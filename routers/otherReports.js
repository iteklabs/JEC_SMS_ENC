const a0_0x4aeceb=a0_0x3a5d;(function(_0x43a0d1,_0x46c879){const _0x29a395=a0_0x3a5d,_0x522ea6=_0x43a0d1();while(!![]){try{const _0xa4c9c3=parseInt(_0x29a395(0xe6))/0x1+parseInt(_0x29a395(0x1b8))/0x2*(parseInt(_0x29a395(0x248))/0x3)+parseInt(_0x29a395(0x13d))/0x4+parseInt(_0x29a395(0x1d5))/0x5+parseInt(_0x29a395(0x124))/0x6+parseInt(_0x29a395(0x16f))/0x7*(-parseInt(_0x29a395(0xcc))/0x8)+-parseInt(_0x29a395(0x189))/0x9;if(_0xa4c9c3===_0x46c879)break;else _0x522ea6['push'](_0x522ea6['shift']());}catch(_0x24a098){_0x522ea6['push'](_0x522ea6['shift']());}}}(a0_0x5d99,0x6a596));const express=require(a0_0x4aeceb(0x17d)),res=require(a0_0x4aeceb(0x1d0)),app=express(),router=express[a0_0x4aeceb(0x20e)](),multer=require(a0_0x4aeceb(0x1e2)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x4aeceb(0x22a)),auth=require(a0_0x4aeceb(0x1cc)),users=require('../public/language/languages.json'),excelJS=require(a0_0x4aeceb(0x1c3)),XLSX=require(a0_0x4aeceb(0x19e)),PDFDocument=require(a0_0x4aeceb(0x156)),fs=require('fs'),blobStream=require(a0_0x4aeceb(0x1d6)),JsBarcode=require(a0_0x4aeceb(0x1f4)),{Canvas}=require(a0_0x4aeceb(0xea)),pdf=require(a0_0x4aeceb(0x134)),path=require(a0_0x4aeceb(0x244)),mongoose=require('mongoose'),cheerio=require(a0_0x4aeceb(0x1b0));router[a0_0x4aeceb(0x18e)]('/balance/view',auth,async(_0x1862d6,_0x12e510)=>{const _0x2a91b4=a0_0x4aeceb;try{const {username:_0x292a09,email:_0x32e1b5,role:_0x2e1e0a}=_0x1862d6['user'],_0x414103=_0x1862d6['user'],_0x2e67e1=await profile[_0x2a91b4(0x1aa)]({'email':_0x414103['email']}),_0x44621e={'year':'numeric','month':_0x2a91b4(0x219),'day':_0x2a91b4(0x1ea)},_0x487572=await master_shop[_0x2a91b4(0xf5)]();console[_0x2a91b4(0x227)](_0x2a91b4(0x183),_0x487572);const _0x5a8ff4=await product[_0x2a91b4(0xf5)]();console[_0x2a91b4(0x227)](_0x2a91b4(0x1eb),_0x5a8ff4);const _0x52b3a7=await warehouse[_0x2a91b4(0x103)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x2a91b4(0x226),'foreignField':_0x2a91b4(0xdc),'as':'product_docs'}},{'$unwind':_0x2a91b4(0xf9)},{'$project':{'product_name':_0x2a91b4(0x140),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x2a91b4(0x1b9),'product_stock':{'$sum':_0x2a91b4(0x239)}}}]);console[_0x2a91b4(0x227)]('Products\x20warehouse_data',_0x52b3a7),_0x52b3a7[_0x2a91b4(0x123)](_0x2147cd=>{const _0x291c77=_0x5a8ff4['map'](_0x57b8b9=>{const _0x387669=a0_0x3a5d;_0x57b8b9[_0x387669(0xdc)]==_0x2147cd[_0x387669(0x200)]&&(_0x57b8b9[_0x387669(0xee)]=parseInt(_0x57b8b9[_0x387669(0xee)])+parseInt(_0x2147cd[_0x387669(0x17e)]));});}),console['log'](_0x2a91b4(0x1eb),_0x5a8ff4);if(_0x487572[0x0]['language']==_0x2a91b4(0x157))var _0x2f80df=users['English'];else{if(_0x487572[0x0][_0x2a91b4(0x153)]=='Hindi')var _0x2f80df=users[_0x2a91b4(0x243)];else{if(_0x487572[0x0][_0x2a91b4(0x153)]=='German')var _0x2f80df=users['German'];else{if(_0x487572[0x0][_0x2a91b4(0x153)]==_0x2a91b4(0x246))var _0x2f80df=users[_0x2a91b4(0x246)];else{if(_0x487572[0x0][_0x2a91b4(0x153)]==_0x2a91b4(0xd1))var _0x2f80df=users[_0x2a91b4(0xd1)];else{if(_0x487572[0x0][_0x2a91b4(0x153)]=='Portuguese\x20(BR)')var _0x2f80df=users[_0x2a91b4(0x202)];else{if(_0x487572[0x0][_0x2a91b4(0x153)]==_0x2a91b4(0x165))var _0x2f80df=users[_0x2a91b4(0x165)];else{if(_0x487572[0x0][_0x2a91b4(0x153)]==_0x2a91b4(0x238))var _0x2f80df=users[_0x2a91b4(0x18b)];}}}}}}}_0x12e510[_0x2a91b4(0x21e)](_0x2a91b4(0x1e7),{'success':_0x1862d6['flash']('success'),'errors':_0x1862d6[_0x2a91b4(0x1ba)](_0x2a91b4(0x23e)),'alldata':_0x5a8ff4,'profile':_0x2e67e1,'master_shop':_0x487572,'role':_0x414103,'product_stock':_0x52b3a7,'language':_0x2f80df});}catch(_0x352124){}});async function dataCheck(_0xd0c0b9,_0x37d40a){const _0x232089=a0_0x4aeceb,_0x67bfb7=await product[_0x232089(0x103)]([{'$group':{'_id':{'brand':_0x232089(0xd4),'category':_0x232089(0x163)},'products':{'$push':{'name':_0x232089(0x198),'product_code':_0x232089(0x15f)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3fd522=[];_0x3fd522[_0x232089(0x180)]=[];for(let _0x54b6f8=0x0;_0x54b6f8<=_0x67bfb7[_0x232089(0x21d)]-0x1;_0x54b6f8++){const _0xd88c20=_0x67bfb7[_0x54b6f8];_0x3fd522['cat_brand'][_0x232089(0xfb)](_0xd88c20);}const _0x348e22=await product[_0x232089(0x103)]([{'$group':{'_id':{'category':_0x232089(0x163)},'products':{'$push':{'brand':_0x232089(0xd4),'product_code':_0x232089(0x15f),'product_name':_0x232089(0x198)}}}},{'$sort':{'_id.category':-0x1}}]),_0x344222=await purchases_finished[_0x232089(0x103)]([{'$match':{'date':{'$gte':_0xd0c0b9,'$lte':_0x37d40a}}},{'$unwind':_0x232089(0x162)},{'$group':{'_id':{'product_name':'$product.product_name','product_code':_0x232089(0x15c)},'totalQTY':{'$sum':'$product.quantity'}}}]);_0x3fd522[_0x232089(0x172)]=[];for(let _0x414047=0x0;_0x414047<=_0x344222['length']-0x1;_0x414047++){const _0x164c5a=_0x344222[_0x414047];_0x3fd522['beg_bal'][_0x232089(0xfb)](_0x164c5a);}const _0x304975=await sales_sa[_0x232089(0x103)]([{'$match':{'date':{'$gte':_0xd0c0b9,'$lte':_0x37d40a}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':'staffs','localField':_0x232089(0x1a7),'foreignField':_0x232089(0x200),'as':_0x232089(0x106)}},{'$unwind':_0x232089(0x251)},{'$unwind':_0x232089(0xcd)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x232089(0x23f),'product_code':_0x232089(0x109)},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console['log'](_0x304975[0x0]),_0x3fd522[_0x232089(0xca)]=[];for(let _0x1a17e9=0x0;_0x1a17e9<=_0x304975['length']-0x1;_0x1a17e9++){const _0x2337c6=_0x304975[_0x1a17e9];_0x3fd522['sales_bkg']['push'](_0x2337c6);}const _0x1d316f=await sales_sa[_0x232089(0x103)]([{'$match':{'date':{'$gte':_0xd0c0b9,'$lte':_0x37d40a}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x232089(0x206)}}},{'$lookup':{'from':_0x232089(0x218),'localField':_0x232089(0x1a7),'foreignField':_0x232089(0x200),'as':'sales_info'}},{'$unwind':'$sales_info'},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x232089(0x1ff)}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x232089(0x109)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'}}}]);_0x3fd522[_0x232089(0x108)]=[];for(let _0x1427f4=0x0;_0x1427f4<=_0x1d316f['length']-0x1;_0x1427f4++){const _0x2e7315=_0x1d316f[_0x1427f4];_0x3fd522[_0x232089(0x108)][_0x232089(0xfb)](_0x2e7315);}let _0x575f1b='';for(let _0x46cab4=0x0;_0x46cab4<=_0x348e22['length']-0x1;_0x46cab4++){const _0x2e3319=_0x348e22[_0x46cab4];_0x575f1b+='<tr>',_0x575f1b+=_0x232089(0x18c)+_0x2e3319[_0x232089(0x200)][_0x232089(0x216)]+_0x232089(0x232),_0x575f1b+='</tr>';for(let _0x530ce1=0x0;_0x530ce1<_0x3fd522[_0x232089(0x180)][_0x232089(0x21d)];_0x530ce1++){const _0x5dd233=_0x3fd522[_0x232089(0x180)][_0x530ce1];if(_0x5dd233['_id'][_0x232089(0x216)]==_0x2e3319[_0x232089(0x200)][_0x232089(0x216)]){let _0x1b2217=[],_0x4e7390=[],_0x443796=[];_0x1b2217[_0x5dd233['_id']['brand']]=[],_0x4e7390[_0x5dd233['_id']['brand']]=[],_0x443796[_0x5dd233[_0x232089(0x200)]['brand']]=[];var _0x17fe5a=0x0,_0x12f754=0x0,_0x4d0bd1=0x0;for(let _0x2fb2ca=0x0;_0x2fb2ca<_0x5dd233[_0x232089(0x127)][_0x232089(0x21d)];_0x2fb2ca++){const _0x2688b4=_0x5dd233[_0x232089(0x127)][_0x2fb2ca];for(let _0x109e1d=0x0;_0x109e1d<=_0x3fd522[_0x232089(0x172)][_0x232089(0x21d)]-0x1;_0x109e1d++){const _0x344f2e=_0x3fd522[_0x232089(0x172)][_0x109e1d];_0x344f2e['_id']['product_name']==_0x2688b4['name']&&_0x344f2e['_id']['product_code']==_0x2688b4[_0x232089(0x174)]&&(_0x17fe5a+=parseInt(_0x344f2e[_0x232089(0x1d2)],0xa));}for(let _0x4986a8=0x0;_0x4986a8<=_0x3fd522['sales_ext'][_0x232089(0x21d)]-0x1;_0x4986a8++){const _0x3b0589=_0x3fd522[_0x232089(0x108)][_0x4986a8];_0x3b0589['_id'][_0x232089(0x1b3)]==_0x2688b4[_0x232089(0xdc)]&&_0x3b0589['_id'][_0x232089(0x174)]==_0x2688b4['product_code']&&(_0x12f754+=parseFloat(_0x3b0589[_0x232089(0x1d2)],0xa)['toFixed'](0x2));}for(let _0x4346da=0x0;_0x4346da<=_0x3fd522[_0x232089(0xca)][_0x232089(0x21d)]-0x1;_0x4346da++){const _0x55f24c=_0x3fd522[_0x232089(0xca)][_0x4346da];_0x55f24c['_id'][_0x232089(0x1b3)]==_0x2688b4[_0x232089(0xdc)]&&_0x55f24c[_0x232089(0x200)][_0x232089(0x174)]==_0x2688b4['product_code']&&(_0x4d0bd1+=parseInt(_0x55f24c[_0x232089(0x1d2)],0xa));}}const _0xcfb976=new Intl[(_0x232089(0x150))](_0x232089(0xd9));var _0x5e3a68=_0xcfb976[_0x232089(0x177)](_0x17fe5a);_0x1b2217[_0x5dd233['_id'][_0x232089(0x1d1)]][_0x232089(0xfb)](_0x5e3a68),_0x4e7390[_0x5dd233[_0x232089(0x200)][_0x232089(0x1d1)]][_0x232089(0xfb)](_0xcfb976[_0x232089(0x177)](_0x12f754)),_0x443796[_0x5dd233['_id']['brand']][_0x232089(0xfb)](_0xcfb976[_0x232089(0x177)](_0x4d0bd1));var _0x1db1fa=_0xcfb976[_0x232089(0x177)](_0x17fe5a-(_0x4d0bd1+_0x12f754));_0x575f1b+=_0x232089(0x1cf),_0x575f1b+='<td\x20class=\x22row_data\x22></td>',_0x575f1b+=_0x232089(0x10c)+_0x5dd233[_0x232089(0x200)]['brand']+_0x232089(0x232),_0x575f1b+=_0x232089(0x10c)+_0x1b2217[_0x5dd233['_id'][_0x232089(0x1d1)]][0x0]+'</td>',_0x575f1b+=_0x232089(0x16e),_0x575f1b+='<td\x20class=\x22row_data\x22>'+_0x443796[_0x5dd233[_0x232089(0x200)]['brand']][0x0]+_0x232089(0x232),_0x575f1b+=_0x232089(0x10c)+_0x4e7390[_0x5dd233[_0x232089(0x200)]['brand']][0x0]+_0x232089(0x232),_0x575f1b+=_0x232089(0x10c)+_0x1db1fa+_0x232089(0x232),_0x575f1b+=_0x232089(0x10f);}}}return console[_0x232089(0x227)](_0x3fd522[_0x232089(0xca)]),_0x575f1b;}router[a0_0x4aeceb(0x23b)](a0_0x4aeceb(0x1ac),auth,async(_0x348f63,_0x11da07)=>{const _0x30d916=a0_0x4aeceb,{from_date:_0x1c545c,to_date:_0x2f4747}=_0x348f63['body'],_0x17e673=await dataCheck(_0x1c545c,_0x2f4747);{}let _0x19f3ab=_0x30d916(0x175);var _0x118b5b=new Date(_0x1c545c),_0x41d09e=new Date(_0x2f4747);const _0x6bbed4={'year':'numeric','month':_0x30d916(0x219),'day':_0x30d916(0x1ea)},_0x55d019=new Intl[(_0x30d916(0x12e))](_0x30d916(0xd9),_0x6bbed4)[_0x30d916(0x177)](_0x118b5b),_0x1f5dbb=new Intl[(_0x30d916(0x12e))](_0x30d916(0xd9),_0x6bbed4)['format'](_0x41d09e);_0x19f3ab+=_0x30d916(0x130),_0x19f3ab+=_0x30d916(0x147),_0x19f3ab+=_0x30d916(0xce)+_0x55d019+'\x20-\x20'+_0x1f5dbb+_0x30d916(0x1b2),_0x19f3ab+=_0x30d916(0x240),_0x19f3ab+=_0x30d916(0xe2),_0x19f3ab+=_0x30d916(0x1cb),_0x19f3ab+=_0x30d916(0x1cf),_0x19f3ab+=_0x30d916(0x210),_0x19f3ab+=_0x30d916(0x159),_0x19f3ab+=_0x30d916(0x1e3)+_0x55d019+_0x30d916(0x204),_0x19f3ab+=_0x30d916(0x1d7),_0x19f3ab+=_0x30d916(0x1cd),_0x19f3ab+=_0x30d916(0x10b)+_0x1f5dbb+_0x30d916(0x204),_0x19f3ab+=_0x30d916(0x10f),_0x19f3ab+='<tr>',_0x19f3ab+='<th>Booking</th>',_0x19f3ab+='<th>X-Truck</th>',_0x19f3ab+=_0x30d916(0x10f),_0x19f3ab+=_0x17e673,_0x19f3ab+='</table>',_0x19f3ab+=_0x30d916(0x19a),_0x19f3ab+=_0x30d916(0x19a);const _0x46913b={'format':_0x30d916(0x18a),'orientation':_0x30d916(0x1c4),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x30d916(0x169)}}};pdf[_0x30d916(0xcb)](_0x19f3ab,_0x46913b)['toStream'](function(_0x421ec7,_0x23e099){const _0x35556a=_0x30d916;if(_0x421ec7){_0x11da07['status'](0x1f4)['send'](_0x35556a(0x1ce));return;}_0x11da07[_0x35556a(0x1ae)]('Content-Type','application/pdf'),_0x23e099[_0x35556a(0x1b6)](_0x11da07);});}),router[a0_0x4aeceb(0x18e)](a0_0x4aeceb(0x1b1),auth,async(_0x4bc914,_0x38f00d)=>{const _0x135b1f=a0_0x4aeceb;try{const {username:_0x371ff8,email:_0x2e1a00,role:_0x294c83}=_0x4bc914[_0x135b1f(0x12f)],_0x24f3d1=_0x4bc914[_0x135b1f(0x12f)],_0x1457c6=await profile['findOne']({'email':_0x24f3d1[_0x135b1f(0x179)]}),_0x4f2df6={'year':_0x135b1f(0x1ea),'month':_0x135b1f(0x219),'day':'numeric'},_0x171fd0=await master_shop[_0x135b1f(0xf5)](),_0x5b2608=await product[_0x135b1f(0xf5)](),_0x2cf658=await warehouse[_0x135b1f(0x103)]([{'$unwind':_0x135b1f(0x131)},{'$lookup':{'from':_0x135b1f(0x127),'localField':_0x135b1f(0x226),'foreignField':'name','as':_0x135b1f(0x20d)}},{'$unwind':_0x135b1f(0xf9)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x135b1f(0x154)}},{'$group':{'_id':_0x135b1f(0x1b9),'product_stock':{'$sum':'$product_stock'}}}]);if(_0x171fd0[0x0][_0x135b1f(0x153)]==_0x135b1f(0x157))var _0x1d32e8=users['English'];else{if(_0x171fd0[0x0]['language']=='Hindi')var _0x1d32e8=users[_0x135b1f(0x243)];else{if(_0x171fd0[0x0][_0x135b1f(0x153)]==_0x135b1f(0x1be))var _0x1d32e8=users[_0x135b1f(0x1be)];else{if(_0x171fd0[0x0]['language']==_0x135b1f(0x246))var _0x1d32e8=users[_0x135b1f(0x246)];else{if(_0x171fd0[0x0][_0x135b1f(0x153)]==_0x135b1f(0xd1))var _0x1d32e8=users['French'];else{if(_0x171fd0[0x0]['language']==_0x135b1f(0x223))var _0x1d32e8=users['Portuguese'];else{if(_0x171fd0[0x0][_0x135b1f(0x153)]==_0x135b1f(0x165))var _0x1d32e8=users[_0x135b1f(0x165)];else{if(_0x171fd0[0x0]['language']==_0x135b1f(0x238))var _0x1d32e8=users[_0x135b1f(0x18b)];}}}}}}}_0x38f00d[_0x135b1f(0x21e)]('agent_sales',{'success':_0x4bc914[_0x135b1f(0x1ba)](_0x135b1f(0x13b)),'errors':_0x4bc914[_0x135b1f(0x1ba)](_0x135b1f(0x23e)),'alldata':_0x5b2608,'profile':_0x1457c6,'master_shop':_0x171fd0,'role':_0x24f3d1,'product_stock':_0x2cf658,'language':_0x1d32e8});}catch(_0x937724){}});async function agentsdataCheck(_0x3e8087,_0x4f0a7f){const _0x4465b7=a0_0x4aeceb,_0x57ba5b=await product[_0x4465b7(0x103)]([{'$group':{'_id':{'brand':_0x4465b7(0xd4),'category':_0x4465b7(0x163)},'products':{'$push':{'name':_0x4465b7(0x198),'product_code':_0x4465b7(0x15f)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5eb5d6=[];_0x5eb5d6['cat_brand']=[];for(let _0x4f01f8=0x0;_0x4f01f8<=_0x57ba5b[_0x4465b7(0x21d)]-0x1;_0x4f01f8++){const _0x55d7ad=_0x57ba5b[_0x4f01f8];_0x5eb5d6['cat_brand']['push'](_0x55d7ad);}const _0x5cb5c4=await product[_0x4465b7(0x103)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x4465b7(0xd4),'product_code':'$product_code','product_name':_0x4465b7(0x198)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1a0755=await product[_0x4465b7(0x103)]([{'$group':{'_id':{'category':'$category','brand':'$brand'}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x137326=await sales_sa[_0x4465b7(0x103)]([{'$match':{'date':{'$gte':_0x3e8087,'$lte':_0x4f0a7f}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x4465b7(0x218),'localField':_0x4465b7(0x1a7),'foreignField':_0x4465b7(0x200),'as':_0x4465b7(0x106)}},{'$unwind':_0x4465b7(0x251)},{'$unwind':_0x4465b7(0xcd)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x4465b7(0x1ff)}},{'$lookup':{'from':'products','localField':_0x4465b7(0x182),'foreignField':_0x4465b7(0x174),'as':_0x4465b7(0x126)}},{'$unwind':_0x4465b7(0x1a8)},{'$group':{'_id':{'sales_id':_0x4465b7(0x187),'category':_0x4465b7(0x107),'brand':_0x4465b7(0x220)},'salesman_data':{'$first':_0x4465b7(0x1b5)},'totalQTY':{'$sum':_0x4465b7(0x21b)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','product_details':{'prod_name':_0x4465b7(0x10d),'product_code':_0x4465b7(0xe0),'category':_0x4465b7(0x107),'brand':_0x4465b7(0x220)}}}}}]);let _0x346367='';_0x346367+=_0x4465b7(0x1cf),_0x346367+=_0x4465b7(0x173),_0x346367+=_0x4465b7(0x10f),_0x346367+='<tr>',_0x346367+=_0x4465b7(0x242);for(let _0xe3a053=0x0;_0xe3a053<=_0x5cb5c4[_0x4465b7(0x21d)]-0x1;_0xe3a053++){const _0x176340=_0x5cb5c4[_0xe3a053];for(let _0x47b3b0=0x0;_0x47b3b0<_0x1a0755['length'];_0x47b3b0++){const _0x2b7eee=_0x1a0755[_0x47b3b0];_0x2b7eee['_id']==_0x176340[_0x4465b7(0x200)][_0x4465b7(0x216)]&&(_0x346367+=_0x4465b7(0x250)+_0x2b7eee['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x176340[_0x4465b7(0x200)]['category']+_0x4465b7(0x232));}}_0x346367+=_0x4465b7(0x242),_0x346367+=_0x4465b7(0x10f),_0x346367+='<tr>',_0x346367+=_0x4465b7(0x11b);for(let _0x9c00b5=0x0;_0x9c00b5<=_0x5cb5c4['length']-0x1;_0x9c00b5++){const _0x1493ae=_0x5cb5c4[_0x9c00b5];for(let _0x17c360=0x0;_0x17c360<_0x5eb5d6[_0x4465b7(0x180)]['length'];_0x17c360++){const _0x2f0fe2=_0x5eb5d6[_0x4465b7(0x180)][_0x17c360];_0x2f0fe2[_0x4465b7(0x200)][_0x4465b7(0x216)]==_0x1493ae[_0x4465b7(0x200)][_0x4465b7(0x216)]&&(_0x346367+=_0x4465b7(0x1e6)+_0x2f0fe2[_0x4465b7(0x200)][_0x4465b7(0x1d1)]+'</td>');}}_0x346367+=_0x4465b7(0x101),_0x346367+=_0x4465b7(0x10f);let _0x4e9dec={'name':[],'dataqty':{}};for(let _0xb1897a=0x0;_0xb1897a<_0x5eb5d6[_0x4465b7(0x180)][_0x4465b7(0x21d)];_0xb1897a++){const _0x2b32f6=_0x5eb5d6['cat_brand'][_0xb1897a],_0x108620=_0x2b32f6[_0x4465b7(0x200)][_0x4465b7(0x1d1)],_0x5c2a62=_0x2b32f6[_0x4465b7(0x200)][_0x4465b7(0x216)];!_0x4e9dec[_0x4465b7(0x22b)][_0x108620]&&(_0x4e9dec[_0x4465b7(0x22b)][_0x108620]={});!_0x4e9dec[_0x4465b7(0x22b)][_0x108620][_0x5c2a62]&&(_0x4e9dec[_0x4465b7(0x22b)][_0x108620][_0x5c2a62]=[]);for(let _0x4b4a8a=0x0;_0x4b4a8a<_0x137326['length'];_0x4b4a8a++){const _0x20d2a9=_0x137326[_0x4b4a8a];if(_0x108620===_0x20d2a9[_0x4465b7(0x200)][_0x4465b7(0x1d1)]&&_0x5c2a62===_0x20d2a9[_0x4465b7(0x200)]['category']){const _0x40edf1=_0x20d2a9[_0x4465b7(0x1e4)];!_0x4e9dec[_0x4465b7(0x22b)][_0x108620][_0x5c2a62][_0x40edf1]&&(_0x4e9dec[_0x4465b7(0x22b)][_0x108620][_0x5c2a62][_0x40edf1]=[]),_0x4e9dec[_0x4465b7(0x22b)][_0x108620][_0x5c2a62][_0x40edf1][_0x4465b7(0xfb)](_0x20d2a9['totalQTY']),!_0x4e9dec[_0x4465b7(0xdc)][_0x4465b7(0xe4)](_0x40edf1)&&_0x4e9dec[_0x4465b7(0xdc)][_0x4465b7(0xfb)](_0x40edf1);}}}_0x346367+=_0x4465b7(0x1cf);for(let _0x413bab=0x0;_0x413bab<=_0x4e9dec[_0x4465b7(0xdc)]['length']-0x1;_0x413bab++){const _0x1016be=_0x4e9dec[_0x4465b7(0xdc)][_0x413bab];_0x346367+=_0x4465b7(0x10c)+_0x1016be+_0x4465b7(0x232);var _0x33f24c=0x0,_0x585010=0x0;for(let _0x4389dc=0x0;_0x4389dc<=_0x5eb5d6['cat_brand']['length']-0x1;_0x4389dc++){const _0xe7111b=_0x5eb5d6['cat_brand'][_0x4389dc];var _0xf5cf39=0x0;_0x4e9dec[_0x4465b7(0x22b)][_0xe7111b[_0x4465b7(0x200)]['brand']][_0xe7111b['_id']['category']][_0x1016be]?(_0xf5cf39=_0x4e9dec['dataqty'][_0xe7111b[_0x4465b7(0x200)][_0x4465b7(0x1d1)]][_0xe7111b['_id'][_0x4465b7(0x216)]][_0x1016be][0x0],_0x346367+=_0x4465b7(0x10c)+formatNumber(_0xf5cf39[_0x4465b7(0x15a)](0x2))+'</td>'):(_0xf5cf39=0x0,_0x346367+=_0x4465b7(0x10c)+_0xf5cf39+'</td>'),_0x33f24c+=_0xf5cf39;}_0x346367+=_0x4465b7(0x10c)+formatNumber(_0x33f24c[_0x4465b7(0x15a)](0x2))+'</td>';}return _0x346367+='</tr>',_0x346367;}function a0_0x3a5d(_0x4799b1,_0x3aea1a){const _0x5d9935=a0_0x5d99();return a0_0x3a5d=function(_0x3a5d3e,_0x3d43ca){_0x3a5d3e=_0x3a5d3e-0xc8;let _0x28f66c=_0x5d9935[_0x3a5d3e];return _0x28f66c;},a0_0x3a5d(_0x4799b1,_0x3aea1a);}router[a0_0x4aeceb(0x23b)](a0_0x4aeceb(0x158),auth,async(_0x45a986,_0x305176)=>{const _0x5c1065=a0_0x4aeceb,{from_date:_0x4b6544,to_date:_0x442ffd}=_0x45a986[_0x5c1065(0xf0)],_0x143028=await agentsdataCheck(_0x4b6544,_0x442ffd);{}let _0x5eec1c=_0x5c1065(0xd8);var _0x6203fd=new Date(_0x4b6544),_0x42e56c=new Date(_0x442ffd);const _0x56f899={'year':'numeric','month':_0x5c1065(0x219),'day':_0x5c1065(0x1ea)},_0x2ea57b=new Intl[(_0x5c1065(0x12e))](_0x5c1065(0xd9),_0x56f899)['format'](_0x6203fd),_0x47ccca=new Intl['DateTimeFormat'](_0x5c1065(0xd9),_0x56f899)[_0x5c1065(0x177)](_0x42e56c);_0x5eec1c+=_0x5c1065(0x130),_0x5eec1c+=_0x5c1065(0x1fd),_0x5eec1c+=_0x5c1065(0xce)+_0x2ea57b+'\x20-\x20'+_0x47ccca+_0x5c1065(0x1b2),_0x5eec1c+=_0x5c1065(0x240),_0x5eec1c+=_0x5c1065(0xe2),_0x5eec1c+=_0x5c1065(0x1cb),_0x5eec1c+=_0x143028,_0x5eec1c+=_0x5c1065(0x164),_0x5eec1c+=_0x5c1065(0x19a),_0x5eec1c+=_0x5c1065(0x19a);const _0x54edb2={'format':_0x5c1065(0x18a),'orientation':_0x5c1065(0x1c4),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x5c1065(0x169)}}};pdf[_0x5c1065(0xcb)](_0x5eec1c,_0x54edb2)[_0x5c1065(0xeb)](function(_0x105f09,_0x49a237){const _0x2fc35b=_0x5c1065;if(_0x105f09){_0x305176[_0x2fc35b(0x252)](0x1f4)[_0x2fc35b(0x16a)](_0x2fc35b(0x1ce));return;}_0x305176[_0x2fc35b(0x1ae)](_0x2fc35b(0x208),'application/pdf'),_0x49a237[_0x2fc35b(0x1b6)](_0x305176);});}),router[a0_0x4aeceb(0x18e)](a0_0x4aeceb(0x13c),auth,async(_0x3e62e4,_0x2b1fd0)=>{const _0x2bbbae=a0_0x4aeceb;try{const {username:_0xa3c832,email:_0x3f9646,role:_0x15e713}=_0x3e62e4[_0x2bbbae(0x12f)],_0x5132ed=_0x3e62e4[_0x2bbbae(0x12f)],_0x213673=await profile[_0x2bbbae(0x1aa)]({'email':_0x5132ed[_0x2bbbae(0x179)]}),_0x307492={'year':_0x2bbbae(0x1ea),'month':_0x2bbbae(0x219),'day':_0x2bbbae(0x1ea)},_0x185887=await master_shop[_0x2bbbae(0xf5)](),_0x10f846=await staff[_0x2bbbae(0x1aa)]({'email':_0x5132ed[_0x2bbbae(0x179)]}),_0x2b57c3=await product['find'](),_0xf0fb8e=await warehouse[_0x2bbbae(0x103)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x2bbbae(0x226),'foreignField':_0x2bbbae(0xdc),'as':_0x2bbbae(0x20d)}},{'$unwind':_0x2bbbae(0xf9)},{'$project':{'product_name':_0x2bbbae(0x140),'product_stock':_0x2bbbae(0x154)}},{'$group':{'_id':_0x2bbbae(0x1b9),'product_stock':{'$sum':_0x2bbbae(0x239)}}}]),_0x1c6111=await staff[_0x2bbbae(0xf5)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x185887[0x0][_0x2bbbae(0x153)]=='English\x20(US)')var _0x5d72b3=users[_0x2bbbae(0x145)];else{if(_0x185887[0x0][_0x2bbbae(0x153)]==_0x2bbbae(0x243))var _0x5d72b3=users[_0x2bbbae(0x243)];else{if(_0x185887[0x0][_0x2bbbae(0x153)]==_0x2bbbae(0x1be))var _0x5d72b3=users[_0x2bbbae(0x1be)];else{if(_0x185887[0x0][_0x2bbbae(0x153)]==_0x2bbbae(0x246))var _0x5d72b3=users[_0x2bbbae(0x246)];else{if(_0x185887[0x0][_0x2bbbae(0x153)]=='French')var _0x5d72b3=users[_0x2bbbae(0xd1)];else{if(_0x185887[0x0][_0x2bbbae(0x153)]==_0x2bbbae(0x223))var _0x5d72b3=users[_0x2bbbae(0x202)];else{if(_0x185887[0x0]['language']==_0x2bbbae(0x165))var _0x5d72b3=users[_0x2bbbae(0x165)];else{if(_0x185887[0x0][_0x2bbbae(0x153)]==_0x2bbbae(0x238))var _0x5d72b3=users[_0x2bbbae(0x18b)];}}}}}}}_0x2b1fd0[_0x2bbbae(0x21e)]('dsi_sales_admin',{'success':_0x3e62e4[_0x2bbbae(0x1ba)](_0x2bbbae(0x13b)),'errors':_0x3e62e4['flash'](_0x2bbbae(0x23e)),'alldata':_0x2b57c3,'profile':_0x213673,'master_shop':_0x185887,'role':_0x5132ed,'product_stock':_0xf0fb8e,'language':_0x5d72b3,'staff_arr':_0x10f846,'staff_data_all':_0x1c6111});}catch(_0x51c611){_0x2b1fd0['json'](_0x51c611);}});async function agentsdataDSICheck_admin(_0x6e8cd5,_0x34555b,_0x272bad,_0x13aad2){const _0x53c920=a0_0x4aeceb,_0x30d144=await product[_0x53c920(0x103)]([{'$group':{'_id':{'brand':_0x53c920(0xd4),'category':_0x53c920(0x163)},'products':{'$push':{'name':_0x53c920(0x198),'product_code':_0x53c920(0x15f)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x4b2d5b=[];_0x4b2d5b[_0x53c920(0x180)]=[];for(let _0x10907c=0x0;_0x10907c<=_0x30d144[_0x53c920(0x21d)]-0x1;_0x10907c++){const _0x536ff9=_0x30d144[_0x10907c];_0x4b2d5b[_0x53c920(0x180)][_0x53c920(0xfb)](_0x536ff9);}const _0x579593=await product[_0x53c920(0x103)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x53c920(0xd4),'product_code':'$product_code','product_name':_0x53c920(0x198)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5d2900=await product[_0x53c920(0x103)]([{'$group':{'_id':{'category':_0x53c920(0x163),'brand':_0x53c920(0xd4)}}},{'$group':{'_id':_0x53c920(0x186),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xd49687=await sales_sa[_0x53c920(0x103)]([{'$match':{'date':{'$gte':_0x6e8cd5,'$lte':_0x34555b},'sales_staff_id':_0x272bad,'sale_product.isFG':_0x53c920(0x1ff)}},{'$unwind':_0x53c920(0xcd)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':_0x53c920(0x182),'foreignField':_0x53c920(0x174),'as':_0x53c920(0x126)}},{'$unwind':_0x53c920(0x1a8)},{'$group':{'_id':{'dsi':_0x53c920(0x132),'date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x53c920(0x21b)},'products':{'$push':{'qty':_0x53c920(0x21b),'NetPrice':_0x53c920(0x23d),'discount':_0x53c920(0x24c),'adj_discount':_0x53c920(0x117),'product_details':{'prod_name':_0x53c920(0x10d),'product_code':_0x53c920(0xe0),'category':_0x53c920(0x107),'brand':_0x53c920(0x220),'gross_price':_0x53c920(0x224)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x53c920(0x18d),'customer':_0x53c920(0x170),'category':_0x53c920(0x1fb),'brand':_0x53c920(0x1e8)},'totalQty':{'$sum':_0x53c920(0x1ab)},'totalGross':{'$sum':{'$multiply':[_0x53c920(0x1ab),_0x53c920(0xcf)]}},'NetPrice':{'$sum':_0x53c920(0x21c)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x53c920(0x141)},'product_details':{'$first':_0x53c920(0x191)}}},{'$group':{'_id':{'dsi':_0x53c920(0x1bb),'date':'$_id.date','customer':_0x53c920(0x170)},'totalQty':{'$sum':_0x53c920(0x1a4)},'totalGross':{'$sum':_0x53c920(0xfc)},'NetPrice':{'$sum':_0x53c920(0x143)},'discount':{'$sum':_0x53c920(0xed)},'adj_discount':{'$sum':_0x53c920(0x1e9)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x53c920(0x17a),'product_details':_0x53c920(0x131)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x5ecf4d=[],_0x3ce17f={},_0x4f36d2={},_0x389284={};var _0x2de24b=0x0,_0x1b466e=0x0,_0x109666=0x0,_0x153382=0x0,_0x5d2955=0x0;const _0x9d1e7c=0x6;for(let _0x13e0c9=0x0;_0x13e0c9<=_0xd49687[_0x53c920(0x21d)]-0x1;_0x13e0c9++){const _0x5c14e1=_0xd49687[_0x13e0c9];let _0x3c07c6=_0x53c920(0x1cf);_0x3c07c6+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5c14e1[_0x53c920(0x200)][_0x53c920(0x214)]+'</td>',_0x3c07c6+=_0x53c920(0x118)+_0x5c14e1[_0x53c920(0x200)][_0x53c920(0x249)]+_0x53c920(0x232),_0x3c07c6+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5c14e1[_0x53c920(0x200)][_0x53c920(0x15b)]+_0x53c920(0x232);let _0x5932a6={};var _0x5b26f7=0x0;for(let _0x5c9794=0x0;_0x5c9794<=_0x5c14e1[_0x53c920(0x127)]['length']-0x1;_0x5c9794++){const _0x3e4cd0=_0x5c14e1[_0x53c920(0x127)][_0x5c9794];_0x5932a6[_0x3e4cd0[_0x53c920(0x1d1)]+'-'+_0x3e4cd0[_0x53c920(0x216)]]=_0x3e4cd0[_0x53c920(0x234)];const _0x2204c6=_0x3e4cd0[_0x53c920(0x1d1)]+'-'+_0x3e4cd0[_0x53c920(0x216)];!_0x3ce17f[_0x2204c6]&&(_0x3ce17f[_0x2204c6]=0x0),!Array['isArray'](_0x389284[_0x2204c6])&&(_0x389284[_0x2204c6]=[]),!Array[_0x53c920(0x1e5)](_0x389284[_0x2204c6])&&(_0x389284[_0x2204c6]=[]),_0x3ce17f[_0x2204c6]+=_0x3e4cd0[_0x53c920(0x234)],_0x389284[_0x2204c6][_0x53c920(0xfb)](_0x3e4cd0[_0x53c920(0x234)]),_0x5b26f7++;}console[_0x53c920(0x227)](_0x5c14e1);for(let _0x1f42f2=0x0;_0x1f42f2<=_0x4b2d5b[_0x53c920(0x180)][_0x53c920(0x21d)]-0x1;_0x1f42f2++){const _0x5d042a=_0x4b2d5b[_0x53c920(0x180)][_0x1f42f2],_0x418a23=_0x5d042a[_0x53c920(0x200)][_0x53c920(0x1d1)]+'-'+_0x5d042a[_0x53c920(0x200)][_0x53c920(0x216)];_0x3c07c6+=_0x53c920(0x1f0)+(_0x5932a6[_0x418a23]!==undefined?_0x5932a6[_0x418a23][_0x53c920(0x15a)](0x2):'')+_0x53c920(0x232);}_0x109666=_0x5c14e1[_0x53c920(0x102)]+_0x5c14e1[_0x53c920(0x137)],_0x3c07c6+=_0x53c920(0x1ca)+formatNumber(parseFloat(_0x5c14e1[_0x53c920(0xf2)],0x2)[_0x53c920(0x15a)](0x2))+'</td>',_0x3c07c6+=_0x53c920(0x1ca)+formatNumber(_0x5c14e1[_0x53c920(0x155)]['toFixed'](0x2))+_0x53c920(0x232),_0x3c07c6+=_0x53c920(0x1ca)+formatNumber(_0x109666)+_0x53c920(0x232),_0x3c07c6+=_0x53c920(0x1ca)+formatNumber(_0x5c14e1[_0x53c920(0x15e)][_0x53c920(0x15a)](0x2))+'</td>',_0x3c07c6+=_0x53c920(0x10f),_0x2de24b+=parseFloat(_0x5c14e1['totalQty'][_0x53c920(0x15a)](0x2)),_0x1b466e+=parseFloat(_0x5c14e1[_0x53c920(0x15e)]['toFixed'](0x2)),_0x153382+=_0x109666,_0x5d2955+=parseFloat(_0x5c14e1[_0x53c920(0x155)][_0x53c920(0x15a)](0x2));if(_0x13e0c9==_0xd49687[_0x53c920(0x21d)]-0x1){_0x3c07c6+=_0x53c920(0x1cf),_0x3c07c6+=_0x53c920(0x1bf),_0x3c07c6+='</td>';for(let _0x50d6fa=0x0;_0x50d6fa<=_0x4b2d5b[_0x53c920(0x180)]['length']-0x1;_0x50d6fa++){const _0x239dba=_0x4b2d5b['cat_brand'][_0x50d6fa],_0x29de1c=_0x239dba['_id'][_0x53c920(0x1d1)]+'-'+_0x239dba[_0x53c920(0x200)]['category'],_0x1d6e95=_0x389284[_0x29de1c]['reduce']((_0x25b7b2,_0x433969)=>_0x25b7b2+_0x433969,0x0);console[_0x53c920(0x227)](_0x53c920(0x13f),_0x29de1c),_0x3c07c6+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x1d6e95!==undefined?formatNumber(_0x1d6e95[_0x53c920(0x15a)](0x2)):'')+_0x53c920(0x231),console[_0x53c920(0x227)](_0x389284[_0x29de1c]['reduce']((_0x4c2cef,_0x12ad11)=>_0x4c2cef+_0x12ad11,0x0));}_0x3c07c6+=_0x53c920(0x11c)+formatNumber(_0x2de24b[_0x53c920(0x15a)](0x2))+'</b></td>',_0x3c07c6+=_0x53c920(0x11c)+formatNumber(_0x5d2955)+_0x53c920(0x231),_0x3c07c6+=_0x53c920(0x11c)+formatNumber(_0x153382)+'</b></td>',_0x3c07c6+=_0x53c920(0x11c)+formatNumber(_0x1b466e)+'</b></td>',_0x3c07c6+=_0x53c920(0x10f);}_0x5ecf4d[_0x53c920(0xfb)](_0x3c07c6);}function _0x6f0570(_0xd387f4,_0x90c635){const _0x5be700=_0x53c920,_0x29590b=[];for(let _0x1ad033=0x0;_0x1ad033<=_0xd387f4[_0x5be700(0x21d)]-0x1;_0x1ad033+=_0x90c635){_0x29590b[_0x5be700(0xfb)](_0xd387f4[_0x5be700(0x213)](_0x1ad033,_0x1ad033+_0x90c635));}return _0x29590b;}const _0x465e29=_0x6f0570(_0x5ecf4d,_0x9d1e7c);let _0x2bdc53='';return _0x465e29['forEach']((_0x45a834,_0x2b7dd2)=>{const _0x555a8e=_0x53c920;_0x2b7dd2>0x0&&(_0x2bdc53+=_0x555a8e(0x212));_0x2bdc53+=_0x555a8e(0x1cb),_0x2bdc53+=_0x555a8e(0x12c),_0x2bdc53+=_0x555a8e(0x1cf),_0x2bdc53+=_0x555a8e(0x22f),_0x2bdc53+=_0x555a8e(0x10f),_0x2bdc53+=_0x555a8e(0x1cf),_0x2bdc53+=_0x555a8e(0x160);for(let _0x36f695=0x0;_0x36f695<=_0x579593['length']-0x1;_0x36f695++){const _0x59c9af=_0x579593[_0x36f695];for(let _0x297f02=0x0;_0x297f02<_0x5d2900['length'];_0x297f02++){const _0xfb6ff0=_0x5d2900[_0x297f02];_0xfb6ff0['_id']===_0x59c9af[_0x555a8e(0x200)][_0x555a8e(0x216)]&&(_0x2bdc53+=_0x555a8e(0x250)+_0xfb6ff0[_0x555a8e(0x146)]+'\x22\x20class=\x22cat_data\x22>'+_0x59c9af['_id']['category']+'</td>');}}_0x2bdc53+=_0x555a8e(0x228),_0x2bdc53+='</tr>',_0x2bdc53+=_0x555a8e(0x1cf),_0x2bdc53+=_0x555a8e(0xd6),_0x2bdc53+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x2bdc53+=_0x555a8e(0x10a);for(let _0x3cc4c7=0x0;_0x3cc4c7<=_0x579593[_0x555a8e(0x21d)]-0x1;_0x3cc4c7++){const _0x2c03f4=_0x579593[_0x3cc4c7];for(let _0x574905=0x0;_0x574905<_0x4b2d5b[_0x555a8e(0x180)][_0x555a8e(0x21d)];_0x574905++){const _0x1a79d2=_0x4b2d5b[_0x555a8e(0x180)][_0x574905];_0x1a79d2[_0x555a8e(0x200)]['category']===_0x2c03f4[_0x555a8e(0x200)]['category']&&(_0x2bdc53+=_0x555a8e(0x1e6)+_0x1a79d2['_id'][_0x555a8e(0x1d1)]+'</td>');}}_0x2bdc53+=_0x555a8e(0x101),_0x2bdc53+=_0x555a8e(0x245),_0x2bdc53+=_0x555a8e(0x253),_0x2bdc53+=_0x555a8e(0xfe),_0x2bdc53+=_0x555a8e(0x10f),_0x2bdc53+=_0x555a8e(0x1fa),_0x2bdc53+=_0x555a8e(0xc8),_0x45a834['forEach'](_0x1d9f1e=>{_0x2bdc53+=_0x1d9f1e;}),console[_0x555a8e(0x227)](_0x389284),_0x2bdc53+=_0x555a8e(0x100),_0x2bdc53+=_0x555a8e(0x164);}),_0x2bdc53;}async function agentsdataDSICheck_admin_excel(_0x2c9a2c,_0x3d2b9c,_0x2fe661,_0x47cb0c){const _0x43cb9a=a0_0x4aeceb,_0x119f60=await product[_0x43cb9a(0x103)]([{'$group':{'_id':{'brand':_0x43cb9a(0xd4),'category':_0x43cb9a(0x163)},'products':{'$push':{'name':'$name','product_code':_0x43cb9a(0x15f)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3e4a19=[];_0x3e4a19['cat_brand']=[];for(let _0x44ce3d=0x0;_0x44ce3d<=_0x119f60[_0x43cb9a(0x21d)]-0x1;_0x44ce3d++){const _0x4b56e5=_0x119f60[_0x44ce3d];_0x3e4a19[_0x43cb9a(0x180)]['push'](_0x4b56e5);}const _0x1128c5=await product[_0x43cb9a(0x103)]([{'$group':{'_id':{'category':_0x43cb9a(0x163)},'products':{'$push':{'brand':_0x43cb9a(0xd4),'product_code':_0x43cb9a(0x15f),'product_name':_0x43cb9a(0x198)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5a5bf5=await product[_0x43cb9a(0x103)]([{'$group':{'_id':{'category':'$category','brand':_0x43cb9a(0xd4)}}},{'$group':{'_id':_0x43cb9a(0x186),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1607f3=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x2c9a2c,'$lte':_0x3d2b9c},'sales_staff_id':_0x2fe661,'sale_product.isFG':_0x43cb9a(0x1ff)}},{'$unwind':_0x43cb9a(0xcd)},{'$match':{'sale_product.isFG':_0x43cb9a(0x1ff)}},{'$lookup':{'from':'products','localField':_0x43cb9a(0x182),'foreignField':'product_code','as':_0x43cb9a(0x126)}},{'$unwind':_0x43cb9a(0x1a8)},{'$group':{'_id':{'dsi':_0x43cb9a(0x132),'date':_0x43cb9a(0xff),'customer':_0x43cb9a(0x23a)},'totalQty':{'$sum':_0x43cb9a(0x21b)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x43cb9a(0x23d),'discount':_0x43cb9a(0x24c),'adj_discount':_0x43cb9a(0x117),'product_details':{'prod_name':_0x43cb9a(0x10d),'product_code':_0x43cb9a(0xe0),'category':_0x43cb9a(0x107),'brand':'$product_info.brand','gross_price':_0x43cb9a(0x224)}}}}},{'$unwind':_0x43cb9a(0x235)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x43cb9a(0x18d),'customer':_0x43cb9a(0x170),'category':_0x43cb9a(0x1fb),'brand':_0x43cb9a(0x1e8)},'totalQty':{'$sum':_0x43cb9a(0x1ab)},'totalGross':{'$sum':{'$multiply':[_0x43cb9a(0x1ab),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x43cb9a(0xf6)},'adj_discount':{'$sum':_0x43cb9a(0x141)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x43cb9a(0x1bb),'date':_0x43cb9a(0x18d),'customer':'$_id.customer'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x43cb9a(0xfc)},'NetPrice':{'$sum':_0x43cb9a(0x143)},'discount':{'$sum':_0x43cb9a(0xed)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x43cb9a(0x1a4),'category':_0x43cb9a(0x186),'brand':_0x43cb9a(0x17a),'product_details':_0x43cb9a(0x131)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x583a09=[],_0x475fbe={},_0x8175d2={},_0x49e809={};var _0x10f623=0x0,_0x21a05c=0x0,_0x48a991=0x0,_0x44abf2=0x0,_0x3f49f9=0x0;const _0x3b189b=0x16345785d8a0000;for(let _0x223021=0x0;_0x223021<=_0x1607f3[_0x43cb9a(0x21d)]-0x1;_0x223021++){const _0x3ec6e4=_0x1607f3[_0x223021];let _0x18e091=_0x43cb9a(0x1cf);_0x18e091+=_0x43cb9a(0x118)+_0x3ec6e4[_0x43cb9a(0x200)][_0x43cb9a(0x214)]+_0x43cb9a(0x232),_0x18e091+=_0x43cb9a(0x118)+_0x3ec6e4[_0x43cb9a(0x200)][_0x43cb9a(0x249)]+'</td>',_0x18e091+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x3ec6e4['_id'][_0x43cb9a(0x15b)]+_0x43cb9a(0x232);let _0x37d0a1={};var _0x4e7d90=0x0;for(let _0x6b6938=0x0;_0x6b6938<=_0x3ec6e4[_0x43cb9a(0x127)]['length']-0x1;_0x6b6938++){const _0x48030b=_0x3ec6e4['products'][_0x6b6938];_0x37d0a1[_0x48030b[_0x43cb9a(0x1d1)]+'-'+_0x48030b[_0x43cb9a(0x216)]]=_0x48030b[_0x43cb9a(0x234)];const _0x55f176=_0x48030b[_0x43cb9a(0x1d1)]+'-'+_0x48030b[_0x43cb9a(0x216)];!_0x475fbe[_0x55f176]&&(_0x475fbe[_0x55f176]=0x0),!Array[_0x43cb9a(0x1e5)](_0x49e809[_0x55f176])&&(_0x49e809[_0x55f176]=[]),!Array[_0x43cb9a(0x1e5)](_0x49e809[_0x55f176])&&(_0x49e809[_0x55f176]=[]),_0x475fbe[_0x55f176]+=_0x48030b[_0x43cb9a(0x234)],_0x49e809[_0x55f176][_0x43cb9a(0xfb)](_0x48030b['qty']),_0x4e7d90++;}console['log'](_0x3ec6e4);for(let _0x2b12a4=0x0;_0x2b12a4<=_0x3e4a19[_0x43cb9a(0x180)][_0x43cb9a(0x21d)]-0x1;_0x2b12a4++){const _0x8bf4e2=_0x3e4a19[_0x43cb9a(0x180)][_0x2b12a4],_0x25b847=_0x8bf4e2['_id']['brand']+'-'+_0x8bf4e2[_0x43cb9a(0x200)][_0x43cb9a(0x216)];_0x18e091+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x37d0a1[_0x25b847]!==undefined?_0x37d0a1[_0x25b847]['toFixed'](0x2):'')+_0x43cb9a(0x232);}_0x48a991=_0x3ec6e4['discount']+_0x3ec6e4[_0x43cb9a(0x137)],_0x18e091+=_0x43cb9a(0x1ca)+formatNumber(parseFloat(_0x3ec6e4[_0x43cb9a(0xf2)],0x2)[_0x43cb9a(0x15a)](0x2))+_0x43cb9a(0x232),_0x18e091+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x3ec6e4[_0x43cb9a(0x155)][_0x43cb9a(0x15a)](0x2))+_0x43cb9a(0x232),_0x18e091+=_0x43cb9a(0x1ca)+formatNumber(_0x48a991)+_0x43cb9a(0x232),_0x18e091+=_0x43cb9a(0x1ca)+formatNumber(_0x3ec6e4['NetPrice'][_0x43cb9a(0x15a)](0x2))+_0x43cb9a(0x232),_0x18e091+=_0x43cb9a(0x10f),_0x10f623+=parseFloat(_0x3ec6e4[_0x43cb9a(0xf2)][_0x43cb9a(0x15a)](0x2)),_0x21a05c+=parseFloat(_0x3ec6e4[_0x43cb9a(0x15e)]['toFixed'](0x2)),_0x44abf2+=_0x48a991,_0x3f49f9+=parseFloat(_0x3ec6e4[_0x43cb9a(0x155)][_0x43cb9a(0x15a)](0x2));if(_0x223021==_0x1607f3['length']-0x1){_0x18e091+=_0x43cb9a(0x1cf),_0x18e091+=_0x43cb9a(0x1bf),_0x18e091+=_0x43cb9a(0x232);for(let _0xa77f61=0x0;_0xa77f61<=_0x3e4a19[_0x43cb9a(0x180)]['length']-0x1;_0xa77f61++){const _0x5b456a=_0x3e4a19[_0x43cb9a(0x180)][_0xa77f61],_0x38e62e=_0x5b456a[_0x43cb9a(0x200)][_0x43cb9a(0x1d1)]+'-'+_0x5b456a[_0x43cb9a(0x200)][_0x43cb9a(0x216)],_0x1729eb=_0x49e809[_0x38e62e][_0x43cb9a(0x17f)]((_0x11de49,_0x5a2cfb)=>_0x11de49+_0x5a2cfb,0x0);console['log'](_0x43cb9a(0x13f),_0x38e62e),_0x18e091+=_0x43cb9a(0x11a)+(_0x1729eb!==undefined?formatNumber(_0x1729eb[_0x43cb9a(0x15a)](0x2)):'')+_0x43cb9a(0x231),console[_0x43cb9a(0x227)](_0x49e809[_0x38e62e]['reduce']((_0x38fa57,_0x5b7f2d)=>_0x38fa57+_0x5b7f2d,0x0));}_0x18e091+=_0x43cb9a(0x11c)+formatNumber(_0x10f623[_0x43cb9a(0x15a)](0x2))+_0x43cb9a(0x231),_0x18e091+=_0x43cb9a(0x11c)+formatNumber(_0x3f49f9)+_0x43cb9a(0x231),_0x18e091+=_0x43cb9a(0x11c)+formatNumber(_0x44abf2)+_0x43cb9a(0x231),_0x18e091+=_0x43cb9a(0x11c)+formatNumber(_0x21a05c)+_0x43cb9a(0x231),_0x18e091+=_0x43cb9a(0x10f);}_0x583a09[_0x43cb9a(0xfb)](_0x18e091);}function _0xb37e70(_0x17686a,_0x5baef2){const _0x5e6104=_0x43cb9a,_0x46cbdb=[];for(let _0xd5434e=0x0;_0xd5434e<=_0x17686a['length']-0x1;_0xd5434e+=_0x5baef2){_0x46cbdb[_0x5e6104(0xfb)](_0x17686a[_0x5e6104(0x213)](_0xd5434e,_0xd5434e+_0x5baef2));}return _0x46cbdb;}const _0x25b0d4=_0xb37e70(_0x583a09,_0x3b189b);let _0x1d81c6='';return _0x25b0d4[_0x43cb9a(0x123)]((_0x2dcc3d,_0x230a02)=>{const _0x57ab1e=_0x43cb9a;_0x230a02>0x0&&(_0x1d81c6+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x1d81c6+=_0x57ab1e(0x1cb),_0x1d81c6+=_0x57ab1e(0x12c),_0x1d81c6+=_0x57ab1e(0x1cf),_0x1d81c6+=_0x57ab1e(0x22f),_0x1d81c6+=_0x57ab1e(0x10f),_0x1d81c6+=_0x57ab1e(0x1cf),_0x1d81c6+=_0x57ab1e(0x160);for(let _0x549735=0x0;_0x549735<=_0x1128c5[_0x57ab1e(0x21d)]-0x1;_0x549735++){const _0x2ed716=_0x1128c5[_0x549735];for(let _0x2dcae3=0x0;_0x2dcae3<_0x5a5bf5['length'];_0x2dcae3++){const _0x16c6f1=_0x5a5bf5[_0x2dcae3];_0x16c6f1[_0x57ab1e(0x200)]===_0x2ed716[_0x57ab1e(0x200)][_0x57ab1e(0x216)]&&(_0x1d81c6+=_0x57ab1e(0x250)+_0x16c6f1[_0x57ab1e(0x146)]+_0x57ab1e(0x115)+_0x2ed716['_id'][_0x57ab1e(0x216)]+_0x57ab1e(0x232));}}_0x1d81c6+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x1d81c6+=_0x57ab1e(0x10f),_0x1d81c6+=_0x57ab1e(0x1cf),_0x1d81c6+=_0x57ab1e(0xd6),_0x1d81c6+=_0x57ab1e(0x190),_0x1d81c6+=_0x57ab1e(0x10a);for(let _0x1eae16=0x0;_0x1eae16<=_0x1128c5[_0x57ab1e(0x21d)]-0x1;_0x1eae16++){const _0x547672=_0x1128c5[_0x1eae16];for(let _0x5e3d19=0x0;_0x5e3d19<_0x3e4a19[_0x57ab1e(0x180)][_0x57ab1e(0x21d)];_0x5e3d19++){const _0x5bc24a=_0x3e4a19[_0x57ab1e(0x180)][_0x5e3d19];_0x5bc24a[_0x57ab1e(0x200)]['category']===_0x547672['_id']['category']&&(_0x1d81c6+='<td\x20class=\x22cat_data\x22>'+_0x5bc24a['_id'][_0x57ab1e(0x1d1)]+_0x57ab1e(0x232));}}_0x1d81c6+=_0x57ab1e(0x101),_0x1d81c6+=_0x57ab1e(0x245),_0x1d81c6+=_0x57ab1e(0x253),_0x1d81c6+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x1d81c6+='</tr>',_0x1d81c6+='</thead>',_0x1d81c6+=_0x57ab1e(0xc8),_0x2dcc3d[_0x57ab1e(0x123)](_0x3bd2b7=>{_0x1d81c6+=_0x3bd2b7;}),console[_0x57ab1e(0x227)](_0x49e809),_0x1d81c6+=_0x57ab1e(0x100),_0x1d81c6+='</table>';}),_0x1d81c6;}router[a0_0x4aeceb(0x23b)](a0_0x4aeceb(0x1f7),auth,async(_0x219769,_0x519b6a)=>{const _0x2488d5=a0_0x4aeceb,{from_date:_0x4011a2,to_date:_0x5d2d9d,isExcel:_0x3c0bdb,agent_id:_0x784a71}=_0x219769['body'],_0x34fd2b=_0x219769[_0x2488d5(0x12f)],_0x3e9141=await staff['findOne']({'email':_0x34fd2b[_0x2488d5(0x179)]}),_0x1a3588=await master_shop[_0x2488d5(0xf5)](),_0x245ff3=await agentsdataDSICheck_admin(_0x4011a2,_0x5d2d9d,_0x784a71,_0x3c0bdb),_0x2bd987=await agentsdataDSICheck_admin_excel(_0x4011a2,_0x5d2d9d,_0x784a71,_0x3c0bdb);let _0x14c82c=_0x2488d5(0xf3);var _0x33882a=new Date(_0x4011a2),_0x334376=new Date(_0x5d2d9d);const _0x20ef0b={'year':_0x2488d5(0x1ea),'month':_0x2488d5(0x219),'day':_0x2488d5(0x1ea)},_0x483989=new Intl['DateTimeFormat'](_0x2488d5(0xd9),_0x20ef0b)[_0x2488d5(0x177)](_0x33882a),_0x313318=new Intl[(_0x2488d5(0x12e))](_0x2488d5(0xd9),_0x20ef0b)[_0x2488d5(0x177)](_0x334376);_0x14c82c+='<div\x20class=\x22row\x22>',_0x14c82c+=_0x2488d5(0x24d),_0x14c82c+='<table>',_0x14c82c+=_0x245ff3,_0x14c82c+=_0x2488d5(0x164),_0x14c82c+='</div>',_0x14c82c+=_0x2488d5(0x19a);let _0x1347f4=_0x2488d5(0xf3);_0x1347f4+=_0x2488d5(0x240),_0x1347f4+=_0x2488d5(0x24d),_0x1347f4+='<table>',_0x1347f4+=_0x2bd987,_0x1347f4+=_0x2488d5(0x164),_0x1347f4+=_0x2488d5(0x19a),_0x1347f4+=_0x2488d5(0x19a);let _0x12fae8=_0x2488d5(0x24f);const _0x4c23f9={'width':_0x2488d5(0x14d),'height':_0x2488d5(0x136),'orientation':'landscape','border':{'top':_0x2488d5(0x230),'right':_0x2488d5(0x230),'bottom':_0x2488d5(0x230),'left':_0x2488d5(0x230)},'header':{'height':_0x2488d5(0x20b),'contents':_0x2488d5(0x229)+_0x12fae8+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x483989+'\x20-\x20'+_0x313318+_0x2488d5(0x247)},'footer':{'height':_0x2488d5(0x121),'contents':{'default':_0x2488d5(0x194)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x3c0bdb=='on'){const _0x5cc1ac=cheerio[_0x2488d5(0x1f2)](_0x1347f4);let _0x3032b1=[],_0x213ccf=[],_0x2ba833=[];_0x5cc1ac(_0x2488d5(0x11f))[_0x2488d5(0x222)]((_0x29c562,_0x4dd5ea)=>{const _0x3c822d=_0x2488d5;let _0x120efb=[],_0x556da4=0x0;while(_0x2ba833[_0x556da4]){_0x2ba833[_0x556da4]--,_0x556da4++;}_0x5cc1ac(_0x4dd5ea)[_0x3c822d(0xf5)](_0x3c822d(0xf8))[_0x3c822d(0x222)]((_0x463498,_0x2f0de3)=>{const _0x4a914f=_0x3c822d;let _0x5cd247=_0x5cc1ac(_0x2f0de3)[_0x4a914f(0x14f)]()['trim'](),_0x1acba9=parseFloat(_0x5cd247[_0x4a914f(0xc9)](/,/g,''));isNaN(_0x1acba9)&&(_0x1acba9=_0x5cd247);let _0x57188d=parseInt(_0x5cc1ac(_0x2f0de3)[_0x4a914f(0x12d)](_0x4a914f(0x237)))||0x1,_0x3e5960=parseInt(_0x5cc1ac(_0x2f0de3)['attr']('rowspan'))||0x1;_0x120efb[_0x556da4]=_0x1acba9;(_0x57188d>0x1||_0x3e5960>0x1)&&_0x213ccf[_0x4a914f(0xfb)]({'s':{'r':_0x29c562,'c':_0x556da4},'e':{'r':_0x29c562+_0x3e5960-0x1,'c':_0x556da4+_0x57188d-0x1}});for(let _0x3dd72f=0x0;_0x3dd72f<_0x57188d;_0x3dd72f++){_0x3e5960>0x1&&(_0x2ba833[_0x556da4+_0x3dd72f]=_0x3e5960-0x1);}_0x556da4+=_0x57188d;}),_0x3032b1[_0x3c822d(0xfb)](_0x120efb);});const _0x27585c=XLSX['utils'][_0x2488d5(0xe7)](),_0x2cd9a4=XLSX['utils'][_0x2488d5(0x225)](_0x3032b1);_0x213ccf[_0x2488d5(0x21d)]>0x0&&(_0x2cd9a4[_0x2488d5(0x148)]=_0x213ccf);_0x2cd9a4[_0x2488d5(0x122)]=_0x3032b1[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x2488d5(0x178)][_0x2488d5(0x1dc)](_0x27585c,_0x2cd9a4,'Sales\x20Report');const _0x562c24=XLSX[_0x2488d5(0xd5)](_0x27585c,{'bookType':'xlsx','type':_0x2488d5(0x1c5)});_0x519b6a['setHeader'](_0x2488d5(0x120),_0x2488d5(0x161)),_0x519b6a[_0x2488d5(0x1ae)](_0x2488d5(0x208),_0x2488d5(0x18f)),_0x519b6a[_0x2488d5(0x16a)](_0x562c24);}else pdf[_0x2488d5(0xcb)](_0x14c82c,_0x4c23f9)['toStream'](function(_0x93e443,_0x4b2410){const _0x4250de=_0x2488d5;if(_0x93e443){_0x519b6a[_0x4250de(0x252)](0x1f4)[_0x4250de(0x16a)](_0x4250de(0x1ce));return;}_0x519b6a[_0x4250de(0x1ae)](_0x4250de(0x208),_0x4250de(0x24a)),_0x4b2410[_0x4250de(0x1b6)](_0x519b6a);});}),router[a0_0x4aeceb(0x18e)](a0_0x4aeceb(0x205),auth,async(_0x2df907,_0x3da4d0)=>{const _0xb9f104=a0_0x4aeceb;try{const {username:_0x46337f,email:_0x25d749,role:_0x29e047}=_0x2df907[_0xb9f104(0x12f)],_0x3d44b0=_0x2df907[_0xb9f104(0x12f)],_0x48ad3d=await profile['findOne']({'email':_0x3d44b0['email']}),_0x4b0a4a={'year':_0xb9f104(0x1ea),'month':'long','day':_0xb9f104(0x1ea)},_0x11bd27=await master_shop['find'](),_0x26dc20=await staff[_0xb9f104(0x1aa)]({'email':_0x3d44b0[_0xb9f104(0x179)]}),_0x218aab=await product[_0xb9f104(0xf5)](),_0x3eb98c=await warehouse[_0xb9f104(0x103)]([{'$unwind':_0xb9f104(0x131)},{'$lookup':{'from':_0xb9f104(0x127),'localField':_0xb9f104(0x226),'foreignField':_0xb9f104(0xdc),'as':'product_docs'}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0xb9f104(0x140),'product_stock':_0xb9f104(0x154)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0xb9f104(0x239)}}}]);if(_0x11bd27[0x0][_0xb9f104(0x153)]=='English\x20(US)')var _0x4d8760=users[_0xb9f104(0x145)];else{if(_0x11bd27[0x0][_0xb9f104(0x153)]==_0xb9f104(0x243))var _0x4d8760=users[_0xb9f104(0x243)];else{if(_0x11bd27[0x0][_0xb9f104(0x153)]=='German')var _0x4d8760=users[_0xb9f104(0x1be)];else{if(_0x11bd27[0x0][_0xb9f104(0x153)]==_0xb9f104(0x246))var _0x4d8760=users[_0xb9f104(0x246)];else{if(_0x11bd27[0x0][_0xb9f104(0x153)]==_0xb9f104(0xd1))var _0x4d8760=users[_0xb9f104(0xd1)];else{if(_0x11bd27[0x0]['language']=='Portuguese\x20(BR)')var _0x4d8760=users[_0xb9f104(0x202)];else{if(_0x11bd27[0x0][_0xb9f104(0x153)]==_0xb9f104(0x165))var _0x4d8760=users[_0xb9f104(0x165)];else{if(_0x11bd27[0x0][_0xb9f104(0x153)]=='Arabic\x20(ae)')var _0x4d8760=users[_0xb9f104(0x18b)];}}}}}}}_0x3da4d0[_0xb9f104(0x21e)](_0xb9f104(0x1ed),{'success':_0x2df907[_0xb9f104(0x1ba)](_0xb9f104(0x13b)),'errors':_0x2df907[_0xb9f104(0x1ba)](_0xb9f104(0x23e)),'alldata':_0x218aab,'profile':_0x48ad3d,'master_shop':_0x11bd27,'role':_0x3d44b0,'product_stock':_0x3eb98c,'language':_0x4d8760,'staff_arr':_0x26dc20});}catch(_0x13253a){}});function formatNumber(_0x666289,_0x26b290=a0_0x4aeceb(0xd9),_0x1d2170={'minimumFractionDigits':0x2}){const _0x1dcd16=a0_0x4aeceb,_0x5944e1=new Intl[(_0x1dcd16(0x150))](_0x26b290,_0x1d2170);return _0x5944e1['format'](_0x666289);}async function agentsdataDSICheck(_0x279fcc,_0x2089ea,_0x4cf4b1,_0x3523db){const _0x4b6025=a0_0x4aeceb,_0x300dfe=await product[_0x4b6025(0x103)]([{'$group':{'_id':{'brand':_0x4b6025(0xd4),'category':_0x4b6025(0x163)},'products':{'$push':{'name':_0x4b6025(0x198),'product_code':_0x4b6025(0x15f)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x297938=[];_0x297938[_0x4b6025(0x180)]=[];for(let _0xed179f=0x0;_0xed179f<=_0x300dfe[_0x4b6025(0x21d)]-0x1;_0xed179f++){const _0x194967=_0x300dfe[_0xed179f];_0x297938[_0x4b6025(0x180)][_0x4b6025(0xfb)](_0x194967);}const _0x4be11d=await product[_0x4b6025(0x103)]([{'$group':{'_id':{'category':_0x4b6025(0x163)},'products':{'$push':{'brand':'$brand','product_code':_0x4b6025(0x15f),'product_name':_0x4b6025(0x198)}}}},{'$sort':{'_id.category':-0x1}}]),_0x15047d=await product[_0x4b6025(0x103)]([{'$group':{'_id':{'category':_0x4b6025(0x163),'brand':_0x4b6025(0xd4)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x31af7c=await sales_sa[_0x4b6025(0x103)]([{'$match':{'date':{'$gte':_0x279fcc,'$lte':_0x2089ea},'sales_staff_id':_0x4cf4b1,'sale_product.isFG':'false','status_data':'false'}},{'$unwind':_0x4b6025(0xcd)},{'$match':{'sale_product.isFG':_0x4b6025(0x1ff)}},{'$lookup':{'from':_0x4b6025(0x127),'localField':_0x4b6025(0x182),'foreignField':_0x4b6025(0x174),'as':'product_info'}},{'$unwind':_0x4b6025(0x1a8)},{'$group':{'_id':{'dsi':_0x4b6025(0x132),'date':_0x4b6025(0xff),'customer':'$customer'},'totalQty':{'$sum':_0x4b6025(0x21b)},'products':{'$push':{'qty':_0x4b6025(0x21b),'NetPrice':'$sale_product.totalprice','discount':_0x4b6025(0x24c),'adj_discount':_0x4b6025(0x117),'product_details':{'prod_name':'$product_info.name','product_code':_0x4b6025(0xe0),'category':_0x4b6025(0x107),'brand':'$product_info.brand','gross_price':_0x4b6025(0x224)}}}}},{'$unwind':_0x4b6025(0x235)},{'$group':{'_id':{'dsi':_0x4b6025(0x1bb),'date':_0x4b6025(0x18d),'customer':'$_id.customer','category':_0x4b6025(0x1fb),'brand':_0x4b6025(0x1e8)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x4b6025(0x1ab),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x4b6025(0xf6)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x4b6025(0x191)}}},{'$group':{'_id':{'dsi':_0x4b6025(0x1bb),'date':_0x4b6025(0x18d),'customer':'$_id.customer'},'totalQty':{'$sum':_0x4b6025(0x1a4)},'totalGross':{'$sum':_0x4b6025(0xfc)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x4b6025(0xed)},'adj_discount':{'$sum':_0x4b6025(0x1e9)},'products':{'$push':{'qty':_0x4b6025(0x1a4),'category':_0x4b6025(0x186),'brand':_0x4b6025(0x17a),'product_details':_0x4b6025(0x131)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x3aae14=[],_0x36554f={},_0x2f4e80={},_0x39ba32={};var _0xd7faa6=0x0,_0x29f82f=0x0,_0xd26d20=0x0,_0x49e601=0x0,_0x214791=0x0;const _0x304834=0x6;for(let _0x4b51a4=0x0;_0x4b51a4<=_0x31af7c['length']-0x1;_0x4b51a4++){const _0x3c35fa=_0x31af7c[_0x4b51a4];let _0x5b044c=_0x4b6025(0x1cf);_0x5b044c+=_0x4b6025(0x118)+_0x3c35fa['_id']['dsi']+_0x4b6025(0x232),_0x5b044c+=_0x4b6025(0x118)+_0x3c35fa[_0x4b6025(0x200)][_0x4b6025(0x249)]+_0x4b6025(0x232),_0x5b044c+=_0x4b6025(0x118)+_0x3c35fa[_0x4b6025(0x200)][_0x4b6025(0x15b)]+_0x4b6025(0x232);let _0x2fa870={};var _0x510f3b=0x0;for(let _0x39dbe1=0x0;_0x39dbe1<=_0x3c35fa[_0x4b6025(0x127)][_0x4b6025(0x21d)]-0x1;_0x39dbe1++){const _0x2b2cd0=_0x3c35fa['products'][_0x39dbe1];_0x2fa870[_0x2b2cd0[_0x4b6025(0x1d1)]+'-'+_0x2b2cd0[_0x4b6025(0x216)]]=_0x2b2cd0['qty'];const _0x534c36=_0x2b2cd0[_0x4b6025(0x1d1)]+'-'+_0x2b2cd0[_0x4b6025(0x216)];!_0x36554f[_0x534c36]&&(_0x36554f[_0x534c36]=0x0),!Array[_0x4b6025(0x1e5)](_0x39ba32[_0x534c36])&&(_0x39ba32[_0x534c36]=[]),!Array['isArray'](_0x39ba32[_0x534c36])&&(_0x39ba32[_0x534c36]=[]),_0x36554f[_0x534c36]+=_0x2b2cd0[_0x4b6025(0x234)],_0x39ba32[_0x534c36][_0x4b6025(0xfb)](_0x2b2cd0[_0x4b6025(0x234)]),_0x510f3b++;}console[_0x4b6025(0x227)](_0x3c35fa);for(let _0x4be561=0x0;_0x4be561<=_0x297938[_0x4b6025(0x180)][_0x4b6025(0x21d)]-0x1;_0x4be561++){const _0x5f3c0a=_0x297938['cat_brand'][_0x4be561],_0x34df15=_0x5f3c0a['_id'][_0x4b6025(0x1d1)]+'-'+_0x5f3c0a['_id'][_0x4b6025(0x216)];_0x5b044c+=_0x4b6025(0x1f0)+(_0x2fa870[_0x34df15]!==undefined?_0x2fa870[_0x34df15]['toFixed'](0x2):'')+_0x4b6025(0x232);}_0xd26d20=_0x3c35fa[_0x4b6025(0x102)]+_0x3c35fa['adj_discount'],_0x5b044c+=_0x4b6025(0x1ca)+formatNumber(parseFloat(_0x3c35fa[_0x4b6025(0xf2)],0x2)[_0x4b6025(0x15a)](0x2))+'</td>',_0x5b044c+=_0x4b6025(0x1ca)+formatNumber(_0x3c35fa['totalGross'][_0x4b6025(0x15a)](0x2))+_0x4b6025(0x232),_0x5b044c+=_0x4b6025(0x1ca)+formatNumber(_0xd26d20)+_0x4b6025(0x232),_0x5b044c+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x3c35fa[_0x4b6025(0x15e)][_0x4b6025(0x15a)](0x2))+_0x4b6025(0x232),_0x5b044c+=_0x4b6025(0x10f),_0xd7faa6+=parseFloat(_0x3c35fa[_0x4b6025(0xf2)][_0x4b6025(0x15a)](0x2)),_0x29f82f+=parseFloat(_0x3c35fa[_0x4b6025(0x15e)]['toFixed'](0x2)),_0x49e601+=_0xd26d20,_0x214791+=parseFloat(_0x3c35fa[_0x4b6025(0x155)][_0x4b6025(0x15a)](0x2));if(_0x4b51a4==_0x31af7c[_0x4b6025(0x21d)]-0x1){_0x5b044c+=_0x4b6025(0x1cf),_0x5b044c+=_0x4b6025(0x1bf),_0x5b044c+=_0x4b6025(0x232);for(let _0x2825e7=0x0;_0x2825e7<=_0x297938[_0x4b6025(0x180)][_0x4b6025(0x21d)]-0x1;_0x2825e7++){const _0x5c85fd=_0x297938[_0x4b6025(0x180)][_0x2825e7],_0xdd473f=_0x5c85fd[_0x4b6025(0x200)][_0x4b6025(0x1d1)]+'-'+_0x5c85fd['_id']['category'];!_0x39ba32[_0xdd473f]&&(_0x39ba32[_0xdd473f]=[]);const _0x42172b=_0x39ba32[_0xdd473f][_0x4b6025(0x17f)]((_0xc0d642,_0x545d53)=>_0xc0d642+_0x545d53,0x0);_0x5b044c+=_0x4b6025(0x11a)+(_0x42172b!==undefined?formatNumber(_0x42172b[_0x4b6025(0x15a)](0x2)):'')+_0x4b6025(0x231),console[_0x4b6025(0x227)](_0x39ba32[_0xdd473f][_0x4b6025(0x17f)]((_0x16e9e0,_0x1d9d5a)=>_0x16e9e0+_0x1d9d5a,0x0));}_0x5b044c+=_0x4b6025(0x11c)+formatNumber(_0xd7faa6[_0x4b6025(0x15a)](0x2))+_0x4b6025(0x231),_0x5b044c+=_0x4b6025(0x11c)+formatNumber(_0x214791)+_0x4b6025(0x231),_0x5b044c+=_0x4b6025(0x11c)+formatNumber(_0x49e601)+'</b></td>',_0x5b044c+=_0x4b6025(0x11c)+formatNumber(_0x29f82f)+_0x4b6025(0x231),_0x5b044c+=_0x4b6025(0x10f);}_0x3aae14[_0x4b6025(0xfb)](_0x5b044c);}function _0x476f03(_0x58c455,_0x214141){const _0x2f0073=_0x4b6025,_0x525dfb=[];for(let _0x10aea7=0x0;_0x10aea7<=_0x58c455[_0x2f0073(0x21d)]-0x1;_0x10aea7+=_0x214141){_0x525dfb['push'](_0x58c455[_0x2f0073(0x213)](_0x10aea7,_0x10aea7+_0x214141));}return _0x525dfb;}const _0x14cfc4=_0x476f03(_0x3aae14,_0x304834);let _0x45071b='';return _0x14cfc4[_0x4b6025(0x123)]((_0x2fb357,_0x45fe02)=>{const _0x20d9a9=_0x4b6025;_0x45fe02>0x0&&(_0x45071b+=_0x20d9a9(0x212));_0x45071b+='<table>',_0x45071b+=_0x20d9a9(0x12c),_0x45071b+='<tr>',_0x45071b+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x45071b+=_0x20d9a9(0x10f),_0x45071b+='<tr>',_0x45071b+=_0x20d9a9(0x160);for(let _0x5e321f=0x0;_0x5e321f<=_0x4be11d[_0x20d9a9(0x21d)]-0x1;_0x5e321f++){const _0x392fbd=_0x4be11d[_0x5e321f];for(let _0x1919ba=0x0;_0x1919ba<_0x15047d[_0x20d9a9(0x21d)];_0x1919ba++){const _0x3c94be=_0x15047d[_0x1919ba];_0x3c94be['_id']===_0x392fbd[_0x20d9a9(0x200)][_0x20d9a9(0x216)]&&(_0x45071b+=_0x20d9a9(0x250)+_0x3c94be['brandCount']+_0x20d9a9(0x115)+_0x392fbd[_0x20d9a9(0x200)][_0x20d9a9(0x216)]+'</td>');}}_0x45071b+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x45071b+=_0x20d9a9(0x10f),_0x45071b+=_0x20d9a9(0x1cf),_0x45071b+=_0x20d9a9(0xd6),_0x45071b+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x45071b+=_0x20d9a9(0x10a);for(let _0xcd0996=0x0;_0xcd0996<=_0x4be11d[_0x20d9a9(0x21d)]-0x1;_0xcd0996++){const _0x522a84=_0x4be11d[_0xcd0996];for(let _0xd0c5fd=0x0;_0xd0c5fd<_0x297938['cat_brand'][_0x20d9a9(0x21d)];_0xd0c5fd++){const _0x55abe2=_0x297938['cat_brand'][_0xd0c5fd];_0x55abe2[_0x20d9a9(0x200)][_0x20d9a9(0x216)]===_0x522a84[_0x20d9a9(0x200)]['category']&&(_0x45071b+=_0x20d9a9(0x1e6)+_0x55abe2['_id'][_0x20d9a9(0x1d1)]+'</td>');}}_0x45071b+=_0x20d9a9(0x101),_0x45071b+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x45071b+=_0x20d9a9(0x253),_0x45071b+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x45071b+=_0x20d9a9(0x10f),_0x45071b+=_0x20d9a9(0x1fa),_0x45071b+=_0x20d9a9(0xc8),_0x2fb357[_0x20d9a9(0x123)](_0x5d1d64=>{_0x45071b+=_0x5d1d64;}),console[_0x20d9a9(0x227)](_0x39ba32),_0x45071b+=_0x20d9a9(0x100),_0x45071b+='</table>';}),_0x45071b;}async function agentsdataDSICheck_excel(_0x47bb65,_0x1dbbc0,_0xc20c5f,_0x2267d0){const _0x87c5ef=a0_0x4aeceb,_0x330b50=await product[_0x87c5ef(0x103)]([{'$group':{'_id':{'brand':_0x87c5ef(0xd4),'category':_0x87c5ef(0x163)},'products':{'$push':{'name':_0x87c5ef(0x198),'product_code':_0x87c5ef(0x15f)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x53ebec=[];_0x53ebec[_0x87c5ef(0x180)]=[];for(let _0x155d0b=0x0;_0x155d0b<=_0x330b50[_0x87c5ef(0x21d)]-0x1;_0x155d0b++){const _0x17ebbe=_0x330b50[_0x155d0b];_0x53ebec[_0x87c5ef(0x180)][_0x87c5ef(0xfb)](_0x17ebbe);}const _0x10af5f=await product['aggregate']([{'$group':{'_id':{'category':_0x87c5ef(0x163)},'products':{'$push':{'brand':_0x87c5ef(0xd4),'product_code':_0x87c5ef(0x15f),'product_name':_0x87c5ef(0x198)}}}},{'$sort':{'_id.category':-0x1}}]),_0x16efce=await product[_0x87c5ef(0x103)]([{'$group':{'_id':{'category':_0x87c5ef(0x163),'brand':_0x87c5ef(0xd4)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4dfa4f=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x47bb65,'$lte':_0x1dbbc0},'sales_staff_id':_0xc20c5f,'sale_product.isFG':_0x87c5ef(0x1ff)}},{'$unwind':_0x87c5ef(0xcd)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x87c5ef(0x127),'localField':'sale_product.product_code','foreignField':'product_code','as':'product_info'}},{'$unwind':_0x87c5ef(0x1a8)},{'$group':{'_id':{'dsi':'$dsi','date':_0x87c5ef(0xff),'customer':_0x87c5ef(0x23a)},'totalQty':{'$sum':_0x87c5ef(0x21b)},'products':{'$push':{'qty':_0x87c5ef(0x21b),'NetPrice':'$sale_product.totalprice','discount':_0x87c5ef(0x24c),'adj_discount':_0x87c5ef(0x117),'product_details':{'prod_name':_0x87c5ef(0x10d),'product_code':_0x87c5ef(0xe0),'category':_0x87c5ef(0x107),'brand':_0x87c5ef(0x220),'gross_price':_0x87c5ef(0x224)}}}}},{'$unwind':_0x87c5ef(0x235)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x87c5ef(0x18d),'customer':_0x87c5ef(0x170),'category':'$products.product_details.category','brand':_0x87c5ef(0x1e8)},'totalQty':{'$sum':_0x87c5ef(0x1ab)},'totalGross':{'$sum':{'$multiply':[_0x87c5ef(0x1ab),_0x87c5ef(0xcf)]}},'NetPrice':{'$sum':_0x87c5ef(0x21c)},'discount':{'$sum':_0x87c5ef(0xf6)},'adj_discount':{'$sum':_0x87c5ef(0x141)},'product_details':{'$first':_0x87c5ef(0x191)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x87c5ef(0x18d),'customer':_0x87c5ef(0x170)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x87c5ef(0x143)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x87c5ef(0x1e9)},'products':{'$push':{'qty':_0x87c5ef(0x1a4),'category':'$_id.category','brand':_0x87c5ef(0x17a),'product_details':_0x87c5ef(0x131)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4be4a0=[],_0x502b9a={},_0x42a37e={},_0x3258a6={};var _0x125a51=0x0,_0x49e00d=0x0,_0x2d8f29=0x0,_0x244fe4=0x0,_0x1c6537=0x0;const _0x44237c=0x9184e72a000;for(let _0x4b3787=0x0;_0x4b3787<=_0x4dfa4f[_0x87c5ef(0x21d)]-0x1;_0x4b3787++){const _0x23e637=_0x4dfa4f[_0x4b3787];let _0x4bdc44=_0x87c5ef(0x1cf);_0x4bdc44+=_0x87c5ef(0x118)+_0x23e637['_id'][_0x87c5ef(0x214)]+_0x87c5ef(0x232),_0x4bdc44+=_0x87c5ef(0x118)+_0x23e637['_id'][_0x87c5ef(0x249)]+_0x87c5ef(0x232),_0x4bdc44+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x23e637[_0x87c5ef(0x200)][_0x87c5ef(0x15b)]+_0x87c5ef(0x232);let _0x2ba2a6={};var _0x28108b=0x0;for(let _0x1d7cd4=0x0;_0x1d7cd4<=_0x23e637[_0x87c5ef(0x127)][_0x87c5ef(0x21d)]-0x1;_0x1d7cd4++){const _0x3594fb=_0x23e637[_0x87c5ef(0x127)][_0x1d7cd4];_0x2ba2a6[_0x3594fb[_0x87c5ef(0x1d1)]+'-'+_0x3594fb[_0x87c5ef(0x216)]]=_0x3594fb[_0x87c5ef(0x234)];const _0x28753c=_0x3594fb['brand']+'-'+_0x3594fb['category'];!_0x502b9a[_0x28753c]&&(_0x502b9a[_0x28753c]=0x0),!Array[_0x87c5ef(0x1e5)](_0x3258a6[_0x28753c])&&(_0x3258a6[_0x28753c]=[]),!Array[_0x87c5ef(0x1e5)](_0x3258a6[_0x28753c])&&(_0x3258a6[_0x28753c]=[]),_0x502b9a[_0x28753c]+=_0x3594fb['qty'],_0x3258a6[_0x28753c][_0x87c5ef(0xfb)](_0x3594fb['qty']),_0x28108b++;}console[_0x87c5ef(0x227)](_0x23e637);for(let _0x4b5655=0x0;_0x4b5655<=_0x53ebec[_0x87c5ef(0x180)][_0x87c5ef(0x21d)]-0x1;_0x4b5655++){const _0x44c9b4=_0x53ebec['cat_brand'][_0x4b5655],_0x27521d=_0x44c9b4[_0x87c5ef(0x200)][_0x87c5ef(0x1d1)]+'-'+_0x44c9b4[_0x87c5ef(0x200)]['category'];_0x4bdc44+=_0x87c5ef(0x1f0)+(_0x2ba2a6[_0x27521d]!==undefined?_0x2ba2a6[_0x27521d][_0x87c5ef(0x15a)](0x2):'')+_0x87c5ef(0x232);}_0x2d8f29=_0x23e637['discount']+_0x23e637[_0x87c5ef(0x137)],_0x4bdc44+=_0x87c5ef(0x1ca)+formatNumber(parseFloat(_0x23e637[_0x87c5ef(0xf2)],0x2)[_0x87c5ef(0x15a)](0x2))+_0x87c5ef(0x232),_0x4bdc44+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x23e637[_0x87c5ef(0x155)][_0x87c5ef(0x15a)](0x2))+'</td>',_0x4bdc44+=_0x87c5ef(0x1ca)+formatNumber(_0x2d8f29)+_0x87c5ef(0x232),_0x4bdc44+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x23e637[_0x87c5ef(0x15e)][_0x87c5ef(0x15a)](0x2))+_0x87c5ef(0x232),_0x4bdc44+='</tr>',_0x125a51+=parseFloat(_0x23e637[_0x87c5ef(0xf2)][_0x87c5ef(0x15a)](0x2)),_0x49e00d+=parseFloat(_0x23e637['NetPrice'][_0x87c5ef(0x15a)](0x2)),_0x244fe4+=_0x2d8f29,_0x1c6537+=parseFloat(_0x23e637[_0x87c5ef(0x155)][_0x87c5ef(0x15a)](0x2));if(_0x4b3787==_0x4dfa4f[_0x87c5ef(0x21d)]-0x1){_0x4bdc44+=_0x87c5ef(0x1cf),_0x4bdc44+=_0x87c5ef(0x1bf),_0x4bdc44+=_0x87c5ef(0x232);for(let _0x22ee13=0x0;_0x22ee13<=_0x53ebec[_0x87c5ef(0x180)][_0x87c5ef(0x21d)]-0x1;_0x22ee13++){const _0x213b36=_0x53ebec[_0x87c5ef(0x180)][_0x22ee13],_0x2615f0=_0x213b36[_0x87c5ef(0x200)][_0x87c5ef(0x1d1)]+'-'+_0x213b36[_0x87c5ef(0x200)][_0x87c5ef(0x216)];!_0x3258a6[_0x2615f0]&&(_0x3258a6[_0x2615f0]=[]);const _0x58d5ed=_0x3258a6[_0x2615f0]['reduce']((_0x289f6e,_0x2e2893)=>_0x289f6e+_0x2e2893,0x0);_0x4bdc44+=_0x87c5ef(0x11a)+(_0x58d5ed!==undefined?formatNumber(_0x58d5ed[_0x87c5ef(0x15a)](0x2)):'')+'</b></td>',console[_0x87c5ef(0x227)](_0x3258a6[_0x2615f0]['reduce']((_0x252b89,_0x33f6c3)=>_0x252b89+_0x33f6c3,0x0));}_0x4bdc44+=_0x87c5ef(0x11c)+formatNumber(_0x125a51[_0x87c5ef(0x15a)](0x2))+_0x87c5ef(0x231),_0x4bdc44+=_0x87c5ef(0x11c)+formatNumber(_0x1c6537)+_0x87c5ef(0x231),_0x4bdc44+=_0x87c5ef(0x11c)+formatNumber(_0x244fe4)+_0x87c5ef(0x231),_0x4bdc44+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x49e00d)+_0x87c5ef(0x231),_0x4bdc44+=_0x87c5ef(0x10f);}_0x4be4a0[_0x87c5ef(0xfb)](_0x4bdc44);}function _0x493031(_0x3d5fb0,_0x2347ac){const _0x4c68b5=_0x87c5ef,_0x5ed17f=[];for(let _0x33e829=0x0;_0x33e829<=_0x3d5fb0[_0x4c68b5(0x21d)]-0x1;_0x33e829+=_0x2347ac){_0x5ed17f[_0x4c68b5(0xfb)](_0x3d5fb0[_0x4c68b5(0x213)](_0x33e829,_0x33e829+_0x2347ac));}return _0x5ed17f;}const _0x19d256=_0x493031(_0x4be4a0,_0x44237c);let _0x426eec='';return _0x19d256[_0x87c5ef(0x123)]((_0x5bad48,_0x358490)=>{const _0x5f12be=_0x87c5ef;_0x358490>0x0&&(_0x426eec+=_0x5f12be(0x212));_0x426eec+=_0x5f12be(0x1cb),_0x426eec+=_0x5f12be(0x12c),_0x426eec+=_0x5f12be(0x1cf),_0x426eec+=_0x5f12be(0x22f),_0x426eec+=_0x5f12be(0x10f),_0x426eec+=_0x5f12be(0x1cf),_0x426eec+=_0x5f12be(0x160);for(let _0x4d8c5b=0x0;_0x4d8c5b<=_0x10af5f[_0x5f12be(0x21d)]-0x1;_0x4d8c5b++){const _0x1ce179=_0x10af5f[_0x4d8c5b];for(let _0x705c27=0x0;_0x705c27<_0x16efce[_0x5f12be(0x21d)];_0x705c27++){const _0x185256=_0x16efce[_0x705c27];_0x185256['_id']===_0x1ce179[_0x5f12be(0x200)][_0x5f12be(0x216)]&&(_0x426eec+=_0x5f12be(0x250)+_0x185256[_0x5f12be(0x146)]+_0x5f12be(0x115)+_0x1ce179[_0x5f12be(0x200)][_0x5f12be(0x216)]+_0x5f12be(0x232));}}_0x426eec+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x426eec+=_0x5f12be(0x10f),_0x426eec+=_0x5f12be(0x1cf),_0x426eec+=_0x5f12be(0xd6),_0x426eec+=_0x5f12be(0x190),_0x426eec+=_0x5f12be(0x10a);for(let _0x40f7b4=0x0;_0x40f7b4<=_0x10af5f[_0x5f12be(0x21d)]-0x1;_0x40f7b4++){const _0x485796=_0x10af5f[_0x40f7b4];for(let _0x7606df=0x0;_0x7606df<_0x53ebec['cat_brand'][_0x5f12be(0x21d)];_0x7606df++){const _0x181852=_0x53ebec[_0x5f12be(0x180)][_0x7606df];_0x181852[_0x5f12be(0x200)][_0x5f12be(0x216)]===_0x485796[_0x5f12be(0x200)][_0x5f12be(0x216)]&&(_0x426eec+=_0x5f12be(0x1e6)+_0x181852[_0x5f12be(0x200)]['brand']+_0x5f12be(0x232));}}_0x426eec+=_0x5f12be(0x101),_0x426eec+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x426eec+=_0x5f12be(0x253),_0x426eec+=_0x5f12be(0xfe),_0x426eec+=_0x5f12be(0x10f),_0x426eec+='</thead>',_0x426eec+='<tbody>',_0x5bad48[_0x5f12be(0x123)](_0x39fcf3=>{_0x426eec+=_0x39fcf3;}),console[_0x5f12be(0x227)](_0x3258a6),_0x426eec+=_0x5f12be(0x100),_0x426eec+=_0x5f12be(0x164);}),_0x426eec;}router[a0_0x4aeceb(0x23b)](a0_0x4aeceb(0x209),auth,async(_0xedf1b0,_0x50454a)=>{const _0x33fc1a=a0_0x4aeceb,{from_date:_0x16a6b8,to_date:_0x65af1,isExcel:_0x3bc849}=_0xedf1b0[_0x33fc1a(0xf0)],_0x3d0bb9=_0xedf1b0[_0x33fc1a(0x12f)],_0x2a8d5d=await staff[_0x33fc1a(0x1aa)]({'email':_0x3d0bb9[_0x33fc1a(0x179)]}),_0x1f33b3=await master_shop[_0x33fc1a(0xf5)](),_0x340df0=await agentsdataDSICheck(_0x16a6b8,_0x65af1,_0x2a8d5d['_id']['valueOf'](),_0x3bc849),_0x4e8d7d=await agentsdataDSICheck_excel(_0x16a6b8,_0x65af1,_0x2a8d5d[_0x33fc1a(0x200)][_0x33fc1a(0x152)](),_0x3bc849);let _0xa55f7=_0x33fc1a(0x1df);var _0x1986ab=new Date(_0x16a6b8),_0x25a48f=new Date(_0x65af1);const _0x9746d3={'year':_0x33fc1a(0x1ea),'month':'long','day':'numeric'},_0x369839=new Intl[(_0x33fc1a(0x12e))](_0x33fc1a(0xd9),_0x9746d3)[_0x33fc1a(0x177)](_0x1986ab),_0x12d982=new Intl[(_0x33fc1a(0x12e))]('en-US',_0x9746d3)[_0x33fc1a(0x177)](_0x25a48f);_0xa55f7+=_0x33fc1a(0x240),_0xa55f7+=_0x33fc1a(0x24d),_0xa55f7+='<table>',_0xa55f7+=_0x340df0,_0xa55f7+='</table>',_0xa55f7+=_0x33fc1a(0x19a),_0xa55f7+=_0x33fc1a(0x19a);let _0x4b1666='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x4b1666+=_0x33fc1a(0x240),_0x4b1666+='<div\x20\x20id=\x22table-conatainer\x22>',_0x4b1666+=_0x33fc1a(0x1cb),_0x4b1666+=_0x4e8d7d,_0x4b1666+=_0x33fc1a(0x164),_0x4b1666+=_0x33fc1a(0x19a),_0x4b1666+=_0x33fc1a(0x19a);let _0x40a7bc=_0x33fc1a(0x24f);const _0x1feefa={'width':'15in','height':_0x33fc1a(0x136),'orientation':_0x33fc1a(0x1c4),'border':{'top':_0x33fc1a(0x230),'right':_0x33fc1a(0x230),'bottom':_0x33fc1a(0x230),'left':_0x33fc1a(0x230)},'header':{'height':_0x33fc1a(0x20b),'contents':_0x33fc1a(0x229)+_0x40a7bc+_0x33fc1a(0x1c2)+_0x369839+_0x33fc1a(0x193)+_0x12d982+_0x33fc1a(0x247)},'footer':{'height':_0x33fc1a(0x121),'contents':{'default':_0x33fc1a(0x194)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x33fc1a(0x169)}}};if(_0x3bc849=='on'){const _0x170745=cheerio[_0x33fc1a(0x1f2)](_0x4b1666);let _0x4a7f2e=[],_0xdebcba=[],_0x3dfc32=[];const _0x16180a=_0xa945ab=>{const _0x3d8b2c=_0x33fc1a,_0x13c03b={'top':{'style':'thick','color':{'rgb':_0x3d8b2c(0x1c0)}},'bottom':{'style':_0x3d8b2c(0x17c),'color':{'rgb':_0x3d8b2c(0x1c0)}},'left':{'style':_0x3d8b2c(0x17c),'color':{'rgb':'000000'}},'right':{'style':_0x3d8b2c(0x17c),'color':{'rgb':'000000'}}};if(_0xa945ab){const _0x3e01d7=_0xa945ab['split'](';')[_0x3d8b2c(0x17f)]((_0x144a09,_0x166267)=>{const _0x4898c2=_0x3d8b2c,[_0x51743c,_0x5cd99e]=_0x166267[_0x4898c2(0x112)](':')[_0x4898c2(0x13a)](_0x3d98b3=>_0x3d98b3['trim']());return _0x144a09[_0x51743c]=_0x5cd99e,_0x144a09;},{});_0x3e01d7[_0x3d8b2c(0x1f6)]&&(_0x13c03b[_0x3d8b2c(0x1c9)][_0x3d8b2c(0x11e)]=_0x3e01d7[_0x3d8b2c(0x1f6)][_0x3d8b2c(0xe4)]('thin')?_0x3d8b2c(0x149):'medium'),_0x3e01d7[_0x3d8b2c(0x1d4)]&&(_0x13c03b['bottom'][_0x3d8b2c(0x11e)]=_0x3e01d7[_0x3d8b2c(0x1d4)][_0x3d8b2c(0xe4)](_0x3d8b2c(0x149))?_0x3d8b2c(0x149):'medium'),_0x3e01d7['border-left']&&(_0x13c03b['left'][_0x3d8b2c(0x11e)]=_0x3e01d7[_0x3d8b2c(0x1e0)][_0x3d8b2c(0xe4)](_0x3d8b2c(0x149))?_0x3d8b2c(0x149):'medium'),_0x3e01d7[_0x3d8b2c(0xde)]&&(_0x13c03b[_0x3d8b2c(0x1a2)][_0x3d8b2c(0x11e)]=_0x3e01d7[_0x3d8b2c(0xde)]['includes'](_0x3d8b2c(0x149))?'thin':_0x3d8b2c(0x236));}return _0x13c03b;};_0x170745('table\x20tr')[_0x33fc1a(0x222)]((_0x12abcb,_0x31bc2b)=>{const _0x1479f6=_0x33fc1a;let _0x5b579a=[],_0x3ba92b=0x0;while(_0x3dfc32[_0x3ba92b]){_0x3dfc32[_0x3ba92b]--,_0x3ba92b++;}_0x170745(_0x31bc2b)['find'](_0x1479f6(0xf8))[_0x1479f6(0x222)]((_0xabb2d4,_0x19a5f4)=>{const _0xb2878=_0x1479f6;let _0x139f90=_0x170745(_0x19a5f4)[_0xb2878(0x14f)]()[_0xb2878(0x1ef)](),_0x4a16a2=parseFloat(_0x139f90[_0xb2878(0xc9)](/,/g,'')),_0x218e90={};!isNaN(_0x4a16a2)?(_0x218e90['v']=_0x4a16a2,_0x218e90['t']='n'):(_0x218e90['v']=_0x139f90,_0x218e90['t']='s');const _0x286cb5=_0x170745(_0x19a5f4)['attr'](_0xb2878(0x11e)),_0x51704f=_0x16180a(_0x286cb5);_0x218e90['s']={'border':_0x51704f},_0x5b579a[_0x3ba92b]=_0x218e90;let _0xe1a435=parseInt(_0x170745(_0x19a5f4)['attr'](_0xb2878(0x237)))||0x1,_0x170276=parseInt(_0x170745(_0x19a5f4)['attr'](_0xb2878(0x254)))||0x1;(_0xe1a435>0x1||_0x170276>0x1)&&_0xdebcba[_0xb2878(0xfb)]({'s':{'r':_0x12abcb,'c':_0x3ba92b},'e':{'r':_0x12abcb+_0x170276-0x1,'c':_0x3ba92b+_0xe1a435-0x1}});for(let _0x44f8b5=0x0;_0x44f8b5<_0xe1a435;_0x44f8b5++){_0x170276>0x1&&(_0x3dfc32[_0x3ba92b+_0x44f8b5]=_0x170276-0x1);}_0x3ba92b+=_0xe1a435;}),_0x4a7f2e[_0x1479f6(0xfb)](_0x5b579a);});const _0x165fc3=XLSX['utils'][_0x33fc1a(0xe7)](),_0x131e2c=XLSX[_0x33fc1a(0x178)][_0x33fc1a(0x225)](_0x4a7f2e);_0xdebcba[_0x33fc1a(0x21d)]>0x0&&(_0x131e2c['!merges']=_0xdebcba);_0x131e2c['!cols']=_0x4a7f2e[0x0][_0x33fc1a(0x13a)](()=>({'wpx':0x64})),XLSX[_0x33fc1a(0x178)][_0x33fc1a(0x1dc)](_0x165fc3,_0x131e2c,_0x33fc1a(0x1de));const _0x3a964d=XLSX['write'](_0x165fc3,{'bookType':'xlsx','type':_0x33fc1a(0x1c5)});_0x50454a[_0x33fc1a(0x1ae)](_0x33fc1a(0x120),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x50454a[_0x33fc1a(0x1ae)](_0x33fc1a(0x208),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x50454a[_0x33fc1a(0x16a)](_0x3a964d);}else pdf[_0x33fc1a(0xcb)](_0xa55f7,_0x1feefa)[_0x33fc1a(0xeb)](function(_0x13c52b,_0x2b88e2){const _0x46c315=_0x33fc1a;if(_0x13c52b){console[_0x46c315(0xf7)]('PDF\x20Generation\x20Error:',_0x13c52b),_0x50454a[_0x46c315(0x252)](0x1f4)[_0x46c315(0x16a)](_0x46c315(0x1ce)+_0x13c52b);return;}_0x50454a[_0x46c315(0x1ae)](_0x46c315(0x208),_0x46c315(0x24a)),_0x2b88e2['pipe'](_0x50454a);});}),router[a0_0x4aeceb(0x18e)]('/total_sales_reports/view',auth,async(_0x5341cf,_0x21c8c1)=>{const _0x5adc3f=a0_0x4aeceb;try{const {username:_0x4cf27a,email:_0xf3b40b,role:_0x4a1d09}=_0x5341cf[_0x5adc3f(0x12f)],_0x3b215b=_0x5341cf[_0x5adc3f(0x12f)],_0x4ebebc=await profile[_0x5adc3f(0x1aa)]({'email':_0x3b215b['email']}),_0x1b9ef9={'year':_0x5adc3f(0x1ea),'month':_0x5adc3f(0x219),'day':'numeric'},_0x402f4d=await master_shop[_0x5adc3f(0xf5)](),_0x37e278=await product['find'](),_0x51fffd=await warehouse[_0x5adc3f(0x103)]([{'$unwind':_0x5adc3f(0x131)},{'$lookup':{'from':'products','localField':_0x5adc3f(0x226),'foreignField':'name','as':_0x5adc3f(0x20d)}},{'$unwind':_0x5adc3f(0xf9)},{'$project':{'product_name':_0x5adc3f(0x140),'product_stock':_0x5adc3f(0x154)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x5adc3f(0x239)}}}]),_0x1ff9cf=await staff[_0x5adc3f(0x1aa)]({'email':_0x3b215b['email']});if(_0x402f4d[0x0][_0x5adc3f(0x153)]=='English\x20(US)')var _0x4d16ef=users[_0x5adc3f(0x145)];else{if(_0x402f4d[0x0][_0x5adc3f(0x153)]==_0x5adc3f(0x243))var _0x4d16ef=users[_0x5adc3f(0x243)];else{if(_0x402f4d[0x0][_0x5adc3f(0x153)]==_0x5adc3f(0x1be))var _0x4d16ef=users[_0x5adc3f(0x1be)];else{if(_0x402f4d[0x0][_0x5adc3f(0x153)]==_0x5adc3f(0x246))var _0x4d16ef=users[_0x5adc3f(0x246)];else{if(_0x402f4d[0x0][_0x5adc3f(0x153)]==_0x5adc3f(0xd1))var _0x4d16ef=users[_0x5adc3f(0xd1)];else{if(_0x402f4d[0x0][_0x5adc3f(0x153)]==_0x5adc3f(0x223))var _0x4d16ef=users['Portuguese'];else{if(_0x402f4d[0x0][_0x5adc3f(0x153)]==_0x5adc3f(0x165))var _0x4d16ef=users[_0x5adc3f(0x165)];else{if(_0x402f4d[0x0]['language']=='Arabic\x20(ae)')var _0x4d16ef=users[_0x5adc3f(0x18b)];}}}}}}}_0x21c8c1[_0x5adc3f(0x21e)]('sales_reports',{'success':_0x5341cf[_0x5adc3f(0x1ba)](_0x5adc3f(0x13b)),'errors':_0x5341cf['flash'](_0x5adc3f(0x23e)),'alldata':_0x37e278,'profile':_0x4ebebc,'master_shop':_0x402f4d,'role':_0x3b215b,'product_stock':_0x51fffd,'language':_0x4d16ef,'staff_arr':_0x1ff9cf});}catch(_0x4a3f3d){}});async function dataSalesReports(_0x47f6ee,_0x5e23ed,_0x22875b){const _0x3ab4e8=a0_0x4aeceb;let _0x304609='';const _0x3162ac=await sales_sa[_0x3ab4e8(0x103)]([{'$match':{'date':{'$gte':_0x47f6ee,'$lte':_0x5e23ed},'sales_staff_id':_0x22875b}},{'$unwind':_0x3ab4e8(0xcd)},{'$match':{'sale_product.isFG':_0x3ab4e8(0x1ff)}},{'$group':{'_id':{'product_name':_0x3ab4e8(0x23f),'product_code':_0x3ab4e8(0x109)},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x1da9a5=0x0,_0x517379=0x0;for(let _0x2ac8ba=0x0;_0x2ac8ba<=_0x3162ac[_0x3ab4e8(0x21d)]-0x1;_0x2ac8ba++){const _0x4b9136=_0x3162ac[_0x2ac8ba];var _0x46a4a8=_0x4b9136[_0x3ab4e8(0x22e)][_0x3ab4e8(0x128)](undefined),_0x16fa8f=_0x4b9136[_0x3ab4e8(0x1ee)][_0x3ab4e8(0x128)](undefined);_0x304609+=_0x3ab4e8(0x1cf),_0x304609+=_0x3ab4e8(0x10c)+_0x4b9136[_0x3ab4e8(0x200)][_0x3ab4e8(0x174)]+_0x3ab4e8(0x232),_0x304609+=_0x3ab4e8(0x10c)+_0x4b9136[_0x3ab4e8(0x200)][_0x3ab4e8(0x1b3)]+_0x3ab4e8(0x232),_0x304609+=_0x3ab4e8(0x10c)+formatNumber(_0x4b9136[_0x3ab4e8(0x1ee)][_0x3ab4e8(0x15a)](0x2))+_0x3ab4e8(0x232),_0x304609+=_0x3ab4e8(0x10c)+formatNumber(_0x4b9136[_0x3ab4e8(0x22e)][_0x3ab4e8(0x15a)](0x2))+'</td>',_0x304609+=_0x3ab4e8(0x10f),_0x1da9a5+=parseFloat(_0x4b9136[_0x3ab4e8(0x1ee)]),_0x517379+=parseFloat(_0x4b9136[_0x3ab4e8(0x22e)]);}var _0x122039=_0x517379[_0x3ab4e8(0x128)](undefined),_0x22b6c4=_0x1da9a5[_0x3ab4e8(0x128)](undefined);return _0x304609+='<tr>',_0x304609+=_0x3ab4e8(0x105),_0x304609+=_0x3ab4e8(0x233)+formatNumber(_0x1da9a5[_0x3ab4e8(0x15a)](0x2))+_0x3ab4e8(0x231),_0x304609+=_0x3ab4e8(0x233)+formatNumber(_0x517379[_0x3ab4e8(0x15a)](0x2))+_0x3ab4e8(0x231),_0x304609+=_0x3ab4e8(0x10f),_0x304609;}router['post'](a0_0x4aeceb(0x188),auth,async(_0x11d240,_0x5f10fc)=>{const _0x11cf4c=a0_0x4aeceb;try{const {from_date:_0x15eb32,to_date:_0x6ebe7b,isExcel:_0x810560}=_0x11d240[_0x11cf4c(0xf0)],_0x12bd1a=_0x11d240[_0x11cf4c(0x12f)],_0x1a7ec1=await staff['findOne']({'email':_0x12bd1a[_0x11cf4c(0x179)]});let _0x3e7a50=_0x11cf4c(0x16d);var _0x28c000=new Date(_0x15eb32),_0xcd5630=new Date(_0x6ebe7b);const _0x1f9583={'year':'numeric','month':_0x11cf4c(0x219),'day':'numeric'},_0x1fb14a=new Intl[(_0x11cf4c(0x12e))](_0x11cf4c(0xd9),_0x1f9583)[_0x11cf4c(0x177)](_0x28c000),_0x43be51=new Intl[(_0x11cf4c(0x12e))](_0x11cf4c(0xd9),_0x1f9583)[_0x11cf4c(0x177)](_0xcd5630);var _0x572186=await dataSalesReports(_0x15eb32,_0x6ebe7b,_0x1a7ec1[_0x11cf4c(0x200)][_0x11cf4c(0x152)]());_0x3e7a50+=_0x11cf4c(0x240),_0x3e7a50+=_0x11cf4c(0xe2),_0x3e7a50+=_0x11cf4c(0x1cb),_0x3e7a50+=_0x11cf4c(0x1cf),_0x3e7a50+='<th>\x20ITEM\x20CODE\x20</th>',_0x3e7a50+=_0x11cf4c(0x171),_0x3e7a50+=_0x11cf4c(0xec),_0x3e7a50+=_0x11cf4c(0x19f),_0x3e7a50+='<tr>',_0x3e7a50+=_0x572186,_0x3e7a50+='</tr>',_0x3e7a50+=_0x11cf4c(0x19a),_0x3e7a50+=_0x11cf4c(0x19a);let _0x34495d=_0x11cf4c(0x24f);const _0xe1bc19={'width':_0x11cf4c(0x14d),'height':_0x11cf4c(0x136),'orientation':'landscape','border':{'top':'0.1in','right':_0x11cf4c(0x230),'bottom':_0x11cf4c(0x230),'left':_0x11cf4c(0x230)},'header':{'height':'60mm','contents':_0x11cf4c(0x229)+_0x34495d+_0x11cf4c(0x1c8)+_0x1a7ec1['name']+'</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x1fb14a+_0x11cf4c(0x193)+_0x43be51+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x11cf4c(0x121),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x11cf4c(0x169)}}};if(_0x810560=='on'){const _0x564782=cheerio[_0x11cf4c(0x1f2)](_0x3e7a50);let _0x4dfb1e=[],_0xb80da8=[],_0x43611f=[];const _0x5c0fb4=_0x160f32=>{const _0x515f2c=_0x11cf4c,_0x996870={'top':{'style':_0x515f2c(0x17c),'color':{'rgb':_0x515f2c(0x1c0)}},'bottom':{'style':_0x515f2c(0x17c),'color':{'rgb':_0x515f2c(0x1c0)}},'left':{'style':'thick','color':{'rgb':_0x515f2c(0x1c0)}},'right':{'style':_0x515f2c(0x17c),'color':{'rgb':_0x515f2c(0x1c0)}}};if(_0x160f32){const _0x1ed756=_0x160f32[_0x515f2c(0x112)](';')[_0x515f2c(0x17f)]((_0x3bb053,_0xde91fb)=>{const _0x4cd660=_0x515f2c,[_0x4a5531,_0x5a5b35]=_0xde91fb[_0x4cd660(0x112)](':')[_0x4cd660(0x13a)](_0x16da62=>_0x16da62['trim']());return _0x3bb053[_0x4a5531]=_0x5a5b35,_0x3bb053;},{});_0x1ed756[_0x515f2c(0x1f6)]&&(_0x996870[_0x515f2c(0x1c9)]['style']=_0x1ed756['border-top'][_0x515f2c(0xe4)]('thin')?'thin':_0x515f2c(0x236)),_0x1ed756[_0x515f2c(0x1d4)]&&(_0x996870[_0x515f2c(0x20f)][_0x515f2c(0x11e)]=_0x1ed756[_0x515f2c(0x1d4)][_0x515f2c(0xe4)](_0x515f2c(0x149))?'thin':_0x515f2c(0x236)),_0x1ed756[_0x515f2c(0x1e0)]&&(_0x996870[_0x515f2c(0x1a1)][_0x515f2c(0x11e)]=_0x1ed756[_0x515f2c(0x1e0)][_0x515f2c(0xe4)](_0x515f2c(0x149))?_0x515f2c(0x149):_0x515f2c(0x236)),_0x1ed756['border-right']&&(_0x996870[_0x515f2c(0x1a2)][_0x515f2c(0x11e)]=_0x1ed756[_0x515f2c(0xde)][_0x515f2c(0xe4)](_0x515f2c(0x149))?_0x515f2c(0x149):_0x515f2c(0x236));}return _0x996870;};_0x564782(_0x11cf4c(0x11f))[_0x11cf4c(0x222)]((_0x3ffaf4,_0x3a8b79)=>{const _0x328d3b=_0x11cf4c;let _0x4507b8=[],_0xe8c24f=0x0;while(_0x43611f[_0xe8c24f]){_0x43611f[_0xe8c24f]--,_0xe8c24f++;}_0x564782(_0x3a8b79)[_0x328d3b(0xf5)](_0x328d3b(0xf8))['each']((_0x2a2a11,_0x5aa21d)=>{const _0x18dde8=_0x328d3b;let _0x4f360d=_0x564782(_0x5aa21d)[_0x18dde8(0x14f)]()['trim'](),_0xaa3ba6=parseFloat(_0x4f360d['replace'](/,/g,'')),_0x1015c2={};!isNaN(_0xaa3ba6)?(_0x1015c2['v']=_0xaa3ba6,_0x1015c2['t']='n'):(_0x1015c2['v']=_0x4f360d,_0x1015c2['t']='s');const _0x31621a=_0x564782(_0x5aa21d)[_0x18dde8(0x12d)](_0x18dde8(0x11e)),_0x32c3b1=_0x5c0fb4(_0x31621a);_0x1015c2['s']={'border':_0x32c3b1},_0x4507b8[_0xe8c24f]=_0x1015c2;let _0x1bcc9e=parseInt(_0x564782(_0x5aa21d)[_0x18dde8(0x12d)]('colspan'))||0x1,_0x4bc9f7=parseInt(_0x564782(_0x5aa21d)[_0x18dde8(0x12d)](_0x18dde8(0x254)))||0x1;(_0x1bcc9e>0x1||_0x4bc9f7>0x1)&&_0xb80da8[_0x18dde8(0xfb)]({'s':{'r':_0x3ffaf4,'c':_0xe8c24f},'e':{'r':_0x3ffaf4+_0x4bc9f7-0x1,'c':_0xe8c24f+_0x1bcc9e-0x1}});for(let _0x10fa5c=0x0;_0x10fa5c<_0x1bcc9e;_0x10fa5c++){_0x4bc9f7>0x1&&(_0x43611f[_0xe8c24f+_0x10fa5c]=_0x4bc9f7-0x1);}_0xe8c24f+=_0x1bcc9e;}),_0x4dfb1e[_0x328d3b(0xfb)](_0x4507b8);});const _0x55d422=XLSX[_0x11cf4c(0x178)]['book_new'](),_0x2b234a=XLSX[_0x11cf4c(0x178)][_0x11cf4c(0x225)](_0x4dfb1e);_0xb80da8[_0x11cf4c(0x21d)]>0x0&&(_0x2b234a[_0x11cf4c(0x148)]=_0xb80da8);_0x2b234a[_0x11cf4c(0x122)]=_0x4dfb1e[0x0][_0x11cf4c(0x13a)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x55d422,_0x2b234a,_0x11cf4c(0x1de));const _0x305195=XLSX['write'](_0x55d422,{'bookType':'xlsx','type':_0x11cf4c(0x1c5)});_0x5f10fc[_0x11cf4c(0x1ae)]('Content-Disposition',_0x11cf4c(0x161)),_0x5f10fc[_0x11cf4c(0x1ae)](_0x11cf4c(0x208),_0x11cf4c(0x18f)),_0x5f10fc[_0x11cf4c(0x16a)](_0x305195);}else pdf['create'](_0x3e7a50,_0xe1bc19)[_0x11cf4c(0xeb)](function(_0x278b0f,_0x542dd7){const _0x537e6f=_0x11cf4c;if(_0x278b0f){_0x5f10fc[_0x537e6f(0x252)](0x1f4)[_0x537e6f(0x16a)](_0x537e6f(0x1ce));return;}_0x5f10fc[_0x537e6f(0x1ae)]('Content-Type',_0x537e6f(0x24a)),_0x542dd7[_0x537e6f(0x1b6)](_0x5f10fc);});}catch(_0xa8fba1){}}),router['get'](a0_0x4aeceb(0x14b),auth,async(_0x162df1,_0xe0b730)=>{const _0x3484e9=a0_0x4aeceb;try{const {username:_0xaa9036,email:_0x49b83e,role:_0x56dd55}=_0x162df1['user'],_0x578180=_0x162df1[_0x3484e9(0x12f)],_0x38ddc3=await profile[_0x3484e9(0x1aa)]({'email':_0x578180[_0x3484e9(0x179)]}),_0x42c902={'year':_0x3484e9(0x1ea),'month':_0x3484e9(0x219),'day':_0x3484e9(0x1ea)},_0x554080=await master_shop[_0x3484e9(0xf5)](),_0x2fbd25=await product[_0x3484e9(0xf5)](),_0x8725=await warehouse['aggregate']([{'$unwind':_0x3484e9(0x131)},{'$lookup':{'from':_0x3484e9(0x127),'localField':_0x3484e9(0x226),'foreignField':_0x3484e9(0xdc),'as':'product_docs'}},{'$unwind':_0x3484e9(0xf9)},{'$project':{'product_name':_0x3484e9(0x140),'product_stock':_0x3484e9(0x154)}},{'$group':{'_id':_0x3484e9(0x1b9),'product_stock':{'$sum':_0x3484e9(0x239)}}}]);if(_0x554080[0x0]['language']=='English\x20(US)')var _0x38cd5b=users[_0x3484e9(0x145)];else{if(_0x554080[0x0][_0x3484e9(0x153)]=='Hindi')var _0x38cd5b=users[_0x3484e9(0x243)];else{if(_0x554080[0x0]['language']=='German')var _0x38cd5b=users[_0x3484e9(0x1be)];else{if(_0x554080[0x0][_0x3484e9(0x153)]==_0x3484e9(0x246))var _0x38cd5b=users['Spanish'];else{if(_0x554080[0x0][_0x3484e9(0x153)]==_0x3484e9(0xd1))var _0x38cd5b=users['French'];else{if(_0x554080[0x0][_0x3484e9(0x153)]=='Portuguese\x20(BR)')var _0x38cd5b=users[_0x3484e9(0x202)];else{if(_0x554080[0x0][_0x3484e9(0x153)]=='Chinese')var _0x38cd5b=users[_0x3484e9(0x165)];else{if(_0x554080[0x0][_0x3484e9(0x153)]==_0x3484e9(0x238))var _0x38cd5b=users[_0x3484e9(0x18b)];}}}}}}}_0xe0b730[_0x3484e9(0x21e)]('inventory_sum',{'success':_0x162df1[_0x3484e9(0x1ba)]('success'),'errors':_0x162df1[_0x3484e9(0x1ba)](_0x3484e9(0x23e)),'alldata':_0x2fbd25,'profile':_0x38ddc3,'master_shop':_0x554080,'role':_0x578180,'product_stock':_0x8725,'language':_0x38cd5b});}catch(_0xcc707e){}});async function dataInventoryReports(_0xb161a8,_0x2b926d,_0x1c1249){const _0x28b572=a0_0x4aeceb,_0x58362a=await sales_sa[_0x28b572(0x103)]([{'$match':{'date':{'$gte':_0xb161a8,'$lte':_0x2b926d},'sales_staff_id':_0x1c1249}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x28b572(0x23f),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x4e2bd2=mongoose['Types'][_0x28b572(0x19b)],_0x3e3c18=await staff['aggregate']([{'$match':{'_id':_0x4e2bd2(_0x1c1249)}},{'$unwind':'$product_list'},{'$match':{'product_list.isConfirm':_0x28b572(0x1ec)}},{'$group':{'_id':{'product_name':_0x28b572(0x215),'product_code':_0x28b572(0x1af)},'sumqty':{'$sum':_0x28b572(0x176)}}},{'$sort':{'_id.product_name':0x1}}]),_0x4407c3=await sales_inv_data[_0x28b572(0x103)]([{'$match':{'date':{'$gte':_0xb161a8,'$lte':_0x2b926d},'sales_staff_id':_0x1c1249}},{'$unwind':_0x28b572(0xcd)},{'$group':{'_id':{'product_name':_0x28b572(0x23f),'product_code':_0x28b572(0x109)},'totalQTYsum':{'$sum':'$sale_product.stock'}}}]);console['log'](_0x4407c3);let _0x487988='';var _0x59239c=0x0;for(let _0x3713ca=0x0;_0x3713ca<=_0x3e3c18[_0x28b572(0x21d)]-0x1;_0x3713ca++){const _0x577333=_0x3e3c18[_0x3713ca];_0x487988+=_0x28b572(0x1cf),_0x487988+=_0x28b572(0x1c6)+_0x577333['_id']['product_code']+'</td>',_0x487988+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>'+_0x577333[_0x28b572(0x200)][_0x28b572(0x1b3)]+_0x28b572(0x232);var _0x43ce54=_0x577333[_0x28b572(0x1ee)],_0x5e28f3=0x0;for(let _0xebd69f=0x0;_0xebd69f<=_0x58362a[_0x28b572(0x21d)]-0x1;_0xebd69f++){const _0x43417b=_0x58362a[_0xebd69f];_0x577333[_0x28b572(0x200)][_0x28b572(0x174)]==_0x43417b[_0x28b572(0x200)][_0x28b572(0x174)]&&_0x577333[_0x28b572(0x200)][_0x28b572(0x1b3)]==_0x43417b['_id'][_0x28b572(0x1b3)]&&(_0x5e28f3=_0x43417b[_0x28b572(0x1ee)]);}var _0x233424=0x0;for(let _0x3f313f=0x0;_0x3f313f<=_0x4407c3[_0x28b572(0x21d)]-0x1;_0x3f313f++){const _0xcc6124=_0x4407c3[_0x3f313f];_0x577333[_0x28b572(0x200)][_0x28b572(0x174)]==_0xcc6124[_0x28b572(0x200)][_0x28b572(0x174)]&&_0x577333[_0x28b572(0x200)][_0x28b572(0x1b3)]==_0xcc6124[_0x28b572(0x200)]['product_name']&&(_0x233424=_0xcc6124[_0x28b572(0x207)]);}_0x59239c=_0x43ce54-_0x233424+_0x5e28f3,_0x487988+=_0x28b572(0x10c)+_0x59239c+_0x28b572(0x232);let _0x2429cd=![];for(let _0x114417=0x0;_0x114417<=_0x4407c3[_0x28b572(0x21d)]-0x1;_0x114417++){const _0x5977c4=_0x4407c3[_0x114417];if(_0x577333['_id'][_0x28b572(0x174)]==_0x5977c4[_0x28b572(0x200)][_0x28b572(0x174)]&&_0x577333[_0x28b572(0x200)][_0x28b572(0x1b3)]==_0x5977c4[_0x28b572(0x200)][_0x28b572(0x1b3)]){_0x487988+=_0x28b572(0x10c)+_0x5977c4[_0x28b572(0x207)]+_0x28b572(0x232),_0x2429cd=!![];break;}}!_0x2429cd&&(_0x487988+=_0x28b572(0x16e));let _0x4267c4=![];for(let _0x5469a8=0x0;_0x5469a8<=_0x58362a[_0x28b572(0x21d)]-0x1;_0x5469a8++){const _0xd3a126=_0x58362a[_0x5469a8];if(_0x577333[_0x28b572(0x200)][_0x28b572(0x174)]==_0xd3a126[_0x28b572(0x200)]['product_code']&&_0x577333[_0x28b572(0x200)]['product_name']==_0xd3a126[_0x28b572(0x200)][_0x28b572(0x1b3)]){_0x487988+=_0x28b572(0x10c)+_0xd3a126[_0x28b572(0x1ee)]+'</td>',_0x4267c4=!![];break;}}!_0x4267c4&&(_0x487988+=_0x28b572(0x16e)),_0x487988+=_0x28b572(0x10c)+_0x577333[_0x28b572(0x1ee)]+_0x28b572(0x232),_0x487988+=_0x28b572(0x10f);}return _0x487988;}router[a0_0x4aeceb(0x23b)]('/inventory_sum/pdf',auth,async(_0x3919e9,_0x1d31c5)=>{const _0x348d02=a0_0x4aeceb;try{const {from_date:_0x31ae3f,to_date:_0x5ac5fa}=_0x3919e9['body'],_0x1f44aa=_0x3919e9[_0x348d02(0x12f)],_0x531520=await staff[_0x348d02(0x1aa)]({'email':_0x1f44aa[_0x348d02(0x179)]});let _0x2a81fa=_0x348d02(0x16d);var _0x3a7e29=new Date(_0x31ae3f),_0x549bca=new Date(_0x5ac5fa);const _0x5936ef={'year':_0x348d02(0x1ea),'month':_0x348d02(0x219),'day':_0x348d02(0x1ea)},_0x1dc60e=new Intl[(_0x348d02(0x12e))](_0x348d02(0xd9),_0x5936ef)['format'](_0x3a7e29),_0x381c3b=new Intl[(_0x348d02(0x12e))](_0x348d02(0xd9),_0x5936ef)[_0x348d02(0x177)](_0x549bca);var _0x5d26a8=await dataInventoryReports(_0x31ae3f,_0x5ac5fa,_0x531520[_0x348d02(0x200)][_0x348d02(0x152)]());_0x2a81fa+=_0x348d02(0x130),_0x2a81fa+='<p>INVENTORY\x20SUMMARY</p>',_0x2a81fa+=_0x348d02(0xce)+_0x1dc60e+_0x348d02(0x193)+_0x381c3b+_0x348d02(0x1b2),_0x2a81fa+=_0x348d02(0x240),_0x2a81fa+=_0x348d02(0xe2),_0x2a81fa+='<table>',_0x2a81fa+=_0x348d02(0x1cf),_0x2a81fa+=_0x348d02(0xe5),_0x2a81fa+=_0x348d02(0x171),_0x2a81fa+=_0x348d02(0x1fc),_0x2a81fa+='<th>\x20INCOMING\x20</th>',_0x2a81fa+='<th>\x20SALES\x20</th>',_0x2a81fa+=_0x348d02(0x199),_0x2a81fa+=_0x348d02(0x1cf),_0x2a81fa+=_0x5d26a8,_0x2a81fa+=_0x348d02(0x10f),_0x2a81fa+='</div>',_0x2a81fa+=_0x348d02(0x19a);const _0x4e4bf1={'format':_0x348d02(0x18a),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x348d02(0x169)}}};pdf['create'](_0x2a81fa,_0x4e4bf1)['toStream'](function(_0x1e2b29,_0x133ee3){const _0x8e62d4=_0x348d02;if(_0x1e2b29){_0x1d31c5[_0x8e62d4(0x252)](0x1f4)[_0x8e62d4(0x16a)](_0x8e62d4(0x1ce));return;}_0x1d31c5[_0x8e62d4(0x1ae)](_0x8e62d4(0x208),_0x8e62d4(0x24a)),_0x133ee3[_0x8e62d4(0x1b6)](_0x1d31c5);});}catch(_0x4b9ccf){}}),router[a0_0x4aeceb(0x18e)](a0_0x4aeceb(0x104),auth,async(_0x4761aa,_0x479437)=>{const _0x53d3b2=a0_0x4aeceb;try{const {username:_0x5588fd,email:_0x15771f,role:_0x1b6493}=_0x4761aa['user'],_0x35473c=_0x4761aa[_0x53d3b2(0x12f)],_0x4ddc71=await profile[_0x53d3b2(0x1aa)]({'email':_0x35473c['email']}),_0x2424f1={'year':'numeric','month':_0x53d3b2(0x219),'day':_0x53d3b2(0x1ea)},_0x5cce57=await master_shop['find']();console['log']('Products\x20master',_0x5cce57);const _0x50de8a=await product['find']();console[_0x53d3b2(0x227)](_0x53d3b2(0x1eb),_0x50de8a);const _0x4a1822=await warehouse[_0x53d3b2(0x103)]([{'$unwind':_0x53d3b2(0x131)},{'$lookup':{'from':_0x53d3b2(0x127),'localField':_0x53d3b2(0x226),'foreignField':_0x53d3b2(0xdc),'as':_0x53d3b2(0x20d)}},{'$unwind':_0x53d3b2(0xf9)},{'$project':{'product_name':_0x53d3b2(0x140),'product_stock':_0x53d3b2(0x154)}},{'$group':{'_id':_0x53d3b2(0x1b9),'product_stock':{'$sum':_0x53d3b2(0x239)}}}]);console[_0x53d3b2(0x227)](_0x53d3b2(0x151),_0x4a1822),_0x4a1822[_0x53d3b2(0x123)](_0xbd6471=>{const _0x279915=_0x53d3b2,_0x11fa1b=_0x50de8a[_0x279915(0x13a)](_0x12ccc4=>{const _0x127c9d=_0x279915;_0x12ccc4[_0x127c9d(0xdc)]==_0xbd6471[_0x127c9d(0x200)]&&(_0x12ccc4['stock']=parseInt(_0x12ccc4['stock'])+parseInt(_0xbd6471['product_stock']));});});const _0x4d3f7f=await staff[_0x53d3b2(0x1aa)]({'email':_0x35473c['email']});if(_0x5cce57[0x0][_0x53d3b2(0x153)]==_0x53d3b2(0x157))var _0x41b815=users[_0x53d3b2(0x145)];else{if(_0x5cce57[0x0]['language']==_0x53d3b2(0x243))var _0x41b815=users['Hindi'];else{if(_0x5cce57[0x0][_0x53d3b2(0x153)]==_0x53d3b2(0x1be))var _0x41b815=users[_0x53d3b2(0x1be)];else{if(_0x5cce57[0x0][_0x53d3b2(0x153)]=='Spanish')var _0x41b815=users[_0x53d3b2(0x246)];else{if(_0x5cce57[0x0][_0x53d3b2(0x153)]==_0x53d3b2(0xd1))var _0x41b815=users[_0x53d3b2(0xd1)];else{if(_0x5cce57[0x0][_0x53d3b2(0x153)]==_0x53d3b2(0x223))var _0x41b815=users['Portuguese'];else{if(_0x5cce57[0x0]['language']==_0x53d3b2(0x165))var _0x41b815=users[_0x53d3b2(0x165)];else{if(_0x5cce57[0x0]['language']=='Arabic\x20(ae)')var _0x41b815=users['Arabic'];}}}}}}}_0x479437[_0x53d3b2(0x21e)](_0x53d3b2(0x21f),{'success':_0x4761aa[_0x53d3b2(0x1ba)](_0x53d3b2(0x13b)),'errors':_0x4761aa[_0x53d3b2(0x1ba)](_0x53d3b2(0x23e)),'alldata':_0x50de8a,'profile':_0x4ddc71,'master_shop':_0x5cce57,'role':_0x35473c,'product_stock':_0x4a1822,'language':_0x41b815,'staff_arr':_0x4d3f7f});}catch(_0xc56c53){}});async function agentsdataDSICheck_DSRR(_0xaf6000,_0x4589fa,_0xdd4cea,_0x2a541a){const _0x57a71c=a0_0x4aeceb;let _0x297a61=new Date(_0xaf6000);_0x297a61[_0x57a71c(0x114)](_0x297a61[_0x57a71c(0x1a6)]()-0x1);let _0xba5f2d=_0x297a61[_0x57a71c(0x12b)]()[_0x57a71c(0x112)]('T')[0x0];const _0x31336c=await product[_0x57a71c(0x103)]([{'$group':{'_id':{'brand':_0x57a71c(0xd4),'category':_0x57a71c(0x163)},'products':{'$push':{'name':_0x57a71c(0x198),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x34e005=[];_0x34e005[_0x57a71c(0x180)]=[];for(let _0x2ed348=0x0;_0x2ed348<=_0x31336c[_0x57a71c(0x21d)]-0x1;_0x2ed348++){const _0x513a10=_0x31336c[_0x2ed348];_0x34e005[_0x57a71c(0x180)]['push'](_0x513a10);}const _0x179226=await product[_0x57a71c(0x103)]([{'$group':{'_id':{'category':_0x57a71c(0x163)},'products':{'$push':{'brand':_0x57a71c(0xd4),'product_code':_0x57a71c(0x15f),'product_name':_0x57a71c(0x198)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3a5b68=await product[_0x57a71c(0x103)]([{'$group':{'_id':{'category':_0x57a71c(0x163),'brand':_0x57a71c(0xd4)}}},{'$group':{'_id':_0x57a71c(0x186),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x460d38=await sales_sa[_0x57a71c(0x103)]([{'$match':{'date':_0xaf6000,'sales_staff_id':_0x4589fa,'sale_product.isFG':_0x57a71c(0x1ff)}},{'$unwind':_0x57a71c(0xcd)},{'$lookup':{'from':'products','localField':_0x57a71c(0x182),'foreignField':_0x57a71c(0x174),'as':_0x57a71c(0x126)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x57a71c(0x132),'date':_0x57a71c(0xff),'customer':_0x57a71c(0x23a),'status_data':_0x57a71c(0x197)},'totalQty':{'$sum':_0x57a71c(0x21b)},'cash':{'$first':_0x57a71c(0x21a)},'amount':{'$first':_0x57a71c(0x184)},'bank':{'$first':_0x57a71c(0x201)},'check_no':{'$first':_0x57a71c(0x203)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x57a71c(0x21b),'NetPrice':_0x57a71c(0x23d),'discount':_0x57a71c(0x24c),'adj_discount':_0x57a71c(0x117),'product_details':{'prod_name':_0x57a71c(0x10d),'product_code':'$product_info.product_code','category':_0x57a71c(0x107),'brand':'$product_info.brand','gross_price':'$product_info.gross_price','isFG':_0x57a71c(0x1e1),'prod_cat':'$sale_product.prod_cat','prod_id':_0x57a71c(0x23c)}}}}},{'$unwind':_0x57a71c(0x235)},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x57a71c(0x170),'status_data':_0x57a71c(0x166),'category':_0x57a71c(0x1fb),'brand':'$products.product_details.brand','prod_id':_0x57a71c(0x22c)},'totalQty':{'$sum':_0x57a71c(0x1ab)},'totalGross':{'$sum':{'$multiply':[_0x57a71c(0x1ab),_0x57a71c(0xcf)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x57a71c(0xf6)},'adj_discount':{'$sum':_0x57a71c(0x141)},'cash':{'$first':_0x57a71c(0x21a)},'amount':{'$first':_0x57a71c(0x184)},'bank':{'$first':_0x57a71c(0x201)},'check_no':{'$first':_0x57a71c(0x203)},'due_date':{'$first':_0x57a71c(0xe3)},'product_details':{'$first':_0x57a71c(0x191)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x57a71c(0x18d),'customer':_0x57a71c(0x170),'status_data':'$_id.status_data'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x57a71c(0xfc)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x57a71c(0xed)},'adj_discount':{'$sum':_0x57a71c(0x1e9)},'cash':{'$first':_0x57a71c(0x21a)},'amount':{'$first':_0x57a71c(0x184)},'bank':{'$first':_0x57a71c(0x201)},'check_no':{'$first':_0x57a71c(0x203)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x57a71c(0x1a4),'category':_0x57a71c(0x186),'brand':_0x57a71c(0x17a),'product_details':_0x57a71c(0x131)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xd2d4a7=await sales_sa[_0x57a71c(0x103)]([{'$match':{'date':_0xba5f2d,'sales_staff_id':_0x4589fa,'sale_product.isFG':_0x57a71c(0x1ff)}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x57a71c(0x127),'localField':_0x57a71c(0x182),'foreignField':'product_code','as':_0x57a71c(0x126)}},{'$unwind':_0x57a71c(0x1a8)},{'$group':{'_id':{'dsi':_0x57a71c(0x132),'date':_0x57a71c(0xff),'customer':_0x57a71c(0x23a)},'totalQty':{'$sum':_0x57a71c(0x21b)},'cash':{'$first':_0x57a71c(0x21a)},'amount':{'$first':'$amount'},'bank':{'$first':_0x57a71c(0x201)},'check_no':{'$first':_0x57a71c(0x203)},'due_date':{'$first':_0x57a71c(0xe3)},'products':{'$push':{'qty':_0x57a71c(0x21b),'NetPrice':_0x57a71c(0x23d),'discount':_0x57a71c(0x24c),'adj_discount':_0x57a71c(0x117),'product_details':{'prod_name':_0x57a71c(0x10d),'product_code':'$product_info.product_code','category':_0x57a71c(0x107),'brand':_0x57a71c(0x220),'gross_price':'$product_info.gross_price','isFG':'$sale_product.isFG','prod_cat':_0x57a71c(0xf1),'prod_id':_0x57a71c(0x23c)}}}}},{'$unwind':_0x57a71c(0x235)},{'$group':{'_id':{'dsi':_0x57a71c(0x1bb),'date':_0x57a71c(0x18d),'customer':_0x57a71c(0x170),'category':_0x57a71c(0x1fb),'brand':_0x57a71c(0x1e8),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x57a71c(0x1ab)},'cash':{'$first':_0x57a71c(0x21a)},'amount':{'$first':_0x57a71c(0x184)},'bank':{'$first':_0x57a71c(0x201)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x57a71c(0xe3)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x57a71c(0xcf)]}},'NetPrice':{'$sum':_0x57a71c(0x21c)},'discount':{'$sum':_0x57a71c(0xf6)},'adj_discount':{'$sum':_0x57a71c(0x141)},'product_details':{'$first':_0x57a71c(0x191)}}},{'$group':{'_id':{'dsi':_0x57a71c(0x1bb),'date':_0x57a71c(0x18d),'customer':_0x57a71c(0x170)},'totalQty':{'$sum':_0x57a71c(0x1a4)},'cash':{'$first':'$cash'},'amount':{'$first':_0x57a71c(0x184)},'bank':{'$first':_0x57a71c(0x201)},'check_no':{'$first':_0x57a71c(0x203)},'due_date':{'$first':_0x57a71c(0xe3)},'totalGross':{'$sum':_0x57a71c(0xfc)},'NetPrice':{'$sum':_0x57a71c(0x143)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x57a71c(0x1a4),'category':_0x57a71c(0x186),'brand':_0x57a71c(0x17a),'product_details':_0x57a71c(0x131)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x392103=await sales_sa['aggregate']([{'$match':{'date':_0xaf6000,'sales_staff_id':_0x4589fa,'status_data':_0x57a71c(0x1ec)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x7f049d=await staff[_0x57a71c(0x1a0)](_0x4589fa);let _0x2b200e=[],_0x5677a5={},_0x12f18a={};var _0x586c3b=0x0,_0x330856=0x0,_0x44f385=0x0,_0xa7a514=0x0,_0x1ab266=0x0;const _0x5a890c=0x6;var _0xf62737=0x0,_0x117a2e=0x0;for(let _0x4b0e24=0x0;_0x4b0e24<=_0x460d38['length']-0x1;_0x4b0e24++){const _0x253b15=_0x460d38[_0x4b0e24];let _0x3e92dc='<tr>';_0x3e92dc+=_0x57a71c(0x1f9),_0x3e92dc+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x253b15[_0x57a71c(0x200)]['customer']+_0x57a71c(0x232),_0x3e92dc+=_0x57a71c(0x118)+_0x253b15[_0x57a71c(0x200)][_0x57a71c(0x214)]+_0x57a71c(0x232);let _0xd0ebf4={},_0x497bff={},_0x5237c7={};var _0x744a19={},_0x4c6127={},_0x82f77f={},_0x4ed240=0x0;for(let _0x44d23c=0x0;_0x44d23c<=_0x253b15[_0x57a71c(0x127)][_0x57a71c(0x21d)]-0x1;_0x44d23c++){const _0x1dace7=_0x253b15[_0x57a71c(0x127)][_0x44d23c];_0xd0ebf4[_0x1dace7[_0x57a71c(0x1d1)]+'-'+_0x1dace7[_0x57a71c(0x216)]]=_0x1dace7['qty'],_0x497bff[[_0x1dace7[_0x57a71c(0x1d1)]+'-'+_0x1dace7[_0x57a71c(0x216)]]]=_0x1dace7['product_details'][_0x57a71c(0x1a5)],_0x5237c7[[_0x1dace7[_0x57a71c(0x1d1)]+'-'+_0x1dace7[_0x57a71c(0x216)]]]=_0x1dace7[_0x57a71c(0x1dd)][_0x57a71c(0x217)];const _0x141bcd=_0x1dace7[_0x57a71c(0x1d1)]+'-'+_0x1dace7[_0x57a71c(0x216)];!Array[_0x57a71c(0x1e5)](_0x12f18a[_0x141bcd])&&(_0x12f18a[_0x141bcd]=[]);!Array[_0x57a71c(0x1e5)](_0x12f18a[_0x141bcd])&&(_0x12f18a[_0x141bcd]=[]);_0x12f18a[_0x141bcd][_0x57a71c(0xfb)](_0x1dace7[_0x57a71c(0x234)]);if(_0x1dace7[_0x57a71c(0x1dd)]['prod_cat']=='P')_0x1dace7['product_details'][_0x57a71c(0x1a5)]==_0x57a71c(0x1ec)?(!_0x82f77f[_0x141bcd]&&(_0x82f77f[_0x141bcd]=0x0),_0x82f77f[_0x141bcd]=_0x1dace7[_0x57a71c(0x234)]):(!_0x744a19[_0x141bcd]&&(_0x744a19[_0x141bcd]=0x0),_0x744a19[_0x141bcd]=_0x1dace7['qty']);else _0x1dace7[_0x57a71c(0x1dd)][_0x57a71c(0x217)]=='S'&&(_0x1dace7[_0x57a71c(0x1dd)][_0x57a71c(0x1a5)]==_0x57a71c(0x1ec)?(!_0x82f77f[_0x141bcd]&&(_0x82f77f[_0x141bcd]=0x0),_0x82f77f[_0x141bcd]=_0x1dace7[_0x57a71c(0x234)]):(!_0x4c6127[_0x141bcd]&&(_0x4c6127[_0x141bcd]=0x0),_0x4c6127[_0x141bcd]=_0x1dace7[_0x57a71c(0x234)]));_0x4ed240++;}for(let _0x33caed=0x0;_0x33caed<=_0x34e005[_0x57a71c(0x180)][_0x57a71c(0x21d)]-0x1;_0x33caed++){const _0x23881b=_0x34e005['cat_brand'][_0x33caed],_0x22527f=_0x23881b[_0x57a71c(0x200)]['brand']+'-'+_0x23881b[_0x57a71c(0x200)]['category'],_0x45190e=_0x5237c7[_0x22527f]!==undefined?_0x5237c7[_0x22527f]:'NA';var _0x15ffe6=_0x744a19[_0x22527f]!==undefined?_0x744a19[_0x22527f][_0x57a71c(0x15a)](0x2):'',_0xbc1c72=_0x4c6127[_0x22527f]!==undefined?_0x4c6127[_0x22527f][_0x57a71c(0x15a)](0x2):'',_0x2f3164=_0x82f77f[_0x22527f]!==undefined?_0x82f77f[_0x22527f]['toFixed'](0x2):'';_0x3e92dc+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x15ffe6+_0x57a71c(0x232),_0x3e92dc+=_0x57a71c(0x1f0)+_0xbc1c72+_0x57a71c(0x232),_0x3e92dc+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x2f3164+_0x57a71c(0x232);}var _0x5a3278=formatNumber(parseFloat(_0x253b15[_0x57a71c(0x142)])),_0x32059c=formatNumber(parseFloat(_0x253b15[_0x57a71c(0xd7)]));isNaN(_0x32059c)&&(_0x32059c=0x0),_0x3e92dc+=_0x57a71c(0x1f0)+_0x5a3278+_0x57a71c(0x232),_0x3e92dc+=_0x57a71c(0x1f0)+_0x32059c+_0x57a71c(0x232),_0x3e92dc+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x253b15['bank']+_0x57a71c(0x232),_0x3e92dc+=_0x57a71c(0x118)+_0x253b15[_0x57a71c(0x1bd)]+_0x57a71c(0x232),_0x3e92dc+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x253b15[_0x57a71c(0x168)]+_0x57a71c(0x232),_0x44f385=_0x253b15[_0x57a71c(0x102)]+_0x253b15[_0x57a71c(0x137)],_0xf62737+=parseFloat(_0x253b15[_0x57a71c(0x142)]),_0x117a2e+=parseFloat(_0x32059c),_0x2b200e[_0x57a71c(0xfb)](_0x3e92dc);}if(_0x392103[_0x57a71c(0x21d)]>0x0)for(let _0x38ee27=0x0;_0x38ee27<=_0x392103[_0x57a71c(0x21d)]-0x1;_0x38ee27++){const _0x4c8f69=_0x392103[_0x38ee27];console[_0x57a71c(0x227)](_0x4c8f69);let _0x35f923=_0x57a71c(0x1cf);_0x35f923+=_0x57a71c(0x15d)+(0x8+0x7*0x3)+_0x57a71c(0x1f3)+_0x4c8f69[_0x57a71c(0xd2)]+_0x57a71c(0x231),_0x35f923+='</tr>',_0x2b200e[_0x57a71c(0xfb)](_0x35f923);}function _0x186e1c(_0x21444e,_0x730883){const _0x418d07=_0x57a71c,_0x1db093=[];for(let _0x3e4391=0x0;_0x3e4391<=_0x21444e[_0x418d07(0x21d)]-0x1;_0x3e4391+=_0x730883){_0x1db093[_0x418d07(0xfb)](_0x21444e[_0x418d07(0x213)](_0x3e4391,_0x3e4391+_0x730883));}return _0x1db093;}const _0x436325=_0x186e1c(_0x2b200e,_0x5a890c);let _0x163461='';return _0x436325[_0x57a71c(0x123)]((_0x170112,_0x28cd1b)=>{const _0x1e6133=_0x57a71c;_0x28cd1b>0x0&&(_0x163461+=_0x1e6133(0x212));_0x163461+=_0x1e6133(0x1cb),_0x163461+=_0x1e6133(0x12c);const _0xfedb8=new Date(_0xaf6000),_0x7689da={'year':_0x1e6133(0x1ea),'month':_0x1e6133(0x219),'day':'numeric','timeZone':'Asia/Manila'},_0x201c19=_0xfedb8[_0x1e6133(0x116)](_0x1e6133(0xd9),_0x7689da);_0x163461+='<tr>',_0x163461+=_0x1e6133(0x211)+_0x2a541a+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1cf),_0x163461+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0x7f049d['name']+_0x1e6133(0x232),_0x163461+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>',_0x163461+=_0x1e6133(0x1d8),_0x163461+=_0x1e6133(0x113),_0x163461+=_0x1e6133(0xef),_0x163461+=_0x1e6133(0x22d),_0x163461+=_0x1e6133(0x181),_0x163461+=_0x1e6133(0xd3),_0x163461+=_0x1e6133(0x195),_0x163461+=_0x1e6133(0x10f),_0x163461+='<tr>',_0x163461+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x163461+=_0x1e6133(0x1f1)+_0x201c19+_0x1e6133(0x232),_0x163461+=_0x1e6133(0x1f5),_0x163461+=_0x1e6133(0x24e),_0x163461+=_0x1e6133(0x14e),_0x163461+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x163461+=_0x1e6133(0x10f),_0x163461+='<tr>',_0x163461+=_0x1e6133(0xe8),_0x163461+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>',_0x163461+=_0x1e6133(0x24b),_0x163461+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x163461+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1cf),_0x163461+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x163461+='</tr>',_0x163461+=_0x1e6133(0x1cf),_0x163461+=_0x1e6133(0xfd),_0x163461+=_0x1e6133(0xda),_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1cf),_0x163461+=_0x1e6133(0xe1),_0x163461+=_0x1e6133(0x17b),_0x163461+=_0x1e6133(0x16b);for(let _0x231c9d=0x0;_0x231c9d<=_0x179226[_0x1e6133(0x21d)]-0x1;_0x231c9d++){const _0xcc0558=_0x179226[_0x231c9d];for(let _0x49d138=0x0;_0x49d138<_0x34e005[_0x1e6133(0x180)][_0x1e6133(0x21d)];_0x49d138++){const _0x15b6d9=_0x34e005[_0x1e6133(0x180)][_0x49d138];if(_0x15b6d9[_0x1e6133(0x200)][_0x1e6133(0x216)]===_0xcc0558[_0x1e6133(0x200)][_0x1e6133(0x216)]){var _0xcca7c7='';switch(_0xcc0558[_0x1e6133(0x200)]['category']){case'Standard':_0xcca7c7=_0x15b6d9[_0x1e6133(0x200)][_0x1e6133(0x1d1)]+_0x1e6133(0x13e);break;case _0x1e6133(0xe9):_0xcca7c7=_0x15b6d9[_0x1e6133(0x200)][_0x1e6133(0x1d1)]+_0x1e6133(0x1d9);break;default:_0xcca7c7=_0x15b6d9[_0x1e6133(0x200)][_0x1e6133(0x1d1)];break;}_0x163461+=_0x1e6133(0x16c)+_0xcca7c7+_0x1e6133(0x231);}}}_0x163461+=_0x1e6133(0x1a3),_0x163461+=_0x1e6133(0x10e),_0x163461+=_0x1e6133(0x185),_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1cf),_0x163461+=_0x1e6133(0x160);for(let _0x41d0d6=0x0;_0x41d0d6<=_0x34e005['cat_brand'][_0x1e6133(0x21d)]-0x1;_0x41d0d6++){const _0x362def=_0x34e005[_0x41d0d6];_0x163461+=_0x1e6133(0x125),_0x163461+='<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>',_0x163461+=_0x1e6133(0x221);}_0x163461+=_0x1e6133(0x1f8),_0x163461+=_0x1e6133(0x19c),_0x163461+=_0x1e6133(0x1c7),_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1fa),_0x163461+=_0x1e6133(0xc8),_0x170112[_0x1e6133(0x123)](_0x1c448d=>{_0x163461+=_0x1c448d;});let _0x2829e0={},_0x52002e={},_0x354180={};for(let _0x3dc51d=0x0;_0x3dc51d<=_0x460d38[_0x1e6133(0x21d)]-0x1;_0x3dc51d++){const _0xc027f9=_0x460d38[_0x3dc51d];var _0x42e06e=0x0;for(let _0x56ffe8=0x0;_0x56ffe8<=_0xc027f9['products'][_0x1e6133(0x21d)]-0x1;_0x56ffe8++){const _0x27ef0d=_0xc027f9['products'][_0x56ffe8],_0x5b9f0d=_0x27ef0d[_0x1e6133(0x1d1)]+'-'+_0x27ef0d[_0x1e6133(0x216)];if(_0x27ef0d[_0x1e6133(0x1dd)][_0x1e6133(0x217)]=='P')_0x27ef0d[_0x1e6133(0x1dd)]['isFG']==_0x1e6133(0x1ec)?(!_0x354180[_0x5b9f0d]&&(_0x354180[_0x5b9f0d]=0x0),_0x354180[_0x5b9f0d]+=_0x27ef0d['qty']):(!_0x2829e0[_0x5b9f0d]&&(_0x2829e0[_0x5b9f0d]=0x0),_0x2829e0[_0x5b9f0d]+=_0x27ef0d[_0x1e6133(0x234)]);else _0x27ef0d[_0x1e6133(0x1dd)]['prod_cat']=='S'&&(_0x27ef0d[_0x1e6133(0x1dd)][_0x1e6133(0x1a5)]==_0x1e6133(0x1ec)?(!_0x354180[_0x5b9f0d]&&(_0x354180[_0x5b9f0d]=0x0),_0x354180[_0x5b9f0d]+=_0x27ef0d['qty'],console[_0x1e6133(0x227)](_0x27ef0d[_0x1e6133(0x234)])):(!_0x52002e[_0x5b9f0d]&&(_0x52002e[_0x5b9f0d]=0x0),_0x52002e[_0x5b9f0d]+=_0x27ef0d[_0x1e6133(0x234)]));_0x42e06e++;}}let _0x39a850={},_0x4a445d={},_0x18d5ac={};var _0x34f551=0x0,_0x4936ca=0x0;for(let _0x351aa2=0x0;_0x351aa2<=_0xd2d4a7[_0x1e6133(0x21d)]-0x1;_0x351aa2++){const _0x539796=_0xd2d4a7[_0x351aa2];var _0x42e06e=0x0;for(let _0xdce344=0x0;_0xdce344<=_0x539796[_0x1e6133(0x127)]['length']-0x1;_0xdce344++){const _0x327360=_0x539796[_0x1e6133(0x127)][_0xdce344],_0x46e5b7=_0x327360[_0x1e6133(0x1d1)]+'-'+_0x327360[_0x1e6133(0x216)];if(_0x327360[_0x1e6133(0x1dd)][_0x1e6133(0x217)]=='P')_0x327360[_0x1e6133(0x1dd)]['isFG']==_0x1e6133(0x1ec)?(!_0x18d5ac[_0x46e5b7]&&(_0x18d5ac[_0x46e5b7]=0x0),_0x18d5ac[_0x46e5b7]+=_0x327360[_0x1e6133(0x234)]):(!_0x39a850[_0x46e5b7]&&(_0x39a850[_0x46e5b7]=0x0),_0x39a850[_0x46e5b7]+=_0x327360['qty']);else _0x327360[_0x1e6133(0x1dd)][_0x1e6133(0x217)]=='S'&&(_0x327360[_0x1e6133(0x1dd)][_0x1e6133(0x1a5)]=='true'?(!_0x18d5ac[_0x46e5b7]&&(_0x18d5ac[_0x46e5b7]=0x0),_0x18d5ac[_0x46e5b7]+=_0x327360[_0x1e6133(0x234)]):(!_0x4a445d[_0x46e5b7]&&(_0x4a445d[_0x46e5b7]=0x0),_0x4a445d[_0x46e5b7]+=_0x327360[_0x1e6133(0x234)]));_0x42e06e++;}var _0x36eec8=parseFloat(_0x539796[_0x1e6133(0x142)]),_0x125719=parseFloat(_0x539796[_0x1e6133(0xd7)]);isNaN(_0x125719)&&(_0x125719=0x0),_0x34f551+=_0x36eec8,_0x4936ca+=_0x125719;}_0x163461+=_0x1e6133(0x1cf),_0x163461+=_0x1e6133(0x119),_0x163461+=_0x1e6133(0x1da),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x53200c=0x0;_0x53200c<=_0x34e005[_0x1e6133(0x180)][_0x1e6133(0x21d)]-0x1;_0x53200c++){const _0x23861b=_0x34e005[_0x1e6133(0x180)][_0x53200c],_0x4a01f2=_0x23861b[_0x1e6133(0x200)][_0x1e6133(0x1d1)]+'-'+_0x23861b['_id']['category'];var _0x141518=_0x2829e0[_0x4a01f2]!==undefined?formatNumber(_0x2829e0[_0x4a01f2][_0x1e6133(0x15a)](0x2)):'',_0xa49f8=_0x354180[_0x4a01f2]!==undefined?formatNumber(_0x354180[_0x4a01f2][_0x1e6133(0x15a)](0x2)):'',_0x18fdf7=_0x52002e[_0x4a01f2]!==undefined?formatNumber(_0x52002e[_0x4a01f2][_0x1e6133(0x15a)](0x2)):'';_0x163461+=_0x1e6133(0x11a)+_0x141518+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+_0x18fdf7+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+_0xa49f8+'</b></td>';}_0x163461+=_0x1e6133(0x11a)+formatNumber(_0xf62737)+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+formatNumber(_0x117a2e)+'</b></td>',_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1cf),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x163461+=_0x1e6133(0x1a9),_0x163461+=_0x1e6133(0x1f9);for(let _0x5714f5=0x0;_0x5714f5<=_0x34e005[_0x1e6133(0x180)][_0x1e6133(0x21d)]-0x1;_0x5714f5++){const _0x491d51=_0x34e005[_0x1e6133(0x180)][_0x5714f5],_0x13874a=_0x491d51['_id'][_0x1e6133(0x1d1)]+'-'+_0x491d51[_0x1e6133(0x200)][_0x1e6133(0x216)];var _0x141518=_0x39a850[_0x13874a]!==undefined?formatNumber(_0x39a850[_0x13874a][_0x1e6133(0x15a)](0x2)):'',_0xa49f8=_0x18d5ac[_0x13874a]!==undefined?formatNumber(_0x18d5ac[_0x13874a][_0x1e6133(0x15a)](0x2)):'',_0x18fdf7=_0x4a445d[_0x13874a]!==undefined?formatNumber(_0x4a445d[_0x13874a][_0x1e6133(0x15a)](0x2)):'';_0x163461+=_0x1e6133(0x11a)+_0x141518+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+_0x18fdf7+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+_0xa49f8+_0x1e6133(0x231);}_0x163461+=_0x1e6133(0x11a)+formatNumber(_0x34f551)+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+formatNumber(_0x4936ca)+'</b></td>',_0x163461+=_0x1e6133(0x1f9),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1cf),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x163461+=_0x1e6133(0x1c1),_0x163461+=_0x1e6133(0x1f9);let _0x3810a5=0x0,_0x4e5982=0x0,_0x410c65=0x0;for(let _0x118910=0x0;_0x118910<=_0x34e005[_0x1e6133(0x180)]['length']-0x1;_0x118910++){const _0x4e2fd8=_0x34e005['cat_brand'][_0x118910],_0x597dbb=_0x4e2fd8[_0x1e6133(0x200)]['brand']+'-'+_0x4e2fd8[_0x1e6133(0x200)]['category'];var _0x1d443a=_0x2829e0[_0x597dbb]!==undefined?_0x2829e0[_0x597dbb]['toFixed'](0x2):'0',_0x5e3a3d=_0x354180[_0x597dbb]!==undefined?_0x354180[_0x597dbb]['toFixed'](0x2):'0',_0xfa0ab5=_0x52002e[_0x597dbb]!==undefined?_0x52002e[_0x597dbb][_0x1e6133(0x15a)](0x2):'0',_0x33fc29=_0x39a850[_0x597dbb]!==undefined?_0x39a850[_0x597dbb][_0x1e6133(0x15a)](0x2):'0',_0x33cba8=_0x18d5ac[_0x597dbb]!==undefined?_0x18d5ac[_0x597dbb][_0x1e6133(0x15a)](0x2):'0',_0x3759ed=_0x4a445d[_0x597dbb]!==undefined?_0x4a445d[_0x597dbb][_0x1e6133(0x15a)](0x2):'0';_0x3810a5=parseFloat(_0x1d443a)+parseFloat(_0x33fc29),_0x4e5982=parseFloat(_0xfa0ab5)+parseFloat(_0x3759ed),_0x410c65=parseFloat(_0x5e3a3d)+parseFloat(_0x33cba8),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3810a5[_0x1e6133(0x15a)](0x2))+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+formatNumber(_0x4e5982[_0x1e6133(0x15a)](0x2))+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+formatNumber(_0x410c65[_0x1e6133(0x15a)](0x2))+_0x1e6133(0x231);}var _0x1bce36=formatNumber(_0xf62737+_0x34f551),_0x108832=formatNumber(_0x117a2e+_0x4936ca);_0x163461+=_0x1e6133(0x11a)+_0x1bce36+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+_0x108832+'</b></td>',_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x163461+=_0x1e6133(0x1f9),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x163461+='</tr>',_0x163461+=_0x1e6133(0x1cf),_0x163461+=_0x1e6133(0x1db)+(_0x34e005[_0x1e6133(0x180)][_0x1e6133(0x21d)]*0x3+0x9)+'\x22><b></b></td>',_0x163461+='</tr>',_0x163461+=_0x1e6133(0x1cf),_0x163461+=_0x1e6133(0x119),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x163461+=_0x1e6133(0x1f9);for(let _0x1bcc86=0x0;_0x1bcc86<=_0x34e005[_0x1e6133(0x180)][_0x1e6133(0x21d)]-0x1;_0x1bcc86++){const _0x523143=_0x34e005[_0x1e6133(0x180)][_0x1bcc86],_0x1d3085=_0x523143[_0x1e6133(0x200)][_0x1e6133(0x1d1)]+'-'+_0x523143['_id'][_0x1e6133(0x216)];var _0x1d443a=_0x2829e0[_0x1d3085]!==undefined?_0x2829e0[_0x1d3085][_0x1e6133(0x15a)](0x2):'0',_0x5e3a3d=_0x354180[_0x1d3085]!==undefined?_0x354180[_0x1d3085][_0x1e6133(0x15a)](0x2):'0',_0xfa0ab5=_0x52002e[_0x1d3085]!==undefined?_0x52002e[_0x1d3085]['toFixed'](0x2):'0',_0x33fc29=_0x39a850[_0x1d3085]!==undefined?_0x39a850[_0x1d3085][_0x1e6133(0x15a)](0x2):'0',_0x33cba8=_0x18d5ac[_0x1d3085]!==undefined?_0x18d5ac[_0x1d3085][_0x1e6133(0x15a)](0x2):'0',_0x3759ed=_0x4a445d[_0x1d3085]!==undefined?_0x4a445d[_0x1d3085][_0x1e6133(0x15a)](0x2):'0';_0x3810a5=parseFloat(_0x1d443a)+parseFloat(_0x33fc29),_0x4e5982=parseFloat(_0xfa0ab5)+parseFloat(_0x3759ed),_0x410c65=parseFloat(_0x5e3a3d)+parseFloat(_0x33cba8),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x163461+=_0x1e6133(0xdd);}_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1cf),_0x163461+=_0x1e6133(0x119),_0x163461+=_0x1e6133(0x11d),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x3cb2a9=0x0;_0x3cb2a9<=_0x34e005['cat_brand'][_0x1e6133(0x21d)]-0x1;_0x3cb2a9++){const _0x16a089=_0x34e005[_0x1e6133(0x180)][_0x3cb2a9],_0x119b2d=_0x16a089[_0x1e6133(0x200)][_0x1e6133(0x1d1)]+'-'+_0x16a089[_0x1e6133(0x200)]['category'];var _0x1d443a=_0x2829e0[_0x119b2d]!==undefined?_0x2829e0[_0x119b2d][_0x1e6133(0x15a)](0x2):'0',_0x5e3a3d=_0x354180[_0x119b2d]!==undefined?_0x354180[_0x119b2d][_0x1e6133(0x15a)](0x2):'0',_0xfa0ab5=_0x52002e[_0x119b2d]!==undefined?_0x52002e[_0x119b2d][_0x1e6133(0x15a)](0x2):'0',_0x33fc29=_0x39a850[_0x119b2d]!==undefined?_0x39a850[_0x119b2d][_0x1e6133(0x15a)](0x2):'0',_0x33cba8=_0x18d5ac[_0x119b2d]!==undefined?_0x18d5ac[_0x119b2d][_0x1e6133(0x15a)](0x2):'0',_0x3759ed=_0x4a445d[_0x119b2d]!==undefined?_0x4a445d[_0x119b2d][_0x1e6133(0x15a)](0x2):'0';_0x3810a5=parseFloat(_0x1d443a)+parseFloat(_0x33fc29),_0x4e5982=parseFloat(_0xfa0ab5)+parseFloat(_0x3759ed),_0x410c65=parseFloat(_0x5e3a3d)+parseFloat(_0x33cba8),_0x163461+=_0x1e6133(0xdd),_0x163461+=_0x1e6133(0xdd),_0x163461+=_0x1e6133(0xdd);}_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x10f),_0x163461+='<tr>',_0x163461+=_0x1e6133(0x119),_0x163461+=_0x1e6133(0x12a),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x2da996=0x0;_0x2da996<=_0x34e005[_0x1e6133(0x180)][_0x1e6133(0x21d)]-0x1;_0x2da996++){const _0x5a9f19=_0x34e005['cat_brand'][_0x2da996],_0x246e71=_0x5a9f19[_0x1e6133(0x200)][_0x1e6133(0x1d1)]+'-'+_0x5a9f19[_0x1e6133(0x200)][_0x1e6133(0x216)];var _0x1d443a=_0x2829e0[_0x246e71]!==undefined?_0x2829e0[_0x246e71][_0x1e6133(0x15a)](0x2):'0',_0x5e3a3d=_0x354180[_0x246e71]!==undefined?_0x354180[_0x246e71][_0x1e6133(0x15a)](0x2):'0',_0xfa0ab5=_0x52002e[_0x246e71]!==undefined?_0x52002e[_0x246e71][_0x1e6133(0x15a)](0x2):'0',_0x33fc29=_0x39a850[_0x246e71]!==undefined?_0x39a850[_0x246e71][_0x1e6133(0x15a)](0x2):'0',_0x33cba8=_0x18d5ac[_0x246e71]!==undefined?_0x18d5ac[_0x246e71][_0x1e6133(0x15a)](0x2):'0',_0x3759ed=_0x4a445d[_0x246e71]!==undefined?_0x4a445d[_0x246e71][_0x1e6133(0x15a)](0x2):'0';_0x3810a5=parseFloat(_0x1d443a)+parseFloat(_0x33fc29),_0x4e5982=parseFloat(_0xfa0ab5)+parseFloat(_0x3759ed),_0x410c65=parseFloat(_0x5e3a3d)+parseFloat(_0x33cba8),_0x163461+=_0x1e6133(0xdd),_0x163461+=_0x1e6133(0xdd),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1cf),_0x163461+=_0x1e6133(0x119),_0x163461+=_0x1e6133(0x1da),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x1795a3=0x0;_0x1795a3<=_0x34e005[_0x1e6133(0x180)]['length']-0x1;_0x1795a3++){const _0x7750c2=_0x34e005[_0x1e6133(0x180)][_0x1795a3],_0xae765b=_0x7750c2[_0x1e6133(0x200)]['brand']+'-'+_0x7750c2[_0x1e6133(0x200)][_0x1e6133(0x216)];var _0x1d443a=_0x2829e0[_0xae765b]!==undefined?_0x2829e0[_0xae765b]['toFixed'](0x2):'',_0x5e3a3d=_0x354180[_0xae765b]!==undefined?_0x354180[_0xae765b][_0x1e6133(0x15a)](0x2):'',_0xfa0ab5=_0x52002e[_0xae765b]!==undefined?_0x52002e[_0xae765b][_0x1e6133(0x15a)](0x2):'',_0x33fc29=_0x39a850[_0xae765b]!==undefined?_0x39a850[_0xae765b][_0x1e6133(0x15a)](0x2):'',_0x33cba8=_0x18d5ac[_0xae765b]!==undefined?_0x18d5ac[_0xae765b][_0x1e6133(0x15a)](0x2):'',_0x3759ed=_0x4a445d[_0xae765b]!==undefined?_0x4a445d[_0xae765b]['toFixed'](0x2):'';_0x3810a5=formatNumber(parseFloat(_0x1d443a)+parseFloat(_0x33fc29)),_0x4e5982=formatNumber(parseFloat(_0xfa0ab5)+parseFloat(_0x3759ed)),_0x410c65=formatNumber(parseFloat(_0x5e3a3d)+parseFloat(_0x33cba8)),_0x163461+=_0x1e6133(0x11a)+_0x1d443a+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+_0xfa0ab5+_0x1e6133(0x231),_0x163461+=_0x1e6133(0x11a)+_0x5e3a3d+_0x1e6133(0x231);}_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x10f),_0x163461+=_0x1e6133(0x1cf),_0x163461+=_0x1e6133(0x119),_0x163461+=_0x1e6133(0x20a),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x4f848d=0x0;_0x4f848d<=_0x34e005[_0x1e6133(0x180)][_0x1e6133(0x21d)]-0x1;_0x4f848d++){const _0x3acd98=_0x34e005[_0x1e6133(0x180)][_0x4f848d],_0x3efba8=_0x3acd98['_id']['brand']+'-'+_0x3acd98[_0x1e6133(0x200)][_0x1e6133(0x216)];var _0x1d443a=_0x2829e0[_0x3efba8]!==undefined?_0x2829e0[_0x3efba8][_0x1e6133(0x15a)](0x2):'0',_0x5e3a3d=_0x354180[_0x3efba8]!==undefined?_0x354180[_0x3efba8][_0x1e6133(0x15a)](0x2):'0',_0xfa0ab5=_0x52002e[_0x3efba8]!==undefined?_0x52002e[_0x3efba8][_0x1e6133(0x15a)](0x2):'0',_0x33fc29=_0x39a850[_0x3efba8]!==undefined?_0x39a850[_0x3efba8][_0x1e6133(0x15a)](0x2):'0',_0x33cba8=_0x18d5ac[_0x3efba8]!==undefined?_0x18d5ac[_0x3efba8]['toFixed'](0x2):'0',_0x3759ed=_0x4a445d[_0x3efba8]!==undefined?_0x4a445d[_0x3efba8][_0x1e6133(0x15a)](0x2):'0';_0x3810a5=parseFloat(_0x1d443a)+parseFloat(_0x33fc29),_0x4e5982=parseFloat(_0xfa0ab5)+parseFloat(_0x3759ed),_0x410c65=parseFloat(_0x5e3a3d)+parseFloat(_0x33cba8),_0x163461+=_0x1e6133(0xdd),_0x163461+=_0x1e6133(0xdd),_0x163461+=_0x1e6133(0xdd);}_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x1f9),_0x163461+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x163461+=_0x1e6133(0x1f9),_0x163461+=_0x1e6133(0x10f),_0x163461+='</tbody>',_0x163461+=_0x1e6133(0x164);}),_0x163461;}function a0_0x5d99(){const _0x3f0da5=['<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','top','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<table>','../middleware/auth','<th\x20colspan=\x272\x27>SOLD</th>','Error\x20generating\x20PDF','<tr>','express/lib/response','brand','totalQTY','attachment;\x20filename=\x22reports.xlsx\x22','border-bottom','859940XbZxlw','blob-stream','<th\x20rowspan=\x272\x27>Production</th>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','\x20-\x20HH','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','book_append_sheet','product_details','Sales\x20Report','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','border-left','$sale_product.isFG','multer','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','salesman_data','isArray','<td\x20class=\x22cat_data\x22>','balanced','$products.product_details.brand','$adj_discount','numeric','Products\x20find_data','true','dsi_sales','sumqty','trim','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','load','\x22><b>','jsbarcode','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','border-top','/agent_reports/pdf_admin','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','</thead>','$products.product_details.category','<th>\x20BEG\x20BALANCE\x20</th>','<p>SALES\x20REPORTS</p>','/dl_excel','false','_id','$bank','Portuguese','$check_no','</th>','/agent_reports/view','$sales_staff_id','totalQTYsum','Content-Type','/agent_reports/pdf','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','60mm','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','product_docs','Router','bottom','<th\x20rowspan=\x272\x27>Category</th>','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','<div\x20style=\x22page-break-before:\x20always;\x22></div>','slice','dsi','$product_list.product_name','category','prod_cat','staffs','long','$cash','$sale_product.real_qty_unit_val','$products.NetPrice','length','render','dssr_view','$product_info.brand','<td\x20class=\x22cat_data\x22><b>FG</b></td>','each','Portuguese\x20(BR)','$product_info.gross_price','aoa_to_sheet','product_details.product_name','log','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','../models/all_models','dataqty','$products.product_details.prod_id','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','totalPrice','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','0.1in','</b></td>','</td>','<td\x20class=\x22row_data\x22><b>','qty','$products','medium','colspan','Arabic\x20(ae)','$product_stock','$customer','post','$sale_product._id','$sale_product.totalprice','errors','$sale_product.product_name','<div\x20class=\x22row\x22>','No\x20data\x20was\x20Found!','<td\x20class=\x22cat_data\x22></td>','Hindi','path','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','Spanish','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','75JkWPQR','date','application/pdf','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','$sale_product.discount','<div\x20\x20id=\x22table-conatainer\x22>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','<td\x20colspan=\x22','$sales_info','status','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','rowspan','<tbody>','replace','sales_bkg','create','8oJaGqi','$sale_product','<p>','$products.product_details.gross_price','json','French','note','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','$brand','write','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','amount','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','en-US','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','window.onload\x20=\x20function()\x20{','name','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','border-right','/dsrr/pdf','$product_info.product_code','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','<div\x20class=\x22col-sm-11\x22>','$due_date','includes','<th>\x20ITEM\x20CODE\x20</th>','123024KaCLzP','book_new','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','Household','canvas','toStream','<th>\x20QTY\x20SOLD\x20</th>','$discount','stock','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','body','$sale_product.prod_cat','totalQty','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','html','find','$products.discount','error','td,\x20th','$product_docs','window.print();','push','$totalGross','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','$date','</tbody>','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','discount','aggregate','/dsrr/view','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','sales_info','$product_info.category','sales_ext','$sale_product.product_code','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','<td\x20class=\x22row_data\x22>','$product_info.name','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','</tr>','exports','excel','split','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','setDate','\x22\x20class=\x22cat_data\x22>','toLocaleDateString','$sale_product.adj_discount','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','style','table\x20tr','Content-Disposition','20mm','!cols','forEach','1365474dVRRgJ','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','product_info','products','toLocaleString','params','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','toISOString','<thead>','attr','DateTimeFormat','user','<h1>JAKA\x20EQUITIES\x20CORP</h1>','$product_details','$dsi','dssr_view_admin','html-pdf','<script>','8.5in','adj_discount','/getDSSR_no','</script>','map','success','/agent_reports/sales_ad','1626600FIElFA','\x20-\x20STD','test','$product_details.product_name','$products.adj_discount','cash','$NetPrice','referenceNumber','English','brandCount','<p>FINISHED\x20GOODS\x20INVENTORY</p>','!merges','thin','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','/inventory_sum/view','/dsrr_admin/view','15in','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','text','NumberFormat','Products\x20warehouse_data','valueOf','language','$product_details.product_stock','totalGross','pdfkit-table','English\x20(US)','/agent/pdf','<th\x20rowspan=\x272\x27>Products</th>','toFixed','customer','$product.product_code','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','NetPrice','$product_code','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','attachment;\x20filename=\x22sales_report.xlsx\x22','$product','$category','</table>','Chinese','$_id.status_data','catch','due_date','/dev/null','send','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<td\x20class=\x22row_data\x22>0</td>','318143vtGJtT','$_id.customer','<th>\x20ITEM\x20DESCRIPTION\x20</th>','beg_bal','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','product_code','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$product_list.product_stock','format','utils','email','$_id.brand','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','thick','express','product_stock','reduce','cat_brand','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','sale_product.product_code','Products\x20master','$amount','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','$_id.category','$sales_info._id','/total_sales_reports/pdf','9430974uqYAXb','Letter','Arabic','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','$_id.date','get','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$products.product_details','save','\x20-\x20','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','date_include','$status_data','$name','<th>\x20ENDING\x20BALANCE\x20</th>','</div>','ObjectId','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','deleteOne','xlsx','<th>\x20INVOICE\x20AMOUNT\x20</th>','findById','left','right','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','$totalQty','isFG','getDate','sales_staff_id','$product_info','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','findOne','$products.qty','/balance/pdf','then','setHeader','$product_list.product_code','cheerio','/agent/view','</p>','product_name','getFullYear','$sales_info.name','pipe','/reports/dsrr/view','47976QHuSjS','$product_name','flash','$_id.dsi','sort','check_no','German','<td\x20colspan=\x223\x22><b>TOTAL<b>','000000','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','exceljs','landscape','buffer','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>'];a0_0x5d99=function(){return _0x3f0da5;};return a0_0x5d99();}async function generateReferenceNumber(_0x1585de,_0x1d9dfb,_0x529884){const _0x210db7=a0_0x4aeceb,_0x397d6d=new Date(_0x1585de)[_0x210db7(0x1b4)](),_0xddfee1=('0'+(new Date(_0x1585de)['getMonth']()+0x1))[_0x210db7(0x213)](-0x2),_0x1f94a2=('0'+new Date(_0x1585de)[_0x210db7(0x1a6)]())['slice'](-0x2),_0x67e950=await staff['findOne']({'email':_0x529884['email']}),_0x49f34c=_0x67e950['sales_man_code'],_0x2c6709=_0x49f34c+'-'+_0x397d6d+_0xddfee1+_0x1f94a2,_0x58ebb7=await Reference[_0x210db7(0x1aa)]({'referenceNumber':new RegExp('^'+_0x2c6709),'salesman_code':_0x49f34c})[_0x210db7(0x1bc)]({'createdAt':-0x1}),_0x5afa6c=_0x2c6709;_0x58ebb7&&(_0x5afa6c=_0x58ebb7[_0x210db7(0x144)]);console[_0x210db7(0x227)](_0x5afa6c);const _0x244733=new Reference({'referenceNumber':_0x5afa6c,'staff_id':_0x1d9dfb,'salesman_code':_0x49f34c});return await _0x244733[_0x210db7(0x192)](),_0x5afa6c;}router[a0_0x4aeceb(0x23b)](a0_0x4aeceb(0xdf),auth,async(_0x1e071d,_0x5cbbbc)=>{const _0x40d396=a0_0x4aeceb,{from_date:_0x1aae3b,dataview:_0x24e319}=_0x1e071d[_0x40d396(0xf0)],_0x589342=_0x1e071d[_0x40d396(0x12f)],_0x4e09e6=await staff[_0x40d396(0x1aa)]({'email':_0x589342['email']}),_0x1581b9=await master_shop[_0x40d396(0xf5)](),_0x2a7176='';var _0x214741=new Date(_0x1aae3b);const _0x3fa3e0={'year':_0x40d396(0x1ea),'month':_0x40d396(0x219),'day':_0x40d396(0x1ea)},_0x52efaa=new Intl[(_0x40d396(0x12e))](_0x40d396(0xd9),_0x3fa3e0)['format'](_0x214741),_0x4a3f6e=await Reference[_0x40d396(0xf5)]({'staff_id':_0x4e09e6[_0x40d396(0x200)]['valueOf'](),'date_include':_0x1aae3b});if(_0x4a3f6e[_0x40d396(0x21d)]>0x0){let _0x2c42df='';_0x2c42df+=_0x4a3f6e[0x0][_0x40d396(0xf4)];if(_0x24e319==_0x40d396(0x111)){const _0x4e325a=cheerio[_0x40d396(0x1f2)](_0x2c42df);let _0xe1cdf4=[],_0x80d67=[],_0xee387=[];const _0x4ab68e=_0x32627e=>{const _0x1052ba=_0x40d396,_0x2ffe82={'top':{'style':_0x1052ba(0x17c),'color':{'rgb':_0x1052ba(0x1c0)}},'bottom':{'style':_0x1052ba(0x17c),'color':{'rgb':_0x1052ba(0x1c0)}},'left':{'style':'thick','color':{'rgb':_0x1052ba(0x1c0)}},'right':{'style':_0x1052ba(0x17c),'color':{'rgb':_0x1052ba(0x1c0)}}};if(_0x32627e){const _0x47a0d6=_0x32627e[_0x1052ba(0x112)](';')[_0x1052ba(0x17f)]((_0x42b754,_0x2034b6)=>{const _0x5aa225=_0x1052ba,[_0x1b73aa,_0x5b8590]=_0x2034b6['split'](':')[_0x5aa225(0x13a)](_0x3fcca0=>_0x3fcca0[_0x5aa225(0x1ef)]());return _0x42b754[_0x1b73aa]=_0x5b8590,_0x42b754;},{});_0x47a0d6[_0x1052ba(0x1f6)]&&(_0x2ffe82['top'][_0x1052ba(0x11e)]=_0x47a0d6[_0x1052ba(0x1f6)][_0x1052ba(0xe4)]('thin')?_0x1052ba(0x149):'medium'),_0x47a0d6[_0x1052ba(0x1d4)]&&(_0x2ffe82[_0x1052ba(0x20f)]['style']=_0x47a0d6[_0x1052ba(0x1d4)][_0x1052ba(0xe4)]('thin')?_0x1052ba(0x149):_0x1052ba(0x236)),_0x47a0d6[_0x1052ba(0x1e0)]&&(_0x2ffe82['left'][_0x1052ba(0x11e)]=_0x47a0d6['border-left']['includes']('thin')?'thin':_0x1052ba(0x236)),_0x47a0d6[_0x1052ba(0xde)]&&(_0x2ffe82[_0x1052ba(0x1a2)][_0x1052ba(0x11e)]=_0x47a0d6[_0x1052ba(0xde)][_0x1052ba(0xe4)](_0x1052ba(0x149))?'thin':'medium');}return _0x2ffe82;};_0x4e325a(_0x40d396(0x11f))['each']((_0x5da8f7,_0x475081)=>{const _0x26258f=_0x40d396;let _0x48263b=[],_0x4384f3=0x0;while(_0xee387[_0x4384f3]){_0xee387[_0x4384f3]--,_0x4384f3++;}_0x4e325a(_0x475081)[_0x26258f(0xf5)](_0x26258f(0xf8))[_0x26258f(0x222)]((_0x28fb7e,_0x25d87d)=>{const _0x4183df=_0x26258f;let _0x52121c=_0x4e325a(_0x25d87d)[_0x4183df(0x14f)]()[_0x4183df(0x1ef)](),_0x150d9e=parseFloat(_0x52121c[_0x4183df(0xc9)](/,/g,''));isNaN(_0x150d9e)&&(_0x150d9e=_0x52121c);let _0xff05fc=parseInt(_0x4e325a(_0x25d87d)[_0x4183df(0x12d)](_0x4183df(0x237)))||0x1,_0x2937a0=parseInt(_0x4e325a(_0x25d87d)[_0x4183df(0x12d)](_0x4183df(0x254)))||0x1;const _0x26a011=_0x4e325a(_0x25d87d)[_0x4183df(0x12d)](_0x4183df(0x11e)),_0xd552dc=_0x4ab68e(_0x26a011);_0x48263b[_0x4384f3]={'v':_0x150d9e,'s':{'border':_0xd552dc}};(_0xff05fc>0x1||_0x2937a0>0x1)&&_0x80d67[_0x4183df(0xfb)]({'s':{'r':_0x5da8f7,'c':_0x4384f3},'e':{'r':_0x5da8f7+_0x2937a0-0x1,'c':_0x4384f3+_0xff05fc-0x1}});for(let _0x53e0f9=0x0;_0x53e0f9<_0xff05fc;_0x53e0f9++){_0x2937a0>0x1&&(_0xee387[_0x4384f3+_0x53e0f9]=_0x2937a0-0x1);}_0x4384f3+=_0xff05fc;}),_0xe1cdf4[_0x26258f(0xfb)](_0x48263b);});const _0x5a33e6=XLSX[_0x40d396(0x178)][_0x40d396(0xe7)](),_0x43ac79=XLSX['utils'][_0x40d396(0x225)](_0xe1cdf4);_0x80d67['length']>0x0&&(_0x43ac79[_0x40d396(0x148)]=_0x80d67);_0x43ac79['!cols']=_0xe1cdf4[0x0]['map'](()=>({'wpx':0x64})),XLSX['utils'][_0x40d396(0x1dc)](_0x5a33e6,_0x43ac79,_0x40d396(0x1de));const _0x11681b=XLSX[_0x40d396(0xd5)](_0x5a33e6,{'bookType':_0x40d396(0x19e),'type':_0x40d396(0x1c5)});_0x5cbbbc[_0x40d396(0x1ae)](_0x40d396(0x120),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x5cbbbc[_0x40d396(0x1ae)](_0x40d396(0x208),_0x40d396(0x18f)),_0x5cbbbc[_0x40d396(0x16a)](_0x11681b);}else{let _0x567872='';_0x567872+=_0x2c42df,_0x567872+=_0x40d396(0x135),_0x567872+=_0x40d396(0xdb),_0x567872+=_0x40d396(0xfa),_0x567872+='};',_0x567872+='</script>',_0x5cbbbc[_0x40d396(0x16a)](_0x567872);}}else generateReferenceNumber(_0x1aae3b,_0x4e09e6[_0x40d396(0x200)][_0x40d396(0x152)](),_0x589342)[_0x40d396(0x1ad)](async _0x3a35f5=>{const _0x2492b6=_0x40d396,_0x4a8ffc=await agentsdataDSICheck_DSRR(_0x1aae3b,_0x4e09e6[_0x2492b6(0x200)]['valueOf'](),_0x2a7176,_0x3a35f5);console[_0x2492b6(0x227)](_0x4a8ffc);let _0xab071b=_0x2492b6(0x20c);_0xab071b+=_0x2492b6(0x240),_0xab071b+=_0x2492b6(0x24d),_0xab071b+='<table>',_0xab071b+=_0x4a8ffc,_0xab071b+=_0x2492b6(0x164),_0xab071b+='</div>',_0xab071b+=_0x2492b6(0x19a);if(_0x4a8ffc['length']>0x0){const _0x224189=await Reference['findOne']({'staff_id':_0x4e09e6['_id'][_0x2492b6(0x152)](),'referenceNumber':_0x3a35f5});_0x224189['html']=_0xab071b,_0x224189[_0x2492b6(0x196)]=_0x1aae3b,await _0x224189[_0x2492b6(0x192)]();if(_0x24e319==_0x2492b6(0x111)){const _0x38dc38=cheerio[_0x2492b6(0x1f2)](_0xab071b);let _0x44e57f=[],_0x25453b=[],_0x1457ed=[];const _0xa65e9a=_0x5ef1e6=>{const _0x368ca9=_0x2492b6,_0x4e6dfe={'top':{'style':_0x368ca9(0x17c),'color':{'rgb':_0x368ca9(0x1c0)}},'bottom':{'style':_0x368ca9(0x17c),'color':{'rgb':_0x368ca9(0x1c0)}},'left':{'style':'thick','color':{'rgb':'000000'}},'right':{'style':_0x368ca9(0x17c),'color':{'rgb':'000000'}}};if(_0x5ef1e6){const _0x25d697=_0x5ef1e6['split'](';')['reduce']((_0x3a05fa,_0x3f2fef)=>{const _0x5c8ff0=_0x368ca9,[_0x19cec9,_0x3b40f7]=_0x3f2fef[_0x5c8ff0(0x112)](':')[_0x5c8ff0(0x13a)](_0x34a4ea=>_0x34a4ea['trim']());return _0x3a05fa[_0x19cec9]=_0x3b40f7,_0x3a05fa;},{});_0x25d697[_0x368ca9(0x1f6)]&&(_0x4e6dfe[_0x368ca9(0x1c9)]['style']=_0x25d697['border-top'][_0x368ca9(0xe4)](_0x368ca9(0x149))?_0x368ca9(0x149):_0x368ca9(0x236)),_0x25d697['border-bottom']&&(_0x4e6dfe['bottom'][_0x368ca9(0x11e)]=_0x25d697[_0x368ca9(0x1d4)][_0x368ca9(0xe4)]('thin')?_0x368ca9(0x149):_0x368ca9(0x236)),_0x25d697['border-left']&&(_0x4e6dfe['left'][_0x368ca9(0x11e)]=_0x25d697[_0x368ca9(0x1e0)][_0x368ca9(0xe4)](_0x368ca9(0x149))?_0x368ca9(0x149):'medium'),_0x25d697[_0x368ca9(0xde)]&&(_0x4e6dfe[_0x368ca9(0x1a2)][_0x368ca9(0x11e)]=_0x25d697[_0x368ca9(0xde)][_0x368ca9(0xe4)]('thin')?'thin':_0x368ca9(0x236));}return _0x4e6dfe;};_0x38dc38(_0x2492b6(0x11f))[_0x2492b6(0x222)]((_0x324c7d,_0x5b5da1)=>{const _0x61136=_0x2492b6;let _0x40fafc=[],_0x574204=0x0;while(_0x1457ed[_0x574204]){_0x1457ed[_0x574204]--,_0x574204++;}_0x38dc38(_0x5b5da1)['find']('td,\x20th')[_0x61136(0x222)]((_0x1461ba,_0x36ba8e)=>{const _0x15950e=_0x61136;let _0x1c3782=_0x38dc38(_0x36ba8e)[_0x15950e(0x14f)]()['trim'](),_0x488054=parseFloat(_0x1c3782[_0x15950e(0xc9)](/,/g,''));isNaN(_0x488054)&&(_0x488054=_0x1c3782);let _0x74218a=parseInt(_0x38dc38(_0x36ba8e)['attr'](_0x15950e(0x237)))||0x1,_0x56fb49=parseInt(_0x38dc38(_0x36ba8e)[_0x15950e(0x12d)](_0x15950e(0x254)))||0x1;const _0x198f48=_0x38dc38(_0x36ba8e)[_0x15950e(0x12d)]('style'),_0x303cad=_0xa65e9a(_0x198f48);_0x40fafc[_0x574204]={'v':_0x488054,'s':{'border':_0x303cad}};(_0x74218a>0x1||_0x56fb49>0x1)&&_0x25453b[_0x15950e(0xfb)]({'s':{'r':_0x324c7d,'c':_0x574204},'e':{'r':_0x324c7d+_0x56fb49-0x1,'c':_0x574204+_0x74218a-0x1}});for(let _0x2aadf6=0x0;_0x2aadf6<_0x74218a;_0x2aadf6++){_0x56fb49>0x1&&(_0x1457ed[_0x574204+_0x2aadf6]=_0x56fb49-0x1);}_0x574204+=_0x74218a;}),_0x44e57f[_0x61136(0xfb)](_0x40fafc);});const _0x2aa632=XLSX['utils'][_0x2492b6(0xe7)](),_0x44db25=XLSX[_0x2492b6(0x178)][_0x2492b6(0x225)](_0x44e57f);_0x25453b[_0x2492b6(0x21d)]>0x0&&(_0x44db25[_0x2492b6(0x148)]=_0x25453b);_0x44db25['!cols']=_0x44e57f[0x0][_0x2492b6(0x13a)](()=>({'wpx':0x64})),XLSX[_0x2492b6(0x178)][_0x2492b6(0x1dc)](_0x2aa632,_0x44db25,_0x2492b6(0x1de));const _0x373f62=XLSX[_0x2492b6(0xd5)](_0x2aa632,{'bookType':_0x2492b6(0x19e),'type':_0x2492b6(0x1c5)});_0x5cbbbc[_0x2492b6(0x1ae)]('Content-Disposition',_0x2492b6(0x161)),_0x5cbbbc[_0x2492b6(0x1ae)](_0x2492b6(0x208),_0x2492b6(0x18f)),_0x5cbbbc['send'](_0x373f62);}else _0xab071b+=_0x2492b6(0x135),_0xab071b+=_0x2492b6(0xdb),_0xab071b+=_0x2492b6(0xfa),_0xab071b+='};',_0xab071b+=_0x2492b6(0x139),_0x5cbbbc[_0x2492b6(0x16a)](_0xab071b);}else await Reference[_0x2492b6(0x19d)]({'referenceNumber':_0x3a35f5}),_0x1e071d['flash'](_0x2492b6(0x23e),_0x2492b6(0x241)),_0x5cbbbc['redirect'](_0x2492b6(0x1b7));})[_0x40d396(0x167)](console['error']);}),router[a0_0x4aeceb(0x18e)](a0_0x4aeceb(0x14c),auth,async(_0x5b9f38,_0x3882f9)=>{const _0x6f8fb2=a0_0x4aeceb;try{const {username:_0x134ad7,email:_0x3d910d,role:_0x3656da}=_0x5b9f38[_0x6f8fb2(0x12f)],_0x3c867e=_0x5b9f38[_0x6f8fb2(0x12f)],_0x2065e1=await profile[_0x6f8fb2(0x1aa)]({'email':_0x3c867e[_0x6f8fb2(0x179)]}),_0x275f1c={'year':_0x6f8fb2(0x1ea),'month':'long','day':_0x6f8fb2(0x1ea)},_0x1155c6=await master_shop[_0x6f8fb2(0xf5)]();console[_0x6f8fb2(0x227)](_0x6f8fb2(0x183),_0x1155c6);const _0x49aa13=await product['find']();console[_0x6f8fb2(0x227)](_0x6f8fb2(0x1eb),_0x49aa13);const _0x18019b=await warehouse[_0x6f8fb2(0x103)]([{'$unwind':_0x6f8fb2(0x131)},{'$lookup':{'from':'products','localField':_0x6f8fb2(0x226),'foreignField':'name','as':_0x6f8fb2(0x20d)}},{'$unwind':_0x6f8fb2(0xf9)},{'$project':{'product_name':_0x6f8fb2(0x140),'product_stock':_0x6f8fb2(0x154)}},{'$group':{'_id':_0x6f8fb2(0x1b9),'product_stock':{'$sum':_0x6f8fb2(0x239)}}}]);console[_0x6f8fb2(0x227)](_0x6f8fb2(0x151),_0x18019b),_0x18019b[_0x6f8fb2(0x123)](_0x1fc311=>{const _0x257a16=_0x49aa13['map'](_0x5dbb1d=>{const _0x272fe1=a0_0x3a5d;_0x5dbb1d[_0x272fe1(0xdc)]==_0x1fc311[_0x272fe1(0x200)]&&(_0x5dbb1d['stock']=parseInt(_0x5dbb1d[_0x272fe1(0xee)])+parseInt(_0x1fc311[_0x272fe1(0x17e)]));});});const _0x134281=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'}),_0x3d8b16=await staff[_0x6f8fb2(0x1aa)]({'email':_0x3c867e[_0x6f8fb2(0x179)]});if(_0x1155c6[0x0][_0x6f8fb2(0x153)]==_0x6f8fb2(0x157))var _0x382da2=users[_0x6f8fb2(0x145)];else{if(_0x1155c6[0x0][_0x6f8fb2(0x153)]==_0x6f8fb2(0x243))var _0x382da2=users['Hindi'];else{if(_0x1155c6[0x0]['language']=='German')var _0x382da2=users['German'];else{if(_0x1155c6[0x0]['language']==_0x6f8fb2(0x246))var _0x382da2=users[_0x6f8fb2(0x246)];else{if(_0x1155c6[0x0][_0x6f8fb2(0x153)]==_0x6f8fb2(0xd1))var _0x382da2=users[_0x6f8fb2(0xd1)];else{if(_0x1155c6[0x0]['language']==_0x6f8fb2(0x223))var _0x382da2=users[_0x6f8fb2(0x202)];else{if(_0x1155c6[0x0]['language']==_0x6f8fb2(0x165))var _0x382da2=users[_0x6f8fb2(0x165)];else{if(_0x1155c6[0x0][_0x6f8fb2(0x153)]==_0x6f8fb2(0x238))var _0x382da2=users[_0x6f8fb2(0x18b)];}}}}}}}_0x3882f9[_0x6f8fb2(0x21e)](_0x6f8fb2(0x133),{'success':_0x5b9f38[_0x6f8fb2(0x1ba)](_0x6f8fb2(0x13b)),'errors':_0x5b9f38[_0x6f8fb2(0x1ba)](_0x6f8fb2(0x23e)),'alldata':_0x49aa13,'profile':_0x2065e1,'master_shop':_0x1155c6,'role':_0x3c867e,'product_stock':_0x18019b,'language':_0x382da2,'staff_arr':_0x3d8b16,'staff_data_all':_0x134281});}catch(_0x29cc97){}}),router[a0_0x4aeceb(0x23b)](a0_0x4aeceb(0x138),auth,async(_0x5bd135,_0x2b00f7)=>{const _0x36903e=a0_0x4aeceb;try{const {from:_0x303bb4,to:_0x541e9a,staff_data:_0x5a40ad}=_0x5bd135[_0x36903e(0xf0)],_0x22549f=await Reference[_0x36903e(0x103)]([{'$match':{'date_include':{'$gte':_0x303bb4,'$lte':_0x541e9a},'staff_id':_0x5a40ad}},{'$sort':{'date_include':0x1}}]);_0x2b00f7[_0x36903e(0xd0)](_0x22549f);}catch(_0x5db80e){_0x2b00f7[_0x36903e(0xd0)](_0x5db80e);}}),router[a0_0x4aeceb(0x23b)]('/getDSSR_no_sales',auth,async(_0x411d71,_0x484efc)=>{const _0x3e1e70=a0_0x4aeceb;try{const {from:_0x5a6e85,to:_0x47047c}=_0x411d71['body'],{sttaff_id:_0x4a311b}=_0x411d71[_0x3e1e70(0x12f)],_0x31ce21=await Reference[_0x3e1e70(0x103)]([{'$match':{'date_include':{'$gte':_0x5a6e85,'$lte':_0x47047c},'staff_id':_0x4a311b}},{'$sort':{'date_include':0x1}}]);_0x484efc['json'](_0x31ce21);}catch(_0x46c77d){_0x484efc[_0x3e1e70(0xd0)](_0x46c77d);}}),router['get']('/dsrr_admin/view_data/:id',auth,async(_0x461fd6,_0x1fe236)=>{const _0x45b48a=a0_0x4aeceb;try{const _0xdfa167=_0x461fd6[_0x45b48a(0x129)]['id'],_0x38ef70=await Reference[_0x45b48a(0x1a0)](_0xdfa167);let _0x566bae='';_0x566bae+=_0x38ef70[_0x45b48a(0xf4)],_0x566bae+=_0x45b48a(0x135),_0x566bae+=_0x45b48a(0xdb),_0x566bae+=_0x45b48a(0xfa),_0x566bae+='};',_0x566bae+='</script>',_0x1fe236[_0x45b48a(0x16a)](_0x566bae);}catch(_0x2303cd){_0x1fe236[_0x45b48a(0xd0)](_0x2303cd);}}),router[a0_0x4aeceb(0x23b)](a0_0x4aeceb(0x1fe),auth,async(_0x579e6a,_0x151408)=>{const _0x19b95d=a0_0x4aeceb;try{const {ref_data:_0x4a2555}=_0x579e6a[_0x19b95d(0xf0)],_0x589213=_0x4a2555[_0x19b95d(0x112)]('~'),_0x579dfc=_0x589213['filter'](_0x34f9b7=>_0x34f9b7!==''),_0x464e2c=await Reference[_0x19b95d(0x103)]([{'$match':{'referenceNumber':{'$in':_0x579dfc}}}]),_0x33438a=XLSX[_0x19b95d(0x178)]['book_new']();_0x464e2c[_0x19b95d(0x123)](_0x44e600=>{const _0x6541e1=_0x19b95d,_0x1fae48=cheerio[_0x6541e1(0x1f2)](_0x44e600[_0x6541e1(0xf4)]);let _0xb3238a=[],_0x3b81cc=[],_0x16f125=[];_0x1fae48(_0x6541e1(0x11f))[_0x6541e1(0x222)]((_0x313c3c,_0x46332a)=>{const _0x36adad=_0x6541e1;let _0x4415da=[],_0x4cfd8f=0x0;while(_0x16f125[_0x4cfd8f]){_0x16f125[_0x4cfd8f]--,_0x4cfd8f++;}_0x1fae48(_0x46332a)[_0x36adad(0xf5)](_0x36adad(0xf8))[_0x36adad(0x222)]((_0x509e6e,_0x18ef2a)=>{const _0x19c33c=_0x36adad;let _0x2c5a92=_0x1fae48(_0x18ef2a)[_0x19c33c(0x14f)]()[_0x19c33c(0x1ef)](),_0x4fb936=parseFloat(_0x2c5a92[_0x19c33c(0xc9)](/,/g,''));isNaN(_0x4fb936)&&(_0x4fb936=_0x2c5a92);let _0x3d2f4d=parseInt(_0x1fae48(_0x18ef2a)[_0x19c33c(0x12d)](_0x19c33c(0x237)))||0x1,_0x52ffe2=parseInt(_0x1fae48(_0x18ef2a)['attr']('rowspan'))||0x1;_0x4415da[_0x4cfd8f]=_0x4fb936;(_0x3d2f4d>0x1||_0x52ffe2>0x1)&&_0x3b81cc['push']({'s':{'r':_0x313c3c,'c':_0x4cfd8f},'e':{'r':_0x313c3c+_0x52ffe2-0x1,'c':_0x4cfd8f+_0x3d2f4d-0x1}});for(let _0x3535e9=0x0;_0x3535e9<_0x3d2f4d;_0x3535e9++){_0x52ffe2>0x1&&(_0x16f125[_0x4cfd8f+_0x3535e9]=_0x52ffe2-0x1);}_0x4cfd8f+=_0x3d2f4d;}),_0xb3238a[_0x36adad(0xfb)](_0x4415da);});const _0x52cdf6=XLSX['utils'][_0x6541e1(0x225)](_0xb3238a);_0x3b81cc[_0x6541e1(0x21d)]>0x0&&(_0x52cdf6[_0x6541e1(0x148)]=_0x3b81cc),_0x52cdf6['!cols']=_0xb3238a[0x0][_0x6541e1(0x13a)](()=>({'wpx':0x64})),XLSX[_0x6541e1(0x178)]['book_append_sheet'](_0x33438a,_0x52cdf6,_0x44e600[_0x6541e1(0x144)]);});const _0x4b3727=XLSX[_0x19b95d(0xd5)](_0x33438a,{'bookType':'xlsx','type':'buffer'});_0x151408[_0x19b95d(0x1ae)](_0x19b95d(0x120),_0x19b95d(0x1d3)),_0x151408['setHeader'](_0x19b95d(0x208),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x151408[_0x19b95d(0x16a)](_0x4b3727);}catch(_0x44c5bc){_0x151408[_0x19b95d(0xd0)](_0x44c5bc);}}),router[a0_0x4aeceb(0x23b)]('/dsrr_admin/pdf_admin',auth,async(_0x4e88f6,_0x46ff8c)=>{const _0x48ae0c=a0_0x4aeceb,{from_date:_0x7bd185,agent_id:_0xfaf70}=_0x4e88f6['body'],_0x448f8c=_0x4e88f6[_0x48ae0c(0x12f)],_0x17800d=await staff[_0x48ae0c(0x1aa)]({'email':_0x448f8c[_0x48ae0c(0x179)]}),_0x55bf06=await master_shop[_0x48ae0c(0xf5)](),_0x18b4ad=await agentsdataDSICheck_DSRR(_0x7bd185,_0xfaf70,_0x49a191);let _0x44682b=_0x48ae0c(0x14a);var _0x5e4517=new Date(_0x7bd185);const _0x224010={'year':_0x48ae0c(0x1ea),'month':_0x48ae0c(0x219),'day':'numeric'},_0x10441e=new Intl[(_0x48ae0c(0x12e))](_0x48ae0c(0xd9),_0x224010)[_0x48ae0c(0x177)](_0x5e4517);_0x44682b+=_0x48ae0c(0x240),_0x44682b+=_0x48ae0c(0x24d),_0x44682b+='<table>',_0x44682b+=_0x18b4ad,_0x44682b+=_0x48ae0c(0x164),_0x44682b+=_0x48ae0c(0x19a),_0x44682b+='</div>';let _0x225e46=_0x48ae0c(0x24f);const _0x4ce3db={'width':_0x48ae0c(0x14d),'height':_0x48ae0c(0x136),'orientation':_0x48ae0c(0x1c4),'border':{'top':'0.1in','right':_0x48ae0c(0x230),'bottom':_0x48ae0c(0x230),'left':'0.1in'},'header':{'height':_0x48ae0c(0x20b),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x225e46+_0x48ae0c(0x1c2)+_0x10441e+_0x48ae0c(0x247)},'footer':{'height':_0x48ae0c(0x121),'contents':{'default':_0x48ae0c(0x194)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};var _0x49a191='on';if(_0x49a191=='on'){const _0x5e7684=cheerio[_0x48ae0c(0x1f2)](_0x44682b);let _0x5d53a3=[],_0x3b75cd=[],_0x378b3b=[];_0x5e7684(_0x48ae0c(0x11f))[_0x48ae0c(0x222)]((_0x509de2,_0x301d55)=>{const _0x2b7325=_0x48ae0c;let _0x474051=[],_0x3160ae=0x0;while(_0x378b3b[_0x3160ae]){_0x378b3b[_0x3160ae]--,_0x3160ae++;}_0x5e7684(_0x301d55)[_0x2b7325(0xf5)]('td,\x20th')[_0x2b7325(0x222)]((_0x5731c2,_0x139c0c)=>{const _0x32c96b=_0x2b7325;let _0x7ef3a5=_0x5e7684(_0x139c0c)[_0x32c96b(0x14f)]()[_0x32c96b(0x1ef)](),_0x1c5a93=parseFloat(_0x7ef3a5['replace'](/,/g,''));isNaN(_0x1c5a93)&&(_0x1c5a93=_0x7ef3a5);let _0xf992=parseInt(_0x5e7684(_0x139c0c)[_0x32c96b(0x12d)](_0x32c96b(0x237)))||0x1,_0x199c7a=parseInt(_0x5e7684(_0x139c0c)['attr']('rowspan'))||0x1;_0x474051[_0x3160ae]=_0x1c5a93;(_0xf992>0x1||_0x199c7a>0x1)&&_0x3b75cd[_0x32c96b(0xfb)]({'s':{'r':_0x509de2,'c':_0x3160ae},'e':{'r':_0x509de2+_0x199c7a-0x1,'c':_0x3160ae+_0xf992-0x1}});for(let _0x42bd35=0x0;_0x42bd35<_0xf992;_0x42bd35++){_0x199c7a>0x1&&(_0x378b3b[_0x3160ae+_0x42bd35]=_0x199c7a-0x1);}_0x3160ae+=_0xf992;}),_0x5d53a3[_0x2b7325(0xfb)](_0x474051);});const _0x289597=XLSX[_0x48ae0c(0x178)][_0x48ae0c(0xe7)](),_0x510841=XLSX[_0x48ae0c(0x178)][_0x48ae0c(0x225)](_0x5d53a3);_0x3b75cd[_0x48ae0c(0x21d)]>0x0&&(_0x510841[_0x48ae0c(0x148)]=_0x3b75cd);_0x510841['!cols']=_0x5d53a3[0x0][_0x48ae0c(0x13a)](()=>({'wpx':0x64})),XLSX[_0x48ae0c(0x178)][_0x48ae0c(0x1dc)](_0x289597,_0x510841,'Sales\x20Report');const _0x3259a1=XLSX[_0x48ae0c(0xd5)](_0x289597,{'bookType':_0x48ae0c(0x19e),'type':_0x48ae0c(0x1c5)});_0x46ff8c['setHeader'](_0x48ae0c(0x120),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x46ff8c[_0x48ae0c(0x1ae)]('Content-Type',_0x48ae0c(0x18f)),_0x46ff8c[_0x48ae0c(0x16a)](_0x3259a1);}else pdf[_0x48ae0c(0xcb)](_0x44682b,_0x4ce3db)[_0x48ae0c(0xeb)](function(_0xb40a53,_0x28b086){const _0x572822=_0x48ae0c;if(_0xb40a53){_0x46ff8c[_0x572822(0x252)](0x1f4)['send'](_0x572822(0x1ce));return;}_0x46ff8c['setHeader'](_0x572822(0x208),_0x572822(0x24a)),_0x28b086[_0x572822(0x1b6)](_0x46ff8c);});}),module[a0_0x4aeceb(0x110)]=router;