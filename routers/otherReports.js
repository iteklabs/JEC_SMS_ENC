const a0_0x381a3d=a0_0x5084;(function(_0x3b9400,_0x129295){const _0x3f8cc0=a0_0x5084,_0xf1dfba=_0x3b9400();while(!![]){try{const _0x1b2ddf=parseInt(_0x3f8cc0(0xfa))/0x1*(parseInt(_0x3f8cc0(0x11e))/0x2)+parseInt(_0x3f8cc0(0x1ca))/0x3+-parseInt(_0x3f8cc0(0x1c0))/0x4+parseInt(_0x3f8cc0(0x148))/0x5+parseInt(_0x3f8cc0(0x1a3))/0x6*(-parseInt(_0x3f8cc0(0x116))/0x7)+parseInt(_0x3f8cc0(0x206))/0x8+-parseInt(_0x3f8cc0(0x1fc))/0x9*(parseInt(_0x3f8cc0(0xd0))/0xa);if(_0x1b2ddf===_0x129295)break;else _0xf1dfba['push'](_0xf1dfba['shift']());}catch(_0x1717b2){_0xf1dfba['push'](_0xf1dfba['shift']());}}}(a0_0x2616,0x1f7d1));function a0_0x2616(){const _0x4c6f02=['Content-Disposition','cheerio','each','</table>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','../middleware/auth','0.1in','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','true','<th>\x20ITEM\x20CODE\x20</th>','<th>Booking</th>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','NetPrice','<th>\x20ENDING\x20BALANCE\x20</th>','7acaSnA','landscape','name','<th\x20rowspan=\x272\x27>Products</th>','/total_sales_reports/pdf','border-top','\x20-\x20HH','$product_info.gross_price','74318BpiXFr','bottom','totalQTYsum','xlsx','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','$product_details.product_stock','isArray','amount','/balance/view','findOne','inventory_sum','$_id.customer','$sales_info','due_date','medium','<p>SALES\x20REPORTS</p>','right','format','text','split','$NetPrice','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','Products\x20find_data','$product_code','getFullYear','table\x20tr','</div>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','<th\x20rowspan=\x272\x27>Production</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','log','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','/total_sales_reports/view','map','express/lib/response','sales_ext','/dsrr/pdf','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','product_code','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','!cols','English','580745ZNkVSd','<th>\x20QTY\x20SOLD\x20</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$sale_product._id','sales_info','<td\x20colspan=\x223\x22><b>TOTAL<b>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','window.onload\x20=\x20function()\x20{','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','German','left','<script>','Error\x20generating\x20PDF','ObjectId','$discount','DateTimeFormat','$_id.brand','</tbody>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<th\x20colspan=\x272\x27>SOLD</th>','Asia/Manila','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','$product_info.product_code','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','includes','../public/language/languages.json','sale_product.product_code','jsbarcode','$sale_product.quantity','Router','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','$name','create','<div\x20class=\x22col-sm-11\x22>','/agent_reports/pdf_admin','<th>\x20BEG\x20BALANCE\x20</th>','<tbody>','$product_info','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','thin','<td\x20class=\x22row_data\x22>','Arabic\x20(ae)','product_docs','60mm','image','$products.product_details','<td\x20colspan=\x22','$product_list.product_stock','setHeader','body','dsi','sales_staff_id','language','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','<h1>JAKA\x20EQUITIES\x20CORP</h1>','adj_discount','$products.product_details.brand','/dsrr_admin/view_data/:id','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$_id.category','/agent_reports/sales_ad','border-right','border-left','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','product_name','then','Arabic','<div\x20\x20id=\x22table-conatainer\x22>','beg_bal','<td\x20class=\x22row_data\x22><b>','post','product_info','error','$check_no','</th>','<tr>','totalQty','replace','/balance/pdf','blob-stream','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','getDate','$sale_product.stock','catch','salesman_data','user','$dsi','$due_date','<th>\x20SALES\x20</th>','316458qALUXq','params','cash','<th>\x20ITEM\x20DESCRIPTION\x20</th>','$products.adj_discount','$products.discount','brand','$bank','No\x20data\x20was\x20Found!','$products.NetPrice','border-bottom','<th>\x20INCOMING\x20</th>','<th>X-Truck</th>','$sale_product.totalprice','$product_details.product_name','mongoose','slice','$totalQty','<table>','Letter','<thead>','thick','sumqty','\x22><b>','html','$sales_info.name','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','agent_sales','stock','683296CxpIGY','test','product_details.product_name','<td\x20class=\x22cat_data\x22>','$product_list.product_code','attr','find','$product.product_code','Types','book_append_sheet','452826vQjgBq','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','</p>','$status_data','product_details','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','date','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','save','forEach','multer','8.5in','window.print();','product_stock','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>','20mm','express','/dsrr_admin/view','$product','$sale_product','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','French','check_no','pipe','</script>','flash','$cash','toFixed','/agent_reports/pdf','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','book_new','dataqty','\x22\x20class=\x22cat_data\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','findById','$sale_product.discount','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','sort','15in','redirect','dsi_sales_admin','json','$sales_staff_id','status','$products.product_details.gross_price','valueOf','<th>\x20INVOICE\x20AMOUNT\x20</th>','37242wHFkFW','$sale_product.isFG','<p>','$product_details','$product_info.name','qty','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','$sale_product.product_code','totalPrice','/reports/dsrr/view','387016JBAPUh','customer','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','</thead>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','pdfkit-table','</td>','$sale_product.product_name','$_id.status_data','/agent_reports/view','reduce','render','\x20-\x20','prod_cat','$_id.dsi','false','_id','dsi_sales','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','colspan','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','dssr_view_admin','Chinese','$_id.date','Products\x20warehouse_data','excel','canvas','$product_name','brandCount','aggregate','$products','toLocaleString','errors','NumberFormat','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','$brand','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','utils','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','Products\x20master','Portuguese\x20(BR)','$category','sales_reports','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','top','English\x20(US)','send','</tr>','/dsrr_admin/pdf_admin','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','</b></td>','isFG','$amount','<th\x20rowspan=\x272\x27>Category</th>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','Hindi','Sales\x20Report','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','$product.product_name','Portuguese','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','en-US','<div\x20style=\x22page-break-before:\x20always;\x22></div>','buffer','email','$products.qty','$sale_product.adj_discount','attachment;\x20filename=\x22sales_report.xlsx\x22','dssr_view','load','\x22><b></b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','application/pdf','exports','aoa_to_sheet','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','$products.product_details.category','$product_stock','$sales_info._id','attachment;\x20filename=\x22reports.xlsx\x22','totalGross','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$date','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','length','90QnYhKn','products','success','Household','long','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','$adj_discount','$customer','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','style','!merges','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','push','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','Content-Type','category','rowspan','toStream','$product_info.brand','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<td\x20class=\x22cat_data\x22></td>','totalQTY','referenceNumber','sales_bkg','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','filter','/agent/pdf','Spanish','/dl_excel','write','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','/agent/view','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','$totalGross','/dsrr/view','td,\x20th','toISOString','<td\x20class=\x22row_data\x22>0</td>','2nPfcfb','$product_docs','$product_info.category','staffs','000000','sales_man_code','deleteOne','numeric','$sale_product.real_qty_unit_val','discount','<div\x20class=\x22row\x22>','get','trim','cat_brand'];a0_0x2616=function(){return _0x4c6f02;};return a0_0x2616();}const express=require(a0_0x381a3d(0x1db)),res=require(a0_0x381a3d(0x140)),app=express(),router=express[a0_0x381a3d(0x165)](),multer=require(a0_0x381a3d(0x1d5)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require('../models/all_models'),auth=require(a0_0x381a3d(0x10d)),users=require(a0_0x381a3d(0x161)),excelJS=require('exceljs'),XLSX=require('xlsx'),PDFDocument=require(a0_0x381a3d(0x20b)),fs=require('fs'),blobStream=require(a0_0x381a3d(0x198)),JsBarcode=require(a0_0x381a3d(0x163)),{Canvas}=require(a0_0x381a3d(0x221)),pdf=require('html-pdf'),path=require('path'),mongoose=require(a0_0x381a3d(0x1b2)),cheerio=require(a0_0x381a3d(0x109));router[a0_0x381a3d(0x105)](a0_0x381a3d(0x126),auth,async(_0x471d2e,_0x3bdf0c)=>{const _0x4fec38=a0_0x381a3d;try{const {username:_0x3205d6,email:_0x5cab8c,role:_0x3cf43d}=_0x471d2e[_0x4fec38(0x19f)],_0x24d251=_0x471d2e[_0x4fec38(0x19f)],_0x406188=await profile[_0x4fec38(0x127)]({'email':_0x24d251['email']}),_0x36fe62={'year':_0x4fec38(0x101),'month':_0x4fec38(0xd4),'day':_0x4fec38(0x101)},_0x4cef9b=await master_shop[_0x4fec38(0x1c6)]();console[_0x4fec38(0x13c)](_0x4fec38(0x22f),_0x4cef9b);const _0x5267b4=await product['find']();console[_0x4fec38(0x13c)](_0x4fec38(0x134),_0x5267b4);const _0x73ec07=await warehouse[_0x4fec38(0x224)]([{'$unwind':_0x4fec38(0x1ff)},{'$lookup':{'from':_0x4fec38(0xd1),'localField':'product_details.product_name','foreignField':_0x4fec38(0x118),'as':'product_docs'}},{'$unwind':_0x4fec38(0xfb)},{'$project':{'product_name':_0x4fec38(0x1b1),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x4fec38(0x222),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x4fec38(0x13c)]('Products\x20warehouse_data',_0x73ec07),_0x73ec07[_0x4fec38(0x1d4)](_0x3a827d=>{const _0x4e836d=_0x4fec38,_0x203e9b=_0x5267b4[_0x4e836d(0x13f)](_0x130799=>{const _0x13e402=_0x4e836d;_0x130799[_0x13e402(0x118)]==_0x3a827d[_0x13e402(0x216)]&&(_0x130799[_0x13e402(0x1bf)]=parseInt(_0x130799[_0x13e402(0x1bf)])+parseInt(_0x3a827d[_0x13e402(0x1d8)]));});}),console[_0x4fec38(0x13c)](_0x4fec38(0x134),_0x5267b4);if(_0x4cef9b[0x0][_0x4fec38(0x17c)]==_0x4fec38(0x235))var _0x2b7b24=users[_0x4fec38(0x147)];else{if(_0x4cef9b[0x0][_0x4fec38(0x17c)]=='Hindi')var _0x2b7b24=users[_0x4fec38(0x23f)];else{if(_0x4cef9b[0x0][_0x4fec38(0x17c)]==_0x4fec38(0x151))var _0x2b7b24=users[_0x4fec38(0x151)];else{if(_0x4cef9b[0x0][_0x4fec38(0x17c)]==_0x4fec38(0xee))var _0x2b7b24=users['Spanish'];else{if(_0x4cef9b[0x0][_0x4fec38(0x17c)]=='French')var _0x2b7b24=users['French'];else{if(_0x4cef9b[0x0][_0x4fec38(0x17c)]==_0x4fec38(0x230))var _0x2b7b24=users['Portuguese'];else{if(_0x4cef9b[0x0]['language']==_0x4fec38(0x21d))var _0x2b7b24=users[_0x4fec38(0x21d)];else{if(_0x4cef9b[0x0][_0x4fec38(0x17c)]=='Arabic\x20(ae)')var _0x2b7b24=users[_0x4fec38(0x18b)];}}}}}}}_0x3bdf0c[_0x4fec38(0x211)]('balanced',{'success':_0x471d2e[_0x4fec38(0x1e4)](_0x4fec38(0xd2)),'errors':_0x471d2e[_0x4fec38(0x1e4)]('errors'),'alldata':_0x5267b4,'profile':_0x406188,'master_shop':_0x4cef9b,'role':_0x24d251,'product_stock':_0x73ec07,'language':_0x2b7b24});}catch(_0x585e30){}});async function dataCheck(_0x17be90,_0x544ded){const _0x4388c1=a0_0x381a3d,_0x212c45=await product['aggregate']([{'$group':{'_id':{'brand':_0x4388c1(0x22a),'category':_0x4388c1(0x231)},'products':{'$push':{'name':_0x4388c1(0x167),'product_code':_0x4388c1(0x135)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x4f0b9c=[];_0x4f0b9c[_0x4388c1(0x107)]=[];for(let _0x7de817=0x0;_0x7de817<=_0x212c45[_0x4388c1(0x25e)]-0x1;_0x7de817++){const _0x459e9e=_0x212c45[_0x7de817];_0x4f0b9c[_0x4388c1(0x107)][_0x4388c1(0xde)](_0x459e9e);}const _0x4cc274=await product[_0x4388c1(0x224)]([{'$group':{'_id':{'category':_0x4388c1(0x231)},'products':{'$push':{'brand':_0x4388c1(0x22a),'product_code':_0x4388c1(0x135),'product_name':_0x4388c1(0x167)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5770e1=await purchases_finished[_0x4388c1(0x224)]([{'$match':{'date':{'$gte':_0x17be90,'$lte':_0x544ded}}},{'$unwind':_0x4388c1(0x1dd)},{'$group':{'_id':{'product_name':_0x4388c1(0x243),'product_code':_0x4388c1(0x1c7)},'totalQTY':{'$sum':'$product.quantity'}}}]);_0x4f0b9c['beg_bal']=[];for(let _0x40bb43=0x0;_0x40bb43<=_0x5770e1[_0x4388c1(0x25e)]-0x1;_0x40bb43++){const _0x49eaa0=_0x5770e1[_0x40bb43];_0x4f0b9c[_0x4388c1(0x18d)][_0x4388c1(0xde)](_0x49eaa0);}const _0x5659ca=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x17be90,'$lte':_0x544ded}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x4388c1(0xfd),'localField':_0x4388c1(0x17b),'foreignField':'_id','as':_0x4388c1(0x14c)}},{'$unwind':_0x4388c1(0x12a)},{'$unwind':_0x4388c1(0x1de)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x4388c1(0x20d),'product_code':_0x4388c1(0x203)},'totalQTY':{'$sum':_0x4388c1(0x164)}}}]);console[_0x4388c1(0x13c)](_0x5659ca[0x0]),_0x4f0b9c[_0x4388c1(0xe9)]=[];for(let _0x558bf1=0x0;_0x558bf1<=_0x5659ca[_0x4388c1(0x25e)]-0x1;_0x558bf1++){const _0x3d535f=_0x5659ca[_0x558bf1];_0x4f0b9c[_0x4388c1(0xe9)]['push'](_0x3d535f);}const _0xc5ab1=await sales_sa[_0x4388c1(0x224)]([{'$match':{'date':{'$gte':_0x17be90,'$lte':_0x544ded}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x4388c1(0x1f7)}}},{'$lookup':{'from':'staffs','localField':_0x4388c1(0x17b),'foreignField':_0x4388c1(0x216),'as':_0x4388c1(0x14c)}},{'$unwind':_0x4388c1(0x12a)},{'$unwind':_0x4388c1(0x1de)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x4388c1(0x215)}},{'$group':{'_id':{'product_name':_0x4388c1(0x20d),'product_code':_0x4388c1(0x203)},'totalQTY':{'$sum':_0x4388c1(0x102)}}}]);_0x4f0b9c[_0x4388c1(0x141)]=[];for(let _0x1cbe1f=0x0;_0x1cbe1f<=_0xc5ab1[_0x4388c1(0x25e)]-0x1;_0x1cbe1f++){const _0x19c63a=_0xc5ab1[_0x1cbe1f];_0x4f0b9c[_0x4388c1(0x141)][_0x4388c1(0xde)](_0x19c63a);}let _0x517ba5='';for(let _0xd63b74=0x0;_0xd63b74<=_0x4cc274['length']-0x1;_0xd63b74++){const _0x3682fa=_0x4cc274[_0xd63b74];_0x517ba5+=_0x4388c1(0x194),_0x517ba5+=_0x4388c1(0x22e)+_0x3682fa[_0x4388c1(0x216)]['category']+'</td>',_0x517ba5+='</tr>';for(let _0x25b95b=0x0;_0x25b95b<_0x4f0b9c['cat_brand']['length'];_0x25b95b++){const _0xe8e568=_0x4f0b9c[_0x4388c1(0x107)][_0x25b95b];if(_0xe8e568[_0x4388c1(0x216)][_0x4388c1(0xe1)]==_0x3682fa['_id'][_0x4388c1(0xe1)]){let _0x2e5eaf=[],_0x50ebdc=[],_0x55105c=[];_0x2e5eaf[_0xe8e568['_id'][_0x4388c1(0x1a9)]]=[],_0x50ebdc[_0xe8e568[_0x4388c1(0x216)]['brand']]=[],_0x55105c[_0xe8e568[_0x4388c1(0x216)][_0x4388c1(0x1a9)]]=[];var _0x2521f9=0x0,_0x1521b4=0x0,_0x3fcac6=0x0;for(let _0x33b862=0x0;_0x33b862<_0xe8e568[_0x4388c1(0xd1)][_0x4388c1(0x25e)];_0x33b862++){const _0x537fe8=_0xe8e568[_0x4388c1(0xd1)][_0x33b862];for(let _0x4498e0=0x0;_0x4498e0<=_0x4f0b9c[_0x4388c1(0x18d)]['length']-0x1;_0x4498e0++){const _0x6d3372=_0x4f0b9c['beg_bal'][_0x4498e0];_0x6d3372[_0x4388c1(0x216)][_0x4388c1(0x189)]==_0x537fe8[_0x4388c1(0x118)]&&_0x6d3372[_0x4388c1(0x216)][_0x4388c1(0x144)]==_0x537fe8[_0x4388c1(0x144)]&&(_0x2521f9+=parseInt(_0x6d3372[_0x4388c1(0xe7)],0xa));}for(let _0x48df63=0x0;_0x48df63<=_0x4f0b9c[_0x4388c1(0x141)][_0x4388c1(0x25e)]-0x1;_0x48df63++){const _0x40a552=_0x4f0b9c[_0x4388c1(0x141)][_0x48df63];_0x40a552[_0x4388c1(0x216)][_0x4388c1(0x189)]==_0x537fe8[_0x4388c1(0x118)]&&_0x40a552[_0x4388c1(0x216)][_0x4388c1(0x144)]==_0x537fe8[_0x4388c1(0x144)]&&(_0x1521b4+=parseFloat(_0x40a552['totalQTY'],0xa)[_0x4388c1(0x1e6)](0x2));}for(let _0x15d2ba=0x0;_0x15d2ba<=_0x4f0b9c[_0x4388c1(0xe9)][_0x4388c1(0x25e)]-0x1;_0x15d2ba++){const _0xc2c96d=_0x4f0b9c[_0x4388c1(0xe9)][_0x15d2ba];_0xc2c96d[_0x4388c1(0x216)]['product_name']==_0x537fe8[_0x4388c1(0x118)]&&_0xc2c96d[_0x4388c1(0x216)]['product_code']==_0x537fe8[_0x4388c1(0x144)]&&(_0x3fcac6+=parseInt(_0xc2c96d['totalQTY'],0xa));}}const _0xbe3f41=new Intl[(_0x4388c1(0x228))](_0x4388c1(0x246));var _0x272146=_0xbe3f41[_0x4388c1(0x12f)](_0x2521f9);_0x2e5eaf[_0xe8e568[_0x4388c1(0x216)]['brand']][_0x4388c1(0xde)](_0x272146),_0x50ebdc[_0xe8e568[_0x4388c1(0x216)][_0x4388c1(0x1a9)]][_0x4388c1(0xde)](_0xbe3f41[_0x4388c1(0x12f)](_0x1521b4)),_0x55105c[_0xe8e568['_id'][_0x4388c1(0x1a9)]][_0x4388c1(0xde)](_0xbe3f41['format'](_0x3fcac6));var _0x488272=_0xbe3f41[_0x4388c1(0x12f)](_0x2521f9-(_0x3fcac6+_0x1521b4));_0x517ba5+=_0x4388c1(0x194),_0x517ba5+='<td\x20class=\x22row_data\x22></td>',_0x517ba5+=_0x4388c1(0x170)+_0xe8e568[_0x4388c1(0x216)]['brand']+_0x4388c1(0x20c),_0x517ba5+=_0x4388c1(0x170)+_0x2e5eaf[_0xe8e568[_0x4388c1(0x216)]['brand']][0x0]+_0x4388c1(0x20c),_0x517ba5+='<td\x20class=\x22row_data\x22>0</td>',_0x517ba5+=_0x4388c1(0x170)+_0x55105c[_0xe8e568['_id'][_0x4388c1(0x1a9)]][0x0]+_0x4388c1(0x20c),_0x517ba5+=_0x4388c1(0x170)+_0x50ebdc[_0xe8e568['_id']['brand']][0x0]+'</td>',_0x517ba5+=_0x4388c1(0x170)+_0x488272+_0x4388c1(0x20c),_0x517ba5+='</tr>';}}}return console[_0x4388c1(0x13c)](_0x4f0b9c[_0x4388c1(0xe9)]),_0x517ba5;}router[a0_0x381a3d(0x18f)](a0_0x381a3d(0x197),auth,async(_0x42a85f,_0x413532)=>{const _0x2d6dff=a0_0x381a3d,{from_date:_0x2bbf39,to_date:_0x186d29}=_0x42a85f[_0x2d6dff(0x179)],_0x59f225=await dataCheck(_0x2bbf39,_0x186d29);{}let _0x328fb0=_0x2d6dff(0x25a);var _0x1c141b=new Date(_0x2bbf39),_0x18e96=new Date(_0x186d29);const _0x348639={'year':_0x2d6dff(0x101),'month':_0x2d6dff(0xd4),'day':_0x2d6dff(0x101)},_0x3636de=new Intl['DateTimeFormat'](_0x2d6dff(0x246),_0x348639)[_0x2d6dff(0x12f)](_0x1c141b),_0x9273=new Intl['DateTimeFormat'](_0x2d6dff(0x246),_0x348639)[_0x2d6dff(0x12f)](_0x18e96);_0x328fb0+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x328fb0+='<p>FINISHED\x20GOODS\x20INVENTORY</p>',_0x328fb0+=_0x2d6dff(0x1fe)+_0x3636de+_0x2d6dff(0x212)+_0x9273+'</p>',_0x328fb0+=_0x2d6dff(0x104),_0x328fb0+=_0x2d6dff(0x169),_0x328fb0+=_0x2d6dff(0x1b5),_0x328fb0+=_0x2d6dff(0x194),_0x328fb0+=_0x2d6dff(0x23d),_0x328fb0+=_0x2d6dff(0x119),_0x328fb0+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x3636de+_0x2d6dff(0x193),_0x328fb0+=_0x2d6dff(0x13a),_0x328fb0+=_0x2d6dff(0x15b),_0x328fb0+=_0x2d6dff(0x233)+_0x9273+'</th>',_0x328fb0+=_0x2d6dff(0x237),_0x328fb0+=_0x2d6dff(0x194),_0x328fb0+=_0x2d6dff(0x112),_0x328fb0+=_0x2d6dff(0x1af),_0x328fb0+=_0x2d6dff(0x237),_0x328fb0+=_0x59f225,_0x328fb0+='</table>',_0x328fb0+=_0x2d6dff(0x138),_0x328fb0+=_0x2d6dff(0x138);const _0x4e56a8={'format':_0x2d6dff(0x1b6),'orientation':_0x2d6dff(0x117)};pdf[_0x2d6dff(0x168)](_0x328fb0,_0x4e56a8)[_0x2d6dff(0xe3)](function(_0x1defc6,_0x1e44b2){const _0x254663=_0x2d6dff;if(_0x1defc6){_0x413532[_0x254663(0x1f8)](0x1f4)[_0x254663(0x236)](_0x254663(0x154));return;}_0x413532[_0x254663(0x178)](_0x254663(0xe0),_0x254663(0x251)),_0x1e44b2[_0x254663(0x1e2)](_0x413532);});}),router['get'](a0_0x381a3d(0xf2),auth,async(_0x290ef6,_0x45e427)=>{const _0x1ef033=a0_0x381a3d;try{const {username:_0x22ecf1,email:_0x4f7e8f,role:_0x27ad04}=_0x290ef6[_0x1ef033(0x19f)],_0x19d8d0=_0x290ef6[_0x1ef033(0x19f)],_0x29642e=await profile[_0x1ef033(0x127)]({'email':_0x19d8d0[_0x1ef033(0x249)]}),_0x270736={'year':_0x1ef033(0x101),'month':_0x1ef033(0xd4),'day':_0x1ef033(0x101)},_0x105edd=await master_shop[_0x1ef033(0x1c6)](),_0x414d51=await product['find'](),_0x1c9755=await warehouse[_0x1ef033(0x224)]([{'$unwind':_0x1ef033(0x1ff)},{'$lookup':{'from':'products','localField':_0x1ef033(0x1c2),'foreignField':'name','as':_0x1ef033(0x172)}},{'$unwind':_0x1ef033(0xfb)},{'$project':{'product_name':'$product_details.product_name','product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x1ef033(0x222),'product_stock':{'$sum':_0x1ef033(0x256)}}}]);if(_0x105edd[0x0][_0x1ef033(0x17c)]==_0x1ef033(0x235))var _0x44c3cb=users[_0x1ef033(0x147)];else{if(_0x105edd[0x0]['language']==_0x1ef033(0x23f))var _0x44c3cb=users['Hindi'];else{if(_0x105edd[0x0]['language']==_0x1ef033(0x151))var _0x44c3cb=users[_0x1ef033(0x151)];else{if(_0x105edd[0x0][_0x1ef033(0x17c)]=='Spanish')var _0x44c3cb=users[_0x1ef033(0xee)];else{if(_0x105edd[0x0]['language']==_0x1ef033(0x1e0))var _0x44c3cb=users[_0x1ef033(0x1e0)];else{if(_0x105edd[0x0][_0x1ef033(0x17c)]==_0x1ef033(0x230))var _0x44c3cb=users[_0x1ef033(0x244)];else{if(_0x105edd[0x0][_0x1ef033(0x17c)]==_0x1ef033(0x21d))var _0x44c3cb=users[_0x1ef033(0x21d)];else{if(_0x105edd[0x0][_0x1ef033(0x17c)]==_0x1ef033(0x171))var _0x44c3cb=users[_0x1ef033(0x18b)];}}}}}}}_0x45e427[_0x1ef033(0x211)](_0x1ef033(0x1be),{'success':_0x290ef6['flash'](_0x1ef033(0xd2)),'errors':_0x290ef6[_0x1ef033(0x1e4)](_0x1ef033(0x227)),'alldata':_0x414d51,'profile':_0x29642e,'master_shop':_0x105edd,'role':_0x19d8d0,'product_stock':_0x1c9755,'language':_0x44c3cb});}catch(_0xf20383){}});async function agentsdataCheck(_0x106021,_0x1fab23){const _0x5ce8d2=a0_0x381a3d,_0x3f8173=await product[_0x5ce8d2(0x224)]([{'$group':{'_id':{'brand':_0x5ce8d2(0x22a),'category':_0x5ce8d2(0x231)},'products':{'$push':{'name':'$name','product_code':_0x5ce8d2(0x135)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x343eda=[];_0x343eda[_0x5ce8d2(0x107)]=[];for(let _0x8741b6=0x0;_0x8741b6<=_0x3f8173[_0x5ce8d2(0x25e)]-0x1;_0x8741b6++){const _0x3b7da1=_0x3f8173[_0x8741b6];_0x343eda['cat_brand'][_0x5ce8d2(0xde)](_0x3b7da1);}const _0x1b232f=await product[_0x5ce8d2(0x224)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x5ce8d2(0x22a),'product_code':'$product_code','product_name':_0x5ce8d2(0x167)}}}},{'$sort':{'_id.category':-0x1}}]),_0x424d13=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':_0x5ce8d2(0x22a)}}},{'$group':{'_id':_0x5ce8d2(0x184),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4365a5=await sales_sa[_0x5ce8d2(0x224)]([{'$match':{'date':{'$gte':_0x106021,'$lte':_0x1fab23}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5ce8d2(0x1f7)}}},{'$lookup':{'from':'staffs','localField':_0x5ce8d2(0x17b),'foreignField':_0x5ce8d2(0x216),'as':'sales_info'}},{'$unwind':_0x5ce8d2(0x12a)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':'false'}},{'$lookup':{'from':_0x5ce8d2(0xd1),'localField':_0x5ce8d2(0x162),'foreignField':'product_code','as':_0x5ce8d2(0x190)}},{'$unwind':_0x5ce8d2(0x16d)},{'$group':{'_id':{'sales_id':_0x5ce8d2(0x257),'category':_0x5ce8d2(0xfc),'brand':'$product_info.brand'},'salesman_data':{'$first':_0x5ce8d2(0x1bc)},'totalQTY':{'$sum':_0x5ce8d2(0x102)},'products':{'$push':{'qty':_0x5ce8d2(0x102),'product_details':{'prod_name':_0x5ce8d2(0x200),'product_code':'$product_info.product_code','category':_0x5ce8d2(0xfc),'brand':'$product_info.brand'}}}}}]);let _0x4ea0f8='';_0x4ea0f8+=_0x5ce8d2(0x194),_0x4ea0f8+='<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x4ea0f8+=_0x5ce8d2(0x237),_0x4ea0f8+='<tr>',_0x4ea0f8+=_0x5ce8d2(0xe6);for(let _0x502c18=0x0;_0x502c18<=_0x1b232f[_0x5ce8d2(0x25e)]-0x1;_0x502c18++){const _0x57b03e=_0x1b232f[_0x502c18];for(let _0x27b373=0x0;_0x27b373<_0x424d13[_0x5ce8d2(0x25e)];_0x27b373++){const _0x332ceb=_0x424d13[_0x27b373];_0x332ceb[_0x5ce8d2(0x216)]==_0x57b03e[_0x5ce8d2(0x216)]['category']&&(_0x4ea0f8+=_0x5ce8d2(0x176)+_0x332ceb[_0x5ce8d2(0x223)]+_0x5ce8d2(0x1eb)+_0x57b03e['_id'][_0x5ce8d2(0xe1)]+_0x5ce8d2(0x20c));}}_0x4ea0f8+='<td\x20class=\x22cat_data\x22></td>',_0x4ea0f8+='</tr>',_0x4ea0f8+='<tr>',_0x4ea0f8+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>';for(let _0x31d662=0x0;_0x31d662<=_0x1b232f[_0x5ce8d2(0x25e)]-0x1;_0x31d662++){const _0x39cae4=_0x1b232f[_0x31d662];for(let _0x2a3f46=0x0;_0x2a3f46<_0x343eda[_0x5ce8d2(0x107)][_0x5ce8d2(0x25e)];_0x2a3f46++){const _0x225499=_0x343eda[_0x5ce8d2(0x107)][_0x2a3f46];_0x225499[_0x5ce8d2(0x216)][_0x5ce8d2(0xe1)]==_0x39cae4['_id'][_0x5ce8d2(0xe1)]&&(_0x4ea0f8+=_0x5ce8d2(0x1c3)+_0x225499[_0x5ce8d2(0x216)][_0x5ce8d2(0x1a9)]+_0x5ce8d2(0x20c));}}_0x4ea0f8+=_0x5ce8d2(0x1f1),_0x4ea0f8+='</tr>';let _0x390c4c={'name':[],'dataqty':{}};for(let _0x33519b=0x0;_0x33519b<_0x343eda[_0x5ce8d2(0x107)][_0x5ce8d2(0x25e)];_0x33519b++){const _0x2c5921=_0x343eda[_0x5ce8d2(0x107)][_0x33519b],_0x36d8ba=_0x2c5921[_0x5ce8d2(0x216)][_0x5ce8d2(0x1a9)],_0x527c99=_0x2c5921['_id'][_0x5ce8d2(0xe1)];!_0x390c4c[_0x5ce8d2(0x1ea)][_0x36d8ba]&&(_0x390c4c[_0x5ce8d2(0x1ea)][_0x36d8ba]={});!_0x390c4c[_0x5ce8d2(0x1ea)][_0x36d8ba][_0x527c99]&&(_0x390c4c[_0x5ce8d2(0x1ea)][_0x36d8ba][_0x527c99]=[]);for(let _0x1a6e14=0x0;_0x1a6e14<_0x4365a5['length'];_0x1a6e14++){const _0x2b5042=_0x4365a5[_0x1a6e14];if(_0x36d8ba===_0x2b5042[_0x5ce8d2(0x216)][_0x5ce8d2(0x1a9)]&&_0x527c99===_0x2b5042[_0x5ce8d2(0x216)][_0x5ce8d2(0xe1)]){const _0x43d8fa=_0x2b5042[_0x5ce8d2(0x19e)];!_0x390c4c[_0x5ce8d2(0x1ea)][_0x36d8ba][_0x527c99][_0x43d8fa]&&(_0x390c4c[_0x5ce8d2(0x1ea)][_0x36d8ba][_0x527c99][_0x43d8fa]=[]),_0x390c4c[_0x5ce8d2(0x1ea)][_0x36d8ba][_0x527c99][_0x43d8fa]['push'](_0x2b5042[_0x5ce8d2(0xe7)]),!_0x390c4c['name'][_0x5ce8d2(0x160)](_0x43d8fa)&&_0x390c4c[_0x5ce8d2(0x118)][_0x5ce8d2(0xde)](_0x43d8fa);}}}_0x4ea0f8+='<tr>';for(let _0x107da2=0x0;_0x107da2<=_0x390c4c[_0x5ce8d2(0x118)]['length']-0x1;_0x107da2++){const _0x243a8f=_0x390c4c[_0x5ce8d2(0x118)][_0x107da2];_0x4ea0f8+=_0x5ce8d2(0x170)+_0x243a8f+_0x5ce8d2(0x20c);var _0x4b1582=0x0,_0xd74f24=0x0;for(let _0x10752b=0x0;_0x10752b<=_0x343eda[_0x5ce8d2(0x107)]['length']-0x1;_0x10752b++){const _0x20ec6c=_0x343eda[_0x5ce8d2(0x107)][_0x10752b];var _0x4cbc5d=0x0;_0x390c4c['dataqty'][_0x20ec6c[_0x5ce8d2(0x216)][_0x5ce8d2(0x1a9)]][_0x20ec6c[_0x5ce8d2(0x216)][_0x5ce8d2(0xe1)]][_0x243a8f]?(_0x4cbc5d=_0x390c4c[_0x5ce8d2(0x1ea)][_0x20ec6c[_0x5ce8d2(0x216)][_0x5ce8d2(0x1a9)]][_0x20ec6c[_0x5ce8d2(0x216)]['category']][_0x243a8f][0x0],_0x4ea0f8+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x4cbc5d[_0x5ce8d2(0x1e6)](0x2))+_0x5ce8d2(0x20c)):(_0x4cbc5d=0x0,_0x4ea0f8+=_0x5ce8d2(0x170)+_0x4cbc5d+_0x5ce8d2(0x20c)),_0x4b1582+=_0x4cbc5d;}_0x4ea0f8+=_0x5ce8d2(0x170)+formatNumber(_0x4b1582[_0x5ce8d2(0x1e6)](0x2))+'</td>';}return _0x4ea0f8+=_0x5ce8d2(0x237),_0x4ea0f8;}router[a0_0x381a3d(0x18f)](a0_0x381a3d(0xed),auth,async(_0x43d754,_0x1116e3)=>{const _0x1d5839=a0_0x381a3d,{from_date:_0x250f0d,to_date:_0x13580d}=_0x43d754['body'],_0x29137b=await agentsdataCheck(_0x250f0d,_0x13580d);{}let _0xe00dd1=_0x1d5839(0x183);var _0x67a356=new Date(_0x250f0d),_0x5cde5c=new Date(_0x13580d);const _0xab297c={'year':_0x1d5839(0x101),'month':_0x1d5839(0xd4),'day':_0x1d5839(0x101)},_0x394893=new Intl[(_0x1d5839(0x157))](_0x1d5839(0x246),_0xab297c)[_0x1d5839(0x12f)](_0x67a356),_0x4ef914=new Intl[(_0x1d5839(0x157))]('en-US',_0xab297c)['format'](_0x5cde5c);_0xe00dd1+=_0x1d5839(0x17e),_0xe00dd1+=_0x1d5839(0x12d),_0xe00dd1+=_0x1d5839(0x1fe)+_0x394893+'\x20-\x20'+_0x4ef914+'</p>',_0xe00dd1+=_0x1d5839(0x104),_0xe00dd1+='<div\x20class=\x22col-sm-11\x22>',_0xe00dd1+='<table>',_0xe00dd1+=_0x29137b,_0xe00dd1+=_0x1d5839(0x10b),_0xe00dd1+=_0x1d5839(0x138),_0xe00dd1+=_0x1d5839(0x138);const _0x408f01={'format':_0x1d5839(0x1b6),'orientation':_0x1d5839(0x117)};pdf['create'](_0xe00dd1,_0x408f01)['toStream'](function(_0x27cc11,_0x4bb92c){const _0x3bc7f7=_0x1d5839;if(_0x27cc11){_0x1116e3[_0x3bc7f7(0x1f8)](0x1f4)[_0x3bc7f7(0x236)](_0x3bc7f7(0x154));return;}_0x1116e3[_0x3bc7f7(0x178)](_0x3bc7f7(0xe0),'application/pdf'),_0x4bb92c[_0x3bc7f7(0x1e2)](_0x1116e3);});}),router[a0_0x381a3d(0x105)](a0_0x381a3d(0x185),auth,async(_0x3cc0f6,_0x33ae5d)=>{const _0x381783=a0_0x381a3d;try{const {username:_0x501fc7,email:_0x17ce44,role:_0x42eb56}=_0x3cc0f6[_0x381783(0x19f)],_0x112eb9=_0x3cc0f6[_0x381783(0x19f)],_0x1523d5=await profile[_0x381783(0x127)]({'email':_0x112eb9[_0x381783(0x249)]}),_0x4f434d={'year':'numeric','month':_0x381783(0xd4),'day':_0x381783(0x101)},_0x45f53f=await master_shop['find'](),_0x16aadd=await staff[_0x381783(0x127)]({'email':_0x112eb9['email']}),_0x5d77de=await product[_0x381783(0x1c6)](),_0x2a5ea2=await warehouse[_0x381783(0x224)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x381783(0xd1),'localField':_0x381783(0x1c2),'foreignField':_0x381783(0x118),'as':'product_docs'}},{'$unwind':_0x381783(0xfb)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x381783(0x123)}},{'$group':{'_id':_0x381783(0x222),'product_stock':{'$sum':'$product_stock'}}}]),_0x3a7200=await staff[_0x381783(0x1c6)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x45f53f[0x0][_0x381783(0x17c)]==_0x381783(0x235))var _0x59c82a=users['English'];else{if(_0x45f53f[0x0][_0x381783(0x17c)]==_0x381783(0x23f))var _0x59c82a=users[_0x381783(0x23f)];else{if(_0x45f53f[0x0][_0x381783(0x17c)]=='German')var _0x59c82a=users[_0x381783(0x151)];else{if(_0x45f53f[0x0]['language']==_0x381783(0xee))var _0x59c82a=users[_0x381783(0xee)];else{if(_0x45f53f[0x0][_0x381783(0x17c)]==_0x381783(0x1e0))var _0x59c82a=users[_0x381783(0x1e0)];else{if(_0x45f53f[0x0][_0x381783(0x17c)]=='Portuguese\x20(BR)')var _0x59c82a=users[_0x381783(0x244)];else{if(_0x45f53f[0x0]['language']==_0x381783(0x21d))var _0x59c82a=users['Chinese'];else{if(_0x45f53f[0x0][_0x381783(0x17c)]=='Arabic\x20(ae)')var _0x59c82a=users[_0x381783(0x18b)];}}}}}}}_0x33ae5d[_0x381783(0x211)](_0x381783(0x1f5),{'success':_0x3cc0f6[_0x381783(0x1e4)](_0x381783(0xd2)),'errors':_0x3cc0f6[_0x381783(0x1e4)]('errors'),'alldata':_0x5d77de,'profile':_0x1523d5,'master_shop':_0x45f53f,'role':_0x112eb9,'product_stock':_0x2a5ea2,'language':_0x59c82a,'staff_arr':_0x16aadd,'staff_data_all':_0x3a7200});}catch(_0x50e548){_0x33ae5d['json'](_0x50e548);}});async function agentsdataDSICheck_admin(_0x524f26,_0x1331d3,_0x2ceb7f,_0x22f105){const _0x3ec285=a0_0x381a3d,_0x12ac4a=await product[_0x3ec285(0x224)]([{'$group':{'_id':{'brand':'$brand','category':_0x3ec285(0x231)},'products':{'$push':{'name':_0x3ec285(0x167),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x50bb02=[];_0x50bb02[_0x3ec285(0x107)]=[];for(let _0x3f5f68=0x0;_0x3f5f68<=_0x12ac4a[_0x3ec285(0x25e)]-0x1;_0x3f5f68++){const _0x18c6c0=_0x12ac4a[_0x3f5f68];_0x50bb02[_0x3ec285(0x107)][_0x3ec285(0xde)](_0x18c6c0);}const _0x4b6cf9=await product[_0x3ec285(0x224)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x3ec285(0x22a),'product_code':_0x3ec285(0x135),'product_name':_0x3ec285(0x167)}}}},{'$sort':{'_id.category':-0x1}}]),_0x3748ee=await product[_0x3ec285(0x224)]([{'$group':{'_id':{'category':_0x3ec285(0x231),'brand':_0x3ec285(0x22a)}}},{'$group':{'_id':_0x3ec285(0x184),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3b15f7=await sales_sa[_0x3ec285(0x224)]([{'$match':{'date':{'$gte':_0x524f26,'$lte':_0x1331d3},'sales_staff_id':_0x2ceb7f,'sale_product.isFG':_0x3ec285(0x215)}},{'$unwind':_0x3ec285(0x1de)},{'$match':{'sale_product.isFG':_0x3ec285(0x215)}},{'$lookup':{'from':_0x3ec285(0xd1),'localField':_0x3ec285(0x162),'foreignField':_0x3ec285(0x144),'as':_0x3ec285(0x190)}},{'$unwind':_0x3ec285(0x16d)},{'$group':{'_id':{'dsi':_0x3ec285(0x1a0),'date':'$date','customer':_0x3ec285(0xd9)},'totalQty':{'$sum':_0x3ec285(0x102)},'products':{'$push':{'qty':_0x3ec285(0x102),'NetPrice':'$sale_product.totalprice','discount':_0x3ec285(0x1f0),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x3ec285(0x200),'product_code':'$product_info.product_code','category':_0x3ec285(0xfc),'brand':_0x3ec285(0xe4),'gross_price':_0x3ec285(0x11d)}}}}},{'$unwind':_0x3ec285(0x225)},{'$group':{'_id':{'dsi':_0x3ec285(0x214),'date':_0x3ec285(0x21e),'customer':_0x3ec285(0x129),'category':_0x3ec285(0x255),'brand':_0x3ec285(0x180)},'totalQty':{'$sum':_0x3ec285(0x24a)},'totalGross':{'$sum':{'$multiply':[_0x3ec285(0x24a),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x3ec285(0x1ac)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x3ec285(0x1a7)},'product_details':{'$first':_0x3ec285(0x175)}}},{'$group':{'_id':{'dsi':_0x3ec285(0x214),'date':_0x3ec285(0x21e),'customer':_0x3ec285(0x129)},'totalQty':{'$sum':_0x3ec285(0x1b4)},'totalGross':{'$sum':_0x3ec285(0xf5)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x3ec285(0x156)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x3ec285(0x1b4),'category':_0x3ec285(0x184),'brand':_0x3ec285(0x158),'product_details':_0x3ec285(0x1ff)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x1e685f=[],_0x1f8799={},_0x5acbac={},_0x2a8af3={};var _0x3433e1=0x0,_0x321ed5=0x0,_0x2318cf=0x0,_0x147d71=0x0,_0x5c7b18=0x0;const _0x13071c=0x6;for(let _0x55643b=0x0;_0x55643b<=_0x3b15f7[_0x3ec285(0x25e)]-0x1;_0x55643b++){const _0x29e1d9=_0x3b15f7[_0x55643b];let _0x94394b=_0x3ec285(0x194);_0x94394b+=_0x3ec285(0x1cf)+_0x29e1d9['_id'][_0x3ec285(0x17a)]+_0x3ec285(0x20c),_0x94394b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x29e1d9[_0x3ec285(0x216)][_0x3ec285(0x1d0)]+_0x3ec285(0x20c),_0x94394b+=_0x3ec285(0x1cf)+_0x29e1d9[_0x3ec285(0x216)][_0x3ec285(0x207)]+'</td>';let _0xf2cfaa={};var _0x5be144=0x0;for(let _0x275367=0x0;_0x275367<=_0x29e1d9[_0x3ec285(0xd1)]['length']-0x1;_0x275367++){const _0x5ed191=_0x29e1d9[_0x3ec285(0xd1)][_0x275367];_0xf2cfaa[_0x5ed191[_0x3ec285(0x1a9)]+'-'+_0x5ed191[_0x3ec285(0xe1)]]=_0x5ed191[_0x3ec285(0x201)];const _0x317e72=_0x5ed191[_0x3ec285(0x1a9)]+'-'+_0x5ed191[_0x3ec285(0xe1)];!_0x1f8799[_0x317e72]&&(_0x1f8799[_0x317e72]=0x0),!Array[_0x3ec285(0x124)](_0x2a8af3[_0x317e72])&&(_0x2a8af3[_0x317e72]=[]),!Array[_0x3ec285(0x124)](_0x2a8af3[_0x317e72])&&(_0x2a8af3[_0x317e72]=[]),_0x1f8799[_0x317e72]+=_0x5ed191['qty'],_0x2a8af3[_0x317e72][_0x3ec285(0xde)](_0x5ed191[_0x3ec285(0x201)]),_0x5be144++;}console[_0x3ec285(0x13c)](_0x29e1d9);for(let _0x40189d=0x0;_0x40189d<=_0x50bb02[_0x3ec285(0x107)][_0x3ec285(0x25e)]-0x1;_0x40189d++){const _0x1b15d9=_0x50bb02[_0x3ec285(0x107)][_0x40189d],_0x1957ff=_0x1b15d9['_id']['brand']+'-'+_0x1b15d9[_0x3ec285(0x216)][_0x3ec285(0xe1)];_0x94394b+=_0x3ec285(0x208)+(_0xf2cfaa[_0x1957ff]!==undefined?_0xf2cfaa[_0x1957ff][_0x3ec285(0x1e6)](0x2):'')+'</td>';}_0x2318cf=_0x29e1d9['discount']+_0x29e1d9[_0x3ec285(0x17f)],_0x94394b+=_0x3ec285(0x22b)+formatNumber(parseFloat(_0x29e1d9[_0x3ec285(0x195)],0x2)[_0x3ec285(0x1e6)](0x2))+_0x3ec285(0x20c),_0x94394b+=_0x3ec285(0x22b)+formatNumber(_0x29e1d9[_0x3ec285(0x259)][_0x3ec285(0x1e6)](0x2))+'</td>',_0x94394b+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x2318cf)+'</td>',_0x94394b+=_0x3ec285(0x22b)+formatNumber(_0x29e1d9[_0x3ec285(0x114)]['toFixed'](0x2))+'</td>',_0x94394b+='</tr>',_0x3433e1+=parseFloat(_0x29e1d9[_0x3ec285(0x195)]['toFixed'](0x2)),_0x321ed5+=parseFloat(_0x29e1d9[_0x3ec285(0x114)][_0x3ec285(0x1e6)](0x2)),_0x147d71+=_0x2318cf,_0x5c7b18+=parseFloat(_0x29e1d9[_0x3ec285(0x259)][_0x3ec285(0x1e6)](0x2));if(_0x55643b==_0x3b15f7[_0x3ec285(0x25e)]-0x1){_0x94394b+=_0x3ec285(0x194),_0x94394b+=_0x3ec285(0x14d),_0x94394b+=_0x3ec285(0x20c);for(let _0x53cd91=0x0;_0x53cd91<=_0x50bb02[_0x3ec285(0x107)][_0x3ec285(0x25e)]-0x1;_0x53cd91++){const _0x558eab=_0x50bb02[_0x3ec285(0x107)][_0x53cd91],_0x11b123=_0x558eab[_0x3ec285(0x216)]['brand']+'-'+_0x558eab['_id']['category'],_0x27f94c=_0x2a8af3[_0x11b123][_0x3ec285(0x210)]((_0x2ef1b8,_0x129f98)=>_0x2ef1b8+_0x129f98,0x0);console['log'](_0x3ec285(0x1c1),_0x11b123),_0x94394b+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x27f94c!==undefined?formatNumber(_0x27f94c[_0x3ec285(0x1e6)](0x2)):'')+_0x3ec285(0x23a),console['log'](_0x2a8af3[_0x11b123]['reduce']((_0x31ce28,_0x12d66b)=>_0x31ce28+_0x12d66b,0x0));}_0x94394b+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3433e1['toFixed'](0x2))+_0x3ec285(0x23a),_0x94394b+=_0x3ec285(0x14a)+formatNumber(_0x5c7b18)+_0x3ec285(0x23a),_0x94394b+=_0x3ec285(0x14a)+formatNumber(_0x147d71)+_0x3ec285(0x23a),_0x94394b+=_0x3ec285(0x14a)+formatNumber(_0x321ed5)+_0x3ec285(0x23a),_0x94394b+=_0x3ec285(0x237);}_0x1e685f[_0x3ec285(0xde)](_0x94394b);}function _0x5d992a(_0x6f8495,_0x2ee9b7){const _0x5af0dd=_0x3ec285,_0x5ac520=[];for(let _0x3d428e=0x0;_0x3d428e<=_0x6f8495[_0x5af0dd(0x25e)]-0x1;_0x3d428e+=_0x2ee9b7){_0x5ac520[_0x5af0dd(0xde)](_0x6f8495[_0x5af0dd(0x1b3)](_0x3d428e,_0x3d428e+_0x2ee9b7));}return _0x5ac520;}const _0x2cafc4=_0x5d992a(_0x1e685f,_0x13071c);let _0x3a3d8b='';return _0x2cafc4['forEach']((_0xbf31d5,_0x3c3c22)=>{const _0x3a44a9=_0x3ec285;_0x3c3c22>0x0&&(_0x3a3d8b+=_0x3a44a9(0x247));_0x3a3d8b+='<table>',_0x3a3d8b+=_0x3a44a9(0x1b7),_0x3a3d8b+=_0x3a44a9(0x194),_0x3a3d8b+=_0x3a44a9(0x188),_0x3a3d8b+=_0x3a44a9(0x237),_0x3a3d8b+='<tr>',_0x3a3d8b+=_0x3a44a9(0x1ee);for(let _0x23b8b0=0x0;_0x23b8b0<=_0x4b6cf9['length']-0x1;_0x23b8b0++){const _0x155408=_0x4b6cf9[_0x23b8b0];for(let _0x473115=0x0;_0x473115<_0x3748ee[_0x3a44a9(0x25e)];_0x473115++){const _0x56b960=_0x3748ee[_0x473115];_0x56b960['_id']===_0x155408[_0x3a44a9(0x216)][_0x3a44a9(0xe1)]&&(_0x3a3d8b+='<td\x20colspan=\x22'+_0x56b960[_0x3a44a9(0x223)]+'\x22\x20class=\x22cat_data\x22>'+_0x155408[_0x3a44a9(0x216)][_0x3a44a9(0xe1)]+_0x3a44a9(0x20c));}}_0x3a3d8b+=_0x3a44a9(0x17d),_0x3a3d8b+=_0x3a44a9(0x237),_0x3a3d8b+=_0x3a44a9(0x194),_0x3a3d8b+=_0x3a44a9(0x25c),_0x3a3d8b+=_0x3a44a9(0x15f),_0x3a3d8b+=_0x3a44a9(0x19a);for(let _0x52396d=0x0;_0x52396d<=_0x4b6cf9[_0x3a44a9(0x25e)]-0x1;_0x52396d++){const _0xc4ded0=_0x4b6cf9[_0x52396d];for(let _0x217c5b=0x0;_0x217c5b<_0x50bb02['cat_brand'][_0x3a44a9(0x25e)];_0x217c5b++){const _0x3a716e=_0x50bb02['cat_brand'][_0x217c5b];_0x3a716e[_0x3a44a9(0x216)]['category']===_0xc4ded0['_id'][_0x3a44a9(0xe1)]&&(_0x3a3d8b+=_0x3a44a9(0x1c3)+_0x3a716e[_0x3a44a9(0x216)][_0x3a44a9(0x1a9)]+_0x3a44a9(0x20c));}}_0x3a3d8b+=_0x3a44a9(0x1f1),_0x3a3d8b+=_0x3a44a9(0x242),_0x3a3d8b+=_0x3a44a9(0x150),_0x3a3d8b+=_0x3a44a9(0x202),_0x3a3d8b+=_0x3a44a9(0x237),_0x3a3d8b+='</thead>',_0x3a3d8b+=_0x3a44a9(0x16c),_0xbf31d5[_0x3a44a9(0x1d4)](_0x29eea2=>{_0x3a3d8b+=_0x29eea2;}),console[_0x3a44a9(0x13c)](_0x2a8af3),_0x3a3d8b+='</tbody>',_0x3a3d8b+=_0x3a44a9(0x10b);}),_0x3a3d8b;}async function agentsdataDSICheck_admin_excel(_0x513524,_0x45fbba,_0x4b3905,_0x25c07c){const _0x14555f=a0_0x381a3d,_0x253efa=await product[_0x14555f(0x224)]([{'$group':{'_id':{'brand':_0x14555f(0x22a),'category':'$category'},'products':{'$push':{'name':_0x14555f(0x167),'product_code':_0x14555f(0x135)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x362c33=[];_0x362c33[_0x14555f(0x107)]=[];for(let _0x22a05e=0x0;_0x22a05e<=_0x253efa['length']-0x1;_0x22a05e++){const _0xc975f5=_0x253efa[_0x22a05e];_0x362c33[_0x14555f(0x107)][_0x14555f(0xde)](_0xc975f5);}const _0x55056a=await product[_0x14555f(0x224)]([{'$group':{'_id':{'category':_0x14555f(0x231)},'products':{'$push':{'brand':_0x14555f(0x22a),'product_code':'$product_code','product_name':_0x14555f(0x167)}}}},{'$sort':{'_id.category':-0x1}}]),_0x575dbc=await product[_0x14555f(0x224)]([{'$group':{'_id':{'category':_0x14555f(0x231),'brand':_0x14555f(0x22a)}}},{'$group':{'_id':_0x14555f(0x184),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x438a03=await sales_sa[_0x14555f(0x224)]([{'$match':{'date':{'$gte':_0x513524,'$lte':_0x45fbba},'sales_staff_id':_0x4b3905,'sale_product.isFG':_0x14555f(0x215)}},{'$unwind':_0x14555f(0x1de)},{'$match':{'sale_product.isFG':_0x14555f(0x215)}},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':_0x14555f(0x144),'as':_0x14555f(0x190)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x14555f(0x1a0),'date':_0x14555f(0x25b),'customer':_0x14555f(0xd9)},'totalQty':{'$sum':_0x14555f(0x102)},'products':{'$push':{'qty':_0x14555f(0x102),'NetPrice':_0x14555f(0x1b0),'discount':_0x14555f(0x1f0),'adj_discount':_0x14555f(0x24b),'product_details':{'prod_name':_0x14555f(0x200),'product_code':_0x14555f(0x15e),'category':_0x14555f(0xfc),'brand':_0x14555f(0xe4),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x14555f(0x214),'date':_0x14555f(0x21e),'customer':_0x14555f(0x129),'category':'$products.product_details.category','brand':_0x14555f(0x180)},'totalQty':{'$sum':_0x14555f(0x24a)},'totalGross':{'$sum':{'$multiply':[_0x14555f(0x24a),_0x14555f(0x1f9)]}},'NetPrice':{'$sum':_0x14555f(0x1ac)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':_0x14555f(0x1a7)},'product_details':{'$first':_0x14555f(0x175)}}},{'$group':{'_id':{'dsi':_0x14555f(0x214),'date':_0x14555f(0x21e),'customer':_0x14555f(0x129)},'totalQty':{'$sum':_0x14555f(0x1b4)},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0x14555f(0x132)},'discount':{'$sum':_0x14555f(0x156)},'adj_discount':{'$sum':_0x14555f(0xd8)},'products':{'$push':{'qty':'$totalQty','category':_0x14555f(0x184),'brand':_0x14555f(0x158),'product_details':_0x14555f(0x1ff)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0xc13616=[],_0x26f092={},_0x7e6c9d={},_0xc918de={};var _0x5b19f3=0x0,_0x120351=0x0,_0x2b558d=0x0,_0x330fbf=0x0,_0x425636=0x0;const _0x1f5c47=0x16345785d8a0000;for(let _0x5a9c95=0x0;_0x5a9c95<=_0x438a03[_0x14555f(0x25e)]-0x1;_0x5a9c95++){const _0xd9210a=_0x438a03[_0x5a9c95];let _0xda1e39='<tr>';_0xda1e39+=_0x14555f(0x1cf)+_0xd9210a['_id'][_0x14555f(0x17a)]+_0x14555f(0x20c),_0xda1e39+=_0x14555f(0x1cf)+_0xd9210a[_0x14555f(0x216)]['date']+_0x14555f(0x20c),_0xda1e39+=_0x14555f(0x1cf)+_0xd9210a[_0x14555f(0x216)]['customer']+'</td>';let _0x4cc0a2={};var _0x30ad12=0x0;for(let _0x5906d7=0x0;_0x5906d7<=_0xd9210a['products'][_0x14555f(0x25e)]-0x1;_0x5906d7++){const _0x114d01=_0xd9210a[_0x14555f(0xd1)][_0x5906d7];_0x4cc0a2[_0x114d01[_0x14555f(0x1a9)]+'-'+_0x114d01['category']]=_0x114d01['qty'];const _0x4cb8a3=_0x114d01[_0x14555f(0x1a9)]+'-'+_0x114d01[_0x14555f(0xe1)];!_0x26f092[_0x4cb8a3]&&(_0x26f092[_0x4cb8a3]=0x0),!Array['isArray'](_0xc918de[_0x4cb8a3])&&(_0xc918de[_0x4cb8a3]=[]),!Array[_0x14555f(0x124)](_0xc918de[_0x4cb8a3])&&(_0xc918de[_0x4cb8a3]=[]),_0x26f092[_0x4cb8a3]+=_0x114d01[_0x14555f(0x201)],_0xc918de[_0x4cb8a3]['push'](_0x114d01['qty']),_0x30ad12++;}console[_0x14555f(0x13c)](_0xd9210a);for(let _0x3b9113=0x0;_0x3b9113<=_0x362c33[_0x14555f(0x107)]['length']-0x1;_0x3b9113++){const _0x3f9dd6=_0x362c33[_0x14555f(0x107)][_0x3b9113],_0x269fd3=_0x3f9dd6[_0x14555f(0x216)]['brand']+'-'+_0x3f9dd6[_0x14555f(0x216)][_0x14555f(0xe1)];_0xda1e39+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x4cc0a2[_0x269fd3]!==undefined?_0x4cc0a2[_0x269fd3][_0x14555f(0x1e6)](0x2):'')+_0x14555f(0x20c);}_0x2b558d=_0xd9210a[_0x14555f(0x103)]+_0xd9210a[_0x14555f(0x17f)],_0xda1e39+=_0x14555f(0x22b)+formatNumber(parseFloat(_0xd9210a['totalQty'],0x2)[_0x14555f(0x1e6)](0x2))+_0x14555f(0x20c),_0xda1e39+=_0x14555f(0x22b)+formatNumber(_0xd9210a[_0x14555f(0x259)][_0x14555f(0x1e6)](0x2))+_0x14555f(0x20c),_0xda1e39+=_0x14555f(0x22b)+formatNumber(_0x2b558d)+'</td>',_0xda1e39+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xd9210a[_0x14555f(0x114)][_0x14555f(0x1e6)](0x2))+'</td>',_0xda1e39+=_0x14555f(0x237),_0x5b19f3+=parseFloat(_0xd9210a[_0x14555f(0x195)][_0x14555f(0x1e6)](0x2)),_0x120351+=parseFloat(_0xd9210a[_0x14555f(0x114)]['toFixed'](0x2)),_0x330fbf+=_0x2b558d,_0x425636+=parseFloat(_0xd9210a[_0x14555f(0x259)][_0x14555f(0x1e6)](0x2));if(_0x5a9c95==_0x438a03[_0x14555f(0x25e)]-0x1){_0xda1e39+='<tr>',_0xda1e39+=_0x14555f(0x14d),_0xda1e39+=_0x14555f(0x20c);for(let _0x29d880=0x0;_0x29d880<=_0x362c33[_0x14555f(0x107)][_0x14555f(0x25e)]-0x1;_0x29d880++){const _0x33bb2e=_0x362c33[_0x14555f(0x107)][_0x29d880],_0x3208fe=_0x33bb2e['_id'][_0x14555f(0x1a9)]+'-'+_0x33bb2e[_0x14555f(0x216)][_0x14555f(0xe1)],_0x62422f=_0xc918de[_0x3208fe][_0x14555f(0x210)]((_0x4f3a70,_0x3f22df)=>_0x4f3a70+_0x3f22df,0x0);console['log']('test',_0x3208fe),_0xda1e39+=_0x14555f(0x139)+(_0x62422f!==undefined?formatNumber(_0x62422f[_0x14555f(0x1e6)](0x2)):'')+_0x14555f(0x23a),console['log'](_0xc918de[_0x3208fe][_0x14555f(0x210)]((_0xf71791,_0x2ec6ca)=>_0xf71791+_0x2ec6ca,0x0));}_0xda1e39+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x5b19f3['toFixed'](0x2))+'</b></td>',_0xda1e39+=_0x14555f(0x14a)+formatNumber(_0x425636)+'</b></td>',_0xda1e39+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x330fbf)+_0x14555f(0x23a),_0xda1e39+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x120351)+'</b></td>',_0xda1e39+=_0x14555f(0x237);}_0xc13616[_0x14555f(0xde)](_0xda1e39);}function _0x128156(_0xc2920e,_0xc3dbe7){const _0x39fc37=_0x14555f,_0x2ed3a0=[];for(let _0x35395e=0x0;_0x35395e<=_0xc2920e['length']-0x1;_0x35395e+=_0xc3dbe7){_0x2ed3a0[_0x39fc37(0xde)](_0xc2920e['slice'](_0x35395e,_0x35395e+_0xc3dbe7));}return _0x2ed3a0;}const _0xfa1441=_0x128156(_0xc13616,_0x1f5c47);let _0x15c88c='';return _0xfa1441[_0x14555f(0x1d4)]((_0x574a8d,_0xf4abd4)=>{const _0x33db48=_0x14555f;_0xf4abd4>0x0&&(_0x15c88c+=_0x33db48(0x247));_0x15c88c+='<table>',_0x15c88c+=_0x33db48(0x1b7),_0x15c88c+=_0x33db48(0x194),_0x15c88c+=_0x33db48(0x188),_0x15c88c+=_0x33db48(0x237),_0x15c88c+=_0x33db48(0x194),_0x15c88c+=_0x33db48(0x1ee);for(let _0x80b74b=0x0;_0x80b74b<=_0x55056a[_0x33db48(0x25e)]-0x1;_0x80b74b++){const _0x49230b=_0x55056a[_0x80b74b];for(let _0x10d292=0x0;_0x10d292<_0x575dbc[_0x33db48(0x25e)];_0x10d292++){const _0x3cb55a=_0x575dbc[_0x10d292];_0x3cb55a['_id']===_0x49230b[_0x33db48(0x216)][_0x33db48(0xe1)]&&(_0x15c88c+=_0x33db48(0x176)+_0x3cb55a['brandCount']+'\x22\x20class=\x22cat_data\x22>'+_0x49230b[_0x33db48(0x216)][_0x33db48(0xe1)]+_0x33db48(0x20c));}}_0x15c88c+=_0x33db48(0x17d),_0x15c88c+=_0x33db48(0x237),_0x15c88c+=_0x33db48(0x194),_0x15c88c+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x15c88c+=_0x33db48(0x15f),_0x15c88c+=_0x33db48(0x19a);for(let _0x59beb4=0x0;_0x59beb4<=_0x55056a['length']-0x1;_0x59beb4++){const _0x1e2664=_0x55056a[_0x59beb4];for(let _0x2db77a=0x0;_0x2db77a<_0x362c33['cat_brand']['length'];_0x2db77a++){const _0x51a498=_0x362c33[_0x33db48(0x107)][_0x2db77a];_0x51a498[_0x33db48(0x216)][_0x33db48(0xe1)]===_0x1e2664['_id'][_0x33db48(0xe1)]&&(_0x15c88c+='<td\x20class=\x22cat_data\x22>'+_0x51a498[_0x33db48(0x216)]['brand']+'</td>');}}_0x15c88c+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x15c88c+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x15c88c+=_0x33db48(0x150),_0x15c88c+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x15c88c+='</tr>',_0x15c88c+='</thead>',_0x15c88c+=_0x33db48(0x16c),_0x574a8d[_0x33db48(0x1d4)](_0xec7d89=>{_0x15c88c+=_0xec7d89;}),console[_0x33db48(0x13c)](_0xc918de),_0x15c88c+=_0x33db48(0x159),_0x15c88c+='</table>';}),_0x15c88c;}router[a0_0x381a3d(0x18f)](a0_0x381a3d(0x16a),auth,async(_0x577456,_0x25394d)=>{const _0x5f1be8=a0_0x381a3d,{from_date:_0x3aa20d,to_date:_0xd3dbde,isExcel:_0x5ad870,agent_id:_0x55c5db}=_0x577456[_0x5f1be8(0x179)],_0xa709fa=_0x577456['user'],_0x50122a=await staff['findOne']({'email':_0xa709fa[_0x5f1be8(0x249)]}),_0x49a91d=await master_shop[_0x5f1be8(0x1c6)](),_0x4ce181=await agentsdataDSICheck_admin(_0x3aa20d,_0xd3dbde,_0x55c5db,_0x5ad870),_0x448f12=await agentsdataDSICheck_admin_excel(_0x3aa20d,_0xd3dbde,_0x55c5db,_0x5ad870);let _0xbdfbc5=_0x5f1be8(0x23e);var _0x1a6d6f=new Date(_0x3aa20d),_0x35c888=new Date(_0xd3dbde);const _0x900485={'year':'numeric','month':_0x5f1be8(0xd4),'day':_0x5f1be8(0x101)},_0x24be34=new Intl['DateTimeFormat'](_0x5f1be8(0x246),_0x900485)[_0x5f1be8(0x12f)](_0x1a6d6f),_0x462725=new Intl[(_0x5f1be8(0x157))]('en-US',_0x900485)['format'](_0x35c888);_0xbdfbc5+=_0x5f1be8(0x104),_0xbdfbc5+=_0x5f1be8(0x18c),_0xbdfbc5+=_0x5f1be8(0x1b5),_0xbdfbc5+=_0x4ce181,_0xbdfbc5+=_0x5f1be8(0x10b),_0xbdfbc5+=_0x5f1be8(0x138),_0xbdfbc5+=_0x5f1be8(0x138);let _0x1e1797=_0x5f1be8(0x23e);_0x1e1797+=_0x5f1be8(0x104),_0x1e1797+=_0x5f1be8(0x18c),_0x1e1797+=_0x5f1be8(0x1b5),_0x1e1797+=_0x448f12,_0x1e1797+=_0x5f1be8(0x10b),_0x1e1797+='</div>',_0x1e1797+=_0x5f1be8(0x138);let _0x23a318=_0x5f1be8(0x13d);const _0x2300f5={'width':_0x5f1be8(0x1f3),'height':'8.5in','orientation':_0x5f1be8(0x117),'border':{'top':_0x5f1be8(0x10e),'right':_0x5f1be8(0x10e),'bottom':_0x5f1be8(0x10e),'left':_0x5f1be8(0x10e)},'header':{'height':'60mm','contents':_0x5f1be8(0xd7)+_0x23a318+_0x5f1be8(0x1e8)+_0x24be34+_0x5f1be8(0x212)+_0x462725+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x5f1be8(0x1da),'contents':{'default':_0x5f1be8(0xe5)}},'dpi':0x5,'zoomFactor':'1'};if(_0x5ad870=='on'){const _0xddde9f=cheerio[_0x5f1be8(0x24e)](_0x1e1797);let _0x575b31=[],_0x1c6a35=[],_0x10423f=[];_0xddde9f(_0x5f1be8(0x137))[_0x5f1be8(0x10a)]((_0x4cfea5,_0x32592b)=>{const _0x4cc8b6=_0x5f1be8;let _0x4da4f3=[],_0x26f394=0x0;while(_0x10423f[_0x26f394]){_0x10423f[_0x26f394]--,_0x26f394++;}_0xddde9f(_0x32592b)['find']('td,\x20th')['each']((_0x297a3e,_0x6b1bf7)=>{const _0x3f0958=a0_0x5084;let _0x1cc93b=_0xddde9f(_0x6b1bf7)[_0x3f0958(0x130)]()[_0x3f0958(0x106)](),_0x45ed5d=parseFloat(_0x1cc93b[_0x3f0958(0x196)](/,/g,''));isNaN(_0x45ed5d)&&(_0x45ed5d=_0x1cc93b);let _0x2119a8=parseInt(_0xddde9f(_0x6b1bf7)['attr'](_0x3f0958(0x21a)))||0x1,_0x325d65=parseInt(_0xddde9f(_0x6b1bf7)['attr']('rowspan'))||0x1;_0x4da4f3[_0x26f394]=_0x45ed5d;(_0x2119a8>0x1||_0x325d65>0x1)&&_0x1c6a35[_0x3f0958(0xde)]({'s':{'r':_0x4cfea5,'c':_0x26f394},'e':{'r':_0x4cfea5+_0x325d65-0x1,'c':_0x26f394+_0x2119a8-0x1}});for(let _0x29e0df=0x0;_0x29e0df<_0x2119a8;_0x29e0df++){_0x325d65>0x1&&(_0x10423f[_0x26f394+_0x29e0df]=_0x325d65-0x1);}_0x26f394+=_0x2119a8;}),_0x575b31[_0x4cc8b6(0xde)](_0x4da4f3);});const _0x105461=XLSX[_0x5f1be8(0x22d)]['book_new'](),_0x1fde7e=XLSX[_0x5f1be8(0x22d)]['aoa_to_sheet'](_0x575b31);_0x1c6a35[_0x5f1be8(0x25e)]>0x0&&(_0x1fde7e[_0x5f1be8(0xdc)]=_0x1c6a35);_0x1fde7e[_0x5f1be8(0x146)]=_0x575b31[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x5f1be8(0x22d)]['book_append_sheet'](_0x105461,_0x1fde7e,'Sales\x20Report');const _0x36f2fc=XLSX['write'](_0x105461,{'bookType':_0x5f1be8(0x121),'type':_0x5f1be8(0x248)});_0x25394d[_0x5f1be8(0x178)](_0x5f1be8(0x108),_0x5f1be8(0x24c)),_0x25394d[_0x5f1be8(0x178)](_0x5f1be8(0xe0),_0x5f1be8(0x122)),_0x25394d[_0x5f1be8(0x236)](_0x36f2fc);}else pdf['create'](_0xbdfbc5,_0x2300f5)['toStream'](function(_0x45c912,_0x60e1ba){const _0x172356=_0x5f1be8;if(_0x45c912){_0x25394d[_0x172356(0x1f8)](0x1f4)['send'](_0x172356(0x154));return;}_0x25394d[_0x172356(0x178)]('Content-Type','application/pdf'),_0x60e1ba['pipe'](_0x25394d);});}),router[a0_0x381a3d(0x105)](a0_0x381a3d(0x20f),auth,async(_0x2382ea,_0x100bf6)=>{const _0x2cec3f=a0_0x381a3d;try{const {username:_0x106cd3,email:_0x133419,role:_0x58bdd2}=_0x2382ea[_0x2cec3f(0x19f)],_0x558157=_0x2382ea['user'],_0x426189=await profile[_0x2cec3f(0x127)]({'email':_0x558157[_0x2cec3f(0x249)]}),_0x34508e={'year':_0x2cec3f(0x101),'month':_0x2cec3f(0xd4),'day':_0x2cec3f(0x101)},_0x1f182e=await master_shop[_0x2cec3f(0x1c6)](),_0x1513c0=await staff[_0x2cec3f(0x127)]({'email':_0x558157[_0x2cec3f(0x249)]}),_0x33d74d=await product[_0x2cec3f(0x1c6)](),_0x19c3fb=await warehouse[_0x2cec3f(0x224)]([{'$unwind':_0x2cec3f(0x1ff)},{'$lookup':{'from':_0x2cec3f(0xd1),'localField':_0x2cec3f(0x1c2),'foreignField':'name','as':_0x2cec3f(0x172)}},{'$unwind':_0x2cec3f(0xfb)},{'$project':{'product_name':_0x2cec3f(0x1b1),'product_stock':_0x2cec3f(0x123)}},{'$group':{'_id':_0x2cec3f(0x222),'product_stock':{'$sum':_0x2cec3f(0x256)}}}]);if(_0x1f182e[0x0][_0x2cec3f(0x17c)]==_0x2cec3f(0x235))var _0x2180cc=users[_0x2cec3f(0x147)];else{if(_0x1f182e[0x0][_0x2cec3f(0x17c)]==_0x2cec3f(0x23f))var _0x2180cc=users[_0x2cec3f(0x23f)];else{if(_0x1f182e[0x0]['language']==_0x2cec3f(0x151))var _0x2180cc=users['German'];else{if(_0x1f182e[0x0][_0x2cec3f(0x17c)]==_0x2cec3f(0xee))var _0x2180cc=users[_0x2cec3f(0xee)];else{if(_0x1f182e[0x0]['language']==_0x2cec3f(0x1e0))var _0x2180cc=users[_0x2cec3f(0x1e0)];else{if(_0x1f182e[0x0][_0x2cec3f(0x17c)]==_0x2cec3f(0x230))var _0x2180cc=users[_0x2cec3f(0x244)];else{if(_0x1f182e[0x0][_0x2cec3f(0x17c)]==_0x2cec3f(0x21d))var _0x2180cc=users[_0x2cec3f(0x21d)];else{if(_0x1f182e[0x0][_0x2cec3f(0x17c)]=='Arabic\x20(ae)')var _0x2180cc=users[_0x2cec3f(0x18b)];}}}}}}}_0x100bf6[_0x2cec3f(0x211)](_0x2cec3f(0x217),{'success':_0x2382ea['flash']('success'),'errors':_0x2382ea[_0x2cec3f(0x1e4)]('errors'),'alldata':_0x33d74d,'profile':_0x426189,'master_shop':_0x1f182e,'role':_0x558157,'product_stock':_0x19c3fb,'language':_0x2180cc,'staff_arr':_0x1513c0});}catch(_0x4584fa){}});function formatNumber(_0x48d048,_0x56618a='en-US',_0x1dbba9={'minimumFractionDigits':0x2}){const _0x491f9a=a0_0x381a3d,_0xf9721a=new Intl[(_0x491f9a(0x228))](_0x56618a,_0x1dbba9);return _0xf9721a['format'](_0x48d048);}async function agentsdataDSICheck(_0x2ab8d3,_0x47090c,_0x26db14,_0x5a406d){const _0x1e42db=a0_0x381a3d,_0x35622a=await product[_0x1e42db(0x224)]([{'$group':{'_id':{'brand':_0x1e42db(0x22a),'category':_0x1e42db(0x231)},'products':{'$push':{'name':_0x1e42db(0x167),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x1ee7cb=[];_0x1ee7cb[_0x1e42db(0x107)]=[];for(let _0x5000a0=0x0;_0x5000a0<=_0x35622a[_0x1e42db(0x25e)]-0x1;_0x5000a0++){const _0x1eb4c1=_0x35622a[_0x5000a0];_0x1ee7cb[_0x1e42db(0x107)]['push'](_0x1eb4c1);}const _0x2c5cbe=await product[_0x1e42db(0x224)]([{'$group':{'_id':{'category':_0x1e42db(0x231)},'products':{'$push':{'brand':_0x1e42db(0x22a),'product_code':_0x1e42db(0x135),'product_name':_0x1e42db(0x167)}}}},{'$sort':{'_id.category':-0x1}}]),_0x17ef8a=await product['aggregate']([{'$group':{'_id':{'category':_0x1e42db(0x231),'brand':'$brand'}}},{'$group':{'_id':_0x1e42db(0x184),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x8e0ffd=await sales_sa[_0x1e42db(0x224)]([{'$match':{'date':{'$gte':_0x2ab8d3,'$lte':_0x47090c},'sales_staff_id':_0x26db14,'sale_product.isFG':_0x1e42db(0x215)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x1e42db(0x215)}},{'$lookup':{'from':_0x1e42db(0xd1),'localField':_0x1e42db(0x162),'foreignField':_0x1e42db(0x144),'as':_0x1e42db(0x190)}},{'$unwind':_0x1e42db(0x16d)},{'$group':{'_id':{'dsi':_0x1e42db(0x1a0),'date':_0x1e42db(0x25b),'customer':_0x1e42db(0xd9)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x1e42db(0x102),'NetPrice':_0x1e42db(0x1b0),'discount':_0x1e42db(0x1f0),'adj_discount':_0x1e42db(0x24b),'product_details':{'prod_name':_0x1e42db(0x200),'product_code':_0x1e42db(0x15e),'category':_0x1e42db(0xfc),'brand':_0x1e42db(0xe4),'gross_price':_0x1e42db(0x11d)}}}}},{'$unwind':_0x1e42db(0x225)},{'$group':{'_id':{'dsi':_0x1e42db(0x214),'date':_0x1e42db(0x21e),'customer':'$_id.customer','category':_0x1e42db(0x255),'brand':_0x1e42db(0x180)},'totalQty':{'$sum':_0x1e42db(0x24a)},'totalGross':{'$sum':{'$multiply':[_0x1e42db(0x24a),_0x1e42db(0x1f9)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x1e42db(0x1a8)},'adj_discount':{'$sum':_0x1e42db(0x1a7)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x1e42db(0x214),'date':_0x1e42db(0x21e),'customer':_0x1e42db(0x129)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x1e42db(0x156)},'adj_discount':{'$sum':_0x1e42db(0xd8)},'products':{'$push':{'qty':'$totalQty','category':_0x1e42db(0x184),'brand':'$_id.brand','product_details':_0x1e42db(0x1ff)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x198ead=[],_0x4fba56={},_0x3e996a={},_0x17cb28={};var _0x374951=0x0,_0x3e80f6=0x0,_0x3c5d76=0x0,_0x477e12=0x0,_0x40fb52=0x0;const _0x3a3738=0x6;for(let _0x3a64f1=0x0;_0x3a64f1<=_0x8e0ffd['length']-0x1;_0x3a64f1++){const _0x2d5a1d=_0x8e0ffd[_0x3a64f1];let _0x25fa1a=_0x1e42db(0x194);_0x25fa1a+=_0x1e42db(0x1cf)+_0x2d5a1d['_id'][_0x1e42db(0x17a)]+'</td>',_0x25fa1a+=_0x1e42db(0x1cf)+_0x2d5a1d[_0x1e42db(0x216)][_0x1e42db(0x1d0)]+_0x1e42db(0x20c),_0x25fa1a+=_0x1e42db(0x1cf)+_0x2d5a1d[_0x1e42db(0x216)][_0x1e42db(0x207)]+_0x1e42db(0x20c);let _0x28d03d={};var _0x1236ea=0x0;for(let _0x1a2106=0x0;_0x1a2106<=_0x2d5a1d[_0x1e42db(0xd1)][_0x1e42db(0x25e)]-0x1;_0x1a2106++){const _0x42ca70=_0x2d5a1d[_0x1e42db(0xd1)][_0x1a2106];_0x28d03d[_0x42ca70[_0x1e42db(0x1a9)]+'-'+_0x42ca70[_0x1e42db(0xe1)]]=_0x42ca70[_0x1e42db(0x201)];const _0x3690ac=_0x42ca70['brand']+'-'+_0x42ca70[_0x1e42db(0xe1)];!_0x4fba56[_0x3690ac]&&(_0x4fba56[_0x3690ac]=0x0),!Array[_0x1e42db(0x124)](_0x17cb28[_0x3690ac])&&(_0x17cb28[_0x3690ac]=[]),!Array['isArray'](_0x17cb28[_0x3690ac])&&(_0x17cb28[_0x3690ac]=[]),_0x4fba56[_0x3690ac]+=_0x42ca70[_0x1e42db(0x201)],_0x17cb28[_0x3690ac][_0x1e42db(0xde)](_0x42ca70[_0x1e42db(0x201)]),_0x1236ea++;}console[_0x1e42db(0x13c)](_0x2d5a1d);for(let _0x2077b8=0x0;_0x2077b8<=_0x1ee7cb[_0x1e42db(0x107)][_0x1e42db(0x25e)]-0x1;_0x2077b8++){const _0x231dd7=_0x1ee7cb[_0x1e42db(0x107)][_0x2077b8],_0x525585=_0x231dd7['_id'][_0x1e42db(0x1a9)]+'-'+_0x231dd7[_0x1e42db(0x216)]['category'];_0x25fa1a+=_0x1e42db(0x208)+(_0x28d03d[_0x525585]!==undefined?_0x28d03d[_0x525585][_0x1e42db(0x1e6)](0x2):'')+_0x1e42db(0x20c);}_0x3c5d76=_0x2d5a1d[_0x1e42db(0x103)]+_0x2d5a1d[_0x1e42db(0x17f)],_0x25fa1a+=_0x1e42db(0x22b)+formatNumber(parseFloat(_0x2d5a1d[_0x1e42db(0x195)],0x2)['toFixed'](0x2))+_0x1e42db(0x20c),_0x25fa1a+=_0x1e42db(0x22b)+formatNumber(_0x2d5a1d[_0x1e42db(0x259)][_0x1e42db(0x1e6)](0x2))+_0x1e42db(0x20c),_0x25fa1a+=_0x1e42db(0x22b)+formatNumber(_0x3c5d76)+'</td>',_0x25fa1a+=_0x1e42db(0x22b)+formatNumber(_0x2d5a1d['NetPrice'][_0x1e42db(0x1e6)](0x2))+_0x1e42db(0x20c),_0x25fa1a+=_0x1e42db(0x237),_0x374951+=parseFloat(_0x2d5a1d[_0x1e42db(0x195)][_0x1e42db(0x1e6)](0x2)),_0x3e80f6+=parseFloat(_0x2d5a1d['NetPrice']['toFixed'](0x2)),_0x477e12+=_0x3c5d76,_0x40fb52+=parseFloat(_0x2d5a1d[_0x1e42db(0x259)][_0x1e42db(0x1e6)](0x2));if(_0x3a64f1==_0x8e0ffd['length']-0x1){_0x25fa1a+=_0x1e42db(0x194),_0x25fa1a+=_0x1e42db(0x14d),_0x25fa1a+=_0x1e42db(0x20c);for(let _0x4fad66=0x0;_0x4fad66<=_0x1ee7cb[_0x1e42db(0x107)][_0x1e42db(0x25e)]-0x1;_0x4fad66++){const _0x5b5bbe=_0x1ee7cb['cat_brand'][_0x4fad66],_0x18704f=_0x5b5bbe[_0x1e42db(0x216)][_0x1e42db(0x1a9)]+'-'+_0x5b5bbe['_id']['category'],_0x5ada22=_0x17cb28[_0x18704f]['reduce']((_0x2a385a,_0x3d92b2)=>_0x2a385a+_0x3d92b2,0x0);_0x25fa1a+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x5ada22!==undefined?formatNumber(_0x5ada22['toFixed'](0x2)):'')+'</b></td>',console[_0x1e42db(0x13c)](_0x17cb28[_0x18704f]['reduce']((_0x209a0d,_0x2fbb11)=>_0x209a0d+_0x2fbb11,0x0));}_0x25fa1a+=_0x1e42db(0x14a)+formatNumber(_0x374951[_0x1e42db(0x1e6)](0x2))+_0x1e42db(0x23a),_0x25fa1a+=_0x1e42db(0x14a)+formatNumber(_0x40fb52)+_0x1e42db(0x23a),_0x25fa1a+=_0x1e42db(0x14a)+formatNumber(_0x477e12)+'</b></td>',_0x25fa1a+=_0x1e42db(0x14a)+formatNumber(_0x3e80f6)+_0x1e42db(0x23a),_0x25fa1a+=_0x1e42db(0x237);}_0x198ead[_0x1e42db(0xde)](_0x25fa1a);}function _0x596fa3(_0x4ba63c,_0x2fa2a7){const _0x12be8a=_0x1e42db,_0x2b94e1=[];for(let _0x17c6ea=0x0;_0x17c6ea<=_0x4ba63c['length']-0x1;_0x17c6ea+=_0x2fa2a7){_0x2b94e1[_0x12be8a(0xde)](_0x4ba63c[_0x12be8a(0x1b3)](_0x17c6ea,_0x17c6ea+_0x2fa2a7));}return _0x2b94e1;}const _0x2bcac6=_0x596fa3(_0x198ead,_0x3a3738);let _0x32293e='';return _0x2bcac6['forEach']((_0x33bf3f,_0x1b649b)=>{const _0x4cdebb=_0x1e42db;_0x1b649b>0x0&&(_0x32293e+=_0x4cdebb(0x247));_0x32293e+=_0x4cdebb(0x1b5),_0x32293e+='<thead>',_0x32293e+=_0x4cdebb(0x194),_0x32293e+=_0x4cdebb(0x188),_0x32293e+=_0x4cdebb(0x237),_0x32293e+=_0x4cdebb(0x194),_0x32293e+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x440984=0x0;_0x440984<=_0x2c5cbe['length']-0x1;_0x440984++){const _0x1fe751=_0x2c5cbe[_0x440984];for(let _0x371b11=0x0;_0x371b11<_0x17ef8a[_0x4cdebb(0x25e)];_0x371b11++){const _0x288c7a=_0x17ef8a[_0x371b11];_0x288c7a['_id']===_0x1fe751[_0x4cdebb(0x216)][_0x4cdebb(0xe1)]&&(_0x32293e+=_0x4cdebb(0x176)+_0x288c7a[_0x4cdebb(0x223)]+_0x4cdebb(0x1eb)+_0x1fe751[_0x4cdebb(0x216)][_0x4cdebb(0xe1)]+'</td>');}}_0x32293e+=_0x4cdebb(0x17d),_0x32293e+=_0x4cdebb(0x237),_0x32293e+=_0x4cdebb(0x194),_0x32293e+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x32293e+=_0x4cdebb(0x15f),_0x32293e+=_0x4cdebb(0x19a);for(let _0x49e2e6=0x0;_0x49e2e6<=_0x2c5cbe[_0x4cdebb(0x25e)]-0x1;_0x49e2e6++){const _0x3eb57a=_0x2c5cbe[_0x49e2e6];for(let _0x488ffd=0x0;_0x488ffd<_0x1ee7cb[_0x4cdebb(0x107)][_0x4cdebb(0x25e)];_0x488ffd++){const _0x3301b5=_0x1ee7cb['cat_brand'][_0x488ffd];_0x3301b5[_0x4cdebb(0x216)]['category']===_0x3eb57a['_id'][_0x4cdebb(0xe1)]&&(_0x32293e+=_0x4cdebb(0x1c3)+_0x3301b5['_id'][_0x4cdebb(0x1a9)]+'</td>');}}_0x32293e+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x32293e+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x32293e+=_0x4cdebb(0x150),_0x32293e+=_0x4cdebb(0x202),_0x32293e+=_0x4cdebb(0x237),_0x32293e+=_0x4cdebb(0x209),_0x32293e+='<tbody>',_0x33bf3f[_0x4cdebb(0x1d4)](_0x3dc4ea=>{_0x32293e+=_0x3dc4ea;}),console[_0x4cdebb(0x13c)](_0x17cb28),_0x32293e+='</tbody>',_0x32293e+=_0x4cdebb(0x10b);}),_0x32293e;}async function agentsdataDSICheck_excel(_0x448480,_0x46b32b,_0x13145d,_0x210737){const _0x416765=a0_0x381a3d,_0x4a678a=await product[_0x416765(0x224)]([{'$group':{'_id':{'brand':_0x416765(0x22a),'category':_0x416765(0x231)},'products':{'$push':{'name':_0x416765(0x167),'product_code':_0x416765(0x135)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xe378c4=[];_0xe378c4[_0x416765(0x107)]=[];for(let _0x4a6d5b=0x0;_0x4a6d5b<=_0x4a678a[_0x416765(0x25e)]-0x1;_0x4a6d5b++){const _0x17611e=_0x4a678a[_0x4a6d5b];_0xe378c4[_0x416765(0x107)][_0x416765(0xde)](_0x17611e);}const _0x577dd0=await product['aggregate']([{'$group':{'_id':{'category':_0x416765(0x231)},'products':{'$push':{'brand':'$brand','product_code':_0x416765(0x135),'product_name':_0x416765(0x167)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4fecce=await product[_0x416765(0x224)]([{'$group':{'_id':{'category':'$category','brand':'$brand'}}},{'$group':{'_id':_0x416765(0x184),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5f0f45=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x448480,'$lte':_0x46b32b},'sales_staff_id':_0x13145d,'sale_product.isFG':_0x416765(0x215)}},{'$unwind':_0x416765(0x1de)},{'$match':{'sale_product.isFG':_0x416765(0x215)}},{'$lookup':{'from':'products','localField':_0x416765(0x162),'foreignField':_0x416765(0x144),'as':_0x416765(0x190)}},{'$unwind':_0x416765(0x16d)},{'$group':{'_id':{'dsi':_0x416765(0x1a0),'date':_0x416765(0x25b),'customer':_0x416765(0xd9)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x416765(0x102),'NetPrice':_0x416765(0x1b0),'discount':_0x416765(0x1f0),'adj_discount':_0x416765(0x24b),'product_details':{'prod_name':'$product_info.name','product_code':_0x416765(0x15e),'category':_0x416765(0xfc),'brand':_0x416765(0xe4),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x416765(0x21e),'customer':_0x416765(0x129),'category':_0x416765(0x255),'brand':_0x416765(0x180)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x416765(0x24a),_0x416765(0x1f9)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x416765(0x1a8)},'adj_discount':{'$sum':_0x416765(0x1a7)},'product_details':{'$first':_0x416765(0x175)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':'$_id.customer'},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x416765(0x156)},'adj_discount':{'$sum':_0x416765(0xd8)},'products':{'$push':{'qty':_0x416765(0x1b4),'category':_0x416765(0x184),'brand':_0x416765(0x158),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x27e132=[],_0x324a7f={},_0x45ce53={},_0x4e6847={};var _0x3fc5bf=0x0,_0x4c0459=0x0,_0x3173a3=0x0,_0x151fe0=0x0,_0x447eac=0x0;const _0x306431=0x9184e72a000;for(let _0x2961b7=0x0;_0x2961b7<=_0x5f0f45[_0x416765(0x25e)]-0x1;_0x2961b7++){const _0x5043d2=_0x5f0f45[_0x2961b7];let _0xc1d89='<tr>';_0xc1d89+=_0x416765(0x1cf)+_0x5043d2[_0x416765(0x216)][_0x416765(0x17a)]+'</td>',_0xc1d89+=_0x416765(0x1cf)+_0x5043d2[_0x416765(0x216)][_0x416765(0x1d0)]+_0x416765(0x20c),_0xc1d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x5043d2[_0x416765(0x216)]['customer']+'</td>';let _0x197d41={};var _0x2b96c0=0x0;for(let _0x35aa88=0x0;_0x35aa88<=_0x5043d2[_0x416765(0xd1)][_0x416765(0x25e)]-0x1;_0x35aa88++){const _0x38561c=_0x5043d2['products'][_0x35aa88];_0x197d41[_0x38561c[_0x416765(0x1a9)]+'-'+_0x38561c[_0x416765(0xe1)]]=_0x38561c[_0x416765(0x201)];const _0x29cea0=_0x38561c[_0x416765(0x1a9)]+'-'+_0x38561c[_0x416765(0xe1)];!_0x324a7f[_0x29cea0]&&(_0x324a7f[_0x29cea0]=0x0),!Array[_0x416765(0x124)](_0x4e6847[_0x29cea0])&&(_0x4e6847[_0x29cea0]=[]),!Array[_0x416765(0x124)](_0x4e6847[_0x29cea0])&&(_0x4e6847[_0x29cea0]=[]),_0x324a7f[_0x29cea0]+=_0x38561c['qty'],_0x4e6847[_0x29cea0]['push'](_0x38561c[_0x416765(0x201)]),_0x2b96c0++;}console[_0x416765(0x13c)](_0x5043d2);for(let _0x305c46=0x0;_0x305c46<=_0xe378c4['cat_brand'][_0x416765(0x25e)]-0x1;_0x305c46++){const _0x440d98=_0xe378c4[_0x416765(0x107)][_0x305c46],_0x1ddfca=_0x440d98[_0x416765(0x216)]['brand']+'-'+_0x440d98[_0x416765(0x216)][_0x416765(0xe1)];_0xc1d89+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+(_0x197d41[_0x1ddfca]!==undefined?_0x197d41[_0x1ddfca][_0x416765(0x1e6)](0x2):'')+_0x416765(0x20c);}_0x3173a3=_0x5043d2['discount']+_0x5043d2[_0x416765(0x17f)],_0xc1d89+=_0x416765(0x22b)+formatNumber(parseFloat(_0x5043d2[_0x416765(0x195)],0x2)[_0x416765(0x1e6)](0x2))+_0x416765(0x20c),_0xc1d89+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x5043d2['totalGross'][_0x416765(0x1e6)](0x2))+_0x416765(0x20c),_0xc1d89+=_0x416765(0x22b)+formatNumber(_0x3173a3)+_0x416765(0x20c),_0xc1d89+=_0x416765(0x22b)+formatNumber(_0x5043d2[_0x416765(0x114)]['toFixed'](0x2))+_0x416765(0x20c),_0xc1d89+=_0x416765(0x237),_0x3fc5bf+=parseFloat(_0x5043d2['totalQty']['toFixed'](0x2)),_0x4c0459+=parseFloat(_0x5043d2['NetPrice'][_0x416765(0x1e6)](0x2)),_0x151fe0+=_0x3173a3,_0x447eac+=parseFloat(_0x5043d2[_0x416765(0x259)][_0x416765(0x1e6)](0x2));if(_0x2961b7==_0x5f0f45[_0x416765(0x25e)]-0x1){_0xc1d89+=_0x416765(0x194),_0xc1d89+=_0x416765(0x14d),_0xc1d89+=_0x416765(0x20c);for(let _0xe16c46=0x0;_0xe16c46<=_0xe378c4[_0x416765(0x107)][_0x416765(0x25e)]-0x1;_0xe16c46++){const _0x50ba8e=_0xe378c4[_0x416765(0x107)][_0xe16c46],_0x2f40a5=_0x50ba8e['_id'][_0x416765(0x1a9)]+'-'+_0x50ba8e[_0x416765(0x216)][_0x416765(0xe1)],_0x57563a=_0x4e6847[_0x2f40a5][_0x416765(0x210)]((_0x41c0e9,_0x1a61ec)=>_0x41c0e9+_0x1a61ec,0x0);_0xc1d89+=_0x416765(0x139)+(_0x57563a!==undefined?formatNumber(_0x57563a['toFixed'](0x2)):'')+_0x416765(0x23a),console['log'](_0x4e6847[_0x2f40a5][_0x416765(0x210)]((_0x6536b7,_0x178fba)=>_0x6536b7+_0x178fba,0x0));}_0xc1d89+=_0x416765(0x14a)+formatNumber(_0x3fc5bf[_0x416765(0x1e6)](0x2))+_0x416765(0x23a),_0xc1d89+=_0x416765(0x14a)+formatNumber(_0x447eac)+_0x416765(0x23a),_0xc1d89+=_0x416765(0x14a)+formatNumber(_0x151fe0)+'</b></td>',_0xc1d89+=_0x416765(0x14a)+formatNumber(_0x4c0459)+_0x416765(0x23a),_0xc1d89+='</tr>';}_0x27e132[_0x416765(0xde)](_0xc1d89);}function _0x43157d(_0x55a480,_0x35440c){const _0x4ff1f2=_0x416765,_0x14528c=[];for(let _0x4e92af=0x0;_0x4e92af<=_0x55a480[_0x4ff1f2(0x25e)]-0x1;_0x4e92af+=_0x35440c){_0x14528c[_0x4ff1f2(0xde)](_0x55a480[_0x4ff1f2(0x1b3)](_0x4e92af,_0x4e92af+_0x35440c));}return _0x14528c;}const _0x46adb0=_0x43157d(_0x27e132,_0x306431);let _0x72e1f7='';return _0x46adb0[_0x416765(0x1d4)]((_0x424098,_0x4ca60f)=>{const _0x23feaa=_0x416765;_0x4ca60f>0x0&&(_0x72e1f7+=_0x23feaa(0x247));_0x72e1f7+=_0x23feaa(0x1b5),_0x72e1f7+=_0x23feaa(0x1b7),_0x72e1f7+=_0x23feaa(0x194),_0x72e1f7+=_0x23feaa(0x188),_0x72e1f7+=_0x23feaa(0x237),_0x72e1f7+=_0x23feaa(0x194),_0x72e1f7+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x1f8841=0x0;_0x1f8841<=_0x577dd0[_0x23feaa(0x25e)]-0x1;_0x1f8841++){const _0x37ba2e=_0x577dd0[_0x1f8841];for(let _0x10e977=0x0;_0x10e977<_0x4fecce[_0x23feaa(0x25e)];_0x10e977++){const _0x208586=_0x4fecce[_0x10e977];_0x208586['_id']===_0x37ba2e[_0x23feaa(0x216)][_0x23feaa(0xe1)]&&(_0x72e1f7+=_0x23feaa(0x176)+_0x208586[_0x23feaa(0x223)]+_0x23feaa(0x1eb)+_0x37ba2e[_0x23feaa(0x216)]['category']+'</td>');}}_0x72e1f7+=_0x23feaa(0x17d),_0x72e1f7+=_0x23feaa(0x237),_0x72e1f7+='<tr>',_0x72e1f7+=_0x23feaa(0x25c),_0x72e1f7+=_0x23feaa(0x15f),_0x72e1f7+=_0x23feaa(0x19a);for(let _0x275058=0x0;_0x275058<=_0x577dd0[_0x23feaa(0x25e)]-0x1;_0x275058++){const _0x9866a8=_0x577dd0[_0x275058];for(let _0x35e1d3=0x0;_0x35e1d3<_0xe378c4['cat_brand'][_0x23feaa(0x25e)];_0x35e1d3++){const _0x5df09b=_0xe378c4[_0x23feaa(0x107)][_0x35e1d3];_0x5df09b['_id'][_0x23feaa(0xe1)]===_0x9866a8[_0x23feaa(0x216)][_0x23feaa(0xe1)]&&(_0x72e1f7+='<td\x20class=\x22cat_data\x22>'+_0x5df09b[_0x23feaa(0x216)]['brand']+_0x23feaa(0x20c));}}_0x72e1f7+=_0x23feaa(0x1f1),_0x72e1f7+=_0x23feaa(0x242),_0x72e1f7+=_0x23feaa(0x150),_0x72e1f7+=_0x23feaa(0x202),_0x72e1f7+='</tr>',_0x72e1f7+=_0x23feaa(0x209),_0x72e1f7+=_0x23feaa(0x16c),_0x424098['forEach'](_0x2d0367=>{_0x72e1f7+=_0x2d0367;}),console[_0x23feaa(0x13c)](_0x4e6847),_0x72e1f7+=_0x23feaa(0x159),_0x72e1f7+='</table>';}),_0x72e1f7;}router[a0_0x381a3d(0x18f)](a0_0x381a3d(0x1e7),auth,async(_0x478ff7,_0x276336)=>{const _0x1cd0fc=a0_0x381a3d,{from_date:_0x48457e,to_date:_0x3579d8,isExcel:_0x2b87c3}=_0x478ff7[_0x1cd0fc(0x179)],_0x3b70ee=_0x478ff7[_0x1cd0fc(0x19f)],_0x2c33ba=await staff[_0x1cd0fc(0x127)]({'email':_0x3b70ee[_0x1cd0fc(0x249)]}),_0x296c76=await master_shop[_0x1cd0fc(0x1c6)]();console[_0x1cd0fc(0x13c)](_0x296c76[0x0][_0x1cd0fc(0x174)]);const _0x4219d6=await agentsdataDSICheck(_0x48457e,_0x3579d8,_0x2c33ba[_0x1cd0fc(0x216)][_0x1cd0fc(0x1fa)](),_0x2b87c3),_0x3db264=await agentsdataDSICheck_excel(_0x48457e,_0x3579d8,_0x2c33ba[_0x1cd0fc(0x216)]['valueOf'](),_0x2b87c3);let _0x1d4921='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x179277=new Date(_0x48457e),_0x39a44d=new Date(_0x3579d8);const _0x53688d={'year':'numeric','month':'long','day':_0x1cd0fc(0x101)},_0xf3ba62=new Intl[(_0x1cd0fc(0x157))](_0x1cd0fc(0x246),_0x53688d)[_0x1cd0fc(0x12f)](_0x179277),_0x1b4aa9=new Intl['DateTimeFormat'](_0x1cd0fc(0x246),_0x53688d)['format'](_0x39a44d);_0x1d4921+=_0x1cd0fc(0x104),_0x1d4921+=_0x1cd0fc(0x18c),_0x1d4921+=_0x1cd0fc(0x1b5),_0x1d4921+=_0x4219d6,_0x1d4921+=_0x1cd0fc(0x10b),_0x1d4921+=_0x1cd0fc(0x138),_0x1d4921+=_0x1cd0fc(0x138);let _0xb86d79=_0x1cd0fc(0x113);_0xb86d79+=_0x1cd0fc(0x104),_0xb86d79+='<div\x20\x20id=\x22table-conatainer\x22>',_0xb86d79+=_0x1cd0fc(0x1b5),_0xb86d79+=_0x3db264,_0xb86d79+=_0x1cd0fc(0x10b),_0xb86d79+=_0x1cd0fc(0x138),_0xb86d79+='</div>';let _0x1924fa=_0x1cd0fc(0x13d);const _0x4571bf={'width':_0x1cd0fc(0x1f3),'height':_0x1cd0fc(0x1d6),'orientation':_0x1cd0fc(0x117),'border':{'top':_0x1cd0fc(0x10e),'right':'0.1in','bottom':_0x1cd0fc(0x10e),'left':_0x1cd0fc(0x10e)},'header':{'height':_0x1cd0fc(0x173),'contents':_0x1cd0fc(0xd7)+_0x1924fa+_0x1cd0fc(0x1e8)+_0xf3ba62+_0x1cd0fc(0x212)+_0x1b4aa9+_0x1cd0fc(0x16e)},'footer':{'height':_0x1cd0fc(0x1da),'contents':{'default':_0x1cd0fc(0xe5)}},'dpi':0x5,'zoomFactor':'1'};if(_0x2b87c3=='on'){const _0x101f70=cheerio[_0x1cd0fc(0x24e)](_0xb86d79);let _0x2a93d4=[],_0x5b96e4=[],_0x4f6b72=[];const _0x95da3a=_0x52fe09=>{const _0x4741cd=_0x1cd0fc,_0x4a7b2d={'top':{'style':_0x4741cd(0x1b8),'color':{'rgb':'000000'}},'bottom':{'style':_0x4741cd(0x1b8),'color':{'rgb':_0x4741cd(0xfe)}},'left':{'style':'thick','color':{'rgb':_0x4741cd(0xfe)}},'right':{'style':_0x4741cd(0x1b8),'color':{'rgb':_0x4741cd(0xfe)}}};if(_0x52fe09){const _0x302966=_0x52fe09['split'](';')[_0x4741cd(0x210)]((_0x46f7d4,_0xf4de96)=>{const _0x366939=_0x4741cd,[_0x11bcce,_0x1e6887]=_0xf4de96[_0x366939(0x131)](':')[_0x366939(0x13f)](_0x5114fe=>_0x5114fe[_0x366939(0x106)]());return _0x46f7d4[_0x11bcce]=_0x1e6887,_0x46f7d4;},{});_0x302966[_0x4741cd(0x11b)]&&(_0x4a7b2d[_0x4741cd(0x234)][_0x4741cd(0xdb)]=_0x302966[_0x4741cd(0x11b)]['includes']('thin')?_0x4741cd(0x16f):_0x4741cd(0x12c)),_0x302966[_0x4741cd(0x1ad)]&&(_0x4a7b2d['bottom'][_0x4741cd(0xdb)]=_0x302966[_0x4741cd(0x1ad)][_0x4741cd(0x160)]('thin')?'thin':_0x4741cd(0x12c)),_0x302966['border-left']&&(_0x4a7b2d['left'][_0x4741cd(0xdb)]=_0x302966[_0x4741cd(0x187)][_0x4741cd(0x160)]('thin')?'thin':_0x4741cd(0x12c)),_0x302966[_0x4741cd(0x186)]&&(_0x4a7b2d['right'][_0x4741cd(0xdb)]=_0x302966[_0x4741cd(0x186)][_0x4741cd(0x160)]('thin')?_0x4741cd(0x16f):_0x4741cd(0x12c));}return _0x4a7b2d;};_0x101f70(_0x1cd0fc(0x137))[_0x1cd0fc(0x10a)]((_0x427b44,_0x383ff9)=>{const _0x4b1fa1=_0x1cd0fc;let _0x36579f=[],_0x4b914f=0x0;while(_0x4f6b72[_0x4b914f]){_0x4f6b72[_0x4b914f]--,_0x4b914f++;}_0x101f70(_0x383ff9)[_0x4b1fa1(0x1c6)](_0x4b1fa1(0xf7))[_0x4b1fa1(0x10a)]((_0x148d48,_0x3c2833)=>{const _0x263e51=_0x4b1fa1;let _0x20abe3=_0x101f70(_0x3c2833)[_0x263e51(0x130)]()[_0x263e51(0x106)](),_0x3f2f4c=parseFloat(_0x20abe3['replace'](/,/g,'')),_0x3fb5f6={};!isNaN(_0x3f2f4c)?(_0x3fb5f6['v']=_0x3f2f4c,_0x3fb5f6['t']='n'):(_0x3fb5f6['v']=_0x20abe3,_0x3fb5f6['t']='s');const _0x3f4b16=_0x101f70(_0x3c2833)[_0x263e51(0x1c5)](_0x263e51(0xdb)),_0x418a36=_0x95da3a(_0x3f4b16);_0x3fb5f6['s']={'border':_0x418a36},_0x36579f[_0x4b914f]=_0x3fb5f6;let _0x17aa40=parseInt(_0x101f70(_0x3c2833)['attr']('colspan'))||0x1,_0x4d05a3=parseInt(_0x101f70(_0x3c2833)['attr'](_0x263e51(0xe2)))||0x1;(_0x17aa40>0x1||_0x4d05a3>0x1)&&_0x5b96e4[_0x263e51(0xde)]({'s':{'r':_0x427b44,'c':_0x4b914f},'e':{'r':_0x427b44+_0x4d05a3-0x1,'c':_0x4b914f+_0x17aa40-0x1}});for(let _0x28177f=0x0;_0x28177f<_0x17aa40;_0x28177f++){_0x4d05a3>0x1&&(_0x4f6b72[_0x4b914f+_0x28177f]=_0x4d05a3-0x1);}_0x4b914f+=_0x17aa40;}),_0x2a93d4[_0x4b1fa1(0xde)](_0x36579f);});const _0x5b145f=XLSX[_0x1cd0fc(0x22d)][_0x1cd0fc(0x1e9)](),_0x1481d3=XLSX[_0x1cd0fc(0x22d)][_0x1cd0fc(0x253)](_0x2a93d4);_0x5b96e4[_0x1cd0fc(0x25e)]>0x0&&(_0x1481d3['!merges']=_0x5b96e4);_0x1481d3[_0x1cd0fc(0x146)]=_0x2a93d4[0x0][_0x1cd0fc(0x13f)](()=>({'wpx':0x64})),XLSX[_0x1cd0fc(0x22d)][_0x1cd0fc(0x1c9)](_0x5b145f,_0x1481d3,_0x1cd0fc(0x240));const _0x4f018c=XLSX[_0x1cd0fc(0xf0)](_0x5b145f,{'bookType':_0x1cd0fc(0x121),'type':_0x1cd0fc(0x248)});_0x276336['setHeader'](_0x1cd0fc(0x108),_0x1cd0fc(0x24c)),_0x276336[_0x1cd0fc(0x178)]('Content-Type',_0x1cd0fc(0x122)),_0x276336[_0x1cd0fc(0x236)](_0x4f018c);}else pdf[_0x1cd0fc(0x168)](_0x1d4921,_0x4571bf)[_0x1cd0fc(0xe3)](function(_0x253b46,_0x4ee42e){const _0x90bdf7=_0x1cd0fc;if(_0x253b46){_0x276336['status'](0x1f4)[_0x90bdf7(0x236)](_0x90bdf7(0x154));return;}_0x276336[_0x90bdf7(0x178)](_0x90bdf7(0xe0),_0x90bdf7(0x251)),_0x4ee42e[_0x90bdf7(0x1e2)](_0x276336);});}),router[a0_0x381a3d(0x105)](a0_0x381a3d(0x13e),auth,async(_0x5807b0,_0x57a8c9)=>{const _0x4f888a=a0_0x381a3d;try{const {username:_0x2b0634,email:_0x422db0,role:_0x128eb7}=_0x5807b0[_0x4f888a(0x19f)],_0x5a0f68=_0x5807b0[_0x4f888a(0x19f)],_0x47e916=await profile[_0x4f888a(0x127)]({'email':_0x5a0f68[_0x4f888a(0x249)]}),_0x25d37f={'year':_0x4f888a(0x101),'month':_0x4f888a(0xd4),'day':_0x4f888a(0x101)},_0x22e7ec=await master_shop['find'](),_0x5b4f32=await product[_0x4f888a(0x1c6)](),_0x2d93d3=await warehouse[_0x4f888a(0x224)]([{'$unwind':_0x4f888a(0x1ff)},{'$lookup':{'from':_0x4f888a(0xd1),'localField':_0x4f888a(0x1c2),'foreignField':'name','as':_0x4f888a(0x172)}},{'$unwind':_0x4f888a(0xfb)},{'$project':{'product_name':_0x4f888a(0x1b1),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x4f888a(0x222),'product_stock':{'$sum':_0x4f888a(0x256)}}}]),_0x9c10b3=await staff[_0x4f888a(0x127)]({'email':_0x5a0f68[_0x4f888a(0x249)]});if(_0x22e7ec[0x0][_0x4f888a(0x17c)]==_0x4f888a(0x235))var _0x30db38=users[_0x4f888a(0x147)];else{if(_0x22e7ec[0x0][_0x4f888a(0x17c)]==_0x4f888a(0x23f))var _0x30db38=users['Hindi'];else{if(_0x22e7ec[0x0][_0x4f888a(0x17c)]==_0x4f888a(0x151))var _0x30db38=users['German'];else{if(_0x22e7ec[0x0]['language']==_0x4f888a(0xee))var _0x30db38=users[_0x4f888a(0xee)];else{if(_0x22e7ec[0x0][_0x4f888a(0x17c)]=='French')var _0x30db38=users[_0x4f888a(0x1e0)];else{if(_0x22e7ec[0x0][_0x4f888a(0x17c)]==_0x4f888a(0x230))var _0x30db38=users[_0x4f888a(0x244)];else{if(_0x22e7ec[0x0][_0x4f888a(0x17c)]==_0x4f888a(0x21d))var _0x30db38=users[_0x4f888a(0x21d)];else{if(_0x22e7ec[0x0][_0x4f888a(0x17c)]=='Arabic\x20(ae)')var _0x30db38=users[_0x4f888a(0x18b)];}}}}}}}_0x57a8c9[_0x4f888a(0x211)](_0x4f888a(0x232),{'success':_0x5807b0[_0x4f888a(0x1e4)](_0x4f888a(0xd2)),'errors':_0x5807b0[_0x4f888a(0x1e4)]('errors'),'alldata':_0x5b4f32,'profile':_0x47e916,'master_shop':_0x22e7ec,'role':_0x5a0f68,'product_stock':_0x2d93d3,'language':_0x30db38,'staff_arr':_0x9c10b3});}catch(_0x5a9320){}});async function dataSalesReports(_0x238726,_0x18d7b3,_0x5b9724){const _0x4c1705=a0_0x381a3d;let _0x1ed277='';const _0x62caf6=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x238726,'$lte':_0x18d7b3},'sales_staff_id':_0x5b9724}},{'$unwind':_0x4c1705(0x1de)},{'$match':{'sale_product.isFG':_0x4c1705(0x215)}},{'$group':{'_id':{'product_name':_0x4c1705(0x20d),'product_code':_0x4c1705(0x203)},'sumqty':{'$sum':_0x4c1705(0x102)},'totalPrice':{'$sum':_0x4c1705(0x1b0)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x129696=0x0,_0x179fb2=0x0;for(let _0x2309b6=0x0;_0x2309b6<=_0x62caf6[_0x4c1705(0x25e)]-0x1;_0x2309b6++){const _0x290f4c=_0x62caf6[_0x2309b6];var _0x481c07=_0x290f4c['totalPrice'][_0x4c1705(0x226)](undefined),_0x595f10=_0x290f4c[_0x4c1705(0x1b9)][_0x4c1705(0x226)](undefined);_0x1ed277+=_0x4c1705(0x194),_0x1ed277+=_0x4c1705(0x170)+_0x290f4c[_0x4c1705(0x216)]['product_code']+_0x4c1705(0x20c),_0x1ed277+=_0x4c1705(0x170)+_0x290f4c['_id']['product_name']+_0x4c1705(0x20c),_0x1ed277+=_0x4c1705(0x170)+formatNumber(_0x290f4c['sumqty'][_0x4c1705(0x1e6)](0x2))+_0x4c1705(0x20c),_0x1ed277+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x290f4c[_0x4c1705(0x204)][_0x4c1705(0x1e6)](0x2))+_0x4c1705(0x20c),_0x1ed277+=_0x4c1705(0x237),_0x129696+=parseFloat(_0x290f4c[_0x4c1705(0x1b9)]),_0x179fb2+=parseFloat(_0x290f4c[_0x4c1705(0x204)]);}var _0x442c24=_0x179fb2[_0x4c1705(0x226)](undefined),_0x5bac3e=_0x129696[_0x4c1705(0x226)](undefined);return _0x1ed277+=_0x4c1705(0x194),_0x1ed277+=_0x4c1705(0x1df),_0x1ed277+=_0x4c1705(0x18e)+formatNumber(_0x129696[_0x4c1705(0x1e6)](0x2))+_0x4c1705(0x23a),_0x1ed277+=_0x4c1705(0x18e)+formatNumber(_0x179fb2['toFixed'](0x2))+_0x4c1705(0x23a),_0x1ed277+='</tr>',_0x1ed277;}router[a0_0x381a3d(0x18f)](a0_0x381a3d(0x11a),auth,async(_0x2f5280,_0x354ec9)=>{const _0x42b9c8=a0_0x381a3d;try{const {from_date:_0x4b6815,to_date:_0x4f39d4,isExcel:_0x14994f}=_0x2f5280[_0x42b9c8(0x179)],_0x393573=_0x2f5280[_0x42b9c8(0x19f)],_0x24751f=await staff[_0x42b9c8(0x127)]({'email':_0x393573[_0x42b9c8(0x249)]});let _0xce15ca='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x3acc78=new Date(_0x4b6815),_0x24d356=new Date(_0x4f39d4);const _0x526f33={'year':_0x42b9c8(0x101),'month':'long','day':_0x42b9c8(0x101)},_0x28c71e=new Intl[(_0x42b9c8(0x157))](_0x42b9c8(0x246),_0x526f33)['format'](_0x3acc78),_0x4f62d7=new Intl['DateTimeFormat'](_0x42b9c8(0x246),_0x526f33)[_0x42b9c8(0x12f)](_0x24d356);var _0x203310=await dataSalesReports(_0x4b6815,_0x4f39d4,_0x24751f['_id']['valueOf']());_0xce15ca+=_0x42b9c8(0x104),_0xce15ca+=_0x42b9c8(0x169),_0xce15ca+=_0x42b9c8(0x1b5),_0xce15ca+='<tr>',_0xce15ca+=_0x42b9c8(0x111),_0xce15ca+=_0x42b9c8(0x1a6),_0xce15ca+=_0x42b9c8(0x149),_0xce15ca+=_0x42b9c8(0x1fb),_0xce15ca+='<tr>',_0xce15ca+=_0x203310,_0xce15ca+='</tr>',_0xce15ca+=_0x42b9c8(0x138),_0xce15ca+='</div>';let _0x23e6bd=_0x42b9c8(0x13d);const _0x581e93={'width':_0x42b9c8(0x1f3),'height':_0x42b9c8(0x1d6),'orientation':_0x42b9c8(0x117),'border':{'top':_0x42b9c8(0x10e),'right':_0x42b9c8(0x10e),'bottom':_0x42b9c8(0x10e),'left':_0x42b9c8(0x10e)},'header':{'height':'60mm','contents':_0x42b9c8(0xd7)+_0x23e6bd+_0x42b9c8(0x20a)+_0x24751f[_0x42b9c8(0x118)]+_0x42b9c8(0xd6)+_0x28c71e+_0x42b9c8(0x212)+_0x4f62d7+_0x42b9c8(0x16e)},'footer':{'height':_0x42b9c8(0x1da),'contents':{'default':_0x42b9c8(0xe5)}},'dpi':0x5,'zoomFactor':'1'};if(_0x14994f=='on'){const _0x470165=cheerio[_0x42b9c8(0x24e)](_0xce15ca);let _0x26dc7a=[],_0x517cb0=[],_0xeeb326=[];const _0x38ff85=_0xb82f1a=>{const _0x94e0c6=_0x42b9c8,_0x5cd6b2={'top':{'style':_0x94e0c6(0x1b8),'color':{'rgb':_0x94e0c6(0xfe)}},'bottom':{'style':_0x94e0c6(0x1b8),'color':{'rgb':'000000'}},'left':{'style':'thick','color':{'rgb':'000000'}},'right':{'style':_0x94e0c6(0x1b8),'color':{'rgb':_0x94e0c6(0xfe)}}};if(_0xb82f1a){const _0xdd2281=_0xb82f1a[_0x94e0c6(0x131)](';')['reduce']((_0x40d714,_0x36b8dc)=>{const _0x3ee83c=_0x94e0c6,[_0x29ba52,_0x851a77]=_0x36b8dc[_0x3ee83c(0x131)](':')[_0x3ee83c(0x13f)](_0x33f24d=>_0x33f24d[_0x3ee83c(0x106)]());return _0x40d714[_0x29ba52]=_0x851a77,_0x40d714;},{});_0xdd2281[_0x94e0c6(0x11b)]&&(_0x5cd6b2[_0x94e0c6(0x234)][_0x94e0c6(0xdb)]=_0xdd2281[_0x94e0c6(0x11b)][_0x94e0c6(0x160)](_0x94e0c6(0x16f))?_0x94e0c6(0x16f):_0x94e0c6(0x12c)),_0xdd2281[_0x94e0c6(0x1ad)]&&(_0x5cd6b2[_0x94e0c6(0x11f)]['style']=_0xdd2281[_0x94e0c6(0x1ad)][_0x94e0c6(0x160)](_0x94e0c6(0x16f))?_0x94e0c6(0x16f):'medium'),_0xdd2281[_0x94e0c6(0x187)]&&(_0x5cd6b2[_0x94e0c6(0x152)][_0x94e0c6(0xdb)]=_0xdd2281[_0x94e0c6(0x187)]['includes'](_0x94e0c6(0x16f))?_0x94e0c6(0x16f):'medium'),_0xdd2281[_0x94e0c6(0x186)]&&(_0x5cd6b2[_0x94e0c6(0x12e)][_0x94e0c6(0xdb)]=_0xdd2281['border-right'][_0x94e0c6(0x160)](_0x94e0c6(0x16f))?_0x94e0c6(0x16f):_0x94e0c6(0x12c));}return _0x5cd6b2;};_0x470165('table\x20tr')['each']((_0x12cf79,_0x2c34ff)=>{const _0x5bba80=_0x42b9c8;let _0x485ba8=[],_0x976285=0x0;while(_0xeeb326[_0x976285]){_0xeeb326[_0x976285]--,_0x976285++;}_0x470165(_0x2c34ff)[_0x5bba80(0x1c6)](_0x5bba80(0xf7))['each']((_0x3b23c2,_0x289d71)=>{const _0x3657e1=_0x5bba80;let _0x54dcf3=_0x470165(_0x289d71)[_0x3657e1(0x130)]()['trim'](),_0x4ddf6d=parseFloat(_0x54dcf3[_0x3657e1(0x196)](/,/g,'')),_0x4b79b1={};!isNaN(_0x4ddf6d)?(_0x4b79b1['v']=_0x4ddf6d,_0x4b79b1['t']='n'):(_0x4b79b1['v']=_0x54dcf3,_0x4b79b1['t']='s');const _0x510bfe=_0x470165(_0x289d71)[_0x3657e1(0x1c5)](_0x3657e1(0xdb)),_0x3bc327=_0x38ff85(_0x510bfe);_0x4b79b1['s']={'border':_0x3bc327},_0x485ba8[_0x976285]=_0x4b79b1;let _0xb9e61a=parseInt(_0x470165(_0x289d71)['attr'](_0x3657e1(0x21a)))||0x1,_0x54dce2=parseInt(_0x470165(_0x289d71)[_0x3657e1(0x1c5)](_0x3657e1(0xe2)))||0x1;(_0xb9e61a>0x1||_0x54dce2>0x1)&&_0x517cb0[_0x3657e1(0xde)]({'s':{'r':_0x12cf79,'c':_0x976285},'e':{'r':_0x12cf79+_0x54dce2-0x1,'c':_0x976285+_0xb9e61a-0x1}});for(let _0x405c41=0x0;_0x405c41<_0xb9e61a;_0x405c41++){_0x54dce2>0x1&&(_0xeeb326[_0x976285+_0x405c41]=_0x54dce2-0x1);}_0x976285+=_0xb9e61a;}),_0x26dc7a[_0x5bba80(0xde)](_0x485ba8);});const _0x42d191=XLSX['utils'][_0x42b9c8(0x1e9)](),_0x5895f2=XLSX[_0x42b9c8(0x22d)][_0x42b9c8(0x253)](_0x26dc7a);_0x517cb0['length']>0x0&&(_0x5895f2[_0x42b9c8(0xdc)]=_0x517cb0);_0x5895f2[_0x42b9c8(0x146)]=_0x26dc7a[0x0][_0x42b9c8(0x13f)](()=>({'wpx':0x64})),XLSX[_0x42b9c8(0x22d)][_0x42b9c8(0x1c9)](_0x42d191,_0x5895f2,_0x42b9c8(0x240));const _0xc984fa=XLSX[_0x42b9c8(0xf0)](_0x42d191,{'bookType':'xlsx','type':_0x42b9c8(0x248)});_0x354ec9[_0x42b9c8(0x178)](_0x42b9c8(0x108),_0x42b9c8(0x24c)),_0x354ec9[_0x42b9c8(0x178)](_0x42b9c8(0xe0),_0x42b9c8(0x122)),_0x354ec9[_0x42b9c8(0x236)](_0xc984fa);}else pdf['create'](_0xce15ca,_0x581e93)['toStream'](function(_0x35dcd5,_0x5966ec){const _0x383c56=_0x42b9c8;if(_0x35dcd5){_0x354ec9[_0x383c56(0x1f8)](0x1f4)[_0x383c56(0x236)](_0x383c56(0x154));return;}_0x354ec9[_0x383c56(0x178)](_0x383c56(0xe0),_0x383c56(0x251)),_0x5966ec['pipe'](_0x354ec9);});}catch(_0x169e7b){}}),router[a0_0x381a3d(0x105)]('/inventory_sum/view',auth,async(_0x34004e,_0x63516b)=>{const _0x68ea7e=a0_0x381a3d;try{const {username:_0x3f25b2,email:_0xb2dfe3,role:_0x596eb5}=_0x34004e['user'],_0x1803cc=_0x34004e[_0x68ea7e(0x19f)],_0x5e1109=await profile['findOne']({'email':_0x1803cc[_0x68ea7e(0x249)]}),_0x461a0e={'year':_0x68ea7e(0x101),'month':_0x68ea7e(0xd4),'day':_0x68ea7e(0x101)},_0x568bd4=await master_shop['find'](),_0x9acaeb=await product[_0x68ea7e(0x1c6)](),_0x426457=await warehouse[_0x68ea7e(0x224)]([{'$unwind':_0x68ea7e(0x1ff)},{'$lookup':{'from':_0x68ea7e(0xd1),'localField':_0x68ea7e(0x1c2),'foreignField':'name','as':_0x68ea7e(0x172)}},{'$unwind':_0x68ea7e(0xfb)},{'$project':{'product_name':_0x68ea7e(0x1b1),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x68ea7e(0x222),'product_stock':{'$sum':_0x68ea7e(0x256)}}}]);if(_0x568bd4[0x0][_0x68ea7e(0x17c)]==_0x68ea7e(0x235))var _0x4ba733=users['English'];else{if(_0x568bd4[0x0][_0x68ea7e(0x17c)]==_0x68ea7e(0x23f))var _0x4ba733=users[_0x68ea7e(0x23f)];else{if(_0x568bd4[0x0][_0x68ea7e(0x17c)]==_0x68ea7e(0x151))var _0x4ba733=users[_0x68ea7e(0x151)];else{if(_0x568bd4[0x0]['language']=='Spanish')var _0x4ba733=users[_0x68ea7e(0xee)];else{if(_0x568bd4[0x0]['language']=='French')var _0x4ba733=users['French'];else{if(_0x568bd4[0x0][_0x68ea7e(0x17c)]=='Portuguese\x20(BR)')var _0x4ba733=users[_0x68ea7e(0x244)];else{if(_0x568bd4[0x0][_0x68ea7e(0x17c)]==_0x68ea7e(0x21d))var _0x4ba733=users[_0x68ea7e(0x21d)];else{if(_0x568bd4[0x0]['language']=='Arabic\x20(ae)')var _0x4ba733=users[_0x68ea7e(0x18b)];}}}}}}}_0x63516b['render'](_0x68ea7e(0x128),{'success':_0x34004e[_0x68ea7e(0x1e4)](_0x68ea7e(0xd2)),'errors':_0x34004e[_0x68ea7e(0x1e4)](_0x68ea7e(0x227)),'alldata':_0x9acaeb,'profile':_0x5e1109,'master_shop':_0x568bd4,'role':_0x1803cc,'product_stock':_0x426457,'language':_0x4ba733});}catch(_0x39411f){}});async function dataInventoryReports(_0xfb5457,_0x5329ad,_0x4ef307){const _0x2aa60b=a0_0x381a3d,_0x463248=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0xfb5457,'$lte':_0x5329ad},'sales_staff_id':_0x4ef307}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x2aa60b(0x20d),'product_code':_0x2aa60b(0x203)},'sumqty':{'$sum':_0x2aa60b(0x164)}}},{'$sort':{'_id.product_name':0x1}}]),_0x206f00=mongoose[_0x2aa60b(0x1c8)][_0x2aa60b(0x155)],_0x51fb3d=await staff['aggregate']([{'$match':{'_id':_0x206f00(_0x4ef307)}},{'$unwind':'$product_list'},{'$match':{'product_list.isConfirm':_0x2aa60b(0x110)}},{'$group':{'_id':{'product_name':'$product_list.product_name','product_code':_0x2aa60b(0x1c4)},'sumqty':{'$sum':_0x2aa60b(0x177)}}},{'$sort':{'_id.product_name':0x1}}]),_0x4fb8fe=await sales_inv_data[_0x2aa60b(0x224)]([{'$match':{'date':{'$gte':_0xfb5457,'$lte':_0x5329ad},'sales_staff_id':_0x4ef307}},{'$unwind':_0x2aa60b(0x1de)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x2aa60b(0x203)},'totalQTYsum':{'$sum':_0x2aa60b(0x19c)}}}]);console['log'](_0x4fb8fe);let _0x5476b8='';var _0x163f3e=0x0;for(let _0x7671ad=0x0;_0x7671ad<=_0x51fb3d[_0x2aa60b(0x25e)]-0x1;_0x7671ad++){const _0x551c08=_0x51fb3d[_0x7671ad];_0x5476b8+='<tr>',_0x5476b8+=_0x2aa60b(0x199)+_0x551c08[_0x2aa60b(0x216)][_0x2aa60b(0x144)]+_0x2aa60b(0x20c),_0x5476b8+=_0x2aa60b(0x219)+_0x551c08[_0x2aa60b(0x216)][_0x2aa60b(0x189)]+_0x2aa60b(0x20c);var _0x297892=_0x551c08[_0x2aa60b(0x1b9)],_0x2cab77=0x0;for(let _0x156c6b=0x0;_0x156c6b<=_0x463248['length']-0x1;_0x156c6b++){const _0x3ac634=_0x463248[_0x156c6b];_0x551c08[_0x2aa60b(0x216)][_0x2aa60b(0x144)]==_0x3ac634[_0x2aa60b(0x216)][_0x2aa60b(0x144)]&&_0x551c08[_0x2aa60b(0x216)][_0x2aa60b(0x189)]==_0x3ac634[_0x2aa60b(0x216)][_0x2aa60b(0x189)]&&(_0x2cab77=_0x3ac634['sumqty']);}var _0x474887=0x0;for(let _0x33f1ae=0x0;_0x33f1ae<=_0x4fb8fe['length']-0x1;_0x33f1ae++){const _0xbb1d6=_0x4fb8fe[_0x33f1ae];_0x551c08['_id'][_0x2aa60b(0x144)]==_0xbb1d6['_id'][_0x2aa60b(0x144)]&&_0x551c08[_0x2aa60b(0x216)]['product_name']==_0xbb1d6['_id'][_0x2aa60b(0x189)]&&(_0x474887=_0xbb1d6['totalQTYsum']);}_0x163f3e=_0x297892-_0x474887+_0x2cab77,_0x5476b8+=_0x2aa60b(0x170)+_0x163f3e+'</td>';let _0x481066=![];for(let _0x138b5c=0x0;_0x138b5c<=_0x4fb8fe[_0x2aa60b(0x25e)]-0x1;_0x138b5c++){const _0x3b46b0=_0x4fb8fe[_0x138b5c];if(_0x551c08[_0x2aa60b(0x216)][_0x2aa60b(0x144)]==_0x3b46b0['_id'][_0x2aa60b(0x144)]&&_0x551c08['_id'][_0x2aa60b(0x189)]==_0x3b46b0[_0x2aa60b(0x216)][_0x2aa60b(0x189)]){_0x5476b8+=_0x2aa60b(0x170)+_0x3b46b0[_0x2aa60b(0x120)]+_0x2aa60b(0x20c),_0x481066=!![];break;}}!_0x481066&&(_0x5476b8+='<td\x20class=\x22row_data\x22>0</td>');let _0x5a1639=![];for(let _0x38e71b=0x0;_0x38e71b<=_0x463248[_0x2aa60b(0x25e)]-0x1;_0x38e71b++){const _0xcd38d6=_0x463248[_0x38e71b];if(_0x551c08[_0x2aa60b(0x216)]['product_code']==_0xcd38d6[_0x2aa60b(0x216)][_0x2aa60b(0x144)]&&_0x551c08[_0x2aa60b(0x216)]['product_name']==_0xcd38d6[_0x2aa60b(0x216)][_0x2aa60b(0x189)]){_0x5476b8+=_0x2aa60b(0x170)+_0xcd38d6[_0x2aa60b(0x1b9)]+_0x2aa60b(0x20c),_0x5a1639=!![];break;}}!_0x5a1639&&(_0x5476b8+=_0x2aa60b(0xf9)),_0x5476b8+=_0x2aa60b(0x170)+_0x551c08[_0x2aa60b(0x1b9)]+_0x2aa60b(0x20c),_0x5476b8+=_0x2aa60b(0x237);}return _0x5476b8;}function a0_0x5084(_0x545fd8,_0x171629){const _0x2616ae=a0_0x2616();return a0_0x5084=function(_0x50846e,_0x17ea02){_0x50846e=_0x50846e-0xd0;let _0x3f2ef7=_0x2616ae[_0x50846e];return _0x3f2ef7;},a0_0x5084(_0x545fd8,_0x171629);}router[a0_0x381a3d(0x18f)]('/inventory_sum/pdf',auth,async(_0x3207d3,_0x2b72f2)=>{const _0x4134c5=a0_0x381a3d;try{const {from_date:_0x256841,to_date:_0x31891e}=_0x3207d3['body'],_0x10b857=_0x3207d3[_0x4134c5(0x19f)],_0x222b77=await staff[_0x4134c5(0x127)]({'email':_0x10b857['email']});let _0x54c82b=_0x4134c5(0x133);var _0xd4492b=new Date(_0x256841),_0x159e9f=new Date(_0x31891e);const _0x4c09ab={'year':_0x4134c5(0x101),'month':'long','day':_0x4134c5(0x101)},_0x30dd19=new Intl[(_0x4134c5(0x157))](_0x4134c5(0x246),_0x4c09ab)[_0x4134c5(0x12f)](_0xd4492b),_0x213c30=new Intl[(_0x4134c5(0x157))](_0x4134c5(0x246),_0x4c09ab)['format'](_0x159e9f);var _0x37c6d5=await dataInventoryReports(_0x256841,_0x31891e,_0x222b77[_0x4134c5(0x216)][_0x4134c5(0x1fa)]());_0x54c82b+=_0x4134c5(0x17e),_0x54c82b+='<p>INVENTORY\x20SUMMARY</p>',_0x54c82b+=_0x4134c5(0x1fe)+_0x30dd19+'\x20-\x20'+_0x213c30+_0x4134c5(0x1cc),_0x54c82b+='<div\x20class=\x22row\x22>',_0x54c82b+=_0x4134c5(0x169),_0x54c82b+=_0x4134c5(0x1b5),_0x54c82b+='<tr>',_0x54c82b+=_0x4134c5(0x111),_0x54c82b+=_0x4134c5(0x1a6),_0x54c82b+=_0x4134c5(0x16b),_0x54c82b+=_0x4134c5(0x1ae),_0x54c82b+=_0x4134c5(0x1a2),_0x54c82b+=_0x4134c5(0x115),_0x54c82b+=_0x4134c5(0x194),_0x54c82b+=_0x37c6d5,_0x54c82b+='</tr>',_0x54c82b+=_0x4134c5(0x138),_0x54c82b+=_0x4134c5(0x138);const _0x40a692={'format':_0x4134c5(0x1b6),'orientation':_0x4134c5(0x117)};pdf[_0x4134c5(0x168)](_0x54c82b,_0x40a692)['toStream'](function(_0x2310ab,_0x545c45){const _0x5ec1e2=_0x4134c5;if(_0x2310ab){_0x2b72f2[_0x5ec1e2(0x1f8)](0x1f4)['send'](_0x5ec1e2(0x154));return;}_0x2b72f2[_0x5ec1e2(0x178)]('Content-Type','application/pdf'),_0x545c45[_0x5ec1e2(0x1e2)](_0x2b72f2);});}catch(_0x39975d){}}),router[a0_0x381a3d(0x105)](a0_0x381a3d(0xf6),auth,async(_0x26742a,_0x4cc1ad)=>{const _0x183862=a0_0x381a3d;try{const {username:_0x1d4667,email:_0x39d95,role:_0x1856e8}=_0x26742a[_0x183862(0x19f)],_0x491f7a=_0x26742a[_0x183862(0x19f)],_0x117255=await profile[_0x183862(0x127)]({'email':_0x491f7a[_0x183862(0x249)]}),_0x178a4e={'year':_0x183862(0x101),'month':'long','day':'numeric'},_0x2a59d2=await master_shop[_0x183862(0x1c6)]();console[_0x183862(0x13c)](_0x183862(0x22f),_0x2a59d2);const _0x5edb92=await product[_0x183862(0x1c6)]();console[_0x183862(0x13c)](_0x183862(0x134),_0x5edb92);const _0x1c6c39=await warehouse[_0x183862(0x224)]([{'$unwind':_0x183862(0x1ff)},{'$lookup':{'from':_0x183862(0xd1),'localField':_0x183862(0x1c2),'foreignField':'name','as':_0x183862(0x172)}},{'$unwind':'$product_docs'},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x183862(0x123)}},{'$group':{'_id':_0x183862(0x222),'product_stock':{'$sum':'$product_stock'}}}]);console['log'](_0x183862(0x21f),_0x1c6c39),_0x1c6c39['forEach'](_0x3fb25e=>{const _0x3ff558=_0x183862,_0xef6256=_0x5edb92[_0x3ff558(0x13f)](_0x313e12=>{const _0x5c0047=_0x3ff558;_0x313e12[_0x5c0047(0x118)]==_0x3fb25e[_0x5c0047(0x216)]&&(_0x313e12[_0x5c0047(0x1bf)]=parseInt(_0x313e12[_0x5c0047(0x1bf)])+parseInt(_0x3fb25e[_0x5c0047(0x1d8)]));});});const _0x211e61=await staff[_0x183862(0x127)]({'email':_0x491f7a[_0x183862(0x249)]});if(_0x2a59d2[0x0][_0x183862(0x17c)]==_0x183862(0x235))var _0x261903=users[_0x183862(0x147)];else{if(_0x2a59d2[0x0][_0x183862(0x17c)]==_0x183862(0x23f))var _0x261903=users[_0x183862(0x23f)];else{if(_0x2a59d2[0x0]['language']==_0x183862(0x151))var _0x261903=users[_0x183862(0x151)];else{if(_0x2a59d2[0x0][_0x183862(0x17c)]==_0x183862(0xee))var _0x261903=users[_0x183862(0xee)];else{if(_0x2a59d2[0x0][_0x183862(0x17c)]==_0x183862(0x1e0))var _0x261903=users['French'];else{if(_0x2a59d2[0x0][_0x183862(0x17c)]==_0x183862(0x230))var _0x261903=users['Portuguese'];else{if(_0x2a59d2[0x0]['language']==_0x183862(0x21d))var _0x261903=users['Chinese'];else{if(_0x2a59d2[0x0][_0x183862(0x17c)]==_0x183862(0x171))var _0x261903=users[_0x183862(0x18b)];}}}}}}}_0x4cc1ad[_0x183862(0x211)](_0x183862(0x24d),{'success':_0x26742a[_0x183862(0x1e4)]('success'),'errors':_0x26742a[_0x183862(0x1e4)](_0x183862(0x227)),'alldata':_0x5edb92,'profile':_0x117255,'master_shop':_0x2a59d2,'role':_0x491f7a,'product_stock':_0x1c6c39,'language':_0x261903,'staff_arr':_0x211e61});}catch(_0x459a73){}});async function agentsdataDSICheck_DSRR(_0x4c5eb2,_0x9aeca0,_0x437149,_0x2b3d24){const _0x259126=a0_0x381a3d;let _0x5e5f91=new Date(_0x4c5eb2);_0x5e5f91['setDate'](_0x5e5f91['getDate']()-0x1);let _0x43540e=_0x5e5f91[_0x259126(0xf8)]()[_0x259126(0x131)]('T')[0x0];const _0x2536ba=await product[_0x259126(0x224)]([{'$group':{'_id':{'brand':_0x259126(0x22a),'category':_0x259126(0x231)},'products':{'$push':{'name':'$name','product_code':_0x259126(0x135)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2f2ed3=[];_0x2f2ed3[_0x259126(0x107)]=[];for(let _0x29216d=0x0;_0x29216d<=_0x2536ba[_0x259126(0x25e)]-0x1;_0x29216d++){const _0x1c134e=_0x2536ba[_0x29216d];_0x2f2ed3[_0x259126(0x107)][_0x259126(0xde)](_0x1c134e);}const _0x5409f8=await product[_0x259126(0x224)]([{'$group':{'_id':{'category':_0x259126(0x231)},'products':{'$push':{'brand':_0x259126(0x22a),'product_code':_0x259126(0x135),'product_name':_0x259126(0x167)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4e596e=await product['aggregate']([{'$group':{'_id':{'category':_0x259126(0x231),'brand':_0x259126(0x22a)}}},{'$group':{'_id':_0x259126(0x184),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x225d9f=await sales_sa['aggregate']([{'$match':{'date':_0x4c5eb2,'sales_staff_id':_0x9aeca0,'sale_product.isFG':_0x259126(0x215)}},{'$unwind':_0x259126(0x1de)},{'$lookup':{'from':_0x259126(0xd1),'localField':_0x259126(0x162),'foreignField':_0x259126(0x144),'as':'product_info'}},{'$unwind':_0x259126(0x16d)},{'$group':{'_id':{'dsi':_0x259126(0x1a0),'date':'$date','customer':_0x259126(0xd9),'status_data':_0x259126(0x1cd)},'totalQty':{'$sum':_0x259126(0x102)},'cash':{'$first':_0x259126(0x1e5)},'amount':{'$first':_0x259126(0x23c)},'bank':{'$first':_0x259126(0x1aa)},'check_no':{'$first':_0x259126(0x192)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x259126(0x102),'NetPrice':'$sale_product.totalprice','discount':_0x259126(0x1f0),'adj_discount':_0x259126(0x24b),'product_details':{'prod_name':_0x259126(0x200),'product_code':_0x259126(0x15e),'category':'$product_info.category','brand':_0x259126(0xe4),'gross_price':'$product_info.gross_price','isFG':_0x259126(0x1fd),'prod_cat':'$sale_product.prod_cat','prod_id':_0x259126(0x14b)}}}}},{'$unwind':_0x259126(0x225)},{'$group':{'_id':{'dsi':_0x259126(0x214),'date':_0x259126(0x21e),'customer':_0x259126(0x129),'status_data':_0x259126(0x20e),'category':_0x259126(0x255),'brand':'$products.product_details.brand','prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x259126(0x24a)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x259126(0x1f9)]}},'NetPrice':{'$sum':_0x259126(0x1ac)},'discount':{'$sum':_0x259126(0x1a8)},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':_0x259126(0x1e5)},'amount':{'$first':_0x259126(0x23c)},'bank':{'$first':_0x259126(0x1aa)},'check_no':{'$first':_0x259126(0x192)},'due_date':{'$first':_0x259126(0x1a1)},'product_details':{'$first':_0x259126(0x175)}}},{'$group':{'_id':{'dsi':_0x259126(0x214),'date':_0x259126(0x21e),'customer':'$_id.customer','status_data':_0x259126(0x20e)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x259126(0xf5)},'NetPrice':{'$sum':_0x259126(0x132)},'discount':{'$sum':_0x259126(0x156)},'adj_discount':{'$sum':_0x259126(0xd8)},'cash':{'$first':_0x259126(0x1e5)},'amount':{'$first':_0x259126(0x23c)},'bank':{'$first':_0x259126(0x1aa)},'check_no':{'$first':_0x259126(0x192)},'due_date':{'$first':_0x259126(0x1a1)},'products':{'$push':{'qty':'$totalQty','category':_0x259126(0x184),'brand':_0x259126(0x158),'product_details':_0x259126(0x1ff)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x4c4ca4=await sales_sa[_0x259126(0x224)]([{'$match':{'date':_0x43540e,'sales_staff_id':_0x9aeca0,'sale_product.isFG':_0x259126(0x215)}},{'$unwind':_0x259126(0x1de)},{'$lookup':{'from':'products','localField':_0x259126(0x162),'foreignField':_0x259126(0x144),'as':'product_info'}},{'$unwind':_0x259126(0x16d)},{'$group':{'_id':{'dsi':'$dsi','date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x259126(0x102)},'cash':{'$first':_0x259126(0x1e5)},'amount':{'$first':_0x259126(0x23c)},'bank':{'$first':_0x259126(0x1aa)},'check_no':{'$first':'$check_no'},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x259126(0x102),'NetPrice':_0x259126(0x1b0),'discount':_0x259126(0x1f0),'adj_discount':_0x259126(0x24b),'product_details':{'prod_name':_0x259126(0x200),'product_code':_0x259126(0x15e),'category':'$product_info.category','brand':_0x259126(0xe4),'gross_price':'$product_info.gross_price','isFG':_0x259126(0x1fd),'prod_cat':'$sale_product.prod_cat','prod_id':_0x259126(0x14b)}}}}},{'$unwind':_0x259126(0x225)},{'$group':{'_id':{'dsi':_0x259126(0x214),'date':_0x259126(0x21e),'customer':_0x259126(0x129),'category':'$products.product_details.category','brand':_0x259126(0x180),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':_0x259126(0x24a)},'cash':{'$first':_0x259126(0x1e5)},'amount':{'$first':_0x259126(0x23c)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x259126(0x192)},'due_date':{'$first':'$due_date'},'totalGross':{'$sum':{'$multiply':[_0x259126(0x24a),_0x259126(0x1f9)]}},'NetPrice':{'$sum':_0x259126(0x1ac)},'discount':{'$sum':_0x259126(0x1a8)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x259126(0x175)}}},{'$group':{'_id':{'dsi':_0x259126(0x214),'date':_0x259126(0x21e),'customer':_0x259126(0x129)},'totalQty':{'$sum':_0x259126(0x1b4)},'cash':{'$first':_0x259126(0x1e5)},'amount':{'$first':_0x259126(0x23c)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x259126(0x192)},'due_date':{'$first':_0x259126(0x1a1)},'totalGross':{'$sum':_0x259126(0xf5)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x259126(0x156)},'adj_discount':{'$sum':_0x259126(0xd8)},'products':{'$push':{'qty':_0x259126(0x1b4),'category':'$_id.category','brand':_0x259126(0x158),'product_details':_0x259126(0x1ff)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xb98a71=await sales_sa[_0x259126(0x224)]([{'$match':{'date':_0x4c5eb2,'sales_staff_id':_0x9aeca0,'status_data':_0x259126(0x110)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x22fd9c=await staff[_0x259126(0x1ef)](_0x9aeca0);let _0x17524d=[],_0x3bed45={},_0x2e9d90={};var _0x819d4e=0x0,_0x1f6056=0x0,_0x43d915=0x0,_0x5d9bca=0x0,_0x4b2452=0x0;const _0x4ac8d4=0x6;var _0x2754e7=0x0,_0x5428bf=0x0;for(let _0x40b9b8=0x0;_0x40b9b8<=_0x225d9f[_0x259126(0x25e)]-0x1;_0x40b9b8++){const _0x17ea14=_0x225d9f[_0x40b9b8];let _0x1c33f9=_0x259126(0x194);_0x1c33f9+=_0x259126(0xf3),_0x1c33f9+=_0x259126(0x1cf)+_0x17ea14[_0x259126(0x216)][_0x259126(0x207)]+_0x259126(0x20c),_0x1c33f9+=_0x259126(0x1cf)+_0x17ea14[_0x259126(0x216)][_0x259126(0x17a)]+'</td>';let _0x2e6d0a={},_0x239a2a={},_0x12dfd5={};var _0x1258c4={},_0x515453={},_0x1187b0={},_0x30d415=0x0;for(let _0x14aa51=0x0;_0x14aa51<=_0x17ea14[_0x259126(0xd1)][_0x259126(0x25e)]-0x1;_0x14aa51++){const _0x1bf9b7=_0x17ea14[_0x259126(0xd1)][_0x14aa51];_0x2e6d0a[_0x1bf9b7['brand']+'-'+_0x1bf9b7[_0x259126(0xe1)]]=_0x1bf9b7[_0x259126(0x201)],_0x239a2a[[_0x1bf9b7[_0x259126(0x1a9)]+'-'+_0x1bf9b7[_0x259126(0xe1)]]]=_0x1bf9b7['product_details']['isFG'],_0x12dfd5[[_0x1bf9b7['brand']+'-'+_0x1bf9b7[_0x259126(0xe1)]]]=_0x1bf9b7['product_details'][_0x259126(0x213)];const _0x4427f2=_0x1bf9b7[_0x259126(0x1a9)]+'-'+_0x1bf9b7[_0x259126(0xe1)];!Array[_0x259126(0x124)](_0x2e9d90[_0x4427f2])&&(_0x2e9d90[_0x4427f2]=[]);!Array[_0x259126(0x124)](_0x2e9d90[_0x4427f2])&&(_0x2e9d90[_0x4427f2]=[]);_0x2e9d90[_0x4427f2][_0x259126(0xde)](_0x1bf9b7[_0x259126(0x201)]);if(_0x1bf9b7['product_details'][_0x259126(0x213)]=='P')_0x1bf9b7[_0x259126(0x1ce)][_0x259126(0x23b)]=='true'?(!_0x1187b0[_0x4427f2]&&(_0x1187b0[_0x4427f2]=0x0),_0x1187b0[_0x4427f2]=_0x1bf9b7[_0x259126(0x201)]):(!_0x1258c4[_0x4427f2]&&(_0x1258c4[_0x4427f2]=0x0),_0x1258c4[_0x4427f2]=_0x1bf9b7[_0x259126(0x201)]);else _0x1bf9b7[_0x259126(0x1ce)][_0x259126(0x213)]=='S'&&(_0x1bf9b7[_0x259126(0x1ce)]['isFG']=='true'?(!_0x1187b0[_0x4427f2]&&(_0x1187b0[_0x4427f2]=0x0),_0x1187b0[_0x4427f2]=_0x1bf9b7[_0x259126(0x201)]):(!_0x515453[_0x4427f2]&&(_0x515453[_0x4427f2]=0x0),_0x515453[_0x4427f2]=_0x1bf9b7['qty']));_0x30d415++;}for(let _0x74b6c=0x0;_0x74b6c<=_0x2f2ed3[_0x259126(0x107)][_0x259126(0x25e)]-0x1;_0x74b6c++){const _0x3961d6=_0x2f2ed3[_0x259126(0x107)][_0x74b6c],_0x43eda8=_0x3961d6[_0x259126(0x216)][_0x259126(0x1a9)]+'-'+_0x3961d6[_0x259126(0x216)][_0x259126(0xe1)],_0x29ccc1=_0x12dfd5[_0x43eda8]!==undefined?_0x12dfd5[_0x43eda8]:'NA';var _0x2135b9=_0x1258c4[_0x43eda8]!==undefined?_0x1258c4[_0x43eda8]['toFixed'](0x2):'',_0x1c997d=_0x515453[_0x43eda8]!==undefined?_0x515453[_0x43eda8]['toFixed'](0x2):'',_0xd1cf7a=_0x1187b0[_0x43eda8]!==undefined?_0x1187b0[_0x43eda8]['toFixed'](0x2):'';_0x1c33f9+=_0x259126(0x208)+_0x2135b9+'</td>',_0x1c33f9+=_0x259126(0x208)+_0x1c997d+_0x259126(0x20c),_0x1c33f9+=_0x259126(0x208)+_0xd1cf7a+'</td>';}var _0x2d99e8=formatNumber(parseFloat(_0x17ea14['cash'])),_0x1383ce=formatNumber(parseFloat(_0x17ea14[_0x259126(0x125)]));isNaN(_0x1383ce)&&(_0x1383ce=0x0),_0x1c33f9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x2d99e8+_0x259126(0x20c),_0x1c33f9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x1383ce+_0x259126(0x20c),_0x1c33f9+=_0x259126(0x1cf)+_0x17ea14['bank']+_0x259126(0x20c),_0x1c33f9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x17ea14[_0x259126(0x1e1)]+_0x259126(0x20c),_0x1c33f9+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x17ea14[_0x259126(0x12b)]+_0x259126(0x20c),_0x43d915=_0x17ea14[_0x259126(0x103)]+_0x17ea14[_0x259126(0x17f)],_0x2754e7+=parseFloat(_0x17ea14[_0x259126(0x1a5)]),_0x5428bf+=parseFloat(_0x1383ce),_0x17524d[_0x259126(0xde)](_0x1c33f9);}function _0x45ff9b(_0x3eb4e7,_0x5218e7){const _0x52c4f2=_0x259126,_0x4db22f=[];for(let _0x27fd5f=0x0;_0x27fd5f<=_0x3eb4e7[_0x52c4f2(0x25e)]-0x1;_0x27fd5f+=_0x5218e7){_0x4db22f['push'](_0x3eb4e7[_0x52c4f2(0x1b3)](_0x27fd5f,_0x27fd5f+_0x5218e7));}return _0x4db22f;}const _0x178574=_0x45ff9b(_0x17524d,_0x4ac8d4);let _0x27363f='';return _0x178574[_0x259126(0x1d4)]((_0x22a4e7,_0x1c0793)=>{const _0x348e07=_0x259126;_0x1c0793>0x0&&(_0x27363f+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x27363f+=_0x348e07(0x1b5),_0x27363f+='<thead>';const _0x4c17db=new Date(_0x4c5eb2),_0x56202c={'year':_0x348e07(0x101),'month':_0x348e07(0xd4),'day':'numeric','timeZone':_0x348e07(0x15c)},_0x491994=_0x4c17db['toLocaleDateString'](_0x348e07(0x246),_0x56202c);_0x27363f+='<tr>',_0x27363f+=_0x348e07(0x254)+_0x2b3d24+_0x348e07(0x23a),_0x27363f+=_0x348e07(0x237),_0x27363f+='<tr>',_0x27363f+=_0x348e07(0xdd)+_0x22fd9c[_0x348e07(0x118)]+_0x348e07(0x20c),_0x27363f+=_0x348e07(0x241),_0x27363f+=_0x348e07(0x14e),_0x27363f+=_0x348e07(0x21b),_0x27363f+=_0x348e07(0x143),_0x27363f+=_0x348e07(0xda),_0x27363f+=_0x348e07(0x145),_0x27363f+=_0x348e07(0x182),_0x27363f+=_0x348e07(0x22c),_0x27363f+=_0x348e07(0x237),_0x27363f+=_0x348e07(0x194),_0x27363f+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x27363f+=_0x348e07(0x166)+_0x491994+_0x348e07(0x20c),_0x27363f+=_0x348e07(0x1bd),_0x27363f+=_0x348e07(0xd5),_0x27363f+=_0x348e07(0x15d),_0x27363f+=_0x348e07(0x15d),_0x27363f+=_0x348e07(0x237),_0x27363f+=_0x348e07(0x194),_0x27363f+='<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>',_0x27363f+=_0x348e07(0x239),_0x27363f+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>',_0x27363f+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x27363f+=_0x348e07(0x15d),_0x27363f+='</tr>',_0x27363f+=_0x348e07(0x194),_0x27363f+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x27363f+=_0x348e07(0x237),_0x27363f+=_0x348e07(0x194),_0x27363f+=_0x348e07(0xf1),_0x27363f+='<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>',_0x27363f+=_0x348e07(0x237),_0x27363f+=_0x348e07(0x194),_0x27363f+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>',_0x27363f+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x27363f+=_0x348e07(0x10c);for(let _0x13f6e1=0x0;_0x13f6e1<=_0x5409f8[_0x348e07(0x25e)]-0x1;_0x13f6e1++){const _0x22f45c=_0x5409f8[_0x13f6e1];for(let _0x5f3f89=0x0;_0x5f3f89<_0x2f2ed3[_0x348e07(0x107)][_0x348e07(0x25e)];_0x5f3f89++){const _0x4d247f=_0x2f2ed3['cat_brand'][_0x5f3f89];if(_0x4d247f[_0x348e07(0x216)][_0x348e07(0xe1)]===_0x22f45c[_0x348e07(0x216)][_0x348e07(0xe1)]){var _0x4e2412='';switch(_0x22f45c[_0x348e07(0x216)]['category']){case'Standard':_0x4e2412=_0x4d247f[_0x348e07(0x216)][_0x348e07(0x1a9)]+'\x20-\x20STD';break;case _0x348e07(0xd3):_0x4e2412=_0x4d247f['_id'][_0x348e07(0x1a9)]+_0x348e07(0x11c);break;default:_0x4e2412=_0x4d247f['_id'][_0x348e07(0x1a9)];break;}_0x27363f+=_0x348e07(0x1cb)+_0x4e2412+'</b></td>';}}}_0x27363f+=_0x348e07(0x1d9),_0x27363f+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>',_0x27363f+=_0x348e07(0x25d),_0x27363f+=_0x348e07(0x237),_0x27363f+=_0x348e07(0x194),_0x27363f+=_0x348e07(0x1ee);for(let _0x4a00df=0x0;_0x4a00df<=_0x2f2ed3[_0x348e07(0x107)]['length']-0x1;_0x4a00df++){const _0x2dec47=_0x2f2ed3[_0x4a00df];_0x27363f+=_0x348e07(0xf4),_0x27363f+=_0x348e07(0x1d1),_0x27363f+='<td\x20class=\x22cat_data\x22><b>FG</b></td>';}_0x27363f+=_0x348e07(0x13b),_0x27363f+=_0x348e07(0xea),_0x27363f+=_0x348e07(0xeb),_0x27363f+=_0x348e07(0x237),_0x27363f+=_0x348e07(0x209),_0x27363f+=_0x348e07(0x16c),_0x22a4e7[_0x348e07(0x1d4)](_0x51a7cd=>{_0x27363f+=_0x51a7cd;});let _0x1f58c2={},_0x573830={},_0x39dafb={};for(let _0x20ec9e=0x0;_0x20ec9e<=_0x225d9f[_0x348e07(0x25e)]-0x1;_0x20ec9e++){const _0x275e8f=_0x225d9f[_0x20ec9e];var _0x2e0289=0x0;for(let _0x4f5b31=0x0;_0x4f5b31<=_0x275e8f[_0x348e07(0xd1)]['length']-0x1;_0x4f5b31++){const _0x2d0258=_0x275e8f[_0x348e07(0xd1)][_0x4f5b31],_0x1f405d=_0x2d0258[_0x348e07(0x1a9)]+'-'+_0x2d0258[_0x348e07(0xe1)];if(_0x2d0258['product_details'][_0x348e07(0x213)]=='P')_0x2d0258[_0x348e07(0x1ce)]['isFG']=='true'?(!_0x39dafb[_0x1f405d]&&(_0x39dafb[_0x1f405d]=0x0),_0x39dafb[_0x1f405d]+=_0x2d0258[_0x348e07(0x201)]):(!_0x1f58c2[_0x1f405d]&&(_0x1f58c2[_0x1f405d]=0x0),_0x1f58c2[_0x1f405d]+=_0x2d0258['qty']);else _0x2d0258[_0x348e07(0x1ce)][_0x348e07(0x213)]=='S'&&(_0x2d0258[_0x348e07(0x1ce)][_0x348e07(0x23b)]==_0x348e07(0x110)?(!_0x39dafb[_0x1f405d]&&(_0x39dafb[_0x1f405d]=0x0),_0x39dafb[_0x1f405d]+=_0x2d0258[_0x348e07(0x201)],console[_0x348e07(0x13c)](_0x2d0258[_0x348e07(0x201)])):(!_0x573830[_0x1f405d]&&(_0x573830[_0x1f405d]=0x0),_0x573830[_0x1f405d]+=_0x2d0258[_0x348e07(0x201)]));_0x2e0289++;}}let _0xb61de8={},_0x418fb0={},_0x131e8={};var _0xf1707e=0x0,_0x4f9133=0x0;for(let _0x518621=0x0;_0x518621<=_0x4c4ca4['length']-0x1;_0x518621++){const _0x4a08b6=_0x4c4ca4[_0x518621];var _0x2e0289=0x0;for(let _0x37ec88=0x0;_0x37ec88<=_0x4a08b6['products'][_0x348e07(0x25e)]-0x1;_0x37ec88++){const _0x3b4914=_0x4a08b6[_0x348e07(0xd1)][_0x37ec88],_0x1563f1=_0x3b4914[_0x348e07(0x1a9)]+'-'+_0x3b4914[_0x348e07(0xe1)];if(_0x3b4914[_0x348e07(0x1ce)][_0x348e07(0x213)]=='P')_0x3b4914['product_details'][_0x348e07(0x23b)]=='true'?(!_0x131e8[_0x1563f1]&&(_0x131e8[_0x1563f1]=0x0),_0x131e8[_0x1563f1]+=_0x3b4914[_0x348e07(0x201)]):(!_0xb61de8[_0x1563f1]&&(_0xb61de8[_0x1563f1]=0x0),_0xb61de8[_0x1563f1]+=_0x3b4914['qty']);else _0x3b4914[_0x348e07(0x1ce)][_0x348e07(0x213)]=='S'&&(_0x3b4914[_0x348e07(0x1ce)][_0x348e07(0x23b)]==_0x348e07(0x110)?(!_0x131e8[_0x1563f1]&&(_0x131e8[_0x1563f1]=0x0),_0x131e8[_0x1563f1]+=_0x3b4914[_0x348e07(0x201)]):(!_0x418fb0[_0x1563f1]&&(_0x418fb0[_0x1563f1]=0x0),_0x418fb0[_0x1563f1]+=_0x3b4914['qty']));_0x2e0289++;}var _0x2ce265=parseFloat(_0x4a08b6['cash']),_0x128d78=parseFloat(_0x4a08b6[_0x348e07(0x125)]);isNaN(_0x128d78)&&(_0x128d78=0x0),_0xf1707e+=_0x2ce265,_0x4f9133+=_0x128d78;}if(_0xb98a71[_0x348e07(0x25e)]>0x0)for(let _0x1f1ebf=0x0;_0x1f1ebf<=_0xb98a71['length']-0x1;_0x1f1ebf++){const _0x51dc30=_0xb98a71[_0x1f1ebf];console[_0x348e07(0x13c)](_0x51dc30),_0x27363f+=_0x348e07(0x194),_0x27363f+=_0x348e07(0x250)+(0x8+0x7*0x3)+_0x348e07(0x1ba)+_0x51dc30['note']+_0x348e07(0x23a),_0x27363f+=_0x348e07(0x237);}_0x27363f+='<tr>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x27363f+=_0x348e07(0xf3);for(let _0x588272=0x0;_0x588272<=_0x2f2ed3[_0x348e07(0x107)][_0x348e07(0x25e)]-0x1;_0x588272++){const _0x3e095c=_0x2f2ed3[_0x348e07(0x107)][_0x588272],_0x1c2db5=_0x3e095c[_0x348e07(0x216)][_0x348e07(0x1a9)]+'-'+_0x3e095c[_0x348e07(0x216)][_0x348e07(0xe1)];var _0x3daefb=_0x1f58c2[_0x1c2db5]!==undefined?formatNumber(_0x1f58c2[_0x1c2db5]['toFixed'](0x2)):'',_0x56a030=_0x39dafb[_0x1c2db5]!==undefined?formatNumber(_0x39dafb[_0x1c2db5][_0x348e07(0x1e6)](0x2)):'',_0x3101f7=_0x573830[_0x1c2db5]!==undefined?formatNumber(_0x573830[_0x1c2db5]['toFixed'](0x2)):'';_0x27363f+=_0x348e07(0x139)+_0x3daefb+_0x348e07(0x23a),_0x27363f+=_0x348e07(0x139)+_0x3101f7+_0x348e07(0x23a),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x56a030+_0x348e07(0x23a);}_0x27363f+=_0x348e07(0x139)+formatNumber(_0x2754e7)+_0x348e07(0x23a),_0x27363f+=_0x348e07(0x139)+formatNumber(_0x5428bf)+'</b></td>',_0x27363f+=_0x348e07(0xf3),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+=_0x348e07(0x237),_0x27363f+=_0x348e07(0x194),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x27363f+=_0x348e07(0x245),_0x27363f+=_0x348e07(0xf3);for(let _0x381f0e=0x0;_0x381f0e<=_0x2f2ed3[_0x348e07(0x107)][_0x348e07(0x25e)]-0x1;_0x381f0e++){const _0x44c446=_0x2f2ed3[_0x348e07(0x107)][_0x381f0e],_0x432a52=_0x44c446[_0x348e07(0x216)]['brand']+'-'+_0x44c446['_id'][_0x348e07(0xe1)];var _0x3daefb=_0xb61de8[_0x432a52]!==undefined?formatNumber(_0xb61de8[_0x432a52][_0x348e07(0x1e6)](0x2)):'',_0x56a030=_0x131e8[_0x432a52]!==undefined?formatNumber(_0x131e8[_0x432a52]['toFixed'](0x2)):'',_0x3101f7=_0x418fb0[_0x432a52]!==undefined?formatNumber(_0x418fb0[_0x432a52][_0x348e07(0x1e6)](0x2)):'';_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3daefb+'</b></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x3101f7+_0x348e07(0x23a),_0x27363f+=_0x348e07(0x139)+_0x56a030+'</b></td>';}_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xf1707e)+'</b></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4f9133)+_0x348e07(0x23a),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0x237),_0x27363f+='<tr>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x27363f+=_0x348e07(0x218),_0x27363f+=_0x348e07(0xf3);let _0x2d469a=0x0,_0x239226=0x0,_0x206634=0x0;for(let _0xd54098=0x0;_0xd54098<=_0x2f2ed3[_0x348e07(0x107)][_0x348e07(0x25e)]-0x1;_0xd54098++){const _0x3e54d4=_0x2f2ed3['cat_brand'][_0xd54098],_0x3913f4=_0x3e54d4[_0x348e07(0x216)]['brand']+'-'+_0x3e54d4[_0x348e07(0x216)][_0x348e07(0xe1)];var _0x488eaa=_0x1f58c2[_0x3913f4]!==undefined?_0x1f58c2[_0x3913f4][_0x348e07(0x1e6)](0x2):'0',_0x438371=_0x39dafb[_0x3913f4]!==undefined?_0x39dafb[_0x3913f4]['toFixed'](0x2):'0',_0x21beb4=_0x573830[_0x3913f4]!==undefined?_0x573830[_0x3913f4]['toFixed'](0x2):'0',_0x3d1b08=_0xb61de8[_0x3913f4]!==undefined?_0xb61de8[_0x3913f4][_0x348e07(0x1e6)](0x2):'0',_0x604728=_0x131e8[_0x3913f4]!==undefined?_0x131e8[_0x3913f4][_0x348e07(0x1e6)](0x2):'0',_0xa0830f=_0x418fb0[_0x3913f4]!==undefined?_0x418fb0[_0x3913f4]['toFixed'](0x2):'0';_0x2d469a=parseFloat(_0x488eaa)+parseFloat(_0x3d1b08),_0x239226=parseFloat(_0x21beb4)+parseFloat(_0xa0830f),_0x206634=parseFloat(_0x438371)+parseFloat(_0x604728),_0x27363f+=_0x348e07(0x139)+formatNumber(_0x2d469a['toFixed'](0x2))+_0x348e07(0x23a),_0x27363f+=_0x348e07(0x139)+formatNumber(_0x239226['toFixed'](0x2))+_0x348e07(0x23a),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x206634[_0x348e07(0x1e6)](0x2))+_0x348e07(0x23a);}var _0x296b49=formatNumber(_0x2754e7+_0xf1707e),_0x539abc=formatNumber(_0x5428bf+_0x4f9133);_0x27363f+=_0x348e07(0x139)+_0x296b49+_0x348e07(0x23a),_0x27363f+=_0x348e07(0x139)+_0x539abc+_0x348e07(0x23a),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0x237),_0x27363f+='<tr>',_0x27363f+=_0x348e07(0x229)+(_0x2f2ed3[_0x348e07(0x107)]['length']*0x3+0x9)+_0x348e07(0x24f),_0x27363f+=_0x348e07(0x237),_0x27363f+=_0x348e07(0x194),_0x27363f+=_0x348e07(0x1ec),_0x27363f+=_0x348e07(0xdf),_0x27363f+=_0x348e07(0xf3);for(let _0xee5dd6=0x0;_0xee5dd6<=_0x2f2ed3['cat_brand'][_0x348e07(0x25e)]-0x1;_0xee5dd6++){const _0x3436da=_0x2f2ed3['cat_brand'][_0xee5dd6],_0x525688=_0x3436da[_0x348e07(0x216)][_0x348e07(0x1a9)]+'-'+_0x3436da[_0x348e07(0x216)][_0x348e07(0xe1)];var _0x488eaa=_0x1f58c2[_0x525688]!==undefined?_0x1f58c2[_0x525688][_0x348e07(0x1e6)](0x2):'0',_0x438371=_0x39dafb[_0x525688]!==undefined?_0x39dafb[_0x525688]['toFixed'](0x2):'0',_0x21beb4=_0x573830[_0x525688]!==undefined?_0x573830[_0x525688][_0x348e07(0x1e6)](0x2):'0',_0x3d1b08=_0xb61de8[_0x525688]!==undefined?_0xb61de8[_0x525688][_0x348e07(0x1e6)](0x2):'0',_0x604728=_0x131e8[_0x525688]!==undefined?_0x131e8[_0x525688][_0x348e07(0x1e6)](0x2):'0',_0xa0830f=_0x418fb0[_0x525688]!==undefined?_0x418fb0[_0x525688]['toFixed'](0x2):'0';_0x2d469a=parseFloat(_0x488eaa)+parseFloat(_0x3d1b08),_0x239226=parseFloat(_0x21beb4)+parseFloat(_0xa0830f),_0x206634=parseFloat(_0x438371)+parseFloat(_0x604728),_0x27363f+=_0x348e07(0x1ed),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x27363f+=_0x348e07(0x1ed);}_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+=_0x348e07(0xf3),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0x237),_0x27363f+='<tr>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>',_0x27363f+=_0x348e07(0xf3);for(let _0x1f9d79=0x0;_0x1f9d79<=_0x2f2ed3['cat_brand'][_0x348e07(0x25e)]-0x1;_0x1f9d79++){const _0x2923b7=_0x2f2ed3[_0x348e07(0x107)][_0x1f9d79],_0x463dea=_0x2923b7['_id']['brand']+'-'+_0x2923b7['_id']['category'];var _0x488eaa=_0x1f58c2[_0x463dea]!==undefined?_0x1f58c2[_0x463dea][_0x348e07(0x1e6)](0x2):'0',_0x438371=_0x39dafb[_0x463dea]!==undefined?_0x39dafb[_0x463dea]['toFixed'](0x2):'0',_0x21beb4=_0x573830[_0x463dea]!==undefined?_0x573830[_0x463dea][_0x348e07(0x1e6)](0x2):'0',_0x3d1b08=_0xb61de8[_0x463dea]!==undefined?_0xb61de8[_0x463dea][_0x348e07(0x1e6)](0x2):'0',_0x604728=_0x131e8[_0x463dea]!==undefined?_0x131e8[_0x463dea][_0x348e07(0x1e6)](0x2):'0',_0xa0830f=_0x418fb0[_0x463dea]!==undefined?_0x418fb0[_0x463dea][_0x348e07(0x1e6)](0x2):'0';_0x2d469a=parseFloat(_0x488eaa)+parseFloat(_0x3d1b08),_0x239226=parseFloat(_0x21beb4)+parseFloat(_0xa0830f),_0x206634=parseFloat(_0x438371)+parseFloat(_0x604728),_0x27363f+=_0x348e07(0x1ed),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+=_0x348e07(0xf3),_0x27363f+='</tr>',_0x27363f+=_0x348e07(0x194),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>',_0x27363f+=_0x348e07(0xf3);for(let _0x57dddc=0x0;_0x57dddc<=_0x2f2ed3[_0x348e07(0x107)][_0x348e07(0x25e)]-0x1;_0x57dddc++){const _0x2b9efb=_0x2f2ed3['cat_brand'][_0x57dddc],_0x15ca66=_0x2b9efb[_0x348e07(0x216)]['brand']+'-'+_0x2b9efb[_0x348e07(0x216)][_0x348e07(0xe1)];var _0x488eaa=_0x1f58c2[_0x15ca66]!==undefined?_0x1f58c2[_0x15ca66][_0x348e07(0x1e6)](0x2):'0',_0x438371=_0x39dafb[_0x15ca66]!==undefined?_0x39dafb[_0x15ca66]['toFixed'](0x2):'0',_0x21beb4=_0x573830[_0x15ca66]!==undefined?_0x573830[_0x15ca66]['toFixed'](0x2):'0',_0x3d1b08=_0xb61de8[_0x15ca66]!==undefined?_0xb61de8[_0x15ca66][_0x348e07(0x1e6)](0x2):'0',_0x604728=_0x131e8[_0x15ca66]!==undefined?_0x131e8[_0x15ca66][_0x348e07(0x1e6)](0x2):'0',_0xa0830f=_0x418fb0[_0x15ca66]!==undefined?_0x418fb0[_0x15ca66]['toFixed'](0x2):'0';_0x2d469a=parseFloat(_0x488eaa)+parseFloat(_0x3d1b08),_0x239226=parseFloat(_0x21beb4)+parseFloat(_0xa0830f),_0x206634=parseFloat(_0x438371)+parseFloat(_0x604728),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+='</tr>',_0x27363f+=_0x348e07(0x194),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x27363f+=_0x348e07(0xf3);for(let _0x5c0598=0x0;_0x5c0598<=_0x2f2ed3[_0x348e07(0x107)][_0x348e07(0x25e)]-0x1;_0x5c0598++){const _0x68cd76=_0x2f2ed3['cat_brand'][_0x5c0598],_0x2b7188=_0x68cd76['_id'][_0x348e07(0x1a9)]+'-'+_0x68cd76[_0x348e07(0x216)][_0x348e07(0xe1)];var _0x488eaa=_0x1f58c2[_0x2b7188]!==undefined?_0x1f58c2[_0x2b7188][_0x348e07(0x1e6)](0x2):'',_0x438371=_0x39dafb[_0x2b7188]!==undefined?_0x39dafb[_0x2b7188][_0x348e07(0x1e6)](0x2):'',_0x21beb4=_0x573830[_0x2b7188]!==undefined?_0x573830[_0x2b7188][_0x348e07(0x1e6)](0x2):'',_0x3d1b08=_0xb61de8[_0x2b7188]!==undefined?_0xb61de8[_0x2b7188][_0x348e07(0x1e6)](0x2):'',_0x604728=_0x131e8[_0x2b7188]!==undefined?_0x131e8[_0x2b7188][_0x348e07(0x1e6)](0x2):'',_0xa0830f=_0x418fb0[_0x2b7188]!==undefined?_0x418fb0[_0x2b7188][_0x348e07(0x1e6)](0x2):'';_0x2d469a=formatNumber(parseFloat(_0x488eaa)+parseFloat(_0x3d1b08)),_0x239226=formatNumber(parseFloat(_0x21beb4)+parseFloat(_0xa0830f)),_0x206634=formatNumber(parseFloat(_0x438371)+parseFloat(_0x604728)),_0x27363f+=_0x348e07(0x139)+_0x488eaa+'</b></td>',_0x27363f+=_0x348e07(0x139)+_0x21beb4+_0x348e07(0x23a),_0x27363f+=_0x348e07(0x139)+_0x438371+'</b></td>';}_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0x237),_0x27363f+=_0x348e07(0x194),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x27363f+=_0x348e07(0x10f),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x1af46e=0x0;_0x1af46e<=_0x2f2ed3[_0x348e07(0x107)][_0x348e07(0x25e)]-0x1;_0x1af46e++){const _0x25b4c2=_0x2f2ed3[_0x348e07(0x107)][_0x1af46e],_0x436c87=_0x25b4c2['_id'][_0x348e07(0x1a9)]+'-'+_0x25b4c2['_id'][_0x348e07(0xe1)];var _0x488eaa=_0x1f58c2[_0x436c87]!==undefined?_0x1f58c2[_0x436c87][_0x348e07(0x1e6)](0x2):'0',_0x438371=_0x39dafb[_0x436c87]!==undefined?_0x39dafb[_0x436c87][_0x348e07(0x1e6)](0x2):'0',_0x21beb4=_0x573830[_0x436c87]!==undefined?_0x573830[_0x436c87][_0x348e07(0x1e6)](0x2):'0',_0x3d1b08=_0xb61de8[_0x436c87]!==undefined?_0xb61de8[_0x436c87]['toFixed'](0x2):'0',_0x604728=_0x131e8[_0x436c87]!==undefined?_0x131e8[_0x436c87][_0x348e07(0x1e6)](0x2):'0',_0xa0830f=_0x418fb0[_0x436c87]!==undefined?_0x418fb0[_0x436c87]['toFixed'](0x2):'0';_0x2d469a=parseFloat(_0x488eaa)+parseFloat(_0x3d1b08),_0x239226=parseFloat(_0x21beb4)+parseFloat(_0xa0830f),_0x206634=parseFloat(_0x438371)+parseFloat(_0x604728),_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x27363f+=_0x348e07(0x1ed),_0x27363f+=_0x348e07(0x1ed);}_0x27363f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0xf3),_0x27363f+=_0x348e07(0x237),_0x27363f+='</tbody>',_0x27363f+=_0x348e07(0x10b);}),_0x27363f;}async function generateReferenceNumber(_0x359203,_0x2fe692,_0x4a82c7){const _0xbdb62a=a0_0x381a3d,_0x5a3de0=new Date(_0x359203)[_0xbdb62a(0x136)](),_0x5e3afd=('0'+(new Date(_0x359203)['getMonth']()+0x1))[_0xbdb62a(0x1b3)](-0x2),_0x1d9513=('0'+new Date(_0x359203)[_0xbdb62a(0x19b)]())['slice'](-0x2),_0x4f3046=await staff[_0xbdb62a(0x127)]({'email':_0x4a82c7['email']}),_0x1e7bc5=_0x4f3046[_0xbdb62a(0xff)],_0x9fd681=_0x1e7bc5+'-'+_0x5a3de0+_0x5e3afd+_0x1d9513,_0x1912e8=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x9fd681),'salesman_code':_0x1e7bc5})[_0xbdb62a(0x1f2)]({'createdAt':-0x1}),_0x3d5d9a=_0x9fd681;_0x1912e8&&(_0x3d5d9a=_0x1912e8[_0xbdb62a(0xe8)]);console[_0xbdb62a(0x13c)](_0x3d5d9a);const _0x2840ef=new Reference({'referenceNumber':_0x3d5d9a,'staff_id':_0x2fe692,'salesman_code':_0x1e7bc5});return await _0x2840ef[_0xbdb62a(0x1d3)](),_0x3d5d9a;}router[a0_0x381a3d(0x18f)](a0_0x381a3d(0x142),auth,async(_0x51d105,_0x1e1bf4)=>{const _0x1d92f4=a0_0x381a3d,{from_date:_0x44d75a,dataview:_0x3afb8f}=_0x51d105[_0x1d92f4(0x179)],_0x3c59c9=_0x51d105['user'],_0x13ac2a=await staff['findOne']({'email':_0x3c59c9[_0x1d92f4(0x249)]}),_0x1a69e0=await master_shop[_0x1d92f4(0x1c6)](),_0x250abd='';var _0x184fb1=new Date(_0x44d75a);const _0x2151eb={'year':_0x1d92f4(0x101),'month':_0x1d92f4(0xd4),'day':_0x1d92f4(0x101)},_0x512f00=new Intl[(_0x1d92f4(0x157))](_0x1d92f4(0x246),_0x2151eb)[_0x1d92f4(0x12f)](_0x184fb1),_0x16eb6d=await Reference[_0x1d92f4(0x1c6)]({'staff_id':_0x13ac2a[_0x1d92f4(0x216)][_0x1d92f4(0x1fa)](),'date_include':_0x44d75a});if(_0x16eb6d['length']>0x0){let _0x114c4c='';_0x114c4c+=_0x16eb6d[0x0][_0x1d92f4(0x1bb)];if(_0x3afb8f==_0x1d92f4(0x220)){const _0x166ff6=cheerio[_0x1d92f4(0x24e)](_0x114c4c);let _0x1f7bd0=[],_0x11b627=[],_0x3a0041=[];const _0x157007=_0x28c807=>{const _0x31fcc9=_0x1d92f4,_0x48cc3a={'top':{'style':_0x31fcc9(0x1b8),'color':{'rgb':_0x31fcc9(0xfe)}},'bottom':{'style':'thick','color':{'rgb':_0x31fcc9(0xfe)}},'left':{'style':'thick','color':{'rgb':'000000'}},'right':{'style':_0x31fcc9(0x1b8),'color':{'rgb':_0x31fcc9(0xfe)}}};if(_0x28c807){const _0x241cbf=_0x28c807[_0x31fcc9(0x131)](';')[_0x31fcc9(0x210)]((_0x1139f7,_0x1b2c61)=>{const _0x5d0d55=_0x31fcc9,[_0x181088,_0x20b547]=_0x1b2c61[_0x5d0d55(0x131)](':')[_0x5d0d55(0x13f)](_0x29c87d=>_0x29c87d[_0x5d0d55(0x106)]());return _0x1139f7[_0x181088]=_0x20b547,_0x1139f7;},{});_0x241cbf[_0x31fcc9(0x11b)]&&(_0x48cc3a[_0x31fcc9(0x234)][_0x31fcc9(0xdb)]=_0x241cbf[_0x31fcc9(0x11b)][_0x31fcc9(0x160)](_0x31fcc9(0x16f))?_0x31fcc9(0x16f):'medium'),_0x241cbf[_0x31fcc9(0x1ad)]&&(_0x48cc3a[_0x31fcc9(0x11f)]['style']=_0x241cbf[_0x31fcc9(0x1ad)][_0x31fcc9(0x160)]('thin')?_0x31fcc9(0x16f):'medium'),_0x241cbf['border-left']&&(_0x48cc3a[_0x31fcc9(0x152)][_0x31fcc9(0xdb)]=_0x241cbf[_0x31fcc9(0x187)][_0x31fcc9(0x160)]('thin')?_0x31fcc9(0x16f):_0x31fcc9(0x12c)),_0x241cbf['border-right']&&(_0x48cc3a['right'][_0x31fcc9(0xdb)]=_0x241cbf[_0x31fcc9(0x186)][_0x31fcc9(0x160)](_0x31fcc9(0x16f))?_0x31fcc9(0x16f):_0x31fcc9(0x12c));}return _0x48cc3a;};_0x166ff6(_0x1d92f4(0x137))['each']((_0x40d289,_0x5f47e6)=>{const _0x2a03ab=_0x1d92f4;let _0x364a3f=[],_0x445efb=0x0;while(_0x3a0041[_0x445efb]){_0x3a0041[_0x445efb]--,_0x445efb++;}_0x166ff6(_0x5f47e6)[_0x2a03ab(0x1c6)](_0x2a03ab(0xf7))['each']((_0x2f728a,_0x522d33)=>{const _0x3e943c=_0x2a03ab;let _0x12f9f0=_0x166ff6(_0x522d33)[_0x3e943c(0x130)]()[_0x3e943c(0x106)](),_0x5a2692=parseFloat(_0x12f9f0['replace'](/,/g,''));isNaN(_0x5a2692)&&(_0x5a2692=_0x12f9f0);let _0x422820=parseInt(_0x166ff6(_0x522d33)[_0x3e943c(0x1c5)]('colspan'))||0x1,_0x4e1bf9=parseInt(_0x166ff6(_0x522d33)[_0x3e943c(0x1c5)]('rowspan'))||0x1;const _0x2eb975=_0x166ff6(_0x522d33)[_0x3e943c(0x1c5)](_0x3e943c(0xdb)),_0x2b7d38=_0x157007(_0x2eb975);_0x364a3f[_0x445efb]={'v':_0x5a2692,'s':{'border':_0x2b7d38}};(_0x422820>0x1||_0x4e1bf9>0x1)&&_0x11b627[_0x3e943c(0xde)]({'s':{'r':_0x40d289,'c':_0x445efb},'e':{'r':_0x40d289+_0x4e1bf9-0x1,'c':_0x445efb+_0x422820-0x1}});for(let _0x48fe53=0x0;_0x48fe53<_0x422820;_0x48fe53++){_0x4e1bf9>0x1&&(_0x3a0041[_0x445efb+_0x48fe53]=_0x4e1bf9-0x1);}_0x445efb+=_0x422820;}),_0x1f7bd0['push'](_0x364a3f);});const _0x559c32=XLSX[_0x1d92f4(0x22d)][_0x1d92f4(0x1e9)](),_0x4548a8=XLSX[_0x1d92f4(0x22d)][_0x1d92f4(0x253)](_0x1f7bd0);_0x11b627[_0x1d92f4(0x25e)]>0x0&&(_0x4548a8[_0x1d92f4(0xdc)]=_0x11b627);_0x4548a8[_0x1d92f4(0x146)]=_0x1f7bd0[0x0][_0x1d92f4(0x13f)](()=>({'wpx':0x64})),XLSX['utils'][_0x1d92f4(0x1c9)](_0x559c32,_0x4548a8,_0x1d92f4(0x240));const _0x3f6b79=XLSX[_0x1d92f4(0xf0)](_0x559c32,{'bookType':_0x1d92f4(0x121),'type':'buffer'});_0x1e1bf4['setHeader'](_0x1d92f4(0x108),_0x1d92f4(0x24c)),_0x1e1bf4['setHeader'](_0x1d92f4(0xe0),_0x1d92f4(0x122)),_0x1e1bf4[_0x1d92f4(0x236)](_0x3f6b79);}else{let _0x5890bf='';_0x5890bf+=_0x114c4c,_0x5890bf+=_0x1d92f4(0x153),_0x5890bf+=_0x1d92f4(0x14f),_0x5890bf+='window.print();',_0x5890bf+='};',_0x5890bf+=_0x1d92f4(0x1e3),_0x1e1bf4['send'](_0x5890bf);}}else generateReferenceNumber(_0x44d75a,_0x13ac2a[_0x1d92f4(0x216)]['valueOf'](),_0x3c59c9)[_0x1d92f4(0x18a)](async _0x4ad8d1=>{const _0x37cd9d=_0x1d92f4,_0x11c9ce=await agentsdataDSICheck_DSRR(_0x44d75a,_0x13ac2a['_id'][_0x37cd9d(0x1fa)](),_0x250abd,_0x4ad8d1);let _0x8b9fbf=_0x37cd9d(0x15a);_0x8b9fbf+='<div\x20class=\x22row\x22>',_0x8b9fbf+=_0x37cd9d(0x18c),_0x8b9fbf+=_0x37cd9d(0x1b5),_0x8b9fbf+=_0x11c9ce,_0x8b9fbf+=_0x37cd9d(0x10b),_0x8b9fbf+='</div>',_0x8b9fbf+=_0x37cd9d(0x138);if(_0x11c9ce['length']>0x0){const _0x369f6b=await Reference[_0x37cd9d(0x127)]({'staff_id':_0x13ac2a[_0x37cd9d(0x216)][_0x37cd9d(0x1fa)](),'referenceNumber':_0x4ad8d1});_0x369f6b['html']=_0x8b9fbf,_0x369f6b['date_include']=_0x44d75a,await _0x369f6b[_0x37cd9d(0x1d3)]();if(_0x3afb8f=='excel'){const _0x1b735f=cheerio[_0x37cd9d(0x24e)](_0x8b9fbf);let _0x595415=[],_0x3e49fe=[],_0x341425=[];const _0x1cc971=_0x31498b=>{const _0x1ba08e=_0x37cd9d,_0x393218={'top':{'style':'thick','color':{'rgb':'000000'}},'bottom':{'style':_0x1ba08e(0x1b8),'color':{'rgb':'000000'}},'left':{'style':_0x1ba08e(0x1b8),'color':{'rgb':_0x1ba08e(0xfe)}},'right':{'style':'thick','color':{'rgb':_0x1ba08e(0xfe)}}};if(_0x31498b){const _0x42540a=_0x31498b[_0x1ba08e(0x131)](';')['reduce']((_0x5d232c,_0x48b156)=>{const _0x263a92=_0x1ba08e,[_0x52fe5c,_0x3c5d64]=_0x48b156['split'](':')[_0x263a92(0x13f)](_0x1a48a4=>_0x1a48a4[_0x263a92(0x106)]());return _0x5d232c[_0x52fe5c]=_0x3c5d64,_0x5d232c;},{});_0x42540a[_0x1ba08e(0x11b)]&&(_0x393218['top'][_0x1ba08e(0xdb)]=_0x42540a[_0x1ba08e(0x11b)]['includes'](_0x1ba08e(0x16f))?'thin':_0x1ba08e(0x12c)),_0x42540a['border-bottom']&&(_0x393218['bottom']['style']=_0x42540a['border-bottom'][_0x1ba08e(0x160)](_0x1ba08e(0x16f))?_0x1ba08e(0x16f):_0x1ba08e(0x12c)),_0x42540a[_0x1ba08e(0x187)]&&(_0x393218[_0x1ba08e(0x152)]['style']=_0x42540a[_0x1ba08e(0x187)]['includes'](_0x1ba08e(0x16f))?_0x1ba08e(0x16f):'medium'),_0x42540a[_0x1ba08e(0x186)]&&(_0x393218[_0x1ba08e(0x12e)][_0x1ba08e(0xdb)]=_0x42540a[_0x1ba08e(0x186)][_0x1ba08e(0x160)](_0x1ba08e(0x16f))?_0x1ba08e(0x16f):_0x1ba08e(0x12c));}return _0x393218;};_0x1b735f('table\x20tr')[_0x37cd9d(0x10a)]((_0x4e5b32,_0x1374b5)=>{const _0x252db7=_0x37cd9d;let _0x538ea6=[],_0x2f2ef9=0x0;while(_0x341425[_0x2f2ef9]){_0x341425[_0x2f2ef9]--,_0x2f2ef9++;}_0x1b735f(_0x1374b5)[_0x252db7(0x1c6)]('td,\x20th')['each']((_0x1385a6,_0x5573bc)=>{const _0x2c2ed0=_0x252db7;let _0x58ac33=_0x1b735f(_0x5573bc)['text']()[_0x2c2ed0(0x106)](),_0x5708b1=parseFloat(_0x58ac33['replace'](/,/g,''));isNaN(_0x5708b1)&&(_0x5708b1=_0x58ac33);let _0x3b87c1=parseInt(_0x1b735f(_0x5573bc)[_0x2c2ed0(0x1c5)](_0x2c2ed0(0x21a)))||0x1,_0x4601d7=parseInt(_0x1b735f(_0x5573bc)[_0x2c2ed0(0x1c5)](_0x2c2ed0(0xe2)))||0x1;const _0x23c3c4=_0x1b735f(_0x5573bc)[_0x2c2ed0(0x1c5)](_0x2c2ed0(0xdb)),_0x3c4626=_0x1cc971(_0x23c3c4);_0x538ea6[_0x2f2ef9]={'v':_0x5708b1,'s':{'border':_0x3c4626}};(_0x3b87c1>0x1||_0x4601d7>0x1)&&_0x3e49fe['push']({'s':{'r':_0x4e5b32,'c':_0x2f2ef9},'e':{'r':_0x4e5b32+_0x4601d7-0x1,'c':_0x2f2ef9+_0x3b87c1-0x1}});for(let _0x3ffca1=0x0;_0x3ffca1<_0x3b87c1;_0x3ffca1++){_0x4601d7>0x1&&(_0x341425[_0x2f2ef9+_0x3ffca1]=_0x4601d7-0x1);}_0x2f2ef9+=_0x3b87c1;}),_0x595415[_0x252db7(0xde)](_0x538ea6);});const _0x5ef854=XLSX[_0x37cd9d(0x22d)][_0x37cd9d(0x1e9)](),_0x528478=XLSX['utils'][_0x37cd9d(0x253)](_0x595415);_0x3e49fe[_0x37cd9d(0x25e)]>0x0&&(_0x528478['!merges']=_0x3e49fe);_0x528478['!cols']=_0x595415[0x0][_0x37cd9d(0x13f)](()=>({'wpx':0x64})),XLSX[_0x37cd9d(0x22d)][_0x37cd9d(0x1c9)](_0x5ef854,_0x528478,'Sales\x20Report');const _0x22fd6f=XLSX[_0x37cd9d(0xf0)](_0x5ef854,{'bookType':'xlsx','type':_0x37cd9d(0x248)});_0x1e1bf4['setHeader'](_0x37cd9d(0x108),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x1e1bf4['setHeader'](_0x37cd9d(0xe0),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x1e1bf4[_0x37cd9d(0x236)](_0x22fd6f);}else _0x8b9fbf+='<script>',_0x8b9fbf+='window.onload\x20=\x20function()\x20{',_0x8b9fbf+='window.print();',_0x8b9fbf+='};',_0x8b9fbf+=_0x37cd9d(0x1e3),_0x1e1bf4[_0x37cd9d(0x236)](_0x8b9fbf);}else await Reference[_0x37cd9d(0x100)]({'referenceNumber':_0x4ad8d1}),_0x51d105['flash'](_0x37cd9d(0x227),_0x37cd9d(0x1ab)),_0x1e1bf4[_0x37cd9d(0x1f4)](_0x37cd9d(0x205));})[_0x1d92f4(0x19d)](console[_0x1d92f4(0x191)]);}),router['get'](a0_0x381a3d(0x1dc),auth,async(_0xa3276b,_0x5f1c4c)=>{const _0x410e9b=a0_0x381a3d;try{const {username:_0x1bc2ad,email:_0x46384e,role:_0x36c3ac}=_0xa3276b[_0x410e9b(0x19f)],_0x558f05=_0xa3276b[_0x410e9b(0x19f)],_0x261061=await profile[_0x410e9b(0x127)]({'email':_0x558f05[_0x410e9b(0x249)]}),_0xa9a02b={'year':_0x410e9b(0x101),'month':_0x410e9b(0xd4),'day':_0x410e9b(0x101)},_0x1f28b2=await master_shop[_0x410e9b(0x1c6)]();console[_0x410e9b(0x13c)](_0x410e9b(0x22f),_0x1f28b2);const _0x34d45e=await product['find']();console[_0x410e9b(0x13c)]('Products\x20find_data',_0x34d45e);const _0x18e44b=await warehouse[_0x410e9b(0x224)]([{'$unwind':_0x410e9b(0x1ff)},{'$lookup':{'from':'products','localField':_0x410e9b(0x1c2),'foreignField':_0x410e9b(0x118),'as':'product_docs'}},{'$unwind':_0x410e9b(0xfb)},{'$project':{'product_name':_0x410e9b(0x1b1),'product_stock':_0x410e9b(0x123)}},{'$group':{'_id':_0x410e9b(0x222),'product_stock':{'$sum':'$product_stock'}}}]);console['log']('Products\x20warehouse_data',_0x18e44b),_0x18e44b[_0x410e9b(0x1d4)](_0x4b9fd5=>{const _0x363e72=_0x410e9b,_0x20ac70=_0x34d45e[_0x363e72(0x13f)](_0x1f6815=>{const _0x320bbf=_0x363e72;_0x1f6815['name']==_0x4b9fd5[_0x320bbf(0x216)]&&(_0x1f6815[_0x320bbf(0x1bf)]=parseInt(_0x1f6815[_0x320bbf(0x1bf)])+parseInt(_0x4b9fd5[_0x320bbf(0x1d8)]));});});const _0x213d68=await staff[_0x410e9b(0x1c6)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x23a485=await staff[_0x410e9b(0x127)]({'email':_0x558f05[_0x410e9b(0x249)]});if(_0x1f28b2[0x0][_0x410e9b(0x17c)]==_0x410e9b(0x235))var _0x535614=users[_0x410e9b(0x147)];else{if(_0x1f28b2[0x0]['language']==_0x410e9b(0x23f))var _0x535614=users[_0x410e9b(0x23f)];else{if(_0x1f28b2[0x0][_0x410e9b(0x17c)]==_0x410e9b(0x151))var _0x535614=users['German'];else{if(_0x1f28b2[0x0][_0x410e9b(0x17c)]==_0x410e9b(0xee))var _0x535614=users[_0x410e9b(0xee)];else{if(_0x1f28b2[0x0][_0x410e9b(0x17c)]=='French')var _0x535614=users[_0x410e9b(0x1e0)];else{if(_0x1f28b2[0x0][_0x410e9b(0x17c)]=='Portuguese\x20(BR)')var _0x535614=users[_0x410e9b(0x244)];else{if(_0x1f28b2[0x0]['language']==_0x410e9b(0x21d))var _0x535614=users[_0x410e9b(0x21d)];else{if(_0x1f28b2[0x0]['language']==_0x410e9b(0x171))var _0x535614=users[_0x410e9b(0x18b)];}}}}}}}_0x5f1c4c[_0x410e9b(0x211)](_0x410e9b(0x21c),{'success':_0xa3276b[_0x410e9b(0x1e4)](_0x410e9b(0xd2)),'errors':_0xa3276b[_0x410e9b(0x1e4)](_0x410e9b(0x227)),'alldata':_0x34d45e,'profile':_0x261061,'master_shop':_0x1f28b2,'role':_0x558f05,'product_stock':_0x18e44b,'language':_0x535614,'staff_arr':_0x23a485,'staff_data_all':_0x213d68});}catch(_0x46c17f){}}),router[a0_0x381a3d(0x18f)]('/getDSSR_no',auth,async(_0x5d4f55,_0x121b66)=>{const _0x5e5867=a0_0x381a3d;try{const {from:_0x51d43a,to:_0x5d303e,staff_data:_0x114a3e}=_0x5d4f55[_0x5e5867(0x179)],_0xf5d78b=await Reference[_0x5e5867(0x224)]([{'$match':{'date_include':{'$gte':_0x51d43a,'$lte':_0x5d303e},'staff_id':_0x114a3e}},{'$sort':{'date_include':0x1}}]);_0x121b66['json'](_0xf5d78b);}catch(_0x1b772d){_0x121b66[_0x5e5867(0x1f6)](_0x1b772d);}}),router[a0_0x381a3d(0x105)](a0_0x381a3d(0x181),auth,async(_0x7717ec,_0x31cc92)=>{const _0x2b82d5=a0_0x381a3d;try{const _0x4cf403=_0x7717ec[_0x2b82d5(0x1a4)]['id'],_0x1e9221=await Reference[_0x2b82d5(0x1ef)](_0x4cf403);let _0x1aa4f9='';_0x1aa4f9+=_0x1e9221[_0x2b82d5(0x1bb)],_0x1aa4f9+=_0x2b82d5(0x153),_0x1aa4f9+=_0x2b82d5(0x14f),_0x1aa4f9+=_0x2b82d5(0x1d7),_0x1aa4f9+='};',_0x1aa4f9+=_0x2b82d5(0x1e3),_0x31cc92[_0x2b82d5(0x236)](_0x1aa4f9);}catch(_0x511ddb){_0x31cc92[_0x2b82d5(0x1f6)](_0x511ddb);}}),router[a0_0x381a3d(0x18f)](a0_0x381a3d(0xef),auth,async(_0x38b0ad,_0x95c583)=>{const _0xee6042=a0_0x381a3d;try{const {ref_data:_0x4942e0}=_0x38b0ad[_0xee6042(0x179)],_0x6a3b08=_0x4942e0[_0xee6042(0x131)]('~'),_0x57316f=_0x6a3b08[_0xee6042(0xec)](_0x50fce6=>_0x50fce6!==''),_0xe39693=await Reference[_0xee6042(0x224)]([{'$match':{'referenceNumber':{'$in':_0x57316f}}}]),_0x45e200=XLSX[_0xee6042(0x22d)]['book_new']();_0xe39693['forEach'](_0x1d879f=>{const _0x524d2f=_0xee6042,_0x4b3aff=cheerio['load'](_0x1d879f[_0x524d2f(0x1bb)]);let _0x3006ad=[],_0x41774c=[],_0x2775db=[];_0x4b3aff(_0x524d2f(0x137))[_0x524d2f(0x10a)]((_0x3160dd,_0x294fb1)=>{let _0x4e2424=[],_0xc717c6=0x0;while(_0x2775db[_0xc717c6]){_0x2775db[_0xc717c6]--,_0xc717c6++;}_0x4b3aff(_0x294fb1)['find']('td,\x20th')['each']((_0x156685,_0x4967ea)=>{const _0x9fc269=a0_0x5084;let _0xd69acf=_0x4b3aff(_0x4967ea)[_0x9fc269(0x130)]()[_0x9fc269(0x106)](),_0x5b00ba=parseFloat(_0xd69acf[_0x9fc269(0x196)](/,/g,''));isNaN(_0x5b00ba)&&(_0x5b00ba=_0xd69acf);let _0x55c886=parseInt(_0x4b3aff(_0x4967ea)[_0x9fc269(0x1c5)](_0x9fc269(0x21a)))||0x1,_0x162c51=parseInt(_0x4b3aff(_0x4967ea)[_0x9fc269(0x1c5)](_0x9fc269(0xe2)))||0x1;_0x4e2424[_0xc717c6]=_0x5b00ba;(_0x55c886>0x1||_0x162c51>0x1)&&_0x41774c[_0x9fc269(0xde)]({'s':{'r':_0x3160dd,'c':_0xc717c6},'e':{'r':_0x3160dd+_0x162c51-0x1,'c':_0xc717c6+_0x55c886-0x1}});for(let _0x1b687c=0x0;_0x1b687c<_0x55c886;_0x1b687c++){_0x162c51>0x1&&(_0x2775db[_0xc717c6+_0x1b687c]=_0x162c51-0x1);}_0xc717c6+=_0x55c886;}),_0x3006ad['push'](_0x4e2424);});const _0x16b93d=XLSX['utils'][_0x524d2f(0x253)](_0x3006ad);_0x41774c[_0x524d2f(0x25e)]>0x0&&(_0x16b93d[_0x524d2f(0xdc)]=_0x41774c),_0x16b93d[_0x524d2f(0x146)]=_0x3006ad[0x0][_0x524d2f(0x13f)](()=>({'wpx':0x64})),XLSX[_0x524d2f(0x22d)]['book_append_sheet'](_0x45e200,_0x16b93d,_0x1d879f[_0x524d2f(0xe8)]);});const _0x348d5e=XLSX[_0xee6042(0xf0)](_0x45e200,{'bookType':'xlsx','type':_0xee6042(0x248)});_0x95c583[_0xee6042(0x178)](_0xee6042(0x108),_0xee6042(0x258)),_0x95c583[_0xee6042(0x178)](_0xee6042(0xe0),_0xee6042(0x122)),_0x95c583[_0xee6042(0x236)](_0x348d5e);}catch(_0xff883d){_0x95c583['json'](_0xff883d);}}),router[a0_0x381a3d(0x18f)](a0_0x381a3d(0x238),auth,async(_0x25d33a,_0x18d0aa)=>{const _0x1f04e2=a0_0x381a3d,{from_date:_0x15af7a,agent_id:_0x1d5d78}=_0x25d33a[_0x1f04e2(0x179)],_0x43b8fc=_0x25d33a[_0x1f04e2(0x19f)],_0x4c2a40=await staff['findOne']({'email':_0x43b8fc['email']}),_0x5789ee=await master_shop['find'](),_0x364aa2=await agentsdataDSICheck_DSRR(_0x15af7a,_0x1d5d78,_0xe0b452);let _0x530447=_0x1f04e2(0x1d2);var _0x1a0216=new Date(_0x15af7a);const _0x54abc0={'year':_0x1f04e2(0x101),'month':_0x1f04e2(0xd4),'day':_0x1f04e2(0x101)},_0x276a2d=new Intl[(_0x1f04e2(0x157))](_0x1f04e2(0x246),_0x54abc0)[_0x1f04e2(0x12f)](_0x1a0216);_0x530447+=_0x1f04e2(0x104),_0x530447+='<div\x20\x20id=\x22table-conatainer\x22>',_0x530447+=_0x1f04e2(0x1b5),_0x530447+=_0x364aa2,_0x530447+=_0x1f04e2(0x10b),_0x530447+='</div>',_0x530447+=_0x1f04e2(0x138);let _0x2e7ca7=_0x1f04e2(0x13d);const _0x629117={'width':'15in','height':_0x1f04e2(0x1d6),'orientation':_0x1f04e2(0x117),'border':{'top':_0x1f04e2(0x10e),'right':_0x1f04e2(0x10e),'bottom':_0x1f04e2(0x10e),'left':_0x1f04e2(0x10e)},'header':{'height':_0x1f04e2(0x173),'contents':_0x1f04e2(0xd7)+_0x2e7ca7+_0x1f04e2(0x1e8)+_0x276a2d+_0x1f04e2(0x16e)},'footer':{'height':_0x1f04e2(0x1da),'contents':{'default':_0x1f04e2(0xe5)}},'dpi':0x5,'zoomFactor':'1'};var _0xe0b452='on';if(_0xe0b452=='on'){const _0x21a29f=cheerio[_0x1f04e2(0x24e)](_0x530447);let _0xf68f5e=[],_0x3e5265=[],_0x4f9beb=[];_0x21a29f(_0x1f04e2(0x137))['each']((_0x397ea5,_0x414d08)=>{const _0x42ad29=_0x1f04e2;let _0x27c100=[],_0x2d93aa=0x0;while(_0x4f9beb[_0x2d93aa]){_0x4f9beb[_0x2d93aa]--,_0x2d93aa++;}_0x21a29f(_0x414d08)[_0x42ad29(0x1c6)](_0x42ad29(0xf7))[_0x42ad29(0x10a)]((_0x8c93b6,_0x5f3cd0)=>{const _0x19d2a1=_0x42ad29;let _0x3c0771=_0x21a29f(_0x5f3cd0)['text']()[_0x19d2a1(0x106)](),_0x5cb441=parseFloat(_0x3c0771[_0x19d2a1(0x196)](/,/g,''));isNaN(_0x5cb441)&&(_0x5cb441=_0x3c0771);let _0x127b21=parseInt(_0x21a29f(_0x5f3cd0)[_0x19d2a1(0x1c5)](_0x19d2a1(0x21a)))||0x1,_0x968bdc=parseInt(_0x21a29f(_0x5f3cd0)[_0x19d2a1(0x1c5)](_0x19d2a1(0xe2)))||0x1;_0x27c100[_0x2d93aa]=_0x5cb441;(_0x127b21>0x1||_0x968bdc>0x1)&&_0x3e5265[_0x19d2a1(0xde)]({'s':{'r':_0x397ea5,'c':_0x2d93aa},'e':{'r':_0x397ea5+_0x968bdc-0x1,'c':_0x2d93aa+_0x127b21-0x1}});for(let _0xbf8d5=0x0;_0xbf8d5<_0x127b21;_0xbf8d5++){_0x968bdc>0x1&&(_0x4f9beb[_0x2d93aa+_0xbf8d5]=_0x968bdc-0x1);}_0x2d93aa+=_0x127b21;}),_0xf68f5e['push'](_0x27c100);});const _0x4103b7=XLSX[_0x1f04e2(0x22d)][_0x1f04e2(0x1e9)](),_0xb473d9=XLSX[_0x1f04e2(0x22d)][_0x1f04e2(0x253)](_0xf68f5e);_0x3e5265['length']>0x0&&(_0xb473d9['!merges']=_0x3e5265);_0xb473d9[_0x1f04e2(0x146)]=_0xf68f5e[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x1f04e2(0x22d)]['book_append_sheet'](_0x4103b7,_0xb473d9,_0x1f04e2(0x240));const _0x69397a=XLSX[_0x1f04e2(0xf0)](_0x4103b7,{'bookType':_0x1f04e2(0x121),'type':'buffer'});_0x18d0aa[_0x1f04e2(0x178)](_0x1f04e2(0x108),_0x1f04e2(0x24c)),_0x18d0aa['setHeader'](_0x1f04e2(0xe0),_0x1f04e2(0x122)),_0x18d0aa[_0x1f04e2(0x236)](_0x69397a);}else pdf['create'](_0x530447,_0x629117)[_0x1f04e2(0xe3)](function(_0xe52e09,_0x2ecbbd){const _0x5afa3b=_0x1f04e2;if(_0xe52e09){_0x18d0aa[_0x5afa3b(0x1f8)](0x1f4)[_0x5afa3b(0x236)](_0x5afa3b(0x154));return;}_0x18d0aa[_0x5afa3b(0x178)]('Content-Type',_0x5afa3b(0x251)),_0x2ecbbd['pipe'](_0x18d0aa);});}),module[a0_0x381a3d(0x252)]=router;