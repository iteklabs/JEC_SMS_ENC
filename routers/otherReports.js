const a0_0x4e65fc=a0_0x1edd;function a0_0x42de(){const _0x3ea36f=['thin','<div\x20class=\x22col-sm-11\x22>','length','ObjectId','findById','products','8.5in','sale_product.product_code','getFullYear','top','bank','note','thick','<td\x20colspan=\x22','$product_name','border-bottom','dataqty','Household','$sale_product.product_code','cheerio','$product_details.product_stock','<td\x20class=\x22row_data\x22>','Sales\x20Report','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','table\x20tr','NumberFormat','sort','$product_info.category','en-US','Content-Disposition','</td>','<div\x20style=\x22page-break-before:\x20always;\x22></div>','exceljs','pipe','dsi_sales','$product_info.name','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','stock','utils','aggregate','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','get','window.print();','qty','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','express','<div\x20class=\x22row\x22>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','$product_info.product_code','balanced','$sale_product.product_name','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','border-top','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','$product_list.product_code','style','left','filter','split','Arabic\x20(ae)','inventory_sum','html-pdf','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','$status_data','aoa_to_sheet','product_code','$product_details','dsi','<p>INVENTORY\x20SUMMARY</p>','product_details','</p>','status','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','excel','$totalQty','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','/dev/null','1290aXpvOJ','totalQty','PDF\x20Generation\x20Error:','$product_stock','$product.quantity','discount','buffer','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','find','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','60mm','$totalGross','\x22><b>','/agent_reports/pdf','$sales_info','landscape','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','<th\x20rowspan=\x272\x27>Category</th>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','isFG','language','!merges','totalPrice','$product_list','$dsi','right','findOne','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','book_append_sheet','due_date','xlsx','$product_info.brand','../public/language/languages.json','slice','beg_bal','/dl_excel','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>','errors','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$_id.date','<thead>','<th>X-Truck</th>','$products.product_details.category','<table>','Products\x20find_data','5384700nZsKNB','$check_no','rowspan','$products','Letter','$_id.status_data','886440PuEdoX','9QWDDYi','</tbody>','DateTimeFormat','/dsrr_admin/pdf_admin','2410KZzGRk','Error\x20generating\x20PDF','$cash','Standard','$products.product_details.gross_price','<td\x20class=\x22cat_data\x22>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','replace','multer','sales_man_code','$product_list.product_name','<th>\x20BEG\x20BALANCE\x20</th>','English\x20(US)','<th>\x20QTY\x20SOLD\x20</th>','<div\x20\x20id=\x22table-conatainer\x22>','html','window.onload\x20=\x20function()\x20{','<th>\x20ITEM\x20DESCRIPTION\x20</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','customer','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','agent_sales','</table>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','blob-stream','path','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','$customer','/agent_reports/pdf_admin','sales_ext','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','<td\x20class=\x22row_data\x22><b>','Arabic','$product_info','brand','<td\x20class=\x22cat_data\x22></td>','/dsrr/pdf','$sale_product._id','$products.NetPrice','dssr_view_admin','$NetPrice','td,\x20th','product_docs','$product_code','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','$sales_info.name','$amount','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','application/pdf','$product_details.product_name','$products.adj_discount','sales_bkg','$product_info.gross_price','</b></td>','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','colspan','error','product_details.product_name','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','cat_brand','$date','Spanish','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','each','<th>\x20INCOMING\x20</th>','$product.product_name','$brand','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','$adj_discount','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','push','$sale_product.quantity','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','toFixed','<td\x20colspan=\x223\x22><b>TOTAL<b>','brandCount','getMonth','Products\x20master','prod_cat','sales_info','French','../middleware/auth','forEach','product_stock','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>','English','$products.product_details.brand','!cols','name','toISOString','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','\x22><b></b></td>','user','deleteOne','</th>','date_include','write','$sale_product.discount','/dsrr_admin/view','sales_reports','<th>\x20ENDING\x20BALANCE\x20</th>','<tbody>','sales_staff_id','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','cash','success','/inventory_sum/pdf','$_id.dsi','966OZWJtw','Portuguese\x20(BR)','exports','create','border-left','$bank','</tr>','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','</div>','\x20-\x20','$_id.customer','15in','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','medium','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','_id','redirect','20mm','includes','sumqty','$sale_product','10780VvkUDa','$sale_product.totalprice','<tr>','Content-Type','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$sales_info._id','\x20-\x20STD','$sale_product.prod_cat','email','2394010lUdlsE','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','bottom','$product_list.product_stock','<th\x20colspan=\x272\x27>SOLD</th>','toLocaleString','4ICAerk','getDate','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','valueOf','render','$_id.brand','amount','setHeader','<th\x20rowspan=\x272\x27>Products</th>','<p>','$products.product_details.prod_id','body','category','totalQTY','$products.discount','staffs','map','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','salesman_data','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','</thead>','referenceNumber','German','<h1>JAKA\x20EQUITIES\x20CORP</h1>','Router','NetPrice','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','$category','totalGross','/agent_reports/sales_ad','format','$discount','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20','reduce','0.1in','adj_discount','attachment;\x20filename=\x22sales_report.xlsx\x22','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','000000','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','$sale_product.real_qty_unit_val','/getDSSR_no','load','trim','attr','$sale_product.adj_discount','$products.qty','<th>Booking</th>','text','json','true','No\x20data\x20was\x20Found!','test','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','$products.product_details','date','toLocaleDateString','toStream','<th\x20rowspan=\x272\x27>Production</th>','<script>','border-right','Hindi','../models/all_models','$sale_product.isFG','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','Products\x20warehouse_data','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','Portuguese','\x22\x20class=\x22cat_data\x22>','/reports/dsrr/view','post','$product_docs','$_id.category','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','book_new','Chinese','Types','Asia/Manila','$name','catch','product_info','<td\x20class=\x22row_data\x22>0</td>','$sales_staff_id','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','false','56pEcoSM','/total_sales_reports/view','<td\x20class=\x22row_data\x22></td>','599542krUgkG','log','pdfkit-table','send','jsbarcode','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','$due_date','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','attachment;\x20filename=\x22reports.xlsx\x22','isArray','numeric','/balance/view','product_name','/balance/pdf','<p>FINISHED\x20GOODS\x20INVENTORY</p>','check_no','42132gIvomn','long','flash','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>'];a0_0x42de=function(){return _0x3ea36f;};return a0_0x42de();}(function(_0x25c7fd,_0x5b0003){const _0x535c68=a0_0x1edd,_0x3b63d1=_0x25c7fd();while(!![]){try{const _0x2b376f=parseInt(_0x535c68(0x10d))/0x1+-parseInt(_0x535c68(0x1ab))/0x2*(-parseInt(_0x535c68(0x8d))/0x3)+parseInt(_0x535c68(0xb3))/0x4*(-parseInt(_0x535c68(0xad))/0x5)+parseInt(_0x535c68(0x11e))/0x6*(parseInt(_0x535c68(0x10a))/0x7)+-parseInt(_0x535c68(0x1a6))/0x8*(-parseInt(_0x535c68(0x1a7))/0x9)+-parseInt(_0x535c68(0x171))/0xa*(-parseInt(_0x535c68(0xa4))/0xb)+-parseInt(_0x535c68(0x1a0))/0xc;if(_0x2b376f===_0x5b0003)break;else _0x3b63d1['push'](_0x3b63d1['shift']());}catch(_0x3cf313){_0x3b63d1['push'](_0x3b63d1['shift']());}}}(a0_0x42de,0x56492));const express=require(a0_0x4e65fc(0x150)),res=require('express/lib/response'),app=express(),router=express[a0_0x4e65fc(0xcb)](),multer=require(a0_0x4e65fc(0x1b3)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x4e65fc(0xf2)),auth=require(a0_0x4e65fc(0x1fe)),users=require(a0_0x4e65fc(0x192)),excelJS=require(a0_0x4e65fc(0x142)),XLSX=require(a0_0x4e65fc(0x190)),PDFDocument=require(a0_0x4e65fc(0x10f)),fs=require('fs'),blobStream=require(a0_0x4e65fc(0x1c3)),JsBarcode=require(a0_0x4e65fc(0x111)),{Canvas}=require('canvas'),pdf=require(a0_0x4e65fc(0x160)),path=require(a0_0x4e65fc(0x1c4)),mongoose=require('mongoose'),cheerio=require(a0_0x4e65fc(0x135));router[a0_0x4e65fc(0x14c)](a0_0x4e65fc(0x119),auth,async(_0x7197ea,_0x108903)=>{const _0x47a305=a0_0x4e65fc;try{const {username:_0x494d37,email:_0x667656,role:_0x2ea04d}=_0x7197ea[_0x47a305(0x209)],_0x2085d7=_0x7197ea[_0x47a305(0x209)],_0x2d6d99=await profile[_0x47a305(0x18c)]({'email':_0x2085d7['email']}),_0x1af99f={'year':_0x47a305(0x118),'month':_0x47a305(0x11f),'day':_0x47a305(0x118)},_0x16068a=await master_shop[_0x47a305(0x179)]();console['log'](_0x47a305(0x1fa),_0x16068a);const _0x11ab10=await product['find']();console[_0x47a305(0x10e)](_0x47a305(0x19f),_0x11ab10);const _0xb1efcf=await warehouse[_0x47a305(0x14a)]([{'$unwind':_0x47a305(0x166)},{'$lookup':{'from':_0x47a305(0x127),'localField':_0x47a305(0x1e4),'foreignField':'name','as':_0x47a305(0x1d5)}},{'$unwind':_0x47a305(0xfc)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x47a305(0x136)}},{'$group':{'_id':_0x47a305(0x130),'product_stock':{'$sum':_0x47a305(0x174)}}}]);console[_0x47a305(0x10e)]('Products\x20warehouse_data',_0xb1efcf),_0xb1efcf[_0x47a305(0x1ff)](_0x1dbd62=>{const _0x5c8cfa=_0x47a305,_0x3a2334=_0x11ab10[_0x5c8cfa(0xc3)](_0x13fe72=>{const _0x1925e2=_0x5c8cfa;_0x13fe72[_0x1925e2(0x205)]==_0x1dbd62[_0x1925e2(0x9e)]&&(_0x13fe72['stock']=parseInt(_0x13fe72[_0x1925e2(0x148)])+parseInt(_0x1dbd62[_0x1925e2(0x200)]));});}),console['log'](_0x47a305(0x19f),_0x11ab10);if(_0x16068a[0x0][_0x47a305(0x186)]=='English\x20(US)')var _0x5c0dd1=users[_0x47a305(0x202)];else{if(_0x16068a[0x0][_0x47a305(0x186)]==_0x47a305(0xf1))var _0x5c0dd1=users[_0x47a305(0xf1)];else{if(_0x16068a[0x0][_0x47a305(0x186)]==_0x47a305(0xc9))var _0x5c0dd1=users[_0x47a305(0xc9)];else{if(_0x16068a[0x0]['language']==_0x47a305(0x1e8))var _0x5c0dd1=users['Spanish'];else{if(_0x16068a[0x0][_0x47a305(0x186)]==_0x47a305(0x1fd))var _0x5c0dd1=users['French'];else{if(_0x16068a[0x0][_0x47a305(0x186)]==_0x47a305(0x8e))var _0x5c0dd1=users[_0x47a305(0xf8)];else{if(_0x16068a[0x0][_0x47a305(0x186)]==_0x47a305(0x100))var _0x5c0dd1=users['Chinese'];else{if(_0x16068a[0x0][_0x47a305(0x186)]==_0x47a305(0x15e))var _0x5c0dd1=users[_0x47a305(0x1cb)];}}}}}}}_0x108903['render'](_0x47a305(0x154),{'success':_0x7197ea[_0x47a305(0x120)](_0x47a305(0x8a)),'errors':_0x7197ea[_0x47a305(0x120)](_0x47a305(0x197)),'alldata':_0x11ab10,'profile':_0x2d6d99,'master_shop':_0x16068a,'role':_0x2085d7,'product_stock':_0xb1efcf,'language':_0x5c0dd1});}catch(_0x52a76b){}});async function dataCheck(_0x2293a3,_0x1d97c1){const _0x1602c3=a0_0x4e65fc,_0x218ab9=await product[_0x1602c3(0x14a)]([{'$group':{'_id':{'brand':_0x1602c3(0x1ee),'category':'$category'},'products':{'$push':{'name':_0x1602c3(0x103),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2735cd=[];_0x2735cd[_0x1602c3(0x1e6)]=[];for(let _0x45702a=0x0;_0x45702a<=_0x218ab9[_0x1602c3(0x124)]-0x1;_0x45702a++){const _0x446223=_0x218ab9[_0x45702a];_0x2735cd[_0x1602c3(0x1e6)]['push'](_0x446223);}const _0x461eb1=await product[_0x1602c3(0x14a)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x1602c3(0x1ee),'product_code':_0x1602c3(0x1d6),'product_name':_0x1602c3(0x103)}}}},{'$sort':{'_id.category':-0x1}}]),_0x453f87=await purchases_finished[_0x1602c3(0x14a)]([{'$match':{'date':{'$gte':_0x2293a3,'$lte':_0x1d97c1}}},{'$unwind':'$product'},{'$group':{'_id':{'product_name':_0x1602c3(0x1ed),'product_code':'$product.product_code'},'totalQTY':{'$sum':_0x1602c3(0x175)}}}]);_0x2735cd[_0x1602c3(0x194)]=[];for(let _0x2b994f=0x0;_0x2b994f<=_0x453f87[_0x1602c3(0x124)]-0x1;_0x2b994f++){const _0x514462=_0x453f87[_0x2b994f];_0x2735cd[_0x1602c3(0x194)][_0x1602c3(0x1f2)](_0x514462);}const _0x38f5e2=await sales_sa[_0x1602c3(0x14a)]([{'$match':{'date':{'$gte':_0x2293a3,'$lte':_0x1d97c1}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x1602c3(0x107)}}},{'$lookup':{'from':_0x1602c3(0xc2),'localField':_0x1602c3(0x213),'foreignField':_0x1602c3(0x9e),'as':_0x1602c3(0x1fc)}},{'$unwind':_0x1602c3(0x17f)},{'$unwind':_0x1602c3(0xa3)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x1602c3(0x155),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':'$sale_product.quantity'}}}]);console['log'](_0x38f5e2[0x0]),_0x2735cd[_0x1602c3(0x1de)]=[];for(let _0x4d2e58=0x0;_0x4d2e58<=_0x38f5e2['length']-0x1;_0x4d2e58++){const _0x1be9ad=_0x38f5e2[_0x4d2e58];_0x2735cd[_0x1602c3(0x1de)][_0x1602c3(0x1f2)](_0x1be9ad);}const _0x2a0943=await sales_sa[_0x1602c3(0x14a)]([{'$match':{'date':{'$gte':_0x2293a3,'$lte':_0x1d97c1}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x1602c3(0x107)}}},{'$lookup':{'from':_0x1602c3(0xc2),'localField':_0x1602c3(0x213),'foreignField':_0x1602c3(0x9e),'as':_0x1602c3(0x1fc)}},{'$unwind':_0x1602c3(0x17f)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x1602c3(0x109)}},{'$group':{'_id':{'product_name':_0x1602c3(0x155),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x1602c3(0xdb)}}}]);_0x2735cd[_0x1602c3(0x1c8)]=[];for(let _0x37f530=0x0;_0x37f530<=_0x2a0943['length']-0x1;_0x37f530++){const _0x55e330=_0x2a0943[_0x37f530];_0x2735cd[_0x1602c3(0x1c8)]['push'](_0x55e330);}let _0x16438f='';for(let _0x578da0=0x0;_0x578da0<=_0x461eb1[_0x1602c3(0x124)]-0x1;_0x578da0++){const _0x5b000d=_0x461eb1[_0x578da0];_0x16438f+=_0x1602c3(0xa6),_0x16438f+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0x5b000d[_0x1602c3(0x9e)][_0x1602c3(0xbf)]+_0x1602c3(0x140),_0x16438f+=_0x1602c3(0x93);for(let _0x58f053=0x0;_0x58f053<_0x2735cd[_0x1602c3(0x1e6)][_0x1602c3(0x124)];_0x58f053++){const _0x203e52=_0x2735cd[_0x1602c3(0x1e6)][_0x58f053];if(_0x203e52[_0x1602c3(0x9e)][_0x1602c3(0xbf)]==_0x5b000d[_0x1602c3(0x9e)][_0x1602c3(0xbf)]){let _0x23ac4e=[],_0x1dd017=[],_0x457092=[];_0x23ac4e[_0x203e52[_0x1602c3(0x9e)]['brand']]=[],_0x1dd017[_0x203e52[_0x1602c3(0x9e)][_0x1602c3(0x1cd)]]=[],_0x457092[_0x203e52['_id'][_0x1602c3(0x1cd)]]=[];var _0x2f9e5c=0x0,_0x44fe8c=0x0,_0x4833bc=0x0;for(let _0x5e459c=0x0;_0x5e459c<_0x203e52[_0x1602c3(0x127)]['length'];_0x5e459c++){const _0x395b38=_0x203e52[_0x1602c3(0x127)][_0x5e459c];for(let _0x1232ee=0x0;_0x1232ee<=_0x2735cd[_0x1602c3(0x194)][_0x1602c3(0x124)]-0x1;_0x1232ee++){const _0xacd1=_0x2735cd['beg_bal'][_0x1232ee];_0xacd1[_0x1602c3(0x9e)][_0x1602c3(0x11a)]==_0x395b38[_0x1602c3(0x205)]&&_0xacd1['_id'][_0x1602c3(0x165)]==_0x395b38[_0x1602c3(0x165)]&&(_0x2f9e5c+=parseInt(_0xacd1[_0x1602c3(0xc0)],0xa));}for(let _0x2c8cc3=0x0;_0x2c8cc3<=_0x2735cd[_0x1602c3(0x1c8)][_0x1602c3(0x124)]-0x1;_0x2c8cc3++){const _0x34fbe2=_0x2735cd[_0x1602c3(0x1c8)][_0x2c8cc3];_0x34fbe2[_0x1602c3(0x9e)][_0x1602c3(0x11a)]==_0x395b38[_0x1602c3(0x205)]&&_0x34fbe2['_id'][_0x1602c3(0x165)]==_0x395b38[_0x1602c3(0x165)]&&(_0x44fe8c+=parseFloat(_0x34fbe2[_0x1602c3(0xc0)],0xa)[_0x1602c3(0x1f6)](0x2));}for(let _0x12fa66=0x0;_0x12fa66<=_0x2735cd[_0x1602c3(0x1de)][_0x1602c3(0x124)]-0x1;_0x12fa66++){const _0x1a5eb7=_0x2735cd[_0x1602c3(0x1de)][_0x12fa66];_0x1a5eb7[_0x1602c3(0x9e)][_0x1602c3(0x11a)]==_0x395b38[_0x1602c3(0x205)]&&_0x1a5eb7[_0x1602c3(0x9e)][_0x1602c3(0x165)]==_0x395b38[_0x1602c3(0x165)]&&(_0x4833bc+=parseInt(_0x1a5eb7[_0x1602c3(0xc0)],0xa));}}const _0x5a137a=new Intl[(_0x1602c3(0x13b))](_0x1602c3(0x13e));var _0x446758=_0x5a137a[_0x1602c3(0xd1)](_0x2f9e5c);_0x23ac4e[_0x203e52[_0x1602c3(0x9e)][_0x1602c3(0x1cd)]][_0x1602c3(0x1f2)](_0x446758),_0x1dd017[_0x203e52[_0x1602c3(0x9e)][_0x1602c3(0x1cd)]]['push'](_0x5a137a[_0x1602c3(0xd1)](_0x44fe8c)),_0x457092[_0x203e52['_id']['brand']][_0x1602c3(0x1f2)](_0x5a137a['format'](_0x4833bc));var _0x2a70ba=_0x5a137a[_0x1602c3(0xd1)](_0x2f9e5c-(_0x4833bc+_0x44fe8c));_0x16438f+='<tr>',_0x16438f+=_0x1602c3(0x10c),_0x16438f+=_0x1602c3(0x137)+_0x203e52[_0x1602c3(0x9e)]['brand']+_0x1602c3(0x140),_0x16438f+=_0x1602c3(0x137)+_0x23ac4e[_0x203e52[_0x1602c3(0x9e)][_0x1602c3(0x1cd)]][0x0]+'</td>',_0x16438f+=_0x1602c3(0x106),_0x16438f+=_0x1602c3(0x137)+_0x457092[_0x203e52[_0x1602c3(0x9e)]['brand']][0x0]+_0x1602c3(0x140),_0x16438f+=_0x1602c3(0x137)+_0x1dd017[_0x203e52[_0x1602c3(0x9e)][_0x1602c3(0x1cd)]][0x0]+_0x1602c3(0x140),_0x16438f+=_0x1602c3(0x137)+_0x2a70ba+_0x1602c3(0x140),_0x16438f+='</tr>';}}}return console[_0x1602c3(0x10e)](_0x2735cd['sales_bkg']),_0x16438f;}router['post'](a0_0x4e65fc(0x11b),auth,async(_0x4393c6,_0xfb9aa)=>{const _0x4714be=a0_0x4e65fc,{from_date:_0x44d724,to_date:_0x2103ac}=_0x4393c6['body'],_0x467d5e=await dataCheck(_0x44d724,_0x2103ac);{}let _0x46f60d=_0x4714be(0x1da);var _0x1b3251=new Date(_0x44d724),_0xf2ff5c=new Date(_0x2103ac);const _0x23608f={'year':_0x4714be(0x118),'month':'long','day':_0x4714be(0x118)},_0x5ab2ff=new Intl[(_0x4714be(0x1a9))](_0x4714be(0x13e),_0x23608f)[_0x4714be(0xd1)](_0x1b3251),_0x3e1544=new Intl['DateTimeFormat']('en-US',_0x23608f)[_0x4714be(0xd1)](_0xf2ff5c);_0x46f60d+=_0x4714be(0xca),_0x46f60d+=_0x4714be(0x11c),_0x46f60d+='<p>'+_0x5ab2ff+_0x4714be(0x97)+_0x3e1544+_0x4714be(0x16a),_0x46f60d+=_0x4714be(0x151),_0x46f60d+='<div\x20class=\x22col-sm-11\x22>',_0x46f60d+=_0x4714be(0x19e),_0x46f60d+=_0x4714be(0xa6),_0x46f60d+=_0x4714be(0x182),_0x46f60d+=_0x4714be(0xbb),_0x46f60d+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x5ab2ff+_0x4714be(0x20b),_0x46f60d+=_0x4714be(0xee),_0x46f60d+=_0x4714be(0xb1),_0x46f60d+='<th\x20rowspan=\x272\x27>Ending\x20Balance<br>'+_0x3e1544+'</th>',_0x46f60d+=_0x4714be(0x93),_0x46f60d+=_0x4714be(0xa6),_0x46f60d+=_0x4714be(0xe2),_0x46f60d+=_0x4714be(0x19c),_0x46f60d+=_0x4714be(0x93),_0x46f60d+=_0x467d5e,_0x46f60d+=_0x4714be(0x1c1),_0x46f60d+='</div>',_0x46f60d+=_0x4714be(0x96);const _0x2fe138={'format':_0x4714be(0x1a4),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};pdf[_0x4714be(0x90)](_0x46f60d,_0x2fe138)[_0x4714be(0xed)](function(_0x53c345,_0x22b78d){const _0x201afa=_0x4714be;if(_0x53c345){_0xfb9aa['status'](0x1f4)[_0x201afa(0x110)](_0x201afa(0x1ac));return;}_0xfb9aa[_0x201afa(0xba)]('Content-Type',_0x201afa(0x1db)),_0x22b78d['pipe'](_0xfb9aa);});}),router[a0_0x4e65fc(0x14c)]('/agent/view',auth,async(_0x37b759,_0xffc05f)=>{const _0x2fb915=a0_0x4e65fc;try{const {username:_0x1d7511,email:_0x4e5b70,role:_0x13522f}=_0x37b759['user'],_0x50a4d4=_0x37b759['user'],_0x224ca2=await profile[_0x2fb915(0x18c)]({'email':_0x50a4d4[_0x2fb915(0xac)]}),_0x31785d={'year':_0x2fb915(0x118),'month':_0x2fb915(0x11f),'day':_0x2fb915(0x118)},_0x1357c3=await master_shop['find'](),_0x2f30d0=await product['find'](),_0x2af38e=await warehouse[_0x2fb915(0x14a)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x2fb915(0x127),'localField':_0x2fb915(0x1e4),'foreignField':'name','as':_0x2fb915(0x1d5)}},{'$unwind':_0x2fb915(0xfc)},{'$project':{'product_name':_0x2fb915(0x1dc),'product_stock':_0x2fb915(0x136)}},{'$group':{'_id':_0x2fb915(0x130),'product_stock':{'$sum':_0x2fb915(0x174)}}}]);if(_0x1357c3[0x0]['language']==_0x2fb915(0x1b7))var _0x319c8c=users[_0x2fb915(0x202)];else{if(_0x1357c3[0x0][_0x2fb915(0x186)]=='Hindi')var _0x319c8c=users[_0x2fb915(0xf1)];else{if(_0x1357c3[0x0]['language']==_0x2fb915(0xc9))var _0x319c8c=users[_0x2fb915(0xc9)];else{if(_0x1357c3[0x0][_0x2fb915(0x186)]==_0x2fb915(0x1e8))var _0x319c8c=users['Spanish'];else{if(_0x1357c3[0x0]['language']==_0x2fb915(0x1fd))var _0x319c8c=users['French'];else{if(_0x1357c3[0x0][_0x2fb915(0x186)]=='Portuguese\x20(BR)')var _0x319c8c=users[_0x2fb915(0xf8)];else{if(_0x1357c3[0x0]['language']==_0x2fb915(0x100))var _0x319c8c=users[_0x2fb915(0x100)];else{if(_0x1357c3[0x0][_0x2fb915(0x186)]==_0x2fb915(0x15e))var _0x319c8c=users['Arabic'];}}}}}}}_0xffc05f[_0x2fb915(0xb7)](_0x2fb915(0x1c0),{'success':_0x37b759[_0x2fb915(0x120)](_0x2fb915(0x8a)),'errors':_0x37b759['flash'](_0x2fb915(0x197)),'alldata':_0x2f30d0,'profile':_0x224ca2,'master_shop':_0x1357c3,'role':_0x50a4d4,'product_stock':_0x2af38e,'language':_0x319c8c});}catch(_0x2478f8){}});async function agentsdataCheck(_0x28036c,_0xadc3ed){const _0x55239c=a0_0x4e65fc,_0x49e9d1=await product[_0x55239c(0x14a)]([{'$group':{'_id':{'brand':_0x55239c(0x1ee),'category':_0x55239c(0xce)},'products':{'$push':{'name':_0x55239c(0x103),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x15d7fb=[];_0x15d7fb[_0x55239c(0x1e6)]=[];for(let _0xd47a48=0x0;_0xd47a48<=_0x49e9d1[_0x55239c(0x124)]-0x1;_0xd47a48++){const _0x3ef2b0=_0x49e9d1[_0xd47a48];_0x15d7fb[_0x55239c(0x1e6)][_0x55239c(0x1f2)](_0x3ef2b0);}const _0x38370f=await product['aggregate']([{'$group':{'_id':{'category':_0x55239c(0xce)},'products':{'$push':{'brand':_0x55239c(0x1ee),'product_code':_0x55239c(0x1d6),'product_name':_0x55239c(0x103)}}}},{'$sort':{'_id.category':-0x1}}]),_0x58f53d=await product[_0x55239c(0x14a)]([{'$group':{'_id':{'category':_0x55239c(0xce),'brand':_0x55239c(0x1ee)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x262ff1=await sales_sa[_0x55239c(0x14a)]([{'$match':{'date':{'$gte':_0x28036c,'$lte':_0xadc3ed}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x55239c(0x107)}}},{'$lookup':{'from':_0x55239c(0xc2),'localField':'sales_staff_id','foreignField':_0x55239c(0x9e),'as':_0x55239c(0x1fc)}},{'$unwind':_0x55239c(0x17f)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x55239c(0x109)}},{'$lookup':{'from':_0x55239c(0x127),'localField':_0x55239c(0x129),'foreignField':_0x55239c(0x165),'as':_0x55239c(0x105)}},{'$unwind':'$product_info'},{'$group':{'_id':{'sales_id':_0x55239c(0xa9),'category':_0x55239c(0x13d),'brand':_0x55239c(0x191)},'salesman_data':{'$first':_0x55239c(0x1d8)},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','product_details':{'prod_name':_0x55239c(0x145),'product_code':_0x55239c(0x153),'category':_0x55239c(0x13d),'brand':_0x55239c(0x191)}}}}}]);let _0x402919='';_0x402919+=_0x55239c(0xa6),_0x402919+=_0x55239c(0x94),_0x402919+=_0x55239c(0x93),_0x402919+=_0x55239c(0xa6),_0x402919+=_0x55239c(0x1ce);for(let _0x56cf40=0x0;_0x56cf40<=_0x38370f[_0x55239c(0x124)]-0x1;_0x56cf40++){const _0x16c390=_0x38370f[_0x56cf40];for(let _0x561cd6=0x0;_0x561cd6<_0x58f53d[_0x55239c(0x124)];_0x561cd6++){const _0xa076c7=_0x58f53d[_0x561cd6];_0xa076c7['_id']==_0x16c390[_0x55239c(0x9e)][_0x55239c(0xbf)]&&(_0x402919+=_0x55239c(0x12f)+_0xa076c7[_0x55239c(0x1f8)]+_0x55239c(0xf9)+_0x16c390['_id'][_0x55239c(0xbf)]+_0x55239c(0x140));}}_0x402919+='<td\x20class=\x22cat_data\x22></td>',_0x402919+='</tr>',_0x402919+=_0x55239c(0xa6),_0x402919+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>';for(let _0x56d7b2=0x0;_0x56d7b2<=_0x38370f[_0x55239c(0x124)]-0x1;_0x56d7b2++){const _0x1a771b=_0x38370f[_0x56d7b2];for(let _0x382e72=0x0;_0x382e72<_0x15d7fb[_0x55239c(0x1e6)][_0x55239c(0x124)];_0x382e72++){const _0x11b1e9=_0x15d7fb['cat_brand'][_0x382e72];_0x11b1e9[_0x55239c(0x9e)][_0x55239c(0xbf)]==_0x1a771b[_0x55239c(0x9e)][_0x55239c(0xbf)]&&(_0x402919+=_0x55239c(0x1b0)+_0x11b1e9[_0x55239c(0x9e)][_0x55239c(0x1cd)]+_0x55239c(0x140));}}_0x402919+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x402919+=_0x55239c(0x93);let _0x1ff7b2={'name':[],'dataqty':{}};for(let _0x5cf886=0x0;_0x5cf886<_0x15d7fb[_0x55239c(0x1e6)][_0x55239c(0x124)];_0x5cf886++){const _0x10302d=_0x15d7fb[_0x55239c(0x1e6)][_0x5cf886],_0x4d4221=_0x10302d[_0x55239c(0x9e)][_0x55239c(0x1cd)],_0x11b536=_0x10302d['_id'][_0x55239c(0xbf)];!_0x1ff7b2[_0x55239c(0x132)][_0x4d4221]&&(_0x1ff7b2[_0x55239c(0x132)][_0x4d4221]={});!_0x1ff7b2[_0x55239c(0x132)][_0x4d4221][_0x11b536]&&(_0x1ff7b2[_0x55239c(0x132)][_0x4d4221][_0x11b536]=[]);for(let _0x494a30=0x0;_0x494a30<_0x262ff1[_0x55239c(0x124)];_0x494a30++){const _0x2d219b=_0x262ff1[_0x494a30];if(_0x4d4221===_0x2d219b[_0x55239c(0x9e)][_0x55239c(0x1cd)]&&_0x11b536===_0x2d219b[_0x55239c(0x9e)][_0x55239c(0xbf)]){const _0x1692c4=_0x2d219b[_0x55239c(0xc5)];!_0x1ff7b2[_0x55239c(0x132)][_0x4d4221][_0x11b536][_0x1692c4]&&(_0x1ff7b2['dataqty'][_0x4d4221][_0x11b536][_0x1692c4]=[]),_0x1ff7b2[_0x55239c(0x132)][_0x4d4221][_0x11b536][_0x1692c4][_0x55239c(0x1f2)](_0x2d219b[_0x55239c(0xc0)]),!_0x1ff7b2['name'][_0x55239c(0xa1)](_0x1692c4)&&_0x1ff7b2[_0x55239c(0x205)][_0x55239c(0x1f2)](_0x1692c4);}}}_0x402919+=_0x55239c(0xa6);for(let _0x2f90a6=0x0;_0x2f90a6<=_0x1ff7b2['name']['length']-0x1;_0x2f90a6++){const _0x157239=_0x1ff7b2['name'][_0x2f90a6];_0x402919+=_0x55239c(0x137)+_0x157239+_0x55239c(0x140);var _0x21025d=0x0,_0x325d9f=0x0;for(let _0x549050=0x0;_0x549050<=_0x15d7fb[_0x55239c(0x1e6)][_0x55239c(0x124)]-0x1;_0x549050++){const _0x3f4b73=_0x15d7fb[_0x55239c(0x1e6)][_0x549050];var _0x1bedba=0x0;_0x1ff7b2[_0x55239c(0x132)][_0x3f4b73[_0x55239c(0x9e)]['brand']][_0x3f4b73[_0x55239c(0x9e)]['category']][_0x157239]?(_0x1bedba=_0x1ff7b2[_0x55239c(0x132)][_0x3f4b73[_0x55239c(0x9e)][_0x55239c(0x1cd)]][_0x3f4b73[_0x55239c(0x9e)]['category']][_0x157239][0x0],_0x402919+=_0x55239c(0x137)+formatNumber(_0x1bedba[_0x55239c(0x1f6)](0x2))+'</td>'):(_0x1bedba=0x0,_0x402919+=_0x55239c(0x137)+_0x1bedba+'</td>'),_0x21025d+=_0x1bedba;}_0x402919+='<td\x20class=\x22row_data\x22>'+formatNumber(_0x21025d[_0x55239c(0x1f6)](0x2))+'</td>';}return _0x402919+=_0x55239c(0x93),_0x402919;}router[a0_0x4e65fc(0xfb)]('/agent/pdf',auth,async(_0xf1e8bc,_0x283df2)=>{const _0x52fbe2=a0_0x4e65fc,{from_date:_0x54cd98,to_date:_0x46853a}=_0xf1e8bc[_0x52fbe2(0xbe)],_0x2fce9b=await agentsdataCheck(_0x54cd98,_0x46853a);{}let _0x3f04c0='\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x4a9e45=new Date(_0x54cd98),_0x36a63f=new Date(_0x46853a);const _0x1d22b6={'year':_0x52fbe2(0x118),'month':'long','day':'numeric'},_0x33263b=new Intl['DateTimeFormat'](_0x52fbe2(0x13e),_0x1d22b6)[_0x52fbe2(0xd1)](_0x4a9e45),_0x4b0644=new Intl['DateTimeFormat'](_0x52fbe2(0x13e),_0x1d22b6)[_0x52fbe2(0xd1)](_0x36a63f);_0x3f04c0+=_0x52fbe2(0xca),_0x3f04c0+='<p>SALES\x20REPORTS</p>',_0x3f04c0+=_0x52fbe2(0xbc)+_0x33263b+_0x52fbe2(0x97)+_0x4b0644+'</p>',_0x3f04c0+=_0x52fbe2(0x151),_0x3f04c0+='<div\x20class=\x22col-sm-11\x22>',_0x3f04c0+=_0x52fbe2(0x19e),_0x3f04c0+=_0x2fce9b,_0x3f04c0+=_0x52fbe2(0x1c1),_0x3f04c0+=_0x52fbe2(0x96),_0x3f04c0+=_0x52fbe2(0x96);const _0x91d828={'format':_0x52fbe2(0x1a4),'orientation':_0x52fbe2(0x180),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x52fbe2(0x170)}}};pdf[_0x52fbe2(0x90)](_0x3f04c0,_0x91d828)[_0x52fbe2(0xed)](function(_0x36bc69,_0x487ae1){const _0x12d47a=_0x52fbe2;if(_0x36bc69){_0x283df2[_0x12d47a(0x16b)](0x1f4)[_0x12d47a(0x110)](_0x12d47a(0x1ac));return;}_0x283df2[_0x12d47a(0xba)]('Content-Type',_0x12d47a(0x1db)),_0x487ae1[_0x12d47a(0x143)](_0x283df2);});}),router[a0_0x4e65fc(0x14c)](a0_0x4e65fc(0xd0),auth,async(_0x33abb8,_0x5e9087)=>{const _0x56ef66=a0_0x4e65fc;try{const {username:_0x439a3b,email:_0x2f2681,role:_0x5d1ef8}=_0x33abb8['user'],_0x25fccc=_0x33abb8['user'],_0xb9fb26=await profile['findOne']({'email':_0x25fccc[_0x56ef66(0xac)]}),_0x235147={'year':'numeric','month':_0x56ef66(0x11f),'day':_0x56ef66(0x118)},_0x10077b=await master_shop[_0x56ef66(0x179)](),_0x23bf8b=await staff[_0x56ef66(0x18c)]({'email':_0x25fccc[_0x56ef66(0xac)]}),_0x11926d=await product[_0x56ef66(0x179)](),_0x220721=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x56ef66(0x127),'localField':_0x56ef66(0x1e4),'foreignField':_0x56ef66(0x205),'as':_0x56ef66(0x1d5)}},{'$unwind':_0x56ef66(0xfc)},{'$project':{'product_name':_0x56ef66(0x1dc),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x56ef66(0x130),'product_stock':{'$sum':_0x56ef66(0x174)}}}]),_0x39aa8d=await staff[_0x56ef66(0x179)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x10077b[0x0][_0x56ef66(0x186)]==_0x56ef66(0x1b7))var _0x44d6a3=users[_0x56ef66(0x202)];else{if(_0x10077b[0x0][_0x56ef66(0x186)]==_0x56ef66(0xf1))var _0x44d6a3=users['Hindi'];else{if(_0x10077b[0x0][_0x56ef66(0x186)]==_0x56ef66(0xc9))var _0x44d6a3=users['German'];else{if(_0x10077b[0x0]['language']=='Spanish')var _0x44d6a3=users[_0x56ef66(0x1e8)];else{if(_0x10077b[0x0][_0x56ef66(0x186)]==_0x56ef66(0x1fd))var _0x44d6a3=users[_0x56ef66(0x1fd)];else{if(_0x10077b[0x0][_0x56ef66(0x186)]=='Portuguese\x20(BR)')var _0x44d6a3=users[_0x56ef66(0xf8)];else{if(_0x10077b[0x0]['language']==_0x56ef66(0x100))var _0x44d6a3=users[_0x56ef66(0x100)];else{if(_0x10077b[0x0][_0x56ef66(0x186)]=='Arabic\x20(ae)')var _0x44d6a3=users[_0x56ef66(0x1cb)];}}}}}}}_0x5e9087[_0x56ef66(0xb7)]('dsi_sales_admin',{'success':_0x33abb8[_0x56ef66(0x120)](_0x56ef66(0x8a)),'errors':_0x33abb8['flash']('errors'),'alldata':_0x11926d,'profile':_0xb9fb26,'master_shop':_0x10077b,'role':_0x25fccc,'product_stock':_0x220721,'language':_0x44d6a3,'staff_arr':_0x23bf8b,'staff_data_all':_0x39aa8d});}catch(_0x31a0c2){_0x5e9087[_0x56ef66(0xe4)](_0x31a0c2);}});async function agentsdataDSICheck_admin(_0xb5f8f7,_0x11c876,_0x538cbd,_0x4cf1a5){const _0x418b5c=a0_0x4e65fc,_0x41c78f=await product[_0x418b5c(0x14a)]([{'$group':{'_id':{'brand':_0x418b5c(0x1ee),'category':_0x418b5c(0xce)},'products':{'$push':{'name':_0x418b5c(0x103),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x448afe=[];_0x448afe['cat_brand']=[];for(let _0x3e56d0=0x0;_0x3e56d0<=_0x41c78f['length']-0x1;_0x3e56d0++){const _0x47649a=_0x41c78f[_0x3e56d0];_0x448afe['cat_brand'][_0x418b5c(0x1f2)](_0x47649a);}const _0x3cb3ac=await product[_0x418b5c(0x14a)]([{'$group':{'_id':{'category':_0x418b5c(0xce)},'products':{'$push':{'brand':_0x418b5c(0x1ee),'product_code':_0x418b5c(0x1d6),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x56513a=await product[_0x418b5c(0x14a)]([{'$group':{'_id':{'category':_0x418b5c(0xce),'brand':_0x418b5c(0x1ee)}}},{'$group':{'_id':_0x418b5c(0xfd),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1c6731=await sales_sa[_0x418b5c(0x14a)]([{'$match':{'date':{'$gte':_0xb5f8f7,'$lte':_0x11c876},'sales_staff_id':_0x538cbd,'sale_product.isFG':_0x418b5c(0x109)}},{'$unwind':_0x418b5c(0xa3)},{'$match':{'sale_product.isFG':_0x418b5c(0x109)}},{'$lookup':{'from':_0x418b5c(0x127),'localField':_0x418b5c(0x129),'foreignField':_0x418b5c(0x165),'as':'product_info'}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x418b5c(0x18a),'date':_0x418b5c(0x1e7),'customer':_0x418b5c(0x1c6)},'totalQty':{'$sum':_0x418b5c(0xdb)},'products':{'$push':{'qty':_0x418b5c(0xdb),'NetPrice':_0x418b5c(0xa5),'discount':_0x418b5c(0x20e),'adj_discount':_0x418b5c(0xe0),'product_details':{'prod_name':_0x418b5c(0x145),'product_code':_0x418b5c(0x153),'category':_0x418b5c(0x13d),'brand':_0x418b5c(0x191),'gross_price':_0x418b5c(0x1df)}}}}},{'$unwind':_0x418b5c(0x1a3)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x418b5c(0x19a),'customer':_0x418b5c(0x98),'category':'$products.product_details.category','brand':_0x418b5c(0x203)},'totalQty':{'$sum':_0x418b5c(0xe1)},'totalGross':{'$sum':{'$multiply':[_0x418b5c(0xe1),_0x418b5c(0x1af)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x418b5c(0xc1)},'adj_discount':{'$sum':_0x418b5c(0x1dd)},'product_details':{'$first':_0x418b5c(0xea)}}},{'$group':{'_id':{'dsi':_0x418b5c(0x8c),'date':_0x418b5c(0x19a),'customer':'$_id.customer'},'totalQty':{'$sum':_0x418b5c(0x16e)},'totalGross':{'$sum':_0x418b5c(0x17c)},'NetPrice':{'$sum':_0x418b5c(0x1d3)},'discount':{'$sum':_0x418b5c(0xd2)},'adj_discount':{'$sum':_0x418b5c(0x1f0)},'products':{'$push':{'qty':'$totalQty','category':_0x418b5c(0xfd),'brand':'$_id.brand','product_details':_0x418b5c(0x166)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x5e9827=[],_0xe72edc={},_0x496b68={},_0x10fe6f={};var _0x2f4118=0x0,_0x3795e4=0x0,_0x211d5c=0x0,_0x1d2ef3=0x0,_0x3cb8f7=0x0;const _0x18dba6=0x6;for(let _0x1f869b=0x0;_0x1f869b<=_0x1c6731[_0x418b5c(0x124)]-0x1;_0x1f869b++){const _0xaa5b1e=_0x1c6731[_0x1f869b];let _0x4a06dd=_0x418b5c(0xa6);_0x4a06dd+=_0x418b5c(0x112)+_0xaa5b1e[_0x418b5c(0x9e)][_0x418b5c(0x167)]+_0x418b5c(0x140),_0x4a06dd+=_0x418b5c(0x112)+_0xaa5b1e[_0x418b5c(0x9e)][_0x418b5c(0xeb)]+_0x418b5c(0x140),_0x4a06dd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0xaa5b1e['_id'][_0x418b5c(0x1be)]+'</td>';let _0x16881f={};var _0x64f30b=0x0;for(let _0x43bbcd=0x0;_0x43bbcd<=_0xaa5b1e[_0x418b5c(0x127)][_0x418b5c(0x124)]-0x1;_0x43bbcd++){const _0x4c279e=_0xaa5b1e[_0x418b5c(0x127)][_0x43bbcd];_0x16881f[_0x4c279e[_0x418b5c(0x1cd)]+'-'+_0x4c279e['category']]=_0x4c279e[_0x418b5c(0x14e)];const _0xbc321d=_0x4c279e[_0x418b5c(0x1cd)]+'-'+_0x4c279e[_0x418b5c(0xbf)];!_0xe72edc[_0xbc321d]&&(_0xe72edc[_0xbc321d]=0x0),!Array['isArray'](_0x10fe6f[_0xbc321d])&&(_0x10fe6f[_0xbc321d]=[]),!Array[_0x418b5c(0x117)](_0x10fe6f[_0xbc321d])&&(_0x10fe6f[_0xbc321d]=[]),_0xe72edc[_0xbc321d]+=_0x4c279e[_0x418b5c(0x14e)],_0x10fe6f[_0xbc321d]['push'](_0x4c279e[_0x418b5c(0x14e)]),_0x64f30b++;}console[_0x418b5c(0x10e)](_0xaa5b1e);for(let _0x4b61f7=0x0;_0x4b61f7<=_0x448afe[_0x418b5c(0x1e6)][_0x418b5c(0x124)]-0x1;_0x4b61f7++){const _0x4a89d6=_0x448afe[_0x418b5c(0x1e6)][_0x4b61f7],_0x3510cc=_0x4a89d6['_id'][_0x418b5c(0x1cd)]+'-'+_0x4a89d6['_id'][_0x418b5c(0xbf)];_0x4a06dd+=_0x418b5c(0x1d7)+(_0x16881f[_0x3510cc]!==undefined?_0x16881f[_0x3510cc][_0x418b5c(0x1f6)](0x2):'')+_0x418b5c(0x140);}_0x211d5c=_0xaa5b1e[_0x418b5c(0x176)]+_0xaa5b1e[_0x418b5c(0xd6)],_0x4a06dd+=_0x418b5c(0x158)+formatNumber(parseFloat(_0xaa5b1e[_0x418b5c(0x172)],0x2)['toFixed'](0x2))+'</td>',_0x4a06dd+=_0x418b5c(0x158)+formatNumber(_0xaa5b1e[_0x418b5c(0xcf)][_0x418b5c(0x1f6)](0x2))+_0x418b5c(0x140),_0x4a06dd+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x211d5c)+'</td>',_0x4a06dd+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0xaa5b1e[_0x418b5c(0xcc)][_0x418b5c(0x1f6)](0x2))+_0x418b5c(0x140),_0x4a06dd+=_0x418b5c(0x93),_0x2f4118+=parseFloat(_0xaa5b1e['totalQty'][_0x418b5c(0x1f6)](0x2)),_0x3795e4+=parseFloat(_0xaa5b1e[_0x418b5c(0xcc)]['toFixed'](0x2)),_0x1d2ef3+=_0x211d5c,_0x3cb8f7+=parseFloat(_0xaa5b1e['totalGross']['toFixed'](0x2));if(_0x1f869b==_0x1c6731['length']-0x1){_0x4a06dd+='<tr>',_0x4a06dd+=_0x418b5c(0x1f7),_0x4a06dd+=_0x418b5c(0x140);for(let _0x3c3126=0x0;_0x3c3126<=_0x448afe[_0x418b5c(0x1e6)][_0x418b5c(0x124)]-0x1;_0x3c3126++){const _0x245b2c=_0x448afe[_0x418b5c(0x1e6)][_0x3c3126],_0x3912fe=_0x245b2c[_0x418b5c(0x9e)][_0x418b5c(0x1cd)]+'-'+_0x245b2c[_0x418b5c(0x9e)]['category'],_0x2e45a4=_0x10fe6f[_0x3912fe][_0x418b5c(0xd4)]((_0x99df26,_0x38b8c1)=>_0x99df26+_0x38b8c1,0x0);console[_0x418b5c(0x10e)]('test',_0x3912fe),_0x4a06dd+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x2e45a4!==undefined?formatNumber(_0x2e45a4[_0x418b5c(0x1f6)](0x2)):'')+_0x418b5c(0x1e0),console[_0x418b5c(0x10e)](_0x10fe6f[_0x3912fe]['reduce']((_0x1a034a,_0x284490)=>_0x1a034a+_0x284490,0x0));}_0x4a06dd+=_0x418b5c(0xa8)+formatNumber(_0x2f4118['toFixed'](0x2))+'</b></td>',_0x4a06dd+=_0x418b5c(0xa8)+formatNumber(_0x3cb8f7)+_0x418b5c(0x1e0),_0x4a06dd+=_0x418b5c(0xa8)+formatNumber(_0x1d2ef3)+_0x418b5c(0x1e0),_0x4a06dd+=_0x418b5c(0xa8)+formatNumber(_0x3795e4)+_0x418b5c(0x1e0),_0x4a06dd+='</tr>';}_0x5e9827[_0x418b5c(0x1f2)](_0x4a06dd);}function _0x30e1f9(_0x2aedf0,_0x26a519){const _0x363ec0=_0x418b5c,_0x1c0db4=[];for(let _0x29ccf8=0x0;_0x29ccf8<=_0x2aedf0['length']-0x1;_0x29ccf8+=_0x26a519){_0x1c0db4[_0x363ec0(0x1f2)](_0x2aedf0[_0x363ec0(0x193)](_0x29ccf8,_0x29ccf8+_0x26a519));}return _0x1c0db4;}const _0x8953be=_0x30e1f9(_0x5e9827,_0x18dba6);let _0x3bb498='';return _0x8953be[_0x418b5c(0x1ff)]((_0x365a4c,_0x479cf8)=>{const _0x11946f=_0x418b5c;_0x479cf8>0x0&&(_0x3bb498+=_0x11946f(0x141));_0x3bb498+='<table>',_0x3bb498+=_0x11946f(0x19b),_0x3bb498+=_0x11946f(0xa6),_0x3bb498+=_0x11946f(0x14b),_0x3bb498+='</tr>',_0x3bb498+='<tr>',_0x3bb498+=_0x11946f(0xc4);for(let _0xac3299=0x0;_0xac3299<=_0x3cb3ac[_0x11946f(0x124)]-0x1;_0xac3299++){const _0x6bbf0b=_0x3cb3ac[_0xac3299];for(let _0x50b20c=0x0;_0x50b20c<_0x56513a[_0x11946f(0x124)];_0x50b20c++){const _0x14b6c0=_0x56513a[_0x50b20c];_0x14b6c0[_0x11946f(0x9e)]===_0x6bbf0b[_0x11946f(0x9e)][_0x11946f(0xbf)]&&(_0x3bb498+=_0x11946f(0x12f)+_0x14b6c0[_0x11946f(0x1f8)]+_0x11946f(0xf9)+_0x6bbf0b['_id']['category']+_0x11946f(0x140));}}_0x3bb498+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x3bb498+=_0x11946f(0x93),_0x3bb498+='<tr>',_0x3bb498+=_0x11946f(0xc6),_0x3bb498+=_0x11946f(0xfe),_0x3bb498+=_0x11946f(0x18d);for(let _0x2cfe43=0x0;_0x2cfe43<=_0x3cb3ac['length']-0x1;_0x2cfe43++){const _0xf9250d=_0x3cb3ac[_0x2cfe43];for(let _0xb64d3a=0x0;_0xb64d3a<_0x448afe[_0x11946f(0x1e6)][_0x11946f(0x124)];_0xb64d3a++){const _0x10c1b5=_0x448afe['cat_brand'][_0xb64d3a];_0x10c1b5[_0x11946f(0x9e)][_0x11946f(0xbf)]===_0xf9250d[_0x11946f(0x9e)]['category']&&(_0x3bb498+=_0x11946f(0x1b0)+_0x10c1b5[_0x11946f(0x9e)][_0x11946f(0x1cd)]+_0x11946f(0x140));}}_0x3bb498+=_0x11946f(0x1e1),_0x3bb498+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x3bb498+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x3bb498+=_0x11946f(0x181),_0x3bb498+='</tr>',_0x3bb498+=_0x11946f(0xc7),_0x3bb498+=_0x11946f(0x212),_0x365a4c[_0x11946f(0x1ff)](_0x33a458=>{_0x3bb498+=_0x33a458;}),console[_0x11946f(0x10e)](_0x10fe6f),_0x3bb498+=_0x11946f(0x1a8),_0x3bb498+=_0x11946f(0x1c1);}),_0x3bb498;}function a0_0x1edd(_0x32697b,_0x27c6a5){const _0x42de04=a0_0x42de();return a0_0x1edd=function(_0x1eddbf,_0x491ff7){_0x1eddbf=_0x1eddbf-0x88;let _0x4eba5d=_0x42de04[_0x1eddbf];return _0x4eba5d;},a0_0x1edd(_0x32697b,_0x27c6a5);}async function agentsdataDSICheck_admin_excel(_0x1e3907,_0x19a607,_0xbf46c8,_0x3b3333){const _0x109e2b=a0_0x4e65fc,_0x1cfbeb=await product[_0x109e2b(0x14a)]([{'$group':{'_id':{'brand':_0x109e2b(0x1ee),'category':_0x109e2b(0xce)},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x38ca59=[];_0x38ca59[_0x109e2b(0x1e6)]=[];for(let _0x24c1cf=0x0;_0x24c1cf<=_0x1cfbeb[_0x109e2b(0x124)]-0x1;_0x24c1cf++){const _0x51e570=_0x1cfbeb[_0x24c1cf];_0x38ca59['cat_brand'][_0x109e2b(0x1f2)](_0x51e570);}const _0x5f439b=await product[_0x109e2b(0x14a)]([{'$group':{'_id':{'category':_0x109e2b(0xce)},'products':{'$push':{'brand':_0x109e2b(0x1ee),'product_code':_0x109e2b(0x1d6),'product_name':_0x109e2b(0x103)}}}},{'$sort':{'_id.category':-0x1}}]),_0x50f44f=await product[_0x109e2b(0x14a)]([{'$group':{'_id':{'category':_0x109e2b(0xce),'brand':_0x109e2b(0x1ee)}}},{'$group':{'_id':_0x109e2b(0xfd),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x406cba=await sales_sa[_0x109e2b(0x14a)]([{'$match':{'date':{'$gte':_0x1e3907,'$lte':_0x19a607},'sales_staff_id':_0xbf46c8,'sale_product.isFG':_0x109e2b(0x109)}},{'$unwind':_0x109e2b(0xa3)},{'$match':{'sale_product.isFG':_0x109e2b(0x109)}},{'$lookup':{'from':_0x109e2b(0x127),'localField':_0x109e2b(0x129),'foreignField':_0x109e2b(0x165),'as':_0x109e2b(0x105)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x109e2b(0x18a),'date':'$date','customer':_0x109e2b(0x1c6)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x109e2b(0xa5),'discount':_0x109e2b(0x20e),'adj_discount':_0x109e2b(0xe0),'product_details':{'prod_name':_0x109e2b(0x145),'product_code':_0x109e2b(0x153),'category':'$product_info.category','brand':_0x109e2b(0x191),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x109e2b(0x1a3)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x109e2b(0x19a),'customer':_0x109e2b(0x98),'category':_0x109e2b(0x19d),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x109e2b(0xe1)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x109e2b(0x1af)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x109e2b(0xc1)},'adj_discount':{'$sum':_0x109e2b(0x1dd)},'product_details':{'$first':_0x109e2b(0xea)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x109e2b(0x19a),'customer':_0x109e2b(0x98)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0x109e2b(0x17c)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x109e2b(0xd2)},'adj_discount':{'$sum':_0x109e2b(0x1f0)},'products':{'$push':{'qty':'$totalQty','category':'$_id.category','brand':_0x109e2b(0xb8),'product_details':_0x109e2b(0x166)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x1c43ba=[],_0x1d7b9c={},_0x2a58e2={},_0xb2249f={};var _0x382c45=0x0,_0xa61592=0x0,_0x26900f=0x0,_0x523fdf=0x0,_0x235a06=0x0;const _0x1eb837=0x16345785d8a0000;for(let _0x514e51=0x0;_0x514e51<=_0x406cba[_0x109e2b(0x124)]-0x1;_0x514e51++){const _0xddce3b=_0x406cba[_0x514e51];let _0x55f6a6=_0x109e2b(0xa6);_0x55f6a6+=_0x109e2b(0x112)+_0xddce3b[_0x109e2b(0x9e)]['dsi']+'</td>',_0x55f6a6+=_0x109e2b(0x112)+_0xddce3b[_0x109e2b(0x9e)][_0x109e2b(0xeb)]+_0x109e2b(0x140),_0x55f6a6+=_0x109e2b(0x112)+_0xddce3b['_id'][_0x109e2b(0x1be)]+_0x109e2b(0x140);let _0x1156c4={};var _0x570147=0x0;for(let _0x3b6c94=0x0;_0x3b6c94<=_0xddce3b[_0x109e2b(0x127)][_0x109e2b(0x124)]-0x1;_0x3b6c94++){const _0x57b74a=_0xddce3b[_0x109e2b(0x127)][_0x3b6c94];_0x1156c4[_0x57b74a['brand']+'-'+_0x57b74a['category']]=_0x57b74a[_0x109e2b(0x14e)];const _0x2ee66a=_0x57b74a[_0x109e2b(0x1cd)]+'-'+_0x57b74a[_0x109e2b(0xbf)];!_0x1d7b9c[_0x2ee66a]&&(_0x1d7b9c[_0x2ee66a]=0x0),!Array['isArray'](_0xb2249f[_0x2ee66a])&&(_0xb2249f[_0x2ee66a]=[]),!Array[_0x109e2b(0x117)](_0xb2249f[_0x2ee66a])&&(_0xb2249f[_0x2ee66a]=[]),_0x1d7b9c[_0x2ee66a]+=_0x57b74a[_0x109e2b(0x14e)],_0xb2249f[_0x2ee66a][_0x109e2b(0x1f2)](_0x57b74a['qty']),_0x570147++;}console[_0x109e2b(0x10e)](_0xddce3b);for(let _0x18a917=0x0;_0x18a917<=_0x38ca59[_0x109e2b(0x1e6)]['length']-0x1;_0x18a917++){const _0xcf7542=_0x38ca59['cat_brand'][_0x18a917],_0x4c7078=_0xcf7542[_0x109e2b(0x9e)]['brand']+'-'+_0xcf7542['_id'][_0x109e2b(0xbf)];_0x55f6a6+=_0x109e2b(0x1d7)+(_0x1156c4[_0x4c7078]!==undefined?_0x1156c4[_0x4c7078][_0x109e2b(0x1f6)](0x2):'')+_0x109e2b(0x140);}_0x26900f=_0xddce3b[_0x109e2b(0x176)]+_0xddce3b['adj_discount'],_0x55f6a6+=_0x109e2b(0x158)+formatNumber(parseFloat(_0xddce3b[_0x109e2b(0x172)],0x2)['toFixed'](0x2))+'</td>',_0x55f6a6+=_0x109e2b(0x158)+formatNumber(_0xddce3b[_0x109e2b(0xcf)]['toFixed'](0x2))+_0x109e2b(0x140),_0x55f6a6+=_0x109e2b(0x158)+formatNumber(_0x26900f)+_0x109e2b(0x140),_0x55f6a6+=_0x109e2b(0x158)+formatNumber(_0xddce3b[_0x109e2b(0xcc)][_0x109e2b(0x1f6)](0x2))+_0x109e2b(0x140),_0x55f6a6+=_0x109e2b(0x93),_0x382c45+=parseFloat(_0xddce3b[_0x109e2b(0x172)]['toFixed'](0x2)),_0xa61592+=parseFloat(_0xddce3b['NetPrice'][_0x109e2b(0x1f6)](0x2)),_0x523fdf+=_0x26900f,_0x235a06+=parseFloat(_0xddce3b[_0x109e2b(0xcf)][_0x109e2b(0x1f6)](0x2));if(_0x514e51==_0x406cba[_0x109e2b(0x124)]-0x1){_0x55f6a6+='<tr>',_0x55f6a6+=_0x109e2b(0x1f7),_0x55f6a6+='</td>';for(let _0x43154f=0x0;_0x43154f<=_0x38ca59[_0x109e2b(0x1e6)][_0x109e2b(0x124)]-0x1;_0x43154f++){const _0x472e06=_0x38ca59[_0x109e2b(0x1e6)][_0x43154f],_0x40dcd6=_0x472e06['_id']['brand']+'-'+_0x472e06[_0x109e2b(0x9e)][_0x109e2b(0xbf)],_0x1264ce=_0xb2249f[_0x40dcd6][_0x109e2b(0xd4)]((_0x2a0cae,_0x420735)=>_0x2a0cae+_0x420735,0x0);console[_0x109e2b(0x10e)](_0x109e2b(0xe7),_0x40dcd6),_0x55f6a6+=_0x109e2b(0x9a)+(_0x1264ce!==undefined?formatNumber(_0x1264ce['toFixed'](0x2)):'')+'</b></td>',console['log'](_0xb2249f[_0x40dcd6][_0x109e2b(0xd4)]((_0x389fba,_0x398854)=>_0x389fba+_0x398854,0x0));}_0x55f6a6+=_0x109e2b(0xa8)+formatNumber(_0x382c45['toFixed'](0x2))+_0x109e2b(0x1e0),_0x55f6a6+=_0x109e2b(0xa8)+formatNumber(_0x235a06)+_0x109e2b(0x1e0),_0x55f6a6+=_0x109e2b(0xa8)+formatNumber(_0x523fdf)+_0x109e2b(0x1e0),_0x55f6a6+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xa61592)+'</b></td>',_0x55f6a6+=_0x109e2b(0x93);}_0x1c43ba['push'](_0x55f6a6);}function _0x2e604e(_0x13d21f,_0x569a61){const _0x5250eb=_0x109e2b,_0x1a3f9f=[];for(let _0x58e2b2=0x0;_0x58e2b2<=_0x13d21f['length']-0x1;_0x58e2b2+=_0x569a61){_0x1a3f9f[_0x5250eb(0x1f2)](_0x13d21f[_0x5250eb(0x193)](_0x58e2b2,_0x58e2b2+_0x569a61));}return _0x1a3f9f;}const _0x2243df=_0x2e604e(_0x1c43ba,_0x1eb837);let _0x19a1e6='';return _0x2243df[_0x109e2b(0x1ff)]((_0x524700,_0x20b6b3)=>{const _0x3eefbb=_0x109e2b;_0x20b6b3>0x0&&(_0x19a1e6+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x19a1e6+='<table>',_0x19a1e6+=_0x3eefbb(0x19b),_0x19a1e6+='<tr>',_0x19a1e6+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x19a1e6+=_0x3eefbb(0x93),_0x19a1e6+=_0x3eefbb(0xa6),_0x19a1e6+=_0x3eefbb(0xc4);for(let _0xd24db5=0x0;_0xd24db5<=_0x5f439b[_0x3eefbb(0x124)]-0x1;_0xd24db5++){const _0xf8a6d5=_0x5f439b[_0xd24db5];for(let _0x3becfb=0x0;_0x3becfb<_0x50f44f['length'];_0x3becfb++){const _0x494462=_0x50f44f[_0x3becfb];_0x494462['_id']===_0xf8a6d5[_0x3eefbb(0x9e)][_0x3eefbb(0xbf)]&&(_0x19a1e6+='<td\x20colspan=\x22'+_0x494462['brandCount']+_0x3eefbb(0xf9)+_0xf8a6d5['_id'][_0x3eefbb(0xbf)]+_0x3eefbb(0x140));}}_0x19a1e6+=_0x3eefbb(0x1bd),_0x19a1e6+=_0x3eefbb(0x93),_0x19a1e6+='<tr>',_0x19a1e6+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x19a1e6+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x19a1e6+=_0x3eefbb(0x18d);for(let _0x3f6313=0x0;_0x3f6313<=_0x5f439b[_0x3eefbb(0x124)]-0x1;_0x3f6313++){const _0x3ba87c=_0x5f439b[_0x3f6313];for(let _0x241b0b=0x0;_0x241b0b<_0x38ca59['cat_brand']['length'];_0x241b0b++){const _0x63348f=_0x38ca59[_0x3eefbb(0x1e6)][_0x241b0b];_0x63348f['_id']['category']===_0x3ba87c[_0x3eefbb(0x9e)]['category']&&(_0x19a1e6+=_0x3eefbb(0x1b0)+_0x63348f[_0x3eefbb(0x9e)]['brand']+_0x3eefbb(0x140));}}_0x19a1e6+=_0x3eefbb(0x1e1),_0x19a1e6+=_0x3eefbb(0x16c),_0x19a1e6+=_0x3eefbb(0x16f),_0x19a1e6+=_0x3eefbb(0x181),_0x19a1e6+=_0x3eefbb(0x93),_0x19a1e6+=_0x3eefbb(0xc7),_0x19a1e6+=_0x3eefbb(0x212),_0x524700['forEach'](_0x3472b4=>{_0x19a1e6+=_0x3472b4;}),console['log'](_0xb2249f),_0x19a1e6+='</tbody>',_0x19a1e6+=_0x3eefbb(0x1c1);}),_0x19a1e6;}router[a0_0x4e65fc(0xfb)](a0_0x4e65fc(0x1c7),auth,async(_0x319cfc,_0x499c2e)=>{const _0x246aaa=a0_0x4e65fc,{from_date:_0x3c2bf1,to_date:_0x342e9f,isExcel:_0x32735c,agent_id:_0x44fe5d}=_0x319cfc[_0x246aaa(0xbe)],_0x107c3e=_0x319cfc[_0x246aaa(0x209)],_0x4a129a=await staff[_0x246aaa(0x18c)]({'email':_0x107c3e[_0x246aaa(0xac)]}),_0x1b7d88=await master_shop[_0x246aaa(0x179)](),_0x315ef6=await agentsdataDSICheck_admin(_0x3c2bf1,_0x342e9f,_0x44fe5d,_0x32735c),_0x3bde3b=await agentsdataDSICheck_admin_excel(_0x3c2bf1,_0x342e9f,_0x44fe5d,_0x32735c);let _0x463dac=_0x246aaa(0x199);var _0x419f78=new Date(_0x3c2bf1),_0x45b7c2=new Date(_0x342e9f);const _0x6cbaad={'year':_0x246aaa(0x118),'month':_0x246aaa(0x11f),'day':'numeric'},_0x2affde=new Intl[(_0x246aaa(0x1a9))](_0x246aaa(0x13e),_0x6cbaad)['format'](_0x419f78),_0x50d4d3=new Intl[(_0x246aaa(0x1a9))](_0x246aaa(0x13e),_0x6cbaad)['format'](_0x45b7c2);_0x463dac+=_0x246aaa(0x151),_0x463dac+=_0x246aaa(0x1b9),_0x463dac+=_0x246aaa(0x19e),_0x463dac+=_0x315ef6,_0x463dac+=_0x246aaa(0x1c1),_0x463dac+='</div>',_0x463dac+=_0x246aaa(0x96);let _0x538fd3='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x538fd3+=_0x246aaa(0x151),_0x538fd3+=_0x246aaa(0x1b9),_0x538fd3+=_0x246aaa(0x19e),_0x538fd3+=_0x3bde3b,_0x538fd3+=_0x246aaa(0x1c1),_0x538fd3+=_0x246aaa(0x96),_0x538fd3+=_0x246aaa(0x96);let _0x35fbd1=_0x246aaa(0xb5);const _0x7d4b40={'width':_0x246aaa(0x99),'height':_0x246aaa(0x128),'orientation':_0x246aaa(0x180),'border':{'top':'0.1in','right':_0x246aaa(0xd5),'bottom':_0x246aaa(0xd5),'left':_0x246aaa(0xd5)},'header':{'height':_0x246aaa(0x17b),'contents':_0x246aaa(0x9d)+_0x35fbd1+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x2affde+_0x246aaa(0x97)+_0x50d4d3+_0x246aaa(0xda)},'footer':{'height':_0x246aaa(0xa0),'contents':{'default':_0x246aaa(0x1e9)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x246aaa(0x170)}}};if(_0x32735c=='on'){const _0x42d9ef=cheerio[_0x246aaa(0xdd)](_0x538fd3);let _0x41545e=[],_0x533ab1=[],_0x4f6b98=[];_0x42d9ef(_0x246aaa(0x13a))[_0x246aaa(0x1eb)]((_0x4c4b39,_0x11be1c)=>{const _0x350997=_0x246aaa;let _0x2c3bb1=[],_0x50d641=0x0;while(_0x4f6b98[_0x50d641]){_0x4f6b98[_0x50d641]--,_0x50d641++;}_0x42d9ef(_0x11be1c)[_0x350997(0x179)](_0x350997(0x1d4))[_0x350997(0x1eb)]((_0x3ff3cf,_0x51354a)=>{const _0x2c0ac9=_0x350997;let _0x22d381=_0x42d9ef(_0x51354a)[_0x2c0ac9(0xe3)]()[_0x2c0ac9(0xde)](),_0x9beeae=parseFloat(_0x22d381[_0x2c0ac9(0x1b2)](/,/g,''));isNaN(_0x9beeae)&&(_0x9beeae=_0x22d381);let _0x32afd2=parseInt(_0x42d9ef(_0x51354a)[_0x2c0ac9(0xdf)](_0x2c0ac9(0x1e2)))||0x1,_0x5133a1=parseInt(_0x42d9ef(_0x51354a)[_0x2c0ac9(0xdf)](_0x2c0ac9(0x1a2)))||0x1;_0x2c3bb1[_0x50d641]=_0x9beeae;(_0x32afd2>0x1||_0x5133a1>0x1)&&_0x533ab1[_0x2c0ac9(0x1f2)]({'s':{'r':_0x4c4b39,'c':_0x50d641},'e':{'r':_0x4c4b39+_0x5133a1-0x1,'c':_0x50d641+_0x32afd2-0x1}});for(let _0x5263fe=0x0;_0x5263fe<_0x32afd2;_0x5263fe++){_0x5133a1>0x1&&(_0x4f6b98[_0x50d641+_0x5263fe]=_0x5133a1-0x1);}_0x50d641+=_0x32afd2;}),_0x41545e['push'](_0x2c3bb1);});const _0x557c98=XLSX[_0x246aaa(0x149)][_0x246aaa(0xff)](),_0x40c3f4=XLSX['utils']['aoa_to_sheet'](_0x41545e);_0x533ab1[_0x246aaa(0x124)]>0x0&&(_0x40c3f4[_0x246aaa(0x187)]=_0x533ab1);_0x40c3f4[_0x246aaa(0x204)]=_0x41545e[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x246aaa(0x149)][_0x246aaa(0x18e)](_0x557c98,_0x40c3f4,_0x246aaa(0x138));const _0x7c7dd9=XLSX[_0x246aaa(0x20d)](_0x557c98,{'bookType':_0x246aaa(0x190),'type':'buffer'});_0x499c2e['setHeader']('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x499c2e[_0x246aaa(0xba)](_0x246aaa(0xa7),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x499c2e['send'](_0x7c7dd9);}else pdf['create'](_0x463dac,_0x7d4b40)[_0x246aaa(0xed)](function(_0x5c138f,_0x55e314){const _0x2d3e54=_0x246aaa;if(_0x5c138f){_0x499c2e[_0x2d3e54(0x16b)](0x1f4)[_0x2d3e54(0x110)](_0x2d3e54(0x1ac));return;}_0x499c2e[_0x2d3e54(0xba)]('Content-Type','application/pdf'),_0x55e314['pipe'](_0x499c2e);});}),router['get']('/agent_reports/view',auth,async(_0x1f2ab1,_0x3db158)=>{const _0x158a56=a0_0x4e65fc;try{const {username:_0x333bcb,email:_0x438aae,role:_0x370f0e}=_0x1f2ab1['user'],_0x10c7bf=_0x1f2ab1[_0x158a56(0x209)],_0xc92bba=await profile['findOne']({'email':_0x10c7bf[_0x158a56(0xac)]}),_0x15b0da={'year':'numeric','month':'long','day':'numeric'},_0xd588c4=await master_shop[_0x158a56(0x179)](),_0x39195c=await staff[_0x158a56(0x18c)]({'email':_0x10c7bf['email']}),_0x4370b9=await product[_0x158a56(0x179)](),_0x199ab4=await warehouse[_0x158a56(0x14a)]([{'$unwind':_0x158a56(0x166)},{'$lookup':{'from':_0x158a56(0x127),'localField':_0x158a56(0x1e4),'foreignField':_0x158a56(0x205),'as':'product_docs'}},{'$unwind':_0x158a56(0xfc)},{'$project':{'product_name':_0x158a56(0x1dc),'product_stock':_0x158a56(0x136)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x158a56(0x174)}}}]);if(_0xd588c4[0x0][_0x158a56(0x186)]==_0x158a56(0x1b7))var _0xd5359c=users[_0x158a56(0x202)];else{if(_0xd588c4[0x0][_0x158a56(0x186)]==_0x158a56(0xf1))var _0xd5359c=users[_0x158a56(0xf1)];else{if(_0xd588c4[0x0][_0x158a56(0x186)]==_0x158a56(0xc9))var _0xd5359c=users[_0x158a56(0xc9)];else{if(_0xd588c4[0x0][_0x158a56(0x186)]=='Spanish')var _0xd5359c=users[_0x158a56(0x1e8)];else{if(_0xd588c4[0x0]['language']==_0x158a56(0x1fd))var _0xd5359c=users[_0x158a56(0x1fd)];else{if(_0xd588c4[0x0][_0x158a56(0x186)]==_0x158a56(0x8e))var _0xd5359c=users[_0x158a56(0xf8)];else{if(_0xd588c4[0x0][_0x158a56(0x186)]==_0x158a56(0x100))var _0xd5359c=users[_0x158a56(0x100)];else{if(_0xd588c4[0x0][_0x158a56(0x186)]==_0x158a56(0x15e))var _0xd5359c=users[_0x158a56(0x1cb)];}}}}}}}_0x3db158['render'](_0x158a56(0x144),{'success':_0x1f2ab1[_0x158a56(0x120)](_0x158a56(0x8a)),'errors':_0x1f2ab1[_0x158a56(0x120)]('errors'),'alldata':_0x4370b9,'profile':_0xc92bba,'master_shop':_0xd588c4,'role':_0x10c7bf,'product_stock':_0x199ab4,'language':_0xd5359c,'staff_arr':_0x39195c});}catch(_0xb96e97){}});function formatNumber(_0x1d2fb0,_0xaee575=a0_0x4e65fc(0x13e),_0x2c1a57={'minimumFractionDigits':0x2}){const _0x1a9025=a0_0x4e65fc,_0x2d7951=new Intl['NumberFormat'](_0xaee575,_0x2c1a57);return _0x2d7951[_0x1a9025(0xd1)](_0x1d2fb0);}async function agentsdataDSICheck(_0x5e9961,_0x4cfa4d,_0x4b1f75,_0x5d207f){const _0x4ceb75=a0_0x4e65fc,_0x138b16=await product[_0x4ceb75(0x14a)]([{'$group':{'_id':{'brand':_0x4ceb75(0x1ee),'category':'$category'},'products':{'$push':{'name':_0x4ceb75(0x103),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5c60ef=[];_0x5c60ef['cat_brand']=[];for(let _0x4d4ec0=0x0;_0x4d4ec0<=_0x138b16[_0x4ceb75(0x124)]-0x1;_0x4d4ec0++){const _0x49da3f=_0x138b16[_0x4d4ec0];_0x5c60ef[_0x4ceb75(0x1e6)][_0x4ceb75(0x1f2)](_0x49da3f);}const _0x5c602b=await product[_0x4ceb75(0x14a)]([{'$group':{'_id':{'category':_0x4ceb75(0xce)},'products':{'$push':{'brand':_0x4ceb75(0x1ee),'product_code':_0x4ceb75(0x1d6),'product_name':_0x4ceb75(0x103)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5e57d8=await product[_0x4ceb75(0x14a)]([{'$group':{'_id':{'category':_0x4ceb75(0xce),'brand':_0x4ceb75(0x1ee)}}},{'$group':{'_id':_0x4ceb75(0xfd),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x313be8=await sales_sa[_0x4ceb75(0x14a)]([{'$match':{'date':{'$gte':_0x5e9961,'$lte':_0x4cfa4d},'sales_staff_id':_0x4b1f75,'sale_product.isFG':_0x4ceb75(0x109),'status_data':_0x4ceb75(0x109)}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x4ceb75(0x127),'localField':_0x4ceb75(0x129),'foreignField':_0x4ceb75(0x165),'as':_0x4ceb75(0x105)}},{'$unwind':_0x4ceb75(0x1cc)},{'$group':{'_id':{'dsi':_0x4ceb75(0x18a),'date':_0x4ceb75(0x1e7),'customer':_0x4ceb75(0x1c6)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x4ceb75(0xa5),'discount':_0x4ceb75(0x20e),'adj_discount':_0x4ceb75(0xe0),'product_details':{'prod_name':_0x4ceb75(0x145),'product_code':_0x4ceb75(0x153),'category':_0x4ceb75(0x13d),'brand':_0x4ceb75(0x191),'gross_price':_0x4ceb75(0x1df)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x4ceb75(0x8c),'date':'$_id.date','customer':'$_id.customer','category':_0x4ceb75(0x19d),'brand':_0x4ceb75(0x203)},'totalQty':{'$sum':_0x4ceb75(0xe1)},'totalGross':{'$sum':{'$multiply':[_0x4ceb75(0xe1),_0x4ceb75(0x1af)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x4ceb75(0xc1)},'adj_discount':{'$sum':_0x4ceb75(0x1dd)},'product_details':{'$first':_0x4ceb75(0xea)}}},{'$group':{'_id':{'dsi':_0x4ceb75(0x8c),'date':'$_id.date','customer':_0x4ceb75(0x98)},'totalQty':{'$sum':_0x4ceb75(0x16e)},'totalGross':{'$sum':_0x4ceb75(0x17c)},'NetPrice':{'$sum':_0x4ceb75(0x1d3)},'discount':{'$sum':_0x4ceb75(0xd2)},'adj_discount':{'$sum':_0x4ceb75(0x1f0)},'products':{'$push':{'qty':_0x4ceb75(0x16e),'category':_0x4ceb75(0xfd),'brand':'$_id.brand','product_details':_0x4ceb75(0x166)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2b0c39=[],_0x4b0454={},_0x462b50={},_0x57e4e1={};var _0xf35195=0x0,_0x225393=0x0,_0x358f6e=0x0,_0x12fc9f=0x0,_0x40fcb0=0x0;const _0x8b0f81=0x6;for(let _0xb51b9c=0x0;_0xb51b9c<=_0x313be8[_0x4ceb75(0x124)]-0x1;_0xb51b9c++){const _0x389e06=_0x313be8[_0xb51b9c];let _0x144080='<tr>';_0x144080+=_0x4ceb75(0x112)+_0x389e06[_0x4ceb75(0x9e)][_0x4ceb75(0x167)]+_0x4ceb75(0x140),_0x144080+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x389e06[_0x4ceb75(0x9e)][_0x4ceb75(0xeb)]+_0x4ceb75(0x140),_0x144080+=_0x4ceb75(0x112)+_0x389e06[_0x4ceb75(0x9e)][_0x4ceb75(0x1be)]+'</td>';let _0x40e04f={};var _0x46f40a=0x0;for(let _0x577654=0x0;_0x577654<=_0x389e06[_0x4ceb75(0x127)][_0x4ceb75(0x124)]-0x1;_0x577654++){const _0x3f93e7=_0x389e06[_0x4ceb75(0x127)][_0x577654];_0x40e04f[_0x3f93e7[_0x4ceb75(0x1cd)]+'-'+_0x3f93e7[_0x4ceb75(0xbf)]]=_0x3f93e7[_0x4ceb75(0x14e)];const _0xa9a067=_0x3f93e7[_0x4ceb75(0x1cd)]+'-'+_0x3f93e7['category'];!_0x4b0454[_0xa9a067]&&(_0x4b0454[_0xa9a067]=0x0),!Array[_0x4ceb75(0x117)](_0x57e4e1[_0xa9a067])&&(_0x57e4e1[_0xa9a067]=[]),!Array['isArray'](_0x57e4e1[_0xa9a067])&&(_0x57e4e1[_0xa9a067]=[]),_0x4b0454[_0xa9a067]+=_0x3f93e7['qty'],_0x57e4e1[_0xa9a067]['push'](_0x3f93e7['qty']),_0x46f40a++;}console[_0x4ceb75(0x10e)](_0x389e06);for(let _0x2a34f5=0x0;_0x2a34f5<=_0x5c60ef['cat_brand'][_0x4ceb75(0x124)]-0x1;_0x2a34f5++){const _0x34e392=_0x5c60ef[_0x4ceb75(0x1e6)][_0x2a34f5],_0x4cf636=_0x34e392[_0x4ceb75(0x9e)][_0x4ceb75(0x1cd)]+'-'+_0x34e392[_0x4ceb75(0x9e)][_0x4ceb75(0xbf)];_0x144080+=_0x4ceb75(0x1d7)+(_0x40e04f[_0x4cf636]!==undefined?_0x40e04f[_0x4cf636][_0x4ceb75(0x1f6)](0x2):'')+_0x4ceb75(0x140);}_0x358f6e=_0x389e06[_0x4ceb75(0x176)]+_0x389e06[_0x4ceb75(0xd6)],_0x144080+=_0x4ceb75(0x158)+formatNumber(parseFloat(_0x389e06['totalQty'],0x2)[_0x4ceb75(0x1f6)](0x2))+_0x4ceb75(0x140),_0x144080+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x389e06[_0x4ceb75(0xcf)][_0x4ceb75(0x1f6)](0x2))+_0x4ceb75(0x140),_0x144080+=_0x4ceb75(0x158)+formatNumber(_0x358f6e)+_0x4ceb75(0x140),_0x144080+=_0x4ceb75(0x158)+formatNumber(_0x389e06[_0x4ceb75(0xcc)]['toFixed'](0x2))+_0x4ceb75(0x140),_0x144080+='</tr>',_0xf35195+=parseFloat(_0x389e06['totalQty']['toFixed'](0x2)),_0x225393+=parseFloat(_0x389e06[_0x4ceb75(0xcc)][_0x4ceb75(0x1f6)](0x2)),_0x12fc9f+=_0x358f6e,_0x40fcb0+=parseFloat(_0x389e06[_0x4ceb75(0xcf)][_0x4ceb75(0x1f6)](0x2));if(_0xb51b9c==_0x313be8['length']-0x1){_0x144080+=_0x4ceb75(0xa6),_0x144080+=_0x4ceb75(0x1f7),_0x144080+=_0x4ceb75(0x140);for(let _0x37f09a=0x0;_0x37f09a<=_0x5c60ef[_0x4ceb75(0x1e6)][_0x4ceb75(0x124)]-0x1;_0x37f09a++){const _0x5f0c7d=_0x5c60ef[_0x4ceb75(0x1e6)][_0x37f09a],_0x34138a=_0x5f0c7d[_0x4ceb75(0x9e)][_0x4ceb75(0x1cd)]+'-'+_0x5f0c7d['_id']['category'];!_0x57e4e1[_0x34138a]&&(_0x57e4e1[_0x34138a]=[]);const _0x1462c2=_0x57e4e1[_0x34138a][_0x4ceb75(0xd4)]((_0x244b7f,_0x1b0a6b)=>_0x244b7f+_0x1b0a6b,0x0);_0x144080+=_0x4ceb75(0x9a)+(_0x1462c2!==undefined?formatNumber(_0x1462c2['toFixed'](0x2)):'')+'</b></td>',console['log'](_0x57e4e1[_0x34138a]['reduce']((_0x194596,_0x3e4621)=>_0x194596+_0x3e4621,0x0));}_0x144080+=_0x4ceb75(0xa8)+formatNumber(_0xf35195[_0x4ceb75(0x1f6)](0x2))+_0x4ceb75(0x1e0),_0x144080+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x40fcb0)+_0x4ceb75(0x1e0),_0x144080+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x12fc9f)+_0x4ceb75(0x1e0),_0x144080+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x225393)+_0x4ceb75(0x1e0),_0x144080+=_0x4ceb75(0x93);}_0x2b0c39[_0x4ceb75(0x1f2)](_0x144080);}function _0x4df1b7(_0x379c9d,_0x43aea6){const _0x40b1d7=_0x4ceb75,_0x4913aa=[];for(let _0x22ccf3=0x0;_0x22ccf3<=_0x379c9d[_0x40b1d7(0x124)]-0x1;_0x22ccf3+=_0x43aea6){_0x4913aa[_0x40b1d7(0x1f2)](_0x379c9d[_0x40b1d7(0x193)](_0x22ccf3,_0x22ccf3+_0x43aea6));}return _0x4913aa;}const _0x14281f=_0x4df1b7(_0x2b0c39,_0x8b0f81);let _0x57a063='';return _0x14281f['forEach']((_0x1b10c3,_0x37917f)=>{const _0x6d21b=_0x4ceb75;_0x37917f>0x0&&(_0x57a063+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x57a063+=_0x6d21b(0x19e),_0x57a063+=_0x6d21b(0x19b),_0x57a063+=_0x6d21b(0xa6),_0x57a063+=_0x6d21b(0x14b),_0x57a063+=_0x6d21b(0x93),_0x57a063+='<tr>',_0x57a063+=_0x6d21b(0xc4);for(let _0x166cdc=0x0;_0x166cdc<=_0x5c602b[_0x6d21b(0x124)]-0x1;_0x166cdc++){const _0x1bf142=_0x5c602b[_0x166cdc];for(let _0x491474=0x0;_0x491474<_0x5e57d8[_0x6d21b(0x124)];_0x491474++){const _0xdf0d5=_0x5e57d8[_0x491474];_0xdf0d5[_0x6d21b(0x9e)]===_0x1bf142['_id'][_0x6d21b(0xbf)]&&(_0x57a063+=_0x6d21b(0x12f)+_0xdf0d5[_0x6d21b(0x1f8)]+_0x6d21b(0xf9)+_0x1bf142[_0x6d21b(0x9e)]['category']+_0x6d21b(0x140));}}_0x57a063+=_0x6d21b(0x1bd),_0x57a063+='</tr>',_0x57a063+='<tr>',_0x57a063+=_0x6d21b(0xc6),_0x57a063+=_0x6d21b(0xfe),_0x57a063+=_0x6d21b(0x18d);for(let _0x4e04f1=0x0;_0x4e04f1<=_0x5c602b[_0x6d21b(0x124)]-0x1;_0x4e04f1++){const _0x45efd1=_0x5c602b[_0x4e04f1];for(let _0x5f2132=0x0;_0x5f2132<_0x5c60ef[_0x6d21b(0x1e6)]['length'];_0x5f2132++){const _0x18ac22=_0x5c60ef[_0x6d21b(0x1e6)][_0x5f2132];_0x18ac22[_0x6d21b(0x9e)][_0x6d21b(0xbf)]===_0x45efd1[_0x6d21b(0x9e)][_0x6d21b(0xbf)]&&(_0x57a063+=_0x6d21b(0x1b0)+_0x18ac22['_id']['brand']+_0x6d21b(0x140));}}_0x57a063+=_0x6d21b(0x1e1),_0x57a063+=_0x6d21b(0x16c),_0x57a063+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0x57a063+=_0x6d21b(0x181),_0x57a063+=_0x6d21b(0x93),_0x57a063+=_0x6d21b(0xc7),_0x57a063+=_0x6d21b(0x212),_0x1b10c3['forEach'](_0x56d0b1=>{_0x57a063+=_0x56d0b1;}),console[_0x6d21b(0x10e)](_0x57e4e1),_0x57a063+='</tbody>',_0x57a063+=_0x6d21b(0x1c1);}),_0x57a063;}async function agentsdataDSICheck_excel(_0x3d4592,_0x84dc49,_0x3bc4e9,_0x122f41){const _0xa76f70=a0_0x4e65fc,_0x5cf15a=await product[_0xa76f70(0x14a)]([{'$group':{'_id':{'brand':_0xa76f70(0x1ee),'category':_0xa76f70(0xce)},'products':{'$push':{'name':_0xa76f70(0x103),'product_code':_0xa76f70(0x1d6)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x49b893=[];_0x49b893[_0xa76f70(0x1e6)]=[];for(let _0x487178=0x0;_0x487178<=_0x5cf15a[_0xa76f70(0x124)]-0x1;_0x487178++){const _0x5738c5=_0x5cf15a[_0x487178];_0x49b893['cat_brand'][_0xa76f70(0x1f2)](_0x5738c5);}const _0x45eff7=await product[_0xa76f70(0x14a)]([{'$group':{'_id':{'category':_0xa76f70(0xce)},'products':{'$push':{'brand':'$brand','product_code':'$product_code','product_name':_0xa76f70(0x103)}}}},{'$sort':{'_id.category':-0x1}}]),_0x5148b5=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':_0xa76f70(0x1ee)}}},{'$group':{'_id':_0xa76f70(0xfd),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x77dccc=await sales_sa[_0xa76f70(0x14a)]([{'$match':{'date':{'$gte':_0x3d4592,'$lte':_0x84dc49},'sales_staff_id':_0x3bc4e9,'sale_product.isFG':'false'}},{'$unwind':_0xa76f70(0xa3)},{'$match':{'sale_product.isFG':_0xa76f70(0x109)}},{'$lookup':{'from':_0xa76f70(0x127),'localField':_0xa76f70(0x129),'foreignField':_0xa76f70(0x165),'as':_0xa76f70(0x105)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0xa76f70(0x18a),'date':_0xa76f70(0x1e7),'customer':'$customer'},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0xa76f70(0xdb),'NetPrice':'$sale_product.totalprice','discount':'$sale_product.discount','adj_discount':_0xa76f70(0xe0),'product_details':{'prod_name':'$product_info.name','product_code':_0xa76f70(0x153),'category':'$product_info.category','brand':'$product_info.brand','gross_price':_0xa76f70(0x1df)}}}}},{'$unwind':_0xa76f70(0x1a3)},{'$group':{'_id':{'dsi':_0xa76f70(0x8c),'date':_0xa76f70(0x19a),'customer':'$_id.customer','category':_0xa76f70(0x19d),'brand':_0xa76f70(0x203)},'totalQty':{'$sum':_0xa76f70(0xe1)},'totalGross':{'$sum':{'$multiply':[_0xa76f70(0xe1),_0xa76f70(0x1af)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0xa76f70(0xc1)},'adj_discount':{'$sum':_0xa76f70(0x1dd)},'product_details':{'$first':_0xa76f70(0xea)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0xa76f70(0x19a),'customer':_0xa76f70(0x98)},'totalQty':{'$sum':_0xa76f70(0x16e)},'totalGross':{'$sum':_0xa76f70(0x17c)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0xa76f70(0xd2)},'adj_discount':{'$sum':_0xa76f70(0x1f0)},'products':{'$push':{'qty':_0xa76f70(0x16e),'category':_0xa76f70(0xfd),'brand':_0xa76f70(0xb8),'product_details':_0xa76f70(0x166)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x304604=[],_0x1c945e={},_0x2c5134={},_0x45bc33={};var _0x333b0e=0x0,_0xe8d494=0x0,_0xdda191=0x0,_0xb23aa5=0x0,_0x3f3e09=0x0;const _0x4504b0=0x9184e72a000;for(let _0x4eae18=0x0;_0x4eae18<=_0x77dccc['length']-0x1;_0x4eae18++){const _0x1f7197=_0x77dccc[_0x4eae18];let _0x1f2897=_0xa76f70(0xa6);_0x1f2897+=_0xa76f70(0x112)+_0x1f7197[_0xa76f70(0x9e)][_0xa76f70(0x167)]+_0xa76f70(0x140),_0x1f2897+=_0xa76f70(0x112)+_0x1f7197['_id']['date']+'</td>',_0x1f2897+=_0xa76f70(0x112)+_0x1f7197[_0xa76f70(0x9e)][_0xa76f70(0x1be)]+_0xa76f70(0x140);let _0x2865a6={};var _0x4546c0=0x0;for(let _0x507790=0x0;_0x507790<=_0x1f7197['products'][_0xa76f70(0x124)]-0x1;_0x507790++){const _0x2f6f9b=_0x1f7197[_0xa76f70(0x127)][_0x507790];_0x2865a6[_0x2f6f9b[_0xa76f70(0x1cd)]+'-'+_0x2f6f9b[_0xa76f70(0xbf)]]=_0x2f6f9b[_0xa76f70(0x14e)];const _0x587bbc=_0x2f6f9b[_0xa76f70(0x1cd)]+'-'+_0x2f6f9b[_0xa76f70(0xbf)];!_0x1c945e[_0x587bbc]&&(_0x1c945e[_0x587bbc]=0x0),!Array[_0xa76f70(0x117)](_0x45bc33[_0x587bbc])&&(_0x45bc33[_0x587bbc]=[]),!Array[_0xa76f70(0x117)](_0x45bc33[_0x587bbc])&&(_0x45bc33[_0x587bbc]=[]),_0x1c945e[_0x587bbc]+=_0x2f6f9b[_0xa76f70(0x14e)],_0x45bc33[_0x587bbc]['push'](_0x2f6f9b['qty']),_0x4546c0++;}console[_0xa76f70(0x10e)](_0x1f7197);for(let _0x4baf46=0x0;_0x4baf46<=_0x49b893[_0xa76f70(0x1e6)][_0xa76f70(0x124)]-0x1;_0x4baf46++){const _0x5171a0=_0x49b893[_0xa76f70(0x1e6)][_0x4baf46],_0x4a0f69=_0x5171a0[_0xa76f70(0x9e)][_0xa76f70(0x1cd)]+'-'+_0x5171a0[_0xa76f70(0x9e)][_0xa76f70(0xbf)];_0x1f2897+=_0xa76f70(0x1d7)+(_0x2865a6[_0x4a0f69]!==undefined?_0x2865a6[_0x4a0f69][_0xa76f70(0x1f6)](0x2):'')+_0xa76f70(0x140);}_0xdda191=_0x1f7197['discount']+_0x1f7197['adj_discount'],_0x1f2897+=_0xa76f70(0x158)+formatNumber(parseFloat(_0x1f7197[_0xa76f70(0x172)],0x2)[_0xa76f70(0x1f6)](0x2))+_0xa76f70(0x140),_0x1f2897+=_0xa76f70(0x158)+formatNumber(_0x1f7197[_0xa76f70(0xcf)]['toFixed'](0x2))+_0xa76f70(0x140),_0x1f2897+=_0xa76f70(0x158)+formatNumber(_0xdda191)+_0xa76f70(0x140),_0x1f2897+=_0xa76f70(0x158)+formatNumber(_0x1f7197[_0xa76f70(0xcc)]['toFixed'](0x2))+_0xa76f70(0x140),_0x1f2897+=_0xa76f70(0x93),_0x333b0e+=parseFloat(_0x1f7197[_0xa76f70(0x172)][_0xa76f70(0x1f6)](0x2)),_0xe8d494+=parseFloat(_0x1f7197['NetPrice']['toFixed'](0x2)),_0xb23aa5+=_0xdda191,_0x3f3e09+=parseFloat(_0x1f7197['totalGross'][_0xa76f70(0x1f6)](0x2));if(_0x4eae18==_0x77dccc[_0xa76f70(0x124)]-0x1){_0x1f2897+=_0xa76f70(0xa6),_0x1f2897+=_0xa76f70(0x1f7),_0x1f2897+=_0xa76f70(0x140);for(let _0x2138f4=0x0;_0x2138f4<=_0x49b893[_0xa76f70(0x1e6)][_0xa76f70(0x124)]-0x1;_0x2138f4++){const _0x4e4ca7=_0x49b893[_0xa76f70(0x1e6)][_0x2138f4],_0x51690e=_0x4e4ca7[_0xa76f70(0x9e)][_0xa76f70(0x1cd)]+'-'+_0x4e4ca7[_0xa76f70(0x9e)][_0xa76f70(0xbf)];!_0x45bc33[_0x51690e]&&(_0x45bc33[_0x51690e]=[]);const _0x2132b2=_0x45bc33[_0x51690e][_0xa76f70(0xd4)]((_0x2670b7,_0xced860)=>_0x2670b7+_0xced860,0x0);_0x1f2897+=_0xa76f70(0x9a)+(_0x2132b2!==undefined?formatNumber(_0x2132b2[_0xa76f70(0x1f6)](0x2)):'')+_0xa76f70(0x1e0),console[_0xa76f70(0x10e)](_0x45bc33[_0x51690e][_0xa76f70(0xd4)]((_0xf565fb,_0x2afb63)=>_0xf565fb+_0x2afb63,0x0));}_0x1f2897+=_0xa76f70(0xa8)+formatNumber(_0x333b0e[_0xa76f70(0x1f6)](0x2))+_0xa76f70(0x1e0),_0x1f2897+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x3f3e09)+_0xa76f70(0x1e0),_0x1f2897+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xb23aa5)+_0xa76f70(0x1e0),_0x1f2897+=_0xa76f70(0xa8)+formatNumber(_0xe8d494)+_0xa76f70(0x1e0),_0x1f2897+=_0xa76f70(0x93);}_0x304604[_0xa76f70(0x1f2)](_0x1f2897);}function _0x5b5f98(_0x33227e,_0x51b7cb){const _0x5af46a=_0xa76f70,_0x188c79=[];for(let _0x17b2cf=0x0;_0x17b2cf<=_0x33227e[_0x5af46a(0x124)]-0x1;_0x17b2cf+=_0x51b7cb){_0x188c79['push'](_0x33227e[_0x5af46a(0x193)](_0x17b2cf,_0x17b2cf+_0x51b7cb));}return _0x188c79;}const _0x5be87c=_0x5b5f98(_0x304604,_0x4504b0);let _0x2c24ad='';return _0x5be87c['forEach']((_0x195f53,_0x328ffa)=>{const _0x41b9fc=_0xa76f70;_0x328ffa>0x0&&(_0x2c24ad+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x2c24ad+='<table>',_0x2c24ad+='<thead>',_0x2c24ad+=_0x41b9fc(0xa6),_0x2c24ad+=_0x41b9fc(0x14b),_0x2c24ad+=_0x41b9fc(0x93),_0x2c24ad+='<tr>',_0x2c24ad+=_0x41b9fc(0xc4);for(let _0x49bd4f=0x0;_0x49bd4f<=_0x45eff7[_0x41b9fc(0x124)]-0x1;_0x49bd4f++){const _0x4bbdff=_0x45eff7[_0x49bd4f];for(let _0x338c08=0x0;_0x338c08<_0x5148b5[_0x41b9fc(0x124)];_0x338c08++){const _0x1f9904=_0x5148b5[_0x338c08];_0x1f9904[_0x41b9fc(0x9e)]===_0x4bbdff[_0x41b9fc(0x9e)][_0x41b9fc(0xbf)]&&(_0x2c24ad+=_0x41b9fc(0x12f)+_0x1f9904[_0x41b9fc(0x1f8)]+'\x22\x20class=\x22cat_data\x22>'+_0x4bbdff[_0x41b9fc(0x9e)]['category']+'</td>');}}_0x2c24ad+=_0x41b9fc(0x1bd),_0x2c24ad+=_0x41b9fc(0x93),_0x2c24ad+=_0x41b9fc(0xa6),_0x2c24ad+=_0x41b9fc(0xc6),_0x2c24ad+=_0x41b9fc(0xfe),_0x2c24ad+=_0x41b9fc(0x18d);for(let _0x2936b2=0x0;_0x2936b2<=_0x45eff7[_0x41b9fc(0x124)]-0x1;_0x2936b2++){const _0x43f97a=_0x45eff7[_0x2936b2];for(let _0x4f53ca=0x0;_0x4f53ca<_0x49b893[_0x41b9fc(0x1e6)][_0x41b9fc(0x124)];_0x4f53ca++){const _0x2bfa5e=_0x49b893[_0x41b9fc(0x1e6)][_0x4f53ca];_0x2bfa5e[_0x41b9fc(0x9e)][_0x41b9fc(0xbf)]===_0x43f97a[_0x41b9fc(0x9e)][_0x41b9fc(0xbf)]&&(_0x2c24ad+=_0x41b9fc(0x1b0)+_0x2bfa5e['_id'][_0x41b9fc(0x1cd)]+'</td>');}}_0x2c24ad+=_0x41b9fc(0x1e1),_0x2c24ad+=_0x41b9fc(0x16c),_0x2c24ad+=_0x41b9fc(0x16f),_0x2c24ad+=_0x41b9fc(0x181),_0x2c24ad+=_0x41b9fc(0x93),_0x2c24ad+=_0x41b9fc(0xc7),_0x2c24ad+=_0x41b9fc(0x212),_0x195f53[_0x41b9fc(0x1ff)](_0x5e6c0d=>{_0x2c24ad+=_0x5e6c0d;}),console[_0x41b9fc(0x10e)](_0x45bc33),_0x2c24ad+=_0x41b9fc(0x1a8),_0x2c24ad+='</table>';}),_0x2c24ad;}router['post'](a0_0x4e65fc(0x17e),auth,async(_0xffa789,_0xe6d0dd)=>{const _0x165edf=a0_0x4e65fc,{from_date:_0x280568,to_date:_0x1ff95b,isExcel:_0x50cda1}=_0xffa789['body'],_0x49a81e=_0xffa789[_0x165edf(0x209)],_0x821f9=await staff[_0x165edf(0x18c)]({'email':_0x49a81e[_0x165edf(0xac)]}),_0xcb5a70=await master_shop['find'](),_0x14c5b7=await agentsdataDSICheck(_0x280568,_0x1ff95b,_0x821f9['_id'][_0x165edf(0xb6)](),_0x50cda1),_0x2c1cd5=await agentsdataDSICheck_excel(_0x280568,_0x1ff95b,_0x821f9[_0x165edf(0x9e)][_0x165edf(0xb6)](),_0x50cda1);let _0x5b3f30=_0x165edf(0x146);var _0xccf37f=new Date(_0x280568),_0x3a5de9=new Date(_0x1ff95b);const _0x2aff49={'year':_0x165edf(0x118),'month':'long','day':_0x165edf(0x118)},_0x3d5256=new Intl['DateTimeFormat']('en-US',_0x2aff49)[_0x165edf(0xd1)](_0xccf37f),_0x2f65cb=new Intl[(_0x165edf(0x1a9))](_0x165edf(0x13e),_0x2aff49)[_0x165edf(0xd1)](_0x3a5de9);_0x5b3f30+=_0x165edf(0x151),_0x5b3f30+=_0x165edf(0x1b9),_0x5b3f30+=_0x165edf(0x19e),_0x5b3f30+=_0x14c5b7,_0x5b3f30+=_0x165edf(0x1c1),_0x5b3f30+=_0x165edf(0x96),_0x5b3f30+='</div>';let _0x5d3125=_0x165edf(0x146);_0x5d3125+='<div\x20class=\x22row\x22>',_0x5d3125+='<div\x20\x20id=\x22table-conatainer\x22>',_0x5d3125+='<table>',_0x5d3125+=_0x2c1cd5,_0x5d3125+='</table>',_0x5d3125+=_0x165edf(0x96),_0x5d3125+=_0x165edf(0x96);let _0x5bc3e4=_0x165edf(0xb5);const _0x2210da={'width':_0x165edf(0x99),'height':_0x165edf(0x128),'orientation':_0x165edf(0x180),'border':{'top':_0x165edf(0xd5),'right':_0x165edf(0xd5),'bottom':_0x165edf(0xd5),'left':_0x165edf(0xd5)},'header':{'height':'60mm','contents':_0x165edf(0x9d)+_0x5bc3e4+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+_0x3d5256+'\x20-\x20'+_0x2f65cb+_0x165edf(0xda)},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x165edf(0x170)}}};if(_0x50cda1=='on'){const _0x1992be=cheerio[_0x165edf(0xdd)](_0x5d3125);let _0x192b8c=[],_0x362beb=[],_0x50cf18=[];const _0x5f3768=_0x3cf41f=>{const _0x586ff8=_0x165edf,_0x26c581={'top':{'style':_0x586ff8(0x12e),'color':{'rgb':'000000'}},'bottom':{'style':_0x586ff8(0x12e),'color':{'rgb':_0x586ff8(0xd9)}},'left':{'style':_0x586ff8(0x12e),'color':{'rgb':_0x586ff8(0xd9)}},'right':{'style':_0x586ff8(0x12e),'color':{'rgb':'000000'}}};if(_0x3cf41f){const _0x241a3b=_0x3cf41f[_0x586ff8(0x15d)](';')[_0x586ff8(0xd4)]((_0x18d60f,_0x3cc012)=>{const _0x415116=_0x586ff8,[_0x487773,_0x2d49f6]=_0x3cc012[_0x415116(0x15d)](':')[_0x415116(0xc3)](_0x126273=>_0x126273['trim']());return _0x18d60f[_0x487773]=_0x2d49f6,_0x18d60f;},{});_0x241a3b[_0x586ff8(0x157)]&&(_0x26c581[_0x586ff8(0x12b)][_0x586ff8(0x15a)]=_0x241a3b['border-top'][_0x586ff8(0xa1)](_0x586ff8(0x122))?_0x586ff8(0x122):_0x586ff8(0x9b)),_0x241a3b['border-bottom']&&(_0x26c581[_0x586ff8(0xaf)][_0x586ff8(0x15a)]=_0x241a3b[_0x586ff8(0x131)][_0x586ff8(0xa1)]('thin')?_0x586ff8(0x122):'medium'),_0x241a3b[_0x586ff8(0x91)]&&(_0x26c581['left'][_0x586ff8(0x15a)]=_0x241a3b[_0x586ff8(0x91)][_0x586ff8(0xa1)]('thin')?_0x586ff8(0x122):_0x586ff8(0x9b)),_0x241a3b['border-right']&&(_0x26c581[_0x586ff8(0x18b)][_0x586ff8(0x15a)]=_0x241a3b[_0x586ff8(0xf0)][_0x586ff8(0xa1)](_0x586ff8(0x122))?_0x586ff8(0x122):_0x586ff8(0x9b));}return _0x26c581;};_0x1992be(_0x165edf(0x13a))['each']((_0x2651fb,_0x133dee)=>{const _0x581b72=_0x165edf;let _0x278a77=[],_0x308193=0x0;while(_0x50cf18[_0x308193]){_0x50cf18[_0x308193]--,_0x308193++;}_0x1992be(_0x133dee)['find'](_0x581b72(0x1d4))[_0x581b72(0x1eb)]((_0x55313c,_0x3e231c)=>{const _0x405d40=_0x581b72;let _0x3111bb=_0x1992be(_0x3e231c)[_0x405d40(0xe3)]()[_0x405d40(0xde)](),_0x4e7994=parseFloat(_0x3111bb[_0x405d40(0x1b2)](/,/g,'')),_0x10632c={};!isNaN(_0x4e7994)?(_0x10632c['v']=_0x4e7994,_0x10632c['t']='n'):(_0x10632c['v']=_0x3111bb,_0x10632c['t']='s');const _0x172b51=_0x1992be(_0x3e231c)[_0x405d40(0xdf)](_0x405d40(0x15a)),_0x596c1e=_0x5f3768(_0x172b51);_0x10632c['s']={'border':_0x596c1e},_0x278a77[_0x308193]=_0x10632c;let _0x2c034b=parseInt(_0x1992be(_0x3e231c)[_0x405d40(0xdf)](_0x405d40(0x1e2)))||0x1,_0x4a2466=parseInt(_0x1992be(_0x3e231c)['attr']('rowspan'))||0x1;(_0x2c034b>0x1||_0x4a2466>0x1)&&_0x362beb[_0x405d40(0x1f2)]({'s':{'r':_0x2651fb,'c':_0x308193},'e':{'r':_0x2651fb+_0x4a2466-0x1,'c':_0x308193+_0x2c034b-0x1}});for(let _0x1a83ed=0x0;_0x1a83ed<_0x2c034b;_0x1a83ed++){_0x4a2466>0x1&&(_0x50cf18[_0x308193+_0x1a83ed]=_0x4a2466-0x1);}_0x308193+=_0x2c034b;}),_0x192b8c[_0x581b72(0x1f2)](_0x278a77);});const _0x48d386=XLSX[_0x165edf(0x149)][_0x165edf(0xff)](),_0x196fcc=XLSX['utils'][_0x165edf(0x164)](_0x192b8c);_0x362beb[_0x165edf(0x124)]>0x0&&(_0x196fcc[_0x165edf(0x187)]=_0x362beb);_0x196fcc[_0x165edf(0x204)]=_0x192b8c[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x165edf(0x149)]['book_append_sheet'](_0x48d386,_0x196fcc,'Sales\x20Report');const _0x2ec006=XLSX[_0x165edf(0x20d)](_0x48d386,{'bookType':_0x165edf(0x190),'type':_0x165edf(0x177)});_0xe6d0dd[_0x165edf(0xba)](_0x165edf(0x13f),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0xe6d0dd[_0x165edf(0xba)](_0x165edf(0xa7),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0xe6d0dd['send'](_0x2ec006);}else pdf[_0x165edf(0x90)](_0x5b3f30,_0x2210da)[_0x165edf(0xed)](function(_0x2395a4,_0xce4664){const _0x1d2d39=_0x165edf;if(_0x2395a4){console[_0x1d2d39(0x1e3)](_0x1d2d39(0x173),_0x2395a4),_0xe6d0dd[_0x1d2d39(0x16b)](0x1f4)[_0x1d2d39(0x110)](_0x1d2d39(0x1ac)+_0x2395a4);return;}_0xe6d0dd[_0x1d2d39(0xba)]('Content-Type','application/pdf'),_0xce4664['pipe'](_0xe6d0dd);});}),router[a0_0x4e65fc(0x14c)](a0_0x4e65fc(0x10b),auth,async(_0x1e2a54,_0x1d1673)=>{const _0x11dba9=a0_0x4e65fc;try{const {username:_0x1aa02d,email:_0x281f8f,role:_0x27d83a}=_0x1e2a54[_0x11dba9(0x209)],_0x5c8b14=_0x1e2a54[_0x11dba9(0x209)],_0x41bed3=await profile['findOne']({'email':_0x5c8b14[_0x11dba9(0xac)]}),_0x1b0147={'year':_0x11dba9(0x118),'month':_0x11dba9(0x11f),'day':'numeric'},_0x14755a=await master_shop['find'](),_0x52efa9=await product[_0x11dba9(0x179)](),_0x8d905a=await warehouse[_0x11dba9(0x14a)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x11dba9(0x1e4),'foreignField':_0x11dba9(0x205),'as':'product_docs'}},{'$unwind':_0x11dba9(0xfc)},{'$project':{'product_name':_0x11dba9(0x1dc),'product_stock':_0x11dba9(0x136)}},{'$group':{'_id':_0x11dba9(0x130),'product_stock':{'$sum':_0x11dba9(0x174)}}}]),_0x4eb301=await staff[_0x11dba9(0x18c)]({'email':_0x5c8b14[_0x11dba9(0xac)]});if(_0x14755a[0x0][_0x11dba9(0x186)]==_0x11dba9(0x1b7))var _0x53a24f=users[_0x11dba9(0x202)];else{if(_0x14755a[0x0][_0x11dba9(0x186)]=='Hindi')var _0x53a24f=users[_0x11dba9(0xf1)];else{if(_0x14755a[0x0][_0x11dba9(0x186)]==_0x11dba9(0xc9))var _0x53a24f=users[_0x11dba9(0xc9)];else{if(_0x14755a[0x0][_0x11dba9(0x186)]==_0x11dba9(0x1e8))var _0x53a24f=users[_0x11dba9(0x1e8)];else{if(_0x14755a[0x0]['language']==_0x11dba9(0x1fd))var _0x53a24f=users[_0x11dba9(0x1fd)];else{if(_0x14755a[0x0]['language']==_0x11dba9(0x8e))var _0x53a24f=users[_0x11dba9(0xf8)];else{if(_0x14755a[0x0][_0x11dba9(0x186)]==_0x11dba9(0x100))var _0x53a24f=users[_0x11dba9(0x100)];else{if(_0x14755a[0x0][_0x11dba9(0x186)]=='Arabic\x20(ae)')var _0x53a24f=users['Arabic'];}}}}}}}_0x1d1673[_0x11dba9(0xb7)](_0x11dba9(0x210),{'success':_0x1e2a54[_0x11dba9(0x120)](_0x11dba9(0x8a)),'errors':_0x1e2a54[_0x11dba9(0x120)](_0x11dba9(0x197)),'alldata':_0x52efa9,'profile':_0x41bed3,'master_shop':_0x14755a,'role':_0x5c8b14,'product_stock':_0x8d905a,'language':_0x53a24f,'staff_arr':_0x4eb301});}catch(_0x1cabc7){}});async function dataSalesReports(_0x24b520,_0x175f64,_0x578754){const _0x32700d=a0_0x4e65fc;let _0xf3970f='';const _0x2b0630=await sales_sa[_0x32700d(0x14a)]([{'$match':{'date':{'$gte':_0x24b520,'$lte':_0x175f64},'sales_staff_id':_0x578754}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x32700d(0x109)}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x32700d(0x134)},'sumqty':{'$sum':_0x32700d(0xdb)},'totalPrice':{'$sum':_0x32700d(0xa5)}}},{'$sort':{'_id.product_name':0x1}}]);var _0x48d432=0x0,_0x40c28b=0x0;for(let _0x525ac6=0x0;_0x525ac6<=_0x2b0630[_0x32700d(0x124)]-0x1;_0x525ac6++){const _0x4710b7=_0x2b0630[_0x525ac6];var _0x599115=_0x4710b7[_0x32700d(0x188)][_0x32700d(0xb2)](undefined),_0x387562=_0x4710b7[_0x32700d(0xa2)][_0x32700d(0xb2)](undefined);_0xf3970f+=_0x32700d(0xa6),_0xf3970f+=_0x32700d(0x137)+_0x4710b7[_0x32700d(0x9e)][_0x32700d(0x165)]+_0x32700d(0x140),_0xf3970f+=_0x32700d(0x137)+_0x4710b7[_0x32700d(0x9e)][_0x32700d(0x11a)]+_0x32700d(0x140),_0xf3970f+=_0x32700d(0x137)+formatNumber(_0x4710b7[_0x32700d(0xa2)][_0x32700d(0x1f6)](0x2))+_0x32700d(0x140),_0xf3970f+=_0x32700d(0x137)+formatNumber(_0x4710b7[_0x32700d(0x188)][_0x32700d(0x1f6)](0x2))+'</td>',_0xf3970f+=_0x32700d(0x93),_0x48d432+=parseFloat(_0x4710b7[_0x32700d(0xa2)]),_0x40c28b+=parseFloat(_0x4710b7[_0x32700d(0x188)]);}var _0x5069b8=_0x40c28b[_0x32700d(0xb2)](undefined),_0xc22df3=_0x48d432[_0x32700d(0xb2)](undefined);return _0xf3970f+=_0x32700d(0xa6),_0xf3970f+=_0x32700d(0x1e5),_0xf3970f+=_0x32700d(0x1ca)+formatNumber(_0x48d432[_0x32700d(0x1f6)](0x2))+_0x32700d(0x1e0),_0xf3970f+=_0x32700d(0x1ca)+formatNumber(_0x40c28b['toFixed'](0x2))+_0x32700d(0x1e0),_0xf3970f+=_0x32700d(0x93),_0xf3970f;}router[a0_0x4e65fc(0xfb)]('/total_sales_reports/pdf',auth,async(_0x50664c,_0x5ac4ef)=>{const _0x3246d1=a0_0x4e65fc;try{const {from_date:_0x45de41,to_date:_0x301c83,isExcel:_0x37614f}=_0x50664c['body'],_0x121275=_0x50664c[_0x3246d1(0x209)],_0x44ecb3=await staff[_0x3246d1(0x18c)]({'email':_0x121275[_0x3246d1(0xac)]});let _0x2a53eb=_0x3246d1(0x198);var _0x10c9ab=new Date(_0x45de41),_0x5f3da7=new Date(_0x301c83);const _0x29d9ce={'year':_0x3246d1(0x118),'month':_0x3246d1(0x11f),'day':_0x3246d1(0x118)},_0x3b8b4f=new Intl['DateTimeFormat']('en-US',_0x29d9ce)[_0x3246d1(0xd1)](_0x10c9ab),_0x50c715=new Intl[(_0x3246d1(0x1a9))](_0x3246d1(0x13e),_0x29d9ce)['format'](_0x5f3da7);var _0x50af73=await dataSalesReports(_0x45de41,_0x301c83,_0x44ecb3[_0x3246d1(0x9e)]['valueOf']());_0x2a53eb+=_0x3246d1(0x151),_0x2a53eb+='<div\x20class=\x22col-sm-11\x22>',_0x2a53eb+=_0x3246d1(0x19e),_0x2a53eb+=_0x3246d1(0xa6),_0x2a53eb+='<th>\x20ITEM\x20CODE\x20</th>',_0x2a53eb+=_0x3246d1(0x1bc),_0x2a53eb+=_0x3246d1(0x1b8),_0x2a53eb+='<th>\x20INVOICE\x20AMOUNT\x20</th>',_0x2a53eb+=_0x3246d1(0xa6),_0x2a53eb+=_0x50af73,_0x2a53eb+=_0x3246d1(0x93),_0x2a53eb+='</div>',_0x2a53eb+=_0x3246d1(0x96);let _0x3a6b8d=_0x3246d1(0xb5);const _0x89aaf0={'width':_0x3246d1(0x99),'height':_0x3246d1(0x128),'orientation':'landscape','border':{'top':_0x3246d1(0xd5),'right':'0.1in','bottom':_0x3246d1(0xd5),'left':'0.1in'},'header':{'height':_0x3246d1(0x17b),'contents':_0x3246d1(0x9d)+_0x3a6b8d+'\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>'+_0x44ecb3[_0x3246d1(0x205)]+_0x3246d1(0xf6)+_0x3b8b4f+'\x20-\x20'+_0x50c715+_0x3246d1(0xda)},'footer':{'height':_0x3246d1(0xa0),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x37614f=='on'){const _0x25b8a4=cheerio[_0x3246d1(0xdd)](_0x2a53eb);let _0x191eb2=[],_0x1efef3=[],_0x4123de=[];const _0xc786b6=_0xebb4db=>{const _0x28b16d=_0x3246d1,_0x5b4758={'top':{'style':_0x28b16d(0x12e),'color':{'rgb':_0x28b16d(0xd9)}},'bottom':{'style':_0x28b16d(0x12e),'color':{'rgb':_0x28b16d(0xd9)}},'left':{'style':_0x28b16d(0x12e),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x28b16d(0xd9)}}};if(_0xebb4db){const _0x2e05a3=_0xebb4db['split'](';')['reduce']((_0x16827e,_0x10ea36)=>{const _0x107f8a=_0x28b16d,[_0x6b63bf,_0x104163]=_0x10ea36['split'](':')[_0x107f8a(0xc3)](_0x5cd33f=>_0x5cd33f[_0x107f8a(0xde)]());return _0x16827e[_0x6b63bf]=_0x104163,_0x16827e;},{});_0x2e05a3[_0x28b16d(0x157)]&&(_0x5b4758[_0x28b16d(0x12b)][_0x28b16d(0x15a)]=_0x2e05a3[_0x28b16d(0x157)]['includes'](_0x28b16d(0x122))?'thin':_0x28b16d(0x9b)),_0x2e05a3[_0x28b16d(0x131)]&&(_0x5b4758[_0x28b16d(0xaf)][_0x28b16d(0x15a)]=_0x2e05a3[_0x28b16d(0x131)][_0x28b16d(0xa1)]('thin')?_0x28b16d(0x122):_0x28b16d(0x9b)),_0x2e05a3[_0x28b16d(0x91)]&&(_0x5b4758[_0x28b16d(0x15b)][_0x28b16d(0x15a)]=_0x2e05a3['border-left']['includes'](_0x28b16d(0x122))?_0x28b16d(0x122):'medium'),_0x2e05a3['border-right']&&(_0x5b4758[_0x28b16d(0x18b)]['style']=_0x2e05a3[_0x28b16d(0xf0)][_0x28b16d(0xa1)](_0x28b16d(0x122))?_0x28b16d(0x122):_0x28b16d(0x9b));}return _0x5b4758;};_0x25b8a4('table\x20tr')['each']((_0x3dc563,_0x47bcfa)=>{const _0x56b584=_0x3246d1;let _0x46c49e=[],_0x393a60=0x0;while(_0x4123de[_0x393a60]){_0x4123de[_0x393a60]--,_0x393a60++;}_0x25b8a4(_0x47bcfa)[_0x56b584(0x179)](_0x56b584(0x1d4))[_0x56b584(0x1eb)]((_0x3f083f,_0x26942c)=>{const _0x5b34db=_0x56b584;let _0x551146=_0x25b8a4(_0x26942c)[_0x5b34db(0xe3)]()[_0x5b34db(0xde)](),_0x433ba6=parseFloat(_0x551146[_0x5b34db(0x1b2)](/,/g,'')),_0x5381ed={};!isNaN(_0x433ba6)?(_0x5381ed['v']=_0x433ba6,_0x5381ed['t']='n'):(_0x5381ed['v']=_0x551146,_0x5381ed['t']='s');const _0xd71d08=_0x25b8a4(_0x26942c)['attr'](_0x5b34db(0x15a)),_0x1b1d7b=_0xc786b6(_0xd71d08);_0x5381ed['s']={'border':_0x1b1d7b},_0x46c49e[_0x393a60]=_0x5381ed;let _0x1b62cc=parseInt(_0x25b8a4(_0x26942c)[_0x5b34db(0xdf)](_0x5b34db(0x1e2)))||0x1,_0x5efbe6=parseInt(_0x25b8a4(_0x26942c)['attr'](_0x5b34db(0x1a2)))||0x1;(_0x1b62cc>0x1||_0x5efbe6>0x1)&&_0x1efef3[_0x5b34db(0x1f2)]({'s':{'r':_0x3dc563,'c':_0x393a60},'e':{'r':_0x3dc563+_0x5efbe6-0x1,'c':_0x393a60+_0x1b62cc-0x1}});for(let _0xb54160=0x0;_0xb54160<_0x1b62cc;_0xb54160++){_0x5efbe6>0x1&&(_0x4123de[_0x393a60+_0xb54160]=_0x5efbe6-0x1);}_0x393a60+=_0x1b62cc;}),_0x191eb2[_0x56b584(0x1f2)](_0x46c49e);});const _0x4d05a8=XLSX[_0x3246d1(0x149)][_0x3246d1(0xff)](),_0x1e1d1e=XLSX[_0x3246d1(0x149)][_0x3246d1(0x164)](_0x191eb2);_0x1efef3[_0x3246d1(0x124)]>0x0&&(_0x1e1d1e[_0x3246d1(0x187)]=_0x1efef3);_0x1e1d1e[_0x3246d1(0x204)]=_0x191eb2[0x0][_0x3246d1(0xc3)](()=>({'wpx':0x64})),XLSX[_0x3246d1(0x149)][_0x3246d1(0x18e)](_0x4d05a8,_0x1e1d1e,_0x3246d1(0x138));const _0x2d76c8=XLSX[_0x3246d1(0x20d)](_0x4d05a8,{'bookType':_0x3246d1(0x190),'type':_0x3246d1(0x177)});_0x5ac4ef[_0x3246d1(0xba)](_0x3246d1(0x13f),_0x3246d1(0xd7)),_0x5ac4ef[_0x3246d1(0xba)](_0x3246d1(0xa7),_0x3246d1(0x184)),_0x5ac4ef[_0x3246d1(0x110)](_0x2d76c8);}else pdf[_0x3246d1(0x90)](_0x2a53eb,_0x89aaf0)[_0x3246d1(0xed)](function(_0x43ec1c,_0x29c281){const _0x5dee7c=_0x3246d1;if(_0x43ec1c){_0x5ac4ef[_0x5dee7c(0x16b)](0x1f4)[_0x5dee7c(0x110)](_0x5dee7c(0x1ac));return;}_0x5ac4ef[_0x5dee7c(0xba)](_0x5dee7c(0xa7),_0x5dee7c(0x1db)),_0x29c281['pipe'](_0x5ac4ef);});}catch(_0xd7fd48){}}),router[a0_0x4e65fc(0x14c)]('/inventory_sum/view',auth,async(_0x5c46d5,_0x1dcbe3)=>{const _0x17bf90=a0_0x4e65fc;try{const {username:_0x3879d8,email:_0x16ced4,role:_0x5233d9}=_0x5c46d5['user'],_0x55acaf=_0x5c46d5[_0x17bf90(0x209)],_0x2d73ca=await profile[_0x17bf90(0x18c)]({'email':_0x55acaf[_0x17bf90(0xac)]}),_0x1d82c3={'year':'numeric','month':'long','day':_0x17bf90(0x118)},_0x3d415b=await master_shop[_0x17bf90(0x179)](),_0x6df5be=await product[_0x17bf90(0x179)](),_0x3ec65b=await warehouse[_0x17bf90(0x14a)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x17bf90(0x127),'localField':'product_details.product_name','foreignField':_0x17bf90(0x205),'as':'product_docs'}},{'$unwind':_0x17bf90(0xfc)},{'$project':{'product_name':_0x17bf90(0x1dc),'product_stock':_0x17bf90(0x136)}},{'$group':{'_id':_0x17bf90(0x130),'product_stock':{'$sum':_0x17bf90(0x174)}}}]);if(_0x3d415b[0x0][_0x17bf90(0x186)]=='English\x20(US)')var _0x284dd5=users[_0x17bf90(0x202)];else{if(_0x3d415b[0x0][_0x17bf90(0x186)]==_0x17bf90(0xf1))var _0x284dd5=users[_0x17bf90(0xf1)];else{if(_0x3d415b[0x0][_0x17bf90(0x186)]=='German')var _0x284dd5=users[_0x17bf90(0xc9)];else{if(_0x3d415b[0x0][_0x17bf90(0x186)]==_0x17bf90(0x1e8))var _0x284dd5=users['Spanish'];else{if(_0x3d415b[0x0][_0x17bf90(0x186)]=='French')var _0x284dd5=users[_0x17bf90(0x1fd)];else{if(_0x3d415b[0x0][_0x17bf90(0x186)]==_0x17bf90(0x8e))var _0x284dd5=users[_0x17bf90(0xf8)];else{if(_0x3d415b[0x0][_0x17bf90(0x186)]=='Chinese')var _0x284dd5=users[_0x17bf90(0x100)];else{if(_0x3d415b[0x0][_0x17bf90(0x186)]=='Arabic\x20(ae)')var _0x284dd5=users[_0x17bf90(0x1cb)];}}}}}}}_0x1dcbe3[_0x17bf90(0xb7)](_0x17bf90(0x15f),{'success':_0x5c46d5['flash'](_0x17bf90(0x8a)),'errors':_0x5c46d5[_0x17bf90(0x120)](_0x17bf90(0x197)),'alldata':_0x6df5be,'profile':_0x2d73ca,'master_shop':_0x3d415b,'role':_0x55acaf,'product_stock':_0x3ec65b,'language':_0x284dd5});}catch(_0xb71d17){}});async function dataInventoryReports(_0x42d31c,_0x3aec73,_0x3e6b6f){const _0x126018=a0_0x4e65fc,_0x519454=await sales_sa[_0x126018(0x14a)]([{'$match':{'date':{'$gte':_0x42d31c,'$lte':_0x3aec73},'sales_staff_id':_0x3e6b6f}},{'$unwind':_0x126018(0xa3)},{'$group':{'_id':{'product_name':_0x126018(0x155),'product_code':_0x126018(0x134)},'sumqty':{'$sum':_0x126018(0x1f3)}}},{'$sort':{'_id.product_name':0x1}}]),_0x3e3e04=mongoose[_0x126018(0x101)][_0x126018(0x125)],_0x57f590=await staff[_0x126018(0x14a)]([{'$match':{'_id':_0x3e3e04(_0x3e6b6f)}},{'$unwind':_0x126018(0x189)},{'$match':{'product_list.isConfirm':_0x126018(0xe5)}},{'$group':{'_id':{'product_name':_0x126018(0x1b5),'product_code':_0x126018(0x159)},'sumqty':{'$sum':_0x126018(0xb0)}}},{'$sort':{'_id.product_name':0x1}}]),_0x308b1d=await sales_inv_data[_0x126018(0x14a)]([{'$match':{'date':{'$gte':_0x42d31c,'$lte':_0x3aec73},'sales_staff_id':_0x3e6b6f}},{'$unwind':_0x126018(0xa3)},{'$group':{'_id':{'product_name':_0x126018(0x155),'product_code':_0x126018(0x134)},'totalQTYsum':{'$sum':'$sale_product.stock'}}}]);console['log'](_0x308b1d);let _0x4f729f='';var _0x8e2d6f=0x0;for(let _0x2d0c17=0x0;_0x2d0c17<=_0x57f590[_0x126018(0x124)]-0x1;_0x2d0c17++){const _0x5013d5=_0x57f590[_0x2d0c17];_0x4f729f+=_0x126018(0xa6),_0x4f729f+=_0x126018(0x113)+_0x5013d5[_0x126018(0x9e)][_0x126018(0x165)]+'</td>',_0x4f729f+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>'+_0x5013d5[_0x126018(0x9e)][_0x126018(0x11a)]+'</td>';var _0xab818e=_0x5013d5[_0x126018(0xa2)],_0x572c74=0x0;for(let _0x2ca8d3=0x0;_0x2ca8d3<=_0x519454['length']-0x1;_0x2ca8d3++){const _0x2758e6=_0x519454[_0x2ca8d3];_0x5013d5[_0x126018(0x9e)][_0x126018(0x165)]==_0x2758e6[_0x126018(0x9e)][_0x126018(0x165)]&&_0x5013d5[_0x126018(0x9e)]['product_name']==_0x2758e6[_0x126018(0x9e)][_0x126018(0x11a)]&&(_0x572c74=_0x2758e6[_0x126018(0xa2)]);}var _0x44bd0e=0x0;for(let _0x6bbf7b=0x0;_0x6bbf7b<=_0x308b1d['length']-0x1;_0x6bbf7b++){const _0x1359b9=_0x308b1d[_0x6bbf7b];_0x5013d5[_0x126018(0x9e)][_0x126018(0x165)]==_0x1359b9[_0x126018(0x9e)][_0x126018(0x165)]&&_0x5013d5[_0x126018(0x9e)][_0x126018(0x11a)]==_0x1359b9['_id'][_0x126018(0x11a)]&&(_0x44bd0e=_0x1359b9['totalQTYsum']);}_0x8e2d6f=_0xab818e-_0x44bd0e+_0x572c74,_0x4f729f+=_0x126018(0x137)+_0x8e2d6f+_0x126018(0x140);let _0x382871=![];for(let _0x34aec0=0x0;_0x34aec0<=_0x308b1d[_0x126018(0x124)]-0x1;_0x34aec0++){const _0x11e06b=_0x308b1d[_0x34aec0];if(_0x5013d5[_0x126018(0x9e)]['product_code']==_0x11e06b[_0x126018(0x9e)][_0x126018(0x165)]&&_0x5013d5['_id'][_0x126018(0x11a)]==_0x11e06b[_0x126018(0x9e)][_0x126018(0x11a)]){_0x4f729f+=_0x126018(0x137)+_0x11e06b['totalQTYsum']+_0x126018(0x140),_0x382871=!![];break;}}!_0x382871&&(_0x4f729f+=_0x126018(0x106));let _0x2b0cf7=![];for(let _0x1b34f4=0x0;_0x1b34f4<=_0x519454[_0x126018(0x124)]-0x1;_0x1b34f4++){const _0x2463f3=_0x519454[_0x1b34f4];if(_0x5013d5[_0x126018(0x9e)][_0x126018(0x165)]==_0x2463f3[_0x126018(0x9e)]['product_code']&&_0x5013d5[_0x126018(0x9e)][_0x126018(0x11a)]==_0x2463f3['_id'][_0x126018(0x11a)]){_0x4f729f+='<td\x20class=\x22row_data\x22>'+_0x2463f3[_0x126018(0xa2)]+_0x126018(0x140),_0x2b0cf7=!![];break;}}!_0x2b0cf7&&(_0x4f729f+=_0x126018(0x106)),_0x4f729f+=_0x126018(0x137)+_0x5013d5[_0x126018(0xa2)]+_0x126018(0x140),_0x4f729f+='</tr>';}return _0x4f729f;}router[a0_0x4e65fc(0xfb)](a0_0x4e65fc(0x8b),auth,async(_0x5933df,_0x19e3c6)=>{const _0x3473b4=a0_0x4e65fc;try{const {from_date:_0x34c2ec,to_date:_0x402a71}=_0x5933df[_0x3473b4(0xbe)],_0x5884b8=_0x5933df['user'],_0x2c62d9=await staff[_0x3473b4(0x18c)]({'email':_0x5884b8[_0x3473b4(0xac)]});let _0x3d1a9a=_0x3473b4(0x198);var _0x3ca14b=new Date(_0x34c2ec),_0x97da12=new Date(_0x402a71);const _0x1a39b6={'year':_0x3473b4(0x118),'month':_0x3473b4(0x11f),'day':_0x3473b4(0x118)},_0x4bc02d=new Intl[(_0x3473b4(0x1a9))](_0x3473b4(0x13e),_0x1a39b6)[_0x3473b4(0xd1)](_0x3ca14b),_0x3d49c9=new Intl['DateTimeFormat']('en-US',_0x1a39b6)['format'](_0x97da12);var _0x4d2945=await dataInventoryReports(_0x34c2ec,_0x402a71,_0x2c62d9['_id'][_0x3473b4(0xb6)]());_0x3d1a9a+=_0x3473b4(0xca),_0x3d1a9a+=_0x3473b4(0x168),_0x3d1a9a+=_0x3473b4(0xbc)+_0x4bc02d+_0x3473b4(0x97)+_0x3d49c9+_0x3473b4(0x16a),_0x3d1a9a+=_0x3473b4(0x151),_0x3d1a9a+=_0x3473b4(0x123),_0x3d1a9a+=_0x3473b4(0x19e),_0x3d1a9a+=_0x3473b4(0xa6),_0x3d1a9a+='<th>\x20ITEM\x20CODE\x20</th>',_0x3d1a9a+=_0x3473b4(0x1bc),_0x3d1a9a+=_0x3473b4(0x1b6),_0x3d1a9a+=_0x3473b4(0x1ec),_0x3d1a9a+='<th>\x20SALES\x20</th>',_0x3d1a9a+=_0x3473b4(0x211),_0x3d1a9a+=_0x3473b4(0xa6),_0x3d1a9a+=_0x4d2945,_0x3d1a9a+=_0x3473b4(0x93),_0x3d1a9a+=_0x3473b4(0x96),_0x3d1a9a+=_0x3473b4(0x96);const _0x4191e4={'format':_0x3473b4(0x1a4),'orientation':_0x3473b4(0x180),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x3473b4(0x170)}}};pdf[_0x3473b4(0x90)](_0x3d1a9a,_0x4191e4)['toStream'](function(_0x533c5b,_0x23fc57){const _0x26261a=_0x3473b4;if(_0x533c5b){_0x19e3c6[_0x26261a(0x16b)](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x19e3c6[_0x26261a(0xba)]('Content-Type',_0x26261a(0x1db)),_0x23fc57[_0x26261a(0x143)](_0x19e3c6);});}catch(_0x257659){}}),router[a0_0x4e65fc(0x14c)]('/dsrr/view',auth,async(_0x4cfd69,_0xe045f9)=>{const _0x558cfd=a0_0x4e65fc;try{const {username:_0x1b3d88,email:_0x1aa53e,role:_0x4f0e85}=_0x4cfd69[_0x558cfd(0x209)],_0x4c0b81=_0x4cfd69[_0x558cfd(0x209)],_0x267ff6=await profile[_0x558cfd(0x18c)]({'email':_0x4c0b81[_0x558cfd(0xac)]}),_0x34cca8={'year':_0x558cfd(0x118),'month':_0x558cfd(0x11f),'day':_0x558cfd(0x118)},_0x583644=await master_shop[_0x558cfd(0x179)]();console['log'](_0x558cfd(0x1fa),_0x583644);const _0x254b2c=await product[_0x558cfd(0x179)]();console[_0x558cfd(0x10e)](_0x558cfd(0x19f),_0x254b2c);const _0x4f8aae=await warehouse['aggregate']([{'$unwind':_0x558cfd(0x166)},{'$lookup':{'from':_0x558cfd(0x127),'localField':_0x558cfd(0x1e4),'foreignField':'name','as':_0x558cfd(0x1d5)}},{'$unwind':_0x558cfd(0xfc)},{'$project':{'product_name':_0x558cfd(0x1dc),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x558cfd(0x174)}}}]);console[_0x558cfd(0x10e)](_0x558cfd(0xf5),_0x4f8aae),_0x4f8aae['forEach'](_0x19a59b=>{const _0xce27b4=_0x558cfd,_0x2d4792=_0x254b2c[_0xce27b4(0xc3)](_0x544c82=>{const _0x249786=_0xce27b4;_0x544c82[_0x249786(0x205)]==_0x19a59b[_0x249786(0x9e)]&&(_0x544c82[_0x249786(0x148)]=parseInt(_0x544c82[_0x249786(0x148)])+parseInt(_0x19a59b[_0x249786(0x200)]));});});const _0x27e3d7=await staff[_0x558cfd(0x18c)]({'email':_0x4c0b81['email']});if(_0x583644[0x0]['language']==_0x558cfd(0x1b7))var _0x2ded95=users['English'];else{if(_0x583644[0x0][_0x558cfd(0x186)]==_0x558cfd(0xf1))var _0x2ded95=users['Hindi'];else{if(_0x583644[0x0][_0x558cfd(0x186)]==_0x558cfd(0xc9))var _0x2ded95=users[_0x558cfd(0xc9)];else{if(_0x583644[0x0][_0x558cfd(0x186)]==_0x558cfd(0x1e8))var _0x2ded95=users[_0x558cfd(0x1e8)];else{if(_0x583644[0x0][_0x558cfd(0x186)]=='French')var _0x2ded95=users[_0x558cfd(0x1fd)];else{if(_0x583644[0x0]['language']==_0x558cfd(0x8e))var _0x2ded95=users[_0x558cfd(0xf8)];else{if(_0x583644[0x0]['language']==_0x558cfd(0x100))var _0x2ded95=users[_0x558cfd(0x100)];else{if(_0x583644[0x0][_0x558cfd(0x186)]=='Arabic\x20(ae)')var _0x2ded95=users[_0x558cfd(0x1cb)];}}}}}}}_0xe045f9[_0x558cfd(0xb7)]('dssr_view',{'success':_0x4cfd69[_0x558cfd(0x120)]('success'),'errors':_0x4cfd69['flash'](_0x558cfd(0x197)),'alldata':_0x254b2c,'profile':_0x267ff6,'master_shop':_0x583644,'role':_0x4c0b81,'product_stock':_0x4f8aae,'language':_0x2ded95,'staff_arr':_0x27e3d7});}catch(_0x1b0455){}});async function agentsdataDSICheck_DSRR(_0x319f60,_0x574654,_0x38a291,_0x3b484d){const _0x49807b=a0_0x4e65fc;let _0x295f20=new Date(_0x319f60);_0x295f20['setDate'](_0x295f20[_0x49807b(0xb4)]()-0x1);let _0x13ca89=_0x295f20[_0x49807b(0x206)]()[_0x49807b(0x15d)]('T')[0x0];const _0x490590=await product['aggregate']([{'$group':{'_id':{'brand':_0x49807b(0x1ee),'category':_0x49807b(0xce)},'products':{'$push':{'name':_0x49807b(0x103),'product_code':_0x49807b(0x1d6)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x182a59=[];_0x182a59[_0x49807b(0x1e6)]=[];for(let _0x3bc4ba=0x0;_0x3bc4ba<=_0x490590[_0x49807b(0x124)]-0x1;_0x3bc4ba++){const _0x4d0da2=_0x490590[_0x3bc4ba];_0x182a59[_0x49807b(0x1e6)]['push'](_0x4d0da2);}const _0x2198c3=await product[_0x49807b(0x14a)]([{'$group':{'_id':{'category':_0x49807b(0xce)},'products':{'$push':{'brand':_0x49807b(0x1ee),'product_code':_0x49807b(0x1d6),'product_name':_0x49807b(0x103)}}}},{'$sort':{'_id.category':-0x1}}]),_0x2c849a=await product[_0x49807b(0x14a)]([{'$group':{'_id':{'category':_0x49807b(0xce),'brand':_0x49807b(0x1ee)}}},{'$group':{'_id':_0x49807b(0xfd),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x42e10f=await sales_sa[_0x49807b(0x14a)]([{'$match':{'date':_0x319f60,'sales_staff_id':_0x574654,'sale_product.isFG':_0x49807b(0x109)}},{'$unwind':_0x49807b(0xa3)},{'$lookup':{'from':_0x49807b(0x127),'localField':_0x49807b(0x129),'foreignField':'product_code','as':'product_info'}},{'$unwind':_0x49807b(0x1cc)},{'$group':{'_id':{'dsi':_0x49807b(0x18a),'date':_0x49807b(0x1e7),'customer':_0x49807b(0x1c6),'status_data':_0x49807b(0x163)},'totalQty':{'$sum':_0x49807b(0xdb)},'cash':{'$first':_0x49807b(0x1ad)},'amount':{'$first':_0x49807b(0x1d9)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x49807b(0x1a1)},'due_date':{'$first':_0x49807b(0x114)},'products':{'$push':{'qty':_0x49807b(0xdb),'NetPrice':_0x49807b(0xa5),'discount':_0x49807b(0x20e),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x49807b(0x145),'product_code':'$product_info.product_code','category':'$product_info.category','brand':'$product_info.brand','gross_price':_0x49807b(0x1df),'isFG':_0x49807b(0xf3),'prod_cat':_0x49807b(0xab),'prod_id':_0x49807b(0x1d0)}}}}},{'$unwind':_0x49807b(0x1a3)},{'$group':{'_id':{'dsi':_0x49807b(0x8c),'date':'$_id.date','customer':_0x49807b(0x98),'status_data':'$_id.status_data','category':_0x49807b(0x19d),'brand':_0x49807b(0x203),'prod_id':_0x49807b(0xbd)},'totalQty':{'$sum':_0x49807b(0xe1)},'totalGross':{'$sum':{'$multiply':[_0x49807b(0xe1),_0x49807b(0x1af)]}},'NetPrice':{'$sum':_0x49807b(0x1d1)},'discount':{'$sum':_0x49807b(0xc1)},'adj_discount':{'$sum':_0x49807b(0x1dd)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x49807b(0x92)},'check_no':{'$first':_0x49807b(0x1a1)},'due_date':{'$first':_0x49807b(0x114)},'product_details':{'$first':_0x49807b(0xea)}}},{'$group':{'_id':{'dsi':_0x49807b(0x8c),'date':_0x49807b(0x19a),'customer':'$_id.customer','status_data':_0x49807b(0x1a5)},'totalQty':{'$sum':_0x49807b(0x16e)},'totalGross':{'$sum':_0x49807b(0x17c)},'NetPrice':{'$sum':_0x49807b(0x1d3)},'discount':{'$sum':_0x49807b(0xd2)},'adj_discount':{'$sum':_0x49807b(0x1f0)},'cash':{'$first':_0x49807b(0x1ad)},'amount':{'$first':'$amount'},'bank':{'$first':_0x49807b(0x92)},'check_no':{'$first':_0x49807b(0x1a1)},'due_date':{'$first':_0x49807b(0x114)},'products':{'$push':{'qty':_0x49807b(0x16e),'category':_0x49807b(0xfd),'brand':_0x49807b(0xb8),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x59416d=await sales_sa['aggregate']([{'$match':{'date':_0x13ca89,'sales_staff_id':_0x574654,'sale_product.isFG':'false'}},{'$unwind':_0x49807b(0xa3)},{'$lookup':{'from':_0x49807b(0x127),'localField':_0x49807b(0x129),'foreignField':_0x49807b(0x165),'as':_0x49807b(0x105)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x49807b(0x18a),'date':'$date','customer':'$customer'},'totalQty':{'$sum':_0x49807b(0xdb)},'cash':{'$first':_0x49807b(0x1ad)},'amount':{'$first':_0x49807b(0x1d9)},'bank':{'$first':_0x49807b(0x92)},'check_no':{'$first':_0x49807b(0x1a1)},'due_date':{'$first':_0x49807b(0x114)},'products':{'$push':{'qty':_0x49807b(0xdb),'NetPrice':_0x49807b(0xa5),'discount':'$sale_product.discount','adj_discount':_0x49807b(0xe0),'product_details':{'prod_name':_0x49807b(0x145),'product_code':_0x49807b(0x153),'category':'$product_info.category','brand':_0x49807b(0x191),'gross_price':_0x49807b(0x1df),'isFG':_0x49807b(0xf3),'prod_cat':_0x49807b(0xab),'prod_id':_0x49807b(0x1d0)}}}}},{'$unwind':_0x49807b(0x1a3)},{'$group':{'_id':{'dsi':_0x49807b(0x8c),'date':_0x49807b(0x19a),'customer':'$_id.customer','category':_0x49807b(0x19d),'brand':'$products.product_details.brand','prod_id':_0x49807b(0xbd)},'totalQty':{'$sum':'$products.qty'},'cash':{'$first':_0x49807b(0x1ad)},'amount':{'$first':_0x49807b(0x1d9)},'bank':{'$first':_0x49807b(0x92)},'check_no':{'$first':_0x49807b(0x1a1)},'due_date':{'$first':_0x49807b(0x114)},'totalGross':{'$sum':{'$multiply':[_0x49807b(0xe1),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x49807b(0x1d1)},'discount':{'$sum':_0x49807b(0xc1)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x49807b(0xea)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x49807b(0x19a),'customer':'$_id.customer'},'totalQty':{'$sum':_0x49807b(0x16e)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x49807b(0x92)},'check_no':{'$first':_0x49807b(0x1a1)},'due_date':{'$first':_0x49807b(0x114)},'totalGross':{'$sum':_0x49807b(0x17c)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x49807b(0x1f0)},'products':{'$push':{'qty':_0x49807b(0x16e),'category':_0x49807b(0xfd),'brand':'$_id.brand','product_details':_0x49807b(0x166)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5b3b11=await sales_sa[_0x49807b(0x14a)]([{'$match':{'date':_0x319f60,'sales_staff_id':_0x574654,'status_data':_0x49807b(0xe5)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0xf36ebe=await staff['findById'](_0x574654);let _0x4b04a1=[],_0x485afa={},_0x4777d5={};var _0x415f5b=0x0,_0x570d72=0x0,_0x9eed5a=0x0,_0xb0b12a=0x0,_0x33027c=0x0;const _0x49a8ec=0x6;var _0x351b73=0x0,_0x58beeb=0x0;for(let _0x1d0112=0x0;_0x1d0112<=_0x42e10f[_0x49807b(0x124)]-0x1;_0x1d0112++){const _0x9f664f=_0x42e10f[_0x1d0112];let _0x8ee54e=_0x49807b(0xa6);_0x8ee54e+=_0x49807b(0xe9),_0x8ee54e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x9f664f['_id'][_0x49807b(0x1be)]+_0x49807b(0x140),_0x8ee54e+=_0x49807b(0x112)+_0x9f664f[_0x49807b(0x9e)]['dsi']+_0x49807b(0x140);let _0x4af49b={},_0x2ffd58={},_0x22ce51={};var _0x41946d={},_0xf8bf34={},_0xcb8867={},_0x44e668=0x0;for(let _0x51dac8=0x0;_0x51dac8<=_0x9f664f['products'][_0x49807b(0x124)]-0x1;_0x51dac8++){const _0x376703=_0x9f664f['products'][_0x51dac8];_0x4af49b[_0x376703[_0x49807b(0x1cd)]+'-'+_0x376703[_0x49807b(0xbf)]]=_0x376703['qty'],_0x2ffd58[[_0x376703[_0x49807b(0x1cd)]+'-'+_0x376703[_0x49807b(0xbf)]]]=_0x376703[_0x49807b(0x169)][_0x49807b(0x185)],_0x22ce51[[_0x376703[_0x49807b(0x1cd)]+'-'+_0x376703[_0x49807b(0xbf)]]]=_0x376703[_0x49807b(0x169)][_0x49807b(0x1fb)];const _0x50e6a9=_0x376703[_0x49807b(0x1cd)]+'-'+_0x376703[_0x49807b(0xbf)];!Array[_0x49807b(0x117)](_0x4777d5[_0x50e6a9])&&(_0x4777d5[_0x50e6a9]=[]);!Array['isArray'](_0x4777d5[_0x50e6a9])&&(_0x4777d5[_0x50e6a9]=[]);_0x4777d5[_0x50e6a9][_0x49807b(0x1f2)](_0x376703['qty']);if(_0x376703[_0x49807b(0x169)][_0x49807b(0x1fb)]=='P')_0x376703[_0x49807b(0x169)]['isFG']=='true'?(!_0xcb8867[_0x50e6a9]&&(_0xcb8867[_0x50e6a9]=0x0),_0xcb8867[_0x50e6a9]=_0x376703[_0x49807b(0x14e)]):(!_0x41946d[_0x50e6a9]&&(_0x41946d[_0x50e6a9]=0x0),_0x41946d[_0x50e6a9]=_0x376703[_0x49807b(0x14e)]);else _0x376703[_0x49807b(0x169)][_0x49807b(0x1fb)]=='S'&&(_0x376703[_0x49807b(0x169)][_0x49807b(0x185)]==_0x49807b(0xe5)?(!_0xcb8867[_0x50e6a9]&&(_0xcb8867[_0x50e6a9]=0x0),_0xcb8867[_0x50e6a9]=_0x376703[_0x49807b(0x14e)]):(!_0xf8bf34[_0x50e6a9]&&(_0xf8bf34[_0x50e6a9]=0x0),_0xf8bf34[_0x50e6a9]=_0x376703[_0x49807b(0x14e)]));_0x44e668++;}for(let _0x301c6d=0x0;_0x301c6d<=_0x182a59['cat_brand']['length']-0x1;_0x301c6d++){const _0x4e64f6=_0x182a59[_0x49807b(0x1e6)][_0x301c6d],_0x5f3957=_0x4e64f6[_0x49807b(0x9e)][_0x49807b(0x1cd)]+'-'+_0x4e64f6[_0x49807b(0x9e)]['category'],_0x3ff292=_0x22ce51[_0x5f3957]!==undefined?_0x22ce51[_0x5f3957]:'NA';var _0x39139c=_0x41946d[_0x5f3957]!==undefined?_0x41946d[_0x5f3957][_0x49807b(0x1f6)](0x2):'',_0x29f9d8=_0xf8bf34[_0x5f3957]!==undefined?_0xf8bf34[_0x5f3957][_0x49807b(0x1f6)](0x2):'',_0x7b00fc=_0xcb8867[_0x5f3957]!==undefined?_0xcb8867[_0x5f3957]['toFixed'](0x2):'';_0x8ee54e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x39139c+_0x49807b(0x140),_0x8ee54e+=_0x49807b(0x1d7)+_0x29f9d8+'</td>',_0x8ee54e+=_0x49807b(0x1d7)+_0x7b00fc+'</td>';}var _0x3b79ad=formatNumber(parseFloat(_0x9f664f[_0x49807b(0x89)])),_0x5edba8=formatNumber(parseFloat(_0x9f664f[_0x49807b(0xb9)]));isNaN(_0x5edba8)&&(_0x5edba8=0x0),_0x8ee54e+=_0x49807b(0x1d7)+_0x3b79ad+_0x49807b(0x140),_0x8ee54e+=_0x49807b(0x1d7)+_0x5edba8+_0x49807b(0x140),_0x8ee54e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x9f664f[_0x49807b(0x12c)]+'</td>',_0x8ee54e+=_0x49807b(0x112)+_0x9f664f[_0x49807b(0x11d)]+_0x49807b(0x140),_0x8ee54e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x9f664f[_0x49807b(0x18f)]+_0x49807b(0x140),_0x9eed5a=_0x9f664f['discount']+_0x9f664f['adj_discount'],_0x351b73+=parseFloat(_0x9f664f[_0x49807b(0x89)]),_0x58beeb+=parseFloat(_0x5edba8),_0x4b04a1[_0x49807b(0x1f2)](_0x8ee54e);}if(_0x5b3b11[_0x49807b(0x124)]>0x0)for(let _0x1a8789=0x0;_0x1a8789<=_0x5b3b11['length']-0x1;_0x1a8789++){const _0x1a2b40=_0x5b3b11[_0x1a8789];console[_0x49807b(0x10e)](_0x1a2b40);let _0x4c5107=_0x49807b(0xa6);_0x4c5107+=_0x49807b(0xf7)+(0x8+0x7*0x3)+_0x49807b(0x17d)+_0x1a2b40[_0x49807b(0x12d)]+'</b></td>',_0x4c5107+=_0x49807b(0x93),_0x4b04a1[_0x49807b(0x1f2)](_0x4c5107);}function _0x4f492e(_0x55c916,_0x130e81){const _0x39c50b=_0x49807b,_0x18b7ae=[];for(let _0xc4c4af=0x0;_0xc4c4af<=_0x55c916[_0x39c50b(0x124)]-0x1;_0xc4c4af+=_0x130e81){_0x18b7ae[_0x39c50b(0x1f2)](_0x55c916[_0x39c50b(0x193)](_0xc4c4af,_0xc4c4af+_0x130e81));}return _0x18b7ae;}const _0x54adc9=_0x4f492e(_0x4b04a1,_0x49a8ec);let _0x1e0f7c='';return _0x54adc9[_0x49807b(0x1ff)]((_0x2f8fa7,_0x56fd01)=>{const _0x58401e=_0x49807b;_0x56fd01>0x0&&(_0x1e0f7c+=_0x58401e(0x141));_0x1e0f7c+='<table>',_0x1e0f7c+=_0x58401e(0x19b);const _0x171723=new Date(_0x319f60),_0x4642ec={'year':'numeric','month':'long','day':_0x58401e(0x118),'timeZone':_0x58401e(0x102)},_0x4115a2=_0x171723[_0x58401e(0xec)]('en-US',_0x4642ec);_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0x108)+_0x3b484d+_0x58401e(0x1e0),_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0xd3)+_0xf36ebe[_0x58401e(0x205)]+_0x58401e(0x140),_0x1e0f7c+=_0x58401e(0x1f1),_0x1e0f7c+=_0x58401e(0x121),_0x1e0f7c+=_0x58401e(0x115),_0x1e0f7c+=_0x58401e(0x196),_0x1e0f7c+=_0x58401e(0x1ef),_0x1e0f7c+=_0x58401e(0x156),_0x1e0f7c+=_0x58401e(0x207),_0x1e0f7c+='<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>',_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x1e0f7c+=_0x58401e(0x183)+_0x4115a2+_0x58401e(0x140),_0x1e0f7c+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>',_0x1e0f7c+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>',_0x1e0f7c+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x1e0f7c+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>',_0x1e0f7c+='</tr>',_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0xf4),_0x1e0f7c+=_0x58401e(0x1c9),_0x1e0f7c+=_0x58401e(0x147),_0x1e0f7c+=_0x58401e(0x1c5),_0x1e0f7c+=_0x58401e(0x1c5),_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+='<tr>',_0x1e0f7c+=_0x58401e(0xae),_0x1e0f7c+=_0x58401e(0x161),_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0x139),_0x1e0f7c+=_0x58401e(0x201),_0x1e0f7c+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>';for(let _0x168dae=0x0;_0x168dae<=_0x2198c3[_0x58401e(0x124)]-0x1;_0x168dae++){const _0x2e5437=_0x2198c3[_0x168dae];for(let _0x4f3fb9=0x0;_0x4f3fb9<_0x182a59[_0x58401e(0x1e6)][_0x58401e(0x124)];_0x4f3fb9++){const _0x544066=_0x182a59[_0x58401e(0x1e6)][_0x4f3fb9];if(_0x544066['_id'][_0x58401e(0xbf)]===_0x2e5437[_0x58401e(0x9e)]['category']){var _0x138ab2='';switch(_0x2e5437['_id'][_0x58401e(0xbf)]){case _0x58401e(0x1ae):_0x138ab2=_0x544066[_0x58401e(0x9e)][_0x58401e(0x1cd)]+_0x58401e(0xaa);break;case _0x58401e(0x133):_0x138ab2=_0x544066[_0x58401e(0x9e)][_0x58401e(0x1cd)]+'\x20-\x20HH';break;default:_0x138ab2=_0x544066[_0x58401e(0x9e)][_0x58401e(0x1cd)];break;}_0x1e0f7c+=_0x58401e(0x162)+_0x138ab2+_0x58401e(0x1e0);}}}_0x1e0f7c+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>',_0x1e0f7c+=_0x58401e(0x95),_0x1e0f7c+=_0x58401e(0x17a),_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0xc4);for(let _0x33f0e5=0x0;_0x33f0e5<=_0x182a59['cat_brand'][_0x58401e(0x124)]-0x1;_0x33f0e5++){const _0x4e3739=_0x182a59[_0x33f0e5];_0x1e0f7c+=_0x58401e(0xd8),_0x1e0f7c+=_0x58401e(0x1ea),_0x1e0f7c+='<td\x20class=\x22cat_data\x22><b>FG</b></td>';}_0x1e0f7c+=_0x58401e(0x152),_0x1e0f7c+=_0x58401e(0x88),_0x1e0f7c+=_0x58401e(0xe8),_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+=_0x58401e(0xc7),_0x1e0f7c+=_0x58401e(0x212),_0x2f8fa7['forEach'](_0x4490e3=>{_0x1e0f7c+=_0x4490e3;});let _0x4d4dba={},_0x3598bc={},_0x3f44ce={};for(let _0x19d04a=0x0;_0x19d04a<=_0x42e10f[_0x58401e(0x124)]-0x1;_0x19d04a++){const _0x572064=_0x42e10f[_0x19d04a];var _0x35409f=0x0;for(let _0x3206ba=0x0;_0x3206ba<=_0x572064[_0x58401e(0x127)][_0x58401e(0x124)]-0x1;_0x3206ba++){const _0x4331a9=_0x572064[_0x58401e(0x127)][_0x3206ba],_0x5e4198=_0x4331a9[_0x58401e(0x1cd)]+'-'+_0x4331a9['category'];if(_0x4331a9[_0x58401e(0x169)][_0x58401e(0x1fb)]=='P')_0x4331a9[_0x58401e(0x169)][_0x58401e(0x185)]=='true'?(!_0x3f44ce[_0x5e4198]&&(_0x3f44ce[_0x5e4198]=0x0),_0x3f44ce[_0x5e4198]+=_0x4331a9[_0x58401e(0x14e)]):(!_0x4d4dba[_0x5e4198]&&(_0x4d4dba[_0x5e4198]=0x0),_0x4d4dba[_0x5e4198]+=_0x4331a9[_0x58401e(0x14e)]);else _0x4331a9['product_details'][_0x58401e(0x1fb)]=='S'&&(_0x4331a9['product_details'][_0x58401e(0x185)]=='true'?(!_0x3f44ce[_0x5e4198]&&(_0x3f44ce[_0x5e4198]=0x0),_0x3f44ce[_0x5e4198]+=_0x4331a9[_0x58401e(0x14e)],console[_0x58401e(0x10e)](_0x4331a9[_0x58401e(0x14e)])):(!_0x3598bc[_0x5e4198]&&(_0x3598bc[_0x5e4198]=0x0),_0x3598bc[_0x5e4198]+=_0x4331a9[_0x58401e(0x14e)]));_0x35409f++;}}let _0x4c5c60={},_0x593ded={},_0x19d1b9={};var _0x20dbaa=0x0,_0x544b46=0x0;for(let _0x58e3a5=0x0;_0x58e3a5<=_0x59416d[_0x58401e(0x124)]-0x1;_0x58e3a5++){const _0x44f4b4=_0x59416d[_0x58e3a5];var _0x35409f=0x0;for(let _0xe4062a=0x0;_0xe4062a<=_0x44f4b4[_0x58401e(0x127)]['length']-0x1;_0xe4062a++){const _0x5ad7a1=_0x44f4b4[_0x58401e(0x127)][_0xe4062a],_0x4ecb1c=_0x5ad7a1[_0x58401e(0x1cd)]+'-'+_0x5ad7a1[_0x58401e(0xbf)];if(_0x5ad7a1[_0x58401e(0x169)][_0x58401e(0x1fb)]=='P')_0x5ad7a1[_0x58401e(0x169)][_0x58401e(0x185)]==_0x58401e(0xe5)?(!_0x19d1b9[_0x4ecb1c]&&(_0x19d1b9[_0x4ecb1c]=0x0),_0x19d1b9[_0x4ecb1c]+=_0x5ad7a1['qty']):(!_0x4c5c60[_0x4ecb1c]&&(_0x4c5c60[_0x4ecb1c]=0x0),_0x4c5c60[_0x4ecb1c]+=_0x5ad7a1[_0x58401e(0x14e)]);else _0x5ad7a1[_0x58401e(0x169)]['prod_cat']=='S'&&(_0x5ad7a1[_0x58401e(0x169)][_0x58401e(0x185)]==_0x58401e(0xe5)?(!_0x19d1b9[_0x4ecb1c]&&(_0x19d1b9[_0x4ecb1c]=0x0),_0x19d1b9[_0x4ecb1c]+=_0x5ad7a1['qty']):(!_0x593ded[_0x4ecb1c]&&(_0x593ded[_0x4ecb1c]=0x0),_0x593ded[_0x4ecb1c]+=_0x5ad7a1['qty']));_0x35409f++;}var _0x37a1c7=parseFloat(_0x44f4b4[_0x58401e(0x89)]),_0x7ae046=parseFloat(_0x44f4b4[_0x58401e(0xb9)]);isNaN(_0x7ae046)&&(_0x7ae046=0x0),_0x20dbaa+=_0x37a1c7,_0x544b46+=_0x7ae046;}_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0x1c2),_0x1e0f7c+=_0x58401e(0x1f4),_0x1e0f7c+=_0x58401e(0xe9);for(let _0x2db3a7=0x0;_0x2db3a7<=_0x182a59[_0x58401e(0x1e6)]['length']-0x1;_0x2db3a7++){const _0x5634ce=_0x182a59[_0x58401e(0x1e6)][_0x2db3a7],_0x5cf4f6=_0x5634ce[_0x58401e(0x9e)][_0x58401e(0x1cd)]+'-'+_0x5634ce[_0x58401e(0x9e)]['category'];var _0x50880c=_0x4d4dba[_0x5cf4f6]!==undefined?formatNumber(_0x4d4dba[_0x5cf4f6]['toFixed'](0x2)):'',_0x1b9aa9=_0x3f44ce[_0x5cf4f6]!==undefined?formatNumber(_0x3f44ce[_0x5cf4f6]['toFixed'](0x2)):'',_0xdc5c40=_0x3598bc[_0x5cf4f6]!==undefined?formatNumber(_0x3598bc[_0x5cf4f6]['toFixed'](0x2)):'';_0x1e0f7c+=_0x58401e(0x9a)+_0x50880c+_0x58401e(0x1e0),_0x1e0f7c+=_0x58401e(0x9a)+_0xdc5c40+_0x58401e(0x1e0),_0x1e0f7c+=_0x58401e(0x9a)+_0x1b9aa9+_0x58401e(0x1e0);}_0x1e0f7c+=_0x58401e(0x9a)+formatNumber(_0x351b73)+'</b></td>',_0x1e0f7c+=_0x58401e(0x9a)+formatNumber(_0x58beeb)+_0x58401e(0x1e0),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='</tr>',_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0x1c2),_0x1e0f7c+=_0x58401e(0xcd),_0x1e0f7c+=_0x58401e(0xe9);for(let _0x195618=0x0;_0x195618<=_0x182a59['cat_brand']['length']-0x1;_0x195618++){const _0x18ac29=_0x182a59['cat_brand'][_0x195618],_0x37e8b9=_0x18ac29[_0x58401e(0x9e)]['brand']+'-'+_0x18ac29[_0x58401e(0x9e)]['category'];var _0x50880c=_0x4c5c60[_0x37e8b9]!==undefined?formatNumber(_0x4c5c60[_0x37e8b9]['toFixed'](0x2)):'',_0x1b9aa9=_0x19d1b9[_0x37e8b9]!==undefined?formatNumber(_0x19d1b9[_0x37e8b9][_0x58401e(0x1f6)](0x2)):'',_0xdc5c40=_0x593ded[_0x37e8b9]!==undefined?formatNumber(_0x593ded[_0x37e8b9]['toFixed'](0x2)):'';_0x1e0f7c+=_0x58401e(0x9a)+_0x50880c+_0x58401e(0x1e0),_0x1e0f7c+=_0x58401e(0x9a)+_0xdc5c40+_0x58401e(0x1e0),_0x1e0f7c+=_0x58401e(0x9a)+_0x1b9aa9+'</b></td>';}_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x20dbaa)+_0x58401e(0x1e0),_0x1e0f7c+=_0x58401e(0x9a)+formatNumber(_0x544b46)+_0x58401e(0x1e0),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='</tr>',_0x1e0f7c+='<tr>',_0x1e0f7c+=_0x58401e(0x1c2),_0x1e0f7c+=_0x58401e(0x1b1),_0x1e0f7c+=_0x58401e(0xe9);let _0xcd8d02=0x0,_0x5ae1e4=0x0,_0x4c3363=0x0;for(let _0x5a9a5a=0x0;_0x5a9a5a<=_0x182a59[_0x58401e(0x1e6)][_0x58401e(0x124)]-0x1;_0x5a9a5a++){const _0x375cbf=_0x182a59[_0x58401e(0x1e6)][_0x5a9a5a],_0x4c459=_0x375cbf['_id'][_0x58401e(0x1cd)]+'-'+_0x375cbf[_0x58401e(0x9e)][_0x58401e(0xbf)];var _0x5754b7=_0x4d4dba[_0x4c459]!==undefined?_0x4d4dba[_0x4c459][_0x58401e(0x1f6)](0x2):'0',_0x5ae1d4=_0x3f44ce[_0x4c459]!==undefined?_0x3f44ce[_0x4c459][_0x58401e(0x1f6)](0x2):'0',_0x7d81aa=_0x3598bc[_0x4c459]!==undefined?_0x3598bc[_0x4c459][_0x58401e(0x1f6)](0x2):'0',_0x3a0e2a=_0x4c5c60[_0x4c459]!==undefined?_0x4c5c60[_0x4c459][_0x58401e(0x1f6)](0x2):'0',_0x18a5cf=_0x19d1b9[_0x4c459]!==undefined?_0x19d1b9[_0x4c459][_0x58401e(0x1f6)](0x2):'0',_0x25fa62=_0x593ded[_0x4c459]!==undefined?_0x593ded[_0x4c459][_0x58401e(0x1f6)](0x2):'0';_0xcd8d02=parseFloat(_0x5754b7)+parseFloat(_0x3a0e2a),_0x5ae1e4=parseFloat(_0x7d81aa)+parseFloat(_0x25fa62),_0x4c3363=parseFloat(_0x5ae1d4)+parseFloat(_0x18a5cf),_0x1e0f7c+=_0x58401e(0x9a)+formatNumber(_0xcd8d02['toFixed'](0x2))+'</b></td>',_0x1e0f7c+=_0x58401e(0x9a)+formatNumber(_0x5ae1e4[_0x58401e(0x1f6)](0x2))+'</b></td>',_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4c3363[_0x58401e(0x1f6)](0x2))+'</b></td>';}var _0x2cdc2=formatNumber(_0x351b73+_0x20dbaa),_0x34d0f4=formatNumber(_0x58beeb+_0x544b46);_0x1e0f7c+=_0x58401e(0x9a)+_0x2cdc2+'</b></td>',_0x1e0f7c+=_0x58401e(0x9a)+_0x34d0f4+'</b></td>',_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+='<tr>',_0x1e0f7c+='<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'+(_0x182a59['cat_brand']['length']*0x3+0x9)+_0x58401e(0x208),_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0x1c2),_0x1e0f7c+=_0x58401e(0x1bf),_0x1e0f7c+=_0x58401e(0xe9);for(let _0x1d405f=0x0;_0x1d405f<=_0x182a59[_0x58401e(0x1e6)][_0x58401e(0x124)]-0x1;_0x1d405f++){const _0x249438=_0x182a59[_0x58401e(0x1e6)][_0x1d405f],_0x167dc7=_0x249438[_0x58401e(0x9e)]['brand']+'-'+_0x249438[_0x58401e(0x9e)][_0x58401e(0xbf)];var _0x5754b7=_0x4d4dba[_0x167dc7]!==undefined?_0x4d4dba[_0x167dc7]['toFixed'](0x2):'0',_0x5ae1d4=_0x3f44ce[_0x167dc7]!==undefined?_0x3f44ce[_0x167dc7][_0x58401e(0x1f6)](0x2):'0',_0x7d81aa=_0x3598bc[_0x167dc7]!==undefined?_0x3598bc[_0x167dc7][_0x58401e(0x1f6)](0x2):'0',_0x3a0e2a=_0x4c5c60[_0x167dc7]!==undefined?_0x4c5c60[_0x167dc7][_0x58401e(0x1f6)](0x2):'0',_0x18a5cf=_0x19d1b9[_0x167dc7]!==undefined?_0x19d1b9[_0x167dc7][_0x58401e(0x1f6)](0x2):'0',_0x25fa62=_0x593ded[_0x167dc7]!==undefined?_0x593ded[_0x167dc7]['toFixed'](0x2):'0';_0xcd8d02=parseFloat(_0x5754b7)+parseFloat(_0x3a0e2a),_0x5ae1e4=parseFloat(_0x7d81aa)+parseFloat(_0x25fa62),_0x4c3363=parseFloat(_0x5ae1d4)+parseFloat(_0x18a5cf),_0x1e0f7c+=_0x58401e(0x178),_0x1e0f7c+=_0x58401e(0x178),_0x1e0f7c+=_0x58401e(0x178);}_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0x1c2),_0x1e0f7c+=_0x58401e(0x14f),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x2b7138=0x0;_0x2b7138<=_0x182a59['cat_brand'][_0x58401e(0x124)]-0x1;_0x2b7138++){const _0x510fef=_0x182a59[_0x58401e(0x1e6)][_0x2b7138],_0x2a0a2a=_0x510fef[_0x58401e(0x9e)][_0x58401e(0x1cd)]+'-'+_0x510fef['_id'][_0x58401e(0xbf)];var _0x5754b7=_0x4d4dba[_0x2a0a2a]!==undefined?_0x4d4dba[_0x2a0a2a][_0x58401e(0x1f6)](0x2):'0',_0x5ae1d4=_0x3f44ce[_0x2a0a2a]!==undefined?_0x3f44ce[_0x2a0a2a][_0x58401e(0x1f6)](0x2):'0',_0x7d81aa=_0x3598bc[_0x2a0a2a]!==undefined?_0x3598bc[_0x2a0a2a]['toFixed'](0x2):'0',_0x3a0e2a=_0x4c5c60[_0x2a0a2a]!==undefined?_0x4c5c60[_0x2a0a2a]['toFixed'](0x2):'0',_0x18a5cf=_0x19d1b9[_0x2a0a2a]!==undefined?_0x19d1b9[_0x2a0a2a][_0x58401e(0x1f6)](0x2):'0',_0x25fa62=_0x593ded[_0x2a0a2a]!==undefined?_0x593ded[_0x2a0a2a][_0x58401e(0x1f6)](0x2):'0';_0xcd8d02=parseFloat(_0x5754b7)+parseFloat(_0x3a0e2a),_0x5ae1e4=parseFloat(_0x7d81aa)+parseFloat(_0x25fa62),_0x4c3363=parseFloat(_0x5ae1d4)+parseFloat(_0x18a5cf),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1e0f7c+=_0x58401e(0x178),_0x1e0f7c+=_0x58401e(0x178);}_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0x93),_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0x1c2),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>',_0x1e0f7c+=_0x58401e(0xe9);for(let _0x1e7fad=0x0;_0x1e7fad<=_0x182a59['cat_brand']['length']-0x1;_0x1e7fad++){const _0x399309=_0x182a59[_0x58401e(0x1e6)][_0x1e7fad],_0x4b6e67=_0x399309[_0x58401e(0x9e)][_0x58401e(0x1cd)]+'-'+_0x399309[_0x58401e(0x9e)][_0x58401e(0xbf)];var _0x5754b7=_0x4d4dba[_0x4b6e67]!==undefined?_0x4d4dba[_0x4b6e67][_0x58401e(0x1f6)](0x2):'0',_0x5ae1d4=_0x3f44ce[_0x4b6e67]!==undefined?_0x3f44ce[_0x4b6e67][_0x58401e(0x1f6)](0x2):'0',_0x7d81aa=_0x3598bc[_0x4b6e67]!==undefined?_0x3598bc[_0x4b6e67][_0x58401e(0x1f6)](0x2):'0',_0x3a0e2a=_0x4c5c60[_0x4b6e67]!==undefined?_0x4c5c60[_0x4b6e67][_0x58401e(0x1f6)](0x2):'0',_0x18a5cf=_0x19d1b9[_0x4b6e67]!==undefined?_0x19d1b9[_0x4b6e67][_0x58401e(0x1f6)](0x2):'0',_0x25fa62=_0x593ded[_0x4b6e67]!==undefined?_0x593ded[_0x4b6e67]['toFixed'](0x2):'0';_0xcd8d02=parseFloat(_0x5754b7)+parseFloat(_0x3a0e2a),_0x5ae1e4=parseFloat(_0x7d81aa)+parseFloat(_0x25fa62),_0x4c3363=parseFloat(_0x5ae1d4)+parseFloat(_0x18a5cf),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1e0f7c+=_0x58401e(0x178),_0x1e0f7c+=_0x58401e(0x178);}_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='</tr>',_0x1e0f7c+=_0x58401e(0xa6),_0x1e0f7c+=_0x58401e(0x1c2),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>',_0x1e0f7c+=_0x58401e(0xe9);for(let _0x112da3=0x0;_0x112da3<=_0x182a59['cat_brand'][_0x58401e(0x124)]-0x1;_0x112da3++){const _0x91dbb=_0x182a59[_0x58401e(0x1e6)][_0x112da3],_0x888e80=_0x91dbb[_0x58401e(0x9e)][_0x58401e(0x1cd)]+'-'+_0x91dbb[_0x58401e(0x9e)][_0x58401e(0xbf)];var _0x5754b7=_0x4d4dba[_0x888e80]!==undefined?_0x4d4dba[_0x888e80]['toFixed'](0x2):'',_0x5ae1d4=_0x3f44ce[_0x888e80]!==undefined?_0x3f44ce[_0x888e80]['toFixed'](0x2):'',_0x7d81aa=_0x3598bc[_0x888e80]!==undefined?_0x3598bc[_0x888e80][_0x58401e(0x1f6)](0x2):'',_0x3a0e2a=_0x4c5c60[_0x888e80]!==undefined?_0x4c5c60[_0x888e80][_0x58401e(0x1f6)](0x2):'',_0x18a5cf=_0x19d1b9[_0x888e80]!==undefined?_0x19d1b9[_0x888e80][_0x58401e(0x1f6)](0x2):'',_0x25fa62=_0x593ded[_0x888e80]!==undefined?_0x593ded[_0x888e80]['toFixed'](0x2):'';_0xcd8d02=formatNumber(parseFloat(_0x5754b7)+parseFloat(_0x3a0e2a)),_0x5ae1e4=formatNumber(parseFloat(_0x7d81aa)+parseFloat(_0x25fa62)),_0x4c3363=formatNumber(parseFloat(_0x5ae1d4)+parseFloat(_0x18a5cf)),_0x1e0f7c+=_0x58401e(0x9a)+_0x5754b7+_0x58401e(0x1e0),_0x1e0f7c+=_0x58401e(0x9a)+_0x7d81aa+_0x58401e(0x1e0),_0x1e0f7c+=_0x58401e(0x9a)+_0x5ae1d4+_0x58401e(0x1e0);}_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x1e0f7c+='</tr>',_0x1e0f7c+='<tr>',_0x1e0f7c+=_0x58401e(0x1c2),_0x1e0f7c+=_0x58401e(0x1f5),_0x1e0f7c+=_0x58401e(0xe9);for(let _0x5cf247=0x0;_0x5cf247<=_0x182a59[_0x58401e(0x1e6)][_0x58401e(0x124)]-0x1;_0x5cf247++){const _0x1fa8d9=_0x182a59[_0x58401e(0x1e6)][_0x5cf247],_0x401d64=_0x1fa8d9[_0x58401e(0x9e)][_0x58401e(0x1cd)]+'-'+_0x1fa8d9[_0x58401e(0x9e)]['category'];var _0x5754b7=_0x4d4dba[_0x401d64]!==undefined?_0x4d4dba[_0x401d64][_0x58401e(0x1f6)](0x2):'0',_0x5ae1d4=_0x3f44ce[_0x401d64]!==undefined?_0x3f44ce[_0x401d64][_0x58401e(0x1f6)](0x2):'0',_0x7d81aa=_0x3598bc[_0x401d64]!==undefined?_0x3598bc[_0x401d64][_0x58401e(0x1f6)](0x2):'0',_0x3a0e2a=_0x4c5c60[_0x401d64]!==undefined?_0x4c5c60[_0x401d64][_0x58401e(0x1f6)](0x2):'0',_0x18a5cf=_0x19d1b9[_0x401d64]!==undefined?_0x19d1b9[_0x401d64][_0x58401e(0x1f6)](0x2):'0',_0x25fa62=_0x593ded[_0x401d64]!==undefined?_0x593ded[_0x401d64][_0x58401e(0x1f6)](0x2):'0';_0xcd8d02=parseFloat(_0x5754b7)+parseFloat(_0x3a0e2a),_0x5ae1e4=parseFloat(_0x7d81aa)+parseFloat(_0x25fa62),_0x4c3363=parseFloat(_0x5ae1d4)+parseFloat(_0x18a5cf),_0x1e0f7c+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x1e0f7c+=_0x58401e(0x178),_0x1e0f7c+=_0x58401e(0x178);}_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+=_0x58401e(0xe9),_0x1e0f7c+='</tr>',_0x1e0f7c+=_0x58401e(0x1a8),_0x1e0f7c+=_0x58401e(0x1c1);}),_0x1e0f7c;}async function generateReferenceNumber(_0x2d9f70,_0x606bc4,_0xa2c9ac){const _0x5dbdb1=a0_0x4e65fc,_0x1f2962=new Date(_0x2d9f70)[_0x5dbdb1(0x12a)](),_0x370614=('0'+(new Date(_0x2d9f70)[_0x5dbdb1(0x1f9)]()+0x1))[_0x5dbdb1(0x193)](-0x2),_0xa8ea2=('0'+new Date(_0x2d9f70)[_0x5dbdb1(0xb4)]())['slice'](-0x2),_0x48dc3f=await staff[_0x5dbdb1(0x18c)]({'email':_0xa2c9ac[_0x5dbdb1(0xac)]}),_0x2a1c25=_0x48dc3f[_0x5dbdb1(0x1b4)],_0x1734da=_0x2a1c25+'-'+_0x1f2962+_0x370614+_0xa8ea2,_0xacc1fd=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x1734da),'salesman_code':_0x2a1c25})[_0x5dbdb1(0x13c)]({'createdAt':-0x1}),_0x496318=_0x1734da;_0xacc1fd&&(_0x496318=_0xacc1fd[_0x5dbdb1(0xc8)]);console['log'](_0x496318);const _0x5daa53=new Reference({'referenceNumber':_0x496318,'staff_id':_0x606bc4,'salesman_code':_0x2a1c25});return await _0x5daa53['save'](),_0x496318;}router[a0_0x4e65fc(0xfb)](a0_0x4e65fc(0x1cf),auth,async(_0x4ce4dd,_0x247bf1)=>{const _0x3e1e2f=a0_0x4e65fc,{from_date:_0x4816cb,dataview:_0x536dd8}=_0x4ce4dd[_0x3e1e2f(0xbe)],_0x4b21d3=_0x4ce4dd['user'],_0x45e147=await staff[_0x3e1e2f(0x18c)]({'email':_0x4b21d3[_0x3e1e2f(0xac)]}),_0x57cdf3=await master_shop[_0x3e1e2f(0x179)](),_0x3f5f88='';var _0x1188ca=new Date(_0x4816cb);const _0x1c2509={'year':_0x3e1e2f(0x118),'month':_0x3e1e2f(0x11f),'day':_0x3e1e2f(0x118)},_0xb061e6=new Intl[(_0x3e1e2f(0x1a9))](_0x3e1e2f(0x13e),_0x1c2509)['format'](_0x1188ca),_0x5f47c4=await Reference[_0x3e1e2f(0x179)]({'staff_id':_0x45e147['_id'][_0x3e1e2f(0xb6)](),'date_include':_0x4816cb});if(_0x5f47c4[_0x3e1e2f(0x124)]>0x0){let _0x5a888a='';_0x5a888a+=_0x5f47c4[0x0]['html'];if(_0x536dd8==_0x3e1e2f(0x16d)){const _0x6c908e=cheerio[_0x3e1e2f(0xdd)](_0x5a888a);let _0x51b9a9=[],_0x214d97=[],_0x22bf0d=[];const _0x31c81f=_0x217430=>{const _0xe05cae=_0x3e1e2f,_0x334fd2={'top':{'style':'thick','color':{'rgb':'000000'}},'bottom':{'style':_0xe05cae(0x12e),'color':{'rgb':_0xe05cae(0xd9)}},'left':{'style':_0xe05cae(0x12e),'color':{'rgb':_0xe05cae(0xd9)}},'right':{'style':'thick','color':{'rgb':_0xe05cae(0xd9)}}};if(_0x217430){const _0x46e0fb=_0x217430[_0xe05cae(0x15d)](';')[_0xe05cae(0xd4)]((_0xd4543,_0x2abf25)=>{const _0x131275=_0xe05cae,[_0x3357ff,_0x1bfbda]=_0x2abf25['split'](':')[_0x131275(0xc3)](_0x3eabd9=>_0x3eabd9[_0x131275(0xde)]());return _0xd4543[_0x3357ff]=_0x1bfbda,_0xd4543;},{});_0x46e0fb[_0xe05cae(0x157)]&&(_0x334fd2['top'][_0xe05cae(0x15a)]=_0x46e0fb['border-top'][_0xe05cae(0xa1)](_0xe05cae(0x122))?_0xe05cae(0x122):_0xe05cae(0x9b)),_0x46e0fb[_0xe05cae(0x131)]&&(_0x334fd2['bottom'][_0xe05cae(0x15a)]=_0x46e0fb[_0xe05cae(0x131)][_0xe05cae(0xa1)]('thin')?_0xe05cae(0x122):_0xe05cae(0x9b)),_0x46e0fb[_0xe05cae(0x91)]&&(_0x334fd2['left'][_0xe05cae(0x15a)]=_0x46e0fb[_0xe05cae(0x91)][_0xe05cae(0xa1)](_0xe05cae(0x122))?_0xe05cae(0x122):_0xe05cae(0x9b)),_0x46e0fb['border-right']&&(_0x334fd2['right']['style']=_0x46e0fb[_0xe05cae(0xf0)][_0xe05cae(0xa1)](_0xe05cae(0x122))?'thin':_0xe05cae(0x9b));}return _0x334fd2;};_0x6c908e(_0x3e1e2f(0x13a))['each']((_0x59a2f5,_0x2411af)=>{const _0x926695=_0x3e1e2f;let _0x3e537c=[],_0x2a8f8a=0x0;while(_0x22bf0d[_0x2a8f8a]){_0x22bf0d[_0x2a8f8a]--,_0x2a8f8a++;}_0x6c908e(_0x2411af)[_0x926695(0x179)](_0x926695(0x1d4))[_0x926695(0x1eb)]((_0x1b45e0,_0x2f7398)=>{const _0x33fc75=_0x926695;let _0x4bc8ea=_0x6c908e(_0x2f7398)[_0x33fc75(0xe3)]()['trim'](),_0x3dd992=parseFloat(_0x4bc8ea[_0x33fc75(0x1b2)](/,/g,''));isNaN(_0x3dd992)&&(_0x3dd992=_0x4bc8ea);let _0x482787=parseInt(_0x6c908e(_0x2f7398)[_0x33fc75(0xdf)](_0x33fc75(0x1e2)))||0x1,_0x485502=parseInt(_0x6c908e(_0x2f7398)[_0x33fc75(0xdf)](_0x33fc75(0x1a2)))||0x1;const _0x2bcb25=_0x6c908e(_0x2f7398)[_0x33fc75(0xdf)](_0x33fc75(0x15a)),_0x71369f=_0x31c81f(_0x2bcb25);_0x3e537c[_0x2a8f8a]={'v':_0x3dd992,'s':{'border':_0x71369f}};(_0x482787>0x1||_0x485502>0x1)&&_0x214d97[_0x33fc75(0x1f2)]({'s':{'r':_0x59a2f5,'c':_0x2a8f8a},'e':{'r':_0x59a2f5+_0x485502-0x1,'c':_0x2a8f8a+_0x482787-0x1}});for(let _0xa90d6a=0x0;_0xa90d6a<_0x482787;_0xa90d6a++){_0x485502>0x1&&(_0x22bf0d[_0x2a8f8a+_0xa90d6a]=_0x485502-0x1);}_0x2a8f8a+=_0x482787;}),_0x51b9a9[_0x926695(0x1f2)](_0x3e537c);});const _0x2eba97=XLSX[_0x3e1e2f(0x149)][_0x3e1e2f(0xff)](),_0x3bbf7c=XLSX['utils'][_0x3e1e2f(0x164)](_0x51b9a9);_0x214d97[_0x3e1e2f(0x124)]>0x0&&(_0x3bbf7c['!merges']=_0x214d97);_0x3bbf7c[_0x3e1e2f(0x204)]=_0x51b9a9[0x0][_0x3e1e2f(0xc3)](()=>({'wpx':0x64})),XLSX[_0x3e1e2f(0x149)][_0x3e1e2f(0x18e)](_0x2eba97,_0x3bbf7c,_0x3e1e2f(0x138));const _0x52a514=XLSX[_0x3e1e2f(0x20d)](_0x2eba97,{'bookType':'xlsx','type':'buffer'});_0x247bf1[_0x3e1e2f(0xba)]('Content-Disposition',_0x3e1e2f(0xd7)),_0x247bf1['setHeader'](_0x3e1e2f(0xa7),_0x3e1e2f(0x184)),_0x247bf1['send'](_0x52a514);}else{let _0x481fde='';_0x481fde+=_0x5a888a,_0x481fde+='<script>',_0x481fde+='window.onload\x20=\x20function()\x20{',_0x481fde+=_0x3e1e2f(0x14d),_0x481fde+='};',_0x481fde+='</script>',_0x247bf1[_0x3e1e2f(0x110)](_0x481fde);}}else generateReferenceNumber(_0x4816cb,_0x45e147['_id'][_0x3e1e2f(0xb6)](),_0x4b21d3)['then'](async _0x4c0847=>{const _0x327afd=_0x3e1e2f,_0x45cf96=await agentsdataDSICheck_DSRR(_0x4816cb,_0x45e147[_0x327afd(0x9e)][_0x327afd(0xb6)](),_0x3f5f88,_0x4c0847);console[_0x327afd(0x10e)](_0x45cf96);let _0x2c6303='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x2c6303+=_0x327afd(0x151),_0x2c6303+=_0x327afd(0x1b9),_0x2c6303+=_0x327afd(0x19e),_0x2c6303+=_0x45cf96,_0x2c6303+=_0x327afd(0x1c1),_0x2c6303+=_0x327afd(0x96),_0x2c6303+='</div>';if(_0x45cf96[_0x327afd(0x124)]>0x0){const _0xb1a0c7=await Reference['findOne']({'staff_id':_0x45e147[_0x327afd(0x9e)][_0x327afd(0xb6)](),'referenceNumber':_0x4c0847});_0xb1a0c7['html']=_0x2c6303,_0xb1a0c7[_0x327afd(0x20c)]=_0x4816cb,await _0xb1a0c7['save']();if(_0x536dd8==_0x327afd(0x16d)){const _0x30b4a2=cheerio[_0x327afd(0xdd)](_0x2c6303);let _0x313483=[],_0x4592df=[],_0x2c58ee=[];const _0x3bc7a7=_0x49b195=>{const _0x15239b=_0x327afd,_0x5de7a0={'top':{'style':_0x15239b(0x12e),'color':{'rgb':_0x15239b(0xd9)}},'bottom':{'style':'thick','color':{'rgb':_0x15239b(0xd9)}},'left':{'style':_0x15239b(0x12e),'color':{'rgb':_0x15239b(0xd9)}},'right':{'style':_0x15239b(0x12e),'color':{'rgb':_0x15239b(0xd9)}}};if(_0x49b195){const _0x12c9dd=_0x49b195[_0x15239b(0x15d)](';')[_0x15239b(0xd4)]((_0x5e6052,_0x4e637f)=>{const _0x1e5f7e=_0x15239b,[_0x1a8c2c,_0x92d7d1]=_0x4e637f[_0x1e5f7e(0x15d)](':')['map'](_0x2debbe=>_0x2debbe[_0x1e5f7e(0xde)]());return _0x5e6052[_0x1a8c2c]=_0x92d7d1,_0x5e6052;},{});_0x12c9dd[_0x15239b(0x157)]&&(_0x5de7a0[_0x15239b(0x12b)]['style']=_0x12c9dd['border-top'][_0x15239b(0xa1)](_0x15239b(0x122))?_0x15239b(0x122):'medium'),_0x12c9dd[_0x15239b(0x131)]&&(_0x5de7a0[_0x15239b(0xaf)][_0x15239b(0x15a)]=_0x12c9dd[_0x15239b(0x131)]['includes'](_0x15239b(0x122))?_0x15239b(0x122):_0x15239b(0x9b)),_0x12c9dd[_0x15239b(0x91)]&&(_0x5de7a0[_0x15239b(0x15b)]['style']=_0x12c9dd['border-left'][_0x15239b(0xa1)](_0x15239b(0x122))?'thin':_0x15239b(0x9b)),_0x12c9dd[_0x15239b(0xf0)]&&(_0x5de7a0[_0x15239b(0x18b)]['style']=_0x12c9dd['border-right'][_0x15239b(0xa1)](_0x15239b(0x122))?_0x15239b(0x122):_0x15239b(0x9b));}return _0x5de7a0;};_0x30b4a2('table\x20tr')[_0x327afd(0x1eb)]((_0xcc5a18,_0x4e4306)=>{const _0x21be2f=_0x327afd;let _0x1c1739=[],_0xbdd57c=0x0;while(_0x2c58ee[_0xbdd57c]){_0x2c58ee[_0xbdd57c]--,_0xbdd57c++;}_0x30b4a2(_0x4e4306)['find'](_0x21be2f(0x1d4))[_0x21be2f(0x1eb)]((_0x26aba8,_0x34d02f)=>{const _0x1bcc31=_0x21be2f;let _0x3fd299=_0x30b4a2(_0x34d02f)[_0x1bcc31(0xe3)]()[_0x1bcc31(0xde)](),_0x906683=parseFloat(_0x3fd299[_0x1bcc31(0x1b2)](/,/g,''));isNaN(_0x906683)&&(_0x906683=_0x3fd299);let _0x12755d=parseInt(_0x30b4a2(_0x34d02f)[_0x1bcc31(0xdf)](_0x1bcc31(0x1e2)))||0x1,_0x3d6ad0=parseInt(_0x30b4a2(_0x34d02f)[_0x1bcc31(0xdf)](_0x1bcc31(0x1a2)))||0x1;const _0x738ec1=_0x30b4a2(_0x34d02f)[_0x1bcc31(0xdf)](_0x1bcc31(0x15a)),_0xc17ed8=_0x3bc7a7(_0x738ec1);_0x1c1739[_0xbdd57c]={'v':_0x906683,'s':{'border':_0xc17ed8}};(_0x12755d>0x1||_0x3d6ad0>0x1)&&_0x4592df[_0x1bcc31(0x1f2)]({'s':{'r':_0xcc5a18,'c':_0xbdd57c},'e':{'r':_0xcc5a18+_0x3d6ad0-0x1,'c':_0xbdd57c+_0x12755d-0x1}});for(let _0x49a812=0x0;_0x49a812<_0x12755d;_0x49a812++){_0x3d6ad0>0x1&&(_0x2c58ee[_0xbdd57c+_0x49a812]=_0x3d6ad0-0x1);}_0xbdd57c+=_0x12755d;}),_0x313483[_0x21be2f(0x1f2)](_0x1c1739);});const _0x2d22f7=XLSX[_0x327afd(0x149)][_0x327afd(0xff)](),_0x30c545=XLSX[_0x327afd(0x149)]['aoa_to_sheet'](_0x313483);_0x4592df['length']>0x0&&(_0x30c545[_0x327afd(0x187)]=_0x4592df);_0x30c545[_0x327afd(0x204)]=_0x313483[0x0][_0x327afd(0xc3)](()=>({'wpx':0x64})),XLSX[_0x327afd(0x149)][_0x327afd(0x18e)](_0x2d22f7,_0x30c545,'Sales\x20Report');const _0x179395=XLSX[_0x327afd(0x20d)](_0x2d22f7,{'bookType':'xlsx','type':'buffer'});_0x247bf1[_0x327afd(0xba)](_0x327afd(0x13f),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x247bf1[_0x327afd(0xba)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x247bf1['send'](_0x179395);}else _0x2c6303+=_0x327afd(0xef),_0x2c6303+=_0x327afd(0x1bb),_0x2c6303+='window.print();',_0x2c6303+='};',_0x2c6303+='</script>',_0x247bf1[_0x327afd(0x110)](_0x2c6303);}else await Reference[_0x327afd(0x20a)]({'referenceNumber':_0x4c0847}),_0x4ce4dd[_0x327afd(0x120)](_0x327afd(0x197),_0x327afd(0xe6)),_0x247bf1[_0x327afd(0x9f)](_0x327afd(0xfa));})[_0x3e1e2f(0x104)](console[_0x3e1e2f(0x1e3)]);}),router['get'](a0_0x4e65fc(0x20f),auth,async(_0x2e33f,_0x456e5e)=>{const _0x2afdf6=a0_0x4e65fc;try{const {username:_0x5b7378,email:_0x34e504,role:_0xc9e849}=_0x2e33f[_0x2afdf6(0x209)],_0x4645bc=_0x2e33f[_0x2afdf6(0x209)],_0x1037ac=await profile['findOne']({'email':_0x4645bc['email']}),_0x2d46bb={'year':'numeric','month':_0x2afdf6(0x11f),'day':_0x2afdf6(0x118)},_0x3e8eca=await master_shop['find']();console[_0x2afdf6(0x10e)](_0x2afdf6(0x1fa),_0x3e8eca);const _0x1bb250=await product[_0x2afdf6(0x179)]();console['log'](_0x2afdf6(0x19f),_0x1bb250);const _0x5f235e=await warehouse['aggregate']([{'$unwind':_0x2afdf6(0x166)},{'$lookup':{'from':'products','localField':_0x2afdf6(0x1e4),'foreignField':_0x2afdf6(0x205),'as':_0x2afdf6(0x1d5)}},{'$unwind':_0x2afdf6(0xfc)},{'$project':{'product_name':_0x2afdf6(0x1dc),'product_stock':_0x2afdf6(0x136)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':'$product_stock'}}}]);console[_0x2afdf6(0x10e)](_0x2afdf6(0xf5),_0x5f235e),_0x5f235e['forEach'](_0xe1f2e1=>{const _0x240849=_0x1bb250['map'](_0x3047fb=>{const _0x39c39f=a0_0x1edd;_0x3047fb['name']==_0xe1f2e1[_0x39c39f(0x9e)]&&(_0x3047fb[_0x39c39f(0x148)]=parseInt(_0x3047fb[_0x39c39f(0x148)])+parseInt(_0xe1f2e1[_0x39c39f(0x200)]));});});const _0x429417=await staff[_0x2afdf6(0x179)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x136469=await staff[_0x2afdf6(0x18c)]({'email':_0x4645bc[_0x2afdf6(0xac)]});if(_0x3e8eca[0x0][_0x2afdf6(0x186)]==_0x2afdf6(0x1b7))var _0x26b247=users[_0x2afdf6(0x202)];else{if(_0x3e8eca[0x0][_0x2afdf6(0x186)]==_0x2afdf6(0xf1))var _0x26b247=users[_0x2afdf6(0xf1)];else{if(_0x3e8eca[0x0][_0x2afdf6(0x186)]==_0x2afdf6(0xc9))var _0x26b247=users[_0x2afdf6(0xc9)];else{if(_0x3e8eca[0x0][_0x2afdf6(0x186)]==_0x2afdf6(0x1e8))var _0x26b247=users['Spanish'];else{if(_0x3e8eca[0x0]['language']=='French')var _0x26b247=users[_0x2afdf6(0x1fd)];else{if(_0x3e8eca[0x0]['language']==_0x2afdf6(0x8e))var _0x26b247=users['Portuguese'];else{if(_0x3e8eca[0x0][_0x2afdf6(0x186)]==_0x2afdf6(0x100))var _0x26b247=users[_0x2afdf6(0x100)];else{if(_0x3e8eca[0x0][_0x2afdf6(0x186)]=='Arabic\x20(ae)')var _0x26b247=users[_0x2afdf6(0x1cb)];}}}}}}}_0x456e5e[_0x2afdf6(0xb7)](_0x2afdf6(0x1d2),{'success':_0x2e33f[_0x2afdf6(0x120)]('success'),'errors':_0x2e33f[_0x2afdf6(0x120)](_0x2afdf6(0x197)),'alldata':_0x1bb250,'profile':_0x1037ac,'master_shop':_0x3e8eca,'role':_0x4645bc,'product_stock':_0x5f235e,'language':_0x26b247,'staff_arr':_0x136469,'staff_data_all':_0x429417});}catch(_0xf5ecb9){}}),router[a0_0x4e65fc(0xfb)](a0_0x4e65fc(0xdc),auth,async(_0x3754bd,_0x525881)=>{const _0x223572=a0_0x4e65fc;try{const {from:_0x5eb10d,to:_0x33a00b,staff_data:_0x72352f}=_0x3754bd[_0x223572(0xbe)],_0x550da8=await Reference[_0x223572(0x14a)]([{'$match':{'date_include':{'$gte':_0x5eb10d,'$lte':_0x33a00b},'staff_id':_0x72352f}},{'$sort':{'date_include':0x1}}]);_0x525881[_0x223572(0xe4)](_0x550da8);}catch(_0x268aee){_0x525881[_0x223572(0xe4)](_0x268aee);}}),router[a0_0x4e65fc(0xfb)]('/getDSSR_no_sales',auth,async(_0x2cb1ef,_0x1a30a7)=>{const _0x334dd5=a0_0x4e65fc;try{const {from:_0x3eba38,to:_0x2229c2}=_0x2cb1ef['body'],{sttaff_id:_0x47f27f}=_0x2cb1ef[_0x334dd5(0x209)],_0x1e0514=await Reference[_0x334dd5(0x14a)]([{'$match':{'date_include':{'$gte':_0x3eba38,'$lte':_0x2229c2},'staff_id':_0x47f27f}},{'$sort':{'date_include':0x1}}]);_0x1a30a7[_0x334dd5(0xe4)](_0x1e0514);}catch(_0xf8b564){_0x1a30a7[_0x334dd5(0xe4)](_0xf8b564);}}),router['get']('/dsrr_admin/view_data/:id',auth,async(_0x4708d5,_0x339c1c)=>{const _0x1eaa87=a0_0x4e65fc;try{const _0x3b9737=_0x4708d5['params']['id'],_0x430314=await Reference[_0x1eaa87(0x126)](_0x3b9737);let _0x1911ed='';_0x1911ed+=_0x430314[_0x1eaa87(0x1ba)],_0x1911ed+=_0x1eaa87(0xef),_0x1911ed+=_0x1eaa87(0x1bb),_0x1911ed+=_0x1eaa87(0x14d),_0x1911ed+='};',_0x1911ed+='</script>',_0x339c1c[_0x1eaa87(0x110)](_0x1911ed);}catch(_0xc99314){_0x339c1c[_0x1eaa87(0xe4)](_0xc99314);}}),router['post'](a0_0x4e65fc(0x195),auth,async(_0x470635,_0x1ea027)=>{const _0x41469a=a0_0x4e65fc;try{const {ref_data:_0x2d289c}=_0x470635[_0x41469a(0xbe)],_0x4392d6=_0x2d289c[_0x41469a(0x15d)]('~'),_0x3ea858=_0x4392d6[_0x41469a(0x15c)](_0x16e0e0=>_0x16e0e0!==''),_0xcdfd57=await Reference[_0x41469a(0x14a)]([{'$match':{'referenceNumber':{'$in':_0x3ea858}}}]),_0x139d23=XLSX[_0x41469a(0x149)]['book_new']();_0xcdfd57[_0x41469a(0x1ff)](_0xe06917=>{const _0x5ce628=_0x41469a,_0x10ed7c=cheerio[_0x5ce628(0xdd)](_0xe06917[_0x5ce628(0x1ba)]);let _0xdc8bae=[],_0x50572e=[],_0xb36c1c=[];_0x10ed7c(_0x5ce628(0x13a))[_0x5ce628(0x1eb)]((_0x4b3422,_0x2159e0)=>{const _0x2ed97f=_0x5ce628;let _0xbcf8d8=[],_0x1bf486=0x0;while(_0xb36c1c[_0x1bf486]){_0xb36c1c[_0x1bf486]--,_0x1bf486++;}_0x10ed7c(_0x2159e0)[_0x2ed97f(0x179)]('td,\x20th')[_0x2ed97f(0x1eb)]((_0xf9a28c,_0x14ebb6)=>{const _0x57cdd3=_0x2ed97f;let _0x5a98e6=_0x10ed7c(_0x14ebb6)[_0x57cdd3(0xe3)]()[_0x57cdd3(0xde)](),_0x177c83=parseFloat(_0x5a98e6[_0x57cdd3(0x1b2)](/,/g,''));isNaN(_0x177c83)&&(_0x177c83=_0x5a98e6);let _0x30c14d=parseInt(_0x10ed7c(_0x14ebb6)[_0x57cdd3(0xdf)](_0x57cdd3(0x1e2)))||0x1,_0x48db09=parseInt(_0x10ed7c(_0x14ebb6)['attr'](_0x57cdd3(0x1a2)))||0x1;_0xbcf8d8[_0x1bf486]=_0x177c83;(_0x30c14d>0x1||_0x48db09>0x1)&&_0x50572e[_0x57cdd3(0x1f2)]({'s':{'r':_0x4b3422,'c':_0x1bf486},'e':{'r':_0x4b3422+_0x48db09-0x1,'c':_0x1bf486+_0x30c14d-0x1}});for(let _0x2e38b4=0x0;_0x2e38b4<_0x30c14d;_0x2e38b4++){_0x48db09>0x1&&(_0xb36c1c[_0x1bf486+_0x2e38b4]=_0x48db09-0x1);}_0x1bf486+=_0x30c14d;}),_0xdc8bae[_0x2ed97f(0x1f2)](_0xbcf8d8);});const _0x5305ba=XLSX['utils'][_0x5ce628(0x164)](_0xdc8bae);_0x50572e['length']>0x0&&(_0x5305ba[_0x5ce628(0x187)]=_0x50572e),_0x5305ba[_0x5ce628(0x204)]=_0xdc8bae[0x0][_0x5ce628(0xc3)](()=>({'wpx':0x64})),XLSX[_0x5ce628(0x149)][_0x5ce628(0x18e)](_0x139d23,_0x5305ba,_0xe06917[_0x5ce628(0xc8)]);});const _0x15b0dc=XLSX[_0x41469a(0x20d)](_0x139d23,{'bookType':'xlsx','type':_0x41469a(0x177)});_0x1ea027[_0x41469a(0xba)]('Content-Disposition',_0x41469a(0x116)),_0x1ea027[_0x41469a(0xba)](_0x41469a(0xa7),_0x41469a(0x184)),_0x1ea027[_0x41469a(0x110)](_0x15b0dc);}catch(_0x498c61){_0x1ea027['json'](_0x498c61);}}),router[a0_0x4e65fc(0xfb)](a0_0x4e65fc(0x1aa),auth,async(_0x3ed16b,_0x10475e)=>{const _0xfebc94=a0_0x4e65fc,{from_date:_0x1f7e8f,agent_id:_0x5e8937}=_0x3ed16b[_0xfebc94(0xbe)],_0x1e0ce0=_0x3ed16b['user'],_0x153beb=await staff[_0xfebc94(0x18c)]({'email':_0x1e0ce0[_0xfebc94(0xac)]}),_0x2272a7=await master_shop[_0xfebc94(0x179)](),_0x524af8=await agentsdataDSICheck_DSRR(_0x1f7e8f,_0x5e8937,_0x5107dc);let _0x1ccc36='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20';var _0x28af31=new Date(_0x1f7e8f);const _0x5881f1={'year':_0xfebc94(0x118),'month':_0xfebc94(0x11f),'day':'numeric'},_0x48f099=new Intl['DateTimeFormat'](_0xfebc94(0x13e),_0x5881f1)['format'](_0x28af31);_0x1ccc36+=_0xfebc94(0x151),_0x1ccc36+=_0xfebc94(0x1b9),_0x1ccc36+=_0xfebc94(0x19e),_0x1ccc36+=_0x524af8,_0x1ccc36+=_0xfebc94(0x1c1),_0x1ccc36+=_0xfebc94(0x96),_0x1ccc36+=_0xfebc94(0x96);let _0x528933=_0xfebc94(0xb5);const _0x4d848e={'width':_0xfebc94(0x99),'height':'8.5in','orientation':_0xfebc94(0x180),'border':{'top':'0.1in','right':_0xfebc94(0xd5),'bottom':_0xfebc94(0xd5),'left':_0xfebc94(0xd5)},'header':{'height':_0xfebc94(0x17b),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x528933+_0xfebc94(0x9c)+_0x48f099+_0xfebc94(0xda)},'footer':{'height':_0xfebc94(0xa0),'contents':{'default':_0xfebc94(0x1e9)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0xfebc94(0x170)}}};var _0x5107dc='on';if(_0x5107dc=='on'){const _0x67b363=cheerio['load'](_0x1ccc36);let _0xd9b246=[],_0x23318d=[],_0x1a5724=[];_0x67b363(_0xfebc94(0x13a))[_0xfebc94(0x1eb)]((_0x59fc5e,_0x57d913)=>{const _0x2b820a=_0xfebc94;let _0x39e987=[],_0x585117=0x0;while(_0x1a5724[_0x585117]){_0x1a5724[_0x585117]--,_0x585117++;}_0x67b363(_0x57d913)[_0x2b820a(0x179)](_0x2b820a(0x1d4))['each']((_0x24a273,_0xde58af)=>{const _0x1b1793=_0x2b820a;let _0x398f6e=_0x67b363(_0xde58af)[_0x1b1793(0xe3)]()[_0x1b1793(0xde)](),_0x5d1565=parseFloat(_0x398f6e['replace'](/,/g,''));isNaN(_0x5d1565)&&(_0x5d1565=_0x398f6e);let _0x428a65=parseInt(_0x67b363(_0xde58af)[_0x1b1793(0xdf)](_0x1b1793(0x1e2)))||0x1,_0x4359ff=parseInt(_0x67b363(_0xde58af)[_0x1b1793(0xdf)](_0x1b1793(0x1a2)))||0x1;_0x39e987[_0x585117]=_0x5d1565;(_0x428a65>0x1||_0x4359ff>0x1)&&_0x23318d[_0x1b1793(0x1f2)]({'s':{'r':_0x59fc5e,'c':_0x585117},'e':{'r':_0x59fc5e+_0x4359ff-0x1,'c':_0x585117+_0x428a65-0x1}});for(let _0x171a81=0x0;_0x171a81<_0x428a65;_0x171a81++){_0x4359ff>0x1&&(_0x1a5724[_0x585117+_0x171a81]=_0x4359ff-0x1);}_0x585117+=_0x428a65;}),_0xd9b246['push'](_0x39e987);});const _0x10c52c=XLSX[_0xfebc94(0x149)][_0xfebc94(0xff)](),_0x35ecdf=XLSX[_0xfebc94(0x149)]['aoa_to_sheet'](_0xd9b246);_0x23318d[_0xfebc94(0x124)]>0x0&&(_0x35ecdf[_0xfebc94(0x187)]=_0x23318d);_0x35ecdf['!cols']=_0xd9b246[0x0][_0xfebc94(0xc3)](()=>({'wpx':0x64})),XLSX[_0xfebc94(0x149)][_0xfebc94(0x18e)](_0x10c52c,_0x35ecdf,_0xfebc94(0x138));const _0x682e0e=XLSX[_0xfebc94(0x20d)](_0x10c52c,{'bookType':'xlsx','type':'buffer'});_0x10475e['setHeader'](_0xfebc94(0x13f),_0xfebc94(0xd7)),_0x10475e[_0xfebc94(0xba)](_0xfebc94(0xa7),_0xfebc94(0x184)),_0x10475e[_0xfebc94(0x110)](_0x682e0e);}else pdf['create'](_0x1ccc36,_0x4d848e)[_0xfebc94(0xed)](function(_0x39b5c6,_0xc7670b){const _0x16c0df=_0xfebc94;if(_0x39b5c6){_0x10475e[_0x16c0df(0x16b)](0x1f4)[_0x16c0df(0x110)](_0x16c0df(0x1ac));return;}_0x10475e[_0x16c0df(0xba)](_0x16c0df(0xa7),'application/pdf'),_0xc7670b[_0x16c0df(0x143)](_0x10475e);});}),module[a0_0x4e65fc(0x8f)]=router;