const a0_0x54c9e9=a0_0x4a18;(function(_0x29ac1f,_0x386eb9){const _0x4e46d8=a0_0x4a18,_0x4653e5=_0x29ac1f();while(!![]){try{const _0x261702=parseInt(_0x4e46d8(0x137))/0x1*(-parseInt(_0x4e46d8(0x10e))/0x2)+parseInt(_0x4e46d8(0x1ae))/0x3*(parseInt(_0x4e46d8(0xee))/0x4)+-parseInt(_0x4e46d8(0x110))/0x5+parseInt(_0x4e46d8(0x174))/0x6*(parseInt(_0x4e46d8(0x198))/0x7)+parseInt(_0x4e46d8(0x12a))/0x8+parseInt(_0x4e46d8(0x197))/0x9+-parseInt(_0x4e46d8(0x247))/0xa*(parseInt(_0x4e46d8(0x1a1))/0xb);if(_0x261702===_0x386eb9)break;else _0x4653e5['push'](_0x4653e5['shift']());}catch(_0x77fd04){_0x4653e5['push'](_0x4653e5['shift']());}}}(a0_0x1905,0x50555));const express=require(a0_0x54c9e9(0x268)),res=require(a0_0x54c9e9(0x248)),app=express(),router=express[a0_0x54c9e9(0x1a4)](),multer=require(a0_0x54c9e9(0x160)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require('../models/all_models'),auth=require(a0_0x54c9e9(0x1c3)),users=require(a0_0x54c9e9(0x119)),excelJS=require(a0_0x54c9e9(0x10f)),XLSX=require('xlsx'),PDFDocument=require(a0_0x54c9e9(0xfb)),fs=require('fs'),blobStream=require(a0_0x54c9e9(0x11b)),JsBarcode=require(a0_0x54c9e9(0x1f4)),{Canvas}=require('canvas'),pdf=require(a0_0x54c9e9(0x1e5)),path=require(a0_0x54c9e9(0x24a)),mongoose=require('mongoose'),cheerio=require(a0_0x54c9e9(0x120));router['get'](a0_0x54c9e9(0x238),auth,async(_0x13aac8,_0x4c42fd)=>{const _0x3d63de=a0_0x54c9e9;try{const {username:_0x333474,email:_0x273718,role:_0x2bc1bc}=_0x13aac8[_0x3d63de(0xe6)],_0x23088c=_0x13aac8[_0x3d63de(0xe6)],_0x2fd166=await profile['findOne']({'email':_0x23088c[_0x3d63de(0x220)]}),_0x4a3f64={'year':_0x3d63de(0x235),'month':_0x3d63de(0x1f3),'day':_0x3d63de(0x235)},_0x242870=await master_shop['find']();console[_0x3d63de(0x187)](_0x3d63de(0x229),_0x242870);const _0x512dda=await product['find']();console['log']('Products\x20find_data',_0x512dda);const _0xa95c88=await warehouse[_0x3d63de(0x1b5)]([{'$unwind':_0x3d63de(0x103)},{'$lookup':{'from':_0x3d63de(0x1f5),'localField':_0x3d63de(0x14b),'foreignField':_0x3d63de(0x274),'as':_0x3d63de(0x18c)}},{'$unwind':_0x3d63de(0x1cd)},{'$project':{'product_name':_0x3d63de(0xf8),'product_stock':_0x3d63de(0x20e)}},{'$group':{'_id':_0x3d63de(0x1f8),'product_stock':{'$sum':_0x3d63de(0x242)}}}]);console['log']('Products\x20warehouse_data',_0xa95c88),_0xa95c88[_0x3d63de(0x107)](_0x172c4f=>{const _0x5824d8=_0x512dda['map'](_0x3be433=>{const _0x4ca70d=a0_0x4a18;_0x3be433[_0x4ca70d(0x274)]==_0x172c4f[_0x4ca70d(0x1ec)]&&(_0x3be433[_0x4ca70d(0x186)]=parseInt(_0x3be433[_0x4ca70d(0x186)])+parseInt(_0x172c4f[_0x4ca70d(0x136)]));});}),console['log'](_0x3d63de(0x20a),_0x512dda);if(_0x242870[0x0][_0x3d63de(0x142)]==_0x3d63de(0x1b9))var _0x506cab=users[_0x3d63de(0x207)];else{if(_0x242870[0x0]['language']==_0x3d63de(0x17e))var _0x506cab=users['Hindi'];else{if(_0x242870[0x0][_0x3d63de(0x142)]=='German')var _0x506cab=users[_0x3d63de(0x108)];else{if(_0x242870[0x0][_0x3d63de(0x142)]==_0x3d63de(0x1f2))var _0x506cab=users[_0x3d63de(0x1f2)];else{if(_0x242870[0x0]['language']==_0x3d63de(0x1c1))var _0x506cab=users['French'];else{if(_0x242870[0x0][_0x3d63de(0x142)]==_0x3d63de(0x213))var _0x506cab=users[_0x3d63de(0x23d)];else{if(_0x242870[0x0]['language']==_0x3d63de(0x255))var _0x506cab=users[_0x3d63de(0x255)];else{if(_0x242870[0x0][_0x3d63de(0x142)]==_0x3d63de(0x275))var _0x506cab=users[_0x3d63de(0x1bb)];}}}}}}}_0x4c42fd[_0x3d63de(0x1e9)](_0x3d63de(0xe5),{'success':_0x13aac8[_0x3d63de(0x23b)](_0x3d63de(0x1ea)),'errors':_0x13aac8[_0x3d63de(0x23b)](_0x3d63de(0xf2)),'alldata':_0x512dda,'profile':_0x2fd166,'master_shop':_0x242870,'role':_0x23088c,'product_stock':_0xa95c88,'language':_0x506cab});}catch(_0x5dc0cb){}});async function dataCheck(_0x51c2c0,_0x2c4a0f){const _0x4ce3c2=a0_0x54c9e9,_0x2aedb0=await product[_0x4ce3c2(0x1b5)]([{'$group':{'_id':{'brand':_0x4ce3c2(0x1b2),'category':_0x4ce3c2(0x19c)},'products':{'$push':{'name':'$name','product_code':_0x4ce3c2(0x234)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2a6abc=[];_0x2a6abc[_0x4ce3c2(0x205)]=[];for(let _0x3bda04=0x0;_0x3bda04<=_0x2aedb0[_0x4ce3c2(0x192)]-0x1;_0x3bda04++){const _0x5f1497=_0x2aedb0[_0x3bda04];_0x2a6abc[_0x4ce3c2(0x205)][_0x4ce3c2(0x190)](_0x5f1497);}const _0x1a635c=await product[_0x4ce3c2(0x1b5)]([{'$group':{'_id':{'category':_0x4ce3c2(0x19c)},'products':{'$push':{'brand':_0x4ce3c2(0x1b2),'product_code':_0x4ce3c2(0x234),'product_name':_0x4ce3c2(0x104)}}}},{'$sort':{'_id.category':-0x1}}]),_0x308618=await purchases_finished[_0x4ce3c2(0x1b5)]([{'$match':{'date':{'$gte':_0x51c2c0,'$lte':_0x2c4a0f}}},{'$unwind':_0x4ce3c2(0x172)},{'$group':{'_id':{'product_name':_0x4ce3c2(0x181),'product_code':_0x4ce3c2(0x16a)},'totalQTY':{'$sum':_0x4ce3c2(0x231)}}}]);_0x2a6abc[_0x4ce3c2(0x26f)]=[];for(let _0x34c519=0x0;_0x34c519<=_0x308618['length']-0x1;_0x34c519++){const _0x28394f=_0x308618[_0x34c519];_0x2a6abc['beg_bal'][_0x4ce3c2(0x190)](_0x28394f);}const _0x476506=await sales_sa[_0x4ce3c2(0x1b5)]([{'$match':{'date':{'$gte':_0x51c2c0,'$lte':_0x2c4a0f}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x4ce3c2(0x1cc)}}},{'$lookup':{'from':_0x4ce3c2(0x15f),'localField':_0x4ce3c2(0x258),'foreignField':_0x4ce3c2(0x1ec),'as':_0x4ce3c2(0x135)}},{'$unwind':_0x4ce3c2(0x1d4)},{'$unwind':_0x4ce3c2(0x245)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x4ce3c2(0x143),'product_code':_0x4ce3c2(0x131)},'totalQTY':{'$sum':_0x4ce3c2(0x184)}}}]);console[_0x4ce3c2(0x187)](_0x476506[0x0]),_0x2a6abc[_0x4ce3c2(0x214)]=[];for(let _0x31a8f9=0x0;_0x31a8f9<=_0x476506[_0x4ce3c2(0x192)]-0x1;_0x31a8f9++){const _0x393fd4=_0x476506[_0x31a8f9];_0x2a6abc[_0x4ce3c2(0x214)][_0x4ce3c2(0x190)](_0x393fd4);}const _0x174abe=await sales_sa[_0x4ce3c2(0x1b5)]([{'$match':{'date':{'$gte':_0x51c2c0,'$lte':_0x2c4a0f}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x4ce3c2(0x1cc)}}},{'$lookup':{'from':_0x4ce3c2(0x15f),'localField':_0x4ce3c2(0x258),'foreignField':_0x4ce3c2(0x1ec),'as':_0x4ce3c2(0x135)}},{'$unwind':_0x4ce3c2(0x1d4)},{'$unwind':_0x4ce3c2(0x245)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x4ce3c2(0x171)}},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x4ce3c2(0x131)},'totalQTY':{'$sum':_0x4ce3c2(0x18e)}}}]);_0x2a6abc['sales_ext']=[];for(let _0x192e00=0x0;_0x192e00<=_0x174abe[_0x4ce3c2(0x192)]-0x1;_0x192e00++){const _0x37af1a=_0x174abe[_0x192e00];_0x2a6abc[_0x4ce3c2(0x22d)][_0x4ce3c2(0x190)](_0x37af1a);}let _0x522e0d='';for(let _0x3ae0a5=0x0;_0x3ae0a5<=_0x1a635c[_0x4ce3c2(0x192)]-0x1;_0x3ae0a5++){const _0xdf8af0=_0x1a635c[_0x3ae0a5];_0x522e0d+=_0x4ce3c2(0xf4),_0x522e0d+='<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>'+_0xdf8af0['_id']['category']+_0x4ce3c2(0x21d),_0x522e0d+=_0x4ce3c2(0x1ab);for(let _0x4ed8b7=0x0;_0x4ed8b7<_0x2a6abc[_0x4ce3c2(0x205)]['length'];_0x4ed8b7++){const _0x4c4d04=_0x2a6abc[_0x4ce3c2(0x205)][_0x4ed8b7];if(_0x4c4d04[_0x4ce3c2(0x1ec)][_0x4ce3c2(0xec)]==_0xdf8af0[_0x4ce3c2(0x1ec)][_0x4ce3c2(0xec)]){let _0x2a7857=[],_0x2ee973=[],_0x269152=[];_0x2a7857[_0x4c4d04['_id'][_0x4ce3c2(0x22e)]]=[],_0x2ee973[_0x4c4d04['_id'][_0x4ce3c2(0x22e)]]=[],_0x269152[_0x4c4d04[_0x4ce3c2(0x1ec)][_0x4ce3c2(0x22e)]]=[];var _0x39a1c7=0x0,_0x4e452d=0x0,_0x2b8a94=0x0;for(let _0x10ca37=0x0;_0x10ca37<_0x4c4d04[_0x4ce3c2(0x1f5)][_0x4ce3c2(0x192)];_0x10ca37++){const _0x27eb57=_0x4c4d04[_0x4ce3c2(0x1f5)][_0x10ca37];for(let _0x1e860e=0x0;_0x1e860e<=_0x2a6abc[_0x4ce3c2(0x26f)][_0x4ce3c2(0x192)]-0x1;_0x1e860e++){const _0x4fb8c3=_0x2a6abc['beg_bal'][_0x1e860e];_0x4fb8c3[_0x4ce3c2(0x1ec)][_0x4ce3c2(0x1ac)]==_0x27eb57[_0x4ce3c2(0x274)]&&_0x4fb8c3[_0x4ce3c2(0x1ec)][_0x4ce3c2(0x11e)]==_0x27eb57[_0x4ce3c2(0x11e)]&&(_0x39a1c7+=parseInt(_0x4fb8c3[_0x4ce3c2(0x185)],0xa));}for(let _0x1725c0=0x0;_0x1725c0<=_0x2a6abc[_0x4ce3c2(0x22d)][_0x4ce3c2(0x192)]-0x1;_0x1725c0++){const _0x10ecfc=_0x2a6abc['sales_ext'][_0x1725c0];_0x10ecfc[_0x4ce3c2(0x1ec)]['product_name']==_0x27eb57[_0x4ce3c2(0x274)]&&_0x10ecfc[_0x4ce3c2(0x1ec)]['product_code']==_0x27eb57[_0x4ce3c2(0x11e)]&&(_0x4e452d+=parseFloat(_0x10ecfc[_0x4ce3c2(0x185)],0xa)[_0x4ce3c2(0x1e3)](0x2));}for(let _0x16ea47=0x0;_0x16ea47<=_0x2a6abc['sales_bkg'][_0x4ce3c2(0x192)]-0x1;_0x16ea47++){const _0x3859de=_0x2a6abc[_0x4ce3c2(0x214)][_0x16ea47];_0x3859de[_0x4ce3c2(0x1ec)]['product_name']==_0x27eb57[_0x4ce3c2(0x274)]&&_0x3859de[_0x4ce3c2(0x1ec)][_0x4ce3c2(0x11e)]==_0x27eb57[_0x4ce3c2(0x11e)]&&(_0x2b8a94+=parseInt(_0x3859de['totalQTY'],0xa));}}const _0x594903=new Intl[(_0x4ce3c2(0x236))]('en-US');var _0x362798=_0x594903[_0x4ce3c2(0x16e)](_0x39a1c7);_0x2a7857[_0x4c4d04[_0x4ce3c2(0x1ec)][_0x4ce3c2(0x22e)]][_0x4ce3c2(0x190)](_0x362798),_0x2ee973[_0x4c4d04[_0x4ce3c2(0x1ec)][_0x4ce3c2(0x22e)]][_0x4ce3c2(0x190)](_0x594903[_0x4ce3c2(0x16e)](_0x4e452d)),_0x269152[_0x4c4d04['_id'][_0x4ce3c2(0x22e)]][_0x4ce3c2(0x190)](_0x594903[_0x4ce3c2(0x16e)](_0x2b8a94));var _0x9935c4=_0x594903[_0x4ce3c2(0x16e)](_0x39a1c7-(_0x2b8a94+_0x4e452d));_0x522e0d+=_0x4ce3c2(0xf4),_0x522e0d+=_0x4ce3c2(0x168),_0x522e0d+=_0x4ce3c2(0x24b)+_0x4c4d04[_0x4ce3c2(0x1ec)]['brand']+_0x4ce3c2(0x21d),_0x522e0d+=_0x4ce3c2(0x24b)+_0x2a7857[_0x4c4d04[_0x4ce3c2(0x1ec)][_0x4ce3c2(0x22e)]][0x0]+_0x4ce3c2(0x21d),_0x522e0d+=_0x4ce3c2(0x253),_0x522e0d+=_0x4ce3c2(0x24b)+_0x269152[_0x4c4d04[_0x4ce3c2(0x1ec)][_0x4ce3c2(0x22e)]][0x0]+_0x4ce3c2(0x21d),_0x522e0d+=_0x4ce3c2(0x24b)+_0x2ee973[_0x4c4d04['_id']['brand']][0x0]+'</td>',_0x522e0d+=_0x4ce3c2(0x24b)+_0x9935c4+_0x4ce3c2(0x21d),_0x522e0d+=_0x4ce3c2(0x1ab);}}}return console[_0x4ce3c2(0x187)](_0x2a6abc[_0x4ce3c2(0x214)]),_0x522e0d;}router[a0_0x54c9e9(0x227)](a0_0x54c9e9(0x101),auth,async(_0x530564,_0x4a5e68)=>{const _0x34d09c=a0_0x54c9e9,{from_date:_0x14aa27,to_date:_0x481fe2}=_0x530564[_0x34d09c(0x133)],_0x166c24=await dataCheck(_0x14aa27,_0x481fe2);{}let _0x38cdf9=_0x34d09c(0x1c8);var _0x417681=new Date(_0x14aa27),_0x49beaf=new Date(_0x481fe2);const _0x42e9ff={'year':'numeric','month':_0x34d09c(0x1f3),'day':_0x34d09c(0x235)},_0x25a9a6=new Intl[(_0x34d09c(0x1dd))](_0x34d09c(0x161),_0x42e9ff)[_0x34d09c(0x16e)](_0x417681),_0x37e658=new Intl[(_0x34d09c(0x1dd))](_0x34d09c(0x161),_0x42e9ff)[_0x34d09c(0x16e)](_0x49beaf);_0x38cdf9+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0x38cdf9+=_0x34d09c(0xf5),_0x38cdf9+='<p>'+_0x25a9a6+_0x34d09c(0x177)+_0x37e658+_0x34d09c(0x218),_0x38cdf9+=_0x34d09c(0x1ad),_0x38cdf9+=_0x34d09c(0x14d),_0x38cdf9+=_0x34d09c(0x263),_0x38cdf9+=_0x34d09c(0xf4),_0x38cdf9+=_0x34d09c(0x1aa),_0x38cdf9+=_0x34d09c(0x144),_0x38cdf9+=_0x34d09c(0x24d)+_0x25a9a6+'</th>',_0x38cdf9+='<th\x20rowspan=\x272\x27>Production</th>',_0x38cdf9+=_0x34d09c(0x13f),_0x38cdf9+=_0x34d09c(0x14e)+_0x37e658+_0x34d09c(0x195),_0x38cdf9+='</tr>',_0x38cdf9+=_0x34d09c(0xf4),_0x38cdf9+=_0x34d09c(0x1bc),_0x38cdf9+=_0x34d09c(0x149),_0x38cdf9+=_0x34d09c(0x1ab),_0x38cdf9+=_0x166c24,_0x38cdf9+=_0x34d09c(0x128),_0x38cdf9+=_0x34d09c(0x147),_0x38cdf9+=_0x34d09c(0x147);const _0x1da99f={'format':_0x34d09c(0x102),'orientation':_0x34d09c(0x1de)};pdf[_0x34d09c(0x25a)](_0x38cdf9,_0x1da99f)['toStream'](function(_0x85ccfc,_0x54ce51){const _0x3b7915=_0x34d09c;if(_0x85ccfc){_0x4a5e68[_0x3b7915(0x271)](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x4a5e68['setHeader'](_0x3b7915(0x256),_0x3b7915(0x259)),_0x54ce51['pipe'](_0x4a5e68);});}),router['get'](a0_0x54c9e9(0x18a),auth,async(_0x35e6c6,_0x4c77c5)=>{const _0x1eaa59=a0_0x54c9e9;try{const {username:_0x201106,email:_0x2cf5b8,role:_0x54323b}=_0x35e6c6[_0x1eaa59(0xe6)],_0x19148f=_0x35e6c6[_0x1eaa59(0xe6)],_0x1155f9=await profile[_0x1eaa59(0x13d)]({'email':_0x19148f[_0x1eaa59(0x220)]}),_0x31c5f3={'year':_0x1eaa59(0x235),'month':_0x1eaa59(0x1f3),'day':_0x1eaa59(0x235)},_0x36545e=await master_shop['find'](),_0x3cea35=await product[_0x1eaa59(0x225)](),_0x424a68=await warehouse[_0x1eaa59(0x1b5)]([{'$unwind':'$product_details'},{'$lookup':{'from':'products','localField':_0x1eaa59(0x14b),'foreignField':_0x1eaa59(0x274),'as':'product_docs'}},{'$unwind':_0x1eaa59(0x1cd)},{'$project':{'product_name':_0x1eaa59(0xf8),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x1eaa59(0x1f8),'product_stock':{'$sum':_0x1eaa59(0x242)}}}]);if(_0x36545e[0x0]['language']=='English\x20(US)')var _0x25ee15=users['English'];else{if(_0x36545e[0x0][_0x1eaa59(0x142)]=='Hindi')var _0x25ee15=users[_0x1eaa59(0x17e)];else{if(_0x36545e[0x0][_0x1eaa59(0x142)]==_0x1eaa59(0x108))var _0x25ee15=users[_0x1eaa59(0x108)];else{if(_0x36545e[0x0][_0x1eaa59(0x142)]==_0x1eaa59(0x1f2))var _0x25ee15=users['Spanish'];else{if(_0x36545e[0x0]['language']==_0x1eaa59(0x1c1))var _0x25ee15=users[_0x1eaa59(0x1c1)];else{if(_0x36545e[0x0][_0x1eaa59(0x142)]=='Portuguese\x20(BR)')var _0x25ee15=users[_0x1eaa59(0x23d)];else{if(_0x36545e[0x0][_0x1eaa59(0x142)]==_0x1eaa59(0x255))var _0x25ee15=users[_0x1eaa59(0x255)];else{if(_0x36545e[0x0]['language']==_0x1eaa59(0x275))var _0x25ee15=users[_0x1eaa59(0x1bb)];}}}}}}}_0x4c77c5['render'](_0x1eaa59(0x1fe),{'success':_0x35e6c6[_0x1eaa59(0x23b)](_0x1eaa59(0x1ea)),'errors':_0x35e6c6[_0x1eaa59(0x23b)](_0x1eaa59(0xf2)),'alldata':_0x3cea35,'profile':_0x1155f9,'master_shop':_0x36545e,'role':_0x19148f,'product_stock':_0x424a68,'language':_0x25ee15});}catch(_0x3015f0){}});async function agentsdataCheck(_0x3d5bf6,_0x2b4c36){const _0x550e8e=a0_0x54c9e9,_0x18f083=await product[_0x550e8e(0x1b5)]([{'$group':{'_id':{'brand':_0x550e8e(0x1b2),'category':'$category'},'products':{'$push':{'name':_0x550e8e(0x104),'product_code':_0x550e8e(0x234)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x2ba24d=[];_0x2ba24d[_0x550e8e(0x205)]=[];for(let _0x5376d0=0x0;_0x5376d0<=_0x18f083[_0x550e8e(0x192)]-0x1;_0x5376d0++){const _0x788dfb=_0x18f083[_0x5376d0];_0x2ba24d[_0x550e8e(0x205)][_0x550e8e(0x190)](_0x788dfb);}const _0x590436=await product[_0x550e8e(0x1b5)]([{'$group':{'_id':{'category':_0x550e8e(0x19c)},'products':{'$push':{'brand':_0x550e8e(0x1b2),'product_code':_0x550e8e(0x234),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x41dae1=await product[_0x550e8e(0x1b5)]([{'$group':{'_id':{'category':_0x550e8e(0x19c),'brand':'$brand'}}},{'$group':{'_id':_0x550e8e(0x1fb),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4be28e=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x3d5bf6,'$lte':_0x2b4c36}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x550e8e(0x1cc)}}},{'$lookup':{'from':_0x550e8e(0x15f),'localField':_0x550e8e(0x258),'foreignField':_0x550e8e(0x1ec),'as':'sales_info'}},{'$unwind':'$sales_info'},{'$unwind':_0x550e8e(0x245)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x550e8e(0x171)}},{'$lookup':{'from':_0x550e8e(0x1f5),'localField':_0x550e8e(0x141),'foreignField':_0x550e8e(0x11e),'as':_0x550e8e(0x1ef)}},{'$unwind':'$product_info'},{'$group':{'_id':{'sales_id':'$sales_info._id','category':_0x550e8e(0x111),'brand':'$product_info.brand'},'salesman_data':{'$first':'$sales_info.name'},'totalQTY':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x550e8e(0x18e),'product_details':{'prod_name':_0x550e8e(0x17c),'product_code':_0x550e8e(0x1a0),'category':_0x550e8e(0x111),'brand':_0x550e8e(0x196)}}}}}]);let _0x5c165b='';_0x5c165b+=_0x550e8e(0xf4),_0x5c165b+=_0x550e8e(0x26d),_0x5c165b+='</tr>',_0x5c165b+='<tr>',_0x5c165b+='<td\x20class=\x22cat_data\x22></td>';for(let _0x5a993d=0x0;_0x5a993d<=_0x590436[_0x550e8e(0x192)]-0x1;_0x5a993d++){const _0x5881ba=_0x590436[_0x5a993d];for(let _0x177d72=0x0;_0x177d72<_0x41dae1[_0x550e8e(0x192)];_0x177d72++){const _0x3abcf7=_0x41dae1[_0x177d72];_0x3abcf7[_0x550e8e(0x1ec)]==_0x5881ba['_id']['category']&&(_0x5c165b+=_0x550e8e(0x1a7)+_0x3abcf7[_0x550e8e(0x25d)]+'\x22\x20class=\x22cat_data\x22>'+_0x5881ba[_0x550e8e(0x1ec)][_0x550e8e(0xec)]+_0x550e8e(0x21d));}}_0x5c165b+='<td\x20class=\x22cat_data\x22></td>',_0x5c165b+=_0x550e8e(0x1ab),_0x5c165b+=_0x550e8e(0xf4),_0x5c165b+=_0x550e8e(0x1ed);for(let _0xc30f72=0x0;_0xc30f72<=_0x590436[_0x550e8e(0x192)]-0x1;_0xc30f72++){const _0xe767cc=_0x590436[_0xc30f72];for(let _0x1f7d6e=0x0;_0x1f7d6e<_0x2ba24d['cat_brand']['length'];_0x1f7d6e++){const _0xc166f8=_0x2ba24d[_0x550e8e(0x205)][_0x1f7d6e];_0xc166f8['_id']['category']==_0xe767cc[_0x550e8e(0x1ec)][_0x550e8e(0xec)]&&(_0x5c165b+=_0x550e8e(0x173)+_0xc166f8[_0x550e8e(0x1ec)][_0x550e8e(0x22e)]+'</td>');}}_0x5c165b+=_0x550e8e(0x1b0),_0x5c165b+='</tr>';let _0x3fac01={'name':[],'dataqty':{}};for(let _0xb78dd6=0x0;_0xb78dd6<_0x2ba24d['cat_brand'][_0x550e8e(0x192)];_0xb78dd6++){const _0x365255=_0x2ba24d[_0x550e8e(0x205)][_0xb78dd6],_0x2906c5=_0x365255[_0x550e8e(0x1ec)][_0x550e8e(0x22e)],_0x302348=_0x365255['_id'][_0x550e8e(0xec)];!_0x3fac01['dataqty'][_0x2906c5]&&(_0x3fac01[_0x550e8e(0x175)][_0x2906c5]={});!_0x3fac01[_0x550e8e(0x175)][_0x2906c5][_0x302348]&&(_0x3fac01[_0x550e8e(0x175)][_0x2906c5][_0x302348]=[]);for(let _0x201356=0x0;_0x201356<_0x4be28e[_0x550e8e(0x192)];_0x201356++){const _0x26af33=_0x4be28e[_0x201356];if(_0x2906c5===_0x26af33['_id']['brand']&&_0x302348===_0x26af33[_0x550e8e(0x1ec)][_0x550e8e(0xec)]){const _0x26d7ff=_0x26af33[_0x550e8e(0x114)];!_0x3fac01['dataqty'][_0x2906c5][_0x302348][_0x26d7ff]&&(_0x3fac01[_0x550e8e(0x175)][_0x2906c5][_0x302348][_0x26d7ff]=[]),_0x3fac01[_0x550e8e(0x175)][_0x2906c5][_0x302348][_0x26d7ff]['push'](_0x26af33[_0x550e8e(0x185)]),!_0x3fac01[_0x550e8e(0x274)][_0x550e8e(0x1e8)](_0x26d7ff)&&_0x3fac01[_0x550e8e(0x274)][_0x550e8e(0x190)](_0x26d7ff);}}}_0x5c165b+=_0x550e8e(0xf4);for(let _0x5e2fb1=0x0;_0x5e2fb1<=_0x3fac01['name'][_0x550e8e(0x192)]-0x1;_0x5e2fb1++){const _0x8fd953=_0x3fac01[_0x550e8e(0x274)][_0x5e2fb1];_0x5c165b+=_0x550e8e(0x24b)+_0x8fd953+'</td>';var _0x9acaa3=0x0,_0x44ad23=0x0;for(let _0x5640b0=0x0;_0x5640b0<=_0x2ba24d['cat_brand'][_0x550e8e(0x192)]-0x1;_0x5640b0++){const _0x5d858a=_0x2ba24d[_0x550e8e(0x205)][_0x5640b0];var _0xdb17af=0x0;_0x3fac01[_0x550e8e(0x175)][_0x5d858a['_id']['brand']][_0x5d858a['_id'][_0x550e8e(0xec)]][_0x8fd953]?(_0xdb17af=_0x3fac01['dataqty'][_0x5d858a['_id'][_0x550e8e(0x22e)]][_0x5d858a[_0x550e8e(0x1ec)][_0x550e8e(0xec)]][_0x8fd953][0x0],_0x5c165b+='<td\x20class=\x22row_data\x22>'+formatNumber(_0xdb17af[_0x550e8e(0x1e3)](0x2))+'</td>'):(_0xdb17af=0x0,_0x5c165b+=_0x550e8e(0x24b)+_0xdb17af+_0x550e8e(0x21d)),_0x9acaa3+=_0xdb17af;}_0x5c165b+=_0x550e8e(0x24b)+formatNumber(_0x9acaa3[_0x550e8e(0x1e3)](0x2))+'</td>';}return _0x5c165b+='</tr>',_0x5c165b;}router[a0_0x54c9e9(0x227)]('/agent/pdf',auth,async(_0x2e749c,_0x944549)=>{const _0x1c1c1e=a0_0x54c9e9,{from_date:_0x2715eb,to_date:_0x482c1d}=_0x2e749c[_0x1c1c1e(0x133)],_0x4cafa7=await agentsdataCheck(_0x2715eb,_0x482c1d);{}let _0x250489=_0x1c1c1e(0x23a);var _0x355994=new Date(_0x2715eb),_0x2716e9=new Date(_0x482c1d);const _0x5dec4c={'year':_0x1c1c1e(0x235),'month':_0x1c1c1e(0x1f3),'day':_0x1c1c1e(0x235)},_0x50c4a7=new Intl[(_0x1c1c1e(0x1dd))](_0x1c1c1e(0x161),_0x5dec4c)['format'](_0x355994),_0x2018cb=new Intl['DateTimeFormat'](_0x1c1c1e(0x161),_0x5dec4c)['format'](_0x2716e9);_0x250489+=_0x1c1c1e(0x191),_0x250489+=_0x1c1c1e(0x15e),_0x250489+=_0x1c1c1e(0x112)+_0x50c4a7+_0x1c1c1e(0x177)+_0x2018cb+_0x1c1c1e(0x218),_0x250489+=_0x1c1c1e(0x1ad),_0x250489+=_0x1c1c1e(0x14d),_0x250489+='<table>',_0x250489+=_0x4cafa7,_0x250489+=_0x1c1c1e(0x128),_0x250489+=_0x1c1c1e(0x147),_0x250489+=_0x1c1c1e(0x147);const _0x2c43b9={'format':_0x1c1c1e(0x102),'orientation':_0x1c1c1e(0x1de)};pdf[_0x1c1c1e(0x25a)](_0x250489,_0x2c43b9)[_0x1c1c1e(0x1d2)](function(_0x7f60d5,_0x33ae7b){const _0x566bb0=_0x1c1c1e;if(_0x7f60d5){_0x944549[_0x566bb0(0x271)](0x1f4)[_0x566bb0(0x162)](_0x566bb0(0x262));return;}_0x944549[_0x566bb0(0x1c4)](_0x566bb0(0x256),_0x566bb0(0x259)),_0x33ae7b[_0x566bb0(0x21a)](_0x944549);});}),router[a0_0x54c9e9(0x1ba)](a0_0x54c9e9(0x199),auth,async(_0x3d23d5,_0x3c0d8f)=>{const _0x287b53=a0_0x54c9e9;try{const {username:_0x1cc269,email:_0x200c5a,role:_0x27136b}=_0x3d23d5[_0x287b53(0xe6)],_0x59c773=_0x3d23d5['user'],_0x2a9d81=await profile['findOne']({'email':_0x59c773[_0x287b53(0x220)]}),_0x52b2ed={'year':_0x287b53(0x235),'month':_0x287b53(0x1f3),'day':_0x287b53(0x235)},_0x531db4=await master_shop[_0x287b53(0x225)](),_0x538a0a=await staff['findOne']({'email':_0x59c773[_0x287b53(0x220)]}),_0x14ae02=await product[_0x287b53(0x225)](),_0x4854d1=await warehouse[_0x287b53(0x1b5)]([{'$unwind':_0x287b53(0x103)},{'$lookup':{'from':_0x287b53(0x1f5),'localField':'product_details.product_name','foreignField':'name','as':_0x287b53(0x18c)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x287b53(0xf8),'product_stock':_0x287b53(0x20e)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0x287b53(0x242)}}}]),_0x4721b4=await staff[_0x287b53(0x225)]({'account_category':'sa','type_of_acc_cat':'1'});if(_0x531db4[0x0]['language']==_0x287b53(0x1b9))var _0x3c3241=users['English'];else{if(_0x531db4[0x0][_0x287b53(0x142)]==_0x287b53(0x17e))var _0x3c3241=users[_0x287b53(0x17e)];else{if(_0x531db4[0x0][_0x287b53(0x142)]==_0x287b53(0x108))var _0x3c3241=users[_0x287b53(0x108)];else{if(_0x531db4[0x0]['language']==_0x287b53(0x1f2))var _0x3c3241=users[_0x287b53(0x1f2)];else{if(_0x531db4[0x0][_0x287b53(0x142)]==_0x287b53(0x1c1))var _0x3c3241=users['French'];else{if(_0x531db4[0x0][_0x287b53(0x142)]=='Portuguese\x20(BR)')var _0x3c3241=users[_0x287b53(0x23d)];else{if(_0x531db4[0x0]['language']==_0x287b53(0x255))var _0x3c3241=users['Chinese'];else{if(_0x531db4[0x0]['language']==_0x287b53(0x275))var _0x3c3241=users[_0x287b53(0x1bb)];}}}}}}}_0x3c0d8f['render']('dsi_sales_admin',{'success':_0x3d23d5[_0x287b53(0x23b)]('success'),'errors':_0x3d23d5[_0x287b53(0x23b)]('errors'),'alldata':_0x14ae02,'profile':_0x2a9d81,'master_shop':_0x531db4,'role':_0x59c773,'product_stock':_0x4854d1,'language':_0x3c3241,'staff_arr':_0x538a0a,'staff_data_all':_0x4721b4});}catch(_0x3b5d17){_0x3c0d8f[_0x287b53(0xe7)](_0x3b5d17);}});async function agentsdataDSICheck_admin(_0x8f940e,_0x174fc9,_0x4988ff,_0x5da7ac){const _0x4dfeb1=a0_0x54c9e9,_0x2ab078=await product[_0x4dfeb1(0x1b5)]([{'$group':{'_id':{'brand':_0x4dfeb1(0x1b2),'category':_0x4dfeb1(0x19c)},'products':{'$push':{'name':'$name','product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x365521=[];_0x365521['cat_brand']=[];for(let _0x1bd33f=0x0;_0x1bd33f<=_0x2ab078[_0x4dfeb1(0x192)]-0x1;_0x1bd33f++){const _0x5e495c=_0x2ab078[_0x1bd33f];_0x365521[_0x4dfeb1(0x205)][_0x4dfeb1(0x190)](_0x5e495c);}const _0x1f6bca=await product['aggregate']([{'$group':{'_id':{'category':_0x4dfeb1(0x19c)},'products':{'$push':{'brand':_0x4dfeb1(0x1b2),'product_code':_0x4dfeb1(0x234),'product_name':_0x4dfeb1(0x104)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4f480e=await product[_0x4dfeb1(0x1b5)]([{'$group':{'_id':{'category':'$category','brand':_0x4dfeb1(0x1b2)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2c11d5=await sales_sa[_0x4dfeb1(0x1b5)]([{'$match':{'date':{'$gte':_0x8f940e,'$lte':_0x174fc9},'sales_staff_id':_0x4988ff,'sale_product.isFG':_0x4dfeb1(0x171)}},{'$unwind':_0x4dfeb1(0x245)},{'$match':{'sale_product.isFG':_0x4dfeb1(0x171)}},{'$lookup':{'from':_0x4dfeb1(0x1f5),'localField':_0x4dfeb1(0x141),'foreignField':_0x4dfeb1(0x11e),'as':_0x4dfeb1(0x1ef)}},{'$unwind':_0x4dfeb1(0x167)},{'$group':{'_id':{'dsi':_0x4dfeb1(0x233),'date':'$date','customer':_0x4dfeb1(0x201)},'totalQty':{'$sum':_0x4dfeb1(0x18e)},'products':{'$push':{'qty':_0x4dfeb1(0x18e),'NetPrice':_0x4dfeb1(0x1ce),'discount':'$sale_product.discount','adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x4dfeb1(0x17c),'product_code':_0x4dfeb1(0x1a0),'category':_0x4dfeb1(0x111),'brand':_0x4dfeb1(0x196),'gross_price':_0x4dfeb1(0x124)}}}}},{'$unwind':_0x4dfeb1(0x230)},{'$group':{'_id':{'dsi':_0x4dfeb1(0x25f),'date':'$_id.date','customer':_0x4dfeb1(0x1a5),'category':_0x4dfeb1(0x1d6),'brand':_0x4dfeb1(0x166)},'totalQty':{'$sum':_0x4dfeb1(0x25c)},'totalGross':{'$sum':{'$multiply':[_0x4dfeb1(0x25c),_0x4dfeb1(0x13b)]}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x4dfeb1(0x1da)},'adj_discount':{'$sum':_0x4dfeb1(0x178)},'product_details':{'$first':_0x4dfeb1(0x20b)}}},{'$group':{'_id':{'dsi':_0x4dfeb1(0x25f),'date':_0x4dfeb1(0x15d),'customer':'$_id.customer'},'totalQty':{'$sum':_0x4dfeb1(0xe3)},'totalGross':{'$sum':_0x4dfeb1(0x1ee)},'NetPrice':{'$sum':_0x4dfeb1(0x170)},'discount':{'$sum':_0x4dfeb1(0x127)},'adj_discount':{'$sum':_0x4dfeb1(0x17f)},'products':{'$push':{'qty':'$totalQty','category':_0x4dfeb1(0x1fb),'brand':_0x4dfeb1(0x165),'product_details':_0x4dfeb1(0x103)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x5609a3=[],_0x7ba2cc={},_0x24e23a={},_0x56232d={};var _0x1c9f51=0x0,_0x9f0b70=0x0,_0x8639a9=0x0,_0x3d6cbe=0x0,_0x58dd52=0x0;const _0x3ec24a=0x6;for(let _0x322fd8=0x0;_0x322fd8<=_0x2c11d5[_0x4dfeb1(0x192)]-0x1;_0x322fd8++){const _0x5ebd57=_0x2c11d5[_0x322fd8];let _0x57cb6c=_0x4dfeb1(0xf4);_0x57cb6c+=_0x4dfeb1(0x24e)+_0x5ebd57[_0x4dfeb1(0x1ec)][_0x4dfeb1(0x1e0)]+_0x4dfeb1(0x21d),_0x57cb6c+=_0x4dfeb1(0x24e)+_0x5ebd57['_id'][_0x4dfeb1(0x209)]+'</td>',_0x57cb6c+=_0x4dfeb1(0x24e)+_0x5ebd57['_id'][_0x4dfeb1(0x219)]+_0x4dfeb1(0x21d);let _0x33efc8={};var _0x1f3ad3=0x0;for(let _0x2e8a8c=0x0;_0x2e8a8c<=_0x5ebd57[_0x4dfeb1(0x1f5)][_0x4dfeb1(0x192)]-0x1;_0x2e8a8c++){const _0x35c28c=_0x5ebd57[_0x4dfeb1(0x1f5)][_0x2e8a8c];_0x33efc8[_0x35c28c[_0x4dfeb1(0x22e)]+'-'+_0x35c28c['category']]=_0x35c28c[_0x4dfeb1(0x26e)];const _0x4e57f9=_0x35c28c['brand']+'-'+_0x35c28c[_0x4dfeb1(0xec)];!_0x7ba2cc[_0x4e57f9]&&(_0x7ba2cc[_0x4e57f9]=0x0),!Array[_0x4dfeb1(0x1c2)](_0x56232d[_0x4e57f9])&&(_0x56232d[_0x4e57f9]=[]),!Array[_0x4dfeb1(0x1c2)](_0x56232d[_0x4e57f9])&&(_0x56232d[_0x4e57f9]=[]),_0x7ba2cc[_0x4e57f9]+=_0x35c28c[_0x4dfeb1(0x26e)],_0x56232d[_0x4e57f9][_0x4dfeb1(0x190)](_0x35c28c[_0x4dfeb1(0x26e)]),_0x1f3ad3++;}console[_0x4dfeb1(0x187)](_0x5ebd57);for(let _0x4b195f=0x0;_0x4b195f<=_0x365521[_0x4dfeb1(0x205)][_0x4dfeb1(0x192)]-0x1;_0x4b195f++){const _0x4f6501=_0x365521[_0x4dfeb1(0x205)][_0x4b195f],_0x1a3c4f=_0x4f6501['_id']['brand']+'-'+_0x4f6501[_0x4dfeb1(0x1ec)][_0x4dfeb1(0xec)];_0x57cb6c+=_0x4dfeb1(0xfc)+(_0x33efc8[_0x1a3c4f]!==undefined?_0x33efc8[_0x1a3c4f]['toFixed'](0x2):'')+_0x4dfeb1(0x21d);}_0x8639a9=_0x5ebd57['discount']+_0x5ebd57[_0x4dfeb1(0x20c)],_0x57cb6c+=_0x4dfeb1(0x1cf)+formatNumber(parseFloat(_0x5ebd57[_0x4dfeb1(0xe9)],0x2)[_0x4dfeb1(0x1e3)](0x2))+'</td>',_0x57cb6c+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x5ebd57[_0x4dfeb1(0x1f9)][_0x4dfeb1(0x1e3)](0x2))+'</td>',_0x57cb6c+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x8639a9)+_0x4dfeb1(0x21d),_0x57cb6c+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x5ebd57[_0x4dfeb1(0x252)][_0x4dfeb1(0x1e3)](0x2))+_0x4dfeb1(0x21d),_0x57cb6c+=_0x4dfeb1(0x1ab),_0x1c9f51+=parseFloat(_0x5ebd57['totalQty'][_0x4dfeb1(0x1e3)](0x2)),_0x9f0b70+=parseFloat(_0x5ebd57[_0x4dfeb1(0x252)][_0x4dfeb1(0x1e3)](0x2)),_0x3d6cbe+=_0x8639a9,_0x58dd52+=parseFloat(_0x5ebd57[_0x4dfeb1(0x1f9)][_0x4dfeb1(0x1e3)](0x2));if(_0x322fd8==_0x2c11d5[_0x4dfeb1(0x192)]-0x1){_0x57cb6c+=_0x4dfeb1(0xf4),_0x57cb6c+=_0x4dfeb1(0x221),_0x57cb6c+='</td>';for(let _0x348bdc=0x0;_0x348bdc<=_0x365521[_0x4dfeb1(0x205)][_0x4dfeb1(0x192)]-0x1;_0x348bdc++){const _0x3529dd=_0x365521[_0x4dfeb1(0x205)][_0x348bdc],_0x3ccbdb=_0x3529dd['_id'][_0x4dfeb1(0x22e)]+'-'+_0x3529dd[_0x4dfeb1(0x1ec)][_0x4dfeb1(0xec)],_0x10e844=_0x56232d[_0x3ccbdb][_0x4dfeb1(0x145)]((_0x245a68,_0x12d084)=>_0x245a68+_0x12d084,0x0);console[_0x4dfeb1(0x187)](_0x4dfeb1(0x12f),_0x3ccbdb),_0x57cb6c+=_0x4dfeb1(0x1d7)+(_0x10e844!==undefined?formatNumber(_0x10e844[_0x4dfeb1(0x1e3)](0x2)):'')+_0x4dfeb1(0x257),console[_0x4dfeb1(0x187)](_0x56232d[_0x3ccbdb][_0x4dfeb1(0x145)]((_0x35f6ec,_0x39dad1)=>_0x35f6ec+_0x39dad1,0x0));}_0x57cb6c+=_0x4dfeb1(0x182)+formatNumber(_0x1c9f51['toFixed'](0x2))+_0x4dfeb1(0x257),_0x57cb6c+=_0x4dfeb1(0x182)+formatNumber(_0x58dd52)+'</b></td>',_0x57cb6c+=_0x4dfeb1(0x182)+formatNumber(_0x3d6cbe)+_0x4dfeb1(0x257),_0x57cb6c+=_0x4dfeb1(0x182)+formatNumber(_0x9f0b70)+_0x4dfeb1(0x257),_0x57cb6c+=_0x4dfeb1(0x1ab);}_0x5609a3[_0x4dfeb1(0x190)](_0x57cb6c);}function _0x456375(_0x56b376,_0x483bef){const _0x37d46f=_0x4dfeb1,_0x363bd1=[];for(let _0x39d117=0x0;_0x39d117<=_0x56b376[_0x37d46f(0x192)]-0x1;_0x39d117+=_0x483bef){_0x363bd1[_0x37d46f(0x190)](_0x56b376[_0x37d46f(0x100)](_0x39d117,_0x39d117+_0x483bef));}return _0x363bd1;}const _0x2d04f6=_0x456375(_0x5609a3,_0x3ec24a);let _0xae3d24='';return _0x2d04f6[_0x4dfeb1(0x107)]((_0x5de234,_0x49d578)=>{const _0x4dd255=_0x4dfeb1;_0x49d578>0x0&&(_0xae3d24+=_0x4dd255(0x21e));_0xae3d24+=_0x4dd255(0x263),_0xae3d24+='<thead>',_0xae3d24+=_0x4dd255(0xf4),_0xae3d24+=_0x4dd255(0x12d),_0xae3d24+=_0x4dd255(0x1ab),_0xae3d24+='<tr>',_0xae3d24+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x1fb606=0x0;_0x1fb606<=_0x1f6bca[_0x4dd255(0x192)]-0x1;_0x1fb606++){const _0x1956ec=_0x1f6bca[_0x1fb606];for(let _0x20abe1=0x0;_0x20abe1<_0x4f480e['length'];_0x20abe1++){const _0x5a284e=_0x4f480e[_0x20abe1];_0x5a284e['_id']===_0x1956ec['_id'][_0x4dd255(0xec)]&&(_0xae3d24+=_0x4dd255(0x1a7)+_0x5a284e[_0x4dd255(0x25d)]+_0x4dd255(0x215)+_0x1956ec[_0x4dd255(0x1ec)][_0x4dd255(0xec)]+_0x4dd255(0x21d));}}_0xae3d24+=_0x4dd255(0x1d5),_0xae3d24+=_0x4dd255(0x1ab),_0xae3d24+=_0x4dd255(0xf4),_0xae3d24+=_0x4dd255(0x139),_0xae3d24+=_0x4dd255(0x204),_0xae3d24+=_0x4dd255(0xea);for(let _0x4c9fc9=0x0;_0x4c9fc9<=_0x1f6bca[_0x4dd255(0x192)]-0x1;_0x4c9fc9++){const _0x2534d0=_0x1f6bca[_0x4c9fc9];for(let _0xb96729=0x0;_0xb96729<_0x365521[_0x4dd255(0x205)][_0x4dd255(0x192)];_0xb96729++){const _0x5c56d6=_0x365521['cat_brand'][_0xb96729];_0x5c56d6['_id'][_0x4dd255(0xec)]===_0x2534d0[_0x4dd255(0x1ec)][_0x4dd255(0xec)]&&(_0xae3d24+=_0x4dd255(0x173)+_0x5c56d6[_0x4dd255(0x1ec)][_0x4dd255(0x22e)]+_0x4dd255(0x21d));}}_0xae3d24+=_0x4dd255(0x1b0),_0xae3d24+=_0x4dd255(0x216),_0xae3d24+='<td\x20class=\x22cat_data\x22>DISCOUNT</td>',_0xae3d24+=_0x4dd255(0x148),_0xae3d24+='</tr>',_0xae3d24+='</thead>',_0xae3d24+=_0x4dd255(0x19f),_0x5de234[_0x4dd255(0x107)](_0xd0654f=>{_0xae3d24+=_0xd0654f;}),console[_0x4dd255(0x187)](_0x56232d),_0xae3d24+=_0x4dd255(0xeb),_0xae3d24+=_0x4dd255(0x128);}),_0xae3d24;}async function agentsdataDSICheck_admin_excel(_0x2dbeb9,_0x471223,_0x15bcd3,_0x40bb83){const _0xb08063=a0_0x54c9e9,_0x17ad0c=await product['aggregate']([{'$group':{'_id':{'brand':_0xb08063(0x1b2),'category':_0xb08063(0x19c)},'products':{'$push':{'name':_0xb08063(0x104),'product_code':_0xb08063(0x234)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x20cad2=[];_0x20cad2[_0xb08063(0x205)]=[];for(let _0x1eba17=0x0;_0x1eba17<=_0x17ad0c[_0xb08063(0x192)]-0x1;_0x1eba17++){const _0x5daf97=_0x17ad0c[_0x1eba17];_0x20cad2[_0xb08063(0x205)][_0xb08063(0x190)](_0x5daf97);}const _0x729c01=await product[_0xb08063(0x1b5)]([{'$group':{'_id':{'category':_0xb08063(0x19c)},'products':{'$push':{'brand':_0xb08063(0x1b2),'product_code':_0xb08063(0x234),'product_name':_0xb08063(0x104)}}}},{'$sort':{'_id.category':-0x1}}]),_0x42af81=await product[_0xb08063(0x1b5)]([{'$group':{'_id':{'category':'$category','brand':_0xb08063(0x1b2)}}},{'$group':{'_id':_0xb08063(0x1fb),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x3316d1=await sales_sa['aggregate']([{'$match':{'date':{'$gte':_0x2dbeb9,'$lte':_0x471223},'sales_staff_id':_0x15bcd3,'sale_product.isFG':'false'}},{'$unwind':_0xb08063(0x245)},{'$match':{'sale_product.isFG':_0xb08063(0x171)}},{'$lookup':{'from':_0xb08063(0x1f5),'localField':_0xb08063(0x141),'foreignField':_0xb08063(0x11e),'as':_0xb08063(0x1ef)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0xb08063(0x233),'date':_0xb08063(0x12e),'customer':_0xb08063(0x201)},'totalQty':{'$sum':_0xb08063(0x18e)},'products':{'$push':{'qty':_0xb08063(0x18e),'NetPrice':_0xb08063(0x1ce),'discount':_0xb08063(0x1b3),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0xb08063(0x17c),'product_code':_0xb08063(0x1a0),'category':'$product_info.category','brand':_0xb08063(0x196),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0xb08063(0x25f),'date':_0xb08063(0x15d),'customer':'$_id.customer','category':_0xb08063(0x1d6),'brand':_0xb08063(0x166)},'totalQty':{'$sum':_0xb08063(0x25c)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0xb08063(0x13b)]}},'NetPrice':{'$sum':_0xb08063(0x115)},'discount':{'$sum':_0xb08063(0x1da)},'adj_discount':{'$sum':_0xb08063(0x178)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0xb08063(0x25f),'date':_0xb08063(0x15d),'customer':_0xb08063(0x1a5)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':'$totalGross'},'NetPrice':{'$sum':_0xb08063(0x170)},'discount':{'$sum':_0xb08063(0x127)},'adj_discount':{'$sum':_0xb08063(0x17f)},'products':{'$push':{'qty':_0xb08063(0xe3),'category':_0xb08063(0x1fb),'brand':_0xb08063(0x165),'product_details':_0xb08063(0x103)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x36693e=[],_0x4e7bd4={},_0x3adb86={},_0x170aec={};var _0x19d8cb=0x0,_0x13e493=0x0,_0x1fe8ce=0x0,_0x5cecb4=0x0,_0x50edb0=0x0;const _0x411ff3=0x16345785d8a0000;for(let _0x1d249f=0x0;_0x1d249f<=_0x3316d1['length']-0x1;_0x1d249f++){const _0x31d4d5=_0x3316d1[_0x1d249f];let _0x5c3e91='<tr>';_0x5c3e91+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x31d4d5[_0xb08063(0x1ec)][_0xb08063(0x1e0)]+'</td>',_0x5c3e91+=_0xb08063(0x24e)+_0x31d4d5[_0xb08063(0x1ec)]['date']+_0xb08063(0x21d),_0x5c3e91+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x31d4d5[_0xb08063(0x1ec)]['customer']+'</td>';let _0x5525e3={};var _0x132dce=0x0;for(let _0x40acf9=0x0;_0x40acf9<=_0x31d4d5['products'][_0xb08063(0x192)]-0x1;_0x40acf9++){const _0x40e1ca=_0x31d4d5[_0xb08063(0x1f5)][_0x40acf9];_0x5525e3[_0x40e1ca[_0xb08063(0x22e)]+'-'+_0x40e1ca[_0xb08063(0xec)]]=_0x40e1ca['qty'];const _0x3f7783=_0x40e1ca[_0xb08063(0x22e)]+'-'+_0x40e1ca[_0xb08063(0xec)];!_0x4e7bd4[_0x3f7783]&&(_0x4e7bd4[_0x3f7783]=0x0),!Array[_0xb08063(0x1c2)](_0x170aec[_0x3f7783])&&(_0x170aec[_0x3f7783]=[]),!Array['isArray'](_0x170aec[_0x3f7783])&&(_0x170aec[_0x3f7783]=[]),_0x4e7bd4[_0x3f7783]+=_0x40e1ca[_0xb08063(0x26e)],_0x170aec[_0x3f7783]['push'](_0x40e1ca[_0xb08063(0x26e)]),_0x132dce++;}console[_0xb08063(0x187)](_0x31d4d5);for(let _0x1dc294=0x0;_0x1dc294<=_0x20cad2[_0xb08063(0x205)]['length']-0x1;_0x1dc294++){const _0x29c1c5=_0x20cad2[_0xb08063(0x205)][_0x1dc294],_0x12b9fd=_0x29c1c5[_0xb08063(0x1ec)][_0xb08063(0x22e)]+'-'+_0x29c1c5[_0xb08063(0x1ec)][_0xb08063(0xec)];_0x5c3e91+=_0xb08063(0xfc)+(_0x5525e3[_0x12b9fd]!==undefined?_0x5525e3[_0x12b9fd][_0xb08063(0x1e3)](0x2):'')+'</td>';}_0x1fe8ce=_0x31d4d5['discount']+_0x31d4d5['adj_discount'],_0x5c3e91+=_0xb08063(0x1cf)+formatNumber(parseFloat(_0x31d4d5[_0xb08063(0xe9)],0x2)[_0xb08063(0x1e3)](0x2))+_0xb08063(0x21d),_0x5c3e91+=_0xb08063(0x1cf)+formatNumber(_0x31d4d5['totalGross'][_0xb08063(0x1e3)](0x2))+_0xb08063(0x21d),_0x5c3e91+=_0xb08063(0x1cf)+formatNumber(_0x1fe8ce)+_0xb08063(0x21d),_0x5c3e91+=_0xb08063(0x1cf)+formatNumber(_0x31d4d5[_0xb08063(0x252)][_0xb08063(0x1e3)](0x2))+'</td>',_0x5c3e91+=_0xb08063(0x1ab),_0x19d8cb+=parseFloat(_0x31d4d5[_0xb08063(0xe9)][_0xb08063(0x1e3)](0x2)),_0x13e493+=parseFloat(_0x31d4d5[_0xb08063(0x252)][_0xb08063(0x1e3)](0x2)),_0x5cecb4+=_0x1fe8ce,_0x50edb0+=parseFloat(_0x31d4d5[_0xb08063(0x1f9)][_0xb08063(0x1e3)](0x2));if(_0x1d249f==_0x3316d1['length']-0x1){_0x5c3e91+='<tr>',_0x5c3e91+=_0xb08063(0x221),_0x5c3e91+=_0xb08063(0x21d);for(let _0x172923=0x0;_0x172923<=_0x20cad2[_0xb08063(0x205)][_0xb08063(0x192)]-0x1;_0x172923++){const _0x576cf7=_0x20cad2['cat_brand'][_0x172923],_0x2e08a6=_0x576cf7['_id']['brand']+'-'+_0x576cf7[_0xb08063(0x1ec)][_0xb08063(0xec)],_0x32f212=_0x170aec[_0x2e08a6][_0xb08063(0x145)]((_0x149ad1,_0x244a7a)=>_0x149ad1+_0x244a7a,0x0);console['log'](_0xb08063(0x12f),_0x2e08a6),_0x5c3e91+=_0xb08063(0x1d7)+(_0x32f212!==undefined?formatNumber(_0x32f212[_0xb08063(0x1e3)](0x2)):'')+'</b></td>',console[_0xb08063(0x187)](_0x170aec[_0x2e08a6]['reduce']((_0x143a5e,_0x295578)=>_0x143a5e+_0x295578,0x0));}_0x5c3e91+=_0xb08063(0x182)+formatNumber(_0x19d8cb[_0xb08063(0x1e3)](0x2))+_0xb08063(0x257),_0x5c3e91+=_0xb08063(0x182)+formatNumber(_0x50edb0)+_0xb08063(0x257),_0x5c3e91+=_0xb08063(0x182)+formatNumber(_0x5cecb4)+_0xb08063(0x257),_0x5c3e91+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x13e493)+_0xb08063(0x257),_0x5c3e91+=_0xb08063(0x1ab);}_0x36693e[_0xb08063(0x190)](_0x5c3e91);}function _0x27daa0(_0xbdf538,_0x57a798){const _0x437bdc=_0xb08063,_0x21834c=[];for(let _0x30359c=0x0;_0x30359c<=_0xbdf538['length']-0x1;_0x30359c+=_0x57a798){_0x21834c[_0x437bdc(0x190)](_0xbdf538[_0x437bdc(0x100)](_0x30359c,_0x30359c+_0x57a798));}return _0x21834c;}const _0xfb28d2=_0x27daa0(_0x36693e,_0x411ff3);let _0x1e058e='';return _0xfb28d2[_0xb08063(0x107)]((_0x1aa4e5,_0x1d5867)=>{const _0x1f8571=_0xb08063;_0x1d5867>0x0&&(_0x1e058e+=_0x1f8571(0x21e));_0x1e058e+='<table>',_0x1e058e+='<thead>',_0x1e058e+='<tr>',_0x1e058e+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x1e058e+=_0x1f8571(0x1ab),_0x1e058e+=_0x1f8571(0xf4),_0x1e058e+=_0x1f8571(0x261);for(let _0x95db55=0x0;_0x95db55<=_0x729c01[_0x1f8571(0x192)]-0x1;_0x95db55++){const _0x4e8d3a=_0x729c01[_0x95db55];for(let _0x201c18=0x0;_0x201c18<_0x42af81[_0x1f8571(0x192)];_0x201c18++){const _0x2eac59=_0x42af81[_0x201c18];_0x2eac59[_0x1f8571(0x1ec)]===_0x4e8d3a['_id'][_0x1f8571(0xec)]&&(_0x1e058e+=_0x1f8571(0x1a7)+_0x2eac59['brandCount']+_0x1f8571(0x215)+_0x4e8d3a[_0x1f8571(0x1ec)][_0x1f8571(0xec)]+'</td>');}}_0x1e058e+=_0x1f8571(0x1d5),_0x1e058e+=_0x1f8571(0x1ab),_0x1e058e+=_0x1f8571(0xf4),_0x1e058e+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x1e058e+=_0x1f8571(0x204),_0x1e058e+=_0x1f8571(0xea);for(let _0x212232=0x0;_0x212232<=_0x729c01[_0x1f8571(0x192)]-0x1;_0x212232++){const _0x5eb842=_0x729c01[_0x212232];for(let _0x521316=0x0;_0x521316<_0x20cad2['cat_brand'][_0x1f8571(0x192)];_0x521316++){const _0x47f5be=_0x20cad2['cat_brand'][_0x521316];_0x47f5be['_id']['category']===_0x5eb842[_0x1f8571(0x1ec)][_0x1f8571(0xec)]&&(_0x1e058e+=_0x1f8571(0x173)+_0x47f5be[_0x1f8571(0x1ec)][_0x1f8571(0x22e)]+_0x1f8571(0x21d));}}_0x1e058e+=_0x1f8571(0x1b0),_0x1e058e+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x1e058e+=_0x1f8571(0x265),_0x1e058e+=_0x1f8571(0x148),_0x1e058e+='</tr>',_0x1e058e+=_0x1f8571(0xf6),_0x1e058e+=_0x1f8571(0x19f),_0x1aa4e5['forEach'](_0x1ec8ab=>{_0x1e058e+=_0x1ec8ab;}),console[_0x1f8571(0x187)](_0x170aec),_0x1e058e+=_0x1f8571(0xeb),_0x1e058e+=_0x1f8571(0x128);}),_0x1e058e;}router[a0_0x54c9e9(0x227)](a0_0x54c9e9(0x126),auth,async(_0x475d7f,_0x1c78f4)=>{const _0x191c15=a0_0x54c9e9,{from_date:_0xb95518,to_date:_0x4949f5,isExcel:_0x274142,agent_id:_0x4bd9ec}=_0x475d7f[_0x191c15(0x133)],_0x25550a=_0x475d7f['user'],_0x3c5afb=await staff[_0x191c15(0x13d)]({'email':_0x25550a[_0x191c15(0x220)]}),_0x4caeb=await master_shop[_0x191c15(0x225)](),_0x61168=await agentsdataDSICheck_admin(_0xb95518,_0x4949f5,_0x4bd9ec,_0x274142),_0x2d19fc=await agentsdataDSICheck_admin_excel(_0xb95518,_0x4949f5,_0x4bd9ec,_0x274142);let _0x3d6478='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x3815bc=new Date(_0xb95518),_0x30c2ec=new Date(_0x4949f5);const _0xddcb13={'year':'numeric','month':_0x191c15(0x1f3),'day':_0x191c15(0x235)},_0x5b52c6=new Intl[(_0x191c15(0x1dd))](_0x191c15(0x161),_0xddcb13)['format'](_0x3815bc),_0x323646=new Intl['DateTimeFormat']('en-US',_0xddcb13)[_0x191c15(0x16e)](_0x30c2ec);_0x3d6478+=_0x191c15(0x1ad),_0x3d6478+=_0x191c15(0x155),_0x3d6478+=_0x191c15(0x263),_0x3d6478+=_0x61168,_0x3d6478+='</table>',_0x3d6478+=_0x191c15(0x147),_0x3d6478+=_0x191c15(0x147);let _0x1cc51a=_0x191c15(0x169);_0x1cc51a+=_0x191c15(0x1ad),_0x1cc51a+=_0x191c15(0x155),_0x1cc51a+=_0x191c15(0x263),_0x1cc51a+=_0x2d19fc,_0x1cc51a+=_0x191c15(0x128),_0x1cc51a+=_0x191c15(0x147),_0x1cc51a+='</div>';let _0x207ac6=_0x191c15(0x1e1);const _0x5ee8a0={'width':'15in','height':_0x191c15(0x267),'orientation':_0x191c15(0x1de),'border':{'top':_0x191c15(0x13c),'right':'0.1in','bottom':_0x191c15(0x13c),'left':_0x191c15(0x13c)},'header':{'height':_0x191c15(0x154),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x207ac6+_0x191c15(0x24c)+_0x5b52c6+'\x20-\x20'+_0x323646+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x191c15(0x11d),'contents':{'default':_0x191c15(0x212)}},'dpi':0x5,'zoomFactor':'1'};if(_0x274142=='on'){const _0x3a2e1a=cheerio[_0x191c15(0x1dc)](_0x1cc51a);let _0x27cf34=[],_0x423ed8=[],_0x3e4081=[];_0x3a2e1a(_0x191c15(0x24f))[_0x191c15(0x23e)]((_0x4ee9d2,_0x4ecf15)=>{const _0x5af140=_0x191c15;let _0x5f107f=[],_0x5064b5=0x0;while(_0x3e4081[_0x5064b5]){_0x3e4081[_0x5064b5]--,_0x5064b5++;}_0x3a2e1a(_0x4ecf15)[_0x5af140(0x225)](_0x5af140(0x223))[_0x5af140(0x23e)]((_0x3a1f25,_0x11c663)=>{const _0x1035a3=_0x5af140;let _0x15b5a8=_0x3a2e1a(_0x11c663)[_0x1035a3(0x140)]()['trim'](),_0x3048a6=parseFloat(_0x15b5a8[_0x1035a3(0x10d)](/,/g,''));isNaN(_0x3048a6)&&(_0x3048a6=_0x15b5a8);let _0x4fa573=parseInt(_0x3a2e1a(_0x11c663)[_0x1035a3(0xfa)](_0x1035a3(0x224)))||0x1,_0x2ae54e=parseInt(_0x3a2e1a(_0x11c663)[_0x1035a3(0xfa)]('rowspan'))||0x1;_0x5f107f[_0x5064b5]=_0x3048a6;(_0x4fa573>0x1||_0x2ae54e>0x1)&&_0x423ed8[_0x1035a3(0x190)]({'s':{'r':_0x4ee9d2,'c':_0x5064b5},'e':{'r':_0x4ee9d2+_0x2ae54e-0x1,'c':_0x5064b5+_0x4fa573-0x1}});for(let _0x810059=0x0;_0x810059<_0x4fa573;_0x810059++){_0x2ae54e>0x1&&(_0x3e4081[_0x5064b5+_0x810059]=_0x2ae54e-0x1);}_0x5064b5+=_0x4fa573;}),_0x27cf34[_0x5af140(0x190)](_0x5f107f);});const _0x24ebb5=XLSX['utils'][_0x191c15(0x250)](),_0x49938f=XLSX[_0x191c15(0x183)][_0x191c15(0x1df)](_0x27cf34);_0x423ed8['length']>0x0&&(_0x49938f[_0x191c15(0x26c)]=_0x423ed8);_0x49938f['!cols']=_0x27cf34[0x0][_0x191c15(0x1a6)](()=>({'wpx':0x64})),XLSX['utils'][_0x191c15(0x122)](_0x24ebb5,_0x49938f,_0x191c15(0x232));const _0x3f4470=XLSX[_0x191c15(0x151)](_0x24ebb5,{'bookType':_0x191c15(0x138),'type':_0x191c15(0xff)});_0x1c78f4[_0x191c15(0x1c4)](_0x191c15(0x16b),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x1c78f4[_0x191c15(0x1c4)](_0x191c15(0x256),_0x191c15(0x241)),_0x1c78f4[_0x191c15(0x162)](_0x3f4470);}else pdf['create'](_0x3d6478,_0x5ee8a0)['toStream'](function(_0x2edf81,_0x4971b3){const _0x4ba122=_0x191c15;if(_0x2edf81){_0x1c78f4[_0x4ba122(0x271)](0x1f4)[_0x4ba122(0x162)](_0x4ba122(0x262));return;}_0x1c78f4['setHeader'](_0x4ba122(0x256),'application/pdf'),_0x4971b3[_0x4ba122(0x21a)](_0x1c78f4);});}),router['get'](a0_0x54c9e9(0x1be),auth,async(_0x145e9d,_0xf6e1f3)=>{const _0x3b000f=a0_0x54c9e9;try{const {username:_0xacea5b,email:_0x4e9e00,role:_0x18d33c}=_0x145e9d[_0x3b000f(0xe6)],_0x2c0fbb=_0x145e9d[_0x3b000f(0xe6)],_0x51dcc4=await profile['findOne']({'email':_0x2c0fbb[_0x3b000f(0x220)]}),_0x4265e1={'year':_0x3b000f(0x235),'month':_0x3b000f(0x1f3),'day':_0x3b000f(0x235)},_0xade2d8=await master_shop[_0x3b000f(0x225)](),_0x4dda75=await staff[_0x3b000f(0x13d)]({'email':_0x2c0fbb[_0x3b000f(0x220)]}),_0x3dc52d=await product[_0x3b000f(0x225)](),_0x85f12a=await warehouse[_0x3b000f(0x1b5)]([{'$unwind':_0x3b000f(0x103)},{'$lookup':{'from':_0x3b000f(0x1f5),'localField':'product_details.product_name','foreignField':_0x3b000f(0x274),'as':_0x3b000f(0x18c)}},{'$unwind':_0x3b000f(0x1cd)},{'$project':{'product_name':_0x3b000f(0xf8),'product_stock':_0x3b000f(0x20e)}},{'$group':{'_id':_0x3b000f(0x1f8),'product_stock':{'$sum':_0x3b000f(0x242)}}}]);if(_0xade2d8[0x0]['language']==_0x3b000f(0x1b9))var _0x1aabe5=users[_0x3b000f(0x207)];else{if(_0xade2d8[0x0][_0x3b000f(0x142)]==_0x3b000f(0x17e))var _0x1aabe5=users['Hindi'];else{if(_0xade2d8[0x0][_0x3b000f(0x142)]==_0x3b000f(0x108))var _0x1aabe5=users[_0x3b000f(0x108)];else{if(_0xade2d8[0x0][_0x3b000f(0x142)]==_0x3b000f(0x1f2))var _0x1aabe5=users[_0x3b000f(0x1f2)];else{if(_0xade2d8[0x0][_0x3b000f(0x142)]==_0x3b000f(0x1c1))var _0x1aabe5=users[_0x3b000f(0x1c1)];else{if(_0xade2d8[0x0][_0x3b000f(0x142)]=='Portuguese\x20(BR)')var _0x1aabe5=users[_0x3b000f(0x23d)];else{if(_0xade2d8[0x0]['language']=='Chinese')var _0x1aabe5=users[_0x3b000f(0x255)];else{if(_0xade2d8[0x0]['language']==_0x3b000f(0x275))var _0x1aabe5=users['Arabic'];}}}}}}}_0xf6e1f3['render'](_0x3b000f(0x180),{'success':_0x145e9d[_0x3b000f(0x23b)]('success'),'errors':_0x145e9d[_0x3b000f(0x23b)](_0x3b000f(0xf2)),'alldata':_0x3dc52d,'profile':_0x51dcc4,'master_shop':_0xade2d8,'role':_0x2c0fbb,'product_stock':_0x85f12a,'language':_0x1aabe5,'staff_arr':_0x4dda75});}catch(_0xe68f3){}});function a0_0x4a18(_0x142149,_0x57e8e3){const _0x19057e=a0_0x1905();return a0_0x4a18=function(_0x4a18f1,_0x25bfa4){_0x4a18f1=_0x4a18f1-0xe3;let _0x54f2fc=_0x19057e[_0x4a18f1];return _0x54f2fc;},a0_0x4a18(_0x142149,_0x57e8e3);}function formatNumber(_0x330d62,_0x776afd=a0_0x54c9e9(0x161),_0xb7863f={'minimumFractionDigits':0x2}){const _0x3115ae=a0_0x54c9e9,_0x15c82b=new Intl[(_0x3115ae(0x236))](_0x776afd,_0xb7863f);return _0x15c82b[_0x3115ae(0x16e)](_0x330d62);}async function agentsdataDSICheck(_0x62490d,_0x30d28d,_0x3599c7,_0x2ae970){const _0x5793ff=a0_0x54c9e9,_0x371b5d=await product['aggregate']([{'$group':{'_id':{'brand':_0x5793ff(0x1b2),'category':_0x5793ff(0x19c)},'products':{'$push':{'name':_0x5793ff(0x104),'product_code':_0x5793ff(0x234)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x483d99=[];_0x483d99['cat_brand']=[];for(let _0x3ceeb2=0x0;_0x3ceeb2<=_0x371b5d[_0x5793ff(0x192)]-0x1;_0x3ceeb2++){const _0x118d5a=_0x371b5d[_0x3ceeb2];_0x483d99[_0x5793ff(0x205)][_0x5793ff(0x190)](_0x118d5a);}const _0x41684a=await product[_0x5793ff(0x1b5)]([{'$group':{'_id':{'category':_0x5793ff(0x19c)},'products':{'$push':{'brand':_0x5793ff(0x1b2),'product_code':'$product_code','product_name':_0x5793ff(0x104)}}}},{'$sort':{'_id.category':-0x1}}]),_0x14d7ae=await product[_0x5793ff(0x1b5)]([{'$group':{'_id':{'category':'$category','brand':_0x5793ff(0x1b2)}}},{'$group':{'_id':_0x5793ff(0x1fb),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x256cb1=await sales_sa[_0x5793ff(0x1b5)]([{'$match':{'date':{'$gte':_0x62490d,'$lte':_0x30d28d},'sales_staff_id':_0x3599c7,'sale_product.isFG':_0x5793ff(0x171)}},{'$unwind':_0x5793ff(0x245)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':'products','localField':_0x5793ff(0x141),'foreignField':_0x5793ff(0x11e),'as':'product_info'}},{'$unwind':_0x5793ff(0x167)},{'$group':{'_id':{'dsi':_0x5793ff(0x233),'date':_0x5793ff(0x12e),'customer':'$customer'},'totalQty':{'$sum':_0x5793ff(0x18e)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x5793ff(0x1ce),'discount':'$sale_product.discount','adj_discount':_0x5793ff(0x121),'product_details':{'prod_name':'$product_info.name','product_code':_0x5793ff(0x1a0),'category':_0x5793ff(0x111),'brand':'$product_info.brand','gross_price':_0x5793ff(0x124)}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x5793ff(0x25f),'date':_0x5793ff(0x15d),'customer':_0x5793ff(0x1a5),'category':_0x5793ff(0x1d6),'brand':'$products.product_details.brand'},'totalQty':{'$sum':_0x5793ff(0x25c)},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x5793ff(0x13b)]}},'NetPrice':{'$sum':_0x5793ff(0x115)},'discount':{'$sum':_0x5793ff(0x1da)},'adj_discount':{'$sum':_0x5793ff(0x178)},'product_details':{'$first':_0x5793ff(0x20b)}}},{'$group':{'_id':{'dsi':_0x5793ff(0x25f),'date':_0x5793ff(0x15d),'customer':_0x5793ff(0x1a5)},'totalQty':{'$sum':_0x5793ff(0xe3)},'totalGross':{'$sum':_0x5793ff(0x1ee)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':_0x5793ff(0x17f)},'products':{'$push':{'qty':_0x5793ff(0xe3),'category':_0x5793ff(0x1fb),'brand':'$_id.brand','product_details':_0x5793ff(0x103)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x1b8c9c=[],_0x1384f3={},_0x597e3={},_0x8eeba1={};var _0x1fda8f=0x0,_0x5222d6=0x0,_0x53e6b3=0x0,_0x5d995d=0x0,_0x38b12b=0x0;const _0x3165ad=0x6;for(let _0x17b3ac=0x0;_0x17b3ac<=_0x256cb1['length']-0x1;_0x17b3ac++){const _0x52a787=_0x256cb1[_0x17b3ac];let _0x5efe8e='<tr>';_0x5efe8e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x52a787['_id'][_0x5793ff(0x1e0)]+_0x5793ff(0x21d),_0x5efe8e+=_0x5793ff(0x24e)+_0x52a787[_0x5793ff(0x1ec)][_0x5793ff(0x209)]+_0x5793ff(0x21d),_0x5efe8e+=_0x5793ff(0x24e)+_0x52a787[_0x5793ff(0x1ec)][_0x5793ff(0x219)]+_0x5793ff(0x21d);let _0x48cdab={};var _0x1d3cca=0x0;for(let _0x5da39a=0x0;_0x5da39a<=_0x52a787[_0x5793ff(0x1f5)][_0x5793ff(0x192)]-0x1;_0x5da39a++){const _0x1f4752=_0x52a787[_0x5793ff(0x1f5)][_0x5da39a];_0x48cdab[_0x1f4752[_0x5793ff(0x22e)]+'-'+_0x1f4752[_0x5793ff(0xec)]]=_0x1f4752[_0x5793ff(0x26e)];const _0x1c1ed7=_0x1f4752[_0x5793ff(0x22e)]+'-'+_0x1f4752[_0x5793ff(0xec)];!_0x1384f3[_0x1c1ed7]&&(_0x1384f3[_0x1c1ed7]=0x0),!Array[_0x5793ff(0x1c2)](_0x8eeba1[_0x1c1ed7])&&(_0x8eeba1[_0x1c1ed7]=[]),!Array[_0x5793ff(0x1c2)](_0x8eeba1[_0x1c1ed7])&&(_0x8eeba1[_0x1c1ed7]=[]),_0x1384f3[_0x1c1ed7]+=_0x1f4752['qty'],_0x8eeba1[_0x1c1ed7][_0x5793ff(0x190)](_0x1f4752['qty']),_0x1d3cca++;}console[_0x5793ff(0x187)](_0x52a787);for(let _0xdef2e6=0x0;_0xdef2e6<=_0x483d99[_0x5793ff(0x205)][_0x5793ff(0x192)]-0x1;_0xdef2e6++){const _0x34a893=_0x483d99[_0x5793ff(0x205)][_0xdef2e6],_0x2a5f01=_0x34a893[_0x5793ff(0x1ec)]['brand']+'-'+_0x34a893[_0x5793ff(0x1ec)][_0x5793ff(0xec)];_0x5efe8e+=_0x5793ff(0xfc)+(_0x48cdab[_0x2a5f01]!==undefined?_0x48cdab[_0x2a5f01]['toFixed'](0x2):'')+_0x5793ff(0x21d);}_0x53e6b3=_0x52a787[_0x5793ff(0x1e6)]+_0x52a787[_0x5793ff(0x20c)],_0x5efe8e+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x52a787[_0x5793ff(0xe9)],0x2)[_0x5793ff(0x1e3)](0x2))+_0x5793ff(0x21d),_0x5efe8e+=_0x5793ff(0x1cf)+formatNumber(_0x52a787[_0x5793ff(0x1f9)]['toFixed'](0x2))+'</td>',_0x5efe8e+=_0x5793ff(0x1cf)+formatNumber(_0x53e6b3)+_0x5793ff(0x21d),_0x5efe8e+=_0x5793ff(0x1cf)+formatNumber(_0x52a787[_0x5793ff(0x252)]['toFixed'](0x2))+_0x5793ff(0x21d),_0x5efe8e+=_0x5793ff(0x1ab),_0x1fda8f+=parseFloat(_0x52a787[_0x5793ff(0xe9)][_0x5793ff(0x1e3)](0x2)),_0x5222d6+=parseFloat(_0x52a787[_0x5793ff(0x252)][_0x5793ff(0x1e3)](0x2)),_0x5d995d+=_0x53e6b3,_0x38b12b+=parseFloat(_0x52a787['totalGross'][_0x5793ff(0x1e3)](0x2));if(_0x17b3ac==_0x256cb1['length']-0x1){_0x5efe8e+=_0x5793ff(0xf4),_0x5efe8e+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x5efe8e+=_0x5793ff(0x21d);for(let _0xffe6bb=0x0;_0xffe6bb<=_0x483d99[_0x5793ff(0x205)]['length']-0x1;_0xffe6bb++){const _0x7caa66=_0x483d99[_0x5793ff(0x205)][_0xffe6bb],_0x44a397=_0x7caa66[_0x5793ff(0x1ec)][_0x5793ff(0x22e)]+'-'+_0x7caa66[_0x5793ff(0x1ec)][_0x5793ff(0xec)],_0x253a03=_0x8eeba1[_0x44a397][_0x5793ff(0x145)]((_0x1126f4,_0x592de6)=>_0x1126f4+_0x592de6,0x0);_0x5efe8e+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x253a03!==undefined?formatNumber(_0x253a03[_0x5793ff(0x1e3)](0x2)):'')+_0x5793ff(0x257),console[_0x5793ff(0x187)](_0x8eeba1[_0x44a397]['reduce']((_0x11373b,_0x1a49d9)=>_0x11373b+_0x1a49d9,0x0));}_0x5efe8e+=_0x5793ff(0x182)+formatNumber(_0x1fda8f[_0x5793ff(0x1e3)](0x2))+_0x5793ff(0x257),_0x5efe8e+=_0x5793ff(0x182)+formatNumber(_0x38b12b)+'</b></td>',_0x5efe8e+=_0x5793ff(0x182)+formatNumber(_0x5d995d)+'</b></td>',_0x5efe8e+=_0x5793ff(0x182)+formatNumber(_0x5222d6)+'</b></td>',_0x5efe8e+=_0x5793ff(0x1ab);}_0x1b8c9c[_0x5793ff(0x190)](_0x5efe8e);}function _0x29a0f4(_0x1310c3,_0x5d880c){const _0x556fe6=_0x5793ff,_0xe0f926=[];for(let _0x336171=0x0;_0x336171<=_0x1310c3[_0x556fe6(0x192)]-0x1;_0x336171+=_0x5d880c){_0xe0f926[_0x556fe6(0x190)](_0x1310c3[_0x556fe6(0x100)](_0x336171,_0x336171+_0x5d880c));}return _0xe0f926;}const _0x1bb761=_0x29a0f4(_0x1b8c9c,_0x3165ad);let _0x55b71f='';return _0x1bb761['forEach']((_0x2588cf,_0x2f929c)=>{const _0x41e956=_0x5793ff;_0x2f929c>0x0&&(_0x55b71f+=_0x41e956(0x21e));_0x55b71f+=_0x41e956(0x263),_0x55b71f+='<thead>',_0x55b71f+='<tr>',_0x55b71f+=_0x41e956(0x12d),_0x55b71f+=_0x41e956(0x1ab),_0x55b71f+=_0x41e956(0xf4),_0x55b71f+=_0x41e956(0x261);for(let _0x21a222=0x0;_0x21a222<=_0x41684a[_0x41e956(0x192)]-0x1;_0x21a222++){const _0x182d6c=_0x41684a[_0x21a222];for(let _0xc825af=0x0;_0xc825af<_0x14d7ae[_0x41e956(0x192)];_0xc825af++){const _0x1cb6db=_0x14d7ae[_0xc825af];_0x1cb6db[_0x41e956(0x1ec)]===_0x182d6c[_0x41e956(0x1ec)]['category']&&(_0x55b71f+=_0x41e956(0x1a7)+_0x1cb6db[_0x41e956(0x25d)]+_0x41e956(0x215)+_0x182d6c['_id'][_0x41e956(0xec)]+_0x41e956(0x21d));}}_0x55b71f+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x55b71f+='</tr>',_0x55b71f+=_0x41e956(0xf4),_0x55b71f+=_0x41e956(0x139),_0x55b71f+=_0x41e956(0x204),_0x55b71f+=_0x41e956(0xea);for(let _0x1261d8=0x0;_0x1261d8<=_0x41684a[_0x41e956(0x192)]-0x1;_0x1261d8++){const _0x481376=_0x41684a[_0x1261d8];for(let _0x2a3073=0x0;_0x2a3073<_0x483d99['cat_brand']['length'];_0x2a3073++){const _0x41c3db=_0x483d99['cat_brand'][_0x2a3073];_0x41c3db[_0x41e956(0x1ec)][_0x41e956(0xec)]===_0x481376[_0x41e956(0x1ec)]['category']&&(_0x55b71f+=_0x41e956(0x173)+_0x41c3db['_id'][_0x41e956(0x22e)]+_0x41e956(0x21d));}}_0x55b71f+=_0x41e956(0x1b0),_0x55b71f+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x55b71f+=_0x41e956(0x265),_0x55b71f+=_0x41e956(0x148),_0x55b71f+='</tr>',_0x55b71f+=_0x41e956(0xf6),_0x55b71f+='<tbody>',_0x2588cf[_0x41e956(0x107)](_0x23cb53=>{_0x55b71f+=_0x23cb53;}),console[_0x41e956(0x187)](_0x8eeba1),_0x55b71f+=_0x41e956(0xeb),_0x55b71f+=_0x41e956(0x128);}),_0x55b71f;}async function agentsdataDSICheck_excel(_0x1a22a1,_0x212dc3,_0x359722,_0x20b4ed){const _0x43d43a=a0_0x54c9e9,_0x3ce053=await product[_0x43d43a(0x1b5)]([{'$group':{'_id':{'brand':'$brand','category':_0x43d43a(0x19c)},'products':{'$push':{'name':'$name','product_code':_0x43d43a(0x234)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x41f6c6=[];_0x41f6c6[_0x43d43a(0x205)]=[];for(let _0x430c81=0x0;_0x430c81<=_0x3ce053[_0x43d43a(0x192)]-0x1;_0x430c81++){const _0x2ac722=_0x3ce053[_0x430c81];_0x41f6c6[_0x43d43a(0x205)][_0x43d43a(0x190)](_0x2ac722);}const _0x4e273b=await product[_0x43d43a(0x1b5)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x43d43a(0x1b2),'product_code':_0x43d43a(0x234),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x580876=await product['aggregate']([{'$group':{'_id':{'category':_0x43d43a(0x19c),'brand':_0x43d43a(0x1b2)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x2d6de1=await sales_sa[_0x43d43a(0x1b5)]([{'$match':{'date':{'$gte':_0x1a22a1,'$lte':_0x212dc3},'sales_staff_id':_0x359722,'sale_product.isFG':_0x43d43a(0x171)}},{'$unwind':_0x43d43a(0x245)},{'$match':{'sale_product.isFG':_0x43d43a(0x171)}},{'$lookup':{'from':_0x43d43a(0x1f5),'localField':_0x43d43a(0x141),'foreignField':_0x43d43a(0x11e),'as':'product_info'}},{'$unwind':_0x43d43a(0x167)},{'$group':{'_id':{'dsi':_0x43d43a(0x233),'date':_0x43d43a(0x12e),'customer':'$customer'},'totalQty':{'$sum':_0x43d43a(0x18e)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x43d43a(0x1ce),'discount':_0x43d43a(0x1b3),'adj_discount':_0x43d43a(0x121),'product_details':{'prod_name':_0x43d43a(0x17c),'product_code':_0x43d43a(0x1a0),'category':_0x43d43a(0x111),'brand':_0x43d43a(0x196),'gross_price':_0x43d43a(0x124)}}}}},{'$unwind':_0x43d43a(0x230)},{'$group':{'_id':{'dsi':_0x43d43a(0x25f),'date':_0x43d43a(0x15d),'customer':_0x43d43a(0x1a5),'category':_0x43d43a(0x1d6),'brand':_0x43d43a(0x166)},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x43d43a(0x25c),_0x43d43a(0x13b)]}},'NetPrice':{'$sum':_0x43d43a(0x115)},'discount':{'$sum':_0x43d43a(0x1da)},'adj_discount':{'$sum':_0x43d43a(0x178)},'product_details':{'$first':_0x43d43a(0x20b)}}},{'$group':{'_id':{'dsi':_0x43d43a(0x25f),'date':_0x43d43a(0x15d),'customer':_0x43d43a(0x1a5)},'totalQty':{'$sum':_0x43d43a(0xe3)},'totalGross':{'$sum':_0x43d43a(0x1ee)},'NetPrice':{'$sum':_0x43d43a(0x170)},'discount':{'$sum':_0x43d43a(0x127)},'adj_discount':{'$sum':_0x43d43a(0x17f)},'products':{'$push':{'qty':'$totalQty','category':_0x43d43a(0x1fb),'brand':_0x43d43a(0x165),'product_details':_0x43d43a(0x103)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2231cd=[],_0x249292={},_0x348225={},_0x190865={};var _0x356bbf=0x0,_0x3178fe=0x0,_0xa4f532=0x0,_0x4986d1=0x0,_0x43c646=0x0;const _0x36ff21=0x9184e72a000;for(let _0x43defc=0x0;_0x43defc<=_0x2d6de1[_0x43d43a(0x192)]-0x1;_0x43defc++){const _0x30d320=_0x2d6de1[_0x43defc];let _0x1cc8d1=_0x43d43a(0xf4);_0x1cc8d1+=_0x43d43a(0x24e)+_0x30d320[_0x43d43a(0x1ec)][_0x43d43a(0x1e0)]+_0x43d43a(0x21d),_0x1cc8d1+=_0x43d43a(0x24e)+_0x30d320[_0x43d43a(0x1ec)][_0x43d43a(0x209)]+'</td>',_0x1cc8d1+=_0x43d43a(0x24e)+_0x30d320[_0x43d43a(0x1ec)][_0x43d43a(0x219)]+_0x43d43a(0x21d);let _0x58cd2d={};var _0x2af34e=0x0;for(let _0x3c5a35=0x0;_0x3c5a35<=_0x30d320[_0x43d43a(0x1f5)][_0x43d43a(0x192)]-0x1;_0x3c5a35++){const _0x25517e=_0x30d320[_0x43d43a(0x1f5)][_0x3c5a35];_0x58cd2d[_0x25517e['brand']+'-'+_0x25517e[_0x43d43a(0xec)]]=_0x25517e[_0x43d43a(0x26e)];const _0x1b3752=_0x25517e[_0x43d43a(0x22e)]+'-'+_0x25517e[_0x43d43a(0xec)];!_0x249292[_0x1b3752]&&(_0x249292[_0x1b3752]=0x0),!Array['isArray'](_0x190865[_0x1b3752])&&(_0x190865[_0x1b3752]=[]),!Array['isArray'](_0x190865[_0x1b3752])&&(_0x190865[_0x1b3752]=[]),_0x249292[_0x1b3752]+=_0x25517e[_0x43d43a(0x26e)],_0x190865[_0x1b3752]['push'](_0x25517e[_0x43d43a(0x26e)]),_0x2af34e++;}console['log'](_0x30d320);for(let _0x43198d=0x0;_0x43198d<=_0x41f6c6[_0x43d43a(0x205)]['length']-0x1;_0x43198d++){const _0x5d4406=_0x41f6c6[_0x43d43a(0x205)][_0x43198d],_0x47a1c3=_0x5d4406[_0x43d43a(0x1ec)][_0x43d43a(0x22e)]+'-'+_0x5d4406[_0x43d43a(0x1ec)][_0x43d43a(0xec)];_0x1cc8d1+=_0x43d43a(0xfc)+(_0x58cd2d[_0x47a1c3]!==undefined?_0x58cd2d[_0x47a1c3]['toFixed'](0x2):'')+'</td>';}_0xa4f532=_0x30d320[_0x43d43a(0x1e6)]+_0x30d320['adj_discount'],_0x1cc8d1+=_0x43d43a(0x1cf)+formatNumber(parseFloat(_0x30d320[_0x43d43a(0xe9)],0x2)[_0x43d43a(0x1e3)](0x2))+_0x43d43a(0x21d),_0x1cc8d1+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x30d320['totalGross'][_0x43d43a(0x1e3)](0x2))+_0x43d43a(0x21d),_0x1cc8d1+=_0x43d43a(0x1cf)+formatNumber(_0xa4f532)+_0x43d43a(0x21d),_0x1cc8d1+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x30d320[_0x43d43a(0x252)][_0x43d43a(0x1e3)](0x2))+_0x43d43a(0x21d),_0x1cc8d1+='</tr>',_0x356bbf+=parseFloat(_0x30d320['totalQty'][_0x43d43a(0x1e3)](0x2)),_0x3178fe+=parseFloat(_0x30d320[_0x43d43a(0x252)][_0x43d43a(0x1e3)](0x2)),_0x4986d1+=_0xa4f532,_0x43c646+=parseFloat(_0x30d320[_0x43d43a(0x1f9)][_0x43d43a(0x1e3)](0x2));if(_0x43defc==_0x2d6de1['length']-0x1){_0x1cc8d1+='<tr>',_0x1cc8d1+=_0x43d43a(0x221),_0x1cc8d1+=_0x43d43a(0x21d);for(let _0x3362f7=0x0;_0x3362f7<=_0x41f6c6[_0x43d43a(0x205)][_0x43d43a(0x192)]-0x1;_0x3362f7++){const _0x5bd655=_0x41f6c6[_0x43d43a(0x205)][_0x3362f7],_0xd3bfda=_0x5bd655[_0x43d43a(0x1ec)][_0x43d43a(0x22e)]+'-'+_0x5bd655[_0x43d43a(0x1ec)][_0x43d43a(0xec)],_0xaef9a2=_0x190865[_0xd3bfda]['reduce']((_0x64cd77,_0x2bd75e)=>_0x64cd77+_0x2bd75e,0x0);_0x1cc8d1+=_0x43d43a(0x1d7)+(_0xaef9a2!==undefined?formatNumber(_0xaef9a2['toFixed'](0x2)):'')+_0x43d43a(0x257),console[_0x43d43a(0x187)](_0x190865[_0xd3bfda][_0x43d43a(0x145)]((_0x19d6f3,_0x4a51b7)=>_0x19d6f3+_0x4a51b7,0x0));}_0x1cc8d1+=_0x43d43a(0x182)+formatNumber(_0x356bbf[_0x43d43a(0x1e3)](0x2))+_0x43d43a(0x257),_0x1cc8d1+=_0x43d43a(0x182)+formatNumber(_0x43c646)+_0x43d43a(0x257),_0x1cc8d1+=_0x43d43a(0x182)+formatNumber(_0x4986d1)+_0x43d43a(0x257),_0x1cc8d1+=_0x43d43a(0x182)+formatNumber(_0x3178fe)+'</b></td>',_0x1cc8d1+=_0x43d43a(0x1ab);}_0x2231cd['push'](_0x1cc8d1);}function _0x5ea7f9(_0x43fd4b,_0x2f8cd3){const _0x2015a6=_0x43d43a,_0x311508=[];for(let _0x2b7859=0x0;_0x2b7859<=_0x43fd4b[_0x2015a6(0x192)]-0x1;_0x2b7859+=_0x2f8cd3){_0x311508['push'](_0x43fd4b[_0x2015a6(0x100)](_0x2b7859,_0x2b7859+_0x2f8cd3));}return _0x311508;}const _0x41c4a5=_0x5ea7f9(_0x2231cd,_0x36ff21);let _0x1d2dde='';return _0x41c4a5[_0x43d43a(0x107)]((_0x9141d1,_0x53e7d9)=>{const _0x253d32=_0x43d43a;_0x53e7d9>0x0&&(_0x1d2dde+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x1d2dde+=_0x253d32(0x263),_0x1d2dde+=_0x253d32(0x228),_0x1d2dde+=_0x253d32(0xf4),_0x1d2dde+=_0x253d32(0x12d),_0x1d2dde+=_0x253d32(0x1ab),_0x1d2dde+=_0x253d32(0xf4),_0x1d2dde+=_0x253d32(0x261);for(let _0x11a55a=0x0;_0x11a55a<=_0x4e273b[_0x253d32(0x192)]-0x1;_0x11a55a++){const _0x39a9fd=_0x4e273b[_0x11a55a];for(let _0x4ca5c6=0x0;_0x4ca5c6<_0x580876[_0x253d32(0x192)];_0x4ca5c6++){const _0x340070=_0x580876[_0x4ca5c6];_0x340070[_0x253d32(0x1ec)]===_0x39a9fd['_id']['category']&&(_0x1d2dde+=_0x253d32(0x1a7)+_0x340070[_0x253d32(0x25d)]+'\x22\x20class=\x22cat_data\x22>'+_0x39a9fd[_0x253d32(0x1ec)]['category']+_0x253d32(0x21d));}}_0x1d2dde+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x1d2dde+=_0x253d32(0x1ab),_0x1d2dde+=_0x253d32(0xf4),_0x1d2dde+=_0x253d32(0x139),_0x1d2dde+=_0x253d32(0x204),_0x1d2dde+=_0x253d32(0xea);for(let _0x32cdd7=0x0;_0x32cdd7<=_0x4e273b['length']-0x1;_0x32cdd7++){const _0x2454eb=_0x4e273b[_0x32cdd7];for(let _0x3d7c91=0x0;_0x3d7c91<_0x41f6c6[_0x253d32(0x205)][_0x253d32(0x192)];_0x3d7c91++){const _0x4bf51f=_0x41f6c6['cat_brand'][_0x3d7c91];_0x4bf51f[_0x253d32(0x1ec)][_0x253d32(0xec)]===_0x2454eb[_0x253d32(0x1ec)][_0x253d32(0xec)]&&(_0x1d2dde+=_0x253d32(0x173)+_0x4bf51f[_0x253d32(0x1ec)][_0x253d32(0x22e)]+_0x253d32(0x21d));}}_0x1d2dde+=_0x253d32(0x1b0),_0x1d2dde+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x1d2dde+=_0x253d32(0x265),_0x1d2dde+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x1d2dde+=_0x253d32(0x1ab),_0x1d2dde+=_0x253d32(0xf6),_0x1d2dde+=_0x253d32(0x19f),_0x9141d1[_0x253d32(0x107)](_0x3e769d=>{_0x1d2dde+=_0x3e769d;}),console[_0x253d32(0x187)](_0x190865),_0x1d2dde+=_0x253d32(0xeb),_0x1d2dde+='</table>';}),_0x1d2dde;}router['post']('/agent_reports/pdf',auth,async(_0x39befb,_0x4fb39f)=>{const _0x35777b=a0_0x54c9e9,{from_date:_0x4afa01,to_date:_0x58eddc,isExcel:_0x5957ef}=_0x39befb[_0x35777b(0x133)],_0x1c81e1=_0x39befb[_0x35777b(0xe6)],_0x43cb01=await staff[_0x35777b(0x13d)]({'email':_0x1c81e1[_0x35777b(0x220)]}),_0x449654=await master_shop['find']();console[_0x35777b(0x187)](_0x449654[0x0][_0x35777b(0x243)]);const _0x3c7663=await agentsdataDSICheck(_0x4afa01,_0x58eddc,_0x43cb01[_0x35777b(0x1ec)][_0x35777b(0x1af)](),_0x5957ef),_0x5d8ca2=await agentsdataDSICheck_excel(_0x4afa01,_0x58eddc,_0x43cb01['_id'][_0x35777b(0x1af)](),_0x5957ef);let _0x41661f=_0x35777b(0x237);var _0x41ee0b=new Date(_0x4afa01),_0x4c59e0=new Date(_0x58eddc);const _0x3e0898={'year':_0x35777b(0x235),'month':_0x35777b(0x1f3),'day':_0x35777b(0x235)},_0x2dfa05=new Intl[(_0x35777b(0x1dd))](_0x35777b(0x161),_0x3e0898)['format'](_0x41ee0b),_0x27371b=new Intl[(_0x35777b(0x1dd))](_0x35777b(0x161),_0x3e0898)[_0x35777b(0x16e)](_0x4c59e0);_0x41661f+=_0x35777b(0x1ad),_0x41661f+='<div\x20\x20id=\x22table-conatainer\x22>',_0x41661f+=_0x35777b(0x263),_0x41661f+=_0x3c7663,_0x41661f+=_0x35777b(0x128),_0x41661f+=_0x35777b(0x147),_0x41661f+=_0x35777b(0x147);let _0x11ffd1='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';_0x11ffd1+=_0x35777b(0x1ad),_0x11ffd1+=_0x35777b(0x155),_0x11ffd1+=_0x35777b(0x263),_0x11ffd1+=_0x5d8ca2,_0x11ffd1+='</table>',_0x11ffd1+=_0x35777b(0x147),_0x11ffd1+=_0x35777b(0x147);let _0x4e82a5=_0x35777b(0x1e1);const _0x344bad={'width':'15in','height':_0x35777b(0x267),'orientation':_0x35777b(0x1de),'border':{'top':_0x35777b(0x13c),'right':_0x35777b(0x13c),'bottom':_0x35777b(0x13c),'left':_0x35777b(0x13c)},'header':{'height':_0x35777b(0x154),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x4e82a5+_0x35777b(0x24c)+_0x2dfa05+'\x20-\x20'+_0x27371b+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x35777b(0x11d),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};if(_0x5957ef=='on'){const _0x11e401=cheerio['load'](_0x11ffd1);let _0x21482c=[],_0x286456=[],_0x31b021=[];const _0x3bd31c=_0x241df3=>{const _0x169833=_0x35777b,_0x1db960={'top':{'style':_0x169833(0xfe),'color':{'rgb':_0x169833(0x1a9)}},'bottom':{'style':_0x169833(0xfe),'color':{'rgb':_0x169833(0x1a9)}},'left':{'style':_0x169833(0xfe),'color':{'rgb':'000000'}},'right':{'style':_0x169833(0xfe),'color':{'rgb':_0x169833(0x1a9)}}};if(_0x241df3){const _0x9759c8=_0x241df3[_0x169833(0x12c)](';')[_0x169833(0x145)]((_0x1fd6d8,_0x2ac6d3)=>{const _0x2ff023=_0x169833,[_0x58b412,_0x14fa18]=_0x2ac6d3[_0x2ff023(0x12c)](':')[_0x2ff023(0x1a6)](_0xf7e34e=>_0xf7e34e[_0x2ff023(0x1d3)]());return _0x1fd6d8[_0x58b412]=_0x14fa18,_0x1fd6d8;},{});_0x9759c8[_0x169833(0x217)]&&(_0x1db960[_0x169833(0x1f6)][_0x169833(0x1b6)]=_0x9759c8[_0x169833(0x217)][_0x169833(0x1e8)](_0x169833(0x12b))?_0x169833(0x12b):'medium'),_0x9759c8[_0x169833(0x1a3)]&&(_0x1db960['bottom'][_0x169833(0x1b6)]=_0x9759c8['border-bottom'][_0x169833(0x1e8)]('thin')?_0x169833(0x12b):_0x169833(0x18d)),_0x9759c8[_0x169833(0x25b)]&&(_0x1db960[_0x169833(0x1a2)][_0x169833(0x1b6)]=_0x9759c8[_0x169833(0x25b)][_0x169833(0x1e8)](_0x169833(0x12b))?'thin':_0x169833(0x18d)),_0x9759c8[_0x169833(0xf9)]&&(_0x1db960[_0x169833(0x130)][_0x169833(0x1b6)]=_0x9759c8[_0x169833(0xf9)]['includes'](_0x169833(0x12b))?_0x169833(0x12b):_0x169833(0x18d));}return _0x1db960;};_0x11e401(_0x35777b(0x24f))[_0x35777b(0x23e)]((_0x8ea46b,_0x4b25bf)=>{const _0x4521d4=_0x35777b;let _0x3323ad=[],_0x377967=0x0;while(_0x31b021[_0x377967]){_0x31b021[_0x377967]--,_0x377967++;}_0x11e401(_0x4b25bf)['find'](_0x4521d4(0x223))[_0x4521d4(0x23e)]((_0x2f0f5d,_0x409e17)=>{const _0xe57bf2=_0x4521d4;let _0x9ab68e=_0x11e401(_0x409e17)[_0xe57bf2(0x140)]()[_0xe57bf2(0x1d3)](),_0x4b3e22=parseFloat(_0x9ab68e[_0xe57bf2(0x10d)](/,/g,'')),_0x44f934={};!isNaN(_0x4b3e22)?(_0x44f934['v']=_0x4b3e22,_0x44f934['t']='n'):(_0x44f934['v']=_0x9ab68e,_0x44f934['t']='s');const _0x3586ad=_0x11e401(_0x409e17)[_0xe57bf2(0xfa)]('style'),_0x210290=_0x3bd31c(_0x3586ad);_0x44f934['s']={'border':_0x210290},_0x3323ad[_0x377967]=_0x44f934;let _0x41b184=parseInt(_0x11e401(_0x409e17)[_0xe57bf2(0xfa)](_0xe57bf2(0x224)))||0x1,_0x24ead9=parseInt(_0x11e401(_0x409e17)[_0xe57bf2(0xfa)]('rowspan'))||0x1;(_0x41b184>0x1||_0x24ead9>0x1)&&_0x286456['push']({'s':{'r':_0x8ea46b,'c':_0x377967},'e':{'r':_0x8ea46b+_0x24ead9-0x1,'c':_0x377967+_0x41b184-0x1}});for(let _0x5c522b=0x0;_0x5c522b<_0x41b184;_0x5c522b++){_0x24ead9>0x1&&(_0x31b021[_0x377967+_0x5c522b]=_0x24ead9-0x1);}_0x377967+=_0x41b184;}),_0x21482c['push'](_0x3323ad);});const _0x43fad1=XLSX['utils']['book_new'](),_0x21b3ae=XLSX['utils']['aoa_to_sheet'](_0x21482c);_0x286456['length']>0x0&&(_0x21b3ae[_0x35777b(0x26c)]=_0x286456);_0x21b3ae['!cols']=_0x21482c[0x0][_0x35777b(0x1a6)](()=>({'wpx':0x64})),XLSX[_0x35777b(0x183)][_0x35777b(0x122)](_0x43fad1,_0x21b3ae,'Sales\x20Report');const _0x5b62a5=XLSX['write'](_0x43fad1,{'bookType':_0x35777b(0x138),'type':'buffer'});_0x4fb39f[_0x35777b(0x1c4)]('Content-Disposition','attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x4fb39f[_0x35777b(0x1c4)](_0x35777b(0x256),_0x35777b(0x241)),_0x4fb39f[_0x35777b(0x162)](_0x5b62a5);}else pdf['create'](_0x41661f,_0x344bad)[_0x35777b(0x1d2)](function(_0x2d9ae9,_0x5f06d6){const _0x21b60b=_0x35777b;if(_0x2d9ae9){_0x4fb39f['status'](0x1f4)[_0x21b60b(0x162)](_0x21b60b(0x262));return;}_0x4fb39f['setHeader'](_0x21b60b(0x256),'application/pdf'),_0x5f06d6[_0x21b60b(0x21a)](_0x4fb39f);});}),router[a0_0x54c9e9(0x1ba)](a0_0x54c9e9(0x203),auth,async(_0x2fc2ac,_0x4d93da)=>{const _0x3056b8=a0_0x54c9e9;try{const {username:_0x703c20,email:_0x133355,role:_0x39f883}=_0x2fc2ac[_0x3056b8(0xe6)],_0x48158e=_0x2fc2ac[_0x3056b8(0xe6)],_0xcf1c1b=await profile[_0x3056b8(0x13d)]({'email':_0x48158e['email']}),_0x22a9f8={'year':_0x3056b8(0x235),'month':_0x3056b8(0x1f3),'day':_0x3056b8(0x235)},_0x2427f2=await master_shop[_0x3056b8(0x225)](),_0x5c2e00=await product[_0x3056b8(0x225)](),_0x22ce41=await warehouse[_0x3056b8(0x1b5)]([{'$unwind':_0x3056b8(0x103)},{'$lookup':{'from':_0x3056b8(0x1f5),'localField':_0x3056b8(0x14b),'foreignField':_0x3056b8(0x274),'as':_0x3056b8(0x18c)}},{'$unwind':_0x3056b8(0x1cd)},{'$project':{'product_name':'$product_details.product_name','product_stock':_0x3056b8(0x20e)}},{'$group':{'_id':_0x3056b8(0x1f8),'product_stock':{'$sum':_0x3056b8(0x242)}}}]),_0x2cb568=await staff[_0x3056b8(0x13d)]({'email':_0x48158e[_0x3056b8(0x220)]});if(_0x2427f2[0x0][_0x3056b8(0x142)]==_0x3056b8(0x1b9))var _0x9a996a=users[_0x3056b8(0x207)];else{if(_0x2427f2[0x0]['language']==_0x3056b8(0x17e))var _0x9a996a=users[_0x3056b8(0x17e)];else{if(_0x2427f2[0x0][_0x3056b8(0x142)]==_0x3056b8(0x108))var _0x9a996a=users['German'];else{if(_0x2427f2[0x0][_0x3056b8(0x142)]=='Spanish')var _0x9a996a=users['Spanish'];else{if(_0x2427f2[0x0][_0x3056b8(0x142)]==_0x3056b8(0x1c1))var _0x9a996a=users[_0x3056b8(0x1c1)];else{if(_0x2427f2[0x0][_0x3056b8(0x142)]=='Portuguese\x20(BR)')var _0x9a996a=users[_0x3056b8(0x23d)];else{if(_0x2427f2[0x0]['language']=='Chinese')var _0x9a996a=users[_0x3056b8(0x255)];else{if(_0x2427f2[0x0][_0x3056b8(0x142)]==_0x3056b8(0x275))var _0x9a996a=users[_0x3056b8(0x1bb)];}}}}}}}_0x4d93da['render'](_0x3056b8(0x1e7),{'success':_0x2fc2ac[_0x3056b8(0x23b)](_0x3056b8(0x1ea)),'errors':_0x2fc2ac[_0x3056b8(0x23b)](_0x3056b8(0xf2)),'alldata':_0x5c2e00,'profile':_0xcf1c1b,'master_shop':_0x2427f2,'role':_0x48158e,'product_stock':_0x22ce41,'language':_0x9a996a,'staff_arr':_0x2cb568});}catch(_0x2f626c){}});async function dataSalesReports(_0x171d09,_0x790821,_0x12d878){const _0x57e655=a0_0x54c9e9;let _0x2a3541='';const _0x2ecbf6=await sales_sa[_0x57e655(0x1b5)]([{'$match':{'date':{'$gte':_0x171d09,'$lte':_0x790821},'sales_staff_id':_0x12d878}},{'$unwind':'$sale_product'},{'$match':{'sale_product.isFG':_0x57e655(0x171)}},{'$group':{'_id':{'product_name':_0x57e655(0x143),'product_code':_0x57e655(0x131)},'sumqty':{'$sum':_0x57e655(0x18e)},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x9cece1=0x0,_0x410bc0=0x0;for(let _0xa94312=0x0;_0xa94312<=_0x2ecbf6[_0x57e655(0x192)]-0x1;_0xa94312++){const _0x27c478=_0x2ecbf6[_0xa94312];var _0x1105de=_0x27c478['totalPrice']['toLocaleString'](undefined),_0x3324c2=_0x27c478[_0x57e655(0x106)][_0x57e655(0x206)](undefined);_0x2a3541+=_0x57e655(0xf4),_0x2a3541+='<td\x20class=\x22row_data\x22>'+_0x27c478[_0x57e655(0x1ec)][_0x57e655(0x11e)]+_0x57e655(0x21d),_0x2a3541+='<td\x20class=\x22row_data\x22>'+_0x27c478['_id'][_0x57e655(0x1ac)]+_0x57e655(0x21d),_0x2a3541+=_0x57e655(0x24b)+formatNumber(_0x27c478['sumqty'][_0x57e655(0x1e3)](0x2))+_0x57e655(0x21d),_0x2a3541+=_0x57e655(0x24b)+formatNumber(_0x27c478['totalPrice'][_0x57e655(0x1e3)](0x2))+_0x57e655(0x21d),_0x2a3541+=_0x57e655(0x1ab),_0x9cece1+=parseFloat(_0x27c478['sumqty']),_0x410bc0+=parseFloat(_0x27c478[_0x57e655(0x150)]);}var _0xfb153a=_0x410bc0[_0x57e655(0x206)](undefined),_0x336fbe=_0x9cece1[_0x57e655(0x206)](undefined);return _0x2a3541+=_0x57e655(0xf4),_0x2a3541+=_0x57e655(0x156),_0x2a3541+=_0x57e655(0x25e)+formatNumber(_0x9cece1['toFixed'](0x2))+_0x57e655(0x257),_0x2a3541+='<td\x20class=\x22row_data\x22><b>'+formatNumber(_0x410bc0[_0x57e655(0x1e3)](0x2))+_0x57e655(0x257),_0x2a3541+='</tr>',_0x2a3541;}router[a0_0x54c9e9(0x227)](a0_0x54c9e9(0x157),auth,async(_0x3b281b,_0x2556f6)=>{const _0x155267=a0_0x54c9e9;try{const {from_date:_0x2dc497,to_date:_0x10c472,isExcel:_0x746d39}=_0x3b281b[_0x155267(0x133)],_0x34d71c=_0x3b281b[_0x155267(0xe6)],_0xb91dc6=await staff[_0x155267(0x13d)]({'email':_0x34d71c[_0x155267(0x220)]});let _0x3747c1=_0x155267(0x194);var _0x8f12a=new Date(_0x2dc497),_0x994f55=new Date(_0x10c472);const _0x3b6464={'year':'numeric','month':_0x155267(0x1f3),'day':_0x155267(0x235)},_0x502a05=new Intl[(_0x155267(0x1dd))](_0x155267(0x161),_0x3b6464)['format'](_0x8f12a),_0x40fbcb=new Intl[(_0x155267(0x1dd))](_0x155267(0x161),_0x3b6464)['format'](_0x994f55);var _0x384d50=await dataSalesReports(_0x2dc497,_0x10c472,_0xb91dc6[_0x155267(0x1ec)][_0x155267(0x1af)]());_0x3747c1+=_0x155267(0x1ad),_0x3747c1+=_0x155267(0x14d),_0x3747c1+=_0x155267(0x263),_0x3747c1+='<tr>',_0x3747c1+='<th>\x20ITEM\x20CODE\x20</th>',_0x3747c1+=_0x155267(0x1c0),_0x3747c1+=_0x155267(0x1b1),_0x3747c1+=_0x155267(0x10c),_0x3747c1+=_0x155267(0xf4),_0x3747c1+=_0x384d50,_0x3747c1+=_0x155267(0x1ab),_0x3747c1+=_0x155267(0x147),_0x3747c1+=_0x155267(0x147);let _0x5c4d91=_0x155267(0x1e1);const _0x3a7095={'width':_0x155267(0x1a8),'height':_0x155267(0x267),'orientation':_0x155267(0x1de),'border':{'top':_0x155267(0x13c),'right':'0.1in','bottom':_0x155267(0x13c),'left':_0x155267(0x13c)},'header':{'height':_0x155267(0x154),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x5c4d91+_0x155267(0xe4)+_0xb91dc6[_0x155267(0x274)]+_0x155267(0x164)+_0x502a05+'\x20-\x20'+_0x40fbcb+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':'20mm','contents':{'default':_0x155267(0x212)}},'dpi':0x5,'zoomFactor':'1'};if(_0x746d39=='on'){const _0x2f0d0e=cheerio[_0x155267(0x1dc)](_0x3747c1);let _0x1deb93=[],_0x152b6e=[],_0x36d99e=[];const _0x147fb8=_0x4cf978=>{const _0x599db0=_0x155267,_0xbd7515={'top':{'style':'thick','color':{'rgb':_0x599db0(0x1a9)}},'bottom':{'style':_0x599db0(0xfe),'color':{'rgb':_0x599db0(0x1a9)}},'left':{'style':_0x599db0(0xfe),'color':{'rgb':_0x599db0(0x1a9)}},'right':{'style':'thick','color':{'rgb':_0x599db0(0x1a9)}}};if(_0x4cf978){const _0x3da0ac=_0x4cf978[_0x599db0(0x12c)](';')[_0x599db0(0x145)]((_0x1ce259,_0x4a8e25)=>{const _0x30db8e=_0x599db0,[_0x1b2e9a,_0x4c34ef]=_0x4a8e25[_0x30db8e(0x12c)](':')[_0x30db8e(0x1a6)](_0x206c61=>_0x206c61[_0x30db8e(0x1d3)]());return _0x1ce259[_0x1b2e9a]=_0x4c34ef,_0x1ce259;},{});_0x3da0ac[_0x599db0(0x217)]&&(_0xbd7515[_0x599db0(0x1f6)][_0x599db0(0x1b6)]=_0x3da0ac['border-top'][_0x599db0(0x1e8)](_0x599db0(0x12b))?'thin':_0x599db0(0x18d)),_0x3da0ac[_0x599db0(0x1a3)]&&(_0xbd7515[_0x599db0(0x210)][_0x599db0(0x1b6)]=_0x3da0ac['border-bottom']['includes'](_0x599db0(0x12b))?_0x599db0(0x12b):_0x599db0(0x18d)),_0x3da0ac[_0x599db0(0x25b)]&&(_0xbd7515[_0x599db0(0x1a2)]['style']=_0x3da0ac['border-left'][_0x599db0(0x1e8)](_0x599db0(0x12b))?_0x599db0(0x12b):_0x599db0(0x18d)),_0x3da0ac[_0x599db0(0xf9)]&&(_0xbd7515[_0x599db0(0x130)][_0x599db0(0x1b6)]=_0x3da0ac[_0x599db0(0xf9)][_0x599db0(0x1e8)](_0x599db0(0x12b))?_0x599db0(0x12b):_0x599db0(0x18d));}return _0xbd7515;};_0x2f0d0e(_0x155267(0x24f))[_0x155267(0x23e)]((_0x18c69c,_0x405c50)=>{const _0xfa0a11=_0x155267;let _0x53a019=[],_0x5f3d5d=0x0;while(_0x36d99e[_0x5f3d5d]){_0x36d99e[_0x5f3d5d]--,_0x5f3d5d++;}_0x2f0d0e(_0x405c50)[_0xfa0a11(0x225)]('td,\x20th')[_0xfa0a11(0x23e)]((_0x1c0b70,_0x6ef0b1)=>{const _0x462f48=_0xfa0a11;let _0x3e0eb4=_0x2f0d0e(_0x6ef0b1)[_0x462f48(0x140)]()[_0x462f48(0x1d3)](),_0x3f2cb5=parseFloat(_0x3e0eb4[_0x462f48(0x10d)](/,/g,'')),_0x552f2e={};!isNaN(_0x3f2cb5)?(_0x552f2e['v']=_0x3f2cb5,_0x552f2e['t']='n'):(_0x552f2e['v']=_0x3e0eb4,_0x552f2e['t']='s');const _0x1293cd=_0x2f0d0e(_0x6ef0b1)[_0x462f48(0xfa)](_0x462f48(0x1b6)),_0x46950a=_0x147fb8(_0x1293cd);_0x552f2e['s']={'border':_0x46950a},_0x53a019[_0x5f3d5d]=_0x552f2e;let _0x28fe43=parseInt(_0x2f0d0e(_0x6ef0b1)['attr']('colspan'))||0x1,_0x5742dc=parseInt(_0x2f0d0e(_0x6ef0b1)[_0x462f48(0xfa)](_0x462f48(0x113)))||0x1;(_0x28fe43>0x1||_0x5742dc>0x1)&&_0x152b6e['push']({'s':{'r':_0x18c69c,'c':_0x5f3d5d},'e':{'r':_0x18c69c+_0x5742dc-0x1,'c':_0x5f3d5d+_0x28fe43-0x1}});for(let _0x2887a1=0x0;_0x2887a1<_0x28fe43;_0x2887a1++){_0x5742dc>0x1&&(_0x36d99e[_0x5f3d5d+_0x2887a1]=_0x5742dc-0x1);}_0x5f3d5d+=_0x28fe43;}),_0x1deb93[_0xfa0a11(0x190)](_0x53a019);});const _0x59da1c=XLSX[_0x155267(0x183)][_0x155267(0x250)](),_0x352400=XLSX[_0x155267(0x183)][_0x155267(0x1df)](_0x1deb93);_0x152b6e['length']>0x0&&(_0x352400[_0x155267(0x26c)]=_0x152b6e);_0x352400['!cols']=_0x1deb93[0x0][_0x155267(0x1a6)](()=>({'wpx':0x64})),XLSX[_0x155267(0x183)][_0x155267(0x122)](_0x59da1c,_0x352400,_0x155267(0x232));const _0x1f01ea=XLSX[_0x155267(0x151)](_0x59da1c,{'bookType':_0x155267(0x138),'type':_0x155267(0xff)});_0x2556f6[_0x155267(0x1c4)](_0x155267(0x16b),_0x155267(0x18f)),_0x2556f6[_0x155267(0x1c4)]('Content-Type',_0x155267(0x241)),_0x2556f6[_0x155267(0x162)](_0x1f01ea);}else pdf['create'](_0x3747c1,_0x3a7095)['toStream'](function(_0x38b094,_0x448afc){const _0x3e37f4=_0x155267;if(_0x38b094){_0x2556f6['status'](0x1f4)[_0x3e37f4(0x162)]('Error\x20generating\x20PDF');return;}_0x2556f6[_0x3e37f4(0x1c4)]('Content-Type',_0x3e37f4(0x259)),_0x448afc[_0x3e37f4(0x21a)](_0x2556f6);});}catch(_0x3803f1){}}),router['get']('/inventory_sum/view',auth,async(_0x26abfd,_0x4fa86f)=>{const _0xa3a804=a0_0x54c9e9;try{const {username:_0x4f0747,email:_0x4c3135,role:_0x206f0c}=_0x26abfd['user'],_0x1284b3=_0x26abfd[_0xa3a804(0xe6)],_0x3fe2d3=await profile[_0xa3a804(0x13d)]({'email':_0x1284b3[_0xa3a804(0x220)]}),_0x5249da={'year':_0xa3a804(0x235),'month':'long','day':_0xa3a804(0x235)},_0x12b7c3=await master_shop[_0xa3a804(0x225)](),_0x15b6f0=await product['find'](),_0x5e5a0c=await warehouse[_0xa3a804(0x1b5)]([{'$unwind':_0xa3a804(0x103)},{'$lookup':{'from':_0xa3a804(0x1f5),'localField':_0xa3a804(0x14b),'foreignField':_0xa3a804(0x274),'as':_0xa3a804(0x18c)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0xa3a804(0xf8),'product_stock':_0xa3a804(0x20e)}},{'$group':{'_id':'$product_name','product_stock':{'$sum':_0xa3a804(0x242)}}}]);if(_0x12b7c3[0x0][_0xa3a804(0x142)]==_0xa3a804(0x1b9))var _0x4dc0f1=users[_0xa3a804(0x207)];else{if(_0x12b7c3[0x0][_0xa3a804(0x142)]==_0xa3a804(0x17e))var _0x4dc0f1=users['Hindi'];else{if(_0x12b7c3[0x0][_0xa3a804(0x142)]=='German')var _0x4dc0f1=users[_0xa3a804(0x108)];else{if(_0x12b7c3[0x0]['language']=='Spanish')var _0x4dc0f1=users[_0xa3a804(0x1f2)];else{if(_0x12b7c3[0x0][_0xa3a804(0x142)]==_0xa3a804(0x1c1))var _0x4dc0f1=users[_0xa3a804(0x1c1)];else{if(_0x12b7c3[0x0][_0xa3a804(0x142)]=='Portuguese\x20(BR)')var _0x4dc0f1=users[_0xa3a804(0x23d)];else{if(_0x12b7c3[0x0][_0xa3a804(0x142)]==_0xa3a804(0x255))var _0x4dc0f1=users[_0xa3a804(0x255)];else{if(_0x12b7c3[0x0][_0xa3a804(0x142)]==_0xa3a804(0x275))var _0x4dc0f1=users[_0xa3a804(0x1bb)];}}}}}}}_0x4fa86f['render'](_0xa3a804(0x1fa),{'success':_0x26abfd[_0xa3a804(0x23b)](_0xa3a804(0x1ea)),'errors':_0x26abfd[_0xa3a804(0x23b)](_0xa3a804(0xf2)),'alldata':_0x15b6f0,'profile':_0x3fe2d3,'master_shop':_0x12b7c3,'role':_0x1284b3,'product_stock':_0x5e5a0c,'language':_0x4dc0f1});}catch(_0x401e4b){}});async function dataInventoryReports(_0x1217f5,_0x2cf927,_0x4f7994){const _0x3a575c=a0_0x54c9e9,_0x4e989b=await sales_sa[_0x3a575c(0x1b5)]([{'$match':{'date':{'$gte':_0x1217f5,'$lte':_0x2cf927},'sales_staff_id':_0x4f7994}},{'$unwind':'$sale_product'},{'$group':{'_id':{'product_name':_0x3a575c(0x143),'product_code':'$sale_product.product_code'},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x3501d7=mongoose[_0x3a575c(0x269)][_0x3a575c(0x152)],_0x57fe62=await staff[_0x3a575c(0x1b5)]([{'$match':{'_id':_0x3501d7(_0x4f7994)}},{'$unwind':'$product_list'},{'$match':{'product_list.isConfirm':_0x3a575c(0x26b)}},{'$group':{'_id':{'product_name':_0x3a575c(0x246),'product_code':_0x3a575c(0x193)},'sumqty':{'$sum':_0x3a575c(0x11f)}}},{'$sort':{'_id.product_name':0x1}}]),_0x41e2db=await sales_inv_data['aggregate']([{'$match':{'date':{'$gte':_0x1217f5,'$lte':_0x2cf927},'sales_staff_id':_0x4f7994}},{'$unwind':_0x3a575c(0x245)},{'$group':{'_id':{'product_name':'$sale_product.product_name','product_code':_0x3a575c(0x131)},'totalQTYsum':{'$sum':_0x3a575c(0x1d8)}}}]);console[_0x3a575c(0x187)](_0x41e2db);let _0x436f46='';var _0x2f780f=0x0;for(let _0x1e4615=0x0;_0x1e4615<=_0x57fe62[_0x3a575c(0x192)]-0x1;_0x1e4615++){const _0x30d332=_0x57fe62[_0x1e4615];_0x436f46+='<tr>',_0x436f46+=_0x3a575c(0x125)+_0x30d332[_0x3a575c(0x1ec)]['product_code']+'</td>',_0x436f46+=_0x3a575c(0x19a)+_0x30d332[_0x3a575c(0x1ec)][_0x3a575c(0x1ac)]+_0x3a575c(0x21d);var _0x314c1a=_0x30d332[_0x3a575c(0x106)],_0x3e574d=0x0;for(let _0x503f6e=0x0;_0x503f6e<=_0x4e989b[_0x3a575c(0x192)]-0x1;_0x503f6e++){const _0xace689=_0x4e989b[_0x503f6e];_0x30d332[_0x3a575c(0x1ec)][_0x3a575c(0x11e)]==_0xace689[_0x3a575c(0x1ec)][_0x3a575c(0x11e)]&&_0x30d332[_0x3a575c(0x1ec)][_0x3a575c(0x1ac)]==_0xace689['_id'][_0x3a575c(0x1ac)]&&(_0x3e574d=_0xace689[_0x3a575c(0x106)]);}var _0x5a2b33=0x0;for(let _0x523670=0x0;_0x523670<=_0x41e2db[_0x3a575c(0x192)]-0x1;_0x523670++){const _0x4f3a80=_0x41e2db[_0x523670];_0x30d332['_id'][_0x3a575c(0x11e)]==_0x4f3a80[_0x3a575c(0x1ec)][_0x3a575c(0x11e)]&&_0x30d332['_id'][_0x3a575c(0x1ac)]==_0x4f3a80['_id'][_0x3a575c(0x1ac)]&&(_0x5a2b33=_0x4f3a80[_0x3a575c(0x249)]);}_0x2f780f=_0x314c1a-_0x5a2b33+_0x3e574d,_0x436f46+=_0x3a575c(0x24b)+_0x2f780f+_0x3a575c(0x21d);let _0x564ce9=![];for(let _0x4af13d=0x0;_0x4af13d<=_0x41e2db[_0x3a575c(0x192)]-0x1;_0x4af13d++){const _0x170d76=_0x41e2db[_0x4af13d];if(_0x30d332['_id'][_0x3a575c(0x11e)]==_0x170d76[_0x3a575c(0x1ec)][_0x3a575c(0x11e)]&&_0x30d332['_id'][_0x3a575c(0x1ac)]==_0x170d76[_0x3a575c(0x1ec)][_0x3a575c(0x1ac)]){_0x436f46+=_0x3a575c(0x24b)+_0x170d76['totalQTYsum']+_0x3a575c(0x21d),_0x564ce9=!![];break;}}!_0x564ce9&&(_0x436f46+='<td\x20class=\x22row_data\x22>0</td>');let _0x5aa5fc=![];for(let _0x36223e=0x0;_0x36223e<=_0x4e989b['length']-0x1;_0x36223e++){const _0xd82a5f=_0x4e989b[_0x36223e];if(_0x30d332[_0x3a575c(0x1ec)][_0x3a575c(0x11e)]==_0xd82a5f[_0x3a575c(0x1ec)][_0x3a575c(0x11e)]&&_0x30d332[_0x3a575c(0x1ec)][_0x3a575c(0x1ac)]==_0xd82a5f[_0x3a575c(0x1ec)]['product_name']){_0x436f46+='<td\x20class=\x22row_data\x22>'+_0xd82a5f[_0x3a575c(0x106)]+_0x3a575c(0x21d),_0x5aa5fc=!![];break;}}!_0x5aa5fc&&(_0x436f46+='<td\x20class=\x22row_data\x22>0</td>'),_0x436f46+=_0x3a575c(0x24b)+_0x30d332[_0x3a575c(0x106)]+_0x3a575c(0x21d),_0x436f46+=_0x3a575c(0x1ab);}return _0x436f46;}router['post'](a0_0x54c9e9(0x188),auth,async(_0x315b48,_0x3328c4)=>{const _0x40bb89=a0_0x54c9e9;try{const {from_date:_0x2693a0,to_date:_0x272ec2}=_0x315b48['body'],_0x4d2853=_0x315b48[_0x40bb89(0xe6)],_0x5503c9=await staff[_0x40bb89(0x13d)]({'email':_0x4d2853[_0x40bb89(0x220)]});let _0x16cbdb=_0x40bb89(0x194);var _0x18b45f=new Date(_0x2693a0),_0x4840a6=new Date(_0x272ec2);const _0x4c0f8e={'year':'numeric','month':'long','day':'numeric'},_0x153a24=new Intl[(_0x40bb89(0x1dd))](_0x40bb89(0x161),_0x4c0f8e)[_0x40bb89(0x16e)](_0x18b45f),_0x145359=new Intl[(_0x40bb89(0x1dd))](_0x40bb89(0x161),_0x4c0f8e)[_0x40bb89(0x16e)](_0x4840a6);var _0x4047aa=await dataInventoryReports(_0x2693a0,_0x272ec2,_0x5503c9[_0x40bb89(0x1ec)]['valueOf']());_0x16cbdb+=_0x40bb89(0x191),_0x16cbdb+=_0x40bb89(0x208),_0x16cbdb+=_0x40bb89(0x112)+_0x153a24+_0x40bb89(0x177)+_0x145359+_0x40bb89(0x218),_0x16cbdb+='<div\x20class=\x22row\x22>',_0x16cbdb+='<div\x20class=\x22col-sm-11\x22>',_0x16cbdb+=_0x40bb89(0x263),_0x16cbdb+=_0x40bb89(0xf4),_0x16cbdb+='<th>\x20ITEM\x20CODE\x20</th>',_0x16cbdb+=_0x40bb89(0x1c0),_0x16cbdb+=_0x40bb89(0x146),_0x16cbdb+=_0x40bb89(0x1c9),_0x16cbdb+=_0x40bb89(0x129),_0x16cbdb+=_0x40bb89(0x1bf),_0x16cbdb+=_0x40bb89(0xf4),_0x16cbdb+=_0x4047aa,_0x16cbdb+=_0x40bb89(0x1ab),_0x16cbdb+=_0x40bb89(0x147),_0x16cbdb+=_0x40bb89(0x147);const _0x36d5f3={'format':_0x40bb89(0x102),'orientation':_0x40bb89(0x1de)};pdf['create'](_0x16cbdb,_0x36d5f3)['toStream'](function(_0x5e1caa,_0x27a228){const _0x4e981f=_0x40bb89;if(_0x5e1caa){_0x3328c4['status'](0x1f4)['send']('Error\x20generating\x20PDF');return;}_0x3328c4['setHeader'](_0x4e981f(0x256),'application/pdf'),_0x27a228['pipe'](_0x3328c4);});}catch(_0x317a49){}}),router[a0_0x54c9e9(0x1ba)](a0_0x54c9e9(0x23f),auth,async(_0xaf1ed8,_0x219ca7)=>{const _0x3f7ffa=a0_0x54c9e9;try{const {username:_0x316fdf,email:_0x3eb393,role:_0x4bf043}=_0xaf1ed8['user'],_0x117709=_0xaf1ed8[_0x3f7ffa(0xe6)],_0x382861=await profile[_0x3f7ffa(0x13d)]({'email':_0x117709['email']}),_0x545bf4={'year':'numeric','month':_0x3f7ffa(0x1f3),'day':_0x3f7ffa(0x235)},_0x445fc2=await master_shop['find']();console[_0x3f7ffa(0x187)](_0x3f7ffa(0x229),_0x445fc2);const _0x639daa=await product[_0x3f7ffa(0x225)]();console[_0x3f7ffa(0x187)](_0x3f7ffa(0x20a),_0x639daa);const _0x4eecd6=await warehouse[_0x3f7ffa(0x1b5)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x3f7ffa(0x1f5),'localField':_0x3f7ffa(0x14b),'foreignField':_0x3f7ffa(0x274),'as':_0x3f7ffa(0x18c)}},{'$unwind':_0x3f7ffa(0x1cd)},{'$project':{'product_name':_0x3f7ffa(0xf8),'product_stock':'$product_details.product_stock'}},{'$group':{'_id':_0x3f7ffa(0x1f8),'product_stock':{'$sum':_0x3f7ffa(0x242)}}}]);console['log'](_0x3f7ffa(0x260),_0x4eecd6),_0x4eecd6[_0x3f7ffa(0x107)](_0x4b0e93=>{const _0x41126d=_0x639daa['map'](_0x200fdb=>{const _0x77e05c=a0_0x4a18;_0x200fdb[_0x77e05c(0x274)]==_0x4b0e93['_id']&&(_0x200fdb[_0x77e05c(0x186)]=parseInt(_0x200fdb[_0x77e05c(0x186)])+parseInt(_0x4b0e93[_0x77e05c(0x136)]));});});const _0x5d12fc=await staff[_0x3f7ffa(0x13d)]({'email':_0x117709[_0x3f7ffa(0x220)]});if(_0x445fc2[0x0][_0x3f7ffa(0x142)]==_0x3f7ffa(0x1b9))var _0x3ad562=users[_0x3f7ffa(0x207)];else{if(_0x445fc2[0x0][_0x3f7ffa(0x142)]==_0x3f7ffa(0x17e))var _0x3ad562=users[_0x3f7ffa(0x17e)];else{if(_0x445fc2[0x0][_0x3f7ffa(0x142)]==_0x3f7ffa(0x108))var _0x3ad562=users[_0x3f7ffa(0x108)];else{if(_0x445fc2[0x0][_0x3f7ffa(0x142)]==_0x3f7ffa(0x1f2))var _0x3ad562=users[_0x3f7ffa(0x1f2)];else{if(_0x445fc2[0x0][_0x3f7ffa(0x142)]==_0x3f7ffa(0x1c1))var _0x3ad562=users['French'];else{if(_0x445fc2[0x0][_0x3f7ffa(0x142)]==_0x3f7ffa(0x213))var _0x3ad562=users[_0x3f7ffa(0x23d)];else{if(_0x445fc2[0x0][_0x3f7ffa(0x142)]==_0x3f7ffa(0x255))var _0x3ad562=users[_0x3f7ffa(0x255)];else{if(_0x445fc2[0x0][_0x3f7ffa(0x142)]=='Arabic\x20(ae)')var _0x3ad562=users[_0x3f7ffa(0x1bb)];}}}}}}}_0x219ca7['render'](_0x3f7ffa(0x1f7),{'success':_0xaf1ed8['flash'](_0x3f7ffa(0x1ea)),'errors':_0xaf1ed8[_0x3f7ffa(0x23b)](_0x3f7ffa(0xf2)),'alldata':_0x639daa,'profile':_0x382861,'master_shop':_0x445fc2,'role':_0x117709,'product_stock':_0x4eecd6,'language':_0x3ad562,'staff_arr':_0x5d12fc});}catch(_0x15c460){}});async function agentsdataDSICheck_DSRR(_0x3490b6,_0x125d71,_0x16a32e,_0x58d7a4){const _0x39dba9=a0_0x54c9e9;let _0x238b5d=new Date(_0x3490b6);_0x238b5d[_0x39dba9(0x16c)](_0x238b5d['getDate']()-0x1);let _0x200cde=_0x238b5d[_0x39dba9(0x1fc)]()[_0x39dba9(0x12c)]('T')[0x0];const _0x1e14e7=await product['aggregate']([{'$group':{'_id':{'brand':'$brand','category':_0x39dba9(0x19c)},'products':{'$push':{'name':_0x39dba9(0x104),'product_code':_0x39dba9(0x234)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x35a510=[];_0x35a510[_0x39dba9(0x205)]=[];for(let _0x4ce488=0x0;_0x4ce488<=_0x1e14e7[_0x39dba9(0x192)]-0x1;_0x4ce488++){const _0x336701=_0x1e14e7[_0x4ce488];_0x35a510[_0x39dba9(0x205)][_0x39dba9(0x190)](_0x336701);}const _0x1221a2=await product['aggregate']([{'$group':{'_id':{'category':_0x39dba9(0x19c)},'products':{'$push':{'brand':_0x39dba9(0x1b2),'product_code':_0x39dba9(0x234),'product_name':_0x39dba9(0x104)}}}},{'$sort':{'_id.category':-0x1}}]),_0x1f4910=await product[_0x39dba9(0x1b5)]([{'$group':{'_id':{'category':'$category','brand':_0x39dba9(0x1b2)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x1a1dd0=await sales_sa[_0x39dba9(0x1b5)]([{'$match':{'date':_0x3490b6,'sales_staff_id':_0x125d71,'sale_product.isFG':'false'}},{'$unwind':_0x39dba9(0x245)},{'$lookup':{'from':'products','localField':_0x39dba9(0x141),'foreignField':_0x39dba9(0x11e),'as':_0x39dba9(0x1ef)}},{'$unwind':_0x39dba9(0x167)},{'$group':{'_id':{'dsi':_0x39dba9(0x233),'date':'$date','customer':_0x39dba9(0x201),'status_data':_0x39dba9(0x1d1)},'totalQty':{'$sum':_0x39dba9(0x18e)},'cash':{'$first':'$cash'},'amount':{'$first':_0x39dba9(0x18b)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x39dba9(0x109)},'due_date':{'$first':_0x39dba9(0x23c)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':_0x39dba9(0x1ce),'discount':_0x39dba9(0x1b3),'adj_discount':_0x39dba9(0x121),'product_details':{'prod_name':'$product_info.name','product_code':_0x39dba9(0x1a0),'category':'$product_info.category','brand':_0x39dba9(0x196),'gross_price':_0x39dba9(0x124),'isFG':_0x39dba9(0x1c6),'prod_cat':'$sale_product.prod_cat','prod_id':_0x39dba9(0x16d)}}}}},{'$unwind':_0x39dba9(0x230)},{'$group':{'_id':{'dsi':_0x39dba9(0x25f),'date':_0x39dba9(0x15d),'customer':_0x39dba9(0x1a5),'status_data':'$_id.status_data','category':_0x39dba9(0x1d6),'brand':'$products.product_details.brand','prod_id':_0x39dba9(0x116)},'totalQty':{'$sum':_0x39dba9(0x25c)},'totalGross':{'$sum':{'$multiply':[_0x39dba9(0x25c),_0x39dba9(0x13b)]}},'NetPrice':{'$sum':_0x39dba9(0x115)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'cash':{'$first':_0x39dba9(0x22f)},'amount':{'$first':_0x39dba9(0x18b)},'bank':{'$first':_0x39dba9(0x22c)},'check_no':{'$first':_0x39dba9(0x109)},'due_date':{'$first':'$due_date'},'product_details':{'$first':_0x39dba9(0x20b)}}},{'$group':{'_id':{'dsi':_0x39dba9(0x25f),'date':_0x39dba9(0x15d),'customer':'$_id.customer','status_data':_0x39dba9(0x11c)},'totalQty':{'$sum':_0x39dba9(0xe3)},'totalGross':{'$sum':_0x39dba9(0x1ee)},'NetPrice':{'$sum':_0x39dba9(0x170)},'discount':{'$sum':_0x39dba9(0x127)},'adj_discount':{'$sum':_0x39dba9(0x17f)},'cash':{'$first':_0x39dba9(0x22f)},'amount':{'$first':_0x39dba9(0x18b)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x39dba9(0x109)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x39dba9(0xe3),'category':_0x39dba9(0x1fb),'brand':_0x39dba9(0x165),'product_details':_0x39dba9(0x103)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x5f4377=await sales_sa[_0x39dba9(0x1b5)]([{'$match':{'date':_0x200cde,'sales_staff_id':_0x125d71,'sale_product.isFG':_0x39dba9(0x171)}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x39dba9(0x1f5),'localField':_0x39dba9(0x141),'foreignField':'product_code','as':_0x39dba9(0x1ef)}},{'$unwind':_0x39dba9(0x167)},{'$group':{'_id':{'dsi':_0x39dba9(0x233),'date':_0x39dba9(0x12e),'customer':'$customer'},'totalQty':{'$sum':_0x39dba9(0x18e)},'cash':{'$first':'$cash'},'amount':{'$first':_0x39dba9(0x18b)},'bank':{'$first':_0x39dba9(0x22c)},'check_no':{'$first':_0x39dba9(0x109)},'due_date':{'$first':'$due_date'},'products':{'$push':{'qty':_0x39dba9(0x18e),'NetPrice':'$sale_product.totalprice','discount':_0x39dba9(0x1b3),'adj_discount':_0x39dba9(0x121),'product_details':{'prod_name':_0x39dba9(0x17c),'product_code':_0x39dba9(0x1a0),'category':'$product_info.category','brand':_0x39dba9(0x196),'gross_price':'$product_info.gross_price','isFG':'$sale_product.isFG','prod_cat':_0x39dba9(0x272),'prod_id':'$sale_product._id'}}}}},{'$unwind':_0x39dba9(0x230)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x39dba9(0x15d),'customer':_0x39dba9(0x1a5),'category':'$products.product_details.category','brand':_0x39dba9(0x166),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':'$products.qty'},'cash':{'$first':_0x39dba9(0x22f)},'amount':{'$first':_0x39dba9(0x18b)},'bank':{'$first':_0x39dba9(0x22c)},'check_no':{'$first':_0x39dba9(0x109)},'due_date':{'$first':_0x39dba9(0x23c)},'totalGross':{'$sum':{'$multiply':[_0x39dba9(0x25c),_0x39dba9(0x13b)]}},'NetPrice':{'$sum':_0x39dba9(0x115)},'discount':{'$sum':_0x39dba9(0x1da)},'adj_discount':{'$sum':_0x39dba9(0x178)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x39dba9(0x15d),'customer':'$_id.customer'},'totalQty':{'$sum':_0x39dba9(0xe3)},'cash':{'$first':'$cash'},'amount':{'$first':'$amount'},'bank':{'$first':_0x39dba9(0x22c)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x39dba9(0x23c)},'totalGross':{'$sum':_0x39dba9(0x1ee)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x39dba9(0x127)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x39dba9(0xe3),'category':'$_id.category','brand':_0x39dba9(0x165),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x45392b=await sales_sa[_0x39dba9(0x1b5)]([{'$match':{'date':_0x3490b6,'sales_staff_id':_0x125d71,'status_data':_0x39dba9(0x26b)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x584e3c=await staff[_0x39dba9(0x266)](_0x125d71);let _0xb239c9=[],_0x1aed04={},_0xf747c5={};var _0x581c1c=0x0,_0x2cdf85=0x0,_0x4dce63=0x0,_0x21717d=0x0,_0x115022=0x0;const _0x2698e8=0x6;var _0x53d6b0=0x0,_0x1a7310=0x0;for(let _0xabb170=0x0;_0xabb170<=_0x1a1dd0[_0x39dba9(0x192)]-0x1;_0xabb170++){const _0x24ef83=_0x1a1dd0[_0xabb170];let _0x2a759f=_0x39dba9(0xf4);_0x2a759f+=_0x39dba9(0x239),_0x2a759f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x24ef83[_0x39dba9(0x1ec)][_0x39dba9(0x219)]+_0x39dba9(0x21d),_0x2a759f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x24ef83[_0x39dba9(0x1ec)][_0x39dba9(0x1e0)]+_0x39dba9(0x21d);let _0x358cd1={},_0x59462c={},_0x1f57a2={};var _0x126028={},_0x2bc1c5={},_0x2d3e14={},_0x137c83=0x0;for(let _0x88ba31=0x0;_0x88ba31<=_0x24ef83[_0x39dba9(0x1f5)][_0x39dba9(0x192)]-0x1;_0x88ba31++){const _0x320a5a=_0x24ef83[_0x39dba9(0x1f5)][_0x88ba31];_0x358cd1[_0x320a5a[_0x39dba9(0x22e)]+'-'+_0x320a5a[_0x39dba9(0xec)]]=_0x320a5a[_0x39dba9(0x26e)],_0x59462c[[_0x320a5a['brand']+'-'+_0x320a5a[_0x39dba9(0xec)]]]=_0x320a5a[_0x39dba9(0x1c7)][_0x39dba9(0x10b)],_0x1f57a2[[_0x320a5a[_0x39dba9(0x22e)]+'-'+_0x320a5a[_0x39dba9(0xec)]]]=_0x320a5a[_0x39dba9(0x1c7)][_0x39dba9(0x21f)];const _0xdd2d52=_0x320a5a[_0x39dba9(0x22e)]+'-'+_0x320a5a[_0x39dba9(0xec)];!Array[_0x39dba9(0x1c2)](_0xf747c5[_0xdd2d52])&&(_0xf747c5[_0xdd2d52]=[]);!Array[_0x39dba9(0x1c2)](_0xf747c5[_0xdd2d52])&&(_0xf747c5[_0xdd2d52]=[]);_0xf747c5[_0xdd2d52][_0x39dba9(0x190)](_0x320a5a[_0x39dba9(0x26e)]);if(_0x320a5a[_0x39dba9(0x1c7)][_0x39dba9(0x21f)]=='P')_0x320a5a[_0x39dba9(0x1c7)][_0x39dba9(0x10b)]=='true'?(!_0x2d3e14[_0xdd2d52]&&(_0x2d3e14[_0xdd2d52]=0x0),_0x2d3e14[_0xdd2d52]=_0x320a5a['qty']):(!_0x126028[_0xdd2d52]&&(_0x126028[_0xdd2d52]=0x0),_0x126028[_0xdd2d52]=_0x320a5a['qty']);else _0x320a5a[_0x39dba9(0x1c7)][_0x39dba9(0x21f)]=='S'&&(_0x320a5a[_0x39dba9(0x1c7)]['isFG']==_0x39dba9(0x26b)?(!_0x2d3e14[_0xdd2d52]&&(_0x2d3e14[_0xdd2d52]=0x0),_0x2d3e14[_0xdd2d52]=_0x320a5a[_0x39dba9(0x26e)]):(!_0x2bc1c5[_0xdd2d52]&&(_0x2bc1c5[_0xdd2d52]=0x0),_0x2bc1c5[_0xdd2d52]=_0x320a5a[_0x39dba9(0x26e)]));_0x137c83++;}for(let _0x1eae05=0x0;_0x1eae05<=_0x35a510[_0x39dba9(0x205)][_0x39dba9(0x192)]-0x1;_0x1eae05++){const _0x419b68=_0x35a510[_0x39dba9(0x205)][_0x1eae05],_0x47fee7=_0x419b68[_0x39dba9(0x1ec)]['brand']+'-'+_0x419b68[_0x39dba9(0x1ec)][_0x39dba9(0xec)],_0x29eb1f=_0x1f57a2[_0x47fee7]!==undefined?_0x1f57a2[_0x47fee7]:'NA';var _0x5915f0=_0x126028[_0x47fee7]!==undefined?_0x126028[_0x47fee7][_0x39dba9(0x1e3)](0x2):'',_0x51f7df=_0x2bc1c5[_0x47fee7]!==undefined?_0x2bc1c5[_0x47fee7]['toFixed'](0x2):'',_0x341d8b=_0x2d3e14[_0x47fee7]!==undefined?_0x2d3e14[_0x47fee7][_0x39dba9(0x1e3)](0x2):'';_0x2a759f+=_0x39dba9(0xfc)+_0x5915f0+_0x39dba9(0x21d),_0x2a759f+=_0x39dba9(0xfc)+_0x51f7df+_0x39dba9(0x21d),_0x2a759f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x341d8b+_0x39dba9(0x21d);}var _0x383576=formatNumber(parseFloat(_0x24ef83[_0x39dba9(0x1eb)])),_0x436cfe=formatNumber(parseFloat(_0x24ef83[_0x39dba9(0x19e)]));isNaN(_0x436cfe)&&(_0x436cfe=0x0),_0x2a759f+=_0x39dba9(0xfc)+_0x383576+'</td>',_0x2a759f+=_0x39dba9(0xfc)+_0x436cfe+_0x39dba9(0x21d),_0x2a759f+=_0x39dba9(0x24e)+_0x24ef83[_0x39dba9(0x179)]+_0x39dba9(0x21d),_0x2a759f+=_0x39dba9(0x24e)+_0x24ef83['check_no']+_0x39dba9(0x21d),_0x2a759f+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x24ef83[_0x39dba9(0x222)]+_0x39dba9(0x21d),_0x4dce63=_0x24ef83[_0x39dba9(0x1e6)]+_0x24ef83[_0x39dba9(0x20c)],_0x53d6b0+=parseFloat(_0x24ef83[_0x39dba9(0x1eb)]),_0x1a7310+=parseFloat(_0x436cfe),_0xb239c9[_0x39dba9(0x190)](_0x2a759f);}function _0x2ce411(_0x475cbe,_0x4d5096){const _0x25672b=_0x39dba9,_0x107094=[];for(let _0x2360c6=0x0;_0x2360c6<=_0x475cbe[_0x25672b(0x192)]-0x1;_0x2360c6+=_0x4d5096){_0x107094['push'](_0x475cbe[_0x25672b(0x100)](_0x2360c6,_0x2360c6+_0x4d5096));}return _0x107094;}const _0x1a60f9=_0x2ce411(_0xb239c9,_0x2698e8);let _0x406116='';return _0x1a60f9['forEach']((_0x27e52e,_0xe31624)=>{const _0x3182b2=_0x39dba9;_0xe31624>0x0&&(_0x406116+=_0x3182b2(0x21e));_0x406116+=_0x3182b2(0x263),_0x406116+=_0x3182b2(0x228);const _0x45fba9=new Date(_0x3490b6),_0x829c5c={'year':_0x3182b2(0x235),'month':_0x3182b2(0x1f3),'day':_0x3182b2(0x235),'timeZone':_0x3182b2(0x13a)},_0x5d86aa=_0x45fba9[_0x3182b2(0x202)](_0x3182b2(0x161),_0x829c5c);_0x406116+=_0x3182b2(0xf4),_0x406116+=_0x3182b2(0x1e2)+_0x58d7a4+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x1ab),_0x406116+='<tr>',_0x406116+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0x584e3c[_0x3182b2(0x274)]+_0x3182b2(0x21d),_0x406116+=_0x3182b2(0xe8),_0x406116+=_0x3182b2(0x251),_0x406116+='<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>',_0x406116+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x406116+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>',_0x406116+=_0x3182b2(0xef),_0x406116+=_0x3182b2(0x118),_0x406116+=_0x3182b2(0x226),_0x406116+=_0x3182b2(0x1ab),_0x406116+='<tr>',_0x406116+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>',_0x406116+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20'+_0x5d86aa+_0x3182b2(0x21d),_0x406116+=_0x3182b2(0x270),_0x406116+=_0x3182b2(0x26a),_0x406116+=_0x3182b2(0x22b),_0x406116+=_0x3182b2(0x22b),_0x406116+='</tr>',_0x406116+=_0x3182b2(0xf4),_0x406116+=_0x3182b2(0x158),_0x406116+=_0x3182b2(0x1d0),_0x406116+=_0x3182b2(0xf7),_0x406116+=_0x3182b2(0x22b),_0x406116+=_0x3182b2(0x22b),_0x406116+=_0x3182b2(0x1ab),_0x406116+=_0x3182b2(0xf4),_0x406116+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x406116+='</tr>',_0x406116+=_0x3182b2(0xf4),_0x406116+='<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x406116+=_0x3182b2(0x14f),_0x406116+=_0x3182b2(0x1ab),_0x406116+='<tr>',_0x406116+=_0x3182b2(0x1e4),_0x406116+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x406116+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>';for(let _0x52c11c=0x0;_0x52c11c<=_0x1221a2[_0x3182b2(0x192)]-0x1;_0x52c11c++){const _0x3e5266=_0x1221a2[_0x52c11c];for(let _0x44aefb=0x0;_0x44aefb<_0x35a510[_0x3182b2(0x205)][_0x3182b2(0x192)];_0x44aefb++){const _0x494979=_0x35a510[_0x3182b2(0x205)][_0x44aefb];if(_0x494979[_0x3182b2(0x1ec)][_0x3182b2(0xec)]===_0x3e5266['_id'][_0x3182b2(0xec)]){var _0x2b853d='';switch(_0x3e5266['_id'][_0x3182b2(0xec)]){case _0x3182b2(0xed):_0x2b853d=_0x494979[_0x3182b2(0x1ec)][_0x3182b2(0x22e)]+_0x3182b2(0x1f0);break;case _0x3182b2(0x200):_0x2b853d=_0x494979[_0x3182b2(0x1ec)][_0x3182b2(0x22e)]+_0x3182b2(0x240);break;default:_0x2b853d=_0x494979[_0x3182b2(0x1ec)][_0x3182b2(0x22e)];break;}_0x406116+=_0x3182b2(0x176)+_0x2b853d+_0x3182b2(0x257);}}}_0x406116+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>',_0x406116+=_0x3182b2(0x273),_0x406116+=_0x3182b2(0x14c),_0x406116+=_0x3182b2(0x1ab),_0x406116+=_0x3182b2(0xf4),_0x406116+=_0x3182b2(0x261);for(let _0x46d007=0x0;_0x46d007<=_0x35a510['cat_brand'][_0x3182b2(0x192)]-0x1;_0x46d007++){const _0x402ff1=_0x35a510[_0x46d007];_0x406116+='<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>',_0x406116+=_0x3182b2(0x15a),_0x406116+=_0x3182b2(0x189);}_0x406116+=_0x3182b2(0x10a),_0x406116+=_0x3182b2(0x1ca),_0x406116+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>',_0x406116+='</tr>',_0x406116+='</thead>',_0x406116+='<tbody>',_0x27e52e['forEach'](_0x3c5234=>{_0x406116+=_0x3c5234;});let _0x5e51a9={},_0x44f5eb={},_0x22c29f={};for(let _0x148c2d=0x0;_0x148c2d<=_0x1a1dd0[_0x3182b2(0x192)]-0x1;_0x148c2d++){const _0x6502f0=_0x1a1dd0[_0x148c2d];var _0x1be49d=0x0;for(let _0x34d346=0x0;_0x34d346<=_0x6502f0[_0x3182b2(0x1f5)]['length']-0x1;_0x34d346++){const _0x17ecab=_0x6502f0[_0x3182b2(0x1f5)][_0x34d346],_0x5aa463=_0x17ecab['brand']+'-'+_0x17ecab[_0x3182b2(0xec)];if(_0x17ecab['product_details']['prod_cat']=='P')_0x17ecab[_0x3182b2(0x1c7)][_0x3182b2(0x10b)]=='true'?(!_0x22c29f[_0x5aa463]&&(_0x22c29f[_0x5aa463]=0x0),_0x22c29f[_0x5aa463]+=_0x17ecab['qty']):(!_0x5e51a9[_0x5aa463]&&(_0x5e51a9[_0x5aa463]=0x0),_0x5e51a9[_0x5aa463]+=_0x17ecab[_0x3182b2(0x26e)]);else _0x17ecab[_0x3182b2(0x1c7)][_0x3182b2(0x21f)]=='S'&&(_0x17ecab[_0x3182b2(0x1c7)][_0x3182b2(0x10b)]==_0x3182b2(0x26b)?(!_0x22c29f[_0x5aa463]&&(_0x22c29f[_0x5aa463]=0x0),_0x22c29f[_0x5aa463]+=_0x17ecab[_0x3182b2(0x26e)],console[_0x3182b2(0x187)](_0x17ecab['qty'])):(!_0x44f5eb[_0x5aa463]&&(_0x44f5eb[_0x5aa463]=0x0),_0x44f5eb[_0x5aa463]+=_0x17ecab[_0x3182b2(0x26e)]));_0x1be49d++;}}let _0x2629d0={},_0x3d33b8={},_0x138f8b={};var _0x40715f=0x0,_0x3e9431=0x0;for(let _0x2c71f3=0x0;_0x2c71f3<=_0x5f4377[_0x3182b2(0x192)]-0x1;_0x2c71f3++){const _0x1f9d51=_0x5f4377[_0x2c71f3];var _0x1be49d=0x0;for(let _0x2a45d0=0x0;_0x2a45d0<=_0x1f9d51['products'][_0x3182b2(0x192)]-0x1;_0x2a45d0++){const _0x4f8fc8=_0x1f9d51[_0x3182b2(0x1f5)][_0x2a45d0],_0x59a96d=_0x4f8fc8['brand']+'-'+_0x4f8fc8['category'];if(_0x4f8fc8[_0x3182b2(0x1c7)][_0x3182b2(0x21f)]=='P')_0x4f8fc8[_0x3182b2(0x1c7)][_0x3182b2(0x10b)]=='true'?(!_0x138f8b[_0x59a96d]&&(_0x138f8b[_0x59a96d]=0x0),_0x138f8b[_0x59a96d]+=_0x4f8fc8[_0x3182b2(0x26e)]):(!_0x2629d0[_0x59a96d]&&(_0x2629d0[_0x59a96d]=0x0),_0x2629d0[_0x59a96d]+=_0x4f8fc8[_0x3182b2(0x26e)]);else _0x4f8fc8[_0x3182b2(0x1c7)][_0x3182b2(0x21f)]=='S'&&(_0x4f8fc8[_0x3182b2(0x1c7)][_0x3182b2(0x10b)]==_0x3182b2(0x26b)?(!_0x138f8b[_0x59a96d]&&(_0x138f8b[_0x59a96d]=0x0),_0x138f8b[_0x59a96d]+=_0x4f8fc8['qty']):(!_0x3d33b8[_0x59a96d]&&(_0x3d33b8[_0x59a96d]=0x0),_0x3d33b8[_0x59a96d]+=_0x4f8fc8[_0x3182b2(0x26e)]));_0x1be49d++;}var _0x3e657d=parseFloat(_0x1f9d51[_0x3182b2(0x1eb)]),_0x57d443=parseFloat(_0x1f9d51[_0x3182b2(0x19e)]);isNaN(_0x57d443)&&(_0x57d443=0x0),_0x40715f+=_0x3e657d,_0x3e9431+=_0x57d443;}if(_0x45392b[_0x3182b2(0x192)]>0x0)for(let _0x3215ed=0x0;_0x3215ed<=_0x45392b[_0x3182b2(0x192)]-0x1;_0x3215ed++){const _0x1d997f=_0x45392b[_0x3215ed];console[_0x3182b2(0x187)](_0x1d997f),_0x406116+='<tr>',_0x406116+=_0x3182b2(0x13e)+(0x8+0x7*0x3)+_0x3182b2(0x15c)+_0x1d997f[_0x3182b2(0x14a)]+_0x3182b2(0x257),_0x406116+='</tr>';}_0x406116+='<tr>',_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x406116+=_0x3182b2(0x211),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x4f23fd=0x0;_0x4f23fd<=_0x35a510['cat_brand'][_0x3182b2(0x192)]-0x1;_0x4f23fd++){const _0x73a943=_0x35a510[_0x3182b2(0x205)][_0x4f23fd],_0x209378=_0x73a943['_id'][_0x3182b2(0x22e)]+'-'+_0x73a943[_0x3182b2(0x1ec)][_0x3182b2(0xec)];var _0x10fe0e=_0x5e51a9[_0x209378]!==undefined?formatNumber(_0x5e51a9[_0x209378][_0x3182b2(0x1e3)](0x2)):'',_0x579c02=_0x22c29f[_0x209378]!==undefined?formatNumber(_0x22c29f[_0x209378][_0x3182b2(0x1e3)](0x2)):'',_0x213a41=_0x44f5eb[_0x209378]!==undefined?formatNumber(_0x44f5eb[_0x209378][_0x3182b2(0x1e3)](0x2)):'';_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x10fe0e+_0x3182b2(0x257),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x213a41+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x1d7)+_0x579c02+_0x3182b2(0x257);}_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x53d6b0)+'</b></td>',_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x1a7310)+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+='</tr>',_0x406116+='<tr>',_0x406116+=_0x3182b2(0x22a),_0x406116+=_0x3182b2(0x16f),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x2e38b3=0x0;_0x2e38b3<=_0x35a510[_0x3182b2(0x205)][_0x3182b2(0x192)]-0x1;_0x2e38b3++){const _0x240bcc=_0x35a510[_0x3182b2(0x205)][_0x2e38b3],_0x366bf8=_0x240bcc[_0x3182b2(0x1ec)][_0x3182b2(0x22e)]+'-'+_0x240bcc[_0x3182b2(0x1ec)][_0x3182b2(0xec)];var _0x10fe0e=_0x2629d0[_0x366bf8]!==undefined?formatNumber(_0x2629d0[_0x366bf8][_0x3182b2(0x1e3)](0x2)):'',_0x579c02=_0x138f8b[_0x366bf8]!==undefined?formatNumber(_0x138f8b[_0x366bf8][_0x3182b2(0x1e3)](0x2)):'',_0x213a41=_0x3d33b8[_0x366bf8]!==undefined?formatNumber(_0x3d33b8[_0x366bf8][_0x3182b2(0x1e3)](0x2)):'';_0x406116+=_0x3182b2(0x1d7)+_0x10fe0e+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x1d7)+_0x213a41+'</b></td>',_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x579c02+_0x3182b2(0x257);}_0x406116+=_0x3182b2(0x1d7)+formatNumber(_0x40715f)+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x1d7)+formatNumber(_0x3e9431)+'</b></td>',_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x1ab),_0x406116+='<tr>',_0x406116+=_0x3182b2(0x22a),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>',_0x406116+=_0x3182b2(0x239);let _0x134311=0x0,_0x297bd5=0x0,_0x347af8=0x0;for(let _0x303342=0x0;_0x303342<=_0x35a510[_0x3182b2(0x205)][_0x3182b2(0x192)]-0x1;_0x303342++){const _0x413208=_0x35a510[_0x3182b2(0x205)][_0x303342],_0x4c6bb3=_0x413208[_0x3182b2(0x1ec)]['brand']+'-'+_0x413208[_0x3182b2(0x1ec)][_0x3182b2(0xec)];var _0x4b36d9=_0x5e51a9[_0x4c6bb3]!==undefined?_0x5e51a9[_0x4c6bb3][_0x3182b2(0x1e3)](0x2):'0',_0x5b3730=_0x22c29f[_0x4c6bb3]!==undefined?_0x22c29f[_0x4c6bb3][_0x3182b2(0x1e3)](0x2):'0',_0x5f2072=_0x44f5eb[_0x4c6bb3]!==undefined?_0x44f5eb[_0x4c6bb3][_0x3182b2(0x1e3)](0x2):'0',_0x3774e4=_0x2629d0[_0x4c6bb3]!==undefined?_0x2629d0[_0x4c6bb3][_0x3182b2(0x1e3)](0x2):'0',_0x132142=_0x138f8b[_0x4c6bb3]!==undefined?_0x138f8b[_0x4c6bb3][_0x3182b2(0x1e3)](0x2):'0',_0x1b2f1c=_0x3d33b8[_0x4c6bb3]!==undefined?_0x3d33b8[_0x4c6bb3][_0x3182b2(0x1e3)](0x2):'0';_0x134311=parseFloat(_0x4b36d9)+parseFloat(_0x3774e4),_0x297bd5=parseFloat(_0x5f2072)+parseFloat(_0x1b2f1c),_0x347af8=parseFloat(_0x5b3730)+parseFloat(_0x132142),_0x406116+=_0x3182b2(0x1d7)+formatNumber(_0x134311[_0x3182b2(0x1e3)](0x2))+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x1d7)+formatNumber(_0x297bd5[_0x3182b2(0x1e3)](0x2))+'</b></td>',_0x406116+=_0x3182b2(0x1d7)+formatNumber(_0x347af8[_0x3182b2(0x1e3)](0x2))+_0x3182b2(0x257);}var _0x2a93bc=formatNumber(_0x53d6b0+_0x40715f),_0x1baa75=formatNumber(_0x1a7310+_0x3e9431);_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x2a93bc+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x1d7)+_0x1baa75+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x239),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x1ab),_0x406116+=_0x3182b2(0xf4),_0x406116+=_0x3182b2(0x134)+(_0x35a510[_0x3182b2(0x205)][_0x3182b2(0x192)]*0x3+0x9)+_0x3182b2(0x1b7),_0x406116+='</tr>',_0x406116+=_0x3182b2(0xf4),_0x406116+=_0x3182b2(0x22a),_0x406116+=_0x3182b2(0x1cb),_0x406116+=_0x3182b2(0x239);for(let _0x3894cf=0x0;_0x3894cf<=_0x35a510[_0x3182b2(0x205)][_0x3182b2(0x192)]-0x1;_0x3894cf++){const _0x130ea7=_0x35a510[_0x3182b2(0x205)][_0x3894cf],_0x20d8d9=_0x130ea7[_0x3182b2(0x1ec)][_0x3182b2(0x22e)]+'-'+_0x130ea7[_0x3182b2(0x1ec)][_0x3182b2(0xec)];var _0x4b36d9=_0x5e51a9[_0x20d8d9]!==undefined?_0x5e51a9[_0x20d8d9][_0x3182b2(0x1e3)](0x2):'0',_0x5b3730=_0x22c29f[_0x20d8d9]!==undefined?_0x22c29f[_0x20d8d9][_0x3182b2(0x1e3)](0x2):'0',_0x5f2072=_0x44f5eb[_0x20d8d9]!==undefined?_0x44f5eb[_0x20d8d9][_0x3182b2(0x1e3)](0x2):'0',_0x3774e4=_0x2629d0[_0x20d8d9]!==undefined?_0x2629d0[_0x20d8d9][_0x3182b2(0x1e3)](0x2):'0',_0x132142=_0x138f8b[_0x20d8d9]!==undefined?_0x138f8b[_0x20d8d9][_0x3182b2(0x1e3)](0x2):'0',_0x1b2f1c=_0x3d33b8[_0x20d8d9]!==undefined?_0x3d33b8[_0x20d8d9]['toFixed'](0x2):'0';_0x134311=parseFloat(_0x4b36d9)+parseFloat(_0x3774e4),_0x297bd5=parseFloat(_0x5f2072)+parseFloat(_0x1b2f1c),_0x347af8=parseFloat(_0x5b3730)+parseFloat(_0x132142),_0x406116+=_0x3182b2(0x20d),_0x406116+=_0x3182b2(0x20d),_0x406116+=_0x3182b2(0x20d);}_0x406116+=_0x3182b2(0x239),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x406116+=_0x3182b2(0x1ab),_0x406116+=_0x3182b2(0xf4),_0x406116+=_0x3182b2(0x22a),_0x406116+=_0x3182b2(0x1ff),_0x406116+=_0x3182b2(0x239);for(let _0x5600fa=0x0;_0x5600fa<=_0x35a510[_0x3182b2(0x205)][_0x3182b2(0x192)]-0x1;_0x5600fa++){const _0x2b89fe=_0x35a510['cat_brand'][_0x5600fa],_0x3e0509=_0x2b89fe[_0x3182b2(0x1ec)][_0x3182b2(0x22e)]+'-'+_0x2b89fe[_0x3182b2(0x1ec)][_0x3182b2(0xec)];var _0x4b36d9=_0x5e51a9[_0x3e0509]!==undefined?_0x5e51a9[_0x3e0509]['toFixed'](0x2):'0',_0x5b3730=_0x22c29f[_0x3e0509]!==undefined?_0x22c29f[_0x3e0509]['toFixed'](0x2):'0',_0x5f2072=_0x44f5eb[_0x3e0509]!==undefined?_0x44f5eb[_0x3e0509]['toFixed'](0x2):'0',_0x3774e4=_0x2629d0[_0x3e0509]!==undefined?_0x2629d0[_0x3e0509][_0x3182b2(0x1e3)](0x2):'0',_0x132142=_0x138f8b[_0x3e0509]!==undefined?_0x138f8b[_0x3e0509]['toFixed'](0x2):'0',_0x1b2f1c=_0x3d33b8[_0x3e0509]!==undefined?_0x3d33b8[_0x3e0509]['toFixed'](0x2):'0';_0x134311=parseFloat(_0x4b36d9)+parseFloat(_0x3774e4),_0x297bd5=parseFloat(_0x5f2072)+parseFloat(_0x1b2f1c),_0x347af8=parseFloat(_0x5b3730)+parseFloat(_0x132142),_0x406116+=_0x3182b2(0x20d),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>';}_0x406116+=_0x3182b2(0x239),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x406116+=_0x3182b2(0x239),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x1ab),_0x406116+='<tr>',_0x406116+=_0x3182b2(0x22a),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>',_0x406116+=_0x3182b2(0x239);for(let _0x4d1011=0x0;_0x4d1011<=_0x35a510['cat_brand'][_0x3182b2(0x192)]-0x1;_0x4d1011++){const _0x3fbe95=_0x35a510['cat_brand'][_0x4d1011],_0x482641=_0x3fbe95[_0x3182b2(0x1ec)][_0x3182b2(0x22e)]+'-'+_0x3fbe95[_0x3182b2(0x1ec)]['category'];var _0x4b36d9=_0x5e51a9[_0x482641]!==undefined?_0x5e51a9[_0x482641]['toFixed'](0x2):'0',_0x5b3730=_0x22c29f[_0x482641]!==undefined?_0x22c29f[_0x482641][_0x3182b2(0x1e3)](0x2):'0',_0x5f2072=_0x44f5eb[_0x482641]!==undefined?_0x44f5eb[_0x482641][_0x3182b2(0x1e3)](0x2):'0',_0x3774e4=_0x2629d0[_0x482641]!==undefined?_0x2629d0[_0x482641][_0x3182b2(0x1e3)](0x2):'0',_0x132142=_0x138f8b[_0x482641]!==undefined?_0x138f8b[_0x482641][_0x3182b2(0x1e3)](0x2):'0',_0x1b2f1c=_0x3d33b8[_0x482641]!==undefined?_0x3d33b8[_0x482641][_0x3182b2(0x1e3)](0x2):'0';_0x134311=parseFloat(_0x4b36d9)+parseFloat(_0x3774e4),_0x297bd5=parseFloat(_0x5f2072)+parseFloat(_0x1b2f1c),_0x347af8=parseFloat(_0x5b3730)+parseFloat(_0x132142),_0x406116+=_0x3182b2(0x20d),_0x406116+=_0x3182b2(0x20d),_0x406116+=_0x3182b2(0x20d);}_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x1ab),_0x406116+=_0x3182b2(0xf4),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x406116+=_0x3182b2(0x211),_0x406116+=_0x3182b2(0x239);for(let _0x4a442e=0x0;_0x4a442e<=_0x35a510[_0x3182b2(0x205)]['length']-0x1;_0x4a442e++){const _0x3ac04a=_0x35a510[_0x3182b2(0x205)][_0x4a442e],_0xd57b81=_0x3ac04a[_0x3182b2(0x1ec)][_0x3182b2(0x22e)]+'-'+_0x3ac04a[_0x3182b2(0x1ec)][_0x3182b2(0xec)];var _0x4b36d9=_0x5e51a9[_0xd57b81]!==undefined?_0x5e51a9[_0xd57b81][_0x3182b2(0x1e3)](0x2):'',_0x5b3730=_0x22c29f[_0xd57b81]!==undefined?_0x22c29f[_0xd57b81][_0x3182b2(0x1e3)](0x2):'',_0x5f2072=_0x44f5eb[_0xd57b81]!==undefined?_0x44f5eb[_0xd57b81][_0x3182b2(0x1e3)](0x2):'',_0x3774e4=_0x2629d0[_0xd57b81]!==undefined?_0x2629d0[_0xd57b81][_0x3182b2(0x1e3)](0x2):'',_0x132142=_0x138f8b[_0xd57b81]!==undefined?_0x138f8b[_0xd57b81]['toFixed'](0x2):'',_0x1b2f1c=_0x3d33b8[_0xd57b81]!==undefined?_0x3d33b8[_0xd57b81][_0x3182b2(0x1e3)](0x2):'';_0x134311=formatNumber(parseFloat(_0x4b36d9)+parseFloat(_0x3774e4)),_0x297bd5=formatNumber(parseFloat(_0x5f2072)+parseFloat(_0x1b2f1c)),_0x347af8=formatNumber(parseFloat(_0x5b3730)+parseFloat(_0x132142)),_0x406116+=_0x3182b2(0x1d7)+_0x4b36d9+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x1d7)+_0x5f2072+_0x3182b2(0x257),_0x406116+=_0x3182b2(0x1d7)+_0x5b3730+_0x3182b2(0x257);}_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x1ab),_0x406116+=_0x3182b2(0xf4),_0x406116+=_0x3182b2(0x22a),_0x406116+=_0x3182b2(0x153),_0x406116+=_0x3182b2(0x239);for(let _0x2127ad=0x0;_0x2127ad<=_0x35a510['cat_brand'][_0x3182b2(0x192)]-0x1;_0x2127ad++){const _0x1635c8=_0x35a510[_0x3182b2(0x205)][_0x2127ad],_0x2693ef=_0x1635c8[_0x3182b2(0x1ec)][_0x3182b2(0x22e)]+'-'+_0x1635c8[_0x3182b2(0x1ec)][_0x3182b2(0xec)];var _0x4b36d9=_0x5e51a9[_0x2693ef]!==undefined?_0x5e51a9[_0x2693ef][_0x3182b2(0x1e3)](0x2):'0',_0x5b3730=_0x22c29f[_0x2693ef]!==undefined?_0x22c29f[_0x2693ef][_0x3182b2(0x1e3)](0x2):'0',_0x5f2072=_0x44f5eb[_0x2693ef]!==undefined?_0x44f5eb[_0x2693ef][_0x3182b2(0x1e3)](0x2):'0',_0x3774e4=_0x2629d0[_0x2693ef]!==undefined?_0x2629d0[_0x2693ef]['toFixed'](0x2):'0',_0x132142=_0x138f8b[_0x2693ef]!==undefined?_0x138f8b[_0x2693ef][_0x3182b2(0x1e3)](0x2):'0',_0x1b2f1c=_0x3d33b8[_0x2693ef]!==undefined?_0x3d33b8[_0x2693ef][_0x3182b2(0x1e3)](0x2):'0';_0x134311=parseFloat(_0x4b36d9)+parseFloat(_0x3774e4),_0x297bd5=parseFloat(_0x5f2072)+parseFloat(_0x1b2f1c),_0x347af8=parseFloat(_0x5b3730)+parseFloat(_0x132142),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x406116+=_0x3182b2(0x20d),_0x406116+=_0x3182b2(0x20d);}_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x406116+=_0x3182b2(0x239),_0x406116+=_0x3182b2(0x239),_0x406116+='</tr>',_0x406116+='</tbody>',_0x406116+=_0x3182b2(0x128);}),_0x406116;}async function generateReferenceNumber(_0xf5f772,_0x4b29c0,_0x1d35eb){const _0x271a44=a0_0x54c9e9,_0x946454=new Date(_0xf5f772)[_0x271a44(0x1bd)](),_0x5136f4=('0'+(new Date(_0xf5f772)[_0x271a44(0x105)]()+0x1))['slice'](-0x2),_0x3c96da=('0'+new Date(_0xf5f772)[_0x271a44(0x17a)]())[_0x271a44(0x100)](-0x2),_0x4c852c=await staff[_0x271a44(0x13d)]({'email':_0x1d35eb['email']}),_0x558e6b=_0x4c852c[_0x271a44(0x17b)],_0x425005=_0x558e6b+'-'+_0x946454+_0x5136f4+_0x3c96da,_0x51f188=await Reference['findOne']({'referenceNumber':new RegExp('^'+_0x425005),'salesman_code':_0x558e6b})[_0x271a44(0x1fd)]({'createdAt':-0x1}),_0x5405d2=_0x425005;_0x51f188&&(_0x5405d2=_0x51f188[_0x271a44(0x11a)]);console[_0x271a44(0x187)](_0x5405d2);const _0x125183=new Reference({'referenceNumber':_0x5405d2,'staff_id':_0x4b29c0,'salesman_code':_0x558e6b});return await _0x125183[_0x271a44(0x163)](),_0x5405d2;}function a0_0x1905(){const _0x28b188=['/dl_excel','English\x20(US)','get','Arabic','<th>Booking</th>','getFullYear','/agent_reports/view','<th>\x20ENDING\x20BALANCE\x20</th>','<th>\x20ITEM\x20DESCRIPTION\x20</th>','French','isArray','../middleware/auth','setHeader','/reports/dsrr/view','$sale_product.isFG','product_details','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','<th>\x20INCOMING\x20</th>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>','$sales_staff_id','$product_docs','$sale_product.totalprice','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','$status_data','toStream','trim','$sales_info','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','$products.product_details.category','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$sale_product.stock','window.print();','$products.discount','!cols','load','DateTimeFormat','landscape','aoa_to_sheet','dsi','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','toFixed','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','html-pdf','discount','sales_reports','includes','render','success','cash','_id','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','$totalGross','product_info','\x20-\x20STD','dssr_view_admin','Spanish','long','jsbarcode','products','top','dssr_view','$product_name','totalGross','inventory_sum','$_id.category','toISOString','sort','agent_sales','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>','Household','$customer','toLocaleDateString','/total_sales_reports/view','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','cat_brand','toLocaleString','English','<p>INVENTORY\x20SUMMARY</p>','date','Products\x20find_data','$products.product_details','adj_discount','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','$product_details.product_stock','</script>','bottom','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','Portuguese\x20(BR)','sales_bkg','\x22\x20class=\x22cat_data\x22>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','border-top','</p>','customer','pipe','deleteOne','then','</td>','<div\x20style=\x22page-break-before:\x20always;\x22></div>','prod_cat','email','<td\x20colspan=\x223\x22><b>TOTAL<b>','due_date','td,\x20th','colspan','find','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','post','<thead>','Products\x20master','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','$bank','sales_ext','brand','$cash','$products','$product.quantity','Sales\x20Report','$dsi','$product_code','numeric','NumberFormat','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','/balance/view','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','flash','$due_date','Portuguese','each','/dsrr/view','\x20-\x20HH','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','$product_stock','image','exports','$sale_product','$product_list.product_name','1975510wgVnSq','express/lib/response','totalQTYsum','path','<td\x20class=\x22row_data\x22>','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','table\x20tr','book_new','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','NetPrice','<td\x20class=\x22row_data\x22>0</td>','/getDSSR_no','Chinese','Content-Type','</b></td>','sales_staff_id','application/pdf','create','border-left','$products.qty','brandCount','<td\x20class=\x22row_data\x22><b>','$_id.dsi','Products\x20warehouse_data','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','Error\x20generating\x20PDF','<table>','filter','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','findById','8.5in','express','Types','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','true','!merges','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','qty','beg_bal','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','status','$sale_product.prod_cat','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','name','Arabic\x20(ae)','$totalQty','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','balanced','user','json','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>','totalQty','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','</tbody>','category','Standard','4oZjSZG','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','/dsrr_admin/view','attachment;\x20filename=\x22reports.xlsx\x22','errors','params','<tr>','<p>FINISHED\x20GOODS\x20INVENTORY</p>','</thead>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','$product_details.product_name','border-right','attr','pdfkit-table','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','redirect','thick','buffer','slice','/balance/pdf','Letter','$product_details','$name','getMonth','sumqty','forEach','German','$check_no','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>','isFG','<th>\x20INVOICE\x20AMOUNT\x20</th>','replace','84PsGCxj','exceljs','333740pnIvYm','$product_info.category','<p>','rowspan','salesman_data','$products.NetPrice','$products.product_details.prod_id','html','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','../public/language/languages.json','referenceNumber','blob-stream','$_id.status_data','20mm','product_code','$product_list.product_stock','cheerio','$sale_product.adj_discount','book_append_sheet','date_include','$product_info.gross_price','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','/agent_reports/pdf_admin','$discount','</table>','<th>\x20SALES\x20</th>','3589840obNvOL','thin','split','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','$date','test','right','$sale_product.product_code','error','body','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22','sales_info','product_stock','7254jqLRuW','xlsx','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','Asia/Manila','$products.product_details.gross_price','0.1in','findOne','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','<th\x20colspan=\x272\x27>SOLD</th>','text','sale_product.product_code','language','$sale_product.product_name','<th\x20rowspan=\x272\x27>Products</th>','reduce','<th>\x20BEG\x20BALANCE\x20</th>','</div>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','<th>X-Truck</th>','note','product_details.product_name','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','<div\x20class=\x22col-sm-11\x22>','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','totalPrice','write','ObjectId','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>','60mm','<div\x20\x20id=\x22table-conatainer\x22>','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','/total_sales_reports/pdf','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','/dsrr_admin/pdf_admin','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','catch','\x22><b>','$_id.date','<p>SALES\x20REPORTS</p>','staffs','multer','en-US','send','save','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','$_id.brand','$products.product_details.brand','$product_info','<td\x20class=\x22row_data\x22></td>','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','$product.product_code','Content-Disposition','setDate','$sale_product._id','format','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','$NetPrice','false','$product','<td\x20class=\x22cat_data\x22>','4452ectoLT','dataqty','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','\x20-\x20','$products.adj_discount','bank','getDate','sales_man_code','$product_info.name','/dsrr_admin/view_data/:id','Hindi','$adj_discount','dsi_sales','$product.product_name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','utils','$sale_product.quantity','totalQTY','stock','log','/inventory_sum/pdf','<td\x20class=\x22cat_data\x22><b>FG</b></td>','/agent/view','$amount','product_docs','medium','$sale_product.real_qty_unit_val','attachment;\x20filename=\x22sales_report.xlsx\x22','push','<h1>JAKA\x20EQUITIES\x20CORP</h1>','length','$product_list.product_code','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','</th>','$product_info.brand','313875jbEOiW','3535BZOMWT','/agent_reports/sales_ad','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>','window.onload\x20=\x20function()\x20{','$category','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','amount','<tbody>','$product_info.product_code','33REkzmh','left','border-bottom','Router','$_id.customer','map','<td\x20colspan=\x22','15in','000000','<th\x20rowspan=\x272\x27>Category</th>','</tr>','product_name','<div\x20class=\x22row\x22>','1304397zaIIwQ','valueOf','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','<th>\x20QTY\x20SOLD\x20</th>','$brand','$sale_product.discount','excel','aggregate','style','\x22><b></b></td>'];a0_0x1905=function(){return _0x28b188;};return a0_0x1905();}router[a0_0x54c9e9(0x227)]('/dsrr/pdf',auth,async(_0x187c4b,_0x147c3d)=>{const _0x37151a=a0_0x54c9e9,{from_date:_0x49b7b4,dataview:_0x476afc}=_0x187c4b[_0x37151a(0x133)],_0x1c59d8=_0x187c4b[_0x37151a(0xe6)],_0x44d024=await staff[_0x37151a(0x13d)]({'email':_0x1c59d8['email']}),_0xf719e0=await master_shop[_0x37151a(0x225)](),_0x3cb613='';var _0xa19610=new Date(_0x49b7b4);const _0x377e53={'year':_0x37151a(0x235),'month':'long','day':'numeric'},_0x3bc5d4=new Intl[(_0x37151a(0x1dd))]('en-US',_0x377e53)['format'](_0xa19610),_0x5b509e=await Reference[_0x37151a(0x225)]({'staff_id':_0x44d024['_id'][_0x37151a(0x1af)](),'date_include':_0x49b7b4});if(_0x5b509e[_0x37151a(0x192)]>0x0){let _0x51ef6c='';_0x51ef6c+=_0x5b509e[0x0][_0x37151a(0x117)];const _0x1407dc=cheerio[_0x37151a(0x1dc)](_0x51ef6c);let _0x1691b0=[],_0x1958d4=[],_0x2d2a13=[];const _0x1e0114=_0x295ee8=>{const _0x332199=_0x37151a,_0x4240f1={'top':{'style':_0x332199(0xfe),'color':{'rgb':'000000'}},'bottom':{'style':_0x332199(0xfe),'color':{'rgb':_0x332199(0x1a9)}},'left':{'style':_0x332199(0xfe),'color':{'rgb':_0x332199(0x1a9)}},'right':{'style':_0x332199(0xfe),'color':{'rgb':'000000'}}};if(_0x295ee8){const _0x55330b=_0x295ee8[_0x332199(0x12c)](';')['reduce']((_0x3dff21,_0x11f7ff)=>{const _0x4e101b=_0x332199,[_0xf9d84,_0xa5a63e]=_0x11f7ff[_0x4e101b(0x12c)](':')[_0x4e101b(0x1a6)](_0x3d3ab8=>_0x3d3ab8[_0x4e101b(0x1d3)]());return _0x3dff21[_0xf9d84]=_0xa5a63e,_0x3dff21;},{});_0x55330b[_0x332199(0x217)]&&(_0x4240f1['top'][_0x332199(0x1b6)]=_0x55330b[_0x332199(0x217)]['includes'](_0x332199(0x12b))?_0x332199(0x12b):'medium'),_0x55330b[_0x332199(0x1a3)]&&(_0x4240f1[_0x332199(0x210)]['style']=_0x55330b[_0x332199(0x1a3)]['includes']('thin')?'thin':_0x332199(0x18d)),_0x55330b[_0x332199(0x25b)]&&(_0x4240f1['left'][_0x332199(0x1b6)]=_0x55330b[_0x332199(0x25b)][_0x332199(0x1e8)](_0x332199(0x12b))?_0x332199(0x12b):_0x332199(0x18d)),_0x55330b['border-right']&&(_0x4240f1[_0x332199(0x130)]['style']=_0x55330b[_0x332199(0xf9)][_0x332199(0x1e8)](_0x332199(0x12b))?_0x332199(0x12b):'medium');}return _0x4240f1;};_0x1407dc(_0x37151a(0x24f))[_0x37151a(0x23e)]((_0x4d8ac4,_0xd8a2b7)=>{const _0x43cbac=_0x37151a;let _0x4bf7d2=[],_0x4cd661=0x0;while(_0x2d2a13[_0x4cd661]){_0x2d2a13[_0x4cd661]--,_0x4cd661++;}_0x1407dc(_0xd8a2b7)[_0x43cbac(0x225)](_0x43cbac(0x223))[_0x43cbac(0x23e)]((_0x434357,_0x347ca1)=>{const _0x520e22=_0x43cbac;let _0x3bdf10=_0x1407dc(_0x347ca1)[_0x520e22(0x140)]()['trim'](),_0x4b4569=parseFloat(_0x3bdf10['replace'](/,/g,''));isNaN(_0x4b4569)&&(_0x4b4569=_0x3bdf10);let _0x17aa5c=parseInt(_0x1407dc(_0x347ca1)['attr'](_0x520e22(0x224)))||0x1,_0x3e32fc=parseInt(_0x1407dc(_0x347ca1)['attr'](_0x520e22(0x113)))||0x1;const _0x46c144=_0x1407dc(_0x347ca1)['attr'](_0x520e22(0x1b6)),_0x4fe016=_0x1e0114(_0x46c144);_0x4bf7d2[_0x4cd661]={'v':_0x4b4569,'s':{'border':_0x4fe016}};(_0x17aa5c>0x1||_0x3e32fc>0x1)&&_0x1958d4['push']({'s':{'r':_0x4d8ac4,'c':_0x4cd661},'e':{'r':_0x4d8ac4+_0x3e32fc-0x1,'c':_0x4cd661+_0x17aa5c-0x1}});for(let _0x51bb80=0x0;_0x51bb80<_0x17aa5c;_0x51bb80++){_0x3e32fc>0x1&&(_0x2d2a13[_0x4cd661+_0x51bb80]=_0x3e32fc-0x1);}_0x4cd661+=_0x17aa5c;}),_0x1691b0[_0x43cbac(0x190)](_0x4bf7d2);});const _0x3f4525=XLSX[_0x37151a(0x183)][_0x37151a(0x250)](),_0x3297f2=XLSX[_0x37151a(0x183)][_0x37151a(0x1df)](_0x1691b0);_0x1958d4[_0x37151a(0x192)]>0x0&&(_0x3297f2[_0x37151a(0x26c)]=_0x1958d4);_0x3297f2[_0x37151a(0x1db)]=_0x1691b0[0x0][_0x37151a(0x1a6)](()=>({'wpx':0x64})),XLSX[_0x37151a(0x183)][_0x37151a(0x122)](_0x3f4525,_0x3297f2,'Sales\x20Report');const _0x3ae3cb=XLSX[_0x37151a(0x151)](_0x3f4525,{'bookType':_0x37151a(0x138),'type':_0x37151a(0xff)});_0x147c3d['setHeader']('Content-Disposition',_0x37151a(0x18f)),_0x147c3d[_0x37151a(0x1c4)](_0x37151a(0x256),_0x37151a(0x241)),_0x147c3d[_0x37151a(0x162)](_0x3ae3cb);}else generateReferenceNumber(_0x49b7b4,_0x44d024[_0x37151a(0x1ec)][_0x37151a(0x1af)](),_0x1c59d8)[_0x37151a(0x21c)](async _0x33e135=>{const _0x1afd39=_0x37151a,_0x4257f3=await agentsdataDSICheck_DSRR(_0x49b7b4,_0x44d024[_0x1afd39(0x1ec)][_0x1afd39(0x1af)](),_0x3cb613,_0x33e135);let _0x19615d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x19615d+=_0x1afd39(0x1ad),_0x19615d+=_0x1afd39(0x155),_0x19615d+=_0x1afd39(0x263),_0x19615d+=_0x4257f3,_0x19615d+='</table>',_0x19615d+=_0x1afd39(0x147),_0x19615d+=_0x1afd39(0x147);if(_0x4257f3[_0x1afd39(0x192)]>0x0){const _0x4924ef=await Reference[_0x1afd39(0x13d)]({'staff_id':_0x44d024[_0x1afd39(0x1ec)][_0x1afd39(0x1af)](),'referenceNumber':_0x33e135});_0x4924ef['html']=_0x19615d,_0x4924ef[_0x1afd39(0x123)]=_0x49b7b4,await _0x4924ef['save']();if(_0x476afc==_0x1afd39(0x1b4)){const _0x50fb0d=cheerio['load'](_0x19615d);let _0x3a45f4=[],_0x37c3dd=[],_0x10844b=[];const _0x4296b=_0x2af896=>{const _0x3ee527=_0x1afd39,_0x48aaa0={'top':{'style':_0x3ee527(0xfe),'color':{'rgb':_0x3ee527(0x1a9)}},'bottom':{'style':_0x3ee527(0xfe),'color':{'rgb':_0x3ee527(0x1a9)}},'left':{'style':_0x3ee527(0xfe),'color':{'rgb':_0x3ee527(0x1a9)}},'right':{'style':_0x3ee527(0xfe),'color':{'rgb':_0x3ee527(0x1a9)}}};if(_0x2af896){const _0x476c0e=_0x2af896[_0x3ee527(0x12c)](';')[_0x3ee527(0x145)]((_0x4dc0bb,_0x67bc41)=>{const _0x207d06=_0x3ee527,[_0x267d60,_0x5e4e61]=_0x67bc41[_0x207d06(0x12c)](':')[_0x207d06(0x1a6)](_0x4be842=>_0x4be842['trim']());return _0x4dc0bb[_0x267d60]=_0x5e4e61,_0x4dc0bb;},{});_0x476c0e[_0x3ee527(0x217)]&&(_0x48aaa0[_0x3ee527(0x1f6)][_0x3ee527(0x1b6)]=_0x476c0e['border-top'][_0x3ee527(0x1e8)](_0x3ee527(0x12b))?_0x3ee527(0x12b):'medium'),_0x476c0e[_0x3ee527(0x1a3)]&&(_0x48aaa0[_0x3ee527(0x210)][_0x3ee527(0x1b6)]=_0x476c0e[_0x3ee527(0x1a3)][_0x3ee527(0x1e8)](_0x3ee527(0x12b))?'thin':_0x3ee527(0x18d)),_0x476c0e[_0x3ee527(0x25b)]&&(_0x48aaa0[_0x3ee527(0x1a2)][_0x3ee527(0x1b6)]=_0x476c0e[_0x3ee527(0x25b)][_0x3ee527(0x1e8)](_0x3ee527(0x12b))?'thin':'medium'),_0x476c0e[_0x3ee527(0xf9)]&&(_0x48aaa0[_0x3ee527(0x130)][_0x3ee527(0x1b6)]=_0x476c0e['border-right']['includes']('thin')?'thin':'medium');}return _0x48aaa0;};_0x50fb0d(_0x1afd39(0x24f))['each']((_0x121d91,_0x2a153a)=>{const _0x11fde7=_0x1afd39;let _0x2f9787=[],_0xcd74bc=0x0;while(_0x10844b[_0xcd74bc]){_0x10844b[_0xcd74bc]--,_0xcd74bc++;}_0x50fb0d(_0x2a153a)[_0x11fde7(0x225)]('td,\x20th')[_0x11fde7(0x23e)]((_0x5e6fc1,_0x22c6e4)=>{const _0x4907df=_0x11fde7;let _0x2cbac5=_0x50fb0d(_0x22c6e4)[_0x4907df(0x140)]()['trim'](),_0x3debf2=parseFloat(_0x2cbac5[_0x4907df(0x10d)](/,/g,''));isNaN(_0x3debf2)&&(_0x3debf2=_0x2cbac5);let _0x40c47a=parseInt(_0x50fb0d(_0x22c6e4)[_0x4907df(0xfa)](_0x4907df(0x224)))||0x1,_0xed67f7=parseInt(_0x50fb0d(_0x22c6e4)['attr'](_0x4907df(0x113)))||0x1;const _0x38ae01=_0x50fb0d(_0x22c6e4)[_0x4907df(0xfa)]('style'),_0x2c0f57=_0x4296b(_0x38ae01);_0x2f9787[_0xcd74bc]={'v':_0x3debf2,'s':{'border':_0x2c0f57}};(_0x40c47a>0x1||_0xed67f7>0x1)&&_0x37c3dd[_0x4907df(0x190)]({'s':{'r':_0x121d91,'c':_0xcd74bc},'e':{'r':_0x121d91+_0xed67f7-0x1,'c':_0xcd74bc+_0x40c47a-0x1}});for(let _0x25bfdf=0x0;_0x25bfdf<_0x40c47a;_0x25bfdf++){_0xed67f7>0x1&&(_0x10844b[_0xcd74bc+_0x25bfdf]=_0xed67f7-0x1);}_0xcd74bc+=_0x40c47a;}),_0x3a45f4[_0x11fde7(0x190)](_0x2f9787);});const _0xd8f418=XLSX[_0x1afd39(0x183)][_0x1afd39(0x250)](),_0x4fb383=XLSX[_0x1afd39(0x183)][_0x1afd39(0x1df)](_0x3a45f4);_0x37c3dd[_0x1afd39(0x192)]>0x0&&(_0x4fb383[_0x1afd39(0x26c)]=_0x37c3dd);_0x4fb383[_0x1afd39(0x1db)]=_0x3a45f4[0x0][_0x1afd39(0x1a6)](()=>({'wpx':0x64})),XLSX['utils'][_0x1afd39(0x122)](_0xd8f418,_0x4fb383,_0x1afd39(0x232));const _0x34d67a=XLSX['write'](_0xd8f418,{'bookType':'xlsx','type':_0x1afd39(0xff)});_0x147c3d[_0x1afd39(0x1c4)](_0x1afd39(0x16b),_0x1afd39(0x18f)),_0x147c3d[_0x1afd39(0x1c4)](_0x1afd39(0x256),_0x1afd39(0x241)),_0x147c3d[_0x1afd39(0x162)](_0x34d67a);}else _0x19615d+='<script>',_0x19615d+=_0x1afd39(0x19b),_0x19615d+=_0x1afd39(0x1d9),_0x19615d+='};',_0x19615d+=_0x1afd39(0x20f),_0x147c3d[_0x1afd39(0x162)](_0x19615d);}else await Reference[_0x1afd39(0x21b)]({'referenceNumber':_0x33e135}),_0x187c4b[_0x1afd39(0x23b)](_0x1afd39(0xf2),'No\x20data\x20was\x20Found!'),_0x147c3d[_0x1afd39(0xfd)](_0x1afd39(0x1c5));})[_0x37151a(0x15b)](console[_0x37151a(0x132)]);}),router[a0_0x54c9e9(0x1ba)](a0_0x54c9e9(0xf0),auth,async(_0x13ea01,_0x287081)=>{const _0x54369d=a0_0x54c9e9;try{const {username:_0x8866bb,email:_0x565f14,role:_0x1de478}=_0x13ea01[_0x54369d(0xe6)],_0x37ecba=_0x13ea01['user'],_0x2be72f=await profile[_0x54369d(0x13d)]({'email':_0x37ecba[_0x54369d(0x220)]}),_0x5f35c2={'year':_0x54369d(0x235),'month':_0x54369d(0x1f3),'day':_0x54369d(0x235)},_0x2c1080=await master_shop[_0x54369d(0x225)]();console['log'](_0x54369d(0x229),_0x2c1080);const _0x42847a=await product[_0x54369d(0x225)]();console[_0x54369d(0x187)](_0x54369d(0x20a),_0x42847a);const _0x40fcb6=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$lookup':{'from':_0x54369d(0x1f5),'localField':'product_details.product_name','foreignField':_0x54369d(0x274),'as':'product_docs'}},{'$unwind':_0x54369d(0x1cd)},{'$project':{'product_name':_0x54369d(0xf8),'product_stock':_0x54369d(0x20e)}},{'$group':{'_id':_0x54369d(0x1f8),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x54369d(0x187)](_0x54369d(0x260),_0x40fcb6),_0x40fcb6[_0x54369d(0x107)](_0x1df9fd=>{const _0x716671=_0x42847a['map'](_0x4c0730=>{const _0x313849=a0_0x4a18;_0x4c0730[_0x313849(0x274)]==_0x1df9fd[_0x313849(0x1ec)]&&(_0x4c0730[_0x313849(0x186)]=parseInt(_0x4c0730[_0x313849(0x186)])+parseInt(_0x1df9fd[_0x313849(0x136)]));});});const _0x3a450a=await staff[_0x54369d(0x225)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x4d1fc2=await staff[_0x54369d(0x13d)]({'email':_0x37ecba[_0x54369d(0x220)]});if(_0x2c1080[0x0][_0x54369d(0x142)]==_0x54369d(0x1b9))var _0x399164=users[_0x54369d(0x207)];else{if(_0x2c1080[0x0][_0x54369d(0x142)]==_0x54369d(0x17e))var _0x399164=users[_0x54369d(0x17e)];else{if(_0x2c1080[0x0][_0x54369d(0x142)]==_0x54369d(0x108))var _0x399164=users[_0x54369d(0x108)];else{if(_0x2c1080[0x0][_0x54369d(0x142)]==_0x54369d(0x1f2))var _0x399164=users['Spanish'];else{if(_0x2c1080[0x0][_0x54369d(0x142)]==_0x54369d(0x1c1))var _0x399164=users[_0x54369d(0x1c1)];else{if(_0x2c1080[0x0][_0x54369d(0x142)]==_0x54369d(0x213))var _0x399164=users[_0x54369d(0x23d)];else{if(_0x2c1080[0x0][_0x54369d(0x142)]==_0x54369d(0x255))var _0x399164=users[_0x54369d(0x255)];else{if(_0x2c1080[0x0][_0x54369d(0x142)]==_0x54369d(0x275))var _0x399164=users[_0x54369d(0x1bb)];}}}}}}}_0x287081[_0x54369d(0x1e9)](_0x54369d(0x1f1),{'success':_0x13ea01[_0x54369d(0x23b)]('success'),'errors':_0x13ea01[_0x54369d(0x23b)](_0x54369d(0xf2)),'alldata':_0x42847a,'profile':_0x2be72f,'master_shop':_0x2c1080,'role':_0x37ecba,'product_stock':_0x40fcb6,'language':_0x399164,'staff_arr':_0x4d1fc2,'staff_data_all':_0x3a450a});}catch(_0x308376){}}),router[a0_0x54c9e9(0x227)](a0_0x54c9e9(0x254),auth,async(_0x1c9f33,_0x3ea21d)=>{const _0x504e97=a0_0x54c9e9;try{const {from:_0x54eeae,to:_0x28b49b,staff_data:_0x189262}=_0x1c9f33[_0x504e97(0x133)],_0xf25c94=await Reference[_0x504e97(0x1b5)]([{'$match':{'date_include':{'$gte':_0x54eeae,'$lte':_0x28b49b},'staff_id':_0x189262}},{'$sort':{'date_include':0x1}}]);_0x3ea21d['json'](_0xf25c94);}catch(_0x499db9){_0x3ea21d['json'](_0x499db9);}}),router[a0_0x54c9e9(0x1ba)](a0_0x54c9e9(0x17d),auth,async(_0x5ea894,_0x50e7f2)=>{const _0x177633=a0_0x54c9e9;try{const _0x9dc3ef=_0x5ea894[_0x177633(0xf3)]['id'],_0x469755=await Reference[_0x177633(0x266)](_0x9dc3ef);_0x50e7f2[_0x177633(0x162)](_0x469755[_0x177633(0x117)]);}catch(_0x21b2cd){_0x50e7f2[_0x177633(0xe7)](_0x21b2cd);}}),router[a0_0x54c9e9(0x227)](a0_0x54c9e9(0x1b8),auth,async(_0x1a398a,_0x2c8961)=>{const _0x4493aa=a0_0x54c9e9;try{const {ref_data:_0x5a01ab}=_0x1a398a[_0x4493aa(0x133)],_0x12fba6=_0x5a01ab[_0x4493aa(0x12c)]('~'),_0x3486a8=_0x12fba6[_0x4493aa(0x264)](_0x1d6835=>_0x1d6835!==''),_0x23b3bc=await Reference[_0x4493aa(0x1b5)]([{'$match':{'referenceNumber':{'$in':_0x3486a8}}}]),_0x56cc26=XLSX[_0x4493aa(0x183)][_0x4493aa(0x250)]();_0x23b3bc[_0x4493aa(0x107)](_0x31745d=>{const _0x5dcf84=_0x4493aa,_0x4e83f7=cheerio['load'](_0x31745d[_0x5dcf84(0x117)]);let _0x4adafe=[],_0x103d4d=[],_0x4a44da=[];_0x4e83f7(_0x5dcf84(0x24f))[_0x5dcf84(0x23e)]((_0x2a21d5,_0x529a5f)=>{const _0x5c4b93=_0x5dcf84;let _0x56183b=[],_0x18eb69=0x0;while(_0x4a44da[_0x18eb69]){_0x4a44da[_0x18eb69]--,_0x18eb69++;}_0x4e83f7(_0x529a5f)[_0x5c4b93(0x225)](_0x5c4b93(0x223))[_0x5c4b93(0x23e)]((_0x5b00fb,_0x53f8dd)=>{const _0x2936b3=_0x5c4b93;let _0x196f8e=_0x4e83f7(_0x53f8dd)[_0x2936b3(0x140)]()['trim'](),_0x3b753b=parseFloat(_0x196f8e[_0x2936b3(0x10d)](/,/g,''));isNaN(_0x3b753b)&&(_0x3b753b=_0x196f8e);let _0x387972=parseInt(_0x4e83f7(_0x53f8dd)['attr'](_0x2936b3(0x224)))||0x1,_0x561d16=parseInt(_0x4e83f7(_0x53f8dd)[_0x2936b3(0xfa)](_0x2936b3(0x113)))||0x1;_0x56183b[_0x18eb69]=_0x3b753b;(_0x387972>0x1||_0x561d16>0x1)&&_0x103d4d[_0x2936b3(0x190)]({'s':{'r':_0x2a21d5,'c':_0x18eb69},'e':{'r':_0x2a21d5+_0x561d16-0x1,'c':_0x18eb69+_0x387972-0x1}});for(let _0x4fe9f5=0x0;_0x4fe9f5<_0x387972;_0x4fe9f5++){_0x561d16>0x1&&(_0x4a44da[_0x18eb69+_0x4fe9f5]=_0x561d16-0x1);}_0x18eb69+=_0x387972;}),_0x4adafe['push'](_0x56183b);});const _0x5b0760=XLSX[_0x5dcf84(0x183)][_0x5dcf84(0x1df)](_0x4adafe);_0x103d4d[_0x5dcf84(0x192)]>0x0&&(_0x5b0760[_0x5dcf84(0x26c)]=_0x103d4d),_0x5b0760[_0x5dcf84(0x1db)]=_0x4adafe[0x0]['map'](()=>({'wpx':0x64})),XLSX[_0x5dcf84(0x183)][_0x5dcf84(0x122)](_0x56cc26,_0x5b0760,_0x31745d['referenceNumber']);});const _0x3dc224=XLSX['write'](_0x56cc26,{'bookType':'xlsx','type':'buffer'});_0x2c8961[_0x4493aa(0x1c4)](_0x4493aa(0x16b),_0x4493aa(0xf1)),_0x2c8961[_0x4493aa(0x1c4)](_0x4493aa(0x256),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x2c8961[_0x4493aa(0x162)](_0x3dc224);}catch(_0x2002e5){_0x2c8961[_0x4493aa(0xe7)](_0x2002e5);}}),router[a0_0x54c9e9(0x227)](a0_0x54c9e9(0x159),auth,async(_0x5bde12,_0x410ae1)=>{const _0x592bd5=a0_0x54c9e9,{from_date:_0x4bed14,agent_id:_0x3f2202}=_0x5bde12[_0x592bd5(0x133)],_0x2db488=_0x5bde12[_0x592bd5(0xe6)],_0x4e2fae=await staff[_0x592bd5(0x13d)]({'email':_0x2db488[_0x592bd5(0x220)]}),_0x512647=await master_shop[_0x592bd5(0x225)](),_0x83c833=await agentsdataDSICheck_DSRR(_0x4bed14,_0x3f2202,_0x4ab6ac);let _0x2227e3='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x359441=new Date(_0x4bed14);const _0x495393={'year':_0x592bd5(0x235),'month':'long','day':_0x592bd5(0x235)},_0x550767=new Intl[(_0x592bd5(0x1dd))]('en-US',_0x495393)[_0x592bd5(0x16e)](_0x359441);_0x2227e3+='<div\x20class=\x22row\x22>',_0x2227e3+=_0x592bd5(0x155),_0x2227e3+=_0x592bd5(0x263),_0x2227e3+=_0x83c833,_0x2227e3+='</table>',_0x2227e3+=_0x592bd5(0x147),_0x2227e3+='</div>';let _0x1e1eb4='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x525d7f={'width':_0x592bd5(0x1a8),'height':_0x592bd5(0x267),'orientation':_0x592bd5(0x1de),'border':{'top':'0.1in','right':_0x592bd5(0x13c),'bottom':_0x592bd5(0x13c),'left':_0x592bd5(0x13c)},'header':{'height':_0x592bd5(0x154),'contents':_0x592bd5(0x19d)+_0x1e1eb4+_0x592bd5(0x24c)+_0x550767+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':'20mm','contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1'};var _0x4ab6ac='on';if(_0x4ab6ac=='on'){const _0x21fefc=cheerio[_0x592bd5(0x1dc)](_0x2227e3);let _0xa1effa=[],_0x18aaed=[],_0x40de28=[];_0x21fefc('table\x20tr')[_0x592bd5(0x23e)]((_0x831df6,_0x1cda6b)=>{const _0x5e9b97=_0x592bd5;let _0x510edb=[],_0x4dede1=0x0;while(_0x40de28[_0x4dede1]){_0x40de28[_0x4dede1]--,_0x4dede1++;}_0x21fefc(_0x1cda6b)[_0x5e9b97(0x225)](_0x5e9b97(0x223))[_0x5e9b97(0x23e)]((_0x55abbe,_0x5ee729)=>{const _0x5e681b=_0x5e9b97;let _0x3c17f1=_0x21fefc(_0x5ee729)[_0x5e681b(0x140)]()[_0x5e681b(0x1d3)](),_0x13858c=parseFloat(_0x3c17f1['replace'](/,/g,''));isNaN(_0x13858c)&&(_0x13858c=_0x3c17f1);let _0x459f91=parseInt(_0x21fefc(_0x5ee729)['attr'](_0x5e681b(0x224)))||0x1,_0x5308b6=parseInt(_0x21fefc(_0x5ee729)['attr'](_0x5e681b(0x113)))||0x1;_0x510edb[_0x4dede1]=_0x13858c;(_0x459f91>0x1||_0x5308b6>0x1)&&_0x18aaed[_0x5e681b(0x190)]({'s':{'r':_0x831df6,'c':_0x4dede1},'e':{'r':_0x831df6+_0x5308b6-0x1,'c':_0x4dede1+_0x459f91-0x1}});for(let _0xf35788=0x0;_0xf35788<_0x459f91;_0xf35788++){_0x5308b6>0x1&&(_0x40de28[_0x4dede1+_0xf35788]=_0x5308b6-0x1);}_0x4dede1+=_0x459f91;}),_0xa1effa[_0x5e9b97(0x190)](_0x510edb);});const _0x3f7f13=XLSX[_0x592bd5(0x183)][_0x592bd5(0x250)](),_0x1267df=XLSX[_0x592bd5(0x183)]['aoa_to_sheet'](_0xa1effa);_0x18aaed[_0x592bd5(0x192)]>0x0&&(_0x1267df[_0x592bd5(0x26c)]=_0x18aaed);_0x1267df[_0x592bd5(0x1db)]=_0xa1effa[0x0][_0x592bd5(0x1a6)](()=>({'wpx':0x64})),XLSX[_0x592bd5(0x183)][_0x592bd5(0x122)](_0x3f7f13,_0x1267df,_0x592bd5(0x232));const _0x3531c2=XLSX['write'](_0x3f7f13,{'bookType':'xlsx','type':_0x592bd5(0xff)});_0x410ae1[_0x592bd5(0x1c4)](_0x592bd5(0x16b),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x410ae1[_0x592bd5(0x1c4)](_0x592bd5(0x256),_0x592bd5(0x241)),_0x410ae1[_0x592bd5(0x162)](_0x3531c2);}else pdf[_0x592bd5(0x25a)](_0x2227e3,_0x525d7f)[_0x592bd5(0x1d2)](function(_0xcdaedd,_0x2e5b9b){const _0xc2e4e3=_0x592bd5;if(_0xcdaedd){_0x410ae1[_0xc2e4e3(0x271)](0x1f4)['send'](_0xc2e4e3(0x262));return;}_0x410ae1['setHeader'](_0xc2e4e3(0x256),_0xc2e4e3(0x259)),_0x2e5b9b[_0xc2e4e3(0x21a)](_0x410ae1);});}),module[a0_0x54c9e9(0x244)]=router;