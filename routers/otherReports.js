const a0_0x58d2d0=a0_0x4f58;(function(_0x56686b,_0x55cf72){const _0xc53543=a0_0x4f58,_0x53d042=_0x56686b();while(!![]){try{const _0x50445d=-parseInt(_0xc53543(0x227))/0x1+-parseInt(_0xc53543(0x35d))/0x2*(-parseInt(_0xc53543(0x343))/0x3)+-parseInt(_0xc53543(0x20b))/0x4+parseInt(_0xc53543(0x339))/0x5+parseInt(_0xc53543(0x237))/0x6+-parseInt(_0xc53543(0x36e))/0x7*(parseInt(_0xc53543(0x2fe))/0x8)+-parseInt(_0xc53543(0x27a))/0x9*(parseInt(_0xc53543(0x2cb))/0xa);if(_0x50445d===_0x55cf72)break;else _0x53d042['push'](_0x53d042['shift']());}catch(_0x524996){_0x53d042['push'](_0x53d042['shift']());}}}(a0_0x2bbc,0xaec12));const express=require(a0_0x58d2d0(0x2ac)),res=require(a0_0x58d2d0(0x2d7)),app=express(),router=express[a0_0x58d2d0(0x322)](),multer=require(a0_0x58d2d0(0x2ba)),{profile,master_shop,categories,brands,units,product,purchases,warehouse,sales_finished,sales,transfers_finished,adjustment_finished,purchases_finished,sales_return_finished,adjustment,transfers,sales_sa,staff,sales_inv_data,Reference}=require(a0_0x58d2d0(0x351)),auth=require('../middleware/auth'),users=require(a0_0x58d2d0(0x2b2)),excelJS=require('exceljs'),XLSX=require('xlsx'),PDFDocument=require('pdfkit-table'),fs=require('fs'),blobStream=require(a0_0x58d2d0(0x307)),JsBarcode=require(a0_0x58d2d0(0x321)),{Canvas}=require('canvas'),pdf=require(a0_0x58d2d0(0x1f8)),path=require('path'),mongoose=require(a0_0x58d2d0(0x2a1)),cheerio=require('cheerio');router[a0_0x58d2d0(0x24a)]('/balance/view',auth,async(_0xaafa0c,_0x2de42b)=>{const _0x314987=a0_0x58d2d0;try{const {username:_0x1d196b,email:_0x1df23e,role:_0x5eeb9e}=_0xaafa0c[_0x314987(0x332)],_0x50ea5a=_0xaafa0c['user'],_0xd095dc=await profile['findOne']({'email':_0x50ea5a[_0x314987(0x2c7)]}),_0x273f47={'year':_0x314987(0x22f),'month':_0x314987(0x26a),'day':_0x314987(0x22f)},_0x9f757a=await master_shop[_0x314987(0x2c8)]();console[_0x314987(0x2f8)](_0x314987(0x293),_0x9f757a);const _0x2601d8=await product[_0x314987(0x2c8)]();console['log'](_0x314987(0x28e),_0x2601d8);const _0x5e6534=await warehouse[_0x314987(0x2cf)]([{'$unwind':_0x314987(0x200)},{'$lookup':{'from':'products','localField':_0x314987(0x35e),'foreignField':'name','as':_0x314987(0x29e)}},{'$unwind':_0x314987(0x2ed)},{'$project':{'product_name':_0x314987(0x354),'product_stock':_0x314987(0x2b0)}},{'$group':{'_id':_0x314987(0x31b),'product_stock':{'$sum':_0x314987(0x320)}}}]);console[_0x314987(0x2f8)](_0x314987(0x205),_0x5e6534),_0x5e6534[_0x314987(0x32d)](_0x123363=>{const _0x5765ad=_0x2601d8['map'](_0x31df5a=>{const _0x469aa5=a0_0x4f58;_0x31df5a[_0x469aa5(0x347)]==_0x123363[_0x469aa5(0x20a)]&&(_0x31df5a[_0x469aa5(0x257)]=parseInt(_0x31df5a[_0x469aa5(0x257)])+parseInt(_0x123363[_0x469aa5(0x252)]));});}),console['log']('Products\x20find_data',_0x2601d8);if(_0x9f757a[0x0][_0x314987(0x2d5)]==_0x314987(0x34c))var _0xf3fd52=users[_0x314987(0x23c)];else{if(_0x9f757a[0x0]['language']==_0x314987(0x277))var _0xf3fd52=users[_0x314987(0x277)];else{if(_0x9f757a[0x0][_0x314987(0x2d5)]=='German')var _0xf3fd52=users[_0x314987(0x331)];else{if(_0x9f757a[0x0]['language']==_0x314987(0x2b5))var _0xf3fd52=users[_0x314987(0x2b5)];else{if(_0x9f757a[0x0][_0x314987(0x2d5)]==_0x314987(0x1e8))var _0xf3fd52=users[_0x314987(0x1e8)];else{if(_0x9f757a[0x0][_0x314987(0x2d5)]==_0x314987(0x316))var _0xf3fd52=users[_0x314987(0x1ee)];else{if(_0x9f757a[0x0][_0x314987(0x2d5)]==_0x314987(0x2bf))var _0xf3fd52=users[_0x314987(0x2bf)];else{if(_0x9f757a[0x0][_0x314987(0x2d5)]=='Arabic\x20(ae)')var _0xf3fd52=users[_0x314987(0x1fb)];}}}}}}}_0x2de42b[_0x314987(0x275)](_0x314987(0x33a),{'success':_0xaafa0c[_0x314987(0x1f5)](_0x314987(0x33e)),'errors':_0xaafa0c[_0x314987(0x1f5)](_0x314987(0x311)),'alldata':_0x2601d8,'profile':_0xd095dc,'master_shop':_0x9f757a,'role':_0x50ea5a,'product_stock':_0x5e6534,'language':_0xf3fd52});}catch(_0x4d316e){}});async function dataCheck(_0x27188a,_0x3cc97d){const _0x5a74c8=a0_0x58d2d0,_0x19a95d=await product[_0x5a74c8(0x2cf)]([{'$group':{'_id':{'brand':_0x5a74c8(0x342),'category':_0x5a74c8(0x352)},'products':{'$push':{'name':_0x5a74c8(0x1ef),'product_code':_0x5a74c8(0x1e5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x3fd699=[];_0x3fd699['cat_brand']=[];for(let _0x1c9d11=0x0;_0x1c9d11<=_0x19a95d[_0x5a74c8(0x34e)]-0x1;_0x1c9d11++){const _0x15dedd=_0x19a95d[_0x1c9d11];_0x3fd699['cat_brand']['push'](_0x15dedd);}const _0x222aec=await product[_0x5a74c8(0x2cf)]([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x5a74c8(0x342),'product_code':_0x5a74c8(0x1e5),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x209528=await purchases_finished[_0x5a74c8(0x2cf)]([{'$match':{'date':{'$gte':_0x27188a,'$lte':_0x3cc97d}}},{'$unwind':'$product'},{'$group':{'_id':{'product_name':'$product.product_name','product_code':_0x5a74c8(0x31a)},'totalQTY':{'$sum':_0x5a74c8(0x1f3)}}}]);_0x3fd699[_0x5a74c8(0x2a8)]=[];for(let _0x5518e9=0x0;_0x5518e9<=_0x209528[_0x5a74c8(0x34e)]-0x1;_0x5518e9++){const _0x154b4e=_0x209528[_0x5518e9];_0x3fd699[_0x5a74c8(0x2a8)][_0x5a74c8(0x258)](_0x154b4e);}const _0x4bb69f=await sales_sa[_0x5a74c8(0x2cf)]([{'$match':{'date':{'$gte':_0x27188a,'$lte':_0x3cc97d}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5a74c8(0x250)}}},{'$lookup':{'from':_0x5a74c8(0x337),'localField':_0x5a74c8(0x26f),'foreignField':_0x5a74c8(0x20a),'as':_0x5a74c8(0x21b)}},{'$unwind':_0x5a74c8(0x2f2)},{'$unwind':_0x5a74c8(0x341)},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'2'}},{'$group':{'_id':{'product_name':_0x5a74c8(0x1f6),'product_code':'$sale_product.product_code'},'totalQTY':{'$sum':_0x5a74c8(0x28b)}}}]);console[_0x5a74c8(0x2f8)](_0x4bb69f[0x0]),_0x3fd699[_0x5a74c8(0x361)]=[];for(let _0x328b73=0x0;_0x328b73<=_0x4bb69f[_0x5a74c8(0x34e)]-0x1;_0x328b73++){const _0x31d4b1=_0x4bb69f[_0x328b73];_0x3fd699[_0x5a74c8(0x361)]['push'](_0x31d4b1);}const _0x4b5358=await sales_sa[_0x5a74c8(0x2cf)]([{'$match':{'date':{'$gte':_0x27188a,'$lte':_0x3cc97d}}},{'$addFields':{'sales_staff_id':{'$toObjectId':_0x5a74c8(0x250)}}},{'$lookup':{'from':_0x5a74c8(0x337),'localField':_0x5a74c8(0x26f),'foreignField':'_id','as':_0x5a74c8(0x21b)}},{'$unwind':_0x5a74c8(0x2f2)},{'$unwind':'$sale_product'},{'$match':{'sales_info.account_category':'sa','sales_info.type_of_acc_cat':'1','sale_product.isFG':_0x5a74c8(0x296)}},{'$group':{'_id':{'product_name':_0x5a74c8(0x1f6),'product_code':_0x5a74c8(0x284)},'totalQTY':{'$sum':_0x5a74c8(0x24c)}}}]);_0x3fd699[_0x5a74c8(0x2ec)]=[];for(let _0x4263aa=0x0;_0x4263aa<=_0x4b5358[_0x5a74c8(0x34e)]-0x1;_0x4263aa++){const _0x58e22d=_0x4b5358[_0x4263aa];_0x3fd699[_0x5a74c8(0x2ec)][_0x5a74c8(0x258)](_0x58e22d);}let _0x184372='';for(let _0x14f15c=0x0;_0x14f15c<=_0x222aec[_0x5a74c8(0x34e)]-0x1;_0x14f15c++){const _0x1ba080=_0x222aec[_0x14f15c];_0x184372+=_0x5a74c8(0x253),_0x184372+=_0x5a74c8(0x286)+_0x1ba080[_0x5a74c8(0x20a)][_0x5a74c8(0x319)]+_0x5a74c8(0x24e),_0x184372+='</tr>';for(let _0x5ad135=0x0;_0x5ad135<_0x3fd699[_0x5a74c8(0x263)][_0x5a74c8(0x34e)];_0x5ad135++){const _0x41a2f7=_0x3fd699['cat_brand'][_0x5ad135];if(_0x41a2f7[_0x5a74c8(0x20a)][_0x5a74c8(0x319)]==_0x1ba080['_id']['category']){let _0x4a3530=[],_0x11b7aa=[],_0x43533b=[];_0x4a3530[_0x41a2f7[_0x5a74c8(0x20a)][_0x5a74c8(0x2d8)]]=[],_0x11b7aa[_0x41a2f7['_id'][_0x5a74c8(0x2d8)]]=[],_0x43533b[_0x41a2f7['_id'][_0x5a74c8(0x2d8)]]=[];var _0x3b8392=0x0,_0x534819=0x0,_0x32ccb7=0x0;for(let _0x141804=0x0;_0x141804<_0x41a2f7['products'][_0x5a74c8(0x34e)];_0x141804++){const _0x4ed7c5=_0x41a2f7[_0x5a74c8(0x371)][_0x141804];for(let _0x18599c=0x0;_0x18599c<=_0x3fd699[_0x5a74c8(0x2a8)][_0x5a74c8(0x34e)]-0x1;_0x18599c++){const _0x2b7f14=_0x3fd699[_0x5a74c8(0x2a8)][_0x18599c];_0x2b7f14[_0x5a74c8(0x20a)][_0x5a74c8(0x346)]==_0x4ed7c5[_0x5a74c8(0x347)]&&_0x2b7f14['_id'][_0x5a74c8(0x302)]==_0x4ed7c5[_0x5a74c8(0x302)]&&(_0x3b8392+=parseInt(_0x2b7f14['totalQTY'],0xa));}for(let _0xa61d7a=0x0;_0xa61d7a<=_0x3fd699[_0x5a74c8(0x2ec)][_0x5a74c8(0x34e)]-0x1;_0xa61d7a++){const _0x4663cf=_0x3fd699[_0x5a74c8(0x2ec)][_0xa61d7a];_0x4663cf[_0x5a74c8(0x20a)][_0x5a74c8(0x346)]==_0x4ed7c5['name']&&_0x4663cf[_0x5a74c8(0x20a)]['product_code']==_0x4ed7c5[_0x5a74c8(0x302)]&&(_0x534819+=parseFloat(_0x4663cf[_0x5a74c8(0x283)],0xa)[_0x5a74c8(0x25a)](0x2));}for(let _0x27cb6a=0x0;_0x27cb6a<=_0x3fd699[_0x5a74c8(0x361)]['length']-0x1;_0x27cb6a++){const _0x325740=_0x3fd699[_0x5a74c8(0x361)][_0x27cb6a];_0x325740[_0x5a74c8(0x20a)]['product_name']==_0x4ed7c5[_0x5a74c8(0x347)]&&_0x325740[_0x5a74c8(0x20a)][_0x5a74c8(0x302)]==_0x4ed7c5[_0x5a74c8(0x302)]&&(_0x32ccb7+=parseInt(_0x325740['totalQTY'],0xa));}}const _0x1cf10f=new Intl['NumberFormat'](_0x5a74c8(0x206));var _0x53a9a9=_0x1cf10f['format'](_0x3b8392);_0x4a3530[_0x41a2f7['_id']['brand']][_0x5a74c8(0x258)](_0x53a9a9),_0x11b7aa[_0x41a2f7[_0x5a74c8(0x20a)][_0x5a74c8(0x2d8)]][_0x5a74c8(0x258)](_0x1cf10f[_0x5a74c8(0x2fa)](_0x534819)),_0x43533b[_0x41a2f7[_0x5a74c8(0x20a)][_0x5a74c8(0x2d8)]][_0x5a74c8(0x258)](_0x1cf10f[_0x5a74c8(0x2fa)](_0x32ccb7));var _0x1183b8=_0x1cf10f['format'](_0x3b8392-(_0x32ccb7+_0x534819));_0x184372+=_0x5a74c8(0x253),_0x184372+=_0x5a74c8(0x372),_0x184372+='<td\x20class=\x22row_data\x22>'+_0x41a2f7[_0x5a74c8(0x20a)][_0x5a74c8(0x2d8)]+_0x5a74c8(0x24e),_0x184372+='<td\x20class=\x22row_data\x22>'+_0x4a3530[_0x41a2f7['_id'][_0x5a74c8(0x2d8)]][0x0]+_0x5a74c8(0x24e),_0x184372+=_0x5a74c8(0x34a),_0x184372+=_0x5a74c8(0x2fb)+_0x43533b[_0x41a2f7[_0x5a74c8(0x20a)][_0x5a74c8(0x2d8)]][0x0]+_0x5a74c8(0x24e),_0x184372+=_0x5a74c8(0x2fb)+_0x11b7aa[_0x41a2f7[_0x5a74c8(0x20a)][_0x5a74c8(0x2d8)]][0x0]+'</td>',_0x184372+='<td\x20class=\x22row_data\x22>'+_0x1183b8+_0x5a74c8(0x24e),_0x184372+=_0x5a74c8(0x33c);}}}return console[_0x5a74c8(0x2f8)](_0x3fd699[_0x5a74c8(0x361)]),_0x184372;}function a0_0x2bbc(){const _0x249bad=['$_id.category','setHeader','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>','\x22><b></b></td>','<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SIGNATURE:\x20</b></td>','NetPrice','<p>FINISHED\x20GOODS\x20INVENTORY</p>','</thead>','/agent/pdf','Household','987MwZMJJ','post','<td\x20class=\x22row_data\x22\x20colspan=\x222\x22><b>Total:\x20</b></td>','products','<td\x20class=\x22row_data\x22></td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>','$product_info.category','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','/dsrr_admin/view_data/:id','$product_code','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','$products.NetPrice','French','<div\x20\x20id=\x22table-conatainer\x22>','<th>X-Truck</th>','sort','<script>','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<br>\x20CALLS</b></td>','Portuguese','$name','$sale_product.adj_discount','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TODAY</b></td>','ObjectId','$product.quantity','product_info','flash','$sale_product.product_name','Sales\x20Report','html-pdf','$sale_product.prod_cat','<th>\x20INVOICE\x20AMOUNT\x20</th>','Arabic','$totalQty','$sales_info.name','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>','<p>INVENTORY\x20SUMMARY</p>','$product_details','$products.discount','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>SALES\x20TODAY</b></td>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','sales_reports','Products\x20warehouse_data','en-US','<td\x20class=\x22cat_data\x22><b>IN\x20CAR</b></td>','json','<th>\x20SALES\x20</th>','_id','3223584mHDtUo','$customer','PDF\x20Generation\x20Error:','<tbody>','/getDSSR_no','/dsrr/view','$product_info.gross_price','15in','$status_data','product_details','$products.product_details','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','$totalGross','/getDSSR_no_sales','date_include','$sale_product.isFG','sales_info','<table>','$product_list','cash','$sale_product._id','$product_list.product_name','/inventory_sum/view','toStream','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>DUE\x20DATE</b></td>','deleteOne','$_id.dsi','<td\x20class=\x22cat_data\x22><b>FG</b></td>','416524knlLss','sumqty','/agent_reports/sales_ad','split','getMonth','<th\x20rowspan=\x272\x27>Category</th>','attachment;\x20filename=\x22reports.xlsx\x22','No\x20data\x20was\x20Found!','numeric','$adj_discount','catch','<th\x20rowspan=\x272\x27>Production</th>','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p><b>','getFullYear','$products.adj_discount','5731614YUscVR','$products.product_details.brand','<div\x20style=\x22page-break-before:\x20always;\x22></div>','medium','totalQty','English','book_new','$cash','left','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','landscape','style','/agent_reports/pdf','book_append_sheet','<p>SALES\x20REPORTS</p>','</div>','<td\x20colspan=\x225\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>MODE\x20OF\x20PAYMENT</b></td>','then','excel','get','aoa_to_sheet','$sale_product.real_qty_unit_val','toLocaleDateString','</td>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>','$sales_staff_id','<th>\x20INCOMING\x20</th>','product_stock','<tr>','Asia/Manila','$products.product_details.category','attr','stock','push','rowspan','toFixed','$sale_product.discount','<th>\x20BEG\x20BALANCE\x20</th>','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:20px\x22><b>#</b></td>','000000','$_id.customer','dsi','toISOString','<td\x20colspan=\x22','cat_brand','$products.product_details.prod_id','!cols','map','$check_no','$amount','</th>','long','</b></td>','sales_man_code','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>','</script>','sales_staff_id','<td\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22\x20><b>NO:\x20','<td\x20colspan=\x225\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NO\x20OF\x20WORKING\x20DAYS\x20<br>\x20FOR\x20THE\x20MONTH\x20_________\x20<br>\x20<br>\x20NO\x20OF\x20DAYS\x20WORKED\x20<br>\x20TO\x20DATE\x20_________\x20\x20</br></td>','<td\x20class=\x22cat_data\x22>','Content-Disposition','<th\x20rowspan=\x272\x27>Ending\x20Balance<br>','render','60mm','Hindi','params','Letter','2910636HSRwuH','top','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20height=\x22100px\x22\x20colspan=\x22','create','!merges','bottom','qty','send','</p>','totalQTY','$sale_product.product_code','findOne','<td\x20colspan=\x227\x22\x20class=\x22cat_data\x22>','<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>CHECK\x20#</b></td>','<th>\x20ITEM\x20DESCRIPTION\x20</th>','$due_date','Types','$sale_product.quantity','<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>','brandCount','Products\x20find_data','Error\x20generating\x20PDF','NumberFormat','agent_sales','$bank','Products\x20master','<th>\x20ITEM\x20CODE\x20</th>','/dsrr_admin/pdf_admin','false','check_no','$_id.date','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','border-bottom','colspan','0.1in','attachment;\x20filename=\x22sales_report.xlsx\x22','product_docs','\x20-\x20STD','$product_info.product_code','mongoose','<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>','\x22><b>','border-right','getDate','sale_product.product_code','<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','beg_bal','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20<BR>\x20PRODUCTIVE</b></td>','<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>','<div\x20class=\x22row\x22>','express','\x20-\x20','$product_info.brand','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','$product_details.product_stock','<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22><b>','../public/language/languages.json','dataqty','right','Spanish','application/pdf','$_id.status_data','<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>','window.print();','multer','\x22\x20class=\x22cat_data\x22>','status','pipe','findById','Chinese','dssr_view','$date','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22><b>DSI#PR#</b></td>','/total_sales_reports/pdf','replace','\x22\x20style=\x22max-width:\x20100%;\x20height:\x20auto;\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>JAKA\x20EQUITIES\x20CORP</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>SALES\x20REPORTS\x20-\x20EXTRUCK</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','</b></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','email','find','<div\x20class=\x22col-sm-11\x22>','<th>\x20QTY\x20SOLD\x20</th>','10hQJGJw','<p>','isArray','trim','aggregate','$products','<td\x20class=\x22row_data\x22\x20style=\x22width:\x20200px\x22>','<h1>JAKA\x20EQUITIES\x20CORP</h1>','valueOf','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20BEG:\x20</b></td>','language','window.onload\x20=\x20function()\x20{','express/lib/response','brand','<td\x20colspan=\x223\x22><b>TOTAL<b>','<td\x20class=\x22cat_data\x22>NET\x20SALES</td>','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20SALES\x20TO\x20DATE</b></td>','date','dsi_sales','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC','\x20-\x20HH','dsi_sales_admin','<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>','/reports/dsrr/view','thick','\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20p\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2080%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-left:\x20auto;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-right:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cat_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.row_data\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20','$dsi','20mm','/dsrr/pdf','amount','save','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>Salesman\x20Name</td>','<td\x20colspan=\x223\x22\x20rowspan=\x221\x22\x20class=\x22cat_data\x22><b>CHECK</b></td>','sales_ext','$product_docs','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>','each','$sale_product.stock','buffer','$sales_info','Arabic\x20(ae)','Content-Type','DateTimeFormat','<td\x20colspan=\x2211.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>AREA\x20COVERED:\x20</b></td>','border-left','log','$products.qty','format','<td\x20class=\x22row_data\x22>','body','load','61720mzsNcU','<thead>','totalGross','text','product_code','$products.product_details.gross_price','\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a','<td\x20colspan=\x221\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>REPORT\x20NO</b></td>','<td\x20class=\x22cat_data\x22>DISCOUNT</td>','blob-stream','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b></b></td>','<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>AMOUNT</b></td>','prod_cat','true','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>TOTAL\x20STOCK\x20ON\x20HAND</b></td>','<td\x20class=\x22row_data\x22><b>','/dev/null','<td\x20colspan=\x2224\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>','toLocaleString','errors','xlsx','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>','/inventory_sum/pdf','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20TRAVELLED:\x20</b></td>','Portuguese\x20(BR)','referenceNumber','$NetPrice','category','$product.product_code','$product_name','table\x20tr','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>','$product_info','<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADD:\x20PREVIOUS</b></td>','$product_stock','jsbarcode','Router','filter','$_id.brand','dssr_view_admin','<td\x20class=\x22cat_data\x22><b>IN\x20PC</b></td>','isFG','$product_list.product_stock','<td\x20colspan=\x223\x22\x20rowspan=\x223\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TOTAL\x20KMS\x20<br>\x20TRAVELLED\x20\x20FOR\x20THIS\x20<br>\x20MONTH\x20________\x20KMS</br></td>','$sale_product.totalprice','includes','<td\x20class=\x22cat_data\x22></td>','forEach','/total_sales_reports/view','<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>TO\x20DATE</b></td>','totalPrice','German','user','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','setDate','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DATE:\x20</b>\x20','td,\x20th','staffs','</table>','6196175CBPElH','balanced','<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>','</tr>','error','success','utils','adj_discount','$sale_product','$brand','84507trOptp','border-top','8.5in','product_name','name','reduce','<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','<td\x20class=\x22row_data\x22>0</td>','thin','English\x20(US)','discount','length','inventory_sum','note','../models/all_models','$category','html','$product_details.product_name','$discount','slice','<td\x20colspan=\x2215\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>','customer','bank','write','$product_info.name','/dsrr_admin/view','82kXGIdl','product_details.product_name','totalQTYsum','<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>KM\x20RDG\x20END:\x20</b></td>','sales_bkg','</tbody>','<td\x20height=\x2250px\x22\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22\x20colspan=\x22'];a0_0x2bbc=function(){return _0x249bad;};return a0_0x2bbc();}router[a0_0x58d2d0(0x36f)]('/balance/pdf',auth,async(_0x2b4ed4,_0x47eeba)=>{const _0x1c9008=a0_0x58d2d0,{from_date:_0x4d6ef8,to_date:_0x2e5d88}=_0x2b4ed4['body'],_0x3653c3=await dataCheck(_0x4d6ef8,_0x2e5d88);{}let _0x1e573f=_0x1c9008(0x233);var _0x5ecf29=new Date(_0x4d6ef8),_0x2c8993=new Date(_0x2e5d88);const _0xb34782={'year':_0x1c9008(0x22f),'month':_0x1c9008(0x26a),'day':'numeric'},_0x2a7ae4=new Intl[(_0x1c9008(0x2f5))]('en-US',_0xb34782)[_0x1c9008(0x2fa)](_0x5ecf29),_0x38c308=new Intl['DateTimeFormat'](_0x1c9008(0x206),_0xb34782)[_0x1c9008(0x2fa)](_0x2c8993);_0x1e573f+=_0x1c9008(0x2d2),_0x1e573f+=_0x1c9008(0x36a),_0x1e573f+=_0x1c9008(0x2cc)+_0x2a7ae4+_0x1c9008(0x2ad)+_0x38c308+_0x1c9008(0x282),_0x1e573f+=_0x1c9008(0x2ab),_0x1e573f+=_0x1c9008(0x2c9),_0x1e573f+=_0x1c9008(0x21c),_0x1e573f+=_0x1c9008(0x253),_0x1e573f+=_0x1c9008(0x22c),_0x1e573f+='<th\x20rowspan=\x272\x27>Products</th>',_0x1e573f+='<th\x20rowspan=\x272\x27>Beginning\x20Balance<br>'+_0x2a7ae4+_0x1c9008(0x269),_0x1e573f+=_0x1c9008(0x232),_0x1e573f+='<th\x20colspan=\x272\x27>SOLD</th>',_0x1e573f+=_0x1c9008(0x274)+_0x38c308+_0x1c9008(0x269),_0x1e573f+=_0x1c9008(0x33c),_0x1e573f+='<tr>',_0x1e573f+='<th>Booking</th>',_0x1e573f+=_0x1c9008(0x1ea),_0x1e573f+=_0x1c9008(0x33c),_0x1e573f+=_0x3653c3,_0x1e573f+='</table>',_0x1e573f+='</div>',_0x1e573f+=_0x1c9008(0x246);const _0x5c8298={'format':_0x1c9008(0x279),'orientation':_0x1c9008(0x241),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x1c9008(0x30e)}}};pdf[_0x1c9008(0x27d)](_0x1e573f,_0x5c8298)[_0x1c9008(0x222)](function(_0x3ec764,_0x105ab6){const _0x25d54e=_0x1c9008;if(_0x3ec764){_0x47eeba['status'](0x1f4)[_0x25d54e(0x281)](_0x25d54e(0x28f));return;}_0x47eeba['setHeader']('Content-Type',_0x25d54e(0x2b6)),_0x105ab6['pipe'](_0x47eeba);});}),router[a0_0x58d2d0(0x24a)]('/agent/view',auth,async(_0xc0e121,_0x327992)=>{const _0x153472=a0_0x58d2d0;try{const {username:_0x5d5b04,email:_0xffc059,role:_0x204865}=_0xc0e121[_0x153472(0x332)],_0x289fbc=_0xc0e121[_0x153472(0x332)],_0x42e8d6=await profile['findOne']({'email':_0x289fbc['email']}),_0x5996c8={'year':_0x153472(0x22f),'month':_0x153472(0x26a),'day':_0x153472(0x22f)},_0x16ec75=await master_shop[_0x153472(0x2c8)](),_0x408dbd=await product[_0x153472(0x2c8)](),_0x4cd5ca=await warehouse[_0x153472(0x2cf)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x153472(0x371),'localField':_0x153472(0x35e),'foreignField':_0x153472(0x347),'as':_0x153472(0x29e)}},{'$unwind':'$product_docs'},{'$project':{'product_name':_0x153472(0x354),'product_stock':_0x153472(0x2b0)}},{'$group':{'_id':_0x153472(0x31b),'product_stock':{'$sum':_0x153472(0x320)}}}]);if(_0x16ec75[0x0][_0x153472(0x2d5)]==_0x153472(0x34c))var _0x387e0b=users[_0x153472(0x23c)];else{if(_0x16ec75[0x0][_0x153472(0x2d5)]==_0x153472(0x277))var _0x387e0b=users['Hindi'];else{if(_0x16ec75[0x0][_0x153472(0x2d5)]==_0x153472(0x331))var _0x387e0b=users['German'];else{if(_0x16ec75[0x0][_0x153472(0x2d5)]==_0x153472(0x2b5))var _0x387e0b=users[_0x153472(0x2b5)];else{if(_0x16ec75[0x0]['language']==_0x153472(0x1e8))var _0x387e0b=users['French'];else{if(_0x16ec75[0x0][_0x153472(0x2d5)]=='Portuguese\x20(BR)')var _0x387e0b=users[_0x153472(0x1ee)];else{if(_0x16ec75[0x0]['language']==_0x153472(0x2bf))var _0x387e0b=users[_0x153472(0x2bf)];else{if(_0x16ec75[0x0][_0x153472(0x2d5)]==_0x153472(0x2f3))var _0x387e0b=users['Arabic'];}}}}}}}_0x327992[_0x153472(0x275)](_0x153472(0x291),{'success':_0xc0e121[_0x153472(0x1f5)](_0x153472(0x33e)),'errors':_0xc0e121[_0x153472(0x1f5)]('errors'),'alldata':_0x408dbd,'profile':_0x42e8d6,'master_shop':_0x16ec75,'role':_0x289fbc,'product_stock':_0x4cd5ca,'language':_0x387e0b});}catch(_0x3e83bf){}});async function agentsdataCheck(_0x5d335b,_0x512799){const _0x3ed6e1=a0_0x58d2d0,_0x3eeeaf=await product[_0x3ed6e1(0x2cf)]([{'$group':{'_id':{'brand':'$brand','category':'$category'},'products':{'$push':{'name':_0x3ed6e1(0x1ef),'product_code':_0x3ed6e1(0x1e5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x4fe92d=[];_0x4fe92d[_0x3ed6e1(0x263)]=[];for(let _0x4dc21b=0x0;_0x4dc21b<=_0x3eeeaf[_0x3ed6e1(0x34e)]-0x1;_0x4dc21b++){const _0x54f9ea=_0x3eeeaf[_0x4dc21b];_0x4fe92d[_0x3ed6e1(0x263)][_0x3ed6e1(0x258)](_0x54f9ea);}const _0x28bcd5=await product[_0x3ed6e1(0x2cf)]([{'$group':{'_id':{'category':_0x3ed6e1(0x352)},'products':{'$push':{'brand':_0x3ed6e1(0x342),'product_code':_0x3ed6e1(0x1e5),'product_name':_0x3ed6e1(0x1ef)}}}},{'$sort':{'_id.category':-0x1}}]),_0x4fd20b=await product[_0x3ed6e1(0x2cf)]([{'$group':{'_id':{'category':'$category','brand':_0x3ed6e1(0x342)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x4ace26=await sales_sa[_0x3ed6e1(0x2cf)]([{'$match':{'date':{'$gte':_0x5d335b,'$lte':_0x512799}}},{'$addFields':{'sales_staff_id':{'$toObjectId':'$sales_staff_id'}}},{'$lookup':{'from':_0x3ed6e1(0x337),'localField':'sales_staff_id','foreignField':_0x3ed6e1(0x20a),'as':_0x3ed6e1(0x21b)}},{'$unwind':'$sales_info'},{'$unwind':_0x3ed6e1(0x341)},{'$match':{'sales_info.account_category':'sa','sale_product.isFG':_0x3ed6e1(0x296)}},{'$lookup':{'from':'products','localField':_0x3ed6e1(0x2a6),'foreignField':'product_code','as':_0x3ed6e1(0x1f4)}},{'$unwind':'$product_info'},{'$group':{'_id':{'sales_id':'$sales_info._id','category':_0x3ed6e1(0x1e2),'brand':_0x3ed6e1(0x2ae)},'salesman_data':{'$first':_0x3ed6e1(0x1fd)},'totalQTY':{'$sum':_0x3ed6e1(0x24c)},'products':{'$push':{'qty':_0x3ed6e1(0x24c),'product_details':{'prod_name':_0x3ed6e1(0x35b),'product_code':_0x3ed6e1(0x2a0),'category':_0x3ed6e1(0x1e2),'brand':_0x3ed6e1(0x2ae)}}}}}]);let _0x5c83e2='';_0x5c83e2+=_0x3ed6e1(0x253),_0x5c83e2+=_0x3ed6e1(0x357),_0x5c83e2+=_0x3ed6e1(0x33c),_0x5c83e2+=_0x3ed6e1(0x253),_0x5c83e2+=_0x3ed6e1(0x32c);for(let _0x4b4874=0x0;_0x4b4874<=_0x28bcd5[_0x3ed6e1(0x34e)]-0x1;_0x4b4874++){const _0x1c07e4=_0x28bcd5[_0x4b4874];for(let _0x48bc7a=0x0;_0x48bc7a<_0x4fd20b['length'];_0x48bc7a++){const _0x1ca835=_0x4fd20b[_0x48bc7a];_0x1ca835[_0x3ed6e1(0x20a)]==_0x1c07e4['_id']['category']&&(_0x5c83e2+=_0x3ed6e1(0x262)+_0x1ca835[_0x3ed6e1(0x28d)]+_0x3ed6e1(0x2bb)+_0x1c07e4['_id']['category']+'</td>');}}_0x5c83e2+=_0x3ed6e1(0x32c),_0x5c83e2+=_0x3ed6e1(0x33c),_0x5c83e2+=_0x3ed6e1(0x253),_0x5c83e2+=_0x3ed6e1(0x2ea);for(let _0x278f77=0x0;_0x278f77<=_0x28bcd5[_0x3ed6e1(0x34e)]-0x1;_0x278f77++){const _0x379cd5=_0x28bcd5[_0x278f77];for(let _0x3ac7f1=0x0;_0x3ac7f1<_0x4fe92d['cat_brand'][_0x3ed6e1(0x34e)];_0x3ac7f1++){const _0xe76111=_0x4fe92d[_0x3ed6e1(0x263)][_0x3ac7f1];_0xe76111[_0x3ed6e1(0x20a)][_0x3ed6e1(0x319)]==_0x379cd5[_0x3ed6e1(0x20a)][_0x3ed6e1(0x319)]&&(_0x5c83e2+=_0x3ed6e1(0x272)+_0xe76111[_0x3ed6e1(0x20a)][_0x3ed6e1(0x2d8)]+_0x3ed6e1(0x24e));}}_0x5c83e2+=_0x3ed6e1(0x2a2),_0x5c83e2+='</tr>';let _0x17e0da={'name':[],'dataqty':{}};for(let _0x5181ef=0x0;_0x5181ef<_0x4fe92d['cat_brand'][_0x3ed6e1(0x34e)];_0x5181ef++){const _0x4b7edb=_0x4fe92d['cat_brand'][_0x5181ef],_0x3d034e=_0x4b7edb['_id']['brand'],_0xc5ebcb=_0x4b7edb[_0x3ed6e1(0x20a)][_0x3ed6e1(0x319)];!_0x17e0da[_0x3ed6e1(0x2b3)][_0x3d034e]&&(_0x17e0da[_0x3ed6e1(0x2b3)][_0x3d034e]={});!_0x17e0da[_0x3ed6e1(0x2b3)][_0x3d034e][_0xc5ebcb]&&(_0x17e0da[_0x3ed6e1(0x2b3)][_0x3d034e][_0xc5ebcb]=[]);for(let _0x584377=0x0;_0x584377<_0x4ace26[_0x3ed6e1(0x34e)];_0x584377++){const _0x1d4374=_0x4ace26[_0x584377];if(_0x3d034e===_0x1d4374[_0x3ed6e1(0x20a)][_0x3ed6e1(0x2d8)]&&_0xc5ebcb===_0x1d4374[_0x3ed6e1(0x20a)][_0x3ed6e1(0x319)]){const _0x27dca1=_0x1d4374['salesman_data'];!_0x17e0da['dataqty'][_0x3d034e][_0xc5ebcb][_0x27dca1]&&(_0x17e0da[_0x3ed6e1(0x2b3)][_0x3d034e][_0xc5ebcb][_0x27dca1]=[]),_0x17e0da[_0x3ed6e1(0x2b3)][_0x3d034e][_0xc5ebcb][_0x27dca1][_0x3ed6e1(0x258)](_0x1d4374[_0x3ed6e1(0x283)]),!_0x17e0da[_0x3ed6e1(0x347)][_0x3ed6e1(0x32b)](_0x27dca1)&&_0x17e0da[_0x3ed6e1(0x347)][_0x3ed6e1(0x258)](_0x27dca1);}}}_0x5c83e2+='<tr>';for(let _0x5f30a2=0x0;_0x5f30a2<=_0x17e0da[_0x3ed6e1(0x347)][_0x3ed6e1(0x34e)]-0x1;_0x5f30a2++){const _0x2afaa3=_0x17e0da['name'][_0x5f30a2];_0x5c83e2+=_0x3ed6e1(0x2fb)+_0x2afaa3+_0x3ed6e1(0x24e);var _0x46d927=0x0,_0x30f8eb=0x0;for(let _0x2f4efb=0x0;_0x2f4efb<=_0x4fe92d['cat_brand']['length']-0x1;_0x2f4efb++){const _0x3163fd=_0x4fe92d[_0x3ed6e1(0x263)][_0x2f4efb];var _0x1fb842=0x0;_0x17e0da['dataqty'][_0x3163fd[_0x3ed6e1(0x20a)]['brand']][_0x3163fd[_0x3ed6e1(0x20a)][_0x3ed6e1(0x319)]][_0x2afaa3]?(_0x1fb842=_0x17e0da[_0x3ed6e1(0x2b3)][_0x3163fd[_0x3ed6e1(0x20a)][_0x3ed6e1(0x2d8)]][_0x3163fd['_id']['category']][_0x2afaa3][0x0],_0x5c83e2+=_0x3ed6e1(0x2fb)+formatNumber(_0x1fb842)+_0x3ed6e1(0x24e)):(_0x1fb842=0x0,_0x5c83e2+=_0x3ed6e1(0x2fb)+_0x1fb842+_0x3ed6e1(0x24e)),_0x46d927+=parseFloat(_0x1fb842);}_0x5c83e2+=_0x3ed6e1(0x2fb)+_0x46d927[_0x3ed6e1(0x25a)](0x2)+_0x3ed6e1(0x24e);}return _0x5c83e2+='</tr>',_0x5c83e2;}function a0_0x4f58(_0xfebc51,_0x62f3b1){const _0x2bbcef=a0_0x2bbc();return a0_0x4f58=function(_0x4f58e7,_0x3ea7d0){_0x4f58e7=_0x4f58e7-0x1e2;let _0x1ba6b4=_0x2bbcef[_0x4f58e7];return _0x1ba6b4;},a0_0x4f58(_0xfebc51,_0x62f3b1);}router['post'](a0_0x58d2d0(0x36c),auth,async(_0x410441,_0x4a09ac)=>{const _0x587a24=a0_0x58d2d0,{from_date:_0x349635,to_date:_0x55ca09}=_0x410441['body'],_0x1b87fd=await agentsdataCheck(_0x349635,_0x55ca09);{}let _0xe06fdc=_0x587a24(0x2e4);var _0x246b0f=new Date(_0x349635),_0x278311=new Date(_0x55ca09);const _0x93df13={'year':_0x587a24(0x22f),'month':_0x587a24(0x26a),'day':_0x587a24(0x22f)},_0x50acfe=new Intl[(_0x587a24(0x2f5))]('en-US',_0x93df13)[_0x587a24(0x2fa)](_0x246b0f),_0x15fc2a=new Intl['DateTimeFormat'](_0x587a24(0x206),_0x93df13)[_0x587a24(0x2fa)](_0x278311);_0xe06fdc+='<h1>JAKA\x20EQUITIES\x20CORP</h1>',_0xe06fdc+=_0x587a24(0x245),_0xe06fdc+='<p>'+_0x50acfe+_0x587a24(0x2ad)+_0x15fc2a+_0x587a24(0x282),_0xe06fdc+=_0x587a24(0x2ab),_0xe06fdc+=_0x587a24(0x2c9),_0xe06fdc+=_0x587a24(0x21c),_0xe06fdc+=_0x1b87fd,_0xe06fdc+='</table>',_0xe06fdc+=_0x587a24(0x246),_0xe06fdc+='</div>';const _0x2474de={'format':_0x587a24(0x279),'orientation':'landscape','childProcessOptions':{'env':{'OPENSSL_CONF':_0x587a24(0x30e)}}};pdf[_0x587a24(0x27d)](_0xe06fdc,_0x2474de)[_0x587a24(0x222)](function(_0x22ce0e,_0x548171){const _0x469602=_0x587a24;if(_0x22ce0e){_0x4a09ac[_0x469602(0x2bc)](0x1f4)[_0x469602(0x281)](_0x469602(0x28f));return;}_0x4a09ac[_0x469602(0x365)](_0x469602(0x2f4),'application/pdf'),_0x548171[_0x469602(0x2bd)](_0x4a09ac);});}),router[a0_0x58d2d0(0x24a)](a0_0x58d2d0(0x229),auth,async(_0x3bf82e,_0x3802b2)=>{const _0x4e7aff=a0_0x58d2d0;try{const {username:_0x45de4f,email:_0xb0d483,role:_0x24c8be}=_0x3bf82e[_0x4e7aff(0x332)],_0x1a23e9=_0x3bf82e[_0x4e7aff(0x332)],_0x72db25=await profile['findOne']({'email':_0x1a23e9[_0x4e7aff(0x2c7)]}),_0x8d34d5={'year':'numeric','month':_0x4e7aff(0x26a),'day':'numeric'},_0x2e431a=await master_shop[_0x4e7aff(0x2c8)](),_0x3debff=await staff[_0x4e7aff(0x285)]({'email':_0x1a23e9[_0x4e7aff(0x2c7)]}),_0x431952=await product[_0x4e7aff(0x2c8)](),_0x2690b8=await warehouse[_0x4e7aff(0x2cf)]([{'$unwind':_0x4e7aff(0x200)},{'$lookup':{'from':_0x4e7aff(0x371),'localField':_0x4e7aff(0x35e),'foreignField':_0x4e7aff(0x347),'as':_0x4e7aff(0x29e)}},{'$unwind':_0x4e7aff(0x2ed)},{'$project':{'product_name':_0x4e7aff(0x354),'product_stock':_0x4e7aff(0x2b0)}},{'$group':{'_id':_0x4e7aff(0x31b),'product_stock':{'$sum':_0x4e7aff(0x320)}}}]),_0x1b1f86=await staff['find']({'account_category':'sa','type_of_acc_cat':'1'});if(_0x2e431a[0x0]['language']==_0x4e7aff(0x34c))var _0x29b8bf=users[_0x4e7aff(0x23c)];else{if(_0x2e431a[0x0][_0x4e7aff(0x2d5)]==_0x4e7aff(0x277))var _0x29b8bf=users[_0x4e7aff(0x277)];else{if(_0x2e431a[0x0][_0x4e7aff(0x2d5)]==_0x4e7aff(0x331))var _0x29b8bf=users[_0x4e7aff(0x331)];else{if(_0x2e431a[0x0][_0x4e7aff(0x2d5)]==_0x4e7aff(0x2b5))var _0x29b8bf=users[_0x4e7aff(0x2b5)];else{if(_0x2e431a[0x0][_0x4e7aff(0x2d5)]==_0x4e7aff(0x1e8))var _0x29b8bf=users[_0x4e7aff(0x1e8)];else{if(_0x2e431a[0x0][_0x4e7aff(0x2d5)]==_0x4e7aff(0x316))var _0x29b8bf=users[_0x4e7aff(0x1ee)];else{if(_0x2e431a[0x0][_0x4e7aff(0x2d5)]==_0x4e7aff(0x2bf))var _0x29b8bf=users['Chinese'];else{if(_0x2e431a[0x0][_0x4e7aff(0x2d5)]==_0x4e7aff(0x2f3))var _0x29b8bf=users[_0x4e7aff(0x1fb)];}}}}}}}_0x3802b2['render'](_0x4e7aff(0x2e0),{'success':_0x3bf82e[_0x4e7aff(0x1f5)]('success'),'errors':_0x3bf82e['flash']('errors'),'alldata':_0x431952,'profile':_0x72db25,'master_shop':_0x2e431a,'role':_0x1a23e9,'product_stock':_0x2690b8,'language':_0x29b8bf,'staff_arr':_0x3debff,'staff_data_all':_0x1b1f86});}catch(_0xcf773c){_0x3802b2['json'](_0xcf773c);}});async function agentsdataDSICheck_admin(_0x1a365f,_0x117d0e,_0x3fc23d,_0x349b43){const _0x6d20e8=a0_0x58d2d0,_0x1f96d4=await product[_0x6d20e8(0x2cf)]([{'$group':{'_id':{'brand':_0x6d20e8(0x342),'category':_0x6d20e8(0x352)},'products':{'$push':{'name':_0x6d20e8(0x1ef),'product_code':_0x6d20e8(0x1e5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0xdc99e9=[];_0xdc99e9[_0x6d20e8(0x263)]=[];for(let _0x109482=0x0;_0x109482<=_0x1f96d4['length']-0x1;_0x109482++){const _0x5d8d72=_0x1f96d4[_0x109482];_0xdc99e9[_0x6d20e8(0x263)]['push'](_0x5d8d72);}const _0x1e7538=await product['aggregate']([{'$group':{'_id':{'category':'$category'},'products':{'$push':{'brand':_0x6d20e8(0x342),'product_code':_0x6d20e8(0x1e5),'product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x3f827c=await product['aggregate']([{'$group':{'_id':{'category':'$category','brand':_0x6d20e8(0x342)}}},{'$group':{'_id':_0x6d20e8(0x364),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x316dba=await sales_sa[_0x6d20e8(0x2cf)]([{'$match':{'date':{'$gte':_0x1a365f,'$lte':_0x117d0e},'sales_staff_id':_0x3fc23d,'sale_product.isFG':'false'}},{'$unwind':_0x6d20e8(0x341)},{'$match':{'sale_product.isFG':_0x6d20e8(0x296)}},{'$lookup':{'from':_0x6d20e8(0x371),'localField':_0x6d20e8(0x2a6),'foreignField':'product_code','as':_0x6d20e8(0x1f4)}},{'$unwind':_0x6d20e8(0x31e)},{'$group':{'_id':{'dsi':_0x6d20e8(0x2e5),'date':_0x6d20e8(0x2c1),'customer':_0x6d20e8(0x20c)},'totalQty':{'$sum':_0x6d20e8(0x24c)},'products':{'$push':{'qty':_0x6d20e8(0x24c),'NetPrice':_0x6d20e8(0x32a),'discount':_0x6d20e8(0x25b),'adj_discount':_0x6d20e8(0x1f0),'product_details':{'prod_name':'$product_info.name','product_code':_0x6d20e8(0x2a0),'category':_0x6d20e8(0x1e2),'brand':'$product_info.brand','gross_price':_0x6d20e8(0x211)}}}}},{'$unwind':_0x6d20e8(0x2d0)},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':'$_id.customer','category':'$products.product_details.category','brand':'$products.product_details.brand'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':['$products.qty',_0x6d20e8(0x303)]}},'NetPrice':{'$sum':_0x6d20e8(0x1e7)},'discount':{'$sum':'$products.discount'},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':_0x6d20e8(0x215)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x6d20e8(0x298),'customer':'$_id.customer'},'totalQty':{'$sum':_0x6d20e8(0x1fc)},'totalGross':{'$sum':_0x6d20e8(0x217)},'NetPrice':{'$sum':_0x6d20e8(0x318)},'discount':{'$sum':_0x6d20e8(0x355)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x6d20e8(0x1fc),'category':_0x6d20e8(0x364),'brand':_0x6d20e8(0x324),'product_details':'$product_details'}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x2b4c65=[],_0x3a1094={},_0x1823a6={},_0x17c6fa={};var _0x1289a0=0x0,_0x2405b3=0x0,_0x472a64=0x0,_0x4f779e=0x0,_0x593d43=0x0;const _0x20e323=0x6;for(let _0x30c243=0x0;_0x30c243<=_0x316dba['length']-0x1;_0x30c243++){const _0x26cbdf=_0x316dba[_0x30c243];let _0x387829='<tr>';_0x387829+=_0x6d20e8(0x313)+_0x26cbdf[_0x6d20e8(0x20a)][_0x6d20e8(0x260)]+'</td>',_0x387829+=_0x6d20e8(0x313)+_0x26cbdf['_id'][_0x6d20e8(0x2dc)]+'</td>',_0x387829+=_0x6d20e8(0x313)+_0x26cbdf[_0x6d20e8(0x20a)]['customer']+'</td>';let _0x3177d2={};var _0x4cec5a=0x0;for(let _0x48c0ea=0x0;_0x48c0ea<=_0x26cbdf['products'][_0x6d20e8(0x34e)]-0x1;_0x48c0ea++){const _0x4e73f2=_0x26cbdf[_0x6d20e8(0x371)][_0x48c0ea];_0x3177d2[_0x4e73f2[_0x6d20e8(0x2d8)]+'-'+_0x4e73f2['category']]=_0x4e73f2['qty'];const _0x174bf1=_0x4e73f2[_0x6d20e8(0x2d8)]+'-'+_0x4e73f2[_0x6d20e8(0x319)];!_0x3a1094[_0x174bf1]&&(_0x3a1094[_0x174bf1]=0x0),!Array[_0x6d20e8(0x2cd)](_0x17c6fa[_0x174bf1])&&(_0x17c6fa[_0x174bf1]=[]),!Array[_0x6d20e8(0x2cd)](_0x17c6fa[_0x174bf1])&&(_0x17c6fa[_0x174bf1]=[]),_0x3a1094[_0x174bf1]+=_0x4e73f2[_0x6d20e8(0x280)],_0x17c6fa[_0x174bf1]['push'](_0x4e73f2[_0x6d20e8(0x280)]),_0x4cec5a++;}console[_0x6d20e8(0x2f8)](_0x26cbdf);for(let _0x263303=0x0;_0x263303<=_0xdc99e9[_0x6d20e8(0x263)][_0x6d20e8(0x34e)]-0x1;_0x263303++){const _0x2be9d0=_0xdc99e9[_0x6d20e8(0x263)][_0x263303],_0x431e9e=_0x2be9d0[_0x6d20e8(0x20a)]['brand']+'-'+_0x2be9d0[_0x6d20e8(0x20a)][_0x6d20e8(0x319)];_0x387829+=_0x6d20e8(0x2ee)+(_0x3177d2[_0x431e9e]!==undefined?_0x3177d2[_0x431e9e][_0x6d20e8(0x25a)](0x2):'')+_0x6d20e8(0x24e);}_0x472a64=_0x26cbdf[_0x6d20e8(0x34d)]+_0x26cbdf['adj_discount'],_0x387829+=_0x6d20e8(0x2a7)+formatNumber(parseFloat(_0x26cbdf[_0x6d20e8(0x23b)],0x2)[_0x6d20e8(0x25a)](0x2))+_0x6d20e8(0x24e),_0x387829+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x26cbdf['totalGross'][_0x6d20e8(0x25a)](0x2))+_0x6d20e8(0x24e),_0x387829+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x472a64)+_0x6d20e8(0x24e),_0x387829+=_0x6d20e8(0x2a7)+formatNumber(_0x26cbdf['NetPrice'][_0x6d20e8(0x25a)](0x2))+'</td>',_0x387829+=_0x6d20e8(0x33c),_0x1289a0+=parseFloat(_0x26cbdf[_0x6d20e8(0x23b)]),_0x2405b3+=parseFloat(_0x26cbdf[_0x6d20e8(0x369)][_0x6d20e8(0x25a)](0x2)),_0x4f779e+=_0x472a64,_0x593d43+=parseFloat(_0x26cbdf[_0x6d20e8(0x300)][_0x6d20e8(0x25a)](0x2));if(_0x30c243==_0x316dba[_0x6d20e8(0x34e)]-0x1){_0x387829+=_0x6d20e8(0x253),_0x387829+=_0x6d20e8(0x2d9),_0x387829+='</td>';for(let _0x14b077=0x0;_0x14b077<=_0xdc99e9[_0x6d20e8(0x263)][_0x6d20e8(0x34e)]-0x1;_0x14b077++){const _0x37edb0=_0xdc99e9['cat_brand'][_0x14b077],_0x142dc7=_0x37edb0['_id'][_0x6d20e8(0x2d8)]+'-'+_0x37edb0[_0x6d20e8(0x20a)][_0x6d20e8(0x319)];!_0x17c6fa[_0x142dc7]&&(_0x17c6fa[_0x142dc7]=[]);const _0x13f649=_0x17c6fa[_0x142dc7][_0x6d20e8(0x348)]((_0x1de64b,_0x39e4e2)=>_0x1de64b+_0x39e4e2,0x0);console[_0x6d20e8(0x2f8)]('test',_0x142dc7),_0x387829+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x13f649!==undefined?formatNumber(_0x13f649['toFixed'](0x2)):'')+_0x6d20e8(0x26b),console['log'](_0x17c6fa[_0x142dc7][_0x6d20e8(0x348)]((_0x49d30f,_0x4a130c)=>_0x49d30f+_0x4a130c,0x0));}_0x387829+=_0x6d20e8(0x2e1)+_0x1289a0['toFixed'](0x2)+'</b></td>',_0x387829+=_0x6d20e8(0x2e1)+formatNumber(_0x593d43)+_0x6d20e8(0x26b),_0x387829+=_0x6d20e8(0x2e1)+formatNumber(_0x4f779e)+_0x6d20e8(0x26b),_0x387829+=_0x6d20e8(0x2e1)+formatNumber(_0x2405b3)+_0x6d20e8(0x26b),_0x387829+='</tr>';}_0x2b4c65[_0x6d20e8(0x258)](_0x387829);}function _0x12515b(_0x4a5fc8,_0x25a53a){const _0x393130=_0x6d20e8,_0x1e4856=[];for(let _0x137ae5=0x0;_0x137ae5<=_0x4a5fc8[_0x393130(0x34e)]-0x1;_0x137ae5+=_0x25a53a){_0x1e4856[_0x393130(0x258)](_0x4a5fc8['slice'](_0x137ae5,_0x137ae5+_0x25a53a));}return _0x1e4856;}const _0x2791e7=_0x12515b(_0x2b4c65,_0x20e323);let _0x5ccf99='';return _0x2791e7['forEach']((_0x1046e6,_0x589acd)=>{const _0x21dc89=_0x6d20e8;_0x589acd>0x0&&(_0x5ccf99+=_0x21dc89(0x239));_0x5ccf99+=_0x21dc89(0x21c),_0x5ccf99+='<thead>',_0x5ccf99+='<tr>',_0x5ccf99+='<td\x20colspan=\x2220\x22\x20class=\x22cat_data\x22>QUANTITY\x20SOLD</td>',_0x5ccf99+='</tr>',_0x5ccf99+=_0x21dc89(0x253),_0x5ccf99+=_0x21dc89(0x26d);for(let _0xcca54a=0x0;_0xcca54a<=_0x1e7538[_0x21dc89(0x34e)]-0x1;_0xcca54a++){const _0x2801f0=_0x1e7538[_0xcca54a];for(let _0xfe0b38=0x0;_0xfe0b38<_0x3f827c[_0x21dc89(0x34e)];_0xfe0b38++){const _0x54f664=_0x3f827c[_0xfe0b38];_0x54f664[_0x21dc89(0x20a)]===_0x2801f0[_0x21dc89(0x20a)]['category']&&(_0x5ccf99+=_0x21dc89(0x262)+_0x54f664['brandCount']+_0x21dc89(0x2bb)+_0x2801f0['_id'][_0x21dc89(0x319)]+'</td>');}}_0x5ccf99+='<td\x20class=\x22cat_data\x22\x20colspan=\x224\x22></td>',_0x5ccf99+='</tr>',_0x5ccf99+=_0x21dc89(0x253),_0x5ccf99+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22>DSI\x20Number</td>',_0x5ccf99+=_0x21dc89(0x24f),_0x5ccf99+=_0x21dc89(0x373);for(let _0x160f78=0x0;_0x160f78<=_0x1e7538['length']-0x1;_0x160f78++){const _0x295ebb=_0x1e7538[_0x160f78];for(let _0x368fa9=0x0;_0x368fa9<_0xdc99e9[_0x21dc89(0x263)][_0x21dc89(0x34e)];_0x368fa9++){const _0x378078=_0xdc99e9[_0x21dc89(0x263)][_0x368fa9];_0x378078[_0x21dc89(0x20a)][_0x21dc89(0x319)]===_0x295ebb['_id']['category']&&(_0x5ccf99+=_0x21dc89(0x272)+_0x378078[_0x21dc89(0x20a)]['brand']+'</td>');}}_0x5ccf99+=_0x21dc89(0x2a2),_0x5ccf99+=_0x21dc89(0x2aa),_0x5ccf99+=_0x21dc89(0x306),_0x5ccf99+=_0x21dc89(0x2da),_0x5ccf99+=_0x21dc89(0x33c),_0x5ccf99+='</thead>',_0x5ccf99+=_0x21dc89(0x20e),_0x1046e6[_0x21dc89(0x32d)](_0xb11a00=>{_0x5ccf99+=_0xb11a00;}),console['log'](_0x17c6fa),_0x5ccf99+=_0x21dc89(0x362),_0x5ccf99+='</table>';}),_0x5ccf99;}async function agentsdataDSICheck_admin_excel(_0x298acf,_0x2322a8,_0x1c5758,_0xc6f745){const _0xf87b43=a0_0x58d2d0,_0x502cc5=await product[_0xf87b43(0x2cf)]([{'$group':{'_id':{'brand':_0xf87b43(0x342),'category':_0xf87b43(0x352)},'products':{'$push':{'name':_0xf87b43(0x1ef),'product_code':_0xf87b43(0x1e5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x49e1bc=[];_0x49e1bc[_0xf87b43(0x263)]=[];for(let _0x43afd5=0x0;_0x43afd5<=_0x502cc5[_0xf87b43(0x34e)]-0x1;_0x43afd5++){const _0x416c64=_0x502cc5[_0x43afd5];_0x49e1bc[_0xf87b43(0x263)][_0xf87b43(0x258)](_0x416c64);}const _0x1cc517=await product[_0xf87b43(0x2cf)]([{'$group':{'_id':{'category':_0xf87b43(0x352)},'products':{'$push':{'brand':_0xf87b43(0x342),'product_code':_0xf87b43(0x1e5),'product_name':_0xf87b43(0x1ef)}}}},{'$sort':{'_id.category':-0x1}}]),_0xf1b39b=await product['aggregate']([{'$group':{'_id':{'category':_0xf87b43(0x352),'brand':_0xf87b43(0x342)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x21f136=await sales_sa[_0xf87b43(0x2cf)]([{'$match':{'date':{'$gte':_0x298acf,'$lte':_0x2322a8},'sales_staff_id':_0x1c5758,'sale_product.isFG':'false'}},{'$unwind':_0xf87b43(0x341)},{'$match':{'sale_product.isFG':_0xf87b43(0x296)}},{'$lookup':{'from':_0xf87b43(0x371),'localField':'sale_product.product_code','foreignField':'product_code','as':_0xf87b43(0x1f4)}},{'$unwind':_0xf87b43(0x31e)},{'$group':{'_id':{'dsi':_0xf87b43(0x2e5),'date':_0xf87b43(0x2c1),'customer':_0xf87b43(0x20c)},'totalQty':{'$sum':_0xf87b43(0x24c)},'products':{'$push':{'qty':_0xf87b43(0x24c),'NetPrice':_0xf87b43(0x32a),'discount':_0xf87b43(0x25b),'adj_discount':_0xf87b43(0x1f0),'product_details':{'prod_name':_0xf87b43(0x35b),'product_code':_0xf87b43(0x2a0),'category':'$product_info.category','brand':_0xf87b43(0x2ae),'gross_price':_0xf87b43(0x211)}}}}},{'$unwind':_0xf87b43(0x2d0)},{'$group':{'_id':{'dsi':_0xf87b43(0x225),'date':_0xf87b43(0x298),'customer':_0xf87b43(0x25f),'category':_0xf87b43(0x255),'brand':_0xf87b43(0x238)},'totalQty':{'$sum':_0xf87b43(0x2f9)},'totalGross':{'$sum':{'$multiply':[_0xf87b43(0x2f9),_0xf87b43(0x303)]}},'NetPrice':{'$sum':_0xf87b43(0x1e7)},'discount':{'$sum':_0xf87b43(0x201)},'adj_discount':{'$sum':_0xf87b43(0x236)},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0xf87b43(0x225),'date':_0xf87b43(0x298),'customer':_0xf87b43(0x25f)},'totalQty':{'$sum':'$totalQty'},'totalGross':{'$sum':_0xf87b43(0x217)},'NetPrice':{'$sum':_0xf87b43(0x318)},'discount':{'$sum':'$discount'},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0xf87b43(0x1fc),'category':_0xf87b43(0x364),'brand':_0xf87b43(0x324),'product_details':_0xf87b43(0x200)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4f0e9f=[],_0x3901ed={},_0x192522={},_0x27ebab={};var _0x11fcb5=0x0,_0x3a543b=0x0,_0x262d62=0x0,_0x32fb51=0x0,_0x5a7895=0x0;const _0x2f92c6=0x16345785d8a0000;for(let _0x5a2322=0x0;_0x5a2322<=_0x21f136[_0xf87b43(0x34e)]-0x1;_0x5a2322++){const _0x5a8069=_0x21f136[_0x5a2322];let _0x49ed5d=_0xf87b43(0x253);_0x49ed5d+=_0xf87b43(0x313)+_0x5a8069['_id'][_0xf87b43(0x260)]+'</td>',_0x49ed5d+=_0xf87b43(0x313)+_0x5a8069[_0xf87b43(0x20a)][_0xf87b43(0x2dc)]+_0xf87b43(0x24e),_0x49ed5d+=_0xf87b43(0x313)+_0x5a8069[_0xf87b43(0x20a)][_0xf87b43(0x358)]+_0xf87b43(0x24e);let _0xe18416={};var _0x379fde=0x0;for(let _0x2ae02a=0x0;_0x2ae02a<=_0x5a8069[_0xf87b43(0x371)][_0xf87b43(0x34e)]-0x1;_0x2ae02a++){const _0xede407=_0x5a8069['products'][_0x2ae02a];_0xe18416[_0xede407[_0xf87b43(0x2d8)]+'-'+_0xede407[_0xf87b43(0x319)]]=_0xede407[_0xf87b43(0x280)];const _0x113fac=_0xede407[_0xf87b43(0x2d8)]+'-'+_0xede407[_0xf87b43(0x319)];!_0x3901ed[_0x113fac]&&(_0x3901ed[_0x113fac]=0x0),!Array[_0xf87b43(0x2cd)](_0x27ebab[_0x113fac])&&(_0x27ebab[_0x113fac]=[]),!Array[_0xf87b43(0x2cd)](_0x27ebab[_0x113fac])&&(_0x27ebab[_0x113fac]=[]),_0x3901ed[_0x113fac]+=_0xede407['qty'],_0x27ebab[_0x113fac]['push'](_0xede407['qty']),_0x379fde++;}for(let _0x368fc3=0x0;_0x368fc3<=_0x49e1bc[_0xf87b43(0x263)][_0xf87b43(0x34e)]-0x1;_0x368fc3++){const _0x99fbc4=_0x49e1bc[_0xf87b43(0x263)][_0x368fc3],_0x5efd84=_0x99fbc4[_0xf87b43(0x20a)][_0xf87b43(0x2d8)]+'-'+_0x99fbc4[_0xf87b43(0x20a)][_0xf87b43(0x319)];_0x49ed5d+=_0xf87b43(0x2ee)+(_0xe18416[_0x5efd84]!==undefined?_0xe18416[_0x5efd84][_0xf87b43(0x25a)](0x2):'')+_0xf87b43(0x24e);}_0x262d62=_0x5a8069[_0xf87b43(0x34d)]+_0x5a8069[_0xf87b43(0x340)],_0x49ed5d+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x5a8069[_0xf87b43(0x23b)],0x2)[_0xf87b43(0x25a)](0x2))+_0xf87b43(0x24e),_0x49ed5d+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x5a8069[_0xf87b43(0x300)][_0xf87b43(0x25a)](0x2))+'</td>',_0x49ed5d+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x262d62)+_0xf87b43(0x24e),_0x49ed5d+=_0xf87b43(0x2a7)+formatNumber(_0x5a8069['NetPrice'][_0xf87b43(0x25a)](0x2))+_0xf87b43(0x24e),_0x49ed5d+=_0xf87b43(0x33c),_0x11fcb5+=parseFloat(_0x5a8069[_0xf87b43(0x23b)]),_0x3a543b+=parseFloat(_0x5a8069[_0xf87b43(0x369)][_0xf87b43(0x25a)](0x2)),_0x32fb51+=_0x262d62,_0x5a7895+=parseFloat(_0x5a8069['totalGross'][_0xf87b43(0x25a)](0x2));if(_0x5a2322==_0x21f136[_0xf87b43(0x34e)]-0x1){_0x49ed5d+=_0xf87b43(0x253),_0x49ed5d+='<td\x20colspan=\x223\x22><b>TOTAL<b>',_0x49ed5d+='</td>';for(let _0x12aecf=0x0;_0x12aecf<=_0x49e1bc[_0xf87b43(0x263)][_0xf87b43(0x34e)]-0x1;_0x12aecf++){const _0x137599=_0x49e1bc['cat_brand'][_0x12aecf],_0x104ae8=_0x137599[_0xf87b43(0x20a)][_0xf87b43(0x2d8)]+'-'+_0x137599[_0xf87b43(0x20a)]['category'];!_0x27ebab[_0x104ae8]&&(_0x27ebab[_0x104ae8]=[]);const _0x4661b4=_0x27ebab[_0x104ae8][_0xf87b43(0x348)]((_0x5d1adc,_0x456823)=>_0x5d1adc+_0x456823,0x0);console[_0xf87b43(0x2f8)]('test',_0x104ae8),_0x49ed5d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+(_0x4661b4!==undefined?formatNumber(_0x4661b4[_0xf87b43(0x25a)](0x2)):'')+'</b></td>',console[_0xf87b43(0x2f8)](_0x27ebab[_0x104ae8]['reduce']((_0x2a8965,_0x1eb2c2)=>_0x2a8965+_0x1eb2c2,0x0));}_0x49ed5d+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x11fcb5)+_0xf87b43(0x26b),_0x49ed5d+=_0xf87b43(0x2e1)+formatNumber(_0x5a7895)+_0xf87b43(0x26b),_0x49ed5d+=_0xf87b43(0x2e1)+formatNumber(_0x32fb51)+_0xf87b43(0x26b),_0x49ed5d+=_0xf87b43(0x2e1)+formatNumber(_0x3a543b)+'</b></td>',_0x49ed5d+=_0xf87b43(0x33c);}_0x4f0e9f[_0xf87b43(0x258)](_0x49ed5d);}function _0x4dc71a(_0x2c55c0,_0x4b485d){const _0x2e23db=_0xf87b43,_0x4c8688=[];for(let _0xeb1983=0x0;_0xeb1983<=_0x2c55c0[_0x2e23db(0x34e)]-0x1;_0xeb1983+=_0x4b485d){_0x4c8688[_0x2e23db(0x258)](_0x2c55c0['slice'](_0xeb1983,_0xeb1983+_0x4b485d));}return _0x4c8688;}const _0x5531f8=_0x4dc71a(_0x4f0e9f,_0x2f92c6);let _0x3d8ee7='';return _0x5531f8[_0xf87b43(0x32d)]((_0x235a1f,_0xea8472)=>{const _0x291fd0=_0xf87b43;_0xea8472>0x0&&(_0x3d8ee7+=_0x291fd0(0x239));_0x3d8ee7+='<table>',_0x3d8ee7+=_0x291fd0(0x2ff),_0x3d8ee7+='<tr>',_0x3d8ee7+=_0x291fd0(0x349),_0x3d8ee7+='</tr>',_0x3d8ee7+=_0x291fd0(0x253),_0x3d8ee7+=_0x291fd0(0x26d);for(let _0x1cabef=0x0;_0x1cabef<=_0x1cc517[_0x291fd0(0x34e)]-0x1;_0x1cabef++){const _0x3bb02f=_0x1cc517[_0x1cabef];for(let _0x5f160c=0x0;_0x5f160c<_0xf1b39b[_0x291fd0(0x34e)];_0x5f160c++){const _0x583808=_0xf1b39b[_0x5f160c];_0x583808[_0x291fd0(0x20a)]===_0x3bb02f[_0x291fd0(0x20a)]['category']&&(_0x3d8ee7+=_0x291fd0(0x262)+_0x583808['brandCount']+_0x291fd0(0x2bb)+_0x3bb02f[_0x291fd0(0x20a)][_0x291fd0(0x319)]+_0x291fd0(0x24e));}}_0x3d8ee7+=_0x291fd0(0x28c),_0x3d8ee7+='</tr>',_0x3d8ee7+='<tr>',_0x3d8ee7+=_0x291fd0(0x33b),_0x3d8ee7+=_0x291fd0(0x24f),_0x3d8ee7+=_0x291fd0(0x373);for(let _0x450393=0x0;_0x450393<=_0x1cc517[_0x291fd0(0x34e)]-0x1;_0x450393++){const _0x36bba2=_0x1cc517[_0x450393];for(let _0x228402=0x0;_0x228402<_0x49e1bc[_0x291fd0(0x263)]['length'];_0x228402++){const _0x212cae=_0x49e1bc['cat_brand'][_0x228402];_0x212cae[_0x291fd0(0x20a)][_0x291fd0(0x319)]===_0x36bba2[_0x291fd0(0x20a)]['category']&&(_0x3d8ee7+=_0x291fd0(0x272)+_0x212cae[_0x291fd0(0x20a)][_0x291fd0(0x2d8)]+_0x291fd0(0x24e));}}_0x3d8ee7+=_0x291fd0(0x2a2),_0x3d8ee7+=_0x291fd0(0x2aa),_0x3d8ee7+=_0x291fd0(0x306),_0x3d8ee7+=_0x291fd0(0x2da),_0x3d8ee7+=_0x291fd0(0x33c),_0x3d8ee7+=_0x291fd0(0x36b),_0x3d8ee7+='<tbody>',_0x235a1f[_0x291fd0(0x32d)](_0x333057=>{_0x3d8ee7+=_0x333057;}),console['log'](_0x27ebab),_0x3d8ee7+='</tbody>',_0x3d8ee7+=_0x291fd0(0x338);}),_0x3d8ee7;}router[a0_0x58d2d0(0x36f)]('/agent_reports/pdf_admin',auth,async(_0x2d8bb1,_0x5cc1a3)=>{const _0x4e002b=a0_0x58d2d0,{from_date:_0x310c9c,to_date:_0x34539b,isExcel:_0x58269a,agent_id:_0x4bdec1}=_0x2d8bb1[_0x4e002b(0x2fc)],_0x3358ae=_0x2d8bb1['user'],_0x59003e=await staff[_0x4e002b(0x285)]({'email':_0x3358ae[_0x4e002b(0x2c7)]}),_0x336f03=await master_shop[_0x4e002b(0x2c8)](),_0x539155=await agentsdataDSICheck_admin(_0x310c9c,_0x34539b,_0x4bdec1,_0x58269a),_0x5aa1a4=await agentsdataDSICheck_admin_excel(_0x310c9c,_0x34539b,_0x4bdec1,_0x58269a);let _0x32df5c=_0x4e002b(0x1e3);var _0x214830=new Date(_0x310c9c),_0x492d1c=new Date(_0x34539b);const _0x5c1700={'year':_0x4e002b(0x22f),'month':_0x4e002b(0x26a),'day':_0x4e002b(0x22f)},_0x3ca062=new Intl[(_0x4e002b(0x2f5))](_0x4e002b(0x206),_0x5c1700)[_0x4e002b(0x2fa)](_0x214830),_0x14e9b7=new Intl[(_0x4e002b(0x2f5))]('en-US',_0x5c1700)[_0x4e002b(0x2fa)](_0x492d1c);_0x32df5c+=_0x4e002b(0x2ab),_0x32df5c+=_0x4e002b(0x1e9),_0x32df5c+='<table>',_0x32df5c+=_0x539155,_0x32df5c+='</table>',_0x32df5c+=_0x4e002b(0x246),_0x32df5c+='</div>';let _0x20911c=_0x4e002b(0x1e3);_0x20911c+='<div\x20class=\x22row\x22>',_0x20911c+='<div\x20\x20id=\x22table-conatainer\x22>',_0x20911c+=_0x4e002b(0x21c),_0x20911c+=_0x5aa1a4,_0x20911c+=_0x4e002b(0x338),_0x20911c+=_0x4e002b(0x246),_0x20911c+=_0x4e002b(0x246);let _0x140e4a=_0x4e002b(0x2de);const _0x2fb08b={'width':_0x4e002b(0x212),'height':'8.5in','orientation':_0x4e002b(0x241),'border':{'top':'0.1in','right':_0x4e002b(0x29c),'bottom':'0.1in','left':'0.1in'},'header':{'height':_0x4e002b(0x276),'contents':_0x4e002b(0x1e6)+_0x140e4a+_0x4e002b(0x2c5)+_0x3ca062+'\x20-\x20'+_0x14e9b7+_0x4e002b(0x216)},'footer':{'height':_0x4e002b(0x2e6),'contents':{'default':_0x4e002b(0x2b8)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x58269a=='on'){const _0x49916a=cheerio[_0x4e002b(0x2fd)](_0x20911c);let _0x520d25=[],_0x3af276=[],_0x133d01=[];_0x49916a('table\x20tr')['each']((_0x29af4e,_0x8be137)=>{const _0x3f3c0e=_0x4e002b;let _0x27b168=[],_0x552ceb=0x0;while(_0x133d01[_0x552ceb]){_0x133d01[_0x552ceb]--,_0x552ceb++;}_0x49916a(_0x8be137)[_0x3f3c0e(0x2c8)](_0x3f3c0e(0x336))[_0x3f3c0e(0x2ef)]((_0x179d1c,_0x2b89d5)=>{const _0x54f582=_0x3f3c0e;let _0x1ae98a=_0x49916a(_0x2b89d5)['text']()[_0x54f582(0x2ce)](),_0x30220e=parseFloat(_0x1ae98a['replace'](/,/g,''));isNaN(_0x30220e)&&(_0x30220e=_0x1ae98a);let _0x509dd0=parseInt(_0x49916a(_0x2b89d5)[_0x54f582(0x256)](_0x54f582(0x29b)))||0x1,_0x3ead8c=parseInt(_0x49916a(_0x2b89d5)[_0x54f582(0x256)](_0x54f582(0x259)))||0x1;_0x27b168[_0x552ceb]=_0x30220e;(_0x509dd0>0x1||_0x3ead8c>0x1)&&_0x3af276[_0x54f582(0x258)]({'s':{'r':_0x29af4e,'c':_0x552ceb},'e':{'r':_0x29af4e+_0x3ead8c-0x1,'c':_0x552ceb+_0x509dd0-0x1}});for(let _0x182254=0x0;_0x182254<_0x509dd0;_0x182254++){_0x3ead8c>0x1&&(_0x133d01[_0x552ceb+_0x182254]=_0x3ead8c-0x1);}_0x552ceb+=_0x509dd0;}),_0x520d25[_0x3f3c0e(0x258)](_0x27b168);});const _0x43ad00=XLSX[_0x4e002b(0x33f)]['book_new'](),_0x5f18ac=XLSX[_0x4e002b(0x33f)][_0x4e002b(0x24b)](_0x520d25);_0x3af276[_0x4e002b(0x34e)]>0x0&&(_0x5f18ac[_0x4e002b(0x27e)]=_0x3af276);_0x5f18ac[_0x4e002b(0x265)]=_0x520d25[0x0][_0x4e002b(0x266)](()=>({'wpx':0x64})),XLSX[_0x4e002b(0x33f)][_0x4e002b(0x244)](_0x43ad00,_0x5f18ac,_0x4e002b(0x1f7));const _0x2b188e=XLSX[_0x4e002b(0x35a)](_0x43ad00,{'bookType':_0x4e002b(0x312),'type':'buffer'});_0x5cc1a3['setHeader'](_0x4e002b(0x273),_0x4e002b(0x29d)),_0x5cc1a3[_0x4e002b(0x365)](_0x4e002b(0x2f4),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x5cc1a3[_0x4e002b(0x281)](_0x2b188e);}else pdf[_0x4e002b(0x27d)](_0x32df5c,_0x2fb08b)['toStream'](function(_0x46271e,_0x4602dc){const _0x37e927=_0x4e002b;if(_0x46271e){_0x5cc1a3['status'](0x1f4)[_0x37e927(0x281)](_0x37e927(0x28f));return;}_0x5cc1a3[_0x37e927(0x365)](_0x37e927(0x2f4),_0x37e927(0x2b6)),_0x4602dc[_0x37e927(0x2bd)](_0x5cc1a3);});}),router['get']('/agent_reports/view',auth,async(_0x1c4f0e,_0x2122ae)=>{const _0xa346fa=a0_0x58d2d0;try{const {username:_0x434aeb,email:_0x46b17c,role:_0x122f7c}=_0x1c4f0e[_0xa346fa(0x332)],_0x618e5c=_0x1c4f0e[_0xa346fa(0x332)],_0x1f7a2e=await profile[_0xa346fa(0x285)]({'email':_0x618e5c[_0xa346fa(0x2c7)]}),_0x4665dd={'year':_0xa346fa(0x22f),'month':_0xa346fa(0x26a),'day':_0xa346fa(0x22f)},_0x2fa8a8=await master_shop[_0xa346fa(0x2c8)](),_0xf87573=await staff[_0xa346fa(0x285)]({'email':_0x618e5c[_0xa346fa(0x2c7)]}),_0x3d7ad0=await product['find'](),_0x48231b=await warehouse[_0xa346fa(0x2cf)]([{'$unwind':_0xa346fa(0x200)},{'$lookup':{'from':_0xa346fa(0x371),'localField':_0xa346fa(0x35e),'foreignField':_0xa346fa(0x347),'as':_0xa346fa(0x29e)}},{'$unwind':_0xa346fa(0x2ed)},{'$project':{'product_name':_0xa346fa(0x354),'product_stock':_0xa346fa(0x2b0)}},{'$group':{'_id':_0xa346fa(0x31b),'product_stock':{'$sum':_0xa346fa(0x320)}}}]);if(_0x2fa8a8[0x0][_0xa346fa(0x2d5)]==_0xa346fa(0x34c))var _0x306d42=users[_0xa346fa(0x23c)];else{if(_0x2fa8a8[0x0][_0xa346fa(0x2d5)]=='Hindi')var _0x306d42=users[_0xa346fa(0x277)];else{if(_0x2fa8a8[0x0][_0xa346fa(0x2d5)]==_0xa346fa(0x331))var _0x306d42=users[_0xa346fa(0x331)];else{if(_0x2fa8a8[0x0][_0xa346fa(0x2d5)]==_0xa346fa(0x2b5))var _0x306d42=users[_0xa346fa(0x2b5)];else{if(_0x2fa8a8[0x0][_0xa346fa(0x2d5)]==_0xa346fa(0x1e8))var _0x306d42=users[_0xa346fa(0x1e8)];else{if(_0x2fa8a8[0x0][_0xa346fa(0x2d5)]==_0xa346fa(0x316))var _0x306d42=users[_0xa346fa(0x1ee)];else{if(_0x2fa8a8[0x0][_0xa346fa(0x2d5)]==_0xa346fa(0x2bf))var _0x306d42=users[_0xa346fa(0x2bf)];else{if(_0x2fa8a8[0x0][_0xa346fa(0x2d5)]==_0xa346fa(0x2f3))var _0x306d42=users['Arabic'];}}}}}}}_0x2122ae[_0xa346fa(0x275)](_0xa346fa(0x2dd),{'success':_0x1c4f0e[_0xa346fa(0x1f5)](_0xa346fa(0x33e)),'errors':_0x1c4f0e[_0xa346fa(0x1f5)](_0xa346fa(0x311)),'alldata':_0x3d7ad0,'profile':_0x1f7a2e,'master_shop':_0x2fa8a8,'role':_0x618e5c,'product_stock':_0x48231b,'language':_0x306d42,'staff_arr':_0xf87573});}catch(_0x1a7009){}});function formatNumber(_0x7785ca,_0x474741=a0_0x58d2d0(0x206),_0x6763e0={'minimumFractionDigits':0x2}){const _0x3383bd=a0_0x58d2d0,_0x2c8138=new Intl[(_0x3383bd(0x290))](_0x474741,_0x6763e0);return _0x2c8138[_0x3383bd(0x2fa)](_0x7785ca);}async function agentsdataDSICheck(_0x35bfc9,_0x5bf0cf,_0x41c02a,_0x5d77f8){const _0x330a52=a0_0x58d2d0,_0x5eb6ef=await product[_0x330a52(0x2cf)]([{'$group':{'_id':{'brand':_0x330a52(0x342),'category':_0x330a52(0x352)},'products':{'$push':{'name':_0x330a52(0x1ef),'product_code':_0x330a52(0x1e5)}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5d321e=[];_0x5d321e[_0x330a52(0x263)]=[];for(let _0x55cb48=0x0;_0x55cb48<=_0x5eb6ef[_0x330a52(0x34e)]-0x1;_0x55cb48++){const _0x3d2445=_0x5eb6ef[_0x55cb48];_0x5d321e[_0x330a52(0x263)][_0x330a52(0x258)](_0x3d2445);}const _0x58be43=await product[_0x330a52(0x2cf)]([{'$group':{'_id':{'category':_0x330a52(0x352)},'products':{'$push':{'brand':_0x330a52(0x342),'product_code':_0x330a52(0x1e5),'product_name':_0x330a52(0x1ef)}}}},{'$sort':{'_id.category':-0x1}}]),_0x53b107=await product[_0x330a52(0x2cf)]([{'$group':{'_id':{'category':_0x330a52(0x352),'brand':'$brand'}}},{'$group':{'_id':_0x330a52(0x364),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x5959e9=await sales_sa[_0x330a52(0x2cf)]([{'$match':{'date':{'$gte':_0x35bfc9,'$lte':_0x5bf0cf},'sales_staff_id':_0x41c02a,'sale_product.isFG':'false','status_data':_0x330a52(0x296)}},{'$unwind':_0x330a52(0x341)},{'$match':{'sale_product.isFG':_0x330a52(0x296)}},{'$lookup':{'from':'products','localField':'sale_product.product_code','foreignField':_0x330a52(0x302),'as':_0x330a52(0x1f4)}},{'$unwind':'$product_info'},{'$group':{'_id':{'dsi':_0x330a52(0x2e5),'date':_0x330a52(0x2c1),'customer':'$customer'},'totalQty':{'$sum':_0x330a52(0x24c)},'products':{'$push':{'qty':_0x330a52(0x24c),'NetPrice':_0x330a52(0x32a),'discount':_0x330a52(0x25b),'adj_discount':_0x330a52(0x1f0),'product_details':{'prod_name':_0x330a52(0x35b),'product_code':_0x330a52(0x2a0),'category':_0x330a52(0x1e2),'brand':_0x330a52(0x2ae),'gross_price':_0x330a52(0x211)}}}}},{'$unwind':_0x330a52(0x2d0)},{'$group':{'_id':{'dsi':_0x330a52(0x225),'date':_0x330a52(0x298),'customer':_0x330a52(0x25f),'category':_0x330a52(0x255),'brand':_0x330a52(0x238)},'totalQty':{'$sum':_0x330a52(0x2f9)},'totalGross':{'$sum':{'$multiply':[_0x330a52(0x2f9),'$products.product_details.gross_price']}},'NetPrice':{'$sum':_0x330a52(0x1e7)},'discount':{'$sum':_0x330a52(0x201)},'adj_discount':{'$sum':_0x330a52(0x236)},'product_details':{'$first':_0x330a52(0x215)}}},{'$group':{'_id':{'dsi':_0x330a52(0x225),'date':_0x330a52(0x298),'customer':_0x330a52(0x25f)},'totalQty':{'$sum':_0x330a52(0x1fc)},'totalGross':{'$sum':_0x330a52(0x217)},'NetPrice':{'$sum':_0x330a52(0x318)},'discount':{'$sum':_0x330a52(0x355)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x330a52(0x1fc),'category':_0x330a52(0x364),'brand':'$_id.brand','product_details':_0x330a52(0x200)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x4dc0d8=[],_0x6a65c5={},_0x49bc59={},_0x9dfeb6={};var _0x1d1a87=0x0,_0x55e1c2=0x0,_0x11ab36=0x0,_0xa57a8d=0x0,_0x2c4c82=0x0;const _0x1dfa51=0x6;for(let _0x2b7413=0x0;_0x2b7413<=_0x5959e9[_0x330a52(0x34e)]-0x1;_0x2b7413++){const _0x3bd471=_0x5959e9[_0x2b7413];let _0x4d22b7='<tr>';_0x4d22b7+=_0x330a52(0x313)+_0x3bd471['_id'][_0x330a52(0x260)]+_0x330a52(0x24e),_0x4d22b7+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x3bd471['_id'][_0x330a52(0x2dc)]+_0x330a52(0x24e),_0x4d22b7+=_0x330a52(0x313)+_0x3bd471[_0x330a52(0x20a)]['customer']+'</td>';let _0x514b03={};var _0x2d8a7b=0x0;for(let _0x2ed5f3=0x0;_0x2ed5f3<=_0x3bd471[_0x330a52(0x371)][_0x330a52(0x34e)]-0x1;_0x2ed5f3++){const _0x442569=_0x3bd471[_0x330a52(0x371)][_0x2ed5f3];_0x514b03[_0x442569[_0x330a52(0x2d8)]+'-'+_0x442569['category']]=_0x442569[_0x330a52(0x280)];const _0x18b919=_0x442569['brand']+'-'+_0x442569[_0x330a52(0x319)];!_0x6a65c5[_0x18b919]&&(_0x6a65c5[_0x18b919]=0x0),!Array[_0x330a52(0x2cd)](_0x9dfeb6[_0x18b919])&&(_0x9dfeb6[_0x18b919]=[]),!Array[_0x330a52(0x2cd)](_0x9dfeb6[_0x18b919])&&(_0x9dfeb6[_0x18b919]=[]),_0x6a65c5[_0x18b919]+=_0x442569[_0x330a52(0x280)],_0x9dfeb6[_0x18b919][_0x330a52(0x258)](_0x442569[_0x330a52(0x280)]),_0x2d8a7b++;}for(let _0x875aee=0x0;_0x875aee<=_0x5d321e['cat_brand']['length']-0x1;_0x875aee++){const _0x584ac5=_0x5d321e['cat_brand'][_0x875aee],_0x54afb8=_0x584ac5['_id']['brand']+'-'+_0x584ac5[_0x330a52(0x20a)]['category'];_0x4d22b7+=_0x330a52(0x2ee)+(_0x514b03[_0x54afb8]!==undefined?_0x514b03[_0x54afb8][_0x330a52(0x25a)](0x2):'')+_0x330a52(0x24e);}_0x11ab36=_0x3bd471[_0x330a52(0x34d)]+_0x3bd471['adj_discount'],_0x4d22b7+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(parseFloat(_0x3bd471[_0x330a52(0x23b)],0x2)[_0x330a52(0x25a)](0x2))+'</td>',_0x4d22b7+=_0x330a52(0x2a7)+formatNumber(_0x3bd471[_0x330a52(0x300)][_0x330a52(0x25a)](0x2))+_0x330a52(0x24e),_0x4d22b7+=_0x330a52(0x2a7)+formatNumber(_0x11ab36)+_0x330a52(0x24e),_0x4d22b7+=_0x330a52(0x2a7)+formatNumber(_0x3bd471[_0x330a52(0x369)][_0x330a52(0x25a)](0x2))+'</td>',_0x4d22b7+='</tr>',_0x1d1a87+=parseFloat(_0x3bd471[_0x330a52(0x23b)]),_0x55e1c2+=parseFloat(_0x3bd471[_0x330a52(0x369)][_0x330a52(0x25a)](0x2)),_0xa57a8d+=_0x11ab36,_0x2c4c82+=parseFloat(_0x3bd471[_0x330a52(0x300)][_0x330a52(0x25a)](0x2));if(_0x2b7413==_0x5959e9[_0x330a52(0x34e)]-0x1){_0x4d22b7+=_0x330a52(0x253),_0x4d22b7+=_0x330a52(0x2d9),_0x4d22b7+='</td>';for(let _0x5df1d7=0x0;_0x5df1d7<=_0x5d321e[_0x330a52(0x263)][_0x330a52(0x34e)]-0x1;_0x5df1d7++){const _0x4dd2d1=_0x5d321e[_0x330a52(0x263)][_0x5df1d7],_0x565f80=_0x4dd2d1[_0x330a52(0x20a)][_0x330a52(0x2d8)]+'-'+_0x4dd2d1['_id'][_0x330a52(0x319)];!_0x9dfeb6[_0x565f80]&&(_0x9dfeb6[_0x565f80]=[]);const _0x1a1785=_0x9dfeb6[_0x565f80]['reduce']((_0x124a6d,_0x4478e4)=>_0x124a6d+_0x4478e4,0x0);_0x4d22b7+=_0x330a52(0x2af)+(_0x1a1785!==undefined?formatNumber(_0x1a1785[_0x330a52(0x25a)](0x2)):'')+_0x330a52(0x26b);}_0x4d22b7+=_0x330a52(0x2e1)+formatNumber(_0x1d1a87[_0x330a52(0x25a)](0x2))+_0x330a52(0x26b),_0x4d22b7+=_0x330a52(0x2e1)+formatNumber(_0x2c4c82)+_0x330a52(0x26b),_0x4d22b7+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0xa57a8d)+_0x330a52(0x26b),_0x4d22b7+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x55e1c2)+_0x330a52(0x26b),_0x4d22b7+='</tr>';}console[_0x330a52(0x2f8)]('Checking:\x20',_0x1d1a87+'+='+parseFloat(_0x3bd471[_0x330a52(0x23b)])),_0x4dc0d8[_0x330a52(0x258)](_0x4d22b7);}function _0x31ae1a(_0x45d0f7,_0x1b253b){const _0x198a8f=_0x330a52,_0x116625=[];for(let _0x5cc97b=0x0;_0x5cc97b<=_0x45d0f7[_0x198a8f(0x34e)]-0x1;_0x5cc97b+=_0x1b253b){_0x116625[_0x198a8f(0x258)](_0x45d0f7[_0x198a8f(0x356)](_0x5cc97b,_0x5cc97b+_0x1b253b));}return _0x116625;}const _0x3fd318=_0x31ae1a(_0x4dc0d8,_0x1dfa51);let _0x5c3184='';return _0x3fd318[_0x330a52(0x32d)]((_0x12f874,_0x4dfc04)=>{const _0x4ead0e=_0x330a52;_0x4dfc04>0x0&&(_0x5c3184+=_0x4ead0e(0x239));_0x5c3184+=_0x4ead0e(0x21c),_0x5c3184+=_0x4ead0e(0x2ff),_0x5c3184+=_0x4ead0e(0x253),_0x5c3184+=_0x4ead0e(0x349),_0x5c3184+=_0x4ead0e(0x33c),_0x5c3184+=_0x4ead0e(0x253),_0x5c3184+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x3b56dc=0x0;_0x3b56dc<=_0x58be43[_0x4ead0e(0x34e)]-0x1;_0x3b56dc++){const _0x57bd9f=_0x58be43[_0x3b56dc];for(let _0xef9d0b=0x0;_0xef9d0b<_0x53b107[_0x4ead0e(0x34e)];_0xef9d0b++){const _0x1c5911=_0x53b107[_0xef9d0b];_0x1c5911[_0x4ead0e(0x20a)]===_0x57bd9f[_0x4ead0e(0x20a)][_0x4ead0e(0x319)]&&(_0x5c3184+=_0x4ead0e(0x262)+_0x1c5911[_0x4ead0e(0x28d)]+'\x22\x20class=\x22cat_data\x22>'+_0x57bd9f[_0x4ead0e(0x20a)][_0x4ead0e(0x319)]+_0x4ead0e(0x24e));}}_0x5c3184+=_0x4ead0e(0x28c),_0x5c3184+=_0x4ead0e(0x33c),_0x5c3184+='<tr>',_0x5c3184+=_0x4ead0e(0x33b),_0x5c3184+=_0x4ead0e(0x24f),_0x5c3184+=_0x4ead0e(0x373);for(let _0x5357a0=0x0;_0x5357a0<=_0x58be43['length']-0x1;_0x5357a0++){const _0x27906e=_0x58be43[_0x5357a0];for(let _0x4a6d0e=0x0;_0x4a6d0e<_0x5d321e[_0x4ead0e(0x263)][_0x4ead0e(0x34e)];_0x4a6d0e++){const _0x445882=_0x5d321e[_0x4ead0e(0x263)][_0x4a6d0e];_0x445882['_id'][_0x4ead0e(0x319)]===_0x27906e[_0x4ead0e(0x20a)][_0x4ead0e(0x319)]&&(_0x5c3184+=_0x4ead0e(0x272)+_0x445882[_0x4ead0e(0x20a)][_0x4ead0e(0x2d8)]+_0x4ead0e(0x24e));}}_0x5c3184+='<td\x20class=\x22cat_data\x22>TOTAL\x20QTY</td>',_0x5c3184+=_0x4ead0e(0x2aa),_0x5c3184+=_0x4ead0e(0x306),_0x5c3184+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x5c3184+='</tr>',_0x5c3184+=_0x4ead0e(0x36b),_0x5c3184+=_0x4ead0e(0x20e),_0x12f874[_0x4ead0e(0x32d)](_0x5a71fe=>{_0x5c3184+=_0x5a71fe;}),_0x5c3184+=_0x4ead0e(0x362),_0x5c3184+='</table>';}),_0x5c3184;}async function agentsdataDSICheck_excel(_0x5cdac3,_0x1f9715,_0x571cfa,_0x305630){const _0x261403=a0_0x58d2d0,_0x14d70d=await product[_0x261403(0x2cf)]([{'$group':{'_id':{'brand':_0x261403(0x342),'category':_0x261403(0x352)},'products':{'$push':{'name':_0x261403(0x1ef),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5a7402=[];_0x5a7402[_0x261403(0x263)]=[];for(let _0x448490=0x0;_0x448490<=_0x14d70d[_0x261403(0x34e)]-0x1;_0x448490++){const _0x156737=_0x14d70d[_0x448490];_0x5a7402['cat_brand']['push'](_0x156737);}const _0x43ecc7=await product[_0x261403(0x2cf)]([{'$group':{'_id':{'category':_0x261403(0x352)},'products':{'$push':{'brand':_0x261403(0x342),'product_code':'$product_code','product_name':'$name'}}}},{'$sort':{'_id.category':-0x1}}]),_0x39f457=await product[_0x261403(0x2cf)]([{'$group':{'_id':{'category':_0x261403(0x352),'brand':_0x261403(0x342)}}},{'$group':{'_id':_0x261403(0x364),'brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0x555594=await sales_sa[_0x261403(0x2cf)]([{'$match':{'date':{'$gte':_0x5cdac3,'$lte':_0x1f9715},'sales_staff_id':_0x571cfa,'sale_product.isFG':_0x261403(0x296)}},{'$unwind':_0x261403(0x341)},{'$match':{'sale_product.isFG':'false'}},{'$lookup':{'from':_0x261403(0x371),'localField':_0x261403(0x2a6),'foreignField':_0x261403(0x302),'as':_0x261403(0x1f4)}},{'$unwind':_0x261403(0x31e)},{'$group':{'_id':{'dsi':_0x261403(0x2e5),'date':'$date','customer':_0x261403(0x20c)},'totalQty':{'$sum':'$sale_product.real_qty_unit_val'},'products':{'$push':{'qty':_0x261403(0x24c),'NetPrice':'$sale_product.totalprice','discount':_0x261403(0x25b),'adj_discount':'$sale_product.adj_discount','product_details':{'prod_name':_0x261403(0x35b),'product_code':_0x261403(0x2a0),'category':_0x261403(0x1e2),'brand':_0x261403(0x2ae),'gross_price':'$product_info.gross_price'}}}}},{'$unwind':_0x261403(0x2d0)},{'$group':{'_id':{'dsi':'$_id.dsi','date':_0x261403(0x298),'customer':'$_id.customer','category':'$products.product_details.category','brand':_0x261403(0x238)},'totalQty':{'$sum':_0x261403(0x2f9)},'totalGross':{'$sum':{'$multiply':[_0x261403(0x2f9),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x261403(0x201)},'adj_discount':{'$sum':'$products.adj_discount'},'product_details':{'$first':'$products.product_details'}}},{'$group':{'_id':{'dsi':_0x261403(0x225),'date':_0x261403(0x298),'customer':_0x261403(0x25f)},'totalQty':{'$sum':_0x261403(0x1fc)},'totalGross':{'$sum':_0x261403(0x217)},'NetPrice':{'$sum':_0x261403(0x318)},'discount':{'$sum':_0x261403(0x355)},'adj_discount':{'$sum':_0x261403(0x230)},'products':{'$push':{'qty':_0x261403(0x1fc),'category':'$_id.category','brand':_0x261403(0x324),'product_details':_0x261403(0x200)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]);let _0x389d09=[],_0x4126ad={},_0x238eb6={},_0x5b6223={};var _0x254f6d=0x0,_0x44f250=0x0,_0x147ef3=0x0,_0x4acae6=0x0,_0x43fa62=0x0;const _0x43fec4=0x9184e72a000;for(let _0x6f5de9=0x0;_0x6f5de9<=_0x555594[_0x261403(0x34e)]-0x1;_0x6f5de9++){const _0x3fde57=_0x555594[_0x6f5de9];let _0x1768fc=_0x261403(0x253);_0x1768fc+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x3fde57['_id'][_0x261403(0x260)]+_0x261403(0x24e),_0x1768fc+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x3fde57[_0x261403(0x20a)][_0x261403(0x2dc)]+_0x261403(0x24e),_0x1768fc+=_0x261403(0x313)+_0x3fde57[_0x261403(0x20a)][_0x261403(0x358)]+'</td>';let _0x244888={};var _0x497121=0x0;for(let _0x2761c8=0x0;_0x2761c8<=_0x3fde57['products'][_0x261403(0x34e)]-0x1;_0x2761c8++){const _0xa63a14=_0x3fde57['products'][_0x2761c8];_0x244888[_0xa63a14[_0x261403(0x2d8)]+'-'+_0xa63a14['category']]=_0xa63a14[_0x261403(0x280)];const _0x55abba=_0xa63a14[_0x261403(0x2d8)]+'-'+_0xa63a14['category'];!_0x4126ad[_0x55abba]&&(_0x4126ad[_0x55abba]=0x0),!Array['isArray'](_0x5b6223[_0x55abba])&&(_0x5b6223[_0x55abba]=[]),!Array[_0x261403(0x2cd)](_0x5b6223[_0x55abba])&&(_0x5b6223[_0x55abba]=[]),_0x4126ad[_0x55abba]+=_0xa63a14[_0x261403(0x280)],_0x5b6223[_0x55abba][_0x261403(0x258)](_0xa63a14[_0x261403(0x280)]),_0x497121++;}for(let _0x257552=0x0;_0x257552<=_0x5a7402['cat_brand']['length']-0x1;_0x257552++){const _0x3e0eb3=_0x5a7402[_0x261403(0x263)][_0x257552],_0x3ff33d=_0x3e0eb3['_id'][_0x261403(0x2d8)]+'-'+_0x3e0eb3[_0x261403(0x20a)]['category'];_0x1768fc+=_0x261403(0x2ee)+(_0x244888[_0x3ff33d]!==undefined?_0x244888[_0x3ff33d][_0x261403(0x25a)](0x2):'')+_0x261403(0x24e);}_0x147ef3=_0x3fde57[_0x261403(0x34d)]+_0x3fde57[_0x261403(0x340)],_0x1768fc+=_0x261403(0x2a7)+formatNumber(parseFloat(_0x3fde57['totalQty'],0x2)[_0x261403(0x25a)](0x2))+'</td>',_0x1768fc+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x3fde57[_0x261403(0x300)][_0x261403(0x25a)](0x2))+_0x261403(0x24e),_0x1768fc+=_0x261403(0x2a7)+formatNumber(_0x147ef3)+'</td>',_0x1768fc+='<td\x20class=\x22row_data\x22\x20\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+formatNumber(_0x3fde57['NetPrice'][_0x261403(0x25a)](0x2))+_0x261403(0x24e),_0x1768fc+=_0x261403(0x33c),_0x254f6d+=parseFloat(_0x3fde57[_0x261403(0x23b)][_0x261403(0x25a)](0x2)),_0x44f250+=parseFloat(_0x3fde57[_0x261403(0x369)][_0x261403(0x25a)](0x2)),_0x4acae6+=_0x147ef3,_0x43fa62+=parseFloat(_0x3fde57[_0x261403(0x300)][_0x261403(0x25a)](0x2));if(_0x6f5de9==_0x555594[_0x261403(0x34e)]-0x1){_0x1768fc+=_0x261403(0x253),_0x1768fc+=_0x261403(0x2d9),_0x1768fc+=_0x261403(0x24e);for(let _0x8d6c0d=0x0;_0x8d6c0d<=_0x5a7402[_0x261403(0x263)][_0x261403(0x34e)]-0x1;_0x8d6c0d++){const _0x747605=_0x5a7402[_0x261403(0x263)][_0x8d6c0d],_0x51dafa=_0x747605[_0x261403(0x20a)]['brand']+'-'+_0x747605[_0x261403(0x20a)][_0x261403(0x319)];!_0x5b6223[_0x51dafa]&&(_0x5b6223[_0x51dafa]=[]);const _0x4a383b=_0x5b6223[_0x51dafa][_0x261403(0x348)]((_0x2960c0,_0x127af7)=>_0x2960c0+_0x127af7,0x0);_0x1768fc+=_0x261403(0x2af)+(_0x4a383b!==undefined?formatNumber(_0x4a383b['toFixed'](0x2)):'')+_0x261403(0x26b);}_0x1768fc+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x254f6d[_0x261403(0x25a)](0x2))+_0x261403(0x26b),_0x1768fc+='<td\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x43fa62)+'</b></td>',_0x1768fc+=_0x261403(0x2e1)+formatNumber(_0x4acae6)+_0x261403(0x26b),_0x1768fc+=_0x261403(0x2e1)+formatNumber(_0x44f250)+_0x261403(0x26b),_0x1768fc+=_0x261403(0x33c);}_0x389d09[_0x261403(0x258)](_0x1768fc);}function _0x5967d4(_0x31c72e,_0x21f060){const _0x5cf655=_0x261403,_0x4be432=[];for(let _0x2b018c=0x0;_0x2b018c<=_0x31c72e['length']-0x1;_0x2b018c+=_0x21f060){_0x4be432[_0x5cf655(0x258)](_0x31c72e['slice'](_0x2b018c,_0x2b018c+_0x21f060));}return _0x4be432;}const _0x153da0=_0x5967d4(_0x389d09,_0x43fec4);let _0x126c92='';return _0x153da0['forEach']((_0x249df1,_0x2f19c2)=>{const _0x397d3a=_0x261403;_0x2f19c2>0x0&&(_0x126c92+='<div\x20style=\x22page-break-before:\x20always;\x22></div>');_0x126c92+=_0x397d3a(0x21c),_0x126c92+=_0x397d3a(0x2ff),_0x126c92+='<tr>',_0x126c92+=_0x397d3a(0x349),_0x126c92+=_0x397d3a(0x33c),_0x126c92+=_0x397d3a(0x253),_0x126c92+=_0x397d3a(0x26d);for(let _0x237d5b=0x0;_0x237d5b<=_0x43ecc7[_0x397d3a(0x34e)]-0x1;_0x237d5b++){const _0x509eae=_0x43ecc7[_0x237d5b];for(let _0x29bc6d=0x0;_0x29bc6d<_0x39f457[_0x397d3a(0x34e)];_0x29bc6d++){const _0x11e940=_0x39f457[_0x29bc6d];_0x11e940['_id']===_0x509eae[_0x397d3a(0x20a)][_0x397d3a(0x319)]&&(_0x126c92+='<td\x20colspan=\x22'+_0x11e940['brandCount']+_0x397d3a(0x2bb)+_0x509eae[_0x397d3a(0x20a)]['category']+_0x397d3a(0x24e));}}_0x126c92+=_0x397d3a(0x28c),_0x126c92+=_0x397d3a(0x33c),_0x126c92+=_0x397d3a(0x253),_0x126c92+=_0x397d3a(0x33b),_0x126c92+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Date</td>',_0x126c92+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22>Customer</td>';for(let _0x508323=0x0;_0x508323<=_0x43ecc7[_0x397d3a(0x34e)]-0x1;_0x508323++){const _0x466760=_0x43ecc7[_0x508323];for(let _0x219d54=0x0;_0x219d54<_0x5a7402[_0x397d3a(0x263)][_0x397d3a(0x34e)];_0x219d54++){const _0x22fe41=_0x5a7402[_0x397d3a(0x263)][_0x219d54];_0x22fe41[_0x397d3a(0x20a)]['category']===_0x466760[_0x397d3a(0x20a)][_0x397d3a(0x319)]&&(_0x126c92+='<td\x20class=\x22cat_data\x22>'+_0x22fe41[_0x397d3a(0x20a)][_0x397d3a(0x2d8)]+_0x397d3a(0x24e));}}_0x126c92+=_0x397d3a(0x2a2),_0x126c92+='<td\x20class=\x22cat_data\x22>GROSS\x20SALES</td>',_0x126c92+=_0x397d3a(0x306),_0x126c92+='<td\x20class=\x22cat_data\x22>NET\x20SALES</td>',_0x126c92+=_0x397d3a(0x33c),_0x126c92+=_0x397d3a(0x36b),_0x126c92+=_0x397d3a(0x20e),_0x249df1['forEach'](_0x5597d1=>{_0x126c92+=_0x5597d1;}),console[_0x397d3a(0x2f8)](_0x5b6223),_0x126c92+=_0x397d3a(0x362),_0x126c92+=_0x397d3a(0x338);}),_0x126c92;}router[a0_0x58d2d0(0x36f)](a0_0x58d2d0(0x243),auth,async(_0x1a7fc5,_0x1c87c5)=>{const _0x59da0c=a0_0x58d2d0,{from_date:_0x38ed26,to_date:_0x51cc2a,isExcel:_0x1cba42}=_0x1a7fc5[_0x59da0c(0x2fc)],_0x14acda=_0x1a7fc5[_0x59da0c(0x332)],_0x3dd62a=await staff['findOne']({'email':_0x14acda[_0x59da0c(0x2c7)]}),_0x2a81d0=await master_shop[_0x59da0c(0x2c8)](),_0x2ab11c=await agentsdataDSICheck(_0x38ed26,_0x51cc2a,_0x3dd62a[_0x59da0c(0x20a)][_0x59da0c(0x2d3)](),_0x1cba42),_0x1b9226=await agentsdataDSICheck_excel(_0x38ed26,_0x51cc2a,_0x3dd62a[_0x59da0c(0x20a)][_0x59da0c(0x2d3)](),_0x1cba42);let _0x153cb2='\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-collapse:\x20collapse;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x20/*\x20Ensure\x20table\x20uses\x20the\x20full\x20width\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x209pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#d0cece;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20black;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20print\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x20page-break-inside:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tr\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20th\x20{\x20page-break-inside:\x20avoid;\x20page-break-after:\x20auto;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@import\x20url(\x27https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Roboto\x27,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2012pt;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20@media\x20(max-width:\x201024px)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20table\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20block;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20overflow-x:\x20auto;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20</style>\x0a';var _0x5ce629=new Date(_0x38ed26),_0x1bbc5c=new Date(_0x51cc2a);const _0x2fd7c1={'year':_0x59da0c(0x22f),'month':_0x59da0c(0x26a),'day':_0x59da0c(0x22f)},_0x57dda1=new Intl[(_0x59da0c(0x2f5))]('en-US',_0x2fd7c1)['format'](_0x5ce629),_0x127add=new Intl[(_0x59da0c(0x2f5))](_0x59da0c(0x206),_0x2fd7c1)[_0x59da0c(0x2fa)](_0x1bbc5c);_0x153cb2+=_0x59da0c(0x2ab),_0x153cb2+=_0x59da0c(0x1e9),_0x153cb2+=_0x59da0c(0x21c),_0x153cb2+=_0x2ab11c,_0x153cb2+=_0x59da0c(0x338),_0x153cb2+=_0x59da0c(0x246),_0x153cb2+='</div>';let _0x2b316d=_0x59da0c(0x304);_0x2b316d+=_0x59da0c(0x2ab),_0x2b316d+=_0x59da0c(0x1e9),_0x2b316d+=_0x59da0c(0x21c),_0x2b316d+=_0x1b9226,_0x2b316d+=_0x59da0c(0x338),_0x2b316d+=_0x59da0c(0x246),_0x2b316d+=_0x59da0c(0x246);let _0x1e95a4='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x5e5274={'width':_0x59da0c(0x212),'height':_0x59da0c(0x345),'orientation':'landscape','border':{'top':_0x59da0c(0x29c),'right':_0x59da0c(0x29c),'bottom':_0x59da0c(0x29c),'left':_0x59da0c(0x29c)},'header':{'height':'60mm','contents':_0x59da0c(0x1e6)+_0x1e95a4+_0x59da0c(0x2c5)+_0x57dda1+_0x59da0c(0x2ad)+_0x127add+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x59da0c(0x2e6),'contents':{'default':_0x59da0c(0x2b8)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':'/dev/null'}}};if(_0x1cba42=='on'){const _0x5f12de=cheerio[_0x59da0c(0x2fd)](_0x2b316d);let _0x296046=[],_0xa0b354=[],_0x4eb6b9=[];const _0x1935ea=_0x239f63=>{const _0x496579=_0x59da0c,_0x4cb18b={'top':{'style':_0x496579(0x2e3),'color':{'rgb':_0x496579(0x25e)}},'bottom':{'style':_0x496579(0x2e3),'color':{'rgb':_0x496579(0x25e)}},'left':{'style':_0x496579(0x2e3),'color':{'rgb':'000000'}},'right':{'style':'thick','color':{'rgb':_0x496579(0x25e)}}};if(_0x239f63){const _0x555bc0=_0x239f63[_0x496579(0x22a)](';')[_0x496579(0x348)]((_0x197fc8,_0x5e343b)=>{const _0x51aa3b=_0x496579,[_0x1d4857,_0x437a8f]=_0x5e343b[_0x51aa3b(0x22a)](':')[_0x51aa3b(0x266)](_0x4d67c8=>_0x4d67c8[_0x51aa3b(0x2ce)]());return _0x197fc8[_0x1d4857]=_0x437a8f,_0x197fc8;},{});_0x555bc0['border-top']&&(_0x4cb18b[_0x496579(0x27b)][_0x496579(0x242)]=_0x555bc0[_0x496579(0x344)]['includes']('thin')?_0x496579(0x34b):_0x496579(0x23a)),_0x555bc0[_0x496579(0x29a)]&&(_0x4cb18b['bottom'][_0x496579(0x242)]=_0x555bc0[_0x496579(0x29a)][_0x496579(0x32b)](_0x496579(0x34b))?'thin':_0x496579(0x23a)),_0x555bc0[_0x496579(0x2f7)]&&(_0x4cb18b[_0x496579(0x23f)][_0x496579(0x242)]=_0x555bc0[_0x496579(0x2f7)][_0x496579(0x32b)](_0x496579(0x34b))?_0x496579(0x34b):_0x496579(0x23a)),_0x555bc0['border-right']&&(_0x4cb18b[_0x496579(0x2b4)]['style']=_0x555bc0['border-right']['includes'](_0x496579(0x34b))?_0x496579(0x34b):_0x496579(0x23a));}return _0x4cb18b;};_0x5f12de(_0x59da0c(0x31c))['each']((_0x4cd65c,_0x1ffeac)=>{const _0x300c15=_0x59da0c;let _0x1e5b0d=[],_0x40f712=0x0;while(_0x4eb6b9[_0x40f712]){_0x4eb6b9[_0x40f712]--,_0x40f712++;}_0x5f12de(_0x1ffeac)[_0x300c15(0x2c8)](_0x300c15(0x336))[_0x300c15(0x2ef)]((_0x152358,_0x5de7d3)=>{const _0x54d18c=_0x300c15;let _0x28baae=_0x5f12de(_0x5de7d3)['text']()[_0x54d18c(0x2ce)](),_0x2a910b=parseFloat(_0x28baae['replace'](/,/g,'')),_0x2b6a29={};!isNaN(_0x2a910b)?(_0x2b6a29['v']=_0x2a910b,_0x2b6a29['t']='n'):(_0x2b6a29['v']=_0x28baae,_0x2b6a29['t']='s');const _0x2187b5=_0x5f12de(_0x5de7d3)[_0x54d18c(0x256)](_0x54d18c(0x242)),_0x30fcb9=_0x1935ea(_0x2187b5);_0x2b6a29['s']={'border':_0x30fcb9},_0x1e5b0d[_0x40f712]=_0x2b6a29;let _0xf5d375=parseInt(_0x5f12de(_0x5de7d3)[_0x54d18c(0x256)]('colspan'))||0x1,_0x39ffc1=parseInt(_0x5f12de(_0x5de7d3)[_0x54d18c(0x256)](_0x54d18c(0x259)))||0x1;(_0xf5d375>0x1||_0x39ffc1>0x1)&&_0xa0b354[_0x54d18c(0x258)]({'s':{'r':_0x4cd65c,'c':_0x40f712},'e':{'r':_0x4cd65c+_0x39ffc1-0x1,'c':_0x40f712+_0xf5d375-0x1}});for(let _0x22bb66=0x0;_0x22bb66<_0xf5d375;_0x22bb66++){_0x39ffc1>0x1&&(_0x4eb6b9[_0x40f712+_0x22bb66]=_0x39ffc1-0x1);}_0x40f712+=_0xf5d375;}),_0x296046[_0x300c15(0x258)](_0x1e5b0d);});const _0x4e420e=XLSX[_0x59da0c(0x33f)][_0x59da0c(0x23d)](),_0x23d0f2=XLSX['utils']['aoa_to_sheet'](_0x296046);_0xa0b354[_0x59da0c(0x34e)]>0x0&&(_0x23d0f2[_0x59da0c(0x27e)]=_0xa0b354);_0x23d0f2[_0x59da0c(0x265)]=_0x296046[0x0][_0x59da0c(0x266)](()=>({'wpx':0x64})),XLSX[_0x59da0c(0x33f)]['book_append_sheet'](_0x4e420e,_0x23d0f2,_0x59da0c(0x1f7));const _0x25483d=XLSX[_0x59da0c(0x35a)](_0x4e420e,{'bookType':_0x59da0c(0x312),'type':_0x59da0c(0x2f1)});_0x1c87c5[_0x59da0c(0x365)](_0x59da0c(0x273),_0x59da0c(0x29d)),_0x1c87c5['setHeader']('Content-Type',_0x59da0c(0x299)),_0x1c87c5[_0x59da0c(0x281)](_0x25483d);}else pdf['create'](_0x153cb2,_0x5e5274)[_0x59da0c(0x222)](function(_0x4ab068,_0x100892){const _0x141361=_0x59da0c;if(_0x4ab068){console[_0x141361(0x33d)](_0x141361(0x20d),_0x4ab068),_0x1c87c5[_0x141361(0x2bc)](0x1f4)[_0x141361(0x281)]('Error\x20generating\x20PDF'+_0x4ab068);return;}_0x1c87c5[_0x141361(0x365)](_0x141361(0x2f4),_0x141361(0x2b6)),_0x100892['pipe'](_0x1c87c5);});}),router[a0_0x58d2d0(0x24a)](a0_0x58d2d0(0x32e),auth,async(_0x27c7a5,_0x24e75a)=>{const _0x1a84fa=a0_0x58d2d0;try{const {username:_0x1f9309,email:_0x2dca72,role:_0x13558b}=_0x27c7a5['user'],_0x1d3e1f=_0x27c7a5['user'],_0x1c2a6b=await profile['findOne']({'email':_0x1d3e1f['email']}),_0x56ac99={'year':_0x1a84fa(0x22f),'month':_0x1a84fa(0x26a),'day':_0x1a84fa(0x22f)},_0x4196a4=await master_shop[_0x1a84fa(0x2c8)](),_0x50db61=await product[_0x1a84fa(0x2c8)](),_0x52ab97=await warehouse[_0x1a84fa(0x2cf)]([{'$unwind':'$product_details'},{'$lookup':{'from':_0x1a84fa(0x371),'localField':_0x1a84fa(0x35e),'foreignField':_0x1a84fa(0x347),'as':_0x1a84fa(0x29e)}},{'$unwind':_0x1a84fa(0x2ed)},{'$project':{'product_name':_0x1a84fa(0x354),'product_stock':_0x1a84fa(0x2b0)}},{'$group':{'_id':_0x1a84fa(0x31b),'product_stock':{'$sum':_0x1a84fa(0x320)}}}]),_0x281690=await staff[_0x1a84fa(0x285)]({'email':_0x1d3e1f[_0x1a84fa(0x2c7)]});if(_0x4196a4[0x0][_0x1a84fa(0x2d5)]=='English\x20(US)')var _0x1ba667=users[_0x1a84fa(0x23c)];else{if(_0x4196a4[0x0][_0x1a84fa(0x2d5)]==_0x1a84fa(0x277))var _0x1ba667=users[_0x1a84fa(0x277)];else{if(_0x4196a4[0x0][_0x1a84fa(0x2d5)]==_0x1a84fa(0x331))var _0x1ba667=users[_0x1a84fa(0x331)];else{if(_0x4196a4[0x0][_0x1a84fa(0x2d5)]=='Spanish')var _0x1ba667=users[_0x1a84fa(0x2b5)];else{if(_0x4196a4[0x0][_0x1a84fa(0x2d5)]==_0x1a84fa(0x1e8))var _0x1ba667=users['French'];else{if(_0x4196a4[0x0][_0x1a84fa(0x2d5)]==_0x1a84fa(0x316))var _0x1ba667=users[_0x1a84fa(0x1ee)];else{if(_0x4196a4[0x0][_0x1a84fa(0x2d5)]==_0x1a84fa(0x2bf))var _0x1ba667=users['Chinese'];else{if(_0x4196a4[0x0][_0x1a84fa(0x2d5)]=='Arabic\x20(ae)')var _0x1ba667=users[_0x1a84fa(0x1fb)];}}}}}}}_0x24e75a[_0x1a84fa(0x275)](_0x1a84fa(0x204),{'success':_0x27c7a5[_0x1a84fa(0x1f5)]('success'),'errors':_0x27c7a5['flash'](_0x1a84fa(0x311)),'alldata':_0x50db61,'profile':_0x1c2a6b,'master_shop':_0x4196a4,'role':_0x1d3e1f,'product_stock':_0x52ab97,'language':_0x1ba667,'staff_arr':_0x281690});}catch(_0x3078f6){}});async function dataSalesReports(_0x3b060d,_0x1fdc26,_0x43e57a){const _0x2ff833=a0_0x58d2d0;let _0x379ea9='';const _0x5b4dbe=await sales_sa[_0x2ff833(0x2cf)]([{'$match':{'date':{'$gte':_0x3b060d,'$lte':_0x1fdc26},'sales_staff_id':_0x43e57a}},{'$unwind':_0x2ff833(0x341)},{'$match':{'sale_product.isFG':_0x2ff833(0x296)}},{'$group':{'_id':{'product_name':_0x2ff833(0x1f6),'product_code':_0x2ff833(0x284)},'sumqty':{'$sum':'$sale_product.real_qty_unit_val'},'totalPrice':{'$sum':'$sale_product.totalprice'}}},{'$sort':{'_id.product_name':0x1}}]);var _0x45a4e1=0x0,_0x2b35e4=0x0;for(let _0x21f703=0x0;_0x21f703<=_0x5b4dbe[_0x2ff833(0x34e)]-0x1;_0x21f703++){const _0x1f0651=_0x5b4dbe[_0x21f703];var _0x2f131f=_0x1f0651[_0x2ff833(0x330)][_0x2ff833(0x310)](undefined),_0x5c0499=_0x1f0651[_0x2ff833(0x228)][_0x2ff833(0x310)](undefined);_0x379ea9+=_0x2ff833(0x253),_0x379ea9+=_0x2ff833(0x2fb)+_0x1f0651[_0x2ff833(0x20a)][_0x2ff833(0x302)]+_0x2ff833(0x24e),_0x379ea9+=_0x2ff833(0x2fb)+_0x1f0651['_id'][_0x2ff833(0x346)]+'</td>',_0x379ea9+=_0x2ff833(0x2fb)+formatNumber(_0x1f0651['sumqty']['toFixed'](0x2))+_0x2ff833(0x24e),_0x379ea9+=_0x2ff833(0x2fb)+formatNumber(_0x1f0651[_0x2ff833(0x330)][_0x2ff833(0x25a)](0x2))+_0x2ff833(0x24e),_0x379ea9+='</tr>',_0x45a4e1+=parseFloat(_0x1f0651[_0x2ff833(0x228)]),_0x2b35e4+=parseFloat(_0x1f0651[_0x2ff833(0x330)]);}var _0x31fd60=_0x2b35e4['toLocaleString'](undefined),_0x3323a0=_0x45a4e1[_0x2ff833(0x310)](undefined);return _0x379ea9+=_0x2ff833(0x253),_0x379ea9+=_0x2ff833(0x370),_0x379ea9+=_0x2ff833(0x30d)+formatNumber(_0x45a4e1['toFixed'](0x2))+_0x2ff833(0x26b),_0x379ea9+=_0x2ff833(0x30d)+formatNumber(_0x2b35e4[_0x2ff833(0x25a)](0x2))+_0x2ff833(0x26b),_0x379ea9+=_0x2ff833(0x33c),_0x379ea9;}router[a0_0x58d2d0(0x36f)](a0_0x58d2d0(0x2c3),auth,async(_0xb22a33,_0x36c0b8)=>{const _0x286693=a0_0x58d2d0;try{const {from_date:_0x4cf454,to_date:_0x379391,isExcel:_0x30c681}=_0xb22a33[_0x286693(0x2fc)],_0x586829=_0xb22a33[_0x286693(0x332)],_0x38b926=await staff['findOne']({'email':_0x586829[_0x286693(0x2c7)]});let _0x3900f4=_0x286693(0x203);var _0x108e50=new Date(_0x4cf454),_0x166b0b=new Date(_0x379391);const _0x4afd7a={'year':_0x286693(0x22f),'month':'long','day':'numeric'},_0x35998e=new Intl[(_0x286693(0x2f5))]('en-US',_0x4afd7a)['format'](_0x108e50),_0x4b7308=new Intl[(_0x286693(0x2f5))](_0x286693(0x206),_0x4afd7a)['format'](_0x166b0b);var _0x2463b6=await dataSalesReports(_0x4cf454,_0x379391,_0x38b926[_0x286693(0x20a)]['valueOf']());_0x3900f4+=_0x286693(0x2ab),_0x3900f4+=_0x286693(0x2c9),_0x3900f4+=_0x286693(0x21c),_0x3900f4+='<tr>',_0x3900f4+=_0x286693(0x294),_0x3900f4+=_0x286693(0x288),_0x3900f4+=_0x286693(0x2ca),_0x3900f4+=_0x286693(0x1fa),_0x3900f4+=_0x286693(0x253),_0x3900f4+=_0x2463b6,_0x3900f4+=_0x286693(0x33c),_0x3900f4+=_0x286693(0x246),_0x3900f4+=_0x286693(0x246);let _0x204901='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxYxAAACD0S0HV4xFoAAAAAElFTkSuQmCC';const _0x5514ee={'width':_0x286693(0x212),'height':_0x286693(0x345),'orientation':_0x286693(0x241),'border':{'top':'0.1in','right':_0x286693(0x29c),'bottom':'0.1in','left':'0.1in'},'header':{'height':'60mm','contents':_0x286693(0x1e6)+_0x204901+_0x286693(0x234)+_0x38b926[_0x286693(0x347)]+_0x286693(0x2c6)+_0x35998e+_0x286693(0x2ad)+_0x4b7308+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br><br><br><br><br><br><br><br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'footer':{'height':_0x286693(0x2e6),'contents':{'default':_0x286693(0x2b8)}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x286693(0x30e)}}};if(_0x30c681=='on'){const _0x66f5f0=cheerio[_0x286693(0x2fd)](_0x3900f4);let _0x48d412=[],_0x5eb4cb=[],_0x1f2974=[];const _0x528c64=_0x23a9b0=>{const _0x59e80f=_0x286693,_0x32f8b3={'top':{'style':_0x59e80f(0x2e3),'color':{'rgb':_0x59e80f(0x25e)}},'bottom':{'style':_0x59e80f(0x2e3),'color':{'rgb':_0x59e80f(0x25e)}},'left':{'style':_0x59e80f(0x2e3),'color':{'rgb':_0x59e80f(0x25e)}},'right':{'style':_0x59e80f(0x2e3),'color':{'rgb':_0x59e80f(0x25e)}}};if(_0x23a9b0){const _0x25f7e0=_0x23a9b0[_0x59e80f(0x22a)](';')[_0x59e80f(0x348)]((_0x2bbe59,_0x25d3fa)=>{const [_0x147d11,_0x373956]=_0x25d3fa['split'](':')['map'](_0x5d8372=>_0x5d8372['trim']());return _0x2bbe59[_0x147d11]=_0x373956,_0x2bbe59;},{});_0x25f7e0[_0x59e80f(0x344)]&&(_0x32f8b3[_0x59e80f(0x27b)][_0x59e80f(0x242)]=_0x25f7e0[_0x59e80f(0x344)][_0x59e80f(0x32b)](_0x59e80f(0x34b))?_0x59e80f(0x34b):_0x59e80f(0x23a)),_0x25f7e0[_0x59e80f(0x29a)]&&(_0x32f8b3['bottom'][_0x59e80f(0x242)]=_0x25f7e0[_0x59e80f(0x29a)]['includes']('thin')?_0x59e80f(0x34b):_0x59e80f(0x23a)),_0x25f7e0[_0x59e80f(0x2f7)]&&(_0x32f8b3[_0x59e80f(0x23f)][_0x59e80f(0x242)]=_0x25f7e0[_0x59e80f(0x2f7)]['includes'](_0x59e80f(0x34b))?_0x59e80f(0x34b):_0x59e80f(0x23a)),_0x25f7e0[_0x59e80f(0x2a4)]&&(_0x32f8b3['right']['style']=_0x25f7e0[_0x59e80f(0x2a4)][_0x59e80f(0x32b)](_0x59e80f(0x34b))?'thin':_0x59e80f(0x23a));}return _0x32f8b3;};_0x66f5f0(_0x286693(0x31c))[_0x286693(0x2ef)]((_0x5f3e31,_0x1d5021)=>{const _0xc7a3e1=_0x286693;let _0x4b0949=[],_0x2002fe=0x0;while(_0x1f2974[_0x2002fe]){_0x1f2974[_0x2002fe]--,_0x2002fe++;}_0x66f5f0(_0x1d5021)[_0xc7a3e1(0x2c8)](_0xc7a3e1(0x336))[_0xc7a3e1(0x2ef)]((_0x4f1774,_0x26c7b1)=>{const _0x35b042=_0xc7a3e1;let _0x1d04da=_0x66f5f0(_0x26c7b1)['text']()[_0x35b042(0x2ce)](),_0x2f5bb4=parseFloat(_0x1d04da[_0x35b042(0x2c4)](/,/g,'')),_0x16fa45={};!isNaN(_0x2f5bb4)?(_0x16fa45['v']=_0x2f5bb4,_0x16fa45['t']='n'):(_0x16fa45['v']=_0x1d04da,_0x16fa45['t']='s');const _0x5bd8be=_0x66f5f0(_0x26c7b1)[_0x35b042(0x256)](_0x35b042(0x242)),_0x4b05ca=_0x528c64(_0x5bd8be);_0x16fa45['s']={'border':_0x4b05ca},_0x4b0949[_0x2002fe]=_0x16fa45;let _0x559783=parseInt(_0x66f5f0(_0x26c7b1)[_0x35b042(0x256)](_0x35b042(0x29b)))||0x1,_0x2667f2=parseInt(_0x66f5f0(_0x26c7b1)[_0x35b042(0x256)](_0x35b042(0x259)))||0x1;(_0x559783>0x1||_0x2667f2>0x1)&&_0x5eb4cb['push']({'s':{'r':_0x5f3e31,'c':_0x2002fe},'e':{'r':_0x5f3e31+_0x2667f2-0x1,'c':_0x2002fe+_0x559783-0x1}});for(let _0x1141de=0x0;_0x1141de<_0x559783;_0x1141de++){_0x2667f2>0x1&&(_0x1f2974[_0x2002fe+_0x1141de]=_0x2667f2-0x1);}_0x2002fe+=_0x559783;}),_0x48d412[_0xc7a3e1(0x258)](_0x4b0949);});const _0x291dce=XLSX[_0x286693(0x33f)][_0x286693(0x23d)](),_0x5a254b=XLSX[_0x286693(0x33f)][_0x286693(0x24b)](_0x48d412);_0x5eb4cb['length']>0x0&&(_0x5a254b[_0x286693(0x27e)]=_0x5eb4cb);_0x5a254b['!cols']=_0x48d412[0x0][_0x286693(0x266)](()=>({'wpx':0x64})),XLSX[_0x286693(0x33f)][_0x286693(0x244)](_0x291dce,_0x5a254b,_0x286693(0x1f7));const _0x1987d5=XLSX[_0x286693(0x35a)](_0x291dce,{'bookType':_0x286693(0x312),'type':_0x286693(0x2f1)});_0x36c0b8['setHeader'](_0x286693(0x273),_0x286693(0x29d)),_0x36c0b8[_0x286693(0x365)]('Content-Type',_0x286693(0x299)),_0x36c0b8[_0x286693(0x281)](_0x1987d5);}else pdf[_0x286693(0x27d)](_0x3900f4,_0x5514ee)[_0x286693(0x222)](function(_0x1e977b,_0x74a43){const _0x515210=_0x286693;if(_0x1e977b){_0x36c0b8['status'](0x1f4)[_0x515210(0x281)](_0x515210(0x28f));return;}_0x36c0b8[_0x515210(0x365)](_0x515210(0x2f4),'application/pdf'),_0x74a43['pipe'](_0x36c0b8);});}catch(_0x5a56e6){}}),router['get'](a0_0x58d2d0(0x221),auth,async(_0x80109a,_0x2ab791)=>{const _0x1c7230=a0_0x58d2d0;try{const {username:_0x77f3b3,email:_0x301f17,role:_0x5e9700}=_0x80109a[_0x1c7230(0x332)],_0x228da3=_0x80109a[_0x1c7230(0x332)],_0x29bb2b=await profile['findOne']({'email':_0x228da3[_0x1c7230(0x2c7)]}),_0x2132cf={'year':_0x1c7230(0x22f),'month':_0x1c7230(0x26a),'day':_0x1c7230(0x22f)},_0x1b1e59=await master_shop['find'](),_0x3c560e=await product['find'](),_0x4ce3ed=await warehouse[_0x1c7230(0x2cf)]([{'$unwind':_0x1c7230(0x200)},{'$lookup':{'from':'products','localField':'product_details.product_name','foreignField':'name','as':_0x1c7230(0x29e)}},{'$unwind':_0x1c7230(0x2ed)},{'$project':{'product_name':_0x1c7230(0x354),'product_stock':_0x1c7230(0x2b0)}},{'$group':{'_id':_0x1c7230(0x31b),'product_stock':{'$sum':_0x1c7230(0x320)}}}]);if(_0x1b1e59[0x0][_0x1c7230(0x2d5)]==_0x1c7230(0x34c))var _0x1d053e=users[_0x1c7230(0x23c)];else{if(_0x1b1e59[0x0]['language']==_0x1c7230(0x277))var _0x1d053e=users['Hindi'];else{if(_0x1b1e59[0x0][_0x1c7230(0x2d5)]==_0x1c7230(0x331))var _0x1d053e=users[_0x1c7230(0x331)];else{if(_0x1b1e59[0x0][_0x1c7230(0x2d5)]=='Spanish')var _0x1d053e=users[_0x1c7230(0x2b5)];else{if(_0x1b1e59[0x0][_0x1c7230(0x2d5)]==_0x1c7230(0x1e8))var _0x1d053e=users[_0x1c7230(0x1e8)];else{if(_0x1b1e59[0x0][_0x1c7230(0x2d5)]==_0x1c7230(0x316))var _0x1d053e=users[_0x1c7230(0x1ee)];else{if(_0x1b1e59[0x0]['language']==_0x1c7230(0x2bf))var _0x1d053e=users[_0x1c7230(0x2bf)];else{if(_0x1b1e59[0x0][_0x1c7230(0x2d5)]==_0x1c7230(0x2f3))var _0x1d053e=users[_0x1c7230(0x1fb)];}}}}}}}_0x2ab791[_0x1c7230(0x275)](_0x1c7230(0x34f),{'success':_0x80109a[_0x1c7230(0x1f5)]('success'),'errors':_0x80109a[_0x1c7230(0x1f5)](_0x1c7230(0x311)),'alldata':_0x3c560e,'profile':_0x29bb2b,'master_shop':_0x1b1e59,'role':_0x228da3,'product_stock':_0x4ce3ed,'language':_0x1d053e});}catch(_0x1c5f0b){}});async function dataInventoryReports(_0x48adae,_0x450794,_0x50ae38){const _0x5d8b93=a0_0x58d2d0,_0x2e52a4=await sales_sa[_0x5d8b93(0x2cf)]([{'$match':{'date':{'$gte':_0x48adae,'$lte':_0x450794},'sales_staff_id':_0x50ae38}},{'$unwind':_0x5d8b93(0x341)},{'$group':{'_id':{'product_name':_0x5d8b93(0x1f6),'product_code':_0x5d8b93(0x284)},'sumqty':{'$sum':'$sale_product.quantity'}}},{'$sort':{'_id.product_name':0x1}}]),_0x2df2db=mongoose[_0x5d8b93(0x28a)][_0x5d8b93(0x1f2)],_0x215eab=await staff[_0x5d8b93(0x2cf)]([{'$match':{'_id':_0x2df2db(_0x50ae38)}},{'$unwind':_0x5d8b93(0x21d)},{'$match':{'product_list.isConfirm':_0x5d8b93(0x30b)}},{'$group':{'_id':{'product_name':_0x5d8b93(0x220),'product_code':'$product_list.product_code'},'sumqty':{'$sum':_0x5d8b93(0x328)}}},{'$sort':{'_id.product_name':0x1}}]),_0x12af9f=await sales_inv_data[_0x5d8b93(0x2cf)]([{'$match':{'date':{'$gte':_0x48adae,'$lte':_0x450794},'sales_staff_id':_0x50ae38}},{'$unwind':_0x5d8b93(0x341)},{'$group':{'_id':{'product_name':_0x5d8b93(0x1f6),'product_code':_0x5d8b93(0x284)},'totalQTYsum':{'$sum':_0x5d8b93(0x2f0)}}}]);console[_0x5d8b93(0x2f8)](_0x12af9f);let _0x159a5b='';var _0x4fef63=0x0;for(let _0x226b60=0x0;_0x226b60<=_0x215eab[_0x5d8b93(0x34e)]-0x1;_0x226b60++){const _0x5d71af=_0x215eab[_0x226b60];_0x159a5b+=_0x5d8b93(0x253),_0x159a5b+=_0x5d8b93(0x2d1)+_0x5d71af[_0x5d8b93(0x20a)][_0x5d8b93(0x302)]+_0x5d8b93(0x24e),_0x159a5b+='<td\x20class=\x22row_data\x22\x20style=\x22width:\x20400px\x22>'+_0x5d71af[_0x5d8b93(0x20a)][_0x5d8b93(0x346)]+_0x5d8b93(0x24e);var _0x38c0c5=_0x5d71af['sumqty'],_0x395828=0x0;for(let _0x4fccf7=0x0;_0x4fccf7<=_0x2e52a4[_0x5d8b93(0x34e)]-0x1;_0x4fccf7++){const _0xaf33ef=_0x2e52a4[_0x4fccf7];_0x5d71af['_id']['product_code']==_0xaf33ef['_id']['product_code']&&_0x5d71af[_0x5d8b93(0x20a)][_0x5d8b93(0x346)]==_0xaf33ef[_0x5d8b93(0x20a)]['product_name']&&(_0x395828=_0xaf33ef['sumqty']);}var _0x335728=0x0;for(let _0x45e9f9=0x0;_0x45e9f9<=_0x12af9f['length']-0x1;_0x45e9f9++){const _0x54e855=_0x12af9f[_0x45e9f9];_0x5d71af[_0x5d8b93(0x20a)][_0x5d8b93(0x302)]==_0x54e855[_0x5d8b93(0x20a)][_0x5d8b93(0x302)]&&_0x5d71af[_0x5d8b93(0x20a)][_0x5d8b93(0x346)]==_0x54e855['_id'][_0x5d8b93(0x346)]&&(_0x335728=_0x54e855[_0x5d8b93(0x35f)]);}_0x4fef63=_0x38c0c5-_0x335728+_0x395828,_0x159a5b+=_0x5d8b93(0x2fb)+_0x4fef63+_0x5d8b93(0x24e);let _0x5ab221=![];for(let _0x2f63c8=0x0;_0x2f63c8<=_0x12af9f[_0x5d8b93(0x34e)]-0x1;_0x2f63c8++){const _0x246ce3=_0x12af9f[_0x2f63c8];if(_0x5d71af[_0x5d8b93(0x20a)][_0x5d8b93(0x302)]==_0x246ce3[_0x5d8b93(0x20a)][_0x5d8b93(0x302)]&&_0x5d71af[_0x5d8b93(0x20a)][_0x5d8b93(0x346)]==_0x246ce3[_0x5d8b93(0x20a)][_0x5d8b93(0x346)]){_0x159a5b+=_0x5d8b93(0x2fb)+_0x246ce3[_0x5d8b93(0x35f)]+_0x5d8b93(0x24e),_0x5ab221=!![];break;}}!_0x5ab221&&(_0x159a5b+=_0x5d8b93(0x34a));let _0x71aa0c=![];for(let _0x57ec31=0x0;_0x57ec31<=_0x2e52a4['length']-0x1;_0x57ec31++){const _0x40fe33=_0x2e52a4[_0x57ec31];if(_0x5d71af[_0x5d8b93(0x20a)][_0x5d8b93(0x302)]==_0x40fe33[_0x5d8b93(0x20a)][_0x5d8b93(0x302)]&&_0x5d71af[_0x5d8b93(0x20a)][_0x5d8b93(0x346)]==_0x40fe33[_0x5d8b93(0x20a)]['product_name']){_0x159a5b+=_0x5d8b93(0x2fb)+_0x40fe33[_0x5d8b93(0x228)]+'</td>',_0x71aa0c=!![];break;}}!_0x71aa0c&&(_0x159a5b+=_0x5d8b93(0x34a)),_0x159a5b+=_0x5d8b93(0x2fb)+_0x5d71af[_0x5d8b93(0x228)]+_0x5d8b93(0x24e),_0x159a5b+='</tr>';}return _0x159a5b;}router[a0_0x58d2d0(0x36f)](a0_0x58d2d0(0x314),auth,async(_0xec76e3,_0x772c3)=>{const _0x3bb50c=a0_0x58d2d0;try{const {from_date:_0x2eba2c,to_date:_0xd9e8c0}=_0xec76e3[_0x3bb50c(0x2fc)],_0xfbabda=_0xec76e3[_0x3bb50c(0x332)],_0x448022=await staff['findOne']({'email':_0xfbabda[_0x3bb50c(0x2c7)]});let _0x2822d8=_0x3bb50c(0x203);var _0x583a1b=new Date(_0x2eba2c),_0x25054d=new Date(_0xd9e8c0);const _0x33ed0e={'year':_0x3bb50c(0x22f),'month':_0x3bb50c(0x26a),'day':'numeric'},_0x50ede7=new Intl['DateTimeFormat'](_0x3bb50c(0x206),_0x33ed0e)[_0x3bb50c(0x2fa)](_0x583a1b),_0x437495=new Intl[(_0x3bb50c(0x2f5))](_0x3bb50c(0x206),_0x33ed0e)[_0x3bb50c(0x2fa)](_0x25054d);var _0x296e5f=await dataInventoryReports(_0x2eba2c,_0xd9e8c0,_0x448022[_0x3bb50c(0x20a)]['valueOf']());_0x2822d8+=_0x3bb50c(0x2d2),_0x2822d8+=_0x3bb50c(0x1ff),_0x2822d8+='<p>'+_0x50ede7+_0x3bb50c(0x2ad)+_0x437495+_0x3bb50c(0x282),_0x2822d8+=_0x3bb50c(0x2ab),_0x2822d8+='<div\x20class=\x22col-sm-11\x22>',_0x2822d8+=_0x3bb50c(0x21c),_0x2822d8+='<tr>',_0x2822d8+=_0x3bb50c(0x294),_0x2822d8+='<th>\x20ITEM\x20DESCRIPTION\x20</th>',_0x2822d8+=_0x3bb50c(0x25c),_0x2822d8+=_0x3bb50c(0x251),_0x2822d8+=_0x3bb50c(0x209),_0x2822d8+='<th>\x20ENDING\x20BALANCE\x20</th>',_0x2822d8+='<tr>',_0x2822d8+=_0x296e5f,_0x2822d8+=_0x3bb50c(0x33c),_0x2822d8+=_0x3bb50c(0x246),_0x2822d8+=_0x3bb50c(0x246);const _0x47b757={'format':_0x3bb50c(0x279),'orientation':_0x3bb50c(0x241),'childProcessOptions':{'env':{'OPENSSL_CONF':_0x3bb50c(0x30e)}}};pdf[_0x3bb50c(0x27d)](_0x2822d8,_0x47b757)[_0x3bb50c(0x222)](function(_0x435e21,_0x423017){const _0x42e5dc=_0x3bb50c;if(_0x435e21){_0x772c3[_0x42e5dc(0x2bc)](0x1f4)[_0x42e5dc(0x281)]('Error\x20generating\x20PDF');return;}_0x772c3[_0x42e5dc(0x365)](_0x42e5dc(0x2f4),_0x42e5dc(0x2b6)),_0x423017[_0x42e5dc(0x2bd)](_0x772c3);});}catch(_0x4328a8){}}),router[a0_0x58d2d0(0x24a)](a0_0x58d2d0(0x210),auth,async(_0x4936e8,_0x179a81)=>{const _0xb1627=a0_0x58d2d0;try{const {username:_0x2b493c,email:_0x5db272,role:_0x1c19b3}=_0x4936e8[_0xb1627(0x332)],_0x39726f=_0x4936e8[_0xb1627(0x332)],_0x3ab2a=await profile[_0xb1627(0x285)]({'email':_0x39726f[_0xb1627(0x2c7)]}),_0x14a841={'year':_0xb1627(0x22f),'month':_0xb1627(0x26a),'day':'numeric'},_0x9cefde=await master_shop[_0xb1627(0x2c8)]();console[_0xb1627(0x2f8)](_0xb1627(0x293),_0x9cefde);const _0x38007d=await product[_0xb1627(0x2c8)]();console[_0xb1627(0x2f8)](_0xb1627(0x28e),_0x38007d);const _0x35809d=await warehouse['aggregate']([{'$unwind':_0xb1627(0x200)},{'$lookup':{'from':_0xb1627(0x371),'localField':_0xb1627(0x35e),'foreignField':_0xb1627(0x347),'as':_0xb1627(0x29e)}},{'$unwind':_0xb1627(0x2ed)},{'$project':{'product_name':_0xb1627(0x354),'product_stock':_0xb1627(0x2b0)}},{'$group':{'_id':_0xb1627(0x31b),'product_stock':{'$sum':_0xb1627(0x320)}}}]);console[_0xb1627(0x2f8)](_0xb1627(0x205),_0x35809d),_0x35809d[_0xb1627(0x32d)](_0x5b96b0=>{const _0x4a91ee=_0xb1627,_0x3eeb7f=_0x38007d[_0x4a91ee(0x266)](_0x139695=>{const _0x2118ba=_0x4a91ee;_0x139695['name']==_0x5b96b0[_0x2118ba(0x20a)]&&(_0x139695['stock']=parseInt(_0x139695['stock'])+parseInt(_0x5b96b0['product_stock']));});});const _0x563014=await staff[_0xb1627(0x285)]({'email':_0x39726f[_0xb1627(0x2c7)]});if(_0x9cefde[0x0]['language']=='English\x20(US)')var _0x39fc72=users[_0xb1627(0x23c)];else{if(_0x9cefde[0x0][_0xb1627(0x2d5)]==_0xb1627(0x277))var _0x39fc72=users['Hindi'];else{if(_0x9cefde[0x0][_0xb1627(0x2d5)]==_0xb1627(0x331))var _0x39fc72=users[_0xb1627(0x331)];else{if(_0x9cefde[0x0][_0xb1627(0x2d5)]==_0xb1627(0x2b5))var _0x39fc72=users[_0xb1627(0x2b5)];else{if(_0x9cefde[0x0][_0xb1627(0x2d5)]==_0xb1627(0x1e8))var _0x39fc72=users[_0xb1627(0x1e8)];else{if(_0x9cefde[0x0][_0xb1627(0x2d5)]==_0xb1627(0x316))var _0x39fc72=users['Portuguese'];else{if(_0x9cefde[0x0][_0xb1627(0x2d5)]==_0xb1627(0x2bf))var _0x39fc72=users[_0xb1627(0x2bf)];else{if(_0x9cefde[0x0]['language']==_0xb1627(0x2f3))var _0x39fc72=users['Arabic'];}}}}}}}_0x179a81[_0xb1627(0x275)](_0xb1627(0x2c0),{'success':_0x4936e8['flash'](_0xb1627(0x33e)),'errors':_0x4936e8[_0xb1627(0x1f5)](_0xb1627(0x311)),'alldata':_0x38007d,'profile':_0x3ab2a,'master_shop':_0x9cefde,'role':_0x39726f,'product_stock':_0x35809d,'language':_0x39fc72,'staff_arr':_0x563014});}catch(_0x4fcbf9){}});async function agentsdataDSICheck_DSRR(_0x428314,_0x99ed16,_0x13a7a5,_0x1d45aa){const _0x2db5c7=a0_0x58d2d0;let _0xf9caa8=new Date(_0x428314);_0xf9caa8[_0x2db5c7(0x334)](_0xf9caa8[_0x2db5c7(0x2a5)]()-0x1);let _0x483b49=_0xf9caa8[_0x2db5c7(0x261)]()[_0x2db5c7(0x22a)]('T')[0x0];const _0xb7bbb5=await product[_0x2db5c7(0x2cf)]([{'$group':{'_id':{'brand':_0x2db5c7(0x342),'category':'$category'},'products':{'$push':{'name':_0x2db5c7(0x1ef),'product_code':'$product_code'}}}},{'$sort':{'_id.category':-0x1,'_id.brand':0x1}}]);var _0x5096ce=[];_0x5096ce[_0x2db5c7(0x263)]=[];for(let _0x55820a=0x0;_0x55820a<=_0xb7bbb5[_0x2db5c7(0x34e)]-0x1;_0x55820a++){const _0x116a15=_0xb7bbb5[_0x55820a];_0x5096ce[_0x2db5c7(0x263)][_0x2db5c7(0x258)](_0x116a15);}const _0xd35c83=await product[_0x2db5c7(0x2cf)]([{'$group':{'_id':{'category':_0x2db5c7(0x352)},'products':{'$push':{'brand':_0x2db5c7(0x342),'product_code':'$product_code','product_name':_0x2db5c7(0x1ef)}}}},{'$sort':{'_id.category':-0x1}}]),_0x25d6f9=await product[_0x2db5c7(0x2cf)]([{'$group':{'_id':{'category':'$category','brand':_0x2db5c7(0x342)}}},{'$group':{'_id':'$_id.category','brandCount':{'$sum':0x1}}},{'$sort':{'_id':-0x1}}]),_0xf4b5c3=await sales_sa['aggregate']([{'$match':{'date':_0x428314,'sales_staff_id':_0x99ed16,'sale_product.isFG':_0x2db5c7(0x296)}},{'$unwind':'$sale_product'},{'$lookup':{'from':_0x2db5c7(0x371),'localField':_0x2db5c7(0x2a6),'foreignField':'product_code','as':_0x2db5c7(0x1f4)}},{'$unwind':_0x2db5c7(0x31e)},{'$group':{'_id':{'dsi':'$dsi','date':_0x2db5c7(0x2c1),'customer':_0x2db5c7(0x20c),'status_data':_0x2db5c7(0x213)},'totalQty':{'$sum':_0x2db5c7(0x24c)},'cash':{'$first':_0x2db5c7(0x23e)},'amount':{'$first':'$amount'},'bank':{'$first':_0x2db5c7(0x292)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x2db5c7(0x289)},'products':{'$push':{'qty':'$sale_product.real_qty_unit_val','NetPrice':'$sale_product.totalprice','discount':_0x2db5c7(0x25b),'adj_discount':_0x2db5c7(0x1f0),'product_details':{'prod_name':_0x2db5c7(0x35b),'product_code':'$product_info.product_code','category':_0x2db5c7(0x1e2),'brand':_0x2db5c7(0x2ae),'gross_price':_0x2db5c7(0x211),'isFG':_0x2db5c7(0x21a),'prod_cat':'$sale_product.prod_cat','prod_id':_0x2db5c7(0x21f)}}}}},{'$unwind':_0x2db5c7(0x2d0)},{'$group':{'_id':{'dsi':_0x2db5c7(0x225),'date':_0x2db5c7(0x298),'customer':_0x2db5c7(0x25f),'status_data':'$_id.status_data','category':_0x2db5c7(0x255),'brand':_0x2db5c7(0x238),'prod_id':'$products.product_details.prod_id'},'totalQty':{'$sum':'$products.qty'},'totalGross':{'$sum':{'$multiply':[_0x2db5c7(0x2f9),_0x2db5c7(0x303)]}},'NetPrice':{'$sum':_0x2db5c7(0x1e7)},'discount':{'$sum':_0x2db5c7(0x201)},'adj_discount':{'$sum':_0x2db5c7(0x236)},'cash':{'$first':_0x2db5c7(0x23e)},'amount':{'$first':'$amount'},'bank':{'$first':_0x2db5c7(0x292)},'check_no':{'$first':_0x2db5c7(0x267)},'due_date':{'$first':_0x2db5c7(0x289)},'product_details':{'$first':_0x2db5c7(0x215)}}},{'$group':{'_id':{'dsi':'$_id.dsi','date':'$_id.date','customer':_0x2db5c7(0x25f),'status_data':_0x2db5c7(0x2b7)},'totalQty':{'$sum':_0x2db5c7(0x1fc)},'totalGross':{'$sum':_0x2db5c7(0x217)},'NetPrice':{'$sum':_0x2db5c7(0x318)},'discount':{'$sum':_0x2db5c7(0x355)},'adj_discount':{'$sum':_0x2db5c7(0x230)},'cash':{'$first':'$cash'},'amount':{'$first':_0x2db5c7(0x268)},'bank':{'$first':_0x2db5c7(0x292)},'check_no':{'$first':_0x2db5c7(0x267)},'due_date':{'$first':_0x2db5c7(0x289)},'products':{'$push':{'qty':_0x2db5c7(0x1fc),'category':_0x2db5c7(0x364),'brand':_0x2db5c7(0x324),'product_details':_0x2db5c7(0x200)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x1afd76=await sales_sa[_0x2db5c7(0x2cf)]([{'$match':{'date':_0x483b49,'sales_staff_id':_0x99ed16,'sale_product.isFG':'false'}},{'$unwind':_0x2db5c7(0x341)},{'$lookup':{'from':'products','localField':_0x2db5c7(0x2a6),'foreignField':'product_code','as':_0x2db5c7(0x1f4)}},{'$unwind':_0x2db5c7(0x31e)},{'$group':{'_id':{'dsi':'$dsi','date':_0x2db5c7(0x2c1),'customer':_0x2db5c7(0x20c)},'totalQty':{'$sum':_0x2db5c7(0x24c)},'cash':{'$first':'$cash'},'amount':{'$first':_0x2db5c7(0x268)},'bank':{'$first':'$bank'},'check_no':{'$first':_0x2db5c7(0x267)},'due_date':{'$first':_0x2db5c7(0x289)},'products':{'$push':{'qty':_0x2db5c7(0x24c),'NetPrice':_0x2db5c7(0x32a),'discount':_0x2db5c7(0x25b),'adj_discount':_0x2db5c7(0x1f0),'product_details':{'prod_name':'$product_info.name','product_code':_0x2db5c7(0x2a0),'category':_0x2db5c7(0x1e2),'brand':_0x2db5c7(0x2ae),'gross_price':_0x2db5c7(0x211),'isFG':_0x2db5c7(0x21a),'prod_cat':_0x2db5c7(0x1f9),'prod_id':'$sale_product._id'}}}}},{'$unwind':'$products'},{'$group':{'_id':{'dsi':_0x2db5c7(0x225),'date':_0x2db5c7(0x298),'customer':_0x2db5c7(0x25f),'category':_0x2db5c7(0x255),'brand':'$products.product_details.brand','prod_id':_0x2db5c7(0x264)},'totalQty':{'$sum':_0x2db5c7(0x2f9)},'cash':{'$first':_0x2db5c7(0x23e)},'amount':{'$first':_0x2db5c7(0x268)},'bank':{'$first':_0x2db5c7(0x292)},'check_no':{'$first':_0x2db5c7(0x267)},'due_date':{'$first':_0x2db5c7(0x289)},'totalGross':{'$sum':{'$multiply':[_0x2db5c7(0x2f9),'$products.product_details.gross_price']}},'NetPrice':{'$sum':'$products.NetPrice'},'discount':{'$sum':_0x2db5c7(0x201)},'adj_discount':{'$sum':_0x2db5c7(0x236)},'product_details':{'$first':_0x2db5c7(0x215)}}},{'$group':{'_id':{'dsi':_0x2db5c7(0x225),'date':_0x2db5c7(0x298),'customer':'$_id.customer'},'totalQty':{'$sum':_0x2db5c7(0x1fc)},'cash':{'$first':_0x2db5c7(0x23e)},'amount':{'$first':_0x2db5c7(0x268)},'bank':{'$first':_0x2db5c7(0x292)},'check_no':{'$first':'$check_no'},'due_date':{'$first':_0x2db5c7(0x289)},'totalGross':{'$sum':_0x2db5c7(0x217)},'NetPrice':{'$sum':'$NetPrice'},'discount':{'$sum':_0x2db5c7(0x355)},'adj_discount':{'$sum':'$adj_discount'},'products':{'$push':{'qty':_0x2db5c7(0x1fc),'category':_0x2db5c7(0x364),'brand':_0x2db5c7(0x324),'product_details':_0x2db5c7(0x200)}}}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x2143c0=await sales_sa[_0x2db5c7(0x2cf)]([{'$match':{'date':_0x428314,'sales_staff_id':_0x99ed16,'status_data':_0x2db5c7(0x30b)}},{'$sort':{'_id.dsi':-0x1,'_id.date':0x1}}]),_0x4e1a85=await staff[_0x2db5c7(0x2be)](_0x99ed16);let _0x266a75=[],_0x2e4311={},_0x36bddc={};var _0x3763f2=0x0,_0xc3549b=0x0,_0x429977=0x0,_0x5f41a4=0x0,_0x38577c=0x0;const _0x5361cb=0x6;var _0x1939dd=0x0,_0x32cf14=0x0;for(let _0xe17add=0x0;_0xe17add<=_0xf4b5c3[_0x2db5c7(0x34e)]-0x1;_0xe17add++){const _0x2657ea=_0xf4b5c3[_0xe17add];let _0x478511=_0x2db5c7(0x253);_0x478511+=_0x2db5c7(0x366),_0x478511+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2657ea[_0x2db5c7(0x20a)][_0x2db5c7(0x358)]+_0x2db5c7(0x24e),_0x478511+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2657ea[_0x2db5c7(0x20a)][_0x2db5c7(0x260)]+_0x2db5c7(0x24e);let _0x5793af={},_0x80fbae={},_0x2f6877={};var _0x51e5e5={},_0x2999fd={},_0x1e0bbd={},_0xdca13f=0x0;for(let _0x67afc5=0x0;_0x67afc5<=_0x2657ea['products']['length']-0x1;_0x67afc5++){const _0x5e0b53=_0x2657ea['products'][_0x67afc5];_0x5793af[_0x5e0b53[_0x2db5c7(0x2d8)]+'-'+_0x5e0b53[_0x2db5c7(0x319)]]=_0x5e0b53['qty'],_0x80fbae[[_0x5e0b53[_0x2db5c7(0x2d8)]+'-'+_0x5e0b53['category']]]=_0x5e0b53[_0x2db5c7(0x214)][_0x2db5c7(0x327)],_0x2f6877[[_0x5e0b53[_0x2db5c7(0x2d8)]+'-'+_0x5e0b53[_0x2db5c7(0x319)]]]=_0x5e0b53[_0x2db5c7(0x214)]['prod_cat'];const _0x2167b4=_0x5e0b53[_0x2db5c7(0x2d8)]+'-'+_0x5e0b53[_0x2db5c7(0x319)];!Array['isArray'](_0x36bddc[_0x2167b4])&&(_0x36bddc[_0x2167b4]=[]);!Array['isArray'](_0x36bddc[_0x2167b4])&&(_0x36bddc[_0x2167b4]=[]);_0x36bddc[_0x2167b4][_0x2db5c7(0x258)](_0x5e0b53[_0x2db5c7(0x280)]);if(_0x5e0b53['product_details'][_0x2db5c7(0x30a)]=='P')_0x5e0b53[_0x2db5c7(0x214)]['isFG']==_0x2db5c7(0x30b)?(!_0x1e0bbd[_0x2167b4]&&(_0x1e0bbd[_0x2167b4]=0x0),_0x1e0bbd[_0x2167b4]=_0x5e0b53[_0x2db5c7(0x280)]):(!_0x51e5e5[_0x2167b4]&&(_0x51e5e5[_0x2167b4]=0x0),_0x51e5e5[_0x2167b4]=_0x5e0b53[_0x2db5c7(0x280)]);else _0x5e0b53['product_details'][_0x2db5c7(0x30a)]=='S'&&(_0x5e0b53[_0x2db5c7(0x214)][_0x2db5c7(0x327)]==_0x2db5c7(0x30b)?(!_0x1e0bbd[_0x2167b4]&&(_0x1e0bbd[_0x2167b4]=0x0),_0x1e0bbd[_0x2167b4]=_0x5e0b53[_0x2db5c7(0x280)]):(!_0x2999fd[_0x2167b4]&&(_0x2999fd[_0x2167b4]=0x0),_0x2999fd[_0x2167b4]=_0x5e0b53['qty']));_0xdca13f++;}for(let _0xde7331=0x0;_0xde7331<=_0x5096ce[_0x2db5c7(0x263)][_0x2db5c7(0x34e)]-0x1;_0xde7331++){const _0x504a5a=_0x5096ce[_0x2db5c7(0x263)][_0xde7331],_0x5e9879=_0x504a5a[_0x2db5c7(0x20a)][_0x2db5c7(0x2d8)]+'-'+_0x504a5a[_0x2db5c7(0x20a)]['category'],_0x38fd60=_0x2f6877[_0x5e9879]!==undefined?_0x2f6877[_0x5e9879]:'NA';var _0x5d34c9=_0x51e5e5[_0x5e9879]!==undefined?_0x51e5e5[_0x5e9879][_0x2db5c7(0x25a)](0x2):'',_0x30661a=_0x2999fd[_0x5e9879]!==undefined?_0x2999fd[_0x5e9879][_0x2db5c7(0x25a)](0x2):'',_0x22be7b=_0x1e0bbd[_0x5e9879]!==undefined?_0x1e0bbd[_0x5e9879][_0x2db5c7(0x25a)](0x2):'';_0x478511+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x5d34c9+_0x2db5c7(0x24e),_0x478511+=_0x2db5c7(0x2ee)+_0x30661a+_0x2db5c7(0x24e),_0x478511+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22>'+_0x22be7b+'</td>';}var _0x28f375=formatNumber(parseFloat(_0x2657ea[_0x2db5c7(0x21e)])),_0x2f77ba=formatNumber(parseFloat(_0x2657ea['amount']));isNaN(_0x2f77ba)&&(_0x2f77ba=0x0),_0x478511+=_0x2db5c7(0x2ee)+_0x28f375+_0x2db5c7(0x24e),_0x478511+=_0x2db5c7(0x2ee)+_0x2f77ba+_0x2db5c7(0x24e),_0x478511+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22>'+_0x2657ea[_0x2db5c7(0x359)]+'</td>',_0x478511+=_0x2db5c7(0x313)+_0x2657ea[_0x2db5c7(0x297)]+_0x2db5c7(0x24e),_0x478511+=_0x2db5c7(0x313)+_0x2657ea['due_date']+'</td>',_0x429977=_0x2657ea['discount']+_0x2657ea[_0x2db5c7(0x340)],_0x1939dd+=parseFloat(_0x2657ea[_0x2db5c7(0x21e)]),_0x32cf14+=parseFloat(_0x2f77ba),_0x266a75[_0x2db5c7(0x258)](_0x478511);}if(_0x2143c0['length']>0x0)for(let _0x2d50f5=0x0;_0x2d50f5<=_0x2143c0[_0x2db5c7(0x34e)]-0x1;_0x2d50f5++){const _0x2040f8=_0x2143c0[_0x2d50f5];console[_0x2db5c7(0x2f8)](_0x2040f8);let _0xec824a='<tr>';_0xec824a+=_0x2db5c7(0x27c)+(0x8+0x7*0x3)+_0x2db5c7(0x2a3)+_0x2040f8[_0x2db5c7(0x350)]+'</b></td>',_0xec824a+='</tr>',_0x266a75[_0x2db5c7(0x258)](_0xec824a);}function _0x5f3bad(_0x4ac624,_0x32fffa){const _0x1e6934=_0x2db5c7,_0x251265=[];for(let _0x3e4f41=0x0;_0x3e4f41<=_0x4ac624['length']-0x1;_0x3e4f41+=_0x32fffa){_0x251265[_0x1e6934(0x258)](_0x4ac624[_0x1e6934(0x356)](_0x3e4f41,_0x3e4f41+_0x32fffa));}return _0x251265;}const _0x49d7c0=_0x5f3bad(_0x266a75,_0x5361cb);let _0x288e4d='';return _0x49d7c0['forEach']((_0x44a19f,_0x4c418b)=>{const _0x220a72=_0x2db5c7;_0x4c418b>0x0&&(_0x288e4d+=_0x220a72(0x239));_0x288e4d+=_0x220a72(0x21c),_0x288e4d+=_0x220a72(0x2ff);const _0x2a5d6b=new Date(_0x428314),_0x51129d={'year':_0x220a72(0x22f),'month':_0x220a72(0x26a),'day':_0x220a72(0x22f),'timeZone':_0x220a72(0x254)},_0xc183de=_0x2a5d6b[_0x220a72(0x24d)](_0x220a72(0x206),_0x51129d);_0x288e4d+='<tr>',_0x288e4d+=_0x220a72(0x270)+_0x1d45aa+_0x220a72(0x26b),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+='<td\x20colspan=\x225.5\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>NAME:</b>\x20\x20'+_0x4e1a85['name']+_0x220a72(0x24e),_0x288e4d+='<td\x20colspan=\x226\x22\x20class=\x22cat_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20><b>DISTRICT\x20NO:\x20</b></td>',_0x288e4d+=_0x220a72(0x2d4),_0x288e4d+=_0x220a72(0x329),_0x288e4d+='<td\x20colspan=\x221\x22\x20rowspan=\x221\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22\x20></td>',_0x288e4d+=_0x220a72(0x1f1),_0x288e4d+=_0x220a72(0x32f),_0x288e4d+=_0x220a72(0x271),_0x288e4d+=_0x220a72(0x305),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x368),_0x288e4d+=_0x220a72(0x335)+_0xc183de+_0x220a72(0x24e),_0x288e4d+=_0x220a72(0x360),_0x288e4d+=_0x220a72(0x1ed),_0x288e4d+=_0x220a72(0x308),_0x288e4d+=_0x220a72(0x308),_0x288e4d+='</tr>',_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x2f6),_0x288e4d+=_0x220a72(0x315),_0x288e4d+=_0x220a72(0x2a9),_0x288e4d+=_0x220a72(0x308),_0x288e4d+=_0x220a72(0x308),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+='<td\x20height=\x2220px\x22\x20colspan=\x2229\x22\x20class=\x22cat_data\x22\x20style=\x22width:100px\x22><b></b></td>',_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x30f),_0x288e4d+=_0x220a72(0x247),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x25d),_0x288e4d+='<td\x20colspan=\x221\x22\x20class=\x22cat_data\x22\x20style=\x22width:200px\x22><b>CUSTOMER\x20ADDRESS</b></td>',_0x288e4d+=_0x220a72(0x2c2);for(let _0x127bad=0x0;_0x127bad<=_0xd35c83[_0x220a72(0x34e)]-0x1;_0x127bad++){const _0x5045e5=_0xd35c83[_0x127bad];for(let _0x30064d=0x0;_0x30064d<_0x5096ce[_0x220a72(0x263)][_0x220a72(0x34e)];_0x30064d++){const _0x1ef11b=_0x5096ce[_0x220a72(0x263)][_0x30064d];if(_0x1ef11b[_0x220a72(0x20a)][_0x220a72(0x319)]===_0x5045e5[_0x220a72(0x20a)][_0x220a72(0x319)]){var _0x1f5826='';switch(_0x5045e5[_0x220a72(0x20a)][_0x220a72(0x319)]){case'Standard':_0x1f5826=_0x1ef11b[_0x220a72(0x20a)][_0x220a72(0x2d8)]+_0x220a72(0x29f);break;case _0x220a72(0x36d):_0x1f5826=_0x1ef11b[_0x220a72(0x20a)]['brand']+_0x220a72(0x2df);break;default:_0x1f5826=_0x1ef11b[_0x220a72(0x20a)][_0x220a72(0x2d8)];break;}_0x288e4d+=_0x220a72(0x2b1)+_0x1f5826+'</b></td>';}}}_0x288e4d+='<td\x20colspan=\x221\x22\x20rowspan=\x222\x22\x20class=\x22cat_data\x22><b>CASH</b></td>',_0x288e4d+=_0x220a72(0x309),_0x288e4d+=_0x220a72(0x2eb),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+='<td\x20class=\x22cat_data\x22\x20colspan=\x223\x22></td>';for(let _0x4e7dda=0x0;_0x4e7dda<=_0x5096ce[_0x220a72(0x263)][_0x220a72(0x34e)]-0x1;_0x4e7dda++){const _0x2c187b=_0x5096ce[_0x4e7dda];_0x288e4d+=_0x220a72(0x207),_0x288e4d+=_0x220a72(0x326),_0x288e4d+=_0x220a72(0x226);}_0x288e4d+='<td\x20class=\x22cat_data\x22\x20colspan=\x221\x22><b>BANK</b></td>',_0x288e4d+=_0x220a72(0x287),_0x288e4d+=_0x220a72(0x223),_0x288e4d+='</tr>',_0x288e4d+=_0x220a72(0x36b),_0x288e4d+='<tbody>',_0x44a19f[_0x220a72(0x32d)](_0x966841=>{_0x288e4d+=_0x966841;});let _0x5e7795={},_0x36bcfd={},_0x57b6ec={};for(let _0x18fd6f=0x0;_0x18fd6f<=_0xf4b5c3[_0x220a72(0x34e)]-0x1;_0x18fd6f++){const _0x5671fa=_0xf4b5c3[_0x18fd6f];var _0x54c59e=0x0;for(let _0x20ebe2=0x0;_0x20ebe2<=_0x5671fa[_0x220a72(0x371)][_0x220a72(0x34e)]-0x1;_0x20ebe2++){const _0x2b28ad=_0x5671fa[_0x220a72(0x371)][_0x20ebe2],_0x5dce9c=_0x2b28ad[_0x220a72(0x2d8)]+'-'+_0x2b28ad[_0x220a72(0x319)];if(_0x2b28ad[_0x220a72(0x214)][_0x220a72(0x30a)]=='P')_0x2b28ad['product_details']['isFG']=='true'?(!_0x57b6ec[_0x5dce9c]&&(_0x57b6ec[_0x5dce9c]=0x0),_0x57b6ec[_0x5dce9c]+=_0x2b28ad[_0x220a72(0x280)]):(!_0x5e7795[_0x5dce9c]&&(_0x5e7795[_0x5dce9c]=0x0),_0x5e7795[_0x5dce9c]+=_0x2b28ad[_0x220a72(0x280)]);else _0x2b28ad[_0x220a72(0x214)][_0x220a72(0x30a)]=='S'&&(_0x2b28ad[_0x220a72(0x214)][_0x220a72(0x327)]=='true'?(!_0x57b6ec[_0x5dce9c]&&(_0x57b6ec[_0x5dce9c]=0x0),_0x57b6ec[_0x5dce9c]+=_0x2b28ad['qty'],console[_0x220a72(0x2f8)](_0x2b28ad[_0x220a72(0x280)])):(!_0x36bcfd[_0x5dce9c]&&(_0x36bcfd[_0x5dce9c]=0x0),_0x36bcfd[_0x5dce9c]+=_0x2b28ad[_0x220a72(0x280)]));_0x54c59e++;}}let _0x282e6e={},_0x6a93e3={},_0x3948a0={};var _0x554a89=0x0,_0x3d8e7e=0x0;for(let _0x1ffe60=0x0;_0x1ffe60<=_0x1afd76['length']-0x1;_0x1ffe60++){const _0x380655=_0x1afd76[_0x1ffe60];var _0x54c59e=0x0;for(let _0xe4c564=0x0;_0xe4c564<=_0x380655['products'][_0x220a72(0x34e)]-0x1;_0xe4c564++){const _0x3dc1a8=_0x380655['products'][_0xe4c564],_0xc07ce5=_0x3dc1a8['brand']+'-'+_0x3dc1a8['category'];if(_0x3dc1a8['product_details'][_0x220a72(0x30a)]=='P')_0x3dc1a8['product_details'][_0x220a72(0x327)]==_0x220a72(0x30b)?(!_0x3948a0[_0xc07ce5]&&(_0x3948a0[_0xc07ce5]=0x0),_0x3948a0[_0xc07ce5]+=_0x3dc1a8[_0x220a72(0x280)]):(!_0x282e6e[_0xc07ce5]&&(_0x282e6e[_0xc07ce5]=0x0),_0x282e6e[_0xc07ce5]+=_0x3dc1a8['qty']);else _0x3dc1a8[_0x220a72(0x214)][_0x220a72(0x30a)]=='S'&&(_0x3dc1a8['product_details'][_0x220a72(0x327)]=='true'?(!_0x3948a0[_0xc07ce5]&&(_0x3948a0[_0xc07ce5]=0x0),_0x3948a0[_0xc07ce5]+=_0x3dc1a8[_0x220a72(0x280)]):(!_0x6a93e3[_0xc07ce5]&&(_0x6a93e3[_0xc07ce5]=0x0),_0x6a93e3[_0xc07ce5]+=_0x3dc1a8['qty']));_0x54c59e++;}var _0x295b65=parseFloat(_0x380655[_0x220a72(0x21e)]),_0x5dbd5c=parseFloat(_0x380655[_0x220a72(0x2e8)]);isNaN(_0x5dbd5c)&&(_0x5dbd5c=0x0),_0x554a89+=_0x295b65,_0x3d8e7e+=_0x5dbd5c;}_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x31d),_0x288e4d+=_0x220a72(0x202),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>';for(let _0x2717ef=0x0;_0x2717ef<=_0x5096ce[_0x220a72(0x263)]['length']-0x1;_0x2717ef++){const _0x19178e=_0x5096ce[_0x220a72(0x263)][_0x2717ef],_0x35fedf=_0x19178e[_0x220a72(0x20a)][_0x220a72(0x2d8)]+'-'+_0x19178e[_0x220a72(0x20a)]['category'];var _0x1f15a6=_0x5e7795[_0x35fedf]!==undefined?formatNumber(_0x5e7795[_0x35fedf][_0x220a72(0x25a)](0x2)):'',_0x5ad25f=_0x57b6ec[_0x35fedf]!==undefined?formatNumber(_0x57b6ec[_0x35fedf][_0x220a72(0x25a)](0x2)):'',_0x276312=_0x36bcfd[_0x35fedf]!==undefined?formatNumber(_0x36bcfd[_0x35fedf][_0x220a72(0x25a)](0x2)):'';_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1f15a6+_0x220a72(0x26b),_0x288e4d+=_0x220a72(0x2af)+_0x276312+_0x220a72(0x26b),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x5ad25f+_0x220a72(0x26b);}_0x288e4d+=_0x220a72(0x2af)+formatNumber(_0x1939dd)+_0x220a72(0x26b),_0x288e4d+=_0x220a72(0x2af)+formatNumber(_0x32cf14)+_0x220a72(0x26b),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x31d),_0x288e4d+=_0x220a72(0x31f),_0x288e4d+=_0x220a72(0x366);for(let _0x1c2ae7=0x0;_0x1c2ae7<=_0x5096ce[_0x220a72(0x263)][_0x220a72(0x34e)]-0x1;_0x1c2ae7++){const _0x5306ee=_0x5096ce[_0x220a72(0x263)][_0x1c2ae7],_0xed09b4=_0x5306ee[_0x220a72(0x20a)]['brand']+'-'+_0x5306ee[_0x220a72(0x20a)][_0x220a72(0x319)];var _0x1f15a6=_0x282e6e[_0xed09b4]!==undefined?formatNumber(_0x282e6e[_0xed09b4][_0x220a72(0x25a)](0x2)):'',_0x5ad25f=_0x3948a0[_0xed09b4]!==undefined?formatNumber(_0x3948a0[_0xed09b4][_0x220a72(0x25a)](0x2)):'',_0x276312=_0x6a93e3[_0xed09b4]!==undefined?formatNumber(_0x6a93e3[_0xed09b4][_0x220a72(0x25a)](0x2)):'';_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x1f15a6+'</b></td>',_0x288e4d+=_0x220a72(0x2af)+_0x276312+_0x220a72(0x26b),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+_0x5ad25f+_0x220a72(0x26b);}_0x288e4d+=_0x220a72(0x2af)+formatNumber(_0x554a89)+_0x220a72(0x26b),_0x288e4d+=_0x220a72(0x2af)+formatNumber(_0x3d8e7e)+'</b></td>',_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x31d),_0x288e4d+=_0x220a72(0x2db),_0x288e4d+=_0x220a72(0x366);let _0x4a9f58=0x0,_0x2fcf5c=0x0,_0x54fe40=0x0;for(let _0x5b62f9=0x0;_0x5b62f9<=_0x5096ce[_0x220a72(0x263)][_0x220a72(0x34e)]-0x1;_0x5b62f9++){const _0x4f967a=_0x5096ce[_0x220a72(0x263)][_0x5b62f9],_0x8ff139=_0x4f967a[_0x220a72(0x20a)][_0x220a72(0x2d8)]+'-'+_0x4f967a[_0x220a72(0x20a)]['category'];var _0x21bbf5=_0x5e7795[_0x8ff139]!==undefined?_0x5e7795[_0x8ff139][_0x220a72(0x25a)](0x2):'0',_0x39d280=_0x57b6ec[_0x8ff139]!==undefined?_0x57b6ec[_0x8ff139]['toFixed'](0x2):'0',_0x649f4d=_0x36bcfd[_0x8ff139]!==undefined?_0x36bcfd[_0x8ff139]['toFixed'](0x2):'0',_0xa70b6f=_0x282e6e[_0x8ff139]!==undefined?_0x282e6e[_0x8ff139][_0x220a72(0x25a)](0x2):'0',_0x22def9=_0x3948a0[_0x8ff139]!==undefined?_0x3948a0[_0x8ff139][_0x220a72(0x25a)](0x2):'0',_0x412f6c=_0x6a93e3[_0x8ff139]!==undefined?_0x6a93e3[_0x8ff139][_0x220a72(0x25a)](0x2):'0';_0x4a9f58=parseFloat(_0x21bbf5)+parseFloat(_0xa70b6f),_0x2fcf5c=parseFloat(_0x649f4d)+parseFloat(_0x412f6c),_0x54fe40=parseFloat(_0x39d280)+parseFloat(_0x22def9),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b>'+formatNumber(_0x4a9f58[_0x220a72(0x25a)](0x2))+_0x220a72(0x26b),_0x288e4d+=_0x220a72(0x2af)+formatNumber(_0x2fcf5c[_0x220a72(0x25a)](0x2))+_0x220a72(0x26b),_0x288e4d+=_0x220a72(0x2af)+formatNumber(_0x54fe40[_0x220a72(0x25a)](0x2))+_0x220a72(0x26b);}var _0x2c271e=formatNumber(_0x1939dd+_0x554a89),_0x2a17a1=formatNumber(_0x32cf14+_0x3d8e7e);_0x288e4d+=_0x220a72(0x2af)+_0x2c271e+_0x220a72(0x26b),_0x288e4d+=_0x220a72(0x2af)+_0x2a17a1+_0x220a72(0x26b),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x363)+(_0x5096ce[_0x220a72(0x263)][_0x220a72(0x34e)]*0x3+0x9)+_0x220a72(0x367),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+='<tr>',_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>BEGINNING\x20INVENTORY</b></td>',_0x288e4d+=_0x220a72(0x366);for(let _0x4a52e9=0x0;_0x4a52e9<=_0x5096ce['cat_brand'][_0x220a72(0x34e)]-0x1;_0x4a52e9++){const _0x45a630=_0x5096ce[_0x220a72(0x263)][_0x4a52e9],_0x572c6c=_0x45a630['_id'][_0x220a72(0x2d8)]+'-'+_0x45a630[_0x220a72(0x20a)][_0x220a72(0x319)];var _0x21bbf5=_0x5e7795[_0x572c6c]!==undefined?_0x5e7795[_0x572c6c][_0x220a72(0x25a)](0x2):'0',_0x39d280=_0x57b6ec[_0x572c6c]!==undefined?_0x57b6ec[_0x572c6c][_0x220a72(0x25a)](0x2):'0',_0x649f4d=_0x36bcfd[_0x572c6c]!==undefined?_0x36bcfd[_0x572c6c][_0x220a72(0x25a)](0x2):'0',_0xa70b6f=_0x282e6e[_0x572c6c]!==undefined?_0x282e6e[_0x572c6c][_0x220a72(0x25a)](0x2):'0',_0x22def9=_0x3948a0[_0x572c6c]!==undefined?_0x3948a0[_0x572c6c]['toFixed'](0x2):'0',_0x412f6c=_0x6a93e3[_0x572c6c]!==undefined?_0x6a93e3[_0x572c6c][_0x220a72(0x25a)](0x2):'0';_0x4a9f58=parseFloat(_0x21bbf5)+parseFloat(_0xa70b6f),_0x2fcf5c=parseFloat(_0x649f4d)+parseFloat(_0x412f6c),_0x54fe40=parseFloat(_0x39d280)+parseFloat(_0x22def9),_0x288e4d+=_0x220a72(0x1fe),_0x288e4d+=_0x220a72(0x1fe),_0x288e4d+=_0x220a72(0x1fe);}_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x31d),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ADDITIONAL/WITHDRAWAL</b></td>',_0x288e4d+=_0x220a72(0x366);for(let _0x2d4546=0x0;_0x2d4546<=_0x5096ce[_0x220a72(0x263)][_0x220a72(0x34e)]-0x1;_0x2d4546++){const _0x1014fd=_0x5096ce[_0x220a72(0x263)][_0x2d4546],_0x10e51c=_0x1014fd[_0x220a72(0x20a)]['brand']+'-'+_0x1014fd['_id'][_0x220a72(0x319)];var _0x21bbf5=_0x5e7795[_0x10e51c]!==undefined?_0x5e7795[_0x10e51c][_0x220a72(0x25a)](0x2):'0',_0x39d280=_0x57b6ec[_0x10e51c]!==undefined?_0x57b6ec[_0x10e51c][_0x220a72(0x25a)](0x2):'0',_0x649f4d=_0x36bcfd[_0x10e51c]!==undefined?_0x36bcfd[_0x10e51c][_0x220a72(0x25a)](0x2):'0',_0xa70b6f=_0x282e6e[_0x10e51c]!==undefined?_0x282e6e[_0x10e51c][_0x220a72(0x25a)](0x2):'0',_0x22def9=_0x3948a0[_0x10e51c]!==undefined?_0x3948a0[_0x10e51c]['toFixed'](0x2):'0',_0x412f6c=_0x6a93e3[_0x10e51c]!==undefined?_0x6a93e3[_0x10e51c][_0x220a72(0x25a)](0x2):'0';_0x4a9f58=parseFloat(_0x21bbf5)+parseFloat(_0xa70b6f),_0x2fcf5c=parseFloat(_0x649f4d)+parseFloat(_0x412f6c),_0x54fe40=parseFloat(_0x39d280)+parseFloat(_0x22def9),_0x288e4d+=_0x220a72(0x1fe),_0x288e4d+=_0x220a72(0x1fe),_0x288e4d+=_0x220a72(0x1fe);}_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+='</tr>',_0x288e4d+='<tr>',_0x288e4d+=_0x220a72(0x31d),_0x288e4d+=_0x220a72(0x30c),_0x288e4d+=_0x220a72(0x366);for(let _0x1e3e1c=0x0;_0x1e3e1c<=_0x5096ce[_0x220a72(0x263)][_0x220a72(0x34e)]-0x1;_0x1e3e1c++){const _0x1d44c9=_0x5096ce[_0x220a72(0x263)][_0x1e3e1c],_0x355af7=_0x1d44c9[_0x220a72(0x20a)]['brand']+'-'+_0x1d44c9[_0x220a72(0x20a)][_0x220a72(0x319)];var _0x21bbf5=_0x5e7795[_0x355af7]!==undefined?_0x5e7795[_0x355af7][_0x220a72(0x25a)](0x2):'0',_0x39d280=_0x57b6ec[_0x355af7]!==undefined?_0x57b6ec[_0x355af7]['toFixed'](0x2):'0',_0x649f4d=_0x36bcfd[_0x355af7]!==undefined?_0x36bcfd[_0x355af7]['toFixed'](0x2):'0',_0xa70b6f=_0x282e6e[_0x355af7]!==undefined?_0x282e6e[_0x355af7][_0x220a72(0x25a)](0x2):'0',_0x22def9=_0x3948a0[_0x355af7]!==undefined?_0x3948a0[_0x355af7]['toFixed'](0x2):'0',_0x412f6c=_0x6a93e3[_0x355af7]!==undefined?_0x6a93e3[_0x355af7][_0x220a72(0x25a)](0x2):'0';_0x4a9f58=parseFloat(_0x21bbf5)+parseFloat(_0xa70b6f),_0x2fcf5c=parseFloat(_0x649f4d)+parseFloat(_0x412f6c),_0x54fe40=parseFloat(_0x39d280)+parseFloat(_0x22def9),_0x288e4d+=_0x220a72(0x1fe),_0x288e4d+=_0x220a72(0x1fe),_0x288e4d+=_0x220a72(0x1fe);}_0x288e4d+=_0x220a72(0x366),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20center;\x22><b></b></td>',_0x288e4d+=_0x220a72(0x202),_0x288e4d+=_0x220a72(0x366);for(let _0x49ccf7=0x0;_0x49ccf7<=_0x5096ce[_0x220a72(0x263)]['length']-0x1;_0x49ccf7++){const _0x344331=_0x5096ce[_0x220a72(0x263)][_0x49ccf7],_0x4f4a91=_0x344331[_0x220a72(0x20a)][_0x220a72(0x2d8)]+'-'+_0x344331['_id'][_0x220a72(0x319)];var _0x21bbf5=_0x5e7795[_0x4f4a91]!==undefined?_0x5e7795[_0x4f4a91][_0x220a72(0x25a)](0x2):'',_0x39d280=_0x57b6ec[_0x4f4a91]!==undefined?_0x57b6ec[_0x4f4a91][_0x220a72(0x25a)](0x2):'',_0x649f4d=_0x36bcfd[_0x4f4a91]!==undefined?_0x36bcfd[_0x4f4a91][_0x220a72(0x25a)](0x2):'',_0xa70b6f=_0x282e6e[_0x4f4a91]!==undefined?_0x282e6e[_0x4f4a91][_0x220a72(0x25a)](0x2):'',_0x22def9=_0x3948a0[_0x4f4a91]!==undefined?_0x3948a0[_0x4f4a91][_0x220a72(0x25a)](0x2):'',_0x412f6c=_0x6a93e3[_0x4f4a91]!==undefined?_0x6a93e3[_0x4f4a91]['toFixed'](0x2):'';_0x4a9f58=formatNumber(parseFloat(_0x21bbf5)+parseFloat(_0xa70b6f)),_0x2fcf5c=formatNumber(parseFloat(_0x649f4d)+parseFloat(_0x412f6c)),_0x54fe40=formatNumber(parseFloat(_0x39d280)+parseFloat(_0x22def9)),_0x288e4d+=_0x220a72(0x2af)+_0x21bbf5+'</b></td>',_0x288e4d+=_0x220a72(0x2af)+_0x649f4d+_0x220a72(0x26b),_0x288e4d+=_0x220a72(0x2af)+_0x39d280+_0x220a72(0x26b);}_0x288e4d+=_0x220a72(0x366),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+=_0x220a72(0x366),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x253),_0x288e4d+=_0x220a72(0x31d),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22><b>ENDING\x20INVENTORY</b></td>',_0x288e4d+=_0x220a72(0x366);for(let _0x49b08a=0x0;_0x49b08a<=_0x5096ce[_0x220a72(0x263)][_0x220a72(0x34e)]-0x1;_0x49b08a++){const _0x2acb1a=_0x5096ce[_0x220a72(0x263)][_0x49b08a],_0x4168a2=_0x2acb1a[_0x220a72(0x20a)][_0x220a72(0x2d8)]+'-'+_0x2acb1a[_0x220a72(0x20a)][_0x220a72(0x319)];var _0x21bbf5=_0x5e7795[_0x4168a2]!==undefined?_0x5e7795[_0x4168a2][_0x220a72(0x25a)](0x2):'0',_0x39d280=_0x57b6ec[_0x4168a2]!==undefined?_0x57b6ec[_0x4168a2][_0x220a72(0x25a)](0x2):'0',_0x649f4d=_0x36bcfd[_0x4168a2]!==undefined?_0x36bcfd[_0x4168a2][_0x220a72(0x25a)](0x2):'0',_0xa70b6f=_0x282e6e[_0x4168a2]!==undefined?_0x282e6e[_0x4168a2][_0x220a72(0x25a)](0x2):'0',_0x22def9=_0x3948a0[_0x4168a2]!==undefined?_0x3948a0[_0x4168a2][_0x220a72(0x25a)](0x2):'0',_0x412f6c=_0x6a93e3[_0x4168a2]!==undefined?_0x6a93e3[_0x4168a2][_0x220a72(0x25a)](0x2):'0';_0x4a9f58=parseFloat(_0x21bbf5)+parseFloat(_0xa70b6f),_0x2fcf5c=parseFloat(_0x649f4d)+parseFloat(_0x412f6c),_0x54fe40=parseFloat(_0x39d280)+parseFloat(_0x22def9),_0x288e4d+=_0x220a72(0x1fe),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20right;\x22><b></b></td>',_0x288e4d+=_0x220a72(0x1fe);}_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+='<td\x20class=\x22row_data\x22\x20style=\x22border:\x201px\x20solid\x20black;\x20text-align:\x20left;\x22></td>',_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x366),_0x288e4d+=_0x220a72(0x33c),_0x288e4d+=_0x220a72(0x362),_0x288e4d+=_0x220a72(0x338);}),_0x288e4d;}async function generateReferenceNumber(_0x410d4a,_0x27f58b,_0x2a3b7a){const _0x3e2e9f=a0_0x58d2d0,_0x122ff8=new Date(_0x410d4a)[_0x3e2e9f(0x235)](),_0x24459d=('0'+(new Date(_0x410d4a)[_0x3e2e9f(0x22b)]()+0x1))[_0x3e2e9f(0x356)](-0x2),_0xa34541=('0'+new Date(_0x410d4a)[_0x3e2e9f(0x2a5)]())['slice'](-0x2),_0x56b35c=await staff[_0x3e2e9f(0x285)]({'email':_0x2a3b7a[_0x3e2e9f(0x2c7)]}),_0x2eb633=_0x56b35c[_0x3e2e9f(0x26c)],_0x18b516=_0x2eb633+'-'+_0x122ff8+_0x24459d+_0xa34541,_0x1ede05=await Reference[_0x3e2e9f(0x285)]({'referenceNumber':new RegExp('^'+_0x18b516),'salesman_code':_0x2eb633})[_0x3e2e9f(0x1eb)]({'createdAt':-0x1}),_0x1b89c5=_0x18b516;_0x1ede05&&(_0x1b89c5=_0x1ede05[_0x3e2e9f(0x317)]);console[_0x3e2e9f(0x2f8)](_0x1b89c5);const _0x64ba1c=new Reference({'referenceNumber':_0x1b89c5,'staff_id':_0x27f58b,'salesman_code':_0x2eb633});return await _0x64ba1c['save'](),_0x1b89c5;}router[a0_0x58d2d0(0x36f)](a0_0x58d2d0(0x2e7),auth,async(_0x1cd7d4,_0x2ae893)=>{const _0x4ec74b=a0_0x58d2d0,{from_date:_0x539e4b,dataview:_0xa0619c}=_0x1cd7d4[_0x4ec74b(0x2fc)],_0x2da369=_0x1cd7d4[_0x4ec74b(0x332)],_0x214e30=await staff[_0x4ec74b(0x285)]({'email':_0x2da369[_0x4ec74b(0x2c7)]}),_0x372448=await master_shop['find'](),_0x280a89='';var _0x4f61a8=new Date(_0x539e4b);const _0x353605={'year':_0x4ec74b(0x22f),'month':'long','day':_0x4ec74b(0x22f)},_0x3afa57=new Intl[(_0x4ec74b(0x2f5))]('en-US',_0x353605)[_0x4ec74b(0x2fa)](_0x4f61a8),_0x3c5476=await Reference['find']({'staff_id':_0x214e30[_0x4ec74b(0x20a)][_0x4ec74b(0x2d3)](),'date_include':_0x539e4b});if(_0x3c5476[_0x4ec74b(0x34e)]>0x0){let _0x548a2b='';_0x548a2b+=_0x3c5476[0x0][_0x4ec74b(0x353)];if(_0xa0619c=='excel'){const _0x223ffe=cheerio[_0x4ec74b(0x2fd)](_0x548a2b);let _0x43ae08=[],_0x16f7cd=[],_0x229c5a=[];const _0x1e8f34=_0x8187b0=>{const _0x244839=_0x4ec74b,_0x1b967b={'top':{'style':'thick','color':{'rgb':_0x244839(0x25e)}},'bottom':{'style':_0x244839(0x2e3),'color':{'rgb':_0x244839(0x25e)}},'left':{'style':_0x244839(0x2e3),'color':{'rgb':_0x244839(0x25e)}},'right':{'style':'thick','color':{'rgb':'000000'}}};if(_0x8187b0){const _0x28a778=_0x8187b0[_0x244839(0x22a)](';')['reduce']((_0x1d104e,_0x79bdab)=>{const _0x409f37=_0x244839,[_0x38ba1d,_0x3c8244]=_0x79bdab[_0x409f37(0x22a)](':')['map'](_0x4c9177=>_0x4c9177[_0x409f37(0x2ce)]());return _0x1d104e[_0x38ba1d]=_0x3c8244,_0x1d104e;},{});_0x28a778[_0x244839(0x344)]&&(_0x1b967b[_0x244839(0x27b)][_0x244839(0x242)]=_0x28a778['border-top']['includes'](_0x244839(0x34b))?_0x244839(0x34b):_0x244839(0x23a)),_0x28a778[_0x244839(0x29a)]&&(_0x1b967b[_0x244839(0x27f)][_0x244839(0x242)]=_0x28a778[_0x244839(0x29a)][_0x244839(0x32b)](_0x244839(0x34b))?_0x244839(0x34b):'medium'),_0x28a778[_0x244839(0x2f7)]&&(_0x1b967b['left'][_0x244839(0x242)]=_0x28a778[_0x244839(0x2f7)][_0x244839(0x32b)](_0x244839(0x34b))?'thin':_0x244839(0x23a)),_0x28a778[_0x244839(0x2a4)]&&(_0x1b967b[_0x244839(0x2b4)]['style']=_0x28a778[_0x244839(0x2a4)]['includes']('thin')?'thin':_0x244839(0x23a));}return _0x1b967b;};_0x223ffe(_0x4ec74b(0x31c))['each']((_0x2f1fc3,_0x4b0389)=>{const _0x3ba3f3=_0x4ec74b;let _0x1a00fa=[],_0x4edee5=0x0;while(_0x229c5a[_0x4edee5]){_0x229c5a[_0x4edee5]--,_0x4edee5++;}_0x223ffe(_0x4b0389)['find']('td,\x20th')[_0x3ba3f3(0x2ef)]((_0x153e44,_0x2e7064)=>{const _0x10e5be=_0x3ba3f3;let _0x181011=_0x223ffe(_0x2e7064)[_0x10e5be(0x301)]()[_0x10e5be(0x2ce)](),_0x174f8c=parseFloat(_0x181011[_0x10e5be(0x2c4)](/,/g,''));isNaN(_0x174f8c)&&(_0x174f8c=_0x181011);let _0x182b53=parseInt(_0x223ffe(_0x2e7064)[_0x10e5be(0x256)](_0x10e5be(0x29b)))||0x1,_0x2a22e8=parseInt(_0x223ffe(_0x2e7064)[_0x10e5be(0x256)]('rowspan'))||0x1;const _0x372df2=_0x223ffe(_0x2e7064)[_0x10e5be(0x256)](_0x10e5be(0x242)),_0x14732a=_0x1e8f34(_0x372df2);_0x1a00fa[_0x4edee5]={'v':_0x174f8c,'s':{'border':_0x14732a}};(_0x182b53>0x1||_0x2a22e8>0x1)&&_0x16f7cd[_0x10e5be(0x258)]({'s':{'r':_0x2f1fc3,'c':_0x4edee5},'e':{'r':_0x2f1fc3+_0x2a22e8-0x1,'c':_0x4edee5+_0x182b53-0x1}});for(let _0x278dec=0x0;_0x278dec<_0x182b53;_0x278dec++){_0x2a22e8>0x1&&(_0x229c5a[_0x4edee5+_0x278dec]=_0x2a22e8-0x1);}_0x4edee5+=_0x182b53;}),_0x43ae08[_0x3ba3f3(0x258)](_0x1a00fa);});const _0x4759e4=XLSX[_0x4ec74b(0x33f)][_0x4ec74b(0x23d)](),_0x13c380=XLSX[_0x4ec74b(0x33f)][_0x4ec74b(0x24b)](_0x43ae08);_0x16f7cd['length']>0x0&&(_0x13c380[_0x4ec74b(0x27e)]=_0x16f7cd);_0x13c380[_0x4ec74b(0x265)]=_0x43ae08[0x0][_0x4ec74b(0x266)](()=>({'wpx':0x64})),XLSX['utils']['book_append_sheet'](_0x4759e4,_0x13c380,'Sales\x20Report');const _0xf46dd1=XLSX[_0x4ec74b(0x35a)](_0x4759e4,{'bookType':_0x4ec74b(0x312),'type':'buffer'});_0x2ae893[_0x4ec74b(0x365)](_0x4ec74b(0x273),_0x4ec74b(0x29d)),_0x2ae893[_0x4ec74b(0x365)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x2ae893[_0x4ec74b(0x281)](_0xf46dd1);}else{let _0x2a9d82='';_0x2a9d82+=_0x548a2b,_0x2a9d82+='<script>',_0x2a9d82+=_0x4ec74b(0x2d6),_0x2a9d82+='window.print();',_0x2a9d82+='};',_0x2a9d82+='</script>',_0x2ae893[_0x4ec74b(0x281)](_0x2a9d82);}}else generateReferenceNumber(_0x539e4b,_0x214e30[_0x4ec74b(0x20a)][_0x4ec74b(0x2d3)](),_0x2da369)[_0x4ec74b(0x248)](async _0x3c3663=>{const _0x52cc13=_0x4ec74b,_0x315697=await agentsdataDSICheck_DSRR(_0x539e4b,_0x214e30[_0x52cc13(0x20a)][_0x52cc13(0x2d3)](),_0x280a89,_0x3c3663);console[_0x52cc13(0x2f8)](_0x315697);let _0x2a9926=_0x52cc13(0x333);_0x2a9926+=_0x52cc13(0x2ab),_0x2a9926+=_0x52cc13(0x1e9),_0x2a9926+=_0x52cc13(0x21c),_0x2a9926+=_0x315697,_0x2a9926+=_0x52cc13(0x338),_0x2a9926+=_0x52cc13(0x246),_0x2a9926+=_0x52cc13(0x246);if(_0x315697[_0x52cc13(0x34e)]>0x0){const _0x26673a=await Reference[_0x52cc13(0x285)]({'staff_id':_0x214e30['_id'][_0x52cc13(0x2d3)](),'referenceNumber':_0x3c3663});_0x26673a[_0x52cc13(0x353)]=_0x2a9926,_0x26673a[_0x52cc13(0x219)]=_0x539e4b,await _0x26673a[_0x52cc13(0x2e9)]();if(_0xa0619c==_0x52cc13(0x249)){const _0x14023b=cheerio[_0x52cc13(0x2fd)](_0x2a9926);let _0x114b78=[],_0x524211=[],_0x73906a=[];const _0x1ca20a=_0x372e38=>{const _0x37f75c=_0x52cc13,_0x469753={'top':{'style':_0x37f75c(0x2e3),'color':{'rgb':_0x37f75c(0x25e)}},'bottom':{'style':'thick','color':{'rgb':_0x37f75c(0x25e)}},'left':{'style':'thick','color':{'rgb':_0x37f75c(0x25e)}},'right':{'style':_0x37f75c(0x2e3),'color':{'rgb':_0x37f75c(0x25e)}}};if(_0x372e38){const _0x42d36c=_0x372e38[_0x37f75c(0x22a)](';')[_0x37f75c(0x348)]((_0x212536,_0x26352f)=>{const _0x4ef212=_0x37f75c,[_0x3908c0,_0x2c72d1]=_0x26352f[_0x4ef212(0x22a)](':')[_0x4ef212(0x266)](_0x50128c=>_0x50128c[_0x4ef212(0x2ce)]());return _0x212536[_0x3908c0]=_0x2c72d1,_0x212536;},{});_0x42d36c[_0x37f75c(0x344)]&&(_0x469753['top'][_0x37f75c(0x242)]=_0x42d36c[_0x37f75c(0x344)][_0x37f75c(0x32b)](_0x37f75c(0x34b))?_0x37f75c(0x34b):_0x37f75c(0x23a)),_0x42d36c[_0x37f75c(0x29a)]&&(_0x469753[_0x37f75c(0x27f)][_0x37f75c(0x242)]=_0x42d36c[_0x37f75c(0x29a)]['includes']('thin')?_0x37f75c(0x34b):_0x37f75c(0x23a)),_0x42d36c[_0x37f75c(0x2f7)]&&(_0x469753[_0x37f75c(0x23f)][_0x37f75c(0x242)]=_0x42d36c[_0x37f75c(0x2f7)][_0x37f75c(0x32b)](_0x37f75c(0x34b))?_0x37f75c(0x34b):'medium'),_0x42d36c[_0x37f75c(0x2a4)]&&(_0x469753['right'][_0x37f75c(0x242)]=_0x42d36c['border-right'][_0x37f75c(0x32b)](_0x37f75c(0x34b))?'thin':_0x37f75c(0x23a));}return _0x469753;};_0x14023b('table\x20tr')['each']((_0x5f5bb7,_0x217bbd)=>{const _0x5f442a=_0x52cc13;let _0x528fa7=[],_0x55c47f=0x0;while(_0x73906a[_0x55c47f]){_0x73906a[_0x55c47f]--,_0x55c47f++;}_0x14023b(_0x217bbd)[_0x5f442a(0x2c8)]('td,\x20th')[_0x5f442a(0x2ef)]((_0x5b6e65,_0x52f7fd)=>{const _0x21a407=_0x5f442a;let _0x49e40a=_0x14023b(_0x52f7fd)[_0x21a407(0x301)]()[_0x21a407(0x2ce)](),_0x4abfb4=parseFloat(_0x49e40a['replace'](/,/g,''));isNaN(_0x4abfb4)&&(_0x4abfb4=_0x49e40a);let _0x54b0c4=parseInt(_0x14023b(_0x52f7fd)[_0x21a407(0x256)](_0x21a407(0x29b)))||0x1,_0x52574c=parseInt(_0x14023b(_0x52f7fd)[_0x21a407(0x256)](_0x21a407(0x259)))||0x1;const _0x119c18=_0x14023b(_0x52f7fd)[_0x21a407(0x256)](_0x21a407(0x242)),_0x2a7f68=_0x1ca20a(_0x119c18);_0x528fa7[_0x55c47f]={'v':_0x4abfb4,'s':{'border':_0x2a7f68}};(_0x54b0c4>0x1||_0x52574c>0x1)&&_0x524211[_0x21a407(0x258)]({'s':{'r':_0x5f5bb7,'c':_0x55c47f},'e':{'r':_0x5f5bb7+_0x52574c-0x1,'c':_0x55c47f+_0x54b0c4-0x1}});for(let _0x3ec80f=0x0;_0x3ec80f<_0x54b0c4;_0x3ec80f++){_0x52574c>0x1&&(_0x73906a[_0x55c47f+_0x3ec80f]=_0x52574c-0x1);}_0x55c47f+=_0x54b0c4;}),_0x114b78[_0x5f442a(0x258)](_0x528fa7);});const _0x325a24=XLSX[_0x52cc13(0x33f)][_0x52cc13(0x23d)](),_0x2153b9=XLSX['utils'][_0x52cc13(0x24b)](_0x114b78);_0x524211['length']>0x0&&(_0x2153b9[_0x52cc13(0x27e)]=_0x524211);_0x2153b9[_0x52cc13(0x265)]=_0x114b78[0x0][_0x52cc13(0x266)](()=>({'wpx':0x64})),XLSX['utils'][_0x52cc13(0x244)](_0x325a24,_0x2153b9,_0x52cc13(0x1f7));const _0x3b69eb=XLSX[_0x52cc13(0x35a)](_0x325a24,{'bookType':_0x52cc13(0x312),'type':_0x52cc13(0x2f1)});_0x2ae893[_0x52cc13(0x365)](_0x52cc13(0x273),_0x52cc13(0x29d)),_0x2ae893[_0x52cc13(0x365)](_0x52cc13(0x2f4),_0x52cc13(0x299)),_0x2ae893[_0x52cc13(0x281)](_0x3b69eb);}else _0x2a9926+=_0x52cc13(0x1ec),_0x2a9926+=_0x52cc13(0x2d6),_0x2a9926+=_0x52cc13(0x2b9),_0x2a9926+='};',_0x2a9926+=_0x52cc13(0x26e),_0x2ae893['send'](_0x2a9926);}else await Reference[_0x52cc13(0x224)]({'referenceNumber':_0x3c3663}),_0x1cd7d4[_0x52cc13(0x1f5)](_0x52cc13(0x311),_0x52cc13(0x22e)),_0x2ae893['redirect'](_0x52cc13(0x2e2));})[_0x4ec74b(0x231)](console[_0x4ec74b(0x33d)]);}),router['get'](a0_0x58d2d0(0x35c),auth,async(_0x5c7cec,_0x2febc1)=>{const _0x4a531f=a0_0x58d2d0;try{const {username:_0xff1292,email:_0x2705ff,role:_0x3050f7}=_0x5c7cec['user'],_0x5f4581=_0x5c7cec[_0x4a531f(0x332)],_0x507dc9=await profile[_0x4a531f(0x285)]({'email':_0x5f4581['email']}),_0xd3a235={'year':'numeric','month':_0x4a531f(0x26a),'day':_0x4a531f(0x22f)},_0x58082e=await master_shop[_0x4a531f(0x2c8)]();console[_0x4a531f(0x2f8)]('Products\x20master',_0x58082e);const _0x37c555=await product[_0x4a531f(0x2c8)]();console[_0x4a531f(0x2f8)]('Products\x20find_data',_0x37c555);const _0x44d9fe=await warehouse[_0x4a531f(0x2cf)]([{'$unwind':_0x4a531f(0x200)},{'$lookup':{'from':_0x4a531f(0x371),'localField':_0x4a531f(0x35e),'foreignField':'name','as':_0x4a531f(0x29e)}},{'$unwind':_0x4a531f(0x2ed)},{'$project':{'product_name':_0x4a531f(0x354),'product_stock':_0x4a531f(0x2b0)}},{'$group':{'_id':_0x4a531f(0x31b),'product_stock':{'$sum':'$product_stock'}}}]);console[_0x4a531f(0x2f8)](_0x4a531f(0x205),_0x44d9fe),_0x44d9fe['forEach'](_0x21c008=>{const _0x17e459=_0x4a531f,_0x459337=_0x37c555[_0x17e459(0x266)](_0x2ea016=>{const _0x5033f6=_0x17e459;_0x2ea016[_0x5033f6(0x347)]==_0x21c008[_0x5033f6(0x20a)]&&(_0x2ea016[_0x5033f6(0x257)]=parseInt(_0x2ea016[_0x5033f6(0x257)])+parseInt(_0x21c008[_0x5033f6(0x252)]));});});const _0x339dd9=await staff[_0x4a531f(0x2c8)]({'account_category':'sa','type_of_acc_cat':'1'}),_0x247d46=await staff[_0x4a531f(0x285)]({'email':_0x5f4581[_0x4a531f(0x2c7)]});if(_0x58082e[0x0][_0x4a531f(0x2d5)]==_0x4a531f(0x34c))var _0x5b2351=users[_0x4a531f(0x23c)];else{if(_0x58082e[0x0][_0x4a531f(0x2d5)]==_0x4a531f(0x277))var _0x5b2351=users[_0x4a531f(0x277)];else{if(_0x58082e[0x0]['language']=='German')var _0x5b2351=users[_0x4a531f(0x331)];else{if(_0x58082e[0x0][_0x4a531f(0x2d5)]=='Spanish')var _0x5b2351=users[_0x4a531f(0x2b5)];else{if(_0x58082e[0x0][_0x4a531f(0x2d5)]==_0x4a531f(0x1e8))var _0x5b2351=users[_0x4a531f(0x1e8)];else{if(_0x58082e[0x0][_0x4a531f(0x2d5)]=='Portuguese\x20(BR)')var _0x5b2351=users[_0x4a531f(0x1ee)];else{if(_0x58082e[0x0][_0x4a531f(0x2d5)]==_0x4a531f(0x2bf))var _0x5b2351=users[_0x4a531f(0x2bf)];else{if(_0x58082e[0x0]['language']==_0x4a531f(0x2f3))var _0x5b2351=users[_0x4a531f(0x1fb)];}}}}}}}_0x2febc1[_0x4a531f(0x275)](_0x4a531f(0x325),{'success':_0x5c7cec[_0x4a531f(0x1f5)](_0x4a531f(0x33e)),'errors':_0x5c7cec['flash']('errors'),'alldata':_0x37c555,'profile':_0x507dc9,'master_shop':_0x58082e,'role':_0x5f4581,'product_stock':_0x44d9fe,'language':_0x5b2351,'staff_arr':_0x247d46,'staff_data_all':_0x339dd9});}catch(_0x35fbd4){}}),router[a0_0x58d2d0(0x36f)](a0_0x58d2d0(0x20f),auth,async(_0x31f1ca,_0x3e99c7)=>{const _0x90dc3=a0_0x58d2d0;try{const {from:_0x1b0b6c,to:_0x1c8d5b,staff_data:_0x54825a}=_0x31f1ca[_0x90dc3(0x2fc)],_0x4543ff=await Reference[_0x90dc3(0x2cf)]([{'$match':{'date_include':{'$gte':_0x1b0b6c,'$lte':_0x1c8d5b},'staff_id':_0x54825a}},{'$sort':{'date_include':0x1}}]);_0x3e99c7[_0x90dc3(0x208)](_0x4543ff);}catch(_0x5df2a7){_0x3e99c7[_0x90dc3(0x208)](_0x5df2a7);}}),router[a0_0x58d2d0(0x36f)](a0_0x58d2d0(0x218),auth,async(_0x246a11,_0x4ccad9)=>{const _0x293bef=a0_0x58d2d0;try{const {from:_0x13b0cb,to:_0xa52f5f}=_0x246a11[_0x293bef(0x2fc)],{sttaff_id:_0x47fabe}=_0x246a11['user'],_0x445f87=await Reference[_0x293bef(0x2cf)]([{'$match':{'date_include':{'$gte':_0x13b0cb,'$lte':_0xa52f5f},'staff_id':_0x47fabe}},{'$sort':{'date_include':0x1}}]);_0x4ccad9[_0x293bef(0x208)](_0x445f87);}catch(_0x248923){_0x4ccad9['json'](_0x248923);}}),router['get'](a0_0x58d2d0(0x1e4),auth,async(_0x91cd6f,_0x2b2ebb)=>{const _0x2df9c2=a0_0x58d2d0;try{const _0x4c7a83=_0x91cd6f[_0x2df9c2(0x278)]['id'],_0x41eb7b=await Reference[_0x2df9c2(0x2be)](_0x4c7a83);let _0x1e6eaa='';_0x1e6eaa+=_0x41eb7b[_0x2df9c2(0x353)],_0x1e6eaa+=_0x2df9c2(0x1ec),_0x1e6eaa+=_0x2df9c2(0x2d6),_0x1e6eaa+=_0x2df9c2(0x2b9),_0x1e6eaa+='};',_0x1e6eaa+='</script>',_0x2b2ebb[_0x2df9c2(0x281)](_0x1e6eaa);}catch(_0x277960){_0x2b2ebb[_0x2df9c2(0x208)](_0x277960);}}),router[a0_0x58d2d0(0x36f)]('/dl_excel',auth,async(_0x5287c9,_0x318426)=>{const _0x285660=a0_0x58d2d0;try{const {ref_data:_0x26a760}=_0x5287c9[_0x285660(0x2fc)],_0xa6c8ef=_0x26a760[_0x285660(0x22a)]('~'),_0x1df575=_0xa6c8ef[_0x285660(0x323)](_0x43b729=>_0x43b729!==''),_0x4f60ac=await Reference['aggregate']([{'$match':{'referenceNumber':{'$in':_0x1df575}}}]),_0x2652d8=XLSX[_0x285660(0x33f)][_0x285660(0x23d)]();_0x4f60ac[_0x285660(0x32d)](_0x324984=>{const _0x397ac7=_0x285660,_0x1c0b15=cheerio[_0x397ac7(0x2fd)](_0x324984[_0x397ac7(0x353)]);let _0xfdfdd6=[],_0x4a029b=[],_0xf9d66b=[];_0x1c0b15(_0x397ac7(0x31c))[_0x397ac7(0x2ef)]((_0x1cb4ae,_0x1e6915)=>{const _0x5c009f=_0x397ac7;let _0x2432c4=[],_0x56ad54=0x0;while(_0xf9d66b[_0x56ad54]){_0xf9d66b[_0x56ad54]--,_0x56ad54++;}_0x1c0b15(_0x1e6915)[_0x5c009f(0x2c8)](_0x5c009f(0x336))['each']((_0x39e2ac,_0x2f07d3)=>{const _0x125b0c=_0x5c009f;let _0x4da837=_0x1c0b15(_0x2f07d3)[_0x125b0c(0x301)]()[_0x125b0c(0x2ce)](),_0x1fbfe=parseFloat(_0x4da837['replace'](/,/g,''));isNaN(_0x1fbfe)&&(_0x1fbfe=_0x4da837);let _0x5ca0b8=parseInt(_0x1c0b15(_0x2f07d3)[_0x125b0c(0x256)]('colspan'))||0x1,_0x1dc8f0=parseInt(_0x1c0b15(_0x2f07d3)[_0x125b0c(0x256)](_0x125b0c(0x259)))||0x1;_0x2432c4[_0x56ad54]=_0x1fbfe;(_0x5ca0b8>0x1||_0x1dc8f0>0x1)&&_0x4a029b[_0x125b0c(0x258)]({'s':{'r':_0x1cb4ae,'c':_0x56ad54},'e':{'r':_0x1cb4ae+_0x1dc8f0-0x1,'c':_0x56ad54+_0x5ca0b8-0x1}});for(let _0x46a319=0x0;_0x46a319<_0x5ca0b8;_0x46a319++){_0x1dc8f0>0x1&&(_0xf9d66b[_0x56ad54+_0x46a319]=_0x1dc8f0-0x1);}_0x56ad54+=_0x5ca0b8;}),_0xfdfdd6['push'](_0x2432c4);});const _0x5a9b2e=XLSX[_0x397ac7(0x33f)][_0x397ac7(0x24b)](_0xfdfdd6);_0x4a029b['length']>0x0&&(_0x5a9b2e[_0x397ac7(0x27e)]=_0x4a029b),_0x5a9b2e[_0x397ac7(0x265)]=_0xfdfdd6[0x0][_0x397ac7(0x266)](()=>({'wpx':0x64})),XLSX[_0x397ac7(0x33f)][_0x397ac7(0x244)](_0x2652d8,_0x5a9b2e,_0x324984[_0x397ac7(0x317)]);});const _0x2bc8ee=XLSX[_0x285660(0x35a)](_0x2652d8,{'bookType':_0x285660(0x312),'type':_0x285660(0x2f1)});_0x318426[_0x285660(0x365)](_0x285660(0x273),_0x285660(0x22d)),_0x318426[_0x285660(0x365)](_0x285660(0x2f4),'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x318426['send'](_0x2bc8ee);}catch(_0x489692){_0x318426['json'](_0x489692);}}),router[a0_0x58d2d0(0x36f)](a0_0x58d2d0(0x295),auth,async(_0x121454,_0x4c310e)=>{const _0x44c7a2=a0_0x58d2d0,{from_date:_0x1a044c,agent_id:_0x1ad220}=_0x121454['body'],_0x274092=_0x121454[_0x44c7a2(0x332)],_0x112632=await staff['findOne']({'email':_0x274092[_0x44c7a2(0x2c7)]}),_0x195643=await master_shop[_0x44c7a2(0x2c8)](),_0x1a0401=await agentsdataDSICheck_DSRR(_0x1a044c,_0x1ad220,_0x14d97e);let _0xeb309f=_0x44c7a2(0x240);var _0x171ec7=new Date(_0x1a044c);const _0x5ec3dc={'year':_0x44c7a2(0x22f),'month':'long','day':_0x44c7a2(0x22f)},_0x36fa81=new Intl[(_0x44c7a2(0x2f5))](_0x44c7a2(0x206),_0x5ec3dc)[_0x44c7a2(0x2fa)](_0x171ec7);_0xeb309f+=_0x44c7a2(0x2ab),_0xeb309f+=_0x44c7a2(0x1e9),_0xeb309f+=_0x44c7a2(0x21c),_0xeb309f+=_0x1a0401,_0xeb309f+=_0x44c7a2(0x338),_0xeb309f+='</div>',_0xeb309f+=_0x44c7a2(0x246);let _0x3f66c6=_0x44c7a2(0x2de);const _0x5d7e87={'width':_0x44c7a2(0x212),'height':_0x44c7a2(0x345),'orientation':_0x44c7a2(0x241),'border':{'top':_0x44c7a2(0x29c),'right':_0x44c7a2(0x29c),'bottom':_0x44c7a2(0x29c),'left':_0x44c7a2(0x29c)},'header':{'height':_0x44c7a2(0x276),'contents':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3f66c6+_0x44c7a2(0x2c5)+_0x36fa81+_0x44c7a2(0x216)},'footer':{'height':_0x44c7a2(0x2e6),'contents':{'default':'<span\x20style=\x22color:\x20#444;\x22>{{page}}</span>/<span>{{pages}}</span>'}},'dpi':0x5,'zoomFactor':'1','childProcessOptions':{'env':{'OPENSSL_CONF':_0x44c7a2(0x30e)}}};var _0x14d97e='on';if(_0x14d97e=='on'){const _0x57a62b=cheerio[_0x44c7a2(0x2fd)](_0xeb309f);let _0x2f74d2=[],_0x241271=[],_0x3002cf=[];_0x57a62b(_0x44c7a2(0x31c))['each']((_0x2a59b8,_0x3d6ad1)=>{const _0xa2f607=_0x44c7a2;let _0x335f3b=[],_0x5da87e=0x0;while(_0x3002cf[_0x5da87e]){_0x3002cf[_0x5da87e]--,_0x5da87e++;}_0x57a62b(_0x3d6ad1)['find'](_0xa2f607(0x336))['each']((_0xed19ae,_0x40fe0d)=>{const _0x28b44b=_0xa2f607;let _0x562bb7=_0x57a62b(_0x40fe0d)[_0x28b44b(0x301)]()[_0x28b44b(0x2ce)](),_0x2e8bd8=parseFloat(_0x562bb7['replace'](/,/g,''));isNaN(_0x2e8bd8)&&(_0x2e8bd8=_0x562bb7);let _0x3bc584=parseInt(_0x57a62b(_0x40fe0d)[_0x28b44b(0x256)](_0x28b44b(0x29b)))||0x1,_0x3be200=parseInt(_0x57a62b(_0x40fe0d)[_0x28b44b(0x256)](_0x28b44b(0x259)))||0x1;_0x335f3b[_0x5da87e]=_0x2e8bd8;(_0x3bc584>0x1||_0x3be200>0x1)&&_0x241271[_0x28b44b(0x258)]({'s':{'r':_0x2a59b8,'c':_0x5da87e},'e':{'r':_0x2a59b8+_0x3be200-0x1,'c':_0x5da87e+_0x3bc584-0x1}});for(let _0x286dba=0x0;_0x286dba<_0x3bc584;_0x286dba++){_0x3be200>0x1&&(_0x3002cf[_0x5da87e+_0x286dba]=_0x3be200-0x1);}_0x5da87e+=_0x3bc584;}),_0x2f74d2[_0xa2f607(0x258)](_0x335f3b);});const _0x376af2=XLSX[_0x44c7a2(0x33f)][_0x44c7a2(0x23d)](),_0x2116bc=XLSX[_0x44c7a2(0x33f)]['aoa_to_sheet'](_0x2f74d2);_0x241271['length']>0x0&&(_0x2116bc['!merges']=_0x241271);_0x2116bc[_0x44c7a2(0x265)]=_0x2f74d2[0x0][_0x44c7a2(0x266)](()=>({'wpx':0x64})),XLSX[_0x44c7a2(0x33f)][_0x44c7a2(0x244)](_0x376af2,_0x2116bc,_0x44c7a2(0x1f7));const _0x569692=XLSX['write'](_0x376af2,{'bookType':_0x44c7a2(0x312),'type':_0x44c7a2(0x2f1)});_0x4c310e[_0x44c7a2(0x365)](_0x44c7a2(0x273),'attachment;\x20filename=\x22sales_report.xlsx\x22'),_0x4c310e[_0x44c7a2(0x365)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'),_0x4c310e[_0x44c7a2(0x281)](_0x569692);}else pdf[_0x44c7a2(0x27d)](_0xeb309f,_0x5d7e87)[_0x44c7a2(0x222)](function(_0x2a7e12,_0x36a96e){const _0x287f9f=_0x44c7a2;if(_0x2a7e12){_0x4c310e['status'](0x1f4)[_0x287f9f(0x281)]('Error\x20generating\x20PDF');return;}_0x4c310e[_0x287f9f(0x365)](_0x287f9f(0x2f4),_0x287f9f(0x2b6)),_0x36a96e['pipe'](_0x4c310e);});}),module['exports']=router;