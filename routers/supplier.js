const a0_0x2e243d=a0_0x2e3f;function a0_0x70ff(){const _0x3e996b=['sheet_to_json','/view','\x20added\x20successfully','supplier\x20data\x20add\x20successfully','PUnits','Email','../models/all_models','master','7911fiHuiV','write','Purchase\x20Return','purchase','amount','single','Arabic\x20(ae)','log','1200XxhERk','mobile','redirect','German','/products_export_migrate_file','supplier','English','430DbMSXe','map','721208ynXyEV','findOne','11024NbLloA','error','31492oLpSxE','SalesmanName','172931czrvew','/supplier/view','status','purchase_return','supplier_product_file','payable','utils','aggregate','params','supplier_payment','xlsx','1520052gfJjee','save','addWorksheet','flash','findById','Hindi','multer','Supplier_Code','then','email','SheetNames','landline','Name','find','suppliers_docs','Portuguese\x20(BR)','doc','filename','Mobile_number','errors','2018569UupRCk','post','Company_Name','receivable_sum','body','exports','English\x20(US)','forEach','file','s_payments','message','Content-Disposition','receivable','/view/:id','company','Arabic','json','user','French','render','setHeader','now','success','attachment;\x20filename=supplier_Migration_File.xlsx','data','$reason','/view/payment/:id','Content-Type','diskStorage','payable_sum','suppliers','582DSknaX','get','Spanish','language','address','columns','54wPAscr','send','express','/supplier_import_migrate_file','name','supplier\x20data\x20update\x20successfully','contactperson','Portuguese','Router','supplier.js\x20payment_data','$amount','originalname','Chinese'];a0_0x70ff=function(){return _0x3e996b;};return a0_0x70ff();}(function(_0x298893,_0x39c4b4){const _0x54e771=a0_0x2e3f,_0x3d4278=_0x298893();while(!![]){try{const _0xf2fac=parseInt(_0x54e771(0x11e))/0x1+-parseInt(_0x54e771(0x12f))/0x2+-parseInt(_0x54e771(0x168))/0x3*(parseInt(_0x54e771(0x122))/0x4)+parseInt(_0x54e771(0x11c))/0x5*(-parseInt(_0x54e771(0x162))/0x6)+parseInt(_0x54e771(0x143))/0x7+parseInt(_0x54e771(0x120))/0x8*(-parseInt(_0x54e771(0x10d))/0x9)+parseInt(_0x54e771(0x115))/0xa*(parseInt(_0x54e771(0x124))/0xb);if(_0xf2fac===_0x39c4b4)break;else _0x3d4278['push'](_0x3d4278['shift']());}catch(_0x4c9fc0){_0x3d4278['push'](_0x3d4278['shift']());}}}(a0_0x70ff,0xbd25f));const express=require(a0_0x2e243d(0x16a)),app=express(),router=express[a0_0x2e243d(0x170)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x2e243d(0x10b)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require('exceljs'),xlsx=require(a0_0x2e243d(0x12e)),multer=require(a0_0x2e243d(0x135));router[a0_0x2e243d(0x163)](a0_0x2e243d(0x176),auth,async(_0xaed4ef,_0x26c88)=>{const _0x3c1289=a0_0x2e243d;try{const {username:_0x4b5a8d,email:_0x5b22c6,role:_0x53a89b}=_0xaed4ef['user'],_0x5aa89b=_0xaed4ef[_0x3c1289(0x154)],_0xb0fa1c=await profile[_0x3c1289(0x11f)]({'email':_0x5aa89b[_0x3c1289(0x138)]}),_0x34b580=await master_shop['find']();console[_0x3c1289(0x114)](_0x3c1289(0x10c),_0x34b580);const _0x57ad24=await suppliers[_0x3c1289(0x13c)]();console[_0x3c1289(0x114)](_0x57ad24);const _0x516dc8=await suppliers['aggregate']([{'$lookup':{'from':_0x3c1289(0x14c),'localField':_0x3c1289(0x16c),'foreignField':_0x3c1289(0x161),'as':_0x3c1289(0x13d)}}]),_0x2faecd=_0x516dc8[_0x3c1289(0x11d)](_0x1aa1ac=>{const _0x408501=_0x3c1289;console[_0x408501(0x114)](_0x408501(0x15b),_0x1aa1ac);var _0xa9cec=0x0,_0x591a52=0x0;return _0x1aa1ac['suppliers_docs'][_0x408501(0x14a)](_0x222255=>{const _0x1f0caf=_0x408501;console[_0x1f0caf(0x114)](_0x1f0caf(0x13f),_0x222255),_0x222255['reason']=='Purchase'?_0xa9cec+=_0x222255[_0x1f0caf(0x111)]:_0x591a52+=_0x222255[_0x1f0caf(0x111)];}),_0x1aa1ac[_0x408501(0x110)]=_0xa9cec,_0x1aa1ac[_0x408501(0x127)]=_0x591a52,_0x1aa1ac;});console[_0x3c1289(0x114)](_0x3c1289(0x171),_0x2faecd);if(_0x34b580[0x0][_0x3c1289(0x165)]==_0x3c1289(0x149)){var _0x1d18fc=users[_0x3c1289(0x11b)];console[_0x3c1289(0x114)](_0x1d18fc);}else{if(_0x34b580[0x0][_0x3c1289(0x165)]=='Hindi')var _0x1d18fc=users[_0x3c1289(0x134)];else{if(_0x34b580[0x0][_0x3c1289(0x165)]==_0x3c1289(0x118))var _0x1d18fc=users['German'];else{if(_0x34b580[0x0][_0x3c1289(0x165)]==_0x3c1289(0x164))var _0x1d18fc=users['Spanish'];else{if(_0x34b580[0x0][_0x3c1289(0x165)]==_0x3c1289(0x155))var _0x1d18fc=users['French'];else{if(_0x34b580[0x0][_0x3c1289(0x165)]==_0x3c1289(0x13e))var _0x1d18fc=users[_0x3c1289(0x16f)];else{if(_0x34b580[0x0]['language']=='Chinese')var _0x1d18fc=users[_0x3c1289(0x174)];else{if(_0x34b580[0x0][_0x3c1289(0x165)]==_0x3c1289(0x113))var _0x1d18fc=users[_0x3c1289(0x152)];}}}}}}}_0x26c88[_0x3c1289(0x156)](_0x3c1289(0x11a),{'success':_0xaed4ef[_0x3c1289(0x132)]('success'),'errors':_0xaed4ef[_0x3c1289(0x132)]('errors'),'user':_0x57ad24,'profile':_0xb0fa1c,'master_shop':_0x34b580,'role':_0x5aa89b,'payment':_0x2faecd,'language':_0x1d18fc});}catch(_0x539fb2){console[_0x3c1289(0x114)](_0x539fb2);}}),router[a0_0x2e243d(0x144)](a0_0x2e243d(0x176),auth,async(_0x303d71,_0x7a67aa)=>{const _0x288d4a=a0_0x2e243d;try{const {name:_0x183077,email:_0x3c864f,mobile:_0xbe14ca,company:_0x2d00f1,address:_0xefdf1b,receivable:_0x3c66ab,payable:_0x2b9403,code:_0x2f3802,contactperson:_0x3f88b4,landline:_0x321013}=_0x303d71[_0x288d4a(0x147)],_0x1741f8=new suppliers({'name':_0x183077,'email':_0x3c864f,'mobile':_0xbe14ca,'company':_0x2d00f1,'address':_0xefdf1b,'receivable':_0x3c66ab,'payable':_0x2b9403,'suppliers_code':_0x2f3802,'contactperson':_0x3f88b4,'landline':_0x321013}),_0x1aec72=await _0x1741f8[_0x288d4a(0x130)]();_0x303d71[_0x288d4a(0x132)]('success',_0x288d4a(0x178)),_0x7a67aa[_0x288d4a(0x117)](_0x288d4a(0x125));}catch(_0x354f82){console[_0x288d4a(0x114)](_0x354f82);}}),router[a0_0x2e243d(0x163)]('/view/:id',auth,async(_0x2dc9d3,_0x412efc)=>{const _0x1a9529=a0_0x2e243d;try{const {username:_0x160de4,email:_0x83649a,role:_0x22c699}=_0x2dc9d3[_0x1a9529(0x154)],_0x57e0a5=_0x2dc9d3[_0x1a9529(0x154)],_0x39fb59=await profile[_0x1a9529(0x11f)]({'email':_0x57e0a5[_0x1a9529(0x138)]}),_0x58aa9e=await master_shop[_0x1a9529(0x13c)]();console[_0x1a9529(0x114)](_0x1a9529(0x10c),_0x58aa9e);const _0x375f87=_0x2dc9d3[_0x1a9529(0x12c)]['id'],_0x30b65a=await suppliers[_0x1a9529(0x133)](_0x375f87);console[_0x1a9529(0x114)](_0x30b65a);if(_0x58aa9e[0x0][_0x1a9529(0x165)]=='English\x20(US)'){var _0x16d158=users[_0x1a9529(0x11b)];console[_0x1a9529(0x114)](_0x16d158);}else{if(_0x58aa9e[0x0][_0x1a9529(0x165)]==_0x1a9529(0x134))var _0x16d158=users['Hindi'];else{if(_0x58aa9e[0x0]['language']==_0x1a9529(0x118))var _0x16d158=users[_0x1a9529(0x118)];else{if(_0x58aa9e[0x0]['language']==_0x1a9529(0x164))var _0x16d158=users[_0x1a9529(0x164)];else{if(_0x58aa9e[0x0][_0x1a9529(0x165)]==_0x1a9529(0x155))var _0x16d158=users[_0x1a9529(0x155)];else{if(_0x58aa9e[0x0][_0x1a9529(0x165)]==_0x1a9529(0x13e))var _0x16d158=users[_0x1a9529(0x16f)];else{if(_0x58aa9e[0x0][_0x1a9529(0x165)]==_0x1a9529(0x174))var _0x16d158=users[_0x1a9529(0x174)];else{if(_0x58aa9e[0x0][_0x1a9529(0x165)]==_0x1a9529(0x113))var _0x16d158=users[_0x1a9529(0x152)];}}}}}}}_0x412efc['render'](_0x1a9529(0x11a),{'success':_0x2dc9d3[_0x1a9529(0x132)](_0x1a9529(0x159)),'errors':_0x2dc9d3['flash'](_0x1a9529(0x142)),'role':_0x57e0a5,'profile':_0x39fb59,'master_shop':_0x58aa9e,'user':_0x30b65a,'language':_0x16d158});}catch(_0x2bf2a1){console[_0x1a9529(0x114)](_0x2bf2a1);}}),router[a0_0x2e243d(0x144)](a0_0x2e243d(0x150),auth,async(_0x4b8984,_0x1752d1)=>{const _0x1cf74d=a0_0x2e243d;try{const _0x289751=_0x4b8984[_0x1cf74d(0x12c)]['id'],_0x309ce0=await suppliers[_0x1cf74d(0x133)](_0x289751),{name:_0xc8aa7b,email:_0x1a7c05,mobile:_0x2b8d18,company:_0x411fb7,address:_0x324d4c,receivable:_0x3afb50,payable:_0x4aae60,code:_0x126a2f,contactperson:_0x376c50,landline:_0x28d6c7}=_0x4b8984[_0x1cf74d(0x147)];_0x309ce0[_0x1cf74d(0x16c)]=_0xc8aa7b,_0x309ce0[_0x1cf74d(0x138)]=_0x1a7c05,_0x309ce0[_0x1cf74d(0x116)]=_0x2b8d18,_0x309ce0[_0x1cf74d(0x151)]=_0x411fb7,_0x309ce0[_0x1cf74d(0x166)]=_0x324d4c,_0x309ce0[_0x1cf74d(0x14f)]=_0x3afb50,_0x309ce0[_0x1cf74d(0x129)]=_0x4aae60,_0x309ce0['suppliers_code']=_0x126a2f,_0x309ce0[_0x1cf74d(0x16e)]=_0x376c50,_0x309ce0[_0x1cf74d(0x13a)]=_0x28d6c7;const _0x1d6a02=await _0x309ce0[_0x1cf74d(0x130)]();_0x4b8984[_0x1cf74d(0x132)](_0x1cf74d(0x159),_0x1cf74d(0x16d)),_0x1752d1[_0x1cf74d(0x117)](_0x1cf74d(0x125));}catch(_0x39b6b0){console[_0x1cf74d(0x114)](_0x39b6b0);}}),router[a0_0x2e243d(0x163)](a0_0x2e243d(0x15d),auth,async(_0x4f5239,_0x40f270)=>{const _0x80268b=a0_0x2e243d;try{const {username:_0x3eb2a3,email:_0x2aa907,role:_0x572a6c}=_0x4f5239[_0x80268b(0x154)],_0x2e6e25=_0x4f5239[_0x80268b(0x154)],_0x3c110c=await profile[_0x80268b(0x11f)]({'email':_0x2e6e25[_0x80268b(0x138)]}),_0x1801ee=await master_shop[_0x80268b(0x13c)]();console[_0x80268b(0x114)](_0x80268b(0x10c),_0x1801ee),console[_0x80268b(0x114)](_0x4f5239[_0x80268b(0x12c)]['id']);const _0x5eae45=await suppliers[_0x80268b(0x11f)]({'_id':_0x4f5239[_0x80268b(0x12c)]['id']});console['log'](_0x5eae45);const _0x260e6d=await s_payment_data[_0x80268b(0x13c)]({'suppliers':_0x5eae45[_0x80268b(0x16c)]});console['log'](_0x260e6d);const _0x18372b=await s_payment_data[_0x80268b(0x12b)]([{'$match':{'suppliers':_0x5eae45[_0x80268b(0x16c)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x80268b(0x15c),'sum':{'$sum':_0x80268b(0x172)}}}]);console[_0x80268b(0x114)](_0x80268b(0x160),_0x18372b);const _0x29dd82=await s_payment_data[_0x80268b(0x12b)]([{'$match':{'suppliers':_0x5eae45[_0x80268b(0x16c)]}},{'$match':{'reason':_0x80268b(0x10f)}},{'$group':{'_id':_0x80268b(0x15c),'sum':{'$sum':_0x80268b(0x172)}}}]);console['log'](_0x80268b(0x146),_0x29dd82);if(_0x1801ee[0x0]['language']=='English\x20(US)'){var _0x5f03f3=users[_0x80268b(0x11b)];console[_0x80268b(0x114)](_0x5f03f3);}else{if(_0x1801ee[0x0]['language']==_0x80268b(0x134))var _0x5f03f3=users[_0x80268b(0x134)];else{if(_0x1801ee[0x0][_0x80268b(0x165)]==_0x80268b(0x118))var _0x5f03f3=users[_0x80268b(0x118)];else{if(_0x1801ee[0x0][_0x80268b(0x165)]==_0x80268b(0x164))var _0x5f03f3=users[_0x80268b(0x164)];else{if(_0x1801ee[0x0][_0x80268b(0x165)]==_0x80268b(0x155))var _0x5f03f3=users[_0x80268b(0x155)];else{if(_0x1801ee[0x0]['language']==_0x80268b(0x13e))var _0x5f03f3=users[_0x80268b(0x16f)];else{if(_0x1801ee[0x0]['language']=='Chinese')var _0x5f03f3=users[_0x80268b(0x174)];else{if(_0x1801ee[0x0][_0x80268b(0x165)]==_0x80268b(0x113))var _0x5f03f3=users[_0x80268b(0x152)];}}}}}}}_0x40f270[_0x80268b(0x156)](_0x80268b(0x12d),{'success':_0x4f5239[_0x80268b(0x132)](_0x80268b(0x159)),'errors':_0x4f5239[_0x80268b(0x132)](_0x80268b(0x142)),'role':_0x2e6e25,'profile':_0x3c110c,'master_shop':_0x1801ee,'payment':_0x260e6d,'payable':_0x18372b,'receivable':_0x29dd82,'language':_0x5f03f3});}catch(_0x4dccff){console['log'](_0x4dccff);}}),router['get'](a0_0x2e243d(0x119),auth,async(_0xfcb30a,_0x4a11ba)=>{const _0x4ccede=a0_0x2e243d;try{const _0x544e03=new excelJS['Workbook'](),_0x3c7f86=_0x544e03[_0x4ccede(0x131)]('Customers');return _0x3c7f86[_0x4ccede(0x167)]=[{'header':_0x4ccede(0x13b),'key':'PBrands','width':0xa},{'header':_0x4ccede(0x136),'key':_0x4ccede(0x179),'width':0xa},{'header':_0x4ccede(0x10a),'key':_0x4ccede(0x123),'width':0xa},{'header':_0x4ccede(0x141),'key':_0x4ccede(0x166),'width':0xa},{'header':'Company_Name','key':_0x4ccede(0x116),'width':0xa},{'header':'address','key':_0x4ccede(0x138),'width':0xa}],_0x4a11ba[_0x4ccede(0x157)](_0x4ccede(0x15e),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x4a11ba['setHeader'](_0x4ccede(0x14e),_0x4ccede(0x15a)),_0x544e03[_0x4ccede(0x12e)][_0x4ccede(0x10e)](_0x4a11ba)[_0x4ccede(0x137)](()=>{const _0x461fcc=_0x4ccede;_0x4a11ba[_0x461fcc(0x126)](0xc8);});}catch(_0xc9b17f){_0x4a11ba['status'](0x190)[_0x4ccede(0x169)]({'errors':_0xc9b17f[_0x4ccede(0x14d)]});}});const storage1=multer[a0_0x2e243d(0x15f)]({'destination':(_0xcdfed5,_0x83c145,_0x10511f)=>{_0x10511f(null,'public/Migration');},'filename':(_0x4951ad,_0x4bd162,_0x16bc44)=>{const _0x22f883=a0_0x2e243d;_0x16bc44(null,Date[_0x22f883(0x158)]()+_0x4bd162[_0x22f883(0x173)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x2e3f(_0x387f1f,_0xbf7b4c){const _0x70ff70=a0_0x70ff();return a0_0x2e3f=function(_0x2e3f8d,_0x5e65de){_0x2e3f8d=_0x2e3f8d-0x10a;let _0x51adf6=_0x70ff70[_0x2e3f8d];return _0x51adf6;},a0_0x2e3f(_0x387f1f,_0xbf7b4c);}router[a0_0x2e243d(0x144)](a0_0x2e243d(0x16b),auth,uploadMigrate[a0_0x2e243d(0x112)](a0_0x2e243d(0x128)),async(_0x585066,_0x563c40)=>{const _0x3e927c=a0_0x2e243d,_0x3b13d9=_0x585066[_0x3e927c(0x14b)][_0x3e927c(0x140)],_0x10575e=await xlsx['readFile']('public/Migration/'+_0x3b13d9);let _0x572c5f=_0x10575e[_0x3e927c(0x139)],_0x396f65=xlsx[_0x3e927c(0x12a)][_0x3e927c(0x175)](_0x10575e['Sheets'][_0x572c5f[0x0]]);for(const _0x3899e3 of _0x396f65){const _0x38e2a6=_0x3899e3[_0x3e927c(0x13b)],_0x5d5bc0=_0x3899e3[_0x3e927c(0x136)],_0x8a6aed=_0x3899e3[_0x3e927c(0x166)],_0x38215e=_0x3899e3[_0x3e927c(0x141)],_0x230d1a=_0x3899e3[_0x3e927c(0x10a)],_0x2bffb5=_0x3899e3[_0x3e927c(0x145)];try{let _0x1fa411=await suppliers['findOne']({'name':_0x38e2a6});if(!_0x1fa411){const _0x1b7b75=new suppliers({'name':_0x38e2a6,'suppliers_code':_0x5d5bc0,'address':_0x8a6aed,'mobile':_0x38215e,'email':_0x230d1a,'company':_0x2bffb5});_0x1fa411=await _0x1b7b75[_0x3e927c(0x130)](),_0x585066[_0x3e927c(0x132)]('success',_0x38e2a6+_0x3e927c(0x177));}else _0x585066[_0x3e927c(0x132)](_0x3e927c(0x121),_0x38e2a6+'\x20Failed');}catch(_0x3213d6){_0x563c40[_0x3e927c(0x126)](0x1f4)[_0x3e927c(0x153)]({'proderror':_0x3213d6['message'],'aproduct':ProductName});}}_0x563c40[_0x3e927c(0x117)]('/supplier/view');}),module[a0_0x2e243d(0x148)]=router;