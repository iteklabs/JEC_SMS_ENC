const a0_0x2880d4=a0_0x4f42;(function(_0x2ae36d,_0x406d3b){const _0x3fa70c=a0_0x4f42,_0x299e77=_0x2ae36d();while(!![]){try{const _0x254567=parseInt(_0x3fa70c(0x13b))/0x1*(-parseInt(_0x3fa70c(0x129))/0x2)+-parseInt(_0x3fa70c(0x171))/0x3+parseInt(_0x3fa70c(0x130))/0x4*(-parseInt(_0x3fa70c(0x14f))/0x5)+-parseInt(_0x3fa70c(0x150))/0x6+-parseInt(_0x3fa70c(0x165))/0x7*(-parseInt(_0x3fa70c(0x147))/0x8)+parseInt(_0x3fa70c(0x149))/0x9+parseInt(_0x3fa70c(0x12f))/0xa;if(_0x254567===_0x406d3b)break;else _0x299e77['push'](_0x299e77['shift']());}catch(_0x5a911d){_0x299e77['push'](_0x299e77['shift']());}}}(a0_0x73dc,0x33b24));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x2880d4(0x120)),auth=require(a0_0x2880d4(0x12c)),users=require(a0_0x2880d4(0x128)),excelJS=require('exceljs'),xlsx=require(a0_0x2880d4(0x134)),multer=require('multer');router[a0_0x2880d4(0x125)](a0_0x2880d4(0x151),auth,async(_0x4a9d83,_0x2e74a3)=>{const _0x552273=a0_0x2880d4;try{const {username:_0x201329,email:_0x251005,role:_0x113928}=_0x4a9d83[_0x552273(0x135)],_0x36284d=_0x4a9d83['user'],_0x177fac=await profile[_0x552273(0x13c)]({'email':_0x36284d['email']}),_0x545b32=await master_shop[_0x552273(0x121)]();console['log']('master',_0x545b32);const _0x1432b6=await suppliers[_0x552273(0x121)]();console['log'](_0x1432b6);const _0x1fc2a7=await suppliers[_0x552273(0x14e)]([{'$lookup':{'from':_0x552273(0x161),'localField':'name','foreignField':_0x552273(0x158),'as':_0x552273(0x10a)}}]),_0x1856e4=_0x1fc2a7[_0x552273(0x157)](_0x3718b3=>{const _0x3a2b31=_0x552273;console[_0x3a2b31(0x16e)](_0x3a2b31(0x14b),_0x3718b3);var _0x5dcbb3=0x0,_0x3790d6=0x0;return _0x3718b3[_0x3a2b31(0x10a)][_0x3a2b31(0x14d)](_0x3f4025=>{const _0x2e4e9c=_0x3a2b31;console[_0x2e4e9c(0x16e)](_0x2e4e9c(0x11f),_0x3f4025),_0x3f4025['reason']==_0x2e4e9c(0x154)?_0x5dcbb3+=_0x3f4025['amount']:_0x3790d6+=_0x3f4025[_0x2e4e9c(0x111)];}),_0x3718b3[_0x3a2b31(0x108)]=_0x5dcbb3,_0x3718b3[_0x3a2b31(0x118)]=_0x3790d6,_0x3718b3;});console[_0x552273(0x16e)](_0x552273(0x15c),_0x1856e4);if(_0x545b32[0x0]['language']=='English\x20(US)'){var _0x58d371=users[_0x552273(0x13f)];console[_0x552273(0x16e)](_0x58d371);}else{if(_0x545b32[0x0][_0x552273(0x12a)]=='Hindi')var _0x58d371=users[_0x552273(0x12e)];else{if(_0x545b32[0x0]['language']==_0x552273(0x146))var _0x58d371=users['German'];else{if(_0x545b32[0x0]['language']==_0x552273(0x16b))var _0x58d371=users[_0x552273(0x16b)];else{if(_0x545b32[0x0]['language']==_0x552273(0x124))var _0x58d371=users[_0x552273(0x124)];else{if(_0x545b32[0x0][_0x552273(0x12a)]=='Portuguese\x20(BR)')var _0x58d371=users[_0x552273(0x145)];else{if(_0x545b32[0x0][_0x552273(0x12a)]==_0x552273(0x13a))var _0x58d371=users[_0x552273(0x13a)];else{if(_0x545b32[0x0]['language']==_0x552273(0x169))var _0x58d371=users[_0x552273(0x10b)];}}}}}}}_0x2e74a3[_0x552273(0x155)]('supplier',{'success':_0x4a9d83[_0x552273(0x123)]('success'),'errors':_0x4a9d83[_0x552273(0x123)](_0x552273(0x10f)),'user':_0x1432b6,'profile':_0x177fac,'master_shop':_0x545b32,'role':_0x36284d,'payment':_0x1856e4,'language':_0x58d371});}catch(_0x31a146){console[_0x552273(0x16e)](_0x31a146);}}),router['post']('/view',auth,async(_0x40aa62,_0x4724bd)=>{const _0x48dc78=a0_0x2880d4;try{const {name:_0x1cad3a,email:_0x4df578,mobile:_0x5a6a0f,company:_0x13f016,address:_0x2864e0,receivable:_0x3a0de3,payable:_0x410856,code:_0x1f8f45,contactperson:_0x2b4568,landline:_0x1d11cb}=_0x40aa62['body'],_0x160289=new suppliers({'name':_0x1cad3a,'email':_0x4df578,'mobile':_0x5a6a0f,'company':_0x13f016,'address':_0x2864e0,'receivable':_0x3a0de3,'payable':_0x410856,'suppliers_code':_0x1f8f45,'contactperson':_0x2b4568,'landline':_0x1d11cb}),_0xcf33bc=await _0x160289['save']();_0x40aa62[_0x48dc78(0x123)]('success',_0x48dc78(0x10e)),_0x4724bd[_0x48dc78(0x153)](_0x48dc78(0x11c));}catch(_0x47e108){console[_0x48dc78(0x16e)](_0x47e108);}}),router[a0_0x2880d4(0x125)](a0_0x2880d4(0x172),auth,async(_0x21101d,_0x200034)=>{const _0x6ce8f7=a0_0x2880d4;try{const {username:_0x19b7a1,email:_0x22d4e9,role:_0x34ca8d}=_0x21101d[_0x6ce8f7(0x135)],_0x469fe4=_0x21101d[_0x6ce8f7(0x135)],_0x5a45b9=await profile[_0x6ce8f7(0x13c)]({'email':_0x469fe4[_0x6ce8f7(0x15b)]}),_0x1719b8=await master_shop[_0x6ce8f7(0x121)]();console[_0x6ce8f7(0x16e)](_0x6ce8f7(0x13d),_0x1719b8);const _0x3155e9=_0x21101d[_0x6ce8f7(0x132)]['id'],_0x191052=await suppliers[_0x6ce8f7(0x113)](_0x3155e9);console['log'](_0x191052);if(_0x1719b8[0x0][_0x6ce8f7(0x12a)]=='English\x20(US)'){var _0xcabebf=users['English'];console[_0x6ce8f7(0x16e)](_0xcabebf);}else{if(_0x1719b8[0x0][_0x6ce8f7(0x12a)]==_0x6ce8f7(0x12e))var _0xcabebf=users['Hindi'];else{if(_0x1719b8[0x0][_0x6ce8f7(0x12a)]==_0x6ce8f7(0x146))var _0xcabebf=users['German'];else{if(_0x1719b8[0x0][_0x6ce8f7(0x12a)]=='Spanish')var _0xcabebf=users[_0x6ce8f7(0x16b)];else{if(_0x1719b8[0x0][_0x6ce8f7(0x12a)]==_0x6ce8f7(0x124))var _0xcabebf=users[_0x6ce8f7(0x124)];else{if(_0x1719b8[0x0][_0x6ce8f7(0x12a)]=='Portuguese\x20(BR)')var _0xcabebf=users[_0x6ce8f7(0x145)];else{if(_0x1719b8[0x0]['language']==_0x6ce8f7(0x13a))var _0xcabebf=users[_0x6ce8f7(0x13a)];else{if(_0x1719b8[0x0][_0x6ce8f7(0x12a)]=='Arabic\x20(ae)')var _0xcabebf=users['Arabic'];}}}}}}}_0x200034['render'](_0x6ce8f7(0x12b),{'success':_0x21101d[_0x6ce8f7(0x123)](_0x6ce8f7(0x163)),'errors':_0x21101d[_0x6ce8f7(0x123)](_0x6ce8f7(0x10f)),'role':_0x469fe4,'profile':_0x5a45b9,'master_shop':_0x1719b8,'user':_0x191052,'language':_0xcabebf});}catch(_0x3df844){console[_0x6ce8f7(0x16e)](_0x3df844);}}),router[a0_0x2880d4(0x170)](a0_0x2880d4(0x172),auth,async(_0x540cbc,_0x489151)=>{const _0x598ceb=a0_0x2880d4;try{const _0x2fe49d=_0x540cbc[_0x598ceb(0x132)]['id'],_0x3bba8=await suppliers[_0x598ceb(0x113)](_0x2fe49d),{name:_0x5eeb99,email:_0x23a8a0,mobile:_0x32b699,company:_0x5533e0,address:_0x57da86,receivable:_0x210f0c,payable:_0x299b53,code:_0x52ed83,contactperson:_0x31cb26,landline:_0x57456b}=_0x540cbc[_0x598ceb(0x10c)];_0x3bba8['name']=_0x5eeb99,_0x3bba8['email']=_0x23a8a0,_0x3bba8[_0x598ceb(0x166)]=_0x32b699,_0x3bba8[_0x598ceb(0x133)]=_0x5533e0,_0x3bba8[_0x598ceb(0x14a)]=_0x57da86,_0x3bba8['receivable']=_0x210f0c,_0x3bba8[_0x598ceb(0x127)]=_0x299b53,_0x3bba8[_0x598ceb(0x148)]=_0x52ed83,_0x3bba8[_0x598ceb(0x117)]=_0x31cb26,_0x3bba8[_0x598ceb(0x119)]=_0x57456b;const _0x25181f=await _0x3bba8[_0x598ceb(0x168)]();_0x540cbc['flash'](_0x598ceb(0x163),_0x598ceb(0x16d)),_0x489151[_0x598ceb(0x153)](_0x598ceb(0x11c));}catch(_0xb83c7e){console[_0x598ceb(0x16e)](_0xb83c7e);}}),router[a0_0x2880d4(0x125)](a0_0x2880d4(0x11d),auth,async(_0x18bd0e,_0x2f69f1)=>{const _0x1c6c6b=a0_0x2880d4;try{const {username:_0x129fc3,email:_0x2834ad,role:_0x5eff41}=_0x18bd0e['user'],_0x59f921=_0x18bd0e[_0x1c6c6b(0x135)],_0x22910c=await profile['findOne']({'email':_0x59f921[_0x1c6c6b(0x15b)]}),_0x29463c=await master_shop[_0x1c6c6b(0x121)]();console[_0x1c6c6b(0x16e)](_0x1c6c6b(0x13d),_0x29463c),console['log'](_0x18bd0e[_0x1c6c6b(0x132)]['id']);const _0x5bfecf=await suppliers[_0x1c6c6b(0x13c)]({'_id':_0x18bd0e[_0x1c6c6b(0x132)]['id']});console[_0x1c6c6b(0x16e)](_0x5bfecf);const _0x80ec5=await s_payment_data[_0x1c6c6b(0x121)]({'suppliers':_0x5bfecf[_0x1c6c6b(0x14c)]});console['log'](_0x80ec5);const _0xfae77c=await s_payment_data[_0x1c6c6b(0x14e)]([{'$match':{'suppliers':_0x5bfecf['name']}},{'$match':{'reason':_0x1c6c6b(0x154)}},{'$group':{'_id':_0x1c6c6b(0x11a),'sum':{'$sum':'$amount'}}}]);console[_0x1c6c6b(0x16e)](_0x1c6c6b(0x137),_0xfae77c);const _0x4a52ff=await s_payment_data[_0x1c6c6b(0x14e)]([{'$match':{'suppliers':_0x5bfecf[_0x1c6c6b(0x14c)]}},{'$match':{'reason':_0x1c6c6b(0x16a)}},{'$group':{'_id':_0x1c6c6b(0x11a),'sum':{'$sum':_0x1c6c6b(0x175)}}}]);console[_0x1c6c6b(0x16e)](_0x1c6c6b(0x10d),_0x4a52ff);if(_0x29463c[0x0][_0x1c6c6b(0x12a)]==_0x1c6c6b(0x174)){var _0xa18a24=users[_0x1c6c6b(0x13f)];console[_0x1c6c6b(0x16e)](_0xa18a24);}else{if(_0x29463c[0x0]['language']==_0x1c6c6b(0x12e))var _0xa18a24=users[_0x1c6c6b(0x12e)];else{if(_0x29463c[0x0][_0x1c6c6b(0x12a)]==_0x1c6c6b(0x146))var _0xa18a24=users['German'];else{if(_0x29463c[0x0][_0x1c6c6b(0x12a)]=='Spanish')var _0xa18a24=users[_0x1c6c6b(0x16b)];else{if(_0x29463c[0x0][_0x1c6c6b(0x12a)]==_0x1c6c6b(0x124))var _0xa18a24=users[_0x1c6c6b(0x124)];else{if(_0x29463c[0x0][_0x1c6c6b(0x12a)]==_0x1c6c6b(0x116))var _0xa18a24=users[_0x1c6c6b(0x145)];else{if(_0x29463c[0x0][_0x1c6c6b(0x12a)]==_0x1c6c6b(0x13a))var _0xa18a24=users[_0x1c6c6b(0x13a)];else{if(_0x29463c[0x0][_0x1c6c6b(0x12a)]==_0x1c6c6b(0x169))var _0xa18a24=users['Arabic'];}}}}}}}_0x2f69f1[_0x1c6c6b(0x155)](_0x1c6c6b(0x11b),{'success':_0x18bd0e['flash']('success'),'errors':_0x18bd0e[_0x1c6c6b(0x123)](_0x1c6c6b(0x10f)),'role':_0x59f921,'profile':_0x22910c,'master_shop':_0x29463c,'payment':_0x80ec5,'payable':_0xfae77c,'receivable':_0x4a52ff,'language':_0xa18a24});}catch(_0x4cd48f){console['log'](_0x4cd48f);}}),router[a0_0x2880d4(0x125)](a0_0x2880d4(0x167),auth,async(_0x26b3a8,_0x92789)=>{const _0x20d6b8=a0_0x2880d4;try{const _0x30879a=new excelJS['Workbook'](),_0x5488ce=_0x30879a[_0x20d6b8(0x114)]('Customers');return _0x5488ce[_0x20d6b8(0x15a)]=[{'header':_0x20d6b8(0x122),'key':_0x20d6b8(0x11e),'width':0xa},{'header':_0x20d6b8(0x16f),'key':'PUnits','width':0xa},{'header':_0x20d6b8(0x126),'key':_0x20d6b8(0x109),'width':0xa},{'header':_0x20d6b8(0x12d),'key':_0x20d6b8(0x14a),'width':0xa},{'header':'Company_Name','key':'mobile','width':0xa},{'header':_0x20d6b8(0x14a),'key':_0x20d6b8(0x15b),'width':0xa}],_0x92789[_0x20d6b8(0x159)](_0x20d6b8(0x107),_0x20d6b8(0x141)),_0x92789[_0x20d6b8(0x159)]('Content-Disposition',_0x20d6b8(0x143)),_0x30879a[_0x20d6b8(0x134)][_0x20d6b8(0x142)](_0x92789)[_0x20d6b8(0x131)](()=>{const _0x9a741a=_0x20d6b8;_0x92789[_0x9a741a(0x156)](0xc8);});}catch(_0x10bfe9){_0x92789[_0x20d6b8(0x156)](0x190)[_0x20d6b8(0x164)]({'errors':_0x10bfe9[_0x20d6b8(0x115)]});}});const storage1=multer[a0_0x2880d4(0x112)]({'destination':(_0x33627e,_0xd3af62,_0x226d94)=>{_0x226d94(null,'public/Migration');},'filename':(_0x12dfff,_0x44212c,_0x548202)=>{const _0x58d509=a0_0x2880d4;_0x548202(null,Date[_0x58d509(0x173)]()+_0x44212c[_0x58d509(0x15d)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x73dc(){const _0x56d0a4=['aggregate','12135oJNABQ','564018JejMPk','/view','error','redirect','Purchase','render','status','map','suppliers','setHeader','columns','email','supplier.js\x20payment_data','originalname','SheetNames','single','supplier_product_file','s_payments','public/Migration/','success','send','2613009cgFukd','mobile','/products_export_migrate_file','save','Arabic\x20(ae)','Purchase\x20Return','Spanish','Sheets','supplier\x20data\x20update\x20successfully','log','Supplier_Code','post','645684iQtKni','/view/:id','now','English\x20(US)','$amount','\x20Failed','json','Content-Type','purchase','SalesmanName','suppliers_docs','Arabic','body','receivable_sum','supplier\x20data\x20add\x20successfully','errors','\x20added\x20successfully','amount','diskStorage','findById','addWorksheet','message','Portuguese\x20(BR)','contactperson','purchase_return','landline','$reason','supplier_payment','/supplier/view','/view/payment/:id','PBrands','doc','../models/all_models','find','Name','flash','French','get','Email','payable','../public/language/languages.json','189062ccssmt','language','supplier','../middleware/auth','Mobile_number','Hindi','2782770vefltZ','596dWmcPe','then','params','company','xlsx','user','exports','payable_sum','utils','sheet_to_json','Chinese','2CmiDeW','findOne','master','Company_Name','English','file','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','write','attachment;\x20filename=supplier_Migration_File.xlsx','readFile','Portuguese','German','8kwomFF','suppliers_code','3780900yvhwLF','address','data','name','forEach'];a0_0x73dc=function(){return _0x56d0a4;};return a0_0x73dc();}function a0_0x4f42(_0x2a7cbb,_0x18d0fb){const _0x73dc6d=a0_0x73dc();return a0_0x4f42=function(_0x4f42d8,_0x4a75e2){_0x4f42d8=_0x4f42d8-0x106;let _0x77ce22=_0x73dc6d[_0x4f42d8];return _0x77ce22;},a0_0x4f42(_0x2a7cbb,_0x18d0fb);}router[a0_0x2880d4(0x170)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0x2880d4(0x15f)](a0_0x2880d4(0x160)),async(_0x25a21d,_0x215820)=>{const _0x321a41=a0_0x2880d4,_0x2838a5=_0x25a21d[_0x321a41(0x140)]['filename'],_0x1272a2=await xlsx[_0x321a41(0x144)](_0x321a41(0x162)+_0x2838a5);let _0x2fd326=_0x1272a2[_0x321a41(0x15e)],_0x1dd7ed=xlsx[_0x321a41(0x138)][_0x321a41(0x139)](_0x1272a2[_0x321a41(0x16c)][_0x2fd326[0x0]]);for(const _0x337fe7 of _0x1dd7ed){const _0x5133ed=_0x337fe7[_0x321a41(0x122)],_0x59579b=_0x337fe7[_0x321a41(0x16f)],_0x5b36df=_0x337fe7[_0x321a41(0x14a)],_0x140b5e=_0x337fe7[_0x321a41(0x12d)],_0x5c6a9b=_0x337fe7[_0x321a41(0x126)],_0x135f77=_0x337fe7[_0x321a41(0x13e)];try{let _0x5efd02=await suppliers[_0x321a41(0x13c)]({'name':_0x5133ed});if(!_0x5efd02){const _0x5eddb0=new suppliers({'name':_0x5133ed,'suppliers_code':_0x59579b,'address':_0x5b36df,'mobile':_0x140b5e,'email':_0x5c6a9b,'company':_0x135f77});_0x5efd02=await _0x5eddb0[_0x321a41(0x168)](),_0x25a21d[_0x321a41(0x123)](_0x321a41(0x163),_0x5133ed+_0x321a41(0x110));}else _0x25a21d[_0x321a41(0x123)](_0x321a41(0x152),_0x5133ed+_0x321a41(0x176));}catch(_0x8cbb35){_0x215820[_0x321a41(0x156)](0x1f4)[_0x321a41(0x106)]({'proderror':_0x8cbb35[_0x321a41(0x115)],'aproduct':ProductName});}}_0x215820[_0x321a41(0x153)]('/supplier/view');}),module[a0_0x2880d4(0x136)]=router;