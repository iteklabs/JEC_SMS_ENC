const a0_0x3e46b0=a0_0x4d38;function a0_0x2acd(){const _0x23c486=['$reason','/supplier_import_migrate_file','/view','public/Migration','flash','suppliers_docs','utils','save','Arabic\x20(ae)','30ktEhOg','post','exceljs','errors','Hindi','supplier_payment','log','exports','11824hJymao','redirect','attachment;\x20filename=supplier_Migration_File.xlsx','setHeader','error','German','status','master','render','Chinese','filename','address','796098nRJSjg','single','landline','Supplier_Code','success','Company_Name','sheet_to_json','message','Portuguese','findOne','/supplier/view','English\x20(US)','supplier_product_file','4435970lmuRnO','$amount','Sheets','Spanish','../models/all_models','Mobile_number','body','get','Purchase\x20Return','/view/:id','245241hnqqaT','find','write','reason','Customers','Content-Disposition','now','3MWzWZJ','suppliers_code','PUnits','/products_export_migrate_file','SheetNames','data','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Portuguese\x20(BR)','readFile','mobile','user','language','addWorksheet','json','Router','xlsx','Email','supplier','Purchase','Arabic','aggregate','columns','SalesmanName','Workbook','\x20added\x20successfully','English','doc','../middleware/auth','params','then','originalname','\x20Failed','supplier\x20data\x20add\x20successfully','name','French','public/Migration/','162656NUaBpW','map','purchase_return','email','forEach','payable','supplier.js\x20payment_data','s_payments','company','suppliers','763iKXivw','Name','../public/language/languages.json','254286ThdIkD','amount','send','159818YTqsVR','Content-Type','diskStorage','10wsvCTM','multer'];a0_0x2acd=function(){return _0x23c486;};return a0_0x2acd();}(function(_0x474e53,_0x30d4b4){const _0x199026=a0_0x4d38,_0x30b7ac=_0x474e53();while(!![]){try{const _0x1af608=parseInt(_0x199026(0xdf))/0x1+-parseInt(_0x199026(0xe2))/0x2*(-parseInt(_0x199026(0x122))/0x3)+parseInt(_0x199026(0xd2))/0x4*(parseInt(_0x199026(0xf0))/0x5)+-parseInt(_0x199026(0x104))/0x6+parseInt(_0x199026(0xdc))/0x7*(parseInt(_0x199026(0xf8))/0x8)+parseInt(_0x199026(0x11b))/0x9*(-parseInt(_0x199026(0xe5))/0xa)+-parseInt(_0x199026(0x111))/0xb;if(_0x1af608===_0x30d4b4)break;else _0x30b7ac['push'](_0x30b7ac['shift']());}catch(_0x31c695){_0x30b7ac['push'](_0x30b7ac['shift']());}}}(a0_0x2acd,0x2afcf));const express=require('express'),app=express(),router=express[a0_0x3e46b0(0xbc)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x3e46b0(0x115)),auth=require(a0_0x3e46b0(0xc9)),users=require(a0_0x3e46b0(0xde)),excelJS=require(a0_0x3e46b0(0xf2)),xlsx=require(a0_0x3e46b0(0xbd)),multer=require(a0_0x3e46b0(0xe6));router[a0_0x3e46b0(0x118)](a0_0x3e46b0(0xe9),auth,async(_0x46b764,_0x353b81)=>{const _0x465db7=a0_0x3e46b0;try{const {username:_0x2bbc3d,email:_0xe72da7,role:_0x598ed5}=_0x46b764[_0x465db7(0xb8)],_0x3b66d6=_0x46b764[_0x465db7(0xb8)],_0x236470=await profile[_0x465db7(0x10d)]({'email':_0x3b66d6[_0x465db7(0xd5)]}),_0x113a91=await master_shop[_0x465db7(0x11c)]();console[_0x465db7(0xf6)](_0x465db7(0xff),_0x113a91);const _0x6dc1ab=await suppliers[_0x465db7(0x11c)]();console[_0x465db7(0xf6)](_0x6dc1ab);const _0x580381=await suppliers[_0x465db7(0xc2)]([{'$lookup':{'from':_0x465db7(0xd9),'localField':_0x465db7(0xcf),'foreignField':_0x465db7(0xdb),'as':_0x465db7(0xec)}}]),_0x4094bd=_0x580381[_0x465db7(0xd3)](_0x882d8c=>{const _0xd0368a=_0x465db7;console['log'](_0xd0368a(0x127),_0x882d8c);var _0x963f1d=0x0,_0x2b229b=0x0;return _0x882d8c[_0xd0368a(0xec)][_0xd0368a(0xd6)](_0x1ce7b7=>{const _0x218c7c=_0xd0368a;console[_0x218c7c(0xf6)](_0x218c7c(0xc8),_0x1ce7b7),_0x1ce7b7[_0x218c7c(0x11e)]==_0x218c7c(0xc0)?_0x963f1d+=_0x1ce7b7['amount']:_0x2b229b+=_0x1ce7b7[_0x218c7c(0xe0)];}),_0x882d8c['purchase']=_0x963f1d,_0x882d8c[_0xd0368a(0xd4)]=_0x2b229b,_0x882d8c;});console[_0x465db7(0xf6)](_0x465db7(0xd8),_0x4094bd);if(_0x113a91[0x0][_0x465db7(0xb9)]==_0x465db7(0x10f)){var _0x3726ca=users['English'];console[_0x465db7(0xf6)](_0x3726ca);}else{if(_0x113a91[0x0][_0x465db7(0xb9)]==_0x465db7(0xf4))var _0x3726ca=users[_0x465db7(0xf4)];else{if(_0x113a91[0x0][_0x465db7(0xb9)]==_0x465db7(0xfd))var _0x3726ca=users[_0x465db7(0xfd)];else{if(_0x113a91[0x0]['language']==_0x465db7(0x114))var _0x3726ca=users[_0x465db7(0x114)];else{if(_0x113a91[0x0][_0x465db7(0xb9)]==_0x465db7(0xd0))var _0x3726ca=users[_0x465db7(0xd0)];else{if(_0x113a91[0x0][_0x465db7(0xb9)]==_0x465db7(0x129))var _0x3726ca=users[_0x465db7(0x10c)];else{if(_0x113a91[0x0][_0x465db7(0xb9)]=='Chinese')var _0x3726ca=users[_0x465db7(0x101)];else{if(_0x113a91[0x0][_0x465db7(0xb9)]==_0x465db7(0xef))var _0x3726ca=users['Arabic'];}}}}}}}_0x353b81[_0x465db7(0x100)](_0x465db7(0xbf),{'success':_0x46b764[_0x465db7(0xeb)](_0x465db7(0x108)),'errors':_0x46b764['flash'](_0x465db7(0xf3)),'user':_0x6dc1ab,'profile':_0x236470,'master_shop':_0x113a91,'role':_0x3b66d6,'payment':_0x4094bd,'language':_0x3726ca});}catch(_0x457dfb){console[_0x465db7(0xf6)](_0x457dfb);}}),router['post'](a0_0x3e46b0(0xe9),auth,async(_0x11f733,_0x3deed1)=>{const _0x3cea9d=a0_0x3e46b0;try{const {name:_0x3bd40a,email:_0x2b8280,mobile:_0x51d6b4,company:_0x3054ef,address:_0x335fdc,receivable:_0x505965,payable:_0xda4b1b,code:_0x4d2339,contactperson:_0x290dca,landline:_0x58c358}=_0x11f733['body'],_0x338086=new suppliers({'name':_0x3bd40a,'email':_0x2b8280,'mobile':_0x51d6b4,'company':_0x3054ef,'address':_0x335fdc,'receivable':_0x505965,'payable':_0xda4b1b,'suppliers_code':_0x4d2339,'contactperson':_0x290dca,'landline':_0x58c358}),_0x43956a=await _0x338086[_0x3cea9d(0xee)]();_0x11f733[_0x3cea9d(0xeb)](_0x3cea9d(0x108),_0x3cea9d(0xce)),_0x3deed1['redirect'](_0x3cea9d(0x10e));}catch(_0xf1ee83){console[_0x3cea9d(0xf6)](_0xf1ee83);}}),router[a0_0x3e46b0(0x118)](a0_0x3e46b0(0x11a),auth,async(_0x3d3564,_0x2a8934)=>{const _0x5e7b3b=a0_0x3e46b0;try{const {username:_0x1129a8,email:_0x1763eb,role:_0x33c753}=_0x3d3564[_0x5e7b3b(0xb8)],_0x47a486=_0x3d3564[_0x5e7b3b(0xb8)],_0x22b341=await profile[_0x5e7b3b(0x10d)]({'email':_0x47a486[_0x5e7b3b(0xd5)]}),_0x8db39=await master_shop['find']();console[_0x5e7b3b(0xf6)](_0x5e7b3b(0xff),_0x8db39);const _0x2dc0f8=_0x3d3564[_0x5e7b3b(0xca)]['id'],_0x4bd955=await suppliers['findById'](_0x2dc0f8);console[_0x5e7b3b(0xf6)](_0x4bd955);if(_0x8db39[0x0]['language']=='English\x20(US)'){var _0x5002d8=users[_0x5e7b3b(0xc7)];console[_0x5e7b3b(0xf6)](_0x5002d8);}else{if(_0x8db39[0x0][_0x5e7b3b(0xb9)]==_0x5e7b3b(0xf4))var _0x5002d8=users[_0x5e7b3b(0xf4)];else{if(_0x8db39[0x0][_0x5e7b3b(0xb9)]==_0x5e7b3b(0xfd))var _0x5002d8=users[_0x5e7b3b(0xfd)];else{if(_0x8db39[0x0][_0x5e7b3b(0xb9)]=='Spanish')var _0x5002d8=users[_0x5e7b3b(0x114)];else{if(_0x8db39[0x0][_0x5e7b3b(0xb9)]==_0x5e7b3b(0xd0))var _0x5002d8=users[_0x5e7b3b(0xd0)];else{if(_0x8db39[0x0]['language']==_0x5e7b3b(0x129))var _0x5002d8=users[_0x5e7b3b(0x10c)];else{if(_0x8db39[0x0][_0x5e7b3b(0xb9)]=='Chinese')var _0x5002d8=users[_0x5e7b3b(0x101)];else{if(_0x8db39[0x0][_0x5e7b3b(0xb9)]=='Arabic\x20(ae)')var _0x5002d8=users[_0x5e7b3b(0xc1)];}}}}}}}_0x2a8934[_0x5e7b3b(0x100)](_0x5e7b3b(0xbf),{'success':_0x3d3564['flash']('success'),'errors':_0x3d3564[_0x5e7b3b(0xeb)](_0x5e7b3b(0xf3)),'role':_0x47a486,'profile':_0x22b341,'master_shop':_0x8db39,'user':_0x4bd955,'language':_0x5002d8});}catch(_0x3f9dc1){console[_0x5e7b3b(0xf6)](_0x3f9dc1);}}),router[a0_0x3e46b0(0xf1)](a0_0x3e46b0(0x11a),auth,async(_0x166bb1,_0x1f0270)=>{const _0x361042=a0_0x3e46b0;try{const _0x1356c7=_0x166bb1[_0x361042(0xca)]['id'],_0x15afe0=await suppliers['findById'](_0x1356c7),{name:_0x2f8d3f,email:_0x4c1558,mobile:_0x2e9a29,company:_0xf2568f,address:_0x253e76,receivable:_0x287378,payable:_0x404860,code:_0x3635e4,contactperson:_0x3001ce,landline:_0x2cb766}=_0x166bb1[_0x361042(0x117)];_0x15afe0['name']=_0x2f8d3f,_0x15afe0[_0x361042(0xd5)]=_0x4c1558,_0x15afe0[_0x361042(0x12b)]=_0x2e9a29,_0x15afe0[_0x361042(0xda)]=_0xf2568f,_0x15afe0['address']=_0x253e76,_0x15afe0['receivable']=_0x287378,_0x15afe0[_0x361042(0xd7)]=_0x404860,_0x15afe0[_0x361042(0x123)]=_0x3635e4,_0x15afe0['contactperson']=_0x3001ce,_0x15afe0[_0x361042(0x106)]=_0x2cb766;const _0x31fe68=await _0x15afe0['save']();_0x166bb1['flash']('success','supplier\x20data\x20update\x20successfully'),_0x1f0270[_0x361042(0xf9)](_0x361042(0x10e));}catch(_0x212905){console[_0x361042(0xf6)](_0x212905);}}),router['get']('/view/payment/:id',auth,async(_0x2ded66,_0x53b8f6)=>{const _0x393c26=a0_0x3e46b0;try{const {username:_0x320afc,email:_0x585592,role:_0x2162ef}=_0x2ded66[_0x393c26(0xb8)],_0x4fc8f5=_0x2ded66[_0x393c26(0xb8)],_0x4a307f=await profile[_0x393c26(0x10d)]({'email':_0x4fc8f5['email']}),_0x499034=await master_shop[_0x393c26(0x11c)]();console[_0x393c26(0xf6)](_0x393c26(0xff),_0x499034),console[_0x393c26(0xf6)](_0x2ded66[_0x393c26(0xca)]['id']);const _0x26e688=await suppliers[_0x393c26(0x10d)]({'_id':_0x2ded66[_0x393c26(0xca)]['id']});console[_0x393c26(0xf6)](_0x26e688);const _0x4c3691=await s_payment_data[_0x393c26(0x11c)]({'suppliers':_0x26e688[_0x393c26(0xcf)]});console[_0x393c26(0xf6)](_0x4c3691);const _0x3b3775=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x26e688[_0x393c26(0xcf)]}},{'$match':{'reason':_0x393c26(0xc0)}},{'$group':{'_id':_0x393c26(0xe7),'sum':{'$sum':_0x393c26(0x112)}}}]);console[_0x393c26(0xf6)]('payable_sum',_0x3b3775);const _0x4667d7=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x26e688[_0x393c26(0xcf)]}},{'$match':{'reason':_0x393c26(0x119)}},{'$group':{'_id':_0x393c26(0xe7),'sum':{'$sum':'$amount'}}}]);console[_0x393c26(0xf6)]('receivable_sum',_0x4667d7);if(_0x499034[0x0][_0x393c26(0xb9)]==_0x393c26(0x10f)){var _0x3d1c81=users['English'];console[_0x393c26(0xf6)](_0x3d1c81);}else{if(_0x499034[0x0]['language']=='Hindi')var _0x3d1c81=users[_0x393c26(0xf4)];else{if(_0x499034[0x0][_0x393c26(0xb9)]=='German')var _0x3d1c81=users[_0x393c26(0xfd)];else{if(_0x499034[0x0][_0x393c26(0xb9)]==_0x393c26(0x114))var _0x3d1c81=users[_0x393c26(0x114)];else{if(_0x499034[0x0][_0x393c26(0xb9)]=='French')var _0x3d1c81=users[_0x393c26(0xd0)];else{if(_0x499034[0x0][_0x393c26(0xb9)]==_0x393c26(0x129))var _0x3d1c81=users[_0x393c26(0x10c)];else{if(_0x499034[0x0][_0x393c26(0xb9)]==_0x393c26(0x101))var _0x3d1c81=users['Chinese'];else{if(_0x499034[0x0][_0x393c26(0xb9)]=='Arabic\x20(ae)')var _0x3d1c81=users[_0x393c26(0xc1)];}}}}}}}_0x53b8f6[_0x393c26(0x100)](_0x393c26(0xf5),{'success':_0x2ded66[_0x393c26(0xeb)](_0x393c26(0x108)),'errors':_0x2ded66[_0x393c26(0xeb)](_0x393c26(0xf3)),'role':_0x4fc8f5,'profile':_0x4a307f,'master_shop':_0x499034,'payment':_0x4c3691,'payable':_0x3b3775,'receivable':_0x4667d7,'language':_0x3d1c81});}catch(_0x21110a){console[_0x393c26(0xf6)](_0x21110a);}}),router['get'](a0_0x3e46b0(0x125),auth,async(_0x3d160b,_0x245c70)=>{const _0x48963e=a0_0x3e46b0;try{const _0x5b51a5=new excelJS[(_0x48963e(0xc5))](),_0x5d8f2d=_0x5b51a5[_0x48963e(0xba)](_0x48963e(0x11f));return _0x5d8f2d[_0x48963e(0xc3)]=[{'header':_0x48963e(0xdd),'key':'PBrands','width':0xa},{'header':_0x48963e(0x107),'key':_0x48963e(0x124),'width':0xa},{'header':_0x48963e(0xbe),'key':_0x48963e(0xc4),'width':0xa},{'header':_0x48963e(0x116),'key':_0x48963e(0x103),'width':0xa},{'header':_0x48963e(0x109),'key':'mobile','width':0xa},{'header':'address','key':_0x48963e(0xd5),'width':0xa}],_0x245c70[_0x48963e(0xfb)](_0x48963e(0xe3),_0x48963e(0x128)),_0x245c70[_0x48963e(0xfb)](_0x48963e(0x120),_0x48963e(0xfa)),_0x5b51a5[_0x48963e(0xbd)][_0x48963e(0x11d)](_0x245c70)[_0x48963e(0xcb)](()=>{const _0x4a56a0=_0x48963e;_0x245c70[_0x4a56a0(0xfe)](0xc8);});}catch(_0x2494f8){_0x245c70[_0x48963e(0xfe)](0x190)[_0x48963e(0xe1)]({'errors':_0x2494f8['message']});}});const storage1=multer[a0_0x3e46b0(0xe4)]({'destination':(_0xe51d8c,_0x51bf19,_0x296990)=>{const _0x1d60ad=a0_0x3e46b0;_0x296990(null,_0x1d60ad(0xea));},'filename':(_0x4f190a,_0x5e4dcc,_0x3b7b0a)=>{const _0xd96070=a0_0x3e46b0;_0x3b7b0a(null,Date[_0xd96070(0x121)]()+_0x5e4dcc[_0xd96070(0xcc)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x4d38(_0xcc663,_0x3d5e83){const _0x2acd3e=a0_0x2acd();return a0_0x4d38=function(_0x4d38ab,_0x10f605){_0x4d38ab=_0x4d38ab-0xb8;let _0x3bf3c0=_0x2acd3e[_0x4d38ab];return _0x3bf3c0;},a0_0x4d38(_0xcc663,_0x3d5e83);}router['post'](a0_0x3e46b0(0xe8),auth,uploadMigrate[a0_0x3e46b0(0x105)](a0_0x3e46b0(0x110)),async(_0x1a7091,_0xd9015b)=>{const _0x3b79f4=a0_0x3e46b0,_0x103d3b=_0x1a7091['file'][_0x3b79f4(0x102)],_0x1e2fca=await xlsx[_0x3b79f4(0x12a)](_0x3b79f4(0xd1)+_0x103d3b);let _0x186972=_0x1e2fca[_0x3b79f4(0x126)],_0x150065=xlsx[_0x3b79f4(0xed)][_0x3b79f4(0x10a)](_0x1e2fca[_0x3b79f4(0x113)][_0x186972[0x0]]);for(const _0x31f9d6 of _0x150065){const _0x195b67=_0x31f9d6[_0x3b79f4(0xdd)],_0x3a6dfe=_0x31f9d6[_0x3b79f4(0x107)],_0x3f38c8=_0x31f9d6['address'],_0x157f97=_0x31f9d6[_0x3b79f4(0x116)],_0x2f47f4=_0x31f9d6[_0x3b79f4(0xbe)],_0x54dd32=_0x31f9d6[_0x3b79f4(0x109)];try{let _0x49ec15=await suppliers[_0x3b79f4(0x10d)]({'name':_0x195b67});if(!_0x49ec15){const _0x1a53f8=new suppliers({'name':_0x195b67,'suppliers_code':_0x3a6dfe,'address':_0x3f38c8,'mobile':_0x157f97,'email':_0x2f47f4,'company':_0x54dd32});_0x49ec15=await _0x1a53f8[_0x3b79f4(0xee)](),_0x1a7091['flash'](_0x3b79f4(0x108),_0x195b67+_0x3b79f4(0xc6));}else _0x1a7091['flash'](_0x3b79f4(0xfc),_0x195b67+_0x3b79f4(0xcd));}catch(_0x26bc1a){_0xd9015b[_0x3b79f4(0xfe)](0x1f4)[_0x3b79f4(0xbb)]({'proderror':_0x26bc1a[_0x3b79f4(0x10b)],'aproduct':ProductName});}}_0xd9015b[_0x3b79f4(0xf9)](_0x3b79f4(0x10e));}),module[a0_0x3e46b0(0xf7)]=router;