const a0_0x4dac69=a0_0x26ff;function a0_0x26ff(_0x11755a,_0x3c5d81){const _0x3e6d47=a0_0x3e6d();return a0_0x26ff=function(_0x26ffa4,_0x274474){_0x26ffa4=_0x26ffa4-0x1b4;let _0x2ff241=_0x3e6d47[_0x26ffa4];return _0x2ff241;},a0_0x26ff(_0x11755a,_0x3c5d81);}function a0_0x3e6d(){const _0x5390d7=['payable','forEach','findOne','German','then','Portuguese\x20(BR)','express','Spanish','mobile','supplier.js\x20payment_data','exceljs','exports','success','/products_export_migrate_file','Company_Name','10pNuYEq','Portuguese','7dRVNHc','/supplier/view','PUnits','write','user','French','Customers','errors','receivable','columns','render','originalname','error','12YbdwMr','now','sheet_to_json','/supplier_import_migrate_file','addWorksheet','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','file','address','Sheets','status','1158693njAFVw','7682328LSIzIP','$reason','Arabic\x20(ae)','name','diskStorage','json','/view','Supplier_Code','email','params','Mobile_number','\x20Failed','Purchase','5968084wVolKd','reason','SalesmanName','Name','/view/payment/:id','setHeader','464460FOfSoM','purchase_return','payable_sum','findById','single','supplier\x20data\x20update\x20successfully','company','s_payments','map','Content-Type','supplier\x20data\x20add\x20successfully','attachment;\x20filename=supplier_Migration_File.xlsx','public/Migration','12898179cHMfkB','../models/all_models','supplier','Hindi','flash','post','suppliers_docs','language','$amount','message','find','public/Migration/','utils','Email','send','aggregate','English\x20(US)','xlsx','PBrands','Purchase\x20Return','12guAlgs','save','Arabic','\x20added\x20successfully','log','37047923XkvrvH','Router','master','contactperson','/view/:id','../public/language/languages.json','filename','body','English','redirect','suppliers_code','Chinese','get','183914ndxckZ'];a0_0x3e6d=function(){return _0x5390d7;};return a0_0x3e6d();}(function(_0x1bb70e,_0x29119b){const _0x54779d=a0_0x26ff,_0x44c984=_0x1bb70e();while(!![]){try{const _0x38169a=parseInt(_0x54779d(0x20e))/0x1*(parseInt(_0x54779d(0x1bd))/0x2)+parseInt(_0x54779d(0x1c7))/0x3+-parseInt(_0x54779d(0x1d5))/0x4+-parseInt(_0x54779d(0x1db))/0x5*(parseInt(_0x54779d(0x1fc))/0x6)+-parseInt(_0x54779d(0x220))/0x7*(parseInt(_0x54779d(0x1c8))/0x8)+parseInt(_0x54779d(0x1e8))/0x9*(-parseInt(_0x54779d(0x21e))/0xa)+parseInt(_0x54779d(0x201))/0xb;if(_0x38169a===_0x29119b)break;else _0x44c984['push'](_0x44c984['shift']());}catch(_0x5ad580){_0x44c984['push'](_0x44c984['shift']());}}}(a0_0x3e6d,0xc0031));const express=require(a0_0x4dac69(0x215)),app=express(),router=express[a0_0x4dac69(0x202)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x4dac69(0x1e9)),auth=require('../middleware/auth'),users=require(a0_0x4dac69(0x206)),excelJS=require(a0_0x4dac69(0x219)),xlsx=require(a0_0x4dac69(0x1f9)),multer=require('multer');router[a0_0x4dac69(0x20d)](a0_0x4dac69(0x1ce),auth,async(_0x13365a,_0x19b997)=>{const _0xf021dc=a0_0x4dac69;try{const {username:_0x248282,email:_0x47724f,role:_0x2ce129}=_0x13365a[_0xf021dc(0x1b4)],_0xc4ebbd=_0x13365a[_0xf021dc(0x1b4)],_0x54d4e3=await profile[_0xf021dc(0x211)]({'email':_0xc4ebbd[_0xf021dc(0x1d0)]}),_0x4ea4cd=await master_shop['find']();console['log']('master',_0x4ea4cd);const _0x3290e0=await suppliers[_0xf021dc(0x1f2)]();console[_0xf021dc(0x200)](_0x3290e0);const _0x114823=await suppliers[_0xf021dc(0x1f7)]([{'$lookup':{'from':_0xf021dc(0x1e2),'localField':_0xf021dc(0x1cb),'foreignField':'suppliers','as':_0xf021dc(0x1ee)}}]),_0x3dad24=_0x114823[_0xf021dc(0x1e3)](_0x1e6e34=>{const _0xa0396b=_0xf021dc;console[_0xa0396b(0x200)]('data',_0x1e6e34);var _0x162d63=0x0,_0x12ba32=0x0;return _0x1e6e34[_0xa0396b(0x1ee)][_0xa0396b(0x210)](_0x4156f6=>{const _0x2b5926=_0xa0396b;console['log']('doc',_0x4156f6),_0x4156f6[_0x2b5926(0x1d6)]=='Purchase'?_0x162d63+=_0x4156f6['amount']:_0x12ba32+=_0x4156f6['amount'];}),_0x1e6e34['purchase']=_0x162d63,_0x1e6e34[_0xa0396b(0x1dc)]=_0x12ba32,_0x1e6e34;});console['log'](_0xf021dc(0x218),_0x3dad24);if(_0x4ea4cd[0x0][_0xf021dc(0x1ef)]==_0xf021dc(0x1f8)){var _0x13374=users['English'];console['log'](_0x13374);}else{if(_0x4ea4cd[0x0][_0xf021dc(0x1ef)]==_0xf021dc(0x1eb))var _0x13374=users[_0xf021dc(0x1eb)];else{if(_0x4ea4cd[0x0][_0xf021dc(0x1ef)]==_0xf021dc(0x212))var _0x13374=users[_0xf021dc(0x212)];else{if(_0x4ea4cd[0x0][_0xf021dc(0x1ef)]==_0xf021dc(0x216))var _0x13374=users[_0xf021dc(0x216)];else{if(_0x4ea4cd[0x0]['language']==_0xf021dc(0x1b5))var _0x13374=users['French'];else{if(_0x4ea4cd[0x0][_0xf021dc(0x1ef)]==_0xf021dc(0x214))var _0x13374=users[_0xf021dc(0x21f)];else{if(_0x4ea4cd[0x0]['language']==_0xf021dc(0x20c))var _0x13374=users[_0xf021dc(0x20c)];else{if(_0x4ea4cd[0x0][_0xf021dc(0x1ef)]==_0xf021dc(0x1ca))var _0x13374=users[_0xf021dc(0x1fe)];}}}}}}}_0x19b997[_0xf021dc(0x1ba)](_0xf021dc(0x1ea),{'success':_0x13365a[_0xf021dc(0x1ec)](_0xf021dc(0x21b)),'errors':_0x13365a[_0xf021dc(0x1ec)]('errors'),'user':_0x3290e0,'profile':_0x54d4e3,'master_shop':_0x4ea4cd,'role':_0xc4ebbd,'payment':_0x3dad24,'language':_0x13374});}catch(_0x2a0816){console[_0xf021dc(0x200)](_0x2a0816);}}),router[a0_0x4dac69(0x1ed)]('/view',auth,async(_0x81d405,_0x86e3cb)=>{const _0x38ab0d=a0_0x4dac69;try{const {name:_0x1368ac,email:_0xdf4a9b,mobile:_0x2cb725,company:_0x6dfd47,address:_0x29eac6,receivable:_0x47eb9d,payable:_0x3c9d4a,code:_0xd96637,contactperson:_0x3a3def,landline:_0x3af81c}=_0x81d405['body'],_0x5ab90c=new suppliers({'name':_0x1368ac,'email':_0xdf4a9b,'mobile':_0x2cb725,'company':_0x6dfd47,'address':_0x29eac6,'receivable':_0x47eb9d,'payable':_0x3c9d4a,'suppliers_code':_0xd96637,'contactperson':_0x3a3def,'landline':_0x3af81c}),_0x4ddefe=await _0x5ab90c[_0x38ab0d(0x1fd)]();_0x81d405[_0x38ab0d(0x1ec)]('success',_0x38ab0d(0x1e5)),_0x86e3cb[_0x38ab0d(0x20a)]('/supplier/view');}catch(_0x3149f9){console[_0x38ab0d(0x200)](_0x3149f9);}}),router[a0_0x4dac69(0x20d)]('/view/:id',auth,async(_0x3aeeef,_0x525422)=>{const _0xeb7dd9=a0_0x4dac69;try{const {username:_0xbb0b6d,email:_0xc987f4,role:_0x3caa34}=_0x3aeeef[_0xeb7dd9(0x1b4)],_0x99471a=_0x3aeeef[_0xeb7dd9(0x1b4)],_0x20deeb=await profile['findOne']({'email':_0x99471a[_0xeb7dd9(0x1d0)]}),_0x3441f8=await master_shop[_0xeb7dd9(0x1f2)]();console[_0xeb7dd9(0x200)](_0xeb7dd9(0x203),_0x3441f8);const _0x2b0807=_0x3aeeef[_0xeb7dd9(0x1d1)]['id'],_0x3c6ffc=await suppliers[_0xeb7dd9(0x1de)](_0x2b0807);console[_0xeb7dd9(0x200)](_0x3c6ffc);if(_0x3441f8[0x0][_0xeb7dd9(0x1ef)]==_0xeb7dd9(0x1f8)){var _0x4897e4=users[_0xeb7dd9(0x209)];console[_0xeb7dd9(0x200)](_0x4897e4);}else{if(_0x3441f8[0x0][_0xeb7dd9(0x1ef)]==_0xeb7dd9(0x1eb))var _0x4897e4=users['Hindi'];else{if(_0x3441f8[0x0][_0xeb7dd9(0x1ef)]==_0xeb7dd9(0x212))var _0x4897e4=users[_0xeb7dd9(0x212)];else{if(_0x3441f8[0x0][_0xeb7dd9(0x1ef)]=='Spanish')var _0x4897e4=users[_0xeb7dd9(0x216)];else{if(_0x3441f8[0x0][_0xeb7dd9(0x1ef)]==_0xeb7dd9(0x1b5))var _0x4897e4=users[_0xeb7dd9(0x1b5)];else{if(_0x3441f8[0x0][_0xeb7dd9(0x1ef)]==_0xeb7dd9(0x214))var _0x4897e4=users[_0xeb7dd9(0x21f)];else{if(_0x3441f8[0x0][_0xeb7dd9(0x1ef)]=='Chinese')var _0x4897e4=users['Chinese'];else{if(_0x3441f8[0x0][_0xeb7dd9(0x1ef)]==_0xeb7dd9(0x1ca))var _0x4897e4=users['Arabic'];}}}}}}}_0x525422[_0xeb7dd9(0x1ba)]('supplier',{'success':_0x3aeeef[_0xeb7dd9(0x1ec)](_0xeb7dd9(0x21b)),'errors':_0x3aeeef[_0xeb7dd9(0x1ec)](_0xeb7dd9(0x1b7)),'role':_0x99471a,'profile':_0x20deeb,'master_shop':_0x3441f8,'user':_0x3c6ffc,'language':_0x4897e4});}catch(_0x571911){console[_0xeb7dd9(0x200)](_0x571911);}}),router[a0_0x4dac69(0x1ed)](a0_0x4dac69(0x205),auth,async(_0x3fb65a,_0x123731)=>{const _0x4f60ec=a0_0x4dac69;try{const _0xb6b72d=_0x3fb65a[_0x4f60ec(0x1d1)]['id'],_0x22746e=await suppliers[_0x4f60ec(0x1de)](_0xb6b72d),{name:_0x59b880,email:_0x4d4743,mobile:_0xc8c6b3,company:_0x45f20c,address:_0x2ff3a3,receivable:_0x2f7a92,payable:_0x101237,code:_0x256889,contactperson:_0x561031,landline:_0x2144cd}=_0x3fb65a[_0x4f60ec(0x208)];_0x22746e[_0x4f60ec(0x1cb)]=_0x59b880,_0x22746e[_0x4f60ec(0x1d0)]=_0x4d4743,_0x22746e[_0x4f60ec(0x217)]=_0xc8c6b3,_0x22746e[_0x4f60ec(0x1e1)]=_0x45f20c,_0x22746e['address']=_0x2ff3a3,_0x22746e[_0x4f60ec(0x1b8)]=_0x2f7a92,_0x22746e[_0x4f60ec(0x20f)]=_0x101237,_0x22746e[_0x4f60ec(0x20b)]=_0x256889,_0x22746e[_0x4f60ec(0x204)]=_0x561031,_0x22746e['landline']=_0x2144cd;const _0x5a0c6e=await _0x22746e['save']();_0x3fb65a[_0x4f60ec(0x1ec)](_0x4f60ec(0x21b),_0x4f60ec(0x1e0)),_0x123731[_0x4f60ec(0x20a)](_0x4f60ec(0x221));}catch(_0x51408e){console[_0x4f60ec(0x200)](_0x51408e);}}),router['get'](a0_0x4dac69(0x1d9),auth,async(_0x1bd3fc,_0x4c45d7)=>{const _0x36b89d=a0_0x4dac69;try{const {username:_0x54c3e5,email:_0x577495,role:_0x2a2a84}=_0x1bd3fc[_0x36b89d(0x1b4)],_0x4ddbf7=_0x1bd3fc[_0x36b89d(0x1b4)],_0x270e59=await profile[_0x36b89d(0x211)]({'email':_0x4ddbf7[_0x36b89d(0x1d0)]}),_0x5c6645=await master_shop['find']();console[_0x36b89d(0x200)](_0x36b89d(0x203),_0x5c6645),console['log'](_0x1bd3fc[_0x36b89d(0x1d1)]['id']);const _0x2d5b47=await suppliers['findOne']({'_id':_0x1bd3fc[_0x36b89d(0x1d1)]['id']});console[_0x36b89d(0x200)](_0x2d5b47);const _0xe88dbb=await s_payment_data[_0x36b89d(0x1f2)]({'suppliers':_0x2d5b47[_0x36b89d(0x1cb)]});console[_0x36b89d(0x200)](_0xe88dbb);const _0x339237=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x2d5b47['name']}},{'$match':{'reason':_0x36b89d(0x1d4)}},{'$group':{'_id':_0x36b89d(0x1c9),'sum':{'$sum':_0x36b89d(0x1f0)}}}]);console[_0x36b89d(0x200)](_0x36b89d(0x1dd),_0x339237);const _0x26c2a7=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x2d5b47['name']}},{'$match':{'reason':_0x36b89d(0x1fb)}},{'$group':{'_id':_0x36b89d(0x1c9),'sum':{'$sum':_0x36b89d(0x1f0)}}}]);console[_0x36b89d(0x200)]('receivable_sum',_0x26c2a7);if(_0x5c6645[0x0][_0x36b89d(0x1ef)]==_0x36b89d(0x1f8)){var _0x14d48a=users[_0x36b89d(0x209)];console[_0x36b89d(0x200)](_0x14d48a);}else{if(_0x5c6645[0x0]['language']==_0x36b89d(0x1eb))var _0x14d48a=users[_0x36b89d(0x1eb)];else{if(_0x5c6645[0x0]['language']==_0x36b89d(0x212))var _0x14d48a=users[_0x36b89d(0x212)];else{if(_0x5c6645[0x0]['language']==_0x36b89d(0x216))var _0x14d48a=users[_0x36b89d(0x216)];else{if(_0x5c6645[0x0][_0x36b89d(0x1ef)]==_0x36b89d(0x1b5))var _0x14d48a=users['French'];else{if(_0x5c6645[0x0][_0x36b89d(0x1ef)]==_0x36b89d(0x214))var _0x14d48a=users[_0x36b89d(0x21f)];else{if(_0x5c6645[0x0]['language']=='Chinese')var _0x14d48a=users['Chinese'];else{if(_0x5c6645[0x0]['language']==_0x36b89d(0x1ca))var _0x14d48a=users[_0x36b89d(0x1fe)];}}}}}}}_0x4c45d7[_0x36b89d(0x1ba)]('supplier_payment',{'success':_0x1bd3fc[_0x36b89d(0x1ec)]('success'),'errors':_0x1bd3fc[_0x36b89d(0x1ec)]('errors'),'role':_0x4ddbf7,'profile':_0x270e59,'master_shop':_0x5c6645,'payment':_0xe88dbb,'payable':_0x339237,'receivable':_0x26c2a7,'language':_0x14d48a});}catch(_0x3ed0a2){console[_0x36b89d(0x200)](_0x3ed0a2);}}),router[a0_0x4dac69(0x20d)](a0_0x4dac69(0x21c),auth,async(_0x3d6507,_0x5cac29)=>{const _0xb1603d=a0_0x4dac69;try{const _0xf9c6a3=new excelJS['Workbook'](),_0x1ebb30=_0xf9c6a3[_0xb1603d(0x1c1)](_0xb1603d(0x1b6));return _0x1ebb30[_0xb1603d(0x1b9)]=[{'header':'Name','key':_0xb1603d(0x1fa),'width':0xa},{'header':_0xb1603d(0x1cf),'key':_0xb1603d(0x222),'width':0xa},{'header':_0xb1603d(0x1f5),'key':_0xb1603d(0x1d7),'width':0xa},{'header':_0xb1603d(0x1d2),'key':_0xb1603d(0x1c4),'width':0xa},{'header':'Company_Name','key':_0xb1603d(0x217),'width':0xa},{'header':_0xb1603d(0x1c4),'key':_0xb1603d(0x1d0),'width':0xa}],_0x5cac29[_0xb1603d(0x1da)](_0xb1603d(0x1e4),_0xb1603d(0x1c2)),_0x5cac29[_0xb1603d(0x1da)]('Content-Disposition',_0xb1603d(0x1e6)),_0xf9c6a3[_0xb1603d(0x1f9)][_0xb1603d(0x223)](_0x5cac29)[_0xb1603d(0x213)](()=>{_0x5cac29['status'](0xc8);});}catch(_0x538fbc){_0x5cac29[_0xb1603d(0x1c6)](0x190)[_0xb1603d(0x1f6)]({'errors':_0x538fbc[_0xb1603d(0x1f1)]});}});const storage1=multer[a0_0x4dac69(0x1cc)]({'destination':(_0x39c0fa,_0x391c54,_0x20bb25)=>{const _0x19e0bf=a0_0x4dac69;_0x20bb25(null,_0x19e0bf(0x1e7));},'filename':(_0x2d5ff2,_0x5cf338,_0x3441df)=>{const _0x372f10=a0_0x4dac69;_0x3441df(null,Date[_0x372f10(0x1be)]()+_0x5cf338[_0x372f10(0x1bb)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x4dac69(0x1ed)](a0_0x4dac69(0x1c0),auth,uploadMigrate[a0_0x4dac69(0x1df)]('supplier_product_file'),async(_0x4da959,_0xb5ce68)=>{const _0x42e287=a0_0x4dac69,_0x4d9ee2=_0x4da959[_0x42e287(0x1c3)][_0x42e287(0x207)],_0x12f85a=await xlsx['readFile'](_0x42e287(0x1f3)+_0x4d9ee2);let _0x4f33a8=_0x12f85a['SheetNames'],_0x468e09=xlsx[_0x42e287(0x1f4)][_0x42e287(0x1bf)](_0x12f85a[_0x42e287(0x1c5)][_0x4f33a8[0x0]]);for(const _0x428e25 of _0x468e09){const _0x4e7cf1=_0x428e25[_0x42e287(0x1d8)],_0x118a49=_0x428e25[_0x42e287(0x1cf)],_0x182be0=_0x428e25['address'],_0x1ef77c=_0x428e25['Mobile_number'],_0xd4fc10=_0x428e25['Email'],_0x423bb2=_0x428e25[_0x42e287(0x21d)];try{let _0x3f7d4c=await suppliers[_0x42e287(0x211)]({'name':_0x4e7cf1});if(!_0x3f7d4c){const _0x42da9d=new suppliers({'name':_0x4e7cf1,'suppliers_code':_0x118a49,'address':_0x182be0,'mobile':_0x1ef77c,'email':_0xd4fc10,'company':_0x423bb2});_0x3f7d4c=await _0x42da9d['save'](),_0x4da959['flash'](_0x42e287(0x21b),_0x4e7cf1+_0x42e287(0x1ff));}else _0x4da959[_0x42e287(0x1ec)](_0x42e287(0x1bc),_0x4e7cf1+_0x42e287(0x1d3));}catch(_0xb83db0){_0xb5ce68['status'](0x1f4)[_0x42e287(0x1cd)]({'proderror':_0xb83db0['message'],'aproduct':ProductName});}}_0xb5ce68['redirect']('/supplier/view');}),module[a0_0x4dac69(0x21a)]=router;