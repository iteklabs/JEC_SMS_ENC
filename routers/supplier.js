function a0_0x40a0(_0x2369eb,_0x5ca9f6){const _0x44a453=a0_0x44a4();return a0_0x40a0=function(_0x40a000,_0x30d7fb){_0x40a000=_0x40a000-0x65;let _0x2852d9=_0x44a453[_0x40a000];return _0x2852d9;},a0_0x40a0(_0x2369eb,_0x5ca9f6);}const a0_0x3fe265=a0_0x40a0;(function(_0x478f9c,_0x513f57){const _0x2634e8=a0_0x40a0,_0x2709f2=_0x478f9c();while(!![]){try{const _0x55ff0a=parseInt(_0x2634e8(0x8d))/0x1*(parseInt(_0x2634e8(0x7a))/0x2)+-parseInt(_0x2634e8(0x8e))/0x3+-parseInt(_0x2634e8(0xa3))/0x4*(parseInt(_0x2634e8(0xb8))/0x5)+-parseInt(_0x2634e8(0x82))/0x6*(parseInt(_0x2634e8(0x76))/0x7)+parseInt(_0x2634e8(0x83))/0x8*(parseInt(_0x2634e8(0xb0))/0x9)+parseInt(_0x2634e8(0x72))/0xa+-parseInt(_0x2634e8(0xc7))/0xb;if(_0x55ff0a===_0x513f57)break;else _0x2709f2['push'](_0x2709f2['shift']());}catch(_0x3f91d3){_0x2709f2['push'](_0x2709f2['shift']());}}}(a0_0x44a4,0x96149));function a0_0x44a4(){const _0x176ad5=['8202hGKHPX','17736PntNEW','filename','xlsx','attachment;\x20filename=supplier_Migration_File.xlsx','render','get','write','public/Migration/','columns','supplier_payment','9455wwuvSP','1634694RAoUjY','/supplier/view','redirect','name','/products_export_migrate_file','Customers','Content-Type','utils','diskStorage','save','../models/all_models','mobile','../middleware/auth','aggregate','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','supplier\x20data\x20update\x20successfully','receivable','PBrands','Sheets','Company_Name','flash','4NiphLp','Router','supplier\x20data\x20add\x20successfully','purchase_return','findById','Arabic\x20(ae)','suppliers','exports','supplier.js\x20payment_data','then','doc','Chinese','German','4113ydAaxL','addWorksheet','\x20Failed','map','status','suppliers_docs','setHeader','email','848950WZUugQ','readFile','French','English','public/Migration','error','sheet_to_json','originalname','log','s_payments','Portuguese\x20(BR)','\x20added\x20successfully','file','params','Email','6285301xwDern','post','master','English\x20(US)','body','$amount','PUnits','exceljs','/view/:id','send','../public/language/languages.json','amount','$reason','message','/supplier_import_migrate_file','reason','forEach','language','address','Hindi','Name','Workbook','contactperson','find','now','1232680aQPlis','/view/payment/:id','/view','data','1799WNpBus','json','Portuguese','findOne','236owucEZ','supplier_product_file','Spanish','success','errors','Arabic','multer','user'];a0_0x44a4=function(){return _0x176ad5;};return a0_0x44a4();}const express=require('express'),app=express(),router=express[a0_0x3fe265(0xa4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x3fe265(0x98)),auth=require(a0_0x3fe265(0x9a)),users=require(a0_0x3fe265(0xd1)),excelJS=require(a0_0x3fe265(0xce)),xlsx=require(a0_0x3fe265(0x85)),multer=require(a0_0x3fe265(0x80));router[a0_0x3fe265(0x88)]('/view',auth,async(_0x175c40,_0x11568e)=>{const _0x565f2c=a0_0x3fe265;try{const {username:_0x42d3aa,email:_0x5ab8fe,role:_0x2f4a54}=_0x175c40[_0x565f2c(0x81)],_0x1599e8=_0x175c40[_0x565f2c(0x81)],_0x3fe443=await profile[_0x565f2c(0x79)]({'email':_0x1599e8[_0x565f2c(0xb7)]}),_0x5a9f62=await master_shop[_0x565f2c(0x70)]();console[_0x565f2c(0xc0)](_0x565f2c(0xc9),_0x5a9f62);const _0x1f538f=await suppliers['find']();console[_0x565f2c(0xc0)](_0x1f538f);const _0x49ac6a=await suppliers[_0x565f2c(0x9b)]([{'$lookup':{'from':_0x565f2c(0xc1),'localField':'name','foreignField':_0x565f2c(0xa9),'as':'suppliers_docs'}}]),_0x506777=_0x49ac6a[_0x565f2c(0xb3)](_0xcdd8f7=>{const _0x31b4f1=_0x565f2c;console[_0x31b4f1(0xc0)](_0x31b4f1(0x75),_0xcdd8f7);var _0x373a6c=0x0,_0x57a257=0x0;return _0xcdd8f7[_0x31b4f1(0xb5)][_0x31b4f1(0x69)](_0x4ebe43=>{const _0x10c608=_0x31b4f1;console[_0x10c608(0xc0)](_0x10c608(0xad),_0x4ebe43),_0x4ebe43[_0x10c608(0x68)]=='Purchase'?_0x373a6c+=_0x4ebe43[_0x10c608(0xd2)]:_0x57a257+=_0x4ebe43[_0x10c608(0xd2)];}),_0xcdd8f7['purchase']=_0x373a6c,_0xcdd8f7[_0x31b4f1(0xa6)]=_0x57a257,_0xcdd8f7;});console[_0x565f2c(0xc0)](_0x565f2c(0xab),_0x506777);if(_0x5a9f62[0x0]['language']==_0x565f2c(0xca)){var _0x2f05f9=users[_0x565f2c(0xbb)];console[_0x565f2c(0xc0)](_0x2f05f9);}else{if(_0x5a9f62[0x0][_0x565f2c(0x6a)]==_0x565f2c(0x6c))var _0x2f05f9=users[_0x565f2c(0x6c)];else{if(_0x5a9f62[0x0][_0x565f2c(0x6a)]=='German')var _0x2f05f9=users[_0x565f2c(0xaf)];else{if(_0x5a9f62[0x0][_0x565f2c(0x6a)]==_0x565f2c(0x7c))var _0x2f05f9=users[_0x565f2c(0x7c)];else{if(_0x5a9f62[0x0][_0x565f2c(0x6a)]=='French')var _0x2f05f9=users['French'];else{if(_0x5a9f62[0x0][_0x565f2c(0x6a)]==_0x565f2c(0xc2))var _0x2f05f9=users[_0x565f2c(0x78)];else{if(_0x5a9f62[0x0][_0x565f2c(0x6a)]=='Chinese')var _0x2f05f9=users[_0x565f2c(0xae)];else{if(_0x5a9f62[0x0][_0x565f2c(0x6a)]==_0x565f2c(0xa8))var _0x2f05f9=users[_0x565f2c(0x7f)];}}}}}}}_0x11568e[_0x565f2c(0x87)]('supplier',{'success':_0x175c40[_0x565f2c(0xa2)](_0x565f2c(0x7d)),'errors':_0x175c40[_0x565f2c(0xa2)](_0x565f2c(0x7e)),'user':_0x1f538f,'profile':_0x3fe443,'master_shop':_0x5a9f62,'role':_0x1599e8,'payment':_0x506777,'language':_0x2f05f9});}catch(_0x188eff){console[_0x565f2c(0xc0)](_0x188eff);}}),router[a0_0x3fe265(0xc8)](a0_0x3fe265(0x74),auth,async(_0x157d07,_0x542d24)=>{const _0x3ce991=a0_0x3fe265;try{const {name:_0x41bd3d,email:_0x5338a4,mobile:_0xc62fcc,company:_0xb15ce5,address:_0xd1252d,receivable:_0x53e8ec,payable:_0x558b12,code:_0x45ff24,contactperson:_0xa2d740,landline:_0x26bcdc}=_0x157d07[_0x3ce991(0xcb)],_0x2f6b23=new suppliers({'name':_0x41bd3d,'email':_0x5338a4,'mobile':_0xc62fcc,'company':_0xb15ce5,'address':_0xd1252d,'receivable':_0x53e8ec,'payable':_0x558b12,'suppliers_code':_0x45ff24,'contactperson':_0xa2d740,'landline':_0x26bcdc}),_0x3e8bba=await _0x2f6b23[_0x3ce991(0x97)]();_0x157d07[_0x3ce991(0xa2)](_0x3ce991(0x7d),_0x3ce991(0xa5)),_0x542d24['redirect'](_0x3ce991(0x8f));}catch(_0xba9d90){console[_0x3ce991(0xc0)](_0xba9d90);}}),router[a0_0x3fe265(0x88)](a0_0x3fe265(0xcf),auth,async(_0x3b1f31,_0x35da37)=>{const _0x52c273=a0_0x3fe265;try{const {username:_0xaf0e7f,email:_0x314b09,role:_0x2834de}=_0x3b1f31[_0x52c273(0x81)],_0x55e333=_0x3b1f31[_0x52c273(0x81)],_0x5d83ee=await profile['findOne']({'email':_0x55e333[_0x52c273(0xb7)]}),_0x36e5f9=await master_shop['find']();console[_0x52c273(0xc0)](_0x52c273(0xc9),_0x36e5f9);const _0x5c924a=_0x3b1f31[_0x52c273(0xc5)]['id'],_0x31313b=await suppliers[_0x52c273(0xa7)](_0x5c924a);console[_0x52c273(0xc0)](_0x31313b);if(_0x36e5f9[0x0]['language']=='English\x20(US)'){var _0x497473=users[_0x52c273(0xbb)];console[_0x52c273(0xc0)](_0x497473);}else{if(_0x36e5f9[0x0][_0x52c273(0x6a)]=='Hindi')var _0x497473=users[_0x52c273(0x6c)];else{if(_0x36e5f9[0x0]['language']==_0x52c273(0xaf))var _0x497473=users['German'];else{if(_0x36e5f9[0x0][_0x52c273(0x6a)]==_0x52c273(0x7c))var _0x497473=users[_0x52c273(0x7c)];else{if(_0x36e5f9[0x0][_0x52c273(0x6a)]==_0x52c273(0xba))var _0x497473=users[_0x52c273(0xba)];else{if(_0x36e5f9[0x0]['language']=='Portuguese\x20(BR)')var _0x497473=users[_0x52c273(0x78)];else{if(_0x36e5f9[0x0]['language']=='Chinese')var _0x497473=users[_0x52c273(0xae)];else{if(_0x36e5f9[0x0][_0x52c273(0x6a)]==_0x52c273(0xa8))var _0x497473=users[_0x52c273(0x7f)];}}}}}}}_0x35da37[_0x52c273(0x87)]('supplier',{'success':_0x3b1f31[_0x52c273(0xa2)]('success'),'errors':_0x3b1f31[_0x52c273(0xa2)](_0x52c273(0x7e)),'role':_0x55e333,'profile':_0x5d83ee,'master_shop':_0x36e5f9,'user':_0x31313b,'language':_0x497473});}catch(_0x608fef){console[_0x52c273(0xc0)](_0x608fef);}}),router[a0_0x3fe265(0xc8)]('/view/:id',auth,async(_0x200a10,_0x234c22)=>{const _0x4ccfaf=a0_0x3fe265;try{const _0x3e2898=_0x200a10[_0x4ccfaf(0xc5)]['id'],_0x30a71d=await suppliers[_0x4ccfaf(0xa7)](_0x3e2898),{name:_0x2757dd,email:_0x14443b,mobile:_0x2404f8,company:_0x1d53ee,address:_0x1dc64a,receivable:_0x1e19a0,payable:_0x18d8c1,code:_0x344508,contactperson:_0x278e02,landline:_0x2c06e7}=_0x200a10[_0x4ccfaf(0xcb)];_0x30a71d[_0x4ccfaf(0x91)]=_0x2757dd,_0x30a71d[_0x4ccfaf(0xb7)]=_0x14443b,_0x30a71d['mobile']=_0x2404f8,_0x30a71d['company']=_0x1d53ee,_0x30a71d[_0x4ccfaf(0x6b)]=_0x1dc64a,_0x30a71d[_0x4ccfaf(0x9e)]=_0x1e19a0,_0x30a71d['payable']=_0x18d8c1,_0x30a71d['suppliers_code']=_0x344508,_0x30a71d[_0x4ccfaf(0x6f)]=_0x278e02,_0x30a71d['landline']=_0x2c06e7;const _0x5681bd=await _0x30a71d['save']();_0x200a10['flash']('success',_0x4ccfaf(0x9d)),_0x234c22[_0x4ccfaf(0x90)](_0x4ccfaf(0x8f));}catch(_0x3756cd){console[_0x4ccfaf(0xc0)](_0x3756cd);}}),router[a0_0x3fe265(0x88)](a0_0x3fe265(0x73),auth,async(_0x168042,_0x2ec32b)=>{const _0x366998=a0_0x3fe265;try{const {username:_0x5d6625,email:_0xa2fb04,role:_0x46afc3}=_0x168042[_0x366998(0x81)],_0x2b80b8=_0x168042[_0x366998(0x81)],_0x281914=await profile[_0x366998(0x79)]({'email':_0x2b80b8[_0x366998(0xb7)]}),_0x5618ee=await master_shop['find']();console['log']('master',_0x5618ee),console['log'](_0x168042[_0x366998(0xc5)]['id']);const _0x1f50c4=await suppliers['findOne']({'_id':_0x168042[_0x366998(0xc5)]['id']});console[_0x366998(0xc0)](_0x1f50c4);const _0x6dd3ec=await s_payment_data[_0x366998(0x70)]({'suppliers':_0x1f50c4[_0x366998(0x91)]});console[_0x366998(0xc0)](_0x6dd3ec);const _0x4fb0a8=await s_payment_data[_0x366998(0x9b)]([{'$match':{'suppliers':_0x1f50c4[_0x366998(0x91)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x366998(0x65),'sum':{'$sum':_0x366998(0xcc)}}}]);console[_0x366998(0xc0)]('payable_sum',_0x4fb0a8);const _0x39bdc3=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x1f50c4['name']}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x366998(0xcc)}}}]);console[_0x366998(0xc0)]('receivable_sum',_0x39bdc3);if(_0x5618ee[0x0][_0x366998(0x6a)]==_0x366998(0xca)){var _0x162f4f=users['English'];console[_0x366998(0xc0)](_0x162f4f);}else{if(_0x5618ee[0x0][_0x366998(0x6a)]==_0x366998(0x6c))var _0x162f4f=users[_0x366998(0x6c)];else{if(_0x5618ee[0x0][_0x366998(0x6a)]==_0x366998(0xaf))var _0x162f4f=users[_0x366998(0xaf)];else{if(_0x5618ee[0x0][_0x366998(0x6a)]==_0x366998(0x7c))var _0x162f4f=users[_0x366998(0x7c)];else{if(_0x5618ee[0x0][_0x366998(0x6a)]=='French')var _0x162f4f=users[_0x366998(0xba)];else{if(_0x5618ee[0x0]['language']=='Portuguese\x20(BR)')var _0x162f4f=users[_0x366998(0x78)];else{if(_0x5618ee[0x0][_0x366998(0x6a)]==_0x366998(0xae))var _0x162f4f=users[_0x366998(0xae)];else{if(_0x5618ee[0x0]['language']==_0x366998(0xa8))var _0x162f4f=users[_0x366998(0x7f)];}}}}}}}_0x2ec32b[_0x366998(0x87)](_0x366998(0x8c),{'success':_0x168042[_0x366998(0xa2)](_0x366998(0x7d)),'errors':_0x168042[_0x366998(0xa2)](_0x366998(0x7e)),'role':_0x2b80b8,'profile':_0x281914,'master_shop':_0x5618ee,'payment':_0x6dd3ec,'payable':_0x4fb0a8,'receivable':_0x39bdc3,'language':_0x162f4f});}catch(_0x3e0af1){console[_0x366998(0xc0)](_0x3e0af1);}}),router[a0_0x3fe265(0x88)](a0_0x3fe265(0x92),auth,async(_0x5ed249,_0xd80534)=>{const _0x382b12=a0_0x3fe265;try{const _0x436fba=new excelJS[(_0x382b12(0x6e))](),_0x389921=_0x436fba[_0x382b12(0xb1)](_0x382b12(0x93));return _0x389921[_0x382b12(0x8b)]=[{'header':'Name','key':_0x382b12(0x9f),'width':0xa},{'header':'Supplier_Code','key':_0x382b12(0xcd),'width':0xa},{'header':_0x382b12(0xc6),'key':'SalesmanName','width':0xa},{'header':'Mobile_number','key':'address','width':0xa},{'header':_0x382b12(0xa1),'key':_0x382b12(0x99),'width':0xa},{'header':'address','key':'email','width':0xa}],_0xd80534['setHeader'](_0x382b12(0x94),_0x382b12(0x9c)),_0xd80534[_0x382b12(0xb6)]('Content-Disposition',_0x382b12(0x86)),_0x436fba[_0x382b12(0x85)][_0x382b12(0x89)](_0xd80534)[_0x382b12(0xac)](()=>{const _0x5735a9=_0x382b12;_0xd80534[_0x5735a9(0xb4)](0xc8);});}catch(_0x3b36f8){_0xd80534[_0x382b12(0xb4)](0x190)[_0x382b12(0xd0)]({'errors':_0x3b36f8[_0x382b12(0x66)]});}});const storage1=multer[a0_0x3fe265(0x96)]({'destination':(_0x397e7d,_0x37dcd3,_0x12238f)=>{const _0x27e0b5=a0_0x3fe265;_0x12238f(null,_0x27e0b5(0xbc));},'filename':(_0x44687d,_0x36807f,_0x58b422)=>{const _0x37a89e=a0_0x3fe265;_0x58b422(null,Date[_0x37a89e(0x71)]()+_0x36807f[_0x37a89e(0xbf)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x3fe265(0xc8)](a0_0x3fe265(0x67),auth,uploadMigrate['single'](a0_0x3fe265(0x7b)),async(_0x1622fe,_0x5334f8)=>{const _0x3f2a23=a0_0x3fe265,_0x4386c5=_0x1622fe[_0x3f2a23(0xc4)][_0x3f2a23(0x84)],_0x494d38=await xlsx[_0x3f2a23(0xb9)](_0x3f2a23(0x8a)+_0x4386c5);let _0x3fde9a=_0x494d38['SheetNames'],_0x31c307=xlsx[_0x3f2a23(0x95)][_0x3f2a23(0xbe)](_0x494d38[_0x3f2a23(0xa0)][_0x3fde9a[0x0]]);for(const _0x16a6cb of _0x31c307){const _0x125495=_0x16a6cb[_0x3f2a23(0x6d)],_0x70b574=_0x16a6cb['Supplier_Code'],_0x8b7698=_0x16a6cb[_0x3f2a23(0x6b)],_0x16dd9e=_0x16a6cb['Mobile_number'],_0x4a23c4=_0x16a6cb[_0x3f2a23(0xc6)],_0x24586d=_0x16a6cb[_0x3f2a23(0xa1)];try{let _0x2b5e1e=await suppliers[_0x3f2a23(0x79)]({'name':_0x125495});if(!_0x2b5e1e){const _0x2ffccd=new suppliers({'name':_0x125495,'suppliers_code':_0x70b574,'address':_0x8b7698,'mobile':_0x16dd9e,'email':_0x4a23c4,'company':_0x24586d});_0x2b5e1e=await _0x2ffccd['save'](),_0x1622fe[_0x3f2a23(0xa2)]('success',_0x125495+_0x3f2a23(0xc3));}else _0x1622fe[_0x3f2a23(0xa2)](_0x3f2a23(0xbd),_0x125495+_0x3f2a23(0xb2));}catch(_0x3bd3c5){_0x5334f8[_0x3f2a23(0xb4)](0x1f4)[_0x3f2a23(0x77)]({'proderror':_0x3bd3c5['message'],'aproduct':ProductName});}}_0x5334f8['redirect'](_0x3f2a23(0x8f));}),module[a0_0x3fe265(0xaa)]=router;