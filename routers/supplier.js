const a0_0x3ce07e=a0_0x61ac;(function(_0x365b09,_0x4f8833){const _0x1f1d11=a0_0x61ac,_0x226e9a=_0x365b09();while(!![]){try{const _0x152e99=-parseInt(_0x1f1d11(0x15a))/0x1*(-parseInt(_0x1f1d11(0x146))/0x2)+parseInt(_0x1f1d11(0x159))/0x3*(parseInt(_0x1f1d11(0x114))/0x4)+parseInt(_0x1f1d11(0x12b))/0x5*(-parseInt(_0x1f1d11(0xff))/0x6)+-parseInt(_0x1f1d11(0x10d))/0x7+parseInt(_0x1f1d11(0x126))/0x8*(-parseInt(_0x1f1d11(0x149))/0x9)+-parseInt(_0x1f1d11(0x101))/0xa+parseInt(_0x1f1d11(0x13a))/0xb;if(_0x152e99===_0x4f8833)break;else _0x226e9a['push'](_0x226e9a['shift']());}catch(_0x2d4cc4){_0x226e9a['push'](_0x226e9a['shift']());}}}(a0_0x2a94,0x4e699));const express=require(a0_0x3ce07e(0x147)),app=express(),router=express[a0_0x3ce07e(0x156)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x3ce07e(0x14f)),auth=require(a0_0x3ce07e(0x13b)),users=require(a0_0x3ce07e(0x130)),excelJS=require(a0_0x3ce07e(0x152)),xlsx=require(a0_0x3ce07e(0x124)),multer=require(a0_0x3ce07e(0x109));function a0_0x2a94(){const _0x4a18d8=['xlsx','Mobile_number','1712jRFGWY','utils','suppliers','$reason','master','5naJFuC','write','json','send','public/Migration/','../public/language/languages.json','Supplier_Code','French','supplier\x20data\x20add\x20successfully','receivable_sum','log','columns','Content-Disposition','/view/payment/:id','readFile','9706675ITCRAO','../middleware/auth','flash','file','purchase_return','Company_Name','get','SalesmanName','Chinese','user','setHeader','English','595690aVJByV','express','email','11493UleyPa','Arabic\x20(ae)','diskStorage','suppliers_docs','/view','filename','../models/all_models','English\x20(US)','Sheets','exceljs','findOne','/view/:id','$amount','Router','PBrands','body','15pBBWbx','1KoEaPw','landline','error','Purchase\x20Return','Email','find','amount','Name','Spanish','doc','Portuguese\x20(BR)','status','supplier','errors','Workbook','/supplier/view','SheetNames','save','company','address','exports','1223064IVjsSO','aggregate','3206870wdopeN','\x20added\x20successfully','language','sheet_to_json','forEach','PUnits','suppliers_code','supplier.js\x20payment_data','multer','supplier\x20data\x20update\x20successfully','render','German','2489158WAhIGw','Hindi','then','redirect','success','originalname','purchase','235448llNsCh','now','Customers','Purchase','findById','Portuguese','mobile','name','Arabic','supplier_product_file','addWorksheet','/supplier_import_migrate_file','public/Migration','params','message','post'];a0_0x2a94=function(){return _0x4a18d8;};return a0_0x2a94();}router['get'](a0_0x3ce07e(0x14d),auth,async(_0x2385d8,_0x297330)=>{const _0x473a17=a0_0x3ce07e;try{const {username:_0x53504e,email:_0x20ecd1,role:_0x5ba407}=_0x2385d8[_0x473a17(0x143)],_0x383bd8=_0x2385d8[_0x473a17(0x143)],_0xa3131f=await profile['findOne']({'email':_0x383bd8[_0x473a17(0x148)]}),_0x5ba0f8=await master_shop[_0x473a17(0xef)]();console[_0x473a17(0x135)](_0x473a17(0x12a),_0x5ba0f8);const _0x4bed94=await suppliers['find']();console[_0x473a17(0x135)](_0x4bed94);const _0x3adb3a=await suppliers['aggregate']([{'$lookup':{'from':'s_payments','localField':_0x473a17(0x11b),'foreignField':_0x473a17(0x128),'as':_0x473a17(0x14c)}}]),_0x2d4193=_0x3adb3a['map'](_0x1cd14f=>{const _0x731813=_0x473a17;console[_0x731813(0x135)]('data',_0x1cd14f);var _0x1ab00f=0x0,_0x2b53ef=0x0;return _0x1cd14f[_0x731813(0x14c)][_0x731813(0x105)](_0x5bbfdb=>{const _0x2ae5ff=_0x731813;console[_0x2ae5ff(0x135)](_0x2ae5ff(0xf3),_0x5bbfdb),_0x5bbfdb['reason']=='Purchase'?_0x1ab00f+=_0x5bbfdb[_0x2ae5ff(0xf0)]:_0x2b53ef+=_0x5bbfdb['amount'];}),_0x1cd14f[_0x731813(0x113)]=_0x1ab00f,_0x1cd14f[_0x731813(0x13e)]=_0x2b53ef,_0x1cd14f;});console[_0x473a17(0x135)](_0x473a17(0x108),_0x2d4193);if(_0x5ba0f8[0x0][_0x473a17(0x103)]==_0x473a17(0x150)){var _0x92321=users[_0x473a17(0x145)];console['log'](_0x92321);}else{if(_0x5ba0f8[0x0]['language']==_0x473a17(0x10e))var _0x92321=users['Hindi'];else{if(_0x5ba0f8[0x0][_0x473a17(0x103)]==_0x473a17(0x10c))var _0x92321=users[_0x473a17(0x10c)];else{if(_0x5ba0f8[0x0][_0x473a17(0x103)]==_0x473a17(0xf2))var _0x92321=users[_0x473a17(0xf2)];else{if(_0x5ba0f8[0x0][_0x473a17(0x103)]=='French')var _0x92321=users[_0x473a17(0x132)];else{if(_0x5ba0f8[0x0][_0x473a17(0x103)]=='Portuguese\x20(BR)')var _0x92321=users[_0x473a17(0x119)];else{if(_0x5ba0f8[0x0]['language']==_0x473a17(0x142))var _0x92321=users[_0x473a17(0x142)];else{if(_0x5ba0f8[0x0]['language']==_0x473a17(0x14a))var _0x92321=users[_0x473a17(0x11c)];}}}}}}}_0x297330[_0x473a17(0x10b)](_0x473a17(0xf6),{'success':_0x2385d8[_0x473a17(0x13c)]('success'),'errors':_0x2385d8[_0x473a17(0x13c)](_0x473a17(0xf7)),'user':_0x4bed94,'profile':_0xa3131f,'master_shop':_0x5ba0f8,'role':_0x383bd8,'payment':_0x2d4193,'language':_0x92321});}catch(_0x3baa5f){console[_0x473a17(0x135)](_0x3baa5f);}}),router[a0_0x3ce07e(0x123)]('/view',auth,async(_0x20ec40,_0x4d0119)=>{const _0x542d91=a0_0x3ce07e;try{const {name:_0x26149b,email:_0x52eb21,mobile:_0x408a0b,company:_0x16c20b,address:_0x19bd36,receivable:_0x204c6f,payable:_0x4ad34d,code:_0x1c5132,contactperson:_0x3f651f,landline:_0x4d79c2}=_0x20ec40['body'],_0x3a7f1f=new suppliers({'name':_0x26149b,'email':_0x52eb21,'mobile':_0x408a0b,'company':_0x16c20b,'address':_0x19bd36,'receivable':_0x204c6f,'payable':_0x4ad34d,'suppliers_code':_0x1c5132,'contactperson':_0x3f651f,'landline':_0x4d79c2}),_0x5552d2=await _0x3a7f1f[_0x542d91(0xfb)]();_0x20ec40[_0x542d91(0x13c)](_0x542d91(0x111),_0x542d91(0x133)),_0x4d0119[_0x542d91(0x110)](_0x542d91(0xf9));}catch(_0x44ce44){console['log'](_0x44ce44);}}),router[a0_0x3ce07e(0x140)](a0_0x3ce07e(0x154),auth,async(_0x43495d,_0x69f5f9)=>{const _0x3e079d=a0_0x3ce07e;try{const {username:_0x409642,email:_0x2b743a,role:_0x2d3add}=_0x43495d[_0x3e079d(0x143)],_0x444d49=_0x43495d[_0x3e079d(0x143)],_0x38f648=await profile[_0x3e079d(0x153)]({'email':_0x444d49['email']}),_0x390850=await master_shop[_0x3e079d(0xef)]();console[_0x3e079d(0x135)](_0x3e079d(0x12a),_0x390850);const _0x1d6cc7=_0x43495d[_0x3e079d(0x121)]['id'],_0x5c5c7e=await suppliers[_0x3e079d(0x118)](_0x1d6cc7);console['log'](_0x5c5c7e);if(_0x390850[0x0]['language']==_0x3e079d(0x150)){var _0x2d7402=users[_0x3e079d(0x145)];console[_0x3e079d(0x135)](_0x2d7402);}else{if(_0x390850[0x0][_0x3e079d(0x103)]==_0x3e079d(0x10e))var _0x2d7402=users[_0x3e079d(0x10e)];else{if(_0x390850[0x0][_0x3e079d(0x103)]==_0x3e079d(0x10c))var _0x2d7402=users[_0x3e079d(0x10c)];else{if(_0x390850[0x0][_0x3e079d(0x103)]=='Spanish')var _0x2d7402=users['Spanish'];else{if(_0x390850[0x0]['language']==_0x3e079d(0x132))var _0x2d7402=users['French'];else{if(_0x390850[0x0][_0x3e079d(0x103)]==_0x3e079d(0xf4))var _0x2d7402=users['Portuguese'];else{if(_0x390850[0x0][_0x3e079d(0x103)]==_0x3e079d(0x142))var _0x2d7402=users[_0x3e079d(0x142)];else{if(_0x390850[0x0][_0x3e079d(0x103)]==_0x3e079d(0x14a))var _0x2d7402=users[_0x3e079d(0x11c)];}}}}}}}_0x69f5f9[_0x3e079d(0x10b)](_0x3e079d(0xf6),{'success':_0x43495d[_0x3e079d(0x13c)]('success'),'errors':_0x43495d['flash'](_0x3e079d(0xf7)),'role':_0x444d49,'profile':_0x38f648,'master_shop':_0x390850,'user':_0x5c5c7e,'language':_0x2d7402});}catch(_0x4e4321){console['log'](_0x4e4321);}}),router[a0_0x3ce07e(0x123)](a0_0x3ce07e(0x154),auth,async(_0x268df4,_0x39d3b6)=>{const _0x5dbada=a0_0x3ce07e;try{const _0xddb786=_0x268df4[_0x5dbada(0x121)]['id'],_0x5db3bf=await suppliers['findById'](_0xddb786),{name:_0x3c38ef,email:_0x58e16b,mobile:_0x591c58,company:_0x32055e,address:_0x2671b7,receivable:_0x243054,payable:_0x59f849,code:_0x1b4b28,contactperson:_0x3640e9,landline:_0x1dad25}=_0x268df4[_0x5dbada(0x158)];_0x5db3bf[_0x5dbada(0x11b)]=_0x3c38ef,_0x5db3bf['email']=_0x58e16b,_0x5db3bf['mobile']=_0x591c58,_0x5db3bf[_0x5dbada(0xfc)]=_0x32055e,_0x5db3bf['address']=_0x2671b7,_0x5db3bf['receivable']=_0x243054,_0x5db3bf['payable']=_0x59f849,_0x5db3bf[_0x5dbada(0x107)]=_0x1b4b28,_0x5db3bf['contactperson']=_0x3640e9,_0x5db3bf[_0x5dbada(0x15b)]=_0x1dad25;const _0x2a9173=await _0x5db3bf[_0x5dbada(0xfb)]();_0x268df4[_0x5dbada(0x13c)](_0x5dbada(0x111),_0x5dbada(0x10a)),_0x39d3b6[_0x5dbada(0x110)](_0x5dbada(0xf9));}catch(_0x53ccdf){console[_0x5dbada(0x135)](_0x53ccdf);}}),router[a0_0x3ce07e(0x140)](a0_0x3ce07e(0x138),auth,async(_0x1f64a1,_0x56957)=>{const _0xce62b8=a0_0x3ce07e;try{const {username:_0x43d5a1,email:_0x240462,role:_0x424745}=_0x1f64a1[_0xce62b8(0x143)],_0x542c54=_0x1f64a1[_0xce62b8(0x143)],_0x149026=await profile[_0xce62b8(0x153)]({'email':_0x542c54[_0xce62b8(0x148)]}),_0x4f3b59=await master_shop['find']();console[_0xce62b8(0x135)](_0xce62b8(0x12a),_0x4f3b59),console['log'](_0x1f64a1[_0xce62b8(0x121)]['id']);const _0x552b3c=await suppliers[_0xce62b8(0x153)]({'_id':_0x1f64a1[_0xce62b8(0x121)]['id']});console[_0xce62b8(0x135)](_0x552b3c);const _0x578a24=await s_payment_data[_0xce62b8(0xef)]({'suppliers':_0x552b3c[_0xce62b8(0x11b)]});console['log'](_0x578a24);const _0x4cda78=await s_payment_data[_0xce62b8(0x100)]([{'$match':{'suppliers':_0x552b3c[_0xce62b8(0x11b)]}},{'$match':{'reason':_0xce62b8(0x117)}},{'$group':{'_id':'$reason','sum':{'$sum':_0xce62b8(0x155)}}}]);console['log']('payable_sum',_0x4cda78);const _0x4ae69f=await s_payment_data[_0xce62b8(0x100)]([{'$match':{'suppliers':_0x552b3c[_0xce62b8(0x11b)]}},{'$match':{'reason':_0xce62b8(0x15d)}},{'$group':{'_id':_0xce62b8(0x129),'sum':{'$sum':_0xce62b8(0x155)}}}]);console[_0xce62b8(0x135)](_0xce62b8(0x134),_0x4ae69f);if(_0x4f3b59[0x0][_0xce62b8(0x103)]==_0xce62b8(0x150)){var _0xac7787=users[_0xce62b8(0x145)];console[_0xce62b8(0x135)](_0xac7787);}else{if(_0x4f3b59[0x0][_0xce62b8(0x103)]==_0xce62b8(0x10e))var _0xac7787=users[_0xce62b8(0x10e)];else{if(_0x4f3b59[0x0][_0xce62b8(0x103)]==_0xce62b8(0x10c))var _0xac7787=users['German'];else{if(_0x4f3b59[0x0][_0xce62b8(0x103)]==_0xce62b8(0xf2))var _0xac7787=users[_0xce62b8(0xf2)];else{if(_0x4f3b59[0x0]['language']==_0xce62b8(0x132))var _0xac7787=users[_0xce62b8(0x132)];else{if(_0x4f3b59[0x0]['language']==_0xce62b8(0xf4))var _0xac7787=users[_0xce62b8(0x119)];else{if(_0x4f3b59[0x0][_0xce62b8(0x103)]==_0xce62b8(0x142))var _0xac7787=users[_0xce62b8(0x142)];else{if(_0x4f3b59[0x0][_0xce62b8(0x103)]==_0xce62b8(0x14a))var _0xac7787=users[_0xce62b8(0x11c)];}}}}}}}_0x56957[_0xce62b8(0x10b)]('supplier_payment',{'success':_0x1f64a1[_0xce62b8(0x13c)]('success'),'errors':_0x1f64a1[_0xce62b8(0x13c)](_0xce62b8(0xf7)),'role':_0x542c54,'profile':_0x149026,'master_shop':_0x4f3b59,'payment':_0x578a24,'payable':_0x4cda78,'receivable':_0x4ae69f,'language':_0xac7787});}catch(_0xf34081){console[_0xce62b8(0x135)](_0xf34081);}}),router['get']('/products_export_migrate_file',auth,async(_0x11af32,_0x26ad9b)=>{const _0x2d1391=a0_0x3ce07e;try{const _0x1e1915=new excelJS[(_0x2d1391(0xf8))](),_0x2b44e4=_0x1e1915[_0x2d1391(0x11e)](_0x2d1391(0x116));return _0x2b44e4[_0x2d1391(0x136)]=[{'header':_0x2d1391(0xf1),'key':_0x2d1391(0x157),'width':0xa},{'header':'Supplier_Code','key':_0x2d1391(0x106),'width':0xa},{'header':_0x2d1391(0xee),'key':_0x2d1391(0x141),'width':0xa},{'header':_0x2d1391(0x125),'key':_0x2d1391(0xfd),'width':0xa},{'header':_0x2d1391(0x13f),'key':_0x2d1391(0x11a),'width':0xa},{'header':'address','key':_0x2d1391(0x148),'width':0xa}],_0x26ad9b[_0x2d1391(0x144)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x26ad9b[_0x2d1391(0x144)](_0x2d1391(0x137),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x1e1915['xlsx'][_0x2d1391(0x12c)](_0x26ad9b)[_0x2d1391(0x10f)](()=>{const _0xea7e50=_0x2d1391;_0x26ad9b[_0xea7e50(0xf5)](0xc8);});}catch(_0x4f7155){_0x26ad9b['status'](0x190)[_0x2d1391(0x12e)]({'errors':_0x4f7155[_0x2d1391(0x122)]});}});const storage1=multer[a0_0x3ce07e(0x14b)]({'destination':(_0x270888,_0x229825,_0x1ad6df)=>{const _0x172ed4=a0_0x3ce07e;_0x1ad6df(null,_0x172ed4(0x120));},'filename':(_0x13487e,_0x3daa24,_0x415dc2)=>{const _0x4fb56f=a0_0x3ce07e;_0x415dc2(null,Date[_0x4fb56f(0x115)]()+_0x3daa24[_0x4fb56f(0x112)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x61ac(_0x2d1e3b,_0xcf2346){const _0x2a9401=a0_0x2a94();return a0_0x61ac=function(_0x61ac70,_0xc63cbd){_0x61ac70=_0x61ac70-0xee;let _0x166fc6=_0x2a9401[_0x61ac70];return _0x166fc6;},a0_0x61ac(_0x2d1e3b,_0xcf2346);}router['post'](a0_0x3ce07e(0x11f),auth,uploadMigrate['single'](a0_0x3ce07e(0x11d)),async(_0x2fa4d6,_0x480e29)=>{const _0x554123=a0_0x3ce07e,_0x820aef=_0x2fa4d6[_0x554123(0x13d)][_0x554123(0x14e)],_0x1acfb1=await xlsx[_0x554123(0x139)](_0x554123(0x12f)+_0x820aef);let _0x5a7d89=_0x1acfb1[_0x554123(0xfa)],_0x560446=xlsx[_0x554123(0x127)][_0x554123(0x104)](_0x1acfb1[_0x554123(0x151)][_0x5a7d89[0x0]]);for(const _0x5022ab of _0x560446){const _0xbba56d=_0x5022ab[_0x554123(0xf1)],_0x39ab5e=_0x5022ab[_0x554123(0x131)],_0x5575f9=_0x5022ab[_0x554123(0xfd)],_0x45a302=_0x5022ab[_0x554123(0x125)],_0x132d50=_0x5022ab[_0x554123(0xee)],_0x1dc3be=_0x5022ab[_0x554123(0x13f)];try{let _0x1e0bb5=await suppliers['findOne']({'name':_0xbba56d});if(!_0x1e0bb5){const _0x26485c=new suppliers({'name':_0xbba56d,'suppliers_code':_0x39ab5e,'address':_0x5575f9,'mobile':_0x45a302,'email':_0x132d50,'company':_0x1dc3be});_0x1e0bb5=await _0x26485c['save'](),_0x2fa4d6[_0x554123(0x13c)](_0x554123(0x111),_0xbba56d+_0x554123(0x102));}else _0x2fa4d6[_0x554123(0x13c)](_0x554123(0x15c),_0xbba56d+'\x20Failed');}catch(_0x1ae4d9){_0x480e29['status'](0x1f4)[_0x554123(0x12d)]({'proderror':_0x1ae4d9['message'],'aproduct':ProductName});}}_0x480e29[_0x554123(0x110)](_0x554123(0xf9));}),module[a0_0x3ce07e(0xfe)]=router;