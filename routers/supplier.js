function a0_0x41e5(){const _0x1519f4=['supplier\x20data\x20update\x20successfully','single','Customers','payable','filename','\x20Failed','utils','Arabic','/view','Spanish','public/Migration','Email','\x20added\x20successfully','SheetNames','name','map','66uxDtLc','240396JaucCG','file','French','get','SalesmanName','Name','addWorksheet','columns','/products_export_migrate_file','findById','address','sheet_to_json','findOne','write','3257270DvssEp','xlsx','receivable','PBrands','render','payable_sum','doc','$amount','suppliers_docs','supplier_payment','Portuguese\x20(BR)','English','company','951834pLlFnk','Purchase','Mobile_number','352aqRIBI','PUnits','Supplier_Code','flash','5328252KmueDg','errors','landline','s_payments','Workbook','log','German','supplier','Router','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Content-Disposition','Chinese','master','amount','receivable_sum','originalname','Portuguese','supplier_product_file','email','redirect','express','save','Hindi','/view/payment/:id','purchase_return','$reason','212094myYcEM','success','readFile','body','reason','status','language','contactperson','find','../middleware/auth','params','Company_Name','22841hfjiVr','purchase','post','Arabic\x20(ae)','Content-Type','/view/:id','supplier\x20data\x20add\x20successfully','Purchase\x20Return','now','aggregate','attachment;\x20filename=supplier_Migration_File.xlsx','5127609PzMtpL','/supplier/view','user','English\x20(US)','forEach'];a0_0x41e5=function(){return _0x1519f4;};return a0_0x41e5();}const a0_0x2be5c5=a0_0x384a;function a0_0x384a(_0x176abe,_0x1c9894){const _0x41e51a=a0_0x41e5();return a0_0x384a=function(_0x384a30,_0x1b997d){_0x384a30=_0x384a30-0xd7;let _0x5d819c=_0x41e51a[_0x384a30];return _0x5d819c;},a0_0x384a(_0x176abe,_0x1c9894);}(function(_0x3f0355,_0x212cde){const _0x597eff=a0_0x384a,_0x359526=_0x3f0355();while(!![]){try{const _0x2601ef=parseInt(_0x597eff(0x13e))/0x1+-parseInt(_0x597eff(0x123))/0x2+-parseInt(_0x597eff(0x10d))/0x3+parseInt(_0x597eff(0xdc))/0x4+-parseInt(_0x597eff(0x131))/0x5+-parseInt(_0x597eff(0x122))/0x6*(-parseInt(_0x597eff(0x102))/0x7)+parseInt(_0x597eff(0xd8))/0x8*(parseInt(_0x597eff(0xf6))/0x9);if(_0x2601ef===_0x212cde)break;else _0x359526['push'](_0x359526['shift']());}catch(_0x40c1ce){_0x359526['push'](_0x359526['shift']());}}}(a0_0x41e5,0xd5d3f));const express=require(a0_0x2be5c5(0xf0)),app=express(),router=express[a0_0x2be5c5(0xe4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require(a0_0x2be5c5(0xff)),users=require('../public/language/languages.json'),excelJS=require('exceljs'),xlsx=require(a0_0x2be5c5(0x132)),multer=require('multer');router[a0_0x2be5c5(0x126)](a0_0x2be5c5(0x11a),auth,async(_0x2515c7,_0x57e864)=>{const _0x16e1a4=a0_0x2be5c5;try{const {username:_0x3005ce,email:_0x189c85,role:_0x4c9ec5}=_0x2515c7['user'],_0x2d5223=_0x2515c7['user'],_0x29828c=await profile[_0x16e1a4(0x12f)]({'email':_0x2d5223[_0x16e1a4(0xee)]}),_0x2c68dc=await master_shop['find']();console[_0x16e1a4(0xe1)](_0x16e1a4(0xe8),_0x2c68dc);const _0x2cf4ea=await suppliers['find']();console[_0x16e1a4(0xe1)](_0x2cf4ea);const _0x1d2757=await suppliers[_0x16e1a4(0x10b)]([{'$lookup':{'from':_0x16e1a4(0xdf),'localField':_0x16e1a4(0x120),'foreignField':'suppliers','as':_0x16e1a4(0x139)}}]),_0x4d5ea8=_0x1d2757[_0x16e1a4(0x121)](_0x5d018d=>{const _0x6bd8ad=_0x16e1a4;console[_0x6bd8ad(0xe1)]('data',_0x5d018d);var _0x15ab70=0x0,_0x2e8bcd=0x0;return _0x5d018d[_0x6bd8ad(0x139)][_0x6bd8ad(0x111)](_0x463edc=>{const _0x5ce739=_0x6bd8ad;console['log'](_0x5ce739(0x137),_0x463edc),_0x463edc[_0x5ce739(0xfa)]==_0x5ce739(0x13f)?_0x15ab70+=_0x463edc[_0x5ce739(0xe9)]:_0x2e8bcd+=_0x463edc[_0x5ce739(0xe9)];}),_0x5d018d[_0x6bd8ad(0x103)]=_0x15ab70,_0x5d018d[_0x6bd8ad(0xf4)]=_0x2e8bcd,_0x5d018d;});console[_0x16e1a4(0xe1)]('supplier.js\x20payment_data',_0x4d5ea8);if(_0x2c68dc[0x0][_0x16e1a4(0xfc)]==_0x16e1a4(0x110)){var _0x2e48f3=users['English'];console['log'](_0x2e48f3);}else{if(_0x2c68dc[0x0]['language']==_0x16e1a4(0xf2))var _0x2e48f3=users[_0x16e1a4(0xf2)];else{if(_0x2c68dc[0x0][_0x16e1a4(0xfc)]==_0x16e1a4(0xe2))var _0x2e48f3=users[_0x16e1a4(0xe2)];else{if(_0x2c68dc[0x0][_0x16e1a4(0xfc)]==_0x16e1a4(0x11b))var _0x2e48f3=users[_0x16e1a4(0x11b)];else{if(_0x2c68dc[0x0][_0x16e1a4(0xfc)]=='French')var _0x2e48f3=users[_0x16e1a4(0x125)];else{if(_0x2c68dc[0x0][_0x16e1a4(0xfc)]==_0x16e1a4(0x13b))var _0x2e48f3=users[_0x16e1a4(0xec)];else{if(_0x2c68dc[0x0][_0x16e1a4(0xfc)]=='Chinese')var _0x2e48f3=users[_0x16e1a4(0xe7)];else{if(_0x2c68dc[0x0][_0x16e1a4(0xfc)]==_0x16e1a4(0x105))var _0x2e48f3=users['Arabic'];}}}}}}}_0x57e864[_0x16e1a4(0x135)](_0x16e1a4(0xe3),{'success':_0x2515c7[_0x16e1a4(0xdb)](_0x16e1a4(0xf7)),'errors':_0x2515c7[_0x16e1a4(0xdb)]('errors'),'user':_0x2cf4ea,'profile':_0x29828c,'master_shop':_0x2c68dc,'role':_0x2d5223,'payment':_0x4d5ea8,'language':_0x2e48f3});}catch(_0x41a692){console[_0x16e1a4(0xe1)](_0x41a692);}}),router[a0_0x2be5c5(0x104)](a0_0x2be5c5(0x11a),auth,async(_0xe5c647,_0x337235)=>{const _0x50be38=a0_0x2be5c5;try{const {name:_0x90cc00,email:_0xade08,mobile:_0x5c64ea,company:_0x3d6246,address:_0x4e2ee2,receivable:_0x14cfee,payable:_0x32704e,code:_0x18ce02,contactperson:_0x1953e1,landline:_0x2ac700}=_0xe5c647[_0x50be38(0xf9)],_0x5ec6c2=new suppliers({'name':_0x90cc00,'email':_0xade08,'mobile':_0x5c64ea,'company':_0x3d6246,'address':_0x4e2ee2,'receivable':_0x14cfee,'payable':_0x32704e,'suppliers_code':_0x18ce02,'contactperson':_0x1953e1,'landline':_0x2ac700}),_0x39f5f4=await _0x5ec6c2[_0x50be38(0xf1)]();_0xe5c647[_0x50be38(0xdb)](_0x50be38(0xf7),_0x50be38(0x108)),_0x337235[_0x50be38(0xef)](_0x50be38(0x10e));}catch(_0x4e48c6){console[_0x50be38(0xe1)](_0x4e48c6);}}),router[a0_0x2be5c5(0x126)](a0_0x2be5c5(0x107),auth,async(_0x2a3cf3,_0x52a95e)=>{const _0x407945=a0_0x2be5c5;try{const {username:_0x26c770,email:_0x5cdedf,role:_0x14c850}=_0x2a3cf3[_0x407945(0x10f)],_0x1369ba=_0x2a3cf3[_0x407945(0x10f)],_0x122e96=await profile[_0x407945(0x12f)]({'email':_0x1369ba[_0x407945(0xee)]}),_0x2033dc=await master_shop[_0x407945(0xfe)]();console['log'](_0x407945(0xe8),_0x2033dc);const _0x5ebac7=_0x2a3cf3['params']['id'],_0xfb779c=await suppliers[_0x407945(0x12c)](_0x5ebac7);console[_0x407945(0xe1)](_0xfb779c);if(_0x2033dc[0x0]['language']=='English\x20(US)'){var _0x44cc50=users[_0x407945(0x13c)];console[_0x407945(0xe1)](_0x44cc50);}else{if(_0x2033dc[0x0][_0x407945(0xfc)]==_0x407945(0xf2))var _0x44cc50=users['Hindi'];else{if(_0x2033dc[0x0][_0x407945(0xfc)]==_0x407945(0xe2))var _0x44cc50=users[_0x407945(0xe2)];else{if(_0x2033dc[0x0][_0x407945(0xfc)]==_0x407945(0x11b))var _0x44cc50=users[_0x407945(0x11b)];else{if(_0x2033dc[0x0][_0x407945(0xfc)]==_0x407945(0x125))var _0x44cc50=users[_0x407945(0x125)];else{if(_0x2033dc[0x0]['language']==_0x407945(0x13b))var _0x44cc50=users[_0x407945(0xec)];else{if(_0x2033dc[0x0][_0x407945(0xfc)]=='Chinese')var _0x44cc50=users[_0x407945(0xe7)];else{if(_0x2033dc[0x0]['language']==_0x407945(0x105))var _0x44cc50=users[_0x407945(0x119)];}}}}}}}_0x52a95e[_0x407945(0x135)](_0x407945(0xe3),{'success':_0x2a3cf3[_0x407945(0xdb)](_0x407945(0xf7)),'errors':_0x2a3cf3[_0x407945(0xdb)](_0x407945(0xdd)),'role':_0x1369ba,'profile':_0x122e96,'master_shop':_0x2033dc,'user':_0xfb779c,'language':_0x44cc50});}catch(_0x3654ff){console[_0x407945(0xe1)](_0x3654ff);}}),router[a0_0x2be5c5(0x104)](a0_0x2be5c5(0x107),auth,async(_0x1d22e1,_0x3c9de5)=>{const _0x546e82=a0_0x2be5c5;try{const _0x529bcf=_0x1d22e1['params']['id'],_0x30fe39=await suppliers[_0x546e82(0x12c)](_0x529bcf),{name:_0x4666b4,email:_0x51c97f,mobile:_0x5094b7,company:_0x336b15,address:_0x2de7f2,receivable:_0x39d135,payable:_0x5cac30,code:_0x1a7abb,contactperson:_0x277ffa,landline:_0x521df3}=_0x1d22e1[_0x546e82(0xf9)];_0x30fe39[_0x546e82(0x120)]=_0x4666b4,_0x30fe39[_0x546e82(0xee)]=_0x51c97f,_0x30fe39['mobile']=_0x5094b7,_0x30fe39[_0x546e82(0x13d)]=_0x336b15,_0x30fe39['address']=_0x2de7f2,_0x30fe39[_0x546e82(0x133)]=_0x39d135,_0x30fe39[_0x546e82(0x115)]=_0x5cac30,_0x30fe39['suppliers_code']=_0x1a7abb,_0x30fe39[_0x546e82(0xfd)]=_0x277ffa,_0x30fe39[_0x546e82(0xde)]=_0x521df3;const _0x188127=await _0x30fe39[_0x546e82(0xf1)]();_0x1d22e1[_0x546e82(0xdb)]('success',_0x546e82(0x112)),_0x3c9de5[_0x546e82(0xef)]('/supplier/view');}catch(_0x4588a2){console[_0x546e82(0xe1)](_0x4588a2);}}),router[a0_0x2be5c5(0x126)](a0_0x2be5c5(0xf3),auth,async(_0x568ac3,_0x26d953)=>{const _0x47a93a=a0_0x2be5c5;try{const {username:_0x4b8f91,email:_0x557890,role:_0x5bdf06}=_0x568ac3[_0x47a93a(0x10f)],_0x3c9ebc=_0x568ac3[_0x47a93a(0x10f)],_0xda53=await profile[_0x47a93a(0x12f)]({'email':_0x3c9ebc[_0x47a93a(0xee)]}),_0x450e65=await master_shop[_0x47a93a(0xfe)]();console[_0x47a93a(0xe1)](_0x47a93a(0xe8),_0x450e65),console[_0x47a93a(0xe1)](_0x568ac3['params']['id']);const _0x46903a=await suppliers[_0x47a93a(0x12f)]({'_id':_0x568ac3[_0x47a93a(0x100)]['id']});console[_0x47a93a(0xe1)](_0x46903a);const _0x42d49b=await s_payment_data[_0x47a93a(0xfe)]({'suppliers':_0x46903a[_0x47a93a(0x120)]});console['log'](_0x42d49b);const _0x4776bd=await s_payment_data[_0x47a93a(0x10b)]([{'$match':{'suppliers':_0x46903a[_0x47a93a(0x120)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x47a93a(0xf5),'sum':{'$sum':_0x47a93a(0x138)}}}]);console[_0x47a93a(0xe1)](_0x47a93a(0x136),_0x4776bd);const _0x3c0373=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x46903a[_0x47a93a(0x120)]}},{'$match':{'reason':_0x47a93a(0x109)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x47a93a(0x138)}}}]);console[_0x47a93a(0xe1)](_0x47a93a(0xea),_0x3c0373);if(_0x450e65[0x0][_0x47a93a(0xfc)]=='English\x20(US)'){var _0x4d2ca8=users[_0x47a93a(0x13c)];console[_0x47a93a(0xe1)](_0x4d2ca8);}else{if(_0x450e65[0x0][_0x47a93a(0xfc)]==_0x47a93a(0xf2))var _0x4d2ca8=users[_0x47a93a(0xf2)];else{if(_0x450e65[0x0][_0x47a93a(0xfc)]==_0x47a93a(0xe2))var _0x4d2ca8=users[_0x47a93a(0xe2)];else{if(_0x450e65[0x0][_0x47a93a(0xfc)]==_0x47a93a(0x11b))var _0x4d2ca8=users['Spanish'];else{if(_0x450e65[0x0]['language']==_0x47a93a(0x125))var _0x4d2ca8=users[_0x47a93a(0x125)];else{if(_0x450e65[0x0][_0x47a93a(0xfc)]==_0x47a93a(0x13b))var _0x4d2ca8=users[_0x47a93a(0xec)];else{if(_0x450e65[0x0][_0x47a93a(0xfc)]=='Chinese')var _0x4d2ca8=users['Chinese'];else{if(_0x450e65[0x0]['language']==_0x47a93a(0x105))var _0x4d2ca8=users['Arabic'];}}}}}}}_0x26d953[_0x47a93a(0x135)](_0x47a93a(0x13a),{'success':_0x568ac3[_0x47a93a(0xdb)](_0x47a93a(0xf7)),'errors':_0x568ac3[_0x47a93a(0xdb)](_0x47a93a(0xdd)),'role':_0x3c9ebc,'profile':_0xda53,'master_shop':_0x450e65,'payment':_0x42d49b,'payable':_0x4776bd,'receivable':_0x3c0373,'language':_0x4d2ca8});}catch(_0x3d8ab4){console[_0x47a93a(0xe1)](_0x3d8ab4);}}),router[a0_0x2be5c5(0x126)](a0_0x2be5c5(0x12b),auth,async(_0x593d28,_0x4378fc)=>{const _0x18331f=a0_0x2be5c5;try{const _0x1b93b7=new excelJS[(_0x18331f(0xe0))](),_0xaa7d29=_0x1b93b7[_0x18331f(0x129)](_0x18331f(0x114));return _0xaa7d29[_0x18331f(0x12a)]=[{'header':_0x18331f(0x128),'key':_0x18331f(0x134),'width':0xa},{'header':_0x18331f(0xda),'key':_0x18331f(0xd9),'width':0xa},{'header':_0x18331f(0x11d),'key':_0x18331f(0x127),'width':0xa},{'header':_0x18331f(0xd7),'key':'address','width':0xa},{'header':_0x18331f(0x101),'key':'mobile','width':0xa},{'header':_0x18331f(0x12d),'key':'email','width':0xa}],_0x4378fc['setHeader'](_0x18331f(0x106),_0x18331f(0xe5)),_0x4378fc['setHeader'](_0x18331f(0xe6),_0x18331f(0x10c)),_0x1b93b7[_0x18331f(0x132)][_0x18331f(0x130)](_0x4378fc)['then'](()=>{_0x4378fc['status'](0xc8);});}catch(_0x5d896d){_0x4378fc['status'](0x190)['send']({'errors':_0x5d896d['message']});}});const storage1=multer['diskStorage']({'destination':(_0x222428,_0x50a4f1,_0x4ac187)=>{const _0x5e8fdc=a0_0x2be5c5;_0x4ac187(null,_0x5e8fdc(0x11c));},'filename':(_0x3465f0,_0x54c8da,_0x3348f5)=>{const _0x40bda0=a0_0x2be5c5;_0x3348f5(null,Date[_0x40bda0(0x10a)]()+_0x54c8da[_0x40bda0(0xeb)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x2be5c5(0x104)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0x2be5c5(0x113)](a0_0x2be5c5(0xed)),async(_0x244600,_0x969c77)=>{const _0x2c4288=a0_0x2be5c5,_0x282a60=_0x244600[_0x2c4288(0x124)][_0x2c4288(0x116)],_0x3e3de3=await xlsx[_0x2c4288(0xf8)]('public/Migration/'+_0x282a60);let _0x4b311a=_0x3e3de3[_0x2c4288(0x11f)],_0x13603e=xlsx[_0x2c4288(0x118)][_0x2c4288(0x12e)](_0x3e3de3['Sheets'][_0x4b311a[0x0]]);for(const _0x32e124 of _0x13603e){const _0x5d3543=_0x32e124[_0x2c4288(0x128)],_0x3760a2=_0x32e124['Supplier_Code'],_0x2f57c0=_0x32e124['address'],_0x539f83=_0x32e124[_0x2c4288(0xd7)],_0x583e31=_0x32e124[_0x2c4288(0x11d)],_0x538642=_0x32e124['Company_Name'];try{let _0x4b968f=await suppliers[_0x2c4288(0x12f)]({'name':_0x5d3543});if(!_0x4b968f){const _0x313673=new suppliers({'name':_0x5d3543,'suppliers_code':_0x3760a2,'address':_0x2f57c0,'mobile':_0x539f83,'email':_0x583e31,'company':_0x538642});_0x4b968f=await _0x313673[_0x2c4288(0xf1)](),_0x244600[_0x2c4288(0xdb)]('success',_0x5d3543+_0x2c4288(0x11e));}else _0x244600[_0x2c4288(0xdb)]('error',_0x5d3543+_0x2c4288(0x117));}catch(_0x2cef2f){_0x969c77[_0x2c4288(0xfb)](0x1f4)['json']({'proderror':_0x2cef2f['message'],'aproduct':ProductName});}}_0x969c77[_0x2c4288(0xef)](_0x2c4288(0x10e));}),module['exports']=router;