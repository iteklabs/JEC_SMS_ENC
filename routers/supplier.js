const a0_0x5dfff6=a0_0x3f2c;function a0_0x28cf(){const _0x200336=['error','../public/language/languages.json','/view','receivable_sum','116084wHKxXq','sheet_to_json','supplier_payment','German','single','English\x20(US)','landline','utils','errors','readFile','email','s_payments','Arabic\x20(ae)','Router','Portuguese','Sheets','then','Customers','suppliers_code','data','multer','Mobile_number','1487718AyAPhD','923110gzOUyu','params','PBrands','Purchase','\x20added\x20successfully','supplier_product_file','/supplier/view','32dzxptK','Content-Disposition','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','236481ElFjdg','exports','French','map','message','purchase_return','find','body','user','2qxtGKx','/view/payment/:id','master','address','amount','Portuguese\x20(BR)','suppliers','post','242803euMbqC','supplier.js\x20payment_data','Supplier_Code','Spanish','success','write','Arabic','doc','suppliers_docs','../models/all_models','Email','exceljs','74723AakYkt','supplier\x20data\x20add\x20successfully','language','contactperson','mobile','diskStorage','filename','supplier','public/Migration/','status','/products_export_migrate_file','Purchase\x20Return','Hindi','setHeader','log','name','../middleware/auth','file','public/Migration','express','attachment;\x20filename=supplier_Migration_File.xlsx','PUnits','9xKbOto','Name','company','Company_Name','originalname','send','English','SalesmanName','$amount','addWorksheet','50UYEPjE','flash','render','supplier\x20data\x20update\x20successfully','findById','279601zZWJaj','SheetNames','get','Chinese','aggregate','json','findOne','/view/:id','redirect','144QXKCAS','save','xlsx'];a0_0x28cf=function(){return _0x200336;};return a0_0x28cf();}(function(_0x2f867f,_0x362214){const _0x5ba861=a0_0x3f2c,_0x413343=_0x2f867f();while(!![]){try{const _0x4164bd=parseInt(_0x5ba861(0x1fb))/0x1*(parseInt(_0x5ba861(0x1f3))/0x2)+-parseInt(_0x5ba861(0x1ea))/0x3+parseInt(_0x5ba861(0x1c9))/0x4*(parseInt(_0x5ba861(0x227))/0x5)+-parseInt(_0x5ba861(0x1df))/0x6+parseInt(_0x5ba861(0x22c))/0x7*(parseInt(_0x5ba861(0x1e7))/0x8)+parseInt(_0x5ba861(0x21d))/0x9*(-parseInt(_0x5ba861(0x1e0))/0xa)+-parseInt(_0x5ba861(0x207))/0xb*(parseInt(_0x5ba861(0x1c2))/0xc);if(_0x4164bd===_0x362214)break;else _0x413343['push'](_0x413343['shift']());}catch(_0x207800){_0x413343['push'](_0x413343['shift']());}}}(a0_0x28cf,0x2eeb2));const express=require(a0_0x5dfff6(0x21a)),app=express(),router=express[a0_0x5dfff6(0x1d6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x5dfff6(0x204)),auth=require(a0_0x5dfff6(0x217)),users=require(a0_0x5dfff6(0x1c6)),excelJS=require(a0_0x5dfff6(0x206)),xlsx=require(a0_0x5dfff6(0x1c4)),multer=require(a0_0x5dfff6(0x1dd));router[a0_0x5dfff6(0x22e)](a0_0x5dfff6(0x1c7),auth,async(_0x358c69,_0x465d35)=>{const _0x1f3adf=a0_0x5dfff6;try{const {username:_0x3ea833,email:_0x2a4ed5,role:_0x54f1df}=_0x358c69[_0x1f3adf(0x1f2)],_0xbe1c87=_0x358c69[_0x1f3adf(0x1f2)],_0x1a0073=await profile[_0x1f3adf(0x1bf)]({'email':_0xbe1c87['email']}),_0x466857=await master_shop[_0x1f3adf(0x1f0)]();console['log'](_0x1f3adf(0x1f5),_0x466857);const _0x347fec=await suppliers['find']();console[_0x1f3adf(0x215)](_0x347fec);const _0x20e29d=await suppliers[_0x1f3adf(0x1bd)]([{'$lookup':{'from':_0x1f3adf(0x1d4),'localField':_0x1f3adf(0x216),'foreignField':_0x1f3adf(0x1f9),'as':_0x1f3adf(0x203)}}]),_0x4b3131=_0x20e29d[_0x1f3adf(0x1ed)](_0x3fe6a5=>{const _0x3fa0f3=_0x1f3adf;console[_0x3fa0f3(0x215)](_0x3fa0f3(0x1dc),_0x3fe6a5);var _0x443a9d=0x0,_0x7de0be=0x0;return _0x3fe6a5['suppliers_docs']['forEach'](_0x5e382b=>{const _0x47c49c=_0x3fa0f3;console[_0x47c49c(0x215)](_0x47c49c(0x202),_0x5e382b),_0x5e382b['reason']==_0x47c49c(0x1e3)?_0x443a9d+=_0x5e382b[_0x47c49c(0x1f7)]:_0x7de0be+=_0x5e382b['amount'];}),_0x3fe6a5['purchase']=_0x443a9d,_0x3fe6a5[_0x3fa0f3(0x1ef)]=_0x7de0be,_0x3fe6a5;});console[_0x1f3adf(0x215)](_0x1f3adf(0x1fc),_0x4b3131);if(_0x466857[0x0]['language']==_0x1f3adf(0x1ce)){var _0x1aa753=users[_0x1f3adf(0x223)];console[_0x1f3adf(0x215)](_0x1aa753);}else{if(_0x466857[0x0][_0x1f3adf(0x209)]=='Hindi')var _0x1aa753=users[_0x1f3adf(0x213)];else{if(_0x466857[0x0][_0x1f3adf(0x209)]==_0x1f3adf(0x1cc))var _0x1aa753=users[_0x1f3adf(0x1cc)];else{if(_0x466857[0x0][_0x1f3adf(0x209)]==_0x1f3adf(0x1fe))var _0x1aa753=users[_0x1f3adf(0x1fe)];else{if(_0x466857[0x0][_0x1f3adf(0x209)]=='French')var _0x1aa753=users[_0x1f3adf(0x1ec)];else{if(_0x466857[0x0]['language']=='Portuguese\x20(BR)')var _0x1aa753=users[_0x1f3adf(0x1d7)];else{if(_0x466857[0x0][_0x1f3adf(0x209)]==_0x1f3adf(0x22f))var _0x1aa753=users['Chinese'];else{if(_0x466857[0x0][_0x1f3adf(0x209)]==_0x1f3adf(0x1d5))var _0x1aa753=users[_0x1f3adf(0x201)];}}}}}}}_0x465d35[_0x1f3adf(0x229)](_0x1f3adf(0x20e),{'success':_0x358c69[_0x1f3adf(0x228)](_0x1f3adf(0x1ff)),'errors':_0x358c69['flash'](_0x1f3adf(0x1d1)),'user':_0x347fec,'profile':_0x1a0073,'master_shop':_0x466857,'role':_0xbe1c87,'payment':_0x4b3131,'language':_0x1aa753});}catch(_0x5c4aca){console[_0x1f3adf(0x215)](_0x5c4aca);}}),router[a0_0x5dfff6(0x1fa)]('/view',auth,async(_0x36f7ba,_0x30851c)=>{const _0xaf14e4=a0_0x5dfff6;try{const {name:_0x5d17a5,email:_0x12856a,mobile:_0x4be980,company:_0x1cdc70,address:_0x4256e2,receivable:_0x4dfeab,payable:_0x120459,code:_0x122242,contactperson:_0x4a7cb3,landline:_0x1fab4a}=_0x36f7ba[_0xaf14e4(0x1f1)],_0x1b862a=new suppliers({'name':_0x5d17a5,'email':_0x12856a,'mobile':_0x4be980,'company':_0x1cdc70,'address':_0x4256e2,'receivable':_0x4dfeab,'payable':_0x120459,'suppliers_code':_0x122242,'contactperson':_0x4a7cb3,'landline':_0x1fab4a}),_0x2a6ebf=await _0x1b862a['save']();_0x36f7ba[_0xaf14e4(0x228)](_0xaf14e4(0x1ff),_0xaf14e4(0x208)),_0x30851c[_0xaf14e4(0x1c1)](_0xaf14e4(0x1e6));}catch(_0x162c16){console[_0xaf14e4(0x215)](_0x162c16);}}),router[a0_0x5dfff6(0x22e)]('/view/:id',auth,async(_0x31ab98,_0x452003)=>{const _0x5ac371=a0_0x5dfff6;try{const {username:_0x2a9b3d,email:_0x4dbc2a,role:_0x177aee}=_0x31ab98[_0x5ac371(0x1f2)],_0x77fc0d=_0x31ab98[_0x5ac371(0x1f2)],_0x59b05e=await profile[_0x5ac371(0x1bf)]({'email':_0x77fc0d[_0x5ac371(0x1d3)]}),_0x3ce0f5=await master_shop[_0x5ac371(0x1f0)]();console[_0x5ac371(0x215)](_0x5ac371(0x1f5),_0x3ce0f5);const _0x213732=_0x31ab98[_0x5ac371(0x1e1)]['id'],_0x5bba56=await suppliers[_0x5ac371(0x22b)](_0x213732);console['log'](_0x5bba56);if(_0x3ce0f5[0x0]['language']==_0x5ac371(0x1ce)){var _0x25242a=users['English'];console[_0x5ac371(0x215)](_0x25242a);}else{if(_0x3ce0f5[0x0][_0x5ac371(0x209)]==_0x5ac371(0x213))var _0x25242a=users[_0x5ac371(0x213)];else{if(_0x3ce0f5[0x0]['language']==_0x5ac371(0x1cc))var _0x25242a=users['German'];else{if(_0x3ce0f5[0x0][_0x5ac371(0x209)]=='Spanish')var _0x25242a=users[_0x5ac371(0x1fe)];else{if(_0x3ce0f5[0x0][_0x5ac371(0x209)]=='French')var _0x25242a=users['French'];else{if(_0x3ce0f5[0x0][_0x5ac371(0x209)]==_0x5ac371(0x1f8))var _0x25242a=users['Portuguese'];else{if(_0x3ce0f5[0x0][_0x5ac371(0x209)]==_0x5ac371(0x22f))var _0x25242a=users[_0x5ac371(0x22f)];else{if(_0x3ce0f5[0x0][_0x5ac371(0x209)]==_0x5ac371(0x1d5))var _0x25242a=users[_0x5ac371(0x201)];}}}}}}}_0x452003[_0x5ac371(0x229)](_0x5ac371(0x20e),{'success':_0x31ab98[_0x5ac371(0x228)](_0x5ac371(0x1ff)),'errors':_0x31ab98[_0x5ac371(0x228)]('errors'),'role':_0x77fc0d,'profile':_0x59b05e,'master_shop':_0x3ce0f5,'user':_0x5bba56,'language':_0x25242a});}catch(_0x11613f){console['log'](_0x11613f);}}),router[a0_0x5dfff6(0x1fa)](a0_0x5dfff6(0x1c0),auth,async(_0x5b8868,_0x38fe93)=>{const _0x12042b=a0_0x5dfff6;try{const _0x947261=_0x5b8868[_0x12042b(0x1e1)]['id'],_0x211bf1=await suppliers[_0x12042b(0x22b)](_0x947261),{name:_0x538f22,email:_0x501884,mobile:_0x76a95,company:_0x1e347f,address:_0x30840a,receivable:_0x588a4a,payable:_0x521c62,code:_0x495f25,contactperson:_0x20b064,landline:_0x8dff9}=_0x5b8868[_0x12042b(0x1f1)];_0x211bf1[_0x12042b(0x216)]=_0x538f22,_0x211bf1[_0x12042b(0x1d3)]=_0x501884,_0x211bf1[_0x12042b(0x20b)]=_0x76a95,_0x211bf1[_0x12042b(0x21f)]=_0x1e347f,_0x211bf1[_0x12042b(0x1f6)]=_0x30840a,_0x211bf1['receivable']=_0x588a4a,_0x211bf1['payable']=_0x521c62,_0x211bf1[_0x12042b(0x1db)]=_0x495f25,_0x211bf1[_0x12042b(0x20a)]=_0x20b064,_0x211bf1[_0x12042b(0x1cf)]=_0x8dff9;const _0x2e630e=await _0x211bf1['save']();_0x5b8868[_0x12042b(0x228)]('success',_0x12042b(0x22a)),_0x38fe93[_0x12042b(0x1c1)](_0x12042b(0x1e6));}catch(_0x56b38f){console[_0x12042b(0x215)](_0x56b38f);}}),router[a0_0x5dfff6(0x22e)](a0_0x5dfff6(0x1f4),auth,async(_0x3cbf6b,_0x1d76da)=>{const _0x5df34c=a0_0x5dfff6;try{const {username:_0x4f14a5,email:_0xa4e599,role:_0x3ebacb}=_0x3cbf6b[_0x5df34c(0x1f2)],_0x41a070=_0x3cbf6b[_0x5df34c(0x1f2)],_0x355c08=await profile[_0x5df34c(0x1bf)]({'email':_0x41a070[_0x5df34c(0x1d3)]}),_0x4039f1=await master_shop['find']();console[_0x5df34c(0x215)]('master',_0x4039f1),console[_0x5df34c(0x215)](_0x3cbf6b[_0x5df34c(0x1e1)]['id']);const _0x480e5b=await suppliers[_0x5df34c(0x1bf)]({'_id':_0x3cbf6b[_0x5df34c(0x1e1)]['id']});console['log'](_0x480e5b);const _0x4bdd53=await s_payment_data['find']({'suppliers':_0x480e5b[_0x5df34c(0x216)]});console['log'](_0x4bdd53);const _0x2772a4=await s_payment_data[_0x5df34c(0x1bd)]([{'$match':{'suppliers':_0x480e5b[_0x5df34c(0x216)]}},{'$match':{'reason':_0x5df34c(0x1e3)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x5df34c(0x225)}}}]);console[_0x5df34c(0x215)]('payable_sum',_0x2772a4);const _0x26a72c=await s_payment_data[_0x5df34c(0x1bd)]([{'$match':{'suppliers':_0x480e5b['name']}},{'$match':{'reason':_0x5df34c(0x212)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x5df34c(0x225)}}}]);console[_0x5df34c(0x215)](_0x5df34c(0x1c8),_0x26a72c);if(_0x4039f1[0x0][_0x5df34c(0x209)]==_0x5df34c(0x1ce)){var _0x3083ed=users[_0x5df34c(0x223)];console['log'](_0x3083ed);}else{if(_0x4039f1[0x0][_0x5df34c(0x209)]==_0x5df34c(0x213))var _0x3083ed=users[_0x5df34c(0x213)];else{if(_0x4039f1[0x0][_0x5df34c(0x209)]==_0x5df34c(0x1cc))var _0x3083ed=users[_0x5df34c(0x1cc)];else{if(_0x4039f1[0x0][_0x5df34c(0x209)]==_0x5df34c(0x1fe))var _0x3083ed=users[_0x5df34c(0x1fe)];else{if(_0x4039f1[0x0]['language']=='French')var _0x3083ed=users[_0x5df34c(0x1ec)];else{if(_0x4039f1[0x0]['language']==_0x5df34c(0x1f8))var _0x3083ed=users['Portuguese'];else{if(_0x4039f1[0x0][_0x5df34c(0x209)]==_0x5df34c(0x22f))var _0x3083ed=users[_0x5df34c(0x22f)];else{if(_0x4039f1[0x0][_0x5df34c(0x209)]=='Arabic\x20(ae)')var _0x3083ed=users[_0x5df34c(0x201)];}}}}}}}_0x1d76da[_0x5df34c(0x229)](_0x5df34c(0x1cb),{'success':_0x3cbf6b[_0x5df34c(0x228)](_0x5df34c(0x1ff)),'errors':_0x3cbf6b[_0x5df34c(0x228)](_0x5df34c(0x1d1)),'role':_0x41a070,'profile':_0x355c08,'master_shop':_0x4039f1,'payment':_0x4bdd53,'payable':_0x2772a4,'receivable':_0x26a72c,'language':_0x3083ed});}catch(_0x14f195){console['log'](_0x14f195);}}),router[a0_0x5dfff6(0x22e)](a0_0x5dfff6(0x211),auth,async(_0x1b8f78,_0x44fa9e)=>{const _0x35b87d=a0_0x5dfff6;try{const _0x1048b6=new excelJS['Workbook'](),_0x49179b=_0x1048b6[_0x35b87d(0x226)](_0x35b87d(0x1da));return _0x49179b['columns']=[{'header':'Name','key':_0x35b87d(0x1e2),'width':0xa},{'header':_0x35b87d(0x1fd),'key':_0x35b87d(0x21c),'width':0xa},{'header':_0x35b87d(0x205),'key':_0x35b87d(0x224),'width':0xa},{'header':_0x35b87d(0x1de),'key':_0x35b87d(0x1f6),'width':0xa},{'header':_0x35b87d(0x220),'key':_0x35b87d(0x20b),'width':0xa},{'header':_0x35b87d(0x1f6),'key':_0x35b87d(0x1d3),'width':0xa}],_0x44fa9e[_0x35b87d(0x214)]('Content-Type',_0x35b87d(0x1e9)),_0x44fa9e[_0x35b87d(0x214)](_0x35b87d(0x1e8),_0x35b87d(0x21b)),_0x1048b6[_0x35b87d(0x1c4)][_0x35b87d(0x200)](_0x44fa9e)[_0x35b87d(0x1d9)](()=>{const _0x22e462=_0x35b87d;_0x44fa9e[_0x22e462(0x210)](0xc8);});}catch(_0x38af2c){_0x44fa9e[_0x35b87d(0x210)](0x190)[_0x35b87d(0x222)]({'errors':_0x38af2c['message']});}});function a0_0x3f2c(_0x2e7c84,_0x4e904f){const _0x28cffd=a0_0x28cf();return a0_0x3f2c=function(_0x3f2c3e,_0x17f07c){_0x3f2c3e=_0x3f2c3e-0x1bd;let _0x765c82=_0x28cffd[_0x3f2c3e];return _0x765c82;},a0_0x3f2c(_0x2e7c84,_0x4e904f);}const storage1=multer[a0_0x5dfff6(0x20c)]({'destination':(_0x355288,_0x5d4c4c,_0x2ded35)=>{const _0x5b42e2=a0_0x5dfff6;_0x2ded35(null,_0x5b42e2(0x219));},'filename':(_0x3b40e7,_0xd9d322,_0x8cfbd7)=>{const _0x22aaca=a0_0x5dfff6;_0x8cfbd7(null,Date['now']()+_0xd9d322[_0x22aaca(0x221)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x5dfff6(0x1fa)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0x5dfff6(0x1cd)](a0_0x5dfff6(0x1e5)),async(_0x3f9923,_0x3ca84d)=>{const _0x4ef2be=a0_0x5dfff6,_0x412649=_0x3f9923[_0x4ef2be(0x218)][_0x4ef2be(0x20d)],_0x1c9d3f=await xlsx[_0x4ef2be(0x1d2)](_0x4ef2be(0x20f)+_0x412649);let _0x2c3e71=_0x1c9d3f[_0x4ef2be(0x22d)],_0x2806d9=xlsx[_0x4ef2be(0x1d0)][_0x4ef2be(0x1ca)](_0x1c9d3f[_0x4ef2be(0x1d8)][_0x2c3e71[0x0]]);for(const _0x3577cc of _0x2806d9){const _0x154025=_0x3577cc[_0x4ef2be(0x21e)],_0x4e0034=_0x3577cc[_0x4ef2be(0x1fd)],_0x4c3519=_0x3577cc['address'],_0x37263f=_0x3577cc[_0x4ef2be(0x1de)],_0x554bfc=_0x3577cc[_0x4ef2be(0x205)],_0xeaaa11=_0x3577cc[_0x4ef2be(0x220)];try{let _0x221b46=await suppliers[_0x4ef2be(0x1bf)]({'name':_0x154025});if(!_0x221b46){const _0x499944=new suppliers({'name':_0x154025,'suppliers_code':_0x4e0034,'address':_0x4c3519,'mobile':_0x37263f,'email':_0x554bfc,'company':_0xeaaa11});_0x221b46=await _0x499944[_0x4ef2be(0x1c3)](),_0x3f9923[_0x4ef2be(0x228)](_0x4ef2be(0x1ff),_0x154025+_0x4ef2be(0x1e4));}else _0x3f9923[_0x4ef2be(0x228)](_0x4ef2be(0x1c5),_0x154025+'\x20Failed');}catch(_0x19cc53){_0x3ca84d[_0x4ef2be(0x210)](0x1f4)[_0x4ef2be(0x1be)]({'proderror':_0x19cc53[_0x4ef2be(0x1ee)],'aproduct':ProductName});}}_0x3ca84d[_0x4ef2be(0x1c1)](_0x4ef2be(0x1e6));}),module[a0_0x5dfff6(0x1eb)]=router;