const a0_0x16f118=a0_0x345b;(function(_0x239d63,_0x55dd03){const _0x330ded=a0_0x345b,_0x28e490=_0x239d63();while(!![]){try{const _0x39e4f0=-parseInt(_0x330ded(0xe6))/0x1*(parseInt(_0x330ded(0xb6))/0x2)+-parseInt(_0x330ded(0xc6))/0x3+-parseInt(_0x330ded(0xcd))/0x4+parseInt(_0x330ded(0xf7))/0x5*(-parseInt(_0x330ded(0xa3))/0x6)+parseInt(_0x330ded(0xa8))/0x7+-parseInt(_0x330ded(0x103))/0x8+parseInt(_0x330ded(0xeb))/0x9;if(_0x39e4f0===_0x55dd03)break;else _0x28e490['push'](_0x28e490['shift']());}catch(_0x2cd6ff){_0x28e490['push'](_0x28e490['shift']());}}}(a0_0x3262,0x60092));const express=require(a0_0x16f118(0xaa)),app=express(),router=express[a0_0x16f118(0xf1)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x16f118(0xad)),excelJS=require(a0_0x16f118(0xae)),xlsx=require('xlsx'),multer=require(a0_0x16f118(0xd5));router['get'](a0_0x16f118(0xc4),auth,async(_0x39c9ec,_0x1edfd0)=>{const _0xc851ee=a0_0x16f118;try{const {username:_0x329c27,email:_0x53e367,role:_0x5f4e36}=_0x39c9ec['user'],_0x2502af=_0x39c9ec[_0xc851ee(0xb4)],_0x45a115=await profile[_0xc851ee(0xb8)]({'email':_0x2502af[_0xc851ee(0xd3)]}),_0x199ebf=await master_shop['find']();console[_0xc851ee(0xbc)]('master',_0x199ebf);const _0x5bbf63=await suppliers[_0xc851ee(0xd4)]();console[_0xc851ee(0xbc)](_0x5bbf63);const _0x547f47=await suppliers[_0xc851ee(0xd1)]([{'$lookup':{'from':_0xc851ee(0xe2),'localField':_0xc851ee(0xbf),'foreignField':_0xc851ee(0xec),'as':_0xc851ee(0xb2)}}]),_0x42226c=_0x547f47[_0xc851ee(0xdb)](_0x3d2382=>{const _0x372722=_0xc851ee;console[_0x372722(0xbc)](_0x372722(0xce),_0x3d2382);var _0x252682=0x0,_0x18311c=0x0;return _0x3d2382['suppliers_docs'][_0x372722(0xbe)](_0x3243e7=>{const _0x224066=_0x372722;console[_0x224066(0xbc)](_0x224066(0xf3),_0x3243e7),_0x3243e7['reason']=='Purchase'?_0x252682+=_0x3243e7[_0x224066(0xc8)]:_0x18311c+=_0x3243e7[_0x224066(0xc8)];}),_0x3d2382[_0x372722(0xc1)]=_0x252682,_0x3d2382[_0x372722(0xcb)]=_0x18311c,_0x3d2382;});console[_0xc851ee(0xbc)](_0xc851ee(0xa1),_0x42226c);if(_0x199ebf[0x0][_0xc851ee(0xa7)]==_0xc851ee(0xfa)){var _0x33cb53=users[_0xc851ee(0x9f)];console['log'](_0x33cb53);}else{if(_0x199ebf[0x0][_0xc851ee(0xa7)]==_0xc851ee(0xc9))var _0x33cb53=users[_0xc851ee(0xc9)];else{if(_0x199ebf[0x0][_0xc851ee(0xa7)]==_0xc851ee(0x9c))var _0x33cb53=users['German'];else{if(_0x199ebf[0x0][_0xc851ee(0xa7)]==_0xc851ee(0xea))var _0x33cb53=users[_0xc851ee(0xea)];else{if(_0x199ebf[0x0][_0xc851ee(0xa7)]==_0xc851ee(0xbb))var _0x33cb53=users[_0xc851ee(0xbb)];else{if(_0x199ebf[0x0][_0xc851ee(0xa7)]==_0xc851ee(0xd8))var _0x33cb53=users[_0xc851ee(0xf5)];else{if(_0x199ebf[0x0]['language']==_0xc851ee(0xf6))var _0x33cb53=users[_0xc851ee(0xf6)];else{if(_0x199ebf[0x0]['language']==_0xc851ee(0xa2))var _0x33cb53=users['Arabic'];}}}}}}}_0x1edfd0['render'](_0xc851ee(0xc5),{'success':_0x39c9ec[_0xc851ee(0xa0)](_0xc851ee(0xfd)),'errors':_0x39c9ec[_0xc851ee(0xa0)](_0xc851ee(0xa4)),'user':_0x5bbf63,'profile':_0x45a115,'master_shop':_0x199ebf,'role':_0x2502af,'payment':_0x42226c,'language':_0x33cb53});}catch(_0x5b1681){console[_0xc851ee(0xbc)](_0x5b1681);}}),router[a0_0x16f118(0xba)]('/view',auth,async(_0x178b8d,_0x175330)=>{const _0x19d58e=a0_0x16f118;try{const {name:_0x30b953,email:_0x435cbf,mobile:_0x5e1f52,company:_0x24adf9,address:_0x1b511c,receivable:_0x882bba,payable:_0x398c2c,code:_0x17717d,contactperson:_0x3d2edd,landline:_0x2ce9b0}=_0x178b8d[_0x19d58e(0xaf)],_0x3780db=new suppliers({'name':_0x30b953,'email':_0x435cbf,'mobile':_0x5e1f52,'company':_0x24adf9,'address':_0x1b511c,'receivable':_0x882bba,'payable':_0x398c2c,'suppliers_code':_0x17717d,'contactperson':_0x3d2edd,'landline':_0x2ce9b0}),_0x4673e8=await _0x3780db['save']();_0x178b8d[_0x19d58e(0xa0)](_0x19d58e(0xfd),_0x19d58e(0xe8)),_0x175330[_0x19d58e(0x9b)](_0x19d58e(0x99));}catch(_0x5c70d0){console[_0x19d58e(0xbc)](_0x5c70d0);}}),router[a0_0x16f118(0xd7)]('/view/:id',auth,async(_0x2553ab,_0x35fab8)=>{const _0x5ba1c3=a0_0x16f118;try{const {username:_0x514449,email:_0x140564,role:_0x13ee30}=_0x2553ab['user'],_0x443f9f=_0x2553ab[_0x5ba1c3(0xb4)],_0x2371dd=await profile['findOne']({'email':_0x443f9f[_0x5ba1c3(0xd3)]}),_0x4447cb=await master_shop['find']();console[_0x5ba1c3(0xbc)](_0x5ba1c3(0xb0),_0x4447cb);const _0x54586c=_0x2553ab['params']['id'],_0x3b2668=await suppliers[_0x5ba1c3(0xf4)](_0x54586c);console['log'](_0x3b2668);if(_0x4447cb[0x0][_0x5ba1c3(0xa7)]==_0x5ba1c3(0xfa)){var _0x29fb49=users[_0x5ba1c3(0x9f)];console[_0x5ba1c3(0xbc)](_0x29fb49);}else{if(_0x4447cb[0x0]['language']==_0x5ba1c3(0xc9))var _0x29fb49=users['Hindi'];else{if(_0x4447cb[0x0]['language']=='German')var _0x29fb49=users[_0x5ba1c3(0x9c)];else{if(_0x4447cb[0x0][_0x5ba1c3(0xa7)]==_0x5ba1c3(0xea))var _0x29fb49=users[_0x5ba1c3(0xea)];else{if(_0x4447cb[0x0][_0x5ba1c3(0xa7)]==_0x5ba1c3(0xbb))var _0x29fb49=users[_0x5ba1c3(0xbb)];else{if(_0x4447cb[0x0][_0x5ba1c3(0xa7)]=='Portuguese\x20(BR)')var _0x29fb49=users[_0x5ba1c3(0xf5)];else{if(_0x4447cb[0x0][_0x5ba1c3(0xa7)]==_0x5ba1c3(0xf6))var _0x29fb49=users[_0x5ba1c3(0xf6)];else{if(_0x4447cb[0x0][_0x5ba1c3(0xa7)]==_0x5ba1c3(0xa2))var _0x29fb49=users[_0x5ba1c3(0xca)];}}}}}}}_0x35fab8[_0x5ba1c3(0xda)](_0x5ba1c3(0xc5),{'success':_0x2553ab[_0x5ba1c3(0xa0)](_0x5ba1c3(0xfd)),'errors':_0x2553ab[_0x5ba1c3(0xa0)](_0x5ba1c3(0xa4)),'role':_0x443f9f,'profile':_0x2371dd,'master_shop':_0x4447cb,'user':_0x3b2668,'language':_0x29fb49});}catch(_0x1eaa84){console[_0x5ba1c3(0xbc)](_0x1eaa84);}}),router[a0_0x16f118(0xba)](a0_0x16f118(0xdd),auth,async(_0x1dec36,_0x26f744)=>{const _0x548223=a0_0x16f118;try{const _0x559a8d=_0x1dec36[_0x548223(0xfc)]['id'],_0x4887ec=await suppliers[_0x548223(0xf4)](_0x559a8d),{name:_0x4bab47,email:_0x26e8a2,mobile:_0x370c6b,company:_0x5d0ffb,address:_0x2293db,receivable:_0x40e372,payable:_0x2d07fc,code:_0x21e376,contactperson:_0x118f01,landline:_0x317481}=_0x1dec36['body'];_0x4887ec[_0x548223(0xbf)]=_0x4bab47,_0x4887ec['email']=_0x26e8a2,_0x4887ec[_0x548223(0xed)]=_0x370c6b,_0x4887ec[_0x548223(0xac)]=_0x5d0ffb,_0x4887ec[_0x548223(0xe9)]=_0x2293db,_0x4887ec[_0x548223(0xe3)]=_0x40e372,_0x4887ec['payable']=_0x2d07fc,_0x4887ec[_0x548223(0xe7)]=_0x21e376,_0x4887ec[_0x548223(0x102)]=_0x118f01,_0x4887ec['landline']=_0x317481;const _0x1b0f5d=await _0x4887ec[_0x548223(0xe0)]();_0x1dec36['flash'](_0x548223(0xfd),'supplier\x20data\x20update\x20successfully'),_0x26f744['redirect'](_0x548223(0x99));}catch(_0x39e1e2){console[_0x548223(0xbc)](_0x39e1e2);}}),router[a0_0x16f118(0xd7)](a0_0x16f118(0xc3),auth,async(_0xfc51e,_0x3d91d3)=>{const _0x338946=a0_0x16f118;try{const {username:_0x3749d3,email:_0x265417,role:_0x37c498}=_0xfc51e[_0x338946(0xb4)],_0x582966=_0xfc51e[_0x338946(0xb4)],_0x44a087=await profile[_0x338946(0xb8)]({'email':_0x582966[_0x338946(0xd3)]}),_0x22c68a=await master_shop[_0x338946(0xd4)]();console[_0x338946(0xbc)](_0x338946(0xb0),_0x22c68a),console[_0x338946(0xbc)](_0xfc51e[_0x338946(0xfc)]['id']);const _0x58cb8a=await suppliers['findOne']({'_id':_0xfc51e['params']['id']});console[_0x338946(0xbc)](_0x58cb8a);const _0x5dcbae=await s_payment_data[_0x338946(0xd4)]({'suppliers':_0x58cb8a[_0x338946(0xbf)]});console[_0x338946(0xbc)](_0x5dcbae);const _0x542f93=await s_payment_data[_0x338946(0xd1)]([{'$match':{'suppliers':_0x58cb8a['name']}},{'$match':{'reason':_0x338946(0xb5)}},{'$group':{'_id':_0x338946(0x101),'sum':{'$sum':_0x338946(0x9d)}}}]);console[_0x338946(0xbc)](_0x338946(0xab),_0x542f93);const _0x8bc585=await s_payment_data[_0x338946(0xd1)]([{'$match':{'suppliers':_0x58cb8a[_0x338946(0xbf)]}},{'$match':{'reason':_0x338946(0xb7)}},{'$group':{'_id':_0x338946(0x101),'sum':{'$sum':_0x338946(0x9d)}}}]);console[_0x338946(0xbc)](_0x338946(0xd9),_0x8bc585);if(_0x22c68a[0x0][_0x338946(0xa7)]==_0x338946(0xfa)){var _0x40709b=users['English'];console['log'](_0x40709b);}else{if(_0x22c68a[0x0][_0x338946(0xa7)]==_0x338946(0xc9))var _0x40709b=users['Hindi'];else{if(_0x22c68a[0x0][_0x338946(0xa7)]==_0x338946(0x9c))var _0x40709b=users[_0x338946(0x9c)];else{if(_0x22c68a[0x0][_0x338946(0xa7)]==_0x338946(0xea))var _0x40709b=users['Spanish'];else{if(_0x22c68a[0x0][_0x338946(0xa7)]==_0x338946(0xbb))var _0x40709b=users['French'];else{if(_0x22c68a[0x0][_0x338946(0xa7)]=='Portuguese\x20(BR)')var _0x40709b=users[_0x338946(0xf5)];else{if(_0x22c68a[0x0][_0x338946(0xa7)]==_0x338946(0xf6))var _0x40709b=users[_0x338946(0xf6)];else{if(_0x22c68a[0x0][_0x338946(0xa7)]==_0x338946(0xa2))var _0x40709b=users['Arabic'];}}}}}}}_0x3d91d3['render'](_0x338946(0xb1),{'success':_0xfc51e[_0x338946(0xa0)](_0x338946(0xfd)),'errors':_0xfc51e[_0x338946(0xa0)](_0x338946(0xa4)),'role':_0x582966,'profile':_0x44a087,'master_shop':_0x22c68a,'payment':_0x5dcbae,'payable':_0x542f93,'receivable':_0x8bc585,'language':_0x40709b});}catch(_0x558f60){console[_0x338946(0xbc)](_0x558f60);}}),router[a0_0x16f118(0xd7)](a0_0x16f118(0xa6),auth,async(_0x4d686d,_0x2a2ae6)=>{const _0x25825f=a0_0x16f118;try{const _0x59e660=new excelJS['Workbook'](),_0x40c4b6=_0x59e660[_0x25825f(0xe4)](_0x25825f(0xcc));return _0x40c4b6[_0x25825f(0xa9)]=[{'header':_0x25825f(0xcf),'key':_0x25825f(0xef),'width':0xa},{'header':'Supplier_Code','key':_0x25825f(0xb9),'width':0xa},{'header':_0x25825f(0xb3),'key':_0x25825f(0xc2),'width':0xa},{'header':_0x25825f(0x9e),'key':'address','width':0xa},{'header':_0x25825f(0xfb),'key':_0x25825f(0xed),'width':0xa},{'header':'address','key':_0x25825f(0xd3),'width':0xa}],_0x2a2ae6['setHeader'](_0x25825f(0xff),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x2a2ae6[_0x25825f(0xbd)](_0x25825f(0xdc),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x59e660[_0x25825f(0x9a)][_0x25825f(0xc0)](_0x2a2ae6)[_0x25825f(0x98)](()=>{_0x2a2ae6['status'](0xc8);});}catch(_0x204833){_0x2a2ae6['status'](0x190)[_0x25825f(0xd2)]({'errors':_0x204833[_0x25825f(0x100)]});}});function a0_0x3262(){const _0x49f7fb=['find','multer','Sheets','get','Portuguese\x20(BR)','receivable_sum','render','map','Content-Disposition','/view/:id','now','originalname','save','SheetNames','s_payments','receivable','addWorksheet','public/Migration/','123784sOWLlG','suppliers_code','supplier\x20data\x20add\x20successfully','address','Spanish','11715174XphzAt','suppliers','mobile','utils','PBrands','/supplier_import_migrate_file','Router','filename','doc','findById','Portuguese','Chinese','20VKxpPj','public/Migration','\x20added\x20successfully','English\x20(US)','Company_Name','params','success','single','Content-Type','message','$reason','contactperson','1744768pYfLzG','then','/supplier/view','xlsx','redirect','German','$amount','Mobile_number','English','flash','supplier.js\x20payment_data','Arabic\x20(ae)','207258KfQvhS','errors','diskStorage','/products_export_migrate_file','language','1130689ZnHgcS','columns','express','payable_sum','company','../public/language/languages.json','exceljs','body','master','supplier_payment','suppliers_docs','Email','user','Purchase','8UTjGTg','Purchase\x20Return','findOne','PUnits','post','French','log','setHeader','forEach','name','write','purchase','SalesmanName','/view/payment/:id','/view','supplier','465900OxGwRk','Supplier_Code','amount','Hindi','Arabic','purchase_return','Customers','252588lOSaGF','data','Name','error','aggregate','send','email'];a0_0x3262=function(){return _0x49f7fb;};return a0_0x3262();}const storage1=multer[a0_0x16f118(0xa5)]({'destination':(_0x96bf85,_0x295e0e,_0x13cf62)=>{const _0x1fa2e5=a0_0x16f118;_0x13cf62(null,_0x1fa2e5(0xf8));},'filename':(_0x84c6d4,_0x6bfde2,_0xf350d5)=>{const _0x58a843=a0_0x16f118;_0xf350d5(null,Date[_0x58a843(0xde)]()+_0x6bfde2[_0x58a843(0xdf)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x345b(_0x3076e6,_0x1318df){const _0x32622f=a0_0x3262();return a0_0x345b=function(_0x345b21,_0xab92fb){_0x345b21=_0x345b21-0x98;let _0x372160=_0x32622f[_0x345b21];return _0x372160;},a0_0x345b(_0x3076e6,_0x1318df);}router[a0_0x16f118(0xba)](a0_0x16f118(0xf0),auth,uploadMigrate[a0_0x16f118(0xfe)]('supplier_product_file'),async(_0x46dd3e,_0x38bef0)=>{const _0x5ab1d1=a0_0x16f118,_0x3ae3ac=_0x46dd3e['file'][_0x5ab1d1(0xf2)],_0x153dcc=await xlsx['readFile'](_0x5ab1d1(0xe5)+_0x3ae3ac);let _0x881357=_0x153dcc[_0x5ab1d1(0xe1)],_0x5bd0e4=xlsx[_0x5ab1d1(0xee)]['sheet_to_json'](_0x153dcc[_0x5ab1d1(0xd6)][_0x881357[0x0]]);for(const _0x3b2241 of _0x5bd0e4){const _0x3404b9=_0x3b2241[_0x5ab1d1(0xcf)],_0x578a79=_0x3b2241[_0x5ab1d1(0xc7)],_0x11182a=_0x3b2241[_0x5ab1d1(0xe9)],_0x12ee52=_0x3b2241[_0x5ab1d1(0x9e)],_0x49d87d=_0x3b2241[_0x5ab1d1(0xb3)],_0x53b4fd=_0x3b2241[_0x5ab1d1(0xfb)];try{let _0x47b443=await suppliers[_0x5ab1d1(0xb8)]({'name':_0x3404b9});if(!_0x47b443){const _0x44ab75=new suppliers({'name':_0x3404b9,'suppliers_code':_0x578a79,'address':_0x11182a,'mobile':_0x12ee52,'email':_0x49d87d,'company':_0x53b4fd});_0x47b443=await _0x44ab75[_0x5ab1d1(0xe0)](),_0x46dd3e['flash'](_0x5ab1d1(0xfd),_0x3404b9+_0x5ab1d1(0xf9));}else _0x46dd3e[_0x5ab1d1(0xa0)](_0x5ab1d1(0xd0),_0x3404b9+'\x20Failed');}catch(_0x2676ff){_0x38bef0['status'](0x1f4)['json']({'proderror':_0x2676ff[_0x5ab1d1(0x100)],'aproduct':ProductName});}}_0x38bef0[_0x5ab1d1(0x9b)](_0x5ab1d1(0x99));}),module['exports']=router;