const a0_0x3b8e5b=a0_0x5509;function a0_0x5509(_0x81f558,_0x4a8b36){const _0x38ff69=a0_0x38ff();return a0_0x5509=function(_0x550957,_0x543b84){_0x550957=_0x550957-0x9b;let _0x58fd54=_0x38ff69[_0x550957];return _0x58fd54;},a0_0x5509(_0x81f558,_0x4a8b36);}(function(_0x1963dc,_0x3ea443){const _0x180a6d=a0_0x5509,_0x4e63ea=_0x1963dc();while(!![]){try{const _0x5d6099=-parseInt(_0x180a6d(0xd5))/0x1+parseInt(_0x180a6d(0xf8))/0x2+-parseInt(_0x180a6d(0xd8))/0x3+parseInt(_0x180a6d(0xaa))/0x4*(-parseInt(_0x180a6d(0xc5))/0x5)+-parseInt(_0x180a6d(0x102))/0x6*(parseInt(_0x180a6d(0xbb))/0x7)+-parseInt(_0x180a6d(0xe2))/0x8*(parseInt(_0x180a6d(0xe3))/0x9)+parseInt(_0x180a6d(0xe0))/0xa;if(_0x5d6099===_0x3ea443)break;else _0x4e63ea['push'](_0x4e63ea['shift']());}catch(_0x3958db){_0x4e63ea['push'](_0x4e63ea['shift']());}}}(a0_0x38ff,0x6c1c4));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x3b8e5b(0x9c)),auth=require(a0_0x3b8e5b(0xb6)),users=require(a0_0x3b8e5b(0xc1)),excelJS=require('exceljs'),xlsx=require(a0_0x3b8e5b(0xbc)),multer=require('multer');function a0_0x38ff(){const _0x1be910=['send','Purchase\x20Return','s_payments','language','supplier_payment','render','flash','user','1722VFHdjQ','receivable','message','aggregate','../models/all_models','\x20added\x20successfully','address','email','SalesmanName','payable','English\x20(US)','company','Portuguese','originalname','Content-Disposition','PUnits','Company_Name','status','1338332xRpuBX','addWorksheet','/supplier/view','supplier.js\x20payment_data','supplier\x20data\x20update\x20successfully','get','/products_export_migrate_file','Arabic','supplier\x20data\x20add\x20successfully','save','name','errors','../middleware/auth','log','Mobile_number','German','find','2366xlVlfg','xlsx','Name','Customers','forEach','master','../public/language/languages.json','single','Spanish','/view','5axlqdT','success','post','suppliers_code','supplier_product_file','purchase','Purchase','supplier','Chinese','error','payable_sum','Sheets','\x20Failed','public/Migration/','Email','now','121514wOWjks','Hindi','sheet_to_json','2364447VEkCmt','findById','Workbook','redirect','$amount','attachment;\x20filename=supplier_Migration_File.xlsx','$reason','exports','13340560dSEltX','PBrands','24IcArTH','46287DyfDUK','params','body','/view/payment/:id','English','contactperson','Supplier_Code','Portuguese\x20(BR)','amount','Arabic\x20(ae)','filename','French','SheetNames','receivable_sum','/view/:id','findOne','mobile','landline','readFile','Content-Type','then','930890EjZsKi','diskStorage'];a0_0x38ff=function(){return _0x1be910;};return a0_0x38ff();}router[a0_0x3b8e5b(0xaf)](a0_0x3b8e5b(0xc4),auth,async(_0x5b6e31,_0x579697)=>{const _0x37d4b2=a0_0x3b8e5b;try{const {username:_0x5a741a,email:_0x1e241b,role:_0x37d205}=_0x5b6e31[_0x37d4b2(0x101)],_0x409243=_0x5b6e31[_0x37d4b2(0x101)],_0x13d807=await profile[_0x37d4b2(0xf2)]({'email':_0x409243['email']}),_0x284207=await master_shop[_0x37d4b2(0xba)]();console[_0x37d4b2(0xb7)]('master',_0x284207);const _0x39c98d=await suppliers[_0x37d4b2(0xba)]();console[_0x37d4b2(0xb7)](_0x39c98d);const _0x3edeff=await suppliers[_0x37d4b2(0x9b)]([{'$lookup':{'from':_0x37d4b2(0xfc),'localField':_0x37d4b2(0xb4),'foreignField':'suppliers','as':'suppliers_docs'}}]),_0x57a797=_0x3edeff['map'](_0xe7c6db=>{const _0x5e7cd5=_0x37d4b2;console[_0x5e7cd5(0xb7)]('data',_0xe7c6db);var _0x283562=0x0,_0x27c065=0x0;return _0xe7c6db['suppliers_docs'][_0x5e7cd5(0xbf)](_0x45f499=>{const _0x544692=_0x5e7cd5;console['log']('doc',_0x45f499),_0x45f499['reason']=='Purchase'?_0x283562+=_0x45f499[_0x544692(0xeb)]:_0x27c065+=_0x45f499[_0x544692(0xeb)];}),_0xe7c6db[_0x5e7cd5(0xca)]=_0x283562,_0xe7c6db['purchase_return']=_0x27c065,_0xe7c6db;});console[_0x37d4b2(0xb7)](_0x37d4b2(0xad),_0x57a797);if(_0x284207[0x0][_0x37d4b2(0xfd)]=='English\x20(US)'){var _0x2a9e77=users[_0x37d4b2(0xe7)];console['log'](_0x2a9e77);}else{if(_0x284207[0x0]['language']==_0x37d4b2(0xd6))var _0x2a9e77=users['Hindi'];else{if(_0x284207[0x0]['language']=='German')var _0x2a9e77=users[_0x37d4b2(0xb9)];else{if(_0x284207[0x0][_0x37d4b2(0xfd)]==_0x37d4b2(0xc3))var _0x2a9e77=users['Spanish'];else{if(_0x284207[0x0]['language']=='French')var _0x2a9e77=users['French'];else{if(_0x284207[0x0][_0x37d4b2(0xfd)]==_0x37d4b2(0xea))var _0x2a9e77=users[_0x37d4b2(0xa4)];else{if(_0x284207[0x0]['language']=='Chinese')var _0x2a9e77=users['Chinese'];else{if(_0x284207[0x0][_0x37d4b2(0xfd)]==_0x37d4b2(0xec))var _0x2a9e77=users[_0x37d4b2(0xb1)];}}}}}}}_0x579697['render'](_0x37d4b2(0xcc),{'success':_0x5b6e31[_0x37d4b2(0x100)](_0x37d4b2(0xc6)),'errors':_0x5b6e31['flash']('errors'),'user':_0x39c98d,'profile':_0x13d807,'master_shop':_0x284207,'role':_0x409243,'payment':_0x57a797,'language':_0x2a9e77});}catch(_0x4ff777){console[_0x37d4b2(0xb7)](_0x4ff777);}}),router[a0_0x3b8e5b(0xc7)]('/view',auth,async(_0x41f6e5,_0x21014a)=>{const _0x4e59c7=a0_0x3b8e5b;try{const {name:_0x1a4529,email:_0x3658ae,mobile:_0x4f3438,company:_0x41d2c7,address:_0x1dd193,receivable:_0x403ce6,payable:_0x4bb86b,code:_0x5ec5c6,contactperson:_0x5a9aac,landline:_0x5d298b}=_0x41f6e5[_0x4e59c7(0xe5)],_0x494ee3=new suppliers({'name':_0x1a4529,'email':_0x3658ae,'mobile':_0x4f3438,'company':_0x41d2c7,'address':_0x1dd193,'receivable':_0x403ce6,'payable':_0x4bb86b,'suppliers_code':_0x5ec5c6,'contactperson':_0x5a9aac,'landline':_0x5d298b}),_0x15daed=await _0x494ee3[_0x4e59c7(0xb3)]();_0x41f6e5[_0x4e59c7(0x100)](_0x4e59c7(0xc6),_0x4e59c7(0xb2)),_0x21014a[_0x4e59c7(0xdb)](_0x4e59c7(0xac));}catch(_0x1dc5fc){console['log'](_0x1dc5fc);}}),router[a0_0x3b8e5b(0xaf)](a0_0x3b8e5b(0xf1),auth,async(_0x5067fe,_0x128572)=>{const _0x51718c=a0_0x3b8e5b;try{const {username:_0x5ef5da,email:_0x238d5c,role:_0x376c9c}=_0x5067fe[_0x51718c(0x101)],_0x31231e=_0x5067fe[_0x51718c(0x101)],_0x19e779=await profile['findOne']({'email':_0x31231e['email']}),_0x3e41ce=await master_shop['find']();console[_0x51718c(0xb7)](_0x51718c(0xc0),_0x3e41ce);const _0x33ee0d=_0x5067fe[_0x51718c(0xe4)]['id'],_0x2415e9=await suppliers[_0x51718c(0xd9)](_0x33ee0d);console[_0x51718c(0xb7)](_0x2415e9);if(_0x3e41ce[0x0][_0x51718c(0xfd)]==_0x51718c(0xa2)){var _0x152efa=users[_0x51718c(0xe7)];console[_0x51718c(0xb7)](_0x152efa);}else{if(_0x3e41ce[0x0][_0x51718c(0xfd)]=='Hindi')var _0x152efa=users['Hindi'];else{if(_0x3e41ce[0x0][_0x51718c(0xfd)]=='German')var _0x152efa=users[_0x51718c(0xb9)];else{if(_0x3e41ce[0x0]['language']==_0x51718c(0xc3))var _0x152efa=users['Spanish'];else{if(_0x3e41ce[0x0][_0x51718c(0xfd)]==_0x51718c(0xee))var _0x152efa=users[_0x51718c(0xee)];else{if(_0x3e41ce[0x0][_0x51718c(0xfd)]=='Portuguese\x20(BR)')var _0x152efa=users[_0x51718c(0xa4)];else{if(_0x3e41ce[0x0][_0x51718c(0xfd)]==_0x51718c(0xcd))var _0x152efa=users[_0x51718c(0xcd)];else{if(_0x3e41ce[0x0][_0x51718c(0xfd)]==_0x51718c(0xec))var _0x152efa=users[_0x51718c(0xb1)];}}}}}}}_0x128572[_0x51718c(0xff)](_0x51718c(0xcc),{'success':_0x5067fe[_0x51718c(0x100)](_0x51718c(0xc6)),'errors':_0x5067fe[_0x51718c(0x100)](_0x51718c(0xb5)),'role':_0x31231e,'profile':_0x19e779,'master_shop':_0x3e41ce,'user':_0x2415e9,'language':_0x152efa});}catch(_0x3948f2){console[_0x51718c(0xb7)](_0x3948f2);}}),router[a0_0x3b8e5b(0xc7)](a0_0x3b8e5b(0xf1),auth,async(_0x50322e,_0x464d42)=>{const _0x5a8aaa=a0_0x3b8e5b;try{const _0x118ade=_0x50322e[_0x5a8aaa(0xe4)]['id'],_0xc3aa95=await suppliers[_0x5a8aaa(0xd9)](_0x118ade),{name:_0x1d6d0a,email:_0x2ba08c,mobile:_0x43cca3,company:_0x1d364d,address:_0x59d417,receivable:_0x19d13f,payable:_0x2182d5,code:_0x53c3a1,contactperson:_0x18144c,landline:_0x574f50}=_0x50322e[_0x5a8aaa(0xe5)];_0xc3aa95[_0x5a8aaa(0xb4)]=_0x1d6d0a,_0xc3aa95['email']=_0x2ba08c,_0xc3aa95[_0x5a8aaa(0xf3)]=_0x43cca3,_0xc3aa95[_0x5a8aaa(0xa3)]=_0x1d364d,_0xc3aa95[_0x5a8aaa(0x9e)]=_0x59d417,_0xc3aa95[_0x5a8aaa(0x103)]=_0x19d13f,_0xc3aa95[_0x5a8aaa(0xa1)]=_0x2182d5,_0xc3aa95[_0x5a8aaa(0xc8)]=_0x53c3a1,_0xc3aa95[_0x5a8aaa(0xe8)]=_0x18144c,_0xc3aa95[_0x5a8aaa(0xf4)]=_0x574f50;const _0x1f243b=await _0xc3aa95[_0x5a8aaa(0xb3)]();_0x50322e[_0x5a8aaa(0x100)]('success',_0x5a8aaa(0xae)),_0x464d42[_0x5a8aaa(0xdb)](_0x5a8aaa(0xac));}catch(_0x345ae6){console[_0x5a8aaa(0xb7)](_0x345ae6);}}),router[a0_0x3b8e5b(0xaf)](a0_0x3b8e5b(0xe6),auth,async(_0x41e14e,_0x3143ba)=>{const _0x1aeee0=a0_0x3b8e5b;try{const {username:_0x52e911,email:_0x5b2abd,role:_0x1aa321}=_0x41e14e[_0x1aeee0(0x101)],_0x1c8a70=_0x41e14e[_0x1aeee0(0x101)],_0x327832=await profile[_0x1aeee0(0xf2)]({'email':_0x1c8a70['email']}),_0x2fa313=await master_shop[_0x1aeee0(0xba)]();console['log']('master',_0x2fa313),console[_0x1aeee0(0xb7)](_0x41e14e[_0x1aeee0(0xe4)]['id']);const _0x26855f=await suppliers[_0x1aeee0(0xf2)]({'_id':_0x41e14e[_0x1aeee0(0xe4)]['id']});console[_0x1aeee0(0xb7)](_0x26855f);const _0x17a369=await s_payment_data[_0x1aeee0(0xba)]({'suppliers':_0x26855f['name']});console['log'](_0x17a369);const _0x4c24be=await s_payment_data[_0x1aeee0(0x9b)]([{'$match':{'suppliers':_0x26855f[_0x1aeee0(0xb4)]}},{'$match':{'reason':_0x1aeee0(0xcb)}},{'$group':{'_id':_0x1aeee0(0xde),'sum':{'$sum':_0x1aeee0(0xdc)}}}]);console['log'](_0x1aeee0(0xcf),_0x4c24be);const _0x221acd=await s_payment_data[_0x1aeee0(0x9b)]([{'$match':{'suppliers':_0x26855f[_0x1aeee0(0xb4)]}},{'$match':{'reason':_0x1aeee0(0xfb)}},{'$group':{'_id':_0x1aeee0(0xde),'sum':{'$sum':_0x1aeee0(0xdc)}}}]);console['log'](_0x1aeee0(0xf0),_0x221acd);if(_0x2fa313[0x0]['language']==_0x1aeee0(0xa2)){var _0x29e8c7=users['English'];console[_0x1aeee0(0xb7)](_0x29e8c7);}else{if(_0x2fa313[0x0][_0x1aeee0(0xfd)]==_0x1aeee0(0xd6))var _0x29e8c7=users[_0x1aeee0(0xd6)];else{if(_0x2fa313[0x0][_0x1aeee0(0xfd)]==_0x1aeee0(0xb9))var _0x29e8c7=users['German'];else{if(_0x2fa313[0x0]['language']==_0x1aeee0(0xc3))var _0x29e8c7=users[_0x1aeee0(0xc3)];else{if(_0x2fa313[0x0][_0x1aeee0(0xfd)]==_0x1aeee0(0xee))var _0x29e8c7=users[_0x1aeee0(0xee)];else{if(_0x2fa313[0x0][_0x1aeee0(0xfd)]==_0x1aeee0(0xea))var _0x29e8c7=users['Portuguese'];else{if(_0x2fa313[0x0]['language']==_0x1aeee0(0xcd))var _0x29e8c7=users[_0x1aeee0(0xcd)];else{if(_0x2fa313[0x0]['language']==_0x1aeee0(0xec))var _0x29e8c7=users[_0x1aeee0(0xb1)];}}}}}}}_0x3143ba['render'](_0x1aeee0(0xfe),{'success':_0x41e14e[_0x1aeee0(0x100)](_0x1aeee0(0xc6)),'errors':_0x41e14e[_0x1aeee0(0x100)](_0x1aeee0(0xb5)),'role':_0x1c8a70,'profile':_0x327832,'master_shop':_0x2fa313,'payment':_0x17a369,'payable':_0x4c24be,'receivable':_0x221acd,'language':_0x29e8c7});}catch(_0x1ff1ca){console[_0x1aeee0(0xb7)](_0x1ff1ca);}}),router[a0_0x3b8e5b(0xaf)](a0_0x3b8e5b(0xb0),auth,async(_0x2968ed,_0x324c63)=>{const _0x48daca=a0_0x3b8e5b;try{const _0x2e321c=new excelJS[(_0x48daca(0xda))](),_0x4f82c2=_0x2e321c[_0x48daca(0xab)](_0x48daca(0xbe));return _0x4f82c2['columns']=[{'header':_0x48daca(0xbd),'key':_0x48daca(0xe1),'width':0xa},{'header':_0x48daca(0xe9),'key':_0x48daca(0xa7),'width':0xa},{'header':_0x48daca(0xd3),'key':_0x48daca(0xa0),'width':0xa},{'header':_0x48daca(0xb8),'key':_0x48daca(0x9e),'width':0xa},{'header':_0x48daca(0xa8),'key':_0x48daca(0xf3),'width':0xa},{'header':'address','key':_0x48daca(0x9f),'width':0xa}],_0x324c63['setHeader'](_0x48daca(0xf6),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x324c63['setHeader'](_0x48daca(0xa6),_0x48daca(0xdd)),_0x2e321c[_0x48daca(0xbc)]['write'](_0x324c63)[_0x48daca(0xf7)](()=>{_0x324c63['status'](0xc8);});}catch(_0x5b157a){_0x324c63[_0x48daca(0xa9)](0x190)[_0x48daca(0xfa)]({'errors':_0x5b157a[_0x48daca(0x104)]});}});const storage1=multer[a0_0x3b8e5b(0xf9)]({'destination':(_0x54bf1b,_0x44f958,_0x54ee63)=>{_0x54ee63(null,'public/Migration');},'filename':(_0x1b1c96,_0x2876fd,_0xeff124)=>{const _0x1e9897=a0_0x3b8e5b;_0xeff124(null,Date[_0x1e9897(0xd4)]()+_0x2876fd[_0x1e9897(0xa5)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x3b8e5b(0xc7)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0x3b8e5b(0xc2)](a0_0x3b8e5b(0xc9)),async(_0x289dcb,_0x1d0066)=>{const _0x112782=a0_0x3b8e5b,_0x2dabc1=_0x289dcb['file'][_0x112782(0xed)],_0x4c6f86=await xlsx[_0x112782(0xf5)](_0x112782(0xd2)+_0x2dabc1);let _0x35aa83=_0x4c6f86[_0x112782(0xef)],_0x15d17b=xlsx['utils'][_0x112782(0xd7)](_0x4c6f86[_0x112782(0xd0)][_0x35aa83[0x0]]);for(const _0x146afc of _0x15d17b){const _0x3dadd4=_0x146afc['Name'],_0x5744a2=_0x146afc['Supplier_Code'],_0x4bfa42=_0x146afc[_0x112782(0x9e)],_0x1b303d=_0x146afc[_0x112782(0xb8)],_0x2dbf0f=_0x146afc[_0x112782(0xd3)],_0x569afc=_0x146afc['Company_Name'];try{let _0x451927=await suppliers[_0x112782(0xf2)]({'name':_0x3dadd4});if(!_0x451927){const _0x2f4300=new suppliers({'name':_0x3dadd4,'suppliers_code':_0x5744a2,'address':_0x4bfa42,'mobile':_0x1b303d,'email':_0x2dbf0f,'company':_0x569afc});_0x451927=await _0x2f4300[_0x112782(0xb3)](),_0x289dcb[_0x112782(0x100)](_0x112782(0xc6),_0x3dadd4+_0x112782(0x9d));}else _0x289dcb[_0x112782(0x100)](_0x112782(0xce),_0x3dadd4+_0x112782(0xd1));}catch(_0x21ef0f){_0x1d0066[_0x112782(0xa9)](0x1f4)['json']({'proderror':_0x21ef0f[_0x112782(0x104)],'aproduct':ProductName});}}_0x1d0066[_0x112782(0xdb)]('/supplier/view');}),module[a0_0x3b8e5b(0xdf)]=router;