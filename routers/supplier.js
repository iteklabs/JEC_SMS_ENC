const a0_0x1cc438=a0_0x2684;(function(_0x40f7a6,_0x4c29e3){const _0x308229=a0_0x2684,_0x35930c=_0x40f7a6();while(!![]){try{const _0x2edee5=-parseInt(_0x308229(0x14b))/0x1+parseInt(_0x308229(0x144))/0x2*(parseInt(_0x308229(0x176))/0x3)+parseInt(_0x308229(0x159))/0x4*(parseInt(_0x308229(0x132))/0x5)+parseInt(_0x308229(0x148))/0x6*(parseInt(_0x308229(0x151))/0x7)+parseInt(_0x308229(0x16f))/0x8*(-parseInt(_0x308229(0x18e))/0x9)+parseInt(_0x308229(0x150))/0xa*(-parseInt(_0x308229(0x134))/0xb)+parseInt(_0x308229(0x172))/0xc*(parseInt(_0x308229(0x17a))/0xd);if(_0x2edee5===_0x4c29e3)break;else _0x35930c['push'](_0x35930c['shift']());}catch(_0x5b9bd3){_0x35930c['push'](_0x35930c['shift']());}}}(a0_0x13b6,0x20374));const express=require(a0_0x1cc438(0x12f)),app=express(),router=express[a0_0x1cc438(0x196)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x1cc438(0x194)),auth=require('../middleware/auth'),users=require(a0_0x1cc438(0x1a0)),excelJS=require(a0_0x1cc438(0x161)),xlsx=require(a0_0x1cc438(0x13e)),multer=require(a0_0x1cc438(0x18f));router['get'](a0_0x1cc438(0x189),auth,async(_0x464b73,_0x2a6f41)=>{const _0x1def60=a0_0x1cc438;try{const {username:_0x5ef299,email:_0x101aeb,role:_0x25a5e0}=_0x464b73['user'],_0x244cca=_0x464b73['user'],_0x5bb3df=await profile[_0x1def60(0x155)]({'email':_0x244cca['email']}),_0x41d4af=await master_shop[_0x1def60(0x19a)]();console['log'](_0x1def60(0x192),_0x41d4af);const _0x1ad594=await suppliers['find']();console[_0x1def60(0x13d)](_0x1ad594);const _0x3a3162=await suppliers[_0x1def60(0x141)]([{'$lookup':{'from':_0x1def60(0x19e),'localField':_0x1def60(0x16b),'foreignField':_0x1def60(0x18a),'as':_0x1def60(0x133)}}]),_0x330ac2=_0x3a3162[_0x1def60(0x14d)](_0x51c818=>{const _0x25d273=_0x1def60;console[_0x25d273(0x13d)](_0x25d273(0x18c),_0x51c818);var _0x3fcc3b=0x0,_0x33997a=0x0;return _0x51c818[_0x25d273(0x133)][_0x25d273(0x16d)](_0x34b96a=>{const _0xb736ce=_0x25d273;console[_0xb736ce(0x13d)](_0xb736ce(0x152),_0x34b96a),_0x34b96a[_0xb736ce(0x180)]=='Purchase'?_0x3fcc3b+=_0x34b96a['amount']:_0x33997a+=_0x34b96a[_0xb736ce(0x19d)];}),_0x51c818[_0x25d273(0x13a)]=_0x3fcc3b,_0x51c818[_0x25d273(0x18d)]=_0x33997a,_0x51c818;});console[_0x1def60(0x13d)](_0x1def60(0x175),_0x330ac2);if(_0x41d4af[0x0][_0x1def60(0x130)]==_0x1def60(0x19f)){var _0x2b676f=users['English'];console[_0x1def60(0x13d)](_0x2b676f);}else{if(_0x41d4af[0x0][_0x1def60(0x130)]==_0x1def60(0x190))var _0x2b676f=users[_0x1def60(0x190)];else{if(_0x41d4af[0x0][_0x1def60(0x130)]==_0x1def60(0x146))var _0x2b676f=users[_0x1def60(0x146)];else{if(_0x41d4af[0x0][_0x1def60(0x130)]=='Spanish')var _0x2b676f=users[_0x1def60(0x191)];else{if(_0x41d4af[0x0][_0x1def60(0x130)]==_0x1def60(0x17b))var _0x2b676f=users['French'];else{if(_0x41d4af[0x0][_0x1def60(0x130)]==_0x1def60(0x14e))var _0x2b676f=users[_0x1def60(0x17f)];else{if(_0x41d4af[0x0][_0x1def60(0x130)]==_0x1def60(0x185))var _0x2b676f=users[_0x1def60(0x185)];else{if(_0x41d4af[0x0]['language']==_0x1def60(0x15d))var _0x2b676f=users['Arabic'];}}}}}}}_0x2a6f41['render']('supplier',{'success':_0x464b73[_0x1def60(0x138)](_0x1def60(0x13c)),'errors':_0x464b73[_0x1def60(0x138)](_0x1def60(0x19b)),'user':_0x1ad594,'profile':_0x5bb3df,'master_shop':_0x41d4af,'role':_0x244cca,'payment':_0x330ac2,'language':_0x2b676f});}catch(_0x5b6c95){console['log'](_0x5b6c95);}}),router['post'](a0_0x1cc438(0x189),auth,async(_0x39c7d1,_0x4b9bc7)=>{const _0x5c204a=a0_0x1cc438;try{const {name:_0x3006b0,email:_0x24f6f0,mobile:_0x3ff91c,company:_0x2dbcd4,address:_0x484af6,receivable:_0x361d81,payable:_0x5dd4e6,code:_0x2e7a29,contactperson:_0x3a74fe,landline:_0x145d4b}=_0x39c7d1[_0x5c204a(0x14a)],_0x4fd50b=new suppliers({'name':_0x3006b0,'email':_0x24f6f0,'mobile':_0x3ff91c,'company':_0x2dbcd4,'address':_0x484af6,'receivable':_0x361d81,'payable':_0x5dd4e6,'suppliers_code':_0x2e7a29,'contactperson':_0x3a74fe,'landline':_0x145d4b}),_0x20fd39=await _0x4fd50b[_0x5c204a(0x135)]();_0x39c7d1[_0x5c204a(0x138)](_0x5c204a(0x13c),'supplier\x20data\x20add\x20successfully'),_0x4b9bc7[_0x5c204a(0x171)]('/supplier/view');}catch(_0x4e9e44){console['log'](_0x4e9e44);}}),router[a0_0x1cc438(0x169)](a0_0x1cc438(0x181),auth,async(_0x573bf5,_0x13b973)=>{const _0x2ff3fb=a0_0x1cc438;try{const {username:_0x3a9c48,email:_0x28e78a,role:_0x5e9768}=_0x573bf5[_0x2ff3fb(0x147)],_0x10ef33=_0x573bf5[_0x2ff3fb(0x147)],_0x53be37=await profile[_0x2ff3fb(0x155)]({'email':_0x10ef33[_0x2ff3fb(0x170)]}),_0x4cd1cf=await master_shop[_0x2ff3fb(0x19a)]();console['log'](_0x2ff3fb(0x192),_0x4cd1cf);const _0x31bc67=_0x573bf5[_0x2ff3fb(0x167)]['id'],_0x24fd0a=await suppliers[_0x2ff3fb(0x154)](_0x31bc67);console[_0x2ff3fb(0x13d)](_0x24fd0a);if(_0x4cd1cf[0x0][_0x2ff3fb(0x130)]=='English\x20(US)'){var _0x48c621=users[_0x2ff3fb(0x166)];console['log'](_0x48c621);}else{if(_0x4cd1cf[0x0][_0x2ff3fb(0x130)]=='Hindi')var _0x48c621=users[_0x2ff3fb(0x190)];else{if(_0x4cd1cf[0x0]['language']==_0x2ff3fb(0x146))var _0x48c621=users[_0x2ff3fb(0x146)];else{if(_0x4cd1cf[0x0]['language']=='Spanish')var _0x48c621=users[_0x2ff3fb(0x191)];else{if(_0x4cd1cf[0x0]['language']==_0x2ff3fb(0x17b))var _0x48c621=users[_0x2ff3fb(0x17b)];else{if(_0x4cd1cf[0x0][_0x2ff3fb(0x130)]=='Portuguese\x20(BR)')var _0x48c621=users[_0x2ff3fb(0x17f)];else{if(_0x4cd1cf[0x0][_0x2ff3fb(0x130)]==_0x2ff3fb(0x185))var _0x48c621=users['Chinese'];else{if(_0x4cd1cf[0x0][_0x2ff3fb(0x130)]==_0x2ff3fb(0x15d))var _0x48c621=users[_0x2ff3fb(0x174)];}}}}}}}_0x13b973[_0x2ff3fb(0x142)](_0x2ff3fb(0x13f),{'success':_0x573bf5[_0x2ff3fb(0x138)](_0x2ff3fb(0x13c)),'errors':_0x573bf5[_0x2ff3fb(0x138)](_0x2ff3fb(0x19b)),'role':_0x10ef33,'profile':_0x53be37,'master_shop':_0x4cd1cf,'user':_0x24fd0a,'language':_0x48c621});}catch(_0x239712){console[_0x2ff3fb(0x13d)](_0x239712);}}),router[a0_0x1cc438(0x198)](a0_0x1cc438(0x181),auth,async(_0x5bfbc4,_0x444b45)=>{const _0x3d9031=a0_0x1cc438;try{const _0x22a734=_0x5bfbc4[_0x3d9031(0x167)]['id'],_0x2dad60=await suppliers[_0x3d9031(0x154)](_0x22a734),{name:_0x3b0df8,email:_0x3e365d,mobile:_0x2354f7,company:_0x2d15e0,address:_0x31f3fe,receivable:_0x3b38c7,payable:_0xe12aa8,code:_0x153ae2,contactperson:_0x52e891,landline:_0x4447ba}=_0x5bfbc4[_0x3d9031(0x14a)];_0x2dad60[_0x3d9031(0x16b)]=_0x3b0df8,_0x2dad60[_0x3d9031(0x170)]=_0x3e365d,_0x2dad60['mobile']=_0x2354f7,_0x2dad60[_0x3d9031(0x165)]=_0x2d15e0,_0x2dad60[_0x3d9031(0x13b)]=_0x31f3fe,_0x2dad60[_0x3d9031(0x182)]=_0x3b38c7,_0x2dad60['payable']=_0xe12aa8,_0x2dad60[_0x3d9031(0x162)]=_0x153ae2,_0x2dad60[_0x3d9031(0x19c)]=_0x52e891,_0x2dad60[_0x3d9031(0x140)]=_0x4447ba;const _0x573e2b=await _0x2dad60[_0x3d9031(0x135)]();_0x5bfbc4[_0x3d9031(0x138)](_0x3d9031(0x13c),_0x3d9031(0x15a)),_0x444b45['redirect'](_0x3d9031(0x156));}catch(_0x534dc7){console['log'](_0x534dc7);}}),router[a0_0x1cc438(0x169)](a0_0x1cc438(0x199),auth,async(_0xc16ee1,_0x52c5ae)=>{const _0x2dd69d=a0_0x1cc438;try{const {username:_0xf2c406,email:_0x16d53d,role:_0x4f0ce7}=_0xc16ee1[_0x2dd69d(0x147)],_0x17ca83=_0xc16ee1['user'],_0x358a8a=await profile[_0x2dd69d(0x155)]({'email':_0x17ca83['email']}),_0x4c02b5=await master_shop[_0x2dd69d(0x19a)]();console['log'](_0x2dd69d(0x192),_0x4c02b5),console[_0x2dd69d(0x13d)](_0xc16ee1[_0x2dd69d(0x167)]['id']);const _0xeef752=await suppliers[_0x2dd69d(0x155)]({'_id':_0xc16ee1['params']['id']});console['log'](_0xeef752);const _0x42ff6a=await s_payment_data['find']({'suppliers':_0xeef752[_0x2dd69d(0x16b)]});console[_0x2dd69d(0x13d)](_0x42ff6a);const _0x5bba55=await s_payment_data['aggregate']([{'$match':{'suppliers':_0xeef752[_0x2dd69d(0x16b)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x2dd69d(0x186),'sum':{'$sum':_0x2dd69d(0x193)}}}]);console[_0x2dd69d(0x13d)](_0x2dd69d(0x178),_0x5bba55);const _0x14994d=await s_payment_data['aggregate']([{'$match':{'suppliers':_0xeef752[_0x2dd69d(0x16b)]}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x2dd69d(0x186),'sum':{'$sum':_0x2dd69d(0x193)}}}]);console['log']('receivable_sum',_0x14994d);if(_0x4c02b5[0x0][_0x2dd69d(0x130)]==_0x2dd69d(0x19f)){var _0x45b0db=users[_0x2dd69d(0x166)];console['log'](_0x45b0db);}else{if(_0x4c02b5[0x0]['language']=='Hindi')var _0x45b0db=users['Hindi'];else{if(_0x4c02b5[0x0][_0x2dd69d(0x130)]==_0x2dd69d(0x146))var _0x45b0db=users[_0x2dd69d(0x146)];else{if(_0x4c02b5[0x0]['language']==_0x2dd69d(0x191))var _0x45b0db=users[_0x2dd69d(0x191)];else{if(_0x4c02b5[0x0][_0x2dd69d(0x130)]=='French')var _0x45b0db=users[_0x2dd69d(0x17b)];else{if(_0x4c02b5[0x0][_0x2dd69d(0x130)]==_0x2dd69d(0x14e))var _0x45b0db=users[_0x2dd69d(0x17f)];else{if(_0x4c02b5[0x0][_0x2dd69d(0x130)]==_0x2dd69d(0x185))var _0x45b0db=users[_0x2dd69d(0x185)];else{if(_0x4c02b5[0x0]['language']==_0x2dd69d(0x15d))var _0x45b0db=users[_0x2dd69d(0x174)];}}}}}}}_0x52c5ae[_0x2dd69d(0x142)](_0x2dd69d(0x187),{'success':_0xc16ee1['flash'](_0x2dd69d(0x13c)),'errors':_0xc16ee1[_0x2dd69d(0x138)](_0x2dd69d(0x19b)),'role':_0x17ca83,'profile':_0x358a8a,'master_shop':_0x4c02b5,'payment':_0x42ff6a,'payable':_0x5bba55,'receivable':_0x14994d,'language':_0x45b0db});}catch(_0x32e944){console[_0x2dd69d(0x13d)](_0x32e944);}}),router['get'](a0_0x1cc438(0x18b),auth,async(_0x3aa6de,_0x11ec44)=>{const _0x23c3a0=a0_0x1cc438;try{const _0x30bbcd=new excelJS[(_0x23c3a0(0x195))](),_0x5a663f=_0x30bbcd['addWorksheet'](_0x23c3a0(0x136));return _0x5a663f['columns']=[{'header':_0x23c3a0(0x143),'key':'PBrands','width':0xa},{'header':'Supplier_Code','key':_0x23c3a0(0x184),'width':0xa},{'header':_0x23c3a0(0x188),'key':_0x23c3a0(0x15f),'width':0xa},{'header':_0x23c3a0(0x14c),'key':_0x23c3a0(0x13b),'width':0xa},{'header':'Company_Name','key':_0x23c3a0(0x153),'width':0xa},{'header':_0x23c3a0(0x13b),'key':'email','width':0xa}],_0x11ec44[_0x23c3a0(0x145)]('Content-Type',_0x23c3a0(0x168)),_0x11ec44[_0x23c3a0(0x145)](_0x23c3a0(0x149),_0x23c3a0(0x139)),_0x30bbcd[_0x23c3a0(0x13e)][_0x23c3a0(0x17e)](_0x11ec44)[_0x23c3a0(0x177)](()=>{_0x11ec44['status'](0xc8);});}catch(_0x4c507a){_0x11ec44[_0x23c3a0(0x17d)](0x190)[_0x23c3a0(0x17c)]({'errors':_0x4c507a['message']});}});function a0_0x13b6(){const _0x47af1b=['attachment;\x20filename=supplier_Migration_File.xlsx','purchase','address','success','log','xlsx','supplier','landline','aggregate','render','Name','20pZfxgy','setHeader','German','user','7422VnMwTQ','Content-Disposition','body','78910RqmUhX','Mobile_number','map','Portuguese\x20(BR)','Company_Name','10WOpPOs','287UVxGNd','doc','mobile','findById','findOne','/supplier/view','error','readFile','164EzAzrp','supplier\x20data\x20update\x20successfully','Supplier_Code','public/Migration/','Arabic\x20(ae)','exports','SalesmanName','Sheets','exceljs','suppliers_code','message','\x20Failed','company','English','params','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','get','\x20added\x20successfully','name','utils','forEach','filename','8OdehwF','email','redirect','13896OGeEEr','single','Arabic','supplier.js\x20payment_data','12102pDCeXO','then','payable_sum','file','2782SIUtBt','French','send','status','write','Portuguese','reason','/view/:id','receivable','public/Migration','PUnits','Chinese','$reason','supplier_payment','Email','/view','suppliers','/products_export_migrate_file','data','purchase_return','715068lJStjS','multer','Hindi','Spanish','master','$amount','../models/all_models','Workbook','Router','/supplier_import_migrate_file','post','/view/payment/:id','find','errors','contactperson','amount','s_payments','English\x20(US)','../public/language/languages.json','SheetNames','express','language','originalname','17130nkGpLg','suppliers_docs','2079187PLAWEk','save','Customers','supplier_product_file','flash'];a0_0x13b6=function(){return _0x47af1b;};return a0_0x13b6();}const storage1=multer['diskStorage']({'destination':(_0x5dd4ed,_0x7352ff,_0x46a8d7)=>{const _0x42e015=a0_0x1cc438;_0x46a8d7(null,_0x42e015(0x183));},'filename':(_0x117bd2,_0xc246f8,_0x1fd96c)=>{const _0x21adb5=a0_0x1cc438;_0x1fd96c(null,Date['now']()+_0xc246f8[_0x21adb5(0x131)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x2684(_0x4e0e6b,_0x505a3d){const _0x13b6db=a0_0x13b6();return a0_0x2684=function(_0x268494,_0x19efa7){_0x268494=_0x268494-0x12e;let _0x5d5bdd=_0x13b6db[_0x268494];return _0x5d5bdd;},a0_0x2684(_0x4e0e6b,_0x505a3d);}router[a0_0x1cc438(0x198)](a0_0x1cc438(0x197),auth,uploadMigrate[a0_0x1cc438(0x173)](a0_0x1cc438(0x137)),async(_0x39027f,_0xfc9114)=>{const _0x411882=a0_0x1cc438,_0x5a6094=_0x39027f[_0x411882(0x179)][_0x411882(0x16e)],_0x4b3337=await xlsx[_0x411882(0x158)](_0x411882(0x15c)+_0x5a6094);let _0x2d7ae6=_0x4b3337[_0x411882(0x12e)],_0xcd47ef=xlsx[_0x411882(0x16c)]['sheet_to_json'](_0x4b3337[_0x411882(0x160)][_0x2d7ae6[0x0]]);for(const _0x2f299f of _0xcd47ef){const _0x2317db=_0x2f299f['Name'],_0x2bb3a4=_0x2f299f[_0x411882(0x15b)],_0x52b868=_0x2f299f['address'],_0x533731=_0x2f299f[_0x411882(0x14c)],_0x4fb41d=_0x2f299f[_0x411882(0x188)],_0x480cbb=_0x2f299f[_0x411882(0x14f)];try{let _0x932ca1=await suppliers[_0x411882(0x155)]({'name':_0x2317db});if(!_0x932ca1){const _0x6bea6e=new suppliers({'name':_0x2317db,'suppliers_code':_0x2bb3a4,'address':_0x52b868,'mobile':_0x533731,'email':_0x4fb41d,'company':_0x480cbb});_0x932ca1=await _0x6bea6e[_0x411882(0x135)](),_0x39027f[_0x411882(0x138)](_0x411882(0x13c),_0x2317db+_0x411882(0x16a));}else _0x39027f[_0x411882(0x138)](_0x411882(0x157),_0x2317db+_0x411882(0x164));}catch(_0x19d480){_0xfc9114[_0x411882(0x17d)](0x1f4)['json']({'proderror':_0x19d480[_0x411882(0x163)],'aproduct':ProductName});}}_0xfc9114[_0x411882(0x171)](_0x411882(0x156));}),module[a0_0x1cc438(0x15e)]=router;