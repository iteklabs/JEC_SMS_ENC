const a0_0x1caa6b=a0_0x4e31;(function(_0x26c92a,_0x175008){const _0x4786cb=a0_0x4e31,_0x5b6de9=_0x26c92a();while(!![]){try{const _0x533177=-parseInt(_0x4786cb(0x194))/0x1*(parseInt(_0x4786cb(0x18e))/0x2)+parseInt(_0x4786cb(0x197))/0x3+parseInt(_0x4786cb(0x192))/0x4+-parseInt(_0x4786cb(0x188))/0x5+parseInt(_0x4786cb(0x19a))/0x6+-parseInt(_0x4786cb(0x19d))/0x7*(-parseInt(_0x4786cb(0x178))/0x8)+parseInt(_0x4786cb(0x18c))/0x9*(-parseInt(_0x4786cb(0x17f))/0xa);if(_0x533177===_0x175008)break;else _0x5b6de9['push'](_0x5b6de9['shift']());}catch(_0x58cf91){_0x5b6de9['push'](_0x5b6de9['shift']());}}}(a0_0x4172,0x56e15));const express=require(a0_0x1caa6b(0x16d)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x1caa6b(0x1a4)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0x1caa6b(0x159)),xlsx=require(a0_0x1caa6b(0x186)),multer=require('multer');function a0_0x4e31(_0x2c3721,_0x30f2c3){const _0x41720c=a0_0x4172();return a0_0x4e31=function(_0x4e31bc,_0x1e1fa2){_0x4e31bc=_0x4e31bc-0x151;let _0x7218bd=_0x41720c[_0x4e31bc];return _0x7218bd;},a0_0x4e31(_0x2c3721,_0x30f2c3);}function a0_0x4172(){const _0x2b0e23=['\x20Failed','Hindi','email','135dJnviD','/view/:id','802CqUbCk','readFile','Sheets','reason','159688jBPIhv','company','104eEfdXR','Chinese','Arabic\x20(ae)','628362igPeua','/view','Spanish','2804196IvbCGw','exports','map','14pbunZc','status','English\x20(US)','user','SalesmanName','success','Workbook','../models/all_models','then','public/Migration/','German','Customers','Company_Name','supplier','body','setHeader','forEach','$reason','aggregate','flash','save','get','Arabic','Purchase\x20Return','single','language','supplier.js\x20payment_data','/supplier/view','English','Portuguese\x20(BR)','purchase','redirect','public/Migration','Supplier_Code','exceljs','utils','/supplier_import_migrate_file','error','Content-Type','sheet_to_json','SheetNames','findOne','PBrands','doc','filename','purchase_return','Purchase','suppliers_code','address','Portuguese','errors','PUnits','file','landline','express','master','log','json','payable','French','mobile','render','suppliers_docs','s_payments','params','1890056qFkapn','supplier_payment','write','message','data','find','amount','455180PJMDzj','diskStorage','Email','name','Content-Disposition','$amount','suppliers','xlsx','Name','544605QJMGSx'];a0_0x4172=function(){return _0x2b0e23;};return a0_0x4172();}router[a0_0x1caa6b(0x1b2)]('/view',auth,async(_0x430aa0,_0x476ebb)=>{const _0x17f250=a0_0x1caa6b;try{const {username:_0x4261ca,email:_0x4ff1db,role:_0x23f929}=_0x430aa0['user'],_0x2e62c5=_0x430aa0[_0x17f250(0x1a0)],_0x1c654e=await profile[_0x17f250(0x160)]({'email':_0x2e62c5['email']}),_0xf60819=await master_shop[_0x17f250(0x17d)]();console[_0x17f250(0x16f)]('master',_0xf60819);const _0x4134f1=await suppliers[_0x17f250(0x17d)]();console[_0x17f250(0x16f)](_0x4134f1);const _0x58fd0a=await suppliers[_0x17f250(0x1af)]([{'$lookup':{'from':_0x17f250(0x176),'localField':'name','foreignField':_0x17f250(0x185),'as':_0x17f250(0x175)}}]),_0x3c2c30=_0x58fd0a[_0x17f250(0x19c)](_0x2661b1=>{const _0x641500=_0x17f250;console[_0x641500(0x16f)](_0x641500(0x17c),_0x2661b1);var _0x3cb0bc=0x0,_0x19f4ef=0x0;return _0x2661b1['suppliers_docs'][_0x641500(0x1ad)](_0x2ece79=>{const _0x5cbc6d=_0x641500;console[_0x5cbc6d(0x16f)](_0x5cbc6d(0x162),_0x2ece79),_0x2ece79[_0x5cbc6d(0x191)]==_0x5cbc6d(0x165)?_0x3cb0bc+=_0x2ece79['amount']:_0x19f4ef+=_0x2ece79[_0x5cbc6d(0x17e)];}),_0x2661b1[_0x641500(0x155)]=_0x3cb0bc,_0x2661b1[_0x641500(0x164)]=_0x19f4ef,_0x2661b1;});console[_0x17f250(0x16f)](_0x17f250(0x151),_0x3c2c30);if(_0xf60819[0x0][_0x17f250(0x1b6)]=='English\x20(US)'){var _0x329c80=users[_0x17f250(0x153)];console[_0x17f250(0x16f)](_0x329c80);}else{if(_0xf60819[0x0]['language']=='Hindi')var _0x329c80=users['Hindi'];else{if(_0xf60819[0x0][_0x17f250(0x1b6)]==_0x17f250(0x1a7))var _0x329c80=users[_0x17f250(0x1a7)];else{if(_0xf60819[0x0][_0x17f250(0x1b6)]==_0x17f250(0x199))var _0x329c80=users[_0x17f250(0x199)];else{if(_0xf60819[0x0][_0x17f250(0x1b6)]==_0x17f250(0x172))var _0x329c80=users[_0x17f250(0x172)];else{if(_0xf60819[0x0][_0x17f250(0x1b6)]==_0x17f250(0x154))var _0x329c80=users['Portuguese'];else{if(_0xf60819[0x0][_0x17f250(0x1b6)]=='Chinese')var _0x329c80=users[_0x17f250(0x195)];else{if(_0xf60819[0x0][_0x17f250(0x1b6)]==_0x17f250(0x196))var _0x329c80=users[_0x17f250(0x1b3)];}}}}}}}_0x476ebb[_0x17f250(0x174)](_0x17f250(0x1aa),{'success':_0x430aa0[_0x17f250(0x1b0)]('success'),'errors':_0x430aa0['flash'](_0x17f250(0x169)),'user':_0x4134f1,'profile':_0x1c654e,'master_shop':_0xf60819,'role':_0x2e62c5,'payment':_0x3c2c30,'language':_0x329c80});}catch(_0x6efbee){console[_0x17f250(0x16f)](_0x6efbee);}}),router['post'](a0_0x1caa6b(0x198),auth,async(_0x4e5827,_0x17b7b8)=>{const _0x1c37d4=a0_0x1caa6b;try{const {name:_0x3d290b,email:_0x1c2fca,mobile:_0xcd2760,company:_0x19c84c,address:_0x17c5e2,receivable:_0xe215e9,payable:_0x41fdf0,code:_0x5a1a22,contactperson:_0x1f7dbd,landline:_0x2b03a3}=_0x4e5827[_0x1c37d4(0x1ab)],_0x6effb5=new suppliers({'name':_0x3d290b,'email':_0x1c2fca,'mobile':_0xcd2760,'company':_0x19c84c,'address':_0x17c5e2,'receivable':_0xe215e9,'payable':_0x41fdf0,'suppliers_code':_0x5a1a22,'contactperson':_0x1f7dbd,'landline':_0x2b03a3}),_0x2ec39e=await _0x6effb5[_0x1c37d4(0x1b1)]();_0x4e5827[_0x1c37d4(0x1b0)](_0x1c37d4(0x1a2),'supplier\x20data\x20add\x20successfully'),_0x17b7b8[_0x1c37d4(0x156)](_0x1c37d4(0x152));}catch(_0x252dda){console['log'](_0x252dda);}}),router['get'](a0_0x1caa6b(0x18d),auth,async(_0x4b712e,_0x2aa2d2)=>{const _0x13818b=a0_0x1caa6b;try{const {username:_0xfd92e0,email:_0x288a72,role:_0x4d8dab}=_0x4b712e[_0x13818b(0x1a0)],_0x2b3db3=_0x4b712e[_0x13818b(0x1a0)],_0x564c5b=await profile[_0x13818b(0x160)]({'email':_0x2b3db3[_0x13818b(0x18b)]}),_0x143830=await master_shop['find']();console[_0x13818b(0x16f)](_0x13818b(0x16e),_0x143830);const _0x159eae=_0x4b712e[_0x13818b(0x177)]['id'],_0x1ac288=await suppliers['findById'](_0x159eae);console[_0x13818b(0x16f)](_0x1ac288);if(_0x143830[0x0][_0x13818b(0x1b6)]==_0x13818b(0x19f)){var _0x1af8f5=users[_0x13818b(0x153)];console[_0x13818b(0x16f)](_0x1af8f5);}else{if(_0x143830[0x0][_0x13818b(0x1b6)]==_0x13818b(0x18a))var _0x1af8f5=users[_0x13818b(0x18a)];else{if(_0x143830[0x0]['language']=='German')var _0x1af8f5=users[_0x13818b(0x1a7)];else{if(_0x143830[0x0][_0x13818b(0x1b6)]==_0x13818b(0x199))var _0x1af8f5=users[_0x13818b(0x199)];else{if(_0x143830[0x0][_0x13818b(0x1b6)]==_0x13818b(0x172))var _0x1af8f5=users['French'];else{if(_0x143830[0x0][_0x13818b(0x1b6)]==_0x13818b(0x154))var _0x1af8f5=users[_0x13818b(0x168)];else{if(_0x143830[0x0][_0x13818b(0x1b6)]==_0x13818b(0x195))var _0x1af8f5=users[_0x13818b(0x195)];else{if(_0x143830[0x0][_0x13818b(0x1b6)]==_0x13818b(0x196))var _0x1af8f5=users[_0x13818b(0x1b3)];}}}}}}}_0x2aa2d2['render'](_0x13818b(0x1aa),{'success':_0x4b712e['flash'](_0x13818b(0x1a2)),'errors':_0x4b712e['flash'](_0x13818b(0x169)),'role':_0x2b3db3,'profile':_0x564c5b,'master_shop':_0x143830,'user':_0x1ac288,'language':_0x1af8f5});}catch(_0xdde8e6){console['log'](_0xdde8e6);}}),router['post'](a0_0x1caa6b(0x18d),auth,async(_0xd43774,_0x2b6343)=>{const _0x2f14da=a0_0x1caa6b;try{const _0x59b430=_0xd43774[_0x2f14da(0x177)]['id'],_0x29e086=await suppliers['findById'](_0x59b430),{name:_0x5c5fc3,email:_0x4cba45,mobile:_0x212c9e,company:_0x305ba9,address:_0x5db8af,receivable:_0x200415,payable:_0x271948,code:_0x5cafdb,contactperson:_0x1aadbd,landline:_0xc1b951}=_0xd43774[_0x2f14da(0x1ab)];_0x29e086[_0x2f14da(0x182)]=_0x5c5fc3,_0x29e086[_0x2f14da(0x18b)]=_0x4cba45,_0x29e086[_0x2f14da(0x173)]=_0x212c9e,_0x29e086[_0x2f14da(0x193)]=_0x305ba9,_0x29e086['address']=_0x5db8af,_0x29e086['receivable']=_0x200415,_0x29e086[_0x2f14da(0x171)]=_0x271948,_0x29e086[_0x2f14da(0x166)]=_0x5cafdb,_0x29e086['contactperson']=_0x1aadbd,_0x29e086[_0x2f14da(0x16c)]=_0xc1b951;const _0x3fb73f=await _0x29e086[_0x2f14da(0x1b1)]();_0xd43774[_0x2f14da(0x1b0)](_0x2f14da(0x1a2),'supplier\x20data\x20update\x20successfully'),_0x2b6343[_0x2f14da(0x156)](_0x2f14da(0x152));}catch(_0x71677f){console[_0x2f14da(0x16f)](_0x71677f);}}),router[a0_0x1caa6b(0x1b2)]('/view/payment/:id',auth,async(_0x13157d,_0x24a5fc)=>{const _0x5c453d=a0_0x1caa6b;try{const {username:_0x14af66,email:_0x5ecf05,role:_0x50ab89}=_0x13157d[_0x5c453d(0x1a0)],_0x468460=_0x13157d[_0x5c453d(0x1a0)],_0x26360e=await profile[_0x5c453d(0x160)]({'email':_0x468460[_0x5c453d(0x18b)]}),_0x19a634=await master_shop[_0x5c453d(0x17d)]();console[_0x5c453d(0x16f)]('master',_0x19a634),console[_0x5c453d(0x16f)](_0x13157d[_0x5c453d(0x177)]['id']);const _0x2f85a3=await suppliers[_0x5c453d(0x160)]({'_id':_0x13157d[_0x5c453d(0x177)]['id']});console[_0x5c453d(0x16f)](_0x2f85a3);const _0x503ee7=await s_payment_data[_0x5c453d(0x17d)]({'suppliers':_0x2f85a3['name']});console[_0x5c453d(0x16f)](_0x503ee7);const _0x35c3b2=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x2f85a3[_0x5c453d(0x182)]}},{'$match':{'reason':_0x5c453d(0x165)}},{'$group':{'_id':_0x5c453d(0x1ae),'sum':{'$sum':_0x5c453d(0x184)}}}]);console[_0x5c453d(0x16f)]('payable_sum',_0x35c3b2);const _0x16cc0f=await s_payment_data[_0x5c453d(0x1af)]([{'$match':{'suppliers':_0x2f85a3[_0x5c453d(0x182)]}},{'$match':{'reason':_0x5c453d(0x1b4)}},{'$group':{'_id':_0x5c453d(0x1ae),'sum':{'$sum':'$amount'}}}]);console[_0x5c453d(0x16f)]('receivable_sum',_0x16cc0f);if(_0x19a634[0x0][_0x5c453d(0x1b6)]==_0x5c453d(0x19f)){var _0xdfc2aa=users[_0x5c453d(0x153)];console[_0x5c453d(0x16f)](_0xdfc2aa);}else{if(_0x19a634[0x0]['language']==_0x5c453d(0x18a))var _0xdfc2aa=users[_0x5c453d(0x18a)];else{if(_0x19a634[0x0]['language']=='German')var _0xdfc2aa=users[_0x5c453d(0x1a7)];else{if(_0x19a634[0x0][_0x5c453d(0x1b6)]==_0x5c453d(0x199))var _0xdfc2aa=users[_0x5c453d(0x199)];else{if(_0x19a634[0x0][_0x5c453d(0x1b6)]==_0x5c453d(0x172))var _0xdfc2aa=users[_0x5c453d(0x172)];else{if(_0x19a634[0x0]['language']=='Portuguese\x20(BR)')var _0xdfc2aa=users[_0x5c453d(0x168)];else{if(_0x19a634[0x0]['language']==_0x5c453d(0x195))var _0xdfc2aa=users[_0x5c453d(0x195)];else{if(_0x19a634[0x0][_0x5c453d(0x1b6)]==_0x5c453d(0x196))var _0xdfc2aa=users['Arabic'];}}}}}}}_0x24a5fc[_0x5c453d(0x174)](_0x5c453d(0x179),{'success':_0x13157d[_0x5c453d(0x1b0)](_0x5c453d(0x1a2)),'errors':_0x13157d[_0x5c453d(0x1b0)](_0x5c453d(0x169)),'role':_0x468460,'profile':_0x26360e,'master_shop':_0x19a634,'payment':_0x503ee7,'payable':_0x35c3b2,'receivable':_0x16cc0f,'language':_0xdfc2aa});}catch(_0x9b91b1){console[_0x5c453d(0x16f)](_0x9b91b1);}}),router[a0_0x1caa6b(0x1b2)]('/products_export_migrate_file',auth,async(_0x1a5a85,_0x5568a1)=>{const _0x2bbb86=a0_0x1caa6b;try{const _0x39c90a=new excelJS[(_0x2bbb86(0x1a3))](),_0x286343=_0x39c90a['addWorksheet'](_0x2bbb86(0x1a8));return _0x286343['columns']=[{'header':_0x2bbb86(0x187),'key':_0x2bbb86(0x161),'width':0xa},{'header':_0x2bbb86(0x158),'key':_0x2bbb86(0x16a),'width':0xa},{'header':_0x2bbb86(0x181),'key':_0x2bbb86(0x1a1),'width':0xa},{'header':'Mobile_number','key':_0x2bbb86(0x167),'width':0xa},{'header':_0x2bbb86(0x1a9),'key':_0x2bbb86(0x173),'width':0xa},{'header':_0x2bbb86(0x167),'key':_0x2bbb86(0x18b),'width':0xa}],_0x5568a1[_0x2bbb86(0x1ac)](_0x2bbb86(0x15d),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x5568a1[_0x2bbb86(0x1ac)](_0x2bbb86(0x183),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x39c90a[_0x2bbb86(0x186)][_0x2bbb86(0x17a)](_0x5568a1)[_0x2bbb86(0x1a5)](()=>{const _0x46d44e=_0x2bbb86;_0x5568a1[_0x46d44e(0x19e)](0xc8);});}catch(_0x23372e){_0x5568a1['status'](0x190)['send']({'errors':_0x23372e[_0x2bbb86(0x17b)]});}});const storage1=multer[a0_0x1caa6b(0x180)]({'destination':(_0x5a9a0a,_0x419eb9,_0x537370)=>{const _0x19aabf=a0_0x1caa6b;_0x537370(null,_0x19aabf(0x157));},'filename':(_0x1d918e,_0x31bb28,_0x204223)=>{_0x204223(null,Date['now']()+_0x31bb28['originalname']);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x1caa6b(0x15b),auth,uploadMigrate[a0_0x1caa6b(0x1b5)]('supplier_product_file'),async(_0x242977,_0x13fb5e)=>{const _0x1fe049=a0_0x1caa6b,_0x3ed6e6=_0x242977[_0x1fe049(0x16b)][_0x1fe049(0x163)],_0x87737=await xlsx[_0x1fe049(0x18f)](_0x1fe049(0x1a6)+_0x3ed6e6);let _0x3ae72d=_0x87737[_0x1fe049(0x15f)],_0x53652e=xlsx[_0x1fe049(0x15a)][_0x1fe049(0x15e)](_0x87737[_0x1fe049(0x190)][_0x3ae72d[0x0]]);for(const _0x5e0f33 of _0x53652e){const _0x389ed6=_0x5e0f33[_0x1fe049(0x187)],_0x5eca8a=_0x5e0f33[_0x1fe049(0x158)],_0x4b887e=_0x5e0f33[_0x1fe049(0x167)],_0x4ed3a8=_0x5e0f33['Mobile_number'],_0x3e6a39=_0x5e0f33['Email'],_0x14bbca=_0x5e0f33[_0x1fe049(0x1a9)];try{let _0x4cfed2=await suppliers['findOne']({'name':_0x389ed6});if(!_0x4cfed2){const _0x2fa097=new suppliers({'name':_0x389ed6,'suppliers_code':_0x5eca8a,'address':_0x4b887e,'mobile':_0x4ed3a8,'email':_0x3e6a39,'company':_0x14bbca});_0x4cfed2=await _0x2fa097[_0x1fe049(0x1b1)](),_0x242977[_0x1fe049(0x1b0)](_0x1fe049(0x1a2),_0x389ed6+'\x20added\x20successfully');}else _0x242977[_0x1fe049(0x1b0)](_0x1fe049(0x15c),_0x389ed6+_0x1fe049(0x189));}catch(_0x13088f){_0x13fb5e[_0x1fe049(0x19e)](0x1f4)[_0x1fe049(0x170)]({'proderror':_0x13088f[_0x1fe049(0x17b)],'aproduct':ProductName});}}_0x13fb5e[_0x1fe049(0x156)](_0x1fe049(0x152));}),module[a0_0x1caa6b(0x19b)]=router;