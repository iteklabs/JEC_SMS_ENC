const a0_0x4dbd1f=a0_0xad0f;function a0_0xad0f(_0x51ddb0,_0x3253d3){const _0x479fff=a0_0x479f();return a0_0xad0f=function(_0xad0fed,_0xdccc0d){_0xad0fed=_0xad0fed-0xfc;let _0x2d15ee=_0x479fff[_0xad0fed];return _0x2d15ee;},a0_0xad0f(_0x51ddb0,_0x3253d3);}function a0_0x479f(){const _0x49b884=['application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','supplier_product_file','single','PUnits','message','1256843NBlabO','public/Migration','findOne','/view/:id','Mobile_number','status','German','contactperson','45kZMSuU','Customers','Chinese','24rUqhta','addWorksheet','purchase','user','/view','get','Workbook','Supplier_Code','doc','redirect','Arabic\x20(ae)','write','Name','English\x20(US)','sheet_to_json','setHeader','1065105GSNaFe','save','Spanish','email','receivable','data','params','supplier\x20data\x20add\x20successfully','\x20added\x20successfully','find','Hindi','log','receivable_sum','attachment;\x20filename=supplier_Migration_File.xlsx','address','xlsx','supplier.js\x20payment_data','1240qVeHsT','columns','render','amount','flash','/supplier_import_migrate_file','30373900IcqRUO','$amount','/supplier/view','Arabic','landline','multer','payable','../models/all_models','Purchase','suppliers_code','Company_Name','/products_export_migrate_file','supplier','Portuguese\x20(BR)','Content-Type','errors','Purchase\x20Return','reason','then','English','SheetNames','purchase_return','15485mzHXPm','Portuguese','2052872YchybB','French','findById','utils','post','suppliers_docs','5308452gwgrUU','127742vbdqte','error','success','master','body','file','$reason','name','language','Content-Disposition'];a0_0x479f=function(){return _0x49b884;};return a0_0x479f();}(function(_0x503e60,_0x12d856){const _0x5da999=a0_0xad0f,_0x22f5c1=_0x503e60();while(!![]){try{const _0xa6d832=parseInt(_0x5da999(0x110))/0x1+parseInt(_0x5da999(0x146))/0x2*(-parseInt(_0x5da999(0x100))/0x3)+parseInt(_0x5da999(0x121))/0x4*(-parseInt(_0x5da999(0x13d))/0x5)+-parseInt(_0x5da999(0x145))/0x6+parseInt(_0x5da999(0x155))/0x7+-parseInt(_0x5da999(0x13f))/0x8*(parseInt(_0x5da999(0xfd))/0x9)+parseInt(_0x5da999(0x127))/0xa;if(_0xa6d832===_0x12d856)break;else _0x22f5c1['push'](_0x22f5c1['shift']());}catch(_0x293363){_0x22f5c1['push'](_0x22f5c1['shift']());}}}(a0_0x479f,0x9d093));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x4dbd1f(0x12e)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require('exceljs'),xlsx=require('xlsx'),multer=require(a0_0x4dbd1f(0x12c));router[a0_0x4dbd1f(0x105)](a0_0x4dbd1f(0x104),auth,async(_0x203370,_0x2c2717)=>{const _0x401aee=a0_0x4dbd1f;try{const {username:_0x1743cf,email:_0x5a1461,role:_0x4d84f8}=_0x203370['user'],_0x236099=_0x203370['user'],_0x10401d=await profile[_0x401aee(0x157)]({'email':_0x236099['email']}),_0xfcec51=await master_shop[_0x401aee(0x119)]();console[_0x401aee(0x11b)]('master',_0xfcec51);const _0x17c9aa=await suppliers[_0x401aee(0x119)]();console[_0x401aee(0x11b)](_0x17c9aa);const _0x1742b7=await suppliers['aggregate']([{'$lookup':{'from':'s_payments','localField':'name','foreignField':'suppliers','as':_0x401aee(0x144)}}]),_0x1f1f2d=_0x1742b7['map'](_0x46586f=>{const _0x2514ac=_0x401aee;console[_0x2514ac(0x11b)](_0x2514ac(0x115),_0x46586f);var _0x2698ca=0x0,_0x27c144=0x0;return _0x46586f[_0x2514ac(0x144)]['forEach'](_0x3c87c4=>{const _0xb28c68=_0x2514ac;console['log'](_0xb28c68(0x108),_0x3c87c4),_0x3c87c4[_0xb28c68(0x138)]==_0xb28c68(0x12f)?_0x2698ca+=_0x3c87c4['amount']:_0x27c144+=_0x3c87c4[_0xb28c68(0x124)];}),_0x46586f[_0x2514ac(0x102)]=_0x2698ca,_0x46586f[_0x2514ac(0x13c)]=_0x27c144,_0x46586f;});console[_0x401aee(0x11b)](_0x401aee(0x120),_0x1f1f2d);if(_0xfcec51[0x0][_0x401aee(0x14e)]=='English\x20(US)'){var _0xdbd3c2=users[_0x401aee(0x13a)];console[_0x401aee(0x11b)](_0xdbd3c2);}else{if(_0xfcec51[0x0][_0x401aee(0x14e)]=='Hindi')var _0xdbd3c2=users[_0x401aee(0x11a)];else{if(_0xfcec51[0x0][_0x401aee(0x14e)]==_0x401aee(0x15b))var _0xdbd3c2=users[_0x401aee(0x15b)];else{if(_0xfcec51[0x0][_0x401aee(0x14e)]==_0x401aee(0x112))var _0xdbd3c2=users[_0x401aee(0x112)];else{if(_0xfcec51[0x0]['language']=='French')var _0xdbd3c2=users['French'];else{if(_0xfcec51[0x0][_0x401aee(0x14e)]==_0x401aee(0x134))var _0xdbd3c2=users[_0x401aee(0x13e)];else{if(_0xfcec51[0x0][_0x401aee(0x14e)]==_0x401aee(0xff))var _0xdbd3c2=users['Chinese'];else{if(_0xfcec51[0x0][_0x401aee(0x14e)]=='Arabic\x20(ae)')var _0xdbd3c2=users[_0x401aee(0x12a)];}}}}}}}_0x2c2717['render'](_0x401aee(0x133),{'success':_0x203370[_0x401aee(0x125)](_0x401aee(0x148)),'errors':_0x203370[_0x401aee(0x125)](_0x401aee(0x136)),'user':_0x17c9aa,'profile':_0x10401d,'master_shop':_0xfcec51,'role':_0x236099,'payment':_0x1f1f2d,'language':_0xdbd3c2});}catch(_0xb8d503){console[_0x401aee(0x11b)](_0xb8d503);}}),router[a0_0x4dbd1f(0x143)](a0_0x4dbd1f(0x104),auth,async(_0x2ebc44,_0x171c10)=>{const _0x173a01=a0_0x4dbd1f;try{const {name:_0x58a180,email:_0x4f124a,mobile:_0xd7fb5f,company:_0x186cba,address:_0x18f9d4,receivable:_0x2bda0b,payable:_0x47daf7,code:_0x569500,contactperson:_0x278005,landline:_0x31213f}=_0x2ebc44[_0x173a01(0x14a)],_0x3fecb7=new suppliers({'name':_0x58a180,'email':_0x4f124a,'mobile':_0xd7fb5f,'company':_0x186cba,'address':_0x18f9d4,'receivable':_0x2bda0b,'payable':_0x47daf7,'suppliers_code':_0x569500,'contactperson':_0x278005,'landline':_0x31213f}),_0x3bda34=await _0x3fecb7[_0x173a01(0x111)]();_0x2ebc44['flash'](_0x173a01(0x148),_0x173a01(0x117)),_0x171c10[_0x173a01(0x109)](_0x173a01(0x129));}catch(_0x117e09){console['log'](_0x117e09);}}),router[a0_0x4dbd1f(0x105)](a0_0x4dbd1f(0x158),auth,async(_0x354a91,_0x5c62d8)=>{const _0x54bf29=a0_0x4dbd1f;try{const {username:_0x2a1b0c,email:_0x26b039,role:_0x413f2e}=_0x354a91['user'],_0x58adfd=_0x354a91[_0x54bf29(0x103)],_0x5a3455=await profile[_0x54bf29(0x157)]({'email':_0x58adfd['email']}),_0x39974a=await master_shop[_0x54bf29(0x119)]();console['log']('master',_0x39974a);const _0x324902=_0x354a91[_0x54bf29(0x116)]['id'],_0x3cd6f2=await suppliers[_0x54bf29(0x141)](_0x324902);console[_0x54bf29(0x11b)](_0x3cd6f2);if(_0x39974a[0x0][_0x54bf29(0x14e)]=='English\x20(US)'){var _0x1b487a=users[_0x54bf29(0x13a)];console['log'](_0x1b487a);}else{if(_0x39974a[0x0][_0x54bf29(0x14e)]==_0x54bf29(0x11a))var _0x1b487a=users[_0x54bf29(0x11a)];else{if(_0x39974a[0x0][_0x54bf29(0x14e)]==_0x54bf29(0x15b))var _0x1b487a=users['German'];else{if(_0x39974a[0x0][_0x54bf29(0x14e)]=='Spanish')var _0x1b487a=users[_0x54bf29(0x112)];else{if(_0x39974a[0x0][_0x54bf29(0x14e)]=='French')var _0x1b487a=users[_0x54bf29(0x140)];else{if(_0x39974a[0x0][_0x54bf29(0x14e)]==_0x54bf29(0x134))var _0x1b487a=users[_0x54bf29(0x13e)];else{if(_0x39974a[0x0][_0x54bf29(0x14e)]==_0x54bf29(0xff))var _0x1b487a=users[_0x54bf29(0xff)];else{if(_0x39974a[0x0][_0x54bf29(0x14e)]=='Arabic\x20(ae)')var _0x1b487a=users[_0x54bf29(0x12a)];}}}}}}}_0x5c62d8[_0x54bf29(0x123)](_0x54bf29(0x133),{'success':_0x354a91[_0x54bf29(0x125)](_0x54bf29(0x148)),'errors':_0x354a91[_0x54bf29(0x125)](_0x54bf29(0x136)),'role':_0x58adfd,'profile':_0x5a3455,'master_shop':_0x39974a,'user':_0x3cd6f2,'language':_0x1b487a});}catch(_0x1cdedd){console[_0x54bf29(0x11b)](_0x1cdedd);}}),router[a0_0x4dbd1f(0x143)](a0_0x4dbd1f(0x158),auth,async(_0x2bea19,_0x5d6644)=>{const _0x56248e=a0_0x4dbd1f;try{const _0x302ef3=_0x2bea19[_0x56248e(0x116)]['id'],_0x5088eb=await suppliers[_0x56248e(0x141)](_0x302ef3),{name:_0x47017a,email:_0x544071,mobile:_0x2977bf,company:_0x50ebdc,address:_0x2cfc33,receivable:_0x27f7da,payable:_0xe9541,code:_0x42cfea,contactperson:_0x3cef7c,landline:_0x483e2b}=_0x2bea19['body'];_0x5088eb[_0x56248e(0x14d)]=_0x47017a,_0x5088eb[_0x56248e(0x113)]=_0x544071,_0x5088eb['mobile']=_0x2977bf,_0x5088eb['company']=_0x50ebdc,_0x5088eb['address']=_0x2cfc33,_0x5088eb[_0x56248e(0x114)]=_0x27f7da,_0x5088eb[_0x56248e(0x12d)]=_0xe9541,_0x5088eb[_0x56248e(0x130)]=_0x42cfea,_0x5088eb[_0x56248e(0xfc)]=_0x3cef7c,_0x5088eb[_0x56248e(0x12b)]=_0x483e2b;const _0x1f50dc=await _0x5088eb[_0x56248e(0x111)]();_0x2bea19[_0x56248e(0x125)](_0x56248e(0x148),'supplier\x20data\x20update\x20successfully'),_0x5d6644[_0x56248e(0x109)]('/supplier/view');}catch(_0xa9f1f9){console[_0x56248e(0x11b)](_0xa9f1f9);}}),router[a0_0x4dbd1f(0x105)]('/view/payment/:id',auth,async(_0x117dfe,_0x22ed33)=>{const _0x42957c=a0_0x4dbd1f;try{const {username:_0x1af13c,email:_0x4543d4,role:_0x4fd477}=_0x117dfe['user'],_0x26d036=_0x117dfe[_0x42957c(0x103)],_0x4b2dcc=await profile[_0x42957c(0x157)]({'email':_0x26d036[_0x42957c(0x113)]}),_0x376c18=await master_shop[_0x42957c(0x119)]();console[_0x42957c(0x11b)](_0x42957c(0x149),_0x376c18),console[_0x42957c(0x11b)](_0x117dfe[_0x42957c(0x116)]['id']);const _0x4da1e1=await suppliers[_0x42957c(0x157)]({'_id':_0x117dfe[_0x42957c(0x116)]['id']});console['log'](_0x4da1e1);const _0x57b29b=await s_payment_data[_0x42957c(0x119)]({'suppliers':_0x4da1e1[_0x42957c(0x14d)]});console[_0x42957c(0x11b)](_0x57b29b);const _0x5dbd27=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x4da1e1[_0x42957c(0x14d)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x42957c(0x14c),'sum':{'$sum':_0x42957c(0x128)}}}]);console[_0x42957c(0x11b)]('payable_sum',_0x5dbd27);const _0x5da33d=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x4da1e1[_0x42957c(0x14d)]}},{'$match':{'reason':_0x42957c(0x137)}},{'$group':{'_id':_0x42957c(0x14c),'sum':{'$sum':_0x42957c(0x128)}}}]);console['log'](_0x42957c(0x11c),_0x5da33d);if(_0x376c18[0x0][_0x42957c(0x14e)]==_0x42957c(0x10d)){var _0x7ca962=users[_0x42957c(0x13a)];console['log'](_0x7ca962);}else{if(_0x376c18[0x0][_0x42957c(0x14e)]==_0x42957c(0x11a))var _0x7ca962=users[_0x42957c(0x11a)];else{if(_0x376c18[0x0][_0x42957c(0x14e)]==_0x42957c(0x15b))var _0x7ca962=users[_0x42957c(0x15b)];else{if(_0x376c18[0x0]['language']==_0x42957c(0x112))var _0x7ca962=users[_0x42957c(0x112)];else{if(_0x376c18[0x0]['language']=='French')var _0x7ca962=users[_0x42957c(0x140)];else{if(_0x376c18[0x0]['language']=='Portuguese\x20(BR)')var _0x7ca962=users[_0x42957c(0x13e)];else{if(_0x376c18[0x0]['language']==_0x42957c(0xff))var _0x7ca962=users['Chinese'];else{if(_0x376c18[0x0]['language']==_0x42957c(0x10a))var _0x7ca962=users[_0x42957c(0x12a)];}}}}}}}_0x22ed33['render']('supplier_payment',{'success':_0x117dfe[_0x42957c(0x125)](_0x42957c(0x148)),'errors':_0x117dfe[_0x42957c(0x125)](_0x42957c(0x136)),'role':_0x26d036,'profile':_0x4b2dcc,'master_shop':_0x376c18,'payment':_0x57b29b,'payable':_0x5dbd27,'receivable':_0x5da33d,'language':_0x7ca962});}catch(_0xcbd02b){console[_0x42957c(0x11b)](_0xcbd02b);}}),router[a0_0x4dbd1f(0x105)](a0_0x4dbd1f(0x132),auth,async(_0x498a30,_0x2409cb)=>{const _0x425190=a0_0x4dbd1f;try{const _0x502893=new excelJS[(_0x425190(0x106))](),_0x3e1ae5=_0x502893[_0x425190(0x101)](_0x425190(0xfe));return _0x3e1ae5[_0x425190(0x122)]=[{'header':_0x425190(0x10c),'key':'PBrands','width':0xa},{'header':_0x425190(0x107),'key':_0x425190(0x153),'width':0xa},{'header':'Email','key':'SalesmanName','width':0xa},{'header':_0x425190(0x159),'key':_0x425190(0x11e),'width':0xa},{'header':_0x425190(0x131),'key':'mobile','width':0xa},{'header':_0x425190(0x11e),'key':_0x425190(0x113),'width':0xa}],_0x2409cb['setHeader'](_0x425190(0x135),_0x425190(0x150)),_0x2409cb[_0x425190(0x10f)](_0x425190(0x14f),_0x425190(0x11d)),_0x502893[_0x425190(0x11f)][_0x425190(0x10b)](_0x2409cb)[_0x425190(0x139)](()=>{const _0xb3ef1f=_0x425190;_0x2409cb[_0xb3ef1f(0x15a)](0xc8);});}catch(_0x271c6b){_0x2409cb['status'](0x190)['send']({'errors':_0x271c6b['message']});}});const storage1=multer['diskStorage']({'destination':(_0x34652c,_0x312562,_0x4f9261)=>{const _0x2e19d0=a0_0x4dbd1f;_0x4f9261(null,_0x2e19d0(0x156));},'filename':(_0x4cd54b,_0x12145d,_0x2f2424)=>{_0x2f2424(null,Date['now']()+_0x12145d['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x4dbd1f(0x143)](a0_0x4dbd1f(0x126),auth,uploadMigrate[a0_0x4dbd1f(0x152)](a0_0x4dbd1f(0x151)),async(_0x14d932,_0x3d8f9f)=>{const _0x479062=a0_0x4dbd1f,_0x7d13a9=_0x14d932[_0x479062(0x14b)]['filename'],_0x1d6f56=await xlsx['readFile']('public/Migration/'+_0x7d13a9);let _0x3220b3=_0x1d6f56[_0x479062(0x13b)],_0x22722b=xlsx[_0x479062(0x142)][_0x479062(0x10e)](_0x1d6f56['Sheets'][_0x3220b3[0x0]]);for(const _0x423fee of _0x22722b){const _0x3efd2b=_0x423fee[_0x479062(0x10c)],_0x490c98=_0x423fee[_0x479062(0x107)],_0xc9e705=_0x423fee[_0x479062(0x11e)],_0x118bb4=_0x423fee[_0x479062(0x159)],_0x4e3385=_0x423fee['Email'],_0x203cb2=_0x423fee['Company_Name'];try{let _0x38ebfa=await suppliers[_0x479062(0x157)]({'name':_0x3efd2b});if(!_0x38ebfa){const _0x15f715=new suppliers({'name':_0x3efd2b,'suppliers_code':_0x490c98,'address':_0xc9e705,'mobile':_0x118bb4,'email':_0x4e3385,'company':_0x203cb2});_0x38ebfa=await _0x15f715[_0x479062(0x111)](),_0x14d932[_0x479062(0x125)](_0x479062(0x148),_0x3efd2b+_0x479062(0x118));}else _0x14d932['flash'](_0x479062(0x147),_0x3efd2b+'\x20Failed');}catch(_0x4c6bfe){_0x3d8f9f[_0x479062(0x15a)](0x1f4)['json']({'proderror':_0x4c6bfe[_0x479062(0x154)],'aproduct':ProductName});}}_0x3d8f9f[_0x479062(0x109)](_0x479062(0x129));}),module['exports']=router;