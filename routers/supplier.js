const a0_0x7f9d2c=a0_0x2b91;function a0_0x2b91(_0x77fe12,_0x3dcd9c){const _0x369bc5=a0_0x369b();return a0_0x2b91=function(_0x2b910c,_0x2b99be){_0x2b910c=_0x2b910c-0x127;let _0x49c744=_0x369bc5[_0x2b910c];return _0x49c744;},a0_0x2b91(_0x77fe12,_0x3dcd9c);}(function(_0x4ea8d9,_0x117af8){const _0x4b3839=a0_0x2b91,_0x3deb64=_0x4ea8d9();while(!![]){try{const _0x2a97f9=parseInt(_0x4b3839(0x15e))/0x1+parseInt(_0x4b3839(0x14c))/0x2+-parseInt(_0x4b3839(0x177))/0x3+-parseInt(_0x4b3839(0x170))/0x4*(parseInt(_0x4b3839(0x14b))/0x5)+-parseInt(_0x4b3839(0x130))/0x6+-parseInt(_0x4b3839(0x13b))/0x7*(parseInt(_0x4b3839(0x143))/0x8)+-parseInt(_0x4b3839(0x160))/0x9*(-parseInt(_0x4b3839(0x132))/0xa);if(_0x2a97f9===_0x117af8)break;else _0x3deb64['push'](_0x3deb64['shift']());}catch(_0x450f4e){_0x3deb64['push'](_0x3deb64['shift']());}}}(a0_0x369b,0xc35ad));const express=require('express'),app=express(),router=express[a0_0x7f9d2c(0x138)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x7f9d2c(0x12b)),auth=require(a0_0x7f9d2c(0x16c)),users=require(a0_0x7f9d2c(0x128)),excelJS=require(a0_0x7f9d2c(0x15f)),xlsx=require(a0_0x7f9d2c(0x151)),multer=require('multer');router['get']('/view',auth,async(_0x1a0ba9,_0x4fb46e)=>{const _0xfc736e=a0_0x7f9d2c;try{const {username:_0x504a6c,email:_0x447a2e,role:_0x4d2c89}=_0x1a0ba9[_0xfc736e(0x13f)],_0x209485=_0x1a0ba9[_0xfc736e(0x13f)],_0x340543=await profile[_0xfc736e(0x13a)]({'email':_0x209485[_0xfc736e(0x129)]}),_0x564c90=await master_shop[_0xfc736e(0x191)]();console[_0xfc736e(0x154)](_0xfc736e(0x140),_0x564c90);const _0x46975a=await suppliers[_0xfc736e(0x191)]();console['log'](_0x46975a);const _0x20a76a=await suppliers['aggregate']([{'$lookup':{'from':_0xfc736e(0x152),'localField':_0xfc736e(0x13d),'foreignField':_0xfc736e(0x148),'as':_0xfc736e(0x187)}}]),_0x23cabd=_0x20a76a['map'](_0xb46bbb=>{const _0x54530e=_0xfc736e;console[_0x54530e(0x154)]('data',_0xb46bbb);var _0x511165=0x0,_0x266404=0x0;return _0xb46bbb[_0x54530e(0x187)][_0x54530e(0x146)](_0xa34240=>{const _0x543bf0=_0x54530e;console['log'](_0x543bf0(0x173),_0xa34240),_0xa34240[_0x543bf0(0x15b)]==_0x543bf0(0x137)?_0x511165+=_0xa34240[_0x543bf0(0x145)]:_0x266404+=_0xa34240[_0x543bf0(0x145)];}),_0xb46bbb['purchase']=_0x511165,_0xb46bbb[_0x54530e(0x12c)]=_0x266404,_0xb46bbb;});console['log'](_0xfc736e(0x183),_0x23cabd);if(_0x564c90[0x0][_0xfc736e(0x162)]==_0xfc736e(0x163)){var _0x58aa3c=users[_0xfc736e(0x179)];console[_0xfc736e(0x154)](_0x58aa3c);}else{if(_0x564c90[0x0][_0xfc736e(0x162)]==_0xfc736e(0x18e))var _0x58aa3c=users[_0xfc736e(0x18e)];else{if(_0x564c90[0x0]['language']==_0xfc736e(0x17e))var _0x58aa3c=users['German'];else{if(_0x564c90[0x0][_0xfc736e(0x162)]==_0xfc736e(0x155))var _0x58aa3c=users[_0xfc736e(0x155)];else{if(_0x564c90[0x0]['language']==_0xfc736e(0x164))var _0x58aa3c=users['French'];else{if(_0x564c90[0x0]['language']==_0xfc736e(0x180))var _0x58aa3c=users[_0xfc736e(0x16d)];else{if(_0x564c90[0x0]['language']==_0xfc736e(0x157))var _0x58aa3c=users['Chinese'];else{if(_0x564c90[0x0]['language']=='Arabic\x20(ae)')var _0x58aa3c=users[_0xfc736e(0x14e)];}}}}}}}_0x4fb46e[_0xfc736e(0x159)](_0xfc736e(0x13e),{'success':_0x1a0ba9[_0xfc736e(0x175)](_0xfc736e(0x18a)),'errors':_0x1a0ba9['flash'](_0xfc736e(0x15d)),'user':_0x46975a,'profile':_0x340543,'master_shop':_0x564c90,'role':_0x209485,'payment':_0x23cabd,'language':_0x58aa3c});}catch(_0x3752c4){console['log'](_0x3752c4);}}),router[a0_0x7f9d2c(0x174)](a0_0x7f9d2c(0x127),auth,async(_0x35bf6a,_0x4396d4)=>{const _0x33e40e=a0_0x7f9d2c;try{const {name:_0x42256d,email:_0x4c45e,mobile:_0x1128c6,company:_0x636eaf,address:_0x184bdc,receivable:_0x43ebd3,payable:_0x2d5dc4,code:_0x31693e,contactperson:_0x2c15c4,landline:_0x1c84a0}=_0x35bf6a[_0x33e40e(0x12f)],_0xa7f24c=new suppliers({'name':_0x42256d,'email':_0x4c45e,'mobile':_0x1128c6,'company':_0x636eaf,'address':_0x184bdc,'receivable':_0x43ebd3,'payable':_0x2d5dc4,'suppliers_code':_0x31693e,'contactperson':_0x2c15c4,'landline':_0x1c84a0}),_0x3389f7=await _0xa7f24c[_0x33e40e(0x181)]();_0x35bf6a['flash'](_0x33e40e(0x18a),_0x33e40e(0x16e)),_0x4396d4[_0x33e40e(0x17c)](_0x33e40e(0x165));}catch(_0x2cf459){console['log'](_0x2cf459);}}),router[a0_0x7f9d2c(0x12a)](a0_0x7f9d2c(0x16a),auth,async(_0x91ee78,_0x103b1c)=>{const _0x4b426e=a0_0x7f9d2c;try{const {username:_0x1bece1,email:_0x7253fa,role:_0x505bb5}=_0x91ee78['user'],_0x23daf2=_0x91ee78['user'],_0x377b2a=await profile[_0x4b426e(0x13a)]({'email':_0x23daf2[_0x4b426e(0x129)]}),_0x2e0ca2=await master_shop[_0x4b426e(0x191)]();console['log'](_0x4b426e(0x140),_0x2e0ca2);const _0x266cbe=_0x91ee78[_0x4b426e(0x150)]['id'],_0x2b4413=await suppliers[_0x4b426e(0x15a)](_0x266cbe);console[_0x4b426e(0x154)](_0x2b4413);if(_0x2e0ca2[0x0][_0x4b426e(0x162)]=='English\x20(US)'){var _0x2a12e1=users[_0x4b426e(0x179)];console[_0x4b426e(0x154)](_0x2a12e1);}else{if(_0x2e0ca2[0x0][_0x4b426e(0x162)]=='Hindi')var _0x2a12e1=users[_0x4b426e(0x18e)];else{if(_0x2e0ca2[0x0][_0x4b426e(0x162)]==_0x4b426e(0x17e))var _0x2a12e1=users[_0x4b426e(0x17e)];else{if(_0x2e0ca2[0x0]['language']==_0x4b426e(0x155))var _0x2a12e1=users[_0x4b426e(0x155)];else{if(_0x2e0ca2[0x0][_0x4b426e(0x162)]==_0x4b426e(0x164))var _0x2a12e1=users['French'];else{if(_0x2e0ca2[0x0]['language']=='Portuguese\x20(BR)')var _0x2a12e1=users[_0x4b426e(0x16d)];else{if(_0x2e0ca2[0x0][_0x4b426e(0x162)]==_0x4b426e(0x157))var _0x2a12e1=users[_0x4b426e(0x157)];else{if(_0x2e0ca2[0x0][_0x4b426e(0x162)]=='Arabic\x20(ae)')var _0x2a12e1=users[_0x4b426e(0x14e)];}}}}}}}_0x103b1c['render'](_0x4b426e(0x13e),{'success':_0x91ee78[_0x4b426e(0x175)](_0x4b426e(0x18a)),'errors':_0x91ee78[_0x4b426e(0x175)](_0x4b426e(0x15d)),'role':_0x23daf2,'profile':_0x377b2a,'master_shop':_0x2e0ca2,'user':_0x2b4413,'language':_0x2a12e1});}catch(_0x533b39){console['log'](_0x533b39);}}),router[a0_0x7f9d2c(0x174)](a0_0x7f9d2c(0x16a),auth,async(_0x110d8e,_0x33e060)=>{const _0x164358=a0_0x7f9d2c;try{const _0x169c6f=_0x110d8e[_0x164358(0x150)]['id'],_0x4db604=await suppliers['findById'](_0x169c6f),{name:_0x858fdb,email:_0x371a33,mobile:_0x4c7121,company:_0x355ae3,address:_0x2f6777,receivable:_0x55f51b,payable:_0x3f61f9,code:_0x5e0371,contactperson:_0x7f4d6,landline:_0x239711}=_0x110d8e[_0x164358(0x12f)];_0x4db604[_0x164358(0x13d)]=_0x858fdb,_0x4db604[_0x164358(0x129)]=_0x371a33,_0x4db604[_0x164358(0x133)]=_0x4c7121,_0x4db604[_0x164358(0x182)]=_0x355ae3,_0x4db604[_0x164358(0x13c)]=_0x2f6777,_0x4db604[_0x164358(0x135)]=_0x55f51b,_0x4db604[_0x164358(0x178)]=_0x3f61f9,_0x4db604[_0x164358(0x156)]=_0x5e0371,_0x4db604['contactperson']=_0x7f4d6,_0x4db604['landline']=_0x239711;const _0x17c3e1=await _0x4db604['save']();_0x110d8e[_0x164358(0x175)]('success',_0x164358(0x136)),_0x33e060[_0x164358(0x17c)](_0x164358(0x165));}catch(_0x2b3aa7){console[_0x164358(0x154)](_0x2b3aa7);}}),router[a0_0x7f9d2c(0x12a)](a0_0x7f9d2c(0x12d),auth,async(_0x5052ec,_0x34f5dc)=>{const _0x4a751e=a0_0x7f9d2c;try{const {username:_0x159ddf,email:_0x2c33be,role:_0x4b6cd7}=_0x5052ec[_0x4a751e(0x13f)],_0x226ec3=_0x5052ec[_0x4a751e(0x13f)],_0x5794f7=await profile['findOne']({'email':_0x226ec3[_0x4a751e(0x129)]}),_0x57302d=await master_shop[_0x4a751e(0x191)]();console[_0x4a751e(0x154)]('master',_0x57302d),console[_0x4a751e(0x154)](_0x5052ec['params']['id']);const _0x10351f=await suppliers[_0x4a751e(0x13a)]({'_id':_0x5052ec[_0x4a751e(0x150)]['id']});console[_0x4a751e(0x154)](_0x10351f);const _0x3940e2=await s_payment_data['find']({'suppliers':_0x10351f['name']});console['log'](_0x3940e2);const _0x358a1c=await s_payment_data[_0x4a751e(0x17f)]([{'$match':{'suppliers':_0x10351f[_0x4a751e(0x13d)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x4a751e(0x172),'sum':{'$sum':'$amount'}}}]);console[_0x4a751e(0x154)](_0x4a751e(0x14d),_0x358a1c);const _0x187186=await s_payment_data[_0x4a751e(0x17f)]([{'$match':{'suppliers':_0x10351f[_0x4a751e(0x13d)]}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x4a751e(0x172),'sum':{'$sum':'$amount'}}}]);console[_0x4a751e(0x154)](_0x4a751e(0x144),_0x187186);if(_0x57302d[0x0][_0x4a751e(0x162)]==_0x4a751e(0x163)){var _0x1374c0=users[_0x4a751e(0x179)];console['log'](_0x1374c0);}else{if(_0x57302d[0x0][_0x4a751e(0x162)]==_0x4a751e(0x18e))var _0x1374c0=users['Hindi'];else{if(_0x57302d[0x0][_0x4a751e(0x162)]==_0x4a751e(0x17e))var _0x1374c0=users['German'];else{if(_0x57302d[0x0][_0x4a751e(0x162)]==_0x4a751e(0x155))var _0x1374c0=users['Spanish'];else{if(_0x57302d[0x0][_0x4a751e(0x162)]==_0x4a751e(0x164))var _0x1374c0=users[_0x4a751e(0x164)];else{if(_0x57302d[0x0][_0x4a751e(0x162)]==_0x4a751e(0x180))var _0x1374c0=users['Portuguese'];else{if(_0x57302d[0x0][_0x4a751e(0x162)]==_0x4a751e(0x157))var _0x1374c0=users[_0x4a751e(0x157)];else{if(_0x57302d[0x0]['language']=='Arabic\x20(ae)')var _0x1374c0=users[_0x4a751e(0x14e)];}}}}}}}_0x34f5dc[_0x4a751e(0x159)](_0x4a751e(0x16b),{'success':_0x5052ec[_0x4a751e(0x175)]('success'),'errors':_0x5052ec['flash']('errors'),'role':_0x226ec3,'profile':_0x5794f7,'master_shop':_0x57302d,'payment':_0x3940e2,'payable':_0x358a1c,'receivable':_0x187186,'language':_0x1374c0});}catch(_0x1640d6){console[_0x4a751e(0x154)](_0x1640d6);}}),router[a0_0x7f9d2c(0x12a)](a0_0x7f9d2c(0x14a),auth,async(_0x21d037,_0x2aa845)=>{const _0x3a1b9f=a0_0x7f9d2c;try{const _0x13a12e=new excelJS[(_0x3a1b9f(0x18f))](),_0xc1c49=_0x13a12e[_0x3a1b9f(0x17a)](_0x3a1b9f(0x142));return _0xc1c49[_0x3a1b9f(0x18d)]=[{'header':_0x3a1b9f(0x184),'key':'PBrands','width':0xa},{'header':_0x3a1b9f(0x18c),'key':_0x3a1b9f(0x12e),'width':0xa},{'header':_0x3a1b9f(0x188),'key':_0x3a1b9f(0x190),'width':0xa},{'header':_0x3a1b9f(0x186),'key':_0x3a1b9f(0x13c),'width':0xa},{'header':'Company_Name','key':'mobile','width':0xa},{'header':_0x3a1b9f(0x13c),'key':'email','width':0xa}],_0x2aa845[_0x3a1b9f(0x153)](_0x3a1b9f(0x17b),_0x3a1b9f(0x176)),_0x2aa845['setHeader'](_0x3a1b9f(0x139),_0x3a1b9f(0x168)),_0x13a12e[_0x3a1b9f(0x151)]['write'](_0x2aa845)['then'](()=>{const _0x4c4cea=_0x3a1b9f;_0x2aa845[_0x4c4cea(0x16f)](0xc8);});}catch(_0x1f765b){_0x2aa845[_0x3a1b9f(0x16f)](0x190)[_0x3a1b9f(0x161)]({'errors':_0x1f765b[_0x3a1b9f(0x189)]});}});function a0_0x369b(){const _0x4c36c1=['status','4yEcxpW','originalname','$reason','doc','post','flash','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','657591HNFYuY','payable','English','addWorksheet','Content-Type','redirect','diskStorage','German','aggregate','Portuguese\x20(BR)','save','company','supplier.js\x20payment_data','Name','exports','Mobile_number','suppliers_docs','Email','message','success','sheet_to_json','Supplier_Code','columns','Hindi','Workbook','SalesmanName','find','/view','../public/language/languages.json','email','get','../models/all_models','purchase_return','/view/payment/:id','PUnits','body','4392540cxrUqH','single','28143670CKvWMJ','mobile','public/Migration','receivable','supplier\x20data\x20update\x20successfully','Purchase','Router','Content-Disposition','findOne','9793805alZphX','address','name','supplier','user','master','Sheets','Customers','8bGYIOr','receivable_sum','amount','forEach','filename','suppliers','error','/products_export_migrate_file','7711490xTUOcl','2882120sSDxcz','payable_sum','Arabic','readFile','params','xlsx','s_payments','setHeader','log','Spanish','suppliers_code','Chinese','/supplier_import_migrate_file','render','findById','reason','utils','errors','437446TIdxxR','exceljs','9WwZRvc','send','language','English\x20(US)','French','/supplier/view','supplier_product_file','file','attachment;\x20filename=supplier_Migration_File.xlsx','SheetNames','/view/:id','supplier_payment','../middleware/auth','Portuguese','supplier\x20data\x20add\x20successfully'];a0_0x369b=function(){return _0x4c36c1;};return a0_0x369b();}const storage1=multer[a0_0x7f9d2c(0x17d)]({'destination':(_0x112219,_0x2b3a76,_0x2f0ec1)=>{const _0xad9d3c=a0_0x7f9d2c;_0x2f0ec1(null,_0xad9d3c(0x134));},'filename':(_0x584c73,_0x2721f5,_0xa4022b)=>{const _0x488692=a0_0x7f9d2c;_0xa4022b(null,Date['now']()+_0x2721f5[_0x488692(0x171)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x7f9d2c(0x174)](a0_0x7f9d2c(0x158),auth,uploadMigrate[a0_0x7f9d2c(0x131)](a0_0x7f9d2c(0x166)),async(_0x2dea1e,_0x3b63d8)=>{const _0x257ecf=a0_0x7f9d2c,_0x124a85=_0x2dea1e[_0x257ecf(0x167)][_0x257ecf(0x147)],_0x1b06ee=await xlsx[_0x257ecf(0x14f)]('public/Migration/'+_0x124a85);let _0x55bfb2=_0x1b06ee[_0x257ecf(0x169)],_0x1c2371=xlsx[_0x257ecf(0x15c)][_0x257ecf(0x18b)](_0x1b06ee[_0x257ecf(0x141)][_0x55bfb2[0x0]]);for(const _0x1e9cc1 of _0x1c2371){const _0x440b4e=_0x1e9cc1[_0x257ecf(0x184)],_0xee63ce=_0x1e9cc1[_0x257ecf(0x18c)],_0x8c6aee=_0x1e9cc1[_0x257ecf(0x13c)],_0x4b3595=_0x1e9cc1[_0x257ecf(0x186)],_0x5d652e=_0x1e9cc1[_0x257ecf(0x188)],_0x22ecf3=_0x1e9cc1['Company_Name'];try{let _0x3ac520=await suppliers[_0x257ecf(0x13a)]({'name':_0x440b4e});if(!_0x3ac520){const _0x345ee1=new suppliers({'name':_0x440b4e,'suppliers_code':_0xee63ce,'address':_0x8c6aee,'mobile':_0x4b3595,'email':_0x5d652e,'company':_0x22ecf3});_0x3ac520=await _0x345ee1['save'](),_0x2dea1e[_0x257ecf(0x175)]('success',_0x440b4e+'\x20added\x20successfully');}else _0x2dea1e[_0x257ecf(0x175)](_0x257ecf(0x149),_0x440b4e+'\x20Failed');}catch(_0x47e338){_0x3b63d8[_0x257ecf(0x16f)](0x1f4)['json']({'proderror':_0x47e338['message'],'aproduct':ProductName});}}_0x3b63d8[_0x257ecf(0x17c)](_0x257ecf(0x165));}),module[a0_0x7f9d2c(0x185)]=router;