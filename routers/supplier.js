const a0_0xb05693=a0_0x5003;(function(_0x1fa210,_0x504c5b){const _0x3bcf36=a0_0x5003,_0x4858dd=_0x1fa210();while(!![]){try{const _0x32af47=parseInt(_0x3bcf36(0x1a8))/0x1+parseInt(_0x3bcf36(0x18d))/0x2+-parseInt(_0x3bcf36(0x1a1))/0x3*(parseInt(_0x3bcf36(0x164))/0x4)+-parseInt(_0x3bcf36(0x16a))/0x5*(parseInt(_0x3bcf36(0x1aa))/0x6)+-parseInt(_0x3bcf36(0x15f))/0x7*(-parseInt(_0x3bcf36(0x163))/0x8)+parseInt(_0x3bcf36(0x1c2))/0x9*(-parseInt(_0x3bcf36(0x16b))/0xa)+parseInt(_0x3bcf36(0x1a5))/0xb;if(_0x32af47===_0x504c5b)break;else _0x4858dd['push'](_0x4858dd['shift']());}catch(_0x2a7aa5){_0x4858dd['push'](_0x4858dd['shift']());}}}(a0_0x3b5b,0xf0ab0));function a0_0x5003(_0x4d8661,_0x2d4769){const _0x3b5b62=a0_0x3b5b();return a0_0x5003=function(_0x5003c7,_0x264394){_0x5003c7=_0x5003c7-0x155;let _0x45d048=_0x3b5b62[_0x5003c7];return _0x45d048;},a0_0x5003(_0x4d8661,_0x2d4769);}const express=require(a0_0xb05693(0x17a)),app=express(),router=express[a0_0xb05693(0x1a6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0xb05693(0x189)),excelJS=require(a0_0xb05693(0x17e)),xlsx=require(a0_0xb05693(0x1ba)),multer=require(a0_0xb05693(0x15d));function a0_0x3b5b(){const _0x210125=['purchase','payable_sum','errors','single','PUnits','address','Purchase','addWorksheet','multer','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','55237sbyIHJ','language','\x20Failed','Purchase\x20Return','248qRWrdo','770524iIatpI','suppliers','SheetNames','Portuguese\x20(BR)','supplier_payment','contactperson','5UeBcgw','81710vMfYgp','English\x20(US)','render','suppliers_code','Supplier_Code','supplier\x20data\x20add\x20successfully','company','Customers','purchase_return','file','receivable','suppliers_docs','json','French','message','express','name','filename','Workbook','exceljs','Arabic','originalname','English','data','send','Content-Type','Name','Spanish','supplier\x20data\x20update\x20successfully','master','../public/language/languages.json','aggregate','now','SalesmanName','3227842hnqTps','utils','supplier_product_file','status','Portuguese','/view/payment/:id','save','PBrands','/supplier/view','supplier.js\x20payment_data','Company_Name','redirect','Chinese','mobile','s_payments','email','diskStorage','$reason','Mobile_number','success','3QCutbO','map','user','$amount','2565365EwDKkH','Router','exports','1055110ipZHGz','get','191598QMGuxY','receivable_sum','body','findOne','forEach','/view/:id','Hindi','/supplier_import_migrate_file','public/Migration','German','post','log','columns','write','reason','params','xlsx','findById','Content-Disposition','supplier','attachment;\x20filename=supplier_Migration_File.xlsx','Arabic\x20(ae)','readFile','flash','2133UeVhPj','error','find','/view','amount'];a0_0x3b5b=function(){return _0x210125;};return a0_0x3b5b();}router['get'](a0_0xb05693(0x1c5),auth,async(_0x4f7637,_0x5ab286)=>{const _0x1761a2=a0_0xb05693;try{const {username:_0x56b82c,email:_0x3ff6ea,role:_0x427eaa}=_0x4f7637[_0x1761a2(0x1a3)],_0x2a245b=_0x4f7637[_0x1761a2(0x1a3)],_0x30c64f=await profile[_0x1761a2(0x1ad)]({'email':_0x2a245b[_0x1761a2(0x19c)]}),_0x55411f=await master_shop['find']();console['log'](_0x1761a2(0x188),_0x55411f);const _0x32226d=await suppliers[_0x1761a2(0x1c4)]();console[_0x1761a2(0x1b5)](_0x32226d);const _0x5f4f64=await suppliers['aggregate']([{'$lookup':{'from':_0x1761a2(0x19b),'localField':_0x1761a2(0x17b),'foreignField':_0x1761a2(0x165),'as':_0x1761a2(0x176)}}]),_0x1b02da=_0x5f4f64[_0x1761a2(0x1a2)](_0x32f998=>{const _0x141cb4=_0x1761a2;console[_0x141cb4(0x1b5)](_0x141cb4(0x182),_0x32f998);var _0x3653a2=0x0,_0x49e28f=0x0;return _0x32f998[_0x141cb4(0x176)][_0x141cb4(0x1ae)](_0x2100ed=>{const _0x1ff1fe=_0x141cb4;console[_0x1ff1fe(0x1b5)]('doc',_0x2100ed),_0x2100ed[_0x1ff1fe(0x1b8)]==_0x1ff1fe(0x15b)?_0x3653a2+=_0x2100ed[_0x1ff1fe(0x1c6)]:_0x49e28f+=_0x2100ed[_0x1ff1fe(0x1c6)];}),_0x32f998[_0x141cb4(0x155)]=_0x3653a2,_0x32f998[_0x141cb4(0x173)]=_0x49e28f,_0x32f998;});console['log'](_0x1761a2(0x196),_0x1b02da);if(_0x55411f[0x0][_0x1761a2(0x160)]==_0x1761a2(0x16c)){var _0x13a5cd=users[_0x1761a2(0x181)];console[_0x1761a2(0x1b5)](_0x13a5cd);}else{if(_0x55411f[0x0]['language']==_0x1761a2(0x1b0))var _0x13a5cd=users[_0x1761a2(0x1b0)];else{if(_0x55411f[0x0][_0x1761a2(0x160)]=='German')var _0x13a5cd=users[_0x1761a2(0x1b3)];else{if(_0x55411f[0x0][_0x1761a2(0x160)]==_0x1761a2(0x186))var _0x13a5cd=users[_0x1761a2(0x186)];else{if(_0x55411f[0x0][_0x1761a2(0x160)]==_0x1761a2(0x178))var _0x13a5cd=users[_0x1761a2(0x178)];else{if(_0x55411f[0x0][_0x1761a2(0x160)]==_0x1761a2(0x167))var _0x13a5cd=users['Portuguese'];else{if(_0x55411f[0x0][_0x1761a2(0x160)]==_0x1761a2(0x199))var _0x13a5cd=users[_0x1761a2(0x199)];else{if(_0x55411f[0x0][_0x1761a2(0x160)]==_0x1761a2(0x1bf))var _0x13a5cd=users[_0x1761a2(0x17f)];}}}}}}}_0x5ab286[_0x1761a2(0x16d)](_0x1761a2(0x1bd),{'success':_0x4f7637[_0x1761a2(0x1c1)](_0x1761a2(0x1a0)),'errors':_0x4f7637[_0x1761a2(0x1c1)]('errors'),'user':_0x32226d,'profile':_0x30c64f,'master_shop':_0x55411f,'role':_0x2a245b,'payment':_0x1b02da,'language':_0x13a5cd});}catch(_0x34ce13){console[_0x1761a2(0x1b5)](_0x34ce13);}}),router[a0_0xb05693(0x1b4)](a0_0xb05693(0x1c5),auth,async(_0x242003,_0x126ecd)=>{const _0x48e256=a0_0xb05693;try{const {name:_0x1497fa,email:_0x540d77,mobile:_0xc6f376,company:_0x33db7b,address:_0x1511c7,receivable:_0x2a1bc6,payable:_0x330c4e,code:_0x573d76,contactperson:_0x3ff80b,landline:_0x448f53}=_0x242003[_0x48e256(0x1ac)],_0x30e05d=new suppliers({'name':_0x1497fa,'email':_0x540d77,'mobile':_0xc6f376,'company':_0x33db7b,'address':_0x1511c7,'receivable':_0x2a1bc6,'payable':_0x330c4e,'suppliers_code':_0x573d76,'contactperson':_0x3ff80b,'landline':_0x448f53}),_0x52011b=await _0x30e05d['save']();_0x242003[_0x48e256(0x1c1)](_0x48e256(0x1a0),_0x48e256(0x170)),_0x126ecd['redirect'](_0x48e256(0x195));}catch(_0x3b6438){console[_0x48e256(0x1b5)](_0x3b6438);}}),router[a0_0xb05693(0x1a9)](a0_0xb05693(0x1af),auth,async(_0x158367,_0x307e41)=>{const _0x5789ac=a0_0xb05693;try{const {username:_0x2ed485,email:_0x21f5b4,role:_0x30af4d}=_0x158367['user'],_0x40ffb0=_0x158367[_0x5789ac(0x1a3)],_0x10cd58=await profile[_0x5789ac(0x1ad)]({'email':_0x40ffb0[_0x5789ac(0x19c)]}),_0x238f01=await master_shop[_0x5789ac(0x1c4)]();console[_0x5789ac(0x1b5)](_0x5789ac(0x188),_0x238f01);const _0x5ecd3b=_0x158367[_0x5789ac(0x1b9)]['id'],_0x1b222a=await suppliers[_0x5789ac(0x1bb)](_0x5ecd3b);console[_0x5789ac(0x1b5)](_0x1b222a);if(_0x238f01[0x0]['language']==_0x5789ac(0x16c)){var _0x51325d=users[_0x5789ac(0x181)];console['log'](_0x51325d);}else{if(_0x238f01[0x0][_0x5789ac(0x160)]=='Hindi')var _0x51325d=users[_0x5789ac(0x1b0)];else{if(_0x238f01[0x0][_0x5789ac(0x160)]=='German')var _0x51325d=users[_0x5789ac(0x1b3)];else{if(_0x238f01[0x0][_0x5789ac(0x160)]==_0x5789ac(0x186))var _0x51325d=users['Spanish'];else{if(_0x238f01[0x0][_0x5789ac(0x160)]==_0x5789ac(0x178))var _0x51325d=users[_0x5789ac(0x178)];else{if(_0x238f01[0x0][_0x5789ac(0x160)]==_0x5789ac(0x167))var _0x51325d=users['Portuguese'];else{if(_0x238f01[0x0]['language']==_0x5789ac(0x199))var _0x51325d=users[_0x5789ac(0x199)];else{if(_0x238f01[0x0][_0x5789ac(0x160)]==_0x5789ac(0x1bf))var _0x51325d=users[_0x5789ac(0x17f)];}}}}}}}_0x307e41[_0x5789ac(0x16d)](_0x5789ac(0x1bd),{'success':_0x158367[_0x5789ac(0x1c1)](_0x5789ac(0x1a0)),'errors':_0x158367[_0x5789ac(0x1c1)](_0x5789ac(0x157)),'role':_0x40ffb0,'profile':_0x10cd58,'master_shop':_0x238f01,'user':_0x1b222a,'language':_0x51325d});}catch(_0x457f0e){console[_0x5789ac(0x1b5)](_0x457f0e);}}),router[a0_0xb05693(0x1b4)]('/view/:id',auth,async(_0x36fe26,_0x5b021a)=>{const _0x3fa0e4=a0_0xb05693;try{const _0x12e960=_0x36fe26[_0x3fa0e4(0x1b9)]['id'],_0x229144=await suppliers[_0x3fa0e4(0x1bb)](_0x12e960),{name:_0x1b72ef,email:_0x4490c9,mobile:_0x39fcf1,company:_0x11dcec,address:_0x1c073c,receivable:_0x573a05,payable:_0x5e27bb,code:_0x3acb63,contactperson:_0x56f0ee,landline:_0x437725}=_0x36fe26[_0x3fa0e4(0x1ac)];_0x229144[_0x3fa0e4(0x17b)]=_0x1b72ef,_0x229144[_0x3fa0e4(0x19c)]=_0x4490c9,_0x229144[_0x3fa0e4(0x19a)]=_0x39fcf1,_0x229144[_0x3fa0e4(0x171)]=_0x11dcec,_0x229144['address']=_0x1c073c,_0x229144[_0x3fa0e4(0x175)]=_0x573a05,_0x229144['payable']=_0x5e27bb,_0x229144[_0x3fa0e4(0x16e)]=_0x3acb63,_0x229144[_0x3fa0e4(0x169)]=_0x56f0ee,_0x229144['landline']=_0x437725;const _0x4ee30=await _0x229144['save']();_0x36fe26[_0x3fa0e4(0x1c1)]('success',_0x3fa0e4(0x187)),_0x5b021a['redirect']('/supplier/view');}catch(_0x3576a7){console['log'](_0x3576a7);}}),router[a0_0xb05693(0x1a9)](a0_0xb05693(0x192),auth,async(_0x3dbbc7,_0xda5ee2)=>{const _0xe865b6=a0_0xb05693;try{const {username:_0x1b55f9,email:_0x2df611,role:_0x5f2852}=_0x3dbbc7[_0xe865b6(0x1a3)],_0x126c89=_0x3dbbc7[_0xe865b6(0x1a3)],_0x564ec7=await profile['findOne']({'email':_0x126c89['email']}),_0x190808=await master_shop['find']();console[_0xe865b6(0x1b5)](_0xe865b6(0x188),_0x190808),console['log'](_0x3dbbc7[_0xe865b6(0x1b9)]['id']);const _0xb044e5=await suppliers[_0xe865b6(0x1ad)]({'_id':_0x3dbbc7[_0xe865b6(0x1b9)]['id']});console[_0xe865b6(0x1b5)](_0xb044e5);const _0x503471=await s_payment_data[_0xe865b6(0x1c4)]({'suppliers':_0xb044e5['name']});console[_0xe865b6(0x1b5)](_0x503471);const _0x2d6eb3=await s_payment_data[_0xe865b6(0x18a)]([{'$match':{'suppliers':_0xb044e5['name']}},{'$match':{'reason':_0xe865b6(0x15b)}},{'$group':{'_id':_0xe865b6(0x19e),'sum':{'$sum':_0xe865b6(0x1a4)}}}]);console[_0xe865b6(0x1b5)](_0xe865b6(0x156),_0x2d6eb3);const _0x496fcf=await s_payment_data[_0xe865b6(0x18a)]([{'$match':{'suppliers':_0xb044e5[_0xe865b6(0x17b)]}},{'$match':{'reason':_0xe865b6(0x162)}},{'$group':{'_id':'$reason','sum':{'$sum':_0xe865b6(0x1a4)}}}]);console[_0xe865b6(0x1b5)](_0xe865b6(0x1ab),_0x496fcf);if(_0x190808[0x0][_0xe865b6(0x160)]=='English\x20(US)'){var _0x395686=users[_0xe865b6(0x181)];console[_0xe865b6(0x1b5)](_0x395686);}else{if(_0x190808[0x0]['language']==_0xe865b6(0x1b0))var _0x395686=users[_0xe865b6(0x1b0)];else{if(_0x190808[0x0]['language']=='German')var _0x395686=users[_0xe865b6(0x1b3)];else{if(_0x190808[0x0][_0xe865b6(0x160)]==_0xe865b6(0x186))var _0x395686=users[_0xe865b6(0x186)];else{if(_0x190808[0x0][_0xe865b6(0x160)]==_0xe865b6(0x178))var _0x395686=users['French'];else{if(_0x190808[0x0]['language']==_0xe865b6(0x167))var _0x395686=users[_0xe865b6(0x191)];else{if(_0x190808[0x0][_0xe865b6(0x160)]==_0xe865b6(0x199))var _0x395686=users['Chinese'];else{if(_0x190808[0x0]['language']==_0xe865b6(0x1bf))var _0x395686=users[_0xe865b6(0x17f)];}}}}}}}_0xda5ee2['render'](_0xe865b6(0x168),{'success':_0x3dbbc7[_0xe865b6(0x1c1)]('success'),'errors':_0x3dbbc7[_0xe865b6(0x1c1)]('errors'),'role':_0x126c89,'profile':_0x564ec7,'master_shop':_0x190808,'payment':_0x503471,'payable':_0x2d6eb3,'receivable':_0x496fcf,'language':_0x395686});}catch(_0x4fdef1){console[_0xe865b6(0x1b5)](_0x4fdef1);}}),router[a0_0xb05693(0x1a9)]('/products_export_migrate_file',auth,async(_0x4dd8bc,_0x288418)=>{const _0x4fd113=a0_0xb05693;try{const _0x1c3f93=new excelJS[(_0x4fd113(0x17d))](),_0x555dd9=_0x1c3f93[_0x4fd113(0x15c)](_0x4fd113(0x172));return _0x555dd9[_0x4fd113(0x1b6)]=[{'header':_0x4fd113(0x185),'key':_0x4fd113(0x194),'width':0xa},{'header':_0x4fd113(0x16f),'key':_0x4fd113(0x159),'width':0xa},{'header':'Email','key':_0x4fd113(0x18c),'width':0xa},{'header':_0x4fd113(0x19f),'key':_0x4fd113(0x15a),'width':0xa},{'header':_0x4fd113(0x197),'key':_0x4fd113(0x19a),'width':0xa},{'header':'address','key':_0x4fd113(0x19c),'width':0xa}],_0x288418['setHeader'](_0x4fd113(0x184),_0x4fd113(0x15e)),_0x288418['setHeader'](_0x4fd113(0x1bc),_0x4fd113(0x1be)),_0x1c3f93[_0x4fd113(0x1ba)][_0x4fd113(0x1b7)](_0x288418)['then'](()=>{const _0x10c4d0=_0x4fd113;_0x288418[_0x10c4d0(0x190)](0xc8);});}catch(_0x456852){_0x288418[_0x4fd113(0x190)](0x190)[_0x4fd113(0x183)]({'errors':_0x456852[_0x4fd113(0x179)]});}});const storage1=multer[a0_0xb05693(0x19d)]({'destination':(_0x3558ec,_0x137b38,_0x483f94)=>{const _0x551e4d=a0_0xb05693;_0x483f94(null,_0x551e4d(0x1b2));},'filename':(_0x355b51,_0x27f001,_0x5d3ee5)=>{const _0x457f9f=a0_0xb05693;_0x5d3ee5(null,Date[_0x457f9f(0x18b)]()+_0x27f001[_0x457f9f(0x180)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0xb05693(0x1b1),auth,uploadMigrate[a0_0xb05693(0x158)](a0_0xb05693(0x18f)),async(_0x222834,_0x4baab4)=>{const _0x24291c=a0_0xb05693,_0x32df42=_0x222834[_0x24291c(0x174)][_0x24291c(0x17c)],_0x33257c=await xlsx[_0x24291c(0x1c0)]('public/Migration/'+_0x32df42);let _0x4777cc=_0x33257c[_0x24291c(0x166)],_0xa0663b=xlsx[_0x24291c(0x18e)]['sheet_to_json'](_0x33257c['Sheets'][_0x4777cc[0x0]]);for(const _0x390489 of _0xa0663b){const _0x1a10d6=_0x390489[_0x24291c(0x185)],_0x232ff5=_0x390489[_0x24291c(0x16f)],_0x4623f6=_0x390489[_0x24291c(0x15a)],_0x5adacc=_0x390489[_0x24291c(0x19f)],_0x54af8a=_0x390489['Email'],_0x2f4904=_0x390489[_0x24291c(0x197)];try{let _0x53bec6=await suppliers['findOne']({'name':_0x1a10d6});if(!_0x53bec6){const _0x3463ad=new suppliers({'name':_0x1a10d6,'suppliers_code':_0x232ff5,'address':_0x4623f6,'mobile':_0x5adacc,'email':_0x54af8a,'company':_0x2f4904});_0x53bec6=await _0x3463ad[_0x24291c(0x193)](),_0x222834[_0x24291c(0x1c1)]('success',_0x1a10d6+'\x20added\x20successfully');}else _0x222834[_0x24291c(0x1c1)](_0x24291c(0x1c3),_0x1a10d6+_0x24291c(0x161));}catch(_0x4542d1){_0x4baab4['status'](0x1f4)[_0x24291c(0x177)]({'proderror':_0x4542d1[_0x24291c(0x179)],'aproduct':ProductName});}}_0x4baab4[_0x24291c(0x198)](_0x24291c(0x195));}),module[a0_0xb05693(0x1a7)]=router;