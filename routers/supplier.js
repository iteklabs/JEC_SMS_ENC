const a0_0x1b0b45=a0_0x5118;(function(_0x59b195,_0xa8d23b){const _0x14f7c8=a0_0x5118,_0x1bfc05=_0x59b195();while(!![]){try{const _0x2e383c=parseInt(_0x14f7c8(0x1cf))/0x1*(parseInt(_0x14f7c8(0x1c6))/0x2)+-parseInt(_0x14f7c8(0x215))/0x3*(-parseInt(_0x14f7c8(0x1fe))/0x4)+parseInt(_0x14f7c8(0x21b))/0x5+parseInt(_0x14f7c8(0x1d1))/0x6+parseInt(_0x14f7c8(0x222))/0x7*(parseInt(_0x14f7c8(0x1c7))/0x8)+-parseInt(_0x14f7c8(0x1e0))/0x9*(parseInt(_0x14f7c8(0x21e))/0xa)+-parseInt(_0x14f7c8(0x20c))/0xb*(parseInt(_0x14f7c8(0x1d4))/0xc);if(_0x2e383c===_0xa8d23b)break;else _0x1bfc05['push'](_0x1bfc05['shift']());}catch(_0x482628){_0x1bfc05['push'](_0x1bfc05['shift']());}}}(a0_0x2edd,0xb1e9c));function a0_0x2edd(){const _0x521507=['render','flash','Chinese','4yvqwGT','write','readFile','express','map','findOne','/view/payment/:id','user','PUnits','master','suppliers','doc','receivable','data','11bMqRQQ','Arabic\x20(ae)','supplier','log','find','supplier.js\x20payment_data','landline','$reason','filename','796971LLkpCx','suppliers_docs','get','public/Migration/','French','/view','4541295eXfLhR','../models/all_models','Router','11530PSikMU','Content-Type','params','/products_export_migrate_file','7fOYlap','Purchase\x20Return','exports','setHeader','address','json','Workbook','file','then','$amount','../middleware/auth','xlsx','utils','Mobile_number','Spanish','Name','message','single','email','18LXvUTc','7467376AhtgoC','aggregate','success','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Hindi','company','\x20added\x20successfully','supplier_product_file','11949HpxKpS','purchase_return','5134266JfnwDD','Email','Sheets','12343092ubTkqL','post','redirect','Company_Name','save','addWorksheet','name','English','mobile','Portuguese\x20(BR)','sheet_to_json','language','10251EuCLPi','findById','columns','../public/language/languages.json','public/Migration','Content-Disposition','supplier\x20data\x20add\x20successfully','send','status','errors','payable','amount','Arabic','German','contactperson','/view/:id','diskStorage','/supplier/view','Purchase','Portuguese','multer','/supplier_import_migrate_file','receivable_sum','supplier\x20data\x20update\x20successfully','Supplier_Code','English\x20(US)','body'];a0_0x2edd=function(){return _0x521507;};return a0_0x2edd();}const express=require(a0_0x1b0b45(0x201)),app=express(),router=express[a0_0x1b0b45(0x21d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x1b0b45(0x21c)),auth=require(a0_0x1b0b45(0x1bd)),users=require(a0_0x1b0b45(0x1e3)),excelJS=require('exceljs'),xlsx=require(a0_0x1b0b45(0x1be)),multer=require(a0_0x1b0b45(0x1f4));function a0_0x5118(_0x368990,_0x511ffb){const _0x2edd36=a0_0x2edd();return a0_0x5118=function(_0x51185f,_0x582aeb){_0x51185f=_0x51185f-0x1b4;let _0x3e3a08=_0x2edd36[_0x51185f];return _0x3e3a08;},a0_0x5118(_0x368990,_0x511ffb);}router[a0_0x1b0b45(0x217)](a0_0x1b0b45(0x21a),auth,async(_0x3a875f,_0x4ab950)=>{const _0x5d5bf8=a0_0x1b0b45;try{const {username:_0x2c94a6,email:_0x58d6e2,role:_0x245955}=_0x3a875f['user'],_0x1384c3=_0x3a875f['user'],_0x5900fd=await profile[_0x5d5bf8(0x203)]({'email':_0x1384c3[_0x5d5bf8(0x1c5)]}),_0x5648af=await master_shop[_0x5d5bf8(0x210)]();console[_0x5d5bf8(0x20f)]('master',_0x5648af);const _0x5918f0=await suppliers['find']();console['log'](_0x5918f0);const _0x373582=await suppliers['aggregate']([{'$lookup':{'from':'s_payments','localField':_0x5d5bf8(0x1da),'foreignField':_0x5d5bf8(0x208),'as':'suppliers_docs'}}]),_0x10c310=_0x373582[_0x5d5bf8(0x202)](_0x245fd4=>{const _0xaefac2=_0x5d5bf8;console['log'](_0xaefac2(0x20b),_0x245fd4);var _0x349a5f=0x0,_0x456a2f=0x0;return _0x245fd4[_0xaefac2(0x216)]['forEach'](_0x108f82=>{const _0x5d0de8=_0xaefac2;console['log'](_0x5d0de8(0x209),_0x108f82),_0x108f82['reason']==_0x5d0de8(0x1f2)?_0x349a5f+=_0x108f82[_0x5d0de8(0x1eb)]:_0x456a2f+=_0x108f82[_0x5d0de8(0x1eb)];}),_0x245fd4['purchase']=_0x349a5f,_0x245fd4[_0xaefac2(0x1d0)]=_0x456a2f,_0x245fd4;});console[_0x5d5bf8(0x20f)](_0x5d5bf8(0x211),_0x10c310);if(_0x5648af[0x0][_0x5d5bf8(0x1df)]==_0x5d5bf8(0x1f9)){var _0x3a9778=users['English'];console[_0x5d5bf8(0x20f)](_0x3a9778);}else{if(_0x5648af[0x0]['language']==_0x5d5bf8(0x1cb))var _0x3a9778=users[_0x5d5bf8(0x1cb)];else{if(_0x5648af[0x0]['language']==_0x5d5bf8(0x1ed))var _0x3a9778=users['German'];else{if(_0x5648af[0x0][_0x5d5bf8(0x1df)]==_0x5d5bf8(0x1c1))var _0x3a9778=users['Spanish'];else{if(_0x5648af[0x0][_0x5d5bf8(0x1df)]==_0x5d5bf8(0x219))var _0x3a9778=users[_0x5d5bf8(0x219)];else{if(_0x5648af[0x0][_0x5d5bf8(0x1df)]==_0x5d5bf8(0x1dd))var _0x3a9778=users[_0x5d5bf8(0x1f3)];else{if(_0x5648af[0x0][_0x5d5bf8(0x1df)]=='Chinese')var _0x3a9778=users['Chinese'];else{if(_0x5648af[0x0][_0x5d5bf8(0x1df)]==_0x5d5bf8(0x20d))var _0x3a9778=users[_0x5d5bf8(0x1ec)];}}}}}}}_0x4ab950[_0x5d5bf8(0x1fb)](_0x5d5bf8(0x20e),{'success':_0x3a875f['flash'](_0x5d5bf8(0x1c9)),'errors':_0x3a875f[_0x5d5bf8(0x1fc)](_0x5d5bf8(0x1e9)),'user':_0x5918f0,'profile':_0x5900fd,'master_shop':_0x5648af,'role':_0x1384c3,'payment':_0x10c310,'language':_0x3a9778});}catch(_0x2d0237){console[_0x5d5bf8(0x20f)](_0x2d0237);}}),router[a0_0x1b0b45(0x1d5)]('/view',auth,async(_0x4e62a0,_0x106a2f)=>{const _0x3fe4a7=a0_0x1b0b45;try{const {name:_0x3815c4,email:_0x36ab3c,mobile:_0x1bd186,company:_0x17dcfb,address:_0x5f0bed,receivable:_0x40485c,payable:_0x1f0543,code:_0x2bc45c,contactperson:_0x44a960,landline:_0x27850a}=_0x4e62a0[_0x3fe4a7(0x1fa)],_0x42c961=new suppliers({'name':_0x3815c4,'email':_0x36ab3c,'mobile':_0x1bd186,'company':_0x17dcfb,'address':_0x5f0bed,'receivable':_0x40485c,'payable':_0x1f0543,'suppliers_code':_0x2bc45c,'contactperson':_0x44a960,'landline':_0x27850a}),_0x1e59df=await _0x42c961[_0x3fe4a7(0x1d8)]();_0x4e62a0['flash'](_0x3fe4a7(0x1c9),_0x3fe4a7(0x1e6)),_0x106a2f[_0x3fe4a7(0x1d6)](_0x3fe4a7(0x1f1));}catch(_0x523f58){console[_0x3fe4a7(0x20f)](_0x523f58);}}),router[a0_0x1b0b45(0x217)]('/view/:id',auth,async(_0x3b07f9,_0x2a9a55)=>{const _0x56a654=a0_0x1b0b45;try{const {username:_0x492062,email:_0x166f1a,role:_0x2e8bf0}=_0x3b07f9[_0x56a654(0x205)],_0x7a25aa=_0x3b07f9[_0x56a654(0x205)],_0x1dab79=await profile['findOne']({'email':_0x7a25aa[_0x56a654(0x1c5)]}),_0x37905d=await master_shop['find']();console[_0x56a654(0x20f)]('master',_0x37905d);const _0x1876ae=_0x3b07f9[_0x56a654(0x220)]['id'],_0x293ff9=await suppliers['findById'](_0x1876ae);console[_0x56a654(0x20f)](_0x293ff9);if(_0x37905d[0x0][_0x56a654(0x1df)]==_0x56a654(0x1f9)){var _0xd6f951=users['English'];console['log'](_0xd6f951);}else{if(_0x37905d[0x0][_0x56a654(0x1df)]=='Hindi')var _0xd6f951=users[_0x56a654(0x1cb)];else{if(_0x37905d[0x0][_0x56a654(0x1df)]==_0x56a654(0x1ed))var _0xd6f951=users[_0x56a654(0x1ed)];else{if(_0x37905d[0x0][_0x56a654(0x1df)]==_0x56a654(0x1c1))var _0xd6f951=users[_0x56a654(0x1c1)];else{if(_0x37905d[0x0][_0x56a654(0x1df)]=='French')var _0xd6f951=users['French'];else{if(_0x37905d[0x0][_0x56a654(0x1df)]==_0x56a654(0x1dd))var _0xd6f951=users['Portuguese'];else{if(_0x37905d[0x0][_0x56a654(0x1df)]==_0x56a654(0x1fd))var _0xd6f951=users['Chinese'];else{if(_0x37905d[0x0]['language']==_0x56a654(0x20d))var _0xd6f951=users[_0x56a654(0x1ec)];}}}}}}}_0x2a9a55['render']('supplier',{'success':_0x3b07f9['flash']('success'),'errors':_0x3b07f9[_0x56a654(0x1fc)](_0x56a654(0x1e9)),'role':_0x7a25aa,'profile':_0x1dab79,'master_shop':_0x37905d,'user':_0x293ff9,'language':_0xd6f951});}catch(_0x201615){console['log'](_0x201615);}}),router[a0_0x1b0b45(0x1d5)](a0_0x1b0b45(0x1ef),auth,async(_0x2690d9,_0x260d7b)=>{const _0x30e893=a0_0x1b0b45;try{const _0x201630=_0x2690d9[_0x30e893(0x220)]['id'],_0x3964c6=await suppliers[_0x30e893(0x1e1)](_0x201630),{name:_0x423051,email:_0x25db3e,mobile:_0x3c3c72,company:_0x4e4be1,address:_0x3a324c,receivable:_0x21ca05,payable:_0x2dc190,code:_0x43fe63,contactperson:_0x432704,landline:_0x1100b2}=_0x2690d9[_0x30e893(0x1fa)];_0x3964c6[_0x30e893(0x1da)]=_0x423051,_0x3964c6[_0x30e893(0x1c5)]=_0x25db3e,_0x3964c6[_0x30e893(0x1dc)]=_0x3c3c72,_0x3964c6[_0x30e893(0x1cc)]=_0x4e4be1,_0x3964c6['address']=_0x3a324c,_0x3964c6[_0x30e893(0x20a)]=_0x21ca05,_0x3964c6[_0x30e893(0x1ea)]=_0x2dc190,_0x3964c6['suppliers_code']=_0x43fe63,_0x3964c6[_0x30e893(0x1ee)]=_0x432704,_0x3964c6[_0x30e893(0x212)]=_0x1100b2;const _0x4aa263=await _0x3964c6[_0x30e893(0x1d8)]();_0x2690d9[_0x30e893(0x1fc)](_0x30e893(0x1c9),_0x30e893(0x1f7)),_0x260d7b[_0x30e893(0x1d6)](_0x30e893(0x1f1));}catch(_0x2e9b7f){console[_0x30e893(0x20f)](_0x2e9b7f);}}),router[a0_0x1b0b45(0x217)](a0_0x1b0b45(0x204),auth,async(_0x3198c4,_0xe6da6e)=>{const _0x21c11e=a0_0x1b0b45;try{const {username:_0x4f551c,email:_0x297998,role:_0x2fc36e}=_0x3198c4[_0x21c11e(0x205)],_0x2e522f=_0x3198c4[_0x21c11e(0x205)],_0x1ee498=await profile['findOne']({'email':_0x2e522f[_0x21c11e(0x1c5)]}),_0x2f5b07=await master_shop[_0x21c11e(0x210)]();console['log'](_0x21c11e(0x207),_0x2f5b07),console['log'](_0x3198c4['params']['id']);const _0x338b1f=await suppliers['findOne']({'_id':_0x3198c4['params']['id']});console[_0x21c11e(0x20f)](_0x338b1f);const _0x20b7be=await s_payment_data['find']({'suppliers':_0x338b1f[_0x21c11e(0x1da)]});console[_0x21c11e(0x20f)](_0x20b7be);const _0x3424aa=await s_payment_data[_0x21c11e(0x1c8)]([{'$match':{'suppliers':_0x338b1f[_0x21c11e(0x1da)]}},{'$match':{'reason':_0x21c11e(0x1f2)}},{'$group':{'_id':_0x21c11e(0x213),'sum':{'$sum':_0x21c11e(0x1bc)}}}]);console[_0x21c11e(0x20f)]('payable_sum',_0x3424aa);const _0x24c34e=await s_payment_data[_0x21c11e(0x1c8)]([{'$match':{'suppliers':_0x338b1f['name']}},{'$match':{'reason':_0x21c11e(0x1b4)}},{'$group':{'_id':_0x21c11e(0x213),'sum':{'$sum':'$amount'}}}]);console[_0x21c11e(0x20f)](_0x21c11e(0x1f6),_0x24c34e);if(_0x2f5b07[0x0][_0x21c11e(0x1df)]==_0x21c11e(0x1f9)){var _0x4200ba=users[_0x21c11e(0x1db)];console[_0x21c11e(0x20f)](_0x4200ba);}else{if(_0x2f5b07[0x0][_0x21c11e(0x1df)]==_0x21c11e(0x1cb))var _0x4200ba=users['Hindi'];else{if(_0x2f5b07[0x0][_0x21c11e(0x1df)]=='German')var _0x4200ba=users[_0x21c11e(0x1ed)];else{if(_0x2f5b07[0x0][_0x21c11e(0x1df)]==_0x21c11e(0x1c1))var _0x4200ba=users[_0x21c11e(0x1c1)];else{if(_0x2f5b07[0x0][_0x21c11e(0x1df)]==_0x21c11e(0x219))var _0x4200ba=users[_0x21c11e(0x219)];else{if(_0x2f5b07[0x0][_0x21c11e(0x1df)]==_0x21c11e(0x1dd))var _0x4200ba=users[_0x21c11e(0x1f3)];else{if(_0x2f5b07[0x0][_0x21c11e(0x1df)]==_0x21c11e(0x1fd))var _0x4200ba=users[_0x21c11e(0x1fd)];else{if(_0x2f5b07[0x0][_0x21c11e(0x1df)]==_0x21c11e(0x20d))var _0x4200ba=users[_0x21c11e(0x1ec)];}}}}}}}_0xe6da6e[_0x21c11e(0x1fb)]('supplier_payment',{'success':_0x3198c4[_0x21c11e(0x1fc)](_0x21c11e(0x1c9)),'errors':_0x3198c4[_0x21c11e(0x1fc)](_0x21c11e(0x1e9)),'role':_0x2e522f,'profile':_0x1ee498,'master_shop':_0x2f5b07,'payment':_0x20b7be,'payable':_0x3424aa,'receivable':_0x24c34e,'language':_0x4200ba});}catch(_0x436711){console[_0x21c11e(0x20f)](_0x436711);}}),router[a0_0x1b0b45(0x217)](a0_0x1b0b45(0x221),auth,async(_0x5c78b4,_0x7fd5c5)=>{const _0x9f39dc=a0_0x1b0b45;try{const _0x524c5f=new excelJS[(_0x9f39dc(0x1b9))](),_0x271cd8=_0x524c5f[_0x9f39dc(0x1d9)]('Customers');return _0x271cd8[_0x9f39dc(0x1e2)]=[{'header':_0x9f39dc(0x1c2),'key':'PBrands','width':0xa},{'header':_0x9f39dc(0x1f8),'key':_0x9f39dc(0x206),'width':0xa},{'header':_0x9f39dc(0x1d2),'key':'SalesmanName','width':0xa},{'header':_0x9f39dc(0x1c0),'key':'address','width':0xa},{'header':_0x9f39dc(0x1d7),'key':_0x9f39dc(0x1dc),'width':0xa},{'header':_0x9f39dc(0x1b7),'key':'email','width':0xa}],_0x7fd5c5[_0x9f39dc(0x1b6)](_0x9f39dc(0x21f),_0x9f39dc(0x1ca)),_0x7fd5c5[_0x9f39dc(0x1b6)](_0x9f39dc(0x1e5),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x524c5f[_0x9f39dc(0x1be)][_0x9f39dc(0x1ff)](_0x7fd5c5)[_0x9f39dc(0x1bb)](()=>{const _0x5d058e=_0x9f39dc;_0x7fd5c5[_0x5d058e(0x1e8)](0xc8);});}catch(_0x2a68af){_0x7fd5c5[_0x9f39dc(0x1e8)](0x190)[_0x9f39dc(0x1e7)]({'errors':_0x2a68af[_0x9f39dc(0x1c3)]});}});const storage1=multer[a0_0x1b0b45(0x1f0)]({'destination':(_0x1591c7,_0x3f9f97,_0xeed58b)=>{const _0x5254f3=a0_0x1b0b45;_0xeed58b(null,_0x5254f3(0x1e4));},'filename':(_0x42804c,_0xa08ddc,_0x235fff)=>{_0x235fff(null,Date['now']()+_0xa08ddc['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x1b0b45(0x1d5)](a0_0x1b0b45(0x1f5),auth,uploadMigrate[a0_0x1b0b45(0x1c4)](a0_0x1b0b45(0x1ce)),async(_0x28d629,_0x4b0c43)=>{const _0x56bf87=a0_0x1b0b45,_0x252cc8=_0x28d629[_0x56bf87(0x1ba)][_0x56bf87(0x214)],_0x4c39b1=await xlsx[_0x56bf87(0x200)](_0x56bf87(0x218)+_0x252cc8);let _0x5ac881=_0x4c39b1['SheetNames'],_0xa2c99c=xlsx[_0x56bf87(0x1bf)][_0x56bf87(0x1de)](_0x4c39b1[_0x56bf87(0x1d3)][_0x5ac881[0x0]]);for(const _0x514dc7 of _0xa2c99c){const _0xb17857=_0x514dc7[_0x56bf87(0x1c2)],_0x72f05c=_0x514dc7[_0x56bf87(0x1f8)],_0x250b9f=_0x514dc7[_0x56bf87(0x1b7)],_0x542ede=_0x514dc7[_0x56bf87(0x1c0)],_0x318386=_0x514dc7['Email'],_0x4827b4=_0x514dc7[_0x56bf87(0x1d7)];try{let _0x282c94=await suppliers[_0x56bf87(0x203)]({'name':_0xb17857});if(!_0x282c94){const _0x5373cf=new suppliers({'name':_0xb17857,'suppliers_code':_0x72f05c,'address':_0x250b9f,'mobile':_0x542ede,'email':_0x318386,'company':_0x4827b4});_0x282c94=await _0x5373cf[_0x56bf87(0x1d8)](),_0x28d629[_0x56bf87(0x1fc)]('success',_0xb17857+_0x56bf87(0x1cd));}else _0x28d629[_0x56bf87(0x1fc)]('error',_0xb17857+'\x20Failed');}catch(_0x56b207){_0x4b0c43[_0x56bf87(0x1e8)](0x1f4)[_0x56bf87(0x1b8)]({'proderror':_0x56b207[_0x56bf87(0x1c3)],'aproduct':ProductName});}}_0x4b0c43['redirect'](_0x56bf87(0x1f1));}),module[a0_0x1b0b45(0x1b5)]=router;