var a0_0x419498=a0_0x3a6e;(function(_0x329f6d,_0x53b0f5){var _0x2f1b07=a0_0x3a6e,_0x3a459b=_0x329f6d();while(!![]){try{var _0x55dd62=-parseInt(_0x2f1b07(0x255))/0x1+-parseInt(_0x2f1b07(0x19f))/0x2+parseInt(_0x2f1b07(0x187))/0x3*(-parseInt(_0x2f1b07(0x267))/0x4)+parseInt(_0x2f1b07(0x1a1))/0x5+-parseInt(_0x2f1b07(0x25f))/0x6+parseInt(_0x2f1b07(0x1de))/0x7*(parseInt(_0x2f1b07(0x283))/0x8)+parseInt(_0x2f1b07(0x279))/0x9;if(_0x55dd62===_0x53b0f5)break;else _0x3a459b['push'](_0x3a459b['shift']());}catch(_0x5b7c46){_0x3a459b['push'](_0x3a459b['shift']());}}}(a0_0x595c,0x5e638));const express=require(a0_0x419498(0x274)),app=express(),router=express[a0_0x419498(0x1e6)](),{profile,master_shop,categories,brands,units,product,warehouse_temporary,warehouse_validation_setup,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,purchases_finished,purchases_return_finished,supervisor_settings,invoice_for_incoming,purchases_logs,transfers_finished,datalogs,purchases_incoming}=require(a0_0x419498(0x212)),auth=require(a0_0x419498(0x1ef)),nodemailer=require(a0_0x419498(0x226));function a0_0x3a6e(_0x363632,_0x191f74){var _0x595c42=a0_0x595c();return a0_0x3a6e=function(_0x3a6ea2,_0x2968f0){_0x3a6ea2=_0x3a6ea2-0x186;var _0x1ca744=_0x595c42[_0x3a6ea2];return _0x1ca744;},a0_0x3a6e(_0x363632,_0x191f74);}var ejs=require(a0_0x419498(0x263));const path=require('path'),users=require(a0_0x419498(0x1f3)),{isNull}=require(a0_0x419498(0x211));router[a0_0x419498(0x2a0)](a0_0x419498(0x2b8),auth,async(_0x113750,_0x5bc1ce)=>{var _0x2a3d6f=a0_0x419498;try{const {username:_0x24bdde,email:_0x117c37,role:_0x1ad7cd}=_0x113750[_0x2a3d6f(0x1e8)],_0x5bb979=_0x113750['user'],_0x11a938=await profile[_0x2a3d6f(0x289)]({'email':_0x5bb979[_0x2a3d6f(0x231)]}),_0x458c60=await staff[_0x2a3d6f(0x289)]({'email':_0x5bb979[_0x2a3d6f(0x231)]}),_0x490fae=await master_shop[_0x2a3d6f(0x202)]();let _0x39d709=await transfers_finished[_0x2a3d6f(0x207)]([{'$match':{'to_warehouse':_0x458c60[_0x2a3d6f(0x240)]}}]);if(_0x490fae[0x0][_0x2a3d6f(0x259)]==_0x2a3d6f(0x29a))var _0x1d1f48=users[_0x2a3d6f(0x272)];else{if(_0x490fae[0x0][_0x2a3d6f(0x259)]=='Hindi')var _0x1d1f48=users[_0x2a3d6f(0x1af)];else{if(_0x490fae[0x0][_0x2a3d6f(0x259)]==_0x2a3d6f(0x266))var _0x1d1f48=users[_0x2a3d6f(0x266)];else{if(_0x490fae[0x0][_0x2a3d6f(0x259)]==_0x2a3d6f(0x209))var _0x1d1f48=users[_0x2a3d6f(0x209)];else{if(_0x490fae[0x0]['language']=='French')var _0x1d1f48=users[_0x2a3d6f(0x256)];else{if(_0x490fae[0x0][_0x2a3d6f(0x259)]==_0x2a3d6f(0x1d4))var _0x1d1f48=users[_0x2a3d6f(0x2a7)];else{if(_0x490fae[0x0][_0x2a3d6f(0x259)]=='Chinese')var _0x1d1f48=users[_0x2a3d6f(0x188)];else{if(_0x490fae[0x0][_0x2a3d6f(0x259)]==_0x2a3d6f(0x189))var _0x1d1f48=users[_0x2a3d6f(0x2c4)];}}}}}}}_0x5bc1ce[_0x2a3d6f(0x242)](_0x2a3d6f(0x248),{'success':_0x113750['flash'](_0x2a3d6f(0x18b)),'errors':_0x113750[_0x2a3d6f(0x206)]('errors'),'purchases':_0x39d709,'role':_0x5bb979,'profile':_0x11a938,'master_shop':_0x490fae,'language':_0x1d1f48,'staff_data':_0x458c60});}catch(_0x215b3f){console[_0x2a3d6f(0x296)](_0x2a3d6f(0x270),_0x215b3f),_0x5bc1ce['status'](0xc8)[_0x2a3d6f(0x1b4)]({'message':_0x215b3f[_0x2a3d6f(0x291)]});}}),router[a0_0x419498(0x2a0)](a0_0x419498(0x282),auth,async(_0x4ae4c0,_0x46756c)=>{var _0x7e3aee=a0_0x419498;try{const {username:_0x18b850,email:_0x151183,role:_0x46b839}=_0x4ae4c0[_0x7e3aee(0x1e8)],_0x152ccb=_0x4ae4c0[_0x7e3aee(0x1e8)],_0x555244=await profile[_0x7e3aee(0x289)]({'email':_0x152ccb[_0x7e3aee(0x231)]}),_0x52112a=await staff[_0x7e3aee(0x289)]({'email':_0x152ccb[_0x7e3aee(0x231)]}),_0x97a1f3=await master_shop[_0x7e3aee(0x202)]();let _0x518c11=await transfers_finished[_0x7e3aee(0x207)]([{'$match':{'to_warehouse':_0x52112a[_0x7e3aee(0x240)],'to_recieved':_0x7e3aee(0x1b3)}}]);if(_0x97a1f3[0x0][_0x7e3aee(0x259)]=='English\x20(US)')var _0xb5224f=users['English'];else{if(_0x97a1f3[0x0][_0x7e3aee(0x259)]==_0x7e3aee(0x1af))var _0xb5224f=users[_0x7e3aee(0x1af)];else{if(_0x97a1f3[0x0][_0x7e3aee(0x259)]==_0x7e3aee(0x266))var _0xb5224f=users[_0x7e3aee(0x266)];else{if(_0x97a1f3[0x0][_0x7e3aee(0x259)]==_0x7e3aee(0x209))var _0xb5224f=users[_0x7e3aee(0x209)];else{if(_0x97a1f3[0x0][_0x7e3aee(0x259)]==_0x7e3aee(0x256))var _0xb5224f=users[_0x7e3aee(0x256)];else{if(_0x97a1f3[0x0][_0x7e3aee(0x259)]==_0x7e3aee(0x1d4))var _0xb5224f=users['Portuguese'];else{if(_0x97a1f3[0x0]['language']==_0x7e3aee(0x188))var _0xb5224f=users[_0x7e3aee(0x188)];else{if(_0x97a1f3[0x0][_0x7e3aee(0x259)]==_0x7e3aee(0x189))var _0xb5224f=users[_0x7e3aee(0x2c4)];}}}}}}}_0x46756c[_0x7e3aee(0x242)]('incoming_add',{'success':_0x4ae4c0[_0x7e3aee(0x206)]('success'),'errors':_0x4ae4c0['flash'](_0x7e3aee(0x24c)),'purchases':_0x518c11,'role':_0x152ccb,'profile':_0x555244,'master_shop':_0x97a1f3,'language':_0xb5224f,'staff_data':_0x52112a});}catch(_0x26a519){console[_0x7e3aee(0x296)](_0x7e3aee(0x270),_0x26a519),_0x46756c[_0x7e3aee(0x1e0)](0xc8)[_0x7e3aee(0x1b4)]({'message':_0x26a519[_0x7e3aee(0x291)]});}});const createLog=async _0x5d3cbf=>{var _0x34e08d=a0_0x419498;const _0x27c3bb=new datalogs({'location':_0x5d3cbf});return await _0x27c3bb[_0x34e08d(0x25e)](),_0x27c3bb[_0x34e08d(0x29d)];};router[a0_0x419498(0x1a9)](a0_0x419498(0x282),auth,async(_0x1aa67e,_0x510a66)=>{var _0x12f742=a0_0x419498;try{const {invoice_trf_data:_0x5a6da7,item_code:_0x5e21e5,SCRN:_0x52f5ef,ReqBy:_0x387c16,type_of_products:_0x86b8d1,dateofreq:_0xff040c,PO_number:_0x532ac6,date:_0x1e5c49,warehouse_name:_0x105927,typeservicesData:_0x30934d,typevehicle:_0x2d5b6f,driver:_0x561bbf,plate:_0x282b3b,van:_0x2bfccb,DRSI:_0x18635f,TSU:_0x303ff5,TFU:_0xe2cbe8,note:_0x4fb728}=_0x1aa67e[_0x12f742(0x1c6)],_0x2867d3=await transfers_finished[_0x12f742(0x238)](_0x5a6da7);if(typeof _0x5e21e5=='string')var _0x5a9b9b=[_0x1aa67e['body'][_0x12f742(0x1c1)]],_0x38bc48=[_0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x2ab)]],_0x5a1a7d=[_0x1aa67e[_0x12f742(0x1c6)]['to_quantity']],_0x3a1c02=[_0x1aa67e[_0x12f742(0x1c6)]['unit']],_0x52fa8d=[_0x1aa67e['body'][_0x12f742(0x21e)]],_0x39305a=[_0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x299)]],_0x1a63a4=[_0x1aa67e['body'][_0x12f742(0x1e9)]],_0x11dd96=[_0x1aa67e[_0x12f742(0x1c6)]['secondary_code']],_0x126033=[_0x1aa67e['body'][_0x12f742(0x19e)]],_0x1cfacb=[_0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x1a5)]],_0x9116f7=[_0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x24a)]],_0x5dae02=[_0x1aa67e['body']['max_product_unit']],_0x28c354=[_0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x1dd)]];else var _0x5a9b9b=[..._0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x1c1)]],_0x38bc48=[..._0x1aa67e[_0x12f742(0x1c6)]['item_code']],_0x5a1a7d=[..._0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x1cf)]],_0x3a1c02=[..._0x1aa67e[_0x12f742(0x1c6)]['unit']],_0x52fa8d=[..._0x1aa67e['body'][_0x12f742(0x21e)]],_0x39305a=[..._0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x299)]],_0x1a63a4=[..._0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x1e9)]],_0x11dd96=[..._0x1aa67e[_0x12f742(0x1c6)]['secondary_code']],_0x126033=[..._0x1aa67e['body'][_0x12f742(0x19e)]],_0x1cfacb=[..._0x1aa67e['body'][_0x12f742(0x1a5)]],_0x9116f7=[..._0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x24a)]],_0x5dae02=[..._0x1aa67e['body'][_0x12f742(0x294)]],_0x28c354=[..._0x1aa67e[_0x12f742(0x1c6)][_0x12f742(0x1dd)]];const _0x2b7c8a=_0x5a9b9b[_0x12f742(0x2af)](_0x402e79=>{return _0x402e79={'product_name':_0x402e79};});_0x38bc48[_0x12f742(0x1f8)]((_0x3c86ab,_0x506935)=>{var _0x56e59a=_0x12f742;_0x2b7c8a[_0x506935][_0x56e59a(0x288)]=_0x3c86ab;}),_0x5a1a7d[_0x12f742(0x1f8)]((_0x1b3b97,_0x5267bc)=>{var _0xe89f9a=_0x12f742;_0x2b7c8a[_0x5267bc][_0xe89f9a(0x261)]=Math[_0xe89f9a(0x1f7)](_0x1b3b97);}),_0x3a1c02[_0x12f742(0x1f8)]((_0x29156d,_0x42e69a)=>{var _0x17f75b=_0x12f742;_0x2b7c8a[_0x42e69a][_0x17f75b(0x275)]=_0x29156d;}),_0x52fa8d[_0x12f742(0x1f8)]((_0x4732b2,_0x28fe39)=>{var _0x5df4e9=_0x12f742;_0x2b7c8a[_0x28fe39][_0x5df4e9(0x286)]=_0x4732b2;}),_0x39305a[_0x12f742(0x1f8)]((_0x132de8,_0x2b73d9)=>{var _0x34bc96=_0x12f742,_0x40dbf2=_0x132de8[_0x34bc96(0x19b)](/[A-Za-z]+/)[0x0],_0x5d2e98=parseInt(_0x132de8['match'](/\d+/)[0x0]);_0x2b7c8a[_0x2b73d9][_0x34bc96(0x245)]=_0x40dbf2,_0x2b7c8a[_0x2b73d9][_0x34bc96(0x18d)]=_0x5d2e98;}),_0x1a63a4[_0x12f742(0x1f8)]((_0x502902,_0x35ff05)=>{_0x2b7c8a[_0x35ff05]['primary_code']=_0x502902;}),_0x11dd96[_0x12f742(0x1f8)]((_0x291f1e,_0xd4df06)=>{var _0x1659ab=_0x12f742;_0x2b7c8a[_0xd4df06][_0x1659ab(0x195)]=_0x291f1e;}),_0x126033['forEach']((_0xf682b6,_0xed7e34)=>{var _0x7fc1fa=_0x12f742;_0x2b7c8a[_0xed7e34][_0x7fc1fa(0x19e)]=_0xf682b6;}),_0x1cfacb['forEach']((_0x38fd32,_0x308f3b)=>{var _0x3914fb=_0x12f742;_0x2b7c8a[_0x308f3b][_0x3914fb(0x1a5)]=_0x38fd32;}),_0x9116f7[_0x12f742(0x1f8)]((_0x1d9abc,_0x273f95)=>{var _0x31f6e7=_0x12f742;_0x2b7c8a[_0x273f95][_0x31f6e7(0x24a)]=_0x1d9abc;}),_0x5dae02[_0x12f742(0x1f8)]((_0x1ba6ce,_0x426ddf)=>{var _0x339129=_0x12f742;_0x2b7c8a[_0x426ddf][_0x339129(0x201)]=_0x1ba6ce;}),_0x28c354[_0x12f742(0x1f8)]((_0x3247f8,_0x5aa4b5)=>{var _0x4df77d=_0x12f742;_0x2b7c8a[_0x5aa4b5][_0x4df77d(0x2c2)]=_0x3247f8;});const _0x3f6eb8=await createLog(_0x12f742(0x1b0));_0x28c354['forEach']((_0x4d6b9e,_0x1a8538)=>{var _0x5a9f15=_0x12f742;_0x2b7c8a[_0x1a8538][_0x5a9f15(0x198)]=_0x5a9f15(0x1b9)+_0x3f6eb8[_0x5a9f15(0x273)]()[_0x5a9f15(0x24d)](0x8,'0');});const _0x2f18d1=_0x2b7c8a[_0x12f742(0x2a6)](_0x713dfb=>_0x713dfb[_0x12f742(0x261)]!=='0'&&_0x713dfb['quantity']!==''),_0x2053f7=new purchases_incoming({'invoice':_0x12f742(0x1b9)+_0x3f6eb8['toString']()[_0x12f742(0x24d)](0x8,'0'),'date':_0x1e5c49,'warehouse_name':_0x105927,'product':_0x2f18d1,'note':_0x4fb728,'POnumber':_0x532ac6,'SCRN':_0x52f5ef,'ReqBy':_0x387c16,'dateofreq':_0xff040c,'typeservicesData':_0x30934d,'van':_0x2bfccb,'typevehicle':_0x2d5b6f,'driver':_0x561bbf,'plate':_0x282b3b,'DRSI':_0x18635f,'TSU':_0x303ff5,'TFU':_0xe2cbe8,'typeOfProducts':_0x86b8d1}),_0x38b377=await _0x2053f7[_0x12f742(0x25e)](),_0x586d3d=_0x38b377[_0x12f742(0x217)][_0x12f742(0x2af)](async _0x545c9d=>{var _0x49c8ee=_0x12f742,_0xdc0984=await warehouse[_0x49c8ee(0x289)]({'name':_0x105927,'room':_0x545c9d[_0x49c8ee(0x2c2)]});if(_0x545c9d['quantity']>0x0){var _0x1ba204=0x0;const _0x2e4184=_0xdc0984[_0x49c8ee(0x1fe)][_0x49c8ee(0x2af)](_0x1993e6=>{var _0xc07918=_0x49c8ee;_0x1993e6[_0xc07918(0x1c1)]==_0x545c9d[_0xc07918(0x1c1)]&&_0x1993e6[_0xc07918(0x18d)]==_0x545c9d[_0xc07918(0x265)]&&_0x1993e6[_0xc07918(0x1a5)]==_0x545c9d[_0xc07918(0x1a5)]&&_0x1993e6[_0xc07918(0x24a)]==_0x545c9d[_0xc07918(0x24a)]&&_0x1993e6[_0xc07918(0x19e)]==_0x545c9d[_0xc07918(0x19e)]&&_0x1993e6[_0xc07918(0x198)]==_0x545c9d[_0xc07918(0x198)]&&(typeof _0x545c9d['id_transaction']==_0xc07918(0x1da)?(console[_0xc07918(0x296)](_0xc07918(0x27a),_0x1993e6[_0xc07918(0x2a2)]+_0xc07918(0x2ae)+_0x1993e6[_0xc07918(0x29c)]+_0xc07918(0x1b6)+Math[_0xc07918(0x1f7)](_0x1993e6[_0xc07918(0x2a2)])+Math['abs'](_0x545c9d[_0xc07918(0x1cf)])),_0x1993e6[_0xc07918(0x2a2)]=Math[_0xc07918(0x1f7)](_0x1993e6[_0xc07918(0x2a2)])+Math[_0xc07918(0x1f7)](_0x545c9d[_0xc07918(0x261)])):(_0x1993e6[_0xc07918(0x2a2)]=Math[_0xc07918(0x1f7)](_0x1993e6[_0xc07918(0x2a2)])+Math[_0xc07918(0x1f7)](_0x545c9d[_0xc07918(0x261)]),_0x1ba204++));});_0x1ba204=='0'&&(_0xdc0984[_0x49c8ee(0x1fe)]=_0xdc0984[_0x49c8ee(0x1fe)][_0x49c8ee(0x1a8)]({'product_name':_0x545c9d[_0x49c8ee(0x1c1)],'product_stock':_0x545c9d[_0x49c8ee(0x261)],'bay':_0x545c9d[_0x49c8ee(0x18d)],'level':_0x545c9d[_0x49c8ee(0x245)],'product_code':_0x545c9d['product_code'],'primary_code':_0x545c9d[_0x49c8ee(0x1e9)],'secondary_code':_0x545c9d['secondary_code'],'expiry_date':_0x545c9d[_0x49c8ee(0x1a5)],'production_date':_0x545c9d[_0x49c8ee(0x24a)],'maxProducts':_0x545c9d[_0x49c8ee(0x29b)],'batch_code':_0x545c9d['batch_code'],'secondary_unit':_0x545c9d[_0x49c8ee(0x286)],'unit':_0x545c9d[_0x49c8ee(0x275)],'maxProducts':_0x545c9d[_0x49c8ee(0x29b)],'maxPerUnit':_0x545c9d[_0x49c8ee(0x2a5)],'invoice':_0x545c9d[_0x49c8ee(0x198)]}));}return _0xdc0984;});Promise[_0x12f742(0x271)](_0x586d3d)[_0x12f742(0x26f)](async _0x2b3a2c=>{var _0x4a67b9=_0x12f742;try{for(const _0x4998fc of _0x2b3a2c){await warehouse[_0x4a67b9(0x26d)]({'_id':_0x4998fc[_0x4a67b9(0x29c)]},{'$addToSet':{'product_details':{'$each':_0x4998fc[_0x4a67b9(0x1fe)]}}});}_0x2867d3[_0x4a67b9(0x284)]=_0x4a67b9(0x281);const _0x34bcb7=await _0x2867d3[_0x4a67b9(0x25e)](),_0x31469e=await master_shop[_0x4a67b9(0x202)](),_0x3562ae=await email_settings[_0x4a67b9(0x289)](),_0x5d08e9=await supervisor_settings[_0x4a67b9(0x202)]();var _0xbb4c1a=_0x2053f7[_0x4a67b9(0x217)],_0x331590='',_0x3805ea;for(_0x3805ea in _0xbb4c1a){var _0x214b7b='FG';_0x2053f7[_0x4a67b9(0x257)]==_0x4a67b9(0x1ed)&&(_0x214b7b='DG'),_0x331590+=_0x4a67b9(0x20c)+_0x4a67b9(0x287)+_0xbb4c1a[_0x3805ea]['product_name']+_0x4a67b9(0x1aa)+_0x4a67b9(0x287)+_0xbb4c1a[_0x3805ea][_0x4a67b9(0x288)]+'</td>'+_0x4a67b9(0x287)+_0xbb4c1a[_0x3805ea][_0x4a67b9(0x1cf)]+_0x4a67b9(0x1aa)+_0x4a67b9(0x287)+_0xbb4c1a[_0x3805ea][_0x4a67b9(0x1d5)]+_0x4a67b9(0x1aa)+_0x4a67b9(0x287)+_0xbb4c1a[_0x3805ea][_0x4a67b9(0x286)]+_0x4a67b9(0x1aa)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2053f7[_0x4a67b9(0x257)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xbb4c1a[_0x3805ea][_0x4a67b9(0x241)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x214b7b+_0xbb4c1a[_0x3805ea][_0x4a67b9(0x265)]+'</td>'+'</tr>';}_0x1aa67e['flash'](_0x4a67b9(0x18b),_0x4a67b9(0x2aa)),_0x510a66[_0x4a67b9(0x23d)]('/picking_list/pdf_puchases_fin_own_trf/'+_0x38b377['_id']);}catch(_0x22a8be){console[_0x4a67b9(0x215)](_0x22a8be),_0x510a66[_0x4a67b9(0x1e0)](0x1f4)[_0x4a67b9(0x1b4)]({'error':_0x4a67b9(0x222)});}})[_0x12f742(0x26c)](_0x507d8a=>{var _0x2f898b=_0x12f742;console[_0x2f898b(0x215)](_0x507d8a),_0x510a66[_0x2f898b(0x1e0)](0x1f4)[_0x2f898b(0x1b4)]({'error':_0x2f898b(0x2b0)});});}catch(_0x57f773){}}),router[a0_0x419498(0x1a9)]('/getTRF',auth,async(_0x344beb,_0x2227ca)=>{var _0x4b64dc=a0_0x419498;try{const {warehouse:_0x5737b6}=_0x344beb[_0x4b64dc(0x1c6)],_0x3c4df8=await transfers_finished[_0x4b64dc(0x202)]({'to_warehouse':_0x5737b6,'to_recieved':_0x4b64dc(0x1b3)});_0x2227ca['json'](_0x3c4df8);}catch(_0x29aa26){}}),router['post']('/getinvoicetrf',auth,async(_0x41cdb1,_0x3c7efa)=>{var _0xaed1c6=a0_0x419498;try{const {invoice:_0x5f4449}=_0x41cdb1[_0xaed1c6(0x1c6)],_0x5e0818=await transfers_finished['find']({'_id':_0x5f4449,'to_recieved':_0xaed1c6(0x1b3)});_0x3c7efa[_0xaed1c6(0x1b4)](_0x5e0818);}catch(_0x55cbf7){}}),router[a0_0x419498(0x2a0)](a0_0x419498(0x1a2),auth,async(_0x22cb8a,_0x486c27)=>{var _0x13cc8e=a0_0x419498;try{const {username:_0x225e68,email:_0x170510,role:_0x54b794}=_0x22cb8a[_0x13cc8e(0x1e8)],_0x32cfea=_0x22cb8a[_0x13cc8e(0x1e8)],_0x43243d=await profile[_0x13cc8e(0x289)]({'email':_0x32cfea[_0x13cc8e(0x231)]}),_0x5033bd=await staff[_0x13cc8e(0x289)]({'email':_0x32cfea[_0x13cc8e(0x231)]});if(_0x32cfea[_0x13cc8e(0x258)]=='staff'){const _0x3d6da6=await staff[_0x13cc8e(0x289)]({'email':_0x32cfea[_0x13cc8e(0x231)]});}const _0x3391ef=await master_shop['find']();let _0x4a791e;if(_0x32cfea['role']==_0x13cc8e(0x27b)){const _0x4cc404=await staff['findOne']({'email':_0x32cfea[_0x13cc8e(0x231)]});_0x4a791e=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x4cc404['warehouse'],'typeOfProducts':_0x13cc8e(0x18f)}},{'$lookup':{'from':_0x13cc8e(0x298),'localField':_0x13cc8e(0x298),'foreignField':_0x13cc8e(0x229),'as':_0x13cc8e(0x2a3)}},{'$unwind':_0x13cc8e(0x199)},{'$unwind':_0x13cc8e(0x264)},{'$group':{'_id':_0x13cc8e(0x28f),'invoice':{'$first':_0x13cc8e(0x1fb)},'suppliers':{'$first':_0x13cc8e(0x1ae)},'date':{'$first':_0x13cc8e(0x297)},'warehouse_name':{'$first':_0x13cc8e(0x1f1)},'room':{'$first':'$room'},'product':{'$push':_0x13cc8e(0x264)},'note':{'$first':_0x13cc8e(0x218)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x13cc8e(0x1ad)},'return_data':{'$first':_0x13cc8e(0x21c)},'batch_code':{'$first':_0x13cc8e(0x2a1)},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':'$suppliers_docs'},'total_product_quantity':{'$sum':_0x13cc8e(0x197)},'level':{'$addToSet':_0x13cc8e(0x2b1)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x13cc8e(0x1bc)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x4a791e=await purchases_finished[_0x13cc8e(0x207)]([{'$match':{'typeOfProducts':_0x13cc8e(0x18f)}},{'$unwind':_0x13cc8e(0x264)},{'$group':{'_id':_0x13cc8e(0x28f),'invoice':{'$first':'$invoice'},'suppliers':{'$first':'$suppliers'},'date':{'$first':_0x13cc8e(0x297)},'warehouse_name':{'$first':_0x13cc8e(0x1f1)},'room':{'$addToSet':_0x13cc8e(0x234)},'product':{'$push':'$product'},'note':{'$first':_0x13cc8e(0x218)},'paid_amount':{'$first':_0x13cc8e(0x22c)},'due_amount':{'$first':_0x13cc8e(0x1ad)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0x13cc8e(0x2a1)},'expiry_date':{'$first':_0x13cc8e(0x293)},'suppliers_docs':{'$first':_0x13cc8e(0x199)},'total_product_quantity':{'$sum':_0x13cc8e(0x197)},'level':{'$addToSet':_0x13cc8e(0x2b1)},'isle':{'$addToSet':_0x13cc8e(0x21a)},'type':{'$addToSet':_0x13cc8e(0x232)},'floorlevel':{'$addToSet':'$product.floorlevel'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);if(_0x3391ef[0x0]['language']=='English\x20(US)')var _0x5dd48c=users['English'];else{if(_0x3391ef[0x0][_0x13cc8e(0x259)]=='Hindi')var _0x5dd48c=users[_0x13cc8e(0x1af)];else{if(_0x3391ef[0x0][_0x13cc8e(0x259)]==_0x13cc8e(0x266))var _0x5dd48c=users[_0x13cc8e(0x266)];else{if(_0x3391ef[0x0][_0x13cc8e(0x259)]==_0x13cc8e(0x209))var _0x5dd48c=users[_0x13cc8e(0x209)];else{if(_0x3391ef[0x0][_0x13cc8e(0x259)]==_0x13cc8e(0x256))var _0x5dd48c=users['French'];else{if(_0x3391ef[0x0][_0x13cc8e(0x259)]=='Portuguese\x20(BR)')var _0x5dd48c=users[_0x13cc8e(0x2a7)];else{if(_0x3391ef[0x0][_0x13cc8e(0x259)]==_0x13cc8e(0x188))var _0x5dd48c=users['Chinese'];else{if(_0x3391ef[0x0][_0x13cc8e(0x259)]=='Arabic\x20(ae)')var _0x5dd48c=users[_0x13cc8e(0x2c4)];}}}}}}}_0x486c27[_0x13cc8e(0x242)]('all_purchases_finished',{'success':_0x22cb8a[_0x13cc8e(0x206)](_0x13cc8e(0x18b)),'errors':_0x22cb8a[_0x13cc8e(0x206)](_0x13cc8e(0x24c)),'purchases':_0x4a791e,'role':_0x32cfea,'profile':_0x43243d,'master_shop':_0x3391ef,'language':_0x5dd48c});}catch(_0x3bab21){console['log'](_0x13cc8e(0x270),_0x3bab21),_0x486c27[_0x13cc8e(0x1e0)](0xc8)[_0x13cc8e(0x1b4)]({'message':_0x3bab21[_0x13cc8e(0x291)]});}}),router['get'](a0_0x419498(0x1b1),auth,async(_0xaafdf7,_0x2e1c67)=>{var _0x310ca1=a0_0x419498;try{const {username:_0x1c0b80,email:_0x373b0b,role:_0x520e0e}=_0xaafdf7[_0x310ca1(0x1e8)],_0x57247b=_0xaafdf7[_0x310ca1(0x1e8)],_0x389970=await profile[_0x310ca1(0x289)]({'email':_0x57247b[_0x310ca1(0x231)]}),_0x5c1482=await staff[_0x310ca1(0x289)]({'email':_0x57247b[_0x310ca1(0x231)]});if(_0x57247b[_0x310ca1(0x258)]==_0x310ca1(0x27b)){const _0x20fae7=await staff[_0x310ca1(0x289)]({'email':_0x57247b['email']});}const _0x4bb58a=await master_shop[_0x310ca1(0x202)]();let _0x2f38bf;if(_0x57247b[_0x310ca1(0x258)]==_0x310ca1(0x27b)){const _0x51eb80=await staff['findOne']({'email':_0x57247b[_0x310ca1(0x231)]});_0x2f38bf=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x51eb80[_0x310ca1(0x240)]}},{'$lookup':{'from':_0x310ca1(0x298),'localField':_0x310ca1(0x298),'foreignField':_0x310ca1(0x229),'as':_0x310ca1(0x2a3)}},{'$unwind':'$suppliers_docs'},{'$unwind':_0x310ca1(0x264)},{'$group':{'_id':'$_id','invoice':{'$first':_0x310ca1(0x1fb)},'suppliers':{'$first':_0x310ca1(0x1ae)},'date':{'$first':_0x310ca1(0x297)},'warehouse_name':{'$first':_0x310ca1(0x1f1)},'room':{'$first':_0x310ca1(0x2c3)},'product':{'$push':_0x310ca1(0x264)},'note':{'$first':'$note'},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x310ca1(0x1ad)},'return_data':{'$first':_0x310ca1(0x21c)},'batch_code':{'$first':_0x310ca1(0x2a1)},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':_0x310ca1(0x199)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x310ca1(0x2b1)},'isle':{'$addToSet':_0x310ca1(0x21a)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x310ca1(0x1bc)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x2f38bf=await purchases_finished['aggregate']([{'$match':{'typeOfProducts':'logs'}},{'$unwind':_0x310ca1(0x264)},{'$group':{'_id':_0x310ca1(0x28f),'invoice':{'$first':'$invoice'},'suppliers':{'$first':_0x310ca1(0x1ae)},'date':{'$first':_0x310ca1(0x297)},'warehouse_name':{'$first':_0x310ca1(0x1f1)},'room':{'$addToSet':_0x310ca1(0x234)},'product':{'$push':_0x310ca1(0x264)},'note':{'$first':_0x310ca1(0x218)},'paid_amount':{'$first':_0x310ca1(0x22c)},'due_amount':{'$first':_0x310ca1(0x1ad)},'return_data':{'$first':_0x310ca1(0x21c)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':_0x310ca1(0x293)},'suppliers_docs':{'$first':_0x310ca1(0x199)},'total_product_quantity':{'$sum':_0x310ca1(0x197)},'level':{'$addToSet':_0x310ca1(0x2b1)},'isle':{'$addToSet':_0x310ca1(0x21a)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x310ca1(0x1bc)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);if(_0x4bb58a[0x0][_0x310ca1(0x259)]=='English\x20(US)')var _0x1c7415=users[_0x310ca1(0x272)];else{if(_0x4bb58a[0x0]['language']==_0x310ca1(0x1af))var _0x1c7415=users[_0x310ca1(0x1af)];else{if(_0x4bb58a[0x0][_0x310ca1(0x259)]==_0x310ca1(0x266))var _0x1c7415=users[_0x310ca1(0x266)];else{if(_0x4bb58a[0x0][_0x310ca1(0x259)]==_0x310ca1(0x209))var _0x1c7415=users[_0x310ca1(0x209)];else{if(_0x4bb58a[0x0][_0x310ca1(0x259)]==_0x310ca1(0x256))var _0x1c7415=users['French'];else{if(_0x4bb58a[0x0][_0x310ca1(0x259)]==_0x310ca1(0x1d4))var _0x1c7415=users[_0x310ca1(0x2a7)];else{if(_0x4bb58a[0x0]['language']==_0x310ca1(0x188))var _0x1c7415=users[_0x310ca1(0x188)];else{if(_0x4bb58a[0x0][_0x310ca1(0x259)]==_0x310ca1(0x189))var _0x1c7415=users[_0x310ca1(0x2c4)];}}}}}}}_0x2e1c67['render'](_0x310ca1(0x280),{'success':_0xaafdf7['flash'](_0x310ca1(0x18b)),'errors':_0xaafdf7[_0x310ca1(0x206)](_0x310ca1(0x24c)),'purchases':_0x2f38bf,'role':_0x57247b,'profile':_0x389970,'master_shop':_0x4bb58a,'language':_0x1c7415});}catch(_0x49083e){console[_0x310ca1(0x296)](_0x310ca1(0x270),_0x49083e),_0x2e1c67[_0x310ca1(0x1e0)](0xc8)[_0x310ca1(0x1b4)]({'message':_0x49083e[_0x310ca1(0x291)]});}});function BayBinSelected(_0xf13f42,_0x531620){var _0x5695f8=a0_0x419498,_0x31f778=[],_0x1e3ca7=[];if(_0xf13f42=='DRY\x20GOODS'){switch(_0x531620){case'Rack\x201':_0x31f778=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x5695f8(0x2be):_0x31f778=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x1e3ca7=['DG'];}else{if(_0xf13f42==_0x5695f8(0x18e)){switch(_0x531620){case _0x5695f8(0x239):_0x31f778=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x5695f8(0x2be):_0x31f778=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x1e3ca7=['FG'];}}return{'levels':_0x31f778,'identify':_0x1e3ca7};}async function getRandom8DigitNumber(){var _0x5ed811=a0_0x419498;const _0x437568=0x989680,_0x1ee7e4=0x5f5e0ff,_0x37d63e=Math['floor'](Math['random']()*(_0x1ee7e4-_0x437568+0x1))+_0x437568;var _0x1e9018;const _0xa8b32=await purchases_finished[_0x5ed811(0x289)]({'invoice':'INCF-'+_0x37d63e});return _0xa8b32&&_0xa8b32[_0x5ed811(0x21d)]>0x0?_0x1e9018=_0x5ed811(0x205)+_0x37d63e:_0x1e9018=_0x5ed811(0x205)+_0x37d63e,_0x1e9018;}router['get']('/view/add_purchases',auth,async(_0x28d963,_0x1e5d16)=>{var _0x5926e3=a0_0x419498;try{const {username:_0x29c08e,email:_0x320f71,role:_0x32bb52}=_0x28d963[_0x5926e3(0x1e8)],_0x3fa242=_0x28d963[_0x5926e3(0x1e8)],_0x30c55d=await profile['findOne']({'email':_0x3fa242[_0x5926e3(0x231)]}),_0x1fdd5c=await master_shop[_0x5926e3(0x202)](),_0x1e5a1a=await staff[_0x5926e3(0x289)]({'email':_0x3fa242[_0x5926e3(0x231)]}),_0x56f032=await suppliers['find']({});let _0x38a059;if(_0x3fa242[_0x5926e3(0x258)]=='staff'){const _0x31b9a2=await staff[_0x5926e3(0x289)]({'email':_0x3fa242['email']});_0x38a059=await warehouse[_0x5926e3(0x207)]([{'$match':{'status':_0x5926e3(0x191),'name':_0x31b9a2[_0x5926e3(0x240)]}},{'$group':{'_id':_0x5926e3(0x224),'name':{'$first':_0x5926e3(0x224)}}}]);}else _0x38a059=await warehouse[_0x5926e3(0x207)]([{'$match':{'status':_0x5926e3(0x191)}},{'$group':{'_id':_0x5926e3(0x224),'name':{'$first':'$name'}}}]);const _0x283b32=await product['find']({}),_0x332213=await warehouse[_0x5926e3(0x202)]({'status':_0x5926e3(0x191)}),_0x56dd46=await purchases_finished['find']({}),_0x5c1866=_0x56dd46[_0x5926e3(0x21d)]+0x1,_0x324e9a=_0x5926e3(0x205)+_0x5c1866[_0x5926e3(0x273)]()[_0x5926e3(0x24d)](0x5,'0');var _0x463631=[_0x5926e3(0x22f),'Enclosed'];if(_0x1fdd5c[0x0][_0x5926e3(0x259)]==_0x5926e3(0x29a))var _0x4e8628=users[_0x5926e3(0x272)];else{if(_0x1fdd5c[0x0]['language']==_0x5926e3(0x1af))var _0x4e8628=users[_0x5926e3(0x1af)];else{if(_0x1fdd5c[0x0][_0x5926e3(0x259)]==_0x5926e3(0x266))var _0x4e8628=users['German'];else{if(_0x1fdd5c[0x0][_0x5926e3(0x259)]==_0x5926e3(0x209))var _0x4e8628=users[_0x5926e3(0x209)];else{if(_0x1fdd5c[0x0]['language']==_0x5926e3(0x256))var _0x4e8628=users['French'];else{if(_0x1fdd5c[0x0][_0x5926e3(0x259)]==_0x5926e3(0x1d4))var _0x4e8628=users[_0x5926e3(0x2a7)];else{if(_0x1fdd5c[0x0][_0x5926e3(0x259)]==_0x5926e3(0x188))var _0x4e8628=users[_0x5926e3(0x188)];else{if(_0x1fdd5c[0x0]['language']==_0x5926e3(0x189))var _0x4e8628=users[_0x5926e3(0x2c4)];}}}}}}}const _0xcffd26=getRandom8DigitNumber(),_0x2211ad=new Date(),_0x14dffb={'year':'numeric','month':_0x5926e3(0x1a7),'day':_0x5926e3(0x1a7),'timeZone':'Asia/Manila'},_0x48f543=_0x2211ad['toLocaleDateString']('en-CA',_0x14dffb);console[_0x5926e3(0x296)](_0x48f543),_0xcffd26[_0x5926e3(0x26f)](_0x15cb76=>{var _0x28046a=_0x5926e3;_0x1e5d16[_0x28046a(0x242)](_0x28046a(0x203),{'success':_0x28d963[_0x28046a(0x206)]('success'),'errors':_0x28d963[_0x28046a(0x206)]('errors'),'role':_0x3fa242,'profile':_0x30c55d,'suppliers':_0x56f032,'warehouse':_0x38a059,'product':_0x283b32,'invoice':_0x15cb76,'master_shop':_0x1fdd5c,'language':_0x4e8628,'find_data':_0x332213,'rooms_data':_0x463631,'formattedDate':_0x48f543});})[_0x5926e3(0x26c)](_0x586fdf=>{var _0x1a3595=_0x5926e3;_0x28d963['flash'](_0x1a3595(0x24c),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1e5d16[_0x1a3595(0x23d)](_0x1a3595(0x1f2));});}catch(_0x304963){console[_0x5926e3(0x296)](_0x304963);}}),router[a0_0x419498(0x2a0)](a0_0x419498(0x276),auth,async(_0x29d075,_0x3c43e6)=>{var _0x5c1a9e=a0_0x419498;try{const {username:_0x306f3e,email:_0x1414db,role:_0x5498d6}=_0x29d075[_0x5c1a9e(0x1e8)],_0x55f923=_0x29d075[_0x5c1a9e(0x1e8)],_0x37a6a9=await profile[_0x5c1a9e(0x289)]({'email':_0x55f923[_0x5c1a9e(0x231)]}),_0x7349d9=await master_shop[_0x5c1a9e(0x202)](),_0x570162=await staff[_0x5c1a9e(0x289)]({'email':_0x55f923[_0x5c1a9e(0x231)]}),_0x1a64b9=await suppliers[_0x5c1a9e(0x202)]({});let _0x2a3362;if(_0x55f923['role']==_0x5c1a9e(0x27b)){const _0x82b4c3=await staff[_0x5c1a9e(0x289)]({'email':_0x55f923[_0x5c1a9e(0x231)]});_0x2a3362=await warehouse['aggregate']([{'$match':{'status':_0x5c1a9e(0x191),'name':_0x82b4c3[_0x5c1a9e(0x240)]}},{'$group':{'_id':_0x5c1a9e(0x224),'name':{'$first':_0x5c1a9e(0x224)}}}]);}else _0x2a3362=await warehouse[_0x5c1a9e(0x207)]([{'$match':{'status':_0x5c1a9e(0x191)}},{'$group':{'_id':_0x5c1a9e(0x224),'name':{'$first':'$name'}}}]);const _0x4e3f18=await product[_0x5c1a9e(0x202)]({}),_0x1a286d=await warehouse['find']({'status':_0x5c1a9e(0x191)}),_0x589235=await purchases_finished[_0x5c1a9e(0x202)]({}),_0x280c1b=_0x589235[_0x5c1a9e(0x21d)]+0x1,_0x43c58f=_0x5c1a9e(0x205)+_0x280c1b['toString']()[_0x5c1a9e(0x24d)](0x5,'0');var _0x4e1d08=[_0x5c1a9e(0x22f),_0x5c1a9e(0x1eb)];if(_0x7349d9[0x0][_0x5c1a9e(0x259)]==_0x5c1a9e(0x29a))var _0xf519a0=users['English'];else{if(_0x7349d9[0x0][_0x5c1a9e(0x259)]=='Hindi')var _0xf519a0=users[_0x5c1a9e(0x1af)];else{if(_0x7349d9[0x0][_0x5c1a9e(0x259)]==_0x5c1a9e(0x266))var _0xf519a0=users[_0x5c1a9e(0x266)];else{if(_0x7349d9[0x0][_0x5c1a9e(0x259)]=='Spanish')var _0xf519a0=users[_0x5c1a9e(0x209)];else{if(_0x7349d9[0x0][_0x5c1a9e(0x259)]==_0x5c1a9e(0x256))var _0xf519a0=users[_0x5c1a9e(0x256)];else{if(_0x7349d9[0x0]['language']==_0x5c1a9e(0x1d4))var _0xf519a0=users['Portuguese'];else{if(_0x7349d9[0x0][_0x5c1a9e(0x259)]==_0x5c1a9e(0x188))var _0xf519a0=users[_0x5c1a9e(0x188)];else{if(_0x7349d9[0x0][_0x5c1a9e(0x259)]==_0x5c1a9e(0x189))var _0xf519a0=users[_0x5c1a9e(0x2c4)];}}}}}}}const _0x34c660=getRandom8DigitNumber();_0x34c660[_0x5c1a9e(0x26f)](_0x448412=>{var _0x3cddad=_0x5c1a9e;_0x3c43e6[_0x3cddad(0x242)](_0x3cddad(0x29e),{'success':_0x29d075[_0x3cddad(0x206)](_0x3cddad(0x18b)),'errors':_0x29d075[_0x3cddad(0x206)](_0x3cddad(0x24c)),'role':_0x55f923,'profile':_0x37a6a9,'suppliers':_0x1a64b9,'warehouse':_0x2a3362,'product':_0x4e3f18,'invoice':_0x448412,'master_shop':_0x7349d9,'language':_0xf519a0,'find_data':_0x1a286d,'rooms_data':_0x4e1d08});})['catch'](_0x47c149=>{var _0x54811f=_0x5c1a9e;_0x29d075[_0x54811f(0x206)]('errors',_0x54811f(0x193)),_0x3c43e6[_0x54811f(0x23d)]('/all_purchases_finished/view');});}catch(_0x299e9e){console[_0x5c1a9e(0x296)](_0x299e9e);}}),router['get'](a0_0x419498(0x221),auth,async(_0x5b1a57,_0x4e973a)=>{var _0x12c493=a0_0x419498;try{const _0x1fad0d=_0x5b1a57[_0x12c493(0x233)]['id'];console[_0x12c493(0x296)](_0x1fad0d);const _0x5ec7e3=await master_shop[_0x12c493(0x202)]();console[_0x12c493(0x296)]('master',_0x5ec7e3);const _0x32fec9=await product[_0x12c493(0x289)]({'name':_0x1fad0d});console['log']('product',_0x32fec9),_0x4e973a[_0x12c493(0x1e0)](0xc8)[_0x12c493(0x1b4)]({'product_data':_0x32fec9,'master':_0x5ec7e3});}catch(_0x4b30e6){console[_0x12c493(0x296)](_0x12c493(0x2b5),_0x4b30e6);}}),router['post'](a0_0x419498(0x22b),auth,async(_0x191648,_0xdfa67b)=>{var _0x51366d=a0_0x419498;try{const {invoice:_0x574062,date:_0xb25de1,warehouse_name:_0x54b730,prod_name:_0x1e7401,note:_0x4fa7c5,due_amount:_0x5c2fd1,Room_name:_0x1dc07f,PO_number:_0x362a9c,SCRN:_0x13cb56,ReqBy:_0x37250a,dateofreq:_0x5be96a,suppliers:_0x2b4040,typeservicesData:_0x23c031,van:_0x329c10,typevehicle:_0xb03b70,driver:_0x347c96,plate:_0x9bb51e,DRSI:_0x594943,TSU:_0x57b8c6,TFU:_0x350b23,JO_number:_0x1116bc,type_of_products:_0x5d8841}=_0x191648[_0x51366d(0x1c6)];if(typeof _0x1e7401==_0x51366d(0x227))var _0x4bae04=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x237)]],_0x4bd55f=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x1d3)]],_0x3fdc51=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x262)]],_0x5c77eb=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x2b7)]],_0x2e8c61=[_0x191648[_0x51366d(0x1c6)]['prod_secondunit']],_0x3d0c72=[_0x191648['body']['prod_level']],_0xffc58d=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x1e9)]],_0x1255db=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x195)]],_0x383b16=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x290)]],_0x9e0e29=[_0x191648[_0x51366d(0x1c6)]['batch_code']],_0x5adbf3=[_0x191648['body'][_0x51366d(0x1a5)]],_0x73a09c=[_0x191648['body'][_0x51366d(0x2a4)]],_0x2dd401=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x294)]],_0x203279=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x236)]],_0x45d15c=[_0x191648['body'][_0x51366d(0x214)]],_0x48bc4e=[_0x191648[_0x51366d(0x1c6)]['gross_price']],_0x556c1b=[_0x191648['body'][_0x51366d(0x1cd)]],_0x54fdda=[_0x191648[_0x51366d(0x1c6)]['sales_data_cateory']],_0x32555a=[_0x191648[_0x51366d(0x1c6)][_0x51366d(0x1e4)]];else var _0x4bae04=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x237)]],_0x4bd55f=[..._0x191648[_0x51366d(0x1c6)]['prod_code']],_0x3fdc51=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x262)]],_0x5c77eb=[..._0x191648['body'][_0x51366d(0x2b7)]],_0x2e8c61=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x21e)]],_0x3d0c72=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x21f)]],_0xffc58d=[..._0x191648['body']['primary_code']],_0x1255db=[..._0x191648['body'][_0x51366d(0x195)]],_0x383b16=[..._0x191648['body'][_0x51366d(0x290)]],_0x9e0e29=[..._0x191648[_0x51366d(0x1c6)]['batch_code']],_0x5adbf3=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x1a5)]],_0x73a09c=[..._0x191648['body'][_0x51366d(0x2a4)]],_0x2dd401=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x294)]],_0x203279=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x236)]],_0x45d15c=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x214)]],_0x48bc4e=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x23b)]],_0x556c1b=[..._0x191648['body'][_0x51366d(0x1cd)]],_0x54fdda=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x29f)]],_0x32555a=[..._0x191648[_0x51366d(0x1c6)][_0x51366d(0x1e4)]];const _0x2dea79=_0x4bae04[_0x51366d(0x2af)](_0x35ddac=>{return _0x35ddac={'product_name':_0x35ddac};});_0x32555a[_0x51366d(0x1f8)]((_0x38effa,_0x2c17f1)=>{var _0x564548=_0x51366d;_0x2dea79[_0x2c17f1][_0x564548(0x1e4)]=_0x38effa,_0x2dea79[_0x2c17f1][_0x564548(0x27d)]=_0xb25de1;}),_0x54fdda[_0x51366d(0x1f8)]((_0x12ed31,_0x4d7023)=>{var _0x479fb1=_0x51366d;_0x2dea79[_0x4d7023][_0x479fb1(0x20f)]=_0x12ed31;}),_0x4bd55f[_0x51366d(0x1f8)]((_0x227a5b,_0x106575)=>{_0x2dea79[_0x106575]['product_code']=_0x227a5b;}),_0x556c1b[_0x51366d(0x1f8)]((_0x2ce752,_0x3f9561)=>{_0x2dea79[_0x3f9561]['uuid']=_0x2ce752;}),_0x3fdc51[_0x51366d(0x1f8)]((_0x4e86ce,_0x32b14d)=>{var _0x2900e6=_0x51366d;_0x2dea79[_0x32b14d]['quantity']=Math[_0x2900e6(0x1f7)](_0x4e86ce);}),_0x5c77eb[_0x51366d(0x1f8)]((_0x10eef2,_0x3ae030)=>{_0x2dea79[_0x3ae030]['standard_unit']=_0x10eef2;}),_0x2e8c61['forEach']((_0x3c52e7,_0x3d58e3)=>{var _0x107693=_0x51366d;_0x2dea79[_0x3d58e3][_0x107693(0x286)]=_0x3c52e7;}),_0xffc58d[_0x51366d(0x1f8)]((_0x195e5a,_0x5f1652)=>{var _0x2daf11=_0x51366d;_0x2dea79[_0x5f1652][_0x2daf11(0x1e9)]=_0x195e5a;}),_0x1255db['forEach']((_0x46c5fa,_0xb9203a)=>{var _0x5486e=_0x51366d;_0x2dea79[_0xb9203a][_0x5486e(0x195)]=_0x46c5fa;}),_0x383b16[_0x51366d(0x1f8)]((_0x28088e,_0x15487f)=>{var _0x44929a=_0x51366d;_0x2dea79[_0x15487f][_0x44929a(0x1ac)]=_0x28088e;}),_0x9e0e29[_0x51366d(0x1f8)]((_0x382031,_0x179c49)=>{var _0xc43e37=_0x51366d;_0x2dea79[_0x179c49][_0xc43e37(0x19e)]=_0x382031;}),_0x5adbf3[_0x51366d(0x1f8)]((_0x4946c0,_0x5626c6)=>{var _0x45cd3f=_0x51366d;_0x2dea79[_0x5626c6][_0x45cd3f(0x1a5)]=_0x4946c0;}),_0x73a09c[_0x51366d(0x1f8)]((_0x275f01,_0x5303f2)=>{_0x2dea79[_0x5303f2]['production_date']=_0x275f01;}),_0x2dd401[_0x51366d(0x1f8)]((_0x4a3f2c,_0x4a9c5e)=>{_0x2dea79[_0x4a9c5e]['maxperunit']=_0x4a3f2c;}),_0x203279[_0x51366d(0x1f8)]((_0x4b041c,_0x580cf6)=>{var _0x117dc8=_0x51366d;_0x2dea79[_0x580cf6][_0x117dc8(0x1be)]=_0x4b041c;}),_0x45d15c[_0x51366d(0x1f8)]((_0x360e1d,_0x3e56e5)=>{var _0x5cded3=_0x51366d;_0x2dea79[_0x3e56e5][_0x5cded3(0x2c2)]=_0x360e1d;}),_0x48bc4e[_0x51366d(0x1f8)]((_0x54ed83,_0x3de47d)=>{var _0x4af309=_0x51366d;_0x2dea79[_0x3de47d][_0x4af309(0x23b)]=_0x54ed83;});const _0x255234=new invoice_for_incoming();await _0x255234[_0x51366d(0x25e)]();for(let _0x5ca492=0x0;_0x5ca492<=_0x45d15c['length']-0x1;_0x5ca492++){_0x2dea79[_0x5ca492][_0x51366d(0x198)]=_0x51366d(0x1b9)+_0x255234['invoice_init']['toString']()['padStart'](0x8,'0');}const _0x12db44=await warehouse_validation_setup[_0x51366d(0x207)]([{'$match':{'warehouse_name':_0x54b730}}]);let _0x9bc940=[];for(let _0xd77249=0x0;_0xd77249<=_0x2dea79[_0x51366d(0x21d)]-0x1;_0xd77249++){const _0x13902c=_0x2dea79[_0xd77249];for(let _0x2e4dc3=0x0;_0x2e4dc3<=_0x12db44[_0x51366d(0x21d)]-0x1;_0x2e4dc3++){const _0x1a5f94=_0x12db44[_0x2e4dc3];for(let _0x5a319d=0x0;_0x5a319d<=_0x1a5f94[_0x51366d(0x26a)]['length']-0x1;_0x5a319d++){const _0x2301a7=_0x1a5f94[_0x51366d(0x26a)][_0x5a319d];if(_0x2301a7[_0x51366d(0x288)]===_0x13902c[_0x51366d(0x288)]){let _0x23000a=_0x13902c[_0x51366d(0x261)];const _0x114999=await warehouse['aggregate']([{'$match':{'name':_0x54b730,'room':_0x1a5f94['room']}},{'$unwind':_0x51366d(0x1a3)},{'$match':{'level':_0x2301a7['bay'],'bay':_0x2301a7[_0x51366d(0x299)]}}]);if(_0x114999[_0x51366d(0x21d)]==0x0){for(let _0x5d0793=0x0;_0x5d0793<=_0x1a5f94[_0x51366d(0x26a)][_0x51366d(0x21d)]-0x1&&_0x23000a>0x0;_0x5d0793++){const _0xb0e7d3=_0x1a5f94[_0x51366d(0x26a)][_0x5d0793];if(_0x13902c['product_code']===_0xb0e7d3[_0x51366d(0x288)]){_0x9bc940[_0x5d0793]={};const _0x598508=parseInt(_0xb0e7d3[_0x51366d(0x253)]),_0x3d73b7=0x0;let _0x72bafc=_0x598508-_0x3d73b7,_0x3c922b=Math['min'](_0x23000a,_0x72bafc);console[_0x51366d(0x296)](_0x51366d(0x26e)+_0x3c922b+_0x51366d(0x2bd)+_0x1a5f94[_0x51366d(0x213)]+_0x51366d(0x1f4)+_0x1a5f94['room']+_0x51366d(0x20d)+_0xb0e7d3[_0x51366d(0x18d)]+_0x51366d(0x2ba)+_0xb0e7d3[_0x51366d(0x299)]),_0x9bc940[_0x5d0793][_0x51366d(0x1c1)]=_0x13902c[_0x51366d(0x1c1)],_0x9bc940[_0x5d0793][_0x51366d(0x288)]=_0x13902c['product_code'],_0x9bc940[_0x5d0793][_0x51366d(0x1e4)]=_0x13902c[_0x51366d(0x1e4)],_0x9bc940[_0x5d0793][_0x51366d(0x27d)]=_0x13902c[_0x51366d(0x27d)],_0x9bc940[_0x5d0793][_0x51366d(0x20f)]=_0x13902c[_0x51366d(0x20f)],_0x9bc940[_0x5d0793][_0x51366d(0x1cd)]=_0x13902c[_0x51366d(0x1cd)],_0x9bc940[_0x5d0793]['quantity']=_0x3c922b,_0x9bc940[_0x5d0793][_0x51366d(0x275)]=_0x13902c[_0x51366d(0x275)],_0x9bc940[_0x5d0793][_0x51366d(0x286)]=_0x13902c['secondary_unit'],_0x9bc940[_0x5d0793]['primary_code']=_0x13902c[_0x51366d(0x1e9)],_0x9bc940[_0x5d0793]['secondary_code']=_0x13902c[_0x51366d(0x195)],_0x9bc940[_0x5d0793][_0x51366d(0x1ac)]=_0x13902c[_0x51366d(0x1ac)],_0x9bc940[_0x5d0793]['batch_code']=_0x13902c['batch_code'],_0x9bc940[_0x5d0793][_0x51366d(0x1a5)]=_0x13902c['expiry_date'],_0x9bc940[_0x5d0793]['production_date']=_0x13902c[_0x51366d(0x24a)],_0x9bc940[_0x5d0793][_0x51366d(0x201)]=_0x13902c[_0x51366d(0x201)],_0x9bc940[_0x5d0793][_0x51366d(0x1be)]=_0x13902c[_0x51366d(0x1be)],_0x9bc940[_0x5d0793][_0x51366d(0x198)]=_0x13902c[_0x51366d(0x198)],_0x9bc940[_0x5d0793][_0x51366d(0x23b)]=_0x13902c[_0x51366d(0x23b)],_0x9bc940[_0x5d0793]['room_name']=_0x1a5f94[_0x51366d(0x1dd)],_0x9bc940[_0x5d0793][_0x51366d(0x245)]=_0xb0e7d3[_0x51366d(0x18d)],_0x9bc940[_0x5d0793][_0x51366d(0x18d)]=_0xb0e7d3[_0x51366d(0x299)],_0x23000a-=_0x3c922b;if(_0x23000a<=0x0)break;}}if(_0x23000a<=0x0)break;_0x23000a>0x0&&console['log'](_0x51366d(0x26b)+_0x23000a+'\x20units\x20left\x20that\x20couldn\x27t\x20be\x20placed\x20in\x20any\x20bin.');}}}}}const _0x47cbca=_0x9bc940[_0x51366d(0x2a6)]((_0xd6fa0,_0x229799)=>{if(_0x229799>0x0)return{'item':_0xd6fa0};}),_0x5c1173=_0x47cbca[_0x51366d(0x2a6)](_0x53506b=>_0x53506b[_0x51366d(0x261)]!=='0'&&_0x53506b[_0x51366d(0x261)]!==''),_0x5cc9dd=new purchases_finished({'invoice':_0x51366d(0x1b9)+_0x255234[_0x51366d(0x29d)][_0x51366d(0x273)]()[_0x51366d(0x24d)](0x8,'0'),'suppliers':_0x2b4040,'date':_0xb25de1,'warehouse_name':_0x54b730,'product':_0x5c1173,'note':_0x4fa7c5,'due_amount':_0x5c2fd1,'room':_0x1dc07f,'POnumber':_0x362a9c,'SCRN':_0x13cb56,'JO_number':_0x1116bc,'ReqBy':_0x37250a,'dateofreq':_0x5be96a,'typeservicesData':_0x23c031,'van':_0x329c10,'typevehicle':_0xb03b70,'driver':_0x347c96,'plate':_0x9bb51e,'DRSI':_0x594943,'TSU':_0x57b8c6,'TFU':_0x350b23,'typeOfProducts':_0x5d8841}),_0x530d7e=await _0x5cc9dd[_0x51366d(0x25e)](),_0x548f71=await purchases_finished[_0x51366d(0x289)]({'_id':_0x530d7e[_0x51366d(0x29c)]['valueOf']()});_0x191648['flash'](_0x51366d(0x18b),_0x51366d(0x1f9)),_0xdfa67b[_0x51366d(0x23d)](_0x51366d(0x19d)+_0x548f71['_id'][_0x51366d(0x23c)]());}catch(_0x437133){console['log'](_0x437133);}}),router[a0_0x419498(0x2a0)](a0_0x419498(0x25b),auth,async(_0x14a1f2,_0x38f867)=>{var _0x3cc904=a0_0x419498;try{const {username:_0x97ccbb,email:_0x1642a2,role:_0xcc9c43}=_0x14a1f2[_0x3cc904(0x1e8)],_0x1d2c7b=_0x14a1f2['user'],_0x4e34f8=_0x14a1f2[_0x3cc904(0x233)]['id'],_0x3720c5=await profile['findOne']({'email':_0x1d2c7b[_0x3cc904(0x231)]}),_0x2add9b=await master_shop[_0x3cc904(0x202)](),_0x103a09=await staff['findOne']({'email':_0x1d2c7b[_0x3cc904(0x231)]}),_0x15fb50=await suppliers[_0x3cc904(0x202)]({});let _0x223a32;if(_0x1d2c7b[_0x3cc904(0x258)]==_0x3cc904(0x27b)){const _0x3192ac=await staff[_0x3cc904(0x289)]({'email':_0x1d2c7b[_0x3cc904(0x231)]});_0x223a32=await warehouse[_0x3cc904(0x207)]([{'$match':{'status':_0x3cc904(0x191),'name':_0x3192ac[_0x3cc904(0x240)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x223a32=await warehouse['aggregate']([{'$match':{'status':_0x3cc904(0x191)}},{'$group':{'_id':_0x3cc904(0x224),'name':{'$first':_0x3cc904(0x224)}}}]);const _0x379068=await purchases_finished[_0x3cc904(0x238)](_0x4e34f8);if(_0x2add9b[0x0][_0x3cc904(0x259)]=='English\x20(US)')var _0x1675ee=users[_0x3cc904(0x272)];else{if(_0x2add9b[0x0][_0x3cc904(0x259)]=='Hindi')var _0x1675ee=users[_0x3cc904(0x1af)];else{if(_0x2add9b[0x0][_0x3cc904(0x259)]==_0x3cc904(0x266))var _0x1675ee=users[_0x3cc904(0x266)];else{if(_0x2add9b[0x0][_0x3cc904(0x259)]=='Spanish')var _0x1675ee=users[_0x3cc904(0x209)];else{if(_0x2add9b[0x0][_0x3cc904(0x259)]==_0x3cc904(0x256))var _0x1675ee=users[_0x3cc904(0x256)];else{if(_0x2add9b[0x0][_0x3cc904(0x259)]==_0x3cc904(0x1d4))var _0x1675ee=users[_0x3cc904(0x2a7)];else{if(_0x2add9b[0x0][_0x3cc904(0x259)]=='Chinese')var _0x1675ee=users['Chinese'];else{if(_0x2add9b[0x0][_0x3cc904(0x259)]==_0x3cc904(0x189))var _0x1675ee=users[_0x3cc904(0x2c4)];}}}}}}}_0x38f867[_0x3cc904(0x242)](_0x3cc904(0x1b7),{'success':_0x14a1f2[_0x3cc904(0x206)](_0x3cc904(0x18b)),'errors':_0x14a1f2[_0x3cc904(0x206)](_0x3cc904(0x24c)),'role':_0x1d2c7b,'profile':_0x3720c5,'suppliers':_0x15fb50,'warehouse':_0x223a32,'master_shop':_0x2add9b,'language':_0x1675ee,'purchases_data':_0x379068});}catch(_0x12c1a5){console[_0x3cc904(0x296)](_0x12c1a5);}});function a0_0x595c(){var _0x571bd9=['due_amount','gross_price','valueOf','redirect','\x20</h2>','<h2>\x20','warehouse','to_room_name','render','$secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','level','/barcode_scanner_logs','$product_details.storage','incoming_view','site_title','production_date','getDate','errors','padStart','Error\x20Occurs','$product_details.product_name','createTransport','POnumber','$product_details.product_stock','max','/barcode/:id','399781yWAenP','French','to_warehouse','role','language','Purchase\x20Mail','/process/:id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','master','save','2125584xXDHta','payment\x20successfull','quantity','prod_Qty','ejs','$product','to_bay','German','3010596mxOpnT','stocks','exports','product_data','There\x20is\x20','catch','updateOne','Distributing\x20','then','table\x20page','all','English','toString','express','standard_unit','/view/add_purchases_logs','JO_number','currency','13110705JWAbWA','here2','staff','</thead>','date_recieved','$alertquantity','<html><head><title></title>','all_purchases_finished_logs','true','/incoming/add','2043056vypKIX','to_recieved','Email\x20sent\x20successfully','secondary_unit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_code','findOne','Room_name','image','purchase_invoice','/upload/','stock_quantity','$_id','MaxStocks_data','message','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','$expiry_date','max_product_unit','/all_purchases_finished/preview/','log','$date','suppliers','bin','English\x20(US)','maxProducts','_id','invoice_init','add_purchases_finished_logs','sales_data_cateory','get','$batch_code','product_stock','suppliers_docs','product_date','maxPerUnit','filter','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','</tbody>','Transfer\x20Finalize\x20Successfully','item_code','$product_details.product_code','prod_unit','\x20<>\x20','map','An\x20error\x20occurred.','$product.bay','$unit','$primary_code','paid_amount','add_purchases\x20error','/preview/:id','prod_primunit','/incoming','</h5>',',\x20bin:\x20','product_code_hide','secondary_code_hide','\x20units\x20to\x20warehouse:\x20','Rack\x202','Return\x20Goods','edit_purchases_finished_view','amount','room_name','$room','Arabic','all_purchases_barcode','3KPfUgK','Chinese','Arabic\x20(ae)','type_of_products','success','</tr>','bay','FROZEN\x20GOODS','own','$product_code','Enabled','<h5\x20style=\x22text-align:\x20left;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/view/:id','secondary_code','$maxProdPerUnit','$product.quantity','invoice','$suppliers_docs','host','match','$sales_category','/all_purchases_finished/process/','batch_code','934976nVHJqb','purchase_quantity','689535wjGdUs','/view','$product_details','An\x20error\x20occurred\x20while\x20saving\x20data.','expiry_date','$product_details._id','2-digit','concat','post','</td>','purchases_id','maxStocks','$due_amount','$suppliers','Hindi','INC','/view_log','LOG-INC-','false','json','note','\x20<=>\x20','purchases_process','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','INC-','back','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product.floorlevel','user_id','product_cat','/invoice/:id','FGSEmail','product_name','Paid\x20For\x20Purchase','True','port','/CheckingWarehouse','body','slice','/view/return_purchase/:id','sendMail','prod_qty','Error\x20occurred\x20while\x20processing\x20product:','password','uuid','Error\x20fetching\x20or\x20saving\x20warehouse\x20data:','to_quantity','return_qty','return_data','return_product','prod_code','Portuguese\x20(BR)','unit','$product_details.maxProducts','</span>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$secondary_code','undefined','<span\x20style=\x22float:\x20right;\x22>','$product_details.secondary_code','room','21DjrVGx','return_purchase_finished','status','$brand','</div>','</head><body>','product_id','<!DOCTYPE\x20html>','Router','$maxStocks','user','primary_code','$product_details.bay','Enclosed','getFullYear','DRY\x20GOODS','</table>','../middleware/auth','/give_payment/:id','$warehouse_name','/all_purchases_finished/view','../public/language/languages.json',',\x20room:\x20','</body></html>','\x20Order\x20Number\x20:\x20','abs','forEach','purchase\x20data\x20add\x20successfully','<div>','$invoice','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<hr\x20class=\x22my-3\x22>','product_details','isProcess','primary_code_hide','maxperunit','find','add_purchases_finished','getMonth','INCF-','flash','aggregate','$product_details.rack','Spanish','Please\x20wait\x20warehouse\x20checker\x20to\x20confirm\x20the\x20Products\x20stocks','<strong>\x20Regards\x20</strong>','<tr>',',\x20bay:\x20','$category','sales_category','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','util','../models/all_models','warehouse_name','RoomAssign','error','\x20Order\x20Date\x20:\x20','product','$note','type_of_products_type','$product.bin','date','$return_data','length','prod_secondunit','prod_level','Logo.png','/view/add_purchases/:id','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.type','$name','/../public','nodemailer','string','<table\x20style=\x22width:\x20100%\x20!important;\x22>','name','logo','/view/add_purchases','$paid_amount','Finished\x20Goods','Purchase\x20Return','Ambient','$type_products','email','$product.type','params','$product.room_name','<tbody\x20style=\x22text-align:\x20center;\x22>','prod_cat','prod_name','findById','Rack\x201'];a0_0x595c=function(){return _0x571bd9;};return a0_0x595c();}async function get_warehouse_data(_0x5d7240,_0x40dfb1){var _0x1ceb57=a0_0x419498;try{const _0x122cf0=await warehouse_temporary[_0x1ceb57(0x289)]({'name':_0x5d7240,'room':_0x40dfb1});if(!_0x122cf0){const _0x1a485c=new warehouse_temporary({'name':_0x5d7240,'address':_0x5d7240,'status':_0x1ceb57(0x191),'room':_0x40dfb1,'isStaging':_0x1ceb57(0x1b3)});return await _0x1a485c[_0x1ceb57(0x25e)](),_0x1a485c;}else return _0x122cf0;}catch(_0x21a291){console[_0x1ceb57(0x215)](_0x1ceb57(0x1ce),_0x21a291);throw _0x21a291;}}router[a0_0x419498(0x1a9)]('/process/:id',auth,async(_0x55714d,_0x2a8bc9)=>{var _0x3ca47e=a0_0x419498;try{const _0x27e204=_0x55714d[_0x3ca47e(0x233)]['id'],_0x515e8f=await purchases_finished[_0x3ca47e(0x238)](_0x27e204);let _0x34cb8e=[];_0x515e8f[_0x3ca47e(0x217)][_0x3ca47e(0x1f8)]((_0x1325e9,_0x2df7c8)=>{var _0x372494=_0x3ca47e;_0x34cb8e[_0x2df7c8]={},_0x34cb8e[_0x2df7c8][_0x372494(0x240)]=_0x515e8f[_0x372494(0x213)],_0x34cb8e[_0x2df7c8][_0x372494(0x1e4)]=_0x1325e9['product_id'],_0x34cb8e[_0x2df7c8][_0x372494(0x1c1)]=_0x1325e9[_0x372494(0x1c1)],_0x34cb8e[_0x2df7c8][_0x372494(0x288)]=_0x1325e9[_0x372494(0x288)],_0x34cb8e[_0x2df7c8][_0x372494(0x261)]=_0x1325e9[_0x372494(0x261)],_0x34cb8e[_0x2df7c8]['standard_unit']=_0x1325e9[_0x372494(0x275)],_0x34cb8e[_0x2df7c8]['secondary_unit']=_0x1325e9[_0x372494(0x286)],_0x34cb8e[_0x2df7c8]['level']=_0x1325e9[_0x372494(0x245)],_0x34cb8e[_0x2df7c8][_0x372494(0x18d)]=_0x1325e9[_0x372494(0x18d)],_0x34cb8e[_0x2df7c8][_0x372494(0x1e9)]=_0x1325e9[_0x372494(0x1e9)],_0x34cb8e[_0x2df7c8]['secondary_code']=_0x1325e9[_0x372494(0x195)],_0x34cb8e[_0x2df7c8][_0x372494(0x1ac)]=_0x1325e9[_0x372494(0x1ac)],_0x34cb8e[_0x2df7c8][_0x372494(0x19e)]=_0x1325e9[_0x372494(0x19e)],_0x34cb8e[_0x2df7c8]['expiry_date']=_0x1325e9[_0x372494(0x1a5)],_0x34cb8e[_0x2df7c8][_0x372494(0x24a)]=_0x1325e9['production_date'],_0x34cb8e[_0x2df7c8]['maxperunit']=_0x1325e9['maxperunit'],_0x34cb8e[_0x2df7c8][_0x372494(0x1be)]=_0x1325e9[_0x372494(0x1be)],_0x34cb8e[_0x2df7c8][_0x372494(0x2c2)]=_0x1325e9[_0x372494(0x2c2)],_0x34cb8e[_0x2df7c8]['invoice']=_0x1325e9['invoice'],_0x34cb8e[_0x2df7c8][_0x372494(0x1cd)]=_0x1325e9['uuid'],_0x34cb8e[_0x2df7c8][_0x372494(0x23b)]=_0x1325e9[_0x372494(0x23b)],_0x34cb8e[_0x2df7c8][_0x372494(0x20f)]=_0x1325e9[_0x372494(0x20f)],_0x34cb8e[_0x2df7c8]['date_recieved']=_0x1325e9[_0x372494(0x27d)],_0x34cb8e[_0x2df7c8][_0x372494(0x1ab)]=_0x1325e9[_0x372494(0x29c)][_0x372494(0x23c)]();});for(let _0x19a291=0x0;_0x19a291<=_0x34cb8e[_0x3ca47e(0x21d)]-0x1;_0x19a291++){const _0x24bf51=_0x34cb8e[_0x19a291],_0x22a428=new warehouse_temporary(_0x24bf51);await _0x22a428['save']();}_0x515e8f[_0x3ca47e(0x1ff)]=_0x3ca47e(0x281),await _0x515e8f[_0x3ca47e(0x25e)](),_0x55714d[_0x3ca47e(0x206)](_0x3ca47e(0x18b),_0x3ca47e(0x20a)),_0x2a8bc9[_0x3ca47e(0x23d)](_0x3ca47e(0x19d)+_0x515e8f[_0x3ca47e(0x29c)][_0x3ca47e(0x23c)]());}catch(_0x2fcd27){}}),router[a0_0x419498(0x1a9)](a0_0x419498(0x276),auth,async(_0x2337ad,_0x455447)=>{var _0x5b8521=a0_0x419498;try{const {invoice:_0x33c794,date:_0x3b10ce,warehouse_name:_0x1041a4,prod_name:_0x560862,note:_0xd64f8e,due_amount:_0x53f8b9,Room_name:_0x36ca4b,PO_number:_0x52ab76,SCRN:_0x159c8a,ReqBy:_0x22e8be,dateofreq:_0x57ae92,suppliers:_0x462c90,typeservicesData:_0x29d7c3,van:_0xaef79,typevehicle:_0x6fafe0,driver:_0x57f1da,plate:_0x4218bc,DRSI:_0xe26174,TSU:_0x48628d,TFU:_0x316b70,JO_number:_0x176d32,type_of_products:_0x24c11e}=_0x2337ad[_0x5b8521(0x1c6)];if(typeof _0x560862=='string')var _0x2d40a1=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x237)]],_0x145071=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x1d3)]],_0x10316e=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x262)]],_0x3e4c16=[_0x2337ad[_0x5b8521(0x1c6)]['prod_primunit']],_0xab2b09=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x21e)]],_0x2f5fc7=[_0x2337ad['body'][_0x5b8521(0x21f)]],_0x158742=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x1e9)]],_0x55b7dd=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x195)]],_0x195a51=[_0x2337ad['body']['MaxStocks_data']],_0x340845=[_0x2337ad[_0x5b8521(0x1c6)]['batch_code']],_0x268a64=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x1a5)]],_0x40e3a5=[_0x2337ad['body'][_0x5b8521(0x2a4)]],_0xd13cc6=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x294)]],_0x279967=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x236)]],_0x1fff98=[_0x2337ad[_0x5b8521(0x1c6)]['RoomAssign']],_0x463f4f=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x23b)]],_0x1efda5=[_0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x1cd)]],_0x3d96d2=[_0x2337ad[_0x5b8521(0x1c6)]['sales_data_cateory']],_0x452958=[_0x2337ad[_0x5b8521(0x1c6)]['type_of_products_type']];else var _0x2d40a1=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x237)]],_0x145071=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x1d3)]],_0x10316e=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x262)]],_0x3e4c16=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x2b7)]],_0xab2b09=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x21e)]],_0x2f5fc7=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x21f)]],_0x158742=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x1e9)]],_0x55b7dd=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x195)]],_0x195a51=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x290)]],_0x340845=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x19e)]],_0x268a64=[..._0x2337ad['body'][_0x5b8521(0x1a5)]],_0x40e3a5=[..._0x2337ad['body'][_0x5b8521(0x2a4)]],_0xd13cc6=[..._0x2337ad['body']['max_product_unit']],_0x279967=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x236)]],_0x1fff98=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x214)]],_0x463f4f=[..._0x2337ad['body'][_0x5b8521(0x23b)]],_0x1efda5=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x1cd)]],_0x3d96d2=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x29f)]],_0x452958=[..._0x2337ad[_0x5b8521(0x1c6)][_0x5b8521(0x219)]];const _0x10c2f9=_0x2d40a1[_0x5b8521(0x2af)](_0x5d8c15=>{return _0x5d8c15={'product_name':_0x5d8c15};});_0x452958[_0x5b8521(0x1f8)]((_0x3b33d4,_0xb0bd1e)=>{var _0x26800f=_0x5b8521;_0x10c2f9[_0xb0bd1e][_0x26800f(0x18a)]=_0x3b33d4;}),_0x3d96d2[_0x5b8521(0x1f8)]((_0x200695,_0x42c20c)=>{var _0x2e034b=_0x5b8521;_0x10c2f9[_0x42c20c][_0x2e034b(0x20f)]=_0x200695;}),_0x145071[_0x5b8521(0x1f8)]((_0xc1c5f7,_0x4b59fb)=>{var _0x3b8e37=_0x5b8521;_0x10c2f9[_0x4b59fb][_0x3b8e37(0x288)]=_0xc1c5f7;}),_0x1efda5[_0x5b8521(0x1f8)]((_0x335e39,_0x2ceb8b)=>{_0x10c2f9[_0x2ceb8b]['uuid']=_0x335e39;}),_0x10316e['forEach']((_0x3fee30,_0x534b5a)=>{var _0x53849f=_0x5b8521;_0x10c2f9[_0x534b5a]['quantity']=Math[_0x53849f(0x1f7)](_0x3fee30);}),_0x3e4c16['forEach']((_0x427801,_0x4e1993)=>{var _0x3aab0f=_0x5b8521;_0x10c2f9[_0x4e1993][_0x3aab0f(0x275)]=_0x427801;}),_0xab2b09[_0x5b8521(0x1f8)]((_0x6778df,_0x3d3bdb)=>{var _0x554858=_0x5b8521;_0x10c2f9[_0x3d3bdb][_0x554858(0x286)]=_0x6778df;}),_0x2f5fc7[_0x5b8521(0x1f8)]((_0x4f21c7,_0x38f1ae)=>{var _0x5940e1=_0x5b8521,_0x43b6f4=_0x4f21c7['match'](/[A-Za-z]+/)[0x0],_0x3f4662=parseInt(_0x4f21c7['match'](/\d+/)[0x0]);_0x10c2f9[_0x38f1ae][_0x5940e1(0x245)]=_0x43b6f4,_0x10c2f9[_0x38f1ae]['bay']=_0x3f4662;}),_0x158742[_0x5b8521(0x1f8)]((_0x8eca2d,_0x9d13bc)=>{var _0x3643ed=_0x5b8521;_0x10c2f9[_0x9d13bc][_0x3643ed(0x1e9)]=_0x8eca2d;}),_0x55b7dd[_0x5b8521(0x1f8)]((_0x469106,_0x43c314)=>{var _0x2ae461=_0x5b8521;_0x10c2f9[_0x43c314][_0x2ae461(0x195)]=_0x469106;}),_0x195a51[_0x5b8521(0x1f8)]((_0x1c7b82,_0xacf9b6)=>{_0x10c2f9[_0xacf9b6]['maxStocks']=_0x1c7b82;}),_0x340845[_0x5b8521(0x1f8)]((_0x5497c6,_0x22fb73)=>{var _0x5a85ed=_0x5b8521;_0x10c2f9[_0x22fb73][_0x5a85ed(0x19e)]=_0x5497c6;}),_0x268a64['forEach']((_0x3fa64e,_0x173593)=>{_0x10c2f9[_0x173593]['expiry_date']=_0x3fa64e;}),_0x40e3a5[_0x5b8521(0x1f8)]((_0x2ef3b3,_0x3a963c)=>{var _0x32cdc7=_0x5b8521;_0x10c2f9[_0x3a963c][_0x32cdc7(0x24a)]=_0x2ef3b3;}),_0xd13cc6[_0x5b8521(0x1f8)]((_0x2d0f12,_0x115f3f)=>{_0x10c2f9[_0x115f3f]['maxperunit']=_0x2d0f12;}),_0x279967['forEach']((_0x541d44,_0x1d4e39)=>{var _0x21bda9=_0x5b8521;_0x10c2f9[_0x1d4e39][_0x21bda9(0x1be)]=_0x541d44;}),_0x1fff98['forEach']((_0x2103dd,_0x3fd767)=>{_0x10c2f9[_0x3fd767]['room_name']=_0x2103dd;}),_0x463f4f['forEach']((_0x136392,_0xb1193d)=>{_0x10c2f9[_0xb1193d]['gross_price']=_0x136392;});const _0x126c45=new purchases_logs();await _0x126c45[_0x5b8521(0x25e)]();for(let _0x135d5d=0x0;_0x135d5d<=_0x1fff98[_0x5b8521(0x21d)]-0x1;_0x135d5d++){_0x10c2f9[_0x135d5d][_0x5b8521(0x198)]='LOG-INC-'+_0x126c45[_0x5b8521(0x29d)][_0x5b8521(0x273)]()[_0x5b8521(0x24d)](0x8,'0');}const _0x3e86bf=_0x10c2f9['filter'](_0x4f2105=>_0x4f2105[_0x5b8521(0x261)]!=='0'&&_0x4f2105[_0x5b8521(0x261)]!==''),_0x26050c=new purchases_finished({'invoice':_0x5b8521(0x1b2)+_0x126c45[_0x5b8521(0x29d)][_0x5b8521(0x273)]()[_0x5b8521(0x24d)](0x8,'0'),'suppliers':_0x462c90,'date':_0x3b10ce,'warehouse_name':_0x1041a4,'product':_0x3e86bf,'note':_0xd64f8e,'due_amount':_0x53f8b9,'room':_0x36ca4b,'POnumber':_0x52ab76,'SCRN':_0x159c8a,'JO_number':_0x176d32,'ReqBy':_0x22e8be,'dateofreq':_0x57ae92,'typeservicesData':_0x29d7c3,'van':_0xaef79,'typevehicle':_0x6fafe0,'driver':_0x57f1da,'plate':_0x4218bc,'DRSI':_0xe26174,'TSU':_0x48628d,'TFU':_0x316b70,'typeOfProducts':_0x24c11e}),_0x24fe18=await _0x26050c[_0x5b8521(0x25e)](),_0x3ee674=await purchases_finished[_0x5b8521(0x289)]({'_id':_0x24fe18[_0x5b8521(0x29c)][_0x5b8521(0x23c)]()}),_0x4adbb9=_0x3ee674[_0x5b8521(0x217)]['map'](async _0xadd606=>{var _0x2b7902=_0x5b8521;try{var _0x31a9bb=await warehouse['findOne']({'name':_0x1041a4,'room':_0xadd606[_0x2b7902(0x2c2)]}),_0x56a673=0x0;const _0x5b4ec8=_0x31a9bb[_0x2b7902(0x1fe)]['map'](_0x189470=>{var _0x514206=_0x2b7902;console['log'](_0x189470[_0x514206(0x1c1)]+'=='+_0xadd606[_0x514206(0x1c1)]+'&&'+_0x189470[_0x514206(0x18d)]+'=='+_0xadd606['bay']+'&&'+_0x189470['expiry_date']+'=='+_0xadd606[_0x514206(0x1a5)]+'&&'+_0x189470['production_date']+'=='+_0xadd606['production_date']+'&&'+_0x189470[_0x514206(0x19e)]+'=='+_0xadd606[_0x514206(0x19e)]+'&&'+_0x189470['invoice']+'=='+_0x3ee674[_0x514206(0x198)]),_0x189470[_0x514206(0x1c1)]==_0xadd606[_0x514206(0x1c1)]&&_0x189470[_0x514206(0x18d)]==_0xadd606[_0x514206(0x18d)]&&_0x189470['level']==_0xadd606['level']&&_0x189470[_0x514206(0x1a5)]==_0xadd606[_0x514206(0x1a5)]&&_0x189470[_0x514206(0x24a)]==_0xadd606[_0x514206(0x24a)]&&_0x189470[_0x514206(0x19e)]==_0xadd606[_0x514206(0x19e)]&&_0x189470[_0x514206(0x198)]==_0x3ee674[_0x514206(0x198)]&&(_0x189470[_0x514206(0x2a2)]=Math[_0x514206(0x1f7)](_0x189470[_0x514206(0x2a2)])+Math[_0x514206(0x1f7)](_0xadd606[_0x514206(0x261)]),_0x56a673++);});return _0x56a673==0x0&&(_0x31a9bb[_0x2b7902(0x1fe)]=_0x31a9bb[_0x2b7902(0x1fe)][_0x2b7902(0x1a8)]({'product_name':_0xadd606[_0x2b7902(0x1c1)],'product_stock':Math[_0x2b7902(0x1f7)](_0xadd606[_0x2b7902(0x261)]),'primary_code':_0xadd606[_0x2b7902(0x1e9)],'secondary_code':_0xadd606['secondary_code'],'product_code':_0xadd606[_0x2b7902(0x288)],'bay':_0xadd606['bay'],'level':_0xadd606[_0x2b7902(0x245)],'maxProducts':_0xadd606['maxStocks'],'unit':_0xadd606[_0x2b7902(0x275)],'secondary_unit':_0xadd606[_0x2b7902(0x286)],'expiry_date':_0xadd606[_0x2b7902(0x1a5)],'production_date':_0xadd606['production_date'],'maxProducts':_0xadd606['maxStocks'],'maxPerUnit':_0xadd606[_0x2b7902(0x201)],'batch_code':_0xadd606[_0x2b7902(0x19e)],'product_cat':_0xadd606['product_cat'],'invoice':_0xadd606[_0x2b7902(0x198)],'id_incoming':_0xadd606[_0x2b7902(0x29c)],'uuid':_0xadd606[_0x2b7902(0x1cd)],'gross_price':_0xadd606[_0x2b7902(0x23b)],'sales_category':_0xadd606[_0x2b7902(0x20f)],'type_products':_0xadd606[_0x2b7902(0x18a)]})),_0x31a9bb;}catch(_0x3e887f){return console[_0x2b7902(0x215)](_0x2b7902(0x1cb),_0x3e887f),null;}});Promise[_0x5b8521(0x271)](_0x4adbb9)[_0x5b8521(0x26f)](async _0x59708f=>{var _0x5496eb=_0x5b8521;try{for(const _0x132d4c of _0x59708f){await warehouse[_0x5496eb(0x26d)]({'_id':_0x132d4c[_0x5496eb(0x29c)]},{'$addToSet':{'product_details':{'$each':_0x132d4c['product_details']}}});}const _0x4b04f9=await master_shop['find'](),_0x3fbb3e=await email_settings['findOne'](),_0x30d337=await supervisor_settings[_0x5496eb(0x202)]();var _0x445e1a=_0x3ee674[_0x5496eb(0x217)],_0x448990='',_0x5b2505;for(_0x5b2505 in _0x445e1a){var _0x179fdc='FG';_0x3ee674[_0x5496eb(0x213)]==_0x5496eb(0x1ed)&&(_0x179fdc='DG'),_0x448990+='<tr>'+_0x5496eb(0x287)+_0x445e1a[_0x5b2505]['product_name']+_0x5496eb(0x1aa)+_0x5496eb(0x287)+_0x445e1a[_0x5b2505][_0x5496eb(0x288)]+_0x5496eb(0x1aa)+_0x5496eb(0x287)+_0x445e1a[_0x5b2505][_0x5496eb(0x261)]+_0x5496eb(0x1aa)+_0x5496eb(0x287)+_0x445e1a[_0x5b2505][_0x5496eb(0x275)]+_0x5496eb(0x1aa)+_0x5496eb(0x287)+_0x445e1a[_0x5b2505][_0x5496eb(0x286)]+'</td>'+_0x5496eb(0x287)+_0x3ee674[_0x5496eb(0x213)]+_0x5496eb(0x1aa)+_0x5496eb(0x287)+_0x445e1a[_0x5b2505][_0x5496eb(0x2c2)]+_0x5496eb(0x1aa)+_0x5496eb(0x287)+_0x179fdc+_0x445e1a[_0x5b2505][_0x5496eb(0x18d)]+_0x5496eb(0x1aa),'</tr>';}let _0x4fac59=nodemailer[_0x5496eb(0x250)]({'host':_0x3fbb3e[_0x5496eb(0x19a)],'port':Number(_0x3fbb3e[_0x5496eb(0x1c4)]),'secure':![],'auth':{'user':_0x3fbb3e[_0x5496eb(0x231)],'pass':_0x3fbb3e[_0x5496eb(0x1cc)]}}),_0x30a58c={'from':_0x3fbb3e['email'],'to':_0x30d337[0x0][_0x5496eb(0x1c0)],'subject':_0x5496eb(0x25a),'attachments':[{'filename':_0x5496eb(0x220),'path':__dirname+_0x5496eb(0x225)+_0x5496eb(0x28d)+_0x4b04f9[0x0][_0x5496eb(0x28b)],'cid':_0x5496eb(0x22a)}],'html':'<!DOCTYPE\x20html>'+_0x5496eb(0x27f)+_0x5496eb(0x1e3)+_0x5496eb(0x1fa)+_0x5496eb(0x25c)+_0x5496eb(0x1fa)+_0x5496eb(0x1fc)+_0x5496eb(0x1e2)+_0x5496eb(0x1fa)+_0x5496eb(0x23f)+_0x4b04f9[0x0][_0x5496eb(0x249)]+'\x20</h2>'+_0x5496eb(0x1e2)+_0x5496eb(0x1e2)+_0x5496eb(0x1fd)+_0x5496eb(0x1fa)+_0x5496eb(0x192)+'\x20Order\x20Number\x20:\x20'+_0x3ee674['invoice']+'\x20'+_0x5496eb(0x1db)+_0x5496eb(0x216)+_0x3ee674[_0x5496eb(0x21b)]+'\x20'+_0x5496eb(0x1d7)+_0x5496eb(0x2b9)+_0x5496eb(0x1e2)+_0x5496eb(0x228)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5496eb(0x20c)+_0x5496eb(0x1b8)+_0x5496eb(0x1bb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x5496eb(0x1d8)+_0x5496eb(0x244)+_0x5496eb(0x2a8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x5496eb(0x18c)+_0x5496eb(0x27c)+_0x5496eb(0x235)+'\x20'+_0x448990+'\x20'+_0x5496eb(0x2a9)+_0x5496eb(0x1ee)+_0x5496eb(0x1fa)+_0x5496eb(0x20b)+'<h5>'+_0x4b04f9[0x0][_0x5496eb(0x249)]+_0x5496eb(0x2b9)+_0x5496eb(0x1e2)+'</div>'+_0x5496eb(0x1f5)};_0x4fac59[_0x5496eb(0x1c9)](_0x30a58c,function(_0x539149,_0x423626){var _0x1fe096=_0x5496eb;_0x539149?(console[_0x1fe096(0x296)](_0x539149),console[_0x1fe096(0x296)](_0x1fe096(0x24e))):console['log']('Email\x20sent\x20successfully');});}catch(_0x1fe353){console[_0x5496eb(0x215)](_0x1fe353),_0x455447[_0x5496eb(0x1e0)](0x1f4)[_0x5496eb(0x1b4)]({'error':_0x5496eb(0x1a4),'message':_0x1fe353[_0x5496eb(0x291)]});}})[_0x5b8521(0x26c)](_0x203056=>{var _0x31e818=_0x5b8521;console[_0x31e818(0x215)](_0x203056);}),_0x2337ad[_0x5b8521(0x206)](_0x5b8521(0x18b),'purchase\x20data\x20add\x20successfully'),_0x455447[_0x5b8521(0x23d)](_0x5b8521(0x295)+_0x3ee674[_0x5b8521(0x29c)][_0x5b8521(0x23c)]());}catch(_0x3ea7a6){console[_0x5b8521(0x296)](_0x3ea7a6);}}),router[a0_0x419498(0x2a0)](a0_0x419498(0x2b6),auth,async(_0x3b9c97,_0x23d6a3)=>{var _0x3a5660=a0_0x419498;try{const {username:_0x29cf78,email:_0x18a183,role:_0x4d86a7}=_0x3b9c97[_0x3a5660(0x1e8)],_0x2fdeaa=_0x3b9c97[_0x3a5660(0x1e8)],_0x33e6c2=await profile['findOne']({'email':_0x2fdeaa['email']}),_0x5cf084=await master_shop[_0x3a5660(0x202)](),_0x1735bb=_0x3b9c97[_0x3a5660(0x233)]['id'],_0x3f12ec=await purchases_finished[_0x3a5660(0x238)](_0x1735bb),_0x51ee9c=await suppliers['find']({});let _0x1f03e3;if(_0x2fdeaa['role']==_0x3a5660(0x27b)){const _0xc1a261=await staff['findOne']({'email':_0x2fdeaa[_0x3a5660(0x231)]});_0x1f03e3=await warehouse[_0x3a5660(0x202)]({'status':_0x3a5660(0x191),'name':_0xc1a261[_0x3a5660(0x240)],'warehouse_category':_0x3a5660(0x22d)});}else _0x1f03e3=await warehouse[_0x3a5660(0x207)]([{'$match':{'status':_0x3a5660(0x191),'warehouse_category':_0x3a5660(0x22d)}},{'$group':{'_id':_0x3a5660(0x224),'name':{'$first':'$name'}}}]);const _0x1343b4=await product[_0x3a5660(0x202)]({}),_0x3a01e1=BayBinSelected(_0x3f12ec[_0x3a5660(0x213)],_0x3f12ec['room']);let _0x244565=new Date(_0x3f12ec[_0x3a5660(0x1a5)]),_0x5bec74=('0'+_0x244565[_0x3a5660(0x24b)]())[_0x3a5660(0x1c7)](-0x2),_0x12e367=('0'+(_0x244565[_0x3a5660(0x204)]()+0x1))[_0x3a5660(0x1c7)](-0x2),_0x212f8d=_0x244565['getFullYear'](),_0x42b8cf=_0x212f8d+'-'+_0x12e367+'-'+_0x5bec74;if(_0x5cf084[0x0][_0x3a5660(0x259)]==_0x3a5660(0x29a)){var _0xdef487=users[_0x3a5660(0x272)];console[_0x3a5660(0x296)](_0xdef487);}else{if(_0x5cf084[0x0][_0x3a5660(0x259)]==_0x3a5660(0x1af))var _0xdef487=users['Hindi'];else{if(_0x5cf084[0x0]['language']==_0x3a5660(0x266))var _0xdef487=users['German'];else{if(_0x5cf084[0x0][_0x3a5660(0x259)]==_0x3a5660(0x209))var _0xdef487=users[_0x3a5660(0x209)];else{if(_0x5cf084[0x0][_0x3a5660(0x259)]=='French')var _0xdef487=users[_0x3a5660(0x256)];else{if(_0x5cf084[0x0][_0x3a5660(0x259)]=='Portuguese\x20(BR)')var _0xdef487=users[_0x3a5660(0x2a7)];else{if(_0x5cf084[0x0][_0x3a5660(0x259)]=='Chinese')var _0xdef487=users['Chinese'];else{if(_0x5cf084[0x0][_0x3a5660(0x259)]==_0x3a5660(0x189))var _0xdef487=users[_0x3a5660(0x2c4)];}}}}}}}_0x23d6a3[_0x3a5660(0x242)](_0x3a5660(0x2c0),{'success':_0x3b9c97[_0x3a5660(0x206)](_0x3a5660(0x18b)),'errors':_0x3b9c97[_0x3a5660(0x206)]('errors'),'role':_0x2fdeaa,'profile':_0x33e6c2,'purchases':_0x3f12ec,'suppliers':_0x51ee9c,'warehouse':_0x1f03e3,'product':_0x1343b4,'master_shop':_0x5cf084,'language':_0xdef487,'ed_fullDate':_0x42b8cf,'dataSelected':_0x3a01e1});}catch(_0x1f8dbf){console[_0x3a5660(0x296)](_0x1f8dbf);}}),router[a0_0x419498(0x2a0)](a0_0x419498(0x194),auth,async(_0x212226,_0x53015e)=>{var _0x4f7866=a0_0x419498;try{const {username:_0x22e698,email:_0x4cd27e,role:_0x1be762}=_0x212226[_0x4f7866(0x1e8)],_0x2f8985=_0x212226[_0x4f7866(0x1e8)],_0x4daa97=await profile[_0x4f7866(0x289)]({'email':_0x2f8985['email']}),_0x528d3d=await master_shop['find'](),_0x183fe5=_0x212226['params']['id'],_0xda39f8=await purchases_finished[_0x4f7866(0x238)](_0x183fe5),_0x4baebd=await suppliers[_0x4f7866(0x202)]({});let _0x52230f;if(_0x2f8985[_0x4f7866(0x258)]=='staff'){const _0x530e41=await staff[_0x4f7866(0x289)]({'email':_0x2f8985['email']});_0x52230f=await warehouse[_0x4f7866(0x202)]({'status':'Enabled','name':_0x530e41[_0x4f7866(0x240)],'warehouse_category':_0x4f7866(0x22d)});}else _0x52230f=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x36f6fa=await product[_0x4f7866(0x202)]({}),_0x22a04a=BayBinSelected(_0xda39f8[_0x4f7866(0x213)],_0xda39f8[_0x4f7866(0x1dd)]);let _0x2415d3=new Date(_0xda39f8[_0x4f7866(0x1a5)]),_0x5c76e5=('0'+_0x2415d3[_0x4f7866(0x24b)]())['slice'](-0x2),_0x456486=('0'+(_0x2415d3[_0x4f7866(0x204)]()+0x1))['slice'](-0x2),_0x3988a5=_0x2415d3[_0x4f7866(0x1ec)](),_0x376b77=_0x3988a5+'-'+_0x456486+'-'+_0x5c76e5;if(_0x528d3d[0x0][_0x4f7866(0x259)]=='English\x20(US)'){var _0x34ce25=users['English'];console[_0x4f7866(0x296)](_0x34ce25);}else{if(_0x528d3d[0x0][_0x4f7866(0x259)]=='Hindi')var _0x34ce25=users[_0x4f7866(0x1af)];else{if(_0x528d3d[0x0]['language']==_0x4f7866(0x266))var _0x34ce25=users[_0x4f7866(0x266)];else{if(_0x528d3d[0x0][_0x4f7866(0x259)]==_0x4f7866(0x209))var _0x34ce25=users[_0x4f7866(0x209)];else{if(_0x528d3d[0x0][_0x4f7866(0x259)]=='French')var _0x34ce25=users[_0x4f7866(0x256)];else{if(_0x528d3d[0x0][_0x4f7866(0x259)]==_0x4f7866(0x1d4))var _0x34ce25=users[_0x4f7866(0x2a7)];else{if(_0x528d3d[0x0][_0x4f7866(0x259)]=='Chinese')var _0x34ce25=users[_0x4f7866(0x188)];else{if(_0x528d3d[0x0][_0x4f7866(0x259)]==_0x4f7866(0x189))var _0x34ce25=users['Arabic'];}}}}}}}_0x53015e[_0x4f7866(0x242)]('edit_purchases_finished',{'success':_0x212226[_0x4f7866(0x206)](_0x4f7866(0x18b)),'errors':_0x212226[_0x4f7866(0x206)](_0x4f7866(0x24c)),'role':_0x2f8985,'profile':_0x4daa97,'purchases':_0xda39f8,'suppliers':_0x4baebd,'warehouse':_0x52230f,'product':_0x36f6fa,'master_shop':_0x528d3d,'language':_0x34ce25,'ed_fullDate':_0x376b77,'dataSelected':_0x22a04a});}catch(_0x23ae18){console['log'](_0x23ae18);}}),router['post']('/view/:id',auth,async(_0x57f794,_0x3242d9)=>{var _0x11382a=a0_0x419498;try{const _0x5c8c38=_0x57f794[_0x11382a(0x233)]['id'],_0x5321d1=await purchases_finished[_0x11382a(0x289)]({'_id':_0x57f794[_0x11382a(0x233)]['id']}),_0x159c08=await warehouse[_0x11382a(0x289)]({'name':_0x5321d1['warehouse_name'],'room':_0x5321d1[_0x11382a(0x1dd)]});_0x5321d1['product'][_0x11382a(0x1f8)](_0x2964a1=>{var _0x5a0755=_0x11382a;const _0x1aa93c=_0x159c08[_0x5a0755(0x1fe)][_0x5a0755(0x2af)](_0x3692cf=>{var _0x347ad4=_0x5a0755;_0x3692cf[_0x347ad4(0x1c1)]==_0x2964a1[_0x347ad4(0x1c1)]&&_0x3692cf[_0x347ad4(0x18d)]==_0x2964a1['bay']&&(_0x3692cf['product_stock']=parseInt(_0x3692cf[_0x347ad4(0x2a2)])-parseInt(_0x2964a1[_0x347ad4(0x261)]));});}),await _0x159c08[_0x11382a(0x25e)]();const {invoice:_0x1f904b,suppliers:_0x55a061,date:_0x7e33e1,warehouse_name:_0x2417c4,prod_name:_0x374bd2,prod_code:_0x35dba9,prod_qty:_0x4cdf41,prod_unit:_0xa1da2b,prod_secondunit:_0x1be4aa,prod_level:_0x41e207,prod_isle:_0x2a6d5e,prod_pallet:_0x58cff7,note:_0x4eab0c,expiry_date:_0x162fce,batch_code:_0x355bc7,paid_amount:_0x19cd8e,due_amount:_0x1e01c4,Room_name:_0x120529,primary_code:_0x57cf91,secondary_code:_0x596521,PO_number:_0x3cabf7,JO_number:_0x2344cc}=_0x57f794[_0x11382a(0x1c6)];if(typeof _0x374bd2=='string')var _0x2ca66c=[_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x237)]],_0x5252f7=[_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x1d3)]],_0xda541=[_0x57f794['body'][_0x11382a(0x1ca)]],_0x400dbf=[_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x2ad)]],_0x49a482=[_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x21e)]],_0x4e537f=[_0x57f794['body'][_0x11382a(0x21f)]],_0x27c3d2=[_0x57f794['body'][_0x11382a(0x1e9)]],_0x380e74=[_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x195)]],_0x536d93=[_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x290)]],_0x3d9668=[_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x19e)]],_0x13ba4b=[_0x57f794[_0x11382a(0x1c6)]['expiry_date']];else var _0x2ca66c=[..._0x57f794[_0x11382a(0x1c6)][_0x11382a(0x237)]],_0x5252f7=[..._0x57f794['body'][_0x11382a(0x1d3)]],_0xda541=[..._0x57f794[_0x11382a(0x1c6)][_0x11382a(0x1ca)]],_0x400dbf=[..._0x57f794[_0x11382a(0x1c6)]['prod_unit']],_0x49a482=[..._0x57f794[_0x11382a(0x1c6)]['prod_secondunit']],_0x4e537f=[..._0x57f794[_0x11382a(0x1c6)][_0x11382a(0x21f)]],_0x27c3d2=[..._0x57f794['body']['primary_code']],_0x380e74=[..._0x57f794[_0x11382a(0x1c6)][_0x11382a(0x195)]],_0x536d93=[..._0x57f794[_0x11382a(0x1c6)][_0x11382a(0x290)]],_0x3d9668=[..._0x57f794[_0x11382a(0x1c6)][_0x11382a(0x19e)]],_0x13ba4b=[..._0x57f794[_0x11382a(0x1c6)]['expiry_date']];const _0x45b7b8=_0x2ca66c[_0x11382a(0x2af)](_0x5232d8=>{return _0x5232d8={'product_name':_0x5232d8};});_0x5252f7['forEach']((_0x1cde10,_0x27954e)=>{_0x45b7b8[_0x27954e]['product_code']=_0x1cde10;}),_0xda541[_0x11382a(0x1f8)]((_0x47a649,_0x5bcd71)=>{var _0x41fd39=_0x11382a;_0x45b7b8[_0x5bcd71][_0x41fd39(0x261)]=_0x47a649;}),_0x400dbf['forEach']((_0x27df48,_0x55b857)=>{var _0x693443=_0x11382a;_0x45b7b8[_0x55b857][_0x693443(0x275)]=_0x27df48;}),_0x49a482[_0x11382a(0x1f8)]((_0x5f2340,_0x3ca505)=>{var _0x59b646=_0x11382a;_0x45b7b8[_0x3ca505][_0x59b646(0x286)]=_0x5f2340;}),_0x4e537f['forEach']((_0x4815f3,_0x569aee)=>{_0x45b7b8[_0x569aee]['bay']=_0x4815f3;}),_0x27c3d2[_0x11382a(0x1f8)]((_0x58e25d,_0x261c05)=>{var _0xb0ed3b=_0x11382a;_0x45b7b8[_0x261c05][_0xb0ed3b(0x1e9)]=_0x58e25d;}),_0x380e74[_0x11382a(0x1f8)]((_0x2644a3,_0xdf0477)=>{var _0x25ffa5=_0x11382a;_0x45b7b8[_0xdf0477][_0x25ffa5(0x195)]=_0x2644a3;}),_0x536d93[_0x11382a(0x1f8)]((_0x2a54bb,_0x2e8b07)=>{var _0x2f5323=_0x11382a;_0x45b7b8[_0x2e8b07][_0x2f5323(0x1ac)]=_0x2a54bb;}),_0x3d9668[_0x11382a(0x1f8)]((_0x40b063,_0x2aa6b6)=>{var _0x27acf1=_0x11382a;_0x45b7b8[_0x2aa6b6][_0x27acf1(0x19e)]=_0x40b063;}),_0x13ba4b[_0x11382a(0x1f8)]((_0x3f30e9,_0x30832a)=>{_0x45b7b8[_0x30832a]['expiry_date']=_0x3f30e9;});const _0x479186=_0x45b7b8[_0x11382a(0x2a6)](_0x4cdc3c=>_0x4cdc3c['quantity']!=='0'&&_0x4cdc3c[_0x11382a(0x261)]!=='');_0x5321d1[_0x11382a(0x198)]=_0x1f904b,_0x5321d1[_0x11382a(0x298)]=_0x55a061,_0x5321d1[_0x11382a(0x21b)]=_0x7e33e1,_0x5321d1[_0x11382a(0x213)]=_0x2417c4,_0x5321d1[_0x11382a(0x217)]=_0x479186,_0x5321d1[_0x11382a(0x1b5)]=_0x4eab0c,_0x5321d1[_0x11382a(0x2b4)]=_0x19cd8e,_0x5321d1[_0x11382a(0x23a)]=_0x1e01c4,_0x5321d1[_0x11382a(0x1dd)]=_0x120529,_0x5321d1[_0x11382a(0x251)]=_0x3cabf7,_0x5321d1[_0x11382a(0x277)]=_0x2344cc;const _0x1a8b78=await _0x5321d1['save'](),_0x4dd4eb=await warehouse[_0x11382a(0x289)]({'name':_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x213)],'room':_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x28a)]});_0x5321d1[_0x11382a(0x217)][_0x11382a(0x1f8)](_0x565a53=>{var _0x5d002b=_0x11382a,_0x29de53=0x0;const _0x84ac83=_0x4dd4eb[_0x5d002b(0x1fe)][_0x5d002b(0x2af)](_0x18a110=>{var _0x492134=_0x5d002b;_0x18a110[_0x492134(0x1c1)]==_0x565a53[_0x492134(0x1c1)]&&_0x18a110[_0x492134(0x18d)]==_0x565a53['bay']&&(_0x18a110[_0x492134(0x2a2)]=parseInt(_0x18a110['product_stock'])+parseInt(_0x565a53['quantity']),_0x29de53++);});_0x29de53=='0'&&(_0x4dd4eb[_0x5d002b(0x1fe)]=_0x4dd4eb[_0x5d002b(0x1fe)][_0x5d002b(0x1a8)]({'product_name':_0x565a53[_0x5d002b(0x1c1)],'product_stock':_0x565a53[_0x5d002b(0x261)],'primary_code':_0x565a53[_0x5d002b(0x1e9)],'secondary_code':_0x565a53[_0x5d002b(0x195)],'product_code':_0x565a53[_0x5d002b(0x288)],'bay':_0x565a53[_0x5d002b(0x18d)],'maxProducts':_0x565a53[_0x5d002b(0x1ac)],'unit':_0x565a53[_0x5d002b(0x275)],'secondary_unit':_0x565a53[_0x5d002b(0x286)],'expiry_date':_0x565a53[_0x5d002b(0x1a5)]}));}),await _0x4dd4eb[_0x11382a(0x25e)]();const _0x12f1b8=await s_payment_data[_0x11382a(0x289)]({'invoice':_0x57f794[_0x11382a(0x1c6)][_0x11382a(0x198)]});if(_0x12f1b8===null){}else console[_0x11382a(0x296)](_0x11382a(0x298),_0x12f1b8,_0x57f794['body']['invoice']),_0x12f1b8[_0x11382a(0x298)]=_0x57f794[_0x11382a(0x1c6)]['suppliers'],await _0x12f1b8['save']();_0x57f794[_0x11382a(0x206)](_0x11382a(0x18b),'purchase\x20data\x20update\x20successfully'),_0x3242d9['redirect'](_0x11382a(0x1f2));}catch(_0x45a205){console['log'](_0x45a205);}}),router['post'](a0_0x419498(0x1f0),auth,async(_0x3fd2a8,_0x582e2c)=>{var _0x6bfde2=a0_0x419498;try{const _0x32b767=_0x3fd2a8[_0x6bfde2(0x233)]['id'],{invoice:_0x593069,suppliers:_0x49a52a,payable:_0x4aa1c5,due_amount:_0x44d54f}=_0x3fd2a8[_0x6bfde2(0x1c6)],_0x1583ba=await purchases[_0x6bfde2(0x238)](_0x32b767);var _0x1990c5=_0x4aa1c5-_0x44d54f;_0x1583ba[_0x6bfde2(0x2b4)]=parseFloat(_0x1583ba[_0x6bfde2(0x2b4)])+parseFloat(_0x44d54f),_0x1583ba[_0x6bfde2(0x23a)]=_0x1990c5;const _0x4ac607=await _0x1583ba[_0x6bfde2(0x25e)]();console['log'](_0x4ac607);const _0x424b42=await s_payment_data[_0x6bfde2(0x289)]({'invoice':_0x593069});_0x424b42[_0x6bfde2(0x2c1)]=_0x1990c5,await _0x424b42[_0x6bfde2(0x25e)]();let _0x56c13c=new Date(),_0x2b1684=('0'+_0x56c13c['getDate']())[_0x6bfde2(0x1c7)](-0x2),_0x209d05=('0'+(_0x56c13c[_0x6bfde2(0x204)]()+0x1))[_0x6bfde2(0x1c7)](-0x2),_0x171622=_0x56c13c['getFullYear'](),_0x167e28=_0x171622+'-'+_0x209d05+'-'+_0x2b1684;const _0x3b6a78=new suppliers_payment({'invoice':_0x593069,'date':_0x171622+'-'+_0x209d05+'-'+_0x2b1684,'suppliers':_0x49a52a,'reason':_0x6bfde2(0x1c2),'amount':_0x44d54f}),_0x4132bf=await _0x3b6a78['save']();_0x3fd2a8[_0x6bfde2(0x206)](_0x6bfde2(0x18b),_0x6bfde2(0x260)),_0x582e2c[_0x6bfde2(0x23d)]('/all_purchases/view');}catch(_0x3bd6e8){console['log'](_0x3bd6e8);}}),router[a0_0x419498(0x2a0)](a0_0x419498(0x1bf),auth,async(_0x5dc860,_0x481d20)=>{var _0x1eb0a4=a0_0x419498;try{const {username:_0x451835,email:_0x1a457d,role:_0x455efc}=_0x5dc860[_0x1eb0a4(0x1e8)],_0x4f6c1b=_0x5dc860[_0x1eb0a4(0x1e8)],_0x136c5a=await profile[_0x1eb0a4(0x289)]({'email':_0x4f6c1b[_0x1eb0a4(0x231)]}),_0x2296d7=await master_shop[_0x1eb0a4(0x202)]();console[_0x1eb0a4(0x296)]('master',_0x2296d7);const _0x3443ff=_0x5dc860[_0x1eb0a4(0x233)]['id'],_0xc7340f=await purchases[_0x1eb0a4(0x238)](_0x3443ff);console[_0x1eb0a4(0x296)](_0xc7340f);const _0x3dd993=await suppliers['findOne']({'name':_0xc7340f['suppliers']});console[_0x1eb0a4(0x296)](_0x3dd993);if(_0x2296d7[0x0][_0x1eb0a4(0x259)]=='English\x20(US)'){var _0xb6b6dd=users[_0x1eb0a4(0x272)];console[_0x1eb0a4(0x296)](_0xb6b6dd);}else{if(_0x2296d7[0x0][_0x1eb0a4(0x259)]=='Hindi')var _0xb6b6dd=users[_0x1eb0a4(0x1af)];else{if(_0x2296d7[0x0][_0x1eb0a4(0x259)]==_0x1eb0a4(0x266))var _0xb6b6dd=users[_0x1eb0a4(0x266)];else{if(_0x2296d7[0x0][_0x1eb0a4(0x259)]==_0x1eb0a4(0x209))var _0xb6b6dd=users[_0x1eb0a4(0x209)];else{if(_0x2296d7[0x0][_0x1eb0a4(0x259)]==_0x1eb0a4(0x256))var _0xb6b6dd=users['French'];else{if(_0x2296d7[0x0]['language']==_0x1eb0a4(0x1d4))var _0xb6b6dd=users[_0x1eb0a4(0x2a7)];else{if(_0x2296d7[0x0][_0x1eb0a4(0x259)]=='Chinese')var _0xb6b6dd=users[_0x1eb0a4(0x188)];else{if(_0x2296d7[0x0][_0x1eb0a4(0x259)]=='Arabic\x20(ae)')var _0xb6b6dd=users['Arabic'];}}}}}}}_0x481d20['render'](_0x1eb0a4(0x28c),{'success':_0x5dc860[_0x1eb0a4(0x206)](_0x1eb0a4(0x18b)),'errors':_0x5dc860['flash']('errors'),'role':_0x4f6c1b,'profile':_0x136c5a,'master_shop':_0x2296d7,'supplier':_0x3dd993,'purchase':_0xc7340f,'language':_0xb6b6dd});}catch(_0xf56074){console[_0x1eb0a4(0x296)](_0xf56074);}}),router[a0_0x419498(0x2a0)](a0_0x419498(0x1c8),auth,async(_0x308380,_0x320e74)=>{var _0x39396f=a0_0x419498;try{const {username:_0x301456,email:_0x1d1fcb,role:_0x4bbd47}=_0x308380['user'],_0x27bad1=_0x308380[_0x39396f(0x1e8)],_0x39349a=await profile[_0x39396f(0x289)]({'email':_0x27bad1['email']}),_0x18c658=await master_shop[_0x39396f(0x202)]();console['log'](_0x39396f(0x25d),_0x18c658);const _0x334f1c=_0x308380[_0x39396f(0x233)]['id'];console[_0x39396f(0x296)](_0x334f1c);const _0x5b82da=await purchases_finished['findById'](_0x334f1c);console['log'](_0x39396f(0x1bd),_0x5b82da);const _0x12f937=await product[_0x39396f(0x202)]({}),_0x40f89c=await warehouse[_0x39396f(0x207)]([{'$match':{'name':_0x5b82da[_0x39396f(0x213)],'room':_0x5b82da[_0x39396f(0x1dd)]}},{'$unwind':_0x39396f(0x1a3)},{'$group':{'_id':_0x39396f(0x1a6),'name':{'$first':_0x39396f(0x24f)},'product_stock':{'$first':_0x39396f(0x252)},'bay':{'$first':_0x39396f(0x1ea)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x39396f(0x223)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x39396f(0x1dc)},'product_code':{'$first':_0x39396f(0x2ac)},'storage':{'$first':_0x39396f(0x247)},'rack':{'$first':_0x39396f(0x208)}}}]);console[_0x39396f(0x296)]('stock_data',_0x40f89c);let _0x394712;if(_0x27bad1['role']==_0x39396f(0x27b)){const _0x2ec0a=await staff[_0x39396f(0x289)]({'email':_0x27bad1[_0x39396f(0x231)]});_0x394712=await warehouse[_0x39396f(0x202)]({'status':'Enabled','name':_0x2ec0a[_0x39396f(0x240)],'warehouse_category':_0x39396f(0x22d),'name':_0x39396f(0x2bf)});}else _0x394712=await warehouse[_0x39396f(0x207)]([{'$match':{'status':_0x39396f(0x191),'warehouse_category':_0x39396f(0x22d),'name':_0x39396f(0x2bf)}},{'$group':{'_id':_0x39396f(0x224),'name':{'$first':'$name'}}}]);if(_0x18c658[0x0][_0x39396f(0x259)]==_0x39396f(0x29a)){var _0x85cad0=users[_0x39396f(0x272)];console[_0x39396f(0x296)](_0x85cad0);}else{if(_0x18c658[0x0]['language']==_0x39396f(0x1af))var _0x85cad0=users['Hindi'];else{if(_0x18c658[0x0]['language']==_0x39396f(0x266))var _0x85cad0=users[_0x39396f(0x266)];else{if(_0x18c658[0x0][_0x39396f(0x259)]=='Spanish')var _0x85cad0=users[_0x39396f(0x209)];else{if(_0x18c658[0x0][_0x39396f(0x259)]=='French')var _0x85cad0=users[_0x39396f(0x256)];else{if(_0x18c658[0x0][_0x39396f(0x259)]=='Portuguese\x20(BR)')var _0x85cad0=users[_0x39396f(0x2a7)];else{if(_0x18c658[0x0]['language']==_0x39396f(0x188))var _0x85cad0=users['Chinese'];else{if(_0x18c658[0x0][_0x39396f(0x259)]==_0x39396f(0x189))var _0x85cad0=users[_0x39396f(0x2c4)];}}}}}}}_0x320e74[_0x39396f(0x242)](_0x39396f(0x1df),{'success':_0x308380[_0x39396f(0x206)]('success'),'errors':_0x308380[_0x39396f(0x206)]('errors'),'role':_0x27bad1,'profile':_0x39349a,'user':_0x5b82da,'stock':_0x40f89c,'master_shop':_0x18c658,'product':_0x12f937,'language':_0x85cad0,'warehouse':_0x394712});}catch(_0x3a59d3){console[_0x39396f(0x296)](_0x3a59d3);}}),router[a0_0x419498(0x1a9)](a0_0x419498(0x1c8),auth,async(_0x45c4ec,_0x6a083e)=>{var _0x2d251b=a0_0x419498;try{const {invoice:_0xefe36c,date:_0xfb2b9f,warehouse_name:_0x41abdb,Room_name:_0x26cdd3,product_name:_0xfb86a3,purchase_quantity:_0x500d39,stocks:_0x4f189e,return_qty:_0x25638a,note:_0x8901,level:_0x93e985,isle:_0x392f90,pallet:_0x3b6d26,to_warehouse_name:_0x4314f5,to_Room_name:_0x2309c0}=_0x45c4ec[_0x2d251b(0x1c6)],_0x4630ad=await purchases_finished['findOne']({'_id':_0x45c4ec[_0x2d251b(0x233)]['id']}),_0x65f546=await warehouse['findOne']({'name':_0x41abdb,'room':_0x26cdd3,'warehouse_category':_0x2d251b(0x22d)});if(typeof _0xfb86a3==_0x2d251b(0x227))var _0x2b1711=[_0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x1c1)]],_0x16c05f=[_0x45c4ec[_0x2d251b(0x1c6)]['purchase_quantity']],_0x1ce951=[_0x45c4ec['body'][_0x2d251b(0x268)]],_0x10c1c7=[_0x45c4ec[_0x2d251b(0x1c6)]['return_qty']],_0x3b524f=[_0x45c4ec['body'][_0x2d251b(0x245)]],_0x2eea7f=[_0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x2bb)]],_0x2b8026=[_0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x200)]],_0xb7b423=[_0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x2bc)]];else var _0x2b1711=[..._0x45c4ec['body']['product_name']],_0x16c05f=[..._0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x1a0)]],_0x1ce951=[..._0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x268)]],_0x10c1c7=[..._0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x1d0)]],_0x3b524f=[..._0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x245)]],_0x2eea7f=[..._0x45c4ec[_0x2d251b(0x1c6)]['product_code_hide']],_0x2b8026=[..._0x45c4ec[_0x2d251b(0x1c6)]['primary_code_hide']],_0xb7b423=[..._0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x2bc)]];const _0x7c3265=_0x2b1711[_0x2d251b(0x2af)](_0x7ad7a=>{return _0x7ad7a={'product_name':_0x7ad7a};});_0x16c05f[_0x2d251b(0x1f8)]((_0x20fb46,_0x468ce3)=>{var _0x2b064f=_0x2d251b;_0x7c3265[_0x468ce3][_0x2b064f(0x1a0)]=_0x20fb46;}),_0x1ce951['forEach']((_0x5b6180,_0x28a3e8)=>{var _0x44e87c=_0x2d251b;_0x7c3265[_0x28a3e8][_0x44e87c(0x28e)]=_0x5b6180;}),_0x10c1c7['forEach']((_0x88d8f6,_0x4a9346)=>{var _0xb3bff8=_0x2d251b;_0x7c3265[_0x4a9346][_0xb3bff8(0x1d0)]=_0x88d8f6;}),_0x3b524f[_0x2d251b(0x1f8)]((_0x487a8b,_0x1c4db4)=>{var _0x57fc15=_0x2d251b;_0x7c3265[_0x1c4db4][_0x57fc15(0x18d)]=_0x487a8b;}),_0x2eea7f['forEach']((_0x3a8c13,_0x4b4185)=>{var _0x50a8b4=_0x2d251b;_0x7c3265[_0x4b4185][_0x50a8b4(0x288)]=_0x3a8c13;}),_0x2b8026[_0x2d251b(0x1f8)]((_0x2becad,_0x334b36)=>{_0x7c3265[_0x334b36]['primary_code']=_0x2becad;}),_0xb7b423[_0x2d251b(0x1f8)]((_0x1e595d,_0x4621b6)=>{var _0x7377a3=_0x2d251b;_0x7c3265[_0x4621b6][_0x7377a3(0x195)]=_0x1e595d;}),_0x7c3265[_0x2d251b(0x1f8)](_0x415bb1=>{var _0x14f182=_0x2d251b;console[_0x14f182(0x296)](_0x415bb1);const _0x28f718=_0x65f546[_0x14f182(0x1fe)][_0x14f182(0x2af)](_0x573195=>{var _0x533c83=_0x14f182;_0x573195[_0x533c83(0x1c1)]==_0x415bb1['product_name']&&_0x573195[_0x533c83(0x18d)]==_0x415bb1[_0x533c83(0x18d)]&&(console[_0x533c83(0x296)](parseInt(_0x573195[_0x533c83(0x2a2)])+_0x533c83(0x2ae)+parseInt(_0x415bb1[_0x533c83(0x1d0)])),_0x573195[_0x533c83(0x2a2)]=parseInt(_0x573195[_0x533c83(0x2a2)])-parseInt(_0x415bb1[_0x533c83(0x1d0)]));});}),await _0x65f546[_0x2d251b(0x25e)]();var _0x51cee9=0x0;_0x7c3265[_0x2d251b(0x1f8)](_0x854c6e=>{var _0x5a7e6a=_0x2d251b;(parseInt(_0x854c6e[_0x5a7e6a(0x1a0)])<parseInt(_0x854c6e[_0x5a7e6a(0x1d0)])||parseInt(_0x854c6e[_0x5a7e6a(0x28e)])<parseInt(_0x854c6e['return_qty']))&&_0x51cee9++;});if(_0x51cee9!=0x0)return _0x45c4ec['flash']('errors',_0x2d251b(0x292)),_0x6a083e['redirect'](_0x2d251b(0x1ba));const _0x493d92=new purchases_return_finished({'invoice':_0xefe36c,'suppliers':_0x45c4ec['body'][_0x2d251b(0x298)],'date':_0xfb2b9f,'warehouse_name':_0x41abdb,'return_product':_0x7c3265,'note':_0x8901,'room':_0x26cdd3,'to_warehouse_name':_0x4314f5,'to_room':_0x2309c0}),_0x5bcb10=await _0x493d92[_0x2d251b(0x25e)](),_0x5058fd=await purchases_return_finished['findOne']({'invoice':_0xefe36c}),_0x45b56f=await warehouse[_0x2d251b(0x289)]({'name':_0x4314f5,'room':_0x2309c0,'warehouse_category':_0x2d251b(0x22d)});_0x5058fd[_0x2d251b(0x1d2)][_0x2d251b(0x1f8)](_0x4f31c3=>{var _0x403823=_0x2d251b,_0x1f819a=0x0;const _0x2295c6=_0x45b56f[_0x403823(0x1fe)][_0x403823(0x2af)](_0x27be6d=>{var _0x21519c=_0x403823;console[_0x21519c(0x296)](_0x27be6d[_0x21519c(0x1c1)]+'=='+_0x4f31c3[_0x21519c(0x1c1)]+'&&'+_0x27be6d[_0x21519c(0x18d)]+'=='+_0x4f31c3[_0x21519c(0x18d)]),_0x27be6d['product_name']==_0x4f31c3[_0x21519c(0x1c1)]&&_0x27be6d[_0x21519c(0x18d)]==_0x4f31c3['bay']&&(_0x27be6d[_0x21519c(0x2a2)]=parseInt(_0x27be6d[_0x21519c(0x2a2)])-parseInt(_0x4f31c3[_0x21519c(0x1d0)]),_0x1f819a++);});_0x1f819a=='0'&&(_0x45b56f[_0x403823(0x1fe)]=_0x45b56f[_0x403823(0x1fe)][_0x403823(0x1a8)]({'product_name':_0x4f31c3[_0x403823(0x1c1)],'product_stock':_0x4f31c3[_0x403823(0x1d0)],'primary_code':_0x4f31c3[_0x403823(0x1e9)],'secondary_code':_0x4f31c3[_0x403823(0x195)],'product_code':_0x4f31c3['product_code'],'bay':_0x4f31c3['bay'],'maxProducts':0xf423f}));}),await _0x45b56f[_0x2d251b(0x25e)]();const _0x27f81d=await purchases_finished[_0x2d251b(0x289)]({'invoice':_0xefe36c});_0x27f81d[_0x2d251b(0x1d1)]=_0x2d251b(0x1c3);const _0x33629e=await _0x27f81d[_0x2d251b(0x25e)](),_0x32bacd=new s_payment_data({'invoice':_0xefe36c,'suppliers':_0x45c4ec['body'][_0x2d251b(0x298)],'reason':_0x2d251b(0x22e)});await _0x32bacd[_0x2d251b(0x25e)]();const _0x6c927a=await master_shop[_0x2d251b(0x202)](),_0x28b570=await email_settings[_0x2d251b(0x289)](),_0x3feed2=await suppliers[_0x2d251b(0x289)]({'name':_0x45c4ec[_0x2d251b(0x1c6)][_0x2d251b(0x298)]});_0x6c927a[0x0]['currency_placement']==0x1?(right_currency=_0x6c927a[0x0][_0x2d251b(0x278)],left_currency=''):(right_currency='',left_currency=_0x6c927a[0x0]['currency']);var _0x405b69=_0x2b1711,_0x4f4542=_0x10c1c7,_0x2e3fb1='',_0x2d567f;for(_0x2d567f in _0x405b69){_0x2e3fb1+=_0x2d251b(0x20c)+_0x2d251b(0x287)+_0x405b69[_0x2d567f]+_0x2d251b(0x1aa)+_0x2d251b(0x287)+_0x4f4542[_0x2d567f]+_0x2d251b(0x1aa)+'</tr>';}let _0x4f7493=nodemailer[_0x2d251b(0x250)]({'service':'gmail','auth':{'user':_0x28b570[_0x2d251b(0x231)],'pass':_0x28b570[_0x2d251b(0x1cc)]}}),_0x14a66b={'from':_0x28b570[_0x2d251b(0x231)],'to':_0x3feed2[_0x2d251b(0x231)],'subject':'Purchase\x20Return\x20Mail','attachments':[{'filename':_0x2d251b(0x220),'path':__dirname+_0x2d251b(0x225)+_0x2d251b(0x28d)+_0x6c927a[0x0][_0x2d251b(0x28b)],'cid':_0x2d251b(0x22a)}],'html':_0x2d251b(0x1e5)+_0x2d251b(0x27f)+_0x2d251b(0x1e3)+_0x2d251b(0x1fa)+_0x2d251b(0x25c)+'<div>'+_0x2d251b(0x1fc)+_0x2d251b(0x1e2)+_0x2d251b(0x1fa)+_0x2d251b(0x23f)+_0x6c927a[0x0][_0x2d251b(0x249)]+_0x2d251b(0x23e)+_0x2d251b(0x1e2)+_0x2d251b(0x1e2)+_0x2d251b(0x1fd)+_0x2d251b(0x1fa)+_0x2d251b(0x192)+_0x2d251b(0x1f6)+_0xefe36c+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2d251b(0x216)+_0xfb2b9f+'\x20'+_0x2d251b(0x1d7)+'</h5>'+_0x2d251b(0x1e2)+_0x2d251b(0x228)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2d251b(0x20c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2d251b(0x210)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+'</tr>'+_0x2d251b(0x27c)+_0x2d251b(0x235)+'\x20'+_0x2e3fb1+'\x20'+_0x2d251b(0x2a9)+_0x2d251b(0x1ee)+'<div>'+_0x2d251b(0x20b)+'<h5>'+_0x6c927a[0x0][_0x2d251b(0x249)]+'</h5>'+_0x2d251b(0x1e2)+'</div>'+_0x2d251b(0x1f5)};_0x4f7493[_0x2d251b(0x1c9)](_0x14a66b,function(_0x33d4bd,_0x13b36a){var _0x1b82ca=_0x2d251b;_0x33d4bd?console['log'](_0x1b82ca(0x24e)):console[_0x1b82ca(0x296)](_0x1b82ca(0x285));}),_0x45c4ec[_0x2d251b(0x206)](_0x2d251b(0x18b),'purchases\x20item\x20return\x20successfull'),_0x6a083e[_0x2d251b(0x23d)](_0x2d251b(0x1f2));}catch(_0x2b1215){_0x6a083e[_0x2d251b(0x1e0)](0xc8)[_0x2d251b(0x1b4)]({'message':_0x2b1215[_0x2d251b(0x291)]});}}),router[a0_0x419498(0x2a0)](a0_0x419498(0x254),auth,async(_0x4e167b,_0x2a8c38)=>{var _0x2587b6=a0_0x419498;try{const {username:_0x24505b,email:_0xd30a79,role:_0x432ffe}=_0x4e167b[_0x2587b6(0x1e8)],_0xffc58e=_0x4e167b[_0x2587b6(0x1e8)],_0x484cd9=await profile['findOne']({'email':_0xffc58e[_0x2587b6(0x231)]}),_0x36a31a=await master_shop[_0x2587b6(0x202)](),_0xb30252=_0x4e167b[_0x2587b6(0x233)]['id'],_0xa59a0f=await purchases_finished[_0x2587b6(0x238)](_0xb30252);if(_0x36a31a[0x0]['language']=='English\x20(US)')var _0xa7cc90=users[_0x2587b6(0x272)];else{if(_0x36a31a[0x0][_0x2587b6(0x259)]=='Hindi')var _0xa7cc90=users[_0x2587b6(0x1af)];else{if(_0x36a31a[0x0][_0x2587b6(0x259)]==_0x2587b6(0x266))var _0xa7cc90=users[_0x2587b6(0x266)];else{if(_0x36a31a[0x0][_0x2587b6(0x259)]==_0x2587b6(0x209))var _0xa7cc90=users[_0x2587b6(0x209)];else{if(_0x36a31a[0x0]['language']==_0x2587b6(0x256))var _0xa7cc90=users[_0x2587b6(0x256)];else{if(_0x36a31a[0x0]['language']==_0x2587b6(0x1d4))var _0xa7cc90=users[_0x2587b6(0x2a7)];else{if(_0x36a31a[0x0][_0x2587b6(0x259)]==_0x2587b6(0x188))var _0xa7cc90=users[_0x2587b6(0x188)];else{if(_0x36a31a[0x0]['language']==_0x2587b6(0x189))var _0xa7cc90=users[_0x2587b6(0x2c4)];}}}}}}}_0x2a8c38[_0x2587b6(0x242)](_0x2587b6(0x186),{'success':_0x4e167b[_0x2587b6(0x206)](_0x2587b6(0x18b)),'errors':_0x4e167b[_0x2587b6(0x206)](_0x2587b6(0x24c)),'role':_0xffc58e,'profile':_0x484cd9,'alldata':_0xa59a0f,'master_shop':_0x36a31a,'language':_0xa7cc90}),console[_0x2587b6(0x296)](alldata);}catch(_0x332181){console[_0x2587b6(0x296)](_0x332181);}}),router[a0_0x419498(0x1a9)]('/barcode_scanner',async(_0x1abd7a,_0x31d2cc)=>{var _0x47cc83=a0_0x419498;const {product_code:_0x405bb9}=_0x1abd7a[_0x47cc83(0x1c6)];var _0xbbf819;const _0x1e1237=await product[_0x47cc83(0x207)]([{'$match':{'primary_code':_0x405bb9}},{'$group':{'_id':_0x47cc83(0x28f),'name':{'$first':_0x47cc83(0x224)},'category':{'$first':'$category'},'brand':{'$first':_0x47cc83(0x1e1)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x47cc83(0x27e)},'product_code':{'$first':_0x47cc83(0x190)},'primary_code':{'$first':_0x47cc83(0x2b3)},'secondary_code':{'$first':_0x47cc83(0x1d9)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x47cc83(0x196)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'},'gross_price':{'$first':'$gross_price'},'sales_category':{'$first':_0x47cc83(0x19c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]),_0x47597c=await product[_0x47cc83(0x207)]([{'$match':{'secondary_code':_0x405bb9}},{'$group':{'_id':_0x47cc83(0x28f),'name':{'$first':_0x47cc83(0x224)},'category':{'$first':_0x47cc83(0x20e)},'brand':{'$first':_0x47cc83(0x1e1)},'unit':{'$first':_0x47cc83(0x2b2)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x47cc83(0x2b3)},'secondary_code':{'$first':_0x47cc83(0x1d9)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x47cc83(0x196)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x47cc83(0x243)},'gross_price':{'$first':'$gross_price'},'sales_category':{'$first':_0x47cc83(0x19c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1}}]);if(_0x1e1237[_0x47cc83(0x21d)]>0x0)_0xbbf819=_0x1e1237;else _0x47597c['length']>0x0&&(_0xbbf819=_0x47597c);_0x31d2cc[_0x47cc83(0x1b4)](_0xbbf819);}),router[a0_0x419498(0x1a9)](a0_0x419498(0x1c5),async(_0x1a0dc9,_0x13445a)=>{var _0x1a04ce=a0_0x419498;const {productCode:_0x180223,bay:_0x3fa9e0,warehouses:_0x3ec424,room:_0x1473e9}=_0x1a0dc9[_0x1a04ce(0x1c6)];console['log'](_0x1a0dc9[_0x1a04ce(0x1c6)]);try{const _0x43a09a=await warehouse[_0x1a04ce(0x207)]([{'$match':{'name':_0x3ec424,'room':_0x1473e9}},{'$unwind':_0x1a04ce(0x1a3)},{'$match':{'product_details.bay':parseInt(_0x3fa9e0)}},{'$group':{'_id':_0x1a04ce(0x1a6),'name':{'$first':_0x1a04ce(0x24f)},'product_stock':{'$first':_0x1a04ce(0x252)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x1a04ce(0x1d6)}}}]);_0x13445a[_0x1a04ce(0x1e0)](0xc8)[_0x1a04ce(0x1b4)](_0x43a09a);}catch(_0x2686b2){_0x13445a[_0x1a04ce(0x1e0)](0x194)[_0x1a04ce(0x1b4)]({'message':_0x2686b2[_0x1a04ce(0x291)]});}}),router['post'](a0_0x419498(0x246),async(_0x543614,_0x50c981)=>{var _0x4d396e=a0_0x419498;const {product_code:_0x2f5f4f}=_0x543614[_0x4d396e(0x1c6)];var _0x167225;const _0x2223e=await product['aggregate']([{'$match':{'primary_code':_0x2f5f4f,'type_products':_0x4d396e(0x296)}},{'$group':{'_id':_0x4d396e(0x28f),'name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':_0x4d396e(0x1e1)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x4d396e(0x27e)},'product_code':{'$first':_0x4d396e(0x190)},'primary_code':{'$first':_0x4d396e(0x2b3)},'secondary_code':{'$first':_0x4d396e(0x1d9)},'maxStocks':{'$first':_0x4d396e(0x1e7)},'maxProdPerUnit':{'$first':_0x4d396e(0x196)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x4d396e(0x243)},'gross_price':{'$first':'$gross_price'},'sales_category':{'$first':_0x4d396e(0x19c)},'type_products':{'$first':_0x4d396e(0x230)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1,'type_products':0x1}}]);console[_0x4d396e(0x296)](_0x2223e);const _0x58ece9=await product[_0x4d396e(0x207)]([{'$match':{'secondary_code':_0x2f5f4f,'type_products':'log'}},{'$group':{'_id':_0x4d396e(0x28f),'name':{'$first':_0x4d396e(0x224)},'category':{'$first':_0x4d396e(0x20e)},'brand':{'$first':_0x4d396e(0x1e1)},'unit':{'$first':'$unit'},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x4d396e(0x190)},'primary_code':{'$first':_0x4d396e(0x2b3)},'secondary_code':{'$first':_0x4d396e(0x1d9)},'maxStocks':{'$first':_0x4d396e(0x1e7)},'maxProdPerUnit':{'$first':_0x4d396e(0x196)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x4d396e(0x243)},'gross_price':{'$first':'$gross_price'},'sales_category':{'$first':'$sales_category'},'type_products':{'$first':_0x4d396e(0x230)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1,'gross_price':0x1,'sales_category':0x1,'type_products':0x1}}]);if(_0x2223e[_0x4d396e(0x21d)]>0x0)_0x167225=_0x2223e;else _0x58ece9[_0x4d396e(0x21d)]>0x0&&(_0x167225=_0x58ece9);_0x50c981[_0x4d396e(0x1b4)](_0x167225);}),module[a0_0x419498(0x269)]=router;