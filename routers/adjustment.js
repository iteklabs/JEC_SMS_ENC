function a0_0x2c53(){var _0xbb2c07=['$product_details.level','/picking_list/PDF_adjustment_rm/','$product_details.product_name','storage','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','isAllowEdit','<strong>\x20Regards\x20</strong>','log','Primary_Units','forEach','$product_details._id','error','params','/preview/:id','$product_details.batch_code','adjustment\x20data\x20update\x20successfully','Shelves','<tbody\x20style=\x22text-align:\x20center;\x22>','product_code','../middleware/auth','status','second1','$date','product_details','prod_cat','logo','post','Logo.png','string','</tbody>','_id','ADJ-','exports','findOne','An\x20error\x20occurred.','map','role','<h2>\x20','/adjustment/preview/','password','<h5>','</head><body>','$product_details.maxPerUnit','1559500pxOjfg','Spanish','room','/../public','Raw\x20Materials','express','production_date','New_Qty_Converted','max_per_unit','../models/all_models','True','$product.product_name','padStart','filter','$product_details.production_date','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','7xJXBXj','bay','prod_invoice','room_names','</td>','secondary_unit','<div>','6QbEhzZ','English','/barcode_scanner','invoice','<span\x20style=\x22float:\x20right;\x22>','/view/add_adjustment','Floor','id_transaction','$product','German','</table>','$product_details.rack','\x20Order\x20Number\x20:\x20','Secondary_units','primary_code','$room','Portuguese\x20(BR)','aggregate','<!DOCTYPE\x20html>','\x20</h2>','</tr>','French','$product_details','product_name','5053745eZBuCo','/adjustment/view','$product_details.secondary_unit','host','get','../public/language/languages.json','<tr>','$product_details.unit','RMSEmail','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Enclosed','catch','$product_details.product_stock','</body></html>','findById','$product_details.bin','product','stock','render','\x20Order\x20Date\x20:\x20','Rooms','json','<table\x20style=\x22width:\x20100%\x20!important;\x22>','random','secondary_code','warehouse_name','False','New_Qty_Converted_adj','</h5>','master','all','$product_details.floorlevel','</span>','$product_details.product_cat','8195454bSpLIQ','$finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','adjustment\x20Finalized\x20successfully','length','back','/CheckingWarehouse','\x20<>\x20','Return\x20Goods','batch_code','Email\x20sent\x20successfully','Error\x20Occurs','prod_code','warehouse','Chinese','1078512oQoxmx','prod_name','/view/:id','save','date','redirect','prime1','$warehouse_name','$product_details.bay','stockBefore','email','30yOtmpv','</thead>','$product_details.expiry_date','Receiving\x20Area','floorlevel','flash','Ambient','$product_details.primary_code','slice','errors','Portuguese','46046CdbPlp','body','expiry_date','types','Arabic\x20(ae)','$name','<hr\x20class=\x22my-3\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','floor','Adjustment\x20Mail','$invoice','user','product_stock','type','level','rack','English\x20(US)','foreach\x20newproduct','Arabic','$product_details.invoice','Enabled','$product_details.storage','language','add_adjustment','3708288izyCAc','Hindi','$product_details.type','unit','Router','staff','nodemailer','adjust_qty','<html><head><title></title>','edit_adjustment','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','</div>','split','maxperunit','6092792vZAFea','site_title','id_transaction_from','new_adjust_qty','message','push','Level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$isAllowEdit','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.secondary_code','$_id','$product_details.isle','$product_details.product_code','bin','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','find','note','success'];a0_0x2c53=function(){return _0xbb2c07;};return a0_0x2c53();}var a0_0x140f3a=a0_0x5768;(function(_0x40977d,_0x430142){var _0x2ea20a=a0_0x5768,_0x24853b=_0x40977d();while(!![]){try{var _0x43e01c=-parseInt(_0x2ea20a(0x2aa))/0x1+-parseInt(_0x2ea20a(0x245))/0x2+parseInt(_0x2ea20a(0x22f))/0x3+-parseInt(_0x2ea20a(0x25d))/0x4+-parseInt(_0x2ea20a(0x1fd))/0x5*(-parseInt(_0x2ea20a(0x1e5))/0x6)+parseInt(_0x2ea20a(0x2ba))/0x7*(-parseInt(_0x2ea20a(0x26b))/0x8)+-parseInt(_0x2ea20a(0x220))/0x9*(-parseInt(_0x2ea20a(0x23a))/0xa);if(_0x43e01c===_0x430142)break;else _0x24853b['push'](_0x24853b['shift']());}catch(_0x3a3e58){_0x24853b['push'](_0x24853b['shift']());}}}(a0_0x2c53,0xcad9d));function a0_0x5768(_0xd794aa,_0x5a452a){var _0x2c5333=a0_0x2c53();return a0_0x5768=function(_0x5768eb,_0x170a36){_0x5768eb=_0x5768eb-0x1e4;var _0x467f3b=_0x2c5333[_0x5768eb];return _0x467f3b;},a0_0x5768(_0xd794aa,_0x5a452a);}const express=require(a0_0x140f3a(0x2af)),app=express(),router=express[a0_0x140f3a(0x261)](),auth=require(a0_0x140f3a(0x292)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x140f3a(0x2b3)),users=require(a0_0x140f3a(0x202)),nodemailer=require(a0_0x140f3a(0x263));router[a0_0x140f3a(0x201)]('/view',auth,async(_0x759772,_0x2ed24b)=>{var _0xdf21c7=a0_0x140f3a;try{const {username:_0x89b99f,email:_0x1f2af1,role:_0x11ee09}=_0x759772[_0xdf21c7(0x250)],_0x3a83c8=_0x759772['user'],_0x4eb087=await profile['findOne']({'email':_0x3a83c8['email']}),_0x5e2397=await master_shop[_0xdf21c7(0x27c)]();console['log'](_0xdf21c7(0x21b),_0x5e2397);let _0x445bcf;if(_0x3a83c8[_0xdf21c7(0x2a3)]==_0xdf21c7(0x262)){const _0x191c7e=await staff[_0xdf21c7(0x2a0)]({'email':_0x3a83c8[_0xdf21c7(0x239)]});_0x445bcf=await warehouse[_0xdf21c7(0x27c)]({'status':'Enabled','name':_0x191c7e[_0xdf21c7(0x22d)]});}else _0x445bcf=await warehouse[_0xdf21c7(0x27c)]({'status':_0xdf21c7(0x259)});const _0x20a9ba=await product[_0xdf21c7(0x27c)]();let _0x1f6a63;if(_0x3a83c8['role']==_0xdf21c7(0x262)){const _0x283177=await staff[_0xdf21c7(0x2a0)]({'email':_0x3a83c8['email']});_0x1f6a63=await adjustment[_0xdf21c7(0x27c)]({'warehouse_name':_0x283177[_0xdf21c7(0x22d)]});}else _0x1f6a63=await adjustment[_0xdf21c7(0x1f6)]([{'$unwind':_0xdf21c7(0x1ed)},{'$group':{'_id':_0xdf21c7(0x277),'invoice':{'$first':_0xdf21c7(0x24f)},'date':{'$first':_0xdf21c7(0x295)},'warehouse_name':{'$first':_0xdf21c7(0x236)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0xdf21c7(0x221)},'isAllowEdit':{'$first':_0xdf21c7(0x274)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x5e2397[0x0][_0xdf21c7(0x25b)]=='English\x20(US)'){var _0x30120d=users[_0xdf21c7(0x1e6)];console['log'](_0x30120d);}else{if(_0x5e2397[0x0][_0xdf21c7(0x25b)]=='Hindi')var _0x30120d=users[_0xdf21c7(0x25e)];else{if(_0x5e2397[0x0]['language']==_0xdf21c7(0x1ee))var _0x30120d=users[_0xdf21c7(0x1ee)];else{if(_0x5e2397[0x0][_0xdf21c7(0x25b)]=='Spanish')var _0x30120d=users[_0xdf21c7(0x2ab)];else{if(_0x5e2397[0x0][_0xdf21c7(0x25b)]==_0xdf21c7(0x1fa))var _0x30120d=users[_0xdf21c7(0x1fa)];else{if(_0x5e2397[0x0][_0xdf21c7(0x25b)]==_0xdf21c7(0x1f5))var _0x30120d=users[_0xdf21c7(0x244)];else{if(_0x5e2397[0x0][_0xdf21c7(0x25b)]==_0xdf21c7(0x22e))var _0x30120d=users[_0xdf21c7(0x22e)];else{if(_0x5e2397[0x0][_0xdf21c7(0x25b)]==_0xdf21c7(0x249))var _0x30120d=users[_0xdf21c7(0x257)];}}}}}}}_0x2ed24b[_0xdf21c7(0x210)]('adjustment',{'success':_0x759772['flash']('success'),'errors':_0x759772[_0xdf21c7(0x23f)](_0xdf21c7(0x243)),'role':_0x3a83c8,'profile':_0x4eb087,'warehouse':_0x445bcf,'product':_0x20a9ba,'adjustment':_0x1f6a63,'master_shop':_0x5e2397,'language':_0x30120d});}catch(_0x5a3984){console[_0xdf21c7(0x286)](_0x5a3984);}});async function getRandom8DigitNumber(){var _0x8d274c=a0_0x140f3a;const _0x55403a=0x989680,_0x1c11a0=0x5f5e0ff,_0x538117=Math[_0x8d274c(0x24d)](Math[_0x8d274c(0x215)]()*(_0x1c11a0-_0x55403a+0x1))+_0x55403a;var _0x5e1185;const _0x5b3be7=await adjustment[_0x8d274c(0x2a0)]({'invoice':_0x8d274c(0x29e)+_0x538117});return _0x5b3be7&&_0x5b3be7[_0x8d274c(0x224)]>0x0?_0x5e1185=_0x8d274c(0x29e)+_0x538117:_0x5e1185=_0x8d274c(0x29e)+_0x538117,_0x5e1185;}router[a0_0x140f3a(0x201)](a0_0x140f3a(0x1ea),auth,async(_0x32db2c,_0x3d63e9)=>{var _0x2631e0=a0_0x140f3a;try{const {username:_0x58392f,email:_0x17b3f9,role:_0x17509a}=_0x32db2c['user'],_0x4939de=_0x32db2c[_0x2631e0(0x250)],_0x5ac746=await profile[_0x2631e0(0x2a0)]({'email':_0x4939de[_0x2631e0(0x239)]}),_0x533860=await master_shop['find']();let _0x4056bb;if(_0x4939de[_0x2631e0(0x2a3)]==_0x2631e0(0x262)){const _0x30886b=await staff[_0x2631e0(0x2a0)]({'email':_0x4939de[_0x2631e0(0x239)]});_0x4056bb=await warehouse[_0x2631e0(0x1f6)]([{'$match':{'status':_0x2631e0(0x259),'name':_0x30886b['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x2631e0(0x228)}}},{'$group':{'_id':_0x2631e0(0x24a),'name':{'$first':_0x2631e0(0x24a)}}}]);}else _0x4056bb=await warehouse['aggregate']([{'$match':{'status':_0x2631e0(0x259),'warehouse_category':_0x2631e0(0x2ae),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x2631e0(0x24a),'name':{'$first':_0x2631e0(0x24a)}}}]);const _0x1e3415=await product[_0x2631e0(0x27c)]({}),_0x2b27b6=await adjustment['find']({}),_0x24ebbf=_0x2b27b6[_0x2631e0(0x224)]+0x1,_0x2084f7='ADJ-'+_0x24ebbf['toString']()[_0x2631e0(0x2b6)](0x5,'0');var _0x338f06=[_0x2631e0(0x240),_0x2631e0(0x208),'Return\x20Rooms'];if(_0x533860[0x0][_0x2631e0(0x25b)]==_0x2631e0(0x255))var _0x313409=users['English'];else{if(_0x533860[0x0][_0x2631e0(0x25b)]==_0x2631e0(0x25e))var _0x313409=users[_0x2631e0(0x25e)];else{if(_0x533860[0x0][_0x2631e0(0x25b)]==_0x2631e0(0x1ee))var _0x313409=users[_0x2631e0(0x1ee)];else{if(_0x533860[0x0][_0x2631e0(0x25b)]==_0x2631e0(0x2ab))var _0x313409=users[_0x2631e0(0x2ab)];else{if(_0x533860[0x0][_0x2631e0(0x25b)]=='French')var _0x313409=users[_0x2631e0(0x1fa)];else{if(_0x533860[0x0][_0x2631e0(0x25b)]==_0x2631e0(0x1f5))var _0x313409=users['Portuguese'];else{if(_0x533860[0x0][_0x2631e0(0x25b)]=='Chinese')var _0x313409=users[_0x2631e0(0x22e)];else{if(_0x533860[0x0][_0x2631e0(0x25b)]=='Arabic\x20(ae)')var _0x313409=users[_0x2631e0(0x257)];}}}}}}}const _0x44195e=getRandom8DigitNumber();_0x44195e['then'](_0x488414=>{var _0x3b8c9b=_0x2631e0;_0x3d63e9[_0x3b8c9b(0x210)](_0x3b8c9b(0x25c),{'success':_0x32db2c[_0x3b8c9b(0x23f)](_0x3b8c9b(0x27e)),'errors':_0x32db2c[_0x3b8c9b(0x23f)](_0x3b8c9b(0x243)),'role':_0x4939de,'profile':_0x5ac746,'warehouse':_0x4056bb,'product':_0x1e3415,'master_shop':_0x533860,'language':_0x313409,'rooms_data':_0x338f06,'invoice_no':_0x488414});})[_0x2631e0(0x209)](_0x4d06a6=>{var _0x11f216=_0x2631e0;_0x32db2c['flash'](_0x11f216(0x243),_0x11f216(0x206)),_0x3d63e9['redirect'](_0x11f216(0x1fe));});}catch(_0x4cba7d){console[_0x2631e0(0x286)](_0x4cba7d);}}),router[a0_0x140f3a(0x299)](a0_0x140f3a(0x1ea),auth,async(_0x26807,_0x3d39e6)=>{var _0x457cc2=a0_0x140f3a;try{const {warehouse_name:_0x2d8eec,date:_0x2066bf,prod_name:_0x476b71,level:_0x350f19,isle:_0x21f10b,pallet:_0x4387ad,stock:_0x4ec547,types:_0x37b7ab,adjust_qty:_0x3c7f38,new_adjust_qty:_0x59a0f2,note:_0x3970c8,Room_name:_0x1ed608,invoice:_0x4c5216,JO_number:_0x523e2b,expiry_date:_0x503895}=_0x26807[_0x457cc2(0x246)];if(typeof _0x476b71==_0x457cc2(0x29b))var _0x444eb9=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x230)]],_0x13fb30=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x253)]],_0x71b1b1=[_0x26807['body'][_0x457cc2(0x20f)]],_0x5a2568=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x248)]],_0x68b59=[_0x26807[_0x457cc2(0x246)]['New_Qty_Converted_adj']],_0x54f0b8=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x2b1)]],_0x66b0e=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x287)]],_0x597c05=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x1f2)]],_0x495b12=[_0x26807[_0x457cc2(0x246)]['prod_code']],_0x1f0a96=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x229)]],_0x1d3164=[_0x26807[_0x457cc2(0x246)]['expiry_date']],_0x56cd72=[_0x26807['body'][_0x457cc2(0x2b2)]],_0x2373fa=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x2b0)]],_0x21701a=[_0x26807['body'][_0x457cc2(0x297)]],_0x515c06=[_0x26807[_0x457cc2(0x246)]['Rooms']],_0x2a50c7=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x235)]],_0x4cd2b3=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x294)]],_0x201c31=[_0x26807['body']['prod_invoice']],_0x3c0944=[_0x26807[_0x457cc2(0x246)][_0x457cc2(0x1ec)]];else var _0x444eb9=[..._0x26807['body']['prod_name']],_0x13fb30=[..._0x26807[_0x457cc2(0x246)][_0x457cc2(0x253)]],_0x71b1b1=[..._0x26807[_0x457cc2(0x246)]['stock']],_0x5a2568=[..._0x26807[_0x457cc2(0x246)][_0x457cc2(0x248)]],_0x68b59=[..._0x26807[_0x457cc2(0x246)]['New_Qty_Converted_adj']],_0x54f0b8=[..._0x26807[_0x457cc2(0x246)]['New_Qty_Converted']],_0x66b0e=[..._0x26807['body'][_0x457cc2(0x260)]],_0x597c05=[..._0x26807[_0x457cc2(0x246)][_0x457cc2(0x1f2)]],_0x495b12=[..._0x26807[_0x457cc2(0x246)][_0x457cc2(0x22c)]],_0x1f0a96=[..._0x26807[_0x457cc2(0x246)][_0x457cc2(0x229)]],_0x1d3164=[..._0x26807[_0x457cc2(0x246)]['expiry_date']],_0x56cd72=[..._0x26807['body'][_0x457cc2(0x2b2)]],_0x2373fa=[..._0x26807[_0x457cc2(0x246)]['production_date']],_0x21701a=[..._0x26807['body'][_0x457cc2(0x297)]],_0x515c06=[..._0x26807['body'][_0x457cc2(0x212)]],_0x2a50c7=[..._0x26807['body'][_0x457cc2(0x235)]],_0x4cd2b3=[..._0x26807[_0x457cc2(0x246)][_0x457cc2(0x294)]],_0x201c31=[..._0x26807[_0x457cc2(0x246)][_0x457cc2(0x2bc)]],_0x3c0944=[..._0x26807[_0x457cc2(0x246)][_0x457cc2(0x1ec)]];const _0x2c5a4e=_0x444eb9[_0x457cc2(0x2a2)](_0x3330ff=>{return _0x3330ff={'product_name':_0x3330ff};});_0x13fb30[_0x457cc2(0x288)]((_0x64933b,_0x146455)=>{var _0x4408d6=_0x457cc2;_0x515c06[_0x4408d6(0x288)]((_0x4bcf4e,_0x1c3963)=>{var _0x5b7f7c=_0x4408d6;if(_0x4bcf4e==_0x5b7f7c(0x23d)&&_0x146455==_0x1c3963){var _0x1ebd3b=_0x64933b[_0x5b7f7c(0x242)](0x3);_0x2c5a4e[_0x146455][_0x5b7f7c(0x282)]=_0x64933b[0x0],_0x2c5a4e[_0x146455][_0x5b7f7c(0x254)]=_0x64933b[0x1],_0x2c5a4e[_0x146455]['bay']=0x0,_0x2c5a4e[_0x146455][_0x5b7f7c(0x27a)]=0x0,_0x2c5a4e[_0x146455][_0x5b7f7c(0x252)]=_0x5b7f7c(0x1eb),_0x2c5a4e[_0x146455]['floorlevel']=_0x1ebd3b;}else{if(_0x4bcf4e==_0x5b7f7c(0x28f)&&_0x146455==_0x1c3963){var _0x1ebd3b=_0x64933b[_0x5b7f7c(0x242)](0x3);_0x2c5a4e[_0x146455][_0x5b7f7c(0x282)]=_0x64933b[0x0],_0x2c5a4e[_0x146455][_0x5b7f7c(0x254)]=_0x64933b[0x1],_0x2c5a4e[_0x146455]['bay']=0x0,_0x2c5a4e[_0x146455][_0x5b7f7c(0x27a)]=0x0,_0x2c5a4e[_0x146455][_0x5b7f7c(0x252)]=_0x5b7f7c(0x1eb),_0x2c5a4e[_0x146455]['floorlevel']=_0x64933b[0x5];}else{if(_0x146455==_0x1c3963){var _0x42a25a;if(_0x64933b[0x4]=='L')_0x42a25a=_0x5b7f7c(0x271);else _0x64933b[0x4]=='F'&&(_0x42a25a=_0x5b7f7c(0x1eb));_0x2c5a4e[_0x146455][_0x5b7f7c(0x282)]=_0x64933b[0x0],_0x2c5a4e[_0x146455][_0x5b7f7c(0x254)]=_0x64933b[0x1],_0x2c5a4e[_0x146455][_0x5b7f7c(0x2bb)]=_0x64933b[0x2],_0x2c5a4e[_0x146455]['bin']=_0x64933b[0x3],_0x2c5a4e[_0x146455][_0x5b7f7c(0x252)]=_0x42a25a,_0x2c5a4e[_0x146455][_0x5b7f7c(0x23e)]=_0x64933b[0x5];}}}});}),_0x71b1b1[_0x457cc2(0x288)]((_0x4c8c2d,_0x55e47a)=>{var _0x2e5b61=_0x457cc2;_0x2c5a4e[_0x55e47a][_0x2e5b61(0x238)]=_0x4c8c2d;}),_0x3c0944[_0x457cc2(0x288)]((_0x9f0be,_0x33d3b2)=>{var _0x1717e9=_0x457cc2;_0x2c5a4e[_0x33d3b2][_0x1717e9(0x26d)]=_0x9f0be;}),_0x5a2568[_0x457cc2(0x288)]((_0xd758a8,_0x185e69)=>{var _0x1eef1b=_0x457cc2;_0x2c5a4e[_0x185e69][_0x1eef1b(0x248)]=_0xd758a8;}),_0x68b59[_0x457cc2(0x288)]((_0x272e70,_0x5ac316)=>{_0x2c5a4e[_0x5ac316]['adjust_qty']=_0x272e70;}),_0x54f0b8[_0x457cc2(0x288)]((_0xe6298e,_0x5caecc)=>{var _0x797d0=_0x457cc2;_0x2c5a4e[_0x5caecc][_0x797d0(0x26e)]=_0xe6298e;}),_0x66b0e[_0x457cc2(0x288)]((_0x301eb4,_0x1f05de)=>{var _0x499d39=_0x457cc2;_0x2c5a4e[_0x1f05de][_0x499d39(0x260)]=_0x301eb4;}),_0x597c05[_0x457cc2(0x288)]((_0x30dfe9,_0x3cf588)=>{_0x2c5a4e[_0x3cf588]['secondary_unit']=_0x30dfe9;}),_0x495b12[_0x457cc2(0x288)]((_0x7d12dc,_0x3c82b9)=>{_0x2c5a4e[_0x3c82b9]['product_code']=_0x7d12dc;}),_0x1f0a96[_0x457cc2(0x288)]((_0x255f60,_0x54e7a4)=>{_0x2c5a4e[_0x54e7a4]['batch_code']=_0x255f60;}),_0x1d3164[_0x457cc2(0x288)]((_0x50a065,_0x1a4b19)=>{var _0x3c13ff=_0x457cc2;_0x2c5a4e[_0x1a4b19][_0x3c13ff(0x247)]=_0x50a065;}),_0x56cd72[_0x457cc2(0x288)]((_0x569573,_0x22ef30)=>{_0x2c5a4e[_0x22ef30]['maxperunit']=_0x569573;}),_0x2373fa['forEach']((_0xfa7ca8,_0x5674e7)=>{_0x2c5a4e[_0x5674e7]['production_date']=_0xfa7ca8;}),_0x21701a[_0x457cc2(0x288)]((_0x5e663b,_0x3b9baa)=>{var _0x235ecd=_0x457cc2;_0x2c5a4e[_0x3b9baa][_0x235ecd(0x297)]=_0x5e663b;}),_0x515c06[_0x457cc2(0x288)]((_0x1c4ef0,_0x44424a)=>{_0x2c5a4e[_0x44424a]['room_names']=_0x1c4ef0;}),_0x2a50c7[_0x457cc2(0x288)]((_0x1e2688,_0x354765)=>{var _0x51e8df=_0x457cc2;_0x2c5a4e[_0x354765][_0x51e8df(0x1f3)]=_0x1e2688;}),_0x4cd2b3['forEach']((_0x567279,_0x42721f)=>{var _0x3d6ea0=_0x457cc2;_0x2c5a4e[_0x42721f][_0x3d6ea0(0x216)]=_0x567279;}),_0x201c31[_0x457cc2(0x288)]((_0x537b79,_0x258356)=>{var _0x58526b=_0x457cc2;_0x2c5a4e[_0x258356][_0x58526b(0x1e8)]=_0x537b79;});const _0xd3bff9=_0x2c5a4e[_0x457cc2(0x2b7)](_0x2fb526=>_0x2fb526[_0x457cc2(0x264)]!=='0'&&_0x2fb526[_0x457cc2(0x264)]!=='');var _0x1851fd=0x0;_0xd3bff9[_0x457cc2(0x288)](_0x38e557=>{var _0x3a28ee=_0x457cc2;console[_0x3a28ee(0x286)](_0x3a28ee(0x256),_0x38e557),parseInt(_0x38e557['adjust_qty'])<=0x0&&_0x1851fd++;});if(_0x1851fd!=0x0)return _0x26807[_0x457cc2(0x23f)](_0x457cc2(0x243),_0x457cc2(0x2b9)),_0x3d39e6['redirect'](_0x457cc2(0x225));const _0x4d4975=new adjustment({'warehouse_name':_0x2d8eec,'date':_0x2066bf,'product':_0xd3bff9,'note':_0x3970c8,'room':_0x1ed608,'invoice':_0x4c5216,'JO_number':_0x523e2b,'expiry_date':_0x503895}),_0x5326a5=await _0x4d4975[_0x457cc2(0x232)]();_0x26807[_0x457cc2(0x23f)](_0x457cc2(0x27e),'adjustment\x20add\x20successfull'),_0x3d39e6[_0x457cc2(0x234)](_0x457cc2(0x2a5)+_0x5326a5[_0x457cc2(0x29d)]);}catch(_0x4af90c){console[_0x457cc2(0x286)](_0x4af90c),_0x3d39e6[_0x457cc2(0x293)](0xc8)['json']({'message':_0x4af90c[_0x457cc2(0x26f)]});}}),router[a0_0x140f3a(0x201)](a0_0x140f3a(0x28c),auth,async(_0x4d498e,_0x128d3f)=>{var _0x564789=a0_0x140f3a;try{const {username:_0x267b3c,email:_0x4120e3,role:_0x5b664a}=_0x4d498e[_0x564789(0x250)],_0x57b970=_0x4d498e['user'],_0x338a3c=await profile[_0x564789(0x2a0)]({'email':_0x57b970[_0x564789(0x239)]}),_0x111fef=await master_shop['find'](),_0x3fbccd=_0x4d498e['params']['id'],_0xb52e5d=await adjustment[_0x564789(0x20c)]({'_id':_0x3fbccd}),_0x4adf48=await purchases[_0x564789(0x1f6)]([{'$match':{'warehouse_name':_0xb52e5d[_0x564789(0x217)]}},{'$unwind':_0x564789(0x1ed)},{'$group':{'_id':_0x564789(0x2b5)}}]),_0x4b9d72=await product['find']({}),_0x5c30c3=await warehouse[_0x564789(0x1f6)]([{'$match':{'name':_0xb52e5d[_0x564789(0x217)]}},{'$unwind':_0x564789(0x1fb)},{'$group':{'_id':_0x564789(0x289),'name':{'$first':_0x564789(0x281)},'product_stock':{'$first':_0x564789(0x20a)},'bay':{'$first':_0x564789(0x237)},'bin':{'$first':_0x564789(0x20d)},'type':{'$first':_0x564789(0x25f)},'floorlevel':{'$first':_0x564789(0x21d)},'primary_code':{'$first':_0x564789(0x241)},'secondary_code':{'$first':_0x564789(0x276)},'product_code':{'$first':_0x564789(0x279)},'storage':{'$first':_0x564789(0x25a)},'rack':{'$first':_0x564789(0x1f0)},'maxPerUnit':{'$first':_0x564789(0x2a9)},'expiry_date':{'$first':_0x564789(0x23c)},'production_date':{'$first':_0x564789(0x2b8)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x564789(0x1f4)}}}]);if(_0x111fef[0x0][_0x564789(0x25b)]=='English\x20(US)'){var _0x14670f=users[_0x564789(0x1e6)];console[_0x564789(0x286)](_0x14670f);}else{if(_0x111fef[0x0][_0x564789(0x25b)]==_0x564789(0x25e))var _0x14670f=users[_0x564789(0x25e)];else{if(_0x111fef[0x0][_0x564789(0x25b)]==_0x564789(0x1ee))var _0x14670f=users[_0x564789(0x1ee)];else{if(_0x111fef[0x0][_0x564789(0x25b)]==_0x564789(0x2ab))var _0x14670f=users[_0x564789(0x2ab)];else{if(_0x111fef[0x0][_0x564789(0x25b)]==_0x564789(0x1fa))var _0x14670f=users[_0x564789(0x1fa)];else{if(_0x111fef[0x0]['language']==_0x564789(0x1f5))var _0x14670f=users[_0x564789(0x244)];else{if(_0x111fef[0x0][_0x564789(0x25b)]==_0x564789(0x22e))var _0x14670f=users[_0x564789(0x22e)];else{if(_0x111fef[0x0]['language']==_0x564789(0x249))var _0x14670f=users[_0x564789(0x257)];}}}}}}}_0x128d3f[_0x564789(0x210)]('edit_adjustment_view',{'success':_0x4d498e[_0x564789(0x23f)]('success'),'errors':_0x4d498e[_0x564789(0x23f)]('errors'),'role':_0x57b970,'profile':_0x338a3c,'adjustment':_0xb52e5d,'stock':_0x5c30c3,'master_shop':_0x111fef,'warehouse_name':_0x4adf48,'unit':_0x4b9d72,'language':_0x14670f});}catch(_0x56e020){console[_0x564789(0x286)](_0x56e020),_0x128d3f[_0x564789(0x293)](0xc8)[_0x564789(0x213)]({'message':_0x56e020['message']});}}),router[a0_0x140f3a(0x299)](a0_0x140f3a(0x28c),auth,async(_0x19eff4,_0x3964fc)=>{var _0x13e11b=a0_0x140f3a;try{const _0xd351dd=_0x19eff4[_0x13e11b(0x28b)]['id'],{warehouse_name:_0x202104,Room_name:_0x3c9ef4}=_0x19eff4['body'],_0x473eb3=await adjustment[_0x13e11b(0x20c)]({'_id':_0xd351dd}),_0x26e889=_0x473eb3[_0x13e11b(0x20e)][_0x13e11b(0x2a2)](async _0x1cb329=>{var _0x24ec24=_0x13e11b;if(_0x1cb329[_0x24ec24(0x264)]>0x0){var _0x31cdf1=await warehouse[_0x24ec24(0x2a0)]({'name':_0x202104,'room':_0x1cb329['room_names'],'warehouse_category':_0x24ec24(0x2ae)});const _0x41ba27=_0x31cdf1[_0x24ec24(0x296)][_0x24ec24(0x2a2)](_0x125e10=>{var _0x22a39a=_0x24ec24;console[_0x22a39a(0x286)](_0x1cb329[_0x22a39a(0x248)]+_0x22a39a(0x227));if(_0x1cb329['types']=='minus'){if(_0x125e10[_0x22a39a(0x1fc)]==_0x1cb329[_0x22a39a(0x1fc)]&&_0x125e10['floorlevel']==_0x1cb329[_0x22a39a(0x23e)]&&_0x125e10[_0x22a39a(0x252)]==_0x1cb329[_0x22a39a(0x252)]&&_0x125e10[_0x22a39a(0x27a)]==_0x1cb329[_0x22a39a(0x27a)]&&_0x125e10[_0x22a39a(0x2bb)]==_0x1cb329[_0x22a39a(0x2bb)]&&_0x125e10[_0x22a39a(0x254)]==_0x1cb329[_0x22a39a(0x254)]&&_0x125e10['storage']==_0x1cb329[_0x22a39a(0x282)]&&_0x125e10['expiry_date']==_0x1cb329['expiry_date']&&_0x125e10['batch_code']==_0x1cb329[_0x22a39a(0x229)]&&_0x125e10[_0x22a39a(0x2b0)]==_0x1cb329[_0x22a39a(0x2b0)]&&_0x125e10['invoice']==_0x1cb329[_0x22a39a(0x1e8)]&&_0x125e10[_0x22a39a(0x29d)]==_0x1cb329['id_transaction_from']){var _0x23f39e;_0x23f39e=_0x1cb329[_0x22a39a(0x264)],_0x1cb329[_0x22a39a(0x297)]=='S'&&(_0x23f39e=_0x1cb329[_0x22a39a(0x264)]),_0x125e10['product_stock']=_0x125e10[_0x22a39a(0x251)]-_0x23f39e;}}else{if(_0x125e10['product_name']==_0x1cb329[_0x22a39a(0x1fc)]&&_0x125e10[_0x22a39a(0x23e)]==_0x1cb329['floorlevel']&&_0x125e10[_0x22a39a(0x252)]==_0x1cb329[_0x22a39a(0x252)]&&_0x125e10['bin']==_0x1cb329['bin']&&_0x125e10[_0x22a39a(0x2bb)]==_0x1cb329[_0x22a39a(0x2bb)]&&_0x125e10[_0x22a39a(0x254)]==_0x1cb329[_0x22a39a(0x254)]&&_0x125e10[_0x22a39a(0x282)]==_0x1cb329['storage']&&_0x125e10[_0x22a39a(0x247)]==_0x1cb329[_0x22a39a(0x247)]&&_0x125e10[_0x22a39a(0x229)]==_0x1cb329[_0x22a39a(0x229)]&&_0x125e10['production_date']==_0x1cb329[_0x22a39a(0x2b0)]&&_0x125e10[_0x22a39a(0x1e8)]==_0x1cb329[_0x22a39a(0x1e8)]&&_0x125e10[_0x22a39a(0x29d)]==_0x1cb329['id_transaction_from']){console[_0x22a39a(0x286)](_0x1cb329);var _0x23f39e;_0x23f39e=_0x1cb329['adjust_qty'],_0x1cb329[_0x22a39a(0x297)]=='S'&&(_0x23f39e=_0x1cb329[_0x22a39a(0x264)]),_0x125e10[_0x22a39a(0x251)]=_0x125e10[_0x22a39a(0x251)]+_0x23f39e;}}});}return _0x31cdf1;});Promise['all'](_0x26e889)['then'](async _0x37264c=>{var _0x47eebd=_0x13e11b;try{for(const _0x5d9f7d of _0x37264c){await _0x5d9f7d['save']();}_0x473eb3['finalize']=_0x47eebd(0x2b4);const _0x5624b=await _0x473eb3[_0x47eebd(0x232)](),_0x358235=await master_shop[_0x47eebd(0x27c)](),_0x56f88e=await email_settings[_0x47eebd(0x2a0)](),_0x4fc345=await supervisor_settings['find']();var _0x492901=_0x473eb3[_0x47eebd(0x20e)],_0x472925='',_0x3b54e0;for(_0x3b54e0 in _0x492901){_0x472925+=_0x47eebd(0x203)+_0x47eebd(0x283)+_0x492901[_0x3b54e0]['product_name']+_0x47eebd(0x2be)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x492901[_0x3b54e0][_0x47eebd(0x291)]+_0x47eebd(0x2be)+_0x47eebd(0x283)+_0x492901[_0x3b54e0]['adjust_qty']+_0x47eebd(0x2be)+_0x47eebd(0x283)+_0x492901[_0x3b54e0][_0x47eebd(0x260)]+'</td>'+_0x47eebd(0x283)+_0x492901[_0x3b54e0][_0x47eebd(0x2bf)]+'</td>'+_0x47eebd(0x283)+_0x473eb3[_0x47eebd(0x217)]+_0x47eebd(0x2be)+_0x47eebd(0x283)+_0x492901[_0x3b54e0][_0x47eebd(0x2bd)]+'</td>'+_0x47eebd(0x283)+_0x492901[_0x3b54e0][_0x47eebd(0x282)]+_0x492901[_0x3b54e0][_0x47eebd(0x254)]+_0x492901[_0x3b54e0][_0x47eebd(0x2bb)]+_0x492901[_0x3b54e0][_0x47eebd(0x27a)]+_0x492901[_0x3b54e0][_0x47eebd(0x252)][0x0]+_0x492901[_0x3b54e0][_0x47eebd(0x23e)]+_0x47eebd(0x2be),_0x47eebd(0x1f9);}let _0x558d07=nodemailer['createTransport']({'host':_0x56f88e[_0x47eebd(0x200)],'port':Number(_0x56f88e['port']),'secure':![],'auth':{'user':_0x56f88e[_0x47eebd(0x239)],'pass':_0x56f88e[_0x47eebd(0x2a6)]}}),_0x72611b={'from':_0x56f88e[_0x47eebd(0x239)],'to':_0x4fc345[0x0][_0x47eebd(0x205)],'subject':_0x47eebd(0x24e),'attachments':[{'filename':_0x47eebd(0x29a),'path':__dirname+_0x47eebd(0x2ad)+'/upload/'+_0x358235[0x0]['image'],'cid':_0x47eebd(0x298)}],'html':_0x47eebd(0x1f7)+_0x47eebd(0x265)+_0x47eebd(0x2a8)+_0x47eebd(0x1e4)+_0x47eebd(0x275)+_0x47eebd(0x1e4)+_0x47eebd(0x27b)+'</div>'+_0x47eebd(0x1e4)+_0x47eebd(0x2a4)+_0x358235[0x0][_0x47eebd(0x26c)]+_0x47eebd(0x1f8)+_0x47eebd(0x268)+'</div>'+_0x47eebd(0x24b)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x47eebd(0x1f1)+_0x473eb3[_0x47eebd(0x1e8)]+'\x20'+_0x47eebd(0x1e9)+_0x47eebd(0x211)+_0x473eb3[_0x47eebd(0x233)]+'\x20'+_0x47eebd(0x21e)+_0x47eebd(0x21a)+_0x47eebd(0x268)+_0x47eebd(0x214)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x47eebd(0x207)+_0x47eebd(0x273)+_0x47eebd(0x272)+_0x47eebd(0x24c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x47eebd(0x222)+_0x47eebd(0x267)+_0x47eebd(0x1f9)+_0x47eebd(0x23b)+_0x47eebd(0x290)+'\x20'+_0x472925+'\x20'+_0x47eebd(0x29c)+_0x47eebd(0x1ef)+_0x47eebd(0x1e4)+_0x47eebd(0x285)+_0x47eebd(0x2a7)+_0x358235[0x0][_0x47eebd(0x26c)]+'</h5>'+_0x47eebd(0x268)+'</div>'+_0x47eebd(0x20b)};_0x558d07['sendMail'](_0x72611b,function(_0x22995f,_0x21eec5){var _0x2fd679=_0x47eebd;_0x22995f?(console[_0x2fd679(0x286)](_0x22995f),console['log'](_0x2fd679(0x22b))):console[_0x2fd679(0x286)](_0x2fd679(0x22a));}),_0x19eff4[_0x47eebd(0x23f)]('success',_0x47eebd(0x223)),_0x3964fc[_0x47eebd(0x234)](_0x47eebd(0x280)+_0x5624b[_0x47eebd(0x29d)]);}catch(_0x3833ae){console[_0x47eebd(0x28a)](_0x3833ae),_0x3964fc[_0x47eebd(0x293)](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x13e11b(0x209)](_0x1bdc23=>{var _0x20534c=_0x13e11b;console[_0x20534c(0x28a)](_0x1bdc23),_0x3964fc['status'](0x1f4)[_0x20534c(0x213)]({'error':_0x20534c(0x2a1)});});}catch(_0x2ca3c0){console['log'](_0x2ca3c0),_0x3964fc['status'](0xc8)[_0x13e11b(0x213)]({'message':_0x2ca3c0[_0x13e11b(0x26f)]});}}),router[a0_0x140f3a(0x201)](a0_0x140f3a(0x231),auth,async(_0x198c24,_0x7d5e1a)=>{var _0x182bef=a0_0x140f3a;try{const {username:_0x5d6dbf,email:_0xe3af93,role:_0xc11ef2}=_0x198c24[_0x182bef(0x250)],_0x37bc6c=_0x198c24[_0x182bef(0x250)],_0x404b39=await profile[_0x182bef(0x2a0)]({'email':_0x37bc6c[_0x182bef(0x239)]}),_0x16a7d3=await master_shop['find'](),_0x2395b6=_0x198c24[_0x182bef(0x28b)]['id'],_0x2f40aa=await adjustment[_0x182bef(0x20c)]({'_id':_0x2395b6}),_0x5879da=await purchases[_0x182bef(0x1f6)]([{'$match':{'warehouse_name':_0x2f40aa[_0x182bef(0x217)]}},{'$unwind':_0x182bef(0x1ed)},{'$group':{'_id':_0x182bef(0x2b5)}}]),_0x10d69b=await product[_0x182bef(0x27c)]({}),_0x5ccd30=await warehouse['aggregate']([{'$match':{'name':_0x2f40aa['warehouse_name']}},{'$unwind':_0x182bef(0x1fb)},{'$group':{'_id':_0x182bef(0x289),'name':{'$first':_0x182bef(0x281)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x182bef(0x237)},'bin':{'$first':_0x182bef(0x20d)},'type':{'$first':_0x182bef(0x25f)},'floorlevel':{'$first':_0x182bef(0x21d)},'primary_code':{'$first':_0x182bef(0x241)},'secondary_code':{'$first':_0x182bef(0x276)},'product_code':{'$first':_0x182bef(0x279)},'storage':{'$first':_0x182bef(0x25a)},'rack':{'$first':_0x182bef(0x1f0)},'maxPerUnit':{'$first':_0x182bef(0x2a9)},'expiry_date':{'$first':_0x182bef(0x23c)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x182bef(0x1f4)}}}]);let _0x5cf946;if(_0x37bc6c['role']==_0x182bef(0x262)){const _0x105a50=await staff[_0x182bef(0x2a0)]({'email':_0x37bc6c[_0x182bef(0x239)]});_0x5cf946=await warehouse[_0x182bef(0x1f6)]([{'$match':{'status':_0x182bef(0x259),'name':_0x105a50['warehouse'],'warehouse_category':_0x182bef(0x2ae),'name':{'$ne':_0x182bef(0x228)}}},{'$group':{'_id':_0x182bef(0x24a),'name':{'$first':_0x182bef(0x24a)}}}]);}else _0x5cf946=await warehouse['aggregate']([{'$match':{'status':_0x182bef(0x259),'warehouse_category':_0x182bef(0x2ae),'name':{'$ne':_0x182bef(0x228)}}},{'$group':{'_id':'$name','name':{'$first':_0x182bef(0x24a)}}}]);if(_0x16a7d3[0x0][_0x182bef(0x25b)]==_0x182bef(0x255)){var _0x420d54=users[_0x182bef(0x1e6)];console['log'](_0x420d54);}else{if(_0x16a7d3[0x0][_0x182bef(0x25b)]==_0x182bef(0x25e))var _0x420d54=users['Hindi'];else{if(_0x16a7d3[0x0][_0x182bef(0x25b)]==_0x182bef(0x1ee))var _0x420d54=users['German'];else{if(_0x16a7d3[0x0]['language']==_0x182bef(0x2ab))var _0x420d54=users[_0x182bef(0x2ab)];else{if(_0x16a7d3[0x0][_0x182bef(0x25b)]==_0x182bef(0x1fa))var _0x420d54=users[_0x182bef(0x1fa)];else{if(_0x16a7d3[0x0][_0x182bef(0x25b)]==_0x182bef(0x1f5))var _0x420d54=users[_0x182bef(0x244)];else{if(_0x16a7d3[0x0][_0x182bef(0x25b)]==_0x182bef(0x22e))var _0x420d54=users['Chinese'];else{if(_0x16a7d3[0x0][_0x182bef(0x25b)]==_0x182bef(0x249))var _0x420d54=users[_0x182bef(0x257)];}}}}}}}_0x7d5e1a['render'](_0x182bef(0x266),{'success':_0x198c24['flash'](_0x182bef(0x27e)),'errors':_0x198c24['flash'](_0x182bef(0x243)),'role':_0x37bc6c,'profile':_0x404b39,'adjustment':_0x2f40aa,'stock':_0x5ccd30,'master_shop':_0x16a7d3,'warehouse_name':_0x5879da,'unit':_0x10d69b,'language':_0x420d54,'warehouse':_0x5cf946});}catch(_0x3304be){console[_0x182bef(0x286)](_0x3304be),_0x7d5e1a[_0x182bef(0x293)](0xc8)[_0x182bef(0x213)]({'message':_0x3304be[_0x182bef(0x26f)]});}}),router[a0_0x140f3a(0x299)](a0_0x140f3a(0x231),auth,async(_0xdc8825,_0x32779c)=>{var _0x349f77=a0_0x140f3a;try{const _0x52cf35=_0xdc8825[_0x349f77(0x28b)]['id'],_0x5ac084=await adjustment[_0x349f77(0x20c)]({'_id':_0x52cf35}),_0x52ecc3=await warehouse['findOne']({'name':_0x5ac084[_0x349f77(0x217)],'room':_0x5ac084[_0x349f77(0x2ac)]}),{warehouse_name:_0x61b75c,date:_0x1648ce,prod_name:_0x486cf3,level:_0x5bf95f,isle:_0x4e5d57,pallet:_0x2fc990,stock:_0x1d16d1,types:_0x281dd5,adjust_qty:_0x4042a3,new_adjust_qty:_0x32cdf4,note:_0x79437c,Room_name:_0x5e894e,invoice:_0x7a834d,JO_number:_0x49b5d5,expiry_date:_0x1f58ae}=_0xdc8825['body'];if(typeof _0x486cf3==_0x349f77(0x29b))var _0xa8e473=[_0xdc8825['body'][_0x349f77(0x230)]],_0xb6e339=[_0xdc8825[_0x349f77(0x246)][_0x349f77(0x253)]],_0x47637b=[_0xdc8825['body'][_0x349f77(0x20f)]],_0x524b61=[_0xdc8825[_0x349f77(0x246)]['types']],_0x15cc84=[_0xdc8825[_0x349f77(0x246)]['New_Qty_Converted_adj']],_0x2fcbbc=[_0xdc8825[_0x349f77(0x246)][_0x349f77(0x2b1)]],_0x246def=[_0xdc8825[_0x349f77(0x246)]['Primary_Units']],_0x2b6a1d=[_0xdc8825[_0x349f77(0x246)][_0x349f77(0x1f2)]],_0x207b54=[_0xdc8825['body'][_0x349f77(0x22c)]],_0x394957=[_0xdc8825[_0x349f77(0x246)][_0x349f77(0x229)]],_0x5579a1=[_0xdc8825[_0x349f77(0x246)][_0x349f77(0x247)]],_0x5217b7=[_0xdc8825[_0x349f77(0x246)][_0x349f77(0x2b2)]],_0x11a13e=[_0xdc8825['body'][_0x349f77(0x2b0)]],_0xc6378=[_0xdc8825[_0x349f77(0x246)][_0x349f77(0x297)]],_0x419aa0=[_0xdc8825[_0x349f77(0x246)][_0x349f77(0x212)]],_0x236595=[_0xdc8825[_0x349f77(0x246)]['prime1']],_0x33b15e=[_0xdc8825[_0x349f77(0x246)][_0x349f77(0x294)]];else var _0xa8e473=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x230)]],_0xb6e339=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x253)]],_0x47637b=[..._0xdc8825['body'][_0x349f77(0x20f)]],_0x524b61=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x248)]],_0x15cc84=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x219)]],_0x2fcbbc=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x2b1)]],_0x246def=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x260)]],_0x2b6a1d=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x1f2)]],_0x207b54=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x22c)]],_0x394957=[..._0xdc8825['body'][_0x349f77(0x229)]],_0x5579a1=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x247)]],_0x5217b7=[..._0xdc8825['body'][_0x349f77(0x2b2)]],_0x11a13e=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x2b0)]],_0xc6378=[..._0xdc8825['body']['prod_cat']],_0x419aa0=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x212)]],_0x236595=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x235)]],_0x33b15e=[..._0xdc8825[_0x349f77(0x246)][_0x349f77(0x294)]];const _0x41719d=_0xa8e473[_0x349f77(0x2a2)](_0x150dd1=>{return _0x150dd1={'product_name':_0x150dd1};});_0xb6e339[_0x349f77(0x288)]((_0x154450,_0x5d1c42)=>{_0x419aa0['forEach']((_0x4e5d92,_0x5107bf)=>{var _0x550c53=a0_0x5768;if(_0x4e5d92==_0x550c53(0x23d)&&_0x5d1c42==_0x5107bf){var _0x2e69bc=_0x154450['slice'](0x3);_0x41719d[_0x5d1c42][_0x550c53(0x282)]=_0x154450[0x0],_0x41719d[_0x5d1c42]['rack']=_0x154450[0x1],_0x41719d[_0x5d1c42]['bay']=0x0,_0x41719d[_0x5d1c42][_0x550c53(0x27a)]=0x0,_0x41719d[_0x5d1c42]['type']='Floor',_0x41719d[_0x5d1c42]['floorlevel']=_0x2e69bc;}else{if(_0x4e5d92=='Shelves'&&_0x5d1c42==_0x5107bf){var _0x2e69bc=_0x154450[_0x550c53(0x242)](0x3);_0x41719d[_0x5d1c42][_0x550c53(0x282)]=_0x154450[0x0],_0x41719d[_0x5d1c42][_0x550c53(0x254)]=_0x154450[0x1],_0x41719d[_0x5d1c42][_0x550c53(0x2bb)]=0x0,_0x41719d[_0x5d1c42]['bin']=0x0,_0x41719d[_0x5d1c42]['type']=_0x550c53(0x1eb),_0x41719d[_0x5d1c42][_0x550c53(0x23e)]=_0x154450[0x5];}else{if(_0x5d1c42==_0x5107bf){var _0x49f8d7;if(_0x154450[0x4]=='L')_0x49f8d7=_0x550c53(0x271);else _0x154450[0x4]=='F'&&(_0x49f8d7=_0x550c53(0x1eb));_0x41719d[_0x5d1c42][_0x550c53(0x282)]=_0x154450[0x0],_0x41719d[_0x5d1c42][_0x550c53(0x254)]=_0x154450[0x1],_0x41719d[_0x5d1c42][_0x550c53(0x2bb)]=_0x154450[0x2],_0x41719d[_0x5d1c42]['bin']=_0x154450[0x3],_0x41719d[_0x5d1c42]['type']=_0x49f8d7,_0x41719d[_0x5d1c42][_0x550c53(0x23e)]=_0x154450[0x5];}}}});}),_0x47637b[_0x349f77(0x288)]((_0x5b05ca,_0x3641e8)=>{var _0x5c9816=_0x349f77;_0x41719d[_0x3641e8][_0x5c9816(0x238)]=_0x5b05ca;}),_0x524b61[_0x349f77(0x288)]((_0x40fb1b,_0x2d6cf4)=>{var _0x43c225=_0x349f77;_0x41719d[_0x2d6cf4][_0x43c225(0x248)]=_0x40fb1b;}),_0x15cc84['forEach']((_0x486f1a,_0x16b795)=>{var _0x1f5d5c=_0x349f77;_0x41719d[_0x16b795][_0x1f5d5c(0x264)]=_0x486f1a;}),_0x2fcbbc[_0x349f77(0x288)]((_0x3a6bdd,_0x3beaee)=>{var _0x21182d=_0x349f77;_0x41719d[_0x3beaee][_0x21182d(0x26e)]=_0x3a6bdd;}),_0x246def[_0x349f77(0x288)]((_0xf73709,_0x53c34d)=>{var _0x33e0e4=_0x349f77;_0x41719d[_0x53c34d][_0x33e0e4(0x260)]=_0xf73709;}),_0x2b6a1d[_0x349f77(0x288)]((_0x4ce0e4,_0x2fbd33)=>{var _0x47168a=_0x349f77;_0x41719d[_0x2fbd33][_0x47168a(0x2bf)]=_0x4ce0e4;}),_0x207b54[_0x349f77(0x288)]((_0x368ce0,_0x338fc1)=>{var _0x180c4c=_0x349f77;_0x41719d[_0x338fc1][_0x180c4c(0x291)]=_0x368ce0;}),_0x394957[_0x349f77(0x288)]((_0x45158e,_0xc94d73)=>{var _0x4a7b2f=_0x349f77;_0x41719d[_0xc94d73][_0x4a7b2f(0x229)]=_0x45158e;}),_0x5579a1['forEach']((_0x5e9e58,_0x10afd9)=>{var _0x4e749a=_0x349f77;_0x41719d[_0x10afd9][_0x4e749a(0x247)]=_0x5e9e58;}),_0x5217b7[_0x349f77(0x288)]((_0x49c618,_0x35d439)=>{var _0x46a16d=_0x349f77;_0x41719d[_0x35d439][_0x46a16d(0x26a)]=_0x49c618;}),_0x11a13e[_0x349f77(0x288)]((_0x268ac9,_0x4da0f6)=>{var _0x5c7a7b=_0x349f77;_0x41719d[_0x4da0f6][_0x5c7a7b(0x2b0)]=_0x268ac9;}),_0xc6378[_0x349f77(0x288)]((_0x304545,_0x353018)=>{var _0x32f7e7=_0x349f77;_0x41719d[_0x353018][_0x32f7e7(0x297)]=_0x304545;}),_0x419aa0[_0x349f77(0x288)]((_0x16b1a9,_0x57d67d)=>{var _0x59a15f=_0x349f77;_0x41719d[_0x57d67d][_0x59a15f(0x2bd)]=_0x16b1a9;}),_0x236595[_0x349f77(0x288)]((_0x168c30,_0x5dc748)=>{var _0x3cac0b=_0x349f77;_0x41719d[_0x5dc748][_0x3cac0b(0x1f3)]=_0x168c30;}),_0x33b15e['forEach']((_0x13bce9,_0x40dfd8)=>{var _0x14c0c9=_0x349f77;_0x41719d[_0x40dfd8][_0x14c0c9(0x216)]=_0x13bce9;});const _0x576fd2=_0x41719d[_0x349f77(0x2b7)](_0x4f0e19=>_0x4f0e19[_0x349f77(0x264)]!=='0'&&_0x4f0e19[_0x349f77(0x264)]!=='');var _0x41e5d2=0x0;_0x576fd2[_0x349f77(0x288)](_0x4fcc3e=>{var _0x36259e=_0x349f77;console['log']('foreach\x20newproduct',_0x4fcc3e),parseInt(_0x4fcc3e[_0x36259e(0x264)])<=0x0&&_0x41e5d2++;});if(_0x41e5d2!=0x0)return _0xdc8825[_0x349f77(0x23f)](_0x349f77(0x243),_0x349f77(0x2b9)),_0x32779c[_0x349f77(0x234)](_0x349f77(0x225));_0x5ac084['warehouse_name']=_0x61b75c,_0x5ac084[_0x349f77(0x233)]=_0x1648ce,_0x5ac084[_0x349f77(0x20e)]=_0x576fd2,_0x5ac084[_0x349f77(0x27d)]=_0x79437c,_0x5ac084[_0x349f77(0x1e8)]=_0x7a834d,_0x5ac084[_0x349f77(0x284)]=_0x349f77(0x218);const _0x3f334d=await _0x5ac084[_0x349f77(0x232)]();_0xdc8825[_0x349f77(0x23f)](_0x349f77(0x27e),_0x349f77(0x28e)),_0x32779c['redirect'](_0x349f77(0x1fe));}catch(_0x87c1f9){console[_0x349f77(0x286)](_0x87c1f9);}}),router[a0_0x140f3a(0x299)](a0_0x140f3a(0x1e7),async(_0x52f812,_0x1dac13)=>{var _0x3cd5a1=a0_0x140f3a;const {primary_code:_0x2f3652,warehouse_data:_0x2c04b2,rooms_data:_0x4b8f48,Roomslist:_0x51898c}=_0x52f812[_0x3cd5a1(0x246)],_0x371d78=_0x51898c[_0x3cd5a1(0x269)](','),_0x5d61ec=[];async function _0x35c013(_0x4ccf23){var _0x4def76=_0x3cd5a1;const _0x132849=await warehouse['aggregate']([{'$match':{'name':_0x2c04b2,'room':_0x4ccf23}},{'$unwind':_0x4def76(0x1fb)},{'$match':{'product_details.primary_code':_0x2f3652}},{'$group':{'_id':_0x4def76(0x289),'name':{'$first':_0x4def76(0x281)},'product_stock':{'$first':_0x4def76(0x20a)},'primary_code':{'$first':_0x4def76(0x241)},'secondary_code':{'$first':_0x4def76(0x276)},'product_code':{'$first':_0x4def76(0x279)},'level':{'$first':_0x4def76(0x237)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x4def76(0x25f)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4def76(0x1ff)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4def76(0x23c)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x4def76(0x28d)},'product_cat':{'$first':_0x4def76(0x21f)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x4def76(0x1f4)},'invoice':{'$first':_0x4def76(0x258)}}}]),_0x1665cc=await warehouse['aggregate']([{'$match':{'name':_0x2c04b2,'room':_0x4ccf23}},{'$unwind':_0x4def76(0x1fb)},{'$match':{'product_details.secondary_code':_0x2f3652}},{'$group':{'_id':_0x4def76(0x289),'name':{'$first':_0x4def76(0x281)},'product_stock':{'$first':_0x4def76(0x20a)},'primary_code':{'$first':_0x4def76(0x241)},'secondary_code':{'$first':_0x4def76(0x276)},'product_code':{'$first':_0x4def76(0x279)},'level':{'$first':_0x4def76(0x237)},'isle':{'$first':_0x4def76(0x20d)},'type':{'$first':_0x4def76(0x25f)},'pallet':{'$first':_0x4def76(0x21d)},'unit':{'$first':_0x4def76(0x204)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x4def76(0x25a)},'rack':{'$first':_0x4def76(0x1f0)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4def76(0x2b8)},'maxPerUnit':{'$first':_0x4def76(0x2a9)},'batch_code':{'$first':_0x4def76(0x28d)},'product_cat':{'$first':_0x4def76(0x21f)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x4def76(0x1f4)}}}]);if(_0x132849[_0x4def76(0x224)]>0x0)_0x5d61ec[_0x4def76(0x270)](_0x132849);else _0x1665cc['length']>0x0&&_0x5d61ec[_0x4def76(0x270)](_0x1665cc);}const _0xf4e440=_0x371d78[_0x3cd5a1(0x2a2)](_0x2475eb=>_0x35c013(_0x2475eb));await Promise[_0x3cd5a1(0x21c)](_0xf4e440),_0x1dac13[_0x3cd5a1(0x213)](_0x5d61ec);}),router['post'](a0_0x140f3a(0x226),async(_0x16a212,_0x2491f3)=>{var _0x3d1e8=a0_0x140f3a;const {primaryCode:_0x3ec72e,secondaryCode:_0x450413,productCode:_0x1acdb7,level:_0x335191,isle:_0x54e420,pallet:_0x101708,warehouses:_0x3c5bc2,room:_0x5b5221}=_0x16a212[_0x3d1e8(0x246)];try{const _0x17d570=await warehouse[_0x3d1e8(0x1f6)]([{'$match':{'name':_0x3c5bc2,'room':_0x5b5221}},{'$unwind':_0x3d1e8(0x1fb)},{'$match':{'product_details.level':parseInt(_0x335191),'product_details.isle':_0x54e420,'product_details.pallet':parseInt(_0x101708)}},{'$group':{'_id':_0x3d1e8(0x289),'name':{'$first':_0x3d1e8(0x281)},'product_stock':{'$first':_0x3d1e8(0x20a)},'level':{'$first':_0x3d1e8(0x27f)},'isle':{'$first':_0x3d1e8(0x278)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2491f3['status'](0xc8)[_0x3d1e8(0x213)](_0x17d570);}catch(_0x68218d){_0x2491f3[_0x3d1e8(0x293)](0x194)[_0x3d1e8(0x213)]({'message':_0x68218d[_0x3d1e8(0x26f)]});}}),module[a0_0x140f3a(0x29f)]=router;