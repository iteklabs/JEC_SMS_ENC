var a0_0x27faed=a0_0x5ae9;(function(_0x55c66e,_0x56d892){var _0x277be6=a0_0x5ae9,_0x5b07b6=_0x55c66e();while(!![]){try{var _0x280fb9=-parseInt(_0x277be6(0xfe))/0x1+parseInt(_0x277be6(0xd2))/0x2*(parseInt(_0x277be6(0xf8))/0x3)+-parseInt(_0x277be6(0xa0))/0x4*(-parseInt(_0x277be6(0x158))/0x5)+parseInt(_0x277be6(0xbe))/0x6*(-parseInt(_0x277be6(0x140))/0x7)+-parseInt(_0x277be6(0x138))/0x8*(-parseInt(_0x277be6(0xae))/0x9)+-parseInt(_0x277be6(0xa5))/0xa+parseInt(_0x277be6(0x14b))/0xb;if(_0x280fb9===_0x56d892)break;else _0x5b07b6['push'](_0x5b07b6['shift']());}catch(_0x44d7a1){_0x5b07b6['push'](_0x5b07b6['shift']());}}}(a0_0xb3d3,0x1e62f));function a0_0xb3d3(){var _0x3bee20=['flash','/../public','sendMail','edit_adjustment','max_per_unit','room','minus','../public/language/languages.json','/adjustment/preview/','Portuguese','10aWmbuY','level','redirect','Enabled','prod_code','Email\x20sent\x20successfully','/view/:id','Spanish','<tr>','<hr\x20class=\x22my-3\x22>','adjustment','split','second1','\x20<>\x20','id_transaction_from','</table>','product_name','bay','json','$product_details.storage','prod_name','Primary_Units','/view','Ambient','exports','batch_code','forEach','79632kCkDCX','render','German','Arabic','log','2416070NhzZHW','find','Error\x20Occurs','get','adjustment\x20data\x20update\x20successfully','filter','Portuguese\x20(BR)','errors','ADJ-','2006226ZyScek','/view/add_adjustment','length','/barcode_scanner','post','/preview/:id','True','$product_details.product_name','catch','slice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','add_adjustment','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','findById','Level','bin','6riQxXk','Enclosed','Secondary_units','$product_details.primary_code','secondary_code','_id','Logo.png','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details._id','Receiving\x20Area','English\x20(US)','message','\x20Order\x20Date\x20:\x20','<tbody\x20style=\x22text-align:\x20center;\x22>','../models/all_models','staff','primary_code','warehouse_name','</td>','118xsdjGg','Hindi','site_title','Arabic\x20(ae)','production_date','</head><body>','push','$product_details.batch_code','body','$room','unit','</div>','New_Qty_Converted_adj','stock','Return\x20Rooms','$product_details.product_stock','all','$product_details.floorlevel','params','</span>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$name','Chinese','$warehouse_name','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','role','<h2>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.invoice','product_stock','stockBefore','product_code','adjustment\x20add\x20successfull','RMSEmail','type','9483cZqIJa','/upload/','maxperunit','adjust_qty','$product_details.product_cat','Shelves','57488qduTSL','</body></html>','Floor','Raw\x20Materials','$product_details.type','createTransport','Adjustment\x20Mail','id_transaction','rack','adjustment\x20Finalized\x20successfully','<h5>','date','</h5>','room_names','<h5\x20style=\x22text-align:\x20left;\x22>','prod_invoice','prime1','$isAllowEdit','string','image','logo','/CheckingWarehouse','An\x20error\x20occurred.','<html><head><title></title>','prod_cat','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/adjustment/view','<div>','$product_details.production_date','then','product','new_adjust_qty','Return\x20Goods','save','<strong>\x20Regards\x20</strong>','$product_details.bay','\x20Order\x20Number\x20:\x20','An\x20error\x20occurred\x20while\x20saving\x20data.','False','French','aggregate','$product_details.product_code','$product_details.bin','status','nodemailer','success','back','$product_details','password','English','types','floorlevel','$product_details.level','Rooms','language','$product_details.secondary_unit','</tr>','8aWAENJ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.rack','$product_details.secondary_code','$product_details.maxPerUnit','secondary_unit','<!DOCTYPE\x20html>','storage','526288GlAaMM','padStart','findOne','$product','</thead>','$product_details.expiry_date','map','port','New_Qty_Converted','foreach\x20newproduct','../middleware/auth','544643MdwYVE','user','warehouse'];a0_0xb3d3=function(){return _0x3bee20;};return a0_0xb3d3();}const express=require('express'),app=express(),router=express['Router'](),auth=require(a0_0x27faed(0x14a)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x27faed(0xcd)),users=require(a0_0x27faed(0x155)),nodemailer=require(a0_0x27faed(0x12b));router['get'](a0_0x27faed(0x16e),auth,async(_0x246f66,_0x17e31d)=>{var _0x2dc946=a0_0x27faed;try{const {username:_0x40e366,email:_0x3ef4ec,role:_0x333aa2}=_0x246f66[_0x2dc946(0x14c)],_0x31c5b1=_0x246f66[_0x2dc946(0x14c)],_0x28c053=await profile[_0x2dc946(0x142)]({'email':_0x31c5b1['email']}),_0x5e6f2b=await master_shop['find']();console[_0x2dc946(0xa4)]('master',_0x5e6f2b);let _0x53b9e4;if(_0x31c5b1[_0x2dc946(0xee)]==_0x2dc946(0xce)){const _0x56171b=await staff[_0x2dc946(0x142)]({'email':_0x31c5b1[_0x2dc946(0xea)]});_0x53b9e4=await warehouse['find']({'status':_0x2dc946(0x15b),'name':_0x56171b[_0x2dc946(0x14d)]});}else _0x53b9e4=await warehouse[_0x2dc946(0xa6)]({'status':_0x2dc946(0x15b)});const _0x450d97=await product[_0x2dc946(0xa6)]();let _0x1086c4;if(_0x31c5b1[_0x2dc946(0xee)]==_0x2dc946(0xce)){const _0x3de8fe=await staff[_0x2dc946(0x142)]({'email':_0x31c5b1['email']});_0x1086c4=await adjustment[_0x2dc946(0xa6)]({'warehouse_name':_0x3de8fe['warehouse']});}else _0x1086c4=await adjustment[_0x2dc946(0x127)]([{'$unwind':_0x2dc946(0x143)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x2dc946(0xe9)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x2dc946(0x10f)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x5e6f2b[0x0][_0x2dc946(0x135)]==_0x2dc946(0xc9)){var _0x437008=users[_0x2dc946(0x130)];console[_0x2dc946(0xa4)](_0x437008);}else{if(_0x5e6f2b[0x0]['language']=='Hindi')var _0x437008=users[_0x2dc946(0xd3)];else{if(_0x5e6f2b[0x0][_0x2dc946(0x135)]==_0x2dc946(0xa2))var _0x437008=users[_0x2dc946(0xa2)];else{if(_0x5e6f2b[0x0][_0x2dc946(0x135)]=='Spanish')var _0x437008=users[_0x2dc946(0x15f)];else{if(_0x5e6f2b[0x0][_0x2dc946(0x135)]==_0x2dc946(0x126))var _0x437008=users[_0x2dc946(0x126)];else{if(_0x5e6f2b[0x0][_0x2dc946(0x135)]==_0x2dc946(0xab))var _0x437008=users['Portuguese'];else{if(_0x5e6f2b[0x0]['language']==_0x2dc946(0xe8))var _0x437008=users[_0x2dc946(0xe8)];else{if(_0x5e6f2b[0x0]['language']==_0x2dc946(0xd5))var _0x437008=users[_0x2dc946(0xa3)];}}}}}}}_0x17e31d['render'](_0x2dc946(0x162),{'success':_0x246f66['flash'](_0x2dc946(0x12c)),'errors':_0x246f66[_0x2dc946(0x14e)](_0x2dc946(0xac)),'role':_0x31c5b1,'profile':_0x28c053,'warehouse':_0x53b9e4,'product':_0x450d97,'adjustment':_0x1086c4,'master_shop':_0x5e6f2b,'language':_0x437008});}catch(_0x308fb1){console[_0x2dc946(0xa4)](_0x308fb1);}});function a0_0x5ae9(_0x476059,_0x13ac70){var _0xb3d3bf=a0_0xb3d3();return a0_0x5ae9=function(_0x5ae9ba,_0xe1390){_0x5ae9ba=_0x5ae9ba-0x9d;var _0x534531=_0xb3d3bf[_0x5ae9ba];return _0x534531;},a0_0x5ae9(_0x476059,_0x13ac70);}async function getRandom8DigitNumber(){var _0x4b6726=a0_0x27faed;const _0x45cf8d=0x989680,_0x1ce7f3=0x5f5e0ff,_0x110b9a=Math['floor'](Math['random']()*(_0x1ce7f3-_0x45cf8d+0x1))+_0x45cf8d;var _0x5499a8;const _0x283a9e=await adjustment['findOne']({'invoice':_0x4b6726(0xad)+_0x110b9a});return _0x283a9e&&_0x283a9e[_0x4b6726(0xb0)]>0x0?_0x5499a8=_0x4b6726(0xad)+_0x110b9a:_0x5499a8=_0x4b6726(0xad)+_0x110b9a,_0x5499a8;}router[a0_0x27faed(0xa8)]('/view/add_adjustment',auth,async(_0x37519d,_0x592c6a)=>{var _0x3d3f37=a0_0x27faed;try{const {username:_0x5464bb,email:_0x31c1fc,role:_0x17ad36}=_0x37519d[_0x3d3f37(0x14c)],_0x5cecad=_0x37519d[_0x3d3f37(0x14c)],_0x1ecfbb=await profile[_0x3d3f37(0x142)]({'email':_0x5cecad[_0x3d3f37(0xea)]}),_0x2d8616=await master_shop['find']();let _0x5a957e;if(_0x5cecad[_0x3d3f37(0xee)]==_0x3d3f37(0xce)){const _0x21d3b2=await staff[_0x3d3f37(0x142)]({'email':_0x5cecad['email']});_0x5a957e=await warehouse[_0x3d3f37(0x127)]([{'$match':{'status':'Enabled','name':_0x21d3b2[_0x3d3f37(0x14d)],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x3d3f37(0xe7),'name':{'$first':_0x3d3f37(0xe7)}}}]);}else _0x5a957e=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x3d3f37(0x101),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x3d3f37(0xe7),'name':{'$first':_0x3d3f37(0xe7)}}}]);const _0x532dce=await product[_0x3d3f37(0xa6)]({}),_0x563905=await adjustment[_0x3d3f37(0xa6)]({}),_0x5aab65=_0x563905['length']+0x1,_0x2c8341=_0x3d3f37(0xad)+_0x5aab65['toString']()[_0x3d3f37(0x141)](0x5,'0');var _0x442848=[_0x3d3f37(0x16f),_0x3d3f37(0xbf),_0x3d3f37(0xe0)];if(_0x2d8616[0x0][_0x3d3f37(0x135)]==_0x3d3f37(0xc9))var _0x2c52c4=users[_0x3d3f37(0x130)];else{if(_0x2d8616[0x0][_0x3d3f37(0x135)]==_0x3d3f37(0xd3))var _0x2c52c4=users[_0x3d3f37(0xd3)];else{if(_0x2d8616[0x0][_0x3d3f37(0x135)]=='German')var _0x2c52c4=users[_0x3d3f37(0xa2)];else{if(_0x2d8616[0x0][_0x3d3f37(0x135)]=='Spanish')var _0x2c52c4=users[_0x3d3f37(0x15f)];else{if(_0x2d8616[0x0][_0x3d3f37(0x135)]==_0x3d3f37(0x126))var _0x2c52c4=users[_0x3d3f37(0x126)];else{if(_0x2d8616[0x0][_0x3d3f37(0x135)]==_0x3d3f37(0xab))var _0x2c52c4=users[_0x3d3f37(0x157)];else{if(_0x2d8616[0x0][_0x3d3f37(0x135)]==_0x3d3f37(0xe8))var _0x2c52c4=users[_0x3d3f37(0xe8)];else{if(_0x2d8616[0x0][_0x3d3f37(0x135)]==_0x3d3f37(0xd5))var _0x2c52c4=users['Arabic'];}}}}}}}const _0x35257c=getRandom8DigitNumber();_0x35257c[_0x3d3f37(0x11c)](_0xbdae15=>{var _0x3cf3d8=_0x3d3f37;_0x592c6a[_0x3cf3d8(0xa1)](_0x3cf3d8(0xb9),{'success':_0x37519d[_0x3cf3d8(0x14e)](_0x3cf3d8(0x12c)),'errors':_0x37519d['flash'](_0x3cf3d8(0xac)),'role':_0x5cecad,'profile':_0x1ecfbb,'warehouse':_0x5a957e,'product':_0x532dce,'master_shop':_0x2d8616,'language':_0x2c52c4,'rooms_data':_0x442848,'invoice_no':_0xbdae15});})[_0x3d3f37(0xb6)](_0x3b9059=>{var _0x5b0228=_0x3d3f37;_0x37519d['flash'](_0x5b0228(0xac),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x592c6a[_0x5b0228(0x15a)]('/adjustment/view');});}catch(_0x3ba9f1){console[_0x3d3f37(0xa4)](_0x3ba9f1);}}),router[a0_0x27faed(0xb2)](a0_0x27faed(0xaf),auth,async(_0x51daaa,_0x387df7)=>{var _0x2cda93=a0_0x27faed;try{const {warehouse_name:_0xc6f9b0,date:_0x67eb26,prod_name:_0x19f55c,level:_0x4000a4,isle:_0x12b688,pallet:_0x28d5a2,stock:_0x627cee,types:_0x2cc11c,adjust_qty:_0x4f4d97,new_adjust_qty:_0x4a80f8,note:_0x118671,Room_name:_0x2ece6b,invoice:_0x1c3f6d,JO_number:_0x431d5d,expiry_date:_0x46ccd1}=_0x51daaa[_0x2cda93(0xda)];if(typeof _0x19f55c==_0x2cda93(0x110))var _0x2d22f2=[_0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x16c)]],_0x5e8cb0=[_0x51daaa['body'][_0x2cda93(0x159)]],_0x4042dd=[_0x51daaa[_0x2cda93(0xda)]['stock']],_0x592f25=[_0x51daaa[_0x2cda93(0xda)]['types']],_0x51de8e=[_0x51daaa[_0x2cda93(0xda)][_0x2cda93(0xde)]],_0x58bd6f=[_0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x148)]],_0x53b999=[_0x51daaa['body'][_0x2cda93(0x16d)]],_0xbbe640=[_0x51daaa['body'][_0x2cda93(0xc0)]],_0x3b33bf=[_0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x15c)]],_0x3c97c4=[_0x51daaa[_0x2cda93(0xda)]['batch_code']],_0x511569=[_0x51daaa[_0x2cda93(0xda)]['expiry_date']],_0x21f09a=[_0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x152)]],_0x5cacc1=[_0x51daaa[_0x2cda93(0xda)]['production_date']],_0xfa6239=[_0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x116)]],_0x5bd1a3=[_0x51daaa[_0x2cda93(0xda)]['Rooms']],_0x4c0887=[_0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x10e)]],_0x1d15cc=[_0x51daaa[_0x2cda93(0xda)]['second1']],_0x3d9fa2=[_0x51daaa[_0x2cda93(0xda)]['prod_invoice']],_0x485e10=[_0x51daaa['body'][_0x2cda93(0x105)]];else var _0x2d22f2=[..._0x51daaa['body']['prod_name']],_0x5e8cb0=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x159)]],_0x4042dd=[..._0x51daaa[_0x2cda93(0xda)]['stock']],_0x592f25=[..._0x51daaa[_0x2cda93(0xda)]['types']],_0x51de8e=[..._0x51daaa[_0x2cda93(0xda)]['New_Qty_Converted_adj']],_0x58bd6f=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x148)]],_0x53b999=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0xdc)]],_0xbbe640=[..._0x51daaa['body'][_0x2cda93(0xc0)]],_0x3b33bf=[..._0x51daaa['body'][_0x2cda93(0x15c)]],_0x3c97c4=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x9e)]],_0x511569=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0xec)]],_0x21f09a=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x152)]],_0x5cacc1=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0xd6)]],_0xfa6239=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x116)]],_0x5bd1a3=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x134)]],_0x4c0887=[..._0x51daaa['body'][_0x2cda93(0x10e)]],_0x1d15cc=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x164)]],_0x3d9fa2=[..._0x51daaa[_0x2cda93(0xda)][_0x2cda93(0x10d)]],_0x485e10=[..._0x51daaa['body']['id_transaction']];const _0x3bfc4e=_0x2d22f2[_0x2cda93(0x146)](_0x3b2856=>{return _0x3b2856={'product_name':_0x3b2856};});_0x5e8cb0[_0x2cda93(0x9f)]((_0x167360,_0xc4442f)=>{_0x5bd1a3['forEach']((_0x5c4fdd,_0x15bc52)=>{var _0x121f97=a0_0x5ae9;if(_0x5c4fdd==_0x121f97(0xc8)&&_0xc4442f==_0x15bc52){var _0x3e7d86=_0x167360['slice'](0x3);_0x3bfc4e[_0xc4442f][_0x121f97(0x13f)]=_0x167360[0x0],_0x3bfc4e[_0xc4442f][_0x121f97(0x106)]=_0x167360[0x1],_0x3bfc4e[_0xc4442f]['bay']=0x0,_0x3bfc4e[_0xc4442f][_0x121f97(0xbd)]=0x0,_0x3bfc4e[_0xc4442f][_0x121f97(0xf7)]=_0x121f97(0x100),_0x3bfc4e[_0xc4442f][_0x121f97(0x132)]=_0x3e7d86;}else{if(_0x5c4fdd==_0x121f97(0xfd)&&_0xc4442f==_0x15bc52){var _0x3e7d86=_0x167360[_0x121f97(0xb7)](0x3);_0x3bfc4e[_0xc4442f][_0x121f97(0x13f)]=_0x167360[0x0],_0x3bfc4e[_0xc4442f]['rack']=_0x167360[0x1],_0x3bfc4e[_0xc4442f][_0x121f97(0x169)]=0x0,_0x3bfc4e[_0xc4442f]['bin']=0x0,_0x3bfc4e[_0xc4442f][_0x121f97(0xf7)]=_0x121f97(0x100),_0x3bfc4e[_0xc4442f]['floorlevel']=_0x167360[0x5];}else{if(_0xc4442f==_0x15bc52){var _0x4962ac;if(_0x167360[0x4]=='L')_0x4962ac='Level';else _0x167360[0x4]=='F'&&(_0x4962ac=_0x121f97(0x100));_0x3bfc4e[_0xc4442f][_0x121f97(0x13f)]=_0x167360[0x0],_0x3bfc4e[_0xc4442f][_0x121f97(0x106)]=_0x167360[0x1],_0x3bfc4e[_0xc4442f][_0x121f97(0x169)]=_0x167360[0x2],_0x3bfc4e[_0xc4442f][_0x121f97(0xbd)]=_0x167360[0x3],_0x3bfc4e[_0xc4442f][_0x121f97(0xf7)]=_0x4962ac,_0x3bfc4e[_0xc4442f]['floorlevel']=_0x167360[0x5];}}}});}),_0x4042dd[_0x2cda93(0x9f)]((_0x2ef646,_0x5993ee)=>{var _0x4fb177=_0x2cda93;_0x3bfc4e[_0x5993ee][_0x4fb177(0xf3)]=_0x2ef646;}),_0x485e10[_0x2cda93(0x9f)]((_0x135002,_0x582bbc)=>{_0x3bfc4e[_0x582bbc]['id_transaction_from']=_0x135002;}),_0x592f25[_0x2cda93(0x9f)]((_0x224715,_0x1343b8)=>{var _0x3d1743=_0x2cda93;_0x3bfc4e[_0x1343b8][_0x3d1743(0x131)]=_0x224715;}),_0x51de8e[_0x2cda93(0x9f)]((_0x30424f,_0x7f60f0)=>{var _0x3df53e=_0x2cda93;_0x3bfc4e[_0x7f60f0][_0x3df53e(0xfb)]=_0x30424f;}),_0x58bd6f[_0x2cda93(0x9f)]((_0x3d8e69,_0x25f0bb)=>{var _0x14c14f=_0x2cda93;_0x3bfc4e[_0x25f0bb][_0x14c14f(0x11e)]=_0x3d8e69;}),_0x53b999['forEach']((_0x46fa32,_0x197048)=>{var _0x42787e=_0x2cda93;_0x3bfc4e[_0x197048][_0x42787e(0xdc)]=_0x46fa32;}),_0xbbe640[_0x2cda93(0x9f)]((_0x5e5aea,_0x3735b4)=>{_0x3bfc4e[_0x3735b4]['secondary_unit']=_0x5e5aea;}),_0x3b33bf[_0x2cda93(0x9f)]((_0x5e5ccf,_0x3599d5)=>{_0x3bfc4e[_0x3599d5]['product_code']=_0x5e5ccf;}),_0x3c97c4[_0x2cda93(0x9f)]((_0x1842a5,_0x2198de)=>{var _0x29dbca=_0x2cda93;_0x3bfc4e[_0x2198de][_0x29dbca(0x9e)]=_0x1842a5;}),_0x511569[_0x2cda93(0x9f)]((_0x24734a,_0x8bb23f)=>{var _0x2b3fe4=_0x2cda93;_0x3bfc4e[_0x8bb23f][_0x2b3fe4(0xec)]=_0x24734a;}),_0x21f09a[_0x2cda93(0x9f)]((_0x292370,_0x403076)=>{_0x3bfc4e[_0x403076]['maxperunit']=_0x292370;}),_0x5cacc1[_0x2cda93(0x9f)]((_0x2c9e84,_0x268642)=>{var _0x1e6aac=_0x2cda93;_0x3bfc4e[_0x268642][_0x1e6aac(0xd6)]=_0x2c9e84;}),_0xfa6239[_0x2cda93(0x9f)]((_0x4e6dd1,_0x37abf5)=>{_0x3bfc4e[_0x37abf5]['prod_cat']=_0x4e6dd1;}),_0x5bd1a3[_0x2cda93(0x9f)]((_0x428ff9,_0x16b28a)=>{var _0x5b6f74=_0x2cda93;_0x3bfc4e[_0x16b28a][_0x5b6f74(0x10b)]=_0x428ff9;}),_0x4c0887[_0x2cda93(0x9f)]((_0xaadcfc,_0x29076a)=>{var _0x208e08=_0x2cda93;_0x3bfc4e[_0x29076a][_0x208e08(0xcf)]=_0xaadcfc;}),_0x1d15cc['forEach']((_0x1afe57,_0x58c16f)=>{_0x3bfc4e[_0x58c16f]['secondary_code']=_0x1afe57;}),_0x3d9fa2[_0x2cda93(0x9f)]((_0xfb07df,_0x5fb507)=>{var _0x5f18e8=_0x2cda93;_0x3bfc4e[_0x5fb507][_0x5f18e8(0xc5)]=_0xfb07df;});const _0xe16f9a=_0x3bfc4e['filter'](_0x4aae46=>_0x4aae46[_0x2cda93(0xfb)]!=='0'&&_0x4aae46[_0x2cda93(0xfb)]!=='');var _0x565448=0x0;_0xe16f9a[_0x2cda93(0x9f)](_0x25e3cf=>{var _0x39bc71=_0x2cda93;console[_0x39bc71(0xa4)](_0x39bc71(0x149),_0x25e3cf),parseInt(_0x25e3cf['adjust_qty'])<=0x0&&_0x565448++;});if(_0x565448!=0x0)return _0x51daaa[_0x2cda93(0x14e)]('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x387df7[_0x2cda93(0x15a)](_0x2cda93(0x12d));const _0x59b3fe=new adjustment({'warehouse_name':_0xc6f9b0,'date':_0x67eb26,'product':_0xe16f9a,'note':_0x118671,'room':_0x2ece6b,'invoice':_0x1c3f6d,'JO_number':_0x431d5d,'expiry_date':_0x46ccd1}),_0x38d9b1=await _0x59b3fe[_0x2cda93(0x120)]();_0x51daaa['flash'](_0x2cda93(0x12c),_0x2cda93(0xf5)),_0x387df7[_0x2cda93(0x15a)](_0x2cda93(0x156)+_0x38d9b1[_0x2cda93(0xc3)]);}catch(_0x2da534){console[_0x2cda93(0xa4)](_0x2da534),_0x387df7[_0x2cda93(0x12a)](0xc8)[_0x2cda93(0x16a)]({'message':_0x2da534[_0x2cda93(0xca)]});}}),router[a0_0x27faed(0xa8)]('/preview/:id',auth,async(_0x4e04ac,_0x3b56bc)=>{var _0x19c9d7=a0_0x27faed;try{const {username:_0x2334c8,email:_0x3c26fa,role:_0x166074}=_0x4e04ac[_0x19c9d7(0x14c)],_0x27bf99=_0x4e04ac['user'],_0x9a41ea=await profile[_0x19c9d7(0x142)]({'email':_0x27bf99['email']}),_0x54b636=await master_shop['find'](),_0x3297e2=_0x4e04ac[_0x19c9d7(0xe4)]['id'],_0x41764a=await adjustment[_0x19c9d7(0xbb)]({'_id':_0x3297e2}),_0x8b77d6=await purchases['aggregate']([{'$match':{'warehouse_name':_0x41764a['warehouse_name']}},{'$unwind':_0x19c9d7(0x143)},{'$group':{'_id':'$product.product_name'}}]),_0x561a05=await product[_0x19c9d7(0xa6)]({}),_0x1da782=await warehouse[_0x19c9d7(0x127)]([{'$match':{'name':_0x41764a[_0x19c9d7(0xd0)]}},{'$unwind':_0x19c9d7(0x12e)},{'$group':{'_id':_0x19c9d7(0xc7),'name':{'$first':_0x19c9d7(0xb5)},'product_stock':{'$first':_0x19c9d7(0xe1)},'bay':{'$first':_0x19c9d7(0x122)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x19c9d7(0x102)},'floorlevel':{'$first':_0x19c9d7(0xe3)},'primary_code':{'$first':_0x19c9d7(0xc1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x19c9d7(0x16b)},'rack':{'$first':_0x19c9d7(0x13a)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x19c9d7(0x145)},'production_date':{'$first':_0x19c9d7(0x11b)},'batch_code':{'$first':_0x19c9d7(0xd9)},'room':{'$first':_0x19c9d7(0xdb)}}}]);if(_0x54b636[0x0][_0x19c9d7(0x135)]==_0x19c9d7(0xc9)){var _0x44688a=users[_0x19c9d7(0x130)];console[_0x19c9d7(0xa4)](_0x44688a);}else{if(_0x54b636[0x0][_0x19c9d7(0x135)]==_0x19c9d7(0xd3))var _0x44688a=users[_0x19c9d7(0xd3)];else{if(_0x54b636[0x0][_0x19c9d7(0x135)]=='German')var _0x44688a=users[_0x19c9d7(0xa2)];else{if(_0x54b636[0x0][_0x19c9d7(0x135)]=='Spanish')var _0x44688a=users[_0x19c9d7(0x15f)];else{if(_0x54b636[0x0]['language']==_0x19c9d7(0x126))var _0x44688a=users['French'];else{if(_0x54b636[0x0][_0x19c9d7(0x135)]==_0x19c9d7(0xab))var _0x44688a=users[_0x19c9d7(0x157)];else{if(_0x54b636[0x0][_0x19c9d7(0x135)]==_0x19c9d7(0xe8))var _0x44688a=users[_0x19c9d7(0xe8)];else{if(_0x54b636[0x0][_0x19c9d7(0x135)]==_0x19c9d7(0xd5))var _0x44688a=users[_0x19c9d7(0xa3)];}}}}}}}_0x3b56bc[_0x19c9d7(0xa1)]('edit_adjustment_view',{'success':_0x4e04ac['flash']('success'),'errors':_0x4e04ac[_0x19c9d7(0x14e)]('errors'),'role':_0x27bf99,'profile':_0x9a41ea,'adjustment':_0x41764a,'stock':_0x1da782,'master_shop':_0x54b636,'warehouse_name':_0x8b77d6,'unit':_0x561a05,'language':_0x44688a});}catch(_0x3af4a9){console[_0x19c9d7(0xa4)](_0x3af4a9),_0x3b56bc[_0x19c9d7(0x12a)](0xc8)[_0x19c9d7(0x16a)]({'message':_0x3af4a9[_0x19c9d7(0xca)]});}}),router[a0_0x27faed(0xb2)](a0_0x27faed(0xb3),auth,async(_0x11ab73,_0x50137e)=>{var _0x3e2c56=a0_0x27faed;try{const _0x6c67ea=_0x11ab73[_0x3e2c56(0xe4)]['id'],{warehouse_name:_0x10be34,Room_name:_0x4f500f}=_0x11ab73[_0x3e2c56(0xda)],_0x3eba61=await adjustment[_0x3e2c56(0xbb)]({'_id':_0x6c67ea}),_0x676492=_0x3eba61[_0x3e2c56(0x11d)][_0x3e2c56(0x146)](async _0x5ebe24=>{var _0x3d2b4e=_0x3e2c56;if(_0x5ebe24[_0x3d2b4e(0xfb)]>0x0){var _0x479dd7=await warehouse[_0x3d2b4e(0x142)]({'name':_0x10be34,'room':_0x5ebe24[_0x3d2b4e(0x10b)],'warehouse_category':_0x3d2b4e(0x101)});const _0xf4a636=_0x479dd7['product_details']['map'](_0x223cab=>{var _0x5514dd=_0x3d2b4e;console[_0x5514dd(0xa4)](_0x5ebe24[_0x5514dd(0x131)]+_0x5514dd(0x165));if(_0x5ebe24[_0x5514dd(0x131)]==_0x5514dd(0x154)){if(_0x223cab['product_name']==_0x5ebe24[_0x5514dd(0x168)]&&_0x223cab[_0x5514dd(0x132)]==_0x5ebe24[_0x5514dd(0x132)]&&_0x223cab[_0x5514dd(0xf7)]==_0x5ebe24[_0x5514dd(0xf7)]&&_0x223cab['bin']==_0x5ebe24['bin']&&_0x223cab[_0x5514dd(0x169)]==_0x5ebe24[_0x5514dd(0x169)]&&_0x223cab['rack']==_0x5ebe24[_0x5514dd(0x106)]&&_0x223cab[_0x5514dd(0x13f)]==_0x5ebe24[_0x5514dd(0x13f)]&&_0x223cab[_0x5514dd(0xec)]==_0x5ebe24[_0x5514dd(0xec)]&&_0x223cab[_0x5514dd(0x9e)]==_0x5ebe24[_0x5514dd(0x9e)]&&_0x223cab[_0x5514dd(0xd6)]==_0x5ebe24[_0x5514dd(0xd6)]&&_0x223cab[_0x5514dd(0xc5)]==_0x5ebe24[_0x5514dd(0xc5)]&&_0x223cab[_0x5514dd(0xc3)]==_0x5ebe24['id_transaction_from']){var _0x30f227;_0x30f227=_0x5ebe24[_0x5514dd(0xfb)],_0x5ebe24[_0x5514dd(0x116)]=='S'&&(_0x30f227=_0x5ebe24[_0x5514dd(0xfb)]),_0x223cab['product_stock']=_0x223cab[_0x5514dd(0xf2)]-_0x30f227;}}else{if(_0x223cab[_0x5514dd(0x168)]==_0x5ebe24[_0x5514dd(0x168)]&&_0x223cab[_0x5514dd(0x132)]==_0x5ebe24[_0x5514dd(0x132)]&&_0x223cab['type']==_0x5ebe24[_0x5514dd(0xf7)]&&_0x223cab[_0x5514dd(0xbd)]==_0x5ebe24[_0x5514dd(0xbd)]&&_0x223cab['bay']==_0x5ebe24['bay']&&_0x223cab[_0x5514dd(0x106)]==_0x5ebe24['rack']&&_0x223cab[_0x5514dd(0x13f)]==_0x5ebe24[_0x5514dd(0x13f)]&&_0x223cab[_0x5514dd(0xec)]==_0x5ebe24[_0x5514dd(0xec)]&&_0x223cab[_0x5514dd(0x9e)]==_0x5ebe24[_0x5514dd(0x9e)]&&_0x223cab['production_date']==_0x5ebe24[_0x5514dd(0xd6)]&&_0x223cab[_0x5514dd(0xc5)]==_0x5ebe24[_0x5514dd(0xc5)]&&_0x223cab['_id']==_0x5ebe24[_0x5514dd(0x166)]){console[_0x5514dd(0xa4)](_0x5ebe24);var _0x30f227;_0x30f227=_0x5ebe24['adjust_qty'],_0x5ebe24[_0x5514dd(0x116)]=='S'&&(_0x30f227=_0x5ebe24[_0x5514dd(0xfb)]),_0x223cab['product_stock']=_0x223cab[_0x5514dd(0xf2)]+_0x30f227;}}});}return _0x479dd7;});Promise[_0x3e2c56(0xe2)](_0x676492)[_0x3e2c56(0x11c)](async _0x32dfe0=>{var _0x44f45b=_0x3e2c56;try{for(const _0x164a45 of _0x32dfe0){await _0x164a45[_0x44f45b(0x120)]();}_0x3eba61['finalize']=_0x44f45b(0xb4);const _0x3e9ba8=await _0x3eba61['save'](),_0x5d6f5f=await master_shop[_0x44f45b(0xa6)](),_0x2088ac=await email_settings[_0x44f45b(0x142)](),_0x3e2320=await supervisor_settings[_0x44f45b(0xa6)]();var _0x276cf6=_0x3eba61['product'],_0x2a29b0='',_0x2f0500;for(_0x2f0500 in _0x276cf6){_0x2a29b0+=_0x44f45b(0x160)+_0x44f45b(0xe6)+_0x276cf6[_0x2f0500][_0x44f45b(0x168)]+_0x44f45b(0xd1)+_0x44f45b(0xe6)+_0x276cf6[_0x2f0500][_0x44f45b(0xf4)]+'</td>'+_0x44f45b(0xe6)+_0x276cf6[_0x2f0500][_0x44f45b(0xfb)]+_0x44f45b(0xd1)+_0x44f45b(0xe6)+_0x276cf6[_0x2f0500][_0x44f45b(0xdc)]+_0x44f45b(0xd1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x276cf6[_0x2f0500][_0x44f45b(0x13d)]+'</td>'+_0x44f45b(0xe6)+_0x3eba61[_0x44f45b(0xd0)]+_0x44f45b(0xd1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x276cf6[_0x2f0500]['room_names']+_0x44f45b(0xd1)+_0x44f45b(0xe6)+_0x276cf6[_0x2f0500][_0x44f45b(0x13f)]+_0x276cf6[_0x2f0500]['rack']+_0x276cf6[_0x2f0500]['bay']+_0x276cf6[_0x2f0500]['bin']+_0x276cf6[_0x2f0500][_0x44f45b(0xf7)][0x0]+_0x276cf6[_0x2f0500][_0x44f45b(0x132)]+_0x44f45b(0xd1),_0x44f45b(0x137);}let _0xe37414=nodemailer[_0x44f45b(0x103)]({'host':_0x2088ac['host'],'port':Number(_0x2088ac[_0x44f45b(0x147)]),'secure':![],'auth':{'user':_0x2088ac['email'],'pass':_0x2088ac[_0x44f45b(0x12f)]}}),_0x3124a6={'from':_0x2088ac[_0x44f45b(0xea)],'to':_0x3e2320[0x0][_0x44f45b(0xf6)],'subject':_0x44f45b(0x104),'attachments':[{'filename':_0x44f45b(0xc4),'path':__dirname+_0x44f45b(0x14f)+_0x44f45b(0xf9)+_0x5d6f5f[0x0][_0x44f45b(0x111)],'cid':_0x44f45b(0x112)}],'html':_0x44f45b(0x13e)+_0x44f45b(0x115)+_0x44f45b(0xd7)+_0x44f45b(0x11a)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x44f45b(0x11a)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x44f45b(0xdd)+'<div>'+_0x44f45b(0xef)+_0x5d6f5f[0x0][_0x44f45b(0xd4)]+'\x20</h2>'+_0x44f45b(0xdd)+'</div>'+_0x44f45b(0x161)+_0x44f45b(0x11a)+_0x44f45b(0x10c)+_0x44f45b(0x123)+_0x3eba61[_0x44f45b(0xc5)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x44f45b(0xcb)+_0x3eba61['date']+'\x20'+_0x44f45b(0xe5)+_0x44f45b(0x10a)+_0x44f45b(0xdd)+_0x44f45b(0x118)+_0x44f45b(0xba)+_0x44f45b(0x160)+_0x44f45b(0xc6)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x44f45b(0xf0)+_0x44f45b(0xb8)+_0x44f45b(0xed)+_0x44f45b(0x139)+_0x44f45b(0xeb)+_0x44f45b(0x137)+_0x44f45b(0x144)+_0x44f45b(0xcc)+'\x20'+_0x2a29b0+'\x20'+'</tbody>'+_0x44f45b(0x167)+_0x44f45b(0x11a)+_0x44f45b(0x121)+_0x44f45b(0x108)+_0x5d6f5f[0x0][_0x44f45b(0xd4)]+_0x44f45b(0x10a)+_0x44f45b(0xdd)+'</div>'+_0x44f45b(0xff)};_0xe37414[_0x44f45b(0x150)](_0x3124a6,function(_0x26798b,_0x4dc29c){var _0x17a7bb=_0x44f45b;_0x26798b?(console[_0x17a7bb(0xa4)](_0x26798b),console[_0x17a7bb(0xa4)](_0x17a7bb(0xa7))):console['log'](_0x17a7bb(0x15d));}),_0x11ab73[_0x44f45b(0x14e)](_0x44f45b(0x12c),_0x44f45b(0x107)),_0x50137e[_0x44f45b(0x15a)]('/picking_list/PDF_adjustment_rm/'+_0x3e9ba8[_0x44f45b(0xc3)]);}catch(_0x5f2b91){console['error'](_0x5f2b91),_0x50137e[_0x44f45b(0x12a)](0x1f4)['json']({'error':_0x44f45b(0x124)});}})[_0x3e2c56(0xb6)](_0x4a1ed8=>{var _0x4b81b9=_0x3e2c56;console['error'](_0x4a1ed8),_0x50137e[_0x4b81b9(0x12a)](0x1f4)[_0x4b81b9(0x16a)]({'error':_0x4b81b9(0x114)});});}catch(_0x13fa02){console[_0x3e2c56(0xa4)](_0x13fa02),_0x50137e[_0x3e2c56(0x12a)](0xc8)['json']({'message':_0x13fa02[_0x3e2c56(0xca)]});}}),router[a0_0x27faed(0xa8)](a0_0x27faed(0x15e),auth,async(_0x4cf473,_0x2862ca)=>{var _0x3d67a8=a0_0x27faed;try{const {username:_0x175571,email:_0x1c6b14,role:_0x4a6656}=_0x4cf473['user'],_0x5eca15=_0x4cf473['user'],_0x38f675=await profile['findOne']({'email':_0x5eca15[_0x3d67a8(0xea)]}),_0xb1592b=await master_shop[_0x3d67a8(0xa6)](),_0x2e1da5=_0x4cf473[_0x3d67a8(0xe4)]['id'],_0x15886a=await adjustment[_0x3d67a8(0xbb)]({'_id':_0x2e1da5}),_0x4e38a5=await purchases['aggregate']([{'$match':{'warehouse_name':_0x15886a[_0x3d67a8(0xd0)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x2c0272=await product[_0x3d67a8(0xa6)]({}),_0x4d639c=await warehouse[_0x3d67a8(0x127)]([{'$match':{'name':_0x15886a[_0x3d67a8(0xd0)]}},{'$unwind':_0x3d67a8(0x12e)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3d67a8(0xb5)},'product_stock':{'$first':_0x3d67a8(0xe1)},'bay':{'$first':_0x3d67a8(0x122)},'bin':{'$first':_0x3d67a8(0x129)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3d67a8(0xe3)},'primary_code':{'$first':_0x3d67a8(0xc1)},'secondary_code':{'$first':_0x3d67a8(0x13b)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3d67a8(0x16b)},'rack':{'$first':_0x3d67a8(0x13a)},'maxPerUnit':{'$first':_0x3d67a8(0x13c)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3d67a8(0x11b)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);let _0x46e568;if(_0x5eca15['role']==_0x3d67a8(0xce)){const _0x330546=await staff[_0x3d67a8(0x142)]({'email':_0x5eca15[_0x3d67a8(0xea)]});_0x46e568=await warehouse[_0x3d67a8(0x127)]([{'$match':{'status':_0x3d67a8(0x15b),'name':_0x330546[_0x3d67a8(0x14d)],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x3d67a8(0xe7),'name':{'$first':_0x3d67a8(0xe7)}}}]);}else _0x46e568=await warehouse[_0x3d67a8(0x127)]([{'$match':{'status':_0x3d67a8(0x15b),'warehouse_category':_0x3d67a8(0x101),'name':{'$ne':_0x3d67a8(0x11f)}}},{'$group':{'_id':_0x3d67a8(0xe7),'name':{'$first':_0x3d67a8(0xe7)}}}]);if(_0xb1592b[0x0][_0x3d67a8(0x135)]=='English\x20(US)'){var _0x2f835b=users['English'];console[_0x3d67a8(0xa4)](_0x2f835b);}else{if(_0xb1592b[0x0][_0x3d67a8(0x135)]=='Hindi')var _0x2f835b=users['Hindi'];else{if(_0xb1592b[0x0][_0x3d67a8(0x135)]=='German')var _0x2f835b=users[_0x3d67a8(0xa2)];else{if(_0xb1592b[0x0][_0x3d67a8(0x135)]==_0x3d67a8(0x15f))var _0x2f835b=users[_0x3d67a8(0x15f)];else{if(_0xb1592b[0x0][_0x3d67a8(0x135)]==_0x3d67a8(0x126))var _0x2f835b=users['French'];else{if(_0xb1592b[0x0][_0x3d67a8(0x135)]=='Portuguese\x20(BR)')var _0x2f835b=users['Portuguese'];else{if(_0xb1592b[0x0]['language']==_0x3d67a8(0xe8))var _0x2f835b=users[_0x3d67a8(0xe8)];else{if(_0xb1592b[0x0][_0x3d67a8(0x135)]==_0x3d67a8(0xd5))var _0x2f835b=users[_0x3d67a8(0xa3)];}}}}}}}_0x2862ca['render'](_0x3d67a8(0x151),{'success':_0x4cf473['flash'](_0x3d67a8(0x12c)),'errors':_0x4cf473[_0x3d67a8(0x14e)]('errors'),'role':_0x5eca15,'profile':_0x38f675,'adjustment':_0x15886a,'stock':_0x4d639c,'master_shop':_0xb1592b,'warehouse_name':_0x4e38a5,'unit':_0x2c0272,'language':_0x2f835b,'warehouse':_0x46e568});}catch(_0x21efad){console[_0x3d67a8(0xa4)](_0x21efad),_0x2862ca[_0x3d67a8(0x12a)](0xc8)[_0x3d67a8(0x16a)]({'message':_0x21efad[_0x3d67a8(0xca)]});}}),router[a0_0x27faed(0xb2)]('/view/:id',auth,async(_0x2077df,_0x4129d0)=>{var _0x1c0c97=a0_0x27faed;try{const _0x4780ca=_0x2077df[_0x1c0c97(0xe4)]['id'],_0x5d4f53=await adjustment[_0x1c0c97(0xbb)]({'_id':_0x4780ca}),_0x4cbfc6=await warehouse[_0x1c0c97(0x142)]({'name':_0x5d4f53[_0x1c0c97(0xd0)],'room':_0x5d4f53[_0x1c0c97(0x153)]}),{warehouse_name:_0x50b8b8,date:_0x208c5e,prod_name:_0x55ff62,level:_0x41d153,isle:_0x36d031,pallet:_0x40a8b5,stock:_0x2cfaaa,types:_0x12616a,adjust_qty:_0x25e74b,new_adjust_qty:_0x220aee,note:_0x542a9,Room_name:_0x4a553c,invoice:_0x5cb685,JO_number:_0x1a378f,expiry_date:_0x151067}=_0x2077df[_0x1c0c97(0xda)];if(typeof _0x55ff62==_0x1c0c97(0x110))var _0x29a675=[_0x2077df[_0x1c0c97(0xda)]['prod_name']],_0x380aa8=[_0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x159)]],_0x53ab45=[_0x2077df['body'][_0x1c0c97(0xdf)]],_0x491841=[_0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x131)]],_0x2e4a0d=[_0x2077df['body']['New_Qty_Converted_adj']],_0x3dd81e=[_0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x148)]],_0x2472ab=[_0x2077df['body'][_0x1c0c97(0x16d)]],_0x2c7290=[_0x2077df[_0x1c0c97(0xda)]['Secondary_units']],_0x36375b=[_0x2077df['body'][_0x1c0c97(0x15c)]],_0x5282be=[_0x2077df['body']['batch_code']],_0x1ab2ef=[_0x2077df['body'][_0x1c0c97(0xec)]],_0x45f0b4=[_0x2077df['body'][_0x1c0c97(0x152)]],_0x1a599e=[_0x2077df['body'][_0x1c0c97(0xd6)]],_0xe70f18=[_0x2077df[_0x1c0c97(0xda)]['prod_cat']],_0xebaad=[_0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x134)]],_0x9289bd=[_0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x10e)]],_0x4ce191=[_0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x164)]];else var _0x29a675=[..._0x2077df['body'][_0x1c0c97(0x16c)]],_0x380aa8=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x159)]],_0x53ab45=[..._0x2077df['body']['stock']],_0x491841=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x131)]],_0x2e4a0d=[..._0x2077df[_0x1c0c97(0xda)]['New_Qty_Converted_adj']],_0x3dd81e=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x148)]],_0x2472ab=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0xdc)]],_0x2c7290=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0xc0)]],_0x36375b=[..._0x2077df['body'][_0x1c0c97(0x15c)]],_0x5282be=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x9e)]],_0x1ab2ef=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0xec)]],_0x45f0b4=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x152)]],_0x1a599e=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0xd6)]],_0xe70f18=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x116)]],_0xebaad=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x134)]],_0x9289bd=[..._0x2077df['body'][_0x1c0c97(0x10e)]],_0x4ce191=[..._0x2077df[_0x1c0c97(0xda)][_0x1c0c97(0x164)]];const _0x9ae660=_0x29a675[_0x1c0c97(0x146)](_0x371e2b=>{return _0x371e2b={'product_name':_0x371e2b};});_0x380aa8['forEach']((_0x279bc8,_0xfa399a)=>{var _0x269a61=_0x1c0c97;_0xebaad[_0x269a61(0x9f)]((_0x1cc5e0,_0x63e244)=>{var _0x2b3f9c=_0x269a61;if(_0x1cc5e0==_0x2b3f9c(0xc8)&&_0xfa399a==_0x63e244){var _0x186652=_0x279bc8['slice'](0x3);_0x9ae660[_0xfa399a][_0x2b3f9c(0x13f)]=_0x279bc8[0x0],_0x9ae660[_0xfa399a]['rack']=_0x279bc8[0x1],_0x9ae660[_0xfa399a][_0x2b3f9c(0x169)]=0x0,_0x9ae660[_0xfa399a][_0x2b3f9c(0xbd)]=0x0,_0x9ae660[_0xfa399a][_0x2b3f9c(0xf7)]=_0x2b3f9c(0x100),_0x9ae660[_0xfa399a][_0x2b3f9c(0x132)]=_0x186652;}else{if(_0x1cc5e0=='Shelves'&&_0xfa399a==_0x63e244){var _0x186652=_0x279bc8[_0x2b3f9c(0xb7)](0x3);_0x9ae660[_0xfa399a][_0x2b3f9c(0x13f)]=_0x279bc8[0x0],_0x9ae660[_0xfa399a][_0x2b3f9c(0x106)]=_0x279bc8[0x1],_0x9ae660[_0xfa399a][_0x2b3f9c(0x169)]=0x0,_0x9ae660[_0xfa399a][_0x2b3f9c(0xbd)]=0x0,_0x9ae660[_0xfa399a][_0x2b3f9c(0xf7)]='Floor',_0x9ae660[_0xfa399a]['floorlevel']=_0x279bc8[0x5];}else{if(_0xfa399a==_0x63e244){var _0x4b9f90;if(_0x279bc8[0x4]=='L')_0x4b9f90=_0x2b3f9c(0xbc);else _0x279bc8[0x4]=='F'&&(_0x4b9f90=_0x2b3f9c(0x100));_0x9ae660[_0xfa399a]['storage']=_0x279bc8[0x0],_0x9ae660[_0xfa399a][_0x2b3f9c(0x106)]=_0x279bc8[0x1],_0x9ae660[_0xfa399a][_0x2b3f9c(0x169)]=_0x279bc8[0x2],_0x9ae660[_0xfa399a][_0x2b3f9c(0xbd)]=_0x279bc8[0x3],_0x9ae660[_0xfa399a][_0x2b3f9c(0xf7)]=_0x4b9f90,_0x9ae660[_0xfa399a][_0x2b3f9c(0x132)]=_0x279bc8[0x5];}}}});}),_0x53ab45['forEach']((_0x222aeb,_0x492372)=>{var _0x4e1de2=_0x1c0c97;_0x9ae660[_0x492372][_0x4e1de2(0xf3)]=_0x222aeb;}),_0x491841[_0x1c0c97(0x9f)]((_0x3f3d98,_0x109efd)=>{_0x9ae660[_0x109efd]['types']=_0x3f3d98;}),_0x2e4a0d[_0x1c0c97(0x9f)]((_0x3d9e44,_0x3a3f1a)=>{var _0x1d629e=_0x1c0c97;_0x9ae660[_0x3a3f1a][_0x1d629e(0xfb)]=_0x3d9e44;}),_0x3dd81e[_0x1c0c97(0x9f)]((_0x12ec2e,_0x25f0cf)=>{_0x9ae660[_0x25f0cf]['new_adjust_qty']=_0x12ec2e;}),_0x2472ab[_0x1c0c97(0x9f)]((_0x5f2f42,_0x2f3e67)=>{var _0x20e70e=_0x1c0c97;_0x9ae660[_0x2f3e67][_0x20e70e(0xdc)]=_0x5f2f42;}),_0x2c7290[_0x1c0c97(0x9f)]((_0x550e9e,_0x166109)=>{_0x9ae660[_0x166109]['secondary_unit']=_0x550e9e;}),_0x36375b[_0x1c0c97(0x9f)]((_0x463490,_0x3bbbb5)=>{var _0x55ae0d=_0x1c0c97;_0x9ae660[_0x3bbbb5][_0x55ae0d(0xf4)]=_0x463490;}),_0x5282be[_0x1c0c97(0x9f)]((_0x410edd,_0x376bc1)=>{var _0x3ce07b=_0x1c0c97;_0x9ae660[_0x376bc1][_0x3ce07b(0x9e)]=_0x410edd;}),_0x1ab2ef[_0x1c0c97(0x9f)]((_0x5d758c,_0x581427)=>{_0x9ae660[_0x581427]['expiry_date']=_0x5d758c;}),_0x45f0b4[_0x1c0c97(0x9f)]((_0x5a9268,_0x1da5e1)=>{var _0x375742=_0x1c0c97;_0x9ae660[_0x1da5e1][_0x375742(0xfa)]=_0x5a9268;}),_0x1a599e['forEach']((_0x4097ba,_0x1dde08)=>{var _0x3afb7a=_0x1c0c97;_0x9ae660[_0x1dde08][_0x3afb7a(0xd6)]=_0x4097ba;}),_0xe70f18[_0x1c0c97(0x9f)]((_0x17a96,_0x29ac0d)=>{var _0x570ffd=_0x1c0c97;_0x9ae660[_0x29ac0d][_0x570ffd(0x116)]=_0x17a96;}),_0xebaad[_0x1c0c97(0x9f)]((_0x4d021f,_0x1c7268)=>{var _0x65d3f6=_0x1c0c97;_0x9ae660[_0x1c7268][_0x65d3f6(0x10b)]=_0x4d021f;}),_0x9289bd[_0x1c0c97(0x9f)]((_0x35a1a3,_0x59c83f)=>{var _0x354b68=_0x1c0c97;_0x9ae660[_0x59c83f][_0x354b68(0xcf)]=_0x35a1a3;}),_0x4ce191[_0x1c0c97(0x9f)]((_0x3f3a0d,_0xcebec)=>{var _0x2e2936=_0x1c0c97;_0x9ae660[_0xcebec][_0x2e2936(0xc2)]=_0x3f3a0d;});const _0x5cd664=_0x9ae660[_0x1c0c97(0xaa)](_0x4dee3b=>_0x4dee3b[_0x1c0c97(0xfb)]!=='0'&&_0x4dee3b[_0x1c0c97(0xfb)]!=='');var _0x5f1516=0x0;_0x5cd664[_0x1c0c97(0x9f)](_0xb07929=>{var _0x2ceae9=_0x1c0c97;console['log']('foreach\x20newproduct',_0xb07929),parseInt(_0xb07929[_0x2ceae9(0xfb)])<=0x0&&_0x5f1516++;});if(_0x5f1516!=0x0)return _0x2077df[_0x1c0c97(0x14e)](_0x1c0c97(0xac),_0x1c0c97(0x117)),_0x4129d0[_0x1c0c97(0x15a)]('back');_0x5d4f53[_0x1c0c97(0xd0)]=_0x50b8b8,_0x5d4f53[_0x1c0c97(0x109)]=_0x208c5e,_0x5d4f53['product']=_0x5cd664,_0x5d4f53['note']=_0x542a9,_0x5d4f53[_0x1c0c97(0xc5)]=_0x5cb685,_0x5d4f53['isAllowEdit']=_0x1c0c97(0x125);const _0x5c4d3f=await _0x5d4f53[_0x1c0c97(0x120)]();_0x2077df[_0x1c0c97(0x14e)](_0x1c0c97(0x12c),_0x1c0c97(0xa9)),_0x4129d0[_0x1c0c97(0x15a)](_0x1c0c97(0x119));}catch(_0xfd1042){console[_0x1c0c97(0xa4)](_0xfd1042);}}),router[a0_0x27faed(0xb2)](a0_0x27faed(0xb1),async(_0x3e0490,_0x2e7294)=>{var _0x576e26=a0_0x27faed;const {primary_code:_0x413b46,warehouse_data:_0x5a6d78,rooms_data:_0x2dfbf2,Roomslist:_0x34044d}=_0x3e0490[_0x576e26(0xda)],_0x6752d3=_0x34044d[_0x576e26(0x163)](','),_0x31aafe=[];async function _0x160c41(_0x296b73){var _0x51fcd9=_0x576e26;const _0xd9c508=await warehouse[_0x51fcd9(0x127)]([{'$match':{'name':_0x5a6d78,'room':_0x296b73}},{'$unwind':_0x51fcd9(0x12e)},{'$match':{'product_details.primary_code':_0x413b46}},{'$group':{'_id':_0x51fcd9(0xc7),'name':{'$first':_0x51fcd9(0xb5)},'product_stock':{'$first':_0x51fcd9(0xe1)},'primary_code':{'$first':_0x51fcd9(0xc1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x51fcd9(0x128)},'level':{'$first':_0x51fcd9(0x122)},'isle':{'$first':_0x51fcd9(0x129)},'type':{'$first':_0x51fcd9(0x102)},'pallet':{'$first':_0x51fcd9(0xe3)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x51fcd9(0x16b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x51fcd9(0x145)},'production_date':{'$first':_0x51fcd9(0x11b)},'maxPerUnit':{'$first':_0x51fcd9(0x13c)},'batch_code':{'$first':_0x51fcd9(0xd9)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x51fcd9(0xf1)}}}]),_0x3da42d=await warehouse[_0x51fcd9(0x127)]([{'$match':{'name':_0x5a6d78,'room':_0x296b73}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x413b46}},{'$group':{'_id':_0x51fcd9(0xc7),'name':{'$first':_0x51fcd9(0xb5)},'product_stock':{'$first':_0x51fcd9(0xe1)},'primary_code':{'$first':_0x51fcd9(0xc1)},'secondary_code':{'$first':_0x51fcd9(0x13b)},'product_code':{'$first':_0x51fcd9(0x128)},'level':{'$first':_0x51fcd9(0x122)},'isle':{'$first':_0x51fcd9(0x129)},'type':{'$first':_0x51fcd9(0x102)},'pallet':{'$first':_0x51fcd9(0xe3)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x51fcd9(0x136)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x51fcd9(0x13a)},'expiry_date':{'$first':_0x51fcd9(0x145)},'production_date':{'$first':_0x51fcd9(0x11b)},'maxPerUnit':{'$first':_0x51fcd9(0x13c)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x51fcd9(0xfc)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0xd9c508[_0x51fcd9(0xb0)]>0x0)_0x31aafe[_0x51fcd9(0xd8)](_0xd9c508);else _0x3da42d[_0x51fcd9(0xb0)]>0x0&&_0x31aafe[_0x51fcd9(0xd8)](_0x3da42d);}const _0x531e39=_0x6752d3[_0x576e26(0x146)](_0x5d7fbe=>_0x160c41(_0x5d7fbe));await Promise[_0x576e26(0xe2)](_0x531e39),_0x2e7294['json'](_0x31aafe);}),router[a0_0x27faed(0xb2)](a0_0x27faed(0x113),async(_0x4b3ef3,_0x43cbe0)=>{var _0x4fe69a=a0_0x27faed;const {primaryCode:_0x7b75ae,secondaryCode:_0x36d9a3,productCode:_0x5c2c44,level:_0x29ffd7,isle:_0x18668b,pallet:_0x36ed9a,warehouses:_0x574e44,room:_0x2553f8}=_0x4b3ef3[_0x4fe69a(0xda)];try{const _0x5ae708=await warehouse[_0x4fe69a(0x127)]([{'$match':{'name':_0x574e44,'room':_0x2553f8}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x29ffd7),'product_details.isle':_0x18668b,'product_details.pallet':parseInt(_0x36ed9a)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4fe69a(0xb5)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x4fe69a(0x133)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x43cbe0[_0x4fe69a(0x12a)](0xc8)[_0x4fe69a(0x16a)](_0x5ae708);}catch(_0x4bdd49){_0x43cbe0[_0x4fe69a(0x12a)](0x194)[_0x4fe69a(0x16a)]({'message':_0x4bdd49[_0x4fe69a(0xca)]});}}),module[a0_0x27faed(0x9d)]=router;