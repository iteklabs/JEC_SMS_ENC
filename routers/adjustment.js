var a0_0x107e95=a0_0x4153;function a0_0x4153(_0x7ab8c2,_0x52aa58){var _0x5c5a4e=a0_0x5c5a();return a0_0x4153=function(_0x41535d,_0xb8a785){_0x41535d=_0x41535d-0x125;var _0x2f3b35=_0x5c5a4e[_0x41535d];return _0x2f3b35;},a0_0x4153(_0x7ab8c2,_0x52aa58);}(function(_0x5ecb28,_0x53485e){var _0x4c8ffc=a0_0x4153,_0xd655ae=_0x5ecb28();while(!![]){try{var _0x595dd1=-parseInt(_0x4c8ffc(0x127))/0x1+parseInt(_0x4c8ffc(0x184))/0x2+parseInt(_0x4c8ffc(0x1d0))/0x3*(parseInt(_0x4c8ffc(0x162))/0x4)+-parseInt(_0x4c8ffc(0x1c9))/0x5*(parseInt(_0x4c8ffc(0x1da))/0x6)+parseInt(_0x4c8ffc(0x1b5))/0x7+parseInt(_0x4c8ffc(0x192))/0x8+parseInt(_0x4c8ffc(0x1d1))/0x9;if(_0x595dd1===_0x53485e)break;else _0xd655ae['push'](_0xd655ae['shift']());}catch(_0x1361ca){_0xd655ae['push'](_0xd655ae['shift']());}}}(a0_0x5c5a,0x2c1f4));const express=require(a0_0x107e95(0x1a3)),app=express(),router=express[a0_0x107e95(0x126)](),auth=require(a0_0x107e95(0x1eb)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x107e95(0x194)),users=require(a0_0x107e95(0x15e)),nodemailer=require(a0_0x107e95(0x18f));function a0_0x5c5a(){var _0x1f402b=['An\x20error\x20occurred.','warehouse','Rooms','False','English\x20(US)','$product_details.unit','prime1','Logo.png','Arabic\x20(ae)','success','Router','281758XbDtsL','$product_details.level','rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','floorlevel','get','German','error','padStart','adjustment','log','$invoice','push','Enclosed','$product_details._id','master','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.storage','post','Spanish','product_name','language','ADJ-','_id','An\x20error\x20occurred\x20while\x20saving\x20data.','all','<div>','id_transaction','/preview/:id','</div>','English','floor','Portuguese\x20(BR)','</tbody>','length','$product_details.type','$product.room_names','bay','/view/:id','Floor','prod_name','image','Enabled','</span>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','new_adjust_qty','$product_details.product_stock','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.isle','types','<h5>','storage','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Arabic','../public/language/languages.json','prod_cat','$product_details.expiry_date','$name','178348wxgCJX','</thead>','type','render','Receiving\x20Area','user','params','$product_details.product_cat','$product_details','</h5>','New_Qty_Converted','port','$product_details.bin','Email\x20sent\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/CheckingWarehouse','</body></html>','add_adjustment','product_code','level','\x20<>\x20','$product_details.invoice','Primary_Units','</tr>','secondary_unit','$product_details.primary_code','batch_code','string','filter','body','adjustment\x20Finalized\x20successfully','$product_details.secondary_unit','secondary_code','second1','98176mGezmU','<span\x20style=\x22float:\x20right;\x22>','$product_details.rack','$product_details.batch_code','toString','$product','$product.product_name','id_transaction_from','redirect','max_per_unit','True','nodemailer','adjustment\x20add\x20successfull','New_Qty_Converted_adj','408592clhguZ','adjustment\x20data\x20update\x20successfully','../models/all_models','product_details','$date','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','back','$product_details.secondary_code','$product_details.pallet','Return\x20Goods','catch','random','findById','room_names','<html><head><title></title>','product','message','express','$room','save','maxperunit','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','host','\x20</h2>','/../public','</td>','/picking_list/PDF_adjustment_rm/','errors','Level','foreach\x20newproduct','$warehouse_name','primary_code','bin','prod_code','679007BsVBTU','</table>','email','edit_adjustment_view','stockBefore','json','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','findOne','$product_details.product_code','logo','expiry_date','createTransport','sendMail','/view','$isAllowEdit','role','warehouse_name','$product_details.bay','<tr>','slice','7295FcfLSE','$product_details.maxPerUnit','adjust_qty','<strong>\x20Regards\x20</strong>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','status','find','3ihortP','4757229BxONvF','<h2>\x20','Shelves','$product_details.floorlevel','stock','site_title','$product_details.production_date','forEach','prod_invoice','1266IMRRZR','invoice','\x20Order\x20Number\x20:\x20','Ambient','Error\x20Occurs','$product_details.maxProducts','</head><body>','production_date','$product_details.product_name','/view/add_adjustment','Secondary_units','Chinese','flash','Portuguese','Raw\x20Materials','unit','aggregate','../middleware/auth','split','product_stock','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Return\x20Rooms','$_id','French','Hindi','map'];a0_0x5c5a=function(){return _0x1f402b;};return a0_0x5c5a();}router['get'](a0_0x107e95(0x1c2),auth,async(_0x387dd4,_0x25c797)=>{var _0x2fc4be=a0_0x107e95;try{const {username:_0x3ec2bb,email:_0x8c9c13,role:_0x4a9dc8}=_0x387dd4[_0x2fc4be(0x167)],_0x46ca2a=_0x387dd4[_0x2fc4be(0x167)],_0x4b12f3=await profile[_0x2fc4be(0x1bc)]({'email':_0x46ca2a[_0x2fc4be(0x1b7)]}),_0x1e3762=await master_shop['find']();console[_0x2fc4be(0x131)](_0x2fc4be(0x136),_0x1e3762);let _0x41f94e;if(_0x46ca2a[_0x2fc4be(0x1c4)]==_0x2fc4be(0x137)){const _0x166485=await staff[_0x2fc4be(0x1bc)]({'email':_0x46ca2a[_0x2fc4be(0x1b7)]});_0x41f94e=await warehouse[_0x2fc4be(0x1cf)]({'status':_0x2fc4be(0x152),'name':_0x166485[_0x2fc4be(0x1f5)]});}else _0x41f94e=await warehouse['find']({'status':'Enabled'});const _0x3f3964=await product[_0x2fc4be(0x1cf)]();let _0x4db000;if(_0x46ca2a[_0x2fc4be(0x1c4)]==_0x2fc4be(0x137)){const _0x15caca=await staff[_0x2fc4be(0x1bc)]({'email':_0x46ca2a['email']});_0x4db000=await adjustment[_0x2fc4be(0x1cf)]({'warehouse_name':_0x15caca[_0x2fc4be(0x1f5)]});}else _0x4db000=await adjustment[_0x2fc4be(0x1ea)]([{'$unwind':'$product'},{'$group':{'_id':_0x2fc4be(0x1f0),'invoice':{'$first':_0x2fc4be(0x132)},'date':{'$first':_0x2fc4be(0x196)},'warehouse_name':{'$first':_0x2fc4be(0x1b1)},'room':{'$addToSet':_0x2fc4be(0x14c)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x2fc4be(0x1c3)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1e3762[0x0][_0x2fc4be(0x13d)]==_0x2fc4be(0x1f8)){var _0x5564f5=users[_0x2fc4be(0x146)];console[_0x2fc4be(0x131)](_0x5564f5);}else{if(_0x1e3762[0x0][_0x2fc4be(0x13d)]==_0x2fc4be(0x1f2))var _0x5564f5=users['Hindi'];else{if(_0x1e3762[0x0][_0x2fc4be(0x13d)]==_0x2fc4be(0x12d))var _0x5564f5=users[_0x2fc4be(0x12d)];else{if(_0x1e3762[0x0][_0x2fc4be(0x13d)]==_0x2fc4be(0x13b))var _0x5564f5=users[_0x2fc4be(0x13b)];else{if(_0x1e3762[0x0][_0x2fc4be(0x13d)]==_0x2fc4be(0x1f1))var _0x5564f5=users['French'];else{if(_0x1e3762[0x0][_0x2fc4be(0x13d)]=='Portuguese\x20(BR)')var _0x5564f5=users[_0x2fc4be(0x1e7)];else{if(_0x1e3762[0x0][_0x2fc4be(0x13d)]=='Chinese')var _0x5564f5=users['Chinese'];else{if(_0x1e3762[0x0][_0x2fc4be(0x13d)]==_0x2fc4be(0x1fc))var _0x5564f5=users[_0x2fc4be(0x15d)];}}}}}}}_0x25c797[_0x2fc4be(0x165)](_0x2fc4be(0x130),{'success':_0x387dd4['flash'](_0x2fc4be(0x125)),'errors':_0x387dd4[_0x2fc4be(0x1e6)](_0x2fc4be(0x1ae)),'role':_0x46ca2a,'profile':_0x4b12f3,'warehouse':_0x41f94e,'product':_0x3f3964,'adjustment':_0x4db000,'master_shop':_0x1e3762,'language':_0x5564f5});}catch(_0x194e70){console['log'](_0x194e70);}});async function getRandom8DigitNumber(){var _0x51c89d=a0_0x107e95;const _0x9a66ab=0x989680,_0x1119f1=0x5f5e0ff,_0x12938d=Math[_0x51c89d(0x147)](Math[_0x51c89d(0x19d)]()*(_0x1119f1-_0x9a66ab+0x1))+_0x9a66ab;var _0x1007af;const _0x43705c=await adjustment[_0x51c89d(0x1bc)]({'invoice':_0x51c89d(0x13e)+_0x12938d});return _0x43705c&&_0x43705c[_0x51c89d(0x14a)]>0x0?_0x1007af=_0x51c89d(0x13e)+_0x12938d:_0x1007af=_0x51c89d(0x13e)+_0x12938d,_0x1007af;}router[a0_0x107e95(0x12c)](a0_0x107e95(0x1e3),auth,async(_0x4b6d9c,_0x538dc6)=>{var _0x20e599=a0_0x107e95;try{const {username:_0xc1f0a4,email:_0x3b0aa6,role:_0x4d2bf7}=_0x4b6d9c['user'],_0x484dca=_0x4b6d9c[_0x20e599(0x167)],_0x4b371d=await profile[_0x20e599(0x1bc)]({'email':_0x484dca[_0x20e599(0x1b7)]}),_0x5c51c2=await master_shop[_0x20e599(0x1cf)]();let _0xcf590e;if(_0x484dca[_0x20e599(0x1c4)]==_0x20e599(0x137)){const _0x3d3a70=await staff[_0x20e599(0x1bc)]({'email':_0x484dca['email']});_0xcf590e=await warehouse[_0x20e599(0x1ea)]([{'$match':{'status':_0x20e599(0x152),'name':_0x3d3a70['warehouse'],'warehouse_category':_0x20e599(0x1e8),'name':{'$ne':_0x20e599(0x19b)}}},{'$group':{'_id':_0x20e599(0x161),'name':{'$first':'$name'}}}]);}else _0xcf590e=await warehouse['aggregate']([{'$match':{'status':_0x20e599(0x152),'warehouse_category':_0x20e599(0x1e8),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x20e599(0x161),'name':{'$first':'$name'}}}]);const _0x9fa2d8=await product[_0x20e599(0x1cf)]({}),_0x2d4444=await adjustment[_0x20e599(0x1cf)]({}),_0x3b4f8b=_0x2d4444[_0x20e599(0x14a)]+0x1,_0x24e7e8=_0x20e599(0x13e)+_0x3b4f8b[_0x20e599(0x188)]()[_0x20e599(0x12f)](0x5,'0');var _0x2297c1=[_0x20e599(0x1dd),_0x20e599(0x134),_0x20e599(0x1ef)];if(_0x5c51c2[0x0][_0x20e599(0x13d)]==_0x20e599(0x1f8))var _0x2cf563=users[_0x20e599(0x146)];else{if(_0x5c51c2[0x0][_0x20e599(0x13d)]=='Hindi')var _0x2cf563=users[_0x20e599(0x1f2)];else{if(_0x5c51c2[0x0][_0x20e599(0x13d)]==_0x20e599(0x12d))var _0x2cf563=users[_0x20e599(0x12d)];else{if(_0x5c51c2[0x0][_0x20e599(0x13d)]=='Spanish')var _0x2cf563=users['Spanish'];else{if(_0x5c51c2[0x0][_0x20e599(0x13d)]==_0x20e599(0x1f1))var _0x2cf563=users[_0x20e599(0x1f1)];else{if(_0x5c51c2[0x0]['language']==_0x20e599(0x148))var _0x2cf563=users['Portuguese'];else{if(_0x5c51c2[0x0][_0x20e599(0x13d)]==_0x20e599(0x1e5))var _0x2cf563=users['Chinese'];else{if(_0x5c51c2[0x0]['language']=='Arabic\x20(ae)')var _0x2cf563=users[_0x20e599(0x15d)];}}}}}}}const _0x352306=getRandom8DigitNumber();_0x352306['then'](_0x3865a2=>{var _0x26813b=_0x20e599;_0x538dc6[_0x26813b(0x165)](_0x26813b(0x173),{'success':_0x4b6d9c[_0x26813b(0x1e6)]('success'),'errors':_0x4b6d9c[_0x26813b(0x1e6)](_0x26813b(0x1ae)),'role':_0x484dca,'profile':_0x4b371d,'warehouse':_0xcf590e,'product':_0x9fa2d8,'master_shop':_0x5c51c2,'language':_0x2cf563,'rooms_data':_0x2297c1,'invoice_no':_0x3865a2});})[_0x20e599(0x19c)](_0x3a18f0=>{var _0x22f112=_0x20e599;_0x4b6d9c[_0x22f112(0x1e6)](_0x22f112(0x1ae),_0x22f112(0x1cd)),_0x538dc6[_0x22f112(0x18c)]('/adjustment/view');});}catch(_0x5734ac){console[_0x20e599(0x131)](_0x5734ac);}}),router[a0_0x107e95(0x13a)](a0_0x107e95(0x1e3),auth,async(_0x5489f0,_0x163b97)=>{var _0x8ed705=a0_0x107e95;try{const {warehouse_name:_0x152a89,date:_0x39f810,prod_name:_0x2097c9,level:_0x76eac8,isle:_0x3ea4e6,pallet:_0x4c46dc,stock:_0x3a7115,types:_0x32012b,adjust_qty:_0x53c304,new_adjust_qty:_0x396502,note:_0x559e76,Room_name:_0x56b555,invoice:_0x58fcd3,JO_number:_0x1b6aae,expiry_date:_0x13d8ff}=_0x5489f0[_0x8ed705(0x17f)];if(typeof _0x2097c9==_0x8ed705(0x17d))var _0x2af582=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x150)]],_0x59eab9=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x175)]],_0x18e123=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x1d5)]],_0x1ce527=[_0x5489f0['body'][_0x8ed705(0x159)]],_0x507fe7=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x191)]],_0x49f8da=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x16c)]],_0x27e8c1=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x178)]],_0x593012=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x1e4)]],_0x2466ee=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x1b4)]],_0x58060d=[_0x5489f0['body'][_0x8ed705(0x17c)]],_0x13dd9e=[_0x5489f0['body']['expiry_date']],_0x414c8b=[_0x5489f0[_0x8ed705(0x17f)]['max_per_unit']],_0x393f1c=[_0x5489f0['body'][_0x8ed705(0x1e1)]],_0x14930a=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x15f)]],_0x27c41d=[_0x5489f0[_0x8ed705(0x17f)]['Rooms']],_0x418eff=[_0x5489f0['body'][_0x8ed705(0x1fa)]],_0x5176ba=[_0x5489f0[_0x8ed705(0x17f)]['second1']],_0x47421b=[_0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x1d9)]],_0x3bf971=[_0x5489f0['body'][_0x8ed705(0x143)]];else var _0x2af582=[..._0x5489f0['body']['prod_name']],_0x59eab9=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x175)]],_0x18e123=[..._0x5489f0[_0x8ed705(0x17f)]['stock']],_0x1ce527=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x159)]],_0x507fe7=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x191)]],_0x49f8da=[..._0x5489f0[_0x8ed705(0x17f)]['New_Qty_Converted']],_0x27e8c1=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x1e9)]],_0x593012=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x1e4)]],_0x2466ee=[..._0x5489f0['body'][_0x8ed705(0x1b4)]],_0x58060d=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x17c)]],_0x13dd9e=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x1bf)]],_0x414c8b=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x18d)]],_0x393f1c=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x1e1)]],_0x14930a=[..._0x5489f0[_0x8ed705(0x17f)]['prod_cat']],_0x27c41d=[..._0x5489f0[_0x8ed705(0x17f)]['Rooms']],_0x418eff=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x1fa)]],_0x5176ba=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x183)]],_0x47421b=[..._0x5489f0[_0x8ed705(0x17f)]['prod_invoice']],_0x3bf971=[..._0x5489f0[_0x8ed705(0x17f)][_0x8ed705(0x143)]];const _0x2fdc3f=_0x2af582[_0x8ed705(0x1f3)](_0x26f1d8=>{return _0x26f1d8={'product_name':_0x26f1d8};});_0x59eab9[_0x8ed705(0x1d8)]((_0x306d83,_0x52bcb8)=>{var _0x25b3cc=_0x8ed705;_0x27c41d[_0x25b3cc(0x1d8)]((_0x2ce913,_0x5a1368)=>{var _0x4be411=_0x25b3cc;if(_0x2ce913=='Receiving\x20Area'&&_0x52bcb8==_0x5a1368){var _0x3e9cd8=_0x306d83[_0x4be411(0x1c8)](0x3);_0x2fdc3f[_0x52bcb8][_0x4be411(0x15b)]=_0x306d83[0x0],_0x2fdc3f[_0x52bcb8][_0x4be411(0x129)]=_0x306d83[0x1],_0x2fdc3f[_0x52bcb8]['bay']=0x0,_0x2fdc3f[_0x52bcb8][_0x4be411(0x1b3)]=0x0,_0x2fdc3f[_0x52bcb8][_0x4be411(0x164)]='Floor',_0x2fdc3f[_0x52bcb8][_0x4be411(0x12b)]=_0x3e9cd8;}else{if(_0x2ce913==_0x4be411(0x1d3)&&_0x52bcb8==_0x5a1368){var _0x3e9cd8=_0x306d83[_0x4be411(0x1c8)](0x3);_0x2fdc3f[_0x52bcb8][_0x4be411(0x15b)]=_0x306d83[0x0],_0x2fdc3f[_0x52bcb8]['rack']=_0x306d83[0x1],_0x2fdc3f[_0x52bcb8][_0x4be411(0x14d)]=0x0,_0x2fdc3f[_0x52bcb8][_0x4be411(0x1b3)]=0x0,_0x2fdc3f[_0x52bcb8][_0x4be411(0x164)]=_0x4be411(0x14f),_0x2fdc3f[_0x52bcb8]['floorlevel']=_0x306d83[0x5];}else{if(_0x52bcb8==_0x5a1368){var _0x3d9e28;if(_0x306d83[0x4]=='L')_0x3d9e28=_0x4be411(0x1af);else _0x306d83[0x4]=='F'&&(_0x3d9e28=_0x4be411(0x14f));_0x2fdc3f[_0x52bcb8][_0x4be411(0x15b)]=_0x306d83[0x0],_0x2fdc3f[_0x52bcb8][_0x4be411(0x129)]=_0x306d83[0x1],_0x2fdc3f[_0x52bcb8][_0x4be411(0x14d)]=_0x306d83[0x2],_0x2fdc3f[_0x52bcb8][_0x4be411(0x1b3)]=_0x306d83[0x3],_0x2fdc3f[_0x52bcb8][_0x4be411(0x164)]=_0x3d9e28,_0x2fdc3f[_0x52bcb8][_0x4be411(0x12b)]=_0x306d83[0x5];}}}});}),_0x18e123['forEach']((_0x232c2f,_0x1ad54a)=>{_0x2fdc3f[_0x1ad54a]['stockBefore']=_0x232c2f;}),_0x3bf971[_0x8ed705(0x1d8)]((_0x5880a2,_0x210289)=>{_0x2fdc3f[_0x210289]['id_transaction_from']=_0x5880a2;}),_0x1ce527[_0x8ed705(0x1d8)]((_0x3d0d53,_0x17e9d8)=>{_0x2fdc3f[_0x17e9d8]['types']=_0x3d0d53;}),_0x507fe7[_0x8ed705(0x1d8)]((_0x493df0,_0x351b73)=>{_0x2fdc3f[_0x351b73]['adjust_qty']=_0x493df0;}),_0x49f8da[_0x8ed705(0x1d8)]((_0x318e5a,_0x154545)=>{var _0x1bcb37=_0x8ed705;_0x2fdc3f[_0x154545][_0x1bcb37(0x155)]=_0x318e5a;}),_0x27e8c1['forEach']((_0x294bf,_0x1eac2e)=>{_0x2fdc3f[_0x1eac2e]['unit']=_0x294bf;}),_0x593012[_0x8ed705(0x1d8)]((_0x4628db,_0x5508fc)=>{_0x2fdc3f[_0x5508fc]['secondary_unit']=_0x4628db;}),_0x2466ee[_0x8ed705(0x1d8)]((_0x1a85e6,_0x138193)=>{_0x2fdc3f[_0x138193]['product_code']=_0x1a85e6;}),_0x58060d[_0x8ed705(0x1d8)]((_0x2cbda8,_0x3fd1d7)=>{var _0x22c748=_0x8ed705;_0x2fdc3f[_0x3fd1d7][_0x22c748(0x17c)]=_0x2cbda8;}),_0x13dd9e[_0x8ed705(0x1d8)]((_0x51ebeb,_0x129172)=>{_0x2fdc3f[_0x129172]['expiry_date']=_0x51ebeb;}),_0x414c8b['forEach']((_0xf9c0ea,_0x3c4908)=>{_0x2fdc3f[_0x3c4908]['maxperunit']=_0xf9c0ea;}),_0x393f1c[_0x8ed705(0x1d8)]((_0x147ef6,_0x3400f4)=>{_0x2fdc3f[_0x3400f4]['production_date']=_0x147ef6;}),_0x14930a[_0x8ed705(0x1d8)]((_0x3153fe,_0x47f86f)=>{_0x2fdc3f[_0x47f86f]['prod_cat']=_0x3153fe;}),_0x27c41d[_0x8ed705(0x1d8)]((_0x1a6a7c,_0xafca2e)=>{var _0x2ce8f3=_0x8ed705;_0x2fdc3f[_0xafca2e][_0x2ce8f3(0x19f)]=_0x1a6a7c;}),_0x418eff[_0x8ed705(0x1d8)]((_0x475c62,_0x5bda03)=>{_0x2fdc3f[_0x5bda03]['primary_code']=_0x475c62;}),_0x5176ba['forEach']((_0x473d3b,_0x3b0941)=>{var _0x4c8cbc=_0x8ed705;_0x2fdc3f[_0x3b0941][_0x4c8cbc(0x182)]=_0x473d3b;}),_0x47421b[_0x8ed705(0x1d8)]((_0x558b48,_0x588b74)=>{_0x2fdc3f[_0x588b74]['invoice']=_0x558b48;});const _0x435ae2=_0x2fdc3f[_0x8ed705(0x17e)](_0x152235=>_0x152235['adjust_qty']!=='0'&&_0x152235[_0x8ed705(0x1cb)]!=='');var _0x160579=0x0;_0x435ae2[_0x8ed705(0x1d8)](_0xf8f430=>{var _0x5f0926=_0x8ed705;console[_0x5f0926(0x131)]('foreach\x20newproduct',_0xf8f430),parseInt(_0xf8f430[_0x5f0926(0x1cb)])<=0x0&&_0x160579++;});if(_0x160579!=0x0)return _0x5489f0[_0x8ed705(0x1e6)](_0x8ed705(0x1ae),_0x8ed705(0x15c)),_0x163b97[_0x8ed705(0x18c)](_0x8ed705(0x198));const _0x5a41f7=new adjustment({'warehouse_name':_0x152a89,'date':_0x39f810,'product':_0x435ae2,'note':_0x559e76,'room':_0x56b555,'invoice':_0x58fcd3,'JO_number':_0x1b6aae,'expiry_date':_0x13d8ff}),_0x287c27=await _0x5a41f7[_0x8ed705(0x1a5)]();_0x5489f0[_0x8ed705(0x1e6)]('success',_0x8ed705(0x190)),_0x163b97['redirect']('/adjustment/preview/'+_0x287c27['_id']);}catch(_0xfe7969){console[_0x8ed705(0x131)](_0xfe7969),_0x163b97[_0x8ed705(0x1ce)](0xc8)[_0x8ed705(0x1ba)]({'message':_0xfe7969[_0x8ed705(0x1a2)]});}}),router[a0_0x107e95(0x12c)](a0_0x107e95(0x144),auth,async(_0x1d3fbd,_0x1932d9)=>{var _0x2cfac0=a0_0x107e95;try{const {username:_0x2f9719,email:_0x20c4cc,role:_0x1e2231}=_0x1d3fbd[_0x2cfac0(0x167)],_0x4c82cd=_0x1d3fbd[_0x2cfac0(0x167)],_0x227109=await profile[_0x2cfac0(0x1bc)]({'email':_0x4c82cd[_0x2cfac0(0x1b7)]}),_0x1f5bc8=await master_shop['find'](),_0x3e9fc8=_0x1d3fbd[_0x2cfac0(0x168)]['id'],_0xa8aa95=await adjustment[_0x2cfac0(0x19e)]({'_id':_0x3e9fc8}),_0x28a6a0=await purchases[_0x2cfac0(0x1ea)]([{'$match':{'warehouse_name':_0xa8aa95[_0x2cfac0(0x1c5)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x18d9f3=await product['find']({}),_0xdcecc3=await warehouse[_0x2cfac0(0x1ea)]([{'$match':{'name':_0xa8aa95[_0x2cfac0(0x1c5)]}},{'$unwind':_0x2cfac0(0x16a)},{'$group':{'_id':_0x2cfac0(0x135),'name':{'$first':_0x2cfac0(0x1e2)},'product_stock':{'$first':_0x2cfac0(0x156)},'bay':{'$first':_0x2cfac0(0x1c6)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2cfac0(0x14b)},'floorlevel':{'$first':_0x2cfac0(0x1d4)},'primary_code':{'$first':_0x2cfac0(0x17b)},'secondary_code':{'$first':_0x2cfac0(0x199)},'product_code':{'$first':_0x2cfac0(0x1bd)},'storage':{'$first':_0x2cfac0(0x139)},'rack':{'$first':_0x2cfac0(0x186)},'maxPerUnit':{'$first':_0x2cfac0(0x1ca)},'expiry_date':{'$first':_0x2cfac0(0x160)},'production_date':{'$first':_0x2cfac0(0x1d7)},'batch_code':{'$first':_0x2cfac0(0x187)},'room':{'$first':_0x2cfac0(0x1a4)}}}]);if(_0x1f5bc8[0x0][_0x2cfac0(0x13d)]==_0x2cfac0(0x1f8)){var _0x3c2b93=users[_0x2cfac0(0x146)];console[_0x2cfac0(0x131)](_0x3c2b93);}else{if(_0x1f5bc8[0x0][_0x2cfac0(0x13d)]==_0x2cfac0(0x1f2))var _0x3c2b93=users['Hindi'];else{if(_0x1f5bc8[0x0][_0x2cfac0(0x13d)]=='German')var _0x3c2b93=users['German'];else{if(_0x1f5bc8[0x0][_0x2cfac0(0x13d)]==_0x2cfac0(0x13b))var _0x3c2b93=users[_0x2cfac0(0x13b)];else{if(_0x1f5bc8[0x0]['language']==_0x2cfac0(0x1f1))var _0x3c2b93=users[_0x2cfac0(0x1f1)];else{if(_0x1f5bc8[0x0][_0x2cfac0(0x13d)]==_0x2cfac0(0x148))var _0x3c2b93=users[_0x2cfac0(0x1e7)];else{if(_0x1f5bc8[0x0][_0x2cfac0(0x13d)]==_0x2cfac0(0x1e5))var _0x3c2b93=users[_0x2cfac0(0x1e5)];else{if(_0x1f5bc8[0x0]['language']==_0x2cfac0(0x1fc))var _0x3c2b93=users['Arabic'];}}}}}}}_0x1932d9[_0x2cfac0(0x165)](_0x2cfac0(0x1b8),{'success':_0x1d3fbd[_0x2cfac0(0x1e6)]('success'),'errors':_0x1d3fbd[_0x2cfac0(0x1e6)](_0x2cfac0(0x1ae)),'role':_0x4c82cd,'profile':_0x227109,'adjustment':_0xa8aa95,'stock':_0xdcecc3,'master_shop':_0x1f5bc8,'warehouse_name':_0x28a6a0,'unit':_0x18d9f3,'language':_0x3c2b93});}catch(_0x55f142){console[_0x2cfac0(0x131)](_0x55f142),_0x1932d9[_0x2cfac0(0x1ce)](0xc8)[_0x2cfac0(0x1ba)]({'message':_0x55f142[_0x2cfac0(0x1a2)]});}}),router[a0_0x107e95(0x13a)](a0_0x107e95(0x144),auth,async(_0x3d0713,_0x3d5f8e)=>{var _0x57fadc=a0_0x107e95;try{const _0x19c425=_0x3d0713[_0x57fadc(0x168)]['id'],{warehouse_name:_0x1b08ec,Room_name:_0x3593bf}=_0x3d0713[_0x57fadc(0x17f)],_0x3c14d5=await adjustment[_0x57fadc(0x19e)]({'_id':_0x19c425}),_0x5e652a=_0x3c14d5[_0x57fadc(0x1a1)]['map'](async _0x4acda5=>{var _0x4c1ce5=_0x57fadc;if(_0x4acda5[_0x4c1ce5(0x1cb)]>0x0){var _0x30c75f=await warehouse['findOne']({'name':_0x1b08ec,'room':_0x4acda5[_0x4c1ce5(0x19f)],'warehouse_category':_0x4c1ce5(0x1e8)});const _0x1012db=_0x30c75f[_0x4c1ce5(0x195)][_0x4c1ce5(0x1f3)](_0x43c90b=>{var _0x5349f1=_0x4c1ce5;console['log'](_0x4acda5['types']+_0x5349f1(0x176));if(_0x4acda5[_0x5349f1(0x159)]=='minus'){if(_0x43c90b[_0x5349f1(0x13c)]==_0x4acda5[_0x5349f1(0x13c)]&&_0x43c90b[_0x5349f1(0x12b)]==_0x4acda5['floorlevel']&&_0x43c90b[_0x5349f1(0x164)]==_0x4acda5['type']&&_0x43c90b[_0x5349f1(0x1b3)]==_0x4acda5[_0x5349f1(0x1b3)]&&_0x43c90b[_0x5349f1(0x14d)]==_0x4acda5[_0x5349f1(0x14d)]&&_0x43c90b[_0x5349f1(0x129)]==_0x4acda5['rack']&&_0x43c90b[_0x5349f1(0x15b)]==_0x4acda5['storage']&&_0x43c90b[_0x5349f1(0x1bf)]==_0x4acda5[_0x5349f1(0x1bf)]&&_0x43c90b[_0x5349f1(0x17c)]==_0x4acda5[_0x5349f1(0x17c)]&&_0x43c90b[_0x5349f1(0x1e1)]==_0x4acda5[_0x5349f1(0x1e1)]&&_0x43c90b[_0x5349f1(0x1db)]==_0x4acda5[_0x5349f1(0x1db)]&&_0x43c90b[_0x5349f1(0x13f)]==_0x4acda5[_0x5349f1(0x18b)]){var _0x152cc1;_0x152cc1=_0x4acda5['adjust_qty'],_0x4acda5[_0x5349f1(0x15f)]=='S'&&(_0x152cc1=_0x4acda5[_0x5349f1(0x1cb)]),_0x43c90b[_0x5349f1(0x1ed)]=_0x43c90b[_0x5349f1(0x1ed)]-_0x152cc1;}}else{if(_0x43c90b[_0x5349f1(0x13c)]==_0x4acda5['product_name']&&_0x43c90b[_0x5349f1(0x12b)]==_0x4acda5[_0x5349f1(0x12b)]&&_0x43c90b['type']==_0x4acda5[_0x5349f1(0x164)]&&_0x43c90b['bin']==_0x4acda5[_0x5349f1(0x1b3)]&&_0x43c90b[_0x5349f1(0x14d)]==_0x4acda5['bay']&&_0x43c90b[_0x5349f1(0x129)]==_0x4acda5['rack']&&_0x43c90b[_0x5349f1(0x15b)]==_0x4acda5['storage']&&_0x43c90b[_0x5349f1(0x1bf)]==_0x4acda5['expiry_date']&&_0x43c90b[_0x5349f1(0x17c)]==_0x4acda5['batch_code']&&_0x43c90b[_0x5349f1(0x1e1)]==_0x4acda5['production_date']&&_0x43c90b[_0x5349f1(0x1db)]==_0x4acda5[_0x5349f1(0x1db)]&&_0x43c90b['_id']==_0x4acda5['id_transaction_from']){console[_0x5349f1(0x131)](_0x4acda5);var _0x152cc1;_0x152cc1=_0x4acda5['adjust_qty'],_0x4acda5[_0x5349f1(0x15f)]=='S'&&(_0x152cc1=_0x4acda5['adjust_qty']),_0x43c90b[_0x5349f1(0x1ed)]=_0x43c90b[_0x5349f1(0x1ed)]+_0x152cc1;}}});}return _0x30c75f;});Promise[_0x57fadc(0x141)](_0x5e652a)['then'](async _0x2a3e67=>{var _0x482c7b=_0x57fadc;try{for(const _0x51fc15 of _0x2a3e67){await _0x51fc15['save']();}_0x3c14d5['finalize']=_0x482c7b(0x18e);const _0x4e2a68=await _0x3c14d5['save'](),_0x5661de=await master_shop[_0x482c7b(0x1cf)](),_0x93bbb9=await email_settings[_0x482c7b(0x1bc)](),_0x40513e=await supervisor_settings['find']();var _0x537be6=_0x3c14d5[_0x482c7b(0x1a1)],_0x11886c='',_0x4616af;for(_0x4616af in _0x537be6){_0x11886c+='<tr>'+_0x482c7b(0x1bb)+_0x537be6[_0x4616af][_0x482c7b(0x13c)]+_0x482c7b(0x1ac)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x537be6[_0x4616af][_0x482c7b(0x174)]+_0x482c7b(0x1ac)+_0x482c7b(0x1bb)+_0x537be6[_0x4616af][_0x482c7b(0x1cb)]+_0x482c7b(0x1ac)+_0x482c7b(0x1bb)+_0x537be6[_0x4616af][_0x482c7b(0x1e9)]+_0x482c7b(0x1ac)+_0x482c7b(0x1bb)+_0x537be6[_0x4616af]['secondary_unit']+_0x482c7b(0x1ac)+_0x482c7b(0x1bb)+_0x3c14d5[_0x482c7b(0x1c5)]+'</td>'+_0x482c7b(0x1bb)+_0x537be6[_0x4616af][_0x482c7b(0x19f)]+'</td>'+_0x482c7b(0x1bb)+_0x537be6[_0x4616af][_0x482c7b(0x15b)]+_0x537be6[_0x4616af][_0x482c7b(0x129)]+_0x537be6[_0x4616af][_0x482c7b(0x14d)]+_0x537be6[_0x4616af][_0x482c7b(0x1b3)]+_0x537be6[_0x4616af][_0x482c7b(0x164)][0x0]+_0x537be6[_0x4616af][_0x482c7b(0x12b)]+_0x482c7b(0x1ac),_0x482c7b(0x179);}let _0x2b239c=nodemailer[_0x482c7b(0x1c0)]({'host':_0x93bbb9[_0x482c7b(0x1a9)],'port':Number(_0x93bbb9[_0x482c7b(0x16d)]),'secure':![],'auth':{'user':_0x93bbb9[_0x482c7b(0x1b7)],'pass':_0x93bbb9['password']}}),_0x1fd75e={'from':_0x93bbb9[_0x482c7b(0x1b7)],'to':_0x40513e[0x0]['RMSEmail'],'subject':'Adjustment\x20Mail','attachments':[{'filename':_0x482c7b(0x1fb),'path':__dirname+_0x482c7b(0x1ab)+'/upload/'+_0x5661de[0x0][_0x482c7b(0x151)],'cid':_0x482c7b(0x1be)}],'html':'<!DOCTYPE\x20html>'+_0x482c7b(0x1a0)+_0x482c7b(0x1e0)+_0x482c7b(0x142)+_0x482c7b(0x1a7)+_0x482c7b(0x142)+_0x482c7b(0x154)+'</div>'+_0x482c7b(0x142)+_0x482c7b(0x1d2)+_0x5661de[0x0][_0x482c7b(0x1d6)]+_0x482c7b(0x1aa)+_0x482c7b(0x145)+_0x482c7b(0x145)+'<hr\x20class=\x22my-3\x22>'+_0x482c7b(0x142)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x482c7b(0x1dc)+_0x3c14d5[_0x482c7b(0x1db)]+'\x20'+_0x482c7b(0x185)+'\x20Order\x20Date\x20:\x20'+_0x3c14d5['date']+'\x20'+_0x482c7b(0x153)+_0x482c7b(0x16b)+_0x482c7b(0x145)+_0x482c7b(0x1ee)+_0x482c7b(0x197)+_0x482c7b(0x1c7)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x482c7b(0x12a)+_0x482c7b(0x138)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x482c7b(0x1a8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x482c7b(0x170)+_0x482c7b(0x179)+_0x482c7b(0x163)+_0x482c7b(0x157)+'\x20'+_0x11886c+'\x20'+_0x482c7b(0x149)+_0x482c7b(0x1b6)+_0x482c7b(0x142)+_0x482c7b(0x1cc)+_0x482c7b(0x15a)+_0x5661de[0x0][_0x482c7b(0x1d6)]+'</h5>'+'</div>'+_0x482c7b(0x145)+_0x482c7b(0x172)};_0x2b239c[_0x482c7b(0x1c1)](_0x1fd75e,function(_0x3edbba,_0x480b99){var _0x22228b=_0x482c7b;_0x3edbba?(console['log'](_0x3edbba),console[_0x22228b(0x131)](_0x22228b(0x1de))):console[_0x22228b(0x131)](_0x22228b(0x16f));}),_0x3d0713[_0x482c7b(0x1e6)](_0x482c7b(0x125),_0x482c7b(0x180)),_0x3d5f8e[_0x482c7b(0x18c)](_0x482c7b(0x1ad)+_0x4e2a68['_id']);}catch(_0x24cb19){console[_0x482c7b(0x12e)](_0x24cb19),_0x3d5f8e[_0x482c7b(0x1ce)](0x1f4)[_0x482c7b(0x1ba)]({'error':_0x482c7b(0x140)});}})[_0x57fadc(0x19c)](_0x208a9c=>{var _0x10269c=_0x57fadc;console['error'](_0x208a9c),_0x3d5f8e[_0x10269c(0x1ce)](0x1f4)[_0x10269c(0x1ba)]({'error':_0x10269c(0x1f4)});});}catch(_0x5886a5){console[_0x57fadc(0x131)](_0x5886a5),_0x3d5f8e[_0x57fadc(0x1ce)](0xc8)[_0x57fadc(0x1ba)]({'message':_0x5886a5[_0x57fadc(0x1a2)]});}}),router[a0_0x107e95(0x12c)](a0_0x107e95(0x14e),auth,async(_0x20f060,_0x153942)=>{var _0x49483a=a0_0x107e95;try{const {username:_0x974f25,email:_0x4426e2,role:_0x47eab4}=_0x20f060[_0x49483a(0x167)],_0x19010c=_0x20f060[_0x49483a(0x167)],_0x1f6783=await profile[_0x49483a(0x1bc)]({'email':_0x19010c[_0x49483a(0x1b7)]}),_0x3663ed=await master_shop[_0x49483a(0x1cf)](),_0x10b2b5=_0x20f060[_0x49483a(0x168)]['id'],_0x45a4c2=await adjustment[_0x49483a(0x19e)]({'_id':_0x10b2b5}),_0xa92a5=await purchases[_0x49483a(0x1ea)]([{'$match':{'warehouse_name':_0x45a4c2[_0x49483a(0x1c5)]}},{'$unwind':_0x49483a(0x189)},{'$group':{'_id':_0x49483a(0x18a)}}]),_0xc28b3e=await product[_0x49483a(0x1cf)]({}),_0x5deabc=await warehouse[_0x49483a(0x1ea)]([{'$match':{'name':_0x45a4c2[_0x49483a(0x1c5)]}},{'$unwind':_0x49483a(0x16a)},{'$group':{'_id':_0x49483a(0x135),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x49483a(0x16e)},'type':{'$first':_0x49483a(0x14b)},'floorlevel':{'$first':_0x49483a(0x1d4)},'primary_code':{'$first':_0x49483a(0x17b)},'secondary_code':{'$first':_0x49483a(0x199)},'product_code':{'$first':_0x49483a(0x1bd)},'storage':{'$first':_0x49483a(0x139)},'rack':{'$first':_0x49483a(0x186)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x49483a(0x1d7)},'batch_code':{'$first':_0x49483a(0x187)},'room':{'$first':_0x49483a(0x1a4)}}}]);let _0x15441;if(_0x19010c[_0x49483a(0x1c4)]=='staff'){const _0x1670e7=await staff['findOne']({'email':_0x19010c[_0x49483a(0x1b7)]});_0x15441=await warehouse[_0x49483a(0x1ea)]([{'$match':{'status':_0x49483a(0x152),'name':_0x1670e7['warehouse'],'warehouse_category':_0x49483a(0x1e8),'name':{'$ne':_0x49483a(0x19b)}}},{'$group':{'_id':_0x49483a(0x161),'name':{'$first':_0x49483a(0x161)}}}]);}else _0x15441=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x49483a(0x161),'name':{'$first':'$name'}}}]);if(_0x3663ed[0x0][_0x49483a(0x13d)]==_0x49483a(0x1f8)){var _0x2c275d=users[_0x49483a(0x146)];console['log'](_0x2c275d);}else{if(_0x3663ed[0x0][_0x49483a(0x13d)]=='Hindi')var _0x2c275d=users['Hindi'];else{if(_0x3663ed[0x0]['language']==_0x49483a(0x12d))var _0x2c275d=users[_0x49483a(0x12d)];else{if(_0x3663ed[0x0][_0x49483a(0x13d)]==_0x49483a(0x13b))var _0x2c275d=users[_0x49483a(0x13b)];else{if(_0x3663ed[0x0][_0x49483a(0x13d)]==_0x49483a(0x1f1))var _0x2c275d=users[_0x49483a(0x1f1)];else{if(_0x3663ed[0x0][_0x49483a(0x13d)]==_0x49483a(0x148))var _0x2c275d=users[_0x49483a(0x1e7)];else{if(_0x3663ed[0x0][_0x49483a(0x13d)]==_0x49483a(0x1e5))var _0x2c275d=users[_0x49483a(0x1e5)];else{if(_0x3663ed[0x0][_0x49483a(0x13d)]==_0x49483a(0x1fc))var _0x2c275d=users[_0x49483a(0x15d)];}}}}}}}_0x153942['render']('edit_adjustment',{'success':_0x20f060['flash']('success'),'errors':_0x20f060['flash'](_0x49483a(0x1ae)),'role':_0x19010c,'profile':_0x1f6783,'adjustment':_0x45a4c2,'stock':_0x5deabc,'master_shop':_0x3663ed,'warehouse_name':_0xa92a5,'unit':_0xc28b3e,'language':_0x2c275d,'warehouse':_0x15441});}catch(_0x4fdf25){console[_0x49483a(0x131)](_0x4fdf25),_0x153942['status'](0xc8)['json']({'message':_0x4fdf25['message']});}}),router[a0_0x107e95(0x13a)](a0_0x107e95(0x14e),auth,async(_0x2a3347,_0x4665ed)=>{var _0x25b9d5=a0_0x107e95;try{const _0x12d5f6=_0x2a3347[_0x25b9d5(0x168)]['id'],_0x4ed9c6=await adjustment[_0x25b9d5(0x19e)]({'_id':_0x12d5f6}),_0x7e2cbf=await warehouse[_0x25b9d5(0x1bc)]({'name':_0x4ed9c6[_0x25b9d5(0x1c5)],'room':_0x4ed9c6['room']}),{warehouse_name:_0x2eb8f3,date:_0x463a6d,prod_name:_0x354e9b,level:_0x40b702,isle:_0x367230,pallet:_0x5ae936,stock:_0x20ca66,types:_0x269ef8,adjust_qty:_0x520b2e,new_adjust_qty:_0x455920,note:_0x27b9d3,Room_name:_0x3be564,invoice:_0x380c6b,JO_number:_0x532092,expiry_date:_0x23e59f}=_0x2a3347['body'];if(typeof _0x354e9b=='string')var _0x19fb14=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x150)]],_0x20fc77=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x175)]],_0x173013=[_0x2a3347['body']['stock']],_0x3ceaf1=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x159)]],_0x238c9d=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x191)]],_0x12f50a=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x16c)]],_0x5ca891=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x178)]],_0x14a710=[_0x2a3347['body'][_0x25b9d5(0x1e4)]],_0x55d49a=[_0x2a3347['body'][_0x25b9d5(0x1b4)]],_0x5c7f6f=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x17c)]],_0x449a6b=[_0x2a3347['body']['expiry_date']],_0x5afd49=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x18d)]],_0x5e159f=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x1e1)]],_0x4341d3=[_0x2a3347['body'][_0x25b9d5(0x15f)]],_0x263b0f=[_0x2a3347['body'][_0x25b9d5(0x1f6)]],_0x543a0e=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x1fa)]],_0x28bc00=[_0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x183)]];else var _0x19fb14=[..._0x2a3347[_0x25b9d5(0x17f)]['prod_name']],_0x20fc77=[..._0x2a3347[_0x25b9d5(0x17f)]['level']],_0x173013=[..._0x2a3347[_0x25b9d5(0x17f)]['stock']],_0x3ceaf1=[..._0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x159)]],_0x238c9d=[..._0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x191)]],_0x12f50a=[..._0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x16c)]],_0x5ca891=[..._0x2a3347[_0x25b9d5(0x17f)]['unit']],_0x14a710=[..._0x2a3347[_0x25b9d5(0x17f)]['Secondary_units']],_0x55d49a=[..._0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x1b4)]],_0x5c7f6f=[..._0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x17c)]],_0x449a6b=[..._0x2a3347[_0x25b9d5(0x17f)]['expiry_date']],_0x5afd49=[..._0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x18d)]],_0x5e159f=[..._0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x1e1)]],_0x4341d3=[..._0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x15f)]],_0x263b0f=[..._0x2a3347['body'][_0x25b9d5(0x1f6)]],_0x543a0e=[..._0x2a3347[_0x25b9d5(0x17f)]['prime1']],_0x28bc00=[..._0x2a3347[_0x25b9d5(0x17f)][_0x25b9d5(0x183)]];const _0x4aad96=_0x19fb14['map'](_0x30e57a=>{return _0x30e57a={'product_name':_0x30e57a};});_0x20fc77[_0x25b9d5(0x1d8)]((_0x3d04e1,_0x32e4d6)=>{var _0x48005d=_0x25b9d5;_0x263b0f[_0x48005d(0x1d8)]((_0x5a257e,_0x5ac978)=>{var _0x508207=_0x48005d;if(_0x5a257e==_0x508207(0x166)&&_0x32e4d6==_0x5ac978){var _0x37b47c=_0x3d04e1[_0x508207(0x1c8)](0x3);_0x4aad96[_0x32e4d6][_0x508207(0x15b)]=_0x3d04e1[0x0],_0x4aad96[_0x32e4d6]['rack']=_0x3d04e1[0x1],_0x4aad96[_0x32e4d6][_0x508207(0x14d)]=0x0,_0x4aad96[_0x32e4d6][_0x508207(0x1b3)]=0x0,_0x4aad96[_0x32e4d6][_0x508207(0x164)]=_0x508207(0x14f),_0x4aad96[_0x32e4d6][_0x508207(0x12b)]=_0x37b47c;}else{if(_0x5a257e==_0x508207(0x1d3)&&_0x32e4d6==_0x5ac978){var _0x37b47c=_0x3d04e1[_0x508207(0x1c8)](0x3);_0x4aad96[_0x32e4d6]['storage']=_0x3d04e1[0x0],_0x4aad96[_0x32e4d6]['rack']=_0x3d04e1[0x1],_0x4aad96[_0x32e4d6][_0x508207(0x14d)]=0x0,_0x4aad96[_0x32e4d6]['bin']=0x0,_0x4aad96[_0x32e4d6]['type']=_0x508207(0x14f),_0x4aad96[_0x32e4d6][_0x508207(0x12b)]=_0x3d04e1[0x5];}else{if(_0x32e4d6==_0x5ac978){var _0x15ff62;if(_0x3d04e1[0x4]=='L')_0x15ff62=_0x508207(0x1af);else _0x3d04e1[0x4]=='F'&&(_0x15ff62='Floor');_0x4aad96[_0x32e4d6][_0x508207(0x15b)]=_0x3d04e1[0x0],_0x4aad96[_0x32e4d6]['rack']=_0x3d04e1[0x1],_0x4aad96[_0x32e4d6]['bay']=_0x3d04e1[0x2],_0x4aad96[_0x32e4d6]['bin']=_0x3d04e1[0x3],_0x4aad96[_0x32e4d6]['type']=_0x15ff62,_0x4aad96[_0x32e4d6]['floorlevel']=_0x3d04e1[0x5];}}}});}),_0x173013[_0x25b9d5(0x1d8)]((_0x1e36d9,_0x160ebb)=>{var _0x5d5d9f=_0x25b9d5;_0x4aad96[_0x160ebb][_0x5d5d9f(0x1b9)]=_0x1e36d9;}),_0x3ceaf1[_0x25b9d5(0x1d8)]((_0x2d955d,_0x4fd046)=>{var _0x2f4121=_0x25b9d5;_0x4aad96[_0x4fd046][_0x2f4121(0x159)]=_0x2d955d;}),_0x238c9d[_0x25b9d5(0x1d8)]((_0x13838f,_0xc8e464)=>{var _0x54b4c2=_0x25b9d5;_0x4aad96[_0xc8e464][_0x54b4c2(0x1cb)]=_0x13838f;}),_0x12f50a[_0x25b9d5(0x1d8)]((_0x4841ef,_0x58c1a8)=>{var _0x580472=_0x25b9d5;_0x4aad96[_0x58c1a8][_0x580472(0x155)]=_0x4841ef;}),_0x5ca891[_0x25b9d5(0x1d8)]((_0xe338d2,_0x55c5f8)=>{_0x4aad96[_0x55c5f8]['unit']=_0xe338d2;}),_0x14a710['forEach']((_0x1b7606,_0x572fe3)=>{var _0x1abf2a=_0x25b9d5;_0x4aad96[_0x572fe3][_0x1abf2a(0x17a)]=_0x1b7606;}),_0x55d49a[_0x25b9d5(0x1d8)]((_0x5830d0,_0xb4cde7)=>{_0x4aad96[_0xb4cde7]['product_code']=_0x5830d0;}),_0x5c7f6f[_0x25b9d5(0x1d8)]((_0xafc481,_0x313e1b)=>{var _0x565c23=_0x25b9d5;_0x4aad96[_0x313e1b][_0x565c23(0x17c)]=_0xafc481;}),_0x449a6b[_0x25b9d5(0x1d8)]((_0x1da2ee,_0x3cebb7)=>{_0x4aad96[_0x3cebb7]['expiry_date']=_0x1da2ee;}),_0x5afd49[_0x25b9d5(0x1d8)]((_0x479c27,_0x39990f)=>{var _0x1a54fd=_0x25b9d5;_0x4aad96[_0x39990f][_0x1a54fd(0x1a6)]=_0x479c27;}),_0x5e159f[_0x25b9d5(0x1d8)]((_0x2f7531,_0x4e1481)=>{var _0x177187=_0x25b9d5;_0x4aad96[_0x4e1481][_0x177187(0x1e1)]=_0x2f7531;}),_0x4341d3[_0x25b9d5(0x1d8)]((_0x39be80,_0x578966)=>{var _0x61b049=_0x25b9d5;_0x4aad96[_0x578966][_0x61b049(0x15f)]=_0x39be80;}),_0x263b0f[_0x25b9d5(0x1d8)]((_0x103544,_0x16cac9)=>{_0x4aad96[_0x16cac9]['room_names']=_0x103544;}),_0x543a0e[_0x25b9d5(0x1d8)]((_0x3c3efb,_0x3e6701)=>{var _0x293d6f=_0x25b9d5;_0x4aad96[_0x3e6701][_0x293d6f(0x1b2)]=_0x3c3efb;}),_0x28bc00['forEach']((_0x564d78,_0x585d66)=>{var _0x55979c=_0x25b9d5;_0x4aad96[_0x585d66][_0x55979c(0x182)]=_0x564d78;});const _0x4d4143=_0x4aad96[_0x25b9d5(0x17e)](_0x4907ed=>_0x4907ed[_0x25b9d5(0x1cb)]!=='0'&&_0x4907ed[_0x25b9d5(0x1cb)]!=='');var _0x3e92e0=0x0;_0x4d4143[_0x25b9d5(0x1d8)](_0x30c2f3=>{var _0x33a3c8=_0x25b9d5;console[_0x33a3c8(0x131)](_0x33a3c8(0x1b0),_0x30c2f3),parseInt(_0x30c2f3[_0x33a3c8(0x1cb)])<=0x0&&_0x3e92e0++;});if(_0x3e92e0!=0x0)return _0x2a3347['flash']('errors',_0x25b9d5(0x15c)),_0x4665ed[_0x25b9d5(0x18c)]('back');_0x4ed9c6['warehouse_name']=_0x2eb8f3,_0x4ed9c6['date']=_0x463a6d,_0x4ed9c6[_0x25b9d5(0x1a1)]=_0x4d4143,_0x4ed9c6['note']=_0x27b9d3,_0x4ed9c6[_0x25b9d5(0x1db)]=_0x380c6b,_0x4ed9c6['isAllowEdit']=_0x25b9d5(0x1f7);const _0xd406f2=await _0x4ed9c6[_0x25b9d5(0x1a5)]();_0x2a3347[_0x25b9d5(0x1e6)](_0x25b9d5(0x125),_0x25b9d5(0x193)),_0x4665ed['redirect']('/adjustment/view');}catch(_0x5eb427){console[_0x25b9d5(0x131)](_0x5eb427);}}),router[a0_0x107e95(0x13a)]('/barcode_scanner',async(_0x5315d7,_0x12aba2)=>{var _0x432c39=a0_0x107e95;const {primary_code:_0x3b08a8,warehouse_data:_0x2cd762,rooms_data:_0x4f54ea,Roomslist:_0x42083a}=_0x5315d7[_0x432c39(0x17f)],_0x84dd5f=_0x42083a[_0x432c39(0x1ec)](','),_0x141fb7=[];async function _0x121721(_0xdc5d3a){var _0x1ec4a3=_0x432c39;const _0xa1ea5b=await warehouse[_0x1ec4a3(0x1ea)]([{'$match':{'name':_0x2cd762,'room':_0xdc5d3a}},{'$unwind':_0x1ec4a3(0x16a)},{'$match':{'product_details.primary_code':_0x3b08a8}},{'$group':{'_id':_0x1ec4a3(0x135),'name':{'$first':_0x1ec4a3(0x1e2)},'product_stock':{'$first':_0x1ec4a3(0x156)},'primary_code':{'$first':_0x1ec4a3(0x17b)},'secondary_code':{'$first':_0x1ec4a3(0x199)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x1ec4a3(0x16e)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1ec4a3(0x1d4)},'unit':{'$first':_0x1ec4a3(0x1f9)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x1ec4a3(0x139)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x1ec4a3(0x187)},'product_cat':{'$first':_0x1ec4a3(0x169)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1ec4a3(0x1a4)},'invoice':{'$first':_0x1ec4a3(0x177)}}}]),_0x307703=await warehouse[_0x1ec4a3(0x1ea)]([{'$match':{'name':_0x2cd762,'room':_0xdc5d3a}},{'$unwind':_0x1ec4a3(0x16a)},{'$match':{'product_details.secondary_code':_0x3b08a8}},{'$group':{'_id':_0x1ec4a3(0x135),'name':{'$first':_0x1ec4a3(0x1e2)},'product_stock':{'$first':_0x1ec4a3(0x156)},'primary_code':{'$first':_0x1ec4a3(0x17b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1ec4a3(0x1bd)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x1ec4a3(0x16e)},'type':{'$first':_0x1ec4a3(0x14b)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1ec4a3(0x1f9)},'secondary_unit':{'$first':_0x1ec4a3(0x181)},'storage':{'$first':_0x1ec4a3(0x139)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1ec4a3(0x160)},'production_date':{'$first':_0x1ec4a3(0x1d7)},'maxPerUnit':{'$first':_0x1ec4a3(0x1ca)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x1ec4a3(0x1a4)}}}]);if(_0xa1ea5b[_0x1ec4a3(0x14a)]>0x0)_0x141fb7['push'](_0xa1ea5b);else _0x307703['length']>0x0&&_0x141fb7[_0x1ec4a3(0x133)](_0x307703);}const _0x18a04a=_0x84dd5f[_0x432c39(0x1f3)](_0x211b9c=>_0x121721(_0x211b9c));await Promise[_0x432c39(0x141)](_0x18a04a),_0x12aba2[_0x432c39(0x1ba)](_0x141fb7);}),router[a0_0x107e95(0x13a)](a0_0x107e95(0x171),async(_0x21e0dc,_0x3212fa)=>{var _0x5c997c=a0_0x107e95;const {primaryCode:_0x446b95,secondaryCode:_0x445b08,productCode:_0x49d14e,level:_0x34e23d,isle:_0x42ff79,pallet:_0x4de25f,warehouses:_0x1a25fd,room:_0xad83dc}=_0x21e0dc[_0x5c997c(0x17f)];try{const _0xc91f22=await warehouse[_0x5c997c(0x1ea)]([{'$match':{'name':_0x1a25fd,'room':_0xad83dc}},{'$unwind':_0x5c997c(0x16a)},{'$match':{'product_details.level':parseInt(_0x34e23d),'product_details.isle':_0x42ff79,'product_details.pallet':parseInt(_0x4de25f)}},{'$group':{'_id':_0x5c997c(0x135),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x5c997c(0x128)},'isle':{'$first':_0x5c997c(0x158)},'pallet':{'$first':_0x5c997c(0x19a)},'maxProducts':{'$first':_0x5c997c(0x1df)}}}]);_0x3212fa[_0x5c997c(0x1ce)](0xc8)[_0x5c997c(0x1ba)](_0xc91f22);}catch(_0x52b0be){_0x3212fa['status'](0x194)[_0x5c997c(0x1ba)]({'message':_0x52b0be['message']});}}),module['exports']=router;