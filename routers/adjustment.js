var a0_0x4586d6=a0_0x4416;(function(_0x49d107,_0x244a1e){var _0x27b660=a0_0x4416,_0x36dd62=_0x49d107();while(!![]){try{var _0x579536=-parseInt(_0x27b660(0x104))/0x1*(parseInt(_0x27b660(0x73))/0x2)+-parseInt(_0x27b660(0x99))/0x3*(-parseInt(_0x27b660(0xbb))/0x4)+parseInt(_0x27b660(0x115))/0x5*(parseInt(_0x27b660(0x12a))/0x6)+parseInt(_0x27b660(0x128))/0x7*(parseInt(_0x27b660(0xe8))/0x8)+parseInt(_0x27b660(0x131))/0x9*(parseInt(_0x27b660(0xe6))/0xa)+parseInt(_0x27b660(0x85))/0xb*(parseInt(_0x27b660(0x89))/0xc)+-parseInt(_0x27b660(0xe0))/0xd;if(_0x579536===_0x244a1e)break;else _0x36dd62['push'](_0x36dd62['shift']());}catch(_0x3c3845){_0x36dd62['push'](_0x36dd62['shift']());}}}(a0_0x5139,0xf1ca0));const express=require(a0_0x4586d6(0x83)),app=express(),router=express[a0_0x4586d6(0x9b)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x4586d6(0x12b));router['get'](a0_0x4586d6(0x9d),auth,async(_0x56479e,_0x443030)=>{var _0x301d3f=a0_0x4586d6;try{const {username:_0x32cb11,email:_0xf3da01,role:_0x253ea4}=_0x56479e[_0x301d3f(0x71)],_0x55fa01=_0x56479e[_0x301d3f(0x71)],_0x1dfc4f=await profile[_0x301d3f(0xcd)]({'email':_0x55fa01[_0x301d3f(0x8d)]}),_0x42ee1f=await master_shop['find']();console[_0x301d3f(0x138)](_0x301d3f(0x74),_0x42ee1f);let _0x1bc9b6;if(_0x55fa01[_0x301d3f(0x11c)]==_0x301d3f(0xff)){const _0x4217df=await staff['findOne']({'email':_0x55fa01['email']});_0x1bc9b6=await warehouse[_0x301d3f(0x6f)]({'status':_0x301d3f(0xf3),'name':_0x4217df[_0x301d3f(0x12e)]});}else _0x1bc9b6=await warehouse[_0x301d3f(0x6f)]({'status':_0x301d3f(0xf3)});const _0x87f5c5=await product[_0x301d3f(0x6f)]();let _0x10b8e2;if(_0x55fa01['role']==_0x301d3f(0xff)){const _0x1e0a91=await staff[_0x301d3f(0xcd)]({'email':_0x55fa01['email']});_0x10b8e2=await adjustment[_0x301d3f(0x6f)]({'warehouse_name':_0x1e0a91[_0x301d3f(0x12e)]});}else _0x10b8e2=await adjustment[_0x301d3f(0xfc)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x301d3f(0x87)},'date':{'$first':_0x301d3f(0xb5)},'warehouse_name':{'$first':_0x301d3f(0x95)},'room':{'$addToSet':_0x301d3f(0xf9)},'finalize':{'$first':_0x301d3f(0x106)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x42ee1f[0x0]['language']=='English\x20(US)'){var _0x38d47e=users[_0x301d3f(0x6c)];console[_0x301d3f(0x138)](_0x38d47e);}else{if(_0x42ee1f[0x0][_0x301d3f(0xb6)]==_0x301d3f(0xf5))var _0x38d47e=users[_0x301d3f(0xf5)];else{if(_0x42ee1f[0x0]['language']=='German')var _0x38d47e=users[_0x301d3f(0x6a)];else{if(_0x42ee1f[0x0][_0x301d3f(0xb6)]==_0x301d3f(0x120))var _0x38d47e=users[_0x301d3f(0x120)];else{if(_0x42ee1f[0x0][_0x301d3f(0xb6)]==_0x301d3f(0xfe))var _0x38d47e=users[_0x301d3f(0xfe)];else{if(_0x42ee1f[0x0]['language']=='Portuguese\x20(BR)')var _0x38d47e=users[_0x301d3f(0x79)];else{if(_0x42ee1f[0x0][_0x301d3f(0xb6)]==_0x301d3f(0x10d))var _0x38d47e=users['Chinese'];else{if(_0x42ee1f[0x0][_0x301d3f(0xb6)]==_0x301d3f(0xa0))var _0x38d47e=users[_0x301d3f(0xb1)];}}}}}}}_0x443030[_0x301d3f(0x114)](_0x301d3f(0x13a),{'success':_0x56479e[_0x301d3f(0x8f)](_0x301d3f(0xdf)),'errors':_0x56479e[_0x301d3f(0x8f)](_0x301d3f(0xcf)),'role':_0x55fa01,'profile':_0x1dfc4f,'warehouse':_0x1bc9b6,'product':_0x87f5c5,'adjustment':_0x10b8e2,'master_shop':_0x42ee1f,'language':_0x38d47e});}catch(_0x14bab2){console[_0x301d3f(0x138)](_0x14bab2);}});function a0_0x5139(){var _0x3e4163=['user','product','58zDojif','master','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','storage','Secondary_units','<div>','Portuguese','Raw\x20Materials','prime1','createTransport','Primary_Units','findById','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','bin','host','invoice','express','$product_details.primary_code','19759487aAFkYv','Floor','$invoice','expiry_date','12mDIOER','Return\x20Goods','redirect','get','email','$product_details.maxProducts','flash','$product_details.product_code','$product_details.unit','type','filter','product_code','$warehouse_name','New_Qty_Converted','$product_details.maxPerUnit','$product_details.secondary_unit','5126118NUydTl','/picking_list/PDF_adjustment_rm/','Router','$product.product_name','/view','second1','bay','Arabic\x20(ae)','</thead>','<span\x20style=\x22float:\x20right;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','date','False','\x20</h2>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','toString','string','params','<tbody\x20style=\x22text-align:\x20center;\x22>','Email\x20sent\x20successfully','Error\x20Occurs','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/preview/:id','$product_details.product_stock','Arabic','max_per_unit','slice','level','$date','language','Enclosed','message','$product_details.rack','$product_details.bin','4pdCnJe','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','ADJ-','product_stock','password','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/barcode_scanner','Portuguese\x20(BR)','save','add_adjustment','unit','site_title','Receiving\x20Area','$product_details.isle','</td>','types','$product_details.floorlevel','finalize','findOne','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','errors','catch','edit_adjustment_view','<!DOCTYPE\x20html>','exports','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','room','status','product_details','$product_details._id','$product_details.expiry_date','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.production_date','json','_id','then','success','60222409cnllnM','product_name','warehouse_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','True','Level','16090evoHpz','random','2296aOxGes','note','prod_invoice','</div>','body','Shelves','room_names','<tr>','post','$product_details.product_cat','Rooms','Enabled','floor','Hindi','</head><body>','\x20Order\x20Date\x20:\x20','/view/add_adjustment','$product.room_names','<h5>','primary_code','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','French','staff','Ambient','$product_details.invoice','minus','isAllowEdit','3043dLMyBh','/upload/','$finalize','id_transaction_from','$product_details.type','forEach','batch_code','<hr\x20class=\x22my-3\x22>','/view/:id','Chinese','secondary_unit','$product_details.storage','/adjustment/view','all','floorlevel','adjust_qty','render','8313055pyXqSr','$name','stock','$product_details.secondary_code','$product_details.bay','<h5\x20style=\x22text-align:\x20left;\x22>','/CheckingWarehouse','role','prod_code','English\x20(US)','New_Qty_Converted_adj','Spanish','prod_name','$product_details.batch_code','map','<strong>\x20Regards\x20</strong>','</h5>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.product_name','1757ZmVSmQ','rack','6ZLGvYz','nodemailer','An\x20error\x20occurred\x20while\x20saving\x20data.','split','warehouse','$product_details','length','2637Efivgd','An\x20error\x20occurred.','push','foreach\x20newproduct','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</body></html>','error','log','</tr>','adjustment','adjustment\x20add\x20successfull','prod_cat','stockBefore','edit_adjustment','$room','maxperunit','</span>','German','production_date','English','id_transaction','$product_details.level','find','Adjustment\x20Mail'];a0_0x5139=function(){return _0x3e4163;};return a0_0x5139();}function a0_0x4416(_0x5b5f0a,_0x5cec40){var _0x513988=a0_0x5139();return a0_0x4416=function(_0x44166c,_0x5577d5){_0x44166c=_0x44166c-0x64;var _0x51b5e=_0x513988[_0x44166c];return _0x51b5e;},a0_0x4416(_0x5b5f0a,_0x5cec40);}async function getRandom8DigitNumber(){var _0xfd110c=a0_0x4586d6;const _0x5de017=0x989680,_0x59fadf=0x5f5e0ff,_0x242224=Math[_0xfd110c(0xf4)](Math[_0xfd110c(0xe7)]()*(_0x59fadf-_0x5de017+0x1))+_0x5de017;var _0x366cb6;const _0x1e3d3c=await adjustment[_0xfd110c(0xcd)]({'invoice':'ADJ-'+_0x242224});return _0x1e3d3c&&_0x1e3d3c[_0xfd110c(0x130)]>0x0?_0x366cb6=_0xfd110c(0xbd)+_0x242224:_0x366cb6=_0xfd110c(0xbd)+_0x242224,_0x366cb6;}router[a0_0x4586d6(0x8c)](a0_0x4586d6(0xf8),auth,async(_0x57f37c,_0x53378a)=>{var _0x4151e8=a0_0x4586d6;try{const {username:_0x2fa6f6,email:_0x52e41d,role:_0x2e64c3}=_0x57f37c[_0x4151e8(0x71)],_0x44d497=_0x57f37c['user'],_0x2162f0=await profile[_0x4151e8(0xcd)]({'email':_0x44d497[_0x4151e8(0x8d)]}),_0x8139b3=await master_shop[_0x4151e8(0x6f)]();let _0x51c7de;if(_0x44d497['role']==_0x4151e8(0xff)){const _0x582b6a=await staff[_0x4151e8(0xcd)]({'email':_0x44d497[_0x4151e8(0x8d)]});_0x51c7de=await warehouse[_0x4151e8(0xfc)]([{'$match':{'status':_0x4151e8(0xf3),'name':_0x582b6a[_0x4151e8(0x12e)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x4151e8(0x8a)}}},{'$group':{'_id':_0x4151e8(0x116),'name':{'$first':'$name'}}}]);}else _0x51c7de=await warehouse[_0x4151e8(0xfc)]([{'$match':{'status':_0x4151e8(0xf3),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x4151e8(0x8a)}}},{'$group':{'_id':_0x4151e8(0x116),'name':{'$first':_0x4151e8(0x116)}}}]);const _0x2bdd95=await product['find']({}),_0x337837=await adjustment[_0x4151e8(0x6f)]({}),_0x18ecee=_0x337837[_0x4151e8(0x130)]+0x1,_0x3af9b3=_0x4151e8(0xbd)+_0x18ecee[_0x4151e8(0xa8)]()['padStart'](0x5,'0');var _0x4ab3e6=[_0x4151e8(0x100),_0x4151e8(0xb7),'Return\x20Rooms'];if(_0x8139b3[0x0][_0x4151e8(0xb6)]==_0x4151e8(0x11e))var _0x1889ca=users[_0x4151e8(0x6c)];else{if(_0x8139b3[0x0]['language']==_0x4151e8(0xf5))var _0x1889ca=users[_0x4151e8(0xf5)];else{if(_0x8139b3[0x0][_0x4151e8(0xb6)]==_0x4151e8(0x6a))var _0x1889ca=users[_0x4151e8(0x6a)];else{if(_0x8139b3[0x0][_0x4151e8(0xb6)]==_0x4151e8(0x120))var _0x1889ca=users[_0x4151e8(0x120)];else{if(_0x8139b3[0x0][_0x4151e8(0xb6)]=='French')var _0x1889ca=users[_0x4151e8(0xfe)];else{if(_0x8139b3[0x0][_0x4151e8(0xb6)]==_0x4151e8(0xc2))var _0x1889ca=users[_0x4151e8(0x79)];else{if(_0x8139b3[0x0]['language']==_0x4151e8(0x10d))var _0x1889ca=users['Chinese'];else{if(_0x8139b3[0x0][_0x4151e8(0xb6)]==_0x4151e8(0xa0))var _0x1889ca=users[_0x4151e8(0xb1)];}}}}}}}const _0x47730a=getRandom8DigitNumber();_0x47730a[_0x4151e8(0xde)](_0x390f9c=>{var _0x4e9811=_0x4151e8;_0x53378a[_0x4e9811(0x114)](_0x4e9811(0xc4),{'success':_0x57f37c[_0x4e9811(0x8f)](_0x4e9811(0xdf)),'errors':_0x57f37c[_0x4e9811(0x8f)]('errors'),'role':_0x44d497,'profile':_0x2162f0,'warehouse':_0x51c7de,'product':_0x2bdd95,'master_shop':_0x8139b3,'language':_0x1889ca,'rooms_data':_0x4ab3e6,'invoice_no':_0x390f9c});})[_0x4151e8(0xd0)](_0x1d45ef=>{var _0x2cfa32=_0x4151e8;_0x57f37c[_0x2cfa32(0x8f)](_0x2cfa32(0xcf),_0x2cfa32(0xda)),_0x53378a[_0x2cfa32(0x8b)](_0x2cfa32(0x110));});}catch(_0x2a0204){console[_0x4151e8(0x138)](_0x2a0204);}}),router[a0_0x4586d6(0xf0)]('/view/add_adjustment',auth,async(_0x379359,_0x1a362f)=>{var _0x448fea=a0_0x4586d6;try{const {warehouse_name:_0x2c2ce6,date:_0x20d230,prod_name:_0x4a93b9,level:_0x134d43,isle:_0x4160bc,pallet:_0x1e867f,stock:_0x13446d,types:_0x48aa88,adjust_qty:_0x536a88,new_adjust_qty:_0x45f897,note:_0x466cd8,Room_name:_0x33dd89,invoice:_0x43c3ab,JO_number:_0x52f112,expiry_date:_0x52a208}=_0x379359[_0x448fea(0xec)];if(typeof _0x4a93b9==_0x448fea(0xa9))var _0x180595=[_0x379359['body'][_0x448fea(0x121)]],_0x2953c8=[_0x379359['body'][_0x448fea(0xb4)]],_0x5c0cf8=[_0x379359[_0x448fea(0xec)][_0x448fea(0x117)]],_0x50354c=[_0x379359[_0x448fea(0xec)]['types']],_0x43ac08=[_0x379359[_0x448fea(0xec)][_0x448fea(0x11f)]],_0x2ac5a3=[_0x379359['body'][_0x448fea(0x96)]],_0x273ebc=[_0x379359[_0x448fea(0xec)][_0x448fea(0x7d)]],_0x31833b=[_0x379359['body']['Secondary_units']],_0x5f4555=[_0x379359[_0x448fea(0xec)][_0x448fea(0x11d)]],_0x4d37fc=[_0x379359[_0x448fea(0xec)][_0x448fea(0x10a)]],_0x21943d=[_0x379359[_0x448fea(0xec)]['expiry_date']],_0x1f109d=[_0x379359[_0x448fea(0xec)][_0x448fea(0xb2)]],_0x3e5b97=[_0x379359[_0x448fea(0xec)][_0x448fea(0x6b)]],_0x4f9ea7=[_0x379359[_0x448fea(0xec)]['prod_cat']],_0x482847=[_0x379359[_0x448fea(0xec)][_0x448fea(0xf2)]],_0x53c5de=[_0x379359[_0x448fea(0xec)][_0x448fea(0x7b)]],_0x24fbd1=[_0x379359[_0x448fea(0xec)][_0x448fea(0x9e)]],_0x446910=[_0x379359[_0x448fea(0xec)][_0x448fea(0xea)]],_0xd13d50=[_0x379359['body'][_0x448fea(0x6d)]];else var _0x180595=[..._0x379359[_0x448fea(0xec)]['prod_name']],_0x2953c8=[..._0x379359[_0x448fea(0xec)][_0x448fea(0xb4)]],_0x5c0cf8=[..._0x379359[_0x448fea(0xec)][_0x448fea(0x117)]],_0x50354c=[..._0x379359[_0x448fea(0xec)][_0x448fea(0xca)]],_0x43ac08=[..._0x379359[_0x448fea(0xec)]['New_Qty_Converted_adj']],_0x2ac5a3=[..._0x379359['body'][_0x448fea(0x96)]],_0x273ebc=[..._0x379359[_0x448fea(0xec)][_0x448fea(0xc5)]],_0x31833b=[..._0x379359[_0x448fea(0xec)][_0x448fea(0x77)]],_0x5f4555=[..._0x379359[_0x448fea(0xec)][_0x448fea(0x11d)]],_0x4d37fc=[..._0x379359['body']['batch_code']],_0x21943d=[..._0x379359[_0x448fea(0xec)][_0x448fea(0x88)]],_0x1f109d=[..._0x379359[_0x448fea(0xec)][_0x448fea(0xb2)]],_0x3e5b97=[..._0x379359[_0x448fea(0xec)]['production_date']],_0x4f9ea7=[..._0x379359[_0x448fea(0xec)][_0x448fea(0x64)]],_0x482847=[..._0x379359['body'][_0x448fea(0xf2)]],_0x53c5de=[..._0x379359[_0x448fea(0xec)][_0x448fea(0x7b)]],_0x24fbd1=[..._0x379359[_0x448fea(0xec)][_0x448fea(0x9e)]],_0x446910=[..._0x379359[_0x448fea(0xec)][_0x448fea(0xea)]],_0xd13d50=[..._0x379359[_0x448fea(0xec)][_0x448fea(0x6d)]];const _0xa9c378=_0x180595[_0x448fea(0x123)](_0x429f86=>{return _0x429f86={'product_name':_0x429f86};});_0x2953c8[_0x448fea(0x109)]((_0x59f3f8,_0x38f9ee)=>{var _0x924fc0=_0x448fea;_0x482847[_0x924fc0(0x109)]((_0x4144d3,_0x1f295f)=>{var _0x4b8bbe=_0x924fc0;if(_0x4144d3==_0x4b8bbe(0xc7)&&_0x38f9ee==_0x1f295f){var _0x402f79=_0x59f3f8[_0x4b8bbe(0xb3)](0x3);_0xa9c378[_0x38f9ee][_0x4b8bbe(0x76)]=_0x59f3f8[0x0],_0xa9c378[_0x38f9ee][_0x4b8bbe(0x129)]=_0x59f3f8[0x1],_0xa9c378[_0x38f9ee]['bay']=0x0,_0xa9c378[_0x38f9ee][_0x4b8bbe(0x80)]=0x0,_0xa9c378[_0x38f9ee]['type']=_0x4b8bbe(0x86),_0xa9c378[_0x38f9ee][_0x4b8bbe(0x112)]=_0x402f79;}else{if(_0x4144d3==_0x4b8bbe(0xed)&&_0x38f9ee==_0x1f295f){var _0x402f79=_0x59f3f8[_0x4b8bbe(0xb3)](0x3);_0xa9c378[_0x38f9ee][_0x4b8bbe(0x76)]=_0x59f3f8[0x0],_0xa9c378[_0x38f9ee]['rack']=_0x59f3f8[0x1],_0xa9c378[_0x38f9ee][_0x4b8bbe(0x9f)]=0x0,_0xa9c378[_0x38f9ee][_0x4b8bbe(0x80)]=0x0,_0xa9c378[_0x38f9ee][_0x4b8bbe(0x92)]=_0x4b8bbe(0x86),_0xa9c378[_0x38f9ee][_0x4b8bbe(0x112)]=_0x59f3f8[0x5];}else{if(_0x38f9ee==_0x1f295f){var _0x362cb5;if(_0x59f3f8[0x4]=='L')_0x362cb5=_0x4b8bbe(0xe5);else _0x59f3f8[0x4]=='F'&&(_0x362cb5='Floor');_0xa9c378[_0x38f9ee][_0x4b8bbe(0x76)]=_0x59f3f8[0x0],_0xa9c378[_0x38f9ee][_0x4b8bbe(0x129)]=_0x59f3f8[0x1],_0xa9c378[_0x38f9ee][_0x4b8bbe(0x9f)]=_0x59f3f8[0x2],_0xa9c378[_0x38f9ee][_0x4b8bbe(0x80)]=_0x59f3f8[0x3],_0xa9c378[_0x38f9ee]['type']=_0x362cb5,_0xa9c378[_0x38f9ee]['floorlevel']=_0x59f3f8[0x5];}}}});}),_0x5c0cf8[_0x448fea(0x109)]((_0x501fa9,_0x4bf969)=>{var _0x1c5af3=_0x448fea;_0xa9c378[_0x4bf969][_0x1c5af3(0x65)]=_0x501fa9;}),_0xd13d50['forEach']((_0x5e6856,_0x5b5750)=>{var _0x46ac1c=_0x448fea;_0xa9c378[_0x5b5750][_0x46ac1c(0x107)]=_0x5e6856;}),_0x50354c[_0x448fea(0x109)]((_0x240efc,_0x1f6412)=>{_0xa9c378[_0x1f6412]['types']=_0x240efc;}),_0x43ac08['forEach']((_0x4bde82,_0xd1aba4)=>{var _0x31acf5=_0x448fea;_0xa9c378[_0xd1aba4][_0x31acf5(0x113)]=_0x4bde82;}),_0x2ac5a3['forEach']((_0x25c829,_0x4fe2ce)=>{_0xa9c378[_0x4fe2ce]['new_adjust_qty']=_0x25c829;}),_0x273ebc[_0x448fea(0x109)]((_0x26e81b,_0x285ecd)=>{_0xa9c378[_0x285ecd]['unit']=_0x26e81b;}),_0x31833b[_0x448fea(0x109)]((_0x58ba5a,_0x342a44)=>{var _0xb932a5=_0x448fea;_0xa9c378[_0x342a44][_0xb932a5(0x10e)]=_0x58ba5a;}),_0x5f4555[_0x448fea(0x109)]((_0x13ded7,_0x525779)=>{var _0x34fe6c=_0x448fea;_0xa9c378[_0x525779][_0x34fe6c(0x94)]=_0x13ded7;}),_0x4d37fc[_0x448fea(0x109)]((_0x2c3c2c,_0x59e0fa)=>{var _0x5e500f=_0x448fea;_0xa9c378[_0x59e0fa][_0x5e500f(0x10a)]=_0x2c3c2c;}),_0x21943d[_0x448fea(0x109)]((_0x46a4e5,_0x4a111a)=>{_0xa9c378[_0x4a111a]['expiry_date']=_0x46a4e5;}),_0x1f109d[_0x448fea(0x109)]((_0x41b58e,_0x4a2ee7)=>{var _0x255bf6=_0x448fea;_0xa9c378[_0x4a2ee7][_0x255bf6(0x68)]=_0x41b58e;}),_0x3e5b97[_0x448fea(0x109)]((_0x2fc307,_0x3558df)=>{var _0x58ba43=_0x448fea;_0xa9c378[_0x3558df][_0x58ba43(0x6b)]=_0x2fc307;}),_0x4f9ea7[_0x448fea(0x109)]((_0x2eeee7,_0x39e3ac)=>{_0xa9c378[_0x39e3ac]['prod_cat']=_0x2eeee7;}),_0x482847[_0x448fea(0x109)]((_0x56b329,_0x4725e3)=>{var _0x5ca8db=_0x448fea;_0xa9c378[_0x4725e3][_0x5ca8db(0xee)]=_0x56b329;}),_0x53c5de[_0x448fea(0x109)]((_0x5d3648,_0x3980a0)=>{var _0x1bf696=_0x448fea;_0xa9c378[_0x3980a0][_0x1bf696(0xfb)]=_0x5d3648;}),_0x24fbd1[_0x448fea(0x109)]((_0x241e5b,_0x301b43)=>{_0xa9c378[_0x301b43]['secondary_code']=_0x241e5b;}),_0x446910[_0x448fea(0x109)]((_0x15017e,_0x56442e)=>{var _0x6d92ae=_0x448fea;_0xa9c378[_0x56442e][_0x6d92ae(0x82)]=_0x15017e;});const _0x50fb8b=_0xa9c378[_0x448fea(0x93)](_0x3dcead=>_0x3dcead[_0x448fea(0x113)]!=='0'&&_0x3dcead['adjust_qty']!=='');var _0x7febe1=0x0;_0x50fb8b[_0x448fea(0x109)](_0x530385=>{var _0x47e91b=_0x448fea;console[_0x47e91b(0x138)](_0x47e91b(0x134),_0x530385),parseInt(_0x530385[_0x47e91b(0x113)])<=0x0&&_0x7febe1++;});if(_0x7febe1!=0x0)return _0x379359[_0x448fea(0x8f)]('errors',_0x448fea(0xce)),_0x1a362f[_0x448fea(0x8b)]('back');const _0x432a16=new adjustment({'warehouse_name':_0x2c2ce6,'date':_0x20d230,'product':_0x50fb8b,'note':_0x466cd8,'room':_0x33dd89,'invoice':_0x43c3ab,'JO_number':_0x52f112,'expiry_date':_0x52a208}),_0x12945f=await _0x432a16[_0x448fea(0xc3)]();_0x379359[_0x448fea(0x8f)](_0x448fea(0xdf),_0x448fea(0x13b)),_0x1a362f[_0x448fea(0x8b)]('/adjustment/preview/'+_0x12945f[_0x448fea(0xdd)]);}catch(_0x203879){console[_0x448fea(0x138)](_0x203879),_0x1a362f[_0x448fea(0xd6)](0xc8)[_0x448fea(0xdc)]({'message':_0x203879[_0x448fea(0xb8)]});}}),router[a0_0x4586d6(0x8c)](a0_0x4586d6(0xaf),auth,async(_0x5eaaf0,_0x473e27)=>{var _0x264761=a0_0x4586d6;try{const {username:_0x141488,email:_0x4748ba,role:_0x5488b1}=_0x5eaaf0[_0x264761(0x71)],_0x232fdf=_0x5eaaf0['user'],_0x27f0ed=await profile['findOne']({'email':_0x232fdf[_0x264761(0x8d)]}),_0x1fbcfd=await master_shop['find'](),_0x10f995=_0x5eaaf0[_0x264761(0xaa)]['id'],_0x47f3bb=await adjustment[_0x264761(0x7e)]({'_id':_0x10f995}),_0x2f6d82=await purchases['aggregate']([{'$match':{'warehouse_name':_0x47f3bb[_0x264761(0xe2)]}},{'$unwind':'$product'},{'$group':{'_id':_0x264761(0x9c)}}]),_0x558e07=await product['find']({}),_0x4badb9=await warehouse[_0x264761(0xfc)]([{'$match':{'name':_0x47f3bb[_0x264761(0xe2)]}},{'$unwind':_0x264761(0x12f)},{'$group':{'_id':_0x264761(0xd8),'name':{'$first':_0x264761(0x127)},'product_stock':{'$first':_0x264761(0xb0)},'bay':{'$first':_0x264761(0x119)},'bin':{'$first':_0x264761(0xba)},'type':{'$first':_0x264761(0x108)},'floorlevel':{'$first':_0x264761(0xcb)},'primary_code':{'$first':_0x264761(0x84)},'secondary_code':{'$first':_0x264761(0x118)},'product_code':{'$first':_0x264761(0x90)},'storage':{'$first':_0x264761(0x10f)},'rack':{'$first':_0x264761(0xb9)},'maxPerUnit':{'$first':_0x264761(0x97)},'expiry_date':{'$first':_0x264761(0xd9)},'production_date':{'$first':_0x264761(0xdb)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x264761(0x67)}}}]);if(_0x1fbcfd[0x0][_0x264761(0xb6)]==_0x264761(0x11e)){var _0x4e2288=users[_0x264761(0x6c)];console[_0x264761(0x138)](_0x4e2288);}else{if(_0x1fbcfd[0x0][_0x264761(0xb6)]=='Hindi')var _0x4e2288=users[_0x264761(0xf5)];else{if(_0x1fbcfd[0x0][_0x264761(0xb6)]==_0x264761(0x6a))var _0x4e2288=users[_0x264761(0x6a)];else{if(_0x1fbcfd[0x0][_0x264761(0xb6)]==_0x264761(0x120))var _0x4e2288=users[_0x264761(0x120)];else{if(_0x1fbcfd[0x0][_0x264761(0xb6)]==_0x264761(0xfe))var _0x4e2288=users['French'];else{if(_0x1fbcfd[0x0][_0x264761(0xb6)]==_0x264761(0xc2))var _0x4e2288=users['Portuguese'];else{if(_0x1fbcfd[0x0][_0x264761(0xb6)]==_0x264761(0x10d))var _0x4e2288=users[_0x264761(0x10d)];else{if(_0x1fbcfd[0x0][_0x264761(0xb6)]==_0x264761(0xa0))var _0x4e2288=users[_0x264761(0xb1)];}}}}}}}_0x473e27['render'](_0x264761(0xd1),{'success':_0x5eaaf0['flash'](_0x264761(0xdf)),'errors':_0x5eaaf0[_0x264761(0x8f)](_0x264761(0xcf)),'role':_0x232fdf,'profile':_0x27f0ed,'adjustment':_0x47f3bb,'stock':_0x4badb9,'master_shop':_0x1fbcfd,'warehouse_name':_0x2f6d82,'unit':_0x558e07,'language':_0x4e2288});}catch(_0x57ca17){console[_0x264761(0x138)](_0x57ca17),_0x473e27['status'](0xc8)[_0x264761(0xdc)]({'message':_0x57ca17[_0x264761(0xb8)]});}}),router['post'](a0_0x4586d6(0xaf),auth,async(_0x1936d5,_0x1d92fb)=>{var _0x3c55f7=a0_0x4586d6;try{const _0x2382c8=_0x1936d5['params']['id'],{warehouse_name:_0x11b395,Room_name:_0xc87fc2}=_0x1936d5[_0x3c55f7(0xec)],_0x1bb2f4=await adjustment[_0x3c55f7(0x7e)]({'_id':_0x2382c8}),_0x18cfde=_0x1bb2f4[_0x3c55f7(0x72)]['map'](async _0x5b2322=>{var _0x249c45=_0x3c55f7;if(_0x5b2322[_0x249c45(0x113)]>0x0){var _0x48a251=await warehouse[_0x249c45(0xcd)]({'name':_0x11b395,'room':_0x5b2322[_0x249c45(0xee)],'warehouse_category':_0x249c45(0x7a)});const _0x2e9e44=_0x48a251[_0x249c45(0xd7)][_0x249c45(0x123)](_0x2e7192=>{var _0x111c97=_0x249c45;console[_0x111c97(0x138)](_0x5b2322[_0x111c97(0xca)]+'\x20<>\x20');if(_0x5b2322[_0x111c97(0xca)]==_0x111c97(0x102)){if(_0x2e7192['product_name']==_0x5b2322[_0x111c97(0xe1)]&&_0x2e7192[_0x111c97(0x112)]==_0x5b2322[_0x111c97(0x112)]&&_0x2e7192[_0x111c97(0x92)]==_0x5b2322['type']&&_0x2e7192[_0x111c97(0x80)]==_0x5b2322[_0x111c97(0x80)]&&_0x2e7192['bay']==_0x5b2322[_0x111c97(0x9f)]&&_0x2e7192[_0x111c97(0x129)]==_0x5b2322[_0x111c97(0x129)]&&_0x2e7192['storage']==_0x5b2322[_0x111c97(0x76)]&&_0x2e7192['expiry_date']==_0x5b2322[_0x111c97(0x88)]&&_0x2e7192[_0x111c97(0x10a)]==_0x5b2322[_0x111c97(0x10a)]&&_0x2e7192['production_date']==_0x5b2322[_0x111c97(0x6b)]&&_0x2e7192['invoice']==_0x5b2322[_0x111c97(0x82)]&&_0x2e7192[_0x111c97(0xdd)]==_0x5b2322[_0x111c97(0x107)]){var _0x294351;_0x294351=_0x5b2322[_0x111c97(0x113)],_0x5b2322[_0x111c97(0x64)]=='S'&&(_0x294351=_0x5b2322[_0x111c97(0x113)]),_0x2e7192[_0x111c97(0xbe)]=_0x2e7192[_0x111c97(0xbe)]-_0x294351;}}else{if(_0x2e7192[_0x111c97(0xe1)]==_0x5b2322[_0x111c97(0xe1)]&&_0x2e7192[_0x111c97(0x112)]==_0x5b2322[_0x111c97(0x112)]&&_0x2e7192[_0x111c97(0x92)]==_0x5b2322[_0x111c97(0x92)]&&_0x2e7192['bin']==_0x5b2322[_0x111c97(0x80)]&&_0x2e7192[_0x111c97(0x9f)]==_0x5b2322['bay']&&_0x2e7192[_0x111c97(0x129)]==_0x5b2322['rack']&&_0x2e7192['storage']==_0x5b2322[_0x111c97(0x76)]&&_0x2e7192['expiry_date']==_0x5b2322[_0x111c97(0x88)]&&_0x2e7192[_0x111c97(0x10a)]==_0x5b2322[_0x111c97(0x10a)]&&_0x2e7192[_0x111c97(0x6b)]==_0x5b2322['production_date']&&_0x2e7192[_0x111c97(0x82)]==_0x5b2322[_0x111c97(0x82)]&&_0x2e7192[_0x111c97(0xdd)]==_0x5b2322[_0x111c97(0x107)]){console[_0x111c97(0x138)](_0x5b2322);var _0x294351;_0x294351=_0x5b2322['adjust_qty'],_0x5b2322[_0x111c97(0x64)]=='S'&&(_0x294351=_0x5b2322[_0x111c97(0x113)]),_0x2e7192[_0x111c97(0xbe)]=_0x2e7192[_0x111c97(0xbe)]+_0x294351;}}});}return _0x48a251;});Promise[_0x3c55f7(0x111)](_0x18cfde)[_0x3c55f7(0xde)](async _0x2e3ab4=>{var _0x7b6c38=_0x3c55f7;try{for(const _0x2eb3a9 of _0x2e3ab4){await _0x2eb3a9['save']();}_0x1bb2f4[_0x7b6c38(0xcc)]=_0x7b6c38(0xe4);const _0x5e0c87=await _0x1bb2f4[_0x7b6c38(0xc3)](),_0xe64346=await master_shop[_0x7b6c38(0x6f)](),_0x5dc748=await email_settings[_0x7b6c38(0xcd)](),_0x24bbf6=await supervisor_settings[_0x7b6c38(0x6f)]();var _0x12d1b1=_0x1bb2f4['product'],_0x5e72bc='',_0x400fd1;for(_0x400fd1 in _0x12d1b1){_0x5e72bc+=_0x7b6c38(0xef)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x12d1b1[_0x400fd1]['product_name']+_0x7b6c38(0xc9)+_0x7b6c38(0xae)+_0x12d1b1[_0x400fd1][_0x7b6c38(0x94)]+_0x7b6c38(0xc9)+_0x7b6c38(0xae)+_0x12d1b1[_0x400fd1][_0x7b6c38(0x113)]+_0x7b6c38(0xc9)+_0x7b6c38(0xae)+_0x12d1b1[_0x400fd1][_0x7b6c38(0xc5)]+_0x7b6c38(0xc9)+_0x7b6c38(0xae)+_0x12d1b1[_0x400fd1][_0x7b6c38(0x10e)]+_0x7b6c38(0xc9)+_0x7b6c38(0xae)+_0x1bb2f4[_0x7b6c38(0xe2)]+_0x7b6c38(0xc9)+_0x7b6c38(0xae)+_0x12d1b1[_0x400fd1][_0x7b6c38(0xee)]+_0x7b6c38(0xc9)+_0x7b6c38(0xae)+_0x12d1b1[_0x400fd1]['storage']+_0x12d1b1[_0x400fd1][_0x7b6c38(0x129)]+_0x12d1b1[_0x400fd1][_0x7b6c38(0x9f)]+_0x12d1b1[_0x400fd1][_0x7b6c38(0x80)]+_0x12d1b1[_0x400fd1][_0x7b6c38(0x92)][0x0]+_0x12d1b1[_0x400fd1]['floorlevel']+'</td>',_0x7b6c38(0x139);}let _0x3aa44b=nodemailer[_0x7b6c38(0x7c)]({'host':_0x5dc748[_0x7b6c38(0x81)],'port':Number(_0x5dc748['port']),'secure':![],'auth':{'user':_0x5dc748[_0x7b6c38(0x8d)],'pass':_0x5dc748[_0x7b6c38(0xbf)]}}),_0x4226df={'from':_0x5dc748[_0x7b6c38(0x8d)],'to':_0x24bbf6[0x0]['RMSEmail'],'subject':_0x7b6c38(0x70),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x7b6c38(0x105)+_0xe64346[0x0]['image'],'cid':'logo'}],'html':_0x7b6c38(0xd2)+'<html><head><title></title>'+_0x7b6c38(0xf6)+'<div>'+_0x7b6c38(0xc0)+'<div>'+_0x7b6c38(0x75)+_0x7b6c38(0xeb)+_0x7b6c38(0x78)+'<h2>\x20'+_0xe64346[0x0]['site_title']+_0x7b6c38(0xa6)+_0x7b6c38(0xeb)+_0x7b6c38(0xeb)+_0x7b6c38(0x10b)+_0x7b6c38(0x78)+_0x7b6c38(0x11a)+'\x20Order\x20Number\x20:\x20'+_0x1bb2f4['invoice']+'\x20'+_0x7b6c38(0xa2)+_0x7b6c38(0xf7)+_0x1bb2f4[_0x7b6c38(0xa4)]+'\x20'+_0x7b6c38(0x69)+_0x7b6c38(0x125)+_0x7b6c38(0xeb)+_0x7b6c38(0x126)+_0x7b6c38(0x135)+_0x7b6c38(0xef)+_0x7b6c38(0xe3)+_0x7b6c38(0x7f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x7b6c38(0xbc)+_0x7b6c38(0xa3)+_0x7b6c38(0xfd)+_0x7b6c38(0xa7)+_0x7b6c38(0xd4)+'</tr>'+_0x7b6c38(0xa1)+_0x7b6c38(0xab)+'\x20'+_0x5e72bc+'\x20'+'</tbody>'+'</table>'+_0x7b6c38(0x78)+_0x7b6c38(0x124)+_0x7b6c38(0xfa)+_0xe64346[0x0][_0x7b6c38(0xc6)]+'</h5>'+'</div>'+_0x7b6c38(0xeb)+_0x7b6c38(0x136)};_0x3aa44b['sendMail'](_0x4226df,function(_0x57f305,_0x23625f){var _0x561812=_0x7b6c38;_0x57f305?(console[_0x561812(0x138)](_0x57f305),console[_0x561812(0x138)](_0x561812(0xad))):console[_0x561812(0x138)](_0x561812(0xac));}),_0x1936d5['flash'](_0x7b6c38(0xdf),'adjustment\x20Finalized\x20successfully'),_0x1d92fb[_0x7b6c38(0x8b)](_0x7b6c38(0x9a)+_0x5e0c87[_0x7b6c38(0xdd)]);}catch(_0x55edfd){console[_0x7b6c38(0x137)](_0x55edfd),_0x1d92fb[_0x7b6c38(0xd6)](0x1f4)[_0x7b6c38(0xdc)]({'error':_0x7b6c38(0x12c)});}})[_0x3c55f7(0xd0)](_0xf5e45a=>{var _0x22378b=_0x3c55f7;console[_0x22378b(0x137)](_0xf5e45a),_0x1d92fb[_0x22378b(0xd6)](0x1f4)['json']({'error':_0x22378b(0x132)});});}catch(_0x4cec86){console[_0x3c55f7(0x138)](_0x4cec86),_0x1d92fb['status'](0xc8)['json']({'message':_0x4cec86[_0x3c55f7(0xb8)]});}}),router['get'](a0_0x4586d6(0x10c),auth,async(_0x97fe48,_0xa29775)=>{var _0x5b30dc=a0_0x4586d6;try{const {username:_0xeb8492,email:_0x3d942a,role:_0x688e91}=_0x97fe48[_0x5b30dc(0x71)],_0x1dbeff=_0x97fe48[_0x5b30dc(0x71)],_0x43ba2a=await profile[_0x5b30dc(0xcd)]({'email':_0x1dbeff[_0x5b30dc(0x8d)]}),_0x477f7b=await master_shop[_0x5b30dc(0x6f)](),_0x43caf0=_0x97fe48[_0x5b30dc(0xaa)]['id'],_0x5d9e90=await adjustment['findById']({'_id':_0x43caf0}),_0x26e09a=await purchases[_0x5b30dc(0xfc)]([{'$match':{'warehouse_name':_0x5d9e90[_0x5b30dc(0xe2)]}},{'$unwind':'$product'},{'$group':{'_id':_0x5b30dc(0x9c)}}]),_0x47a7ca=await product[_0x5b30dc(0x6f)]({}),_0x2c3e6b=await warehouse[_0x5b30dc(0xfc)]([{'$match':{'name':_0x5d9e90['warehouse_name']}},{'$unwind':_0x5b30dc(0x12f)},{'$group':{'_id':_0x5b30dc(0xd8),'name':{'$first':_0x5b30dc(0x127)},'product_stock':{'$first':_0x5b30dc(0xb0)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5b30dc(0x108)},'floorlevel':{'$first':_0x5b30dc(0xcb)},'primary_code':{'$first':_0x5b30dc(0x84)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5b30dc(0x10f)},'rack':{'$first':_0x5b30dc(0xb9)},'maxPerUnit':{'$first':_0x5b30dc(0x97)},'expiry_date':{'$first':_0x5b30dc(0xd9)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x5b30dc(0x122)},'room':{'$first':_0x5b30dc(0x67)}}}]);let _0x2d13e5;if(_0x1dbeff[_0x5b30dc(0x11c)]=='staff'){const _0x219e3b=await staff[_0x5b30dc(0xcd)]({'email':_0x1dbeff[_0x5b30dc(0x8d)]});_0x2d13e5=await warehouse['aggregate']([{'$match':{'status':_0x5b30dc(0xf3),'name':_0x219e3b[_0x5b30dc(0x12e)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x5b30dc(0x8a)}}},{'$group':{'_id':_0x5b30dc(0x116),'name':{'$first':_0x5b30dc(0x116)}}}]);}else _0x2d13e5=await warehouse[_0x5b30dc(0xfc)]([{'$match':{'status':'Enabled','warehouse_category':_0x5b30dc(0x7a),'name':{'$ne':_0x5b30dc(0x8a)}}},{'$group':{'_id':_0x5b30dc(0x116),'name':{'$first':'$name'}}}]);if(_0x477f7b[0x0][_0x5b30dc(0xb6)]==_0x5b30dc(0x11e)){var _0x4306e1=users[_0x5b30dc(0x6c)];console[_0x5b30dc(0x138)](_0x4306e1);}else{if(_0x477f7b[0x0][_0x5b30dc(0xb6)]=='Hindi')var _0x4306e1=users[_0x5b30dc(0xf5)];else{if(_0x477f7b[0x0]['language']==_0x5b30dc(0x6a))var _0x4306e1=users[_0x5b30dc(0x6a)];else{if(_0x477f7b[0x0][_0x5b30dc(0xb6)]==_0x5b30dc(0x120))var _0x4306e1=users['Spanish'];else{if(_0x477f7b[0x0][_0x5b30dc(0xb6)]==_0x5b30dc(0xfe))var _0x4306e1=users['French'];else{if(_0x477f7b[0x0][_0x5b30dc(0xb6)]==_0x5b30dc(0xc2))var _0x4306e1=users['Portuguese'];else{if(_0x477f7b[0x0][_0x5b30dc(0xb6)]==_0x5b30dc(0x10d))var _0x4306e1=users[_0x5b30dc(0x10d)];else{if(_0x477f7b[0x0][_0x5b30dc(0xb6)]=='Arabic\x20(ae)')var _0x4306e1=users[_0x5b30dc(0xb1)];}}}}}}}_0xa29775['render'](_0x5b30dc(0x66),{'success':_0x97fe48[_0x5b30dc(0x8f)]('success'),'errors':_0x97fe48['flash'](_0x5b30dc(0xcf)),'role':_0x1dbeff,'profile':_0x43ba2a,'adjustment':_0x5d9e90,'stock':_0x2c3e6b,'master_shop':_0x477f7b,'warehouse_name':_0x26e09a,'unit':_0x47a7ca,'language':_0x4306e1,'warehouse':_0x2d13e5});}catch(_0x4c851b){console['log'](_0x4c851b),_0xa29775[_0x5b30dc(0xd6)](0xc8)[_0x5b30dc(0xdc)]({'message':_0x4c851b[_0x5b30dc(0xb8)]});}}),router[a0_0x4586d6(0xf0)](a0_0x4586d6(0x10c),auth,async(_0x10914d,_0x57878c)=>{var _0x26fffe=a0_0x4586d6;try{const _0x177c87=_0x10914d[_0x26fffe(0xaa)]['id'],_0x3c2556=await adjustment[_0x26fffe(0x7e)]({'_id':_0x177c87}),_0x3021c3=await warehouse[_0x26fffe(0xcd)]({'name':_0x3c2556[_0x26fffe(0xe2)],'room':_0x3c2556[_0x26fffe(0xd5)]}),{warehouse_name:_0x4df8a1,date:_0x4d5a24,prod_name:_0x12ba93,level:_0x9ca0ae,isle:_0x4d3019,pallet:_0x22bc8f,stock:_0x16887f,types:_0x29748b,adjust_qty:_0x1499a2,new_adjust_qty:_0x1ba34b,note:_0x5262a5,Room_name:_0xec0286,invoice:_0x54b308,JO_number:_0x51b8a9,expiry_date:_0x482494}=_0x10914d[_0x26fffe(0xec)];if(typeof _0x12ba93==_0x26fffe(0xa9))var _0x321aa4=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0x121)]],_0x33bd6c=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0xb4)]],_0x25a072=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0x117)]],_0x43db32=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0xca)]],_0x288669=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0x11f)]],_0x511f51=[_0x10914d[_0x26fffe(0xec)]['New_Qty_Converted']],_0x412f1b=[_0x10914d['body'][_0x26fffe(0x7d)]],_0x4eb58f=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0x77)]],_0x572b79=[_0x10914d['body'][_0x26fffe(0x11d)]],_0x570080=[_0x10914d['body']['batch_code']],_0x1bbfcf=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0x88)]],_0xcd8990=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0xb2)]],_0x4eda3c=[_0x10914d[_0x26fffe(0xec)]['production_date']],_0x52d9d9=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0x64)]],_0x50c98c=[_0x10914d['body']['Rooms']],_0x1aac6d=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0x7b)]],_0x12f945=[_0x10914d[_0x26fffe(0xec)][_0x26fffe(0x9e)]];else var _0x321aa4=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0x121)]],_0x33bd6c=[..._0x10914d['body'][_0x26fffe(0xb4)]],_0x25a072=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0x117)]],_0x43db32=[..._0x10914d['body'][_0x26fffe(0xca)]],_0x288669=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0x11f)]],_0x511f51=[..._0x10914d['body'][_0x26fffe(0x96)]],_0x412f1b=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0xc5)]],_0x4eb58f=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0x77)]],_0x572b79=[..._0x10914d[_0x26fffe(0xec)]['prod_code']],_0x570080=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0x10a)]],_0x1bbfcf=[..._0x10914d['body'][_0x26fffe(0x88)]],_0xcd8990=[..._0x10914d[_0x26fffe(0xec)]['max_per_unit']],_0x4eda3c=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0x6b)]],_0x52d9d9=[..._0x10914d[_0x26fffe(0xec)]['prod_cat']],_0x50c98c=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0xf2)]],_0x1aac6d=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0x7b)]],_0x12f945=[..._0x10914d[_0x26fffe(0xec)][_0x26fffe(0x9e)]];const _0x3c7e06=_0x321aa4[_0x26fffe(0x123)](_0x1d337d=>{return _0x1d337d={'product_name':_0x1d337d};});_0x33bd6c['forEach']((_0x3ec948,_0x819e36)=>{var _0x1743b2=_0x26fffe;_0x50c98c[_0x1743b2(0x109)]((_0x206395,_0x37739a)=>{var _0x153839=_0x1743b2;if(_0x206395==_0x153839(0xc7)&&_0x819e36==_0x37739a){var _0x569fe0=_0x3ec948[_0x153839(0xb3)](0x3);_0x3c7e06[_0x819e36]['storage']=_0x3ec948[0x0],_0x3c7e06[_0x819e36][_0x153839(0x129)]=_0x3ec948[0x1],_0x3c7e06[_0x819e36][_0x153839(0x9f)]=0x0,_0x3c7e06[_0x819e36][_0x153839(0x80)]=0x0,_0x3c7e06[_0x819e36][_0x153839(0x92)]=_0x153839(0x86),_0x3c7e06[_0x819e36]['floorlevel']=_0x569fe0;}else{if(_0x206395==_0x153839(0xed)&&_0x819e36==_0x37739a){var _0x569fe0=_0x3ec948[_0x153839(0xb3)](0x3);_0x3c7e06[_0x819e36][_0x153839(0x76)]=_0x3ec948[0x0],_0x3c7e06[_0x819e36][_0x153839(0x129)]=_0x3ec948[0x1],_0x3c7e06[_0x819e36][_0x153839(0x9f)]=0x0,_0x3c7e06[_0x819e36][_0x153839(0x80)]=0x0,_0x3c7e06[_0x819e36][_0x153839(0x92)]=_0x153839(0x86),_0x3c7e06[_0x819e36][_0x153839(0x112)]=_0x3ec948[0x5];}else{if(_0x819e36==_0x37739a){var _0x4dc646;if(_0x3ec948[0x4]=='L')_0x4dc646=_0x153839(0xe5);else _0x3ec948[0x4]=='F'&&(_0x4dc646='Floor');_0x3c7e06[_0x819e36][_0x153839(0x76)]=_0x3ec948[0x0],_0x3c7e06[_0x819e36]['rack']=_0x3ec948[0x1],_0x3c7e06[_0x819e36]['bay']=_0x3ec948[0x2],_0x3c7e06[_0x819e36][_0x153839(0x80)]=_0x3ec948[0x3],_0x3c7e06[_0x819e36][_0x153839(0x92)]=_0x4dc646,_0x3c7e06[_0x819e36][_0x153839(0x112)]=_0x3ec948[0x5];}}}});}),_0x25a072[_0x26fffe(0x109)]((_0x1d4535,_0x567854)=>{var _0x3695da=_0x26fffe;_0x3c7e06[_0x567854][_0x3695da(0x65)]=_0x1d4535;}),_0x43db32[_0x26fffe(0x109)]((_0x2842bf,_0x542458)=>{_0x3c7e06[_0x542458]['types']=_0x2842bf;}),_0x288669['forEach']((_0x54a9fc,_0x5c9003)=>{var _0x4cbfb4=_0x26fffe;_0x3c7e06[_0x5c9003][_0x4cbfb4(0x113)]=_0x54a9fc;}),_0x511f51[_0x26fffe(0x109)]((_0xcd747a,_0xa4bb62)=>{_0x3c7e06[_0xa4bb62]['new_adjust_qty']=_0xcd747a;}),_0x412f1b[_0x26fffe(0x109)]((_0x2c510d,_0x266d74)=>{var _0x12b38c=_0x26fffe;_0x3c7e06[_0x266d74][_0x12b38c(0xc5)]=_0x2c510d;}),_0x4eb58f[_0x26fffe(0x109)]((_0x5b7a73,_0x4a5a0a)=>{var _0x7097c6=_0x26fffe;_0x3c7e06[_0x4a5a0a][_0x7097c6(0x10e)]=_0x5b7a73;}),_0x572b79[_0x26fffe(0x109)]((_0xa92495,_0x2d7bba)=>{var _0x543462=_0x26fffe;_0x3c7e06[_0x2d7bba][_0x543462(0x94)]=_0xa92495;}),_0x570080[_0x26fffe(0x109)]((_0x5136fb,_0x32ee6c)=>{_0x3c7e06[_0x32ee6c]['batch_code']=_0x5136fb;}),_0x1bbfcf['forEach']((_0x117434,_0x325d57)=>{var _0x1f4ec3=_0x26fffe;_0x3c7e06[_0x325d57][_0x1f4ec3(0x88)]=_0x117434;}),_0xcd8990['forEach']((_0x4d8729,_0x5b201d)=>{var _0x5a92a6=_0x26fffe;_0x3c7e06[_0x5b201d][_0x5a92a6(0x68)]=_0x4d8729;}),_0x4eda3c[_0x26fffe(0x109)]((_0x2aa76c,_0x5e0d35)=>{var _0x55ce32=_0x26fffe;_0x3c7e06[_0x5e0d35][_0x55ce32(0x6b)]=_0x2aa76c;}),_0x52d9d9['forEach']((_0x37ade0,_0x4fee3d)=>{_0x3c7e06[_0x4fee3d]['prod_cat']=_0x37ade0;}),_0x50c98c[_0x26fffe(0x109)]((_0x59e2b5,_0x5164eb)=>{var _0x48a10c=_0x26fffe;_0x3c7e06[_0x5164eb][_0x48a10c(0xee)]=_0x59e2b5;}),_0x1aac6d['forEach']((_0x4dad81,_0x15f237)=>{var _0x5b4cd1=_0x26fffe;_0x3c7e06[_0x15f237][_0x5b4cd1(0xfb)]=_0x4dad81;}),_0x12f945[_0x26fffe(0x109)]((_0x1bfdd1,_0x1f630a)=>{_0x3c7e06[_0x1f630a]['secondary_code']=_0x1bfdd1;});const _0xe94b67=_0x3c7e06[_0x26fffe(0x93)](_0x29a97f=>_0x29a97f[_0x26fffe(0x113)]!=='0'&&_0x29a97f['adjust_qty']!=='');var _0x1efdd8=0x0;_0xe94b67[_0x26fffe(0x109)](_0x2287b0=>{var _0x5bec7e=_0x26fffe;console['log'](_0x5bec7e(0x134),_0x2287b0),parseInt(_0x2287b0[_0x5bec7e(0x113)])<=0x0&&_0x1efdd8++;});if(_0x1efdd8!=0x0)return _0x10914d[_0x26fffe(0x8f)](_0x26fffe(0xcf),_0x26fffe(0xce)),_0x57878c[_0x26fffe(0x8b)]('back');_0x3c2556[_0x26fffe(0xe2)]=_0x4df8a1,_0x3c2556[_0x26fffe(0xa4)]=_0x4d5a24,_0x3c2556[_0x26fffe(0x72)]=_0xe94b67,_0x3c2556[_0x26fffe(0xe9)]=_0x5262a5,_0x3c2556[_0x26fffe(0x82)]=_0x54b308,_0x3c2556[_0x26fffe(0x103)]=_0x26fffe(0xa5);const _0x45bc12=await _0x3c2556['save']();_0x10914d['flash'](_0x26fffe(0xdf),'adjustment\x20data\x20update\x20successfully'),_0x57878c['redirect']('/adjustment/view');}catch(_0x30e30a){console[_0x26fffe(0x138)](_0x30e30a);}}),router[a0_0x4586d6(0xf0)](a0_0x4586d6(0xc1),async(_0x37042f,_0x35288f)=>{var _0x351eb5=a0_0x4586d6;const {primary_code:_0x5685c9,warehouse_data:_0x717051,rooms_data:_0x1a7c04,Roomslist:_0x1ccc3a}=_0x37042f['body'],_0x19e218=_0x1ccc3a[_0x351eb5(0x12d)](','),_0x376453=[];async function _0x52e22b(_0x106f3c){var _0x21861a=_0x351eb5;const _0x25526d=await warehouse[_0x21861a(0xfc)]([{'$match':{'name':_0x717051,'room':_0x106f3c}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x5685c9}},{'$group':{'_id':_0x21861a(0xd8),'name':{'$first':_0x21861a(0x127)},'product_stock':{'$first':_0x21861a(0xb0)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x21861a(0x118)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x21861a(0xba)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x21861a(0xcb)},'unit':{'$first':_0x21861a(0x91)},'secondary_unit':{'$first':_0x21861a(0x98)},'storage':{'$first':_0x21861a(0x10f)},'rack':{'$first':_0x21861a(0xb9)},'expiry_date':{'$first':_0x21861a(0xd9)},'production_date':{'$first':_0x21861a(0xdb)},'maxPerUnit':{'$first':_0x21861a(0x97)},'batch_code':{'$first':_0x21861a(0x122)},'product_cat':{'$first':_0x21861a(0xf1)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x21861a(0x101)}}}]),_0x13305a=await warehouse[_0x21861a(0xfc)]([{'$match':{'name':_0x717051,'room':_0x106f3c}},{'$unwind':_0x21861a(0x12f)},{'$match':{'product_details.secondary_code':_0x5685c9}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x21861a(0x127)},'product_stock':{'$first':_0x21861a(0xb0)},'primary_code':{'$first':_0x21861a(0x84)},'secondary_code':{'$first':_0x21861a(0x118)},'product_code':{'$first':_0x21861a(0x90)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x21861a(0xba)},'type':{'$first':_0x21861a(0x108)},'pallet':{'$first':_0x21861a(0xcb)},'unit':{'$first':_0x21861a(0x91)},'secondary_unit':{'$first':_0x21861a(0x98)},'storage':{'$first':_0x21861a(0x10f)},'rack':{'$first':_0x21861a(0xb9)},'expiry_date':{'$first':_0x21861a(0xd9)},'production_date':{'$first':_0x21861a(0xdb)},'maxPerUnit':{'$first':_0x21861a(0x97)},'batch_code':{'$first':_0x21861a(0x122)},'product_cat':{'$first':_0x21861a(0xf1)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x21861a(0x67)}}}]);if(_0x25526d[_0x21861a(0x130)]>0x0)_0x376453[_0x21861a(0x133)](_0x25526d);else _0x13305a['length']>0x0&&_0x376453['push'](_0x13305a);}const _0x5ce79f=_0x19e218[_0x351eb5(0x123)](_0x55adc8=>_0x52e22b(_0x55adc8));await Promise[_0x351eb5(0x111)](_0x5ce79f),_0x35288f['json'](_0x376453);}),router[a0_0x4586d6(0xf0)](a0_0x4586d6(0x11b),async(_0x19d063,_0x3ef4d2)=>{var _0x3da51c=a0_0x4586d6;const {primaryCode:_0xd7ade9,secondaryCode:_0x5affa4,productCode:_0x35c7e7,level:_0x3f4ffc,isle:_0x356598,pallet:_0x37ca19,warehouses:_0x27f6e9,room:_0x19ca26}=_0x19d063['body'];try{const _0x20b5bc=await warehouse[_0x3da51c(0xfc)]([{'$match':{'name':_0x27f6e9,'room':_0x19ca26}},{'$unwind':_0x3da51c(0x12f)},{'$match':{'product_details.level':parseInt(_0x3f4ffc),'product_details.isle':_0x356598,'product_details.pallet':parseInt(_0x37ca19)}},{'$group':{'_id':_0x3da51c(0xd8),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3da51c(0xb0)},'level':{'$first':_0x3da51c(0x6e)},'isle':{'$first':_0x3da51c(0xc8)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x3da51c(0x8e)}}}]);_0x3ef4d2[_0x3da51c(0xd6)](0xc8)[_0x3da51c(0xdc)](_0x20b5bc);}catch(_0x41ca1c){_0x3ef4d2[_0x3da51c(0xd6)](0x194)[_0x3da51c(0xdc)]({'message':_0x41ca1c['message']});}}),module[a0_0x4586d6(0xd3)]=router;