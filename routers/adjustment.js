var a0_0x2dc043=a0_0x9b78;(function(_0x38cbfa,_0x3a2f9d){var _0x401c4b=a0_0x9b78,_0x1df7b3=_0x38cbfa();while(!![]){try{var _0x3ee614=-parseInt(_0x401c4b(0x20a))/0x1+-parseInt(_0x401c4b(0x24a))/0x2+parseInt(_0x401c4b(0x1e4))/0x3+-parseInt(_0x401c4b(0x26b))/0x4*(parseInt(_0x401c4b(0x1ca))/0x5)+-parseInt(_0x401c4b(0x218))/0x6+-parseInt(_0x401c4b(0x1b7))/0x7+parseInt(_0x401c4b(0x223))/0x8;if(_0x3ee614===_0x3a2f9d)break;else _0x1df7b3['push'](_0x1df7b3['shift']());}catch(_0x164aee){_0x1df7b3['push'](_0x1df7b3['shift']());}}}(a0_0x5cd4,0x3cade));function a0_0x5cd4(){var _0x2627d5=['nodemailer','message','findById','</div>','<tbody\x20style=\x22text-align:\x20center;\x22>','stock','/view/add_adjustment','/CheckingWarehouse','second1','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.primary_code','prod_name','$product_details.secondary_code','port','$product_details.product_name','rack','random','English\x20(US)','adjust_qty','$product_details.maxPerUnit','$product_details.floorlevel','slice','</head><body>','length','sendMail','expiry_date','log','$product_details.bin','English','aggregate','floor','storage','/adjustment/preview/','Chinese','Arabic\x20(ae)','<div>','936831cZmKFO','secondary_code','stockBefore','flash','prod_code','Enabled','$product_details.storage','Arabic','$product_details.product_stock','filter','string','/preview/:id','\x20</h2>','Raw\x20Materials','$product_details.product_cat','$product_details.pallet','back','$product_details.level','There\x27s\x20a\x20error\x20in\x20this\x20transaction','3405uIfwQn','room_names','French','product_name','forEach','finalize','$product.product_name','password','An\x20error\x20occurred.','product','<h5>','$product_details.type','Enclosed','/barcode_scanner','Return\x20Goods','production_date','$_id','</td>','<!DOCTYPE\x20html>','site_title','$product_details.product_code','split','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_code','Portuguese\x20(BR)','errors','817038VvykPs','invoice','floorlevel','maxperunit','render','$product_details._id','warehouse_name','bin','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Return\x20Rooms','success','\x20<>\x20','warehouse','secondary_unit','find','<strong>\x20Regards\x20</strong>','$product_details.production_date','type','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.secondary_unit','image','Rooms','level','_id','\x20Order\x20Number\x20:\x20','prod_cat','$product_details.unit','adjustment','primary_code','createTransport','../public/language/languages.json','$finalize','findOne','Floor','/picking_list/PDF_adjustment_rm/','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Email\x20sent\x20successfully','</h5>','391115aWzOzd','Adjustment\x20Mail','adjustment\x20Finalized\x20successfully','</span>','product_stock','../models/all_models','room','new_adjust_qty','Ambient','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Receiving\x20Area','/view/:id','</tbody>','error','206448qTjisa','date','Portuguese','$product_details.isle','New_Qty_Converted','logo','/upload/','$product.room_names','<h2>\x20','padStart','$date','10196032FYlzqb','Secondary_units','foreach\x20newproduct','all','save','Spanish','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','unit','batch_code','German','types','Primary_Units','<html><head><title></title>','RMSEmail','Shelves','toString','$warehouse_name','email','$product_details.maxProducts','post','/view','Hindi','New_Qty_Converted_adj','note','express','push','host','master','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','ADJ-','Level','params','/adjustment/view','<hr\x20class=\x22my-3\x22>','$product_details.rack','catch','$product_details.expiry_date','Logo.png','role','978050QuXNwr','$product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','get','$invoice','$name','status','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','False','$product_details.bay','<tr>','user','id_transaction','$isAllowEdit','$room','$product_details','bay','max_per_unit','<h5\x20style=\x22text-align:\x20left;\x22>','</tr>','/../public','staff','prime1','body','exports','$product_details.invoice','language','prod_invoice','id_transaction_from','json','</table>','then','redirect','1468CuYuQt','map','../middleware/auth','</thead>'];a0_0x5cd4=function(){return _0x2627d5;};return a0_0x5cd4();}const express=require(a0_0x2dc043(0x23b)),app=express(),router=express['Router'](),auth=require(a0_0x2dc043(0x26d)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x2dc043(0x20f)),users=require(a0_0x2dc043(0x202)),nodemailer=require(a0_0x2dc043(0x26f));router[a0_0x2dc043(0x24d)](a0_0x2dc043(0x237),auth,async(_0x1b1e13,_0x3a0657)=>{var _0x1e86fe=a0_0x2dc043;try{const {username:_0x5149a5,email:_0x461021,role:_0x87edb8}=_0x1b1e13[_0x1e86fe(0x255)],_0x40ad2e=_0x1b1e13[_0x1e86fe(0x255)],_0x2d70fd=await profile['findOne']({'email':_0x40ad2e[_0x1e86fe(0x234)]}),_0x71cb7d=await master_shop[_0x1e86fe(0x1f2)]();console[_0x1e86fe(0x1ad)](_0x1e86fe(0x23e),_0x71cb7d);let _0x517426;if(_0x40ad2e[_0x1e86fe(0x249)]==_0x1e86fe(0x25f)){const _0x2da59d=await staff['findOne']({'email':_0x40ad2e[_0x1e86fe(0x234)]});_0x517426=await warehouse['find']({'status':_0x1e86fe(0x1bc),'name':_0x2da59d['warehouse']});}else _0x517426=await warehouse[_0x1e86fe(0x1f2)]({'status':_0x1e86fe(0x1bc)});const _0x85f043=await product[_0x1e86fe(0x1f2)]();let _0x194ef0;if(_0x40ad2e[_0x1e86fe(0x249)]=='staff'){const _0x3a9c40=await staff[_0x1e86fe(0x204)]({'email':_0x40ad2e[_0x1e86fe(0x234)]});_0x194ef0=await adjustment[_0x1e86fe(0x1f2)]({'warehouse_name':_0x3a9c40[_0x1e86fe(0x1f0)]});}else _0x194ef0=await adjustment[_0x1e86fe(0x1b0)]([{'$unwind':_0x1e86fe(0x24b)},{'$group':{'_id':_0x1e86fe(0x1da),'invoice':{'$first':_0x1e86fe(0x24e)},'date':{'$first':_0x1e86fe(0x222)},'warehouse_name':{'$first':_0x1e86fe(0x233)},'room':{'$addToSet':_0x1e86fe(0x21f)},'finalize':{'$first':_0x1e86fe(0x203)},'isAllowEdit':{'$first':_0x1e86fe(0x257)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x71cb7d[0x0]['language']==_0x1e86fe(0x280)){var _0x3b4409=users[_0x1e86fe(0x1af)];console[_0x1e86fe(0x1ad)](_0x3b4409);}else{if(_0x71cb7d[0x0][_0x1e86fe(0x264)]=='Hindi')var _0x3b4409=users['Hindi'];else{if(_0x71cb7d[0x0][_0x1e86fe(0x264)]=='German')var _0x3b4409=users['German'];else{if(_0x71cb7d[0x0][_0x1e86fe(0x264)]==_0x1e86fe(0x228))var _0x3b4409=users[_0x1e86fe(0x228)];else{if(_0x71cb7d[0x0][_0x1e86fe(0x264)]==_0x1e86fe(0x1cc))var _0x3b4409=users[_0x1e86fe(0x1cc)];else{if(_0x71cb7d[0x0][_0x1e86fe(0x264)]==_0x1e86fe(0x1e2))var _0x3b4409=users['Portuguese'];else{if(_0x71cb7d[0x0]['language']=='Chinese')var _0x3b4409=users[_0x1e86fe(0x1b4)];else{if(_0x71cb7d[0x0][_0x1e86fe(0x264)]=='Arabic\x20(ae)')var _0x3b4409=users[_0x1e86fe(0x1be)];}}}}}}}_0x3a0657[_0x1e86fe(0x1e8)](_0x1e86fe(0x1ff),{'success':_0x1b1e13[_0x1e86fe(0x1ba)](_0x1e86fe(0x1ee)),'errors':_0x1b1e13[_0x1e86fe(0x1ba)](_0x1e86fe(0x1e3)),'role':_0x40ad2e,'profile':_0x2d70fd,'warehouse':_0x517426,'product':_0x85f043,'adjustment':_0x194ef0,'master_shop':_0x71cb7d,'language':_0x3b4409});}catch(_0x1ec1aa){console[_0x1e86fe(0x1ad)](_0x1ec1aa);}});function a0_0x9b78(_0x25f51e,_0x8ca4ab){var _0x5cd4b0=a0_0x5cd4();return a0_0x9b78=function(_0x9b78a8,_0x34752d){_0x9b78a8=_0x9b78a8-0x1aa;var _0x41696e=_0x5cd4b0[_0x9b78a8];return _0x41696e;},a0_0x9b78(_0x25f51e,_0x8ca4ab);}async function getRandom8DigitNumber(){var _0x2b2b6f=a0_0x2dc043;const _0x113def=0x989680,_0x139db1=0x5f5e0ff,_0xbaeb04=Math[_0x2b2b6f(0x1b1)](Math[_0x2b2b6f(0x27f)]()*(_0x139db1-_0x113def+0x1))+_0x113def;var _0x9cff9e;const _0x4e9a81=await adjustment[_0x2b2b6f(0x204)]({'invoice':'ADJ-'+_0xbaeb04});return _0x4e9a81&&_0x4e9a81[_0x2b2b6f(0x1aa)]>0x0?_0x9cff9e=_0x2b2b6f(0x240)+_0xbaeb04:_0x9cff9e='ADJ-'+_0xbaeb04,_0x9cff9e;}router['get'](a0_0x2dc043(0x275),auth,async(_0x2e97c8,_0x1e44e3)=>{var _0x5ee02c=a0_0x2dc043;try{const {username:_0x2b3bc,email:_0x383924,role:_0x356896}=_0x2e97c8[_0x5ee02c(0x255)],_0xd3f815=_0x2e97c8['user'],_0x284285=await profile[_0x5ee02c(0x204)]({'email':_0xd3f815[_0x5ee02c(0x234)]}),_0x4e2f0e=await master_shop[_0x5ee02c(0x1f2)]();let _0x2b1f8a;if(_0xd3f815[_0x5ee02c(0x249)]=='staff'){const _0x3187d0=await staff[_0x5ee02c(0x204)]({'email':_0xd3f815[_0x5ee02c(0x234)]});_0x2b1f8a=await warehouse['aggregate']([{'$match':{'status':_0x5ee02c(0x1bc),'name':_0x3187d0[_0x5ee02c(0x1f0)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x5ee02c(0x1d8)}}},{'$group':{'_id':'$name','name':{'$first':_0x5ee02c(0x24f)}}}]);}else _0x2b1f8a=await warehouse[_0x5ee02c(0x1b0)]([{'$match':{'status':_0x5ee02c(0x1bc),'warehouse_category':_0x5ee02c(0x1c4),'name':{'$ne':_0x5ee02c(0x1d8)}}},{'$group':{'_id':_0x5ee02c(0x24f),'name':{'$first':_0x5ee02c(0x24f)}}}]);const _0x149e4f=await product[_0x5ee02c(0x1f2)]({}),_0x527722=await adjustment[_0x5ee02c(0x1f2)]({}),_0x94b9c1=_0x527722[_0x5ee02c(0x1aa)]+0x1,_0xf868f6=_0x5ee02c(0x240)+_0x94b9c1[_0x5ee02c(0x232)]()[_0x5ee02c(0x221)](0x5,'0');var _0x41677a=[_0x5ee02c(0x212),_0x5ee02c(0x1d6),_0x5ee02c(0x1ed)];if(_0x4e2f0e[0x0][_0x5ee02c(0x264)]==_0x5ee02c(0x280))var _0x26c9ed=users['English'];else{if(_0x4e2f0e[0x0][_0x5ee02c(0x264)]==_0x5ee02c(0x238))var _0x26c9ed=users[_0x5ee02c(0x238)];else{if(_0x4e2f0e[0x0][_0x5ee02c(0x264)]==_0x5ee02c(0x22c))var _0x26c9ed=users[_0x5ee02c(0x22c)];else{if(_0x4e2f0e[0x0][_0x5ee02c(0x264)]==_0x5ee02c(0x228))var _0x26c9ed=users['Spanish'];else{if(_0x4e2f0e[0x0][_0x5ee02c(0x264)]==_0x5ee02c(0x1cc))var _0x26c9ed=users[_0x5ee02c(0x1cc)];else{if(_0x4e2f0e[0x0][_0x5ee02c(0x264)]==_0x5ee02c(0x1e2))var _0x26c9ed=users[_0x5ee02c(0x21a)];else{if(_0x4e2f0e[0x0][_0x5ee02c(0x264)]==_0x5ee02c(0x1b4))var _0x26c9ed=users[_0x5ee02c(0x1b4)];else{if(_0x4e2f0e[0x0]['language']=='Arabic\x20(ae)')var _0x26c9ed=users['Arabic'];}}}}}}}const _0x4b2e37=getRandom8DigitNumber();_0x4b2e37[_0x5ee02c(0x269)](_0x549629=>{var _0x3ceee8=_0x5ee02c;_0x1e44e3['render']('add_adjustment',{'success':_0x2e97c8[_0x3ceee8(0x1ba)]('success'),'errors':_0x2e97c8[_0x3ceee8(0x1ba)](_0x3ceee8(0x1e3)),'role':_0xd3f815,'profile':_0x284285,'warehouse':_0x2b1f8a,'product':_0x149e4f,'master_shop':_0x4e2f0e,'language':_0x26c9ed,'rooms_data':_0x41677a,'invoice_no':_0x549629});})['catch'](_0x3aefc2=>{var _0x3baa69=_0x5ee02c;_0x2e97c8[_0x3baa69(0x1ba)](_0x3baa69(0x1e3),_0x3baa69(0x1c9)),_0x1e44e3[_0x3baa69(0x26a)](_0x3baa69(0x243));});}catch(_0x57ac40){console[_0x5ee02c(0x1ad)](_0x57ac40);}}),router[a0_0x2dc043(0x236)](a0_0x2dc043(0x275),auth,async(_0x3c7098,_0x10658c)=>{var _0x30ef29=a0_0x2dc043;try{const {warehouse_name:_0x57d447,date:_0x542607,prod_name:_0x1fa72d,level:_0x44f273,isle:_0x3a6daa,pallet:_0x120376,stock:_0x36b63e,types:_0x4f0721,adjust_qty:_0x33cd64,new_adjust_qty:_0x4b4516,note:_0x21c099,Room_name:_0x510146,invoice:_0x181692,JO_number:_0x32f793,expiry_date:_0x331c9c}=_0x3c7098[_0x30ef29(0x261)];if(typeof _0x1fa72d=='string')var _0x468a3e=[_0x3c7098['body'][_0x30ef29(0x27a)]],_0x38457a=[_0x3c7098['body'][_0x30ef29(0x1fa)]],_0x12405a=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x274)]],_0x1b45ef=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x22d)]],_0x84799d=[_0x3c7098['body'][_0x30ef29(0x239)]],_0x421eef=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x21c)]],_0x284a15=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x22e)]],_0x4c96ef=[_0x3c7098[_0x30ef29(0x261)]['Secondary_units']],_0x146a74=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x1bb)]],_0x189dfd=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x22b)]],_0x1cac6c=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x1ac)]],_0x267143=[_0x3c7098['body'][_0x30ef29(0x25b)]],_0x2fb548=[_0x3c7098['body'][_0x30ef29(0x1d9)]],_0x43efa3=[_0x3c7098[_0x30ef29(0x261)]['prod_cat']],_0x9b4f75=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x1f9)]],_0x44074f=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x260)]],_0x1bab94=[_0x3c7098['body'][_0x30ef29(0x277)]],_0x267305=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x265)]],_0xecb605=[_0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x256)]];else var _0x468a3e=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x27a)]],_0x38457a=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x1fa)]],_0x12405a=[..._0x3c7098['body'][_0x30ef29(0x274)]],_0x1b45ef=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x22d)]],_0x84799d=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x239)]],_0x421eef=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x21c)]],_0x284a15=[..._0x3c7098['body'][_0x30ef29(0x22a)]],_0x4c96ef=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x224)]],_0x146a74=[..._0x3c7098['body'][_0x30ef29(0x1bb)]],_0x189dfd=[..._0x3c7098['body'][_0x30ef29(0x22b)]],_0x1cac6c=[..._0x3c7098['body']['expiry_date']],_0x267143=[..._0x3c7098[_0x30ef29(0x261)]['max_per_unit']],_0x2fb548=[..._0x3c7098['body'][_0x30ef29(0x1d9)]],_0x43efa3=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x1fd)]],_0x9b4f75=[..._0x3c7098[_0x30ef29(0x261)]['Rooms']],_0x44074f=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x260)]],_0x1bab94=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x277)]],_0x267305=[..._0x3c7098[_0x30ef29(0x261)]['prod_invoice']],_0xecb605=[..._0x3c7098[_0x30ef29(0x261)][_0x30ef29(0x256)]];const _0x56f5c6=_0x468a3e[_0x30ef29(0x26c)](_0x5a9bd6=>{return _0x5a9bd6={'product_name':_0x5a9bd6};});_0x38457a['forEach']((_0x49a5a0,_0x428e5d)=>{var _0x3702e9=_0x30ef29;_0x9b4f75[_0x3702e9(0x1ce)]((_0x443f96,_0x584f2c)=>{var _0x4f18a4=_0x3702e9;if(_0x443f96==_0x4f18a4(0x214)&&_0x428e5d==_0x584f2c){var _0x18593e=_0x49a5a0[_0x4f18a4(0x284)](0x3);_0x56f5c6[_0x428e5d][_0x4f18a4(0x1b2)]=_0x49a5a0[0x0],_0x56f5c6[_0x428e5d][_0x4f18a4(0x27e)]=_0x49a5a0[0x1],_0x56f5c6[_0x428e5d][_0x4f18a4(0x25a)]=0x0,_0x56f5c6[_0x428e5d]['bin']=0x0,_0x56f5c6[_0x428e5d]['type']=_0x4f18a4(0x205),_0x56f5c6[_0x428e5d]['floorlevel']=_0x18593e;}else{if(_0x443f96==_0x4f18a4(0x231)&&_0x428e5d==_0x584f2c){var _0x18593e=_0x49a5a0[_0x4f18a4(0x284)](0x3);_0x56f5c6[_0x428e5d][_0x4f18a4(0x1b2)]=_0x49a5a0[0x0],_0x56f5c6[_0x428e5d][_0x4f18a4(0x27e)]=_0x49a5a0[0x1],_0x56f5c6[_0x428e5d][_0x4f18a4(0x25a)]=0x0,_0x56f5c6[_0x428e5d][_0x4f18a4(0x1eb)]=0x0,_0x56f5c6[_0x428e5d]['type']=_0x4f18a4(0x205),_0x56f5c6[_0x428e5d][_0x4f18a4(0x1e6)]=_0x49a5a0[0x5];}else{if(_0x428e5d==_0x584f2c){var _0xb07801;if(_0x49a5a0[0x4]=='L')_0xb07801=_0x4f18a4(0x241);else _0x49a5a0[0x4]=='F'&&(_0xb07801=_0x4f18a4(0x205));_0x56f5c6[_0x428e5d][_0x4f18a4(0x1b2)]=_0x49a5a0[0x0],_0x56f5c6[_0x428e5d][_0x4f18a4(0x27e)]=_0x49a5a0[0x1],_0x56f5c6[_0x428e5d][_0x4f18a4(0x25a)]=_0x49a5a0[0x2],_0x56f5c6[_0x428e5d][_0x4f18a4(0x1eb)]=_0x49a5a0[0x3],_0x56f5c6[_0x428e5d][_0x4f18a4(0x1f5)]=_0xb07801,_0x56f5c6[_0x428e5d]['floorlevel']=_0x49a5a0[0x5];}}}});}),_0x12405a[_0x30ef29(0x1ce)]((_0x57e780,_0x5768c1)=>{var _0x565727=_0x30ef29;_0x56f5c6[_0x5768c1][_0x565727(0x1b9)]=_0x57e780;}),_0xecb605[_0x30ef29(0x1ce)]((_0x3a344d,_0x1d19c2)=>{var _0xda4905=_0x30ef29;_0x56f5c6[_0x1d19c2][_0xda4905(0x266)]=_0x3a344d;}),_0x1b45ef['forEach']((_0x5331f2,_0x32f3b8)=>{_0x56f5c6[_0x32f3b8]['types']=_0x5331f2;}),_0x84799d['forEach']((_0x45397c,_0x40ac31)=>{var _0x217389=_0x30ef29;_0x56f5c6[_0x40ac31][_0x217389(0x281)]=_0x45397c;}),_0x421eef[_0x30ef29(0x1ce)]((_0x5d4fca,_0x19d43d)=>{var _0x24ba5f=_0x30ef29;_0x56f5c6[_0x19d43d][_0x24ba5f(0x211)]=_0x5d4fca;}),_0x284a15[_0x30ef29(0x1ce)]((_0x107699,_0x5d3ada)=>{var _0x36bdd8=_0x30ef29;_0x56f5c6[_0x5d3ada][_0x36bdd8(0x22a)]=_0x107699;}),_0x4c96ef[_0x30ef29(0x1ce)]((_0x101d6d,_0x53acc2)=>{var _0x1cbe73=_0x30ef29;_0x56f5c6[_0x53acc2][_0x1cbe73(0x1f1)]=_0x101d6d;}),_0x146a74['forEach']((_0x48f99b,_0xafc50c)=>{var _0x3b08d9=_0x30ef29;_0x56f5c6[_0xafc50c][_0x3b08d9(0x1e1)]=_0x48f99b;}),_0x189dfd['forEach']((_0x31104c,_0x2654f3)=>{_0x56f5c6[_0x2654f3]['batch_code']=_0x31104c;}),_0x1cac6c[_0x30ef29(0x1ce)]((_0x37686a,_0x12071c)=>{var _0x1718a1=_0x30ef29;_0x56f5c6[_0x12071c][_0x1718a1(0x1ac)]=_0x37686a;}),_0x267143[_0x30ef29(0x1ce)]((_0x14041c,_0x47ea3c)=>{var _0x325853=_0x30ef29;_0x56f5c6[_0x47ea3c][_0x325853(0x1e7)]=_0x14041c;}),_0x2fb548[_0x30ef29(0x1ce)]((_0x3a2fb3,_0x402b66)=>{var _0x5ddb76=_0x30ef29;_0x56f5c6[_0x402b66][_0x5ddb76(0x1d9)]=_0x3a2fb3;}),_0x43efa3['forEach']((_0x5e3cde,_0x5e3deb)=>{_0x56f5c6[_0x5e3deb]['prod_cat']=_0x5e3cde;}),_0x9b4f75[_0x30ef29(0x1ce)]((_0x1ad044,_0x4f04e4)=>{var _0x4764a5=_0x30ef29;_0x56f5c6[_0x4f04e4][_0x4764a5(0x1cb)]=_0x1ad044;}),_0x44074f['forEach']((_0x594222,_0x50a537)=>{var _0x3ab805=_0x30ef29;_0x56f5c6[_0x50a537][_0x3ab805(0x200)]=_0x594222;}),_0x1bab94['forEach']((_0x3a3543,_0x5ba8bc)=>{var _0x56a506=_0x30ef29;_0x56f5c6[_0x5ba8bc][_0x56a506(0x1b8)]=_0x3a3543;}),_0x267305[_0x30ef29(0x1ce)]((_0x5809ef,_0x1b5471)=>{var _0x17f2d9=_0x30ef29;_0x56f5c6[_0x1b5471][_0x17f2d9(0x1e5)]=_0x5809ef;});const _0x266927=_0x56f5c6[_0x30ef29(0x1c0)](_0x2062e2=>_0x2062e2[_0x30ef29(0x281)]!=='0'&&_0x2062e2[_0x30ef29(0x281)]!=='');var _0x3947e8=0x0;_0x266927[_0x30ef29(0x1ce)](_0x38b591=>{var _0x4d1946=_0x30ef29;console[_0x4d1946(0x1ad)](_0x4d1946(0x225),_0x38b591),parseInt(_0x38b591[_0x4d1946(0x281)])<=0x0&&_0x3947e8++;});if(_0x3947e8!=0x0)return _0x3c7098[_0x30ef29(0x1ba)](_0x30ef29(0x1e3),_0x30ef29(0x207)),_0x10658c[_0x30ef29(0x26a)](_0x30ef29(0x1c7));const _0x1d0af5=new adjustment({'warehouse_name':_0x57d447,'date':_0x542607,'product':_0x266927,'note':_0x21c099,'room':_0x510146,'invoice':_0x181692,'JO_number':_0x32f793,'expiry_date':_0x331c9c}),_0x2fb984=await _0x1d0af5[_0x30ef29(0x227)]();_0x3c7098[_0x30ef29(0x1ba)](_0x30ef29(0x1ee),'adjustment\x20add\x20successfull'),_0x10658c[_0x30ef29(0x26a)](_0x30ef29(0x1b3)+_0x2fb984['_id']);}catch(_0x335986){console[_0x30ef29(0x1ad)](_0x335986),_0x10658c['status'](0xc8)[_0x30ef29(0x267)]({'message':_0x335986[_0x30ef29(0x270)]});}}),router[a0_0x2dc043(0x24d)](a0_0x2dc043(0x1c2),auth,async(_0x120366,_0x262fc7)=>{var _0x20dcbb=a0_0x2dc043;try{const {username:_0x1630bb,email:_0x49621b,role:_0x3dc6e6}=_0x120366[_0x20dcbb(0x255)],_0xf68b07=_0x120366[_0x20dcbb(0x255)],_0x4fd3e2=await profile[_0x20dcbb(0x204)]({'email':_0xf68b07['email']}),_0x446fb7=await master_shop[_0x20dcbb(0x1f2)](),_0x5b515b=_0x120366['params']['id'],_0x1ddbc3=await adjustment[_0x20dcbb(0x271)]({'_id':_0x5b515b}),_0x528c51=await purchases[_0x20dcbb(0x1b0)]([{'$match':{'warehouse_name':_0x1ddbc3['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x20dcbb(0x1d0)}}]),_0x390b8b=await product[_0x20dcbb(0x1f2)]({}),_0x4daf97=await warehouse[_0x20dcbb(0x1b0)]([{'$match':{'name':_0x1ddbc3[_0x20dcbb(0x1ea)]}},{'$unwind':_0x20dcbb(0x259)},{'$group':{'_id':_0x20dcbb(0x1e9),'name':{'$first':_0x20dcbb(0x27d)},'product_stock':{'$first':_0x20dcbb(0x1bf)},'bay':{'$first':_0x20dcbb(0x253)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x20dcbb(0x1d5)},'floorlevel':{'$first':_0x20dcbb(0x283)},'primary_code':{'$first':_0x20dcbb(0x279)},'secondary_code':{'$first':_0x20dcbb(0x27b)},'product_code':{'$first':_0x20dcbb(0x1de)},'storage':{'$first':_0x20dcbb(0x1bd)},'rack':{'$first':_0x20dcbb(0x245)},'maxPerUnit':{'$first':_0x20dcbb(0x282)},'expiry_date':{'$first':_0x20dcbb(0x247)},'production_date':{'$first':_0x20dcbb(0x1f4)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x20dcbb(0x258)}}}]);if(_0x446fb7[0x0][_0x20dcbb(0x264)]==_0x20dcbb(0x280)){var _0x54bfeb=users[_0x20dcbb(0x1af)];console['log'](_0x54bfeb);}else{if(_0x446fb7[0x0]['language']=='Hindi')var _0x54bfeb=users[_0x20dcbb(0x238)];else{if(_0x446fb7[0x0][_0x20dcbb(0x264)]==_0x20dcbb(0x22c))var _0x54bfeb=users[_0x20dcbb(0x22c)];else{if(_0x446fb7[0x0]['language']==_0x20dcbb(0x228))var _0x54bfeb=users[_0x20dcbb(0x228)];else{if(_0x446fb7[0x0]['language']==_0x20dcbb(0x1cc))var _0x54bfeb=users[_0x20dcbb(0x1cc)];else{if(_0x446fb7[0x0][_0x20dcbb(0x264)]=='Portuguese\x20(BR)')var _0x54bfeb=users[_0x20dcbb(0x21a)];else{if(_0x446fb7[0x0][_0x20dcbb(0x264)]==_0x20dcbb(0x1b4))var _0x54bfeb=users[_0x20dcbb(0x1b4)];else{if(_0x446fb7[0x0]['language']=='Arabic\x20(ae)')var _0x54bfeb=users['Arabic'];}}}}}}}_0x262fc7['render']('edit_adjustment_view',{'success':_0x120366[_0x20dcbb(0x1ba)](_0x20dcbb(0x1ee)),'errors':_0x120366[_0x20dcbb(0x1ba)](_0x20dcbb(0x1e3)),'role':_0xf68b07,'profile':_0x4fd3e2,'adjustment':_0x1ddbc3,'stock':_0x4daf97,'master_shop':_0x446fb7,'warehouse_name':_0x528c51,'unit':_0x390b8b,'language':_0x54bfeb});}catch(_0x26ce63){console[_0x20dcbb(0x1ad)](_0x26ce63),_0x262fc7['status'](0xc8)[_0x20dcbb(0x267)]({'message':_0x26ce63[_0x20dcbb(0x270)]});}}),router[a0_0x2dc043(0x236)]('/preview/:id',auth,async(_0x52e77e,_0x2a46f1)=>{var _0xc29d3d=a0_0x2dc043;try{const _0x56e8c9=_0x52e77e[_0xc29d3d(0x242)]['id'],{warehouse_name:_0x4dc16c,Room_name:_0x386c6a}=_0x52e77e[_0xc29d3d(0x261)],_0xbe755c=await adjustment['findById']({'_id':_0x56e8c9}),_0xebcc02=_0xbe755c[_0xc29d3d(0x1d3)][_0xc29d3d(0x26c)](async _0x37af9a=>{var _0x31c895=_0xc29d3d;if(_0x37af9a['adjust_qty']>0x0){var _0x4fe6ea=await warehouse[_0x31c895(0x204)]({'name':_0x4dc16c,'room':_0x37af9a['room_names'],'warehouse_category':_0x31c895(0x1c4)});const _0x1d2796=_0x4fe6ea['product_details'][_0x31c895(0x26c)](_0x103bf9=>{var _0x35d688=_0x31c895;console[_0x35d688(0x1ad)](_0x37af9a[_0x35d688(0x22d)]+_0x35d688(0x1ef));if(_0x37af9a[_0x35d688(0x22d)]=='minus'){if(_0x103bf9[_0x35d688(0x1cd)]==_0x37af9a[_0x35d688(0x1cd)]&&_0x103bf9['floorlevel']==_0x37af9a[_0x35d688(0x1e6)]&&_0x103bf9[_0x35d688(0x1f5)]==_0x37af9a[_0x35d688(0x1f5)]&&_0x103bf9[_0x35d688(0x1eb)]==_0x37af9a['bin']&&_0x103bf9[_0x35d688(0x25a)]==_0x37af9a[_0x35d688(0x25a)]&&_0x103bf9[_0x35d688(0x27e)]==_0x37af9a[_0x35d688(0x27e)]&&_0x103bf9[_0x35d688(0x1b2)]==_0x37af9a[_0x35d688(0x1b2)]&&_0x103bf9[_0x35d688(0x1ac)]==_0x37af9a[_0x35d688(0x1ac)]&&_0x103bf9[_0x35d688(0x22b)]==_0x37af9a[_0x35d688(0x22b)]&&_0x103bf9['production_date']==_0x37af9a[_0x35d688(0x1d9)]&&_0x103bf9[_0x35d688(0x1e5)]==_0x37af9a[_0x35d688(0x1e5)]&&_0x103bf9['_id']==_0x37af9a[_0x35d688(0x266)]){var _0xe9c42;_0xe9c42=_0x37af9a[_0x35d688(0x281)],_0x37af9a['prod_cat']=='S'&&(_0xe9c42=_0x37af9a[_0x35d688(0x281)]),_0x103bf9[_0x35d688(0x20e)]=_0x103bf9[_0x35d688(0x20e)]-_0xe9c42;}}else{if(_0x103bf9[_0x35d688(0x1cd)]==_0x37af9a[_0x35d688(0x1cd)]&&_0x103bf9[_0x35d688(0x1e6)]==_0x37af9a['floorlevel']&&_0x103bf9[_0x35d688(0x1f5)]==_0x37af9a[_0x35d688(0x1f5)]&&_0x103bf9[_0x35d688(0x1eb)]==_0x37af9a[_0x35d688(0x1eb)]&&_0x103bf9[_0x35d688(0x25a)]==_0x37af9a[_0x35d688(0x25a)]&&_0x103bf9['rack']==_0x37af9a['rack']&&_0x103bf9[_0x35d688(0x1b2)]==_0x37af9a[_0x35d688(0x1b2)]&&_0x103bf9['expiry_date']==_0x37af9a[_0x35d688(0x1ac)]&&_0x103bf9[_0x35d688(0x22b)]==_0x37af9a[_0x35d688(0x22b)]&&_0x103bf9[_0x35d688(0x1d9)]==_0x37af9a[_0x35d688(0x1d9)]&&_0x103bf9[_0x35d688(0x1e5)]==_0x37af9a[_0x35d688(0x1e5)]&&_0x103bf9[_0x35d688(0x1fb)]==_0x37af9a[_0x35d688(0x266)]){console[_0x35d688(0x1ad)](_0x37af9a);var _0xe9c42;_0xe9c42=_0x37af9a[_0x35d688(0x281)],_0x37af9a[_0x35d688(0x1fd)]=='S'&&(_0xe9c42=_0x37af9a[_0x35d688(0x281)]),_0x103bf9[_0x35d688(0x20e)]=_0x103bf9[_0x35d688(0x20e)]+_0xe9c42;}}});}return _0x4fe6ea;});Promise[_0xc29d3d(0x226)](_0xebcc02)[_0xc29d3d(0x269)](async _0x4ef6ce=>{var _0x3bc3eb=_0xc29d3d;try{for(const _0x165962 of _0x4ef6ce){await _0x165962[_0x3bc3eb(0x227)]();}_0xbe755c[_0x3bc3eb(0x1cf)]='True';const _0x25d714=await _0xbe755c[_0x3bc3eb(0x227)](),_0x33abd9=await master_shop[_0x3bc3eb(0x1f2)](),_0x40dfb5=await email_settings[_0x3bc3eb(0x204)](),_0x36d141=await supervisor_settings[_0x3bc3eb(0x1f2)]();var _0x5966e7=_0xbe755c[_0x3bc3eb(0x1d3)],_0x5ad148='',_0x42c9f2;for(_0x42c9f2 in _0x5966e7){_0x5ad148+=_0x3bc3eb(0x254)+_0x3bc3eb(0x251)+_0x5966e7[_0x42c9f2][_0x3bc3eb(0x1cd)]+_0x3bc3eb(0x1db)+_0x3bc3eb(0x251)+_0x5966e7[_0x42c9f2][_0x3bc3eb(0x1e1)]+_0x3bc3eb(0x1db)+_0x3bc3eb(0x251)+_0x5966e7[_0x42c9f2][_0x3bc3eb(0x281)]+'</td>'+_0x3bc3eb(0x251)+_0x5966e7[_0x42c9f2][_0x3bc3eb(0x22a)]+_0x3bc3eb(0x1db)+_0x3bc3eb(0x251)+_0x5966e7[_0x42c9f2]['secondary_unit']+_0x3bc3eb(0x1db)+_0x3bc3eb(0x251)+_0xbe755c[_0x3bc3eb(0x1ea)]+_0x3bc3eb(0x1db)+_0x3bc3eb(0x251)+_0x5966e7[_0x42c9f2][_0x3bc3eb(0x1cb)]+_0x3bc3eb(0x1db)+_0x3bc3eb(0x251)+_0x5966e7[_0x42c9f2][_0x3bc3eb(0x1b2)]+_0x5966e7[_0x42c9f2][_0x3bc3eb(0x27e)]+_0x5966e7[_0x42c9f2]['bay']+_0x5966e7[_0x42c9f2][_0x3bc3eb(0x1eb)]+_0x5966e7[_0x42c9f2]['type'][0x0]+_0x5966e7[_0x42c9f2][_0x3bc3eb(0x1e6)]+_0x3bc3eb(0x1db),_0x3bc3eb(0x25d);}let _0x4ab512=nodemailer[_0x3bc3eb(0x201)]({'host':_0x40dfb5[_0x3bc3eb(0x23d)],'port':Number(_0x40dfb5[_0x3bc3eb(0x27c)]),'secure':![],'auth':{'user':_0x40dfb5['email'],'pass':_0x40dfb5[_0x3bc3eb(0x1d1)]}}),_0x25d56c={'from':_0x40dfb5[_0x3bc3eb(0x234)],'to':_0x36d141[0x0][_0x3bc3eb(0x230)],'subject':_0x3bc3eb(0x20b),'attachments':[{'filename':_0x3bc3eb(0x248),'path':__dirname+_0x3bc3eb(0x25e)+_0x3bc3eb(0x21e)+_0x33abd9[0x0][_0x3bc3eb(0x1f8)],'cid':_0x3bc3eb(0x21d)}],'html':_0x3bc3eb(0x1dc)+_0x3bc3eb(0x22f)+_0x3bc3eb(0x285)+_0x3bc3eb(0x1b6)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x3bc3eb(0x1b6)+_0x3bc3eb(0x1f6)+_0x3bc3eb(0x272)+_0x3bc3eb(0x1b6)+_0x3bc3eb(0x220)+_0x33abd9[0x0][_0x3bc3eb(0x1dd)]+_0x3bc3eb(0x1c3)+_0x3bc3eb(0x272)+_0x3bc3eb(0x272)+_0x3bc3eb(0x244)+_0x3bc3eb(0x1b6)+_0x3bc3eb(0x25c)+_0x3bc3eb(0x1fc)+_0xbe755c[_0x3bc3eb(0x1e5)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0xbe755c[_0x3bc3eb(0x219)]+'\x20'+_0x3bc3eb(0x20d)+_0x3bc3eb(0x209)+_0x3bc3eb(0x272)+_0x3bc3eb(0x1ec)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3bc3eb(0x254)+_0x3bc3eb(0x213)+_0x3bc3eb(0x278)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x3bc3eb(0x1e0)+_0x3bc3eb(0x229)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x3bc3eb(0x23f)+_0x3bc3eb(0x24c)+_0x3bc3eb(0x25d)+_0x3bc3eb(0x26e)+_0x3bc3eb(0x273)+'\x20'+_0x5ad148+'\x20'+_0x3bc3eb(0x216)+_0x3bc3eb(0x268)+_0x3bc3eb(0x1b6)+_0x3bc3eb(0x1f3)+_0x3bc3eb(0x1d4)+_0x33abd9[0x0][_0x3bc3eb(0x1dd)]+_0x3bc3eb(0x209)+_0x3bc3eb(0x272)+_0x3bc3eb(0x272)+'</body></html>'};_0x4ab512[_0x3bc3eb(0x1ab)](_0x25d56c,function(_0x2b5ebc,_0x3935ca){var _0x38682c=_0x3bc3eb;_0x2b5ebc?(console[_0x38682c(0x1ad)](_0x2b5ebc),console['log']('Error\x20Occurs')):console[_0x38682c(0x1ad)](_0x38682c(0x208));}),_0x52e77e['flash'](_0x3bc3eb(0x1ee),_0x3bc3eb(0x20c)),_0x2a46f1[_0x3bc3eb(0x26a)](_0x3bc3eb(0x206)+_0x25d714[_0x3bc3eb(0x1fb)]);}catch(_0xc548de){console[_0x3bc3eb(0x217)](_0xc548de),_0x2a46f1[_0x3bc3eb(0x250)](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0xc29d3d(0x246)](_0x4ae59c=>{var _0x219a92=_0xc29d3d;console[_0x219a92(0x217)](_0x4ae59c),_0x2a46f1['status'](0x1f4)[_0x219a92(0x267)]({'error':_0x219a92(0x1d2)});});}catch(_0x3db182){console[_0xc29d3d(0x1ad)](_0x3db182),_0x2a46f1[_0xc29d3d(0x250)](0xc8)['json']({'message':_0x3db182['message']});}}),router[a0_0x2dc043(0x24d)](a0_0x2dc043(0x215),auth,async(_0x1cb493,_0x3b080d)=>{var _0x23f7cd=a0_0x2dc043;try{const {username:_0x2a3b4e,email:_0x5f4ea3,role:_0x106038}=_0x1cb493[_0x23f7cd(0x255)],_0x3a0e7c=_0x1cb493[_0x23f7cd(0x255)],_0x2e6a41=await profile[_0x23f7cd(0x204)]({'email':_0x3a0e7c[_0x23f7cd(0x234)]}),_0x134c44=await master_shop[_0x23f7cd(0x1f2)](),_0x5d10fd=_0x1cb493[_0x23f7cd(0x242)]['id'],_0x4c1f8c=await adjustment[_0x23f7cd(0x271)]({'_id':_0x5d10fd}),_0x43d13c=await purchases[_0x23f7cd(0x1b0)]([{'$match':{'warehouse_name':_0x4c1f8c['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x23f7cd(0x1d0)}}]),_0x2741c0=await product[_0x23f7cd(0x1f2)]({}),_0x41d086=await warehouse['aggregate']([{'$match':{'name':_0x4c1f8c[_0x23f7cd(0x1ea)]}},{'$unwind':_0x23f7cd(0x259)},{'$group':{'_id':_0x23f7cd(0x1e9),'name':{'$first':_0x23f7cd(0x27d)},'product_stock':{'$first':_0x23f7cd(0x1bf)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x23f7cd(0x1ae)},'type':{'$first':_0x23f7cd(0x1d5)},'floorlevel':{'$first':_0x23f7cd(0x283)},'primary_code':{'$first':_0x23f7cd(0x279)},'secondary_code':{'$first':_0x23f7cd(0x27b)},'product_code':{'$first':_0x23f7cd(0x1de)},'storage':{'$first':_0x23f7cd(0x1bd)},'rack':{'$first':_0x23f7cd(0x245)},'maxPerUnit':{'$first':_0x23f7cd(0x282)},'expiry_date':{'$first':_0x23f7cd(0x247)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);let _0x50ab29;if(_0x3a0e7c[_0x23f7cd(0x249)]=='staff'){const _0x57d89e=await staff[_0x23f7cd(0x204)]({'email':_0x3a0e7c[_0x23f7cd(0x234)]});_0x50ab29=await warehouse[_0x23f7cd(0x1b0)]([{'$match':{'status':_0x23f7cd(0x1bc),'name':_0x57d89e['warehouse'],'warehouse_category':_0x23f7cd(0x1c4),'name':{'$ne':_0x23f7cd(0x1d8)}}},{'$group':{'_id':_0x23f7cd(0x24f),'name':{'$first':_0x23f7cd(0x24f)}}}]);}else _0x50ab29=await warehouse[_0x23f7cd(0x1b0)]([{'$match':{'status':_0x23f7cd(0x1bc),'warehouse_category':_0x23f7cd(0x1c4),'name':{'$ne':_0x23f7cd(0x1d8)}}},{'$group':{'_id':_0x23f7cd(0x24f),'name':{'$first':_0x23f7cd(0x24f)}}}]);if(_0x134c44[0x0][_0x23f7cd(0x264)]==_0x23f7cd(0x280)){var _0x571ab1=users[_0x23f7cd(0x1af)];console[_0x23f7cd(0x1ad)](_0x571ab1);}else{if(_0x134c44[0x0][_0x23f7cd(0x264)]=='Hindi')var _0x571ab1=users[_0x23f7cd(0x238)];else{if(_0x134c44[0x0][_0x23f7cd(0x264)]==_0x23f7cd(0x22c))var _0x571ab1=users[_0x23f7cd(0x22c)];else{if(_0x134c44[0x0][_0x23f7cd(0x264)]=='Spanish')var _0x571ab1=users[_0x23f7cd(0x228)];else{if(_0x134c44[0x0][_0x23f7cd(0x264)]==_0x23f7cd(0x1cc))var _0x571ab1=users[_0x23f7cd(0x1cc)];else{if(_0x134c44[0x0][_0x23f7cd(0x264)]==_0x23f7cd(0x1e2))var _0x571ab1=users['Portuguese'];else{if(_0x134c44[0x0][_0x23f7cd(0x264)]==_0x23f7cd(0x1b4))var _0x571ab1=users['Chinese'];else{if(_0x134c44[0x0][_0x23f7cd(0x264)]==_0x23f7cd(0x1b5))var _0x571ab1=users[_0x23f7cd(0x1be)];}}}}}}}_0x3b080d[_0x23f7cd(0x1e8)]('edit_adjustment',{'success':_0x1cb493['flash'](_0x23f7cd(0x1ee)),'errors':_0x1cb493['flash']('errors'),'role':_0x3a0e7c,'profile':_0x2e6a41,'adjustment':_0x4c1f8c,'stock':_0x41d086,'master_shop':_0x134c44,'warehouse_name':_0x43d13c,'unit':_0x2741c0,'language':_0x571ab1,'warehouse':_0x50ab29});}catch(_0x3861fd){console[_0x23f7cd(0x1ad)](_0x3861fd),_0x3b080d[_0x23f7cd(0x250)](0xc8)[_0x23f7cd(0x267)]({'message':_0x3861fd[_0x23f7cd(0x270)]});}}),router[a0_0x2dc043(0x236)](a0_0x2dc043(0x215),auth,async(_0x221d95,_0x27e44a)=>{var _0x49051d=a0_0x2dc043;try{const _0x1a976f=_0x221d95[_0x49051d(0x242)]['id'],_0x832ac8=await adjustment[_0x49051d(0x271)]({'_id':_0x1a976f}),_0x3826f2=await warehouse[_0x49051d(0x204)]({'name':_0x832ac8[_0x49051d(0x1ea)],'room':_0x832ac8[_0x49051d(0x210)]}),{warehouse_name:_0x339fbc,date:_0x18de71,prod_name:_0x294de9,level:_0x2b32a9,isle:_0x54c434,pallet:_0x562cf4,stock:_0x1398d4,types:_0x58c7f9,adjust_qty:_0x37bbe8,new_adjust_qty:_0x1846b2,note:_0x45116a,Room_name:_0x528c3c,invoice:_0x1ed4eb,JO_number:_0x1d4ee2,expiry_date:_0x369031}=_0x221d95[_0x49051d(0x261)];if(typeof _0x294de9==_0x49051d(0x1c1))var _0x27c8eb=[_0x221d95['body'][_0x49051d(0x27a)]],_0x10d46b=[_0x221d95['body'][_0x49051d(0x1fa)]],_0x3a1fb6=[_0x221d95[_0x49051d(0x261)][_0x49051d(0x274)]],_0x4153f0=[_0x221d95[_0x49051d(0x261)][_0x49051d(0x22d)]],_0xa01983=[_0x221d95['body'][_0x49051d(0x239)]],_0x30e5c2=[_0x221d95[_0x49051d(0x261)]['New_Qty_Converted']],_0x5e600f=[_0x221d95[_0x49051d(0x261)][_0x49051d(0x22e)]],_0x36cf39=[_0x221d95[_0x49051d(0x261)][_0x49051d(0x224)]],_0x1591c4=[_0x221d95[_0x49051d(0x261)]['prod_code']],_0x5ef136=[_0x221d95[_0x49051d(0x261)][_0x49051d(0x22b)]],_0x57f89f=[_0x221d95[_0x49051d(0x261)]['expiry_date']],_0x3dd71e=[_0x221d95[_0x49051d(0x261)]['max_per_unit']],_0x64221a=[_0x221d95[_0x49051d(0x261)]['production_date']],_0x3a7dbd=[_0x221d95[_0x49051d(0x261)][_0x49051d(0x1fd)]],_0x32fa7c=[_0x221d95[_0x49051d(0x261)][_0x49051d(0x1f9)]],_0x3f24dc=[_0x221d95[_0x49051d(0x261)][_0x49051d(0x260)]],_0x2fd3ff=[_0x221d95['body']['second1']];else var _0x27c8eb=[..._0x221d95['body'][_0x49051d(0x27a)]],_0x10d46b=[..._0x221d95['body']['level']],_0x3a1fb6=[..._0x221d95['body'][_0x49051d(0x274)]],_0x4153f0=[..._0x221d95['body'][_0x49051d(0x22d)]],_0xa01983=[..._0x221d95['body'][_0x49051d(0x239)]],_0x30e5c2=[..._0x221d95['body'][_0x49051d(0x21c)]],_0x5e600f=[..._0x221d95['body']['unit']],_0x36cf39=[..._0x221d95[_0x49051d(0x261)][_0x49051d(0x224)]],_0x1591c4=[..._0x221d95[_0x49051d(0x261)][_0x49051d(0x1bb)]],_0x5ef136=[..._0x221d95['body'][_0x49051d(0x22b)]],_0x57f89f=[..._0x221d95[_0x49051d(0x261)][_0x49051d(0x1ac)]],_0x3dd71e=[..._0x221d95[_0x49051d(0x261)]['max_per_unit']],_0x64221a=[..._0x221d95[_0x49051d(0x261)][_0x49051d(0x1d9)]],_0x3a7dbd=[..._0x221d95[_0x49051d(0x261)][_0x49051d(0x1fd)]],_0x32fa7c=[..._0x221d95[_0x49051d(0x261)][_0x49051d(0x1f9)]],_0x3f24dc=[..._0x221d95[_0x49051d(0x261)][_0x49051d(0x260)]],_0x2fd3ff=[..._0x221d95[_0x49051d(0x261)][_0x49051d(0x277)]];const _0x3aaeae=_0x27c8eb[_0x49051d(0x26c)](_0x1f2851=>{return _0x1f2851={'product_name':_0x1f2851};});_0x10d46b[_0x49051d(0x1ce)]((_0x2a43ae,_0x1e8949)=>{_0x32fa7c['forEach']((_0x22244c,_0xc00ccf)=>{var _0x32f11a=a0_0x9b78;if(_0x22244c==_0x32f11a(0x214)&&_0x1e8949==_0xc00ccf){var _0xac7742=_0x2a43ae[_0x32f11a(0x284)](0x3);_0x3aaeae[_0x1e8949][_0x32f11a(0x1b2)]=_0x2a43ae[0x0],_0x3aaeae[_0x1e8949]['rack']=_0x2a43ae[0x1],_0x3aaeae[_0x1e8949][_0x32f11a(0x25a)]=0x0,_0x3aaeae[_0x1e8949][_0x32f11a(0x1eb)]=0x0,_0x3aaeae[_0x1e8949][_0x32f11a(0x1f5)]='Floor',_0x3aaeae[_0x1e8949][_0x32f11a(0x1e6)]=_0xac7742;}else{if(_0x22244c==_0x32f11a(0x231)&&_0x1e8949==_0xc00ccf){var _0xac7742=_0x2a43ae[_0x32f11a(0x284)](0x3);_0x3aaeae[_0x1e8949][_0x32f11a(0x1b2)]=_0x2a43ae[0x0],_0x3aaeae[_0x1e8949][_0x32f11a(0x27e)]=_0x2a43ae[0x1],_0x3aaeae[_0x1e8949][_0x32f11a(0x25a)]=0x0,_0x3aaeae[_0x1e8949][_0x32f11a(0x1eb)]=0x0,_0x3aaeae[_0x1e8949][_0x32f11a(0x1f5)]='Floor',_0x3aaeae[_0x1e8949][_0x32f11a(0x1e6)]=_0x2a43ae[0x5];}else{if(_0x1e8949==_0xc00ccf){var _0x2346b7;if(_0x2a43ae[0x4]=='L')_0x2346b7='Level';else _0x2a43ae[0x4]=='F'&&(_0x2346b7=_0x32f11a(0x205));_0x3aaeae[_0x1e8949][_0x32f11a(0x1b2)]=_0x2a43ae[0x0],_0x3aaeae[_0x1e8949][_0x32f11a(0x27e)]=_0x2a43ae[0x1],_0x3aaeae[_0x1e8949][_0x32f11a(0x25a)]=_0x2a43ae[0x2],_0x3aaeae[_0x1e8949][_0x32f11a(0x1eb)]=_0x2a43ae[0x3],_0x3aaeae[_0x1e8949]['type']=_0x2346b7,_0x3aaeae[_0x1e8949][_0x32f11a(0x1e6)]=_0x2a43ae[0x5];}}}});}),_0x3a1fb6['forEach']((_0xe4f505,_0x479a06)=>{var _0x2cfd1d=_0x49051d;_0x3aaeae[_0x479a06][_0x2cfd1d(0x1b9)]=_0xe4f505;}),_0x4153f0[_0x49051d(0x1ce)]((_0xffb80c,_0x57e1fb)=>{var _0x3ab20e=_0x49051d;_0x3aaeae[_0x57e1fb][_0x3ab20e(0x22d)]=_0xffb80c;}),_0xa01983[_0x49051d(0x1ce)]((_0x59b8c6,_0x235256)=>{var _0x57df41=_0x49051d;_0x3aaeae[_0x235256][_0x57df41(0x281)]=_0x59b8c6;}),_0x30e5c2['forEach']((_0x95239c,_0xa71c64)=>{_0x3aaeae[_0xa71c64]['new_adjust_qty']=_0x95239c;}),_0x5e600f[_0x49051d(0x1ce)]((_0x22c196,_0x2ace36)=>{var _0x1c3d8b=_0x49051d;_0x3aaeae[_0x2ace36][_0x1c3d8b(0x22a)]=_0x22c196;}),_0x36cf39[_0x49051d(0x1ce)]((_0x2e189b,_0x1c3be7)=>{var _0x5d78e3=_0x49051d;_0x3aaeae[_0x1c3be7][_0x5d78e3(0x1f1)]=_0x2e189b;}),_0x1591c4[_0x49051d(0x1ce)]((_0x351bdb,_0x1208df)=>{var _0x14f475=_0x49051d;_0x3aaeae[_0x1208df][_0x14f475(0x1e1)]=_0x351bdb;}),_0x5ef136[_0x49051d(0x1ce)]((_0x5a3f2f,_0x59f721)=>{_0x3aaeae[_0x59f721]['batch_code']=_0x5a3f2f;}),_0x57f89f[_0x49051d(0x1ce)]((_0x5a2668,_0x20e2c5)=>{var _0x2a0fe0=_0x49051d;_0x3aaeae[_0x20e2c5][_0x2a0fe0(0x1ac)]=_0x5a2668;}),_0x3dd71e[_0x49051d(0x1ce)]((_0xdcaf4f,_0x2e2a19)=>{var _0x5a0f71=_0x49051d;_0x3aaeae[_0x2e2a19][_0x5a0f71(0x1e7)]=_0xdcaf4f;}),_0x64221a[_0x49051d(0x1ce)]((_0x4fa1ab,_0x3e689a)=>{var _0x38c4cf=_0x49051d;_0x3aaeae[_0x3e689a][_0x38c4cf(0x1d9)]=_0x4fa1ab;}),_0x3a7dbd[_0x49051d(0x1ce)]((_0x901d60,_0x4d6453)=>{var _0x25e2c5=_0x49051d;_0x3aaeae[_0x4d6453][_0x25e2c5(0x1fd)]=_0x901d60;}),_0x32fa7c[_0x49051d(0x1ce)]((_0x304033,_0x31d23f)=>{var _0x4e973a=_0x49051d;_0x3aaeae[_0x31d23f][_0x4e973a(0x1cb)]=_0x304033;}),_0x3f24dc[_0x49051d(0x1ce)]((_0x5746ae,_0x28afee)=>{_0x3aaeae[_0x28afee]['primary_code']=_0x5746ae;}),_0x2fd3ff[_0x49051d(0x1ce)]((_0x4a5bca,_0x11acac)=>{var _0x141150=_0x49051d;_0x3aaeae[_0x11acac][_0x141150(0x1b8)]=_0x4a5bca;});const _0x1ab8c4=_0x3aaeae['filter'](_0x243803=>_0x243803[_0x49051d(0x281)]!=='0'&&_0x243803[_0x49051d(0x281)]!=='');var _0x2d5a51=0x0;_0x1ab8c4[_0x49051d(0x1ce)](_0x435152=>{var _0x3d7bfa=_0x49051d;console['log']('foreach\x20newproduct',_0x435152),parseInt(_0x435152[_0x3d7bfa(0x281)])<=0x0&&_0x2d5a51++;});if(_0x2d5a51!=0x0)return _0x221d95[_0x49051d(0x1ba)](_0x49051d(0x1e3),_0x49051d(0x207)),_0x27e44a[_0x49051d(0x26a)](_0x49051d(0x1c7));_0x832ac8[_0x49051d(0x1ea)]=_0x339fbc,_0x832ac8['date']=_0x18de71,_0x832ac8[_0x49051d(0x1d3)]=_0x1ab8c4,_0x832ac8[_0x49051d(0x23a)]=_0x45116a,_0x832ac8[_0x49051d(0x1e5)]=_0x1ed4eb,_0x832ac8['isAllowEdit']=_0x49051d(0x252);const _0x36cda7=await _0x832ac8['save']();_0x221d95[_0x49051d(0x1ba)](_0x49051d(0x1ee),'adjustment\x20data\x20update\x20successfully'),_0x27e44a[_0x49051d(0x26a)]('/adjustment/view');}catch(_0x5203a6){console[_0x49051d(0x1ad)](_0x5203a6);}}),router['post'](a0_0x2dc043(0x1d7),async(_0x2325ed,_0x1fe138)=>{var _0x5c5b9a=a0_0x2dc043;const {primary_code:_0x3e2300,warehouse_data:_0x7b6fc4,rooms_data:_0x9ed6d5,Roomslist:_0x591e21}=_0x2325ed[_0x5c5b9a(0x261)],_0x4b0b91=_0x591e21[_0x5c5b9a(0x1df)](','),_0x1ca259=[];async function _0xf5c994(_0x238940){var _0x7a5f27=_0x5c5b9a;const _0x7b5e5f=await warehouse[_0x7a5f27(0x1b0)]([{'$match':{'name':_0x7b6fc4,'room':_0x238940}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x3e2300}},{'$group':{'_id':_0x7a5f27(0x1e9),'name':{'$first':_0x7a5f27(0x27d)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x7a5f27(0x279)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x7a5f27(0x253)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x7a5f27(0x1fe)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x7a5f27(0x245)},'expiry_date':{'$first':_0x7a5f27(0x247)},'production_date':{'$first':_0x7a5f27(0x1f4)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x7a5f27(0x263)}}}]),_0x10a62d=await warehouse[_0x7a5f27(0x1b0)]([{'$match':{'name':_0x7b6fc4,'room':_0x238940}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3e2300}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x7a5f27(0x1bf)},'primary_code':{'$first':_0x7a5f27(0x279)},'secondary_code':{'$first':_0x7a5f27(0x27b)},'product_code':{'$first':_0x7a5f27(0x1de)},'level':{'$first':_0x7a5f27(0x253)},'isle':{'$first':_0x7a5f27(0x1ae)},'type':{'$first':_0x7a5f27(0x1d5)},'pallet':{'$first':_0x7a5f27(0x283)},'unit':{'$first':_0x7a5f27(0x1fe)},'secondary_unit':{'$first':_0x7a5f27(0x1f7)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x7a5f27(0x245)},'expiry_date':{'$first':_0x7a5f27(0x247)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x7a5f27(0x282)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x7a5f27(0x1c5)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x7a5f27(0x258)}}}]);if(_0x7b5e5f[_0x7a5f27(0x1aa)]>0x0)_0x1ca259[_0x7a5f27(0x23c)](_0x7b5e5f);else _0x10a62d[_0x7a5f27(0x1aa)]>0x0&&_0x1ca259[_0x7a5f27(0x23c)](_0x10a62d);}const _0x329a65=_0x4b0b91[_0x5c5b9a(0x26c)](_0x26c879=>_0xf5c994(_0x26c879));await Promise[_0x5c5b9a(0x226)](_0x329a65),_0x1fe138[_0x5c5b9a(0x267)](_0x1ca259);}),router['post'](a0_0x2dc043(0x276),async(_0x27b0b4,_0x4b162e)=>{var _0x22cebb=a0_0x2dc043;const {primaryCode:_0x597198,secondaryCode:_0x59acce,productCode:_0x1e1089,level:_0x48a57a,isle:_0x40b5f9,pallet:_0xea9e85,warehouses:_0x38c96f,room:_0x5b70b6}=_0x27b0b4[_0x22cebb(0x261)];try{const _0x5b10a6=await warehouse[_0x22cebb(0x1b0)]([{'$match':{'name':_0x38c96f,'room':_0x5b70b6}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x48a57a),'product_details.isle':_0x40b5f9,'product_details.pallet':parseInt(_0xea9e85)}},{'$group':{'_id':_0x22cebb(0x1e9),'name':{'$first':_0x22cebb(0x27d)},'product_stock':{'$first':_0x22cebb(0x1bf)},'level':{'$first':_0x22cebb(0x1c8)},'isle':{'$first':_0x22cebb(0x21b)},'pallet':{'$first':_0x22cebb(0x1c6)},'maxProducts':{'$first':_0x22cebb(0x235)}}}]);_0x4b162e[_0x22cebb(0x250)](0xc8)['json'](_0x5b10a6);}catch(_0x4fcd2a){_0x4b162e['status'](0x194)['json']({'message':_0x4fcd2a[_0x22cebb(0x270)]});}}),module[a0_0x2dc043(0x262)]=router;