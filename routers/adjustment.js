function a0_0x230f(){var _0xea5502=['/../public','site_title','Shelves','5192784TxZrFk','adjust_qty','secondary_unit','success','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','map','<span\x20style=\x22float:\x20right;\x22>','types','max_per_unit','<hr\x20class=\x22my-3\x22>','6503940zikHYR','$product_details.secondary_code','bay','finalize','Adjustment\x20Mail','user','invoice','room_names','$product_details._id','forEach','role','$product_details.isle','Enabled','/barcode_scanner','69817qXPTlq','</head><body>','</div>','adjustment\x20add\x20successfull','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.level','logo','$product_details.batch_code','createTransport','Error\x20Occurs','New_Qty_Converted','findById','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Level','storage','stock','English','id_transaction_from','$product_details.product_code','$product_details.maxPerUnit','ADJ-','then','email','An\x20error\x20occurred\x20while\x20saving\x20data.','Secondary_units','$room','</h5>','Email\x20sent\x20successfully','</body></html>','/view/:id','adjustment','<h5\x20style=\x22text-align:\x20left;\x22>','Portuguese','$name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Router','50607ewQmmu','push','$date','language','Hindi','error','Primary_Units','staff','</table>','string','new_adjust_qty','_id','\x20<>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Return\x20Goods','product_stock','log','unit','<strong>\x20Regards\x20</strong>','/picking_list/PDF_adjustment_rm/','Arabic\x20(ae)','room','master','$invoice','render','10lCtLPW','split','$product_details.bay','minus','Arabic','product','$product_details.maxProducts','Logo.png','$product_details.product_stock','exports','New_Qty_Converted_adj','1314670QvMCkZ','product_name','find','$product_details.product_cat','<h2>\x20','/view/add_adjustment','$product_details.pallet','Floor','bin','Spanish','Portuguese\x20(BR)','$product_details.primary_code','type','id_transaction','English\x20(US)','product_code','warehouse_name','Receiving\x20Area','message','\x20Order\x20Number\x20:\x20','add_adjustment','redirect','status','length','filter','1941dXUjmd','findOne','<tbody\x20style=\x22text-align:\x20center;\x22>','$warehouse_name','$product_details.type','RMSEmail','German','$product_details.storage','level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Raw\x20Materials','prod_name','<html><head><title></title>','$_id','<tr>','expiry_date','batch_code','$product_details.expiry_date','date','$product.product_name','errors','rack','product_details','/upload/','8150384JprMzw','../middleware/auth','\x20Order\x20Date\x20:\x20','edit_adjustment','flash','</thead>','$finalize','save','$product_details.bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/preview/:id','adjustment\x20data\x20update\x20successfully','42McUiWV','</tr>','secondary_code','primary_code','$isAllowEdit','foreach\x20newproduct','aggregate','/adjustment/view','production_date','3644gjMrWd','adjustment\x20Finalized\x20successfully','second1','random','express','<h5>','904fOyDuN','$product_details.floorlevel','$product','Chinese','maxperunit','prime1','slice','</td>','$product_details','password','</span>','$product_details.secondary_unit','$product_details.product_name','body','params','json','<div>','/CheckingWarehouse','French','13oaJNCi','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','floor','back','An\x20error\x20occurred.','$product_details.production_date','host','catch','Enclosed','$product_details.unit','/adjustment/preview/','Rooms','\x20</h2>','$product_details.rack','sendMail','image','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','floorlevel','</tbody>','edit_adjustment_view','get','padStart','post','prod_code','prod_cat','22PKmXVq','warehouse','stockBefore','all','False'];a0_0x230f=function(){return _0xea5502;};return a0_0x230f();}var a0_0x36d48c=a0_0x1e2a;(function(_0x17e45c,_0x472d44){var _0x5c73c1=a0_0x1e2a,_0x161e8c=_0x17e45c();while(!![]){try{var _0x2d8e4b=parseInt(_0x5c73c1(0x168))/0x1*(-parseInt(_0x5c73c1(0x148))/0x2)+-parseInt(_0x5c73c1(0xe8))/0x3*(-parseInt(_0x5c73c1(0x115))/0x4)+parseInt(_0x5c73c1(0x15a))/0x5+-parseInt(_0x5c73c1(0x10c))/0x6*(parseInt(_0x5c73c1(0xcf))/0x7)+-parseInt(_0x5c73c1(0x11b))/0x8*(-parseInt(_0x5c73c1(0xab))/0x9)+-parseInt(_0x5c73c1(0xc4))/0xa*(-parseInt(_0x5c73c1(0x100))/0xb)+parseInt(_0x5c73c1(0x150))/0xc*(-parseInt(_0x5c73c1(0x12e))/0xd);if(_0x2d8e4b===_0x472d44)break;else _0x161e8c['push'](_0x161e8c['shift']());}catch(_0x186ec5){_0x161e8c['push'](_0x161e8c['shift']());}}}(a0_0x230f,0xb7637));function a0_0x1e2a(_0x3f291a,_0x181b2b){var _0x230f9a=a0_0x230f();return a0_0x1e2a=function(_0x1e2aff,_0x31c619){_0x1e2aff=_0x1e2aff-0x91;var _0x20a137=_0x230f9a[_0x1e2aff];return _0x20a137;},a0_0x1e2a(_0x3f291a,_0x181b2b);}const express=require(a0_0x36d48c(0x119)),app=express(),router=express[a0_0x36d48c(0xaa)](),auth=require(a0_0x36d48c(0x101)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x36d48c(0x143)]('/view',auth,async(_0x2ba33f,_0x128995)=>{var _0xb88b59=a0_0x36d48c;try{const {username:_0x21b8db,email:_0x1a4335,role:_0xa5b431}=_0x2ba33f[_0xb88b59(0x15f)],_0x11be26=_0x2ba33f[_0xb88b59(0x15f)],_0x308966=await profile[_0xb88b59(0xe9)]({'email':_0x11be26[_0xb88b59(0x9d)]}),_0x3dd3d3=await master_shop[_0xb88b59(0xd1)]();console[_0xb88b59(0xbb)](_0xb88b59(0xc1),_0x3dd3d3);let _0x3cb4f9;if(_0x11be26[_0xb88b59(0x164)]=='staff'){const _0x3c078e=await staff[_0xb88b59(0xe9)]({'email':_0x11be26[_0xb88b59(0x9d)]});_0x3cb4f9=await warehouse['find']({'status':_0xb88b59(0x166),'name':_0x3c078e[_0xb88b59(0x149)]});}else _0x3cb4f9=await warehouse[_0xb88b59(0xd1)]({'status':'Enabled'});const _0x1b4609=await product[_0xb88b59(0xd1)]();let _0x170889;if(_0x11be26[_0xb88b59(0x164)]==_0xb88b59(0xb2)){const _0x121c94=await staff['findOne']({'email':_0x11be26[_0xb88b59(0x9d)]});_0x170889=await adjustment[_0xb88b59(0xd1)]({'warehouse_name':_0x121c94[_0xb88b59(0x149)]});}else _0x170889=await adjustment[_0xb88b59(0x112)]([{'$unwind':_0xb88b59(0x11d)},{'$group':{'_id':_0xb88b59(0xf5),'invoice':{'$first':_0xb88b59(0xc2)},'date':{'$first':_0xb88b59(0xad)},'warehouse_name':{'$first':_0xb88b59(0xeb)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0xb88b59(0x106)},'isAllowEdit':{'$first':_0xb88b59(0x110)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3dd3d3[0x0]['language']=='English\x20(US)'){var _0x38b729=users[_0xb88b59(0x97)];console[_0xb88b59(0xbb)](_0x38b729);}else{if(_0x3dd3d3[0x0]['language']==_0xb88b59(0xaf))var _0x38b729=users['Hindi'];else{if(_0x3dd3d3[0x0][_0xb88b59(0xae)]==_0xb88b59(0xee))var _0x38b729=users[_0xb88b59(0xee)];else{if(_0x3dd3d3[0x0][_0xb88b59(0xae)]=='Spanish')var _0x38b729=users[_0xb88b59(0xd8)];else{if(_0x3dd3d3[0x0][_0xb88b59(0xae)]=='French')var _0x38b729=users[_0xb88b59(0x12d)];else{if(_0x3dd3d3[0x0][_0xb88b59(0xae)]==_0xb88b59(0xd9))var _0x38b729=users[_0xb88b59(0xa7)];else{if(_0x3dd3d3[0x0][_0xb88b59(0xae)]=='Chinese')var _0x38b729=users[_0xb88b59(0x11e)];else{if(_0x3dd3d3[0x0][_0xb88b59(0xae)]==_0xb88b59(0xbf))var _0x38b729=users[_0xb88b59(0xc8)];}}}}}}}_0x128995[_0xb88b59(0xc3)](_0xb88b59(0xa5),{'success':_0x2ba33f[_0xb88b59(0x104)]('success'),'errors':_0x2ba33f['flash'](_0xb88b59(0xfc)),'role':_0x11be26,'profile':_0x308966,'warehouse':_0x3cb4f9,'product':_0x1b4609,'adjustment':_0x170889,'master_shop':_0x3dd3d3,'language':_0x38b729});}catch(_0x1e037){console[_0xb88b59(0xbb)](_0x1e037);}});async function getRandom8DigitNumber(){var _0x27016b=a0_0x36d48c;const _0x20e3fd=0x989680,_0xdc6df9=0x5f5e0ff,_0x3780f1=Math[_0x27016b(0x130)](Math[_0x27016b(0x118)]()*(_0xdc6df9-_0x20e3fd+0x1))+_0x20e3fd;var _0x40034a;const _0x35c51b=await adjustment['findOne']({'invoice':_0x27016b(0x9b)+_0x3780f1});return _0x35c51b&&_0x35c51b[_0x27016b(0xe6)]>0x0?_0x40034a='ADJ-'+_0x3780f1:_0x40034a=_0x27016b(0x9b)+_0x3780f1,_0x40034a;}router[a0_0x36d48c(0x143)](a0_0x36d48c(0xd4),auth,async(_0x1dcca2,_0x106612)=>{var _0x47fabb=a0_0x36d48c;try{const {username:_0x5b7f73,email:_0x3293fc,role:_0x20ca24}=_0x1dcca2['user'],_0x50231b=_0x1dcca2[_0x47fabb(0x15f)],_0x2b9244=await profile[_0x47fabb(0xe9)]({'email':_0x50231b[_0x47fabb(0x9d)]}),_0x25e24a=await master_shop['find']();let _0x3c84c5;if(_0x50231b[_0x47fabb(0x164)]==_0x47fabb(0xb2)){const _0x1ec5e6=await staff['findOne']({'email':_0x50231b[_0x47fabb(0x9d)]});_0x3c84c5=await warehouse[_0x47fabb(0x112)]([{'$match':{'status':_0x47fabb(0x166),'name':_0x1ec5e6['warehouse'],'warehouse_category':_0x47fabb(0xf2),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x47fabb(0xa8),'name':{'$first':_0x47fabb(0xa8)}}}]);}else _0x3c84c5=await warehouse[_0x47fabb(0x112)]([{'$match':{'status':_0x47fabb(0x166),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x47fabb(0xb9)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x1e9f7f=await product['find']({}),_0x36bc42=await adjustment[_0x47fabb(0xd1)]({}),_0x157d38=_0x36bc42[_0x47fabb(0xe6)]+0x1,_0xd27bdb='ADJ-'+_0x157d38['toString']()[_0x47fabb(0x144)](0x5,'0');var _0x1ce130=['Ambient',_0x47fabb(0x136),'Return\x20Rooms'];if(_0x25e24a[0x0][_0x47fabb(0xae)]=='English\x20(US)')var _0x1c0d27=users[_0x47fabb(0x97)];else{if(_0x25e24a[0x0][_0x47fabb(0xae)]==_0x47fabb(0xaf))var _0x1c0d27=users[_0x47fabb(0xaf)];else{if(_0x25e24a[0x0]['language']==_0x47fabb(0xee))var _0x1c0d27=users[_0x47fabb(0xee)];else{if(_0x25e24a[0x0][_0x47fabb(0xae)]==_0x47fabb(0xd8))var _0x1c0d27=users['Spanish'];else{if(_0x25e24a[0x0]['language']==_0x47fabb(0x12d))var _0x1c0d27=users[_0x47fabb(0x12d)];else{if(_0x25e24a[0x0]['language']=='Portuguese\x20(BR)')var _0x1c0d27=users[_0x47fabb(0xa7)];else{if(_0x25e24a[0x0][_0x47fabb(0xae)]==_0x47fabb(0x11e))var _0x1c0d27=users[_0x47fabb(0x11e)];else{if(_0x25e24a[0x0][_0x47fabb(0xae)]=='Arabic\x20(ae)')var _0x1c0d27=users[_0x47fabb(0xc8)];}}}}}}}const _0x19dd7f=getRandom8DigitNumber();_0x19dd7f[_0x47fabb(0x9c)](_0x358db2=>{var _0x201285=_0x47fabb;_0x106612[_0x201285(0xc3)](_0x201285(0xe3),{'success':_0x1dcca2[_0x201285(0x104)]('success'),'errors':_0x1dcca2[_0x201285(0x104)](_0x201285(0xfc)),'role':_0x50231b,'profile':_0x2b9244,'warehouse':_0x3c84c5,'product':_0x1e9f7f,'master_shop':_0x25e24a,'language':_0x1c0d27,'rooms_data':_0x1ce130,'invoice_no':_0x358db2});})[_0x47fabb(0x135)](_0x4fa5e5=>{var _0x4fe59c=_0x47fabb;_0x1dcca2[_0x4fe59c(0x104)](_0x4fe59c(0xfc),_0x4fe59c(0x93)),_0x106612[_0x4fe59c(0xe4)](_0x4fe59c(0x113));});}catch(_0x2e58d4){console[_0x47fabb(0xbb)](_0x2e58d4);}}),router[a0_0x36d48c(0x145)]('/view/add_adjustment',auth,async(_0x5236cf,_0x3dd5ce)=>{var _0x29f7c7=a0_0x36d48c;try{const {warehouse_name:_0x4e939a,date:_0x23555c,prod_name:_0x173987,level:_0x1aec19,isle:_0xe3349d,pallet:_0x5e6552,stock:_0x37b63d,types:_0x25ce37,adjust_qty:_0xe9638,new_adjust_qty:_0x57cb56,note:_0x2a79fd,Room_name:_0x126704,invoice:_0x4abe84,JO_number:_0x1bafba,expiry_date:_0x3c956d}=_0x5236cf[_0x29f7c7(0x128)];if(typeof _0x173987=='string')var _0x5d7772=[_0x5236cf['body'][_0x29f7c7(0xf3)]],_0x1e39c1=[_0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0xf0)]],_0x49826f=[_0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x96)]],_0x2f0eeb=[_0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x157)]],_0x5f4d77=[_0x5236cf[_0x29f7c7(0x128)]['New_Qty_Converted_adj']],_0x197bf9=[_0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x91)]],_0x3455b5=[_0x5236cf['body'][_0x29f7c7(0xb1)]],_0x5e7664=[_0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x9f)]],_0x34816c=[_0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x146)]],_0xc2282d=[_0x5236cf[_0x29f7c7(0x128)]['batch_code']],_0x5a5fde=[_0x5236cf[_0x29f7c7(0x128)]['expiry_date']],_0xb0338a=[_0x5236cf[_0x29f7c7(0x128)]['max_per_unit']],_0x14a48f=[_0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x114)]],_0x3ba672=[_0x5236cf['body'][_0x29f7c7(0x147)]],_0x5c4bf9=[_0x5236cf[_0x29f7c7(0x128)]['Rooms']],_0x502530=[_0x5236cf['body'][_0x29f7c7(0x120)]],_0x518775=[_0x5236cf[_0x29f7c7(0x128)]['second1']],_0x3914ff=[_0x5236cf[_0x29f7c7(0x128)]['prod_invoice']],_0x5157dc=[_0x5236cf['body'][_0x29f7c7(0xdc)]];else var _0x5d7772=[..._0x5236cf[_0x29f7c7(0x128)]['prod_name']],_0x1e39c1=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0xf0)]],_0x49826f=[..._0x5236cf['body'][_0x29f7c7(0x96)]],_0x2f0eeb=[..._0x5236cf[_0x29f7c7(0x128)]['types']],_0x5f4d77=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0xce)]],_0x197bf9=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x91)]],_0x3455b5=[..._0x5236cf[_0x29f7c7(0x128)]['unit']],_0x5e7664=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x9f)]],_0x34816c=[..._0x5236cf['body'][_0x29f7c7(0x146)]],_0xc2282d=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0xf8)]],_0x5a5fde=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0xf7)]],_0xb0338a=[..._0x5236cf['body'][_0x29f7c7(0x158)]],_0x14a48f=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x114)]],_0x3ba672=[..._0x5236cf[_0x29f7c7(0x128)]['prod_cat']],_0x5c4bf9=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x139)]],_0x502530=[..._0x5236cf[_0x29f7c7(0x128)]['prime1']],_0x518775=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0x117)]],_0x3914ff=[..._0x5236cf['body']['prod_invoice']],_0x5157dc=[..._0x5236cf[_0x29f7c7(0x128)][_0x29f7c7(0xdc)]];const _0x10023e=_0x5d7772[_0x29f7c7(0x155)](_0x4e0220=>{return _0x4e0220={'product_name':_0x4e0220};});_0x1e39c1['forEach']((_0x3f03ed,_0x5b70c0)=>{_0x5c4bf9['forEach']((_0xea8e01,_0x32c4f5)=>{var _0x2d2123=a0_0x1e2a;if(_0xea8e01==_0x2d2123(0xe0)&&_0x5b70c0==_0x32c4f5){var _0xb16dc0=_0x3f03ed['slice'](0x3);_0x10023e[_0x5b70c0][_0x2d2123(0x95)]=_0x3f03ed[0x0],_0x10023e[_0x5b70c0][_0x2d2123(0xfd)]=_0x3f03ed[0x1],_0x10023e[_0x5b70c0]['bay']=0x0,_0x10023e[_0x5b70c0][_0x2d2123(0xd7)]=0x0,_0x10023e[_0x5b70c0]['type']=_0x2d2123(0xd6),_0x10023e[_0x5b70c0][_0x2d2123(0x140)]=_0xb16dc0;}else{if(_0xea8e01==_0x2d2123(0x14f)&&_0x5b70c0==_0x32c4f5){var _0xb16dc0=_0x3f03ed[_0x2d2123(0x121)](0x3);_0x10023e[_0x5b70c0][_0x2d2123(0x95)]=_0x3f03ed[0x0],_0x10023e[_0x5b70c0][_0x2d2123(0xfd)]=_0x3f03ed[0x1],_0x10023e[_0x5b70c0][_0x2d2123(0x15c)]=0x0,_0x10023e[_0x5b70c0][_0x2d2123(0xd7)]=0x0,_0x10023e[_0x5b70c0][_0x2d2123(0xdb)]=_0x2d2123(0xd6),_0x10023e[_0x5b70c0][_0x2d2123(0x140)]=_0x3f03ed[0x5];}else{if(_0x5b70c0==_0x32c4f5){var _0x170bde;if(_0x3f03ed[0x4]=='L')_0x170bde=_0x2d2123(0x94);else _0x3f03ed[0x4]=='F'&&(_0x170bde=_0x2d2123(0xd6));_0x10023e[_0x5b70c0]['storage']=_0x3f03ed[0x0],_0x10023e[_0x5b70c0][_0x2d2123(0xfd)]=_0x3f03ed[0x1],_0x10023e[_0x5b70c0][_0x2d2123(0x15c)]=_0x3f03ed[0x2],_0x10023e[_0x5b70c0][_0x2d2123(0xd7)]=_0x3f03ed[0x3],_0x10023e[_0x5b70c0][_0x2d2123(0xdb)]=_0x170bde,_0x10023e[_0x5b70c0][_0x2d2123(0x140)]=_0x3f03ed[0x5];}}}});}),_0x49826f[_0x29f7c7(0x163)]((_0x24c6a8,_0x289f71)=>{var _0x5b6c64=_0x29f7c7;_0x10023e[_0x289f71][_0x5b6c64(0x14a)]=_0x24c6a8;}),_0x5157dc[_0x29f7c7(0x163)]((_0x5385eb,_0x3053f2)=>{var _0x1e0f56=_0x29f7c7;_0x10023e[_0x3053f2][_0x1e0f56(0x98)]=_0x5385eb;}),_0x2f0eeb['forEach']((_0x2a4422,_0x4822d7)=>{_0x10023e[_0x4822d7]['types']=_0x2a4422;}),_0x5f4d77[_0x29f7c7(0x163)]((_0x222678,_0xa5a4d0)=>{var _0x22540f=_0x29f7c7;_0x10023e[_0xa5a4d0][_0x22540f(0x151)]=_0x222678;}),_0x197bf9[_0x29f7c7(0x163)]((_0x2ccebc,_0x1a7452)=>{var _0x2037e0=_0x29f7c7;_0x10023e[_0x1a7452][_0x2037e0(0xb5)]=_0x2ccebc;}),_0x3455b5[_0x29f7c7(0x163)]((_0x1b1f3d,_0x1003c0)=>{var _0x34be4a=_0x29f7c7;_0x10023e[_0x1003c0][_0x34be4a(0xbc)]=_0x1b1f3d;}),_0x5e7664['forEach']((_0x5df4ba,_0x4fba96)=>{var _0x488fbf=_0x29f7c7;_0x10023e[_0x4fba96][_0x488fbf(0x152)]=_0x5df4ba;}),_0x34816c['forEach']((_0x42a06f,_0xf0023f)=>{_0x10023e[_0xf0023f]['product_code']=_0x42a06f;}),_0xc2282d[_0x29f7c7(0x163)]((_0x4df978,_0x181ee2)=>{_0x10023e[_0x181ee2]['batch_code']=_0x4df978;}),_0x5a5fde[_0x29f7c7(0x163)]((_0x1641a8,_0x1af8c9)=>{var _0x46b7dd=_0x29f7c7;_0x10023e[_0x1af8c9][_0x46b7dd(0xf7)]=_0x1641a8;}),_0xb0338a[_0x29f7c7(0x163)]((_0x289f46,_0x31b44a)=>{_0x10023e[_0x31b44a]['maxperunit']=_0x289f46;}),_0x14a48f['forEach']((_0x16521a,_0x152e18)=>{var _0x1b738d=_0x29f7c7;_0x10023e[_0x152e18][_0x1b738d(0x114)]=_0x16521a;}),_0x3ba672[_0x29f7c7(0x163)]((_0x4e35d1,_0x2a2bfe)=>{_0x10023e[_0x2a2bfe]['prod_cat']=_0x4e35d1;}),_0x5c4bf9['forEach']((_0x2c58df,_0x5ed422)=>{var _0x55560e=_0x29f7c7;_0x10023e[_0x5ed422][_0x55560e(0x161)]=_0x2c58df;}),_0x502530[_0x29f7c7(0x163)]((_0x355e64,_0x16bd68)=>{var _0x2bcd74=_0x29f7c7;_0x10023e[_0x16bd68][_0x2bcd74(0x10f)]=_0x355e64;}),_0x518775['forEach']((_0x558fa8,_0x232304)=>{var _0x5895f3=_0x29f7c7;_0x10023e[_0x232304][_0x5895f3(0x10e)]=_0x558fa8;}),_0x3914ff[_0x29f7c7(0x163)]((_0x58f348,_0x544725)=>{_0x10023e[_0x544725]['invoice']=_0x58f348;});const _0x57fda2=_0x10023e[_0x29f7c7(0xe7)](_0x4e3bc5=>_0x4e3bc5[_0x29f7c7(0x151)]!=='0'&&_0x4e3bc5[_0x29f7c7(0x151)]!=='');var _0x1aaf82=0x0;_0x57fda2[_0x29f7c7(0x163)](_0x4694a6=>{var _0x183e87=_0x29f7c7;console[_0x183e87(0xbb)](_0x183e87(0x111),_0x4694a6),parseInt(_0x4694a6['adjust_qty'])<=0x0&&_0x1aaf82++;});if(_0x1aaf82!=0x0)return _0x5236cf[_0x29f7c7(0x104)]('errors',_0x29f7c7(0x154)),_0x3dd5ce['redirect'](_0x29f7c7(0x131));const _0xaeb7d3=new adjustment({'warehouse_name':_0x4e939a,'date':_0x23555c,'product':_0x57fda2,'note':_0x2a79fd,'room':_0x126704,'invoice':_0x4abe84,'JO_number':_0x1bafba,'expiry_date':_0x3c956d}),_0x281da9=await _0xaeb7d3[_0x29f7c7(0x107)]();_0x5236cf[_0x29f7c7(0x104)]('success',_0x29f7c7(0x16b)),_0x3dd5ce[_0x29f7c7(0xe4)](_0x29f7c7(0x138)+_0x281da9['_id']);}catch(_0x4f7641){console['log'](_0x4f7641),_0x3dd5ce[_0x29f7c7(0xe5)](0xc8)[_0x29f7c7(0x12a)]({'message':_0x4f7641[_0x29f7c7(0xe1)]});}}),router[a0_0x36d48c(0x143)](a0_0x36d48c(0x10a),auth,async(_0x265b2d,_0x476a78)=>{var _0x30f3ed=a0_0x36d48c;try{const {username:_0x43c64e,email:_0x59bb54,role:_0x489f99}=_0x265b2d['user'],_0x50f03f=_0x265b2d['user'],_0x1a2962=await profile[_0x30f3ed(0xe9)]({'email':_0x50f03f[_0x30f3ed(0x9d)]}),_0x2086bb=await master_shop[_0x30f3ed(0xd1)](),_0x283c61=_0x265b2d[_0x30f3ed(0x129)]['id'],_0x21de59=await adjustment[_0x30f3ed(0x92)]({'_id':_0x283c61}),_0x203d68=await purchases[_0x30f3ed(0x112)]([{'$match':{'warehouse_name':_0x21de59[_0x30f3ed(0xdf)]}},{'$unwind':_0x30f3ed(0x11d)},{'$group':{'_id':_0x30f3ed(0xfb)}}]),_0x4522d7=await product['find']({}),_0x376923=await warehouse[_0x30f3ed(0x112)]([{'$match':{'name':_0x21de59[_0x30f3ed(0xdf)]}},{'$unwind':_0x30f3ed(0x123)},{'$group':{'_id':_0x30f3ed(0x162),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x30f3ed(0xcc)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x30f3ed(0x108)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x30f3ed(0x11c)},'primary_code':{'$first':_0x30f3ed(0xda)},'secondary_code':{'$first':_0x30f3ed(0x15b)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x30f3ed(0xef)},'rack':{'$first':_0x30f3ed(0x13b)},'maxPerUnit':{'$first':_0x30f3ed(0x9a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x30f3ed(0x133)},'batch_code':{'$first':_0x30f3ed(0x16f)},'room':{'$first':_0x30f3ed(0xa0)}}}]);if(_0x2086bb[0x0][_0x30f3ed(0xae)]==_0x30f3ed(0xdd)){var _0x419fd1=users['English'];console[_0x30f3ed(0xbb)](_0x419fd1);}else{if(_0x2086bb[0x0][_0x30f3ed(0xae)]==_0x30f3ed(0xaf))var _0x419fd1=users['Hindi'];else{if(_0x2086bb[0x0][_0x30f3ed(0xae)]==_0x30f3ed(0xee))var _0x419fd1=users[_0x30f3ed(0xee)];else{if(_0x2086bb[0x0]['language']==_0x30f3ed(0xd8))var _0x419fd1=users[_0x30f3ed(0xd8)];else{if(_0x2086bb[0x0][_0x30f3ed(0xae)]==_0x30f3ed(0x12d))var _0x419fd1=users[_0x30f3ed(0x12d)];else{if(_0x2086bb[0x0]['language']=='Portuguese\x20(BR)')var _0x419fd1=users['Portuguese'];else{if(_0x2086bb[0x0]['language']==_0x30f3ed(0x11e))var _0x419fd1=users[_0x30f3ed(0x11e)];else{if(_0x2086bb[0x0][_0x30f3ed(0xae)]==_0x30f3ed(0xbf))var _0x419fd1=users[_0x30f3ed(0xc8)];}}}}}}}_0x476a78[_0x30f3ed(0xc3)](_0x30f3ed(0x142),{'success':_0x265b2d[_0x30f3ed(0x104)](_0x30f3ed(0x153)),'errors':_0x265b2d[_0x30f3ed(0x104)](_0x30f3ed(0xfc)),'role':_0x50f03f,'profile':_0x1a2962,'adjustment':_0x21de59,'stock':_0x376923,'master_shop':_0x2086bb,'warehouse_name':_0x203d68,'unit':_0x4522d7,'language':_0x419fd1});}catch(_0x25daaf){console[_0x30f3ed(0xbb)](_0x25daaf),_0x476a78[_0x30f3ed(0xe5)](0xc8)[_0x30f3ed(0x12a)]({'message':_0x25daaf[_0x30f3ed(0xe1)]});}}),router['post'](a0_0x36d48c(0x10a),auth,async(_0x2ce2c1,_0x4f4830)=>{var _0x4edef2=a0_0x36d48c;try{const _0x439935=_0x2ce2c1[_0x4edef2(0x129)]['id'],{warehouse_name:_0x53909e,Room_name:_0x452ecc}=_0x2ce2c1[_0x4edef2(0x128)],_0x3ec73c=await adjustment['findById']({'_id':_0x439935}),_0x529899=_0x3ec73c[_0x4edef2(0xc9)][_0x4edef2(0x155)](async _0x1205ea=>{var _0x14bbfe=_0x4edef2;if(_0x1205ea[_0x14bbfe(0x151)]>0x0){var _0x1df59e=await warehouse[_0x14bbfe(0xe9)]({'name':_0x53909e,'room':_0x1205ea[_0x14bbfe(0x161)],'warehouse_category':_0x14bbfe(0xf2)});const _0x2ab87f=_0x1df59e[_0x14bbfe(0xfe)]['map'](_0x94d6f1=>{var _0x965691=_0x14bbfe;console[_0x965691(0xbb)](_0x1205ea[_0x965691(0x157)]+_0x965691(0xb7));if(_0x1205ea['types']==_0x965691(0xc7)){if(_0x94d6f1[_0x965691(0xd0)]==_0x1205ea[_0x965691(0xd0)]&&_0x94d6f1[_0x965691(0x140)]==_0x1205ea[_0x965691(0x140)]&&_0x94d6f1['type']==_0x1205ea[_0x965691(0xdb)]&&_0x94d6f1[_0x965691(0xd7)]==_0x1205ea['bin']&&_0x94d6f1['bay']==_0x1205ea[_0x965691(0x15c)]&&_0x94d6f1[_0x965691(0xfd)]==_0x1205ea[_0x965691(0xfd)]&&_0x94d6f1[_0x965691(0x95)]==_0x1205ea['storage']&&_0x94d6f1[_0x965691(0xf7)]==_0x1205ea[_0x965691(0xf7)]&&_0x94d6f1['batch_code']==_0x1205ea[_0x965691(0xf8)]&&_0x94d6f1['production_date']==_0x1205ea[_0x965691(0x114)]&&_0x94d6f1[_0x965691(0x160)]==_0x1205ea[_0x965691(0x160)]&&_0x94d6f1[_0x965691(0xb6)]==_0x1205ea[_0x965691(0x98)]){var _0x4397fa;_0x4397fa=_0x1205ea[_0x965691(0x151)],_0x1205ea[_0x965691(0x147)]=='S'&&(_0x4397fa=_0x1205ea[_0x965691(0x151)]),_0x94d6f1[_0x965691(0xba)]=_0x94d6f1['product_stock']-_0x4397fa;}}else{if(_0x94d6f1['product_name']==_0x1205ea[_0x965691(0xd0)]&&_0x94d6f1[_0x965691(0x140)]==_0x1205ea[_0x965691(0x140)]&&_0x94d6f1['type']==_0x1205ea[_0x965691(0xdb)]&&_0x94d6f1[_0x965691(0xd7)]==_0x1205ea[_0x965691(0xd7)]&&_0x94d6f1[_0x965691(0x15c)]==_0x1205ea['bay']&&_0x94d6f1[_0x965691(0xfd)]==_0x1205ea[_0x965691(0xfd)]&&_0x94d6f1[_0x965691(0x95)]==_0x1205ea[_0x965691(0x95)]&&_0x94d6f1[_0x965691(0xf7)]==_0x1205ea[_0x965691(0xf7)]&&_0x94d6f1[_0x965691(0xf8)]==_0x1205ea[_0x965691(0xf8)]&&_0x94d6f1[_0x965691(0x114)]==_0x1205ea[_0x965691(0x114)]&&_0x94d6f1[_0x965691(0x160)]==_0x1205ea[_0x965691(0x160)]&&_0x94d6f1['_id']==_0x1205ea[_0x965691(0x98)]){console[_0x965691(0xbb)](_0x1205ea);var _0x4397fa;_0x4397fa=_0x1205ea['adjust_qty'],_0x1205ea[_0x965691(0x147)]=='S'&&(_0x4397fa=_0x1205ea['adjust_qty']),_0x94d6f1[_0x965691(0xba)]=_0x94d6f1['product_stock']+_0x4397fa;}}});}return _0x1df59e;});Promise[_0x4edef2(0x14b)](_0x529899)[_0x4edef2(0x9c)](async _0x30b007=>{var _0x27bdc2=_0x4edef2;try{for(const _0xc5ea7 of _0x30b007){await _0xc5ea7[_0x27bdc2(0x107)]();}_0x3ec73c[_0x27bdc2(0x15d)]='True';const _0x16ae2b=await _0x3ec73c[_0x27bdc2(0x107)](),_0x558400=await master_shop[_0x27bdc2(0xd1)](),_0x1ebf16=await email_settings[_0x27bdc2(0xe9)](),_0x3c895c=await supervisor_settings[_0x27bdc2(0xd1)]();var _0x4e913c=_0x3ec73c[_0x27bdc2(0xc9)],_0x791eaa='',_0x4534df;for(_0x4534df in _0x4e913c){_0x791eaa+=_0x27bdc2(0xf6)+_0x27bdc2(0x13e)+_0x4e913c[_0x4534df]['product_name']+_0x27bdc2(0x122)+_0x27bdc2(0x13e)+_0x4e913c[_0x4534df]['product_code']+_0x27bdc2(0x122)+_0x27bdc2(0x13e)+_0x4e913c[_0x4534df][_0x27bdc2(0x151)]+_0x27bdc2(0x122)+_0x27bdc2(0x13e)+_0x4e913c[_0x4534df]['unit']+'</td>'+_0x27bdc2(0x13e)+_0x4e913c[_0x4534df][_0x27bdc2(0x152)]+_0x27bdc2(0x122)+_0x27bdc2(0x13e)+_0x3ec73c[_0x27bdc2(0xdf)]+_0x27bdc2(0x122)+_0x27bdc2(0x13e)+_0x4e913c[_0x4534df][_0x27bdc2(0x161)]+_0x27bdc2(0x122)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4e913c[_0x4534df][_0x27bdc2(0x95)]+_0x4e913c[_0x4534df]['rack']+_0x4e913c[_0x4534df][_0x27bdc2(0x15c)]+_0x4e913c[_0x4534df][_0x27bdc2(0xd7)]+_0x4e913c[_0x4534df]['type'][0x0]+_0x4e913c[_0x4534df][_0x27bdc2(0x140)]+'</td>',_0x27bdc2(0x10d);}let _0x4572bc=nodemailer[_0x27bdc2(0x170)]({'host':_0x1ebf16[_0x27bdc2(0x134)],'port':Number(_0x1ebf16['port']),'secure':![],'auth':{'user':_0x1ebf16[_0x27bdc2(0x9d)],'pass':_0x1ebf16[_0x27bdc2(0x124)]}}),_0x2f6ff5={'from':_0x1ebf16['email'],'to':_0x3c895c[0x0][_0x27bdc2(0xed)],'subject':_0x27bdc2(0x15e),'attachments':[{'filename':_0x27bdc2(0xcb),'path':__dirname+_0x27bdc2(0x14d)+_0x27bdc2(0xff)+_0x558400[0x0][_0x27bdc2(0x13d)],'cid':_0x27bdc2(0x16e)}],'html':'<!DOCTYPE\x20html>'+_0x27bdc2(0xf4)+_0x27bdc2(0x169)+_0x27bdc2(0x12b)+_0x27bdc2(0x13f)+_0x27bdc2(0x12b)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x27bdc2(0x12b)+_0x27bdc2(0xd3)+_0x558400[0x0][_0x27bdc2(0x14e)]+_0x27bdc2(0x13a)+_0x27bdc2(0x16a)+_0x27bdc2(0x16a)+_0x27bdc2(0x159)+_0x27bdc2(0x12b)+_0x27bdc2(0xa6)+_0x27bdc2(0xe2)+_0x3ec73c['invoice']+'\x20'+_0x27bdc2(0x156)+_0x27bdc2(0x102)+_0x3ec73c[_0x27bdc2(0xfa)]+'\x20'+_0x27bdc2(0x125)+_0x27bdc2(0xa1)+_0x27bdc2(0x16a)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x27bdc2(0xa9)+_0x27bdc2(0xf6)+_0x27bdc2(0x16c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x27bdc2(0xb8)+_0x27bdc2(0x12f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x27bdc2(0x109)+_0x27bdc2(0xf1)+_0x27bdc2(0x10d)+_0x27bdc2(0x105)+_0x27bdc2(0xea)+'\x20'+_0x791eaa+'\x20'+_0x27bdc2(0x141)+_0x27bdc2(0xb3)+'<div>'+_0x27bdc2(0xbd)+_0x27bdc2(0x11a)+_0x558400[0x0][_0x27bdc2(0x14e)]+_0x27bdc2(0xa1)+_0x27bdc2(0x16a)+_0x27bdc2(0x16a)+_0x27bdc2(0xa3)};_0x4572bc[_0x27bdc2(0x13c)](_0x2f6ff5,function(_0x142207,_0x4c41df){var _0x39f324=_0x27bdc2;_0x142207?(console['log'](_0x142207),console['log'](_0x39f324(0x171))):console[_0x39f324(0xbb)](_0x39f324(0xa2));}),_0x2ce2c1[_0x27bdc2(0x104)](_0x27bdc2(0x153),_0x27bdc2(0x116)),_0x4f4830['redirect'](_0x27bdc2(0xbe)+_0x16ae2b[_0x27bdc2(0xb6)]);}catch(_0x3ccb9e){console['error'](_0x3ccb9e),_0x4f4830[_0x27bdc2(0xe5)](0x1f4)[_0x27bdc2(0x12a)]({'error':_0x27bdc2(0x9e)});}})[_0x4edef2(0x135)](_0x2f350c=>{var _0x58d0c5=_0x4edef2;console[_0x58d0c5(0xb0)](_0x2f350c),_0x4f4830[_0x58d0c5(0xe5)](0x1f4)['json']({'error':_0x58d0c5(0x132)});});}catch(_0x15df9f){console[_0x4edef2(0xbb)](_0x15df9f),_0x4f4830[_0x4edef2(0xe5)](0xc8)['json']({'message':_0x15df9f[_0x4edef2(0xe1)]});}}),router[a0_0x36d48c(0x143)](a0_0x36d48c(0xa4),auth,async(_0x29f3d3,_0x1b5ca5)=>{var _0x5db828=a0_0x36d48c;try{const {username:_0x1e0a12,email:_0x1976d6,role:_0x20ef7c}=_0x29f3d3[_0x5db828(0x15f)],_0x41d461=_0x29f3d3[_0x5db828(0x15f)],_0x305e79=await profile[_0x5db828(0xe9)]({'email':_0x41d461[_0x5db828(0x9d)]}),_0x575c60=await master_shop[_0x5db828(0xd1)](),_0x2ebbc5=_0x29f3d3[_0x5db828(0x129)]['id'],_0xe34b7f=await adjustment[_0x5db828(0x92)]({'_id':_0x2ebbc5}),_0x338da6=await purchases[_0x5db828(0x112)]([{'$match':{'warehouse_name':_0xe34b7f[_0x5db828(0xdf)]}},{'$unwind':_0x5db828(0x11d)},{'$group':{'_id':_0x5db828(0xfb)}}]),_0x578c04=await product[_0x5db828(0xd1)]({}),_0x3f24cd=await warehouse[_0x5db828(0x112)]([{'$match':{'name':_0xe34b7f[_0x5db828(0xdf)]}},{'$unwind':_0x5db828(0x123)},{'$group':{'_id':_0x5db828(0x162),'name':{'$first':_0x5db828(0x127)},'product_stock':{'$first':_0x5db828(0xcc)},'bay':{'$first':_0x5db828(0xc6)},'bin':{'$first':_0x5db828(0x108)},'type':{'$first':_0x5db828(0xec)},'floorlevel':{'$first':_0x5db828(0x11c)},'primary_code':{'$first':_0x5db828(0xda)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5db828(0x99)},'storage':{'$first':_0x5db828(0xef)},'rack':{'$first':_0x5db828(0x13b)},'maxPerUnit':{'$first':_0x5db828(0x9a)},'expiry_date':{'$first':_0x5db828(0xf9)},'production_date':{'$first':_0x5db828(0x133)},'batch_code':{'$first':_0x5db828(0x16f)},'room':{'$first':'$room'}}}]);let _0x200658;if(_0x41d461[_0x5db828(0x164)]==_0x5db828(0xb2)){const _0x9502c5=await staff[_0x5db828(0xe9)]({'email':_0x41d461[_0x5db828(0x9d)]});_0x200658=await warehouse[_0x5db828(0x112)]([{'$match':{'status':_0x5db828(0x166),'name':_0x9502c5[_0x5db828(0x149)],'warehouse_category':_0x5db828(0xf2),'name':{'$ne':_0x5db828(0xb9)}}},{'$group':{'_id':_0x5db828(0xa8),'name':{'$first':_0x5db828(0xa8)}}}]);}else _0x200658=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x5db828(0xf2),'name':{'$ne':_0x5db828(0xb9)}}},{'$group':{'_id':_0x5db828(0xa8),'name':{'$first':_0x5db828(0xa8)}}}]);if(_0x575c60[0x0][_0x5db828(0xae)]==_0x5db828(0xdd)){var _0x221174=users[_0x5db828(0x97)];console[_0x5db828(0xbb)](_0x221174);}else{if(_0x575c60[0x0][_0x5db828(0xae)]==_0x5db828(0xaf))var _0x221174=users[_0x5db828(0xaf)];else{if(_0x575c60[0x0][_0x5db828(0xae)]==_0x5db828(0xee))var _0x221174=users[_0x5db828(0xee)];else{if(_0x575c60[0x0][_0x5db828(0xae)]==_0x5db828(0xd8))var _0x221174=users[_0x5db828(0xd8)];else{if(_0x575c60[0x0][_0x5db828(0xae)]==_0x5db828(0x12d))var _0x221174=users[_0x5db828(0x12d)];else{if(_0x575c60[0x0]['language']=='Portuguese\x20(BR)')var _0x221174=users[_0x5db828(0xa7)];else{if(_0x575c60[0x0]['language']==_0x5db828(0x11e))var _0x221174=users['Chinese'];else{if(_0x575c60[0x0][_0x5db828(0xae)]==_0x5db828(0xbf))var _0x221174=users[_0x5db828(0xc8)];}}}}}}}_0x1b5ca5[_0x5db828(0xc3)](_0x5db828(0x103),{'success':_0x29f3d3[_0x5db828(0x104)]('success'),'errors':_0x29f3d3[_0x5db828(0x104)](_0x5db828(0xfc)),'role':_0x41d461,'profile':_0x305e79,'adjustment':_0xe34b7f,'stock':_0x3f24cd,'master_shop':_0x575c60,'warehouse_name':_0x338da6,'unit':_0x578c04,'language':_0x221174,'warehouse':_0x200658});}catch(_0x179a80){console[_0x5db828(0xbb)](_0x179a80),_0x1b5ca5[_0x5db828(0xe5)](0xc8)['json']({'message':_0x179a80[_0x5db828(0xe1)]});}}),router[a0_0x36d48c(0x145)]('/view/:id',auth,async(_0x11a9fa,_0x87f873)=>{var _0x212737=a0_0x36d48c;try{const _0x4f9605=_0x11a9fa[_0x212737(0x129)]['id'],_0x2e29e5=await adjustment['findById']({'_id':_0x4f9605}),_0x2b1b0d=await warehouse[_0x212737(0xe9)]({'name':_0x2e29e5[_0x212737(0xdf)],'room':_0x2e29e5[_0x212737(0xc0)]}),{warehouse_name:_0x2a0923,date:_0x4afb12,prod_name:_0x15960f,level:_0x3583d4,isle:_0x17d5b9,pallet:_0x3d1fd0,stock:_0x4f4ed6,types:_0x3507fc,adjust_qty:_0x328794,new_adjust_qty:_0x5a4d7f,note:_0x2bba07,Room_name:_0x5ba025,invoice:_0x712d28,JO_number:_0x1764a9,expiry_date:_0x54c3cd}=_0x11a9fa[_0x212737(0x128)];if(typeof _0x15960f==_0x212737(0xb4))var _0x55aa02=[_0x11a9fa[_0x212737(0x128)]['prod_name']],_0x38571a=[_0x11a9fa[_0x212737(0x128)][_0x212737(0xf0)]],_0x28e8db=[_0x11a9fa[_0x212737(0x128)][_0x212737(0x96)]],_0x193c2b=[_0x11a9fa[_0x212737(0x128)]['types']],_0x4b4e5a=[_0x11a9fa[_0x212737(0x128)][_0x212737(0xce)]],_0x2771ce=[_0x11a9fa['body']['New_Qty_Converted']],_0x36bf88=[_0x11a9fa[_0x212737(0x128)][_0x212737(0xb1)]],_0x455b41=[_0x11a9fa[_0x212737(0x128)][_0x212737(0x9f)]],_0x4e1614=[_0x11a9fa[_0x212737(0x128)][_0x212737(0x146)]],_0x3137b4=[_0x11a9fa['body']['batch_code']],_0x3c167b=[_0x11a9fa[_0x212737(0x128)][_0x212737(0xf7)]],_0x150642=[_0x11a9fa[_0x212737(0x128)]['max_per_unit']],_0x2ef4c8=[_0x11a9fa['body'][_0x212737(0x114)]],_0x4468f3=[_0x11a9fa['body'][_0x212737(0x147)]],_0x3bc4af=[_0x11a9fa['body']['Rooms']],_0x3bc5c7=[_0x11a9fa[_0x212737(0x128)][_0x212737(0x120)]],_0x329f99=[_0x11a9fa[_0x212737(0x128)][_0x212737(0x117)]];else var _0x55aa02=[..._0x11a9fa[_0x212737(0x128)][_0x212737(0xf3)]],_0x38571a=[..._0x11a9fa[_0x212737(0x128)][_0x212737(0xf0)]],_0x28e8db=[..._0x11a9fa[_0x212737(0x128)][_0x212737(0x96)]],_0x193c2b=[..._0x11a9fa[_0x212737(0x128)]['types']],_0x4b4e5a=[..._0x11a9fa['body'][_0x212737(0xce)]],_0x2771ce=[..._0x11a9fa[_0x212737(0x128)][_0x212737(0x91)]],_0x36bf88=[..._0x11a9fa['body'][_0x212737(0xbc)]],_0x455b41=[..._0x11a9fa[_0x212737(0x128)]['Secondary_units']],_0x4e1614=[..._0x11a9fa[_0x212737(0x128)][_0x212737(0x146)]],_0x3137b4=[..._0x11a9fa[_0x212737(0x128)][_0x212737(0xf8)]],_0x3c167b=[..._0x11a9fa['body'][_0x212737(0xf7)]],_0x150642=[..._0x11a9fa['body'][_0x212737(0x158)]],_0x2ef4c8=[..._0x11a9fa['body'][_0x212737(0x114)]],_0x4468f3=[..._0x11a9fa[_0x212737(0x128)][_0x212737(0x147)]],_0x3bc4af=[..._0x11a9fa[_0x212737(0x128)]['Rooms']],_0x3bc5c7=[..._0x11a9fa[_0x212737(0x128)][_0x212737(0x120)]],_0x329f99=[..._0x11a9fa['body'][_0x212737(0x117)]];const _0x13faa1=_0x55aa02[_0x212737(0x155)](_0x2d1eee=>{return _0x2d1eee={'product_name':_0x2d1eee};});_0x38571a[_0x212737(0x163)]((_0x1cbe6a,_0x3ddef3)=>{_0x3bc4af['forEach']((_0xde94fc,_0x1b448c)=>{var _0x5b1279=a0_0x1e2a;if(_0xde94fc==_0x5b1279(0xe0)&&_0x3ddef3==_0x1b448c){var _0x1764c9=_0x1cbe6a[_0x5b1279(0x121)](0x3);_0x13faa1[_0x3ddef3][_0x5b1279(0x95)]=_0x1cbe6a[0x0],_0x13faa1[_0x3ddef3][_0x5b1279(0xfd)]=_0x1cbe6a[0x1],_0x13faa1[_0x3ddef3][_0x5b1279(0x15c)]=0x0,_0x13faa1[_0x3ddef3][_0x5b1279(0xd7)]=0x0,_0x13faa1[_0x3ddef3][_0x5b1279(0xdb)]='Floor',_0x13faa1[_0x3ddef3][_0x5b1279(0x140)]=_0x1764c9;}else{if(_0xde94fc==_0x5b1279(0x14f)&&_0x3ddef3==_0x1b448c){var _0x1764c9=_0x1cbe6a[_0x5b1279(0x121)](0x3);_0x13faa1[_0x3ddef3]['storage']=_0x1cbe6a[0x0],_0x13faa1[_0x3ddef3][_0x5b1279(0xfd)]=_0x1cbe6a[0x1],_0x13faa1[_0x3ddef3][_0x5b1279(0x15c)]=0x0,_0x13faa1[_0x3ddef3][_0x5b1279(0xd7)]=0x0,_0x13faa1[_0x3ddef3][_0x5b1279(0xdb)]=_0x5b1279(0xd6),_0x13faa1[_0x3ddef3][_0x5b1279(0x140)]=_0x1cbe6a[0x5];}else{if(_0x3ddef3==_0x1b448c){var _0x55162b;if(_0x1cbe6a[0x4]=='L')_0x55162b='Level';else _0x1cbe6a[0x4]=='F'&&(_0x55162b=_0x5b1279(0xd6));_0x13faa1[_0x3ddef3][_0x5b1279(0x95)]=_0x1cbe6a[0x0],_0x13faa1[_0x3ddef3][_0x5b1279(0xfd)]=_0x1cbe6a[0x1],_0x13faa1[_0x3ddef3]['bay']=_0x1cbe6a[0x2],_0x13faa1[_0x3ddef3]['bin']=_0x1cbe6a[0x3],_0x13faa1[_0x3ddef3][_0x5b1279(0xdb)]=_0x55162b,_0x13faa1[_0x3ddef3][_0x5b1279(0x140)]=_0x1cbe6a[0x5];}}}});}),_0x28e8db[_0x212737(0x163)]((_0x3d85f6,_0x310cc5)=>{var _0x560f23=_0x212737;_0x13faa1[_0x310cc5][_0x560f23(0x14a)]=_0x3d85f6;}),_0x193c2b[_0x212737(0x163)]((_0x4ef2f2,_0x186ca4)=>{var _0x5cb5f9=_0x212737;_0x13faa1[_0x186ca4][_0x5cb5f9(0x157)]=_0x4ef2f2;}),_0x4b4e5a[_0x212737(0x163)]((_0x421c72,_0x350598)=>{_0x13faa1[_0x350598]['adjust_qty']=_0x421c72;}),_0x2771ce['forEach']((_0x4d76dd,_0x11904a)=>{var _0x296823=_0x212737;_0x13faa1[_0x11904a][_0x296823(0xb5)]=_0x4d76dd;}),_0x36bf88[_0x212737(0x163)]((_0x204466,_0x3f3d56)=>{var _0x1ac8f0=_0x212737;_0x13faa1[_0x3f3d56][_0x1ac8f0(0xbc)]=_0x204466;}),_0x455b41['forEach']((_0x2d88b4,_0x4f270b)=>{var _0x399edd=_0x212737;_0x13faa1[_0x4f270b][_0x399edd(0x152)]=_0x2d88b4;}),_0x4e1614['forEach']((_0x47f48b,_0x9040cd)=>{var _0x3638c0=_0x212737;_0x13faa1[_0x9040cd][_0x3638c0(0xde)]=_0x47f48b;}),_0x3137b4['forEach']((_0x1f01d1,_0x479d5c)=>{var _0x110e60=_0x212737;_0x13faa1[_0x479d5c][_0x110e60(0xf8)]=_0x1f01d1;}),_0x3c167b[_0x212737(0x163)]((_0x2ae09d,_0x2acbf6)=>{_0x13faa1[_0x2acbf6]['expiry_date']=_0x2ae09d;}),_0x150642[_0x212737(0x163)]((_0x3babe1,_0x286791)=>{var _0x43de8a=_0x212737;_0x13faa1[_0x286791][_0x43de8a(0x11f)]=_0x3babe1;}),_0x2ef4c8[_0x212737(0x163)]((_0xe1bae8,_0x133fb2)=>{var _0x5605e1=_0x212737;_0x13faa1[_0x133fb2][_0x5605e1(0x114)]=_0xe1bae8;}),_0x4468f3[_0x212737(0x163)]((_0x533cde,_0x5da3e2)=>{var _0x2cb71d=_0x212737;_0x13faa1[_0x5da3e2][_0x2cb71d(0x147)]=_0x533cde;}),_0x3bc4af[_0x212737(0x163)]((_0x134e15,_0x249339)=>{_0x13faa1[_0x249339]['room_names']=_0x134e15;}),_0x3bc5c7[_0x212737(0x163)]((_0x2c8aaa,_0x3935df)=>{_0x13faa1[_0x3935df]['primary_code']=_0x2c8aaa;}),_0x329f99[_0x212737(0x163)]((_0x15051d,_0x1802b9)=>{_0x13faa1[_0x1802b9]['secondary_code']=_0x15051d;});const _0x458c80=_0x13faa1[_0x212737(0xe7)](_0x3bd0e9=>_0x3bd0e9['adjust_qty']!=='0'&&_0x3bd0e9[_0x212737(0x151)]!=='');var _0x42cd18=0x0;_0x458c80[_0x212737(0x163)](_0x5514bd=>{var _0x2931e1=_0x212737;console[_0x2931e1(0xbb)](_0x2931e1(0x111),_0x5514bd),parseInt(_0x5514bd[_0x2931e1(0x151)])<=0x0&&_0x42cd18++;});if(_0x42cd18!=0x0)return _0x11a9fa['flash'](_0x212737(0xfc),_0x212737(0x154)),_0x87f873[_0x212737(0xe4)](_0x212737(0x131));_0x2e29e5[_0x212737(0xdf)]=_0x2a0923,_0x2e29e5[_0x212737(0xfa)]=_0x4afb12,_0x2e29e5[_0x212737(0xc9)]=_0x458c80,_0x2e29e5['note']=_0x2bba07,_0x2e29e5[_0x212737(0x160)]=_0x712d28,_0x2e29e5['isAllowEdit']=_0x212737(0x14c);const _0x4673b5=await _0x2e29e5[_0x212737(0x107)]();_0x11a9fa[_0x212737(0x104)](_0x212737(0x153),_0x212737(0x10b)),_0x87f873['redirect'](_0x212737(0x113));}catch(_0x3223e0){console[_0x212737(0xbb)](_0x3223e0);}}),router['post'](a0_0x36d48c(0x167),async(_0x3413c3,_0x2ebea0)=>{var _0x2e1234=a0_0x36d48c;const {primary_code:_0x40f14b,warehouse_data:_0x363c88,rooms_data:_0x48f55e,Roomslist:_0x1d1156}=_0x3413c3[_0x2e1234(0x128)],_0x16a7f2=_0x1d1156[_0x2e1234(0xc5)](','),_0x35f778=[];async function _0xae7b68(_0xe224b7){var _0x3fc81b=_0x2e1234;const _0x263466=await warehouse[_0x3fc81b(0x112)]([{'$match':{'name':_0x363c88,'room':_0xe224b7}},{'$unwind':_0x3fc81b(0x123)},{'$match':{'product_details.primary_code':_0x40f14b}},{'$group':{'_id':_0x3fc81b(0x162),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3fc81b(0xcc)},'primary_code':{'$first':_0x3fc81b(0xda)},'secondary_code':{'$first':_0x3fc81b(0x15b)},'product_code':{'$first':_0x3fc81b(0x99)},'level':{'$first':_0x3fc81b(0xc6)},'isle':{'$first':_0x3fc81b(0x108)},'type':{'$first':_0x3fc81b(0xec)},'pallet':{'$first':_0x3fc81b(0x11c)},'unit':{'$first':_0x3fc81b(0x137)},'secondary_unit':{'$first':_0x3fc81b(0x126)},'storage':{'$first':_0x3fc81b(0xef)},'rack':{'$first':_0x3fc81b(0x13b)},'expiry_date':{'$first':_0x3fc81b(0xf9)},'production_date':{'$first':_0x3fc81b(0x133)},'maxPerUnit':{'$first':_0x3fc81b(0x9a)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x3fc81b(0xd2)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3fc81b(0xa0)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x17cf81=await warehouse['aggregate']([{'$match':{'name':_0x363c88,'room':_0xe224b7}},{'$unwind':_0x3fc81b(0x123)},{'$match':{'product_details.secondary_code':_0x40f14b}},{'$group':{'_id':_0x3fc81b(0x162),'name':{'$first':_0x3fc81b(0x127)},'product_stock':{'$first':_0x3fc81b(0xcc)},'primary_code':{'$first':_0x3fc81b(0xda)},'secondary_code':{'$first':_0x3fc81b(0x15b)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3fc81b(0xc6)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3fc81b(0x11c)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x3fc81b(0x126)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3fc81b(0xf9)},'production_date':{'$first':_0x3fc81b(0x133)},'maxPerUnit':{'$first':_0x3fc81b(0x9a)},'batch_code':{'$first':_0x3fc81b(0x16f)},'product_cat':{'$first':_0x3fc81b(0xd2)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3fc81b(0xa0)}}}]);if(_0x263466[_0x3fc81b(0xe6)]>0x0)_0x35f778['push'](_0x263466);else _0x17cf81[_0x3fc81b(0xe6)]>0x0&&_0x35f778[_0x3fc81b(0xac)](_0x17cf81);}const _0x1aa26e=_0x16a7f2[_0x2e1234(0x155)](_0x73dc70=>_0xae7b68(_0x73dc70));await Promise['all'](_0x1aa26e),_0x2ebea0[_0x2e1234(0x12a)](_0x35f778);}),router[a0_0x36d48c(0x145)](a0_0x36d48c(0x12c),async(_0xe74205,_0x1b8568)=>{var _0x148f11=a0_0x36d48c;const {primaryCode:_0x4eb3d7,secondaryCode:_0x2fb3b6,productCode:_0x25a542,level:_0x4d678b,isle:_0x4681a8,pallet:_0x71d4e2,warehouses:_0x1adc0c,room:_0x3543c0}=_0xe74205[_0x148f11(0x128)];try{const _0x3804de=await warehouse['aggregate']([{'$match':{'name':_0x1adc0c,'room':_0x3543c0}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x4d678b),'product_details.isle':_0x4681a8,'product_details.pallet':parseInt(_0x71d4e2)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x148f11(0x127)},'product_stock':{'$first':_0x148f11(0xcc)},'level':{'$first':_0x148f11(0x16d)},'isle':{'$first':_0x148f11(0x165)},'pallet':{'$first':_0x148f11(0xd5)},'maxProducts':{'$first':_0x148f11(0xca)}}}]);_0x1b8568[_0x148f11(0xe5)](0xc8)[_0x148f11(0x12a)](_0x3804de);}catch(_0x583146){_0x1b8568['status'](0x194)['json']({'message':_0x583146[_0x148f11(0xe1)]});}}),module[a0_0x36d48c(0xcd)]=router;