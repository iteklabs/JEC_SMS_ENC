var a0_0x554c5e=a0_0x1814;(function(_0x58bfe1,_0x3b89c7){var _0x46222a=a0_0x1814,_0x29d383=_0x58bfe1();while(!![]){try{var _0x526f89=-parseInt(_0x46222a(0x1fe))/0x1+parseInt(_0x46222a(0x1c8))/0x2+parseInt(_0x46222a(0x1c3))/0x3*(parseInt(_0x46222a(0x1ff))/0x4)+parseInt(_0x46222a(0x245))/0x5+-parseInt(_0x46222a(0x1b3))/0x6+-parseInt(_0x46222a(0x23b))/0x7+parseInt(_0x46222a(0x1a9))/0x8*(parseInt(_0x46222a(0x198))/0x9);if(_0x526f89===_0x3b89c7)break;else _0x29d383['push'](_0x29d383['shift']());}catch(_0x356634){_0x29d383['push'](_0x29d383['shift']());}}}(a0_0x4040,0x24c56));const express=require('express'),app=express(),router=express[a0_0x554c5e(0x218)](),auth=require(a0_0x554c5e(0x1fa)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x554c5e(0x1fb)),users=require(a0_0x554c5e(0x1ed)),nodemailer=require(a0_0x554c5e(0x1de));function a0_0x4040(){var _0x2512fc=['$name','room_names','$product_details.production_date','</td>','Secondary_units','../middleware/auth','../models/all_models','Primary_Units','bin','235864bIgnKX','77908WsmGPa','</body></html>','flash','Arabic','<span\x20style=\x22float:\x20right;\x22>','/picking_list/PDF_adjustment_rm/','</tr>','Raw\x20Materials','product_name','params','success','save','adjustment\x20data\x20update\x20successfully','$finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Receiving\x20Area','catch','True','language','Chinese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','bay','\x20<>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','find','Router','body','German','$product_details.product_code','\x20</h2>','English\x20(US)','<h5>','id_transaction_from','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','get','id_transaction','$product_details.secondary_unit','Spanish','$product_details.batch_code','primary_code','/upload/','$product_details.product_cat','message','$product_details.secondary_code','/view','map','New_Qty_Converted_adj','Ambient','slice','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','aggregate','production_date','product_stock','stock','$product_details.pallet','Hindi','note','$product_details._id','$product_details.isle','Return\x20Rooms','1060045cyaasd','staff','</h5>','Arabic\x20(ae)','findOne','length','$product_details.floorlevel','$product_details.unit','Return\x20Goods','$product_details.product_stock','214230bzzzvP','foreach\x20newproduct','/view/add_adjustment','RMSEmail','rack','filter','string','</tbody>','edit_adjustment_view','prod_name','site_title','toString','English','<tr>','logo','add_adjustment','$product','$product_details.primary_code','unit','log','back','Level','password','$product.product_name','New_Qty_Converted','image','batch_code','secondary_code','warehouse_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$date','</div>','findById','27SCHEkh','$product_details.maxPerUnit','invoice','type','/preview/:id','<hr\x20class=\x22my-3\x22>','$invoice','$product_details.storage','then','user','Portuguese','prod_code','French','<!DOCTYPE\x20html>','Portuguese\x20(BR)','adjustment\x20add\x20successfull','ADJ-','1083112toDXxd','prod_cat','$product_details.bin','level','Shelves','errors','push','$product_details.type','max_per_unit','\x20Order\x20Number\x20:\x20','924600cDcnoB','isAllowEdit','adjust_qty','adjustment\x20Finalized\x20successfully','post','\x20Order\x20Date\x20:\x20','forEach','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','error','padStart','all','status','prime1','types','$product_details.expiry_date','$product_details.rack','12UgRPhk','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<div>','stockBefore','floorlevel','330184pfsPwF','new_adjust_qty','product','Enabled','$product_details.level','createTransport','/adjustment/view','json','/adjustment/preview/','$product.room_names','prod_invoice','$isAllowEdit','$room','$product_details','redirect','Error\x20Occurs','second1','$product_details.bay','Rooms','secondary_unit','/view/:id','False','nodemailer','date','Email\x20sent\x20successfully','role','Floor','email','expiry_date','warehouse','sendMail','port','exports','<table\x20style=\x22width:\x20100%\x20!important;\x22>','render','storage','</thead>','../public/language/languages.json','_id','minus','An\x20error\x20occurred.','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.product_name','/../public','product_code'];a0_0x4040=function(){return _0x2512fc;};return a0_0x4040();}router[a0_0x554c5e(0x221)](a0_0x554c5e(0x22b),auth,async(_0x616470,_0x2113dc)=>{var _0x3c2773=a0_0x554c5e;try{const {username:_0x40ecc9,email:_0x4ed239,role:_0x52a2eb}=_0x616470['user'],_0xd8316d=_0x616470['user'],_0x47ec41=await profile[_0x3c2773(0x23f)]({'email':_0xd8316d[_0x3c2773(0x1e3)]}),_0x3ac46a=await master_shop[_0x3c2773(0x217)]();console[_0x3c2773(0x18a)]('master',_0x3ac46a);let _0x5599e8;if(_0xd8316d[_0x3c2773(0x1e1)]==_0x3c2773(0x23c)){const _0x34fce6=await staff['findOne']({'email':_0xd8316d[_0x3c2773(0x1e3)]});_0x5599e8=await warehouse[_0x3c2773(0x217)]({'status':_0x3c2773(0x1cb),'name':_0x34fce6[_0x3c2773(0x1e5)]});}else _0x5599e8=await warehouse[_0x3c2773(0x217)]({'status':'Enabled'});const _0x48b2c7=await product[_0x3c2773(0x217)]();let _0x2d8727;if(_0xd8316d['role']==_0x3c2773(0x23c)){const _0x4e0b76=await staff[_0x3c2773(0x23f)]({'email':_0xd8316d[_0x3c2773(0x1e3)]});_0x2d8727=await adjustment['find']({'warehouse_name':_0x4e0b76[_0x3c2773(0x1e5)]});}else _0x2d8727=await adjustment[_0x3c2773(0x231)]([{'$unwind':_0x3c2773(0x187)},{'$group':{'_id':'$_id','invoice':{'$first':_0x3c2773(0x19e)},'date':{'$first':_0x3c2773(0x195)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x3c2773(0x1d1)},'finalize':{'$first':_0x3c2773(0x20c)},'isAllowEdit':{'$first':_0x3c2773(0x1d3)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3ac46a[0x0]['language']==_0x3c2773(0x21d)){var _0xc1aeb3=users[_0x3c2773(0x183)];console[_0x3c2773(0x18a)](_0xc1aeb3);}else{if(_0x3ac46a[0x0][_0x3c2773(0x211)]=='Hindi')var _0xc1aeb3=users[_0x3c2773(0x236)];else{if(_0x3ac46a[0x0][_0x3c2773(0x211)]==_0x3c2773(0x21a))var _0xc1aeb3=users[_0x3c2773(0x21a)];else{if(_0x3ac46a[0x0][_0x3c2773(0x211)]==_0x3c2773(0x224))var _0xc1aeb3=users[_0x3c2773(0x224)];else{if(_0x3ac46a[0x0][_0x3c2773(0x211)]==_0x3c2773(0x1a4))var _0xc1aeb3=users['French'];else{if(_0x3ac46a[0x0]['language']==_0x3c2773(0x1a6))var _0xc1aeb3=users['Portuguese'];else{if(_0x3ac46a[0x0]['language']==_0x3c2773(0x212))var _0xc1aeb3=users[_0x3c2773(0x212)];else{if(_0x3ac46a[0x0]['language']==_0x3c2773(0x23e))var _0xc1aeb3=users['Arabic'];}}}}}}}_0x2113dc[_0x3c2773(0x1ea)]('adjustment',{'success':_0x616470[_0x3c2773(0x201)](_0x3c2773(0x209)),'errors':_0x616470[_0x3c2773(0x201)](_0x3c2773(0x1ae)),'role':_0xd8316d,'profile':_0x47ec41,'warehouse':_0x5599e8,'product':_0x48b2c7,'adjustment':_0x2d8727,'master_shop':_0x3ac46a,'language':_0xc1aeb3});}catch(_0x59641e){console[_0x3c2773(0x18a)](_0x59641e);}});function a0_0x1814(_0x48f3e9,_0x4bf24d){var _0x40403f=a0_0x4040();return a0_0x1814=function(_0x18147b,_0xe29bc0){_0x18147b=_0x18147b-0x17a;var _0x572d24=_0x40403f[_0x18147b];return _0x572d24;},a0_0x1814(_0x48f3e9,_0x4bf24d);}async function getRandom8DigitNumber(){var _0x5b9a7f=a0_0x554c5e;const _0x542a0c=0x989680,_0x1d1dc6=0x5f5e0ff,_0x469228=Math['floor'](Math['random']()*(_0x1d1dc6-_0x542a0c+0x1))+_0x542a0c;var _0x5a91c4;const _0x48f0e1=await adjustment['findOne']({'invoice':_0x5b9a7f(0x1a8)+_0x469228});return _0x48f0e1&&_0x48f0e1[_0x5b9a7f(0x240)]>0x0?_0x5a91c4=_0x5b9a7f(0x1a8)+_0x469228:_0x5a91c4='ADJ-'+_0x469228,_0x5a91c4;}router[a0_0x554c5e(0x221)](a0_0x554c5e(0x247),auth,async(_0x1f1169,_0x3f9a37)=>{var _0x408cf0=a0_0x554c5e;try{const {username:_0x535170,email:_0x217a64,role:_0x267038}=_0x1f1169['user'],_0x22886f=_0x1f1169[_0x408cf0(0x1a1)],_0x2e9e69=await profile[_0x408cf0(0x23f)]({'email':_0x22886f[_0x408cf0(0x1e3)]}),_0x268d86=await master_shop[_0x408cf0(0x217)]();let _0x35ef6c;if(_0x22886f[_0x408cf0(0x1e1)]=='staff'){const _0x3d4543=await staff[_0x408cf0(0x23f)]({'email':_0x22886f['email']});_0x35ef6c=await warehouse[_0x408cf0(0x231)]([{'$match':{'status':_0x408cf0(0x1cb),'name':_0x3d4543[_0x408cf0(0x1e5)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x408cf0(0x243)}}},{'$group':{'_id':_0x408cf0(0x1f5),'name':{'$first':_0x408cf0(0x1f5)}}}]);}else _0x35ef6c=await warehouse['aggregate']([{'$match':{'status':_0x408cf0(0x1cb),'warehouse_category':_0x408cf0(0x206),'name':{'$ne':_0x408cf0(0x243)}}},{'$group':{'_id':_0x408cf0(0x1f5),'name':{'$first':_0x408cf0(0x1f5)}}}]);const _0x227dca=await product[_0x408cf0(0x217)]({}),_0x2c79e2=await adjustment['find']({}),_0x5a5347=_0x2c79e2[_0x408cf0(0x240)]+0x1,_0x28366e='ADJ-'+_0x5a5347[_0x408cf0(0x182)]()[_0x408cf0(0x1bc)](0x5,'0');var _0x21c6f2=[_0x408cf0(0x22e),'Enclosed',_0x408cf0(0x23a)];if(_0x268d86[0x0][_0x408cf0(0x211)]==_0x408cf0(0x21d))var _0x319287=users[_0x408cf0(0x183)];else{if(_0x268d86[0x0][_0x408cf0(0x211)]==_0x408cf0(0x236))var _0x319287=users[_0x408cf0(0x236)];else{if(_0x268d86[0x0][_0x408cf0(0x211)]==_0x408cf0(0x21a))var _0x319287=users[_0x408cf0(0x21a)];else{if(_0x268d86[0x0][_0x408cf0(0x211)]=='Spanish')var _0x319287=users[_0x408cf0(0x224)];else{if(_0x268d86[0x0][_0x408cf0(0x211)]==_0x408cf0(0x1a4))var _0x319287=users[_0x408cf0(0x1a4)];else{if(_0x268d86[0x0]['language']==_0x408cf0(0x1a6))var _0x319287=users[_0x408cf0(0x1a2)];else{if(_0x268d86[0x0][_0x408cf0(0x211)]=='Chinese')var _0x319287=users['Chinese'];else{if(_0x268d86[0x0][_0x408cf0(0x211)]=='Arabic\x20(ae)')var _0x319287=users[_0x408cf0(0x202)];}}}}}}}const _0x2b166b=getRandom8DigitNumber();_0x2b166b[_0x408cf0(0x1a0)](_0x2cbd39=>{var _0x5bec06=_0x408cf0;_0x3f9a37[_0x5bec06(0x1ea)](_0x5bec06(0x186),{'success':_0x1f1169[_0x5bec06(0x201)]('success'),'errors':_0x1f1169[_0x5bec06(0x201)](_0x5bec06(0x1ae)),'role':_0x22886f,'profile':_0x2e9e69,'warehouse':_0x35ef6c,'product':_0x227dca,'master_shop':_0x268d86,'language':_0x319287,'rooms_data':_0x21c6f2,'invoice_no':_0x2cbd39});})[_0x408cf0(0x20f)](_0x339fe3=>{var _0x1f50fc=_0x408cf0;_0x1f1169['flash']('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x3f9a37[_0x1f50fc(0x1d6)](_0x1f50fc(0x1ce));});}catch(_0x40c98b){console[_0x408cf0(0x18a)](_0x40c98b);}}),router[a0_0x554c5e(0x1b7)](a0_0x554c5e(0x247),auth,async(_0x151af7,_0x123527)=>{var _0x3e1270=a0_0x554c5e;try{const {warehouse_name:_0x220cd4,date:_0x10d2dd,prod_name:_0x308cd6,level:_0x1484c6,isle:_0x1bb03b,pallet:_0x22ef43,stock:_0x286db9,types:_0x157cac,adjust_qty:_0x52c9b3,new_adjust_qty:_0x5f4a04,note:_0x65415f,Room_name:_0x8bd7f9,invoice:_0x1d616d,JO_number:_0x44d7fb,expiry_date:_0x1e8a19}=_0x151af7['body'];if(typeof _0x308cd6=='string')var _0x4c13f2=[_0x151af7[_0x3e1270(0x219)]['prod_name']],_0x2a6661=[_0x151af7['body'][_0x3e1270(0x1ac)]],_0x5ecbe3=[_0x151af7['body'][_0x3e1270(0x234)]],_0xc42ec1=[_0x151af7['body'][_0x3e1270(0x1c0)]],_0x65bc36=[_0x151af7[_0x3e1270(0x219)][_0x3e1270(0x22d)]],_0x46c482=[_0x151af7[_0x3e1270(0x219)][_0x3e1270(0x18f)]],_0x2ab306=[_0x151af7[_0x3e1270(0x219)]['Primary_Units']],_0x518f75=[_0x151af7['body'][_0x3e1270(0x1f9)]],_0x2372f9=[_0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1a3)]],_0x446b4e=[_0x151af7[_0x3e1270(0x219)][_0x3e1270(0x191)]],_0x33b8cc=[_0x151af7['body'][_0x3e1270(0x1e4)]],_0x5b9d42=[_0x151af7[_0x3e1270(0x219)]['max_per_unit']],_0x25c4ac=[_0x151af7['body'][_0x3e1270(0x232)]],_0x21ea81=[_0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1aa)]],_0x72988f=[_0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1da)]],_0xbbe59b=[_0x151af7['body']['prime1']],_0xf60117=[_0x151af7['body'][_0x3e1270(0x1d8)]],_0x3643d7=[_0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1d2)]],_0x3ff07b=[_0x151af7[_0x3e1270(0x219)]['id_transaction']];else var _0x4c13f2=[..._0x151af7['body']['prod_name']],_0x2a6661=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1ac)]],_0x5ecbe3=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x234)]],_0xc42ec1=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1c0)]],_0x65bc36=[..._0x151af7[_0x3e1270(0x219)]['New_Qty_Converted_adj']],_0x46c482=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x18f)]],_0x2ab306=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x189)]],_0x518f75=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1f9)]],_0x2372f9=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1a3)]],_0x446b4e=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x191)]],_0x33b8cc=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1e4)]],_0x5b9d42=[..._0x151af7['body'][_0x3e1270(0x1b1)]],_0x25c4ac=[..._0x151af7['body'][_0x3e1270(0x232)]],_0x21ea81=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1aa)]],_0x72988f=[..._0x151af7['body']['Rooms']],_0xbbe59b=[..._0x151af7['body'][_0x3e1270(0x1bf)]],_0xf60117=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1d8)]],_0x3643d7=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x1d2)]],_0x3ff07b=[..._0x151af7[_0x3e1270(0x219)][_0x3e1270(0x222)]];const _0x34f3dd=_0x4c13f2['map'](_0x37cfb2=>{return _0x37cfb2={'product_name':_0x37cfb2};});_0x2a6661[_0x3e1270(0x1b9)]((_0x170f0e,_0x369d0d)=>{var _0x108c31=_0x3e1270;_0x72988f[_0x108c31(0x1b9)]((_0x261ff3,_0x46440e)=>{var _0x3e6272=_0x108c31;if(_0x261ff3=='Receiving\x20Area'&&_0x369d0d==_0x46440e){var _0x1833f1=_0x170f0e[_0x3e6272(0x22f)](0x3);_0x34f3dd[_0x369d0d][_0x3e6272(0x1eb)]=_0x170f0e[0x0],_0x34f3dd[_0x369d0d][_0x3e6272(0x17b)]=_0x170f0e[0x1],_0x34f3dd[_0x369d0d][_0x3e6272(0x214)]=0x0,_0x34f3dd[_0x369d0d][_0x3e6272(0x1fd)]=0x0,_0x34f3dd[_0x369d0d][_0x3e6272(0x19b)]=_0x3e6272(0x1e2),_0x34f3dd[_0x369d0d][_0x3e6272(0x1c7)]=_0x1833f1;}else{if(_0x261ff3==_0x3e6272(0x1ad)&&_0x369d0d==_0x46440e){var _0x1833f1=_0x170f0e[_0x3e6272(0x22f)](0x3);_0x34f3dd[_0x369d0d][_0x3e6272(0x1eb)]=_0x170f0e[0x0],_0x34f3dd[_0x369d0d][_0x3e6272(0x17b)]=_0x170f0e[0x1],_0x34f3dd[_0x369d0d][_0x3e6272(0x214)]=0x0,_0x34f3dd[_0x369d0d][_0x3e6272(0x1fd)]=0x0,_0x34f3dd[_0x369d0d]['type']='Floor',_0x34f3dd[_0x369d0d][_0x3e6272(0x1c7)]=_0x170f0e[0x5];}else{if(_0x369d0d==_0x46440e){var _0x1d0663;if(_0x170f0e[0x4]=='L')_0x1d0663=_0x3e6272(0x18c);else _0x170f0e[0x4]=='F'&&(_0x1d0663='Floor');_0x34f3dd[_0x369d0d][_0x3e6272(0x1eb)]=_0x170f0e[0x0],_0x34f3dd[_0x369d0d]['rack']=_0x170f0e[0x1],_0x34f3dd[_0x369d0d]['bay']=_0x170f0e[0x2],_0x34f3dd[_0x369d0d]['bin']=_0x170f0e[0x3],_0x34f3dd[_0x369d0d][_0x3e6272(0x19b)]=_0x1d0663,_0x34f3dd[_0x369d0d][_0x3e6272(0x1c7)]=_0x170f0e[0x5];}}}});}),_0x5ecbe3[_0x3e1270(0x1b9)]((_0x1f5f8c,_0x4434b6)=>{var _0x35094f=_0x3e1270;_0x34f3dd[_0x4434b6][_0x35094f(0x1c6)]=_0x1f5f8c;}),_0x3ff07b[_0x3e1270(0x1b9)]((_0x2ebee5,_0x5a86fb)=>{var _0x4db88d=_0x3e1270;_0x34f3dd[_0x5a86fb][_0x4db88d(0x21f)]=_0x2ebee5;}),_0xc42ec1['forEach']((_0x2c6716,_0x4bd3d0)=>{_0x34f3dd[_0x4bd3d0]['types']=_0x2c6716;}),_0x65bc36[_0x3e1270(0x1b9)]((_0x29d0d4,_0x3d6a69)=>{var _0x2e2cc0=_0x3e1270;_0x34f3dd[_0x3d6a69][_0x2e2cc0(0x1b5)]=_0x29d0d4;}),_0x46c482[_0x3e1270(0x1b9)]((_0x5a7621,_0x245b5e)=>{_0x34f3dd[_0x245b5e]['new_adjust_qty']=_0x5a7621;}),_0x2ab306[_0x3e1270(0x1b9)]((_0x5a8f5a,_0x558eef)=>{var _0x36b607=_0x3e1270;_0x34f3dd[_0x558eef][_0x36b607(0x189)]=_0x5a8f5a;}),_0x518f75[_0x3e1270(0x1b9)]((_0x3deb98,_0x4ebc23)=>{_0x34f3dd[_0x4ebc23]['secondary_unit']=_0x3deb98;}),_0x2372f9[_0x3e1270(0x1b9)]((_0x243cc4,_0x38599f)=>{var _0x153c81=_0x3e1270;_0x34f3dd[_0x38599f][_0x153c81(0x1f4)]=_0x243cc4;}),_0x446b4e[_0x3e1270(0x1b9)]((_0x3f9bc2,_0x3f7a19)=>{_0x34f3dd[_0x3f7a19]['batch_code']=_0x3f9bc2;}),_0x33b8cc[_0x3e1270(0x1b9)]((_0x59f4d1,_0x158447)=>{_0x34f3dd[_0x158447]['expiry_date']=_0x59f4d1;}),_0x5b9d42[_0x3e1270(0x1b9)]((_0x52e287,_0x5213af)=>{_0x34f3dd[_0x5213af]['maxperunit']=_0x52e287;}),_0x25c4ac['forEach']((_0x18e039,_0x399758)=>{var _0x4e14f2=_0x3e1270;_0x34f3dd[_0x399758][_0x4e14f2(0x232)]=_0x18e039;}),_0x21ea81[_0x3e1270(0x1b9)]((_0x1ecec1,_0x2d3cf3)=>{_0x34f3dd[_0x2d3cf3]['prod_cat']=_0x1ecec1;}),_0x72988f[_0x3e1270(0x1b9)]((_0x353725,_0x573024)=>{var _0x1b0c7a=_0x3e1270;_0x34f3dd[_0x573024][_0x1b0c7a(0x1f6)]=_0x353725;}),_0xbbe59b[_0x3e1270(0x1b9)]((_0x5b2d73,_0x3e3a50)=>{_0x34f3dd[_0x3e3a50]['primary_code']=_0x5b2d73;}),_0xf60117[_0x3e1270(0x1b9)]((_0x542265,_0x2d744e)=>{var _0x4647af=_0x3e1270;_0x34f3dd[_0x2d744e][_0x4647af(0x192)]=_0x542265;}),_0x3643d7[_0x3e1270(0x1b9)]((_0x34011e,_0xc9fab5)=>{var _0x39a122=_0x3e1270;_0x34f3dd[_0xc9fab5][_0x39a122(0x19a)]=_0x34011e;});const _0x4f2d2a=_0x34f3dd[_0x3e1270(0x17c)](_0xf7766f=>_0xf7766f[_0x3e1270(0x1b5)]!=='0'&&_0xf7766f[_0x3e1270(0x1b5)]!=='');var _0x577e16=0x0;_0x4f2d2a[_0x3e1270(0x1b9)](_0x2994b8=>{var _0x111473=_0x3e1270;console[_0x111473(0x18a)](_0x111473(0x246),_0x2994b8),parseInt(_0x2994b8[_0x111473(0x1b5)])<=0x0&&_0x577e16++;});if(_0x577e16!=0x0)return _0x151af7['flash'](_0x3e1270(0x1ae),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x123527[_0x3e1270(0x1d6)]('back');const _0x2f9607=new adjustment({'warehouse_name':_0x220cd4,'date':_0x10d2dd,'product':_0x4f2d2a,'note':_0x65415f,'room':_0x8bd7f9,'invoice':_0x1d616d,'JO_number':_0x44d7fb,'expiry_date':_0x1e8a19}),_0x3d2ea0=await _0x2f9607[_0x3e1270(0x20a)]();_0x151af7[_0x3e1270(0x201)](_0x3e1270(0x209),_0x3e1270(0x1a7)),_0x123527[_0x3e1270(0x1d6)](_0x3e1270(0x1d0)+_0x3d2ea0[_0x3e1270(0x1ee)]);}catch(_0x43902f){console['log'](_0x43902f),_0x123527[_0x3e1270(0x1be)](0xc8)[_0x3e1270(0x1cf)]({'message':_0x43902f['message']});}}),router[a0_0x554c5e(0x221)](a0_0x554c5e(0x19c),auth,async(_0x506901,_0x13f5d0)=>{var _0x2d7a1c=a0_0x554c5e;try{const {username:_0x4783a8,email:_0x4fc2db,role:_0x4f23f2}=_0x506901[_0x2d7a1c(0x1a1)],_0x3b76d4=_0x506901[_0x2d7a1c(0x1a1)],_0x42b0e5=await profile[_0x2d7a1c(0x23f)]({'email':_0x3b76d4[_0x2d7a1c(0x1e3)]}),_0x524647=await master_shop[_0x2d7a1c(0x217)](),_0x5423c4=_0x506901[_0x2d7a1c(0x208)]['id'],_0x1b0bef=await adjustment[_0x2d7a1c(0x197)]({'_id':_0x5423c4}),_0x48435b=await purchases[_0x2d7a1c(0x231)]([{'$match':{'warehouse_name':_0x1b0bef[_0x2d7a1c(0x193)]}},{'$unwind':'$product'},{'$group':{'_id':_0x2d7a1c(0x18e)}}]),_0xc5b5b5=await product[_0x2d7a1c(0x217)]({}),_0x1e259d=await warehouse[_0x2d7a1c(0x231)]([{'$match':{'name':_0x1b0bef[_0x2d7a1c(0x193)]}},{'$unwind':_0x2d7a1c(0x1d5)},{'$group':{'_id':_0x2d7a1c(0x238),'name':{'$first':_0x2d7a1c(0x1f2)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2d7a1c(0x1d9)},'bin':{'$first':_0x2d7a1c(0x1ab)},'type':{'$first':_0x2d7a1c(0x1b0)},'floorlevel':{'$first':_0x2d7a1c(0x241)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2d7a1c(0x22a)},'product_code':{'$first':_0x2d7a1c(0x21b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x2d7a1c(0x199)},'expiry_date':{'$first':_0x2d7a1c(0x1c1)},'production_date':{'$first':_0x2d7a1c(0x1f7)},'batch_code':{'$first':_0x2d7a1c(0x225)},'room':{'$first':'$room'}}}]);if(_0x524647[0x0][_0x2d7a1c(0x211)]==_0x2d7a1c(0x21d)){var _0xaef61b=users[_0x2d7a1c(0x183)];console[_0x2d7a1c(0x18a)](_0xaef61b);}else{if(_0x524647[0x0][_0x2d7a1c(0x211)]=='Hindi')var _0xaef61b=users[_0x2d7a1c(0x236)];else{if(_0x524647[0x0]['language']==_0x2d7a1c(0x21a))var _0xaef61b=users[_0x2d7a1c(0x21a)];else{if(_0x524647[0x0][_0x2d7a1c(0x211)]=='Spanish')var _0xaef61b=users['Spanish'];else{if(_0x524647[0x0][_0x2d7a1c(0x211)]=='French')var _0xaef61b=users[_0x2d7a1c(0x1a4)];else{if(_0x524647[0x0][_0x2d7a1c(0x211)]==_0x2d7a1c(0x1a6))var _0xaef61b=users[_0x2d7a1c(0x1a2)];else{if(_0x524647[0x0][_0x2d7a1c(0x211)]==_0x2d7a1c(0x212))var _0xaef61b=users['Chinese'];else{if(_0x524647[0x0][_0x2d7a1c(0x211)]==_0x2d7a1c(0x23e))var _0xaef61b=users[_0x2d7a1c(0x202)];}}}}}}}_0x13f5d0[_0x2d7a1c(0x1ea)](_0x2d7a1c(0x17f),{'success':_0x506901['flash'](_0x2d7a1c(0x209)),'errors':_0x506901['flash'](_0x2d7a1c(0x1ae)),'role':_0x3b76d4,'profile':_0x42b0e5,'adjustment':_0x1b0bef,'stock':_0x1e259d,'master_shop':_0x524647,'warehouse_name':_0x48435b,'unit':_0xc5b5b5,'language':_0xaef61b});}catch(_0x7e0c00){console['log'](_0x7e0c00),_0x13f5d0[_0x2d7a1c(0x1be)](0xc8)['json']({'message':_0x7e0c00[_0x2d7a1c(0x229)]});}}),router[a0_0x554c5e(0x1b7)](a0_0x554c5e(0x19c),auth,async(_0x2c9916,_0x3c77a4)=>{var _0x501de8=a0_0x554c5e;try{const _0x4bbc6a=_0x2c9916[_0x501de8(0x208)]['id'],{warehouse_name:_0x5101f6,Room_name:_0x446322}=_0x2c9916[_0x501de8(0x219)],_0x51f114=await adjustment[_0x501de8(0x197)]({'_id':_0x4bbc6a}),_0x2039e2=_0x51f114[_0x501de8(0x1ca)]['map'](async _0x2dd74f=>{var _0x3625dc=_0x501de8;if(_0x2dd74f['adjust_qty']>0x0){var _0x31e66d=await warehouse[_0x3625dc(0x23f)]({'name':_0x5101f6,'room':_0x2dd74f[_0x3625dc(0x1f6)],'warehouse_category':_0x3625dc(0x206)});const _0x12564b=_0x31e66d['product_details'][_0x3625dc(0x22c)](_0x5bdc34=>{var _0x19dd12=_0x3625dc;console[_0x19dd12(0x18a)](_0x2dd74f[_0x19dd12(0x1c0)]+_0x19dd12(0x215));if(_0x2dd74f[_0x19dd12(0x1c0)]==_0x19dd12(0x1ef)){if(_0x5bdc34[_0x19dd12(0x207)]==_0x2dd74f['product_name']&&_0x5bdc34[_0x19dd12(0x1c7)]==_0x2dd74f['floorlevel']&&_0x5bdc34['type']==_0x2dd74f[_0x19dd12(0x19b)]&&_0x5bdc34[_0x19dd12(0x1fd)]==_0x2dd74f[_0x19dd12(0x1fd)]&&_0x5bdc34[_0x19dd12(0x214)]==_0x2dd74f[_0x19dd12(0x214)]&&_0x5bdc34[_0x19dd12(0x17b)]==_0x2dd74f[_0x19dd12(0x17b)]&&_0x5bdc34[_0x19dd12(0x1eb)]==_0x2dd74f[_0x19dd12(0x1eb)]&&_0x5bdc34[_0x19dd12(0x1e4)]==_0x2dd74f['expiry_date']&&_0x5bdc34[_0x19dd12(0x191)]==_0x2dd74f[_0x19dd12(0x191)]&&_0x5bdc34[_0x19dd12(0x232)]==_0x2dd74f[_0x19dd12(0x232)]&&_0x5bdc34[_0x19dd12(0x19a)]==_0x2dd74f[_0x19dd12(0x19a)]&&_0x5bdc34[_0x19dd12(0x1ee)]==_0x2dd74f[_0x19dd12(0x21f)]){var _0x2c8d5a;_0x2c8d5a=_0x2dd74f['adjust_qty'],_0x2dd74f[_0x19dd12(0x1aa)]=='S'&&(_0x2c8d5a=_0x2dd74f[_0x19dd12(0x1b5)]),_0x5bdc34[_0x19dd12(0x233)]=_0x5bdc34['product_stock']-_0x2c8d5a;}}else{if(_0x5bdc34[_0x19dd12(0x207)]==_0x2dd74f[_0x19dd12(0x207)]&&_0x5bdc34['floorlevel']==_0x2dd74f['floorlevel']&&_0x5bdc34['type']==_0x2dd74f[_0x19dd12(0x19b)]&&_0x5bdc34[_0x19dd12(0x1fd)]==_0x2dd74f[_0x19dd12(0x1fd)]&&_0x5bdc34['bay']==_0x2dd74f[_0x19dd12(0x214)]&&_0x5bdc34[_0x19dd12(0x17b)]==_0x2dd74f['rack']&&_0x5bdc34[_0x19dd12(0x1eb)]==_0x2dd74f[_0x19dd12(0x1eb)]&&_0x5bdc34[_0x19dd12(0x1e4)]==_0x2dd74f[_0x19dd12(0x1e4)]&&_0x5bdc34['batch_code']==_0x2dd74f[_0x19dd12(0x191)]&&_0x5bdc34[_0x19dd12(0x232)]==_0x2dd74f[_0x19dd12(0x232)]&&_0x5bdc34[_0x19dd12(0x19a)]==_0x2dd74f[_0x19dd12(0x19a)]&&_0x5bdc34[_0x19dd12(0x1ee)]==_0x2dd74f[_0x19dd12(0x21f)]){console['log'](_0x2dd74f);var _0x2c8d5a;_0x2c8d5a=_0x2dd74f['adjust_qty'],_0x2dd74f[_0x19dd12(0x1aa)]=='S'&&(_0x2c8d5a=_0x2dd74f['adjust_qty']),_0x5bdc34[_0x19dd12(0x233)]=_0x5bdc34[_0x19dd12(0x233)]+_0x2c8d5a;}}});}return _0x31e66d;});Promise['all'](_0x2039e2)['then'](async _0x5b4cec=>{var _0x53d71e=_0x501de8;try{for(const _0x152395 of _0x5b4cec){await _0x152395[_0x53d71e(0x20a)]();}_0x51f114['finalize']=_0x53d71e(0x210);const _0x38704a=await _0x51f114[_0x53d71e(0x20a)](),_0x24b329=await master_shop[_0x53d71e(0x217)](),_0xf41d47=await email_settings[_0x53d71e(0x23f)](),_0x4699b7=await supervisor_settings[_0x53d71e(0x217)]();var _0x35cb47=_0x51f114[_0x53d71e(0x1ca)],_0x7b081e='',_0x50b1c2;for(_0x50b1c2 in _0x35cb47){_0x7b081e+=_0x53d71e(0x184)+_0x53d71e(0x220)+_0x35cb47[_0x50b1c2]['product_name']+_0x53d71e(0x1f8)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x35cb47[_0x50b1c2][_0x53d71e(0x1f4)]+'</td>'+_0x53d71e(0x220)+_0x35cb47[_0x50b1c2][_0x53d71e(0x1b5)]+_0x53d71e(0x1f8)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x35cb47[_0x50b1c2][_0x53d71e(0x189)]+'</td>'+_0x53d71e(0x220)+_0x35cb47[_0x50b1c2][_0x53d71e(0x1db)]+_0x53d71e(0x1f8)+_0x53d71e(0x220)+_0x51f114['warehouse_name']+_0x53d71e(0x1f8)+_0x53d71e(0x220)+_0x35cb47[_0x50b1c2]['room_names']+_0x53d71e(0x1f8)+_0x53d71e(0x220)+_0x35cb47[_0x50b1c2][_0x53d71e(0x1eb)]+_0x35cb47[_0x50b1c2][_0x53d71e(0x17b)]+_0x35cb47[_0x50b1c2][_0x53d71e(0x214)]+_0x35cb47[_0x50b1c2]['bin']+_0x35cb47[_0x50b1c2]['type'][0x0]+_0x35cb47[_0x50b1c2][_0x53d71e(0x1c7)]+'</td>',_0x53d71e(0x205);}let _0x13706c=nodemailer[_0x53d71e(0x1cd)]({'host':_0xf41d47['host'],'port':Number(_0xf41d47[_0x53d71e(0x1e7)]),'secure':![],'auth':{'user':_0xf41d47[_0x53d71e(0x1e3)],'pass':_0xf41d47[_0x53d71e(0x18d)]}}),_0x5555a7={'from':_0xf41d47['email'],'to':_0x4699b7[0x0][_0x53d71e(0x17a)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x53d71e(0x1f3)+_0x53d71e(0x227)+_0x24b329[0x0][_0x53d71e(0x190)],'cid':_0x53d71e(0x185)}],'html':_0x53d71e(0x1a5)+'<html><head><title></title>'+'</head><body>'+_0x53d71e(0x1c5)+_0x53d71e(0x1ba)+'<div>'+_0x53d71e(0x230)+_0x53d71e(0x196)+_0x53d71e(0x1c5)+'<h2>\x20'+_0x24b329[0x0][_0x53d71e(0x181)]+_0x53d71e(0x21c)+_0x53d71e(0x196)+'</div>'+_0x53d71e(0x19d)+_0x53d71e(0x1c5)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x53d71e(0x1b2)+_0x51f114[_0x53d71e(0x19a)]+'\x20'+_0x53d71e(0x203)+_0x53d71e(0x1b8)+_0x51f114[_0x53d71e(0x1df)]+'\x20'+'</span>'+_0x53d71e(0x23d)+_0x53d71e(0x196)+_0x53d71e(0x1e9)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x53d71e(0x184)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x53d71e(0x216)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x53d71e(0x213)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x53d71e(0x20d)+_0x53d71e(0x194)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x53d71e(0x205)+_0x53d71e(0x1ec)+_0x53d71e(0x1f1)+'\x20'+_0x7b081e+'\x20'+_0x53d71e(0x17e)+'</table>'+_0x53d71e(0x1c5)+'<strong>\x20Regards\x20</strong>'+_0x53d71e(0x21e)+_0x24b329[0x0][_0x53d71e(0x181)]+_0x53d71e(0x23d)+_0x53d71e(0x196)+_0x53d71e(0x196)+_0x53d71e(0x200)};_0x13706c[_0x53d71e(0x1e6)](_0x5555a7,function(_0x41847b,_0x10fd0a){var _0x454475=_0x53d71e;_0x41847b?(console['log'](_0x41847b),console[_0x454475(0x18a)](_0x454475(0x1d7))):console[_0x454475(0x18a)](_0x454475(0x1e0));}),_0x2c9916[_0x53d71e(0x201)](_0x53d71e(0x209),_0x53d71e(0x1b6)),_0x3c77a4['redirect'](_0x53d71e(0x204)+_0x38704a[_0x53d71e(0x1ee)]);}catch(_0x17ccd9){console['error'](_0x17ccd9),_0x3c77a4[_0x53d71e(0x1be)](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x501de8(0x20f)](_0x551424=>{var _0x2765c4=_0x501de8;console[_0x2765c4(0x1bb)](_0x551424),_0x3c77a4['status'](0x1f4)[_0x2765c4(0x1cf)]({'error':_0x2765c4(0x1f0)});});}catch(_0xf58d30){console['log'](_0xf58d30),_0x3c77a4[_0x501de8(0x1be)](0xc8)[_0x501de8(0x1cf)]({'message':_0xf58d30[_0x501de8(0x229)]});}}),router[a0_0x554c5e(0x221)](a0_0x554c5e(0x1dc),auth,async(_0x3750ce,_0x113995)=>{var _0x2748a6=a0_0x554c5e;try{const {username:_0x769148,email:_0x26a587,role:_0x6f2c83}=_0x3750ce[_0x2748a6(0x1a1)],_0x59ee70=_0x3750ce['user'],_0x4ef2ba=await profile['findOne']({'email':_0x59ee70[_0x2748a6(0x1e3)]}),_0x43167a=await master_shop[_0x2748a6(0x217)](),_0x4ce10a=_0x3750ce[_0x2748a6(0x208)]['id'],_0x2b15c7=await adjustment['findById']({'_id':_0x4ce10a}),_0x4f42b3=await purchases[_0x2748a6(0x231)]([{'$match':{'warehouse_name':_0x2b15c7[_0x2748a6(0x193)]}},{'$unwind':_0x2748a6(0x187)},{'$group':{'_id':_0x2748a6(0x18e)}}]),_0x1b484c=await product['find']({}),_0x25a43b=await warehouse[_0x2748a6(0x231)]([{'$match':{'name':_0x2b15c7[_0x2748a6(0x193)]}},{'$unwind':_0x2748a6(0x1d5)},{'$group':{'_id':_0x2748a6(0x238),'name':{'$first':_0x2748a6(0x1f2)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2748a6(0x1d9)},'bin':{'$first':_0x2748a6(0x1ab)},'type':{'$first':_0x2748a6(0x1b0)},'floorlevel':{'$first':_0x2748a6(0x241)},'primary_code':{'$first':_0x2748a6(0x188)},'secondary_code':{'$first':_0x2748a6(0x22a)},'product_code':{'$first':_0x2748a6(0x21b)},'storage':{'$first':_0x2748a6(0x19f)},'rack':{'$first':_0x2748a6(0x1c2)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x2748a6(0x1c1)},'production_date':{'$first':_0x2748a6(0x1f7)},'batch_code':{'$first':_0x2748a6(0x225)},'room':{'$first':'$room'}}}]);let _0x5a6aca;if(_0x59ee70[_0x2748a6(0x1e1)]==_0x2748a6(0x23c)){const _0x572950=await staff[_0x2748a6(0x23f)]({'email':_0x59ee70[_0x2748a6(0x1e3)]});_0x5a6aca=await warehouse[_0x2748a6(0x231)]([{'$match':{'status':_0x2748a6(0x1cb),'name':_0x572950[_0x2748a6(0x1e5)],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x2748a6(0x1f5),'name':{'$first':_0x2748a6(0x1f5)}}}]);}else _0x5a6aca=await warehouse[_0x2748a6(0x231)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x2748a6(0x1f5),'name':{'$first':_0x2748a6(0x1f5)}}}]);if(_0x43167a[0x0][_0x2748a6(0x211)]=='English\x20(US)'){var _0x59eced=users[_0x2748a6(0x183)];console[_0x2748a6(0x18a)](_0x59eced);}else{if(_0x43167a[0x0][_0x2748a6(0x211)]==_0x2748a6(0x236))var _0x59eced=users[_0x2748a6(0x236)];else{if(_0x43167a[0x0]['language']=='German')var _0x59eced=users['German'];else{if(_0x43167a[0x0][_0x2748a6(0x211)]==_0x2748a6(0x224))var _0x59eced=users['Spanish'];else{if(_0x43167a[0x0][_0x2748a6(0x211)]==_0x2748a6(0x1a4))var _0x59eced=users['French'];else{if(_0x43167a[0x0]['language']=='Portuguese\x20(BR)')var _0x59eced=users[_0x2748a6(0x1a2)];else{if(_0x43167a[0x0][_0x2748a6(0x211)]==_0x2748a6(0x212))var _0x59eced=users[_0x2748a6(0x212)];else{if(_0x43167a[0x0][_0x2748a6(0x211)]==_0x2748a6(0x23e))var _0x59eced=users[_0x2748a6(0x202)];}}}}}}}_0x113995[_0x2748a6(0x1ea)]('edit_adjustment',{'success':_0x3750ce[_0x2748a6(0x201)](_0x2748a6(0x209)),'errors':_0x3750ce[_0x2748a6(0x201)](_0x2748a6(0x1ae)),'role':_0x59ee70,'profile':_0x4ef2ba,'adjustment':_0x2b15c7,'stock':_0x25a43b,'master_shop':_0x43167a,'warehouse_name':_0x4f42b3,'unit':_0x1b484c,'language':_0x59eced,'warehouse':_0x5a6aca});}catch(_0x3729dc){console[_0x2748a6(0x18a)](_0x3729dc),_0x113995[_0x2748a6(0x1be)](0xc8)['json']({'message':_0x3729dc[_0x2748a6(0x229)]});}}),router[a0_0x554c5e(0x1b7)](a0_0x554c5e(0x1dc),auth,async(_0x214c38,_0x501cfb)=>{var _0x5bbe0b=a0_0x554c5e;try{const _0x1bd2df=_0x214c38[_0x5bbe0b(0x208)]['id'],_0x4f3ca6=await adjustment[_0x5bbe0b(0x197)]({'_id':_0x1bd2df}),_0x86a9f0=await warehouse[_0x5bbe0b(0x23f)]({'name':_0x4f3ca6[_0x5bbe0b(0x193)],'room':_0x4f3ca6['room']}),{warehouse_name:_0xa9c96d,date:_0x217a31,prod_name:_0x2c2ae6,level:_0x4bb7ed,isle:_0x2c76c8,pallet:_0x37ebbb,stock:_0x3cc3fd,types:_0x177ec0,adjust_qty:_0x5bae20,new_adjust_qty:_0x4cc764,note:_0x2a1469,Room_name:_0xbdbf9f,invoice:_0x5d0a58,JO_number:_0x5a402f,expiry_date:_0x74d39a}=_0x214c38[_0x5bbe0b(0x219)];if(typeof _0x2c2ae6==_0x5bbe0b(0x17d))var _0x114c8c=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x180)]],_0x370963=[_0x214c38[_0x5bbe0b(0x219)]['level']],_0x1c524e=[_0x214c38[_0x5bbe0b(0x219)]['stock']],_0x3a9b0a=[_0x214c38[_0x5bbe0b(0x219)]['types']],_0x5880bd=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x22d)]],_0x32e01c=[_0x214c38['body'][_0x5bbe0b(0x18f)]],_0x3ee729=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1fc)]],_0x2fd40b=[_0x214c38['body'][_0x5bbe0b(0x1f9)]],_0x2bc7b0=[_0x214c38[_0x5bbe0b(0x219)]['prod_code']],_0x170dda=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x191)]],_0x5d1244=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1e4)]],_0x34a122=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1b1)]],_0x55510a=[_0x214c38[_0x5bbe0b(0x219)]['production_date']],_0x880930=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1aa)]],_0x2d7b8e=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1da)]],_0x26db31=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1bf)]],_0x296fac=[_0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1d8)]];else var _0x114c8c=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x180)]],_0x370963=[..._0x214c38['body'][_0x5bbe0b(0x1ac)]],_0x1c524e=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x234)]],_0x3a9b0a=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1c0)]],_0x5880bd=[..._0x214c38['body'][_0x5bbe0b(0x22d)]],_0x32e01c=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x18f)]],_0x3ee729=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x189)]],_0x2fd40b=[..._0x214c38['body']['Secondary_units']],_0x2bc7b0=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1a3)]],_0x170dda=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x191)]],_0x5d1244=[..._0x214c38['body'][_0x5bbe0b(0x1e4)]],_0x34a122=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1b1)]],_0x55510a=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x232)]],_0x880930=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1aa)]],_0x2d7b8e=[..._0x214c38['body'][_0x5bbe0b(0x1da)]],_0x26db31=[..._0x214c38[_0x5bbe0b(0x219)][_0x5bbe0b(0x1bf)]],_0x296fac=[..._0x214c38[_0x5bbe0b(0x219)]['second1']];const _0x17daee=_0x114c8c[_0x5bbe0b(0x22c)](_0x1c3ccf=>{return _0x1c3ccf={'product_name':_0x1c3ccf};});_0x370963[_0x5bbe0b(0x1b9)]((_0x2e2883,_0x4273f9)=>{var _0x954e03=_0x5bbe0b;_0x2d7b8e[_0x954e03(0x1b9)]((_0x1a2770,_0x22effe)=>{var _0x456e63=_0x954e03;if(_0x1a2770==_0x456e63(0x20e)&&_0x4273f9==_0x22effe){var _0x78dfe0=_0x2e2883['slice'](0x3);_0x17daee[_0x4273f9][_0x456e63(0x1eb)]=_0x2e2883[0x0],_0x17daee[_0x4273f9]['rack']=_0x2e2883[0x1],_0x17daee[_0x4273f9][_0x456e63(0x214)]=0x0,_0x17daee[_0x4273f9][_0x456e63(0x1fd)]=0x0,_0x17daee[_0x4273f9][_0x456e63(0x19b)]=_0x456e63(0x1e2),_0x17daee[_0x4273f9][_0x456e63(0x1c7)]=_0x78dfe0;}else{if(_0x1a2770==_0x456e63(0x1ad)&&_0x4273f9==_0x22effe){var _0x78dfe0=_0x2e2883['slice'](0x3);_0x17daee[_0x4273f9][_0x456e63(0x1eb)]=_0x2e2883[0x0],_0x17daee[_0x4273f9][_0x456e63(0x17b)]=_0x2e2883[0x1],_0x17daee[_0x4273f9][_0x456e63(0x214)]=0x0,_0x17daee[_0x4273f9][_0x456e63(0x1fd)]=0x0,_0x17daee[_0x4273f9][_0x456e63(0x19b)]=_0x456e63(0x1e2),_0x17daee[_0x4273f9][_0x456e63(0x1c7)]=_0x2e2883[0x5];}else{if(_0x4273f9==_0x22effe){var _0x106c97;if(_0x2e2883[0x4]=='L')_0x106c97='Level';else _0x2e2883[0x4]=='F'&&(_0x106c97=_0x456e63(0x1e2));_0x17daee[_0x4273f9][_0x456e63(0x1eb)]=_0x2e2883[0x0],_0x17daee[_0x4273f9][_0x456e63(0x17b)]=_0x2e2883[0x1],_0x17daee[_0x4273f9]['bay']=_0x2e2883[0x2],_0x17daee[_0x4273f9][_0x456e63(0x1fd)]=_0x2e2883[0x3],_0x17daee[_0x4273f9]['type']=_0x106c97,_0x17daee[_0x4273f9][_0x456e63(0x1c7)]=_0x2e2883[0x5];}}}});}),_0x1c524e[_0x5bbe0b(0x1b9)]((_0x865f89,_0x535a80)=>{var _0x50aae7=_0x5bbe0b;_0x17daee[_0x535a80][_0x50aae7(0x1c6)]=_0x865f89;}),_0x3a9b0a[_0x5bbe0b(0x1b9)]((_0x129995,_0x53d093)=>{_0x17daee[_0x53d093]['types']=_0x129995;}),_0x5880bd['forEach']((_0x96e53b,_0x251ad0)=>{_0x17daee[_0x251ad0]['adjust_qty']=_0x96e53b;}),_0x32e01c[_0x5bbe0b(0x1b9)]((_0x4193b4,_0x35a91c)=>{var _0xbf08ee=_0x5bbe0b;_0x17daee[_0x35a91c][_0xbf08ee(0x1c9)]=_0x4193b4;}),_0x3ee729[_0x5bbe0b(0x1b9)]((_0x525c4a,_0x56050d)=>{var _0xeca83=_0x5bbe0b;_0x17daee[_0x56050d][_0xeca83(0x189)]=_0x525c4a;}),_0x2fd40b[_0x5bbe0b(0x1b9)]((_0x2e56f2,_0x34a4c2)=>{var _0x1cf95=_0x5bbe0b;_0x17daee[_0x34a4c2][_0x1cf95(0x1db)]=_0x2e56f2;}),_0x2bc7b0['forEach']((_0x4f1ace,_0x394936)=>{var _0x178136=_0x5bbe0b;_0x17daee[_0x394936][_0x178136(0x1f4)]=_0x4f1ace;}),_0x170dda[_0x5bbe0b(0x1b9)]((_0x38c33b,_0x5d0c9f)=>{var _0x4c9daf=_0x5bbe0b;_0x17daee[_0x5d0c9f][_0x4c9daf(0x191)]=_0x38c33b;}),_0x5d1244['forEach']((_0x2a961d,_0x485d50)=>{var _0x34320e=_0x5bbe0b;_0x17daee[_0x485d50][_0x34320e(0x1e4)]=_0x2a961d;}),_0x34a122[_0x5bbe0b(0x1b9)]((_0x3cfa34,_0x5e9dd2)=>{_0x17daee[_0x5e9dd2]['maxperunit']=_0x3cfa34;}),_0x55510a['forEach']((_0x20aacc,_0x325bb7)=>{var _0x44ad54=_0x5bbe0b;_0x17daee[_0x325bb7][_0x44ad54(0x232)]=_0x20aacc;}),_0x880930['forEach']((_0x4694e3,_0x253e6c)=>{var _0x2aa872=_0x5bbe0b;_0x17daee[_0x253e6c][_0x2aa872(0x1aa)]=_0x4694e3;}),_0x2d7b8e['forEach']((_0x3db7a9,_0x557028)=>{_0x17daee[_0x557028]['room_names']=_0x3db7a9;}),_0x26db31['forEach']((_0x2aeb68,_0x430ea7)=>{var _0x4463ff=_0x5bbe0b;_0x17daee[_0x430ea7][_0x4463ff(0x226)]=_0x2aeb68;}),_0x296fac[_0x5bbe0b(0x1b9)]((_0x1cbf02,_0x4d6ec1)=>{var _0x5160ab=_0x5bbe0b;_0x17daee[_0x4d6ec1][_0x5160ab(0x192)]=_0x1cbf02;});const _0x3f83f1=_0x17daee[_0x5bbe0b(0x17c)](_0xfbde19=>_0xfbde19[_0x5bbe0b(0x1b5)]!=='0'&&_0xfbde19[_0x5bbe0b(0x1b5)]!=='');var _0x55a6eb=0x0;_0x3f83f1['forEach'](_0x20c679=>{var _0x34dff3=_0x5bbe0b;console['log'](_0x34dff3(0x246),_0x20c679),parseInt(_0x20c679['adjust_qty'])<=0x0&&_0x55a6eb++;});if(_0x55a6eb!=0x0)return _0x214c38[_0x5bbe0b(0x201)](_0x5bbe0b(0x1ae),_0x5bbe0b(0x1c4)),_0x501cfb['redirect'](_0x5bbe0b(0x18b));_0x4f3ca6['warehouse_name']=_0xa9c96d,_0x4f3ca6['date']=_0x217a31,_0x4f3ca6[_0x5bbe0b(0x1ca)]=_0x3f83f1,_0x4f3ca6[_0x5bbe0b(0x237)]=_0x2a1469,_0x4f3ca6[_0x5bbe0b(0x19a)]=_0x5d0a58,_0x4f3ca6[_0x5bbe0b(0x1b4)]=_0x5bbe0b(0x1dd);const _0x456722=await _0x4f3ca6['save']();_0x214c38[_0x5bbe0b(0x201)]('success',_0x5bbe0b(0x20b)),_0x501cfb[_0x5bbe0b(0x1d6)](_0x5bbe0b(0x1ce));}catch(_0x2414ba){console['log'](_0x2414ba);}}),router[a0_0x554c5e(0x1b7)]('/barcode_scanner',async(_0x53a2cb,_0x4eb907)=>{var _0x337ae4=a0_0x554c5e;const {primary_code:_0x3d72f4,warehouse_data:_0x59648c,rooms_data:_0x1f8367,Roomslist:_0x46ac50}=_0x53a2cb[_0x337ae4(0x219)],_0x368b19=_0x46ac50['split'](','),_0x2e6289=[];async function _0x3c2ac0(_0x5d6d89){var _0x14419e=_0x337ae4;const _0x3e20b3=await warehouse['aggregate']([{'$match':{'name':_0x59648c,'room':_0x5d6d89}},{'$unwind':_0x14419e(0x1d5)},{'$match':{'product_details.primary_code':_0x3d72f4}},{'$group':{'_id':_0x14419e(0x238),'name':{'$first':_0x14419e(0x1f2)},'product_stock':{'$first':_0x14419e(0x244)},'primary_code':{'$first':_0x14419e(0x188)},'secondary_code':{'$first':_0x14419e(0x22a)},'product_code':{'$first':_0x14419e(0x21b)},'level':{'$first':_0x14419e(0x1d9)},'isle':{'$first':_0x14419e(0x1ab)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x14419e(0x241)},'unit':{'$first':_0x14419e(0x242)},'secondary_unit':{'$first':_0x14419e(0x223)},'storage':{'$first':_0x14419e(0x19f)},'rack':{'$first':_0x14419e(0x1c2)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x14419e(0x1f7)},'maxPerUnit':{'$first':_0x14419e(0x199)},'batch_code':{'$first':_0x14419e(0x225)},'product_cat':{'$first':_0x14419e(0x228)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x3290d2=await warehouse[_0x14419e(0x231)]([{'$match':{'name':_0x59648c,'room':_0x5d6d89}},{'$unwind':_0x14419e(0x1d5)},{'$match':{'product_details.secondary_code':_0x3d72f4}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x14419e(0x244)},'primary_code':{'$first':_0x14419e(0x188)},'secondary_code':{'$first':_0x14419e(0x22a)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x14419e(0x1d9)},'isle':{'$first':_0x14419e(0x1ab)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x14419e(0x241)},'unit':{'$first':_0x14419e(0x242)},'secondary_unit':{'$first':_0x14419e(0x223)},'storage':{'$first':_0x14419e(0x19f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x14419e(0x1c1)},'production_date':{'$first':_0x14419e(0x1f7)},'maxPerUnit':{'$first':_0x14419e(0x199)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x14419e(0x228)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x14419e(0x1d4)}}}]);if(_0x3e20b3[_0x14419e(0x240)]>0x0)_0x2e6289[_0x14419e(0x1af)](_0x3e20b3);else _0x3290d2['length']>0x0&&_0x2e6289[_0x14419e(0x1af)](_0x3290d2);}const _0x4852bc=_0x368b19[_0x337ae4(0x22c)](_0x20b483=>_0x3c2ac0(_0x20b483));await Promise[_0x337ae4(0x1bd)](_0x4852bc),_0x4eb907[_0x337ae4(0x1cf)](_0x2e6289);}),router['post']('/CheckingWarehouse',async(_0x541398,_0x18ea68)=>{var _0x547c08=a0_0x554c5e;const {primaryCode:_0x338d52,secondaryCode:_0x29713b,productCode:_0x26f692,level:_0x48551d,isle:_0xbb9f8b,pallet:_0x3acd5a,warehouses:_0x496c40,room:_0x544069}=_0x541398['body'];try{const _0x4ca5b2=await warehouse[_0x547c08(0x231)]([{'$match':{'name':_0x496c40,'room':_0x544069}},{'$unwind':_0x547c08(0x1d5)},{'$match':{'product_details.level':parseInt(_0x48551d),'product_details.isle':_0xbb9f8b,'product_details.pallet':parseInt(_0x3acd5a)}},{'$group':{'_id':_0x547c08(0x238),'name':{'$first':_0x547c08(0x1f2)},'product_stock':{'$first':_0x547c08(0x244)},'level':{'$first':_0x547c08(0x1cc)},'isle':{'$first':_0x547c08(0x239)},'pallet':{'$first':_0x547c08(0x235)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x18ea68[_0x547c08(0x1be)](0xc8)[_0x547c08(0x1cf)](_0x4ca5b2);}catch(_0x506778){_0x18ea68[_0x547c08(0x1be)](0x194)[_0x547c08(0x1cf)]({'message':_0x506778[_0x547c08(0x229)]});}}),module[a0_0x554c5e(0x1e8)]=router;