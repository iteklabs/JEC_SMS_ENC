var a0_0x36bd9f=a0_0x43b6;(function(_0x55a95d,_0x3dcc5c){var _0x522579=a0_0x43b6,_0xa6fbc7=_0x55a95d();while(!![]){try{var _0x51ebd8=parseInt(_0x522579(0x18c))/0x1+parseInt(_0x522579(0x159))/0x2*(-parseInt(_0x522579(0x17e))/0x3)+-parseInt(_0x522579(0x1b0))/0x4*(parseInt(_0x522579(0x1a8))/0x5)+parseInt(_0x522579(0x166))/0x6*(parseInt(_0x522579(0x131))/0x7)+-parseInt(_0x522579(0x1dc))/0x8*(parseInt(_0x522579(0x1a3))/0x9)+-parseInt(_0x522579(0x189))/0xa+parseInt(_0x522579(0x177))/0xb;if(_0x51ebd8===_0x3dcc5c)break;else _0xa6fbc7['push'](_0xa6fbc7['shift']());}catch(_0xf9e88b){_0xa6fbc7['push'](_0xa6fbc7['shift']());}}}(a0_0x1b6e,0x83a28));const express=require(a0_0x36bd9f(0x18a)),app=express(),router=express[a0_0x36bd9f(0x184)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x36bd9f(0x14f)),users=require(a0_0x36bd9f(0x1e5)),nodemailer=require(a0_0x36bd9f(0x18b));function a0_0x1b6e(){var _0x17dc71=['edit_adjustment_view','$product_details.floorlevel','stock','There\x27s\x20a\x20error\x20in\x20this\x20transaction','then','length','site_title','email','</div>','$product_details.level','$product.room_names','$product_details.expiry_date','Email\x20sent\x20successfully','secondary_unit','product','adjustment\x20data\x20update\x20successfully','<span\x20style=\x22float:\x20right;\x22>','minus','Adjustment\x20Mail','secondary_code','153jYtFqJ','/preview/:id','English\x20(US)','Error\x20Occurs','success','1495295xzURUi','adjust_qty','<!DOCTYPE\x20html>','id_transaction','host','id_transaction_from','$product_details.production_date','room_names','4rsmuEL','prod_invoice','/upload/','/view/add_adjustment','\x20Order\x20Date\x20:\x20','exports','$product_details.product_cat','$date','New_Qty_Converted','<tbody\x20style=\x22text-align:\x20center;\x22>','/adjustment/view','prod_cat','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Arabic','production_date','string','isAllowEdit','$product','$product_details.type','/../public','$product_details.invoice','$product_details.bin','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Return\x20Rooms','/CheckingWarehouse','room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.secondary_code','<strong>\x20Regards\x20</strong>','new_adjust_qty','all','rack','prod_name','Floor','$product_details.secondary_unit','padStart','unit','edit_adjustment','English','language','finalize','Secondary_units','foreach\x20newproduct','New_Qty_Converted_adj','126264xwoNst','back','errors','Enclosed','</tr>','warehouse_name','<h5\x20style=\x22text-align:\x20left;\x22>','ADJ-','Logo.png','../public/language/languages.json','body','redirect','user','$product_details.rack','message','product_stock','filter','error','Shelves','image','$product_details','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','\x20<>\x20','$product_details.product_code','level','$warehouse_name','Level','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','An\x20error\x20occurred.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','floorlevel','primary_code','Return\x20Goods','<h2>\x20','invoice','$product_details.batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','second1','Raw\x20Materials','add_adjustment','Receiving\x20Area','slice','$product_details.unit','product_name','$product.product_name','</body></html>','maxperunit','2103878nQUWsh','port','find','prime1','Primary_Units','types','Ambient','note','\x20Order\x20Number\x20:\x20','</head><body>','</td>','params','</span>','Enabled','$product_details.maxPerUnit','warehouse','sendMail','Portuguese','/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','French','RMSEmail','$_id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.product_name','bin','staff','/view/:id','role','$product_details._id','../models/all_models','type','</h5>','$name','Chinese','_id','$product_details.product_stock','Arabic\x20(ae)','password','batch_code','55136TfDzeV','map','Spanish','date','Rooms','$finalize','<div>','Portuguese\x20(BR)','get','<tr>','Hindi','$product_details.maxProducts','logo','6IQdlgT','status','</thead>','True','prod_code','json','catch','findById','split','findOne','floor','/picking_list/PDF_adjustment_rm/','random','flash','$product_details.bay','product_code','$product_details.storage','5838987SOVFLf','toString','\x20</h2>','post','createTransport','bay','log','12LLJHVK','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','expiry_date','stockBefore','save','forEach','Router','$room','German','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.primary_code','2295920YFaMxr','express','nodemailer','615039AFpyCJ','product_details','storage'];a0_0x1b6e=function(){return _0x17dc71;};return a0_0x1b6e();}function a0_0x43b6(_0x37021a,_0x533745){var _0x1b6ef6=a0_0x1b6e();return a0_0x43b6=function(_0x43b63e,_0x57ef3d){_0x43b63e=_0x43b63e-0x121;var _0xba5b49=_0x1b6ef6[_0x43b63e];return _0xba5b49;},a0_0x43b6(_0x37021a,_0x533745);}router[a0_0x36bd9f(0x161)](a0_0x36bd9f(0x143),auth,async(_0x7f67c3,_0x149d51)=>{var _0x4a03a4=a0_0x36bd9f;try{const {username:_0x19ae29,email:_0x41ed56,role:_0x4cd1b9}=_0x7f67c3[_0x4a03a4(0x1e8)],_0x2f8b54=_0x7f67c3[_0x4a03a4(0x1e8)],_0x2bc7fd=await profile['findOne']({'email':_0x2f8b54['email']}),_0x4fc45e=await master_shop[_0x4a03a4(0x133)]();console['log']('master',_0x4fc45e);let _0x359d87;if(_0x2f8b54[_0x4a03a4(0x14d)]==_0x4a03a4(0x14b)){const _0x25db81=await staff[_0x4a03a4(0x16f)]({'email':_0x2f8b54[_0x4a03a4(0x196)]});_0x359d87=await warehouse[_0x4a03a4(0x133)]({'status':_0x4a03a4(0x13e),'name':_0x25db81[_0x4a03a4(0x140)]});}else _0x359d87=await warehouse[_0x4a03a4(0x133)]({'status':_0x4a03a4(0x13e)});const _0x51e797=await product[_0x4a03a4(0x133)]();let _0xc284f9;if(_0x2f8b54['role']==_0x4a03a4(0x14b)){const _0x502f7c=await staff['findOne']({'email':_0x2f8b54[_0x4a03a4(0x196)]});_0xc284f9=await adjustment[_0x4a03a4(0x133)]({'warehouse_name':_0x502f7c[_0x4a03a4(0x140)]});}else _0xc284f9=await adjustment['aggregate']([{'$unwind':_0x4a03a4(0x1c1)},{'$group':{'_id':_0x4a03a4(0x147),'invoice':{'$first':'$invoice'},'date':{'$first':_0x4a03a4(0x1b7)},'warehouse_name':{'$first':_0x4a03a4(0x1f6)},'room':{'$addToSet':_0x4a03a4(0x199)},'finalize':{'$first':_0x4a03a4(0x15e)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4fc45e[0x0]['language']==_0x4a03a4(0x1a5)){var _0x2bcafc=users[_0x4a03a4(0x1d6)];console[_0x4a03a4(0x17d)](_0x2bcafc);}else{if(_0x4fc45e[0x0]['language']=='Hindi')var _0x2bcafc=users[_0x4a03a4(0x163)];else{if(_0x4fc45e[0x0][_0x4a03a4(0x1d7)]=='German')var _0x2bcafc=users['German'];else{if(_0x4fc45e[0x0]['language']==_0x4a03a4(0x15b))var _0x2bcafc=users['Spanish'];else{if(_0x4fc45e[0x0][_0x4a03a4(0x1d7)]==_0x4a03a4(0x145))var _0x2bcafc=users[_0x4a03a4(0x145)];else{if(_0x4fc45e[0x0]['language']==_0x4a03a4(0x160))var _0x2bcafc=users[_0x4a03a4(0x142)];else{if(_0x4fc45e[0x0]['language']==_0x4a03a4(0x153))var _0x2bcafc=users[_0x4a03a4(0x153)];else{if(_0x4fc45e[0x0][_0x4a03a4(0x1d7)]==_0x4a03a4(0x156))var _0x2bcafc=users['Arabic'];}}}}}}}_0x149d51[_0x4a03a4(0x1f1)]('adjustment',{'success':_0x7f67c3[_0x4a03a4(0x173)](_0x4a03a4(0x1a7)),'errors':_0x7f67c3[_0x4a03a4(0x173)](_0x4a03a4(0x1de)),'role':_0x2f8b54,'profile':_0x2bc7fd,'warehouse':_0x359d87,'product':_0x51e797,'adjustment':_0xc284f9,'master_shop':_0x4fc45e,'language':_0x2bcafc});}catch(_0x4ea806){console['log'](_0x4ea806);}});async function getRandom8DigitNumber(){var _0x5a9862=a0_0x36bd9f;const _0x32fda3=0x989680,_0x36b5e8=0x5f5e0ff,_0x58338d=Math[_0x5a9862(0x170)](Math[_0x5a9862(0x172)]()*(_0x36b5e8-_0x32fda3+0x1))+_0x32fda3;var _0x30ae9c;const _0x2e079b=await adjustment[_0x5a9862(0x16f)]({'invoice':_0x5a9862(0x1e3)+_0x58338d});return _0x2e079b&&_0x2e079b[_0x5a9862(0x194)]>0x0?_0x30ae9c=_0x5a9862(0x1e3)+_0x58338d:_0x30ae9c=_0x5a9862(0x1e3)+_0x58338d,_0x30ae9c;}router[a0_0x36bd9f(0x161)](a0_0x36bd9f(0x1b3),auth,async(_0x58a8e6,_0x3d7eca)=>{var _0x1b2908=a0_0x36bd9f;try{const {username:_0x3a526d,email:_0x31d5b1,role:_0x369f6d}=_0x58a8e6[_0x1b2908(0x1e8)],_0x393884=_0x58a8e6['user'],_0xd0c116=await profile['findOne']({'email':_0x393884[_0x1b2908(0x196)]}),_0x132d1d=await master_shop[_0x1b2908(0x133)]();let _0x3dcf4b;if(_0x393884[_0x1b2908(0x14d)]==_0x1b2908(0x14b)){const _0x5841e0=await staff['findOne']({'email':_0x393884[_0x1b2908(0x196)]});_0x3dcf4b=await warehouse[_0x1b2908(0x1f8)]([{'$match':{'status':_0x1b2908(0x13e),'name':_0x5841e0[_0x1b2908(0x140)],'warehouse_category':_0x1b2908(0x128),'name':{'$ne':_0x1b2908(0x122)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x3dcf4b=await warehouse[_0x1b2908(0x1f8)]([{'$match':{'status':'Enabled','warehouse_category':_0x1b2908(0x128),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x1b2908(0x152),'name':{'$first':'$name'}}}]);const _0x4e7ecc=await product[_0x1b2908(0x133)]({}),_0x2e6994=await adjustment[_0x1b2908(0x133)]({}),_0x2c1f15=_0x2e6994[_0x1b2908(0x194)]+0x1,_0x393ddb='ADJ-'+_0x2c1f15[_0x1b2908(0x178)]()[_0x1b2908(0x1d3)](0x5,'0');var _0x2ee279=[_0x1b2908(0x137),_0x1b2908(0x1df),_0x1b2908(0x1c7)];if(_0x132d1d[0x0][_0x1b2908(0x1d7)]==_0x1b2908(0x1a5))var _0x46b7bf=users[_0x1b2908(0x1d6)];else{if(_0x132d1d[0x0][_0x1b2908(0x1d7)]==_0x1b2908(0x163))var _0x46b7bf=users[_0x1b2908(0x163)];else{if(_0x132d1d[0x0][_0x1b2908(0x1d7)]==_0x1b2908(0x186))var _0x46b7bf=users[_0x1b2908(0x186)];else{if(_0x132d1d[0x0]['language']==_0x1b2908(0x15b))var _0x46b7bf=users[_0x1b2908(0x15b)];else{if(_0x132d1d[0x0][_0x1b2908(0x1d7)]==_0x1b2908(0x145))var _0x46b7bf=users[_0x1b2908(0x145)];else{if(_0x132d1d[0x0][_0x1b2908(0x1d7)]==_0x1b2908(0x160))var _0x46b7bf=users[_0x1b2908(0x142)];else{if(_0x132d1d[0x0][_0x1b2908(0x1d7)]==_0x1b2908(0x153))var _0x46b7bf=users[_0x1b2908(0x153)];else{if(_0x132d1d[0x0][_0x1b2908(0x1d7)]==_0x1b2908(0x156))var _0x46b7bf=users[_0x1b2908(0x1bd)];}}}}}}}const _0x153d8d=getRandom8DigitNumber();_0x153d8d[_0x1b2908(0x193)](_0x8e3a13=>{var _0x45e507=_0x1b2908;_0x3d7eca[_0x45e507(0x1f1)](_0x45e507(0x129),{'success':_0x58a8e6[_0x45e507(0x173)](_0x45e507(0x1a7)),'errors':_0x58a8e6[_0x45e507(0x173)]('errors'),'role':_0x393884,'profile':_0xd0c116,'warehouse':_0x3dcf4b,'product':_0x4e7ecc,'master_shop':_0x132d1d,'language':_0x46b7bf,'rooms_data':_0x2ee279,'invoice_no':_0x8e3a13});})[_0x1b2908(0x16c)](_0x1b1271=>{var _0xa5a8d5=_0x1b2908;_0x58a8e6['flash'](_0xa5a8d5(0x1de),_0xa5a8d5(0x192)),_0x3d7eca[_0xa5a8d5(0x1e7)]('/adjustment/view');});}catch(_0x2390fe){console['log'](_0x2390fe);}}),router['post'](a0_0x36bd9f(0x1b3),auth,async(_0x1c006e,_0x5de4e5)=>{var _0x1f3838=a0_0x36bd9f;try{const {warehouse_name:_0x1c57d1,date:_0x4248db,prod_name:_0x594e10,level:_0x55f466,isle:_0x42fc06,pallet:_0x14465e,stock:_0x57bacd,types:_0x3182b4,adjust_qty:_0x58c647,new_adjust_qty:_0x454c4b,note:_0x276976,Room_name:_0x3d07c2,invoice:_0x2b2e3f,JO_number:_0x31ba60,expiry_date:_0x26d27d}=_0x1c006e[_0x1f3838(0x1e6)];if(typeof _0x594e10=='string')var _0x30cf95=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1d0)]],_0xeca80=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1f5)]],_0x3a1f83=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x191)]],_0x4aa368=[_0x1c006e[_0x1f3838(0x1e6)]['types']],_0x2666ab=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1db)]],_0x2d7d9f=[_0x1c006e['body'][_0x1f3838(0x1b8)]],_0x12b9aa=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x135)]],_0x36e81c=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1d9)]],_0x32ff86=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x16a)]],_0x4034c2=[_0x1c006e['body'][_0x1f3838(0x158)]],_0xb86858=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x180)]],_0x31776a=[_0x1c006e[_0x1f3838(0x1e6)]['max_per_unit']],_0x2d035c=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1be)]],_0x162938=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1bb)]],_0xf532c8=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x15d)]],_0x419ed0=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x134)]],_0x46206d=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x127)]],_0x541820=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1b1)]],_0x22accb=[_0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1ab)]];else var _0x30cf95=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1d0)]],_0xeca80=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1f5)]],_0x3a1f83=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x191)]],_0x4aa368=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x136)]],_0x2666ab=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1db)]],_0x2d7d9f=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1b8)]],_0x12b9aa=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1d4)]],_0x36e81c=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1d9)]],_0x32ff86=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x16a)]],_0x4034c2=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x158)]],_0xb86858=[..._0x1c006e['body'][_0x1f3838(0x180)]],_0x31776a=[..._0x1c006e['body']['max_per_unit']],_0x2d035c=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1be)]],_0x162938=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1bb)]],_0xf532c8=[..._0x1c006e[_0x1f3838(0x1e6)]['Rooms']],_0x419ed0=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x134)]],_0x46206d=[..._0x1c006e[_0x1f3838(0x1e6)]['second1']],_0x541820=[..._0x1c006e[_0x1f3838(0x1e6)][_0x1f3838(0x1b1)]],_0x22accb=[..._0x1c006e['body'][_0x1f3838(0x1ab)]];const _0x2b0352=_0x30cf95[_0x1f3838(0x15a)](_0xabb444=>{return _0xabb444={'product_name':_0xabb444};});_0xeca80[_0x1f3838(0x183)]((_0x37c9a5,_0x5a7c8b)=>{var _0x30b306=_0x1f3838;_0xf532c8[_0x30b306(0x183)]((_0xb360d,_0x1372b5)=>{var _0x111148=_0x30b306;if(_0xb360d==_0x111148(0x12a)&&_0x5a7c8b==_0x1372b5){var _0x40cf81=_0x37c9a5[_0x111148(0x12b)](0x3);_0x2b0352[_0x5a7c8b]['storage']=_0x37c9a5[0x0],_0x2b0352[_0x5a7c8b]['rack']=_0x37c9a5[0x1],_0x2b0352[_0x5a7c8b][_0x111148(0x17c)]=0x0,_0x2b0352[_0x5a7c8b][_0x111148(0x14a)]=0x0,_0x2b0352[_0x5a7c8b]['type']=_0x111148(0x1d1),_0x2b0352[_0x5a7c8b][_0x111148(0x1fc)]=_0x40cf81;}else{if(_0xb360d=='Shelves'&&_0x5a7c8b==_0x1372b5){var _0x40cf81=_0x37c9a5['slice'](0x3);_0x2b0352[_0x5a7c8b][_0x111148(0x18e)]=_0x37c9a5[0x0],_0x2b0352[_0x5a7c8b]['rack']=_0x37c9a5[0x1],_0x2b0352[_0x5a7c8b][_0x111148(0x17c)]=0x0,_0x2b0352[_0x5a7c8b][_0x111148(0x14a)]=0x0,_0x2b0352[_0x5a7c8b][_0x111148(0x150)]=_0x111148(0x1d1),_0x2b0352[_0x5a7c8b][_0x111148(0x1fc)]=_0x37c9a5[0x5];}else{if(_0x5a7c8b==_0x1372b5){var _0x489ead;if(_0x37c9a5[0x4]=='L')_0x489ead=_0x111148(0x1f7);else _0x37c9a5[0x4]=='F'&&(_0x489ead=_0x111148(0x1d1));_0x2b0352[_0x5a7c8b][_0x111148(0x18e)]=_0x37c9a5[0x0],_0x2b0352[_0x5a7c8b][_0x111148(0x1cf)]=_0x37c9a5[0x1],_0x2b0352[_0x5a7c8b]['bay']=_0x37c9a5[0x2],_0x2b0352[_0x5a7c8b][_0x111148(0x14a)]=_0x37c9a5[0x3],_0x2b0352[_0x5a7c8b][_0x111148(0x150)]=_0x489ead,_0x2b0352[_0x5a7c8b][_0x111148(0x1fc)]=_0x37c9a5[0x5];}}}});}),_0x3a1f83[_0x1f3838(0x183)]((_0x3c09be,_0x2d9ce0)=>{var _0x234e70=_0x1f3838;_0x2b0352[_0x2d9ce0][_0x234e70(0x181)]=_0x3c09be;}),_0x22accb[_0x1f3838(0x183)]((_0xe4221a,_0x4a4ecc)=>{var _0x517a50=_0x1f3838;_0x2b0352[_0x4a4ecc][_0x517a50(0x1ad)]=_0xe4221a;}),_0x4aa368['forEach']((_0x380adb,_0x16b3c9)=>{var _0x39eb64=_0x1f3838;_0x2b0352[_0x16b3c9][_0x39eb64(0x136)]=_0x380adb;}),_0x2666ab[_0x1f3838(0x183)]((_0x1be9b0,_0x586955)=>{var _0x4f875b=_0x1f3838;_0x2b0352[_0x586955][_0x4f875b(0x1a9)]=_0x1be9b0;}),_0x2d7d9f['forEach']((_0x41863,_0x22d250)=>{var _0x55c6eb=_0x1f3838;_0x2b0352[_0x22d250][_0x55c6eb(0x1cd)]=_0x41863;}),_0x12b9aa[_0x1f3838(0x183)]((_0x535eff,_0x368a68)=>{var _0x369f18=_0x1f3838;_0x2b0352[_0x368a68][_0x369f18(0x1d4)]=_0x535eff;}),_0x36e81c[_0x1f3838(0x183)]((_0x645e6b,_0x836b56)=>{var _0x51f049=_0x1f3838;_0x2b0352[_0x836b56][_0x51f049(0x19c)]=_0x645e6b;}),_0x32ff86[_0x1f3838(0x183)]((_0x47ccf7,_0x475e5)=>{var _0x3fb948=_0x1f3838;_0x2b0352[_0x475e5][_0x3fb948(0x175)]=_0x47ccf7;}),_0x4034c2[_0x1f3838(0x183)]((_0x55b8ea,_0x50d77c)=>{var _0xea862d=_0x1f3838;_0x2b0352[_0x50d77c][_0xea862d(0x158)]=_0x55b8ea;}),_0xb86858[_0x1f3838(0x183)]((_0x18ecd0,_0x5e6690)=>{_0x2b0352[_0x5e6690]['expiry_date']=_0x18ecd0;}),_0x31776a['forEach']((_0x3a5611,_0x14d951)=>{var _0x28289e=_0x1f3838;_0x2b0352[_0x14d951][_0x28289e(0x130)]=_0x3a5611;}),_0x2d035c['forEach']((_0x348064,_0x35d8de)=>{var _0x38c254=_0x1f3838;_0x2b0352[_0x35d8de][_0x38c254(0x1be)]=_0x348064;}),_0x162938['forEach']((_0xc1a98b,_0x2e4bfd)=>{var _0x2b0725=_0x1f3838;_0x2b0352[_0x2e4bfd][_0x2b0725(0x1bb)]=_0xc1a98b;}),_0xf532c8[_0x1f3838(0x183)]((_0x5771c5,_0x3357be)=>{_0x2b0352[_0x3357be]['room_names']=_0x5771c5;}),_0x419ed0[_0x1f3838(0x183)]((_0x190162,_0x2e9252)=>{_0x2b0352[_0x2e9252]['primary_code']=_0x190162;}),_0x46206d['forEach']((_0x2347da,_0x4a4396)=>{var _0xbe61e5=_0x1f3838;_0x2b0352[_0x4a4396][_0xbe61e5(0x1a2)]=_0x2347da;}),_0x541820[_0x1f3838(0x183)]((_0x3c88fc,_0x168780)=>{var _0x517a23=_0x1f3838;_0x2b0352[_0x168780][_0x517a23(0x124)]=_0x3c88fc;});const _0x21f1a7=_0x2b0352[_0x1f3838(0x1ec)](_0x1de56b=>_0x1de56b['adjust_qty']!=='0'&&_0x1de56b[_0x1f3838(0x1a9)]!=='');var _0x2c4a88=0x0;_0x21f1a7['forEach'](_0x4d50be=>{var _0x1889ad=_0x1f3838;console[_0x1889ad(0x17d)](_0x1889ad(0x1da),_0x4d50be),parseInt(_0x4d50be[_0x1889ad(0x1a9)])<=0x0&&_0x2c4a88++;});if(_0x2c4a88!=0x0)return _0x1c006e[_0x1f3838(0x173)](_0x1f3838(0x1de),_0x1f3838(0x187)),_0x5de4e5[_0x1f3838(0x1e7)](_0x1f3838(0x1dd));const _0x296310=new adjustment({'warehouse_name':_0x1c57d1,'date':_0x4248db,'product':_0x21f1a7,'note':_0x276976,'room':_0x3d07c2,'invoice':_0x2b2e3f,'JO_number':_0x31ba60,'expiry_date':_0x26d27d}),_0x1a5b8a=await _0x296310['save']();_0x1c006e[_0x1f3838(0x173)](_0x1f3838(0x1a7),'adjustment\x20add\x20successfull'),_0x5de4e5[_0x1f3838(0x1e7)]('/adjustment/preview/'+_0x1a5b8a[_0x1f3838(0x154)]);}catch(_0x550439){console[_0x1f3838(0x17d)](_0x550439),_0x5de4e5[_0x1f3838(0x167)](0xc8)[_0x1f3838(0x16b)]({'message':_0x550439[_0x1f3838(0x1ea)]});}}),router[a0_0x36bd9f(0x161)](a0_0x36bd9f(0x1a4),auth,async(_0x5178d4,_0x14b93c)=>{var _0x4e62a6=a0_0x36bd9f;try{const {username:_0x3a9828,email:_0x11bfac,role:_0x116417}=_0x5178d4['user'],_0x410886=_0x5178d4[_0x4e62a6(0x1e8)],_0x561a60=await profile[_0x4e62a6(0x16f)]({'email':_0x410886[_0x4e62a6(0x196)]}),_0x61bb83=await master_shop[_0x4e62a6(0x133)](),_0xc3d6df=_0x5178d4[_0x4e62a6(0x13c)]['id'],_0x3d4427=await adjustment[_0x4e62a6(0x16d)]({'_id':_0xc3d6df}),_0x1ea0da=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3d4427['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x4e62a6(0x12e)}}]),_0x11be39=await product[_0x4e62a6(0x133)]({}),_0x56646a=await warehouse[_0x4e62a6(0x1f8)]([{'$match':{'name':_0x3d4427[_0x4e62a6(0x1e1)]}},{'$unwind':_0x4e62a6(0x1f0)},{'$group':{'_id':_0x4e62a6(0x14e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4e62a6(0x155)},'bay':{'$first':_0x4e62a6(0x174)},'bin':{'$first':_0x4e62a6(0x1c5)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4e62a6(0x188)},'secondary_code':{'$first':_0x4e62a6(0x1cb)},'product_code':{'$first':_0x4e62a6(0x1f4)},'storage':{'$first':_0x4e62a6(0x176)},'rack':{'$first':_0x4e62a6(0x1e9)},'maxPerUnit':{'$first':_0x4e62a6(0x13f)},'expiry_date':{'$first':_0x4e62a6(0x19a)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4e62a6(0x125)},'room':{'$first':'$room'}}}]);if(_0x61bb83[0x0]['language']==_0x4e62a6(0x1a5)){var _0x493695=users[_0x4e62a6(0x1d6)];console[_0x4e62a6(0x17d)](_0x493695);}else{if(_0x61bb83[0x0]['language']==_0x4e62a6(0x163))var _0x493695=users[_0x4e62a6(0x163)];else{if(_0x61bb83[0x0][_0x4e62a6(0x1d7)]==_0x4e62a6(0x186))var _0x493695=users[_0x4e62a6(0x186)];else{if(_0x61bb83[0x0]['language']==_0x4e62a6(0x15b))var _0x493695=users[_0x4e62a6(0x15b)];else{if(_0x61bb83[0x0][_0x4e62a6(0x1d7)]==_0x4e62a6(0x145))var _0x493695=users[_0x4e62a6(0x145)];else{if(_0x61bb83[0x0][_0x4e62a6(0x1d7)]==_0x4e62a6(0x160))var _0x493695=users[_0x4e62a6(0x142)];else{if(_0x61bb83[0x0]['language']==_0x4e62a6(0x153))var _0x493695=users[_0x4e62a6(0x153)];else{if(_0x61bb83[0x0][_0x4e62a6(0x1d7)]==_0x4e62a6(0x156))var _0x493695=users[_0x4e62a6(0x1bd)];}}}}}}}_0x14b93c['render'](_0x4e62a6(0x18f),{'success':_0x5178d4[_0x4e62a6(0x173)](_0x4e62a6(0x1a7)),'errors':_0x5178d4['flash'](_0x4e62a6(0x1de)),'role':_0x410886,'profile':_0x561a60,'adjustment':_0x3d4427,'stock':_0x56646a,'master_shop':_0x61bb83,'warehouse_name':_0x1ea0da,'unit':_0x11be39,'language':_0x493695});}catch(_0x1d49c9){console[_0x4e62a6(0x17d)](_0x1d49c9),_0x14b93c['status'](0xc8)[_0x4e62a6(0x16b)]({'message':_0x1d49c9[_0x4e62a6(0x1ea)]});}}),router[a0_0x36bd9f(0x17a)](a0_0x36bd9f(0x1a4),auth,async(_0x17919c,_0x12d70c)=>{var _0x9d3951=a0_0x36bd9f;try{const _0x238219=_0x17919c[_0x9d3951(0x13c)]['id'],{warehouse_name:_0x15e1b1,Room_name:_0x3961d2}=_0x17919c[_0x9d3951(0x1e6)],_0x24798e=await adjustment[_0x9d3951(0x16d)]({'_id':_0x238219}),_0x11d03e=_0x24798e[_0x9d3951(0x19d)]['map'](async _0x120cce=>{var _0x308544=_0x9d3951;if(_0x120cce[_0x308544(0x1a9)]>0x0){var _0x4d3d87=await warehouse['findOne']({'name':_0x15e1b1,'room':_0x120cce[_0x308544(0x1af)],'warehouse_category':_0x308544(0x128)});const _0x3f587c=_0x4d3d87[_0x308544(0x18d)]['map'](_0x3d8097=>{var _0x3ab651=_0x308544;console[_0x3ab651(0x17d)](_0x120cce[_0x3ab651(0x136)]+_0x3ab651(0x1f3));if(_0x120cce[_0x3ab651(0x136)]==_0x3ab651(0x1a0)){if(_0x3d8097['product_name']==_0x120cce[_0x3ab651(0x12d)]&&_0x3d8097['floorlevel']==_0x120cce[_0x3ab651(0x1fc)]&&_0x3d8097['type']==_0x120cce[_0x3ab651(0x150)]&&_0x3d8097[_0x3ab651(0x14a)]==_0x120cce[_0x3ab651(0x14a)]&&_0x3d8097[_0x3ab651(0x17c)]==_0x120cce[_0x3ab651(0x17c)]&&_0x3d8097['rack']==_0x120cce[_0x3ab651(0x1cf)]&&_0x3d8097[_0x3ab651(0x18e)]==_0x120cce[_0x3ab651(0x18e)]&&_0x3d8097[_0x3ab651(0x180)]==_0x120cce[_0x3ab651(0x180)]&&_0x3d8097[_0x3ab651(0x158)]==_0x120cce[_0x3ab651(0x158)]&&_0x3d8097[_0x3ab651(0x1be)]==_0x120cce[_0x3ab651(0x1be)]&&_0x3d8097[_0x3ab651(0x124)]==_0x120cce[_0x3ab651(0x124)]&&_0x3d8097[_0x3ab651(0x154)]==_0x120cce['id_transaction_from']){var _0x315ba0;_0x315ba0=_0x120cce[_0x3ab651(0x1a9)],_0x120cce[_0x3ab651(0x1bb)]=='S'&&(_0x315ba0=_0x120cce['adjust_qty']),_0x3d8097['product_stock']=_0x3d8097[_0x3ab651(0x1eb)]-_0x315ba0;}}else{if(_0x3d8097[_0x3ab651(0x12d)]==_0x120cce[_0x3ab651(0x12d)]&&_0x3d8097[_0x3ab651(0x1fc)]==_0x120cce['floorlevel']&&_0x3d8097[_0x3ab651(0x150)]==_0x120cce[_0x3ab651(0x150)]&&_0x3d8097[_0x3ab651(0x14a)]==_0x120cce[_0x3ab651(0x14a)]&&_0x3d8097['bay']==_0x120cce[_0x3ab651(0x17c)]&&_0x3d8097['rack']==_0x120cce[_0x3ab651(0x1cf)]&&_0x3d8097[_0x3ab651(0x18e)]==_0x120cce[_0x3ab651(0x18e)]&&_0x3d8097['expiry_date']==_0x120cce[_0x3ab651(0x180)]&&_0x3d8097[_0x3ab651(0x158)]==_0x120cce[_0x3ab651(0x158)]&&_0x3d8097[_0x3ab651(0x1be)]==_0x120cce[_0x3ab651(0x1be)]&&_0x3d8097[_0x3ab651(0x124)]==_0x120cce[_0x3ab651(0x124)]&&_0x3d8097[_0x3ab651(0x154)]==_0x120cce[_0x3ab651(0x1ad)]){console[_0x3ab651(0x17d)](_0x120cce);var _0x315ba0;_0x315ba0=_0x120cce[_0x3ab651(0x1a9)],_0x120cce[_0x3ab651(0x1bb)]=='S'&&(_0x315ba0=_0x120cce[_0x3ab651(0x1a9)]),_0x3d8097['product_stock']=_0x3d8097[_0x3ab651(0x1eb)]+_0x315ba0;}}});}return _0x4d3d87;});Promise[_0x9d3951(0x1ce)](_0x11d03e)[_0x9d3951(0x193)](async _0x4c8474=>{var _0x1f48b1=_0x9d3951;try{for(const _0x24094b of _0x4c8474){await _0x24094b[_0x1f48b1(0x182)]();}_0x24798e[_0x1f48b1(0x1d8)]=_0x1f48b1(0x169);const _0x2402e2=await _0x24798e['save'](),_0x3cd9ea=await master_shop[_0x1f48b1(0x133)](),_0x2a116d=await email_settings[_0x1f48b1(0x16f)](),_0x38b9ca=await supervisor_settings[_0x1f48b1(0x133)]();var _0x3ba4e5=_0x24798e['product'],_0x2aa2fe='',_0x33bae3;for(_0x33bae3 in _0x3ba4e5){_0x2aa2fe+=_0x1f48b1(0x162)+_0x1f48b1(0x1bc)+_0x3ba4e5[_0x33bae3]['product_name']+_0x1f48b1(0x13b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3ba4e5[_0x33bae3][_0x1f48b1(0x175)]+'</td>'+_0x1f48b1(0x1bc)+_0x3ba4e5[_0x33bae3][_0x1f48b1(0x1a9)]+_0x1f48b1(0x13b)+_0x1f48b1(0x1bc)+_0x3ba4e5[_0x33bae3]['unit']+'</td>'+_0x1f48b1(0x1bc)+_0x3ba4e5[_0x33bae3][_0x1f48b1(0x19c)]+_0x1f48b1(0x13b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x24798e[_0x1f48b1(0x1e1)]+_0x1f48b1(0x13b)+_0x1f48b1(0x1bc)+_0x3ba4e5[_0x33bae3][_0x1f48b1(0x1af)]+_0x1f48b1(0x13b)+_0x1f48b1(0x1bc)+_0x3ba4e5[_0x33bae3]['storage']+_0x3ba4e5[_0x33bae3][_0x1f48b1(0x1cf)]+_0x3ba4e5[_0x33bae3]['bay']+_0x3ba4e5[_0x33bae3][_0x1f48b1(0x14a)]+_0x3ba4e5[_0x33bae3][_0x1f48b1(0x150)][0x0]+_0x3ba4e5[_0x33bae3][_0x1f48b1(0x1fc)]+'</td>','</tr>';}let _0x32e07d=nodemailer[_0x1f48b1(0x17b)]({'host':_0x2a116d[_0x1f48b1(0x1ac)],'port':Number(_0x2a116d[_0x1f48b1(0x132)]),'secure':![],'auth':{'user':_0x2a116d[_0x1f48b1(0x196)],'pass':_0x2a116d[_0x1f48b1(0x157)]}}),_0x21ab60={'from':_0x2a116d['email'],'to':_0x38b9ca[0x0][_0x1f48b1(0x146)],'subject':_0x1f48b1(0x1a1),'attachments':[{'filename':_0x1f48b1(0x1e4),'path':__dirname+_0x1f48b1(0x1c3)+_0x1f48b1(0x1b2)+_0x3cd9ea[0x0][_0x1f48b1(0x1ef)],'cid':_0x1f48b1(0x165)}],'html':_0x1f48b1(0x1aa)+'<html><head><title></title>'+_0x1f48b1(0x13a)+_0x1f48b1(0x15f)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x1f48b1(0x15f)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x1f48b1(0x15f)+_0x1f48b1(0x123)+_0x3cd9ea[0x0][_0x1f48b1(0x195)]+_0x1f48b1(0x179)+_0x1f48b1(0x197)+_0x1f48b1(0x197)+'<hr\x20class=\x22my-3\x22>'+_0x1f48b1(0x15f)+_0x1f48b1(0x1e2)+_0x1f48b1(0x139)+_0x24798e[_0x1f48b1(0x124)]+'\x20'+_0x1f48b1(0x19f)+_0x1f48b1(0x1b4)+_0x24798e['date']+'\x20'+_0x1f48b1(0x13d)+_0x1f48b1(0x151)+'</div>'+_0x1f48b1(0x148)+_0x1f48b1(0x1c6)+'<tr>'+_0x1f48b1(0x1fb)+_0x1f48b1(0x1f2)+_0x1f48b1(0x144)+_0x1f48b1(0x126)+_0x1f48b1(0x17f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x1f48b1(0x1ca)+_0x1f48b1(0x1f9)+_0x1f48b1(0x1e0)+_0x1f48b1(0x168)+_0x1f48b1(0x1b9)+'\x20'+_0x2aa2fe+'\x20'+'</tbody>'+'</table>'+'<div>'+_0x1f48b1(0x1cc)+'<h5>'+_0x3cd9ea[0x0][_0x1f48b1(0x195)]+_0x1f48b1(0x151)+_0x1f48b1(0x197)+_0x1f48b1(0x197)+_0x1f48b1(0x12f)};_0x32e07d[_0x1f48b1(0x141)](_0x21ab60,function(_0x5970d5,_0x2d980b){var _0x309db2=_0x1f48b1;_0x5970d5?(console[_0x309db2(0x17d)](_0x5970d5),console[_0x309db2(0x17d)](_0x309db2(0x1a6))):console['log'](_0x309db2(0x19b));}),_0x17919c[_0x1f48b1(0x173)]('success','adjustment\x20Finalized\x20successfully'),_0x12d70c[_0x1f48b1(0x1e7)](_0x1f48b1(0x171)+_0x2402e2[_0x1f48b1(0x154)]);}catch(_0x334f3f){console['error'](_0x334f3f),_0x12d70c[_0x1f48b1(0x167)](0x1f4)[_0x1f48b1(0x16b)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})['catch'](_0x2a8d83=>{var _0x248fef=_0x9d3951;console[_0x248fef(0x1ed)](_0x2a8d83),_0x12d70c[_0x248fef(0x167)](0x1f4)[_0x248fef(0x16b)]({'error':_0x248fef(0x1fa)});});}catch(_0x4ec3df){console[_0x9d3951(0x17d)](_0x4ec3df),_0x12d70c[_0x9d3951(0x167)](0xc8)[_0x9d3951(0x16b)]({'message':_0x4ec3df[_0x9d3951(0x1ea)]});}}),router[a0_0x36bd9f(0x161)](a0_0x36bd9f(0x14c),auth,async(_0x3a8977,_0x25a7fc)=>{var _0x53ecd9=a0_0x36bd9f;try{const {username:_0x4fd55c,email:_0x32fc8e,role:_0x3f7120}=_0x3a8977[_0x53ecd9(0x1e8)],_0x54da0a=_0x3a8977[_0x53ecd9(0x1e8)],_0x12b96f=await profile['findOne']({'email':_0x54da0a[_0x53ecd9(0x196)]}),_0x334dc3=await master_shop[_0x53ecd9(0x133)](),_0x5c4f77=_0x3a8977['params']['id'],_0xa83da8=await adjustment[_0x53ecd9(0x16d)]({'_id':_0x5c4f77}),_0x33f7fb=await purchases[_0x53ecd9(0x1f8)]([{'$match':{'warehouse_name':_0xa83da8[_0x53ecd9(0x1e1)]}},{'$unwind':'$product'},{'$group':{'_id':_0x53ecd9(0x12e)}}]),_0x2f39ee=await product['find']({}),_0x2358b3=await warehouse[_0x53ecd9(0x1f8)]([{'$match':{'name':_0xa83da8[_0x53ecd9(0x1e1)]}},{'$unwind':_0x53ecd9(0x1f0)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x53ecd9(0x155)},'bay':{'$first':_0x53ecd9(0x174)},'bin':{'$first':_0x53ecd9(0x1c5)},'type':{'$first':_0x53ecd9(0x1c2)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x53ecd9(0x1cb)},'product_code':{'$first':_0x53ecd9(0x1f4)},'storage':{'$first':_0x53ecd9(0x176)},'rack':{'$first':_0x53ecd9(0x1e9)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x53ecd9(0x19a)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x53ecd9(0x125)},'room':{'$first':'$room'}}}]);let _0x1f23eb;if(_0x54da0a['role']==_0x53ecd9(0x14b)){const _0x24c2a7=await staff[_0x53ecd9(0x16f)]({'email':_0x54da0a[_0x53ecd9(0x196)]});_0x1f23eb=await warehouse[_0x53ecd9(0x1f8)]([{'$match':{'status':'Enabled','name':_0x24c2a7['warehouse'],'warehouse_category':_0x53ecd9(0x128),'name':{'$ne':_0x53ecd9(0x122)}}},{'$group':{'_id':_0x53ecd9(0x152),'name':{'$first':_0x53ecd9(0x152)}}}]);}else _0x1f23eb=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':_0x53ecd9(0x122)}}},{'$group':{'_id':_0x53ecd9(0x152),'name':{'$first':_0x53ecd9(0x152)}}}]);if(_0x334dc3[0x0][_0x53ecd9(0x1d7)]==_0x53ecd9(0x1a5)){var _0x225e30=users[_0x53ecd9(0x1d6)];console[_0x53ecd9(0x17d)](_0x225e30);}else{if(_0x334dc3[0x0]['language']=='Hindi')var _0x225e30=users[_0x53ecd9(0x163)];else{if(_0x334dc3[0x0][_0x53ecd9(0x1d7)]==_0x53ecd9(0x186))var _0x225e30=users[_0x53ecd9(0x186)];else{if(_0x334dc3[0x0][_0x53ecd9(0x1d7)]=='Spanish')var _0x225e30=users[_0x53ecd9(0x15b)];else{if(_0x334dc3[0x0]['language']=='French')var _0x225e30=users['French'];else{if(_0x334dc3[0x0][_0x53ecd9(0x1d7)]==_0x53ecd9(0x160))var _0x225e30=users[_0x53ecd9(0x142)];else{if(_0x334dc3[0x0][_0x53ecd9(0x1d7)]=='Chinese')var _0x225e30=users['Chinese'];else{if(_0x334dc3[0x0][_0x53ecd9(0x1d7)]==_0x53ecd9(0x156))var _0x225e30=users['Arabic'];}}}}}}}_0x25a7fc[_0x53ecd9(0x1f1)](_0x53ecd9(0x1d5),{'success':_0x3a8977[_0x53ecd9(0x173)](_0x53ecd9(0x1a7)),'errors':_0x3a8977[_0x53ecd9(0x173)](_0x53ecd9(0x1de)),'role':_0x54da0a,'profile':_0x12b96f,'adjustment':_0xa83da8,'stock':_0x2358b3,'master_shop':_0x334dc3,'warehouse_name':_0x33f7fb,'unit':_0x2f39ee,'language':_0x225e30,'warehouse':_0x1f23eb});}catch(_0xc30508){console[_0x53ecd9(0x17d)](_0xc30508),_0x25a7fc[_0x53ecd9(0x167)](0xc8)[_0x53ecd9(0x16b)]({'message':_0xc30508[_0x53ecd9(0x1ea)]});}}),router[a0_0x36bd9f(0x17a)](a0_0x36bd9f(0x14c),auth,async(_0x4b4f66,_0x78ec6e)=>{var _0x1686f6=a0_0x36bd9f;try{const _0x139d03=_0x4b4f66[_0x1686f6(0x13c)]['id'],_0x58dd90=await adjustment['findById']({'_id':_0x139d03}),_0x55310b=await warehouse[_0x1686f6(0x16f)]({'name':_0x58dd90[_0x1686f6(0x1e1)],'room':_0x58dd90[_0x1686f6(0x1c9)]}),{warehouse_name:_0x5f04c1,date:_0x56bafd,prod_name:_0x41d0b3,level:_0xd579be,isle:_0x29af00,pallet:_0x597600,stock:_0x49226b,types:_0x541a5f,adjust_qty:_0x22ba0c,new_adjust_qty:_0x5f0c9c,note:_0x1532c5,Room_name:_0x5bf517,invoice:_0x2fc3e5,JO_number:_0x10ca8e,expiry_date:_0x8381c3}=_0x4b4f66[_0x1686f6(0x1e6)];if(typeof _0x41d0b3==_0x1686f6(0x1bf))var _0x451ba8=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1d0)]],_0x611789=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1f5)]],_0x6a0002=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x191)]],_0x2626e3=[_0x4b4f66['body'][_0x1686f6(0x136)]],_0x24b54b=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1db)]],_0x4f6926=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1b8)]],_0x2d277c=[_0x4b4f66[_0x1686f6(0x1e6)]['Primary_Units']],_0xaf4612=[_0x4b4f66[_0x1686f6(0x1e6)]['Secondary_units']],_0x3311f8=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x16a)]],_0x7e776b=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x158)]],_0x196a57=[_0x4b4f66['body']['expiry_date']],_0x307f40=[_0x4b4f66['body']['max_per_unit']],_0x228d25=[_0x4b4f66[_0x1686f6(0x1e6)]['production_date']],_0x393444=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1bb)]],_0x58e52a=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x15d)]],_0x294528=[_0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x134)]],_0x38374e=[_0x4b4f66[_0x1686f6(0x1e6)]['second1']];else var _0x451ba8=[..._0x4b4f66['body'][_0x1686f6(0x1d0)]],_0x611789=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1f5)]],_0x6a0002=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x191)]],_0x2626e3=[..._0x4b4f66['body']['types']],_0x24b54b=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1db)]],_0x4f6926=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1b8)]],_0x2d277c=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1d4)]],_0xaf4612=[..._0x4b4f66[_0x1686f6(0x1e6)]['Secondary_units']],_0x3311f8=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x16a)]],_0x7e776b=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x158)]],_0x196a57=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x180)]],_0x307f40=[..._0x4b4f66[_0x1686f6(0x1e6)]['max_per_unit']],_0x228d25=[..._0x4b4f66['body']['production_date']],_0x393444=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x1bb)]],_0x58e52a=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x15d)]],_0x294528=[..._0x4b4f66[_0x1686f6(0x1e6)]['prime1']],_0x38374e=[..._0x4b4f66[_0x1686f6(0x1e6)][_0x1686f6(0x127)]];const _0x2cb286=_0x451ba8['map'](_0x28cc44=>{return _0x28cc44={'product_name':_0x28cc44};});_0x611789[_0x1686f6(0x183)]((_0x5ce9a4,_0x39a1ca)=>{var _0x200d4c=_0x1686f6;_0x58e52a[_0x200d4c(0x183)]((_0x3de485,_0x1886f9)=>{var _0x13bc33=_0x200d4c;if(_0x3de485==_0x13bc33(0x12a)&&_0x39a1ca==_0x1886f9){var _0x565d34=_0x5ce9a4[_0x13bc33(0x12b)](0x3);_0x2cb286[_0x39a1ca][_0x13bc33(0x18e)]=_0x5ce9a4[0x0],_0x2cb286[_0x39a1ca]['rack']=_0x5ce9a4[0x1],_0x2cb286[_0x39a1ca]['bay']=0x0,_0x2cb286[_0x39a1ca][_0x13bc33(0x14a)]=0x0,_0x2cb286[_0x39a1ca][_0x13bc33(0x150)]=_0x13bc33(0x1d1),_0x2cb286[_0x39a1ca][_0x13bc33(0x1fc)]=_0x565d34;}else{if(_0x3de485==_0x13bc33(0x1ee)&&_0x39a1ca==_0x1886f9){var _0x565d34=_0x5ce9a4[_0x13bc33(0x12b)](0x3);_0x2cb286[_0x39a1ca][_0x13bc33(0x18e)]=_0x5ce9a4[0x0],_0x2cb286[_0x39a1ca][_0x13bc33(0x1cf)]=_0x5ce9a4[0x1],_0x2cb286[_0x39a1ca]['bay']=0x0,_0x2cb286[_0x39a1ca]['bin']=0x0,_0x2cb286[_0x39a1ca][_0x13bc33(0x150)]=_0x13bc33(0x1d1),_0x2cb286[_0x39a1ca]['floorlevel']=_0x5ce9a4[0x5];}else{if(_0x39a1ca==_0x1886f9){var _0x42b7f1;if(_0x5ce9a4[0x4]=='L')_0x42b7f1=_0x13bc33(0x1f7);else _0x5ce9a4[0x4]=='F'&&(_0x42b7f1=_0x13bc33(0x1d1));_0x2cb286[_0x39a1ca][_0x13bc33(0x18e)]=_0x5ce9a4[0x0],_0x2cb286[_0x39a1ca][_0x13bc33(0x1cf)]=_0x5ce9a4[0x1],_0x2cb286[_0x39a1ca][_0x13bc33(0x17c)]=_0x5ce9a4[0x2],_0x2cb286[_0x39a1ca][_0x13bc33(0x14a)]=_0x5ce9a4[0x3],_0x2cb286[_0x39a1ca][_0x13bc33(0x150)]=_0x42b7f1,_0x2cb286[_0x39a1ca][_0x13bc33(0x1fc)]=_0x5ce9a4[0x5];}}}});}),_0x6a0002[_0x1686f6(0x183)]((_0xbba207,_0x35243b)=>{var _0x5123e1=_0x1686f6;_0x2cb286[_0x35243b][_0x5123e1(0x181)]=_0xbba207;}),_0x2626e3[_0x1686f6(0x183)]((_0x58357f,_0x507b32)=>{var _0x1b4830=_0x1686f6;_0x2cb286[_0x507b32][_0x1b4830(0x136)]=_0x58357f;}),_0x24b54b[_0x1686f6(0x183)]((_0x568d51,_0x46e862)=>{var _0x3662de=_0x1686f6;_0x2cb286[_0x46e862][_0x3662de(0x1a9)]=_0x568d51;}),_0x4f6926[_0x1686f6(0x183)]((_0x465ecd,_0x35e077)=>{_0x2cb286[_0x35e077]['new_adjust_qty']=_0x465ecd;}),_0x2d277c['forEach']((_0x37f115,_0x41fb04)=>{_0x2cb286[_0x41fb04]['unit']=_0x37f115;}),_0xaf4612[_0x1686f6(0x183)]((_0x388b40,_0x3a28cf)=>{var _0x1c385a=_0x1686f6;_0x2cb286[_0x3a28cf][_0x1c385a(0x19c)]=_0x388b40;}),_0x3311f8[_0x1686f6(0x183)]((_0x125687,_0x1838b1)=>{_0x2cb286[_0x1838b1]['product_code']=_0x125687;}),_0x7e776b[_0x1686f6(0x183)]((_0x188bd6,_0x168f43)=>{var _0x5045d1=_0x1686f6;_0x2cb286[_0x168f43][_0x5045d1(0x158)]=_0x188bd6;}),_0x196a57[_0x1686f6(0x183)]((_0x3ccff4,_0x4e234c)=>{var _0x1c580e=_0x1686f6;_0x2cb286[_0x4e234c][_0x1c580e(0x180)]=_0x3ccff4;}),_0x307f40[_0x1686f6(0x183)]((_0x4b1040,_0x459c07)=>{_0x2cb286[_0x459c07]['maxperunit']=_0x4b1040;}),_0x228d25[_0x1686f6(0x183)]((_0x1e7f54,_0x393615)=>{_0x2cb286[_0x393615]['production_date']=_0x1e7f54;}),_0x393444[_0x1686f6(0x183)]((_0x34ec98,_0x2201af)=>{var _0x575d67=_0x1686f6;_0x2cb286[_0x2201af][_0x575d67(0x1bb)]=_0x34ec98;}),_0x58e52a[_0x1686f6(0x183)]((_0x5777a8,_0x9377bc)=>{_0x2cb286[_0x9377bc]['room_names']=_0x5777a8;}),_0x294528[_0x1686f6(0x183)]((_0x250fa7,_0x3c382d)=>{var _0x2f4d3e=_0x1686f6;_0x2cb286[_0x3c382d][_0x2f4d3e(0x121)]=_0x250fa7;}),_0x38374e['forEach']((_0x2c3aed,_0x2bb635)=>{var _0x5f5923=_0x1686f6;_0x2cb286[_0x2bb635][_0x5f5923(0x1a2)]=_0x2c3aed;});const _0x120e2b=_0x2cb286[_0x1686f6(0x1ec)](_0x15a8ca=>_0x15a8ca[_0x1686f6(0x1a9)]!=='0'&&_0x15a8ca[_0x1686f6(0x1a9)]!=='');var _0x30fe80=0x0;_0x120e2b[_0x1686f6(0x183)](_0x30aecf=>{var _0xb6078d=_0x1686f6;console[_0xb6078d(0x17d)](_0xb6078d(0x1da),_0x30aecf),parseInt(_0x30aecf[_0xb6078d(0x1a9)])<=0x0&&_0x30fe80++;});if(_0x30fe80!=0x0)return _0x4b4f66[_0x1686f6(0x173)](_0x1686f6(0x1de),_0x1686f6(0x187)),_0x78ec6e[_0x1686f6(0x1e7)]('back');_0x58dd90[_0x1686f6(0x1e1)]=_0x5f04c1,_0x58dd90[_0x1686f6(0x15c)]=_0x56bafd,_0x58dd90[_0x1686f6(0x19d)]=_0x120e2b,_0x58dd90[_0x1686f6(0x138)]=_0x1532c5,_0x58dd90[_0x1686f6(0x124)]=_0x2fc3e5,_0x58dd90[_0x1686f6(0x1c0)]='False';const _0x225b66=await _0x58dd90['save']();_0x4b4f66[_0x1686f6(0x173)](_0x1686f6(0x1a7),_0x1686f6(0x19e)),_0x78ec6e[_0x1686f6(0x1e7)](_0x1686f6(0x1ba));}catch(_0x23b31f){console[_0x1686f6(0x17d)](_0x23b31f);}}),router[a0_0x36bd9f(0x17a)]('/barcode_scanner',async(_0x6ed0f5,_0x34f1bc)=>{var _0x4a25b6=a0_0x36bd9f;const {primary_code:_0x37310e,warehouse_data:_0x17490f,rooms_data:_0x506c35,Roomslist:_0x4ab0c4}=_0x6ed0f5[_0x4a25b6(0x1e6)],_0xdbaabb=_0x4ab0c4[_0x4a25b6(0x16e)](','),_0x2f2ce4=[];async function _0x5b4aa5(_0x9189eb){var _0x2f8973=_0x4a25b6;const _0x5d39bd=await warehouse[_0x2f8973(0x1f8)]([{'$match':{'name':_0x17490f,'room':_0x9189eb}},{'$unwind':_0x2f8973(0x1f0)},{'$match':{'product_details.primary_code':_0x37310e}},{'$group':{'_id':_0x2f8973(0x14e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x2f8973(0x188)},'secondary_code':{'$first':_0x2f8973(0x1cb)},'product_code':{'$first':_0x2f8973(0x1f4)},'level':{'$first':_0x2f8973(0x174)},'isle':{'$first':_0x2f8973(0x1c5)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2f8973(0x12c)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x2f8973(0x176)},'rack':{'$first':_0x2f8973(0x1e9)},'expiry_date':{'$first':_0x2f8973(0x19a)},'production_date':{'$first':_0x2f8973(0x1ae)},'maxPerUnit':{'$first':_0x2f8973(0x13f)},'batch_code':{'$first':_0x2f8973(0x125)},'product_cat':{'$first':_0x2f8973(0x1b6)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x2f8973(0x1c4)}}}]),_0xa3fca3=await warehouse['aggregate']([{'$match':{'name':_0x17490f,'room':_0x9189eb}},{'$unwind':_0x2f8973(0x1f0)},{'$match':{'product_details.secondary_code':_0x37310e}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2f8973(0x149)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2f8973(0x1cb)},'product_code':{'$first':_0x2f8973(0x1f4)},'level':{'$first':_0x2f8973(0x174)},'isle':{'$first':_0x2f8973(0x1c5)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2f8973(0x190)},'unit':{'$first':_0x2f8973(0x12c)},'secondary_unit':{'$first':_0x2f8973(0x1d2)},'storage':{'$first':_0x2f8973(0x176)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2f8973(0x125)},'product_cat':{'$first':_0x2f8973(0x1b6)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2f8973(0x185)}}}]);if(_0x5d39bd['length']>0x0)_0x2f2ce4['push'](_0x5d39bd);else _0xa3fca3[_0x2f8973(0x194)]>0x0&&_0x2f2ce4['push'](_0xa3fca3);}const _0x58075a=_0xdbaabb[_0x4a25b6(0x15a)](_0x5b5648=>_0x5b4aa5(_0x5b5648));await Promise[_0x4a25b6(0x1ce)](_0x58075a),_0x34f1bc[_0x4a25b6(0x16b)](_0x2f2ce4);}),router['post'](a0_0x36bd9f(0x1c8),async(_0x1c7b34,_0x45a709)=>{var _0x4a11a1=a0_0x36bd9f;const {primaryCode:_0x23063c,secondaryCode:_0x2c5da9,productCode:_0x5d55b5,level:_0x14cdde,isle:_0x27d962,pallet:_0x1d350a,warehouses:_0x3e143a,room:_0x3de141}=_0x1c7b34['body'];try{const _0x2533e2=await warehouse['aggregate']([{'$match':{'name':_0x3e143a,'room':_0x3de141}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x14cdde),'product_details.isle':_0x27d962,'product_details.pallet':parseInt(_0x1d350a)}},{'$group':{'_id':_0x4a11a1(0x14e),'name':{'$first':_0x4a11a1(0x149)},'product_stock':{'$first':_0x4a11a1(0x155)},'level':{'$first':_0x4a11a1(0x198)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x4a11a1(0x164)}}}]);_0x45a709['status'](0xc8)[_0x4a11a1(0x16b)](_0x2533e2);}catch(_0x41edab){_0x45a709[_0x4a11a1(0x167)](0x194)[_0x4a11a1(0x16b)]({'message':_0x41edab[_0x4a11a1(0x1ea)]});}}),module[a0_0x36bd9f(0x1b5)]=router;