function a0_0x3ca5(_0x34c224,_0x1f1946){var _0x24a61c=a0_0x24a6();return a0_0x3ca5=function(_0x3ca5fe,_0x3596f4){_0x3ca5fe=_0x3ca5fe-0x6a;var _0x5c3bd3=_0x24a61c[_0x3ca5fe];return _0x5c3bd3;},a0_0x3ca5(_0x34c224,_0x1f1946);}var a0_0x374a3a=a0_0x3ca5;(function(_0x56c052,_0x3bd82a){var _0x52344a=a0_0x3ca5,_0x4b7e41=_0x56c052();while(!![]){try{var _0x4bfdf4=-parseInt(_0x52344a(0xdc))/0x1*(parseInt(_0x52344a(0xf9))/0x2)+parseInt(_0x52344a(0x9a))/0x3+parseInt(_0x52344a(0xe4))/0x4*(parseInt(_0x52344a(0xfe))/0x5)+-parseInt(_0x52344a(0xd3))/0x6*(parseInt(_0x52344a(0x9e))/0x7)+-parseInt(_0x52344a(0x11f))/0x8*(-parseInt(_0x52344a(0x124))/0x9)+parseInt(_0x52344a(0xdd))/0xa*(parseInt(_0x52344a(0xd9))/0xb)+-parseInt(_0x52344a(0xce))/0xc;if(_0x4bfdf4===_0x3bd82a)break;else _0x4b7e41['push'](_0x4b7e41['shift']());}catch(_0x280183){_0x4b7e41['push'](_0x4b7e41['shift']());}}}(a0_0x24a6,0xca563));function a0_0x24a6(){var _0x152eed=['</body></html>','<tbody\x20style=\x22text-align:\x20center;\x22>','Enabled','Logo.png','log','<h2>\x20','product','string','prod_code','express','$isAllowEdit','Shelves','\x20<>\x20','New_Qty_Converted_adj','createTransport','/adjustment/view','$room','Arabic','$product_details.type','$product_details.bay','$product.room_names','/upload/','back','image','room_names','storage','$product_details.production_date','/view','warehouse','An\x20error\x20occurred.','3939654xVkrJU','Primary_Units','prod_cat','$product.product_name','11380019kAzSaW','render','save','ADJ-','email','\x20Order\x20Date\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/barcode_scanner','minus','/preview/:id','post','/view/:id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','product_stock','floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','prime1','Return\x20Goods','Floor','sendMail','password','Rooms','padStart','$product_details._id','Adjustment\x20Mail','catch','product_code','foreach\x20newproduct','map','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.rack','$_id','$product_details.storage','New_Qty_Converted','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.expiry_date','add_adjustment','success','batch_code','An\x20error\x20occurred\x20while\x20saving\x20data.','aggregate','params','$product_details.level','findById','Ambient','$product_details.batch_code','Error\x20Occurs','$product_details.maxPerUnit','22781556OjPxnu','adjust_qty','toString','Chinese','English','6NtLnOY','$product_details.unit','filter','$product_details.product_cat','prod_name','/../public','10060952PMMCjW','Portuguese\x20(BR)','slice','143089FVKnlv','10SCJKbM','nodemailer','</h5>','$product_details.floorlevel','<tr>','Receiving\x20Area','Spanish','4lHQCtd','push','$name','</tbody>','Level','date','stockBefore','random','$product_details.isle','$product_details.bin','$product_details.primary_code','findOne','Router','site_title','primary_code','../models/all_models','second1','find','max_per_unit','adjustment\x20Finalized\x20successfully','RMSEmail','2pNhfwB','invoice','<div>','user','$product_details.pallet','6784930IDAvnb','$invoice','German','$product_details.invoice','flash','Portuguese','body','<table\x20style=\x22width:\x20100%\x20!important;\x22>','forEach','\x20</h2>','$product_details.product_name','types','Hindi','floor','<h5>','secondary_code','bay','new_adjust_qty','production_date','</table>','</thead>','</td>','/adjustment/preview/','stock','$product_details.maxProducts','/picking_list/PDF_adjustment_rm/','id_transaction','logo','French','edit_adjustment','_id','adjustment\x20add\x20successfull','get','260344SlMujY','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','secondary_unit','</div>','message','252rmgcaj','/view/add_adjustment','edit_adjustment_view','redirect','level','language','Raw\x20Materials','staff','$product','</span>','prod_invoice','length','$product_details.product_stock','expiry_date','master','all','$warehouse_name','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','product_name','$product_details.product_code','warehouse_name','role','</tr>','unit','maxperunit','error','json','finalize','note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','id_transaction_from','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','type','<!DOCTYPE\x20html>','status','$product_details.secondary_unit','<strong>\x20Regards\x20</strong>','bin','</head><body>','exports','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details','Secondary_units','Arabic\x20(ae)','rack','False','$product_details.secondary_code','errors','<span\x20style=\x22float:\x20right;\x22>','English\x20(US)'];a0_0x24a6=function(){return _0x152eed;};return a0_0x24a6();}const express=require(a0_0x374a3a(0x85)),app=express(),router=express[a0_0x374a3a(0xf0)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x374a3a(0xf3)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x374a3a(0xde));router[a0_0x374a3a(0x11e)](a0_0x374a3a(0x97),auth,async(_0x38ef45,_0x10d360)=>{var _0x10baa8=a0_0x374a3a;try{const {username:_0x6b03d1,email:_0x5672b3,role:_0x3cd11a}=_0x38ef45['user'],_0x7c2e76=_0x38ef45[_0x10baa8(0xfc)],_0x40cd2f=await profile[_0x10baa8(0xef)]({'email':_0x7c2e76[_0x10baa8(0xa2)]}),_0x52411b=await master_shop['find']();console[_0x10baa8(0x80)](_0x10baa8(0x132),_0x52411b);let _0x33c98e;if(_0x7c2e76['role']==_0x10baa8(0x12b)){const _0xd6254b=await staff[_0x10baa8(0xef)]({'email':_0x7c2e76['email']});_0x33c98e=await warehouse['find']({'status':_0x10baa8(0x7e),'name':_0xd6254b['warehouse']});}else _0x33c98e=await warehouse[_0x10baa8(0xf5)]({'status':_0x10baa8(0x7e)});const _0x1a718b=await product[_0x10baa8(0xf5)]();let _0x138fe7;if(_0x7c2e76[_0x10baa8(0x139)]==_0x10baa8(0x12b)){const _0x265340=await staff[_0x10baa8(0xef)]({'email':_0x7c2e76['email']});_0x138fe7=await adjustment['find']({'warehouse_name':_0x265340[_0x10baa8(0x98)]});}else _0x138fe7=await adjustment[_0x10baa8(0xc6)]([{'$unwind':_0x10baa8(0x12c)},{'$group':{'_id':_0x10baa8(0xbd),'invoice':{'$first':_0x10baa8(0xff)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x10baa8(0x134)},'room':{'$addToSet':_0x10baa8(0x90)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x10baa8(0x86)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x52411b[0x0][_0x10baa8(0x129)]==_0x10baa8(0x7b)){var _0xa70fb4=users[_0x10baa8(0xd2)];console[_0x10baa8(0x80)](_0xa70fb4);}else{if(_0x52411b[0x0][_0x10baa8(0x129)]==_0x10baa8(0x10a))var _0xa70fb4=users[_0x10baa8(0x10a)];else{if(_0x52411b[0x0][_0x10baa8(0x129)]==_0x10baa8(0x100))var _0xa70fb4=users[_0x10baa8(0x100)];else{if(_0x52411b[0x0][_0x10baa8(0x129)]=='Spanish')var _0xa70fb4=users[_0x10baa8(0xe3)];else{if(_0x52411b[0x0][_0x10baa8(0x129)]=='French')var _0xa70fb4=users[_0x10baa8(0x11a)];else{if(_0x52411b[0x0][_0x10baa8(0x129)]==_0x10baa8(0xda))var _0xa70fb4=users[_0x10baa8(0x103)];else{if(_0x52411b[0x0][_0x10baa8(0x129)]==_0x10baa8(0xd1))var _0xa70fb4=users['Chinese'];else{if(_0x52411b[0x0][_0x10baa8(0x129)]=='Arabic\x20(ae)')var _0xa70fb4=users[_0x10baa8(0x8d)];}}}}}}}_0x10d360[_0x10baa8(0x9f)]('adjustment',{'success':_0x38ef45['flash'](_0x10baa8(0xc3)),'errors':_0x38ef45[_0x10baa8(0x102)](_0x10baa8(0x79)),'role':_0x7c2e76,'profile':_0x40cd2f,'warehouse':_0x33c98e,'product':_0x1a718b,'adjustment':_0x138fe7,'master_shop':_0x52411b,'language':_0xa70fb4});}catch(_0x28b725){console[_0x10baa8(0x80)](_0x28b725);}});async function getRandom8DigitNumber(){var _0x2cf8ba=a0_0x374a3a;const _0x2b8414=0x989680,_0x205f56=0x5f5e0ff,_0x2cb665=Math[_0x2cf8ba(0x10b)](Math[_0x2cf8ba(0xeb)]()*(_0x205f56-_0x2b8414+0x1))+_0x2b8414;var _0x5d9e21;const _0x8a4b21=await adjustment[_0x2cf8ba(0xef)]({'invoice':_0x2cf8ba(0xa1)+_0x2cb665});return _0x8a4b21&&_0x8a4b21[_0x2cf8ba(0x12f)]>0x0?_0x5d9e21='ADJ-'+_0x2cb665:_0x5d9e21='ADJ-'+_0x2cb665,_0x5d9e21;}router[a0_0x374a3a(0x11e)](a0_0x374a3a(0x125),auth,async(_0x4b31c6,_0x2b24b9)=>{var _0x1c56ae=a0_0x374a3a;try{const {username:_0x38b8ec,email:_0x4f812b,role:_0x489f0a}=_0x4b31c6['user'],_0x25c28b=_0x4b31c6['user'],_0x184476=await profile[_0x1c56ae(0xef)]({'email':_0x25c28b[_0x1c56ae(0xa2)]}),_0x52d0a3=await master_shop[_0x1c56ae(0xf5)]();let _0x21b66a;if(_0x25c28b[_0x1c56ae(0x139)]==_0x1c56ae(0x12b)){const _0x50ea71=await staff[_0x1c56ae(0xef)]({'email':_0x25c28b['email']});_0x21b66a=await warehouse[_0x1c56ae(0xc6)]([{'$match':{'status':'Enabled','name':_0x50ea71['warehouse'],'warehouse_category':_0x1c56ae(0x12a),'name':{'$ne':_0x1c56ae(0xaf)}}},{'$group':{'_id':'$name','name':{'$first':_0x1c56ae(0xe6)}}}]);}else _0x21b66a=await warehouse[_0x1c56ae(0xc6)]([{'$match':{'status':_0x1c56ae(0x7e),'warehouse_category':_0x1c56ae(0x12a),'name':{'$ne':_0x1c56ae(0xaf)}}},{'$group':{'_id':'$name','name':{'$first':_0x1c56ae(0xe6)}}}]);const _0x1a2972=await product[_0x1c56ae(0xf5)]({}),_0x5b47b7=await adjustment[_0x1c56ae(0xf5)]({}),_0x2e9173=_0x5b47b7[_0x1c56ae(0x12f)]+0x1,_0x233304=_0x1c56ae(0xa1)+_0x2e9173[_0x1c56ae(0xd0)]()[_0x1c56ae(0xb4)](0x5,'0');var _0x3e2ce6=[_0x1c56ae(0xca),'Enclosed','Return\x20Rooms'];if(_0x52d0a3[0x0]['language']==_0x1c56ae(0x7b))var _0x574792=users[_0x1c56ae(0xd2)];else{if(_0x52d0a3[0x0][_0x1c56ae(0x129)]==_0x1c56ae(0x10a))var _0x574792=users[_0x1c56ae(0x10a)];else{if(_0x52d0a3[0x0]['language']==_0x1c56ae(0x100))var _0x574792=users[_0x1c56ae(0x100)];else{if(_0x52d0a3[0x0][_0x1c56ae(0x129)]==_0x1c56ae(0xe3))var _0x574792=users[_0x1c56ae(0xe3)];else{if(_0x52d0a3[0x0][_0x1c56ae(0x129)]==_0x1c56ae(0x11a))var _0x574792=users[_0x1c56ae(0x11a)];else{if(_0x52d0a3[0x0][_0x1c56ae(0x129)]==_0x1c56ae(0xda))var _0x574792=users[_0x1c56ae(0x103)];else{if(_0x52d0a3[0x0][_0x1c56ae(0x129)]==_0x1c56ae(0xd1))var _0x574792=users[_0x1c56ae(0xd1)];else{if(_0x52d0a3[0x0]['language']==_0x1c56ae(0x75))var _0x574792=users[_0x1c56ae(0x8d)];}}}}}}}const _0x3b907b=getRandom8DigitNumber();_0x3b907b['then'](_0x47de48=>{var _0x162370=_0x1c56ae;_0x2b24b9['render'](_0x162370(0xc2),{'success':_0x4b31c6[_0x162370(0x102)](_0x162370(0xc3)),'errors':_0x4b31c6[_0x162370(0x102)]('errors'),'role':_0x25c28b,'profile':_0x184476,'warehouse':_0x21b66a,'product':_0x1a2972,'master_shop':_0x52d0a3,'language':_0x574792,'rooms_data':_0x3e2ce6,'invoice_no':_0x47de48});})[_0x1c56ae(0xb7)](_0x1f5bd0=>{var _0x3973be=_0x1c56ae;_0x4b31c6[_0x3973be(0x102)](_0x3973be(0x79),_0x3973be(0xbb)),_0x2b24b9[_0x3973be(0x127)](_0x3973be(0x8b));});}catch(_0x453cd8){console[_0x1c56ae(0x80)](_0x453cd8);}}),router[a0_0x374a3a(0xa8)](a0_0x374a3a(0x125),auth,async(_0x103607,_0xb32794)=>{var _0x5368e0=a0_0x374a3a;try{const {warehouse_name:_0x16c7fb,date:_0x191759,prod_name:_0x38a7b6,level:_0xd27325,isle:_0x49d791,pallet:_0x3ac2e1,stock:_0x5cc286,types:_0x21cf5a,adjust_qty:_0x2f68b9,new_adjust_qty:_0x46c58c,note:_0xcf41ea,Room_name:_0xf68a3a,invoice:_0x53f86b,JO_number:_0x361883,expiry_date:_0x224bbf}=_0x103607[_0x5368e0(0x104)];if(typeof _0x38a7b6==_0x5368e0(0x83))var _0x3b2e50=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0xd7)]],_0x3bb922=[_0x103607['body']['level']],_0x5cbf65=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0x115)]],_0x4aa01d=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0x109)]],_0xf4212b=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0x89)]],_0x553635=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0xbf)]],_0x1fb19c=[_0x103607[_0x5368e0(0x104)]['Primary_Units']],_0x4b9aed=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0x74)]],_0x3e215b=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0x84)]],_0x57ee86=[_0x103607['body'][_0x5368e0(0xc4)]],_0x535229=[_0x103607['body'][_0x5368e0(0x131)]],_0x14e532=[_0x103607['body']['max_per_unit']],_0x563f7e=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0x110)]],_0x16e678=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0x9c)]],_0x843f9b=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0xb3)]],_0x309128=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0xae)]],_0x3af3bc=[_0x103607[_0x5368e0(0x104)][_0x5368e0(0xf4)]],_0x28199a=[_0x103607['body'][_0x5368e0(0x12e)]],_0x19735a=[_0x103607['body'][_0x5368e0(0x118)]];else var _0x3b2e50=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0xd7)]],_0x3bb922=[..._0x103607[_0x5368e0(0x104)]['level']],_0x5cbf65=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0x115)]],_0x4aa01d=[..._0x103607['body'][_0x5368e0(0x109)]],_0xf4212b=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0x89)]],_0x553635=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0xbf)]],_0x1fb19c=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0x13b)]],_0x4b9aed=[..._0x103607[_0x5368e0(0x104)]['Secondary_units']],_0x3e215b=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0x84)]],_0x57ee86=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0xc4)]],_0x535229=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0x131)]],_0x14e532=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0xf6)]],_0x563f7e=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0x110)]],_0x16e678=[..._0x103607['body'][_0x5368e0(0x9c)]],_0x843f9b=[..._0x103607[_0x5368e0(0x104)]['Rooms']],_0x309128=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0xae)]],_0x3af3bc=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0xf4)]],_0x28199a=[..._0x103607['body']['prod_invoice']],_0x19735a=[..._0x103607[_0x5368e0(0x104)][_0x5368e0(0x118)]];const _0x3f49dd=_0x3b2e50[_0x5368e0(0xba)](_0x2b7158=>{return _0x2b7158={'product_name':_0x2b7158};});_0x3bb922[_0x5368e0(0x106)]((_0x30f684,_0x9b6a1)=>{_0x843f9b['forEach']((_0xd6456e,_0x55a352)=>{var _0x57dd8d=a0_0x3ca5;if(_0xd6456e==_0x57dd8d(0xe2)&&_0x9b6a1==_0x55a352){var _0x12eb2d=_0x30f684['slice'](0x3);_0x3f49dd[_0x9b6a1][_0x57dd8d(0x95)]=_0x30f684[0x0],_0x3f49dd[_0x9b6a1][_0x57dd8d(0x76)]=_0x30f684[0x1],_0x3f49dd[_0x9b6a1][_0x57dd8d(0x10e)]=0x0,_0x3f49dd[_0x9b6a1][_0x57dd8d(0x6f)]=0x0,_0x3f49dd[_0x9b6a1][_0x57dd8d(0x6a)]=_0x57dd8d(0xb0),_0x3f49dd[_0x9b6a1]['floorlevel']=_0x12eb2d;}else{if(_0xd6456e==_0x57dd8d(0x87)&&_0x9b6a1==_0x55a352){var _0x12eb2d=_0x30f684[_0x57dd8d(0xdb)](0x3);_0x3f49dd[_0x9b6a1][_0x57dd8d(0x95)]=_0x30f684[0x0],_0x3f49dd[_0x9b6a1]['rack']=_0x30f684[0x1],_0x3f49dd[_0x9b6a1][_0x57dd8d(0x10e)]=0x0,_0x3f49dd[_0x9b6a1][_0x57dd8d(0x6f)]=0x0,_0x3f49dd[_0x9b6a1]['type']=_0x57dd8d(0xb0),_0x3f49dd[_0x9b6a1][_0x57dd8d(0xac)]=_0x30f684[0x5];}else{if(_0x9b6a1==_0x55a352){var _0x3e8553;if(_0x30f684[0x4]=='L')_0x3e8553=_0x57dd8d(0xe8);else _0x30f684[0x4]=='F'&&(_0x3e8553='Floor');_0x3f49dd[_0x9b6a1][_0x57dd8d(0x95)]=_0x30f684[0x0],_0x3f49dd[_0x9b6a1][_0x57dd8d(0x76)]=_0x30f684[0x1],_0x3f49dd[_0x9b6a1][_0x57dd8d(0x10e)]=_0x30f684[0x2],_0x3f49dd[_0x9b6a1][_0x57dd8d(0x6f)]=_0x30f684[0x3],_0x3f49dd[_0x9b6a1]['type']=_0x3e8553,_0x3f49dd[_0x9b6a1]['floorlevel']=_0x30f684[0x5];}}}});}),_0x5cbf65['forEach']((_0x4142ac,_0x475afd)=>{var _0x132dc4=_0x5368e0;_0x3f49dd[_0x475afd][_0x132dc4(0xea)]=_0x4142ac;}),_0x19735a['forEach']((_0x1c5d00,_0x623bb9)=>{var _0x564747=_0x5368e0;_0x3f49dd[_0x623bb9][_0x564747(0x142)]=_0x1c5d00;}),_0x4aa01d['forEach']((_0x129f79,_0x3a1e6b)=>{var _0x161a7c=_0x5368e0;_0x3f49dd[_0x3a1e6b][_0x161a7c(0x109)]=_0x129f79;}),_0xf4212b[_0x5368e0(0x106)]((_0x1545fc,_0x5a223d)=>{var _0x10544e=_0x5368e0;_0x3f49dd[_0x5a223d][_0x10544e(0xcf)]=_0x1545fc;}),_0x553635['forEach']((_0x155929,_0x47f2de)=>{var _0xb39277=_0x5368e0;_0x3f49dd[_0x47f2de][_0xb39277(0x10f)]=_0x155929;}),_0x1fb19c[_0x5368e0(0x106)]((_0xaa6bae,_0x1ad512)=>{var _0x419770=_0x5368e0;_0x3f49dd[_0x1ad512][_0x419770(0x13b)]=_0xaa6bae;}),_0x4b9aed[_0x5368e0(0x106)]((_0x5662cd,_0x81813d)=>{_0x3f49dd[_0x81813d]['secondary_unit']=_0x5662cd;}),_0x3e215b[_0x5368e0(0x106)]((_0x3f1eb6,_0x55d6c5)=>{var _0x8d9311=_0x5368e0;_0x3f49dd[_0x55d6c5][_0x8d9311(0xb8)]=_0x3f1eb6;}),_0x57ee86[_0x5368e0(0x106)]((_0x126ea9,_0x1a8d22)=>{_0x3f49dd[_0x1a8d22]['batch_code']=_0x126ea9;}),_0x535229[_0x5368e0(0x106)]((_0x59012c,_0x31e24e)=>{_0x3f49dd[_0x31e24e]['expiry_date']=_0x59012c;}),_0x14e532[_0x5368e0(0x106)]((_0x270e36,_0x41c080)=>{var _0x52db38=_0x5368e0;_0x3f49dd[_0x41c080][_0x52db38(0x13c)]=_0x270e36;}),_0x563f7e[_0x5368e0(0x106)]((_0x55aa5b,_0x401dbf)=>{var _0xb880fe=_0x5368e0;_0x3f49dd[_0x401dbf][_0xb880fe(0x110)]=_0x55aa5b;}),_0x16e678[_0x5368e0(0x106)]((_0x761dc7,_0x5c7900)=>{var _0x294377=_0x5368e0;_0x3f49dd[_0x5c7900][_0x294377(0x9c)]=_0x761dc7;}),_0x843f9b[_0x5368e0(0x106)]((_0x44e0b6,_0x105c19)=>{var _0x84ca16=_0x5368e0;_0x3f49dd[_0x105c19][_0x84ca16(0x94)]=_0x44e0b6;}),_0x309128[_0x5368e0(0x106)]((_0x5d18bc,_0x54c61e)=>{var _0x56e95e=_0x5368e0;_0x3f49dd[_0x54c61e][_0x56e95e(0xf2)]=_0x5d18bc;}),_0x3af3bc['forEach']((_0x2d08d9,_0x1318f8)=>{_0x3f49dd[_0x1318f8]['secondary_code']=_0x2d08d9;}),_0x28199a[_0x5368e0(0x106)]((_0x5b9a65,_0x26e422)=>{var _0x13de80=_0x5368e0;_0x3f49dd[_0x26e422][_0x13de80(0xfa)]=_0x5b9a65;});const _0x1a167b=_0x3f49dd[_0x5368e0(0xd5)](_0x4c9bb6=>_0x4c9bb6['adjust_qty']!=='0'&&_0x4c9bb6['adjust_qty']!=='');var _0x40206f=0x0;_0x1a167b[_0x5368e0(0x106)](_0x5ee5a9=>{var _0x1284b6=_0x5368e0;console[_0x1284b6(0x80)](_0x1284b6(0xb9),_0x5ee5a9),parseInt(_0x5ee5a9[_0x1284b6(0xcf)])<=0x0&&_0x40206f++;});if(_0x40206f!=0x0)return _0x103607[_0x5368e0(0x102)](_0x5368e0(0x79),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0xb32794[_0x5368e0(0x127)](_0x5368e0(0x92));const _0x4bf23f=new adjustment({'warehouse_name':_0x16c7fb,'date':_0x191759,'product':_0x1a167b,'note':_0xcf41ea,'room':_0xf68a3a,'invoice':_0x53f86b,'JO_number':_0x361883,'expiry_date':_0x224bbf}),_0xe625bf=await _0x4bf23f[_0x5368e0(0xa0)]();_0x103607[_0x5368e0(0x102)](_0x5368e0(0xc3),_0x5368e0(0x11d)),_0xb32794[_0x5368e0(0x127)](_0x5368e0(0x114)+_0xe625bf['_id']);}catch(_0x12f29f){console[_0x5368e0(0x80)](_0x12f29f),_0xb32794[_0x5368e0(0x6c)](0xc8)[_0x5368e0(0x13e)]({'message':_0x12f29f[_0x5368e0(0x123)]});}}),router[a0_0x374a3a(0x11e)](a0_0x374a3a(0xa7),auth,async(_0x4f0d58,_0xd16ff8)=>{var _0x286979=a0_0x374a3a;try{const {username:_0x4b61e1,email:_0x285423,role:_0x4f7b1d}=_0x4f0d58[_0x286979(0xfc)],_0x308a07=_0x4f0d58[_0x286979(0xfc)],_0x7c440f=await profile['findOne']({'email':_0x308a07[_0x286979(0xa2)]}),_0x1832e4=await master_shop['find'](),_0x4f51bd=_0x4f0d58[_0x286979(0xc7)]['id'],_0x8f7b4b=await adjustment[_0x286979(0xc9)]({'_id':_0x4f51bd}),_0x1d434d=await purchases[_0x286979(0xc6)]([{'$match':{'warehouse_name':_0x8f7b4b['warehouse_name']}},{'$unwind':_0x286979(0x12c)},{'$group':{'_id':'$product.product_name'}}]),_0x6ea163=await product[_0x286979(0xf5)]({}),_0x2b08b6=await warehouse[_0x286979(0xc6)]([{'$match':{'name':_0x8f7b4b[_0x286979(0x138)]}},{'$unwind':_0x286979(0x73)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x286979(0x108)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x286979(0x8f)},'bin':{'$first':_0x286979(0xed)},'type':{'$first':_0x286979(0x8e)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x286979(0xee)},'secondary_code':{'$first':_0x286979(0x78)},'product_code':{'$first':_0x286979(0x137)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x286979(0xbc)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x286979(0x96)},'batch_code':{'$first':_0x286979(0xcb)},'room':{'$first':_0x286979(0x8c)}}}]);if(_0x1832e4[0x0][_0x286979(0x129)]=='English\x20(US)'){var _0x3bc8f6=users[_0x286979(0xd2)];console['log'](_0x3bc8f6);}else{if(_0x1832e4[0x0]['language']==_0x286979(0x10a))var _0x3bc8f6=users[_0x286979(0x10a)];else{if(_0x1832e4[0x0]['language']=='German')var _0x3bc8f6=users[_0x286979(0x100)];else{if(_0x1832e4[0x0][_0x286979(0x129)]==_0x286979(0xe3))var _0x3bc8f6=users['Spanish'];else{if(_0x1832e4[0x0][_0x286979(0x129)]=='French')var _0x3bc8f6=users['French'];else{if(_0x1832e4[0x0][_0x286979(0x129)]=='Portuguese\x20(BR)')var _0x3bc8f6=users[_0x286979(0x103)];else{if(_0x1832e4[0x0]['language']==_0x286979(0xd1))var _0x3bc8f6=users[_0x286979(0xd1)];else{if(_0x1832e4[0x0][_0x286979(0x129)]=='Arabic\x20(ae)')var _0x3bc8f6=users[_0x286979(0x8d)];}}}}}}}_0xd16ff8[_0x286979(0x9f)](_0x286979(0x126),{'success':_0x4f0d58[_0x286979(0x102)]('success'),'errors':_0x4f0d58[_0x286979(0x102)](_0x286979(0x79)),'role':_0x308a07,'profile':_0x7c440f,'adjustment':_0x8f7b4b,'stock':_0x2b08b6,'master_shop':_0x1832e4,'warehouse_name':_0x1d434d,'unit':_0x6ea163,'language':_0x3bc8f6});}catch(_0x5e4d35){console['log'](_0x5e4d35),_0xd16ff8[_0x286979(0x6c)](0xc8)[_0x286979(0x13e)]({'message':_0x5e4d35[_0x286979(0x123)]});}}),router['post']('/preview/:id',auth,async(_0x4149f3,_0x1af334)=>{var _0x23eca7=a0_0x374a3a;try{const _0x4ae243=_0x4149f3[_0x23eca7(0xc7)]['id'],{warehouse_name:_0x27f89b,Room_name:_0xa52c2a}=_0x4149f3[_0x23eca7(0x104)],_0xe8ac3b=await adjustment[_0x23eca7(0xc9)]({'_id':_0x4ae243}),_0x1be70f=_0xe8ac3b['product'][_0x23eca7(0xba)](async _0x244c60=>{var _0x1c978c=_0x23eca7;if(_0x244c60[_0x1c978c(0xcf)]>0x0){var _0x2ea2b9=await warehouse[_0x1c978c(0xef)]({'name':_0x27f89b,'room':_0x244c60[_0x1c978c(0x94)],'warehouse_category':'Raw\x20Materials'});const _0x184dce=_0x2ea2b9['product_details']['map'](_0x2911c2=>{var _0x243fd9=_0x1c978c;console[_0x243fd9(0x80)](_0x244c60[_0x243fd9(0x109)]+_0x243fd9(0x88));if(_0x244c60['types']==_0x243fd9(0xa6)){if(_0x2911c2['product_name']==_0x244c60['product_name']&&_0x2911c2[_0x243fd9(0xac)]==_0x244c60[_0x243fd9(0xac)]&&_0x2911c2[_0x243fd9(0x6a)]==_0x244c60['type']&&_0x2911c2[_0x243fd9(0x6f)]==_0x244c60[_0x243fd9(0x6f)]&&_0x2911c2[_0x243fd9(0x10e)]==_0x244c60['bay']&&_0x2911c2[_0x243fd9(0x76)]==_0x244c60[_0x243fd9(0x76)]&&_0x2911c2['storage']==_0x244c60['storage']&&_0x2911c2[_0x243fd9(0x131)]==_0x244c60['expiry_date']&&_0x2911c2[_0x243fd9(0xc4)]==_0x244c60[_0x243fd9(0xc4)]&&_0x2911c2[_0x243fd9(0x110)]==_0x244c60[_0x243fd9(0x110)]&&_0x2911c2['invoice']==_0x244c60[_0x243fd9(0xfa)]&&_0x2911c2[_0x243fd9(0x11c)]==_0x244c60[_0x243fd9(0x142)]){var _0xaa3faa;_0xaa3faa=_0x244c60[_0x243fd9(0xcf)],_0x244c60['prod_cat']=='S'&&(_0xaa3faa=_0x244c60[_0x243fd9(0xcf)]),_0x2911c2[_0x243fd9(0xab)]=_0x2911c2['product_stock']-_0xaa3faa;}}else{if(_0x2911c2['product_name']==_0x244c60[_0x243fd9(0x136)]&&_0x2911c2['floorlevel']==_0x244c60['floorlevel']&&_0x2911c2[_0x243fd9(0x6a)]==_0x244c60[_0x243fd9(0x6a)]&&_0x2911c2['bin']==_0x244c60[_0x243fd9(0x6f)]&&_0x2911c2[_0x243fd9(0x10e)]==_0x244c60['bay']&&_0x2911c2['rack']==_0x244c60[_0x243fd9(0x76)]&&_0x2911c2[_0x243fd9(0x95)]==_0x244c60[_0x243fd9(0x95)]&&_0x2911c2[_0x243fd9(0x131)]==_0x244c60[_0x243fd9(0x131)]&&_0x2911c2[_0x243fd9(0xc4)]==_0x244c60[_0x243fd9(0xc4)]&&_0x2911c2['production_date']==_0x244c60[_0x243fd9(0x110)]&&_0x2911c2['invoice']==_0x244c60[_0x243fd9(0xfa)]&&_0x2911c2['_id']==_0x244c60['id_transaction_from']){console[_0x243fd9(0x80)](_0x244c60);var _0xaa3faa;_0xaa3faa=_0x244c60[_0x243fd9(0xcf)],_0x244c60[_0x243fd9(0x9c)]=='S'&&(_0xaa3faa=_0x244c60[_0x243fd9(0xcf)]),_0x2911c2[_0x243fd9(0xab)]=_0x2911c2[_0x243fd9(0xab)]+_0xaa3faa;}}});}return _0x2ea2b9;});Promise[_0x23eca7(0x133)](_0x1be70f)['then'](async _0x573d0a=>{var _0x108ca9=_0x23eca7;try{for(const _0x2bff7f of _0x573d0a){await _0x2bff7f[_0x108ca9(0xa0)]();}_0xe8ac3b[_0x108ca9(0x13f)]='True';const _0x3967fa=await _0xe8ac3b[_0x108ca9(0xa0)](),_0x5a547e=await master_shop[_0x108ca9(0xf5)](),_0x4f54dc=await email_settings[_0x108ca9(0xef)](),_0x2a9a08=await supervisor_settings['find']();var _0x8b0be5=_0xe8ac3b[_0x108ca9(0x82)],_0x5d046b='',_0x2db065;for(_0x2db065 in _0x8b0be5){_0x5d046b+=_0x108ca9(0xe1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8b0be5[_0x2db065]['product_name']+'</td>'+_0x108ca9(0xc0)+_0x8b0be5[_0x2db065][_0x108ca9(0xb8)]+_0x108ca9(0x113)+_0x108ca9(0xc0)+_0x8b0be5[_0x2db065][_0x108ca9(0xcf)]+'</td>'+_0x108ca9(0xc0)+_0x8b0be5[_0x2db065][_0x108ca9(0x13b)]+_0x108ca9(0x113)+_0x108ca9(0xc0)+_0x8b0be5[_0x2db065]['secondary_unit']+_0x108ca9(0x113)+_0x108ca9(0xc0)+_0xe8ac3b[_0x108ca9(0x138)]+_0x108ca9(0x113)+_0x108ca9(0xc0)+_0x8b0be5[_0x2db065][_0x108ca9(0x94)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8b0be5[_0x2db065][_0x108ca9(0x95)]+_0x8b0be5[_0x2db065][_0x108ca9(0x76)]+_0x8b0be5[_0x2db065][_0x108ca9(0x10e)]+_0x8b0be5[_0x2db065][_0x108ca9(0x6f)]+_0x8b0be5[_0x2db065][_0x108ca9(0x6a)][0x0]+_0x8b0be5[_0x2db065][_0x108ca9(0xac)]+_0x108ca9(0x113),_0x108ca9(0x13a);}let _0x2fc302=nodemailer[_0x108ca9(0x8a)]({'host':_0x4f54dc['host'],'port':Number(_0x4f54dc['port']),'secure':![],'auth':{'user':_0x4f54dc['email'],'pass':_0x4f54dc[_0x108ca9(0xb2)]}}),_0x8d3273={'from':_0x4f54dc[_0x108ca9(0xa2)],'to':_0x2a9a08[0x0][_0x108ca9(0xf8)],'subject':_0x108ca9(0xb6),'attachments':[{'filename':_0x108ca9(0x7f),'path':__dirname+_0x108ca9(0xd8)+_0x108ca9(0x91)+_0x5a547e[0x0][_0x108ca9(0x93)],'cid':_0x108ca9(0x119)}],'html':_0x108ca9(0x6b)+'<html><head><title></title>'+_0x108ca9(0x70)+'<div>'+_0x108ca9(0xaa)+_0x108ca9(0xfb)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x108ca9(0x122)+'<div>'+_0x108ca9(0x81)+_0x5a547e[0x0][_0x108ca9(0xf1)]+_0x108ca9(0x107)+_0x108ca9(0x122)+_0x108ca9(0x122)+'<hr\x20class=\x22my-3\x22>'+_0x108ca9(0xfb)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0xe8ac3b[_0x108ca9(0xfa)]+'\x20'+_0x108ca9(0x7a)+_0x108ca9(0xa3)+_0xe8ac3b[_0x108ca9(0xe9)]+'\x20'+_0x108ca9(0x12d)+_0x108ca9(0xdf)+'</div>'+_0x108ca9(0x105)+_0x108ca9(0x72)+_0x108ca9(0xe1)+_0x108ca9(0x141)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x108ca9(0x120)+_0x108ca9(0xad)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x108ca9(0x143)+_0x108ca9(0xa4)+_0x108ca9(0x13a)+_0x108ca9(0x112)+_0x108ca9(0x7d)+'\x20'+_0x5d046b+'\x20'+_0x108ca9(0xe7)+_0x108ca9(0x111)+_0x108ca9(0xfb)+_0x108ca9(0x6e)+_0x108ca9(0x10c)+_0x5a547e[0x0][_0x108ca9(0xf1)]+_0x108ca9(0xdf)+_0x108ca9(0x122)+'</div>'+_0x108ca9(0x7c)};_0x2fc302[_0x108ca9(0xb1)](_0x8d3273,function(_0x4835a0,_0x42afc3){var _0x7c9abb=_0x108ca9;_0x4835a0?(console[_0x7c9abb(0x80)](_0x4835a0),console[_0x7c9abb(0x80)](_0x7c9abb(0xcc))):console[_0x7c9abb(0x80)]('Email\x20sent\x20successfully');}),_0x4149f3[_0x108ca9(0x102)](_0x108ca9(0xc3),_0x108ca9(0xf7)),_0x1af334[_0x108ca9(0x127)](_0x108ca9(0x117)+_0x3967fa[_0x108ca9(0x11c)]);}catch(_0x525fe3){console[_0x108ca9(0x13d)](_0x525fe3),_0x1af334[_0x108ca9(0x6c)](0x1f4)[_0x108ca9(0x13e)]({'error':_0x108ca9(0xc5)});}})[_0x23eca7(0xb7)](_0x334acd=>{var _0x333bfb=_0x23eca7;console[_0x333bfb(0x13d)](_0x334acd),_0x1af334[_0x333bfb(0x6c)](0x1f4)['json']({'error':_0x333bfb(0x99)});});}catch(_0x4dff3e){console[_0x23eca7(0x80)](_0x4dff3e),_0x1af334[_0x23eca7(0x6c)](0xc8)[_0x23eca7(0x13e)]({'message':_0x4dff3e[_0x23eca7(0x123)]});}}),router[a0_0x374a3a(0x11e)](a0_0x374a3a(0xa9),auth,async(_0x4489a5,_0x256cb0)=>{var _0x35886f=a0_0x374a3a;try{const {username:_0x26ca84,email:_0x75e47d,role:_0x334b20}=_0x4489a5[_0x35886f(0xfc)],_0x25c992=_0x4489a5[_0x35886f(0xfc)],_0x52aaaf=await profile[_0x35886f(0xef)]({'email':_0x25c992[_0x35886f(0xa2)]}),_0x2d9e90=await master_shop['find'](),_0x499879=_0x4489a5[_0x35886f(0xc7)]['id'],_0x445267=await adjustment[_0x35886f(0xc9)]({'_id':_0x499879}),_0x3f186a=await purchases[_0x35886f(0xc6)]([{'$match':{'warehouse_name':_0x445267['warehouse_name']}},{'$unwind':_0x35886f(0x12c)},{'$group':{'_id':_0x35886f(0x9d)}}]),_0x58c061=await product[_0x35886f(0xf5)]({}),_0x4fa61c=await warehouse[_0x35886f(0xc6)]([{'$match':{'name':_0x445267[_0x35886f(0x138)]}},{'$unwind':_0x35886f(0x73)},{'$group':{'_id':_0x35886f(0xb5),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x35886f(0x130)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x35886f(0xed)},'type':{'$first':_0x35886f(0x8e)},'floorlevel':{'$first':_0x35886f(0xe0)},'primary_code':{'$first':_0x35886f(0xee)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x35886f(0x137)},'storage':{'$first':_0x35886f(0xbe)},'rack':{'$first':_0x35886f(0xbc)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x35886f(0xc1)},'production_date':{'$first':_0x35886f(0x96)},'batch_code':{'$first':_0x35886f(0xcb)},'room':{'$first':_0x35886f(0x8c)}}}]);let _0x8e1a65;if(_0x25c992[_0x35886f(0x139)]==_0x35886f(0x12b)){const _0x2cd343=await staff[_0x35886f(0xef)]({'email':_0x25c992[_0x35886f(0xa2)]});_0x8e1a65=await warehouse[_0x35886f(0xc6)]([{'$match':{'status':'Enabled','name':_0x2cd343[_0x35886f(0x98)],'warehouse_category':_0x35886f(0x12a),'name':{'$ne':_0x35886f(0xaf)}}},{'$group':{'_id':_0x35886f(0xe6),'name':{'$first':_0x35886f(0xe6)}}}]);}else _0x8e1a65=await warehouse[_0x35886f(0xc6)]([{'$match':{'status':'Enabled','warehouse_category':_0x35886f(0x12a),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x35886f(0xe6),'name':{'$first':_0x35886f(0xe6)}}}]);if(_0x2d9e90[0x0][_0x35886f(0x129)]==_0x35886f(0x7b)){var _0x2de76c=users[_0x35886f(0xd2)];console[_0x35886f(0x80)](_0x2de76c);}else{if(_0x2d9e90[0x0][_0x35886f(0x129)]==_0x35886f(0x10a))var _0x2de76c=users['Hindi'];else{if(_0x2d9e90[0x0][_0x35886f(0x129)]==_0x35886f(0x100))var _0x2de76c=users['German'];else{if(_0x2d9e90[0x0][_0x35886f(0x129)]==_0x35886f(0xe3))var _0x2de76c=users['Spanish'];else{if(_0x2d9e90[0x0]['language']==_0x35886f(0x11a))var _0x2de76c=users[_0x35886f(0x11a)];else{if(_0x2d9e90[0x0][_0x35886f(0x129)]==_0x35886f(0xda))var _0x2de76c=users['Portuguese'];else{if(_0x2d9e90[0x0][_0x35886f(0x129)]==_0x35886f(0xd1))var _0x2de76c=users[_0x35886f(0xd1)];else{if(_0x2d9e90[0x0][_0x35886f(0x129)]=='Arabic\x20(ae)')var _0x2de76c=users['Arabic'];}}}}}}}_0x256cb0['render'](_0x35886f(0x11b),{'success':_0x4489a5[_0x35886f(0x102)]('success'),'errors':_0x4489a5[_0x35886f(0x102)](_0x35886f(0x79)),'role':_0x25c992,'profile':_0x52aaaf,'adjustment':_0x445267,'stock':_0x4fa61c,'master_shop':_0x2d9e90,'warehouse_name':_0x3f186a,'unit':_0x58c061,'language':_0x2de76c,'warehouse':_0x8e1a65});}catch(_0x595416){console[_0x35886f(0x80)](_0x595416),_0x256cb0[_0x35886f(0x6c)](0xc8)['json']({'message':_0x595416[_0x35886f(0x123)]});}}),router['post'](a0_0x374a3a(0xa9),auth,async(_0x108f2e,_0x1ca3cb)=>{var _0x19851d=a0_0x374a3a;try{const _0x20e152=_0x108f2e[_0x19851d(0xc7)]['id'],_0x51ef1b=await adjustment[_0x19851d(0xc9)]({'_id':_0x20e152}),_0x54d68e=await warehouse[_0x19851d(0xef)]({'name':_0x51ef1b[_0x19851d(0x138)],'room':_0x51ef1b['room']}),{warehouse_name:_0x5dc204,date:_0x3c96c1,prod_name:_0x2539cc,level:_0x892713,isle:_0x572604,pallet:_0x3fb18f,stock:_0x48336c,types:_0xf23ebc,adjust_qty:_0x129f72,new_adjust_qty:_0x148c79,note:_0x4387a4,Room_name:_0x29984d,invoice:_0x5f4d9a,JO_number:_0x25bbc3,expiry_date:_0x1afb71}=_0x108f2e[_0x19851d(0x104)];if(typeof _0x2539cc=='string')var _0x3b17f9=[_0x108f2e[_0x19851d(0x104)]['prod_name']],_0x1ae562=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0x128)]],_0x1b0694=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0x115)]],_0x2cfc16=[_0x108f2e[_0x19851d(0x104)]['types']],_0x593ffd=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0x89)]],_0x3294c3=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0xbf)]],_0xbe93ee=[_0x108f2e['body'][_0x19851d(0x9b)]],_0x1e0214=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0x74)]],_0x175388=[_0x108f2e['body'][_0x19851d(0x84)]],_0x2e6678=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0xc4)]],_0x166a30=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0x131)]],_0x24b8b4=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0xf6)]],_0x3afbc3=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0x110)]],_0x4b5bfd=[_0x108f2e['body'][_0x19851d(0x9c)]],_0x6e3df3=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0xb3)]],_0x2516f5=[_0x108f2e['body'][_0x19851d(0xae)]],_0x499061=[_0x108f2e[_0x19851d(0x104)][_0x19851d(0xf4)]];else var _0x3b17f9=[..._0x108f2e['body']['prod_name']],_0x1ae562=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0x128)]],_0x1b0694=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0x115)]],_0x2cfc16=[..._0x108f2e[_0x19851d(0x104)]['types']],_0x593ffd=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0x89)]],_0x3294c3=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0xbf)]],_0xbe93ee=[..._0x108f2e['body'][_0x19851d(0x13b)]],_0x1e0214=[..._0x108f2e[_0x19851d(0x104)]['Secondary_units']],_0x175388=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0x84)]],_0x2e6678=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0xc4)]],_0x166a30=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0x131)]],_0x24b8b4=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0xf6)]],_0x3afbc3=[..._0x108f2e['body'][_0x19851d(0x110)]],_0x4b5bfd=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0x9c)]],_0x6e3df3=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0xb3)]],_0x2516f5=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0xae)]],_0x499061=[..._0x108f2e[_0x19851d(0x104)][_0x19851d(0xf4)]];const _0x3f6d16=_0x3b17f9[_0x19851d(0xba)](_0x246b1c=>{return _0x246b1c={'product_name':_0x246b1c};});_0x1ae562[_0x19851d(0x106)]((_0x5b4ddf,_0x53784c)=>{var _0x198110=_0x19851d;_0x6e3df3[_0x198110(0x106)]((_0x50dbb3,_0x1be8e2)=>{var _0x3c0bd8=_0x198110;if(_0x50dbb3==_0x3c0bd8(0xe2)&&_0x53784c==_0x1be8e2){var _0x56d63f=_0x5b4ddf['slice'](0x3);_0x3f6d16[_0x53784c][_0x3c0bd8(0x95)]=_0x5b4ddf[0x0],_0x3f6d16[_0x53784c][_0x3c0bd8(0x76)]=_0x5b4ddf[0x1],_0x3f6d16[_0x53784c][_0x3c0bd8(0x10e)]=0x0,_0x3f6d16[_0x53784c][_0x3c0bd8(0x6f)]=0x0,_0x3f6d16[_0x53784c][_0x3c0bd8(0x6a)]='Floor',_0x3f6d16[_0x53784c][_0x3c0bd8(0xac)]=_0x56d63f;}else{if(_0x50dbb3=='Shelves'&&_0x53784c==_0x1be8e2){var _0x56d63f=_0x5b4ddf[_0x3c0bd8(0xdb)](0x3);_0x3f6d16[_0x53784c][_0x3c0bd8(0x95)]=_0x5b4ddf[0x0],_0x3f6d16[_0x53784c][_0x3c0bd8(0x76)]=_0x5b4ddf[0x1],_0x3f6d16[_0x53784c][_0x3c0bd8(0x10e)]=0x0,_0x3f6d16[_0x53784c][_0x3c0bd8(0x6f)]=0x0,_0x3f6d16[_0x53784c][_0x3c0bd8(0x6a)]=_0x3c0bd8(0xb0),_0x3f6d16[_0x53784c][_0x3c0bd8(0xac)]=_0x5b4ddf[0x5];}else{if(_0x53784c==_0x1be8e2){var _0xea60de;if(_0x5b4ddf[0x4]=='L')_0xea60de=_0x3c0bd8(0xe8);else _0x5b4ddf[0x4]=='F'&&(_0xea60de=_0x3c0bd8(0xb0));_0x3f6d16[_0x53784c][_0x3c0bd8(0x95)]=_0x5b4ddf[0x0],_0x3f6d16[_0x53784c][_0x3c0bd8(0x76)]=_0x5b4ddf[0x1],_0x3f6d16[_0x53784c][_0x3c0bd8(0x10e)]=_0x5b4ddf[0x2],_0x3f6d16[_0x53784c][_0x3c0bd8(0x6f)]=_0x5b4ddf[0x3],_0x3f6d16[_0x53784c][_0x3c0bd8(0x6a)]=_0xea60de,_0x3f6d16[_0x53784c][_0x3c0bd8(0xac)]=_0x5b4ddf[0x5];}}}});}),_0x1b0694[_0x19851d(0x106)]((_0x3c13bf,_0x2c0b51)=>{_0x3f6d16[_0x2c0b51]['stockBefore']=_0x3c13bf;}),_0x2cfc16[_0x19851d(0x106)]((_0x3f367b,_0x19c889)=>{var _0x47c0b1=_0x19851d;_0x3f6d16[_0x19c889][_0x47c0b1(0x109)]=_0x3f367b;}),_0x593ffd['forEach']((_0x2c8ee5,_0x2655a0)=>{var _0x4c17d7=_0x19851d;_0x3f6d16[_0x2655a0][_0x4c17d7(0xcf)]=_0x2c8ee5;}),_0x3294c3[_0x19851d(0x106)]((_0x2a868f,_0x1fdb12)=>{var _0x37d5bb=_0x19851d;_0x3f6d16[_0x1fdb12][_0x37d5bb(0x10f)]=_0x2a868f;}),_0xbe93ee[_0x19851d(0x106)]((_0x224f8f,_0x1f1ba2)=>{var _0x4d663a=_0x19851d;_0x3f6d16[_0x1f1ba2][_0x4d663a(0x13b)]=_0x224f8f;}),_0x1e0214['forEach']((_0x465a80,_0x3c6c3e)=>{var _0x59821f=_0x19851d;_0x3f6d16[_0x3c6c3e][_0x59821f(0x121)]=_0x465a80;}),_0x175388[_0x19851d(0x106)]((_0x254fca,_0x3fce1b)=>{_0x3f6d16[_0x3fce1b]['product_code']=_0x254fca;}),_0x2e6678[_0x19851d(0x106)]((_0x4a5ccc,_0x541afd)=>{var _0x1a9c03=_0x19851d;_0x3f6d16[_0x541afd][_0x1a9c03(0xc4)]=_0x4a5ccc;}),_0x166a30[_0x19851d(0x106)]((_0x26753d,_0x522b0c)=>{var _0x5ce0c7=_0x19851d;_0x3f6d16[_0x522b0c][_0x5ce0c7(0x131)]=_0x26753d;}),_0x24b8b4['forEach']((_0x597988,_0x287fa2)=>{var _0x57a556=_0x19851d;_0x3f6d16[_0x287fa2][_0x57a556(0x13c)]=_0x597988;}),_0x3afbc3[_0x19851d(0x106)]((_0x2c0f7b,_0x356c04)=>{var _0x35a113=_0x19851d;_0x3f6d16[_0x356c04][_0x35a113(0x110)]=_0x2c0f7b;}),_0x4b5bfd['forEach']((_0x562e3c,_0x484aab)=>{var _0x61180c=_0x19851d;_0x3f6d16[_0x484aab][_0x61180c(0x9c)]=_0x562e3c;}),_0x6e3df3[_0x19851d(0x106)]((_0x301c50,_0x44523c)=>{var _0x5d018f=_0x19851d;_0x3f6d16[_0x44523c][_0x5d018f(0x94)]=_0x301c50;}),_0x2516f5[_0x19851d(0x106)]((_0x38554,_0x36c227)=>{var _0x259d57=_0x19851d;_0x3f6d16[_0x36c227][_0x259d57(0xf2)]=_0x38554;}),_0x499061[_0x19851d(0x106)]((_0x16024c,_0x53264d)=>{var _0x52f044=_0x19851d;_0x3f6d16[_0x53264d][_0x52f044(0x10d)]=_0x16024c;});const _0x5e3fc5=_0x3f6d16['filter'](_0x1c88c3=>_0x1c88c3[_0x19851d(0xcf)]!=='0'&&_0x1c88c3['adjust_qty']!=='');var _0x5450a1=0x0;_0x5e3fc5['forEach'](_0xb4ffc0=>{var _0x2d9655=_0x19851d;console[_0x2d9655(0x80)](_0x2d9655(0xb9),_0xb4ffc0),parseInt(_0xb4ffc0['adjust_qty'])<=0x0&&_0x5450a1++;});if(_0x5450a1!=0x0)return _0x108f2e['flash'](_0x19851d(0x79),_0x19851d(0x135)),_0x1ca3cb['redirect'](_0x19851d(0x92));_0x51ef1b['warehouse_name']=_0x5dc204,_0x51ef1b[_0x19851d(0xe9)]=_0x3c96c1,_0x51ef1b['product']=_0x5e3fc5,_0x51ef1b[_0x19851d(0x140)]=_0x4387a4,_0x51ef1b[_0x19851d(0xfa)]=_0x5f4d9a,_0x51ef1b['isAllowEdit']=_0x19851d(0x77);const _0x2f2835=await _0x51ef1b[_0x19851d(0xa0)]();_0x108f2e[_0x19851d(0x102)](_0x19851d(0xc3),'adjustment\x20data\x20update\x20successfully'),_0x1ca3cb[_0x19851d(0x127)](_0x19851d(0x8b));}catch(_0x1a05ec){console[_0x19851d(0x80)](_0x1a05ec);}}),router['post'](a0_0x374a3a(0xa5),async(_0x1e29c9,_0xb32e)=>{var _0x34f865=a0_0x374a3a;const {primary_code:_0x46d429,warehouse_data:_0x3a8360,rooms_data:_0x12aa95,Roomslist:_0x3ad039}=_0x1e29c9[_0x34f865(0x104)],_0xa36b01=_0x3ad039['split'](','),_0x5f4ea8=[];async function _0x1d3ceb(_0x35f993){var _0x42adad=_0x34f865;const _0x2afb3f=await warehouse[_0x42adad(0xc6)]([{'$match':{'name':_0x3a8360,'room':_0x35f993}},{'$unwind':_0x42adad(0x73)},{'$match':{'product_details.primary_code':_0x46d429}},{'$group':{'_id':_0x42adad(0xb5),'name':{'$first':_0x42adad(0x108)},'product_stock':{'$first':_0x42adad(0x130)},'primary_code':{'$first':_0x42adad(0xee)},'secondary_code':{'$first':_0x42adad(0x78)},'product_code':{'$first':_0x42adad(0x137)},'level':{'$first':_0x42adad(0x8f)},'isle':{'$first':_0x42adad(0xed)},'type':{'$first':_0x42adad(0x8e)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x42adad(0xd4)},'secondary_unit':{'$first':_0x42adad(0x6d)},'storage':{'$first':_0x42adad(0xbe)},'rack':{'$first':_0x42adad(0xbc)},'expiry_date':{'$first':_0x42adad(0xc1)},'production_date':{'$first':_0x42adad(0x96)},'maxPerUnit':{'$first':_0x42adad(0xcd)},'batch_code':{'$first':_0x42adad(0xcb)},'product_cat':{'$first':_0x42adad(0xd6)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x42adad(0x8c)},'invoice':{'$first':_0x42adad(0x101)}}}]),_0x95717a=await warehouse[_0x42adad(0xc6)]([{'$match':{'name':_0x3a8360,'room':_0x35f993}},{'$unwind':_0x42adad(0x73)},{'$match':{'product_details.secondary_code':_0x46d429}},{'$group':{'_id':_0x42adad(0xb5),'name':{'$first':_0x42adad(0x108)},'product_stock':{'$first':_0x42adad(0x130)},'primary_code':{'$first':_0x42adad(0xee)},'secondary_code':{'$first':_0x42adad(0x78)},'product_code':{'$first':_0x42adad(0x137)},'level':{'$first':_0x42adad(0x8f)},'isle':{'$first':_0x42adad(0xed)},'type':{'$first':_0x42adad(0x8e)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x42adad(0x6d)},'storage':{'$first':_0x42adad(0xbe)},'rack':{'$first':_0x42adad(0xbc)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x42adad(0x96)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x42adad(0xd6)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x42adad(0x8c)}}}]);if(_0x2afb3f[_0x42adad(0x12f)]>0x0)_0x5f4ea8[_0x42adad(0xe5)](_0x2afb3f);else _0x95717a['length']>0x0&&_0x5f4ea8['push'](_0x95717a);}const _0x10fab7=_0xa36b01[_0x34f865(0xba)](_0x18a577=>_0x1d3ceb(_0x18a577));await Promise[_0x34f865(0x133)](_0x10fab7),_0xb32e[_0x34f865(0x13e)](_0x5f4ea8);}),router[a0_0x374a3a(0xa8)]('/CheckingWarehouse',async(_0x2b7ae5,_0x48ce72)=>{var _0x405762=a0_0x374a3a;const {primaryCode:_0x28bd5a,secondaryCode:_0x5658c2,productCode:_0x22b307,level:_0x2a0364,isle:_0x44be8b,pallet:_0x378ac2,warehouses:_0x3e3dab,room:_0x193459}=_0x2b7ae5[_0x405762(0x104)];try{const _0x31d6cc=await warehouse[_0x405762(0xc6)]([{'$match':{'name':_0x3e3dab,'room':_0x193459}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x2a0364),'product_details.isle':_0x44be8b,'product_details.pallet':parseInt(_0x378ac2)}},{'$group':{'_id':_0x405762(0xb5),'name':{'$first':_0x405762(0x108)},'product_stock':{'$first':_0x405762(0x130)},'level':{'$first':_0x405762(0xc8)},'isle':{'$first':_0x405762(0xec)},'pallet':{'$first':_0x405762(0xfd)},'maxProducts':{'$first':_0x405762(0x116)}}}]);_0x48ce72[_0x405762(0x6c)](0xc8)['json'](_0x31d6cc);}catch(_0x5992ec){_0x48ce72[_0x405762(0x6c)](0x194)[_0x405762(0x13e)]({'message':_0x5992ec[_0x405762(0x123)]});}}),module[a0_0x374a3a(0x71)]=router;