function a0_0x5561(){var _0x167301=['status','rack','params','push','/barcode_scanner','French','Receiving\x20Area','$product_details.product_cat','product','prod_invoice','production_date','/adjustment/view','168894akxfHj','new_adjust_qty','/view/:id','/adjustment/preview/','expiry_date','Error\x20Occurs','post','prime1','Raw\x20Materials','Adjustment\x20Mail','error','$product','second1','$product_details.pallet','/view/add_adjustment','ADJ-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','New_Qty_Converted','prod_cat','render','$product.product_name','<tbody\x20style=\x22text-align:\x20center;\x22>','stock','add_adjustment','$product_details.primary_code','$product_details.isle','/view','bin','minus','adjust_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','English','../middleware/auth','/preview/:id','role','</h5>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','storage','Portuguese','Ambient','<h5\x20style=\x22text-align:\x20left;\x22>','adjustment\x20data\x20update\x20successfully','English\x20(US)','bay','image','filter','$product_details.bay','$product.room_names','room_names','Shelves','40269uUZOMN','Rooms','note','$room','$product_details.bin','Arabic','2268105UwqohS','length','warehouse_name','user','findById','Hindi','\x20Order\x20Date\x20:\x20','$product_details.storage','Chinese','password','max_per_unit','1905370uFiGHB','../public/language/languages.json','6255DCxuLy','level','types','adjustment','type','back','findOne','find','product_code','New_Qty_Converted_adj','$product_details.product_name','</tbody>','stockBefore','isAllowEdit','unit','floorlevel','_id','</head><body>','$product_details.type','invoice','4491fVqOQa','floor','flash','$product_details._id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.product_stock','Email\x20sent\x20successfully','$product_details.expiry_date','prod_name','createTransport','RMSEmail','body','187500QbuEMS','\x20<>\x20','$product_details.rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<strong>\x20Regards\x20</strong>','An\x20error\x20occurred\x20while\x20saving\x20data.','\x20</h2>','map','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','</div>','edit_adjustment','$product_details.level','warehouse','Router','</table>','Secondary_units','$product_details.secondary_unit','date','express','5336nDYjSb','string','German','$product_details.product_code','get','batch_code','then','Level','primary_code','$name','toString','aggregate','$date','log','room','False','$product_details.unit','100DeXzul','Spanish','<span\x20style=\x22float:\x20right;\x22>','Enclosed','success','id_transaction_from','all','$product_details.secondary_code','exports','master','$product_details.batch_code','finalize','True','foreach\x20newproduct','../models/all_models','adjustment\x20add\x20successfull','secondary_unit','product_stock','$invoice','site_title','Enabled','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','random','<tr>','Return\x20Rooms','$product_details','staff','<h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','forEach','catch','$product_details.production_date','$isAllowEdit','<!DOCTYPE\x20html>','language','product_details','email','$finalize','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Portuguese\x20(BR)','Floor','$product_details.floorlevel','/../public','redirect','product_name','sendMail','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.maxPerUnit','secondary_code','/picking_list/PDF_adjustment_rm/','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','id_transaction','Primary_Units','<hr\x20class=\x22my-3\x22>','errors','port','$warehouse_name','message','save','</tr>','</td>','$product_details.invoice','nodemailer','<div>','$_id','Arabic\x20(ae)','prod_code','1320EzbNHf','slice','host','json'];a0_0x5561=function(){return _0x167301;};return a0_0x5561();}var a0_0x22f431=a0_0x6ada;function a0_0x6ada(_0x2c937d,_0x168632){var _0x556166=a0_0x5561();return a0_0x6ada=function(_0x6ada45,_0x15d280){_0x6ada45=_0x6ada45-0x16c;var _0x98c69=_0x556166[_0x6ada45];return _0x98c69;},a0_0x6ada(_0x2c937d,_0x168632);}(function(_0x5c5afb,_0x3edb02){var _0x3668b0=a0_0x6ada,_0x1a93c3=_0x5c5afb();while(!![]){try{var _0x814f72=-parseInt(_0x3668b0(0x210))/0x1+parseInt(_0x3668b0(0x1aa))/0x2+parseInt(_0x3668b0(0x1dd))/0x3*(parseInt(_0x3668b0(0x234))/0x4)+parseInt(_0x3668b0(0x1f0))/0x5*(parseInt(_0x3668b0(0x19a))/0x6)+parseInt(_0x3668b0(0x1e3))/0x7+-parseInt(_0x3668b0(0x223))/0x8*(parseInt(_0x3668b0(0x204))/0x9)+-parseInt(_0x3668b0(0x1ee))/0xa;if(_0x814f72===_0x3edb02)break;else _0x1a93c3['push'](_0x1a93c3['shift']());}catch(_0x2a7060){_0x1a93c3['push'](_0x1a93c3['shift']());}}}(a0_0x5561,0x4b4a3));const express=require(a0_0x22f431(0x222)),app=express(),router=express[a0_0x22f431(0x21d)](),auth=require(a0_0x22f431(0x1ca)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x22f431(0x242)),users=require(a0_0x22f431(0x1ef)),nodemailer=require(a0_0x22f431(0x195));router[a0_0x22f431(0x227)](a0_0x22f431(0x1c4),auth,async(_0x6d1f83,_0x5902a2)=>{var _0x47fbf4=a0_0x22f431;try{const {username:_0x52e0d3,email:_0x137142,role:_0x92ee1e}=_0x6d1f83['user'],_0x207b15=_0x6d1f83[_0x47fbf4(0x1e6)],_0x406adb=await profile[_0x47fbf4(0x1f6)]({'email':_0x207b15[_0x47fbf4(0x17a)]}),_0x28aa67=await master_shop['find']();console[_0x47fbf4(0x230)](_0x47fbf4(0x23d),_0x28aa67);let _0x2e58c0;if(_0x207b15[_0x47fbf4(0x1cc)]==_0x47fbf4(0x170)){const _0x45c91b=await staff[_0x47fbf4(0x1f6)]({'email':_0x207b15[_0x47fbf4(0x17a)]});_0x2e58c0=await warehouse[_0x47fbf4(0x1f7)]({'status':'Enabled','name':_0x45c91b[_0x47fbf4(0x21c)]});}else _0x2e58c0=await warehouse[_0x47fbf4(0x1f7)]({'status':_0x47fbf4(0x248)});const _0x4f7881=await product['find']();let _0x557500;if(_0x207b15[_0x47fbf4(0x1cc)]==_0x47fbf4(0x170)){const _0x284b4e=await staff['findOne']({'email':_0x207b15[_0x47fbf4(0x17a)]});_0x557500=await adjustment['find']({'warehouse_name':_0x284b4e[_0x47fbf4(0x21c)]});}else _0x557500=await adjustment[_0x47fbf4(0x22e)]([{'$unwind':'$product'},{'$group':{'_id':_0x47fbf4(0x197),'invoice':{'$first':_0x47fbf4(0x246)},'date':{'$first':_0x47fbf4(0x22f)},'warehouse_name':{'$first':_0x47fbf4(0x18f)},'room':{'$addToSet':_0x47fbf4(0x1da)},'finalize':{'$first':_0x47fbf4(0x17b)},'isAllowEdit':{'$first':_0x47fbf4(0x176)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x28aa67[0x0]['language']=='English\x20(US)'){var _0x3912b7=users[_0x47fbf4(0x1c9)];console[_0x47fbf4(0x230)](_0x3912b7);}else{if(_0x28aa67[0x0][_0x47fbf4(0x178)]==_0x47fbf4(0x1e8))var _0x3912b7=users[_0x47fbf4(0x1e8)];else{if(_0x28aa67[0x0][_0x47fbf4(0x178)]==_0x47fbf4(0x225))var _0x3912b7=users['German'];else{if(_0x28aa67[0x0][_0x47fbf4(0x178)]==_0x47fbf4(0x235))var _0x3912b7=users[_0x47fbf4(0x235)];else{if(_0x28aa67[0x0][_0x47fbf4(0x178)]=='French')var _0x3912b7=users[_0x47fbf4(0x1a3)];else{if(_0x28aa67[0x0][_0x47fbf4(0x178)]=='Portuguese\x20(BR)')var _0x3912b7=users[_0x47fbf4(0x1d1)];else{if(_0x28aa67[0x0]['language']==_0x47fbf4(0x1eb))var _0x3912b7=users[_0x47fbf4(0x1eb)];else{if(_0x28aa67[0x0][_0x47fbf4(0x178)]==_0x47fbf4(0x198))var _0x3912b7=users['Arabic'];}}}}}}}_0x5902a2[_0x47fbf4(0x1bd)](_0x47fbf4(0x1f3),{'success':_0x6d1f83[_0x47fbf4(0x206)]('success'),'errors':_0x6d1f83[_0x47fbf4(0x206)](_0x47fbf4(0x18d)),'role':_0x207b15,'profile':_0x406adb,'warehouse':_0x2e58c0,'product':_0x4f7881,'adjustment':_0x557500,'master_shop':_0x28aa67,'language':_0x3912b7});}catch(_0x1c76f6){console[_0x47fbf4(0x230)](_0x1c76f6);}});async function getRandom8DigitNumber(){var _0x39add8=a0_0x22f431;const _0x39ffa0=0x989680,_0x4d0aba=0x5f5e0ff,_0x4caae6=Math[_0x39add8(0x205)](Math[_0x39add8(0x16c)]()*(_0x4d0aba-_0x39ffa0+0x1))+_0x39ffa0;var _0x33b99c;const _0x3b111c=await adjustment['findOne']({'invoice':_0x39add8(0x1b9)+_0x4caae6});return _0x3b111c&&_0x3b111c[_0x39add8(0x1e4)]>0x0?_0x33b99c=_0x39add8(0x1b9)+_0x4caae6:_0x33b99c=_0x39add8(0x1b9)+_0x4caae6,_0x33b99c;}router[a0_0x22f431(0x227)](a0_0x22f431(0x1b8),auth,async(_0x514f41,_0x522615)=>{var _0x2c25cc=a0_0x22f431;try{const {username:_0x37cc4b,email:_0x2acc0f,role:_0x34d434}=_0x514f41[_0x2c25cc(0x1e6)],_0x476bc6=_0x514f41[_0x2c25cc(0x1e6)],_0x2ad1d4=await profile[_0x2c25cc(0x1f6)]({'email':_0x476bc6['email']}),_0x4a4a96=await master_shop[_0x2c25cc(0x1f7)]();let _0x4f948c;if(_0x476bc6[_0x2c25cc(0x1cc)]==_0x2c25cc(0x170)){const _0x58bf2f=await staff[_0x2c25cc(0x1f6)]({'email':_0x476bc6[_0x2c25cc(0x17a)]});_0x4f948c=await warehouse[_0x2c25cc(0x22e)]([{'$match':{'status':_0x2c25cc(0x248),'name':_0x58bf2f['warehouse'],'warehouse_category':_0x2c25cc(0x1b2),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x2c25cc(0x22c),'name':{'$first':_0x2c25cc(0x22c)}}}]);}else _0x4f948c=await warehouse[_0x2c25cc(0x22e)]([{'$match':{'status':'Enabled','warehouse_category':_0x2c25cc(0x1b2),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x2c25cc(0x22c),'name':{'$first':'$name'}}}]);const _0xacf8c2=await product[_0x2c25cc(0x1f7)]({}),_0x38bead=await adjustment[_0x2c25cc(0x1f7)]({}),_0xef41cf=_0x38bead[_0x2c25cc(0x1e4)]+0x1,_0xcc126b=_0x2c25cc(0x1b9)+_0xef41cf[_0x2c25cc(0x22d)]()['padStart'](0x5,'0');var _0x5b8953=[_0x2c25cc(0x1d2),_0x2c25cc(0x237),_0x2c25cc(0x16e)];if(_0x4a4a96[0x0]['language']==_0x2c25cc(0x1d5))var _0x77f2ce=users[_0x2c25cc(0x1c9)];else{if(_0x4a4a96[0x0]['language']=='Hindi')var _0x77f2ce=users[_0x2c25cc(0x1e8)];else{if(_0x4a4a96[0x0][_0x2c25cc(0x178)]=='German')var _0x77f2ce=users[_0x2c25cc(0x225)];else{if(_0x4a4a96[0x0]['language']=='Spanish')var _0x77f2ce=users[_0x2c25cc(0x235)];else{if(_0x4a4a96[0x0][_0x2c25cc(0x178)]==_0x2c25cc(0x1a3))var _0x77f2ce=users[_0x2c25cc(0x1a3)];else{if(_0x4a4a96[0x0][_0x2c25cc(0x178)]==_0x2c25cc(0x17e))var _0x77f2ce=users[_0x2c25cc(0x1d1)];else{if(_0x4a4a96[0x0][_0x2c25cc(0x178)]=='Chinese')var _0x77f2ce=users['Chinese'];else{if(_0x4a4a96[0x0][_0x2c25cc(0x178)]==_0x2c25cc(0x198))var _0x77f2ce=users[_0x2c25cc(0x1e2)];}}}}}}}const _0x379559=getRandom8DigitNumber();_0x379559[_0x2c25cc(0x229)](_0x3ba3f0=>{var _0x993b2b=_0x2c25cc;_0x522615[_0x993b2b(0x1bd)](_0x993b2b(0x1c1),{'success':_0x514f41[_0x993b2b(0x206)](_0x993b2b(0x238)),'errors':_0x514f41[_0x993b2b(0x206)](_0x993b2b(0x18d)),'role':_0x476bc6,'profile':_0x2ad1d4,'warehouse':_0x4f948c,'product':_0xacf8c2,'master_shop':_0x4a4a96,'language':_0x77f2ce,'rooms_data':_0x5b8953,'invoice_no':_0x3ba3f0});})[_0x2c25cc(0x174)](_0x459bc2=>{var _0x386c72=_0x2c25cc;_0x514f41['flash'](_0x386c72(0x18d),_0x386c72(0x185)),_0x522615['redirect']('/adjustment/view');});}catch(_0x41ff37){console[_0x2c25cc(0x230)](_0x41ff37);}}),router['post'](a0_0x22f431(0x1b8),auth,async(_0x1e595b,_0x28cc13)=>{var _0x4a086a=a0_0x22f431;try{const {warehouse_name:_0x3320b9,date:_0x2573e8,prod_name:_0x3d7e61,level:_0x3a8e55,isle:_0x69e17e,pallet:_0x30acad,stock:_0x576167,types:_0x59f40f,adjust_qty:_0x52d8e4,new_adjust_qty:_0x24d2a2,note:_0x1b0b5f,Room_name:_0x3e1266,invoice:_0x136a01,JO_number:_0x3c6a0c,expiry_date:_0x481a81}=_0x1e595b['body'];if(typeof _0x3d7e61==_0x4a086a(0x224))var _0x165679=[_0x1e595b[_0x4a086a(0x20f)]['prod_name']],_0x513afe=[_0x1e595b[_0x4a086a(0x20f)]['level']],_0x5d6f87=[_0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1c0)]],_0x4ab743=[_0x1e595b[_0x4a086a(0x20f)]['types']],_0x222aa7=[_0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1f9)]],_0xd34981=[_0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1bb)]],_0x1f91b6=[_0x1e595b['body'][_0x4a086a(0x18b)]],_0x1f4ed8=[_0x1e595b['body'][_0x4a086a(0x21f)]],_0x3b6dde=[_0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x199)]],_0x4c2686=[_0x1e595b[_0x4a086a(0x20f)]['batch_code']],_0xbf4363=[_0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1ae)]],_0x25ccf3=[_0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1ed)]],_0x548780=[_0x1e595b['body'][_0x4a086a(0x1a8)]],_0x118982=[_0x1e595b[_0x4a086a(0x20f)]['prod_cat']],_0x1df50e=[_0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1de)]],_0x8b2043=[_0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1b1)]],_0x58d317=[_0x1e595b[_0x4a086a(0x20f)]['second1']],_0x6332dc=[_0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1a7)]],_0x5f3ace=[_0x1e595b['body']['id_transaction']];else var _0x165679=[..._0x1e595b[_0x4a086a(0x20f)]['prod_name']],_0x513afe=[..._0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1f1)]],_0x5d6f87=[..._0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1c0)]],_0x4ab743=[..._0x1e595b[_0x4a086a(0x20f)]['types']],_0x222aa7=[..._0x1e595b['body'][_0x4a086a(0x1f9)]],_0xd34981=[..._0x1e595b['body'][_0x4a086a(0x1bb)]],_0x1f91b6=[..._0x1e595b['body'][_0x4a086a(0x1fe)]],_0x1f4ed8=[..._0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x21f)]],_0x3b6dde=[..._0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x199)]],_0x4c2686=[..._0x1e595b[_0x4a086a(0x20f)]['batch_code']],_0xbf4363=[..._0x1e595b[_0x4a086a(0x20f)]['expiry_date']],_0x25ccf3=[..._0x1e595b[_0x4a086a(0x20f)]['max_per_unit']],_0x548780=[..._0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1a8)]],_0x118982=[..._0x1e595b['body'][_0x4a086a(0x1bc)]],_0x1df50e=[..._0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1de)]],_0x8b2043=[..._0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1b1)]],_0x58d317=[..._0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x1b6)]],_0x6332dc=[..._0x1e595b[_0x4a086a(0x20f)]['prod_invoice']],_0x5f3ace=[..._0x1e595b[_0x4a086a(0x20f)][_0x4a086a(0x18a)]];const _0x5003f9=_0x165679[_0x4a086a(0x217)](_0x1e54d2=>{return _0x1e54d2={'product_name':_0x1e54d2};});_0x513afe[_0x4a086a(0x173)]((_0xc834ad,_0x1fcd2c)=>{var _0x45e596=_0x4a086a;_0x1df50e[_0x45e596(0x173)]((_0x271312,_0x5d8cd8)=>{var _0x5990cf=_0x45e596;if(_0x271312==_0x5990cf(0x1a4)&&_0x1fcd2c==_0x5d8cd8){var _0x5a2d3b=_0xc834ad[_0x5990cf(0x19b)](0x3);_0x5003f9[_0x1fcd2c]['storage']=_0xc834ad[0x0],_0x5003f9[_0x1fcd2c][_0x5990cf(0x19f)]=_0xc834ad[0x1],_0x5003f9[_0x1fcd2c]['bay']=0x0,_0x5003f9[_0x1fcd2c][_0x5990cf(0x1c5)]=0x0,_0x5003f9[_0x1fcd2c][_0x5990cf(0x1f4)]=_0x5990cf(0x17f),_0x5003f9[_0x1fcd2c][_0x5990cf(0x1ff)]=_0x5a2d3b;}else{if(_0x271312==_0x5990cf(0x1dc)&&_0x1fcd2c==_0x5d8cd8){var _0x5a2d3b=_0xc834ad[_0x5990cf(0x19b)](0x3);_0x5003f9[_0x1fcd2c][_0x5990cf(0x1d0)]=_0xc834ad[0x0],_0x5003f9[_0x1fcd2c][_0x5990cf(0x19f)]=_0xc834ad[0x1],_0x5003f9[_0x1fcd2c][_0x5990cf(0x1d6)]=0x0,_0x5003f9[_0x1fcd2c]['bin']=0x0,_0x5003f9[_0x1fcd2c][_0x5990cf(0x1f4)]=_0x5990cf(0x17f),_0x5003f9[_0x1fcd2c][_0x5990cf(0x1ff)]=_0xc834ad[0x5];}else{if(_0x1fcd2c==_0x5d8cd8){var _0x4e7a46;if(_0xc834ad[0x4]=='L')_0x4e7a46=_0x5990cf(0x22a);else _0xc834ad[0x4]=='F'&&(_0x4e7a46='Floor');_0x5003f9[_0x1fcd2c][_0x5990cf(0x1d0)]=_0xc834ad[0x0],_0x5003f9[_0x1fcd2c][_0x5990cf(0x19f)]=_0xc834ad[0x1],_0x5003f9[_0x1fcd2c]['bay']=_0xc834ad[0x2],_0x5003f9[_0x1fcd2c][_0x5990cf(0x1c5)]=_0xc834ad[0x3],_0x5003f9[_0x1fcd2c][_0x5990cf(0x1f4)]=_0x4e7a46,_0x5003f9[_0x1fcd2c]['floorlevel']=_0xc834ad[0x5];}}}});}),_0x5d6f87[_0x4a086a(0x173)]((_0x4bd2e4,_0x3c65f1)=>{var _0x580f7d=_0x4a086a;_0x5003f9[_0x3c65f1][_0x580f7d(0x1fc)]=_0x4bd2e4;}),_0x5f3ace[_0x4a086a(0x173)]((_0x30c3f8,_0x3310f0)=>{var _0x441318=_0x4a086a;_0x5003f9[_0x3310f0][_0x441318(0x239)]=_0x30c3f8;}),_0x4ab743['forEach']((_0x507156,_0x4b1ce7)=>{var _0xa9428=_0x4a086a;_0x5003f9[_0x4b1ce7][_0xa9428(0x1f2)]=_0x507156;}),_0x222aa7['forEach']((_0x5aa59f,_0x451ab4)=>{_0x5003f9[_0x451ab4]['adjust_qty']=_0x5aa59f;}),_0xd34981['forEach']((_0x1ed4da,_0x415019)=>{_0x5003f9[_0x415019]['new_adjust_qty']=_0x1ed4da;}),_0x1f91b6[_0x4a086a(0x173)]((_0x2653c0,_0x216147)=>{var _0x25df3f=_0x4a086a;_0x5003f9[_0x216147][_0x25df3f(0x1fe)]=_0x2653c0;}),_0x1f4ed8[_0x4a086a(0x173)]((_0x29cbf5,_0x14c1cc)=>{var _0x594dcc=_0x4a086a;_0x5003f9[_0x14c1cc][_0x594dcc(0x244)]=_0x29cbf5;}),_0x3b6dde[_0x4a086a(0x173)]((_0x85d469,_0x3edb62)=>{var _0x2b73d1=_0x4a086a;_0x5003f9[_0x3edb62][_0x2b73d1(0x1f8)]=_0x85d469;}),_0x4c2686['forEach']((_0x213716,_0x8a05e5)=>{var _0x2156df=_0x4a086a;_0x5003f9[_0x8a05e5][_0x2156df(0x228)]=_0x213716;}),_0xbf4363[_0x4a086a(0x173)]((_0x698cd1,_0x1544f2)=>{_0x5003f9[_0x1544f2]['expiry_date']=_0x698cd1;}),_0x25ccf3[_0x4a086a(0x173)]((_0x3a10ec,_0x568381)=>{_0x5003f9[_0x568381]['maxperunit']=_0x3a10ec;}),_0x548780[_0x4a086a(0x173)]((_0x26468e,_0x3661b5)=>{var _0xed88ad=_0x4a086a;_0x5003f9[_0x3661b5][_0xed88ad(0x1a8)]=_0x26468e;}),_0x118982[_0x4a086a(0x173)]((_0x4eead1,_0x570593)=>{var _0x1d51ed=_0x4a086a;_0x5003f9[_0x570593][_0x1d51ed(0x1bc)]=_0x4eead1;}),_0x1df50e[_0x4a086a(0x173)]((_0xbc2bb,_0x2da62e)=>{var _0x208e55=_0x4a086a;_0x5003f9[_0x2da62e][_0x208e55(0x1db)]=_0xbc2bb;}),_0x8b2043[_0x4a086a(0x173)]((_0x4cf86d,_0x3f5cb7)=>{_0x5003f9[_0x3f5cb7]['primary_code']=_0x4cf86d;}),_0x58d317[_0x4a086a(0x173)]((_0x1fed39,_0x3da00d)=>{var _0x576bc8=_0x4a086a;_0x5003f9[_0x3da00d][_0x576bc8(0x187)]=_0x1fed39;}),_0x6332dc['forEach']((_0x28364c,_0x58b713)=>{var _0x60ee26=_0x4a086a;_0x5003f9[_0x58b713][_0x60ee26(0x203)]=_0x28364c;});const _0x2c3c7a=_0x5003f9['filter'](_0x80a5f5=>_0x80a5f5[_0x4a086a(0x1c7)]!=='0'&&_0x80a5f5[_0x4a086a(0x1c7)]!=='');var _0x546e72=0x0;_0x2c3c7a[_0x4a086a(0x173)](_0x3ca7a2=>{var _0x3f215c=_0x4a086a;console[_0x3f215c(0x230)](_0x3f215c(0x241),_0x3ca7a2),parseInt(_0x3ca7a2[_0x3f215c(0x1c7)])<=0x0&&_0x546e72++;});if(_0x546e72!=0x0)return _0x1e595b[_0x4a086a(0x206)](_0x4a086a(0x18d),_0x4a086a(0x218)),_0x28cc13[_0x4a086a(0x182)](_0x4a086a(0x1f5));const _0x178890=new adjustment({'warehouse_name':_0x3320b9,'date':_0x2573e8,'product':_0x2c3c7a,'note':_0x1b0b5f,'room':_0x3e1266,'invoice':_0x136a01,'JO_number':_0x3c6a0c,'expiry_date':_0x481a81}),_0x101f83=await _0x178890['save']();_0x1e595b[_0x4a086a(0x206)](_0x4a086a(0x238),_0x4a086a(0x243)),_0x28cc13[_0x4a086a(0x182)](_0x4a086a(0x1ad)+_0x101f83[_0x4a086a(0x200)]);}catch(_0x126c99){console[_0x4a086a(0x230)](_0x126c99),_0x28cc13[_0x4a086a(0x19e)](0xc8)[_0x4a086a(0x19d)]({'message':_0x126c99[_0x4a086a(0x190)]});}}),router[a0_0x22f431(0x227)](a0_0x22f431(0x1cb),auth,async(_0x173dda,_0xc38d5a)=>{var _0x2d9c62=a0_0x22f431;try{const {username:_0x22043b,email:_0x273b0c,role:_0x46f86e}=_0x173dda['user'],_0x2f46b4=_0x173dda[_0x2d9c62(0x1e6)],_0x261589=await profile[_0x2d9c62(0x1f6)]({'email':_0x2f46b4['email']}),_0x2f65d3=await master_shop[_0x2d9c62(0x1f7)](),_0x4f2e72=_0x173dda['params']['id'],_0x2c29e8=await adjustment['findById']({'_id':_0x4f2e72}),_0x598e12=await purchases[_0x2d9c62(0x22e)]([{'$match':{'warehouse_name':_0x2c29e8[_0x2d9c62(0x1e5)]}},{'$unwind':_0x2d9c62(0x1b5)},{'$group':{'_id':'$product.product_name'}}]),_0x378262=await product['find']({}),_0x42d5f5=await warehouse['aggregate']([{'$match':{'name':_0x2c29e8[_0x2d9c62(0x1e5)]}},{'$unwind':_0x2d9c62(0x16f)},{'$group':{'_id':_0x2d9c62(0x207),'name':{'$first':_0x2d9c62(0x1fa)},'product_stock':{'$first':_0x2d9c62(0x209)},'bay':{'$first':_0x2d9c62(0x1d9)},'bin':{'$first':_0x2d9c62(0x1e1)},'type':{'$first':_0x2d9c62(0x202)},'floorlevel':{'$first':_0x2d9c62(0x180)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2d9c62(0x23b)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2d9c62(0x1ea)},'rack':{'$first':_0x2d9c62(0x212)},'maxPerUnit':{'$first':_0x2d9c62(0x186)},'expiry_date':{'$first':_0x2d9c62(0x20b)},'production_date':{'$first':_0x2d9c62(0x175)},'batch_code':{'$first':_0x2d9c62(0x23e)},'room':{'$first':_0x2d9c62(0x1e0)}}}]);if(_0x2f65d3[0x0][_0x2d9c62(0x178)]==_0x2d9c62(0x1d5)){var _0x27636e=users[_0x2d9c62(0x1c9)];console[_0x2d9c62(0x230)](_0x27636e);}else{if(_0x2f65d3[0x0]['language']==_0x2d9c62(0x1e8))var _0x27636e=users[_0x2d9c62(0x1e8)];else{if(_0x2f65d3[0x0][_0x2d9c62(0x178)]=='German')var _0x27636e=users['German'];else{if(_0x2f65d3[0x0]['language']==_0x2d9c62(0x235))var _0x27636e=users[_0x2d9c62(0x235)];else{if(_0x2f65d3[0x0][_0x2d9c62(0x178)]=='French')var _0x27636e=users[_0x2d9c62(0x1a3)];else{if(_0x2f65d3[0x0]['language']==_0x2d9c62(0x17e))var _0x27636e=users['Portuguese'];else{if(_0x2f65d3[0x0][_0x2d9c62(0x178)]==_0x2d9c62(0x1eb))var _0x27636e=users[_0x2d9c62(0x1eb)];else{if(_0x2f65d3[0x0][_0x2d9c62(0x178)]=='Arabic\x20(ae)')var _0x27636e=users['Arabic'];}}}}}}}_0xc38d5a[_0x2d9c62(0x1bd)]('edit_adjustment_view',{'success':_0x173dda[_0x2d9c62(0x206)]('success'),'errors':_0x173dda[_0x2d9c62(0x206)]('errors'),'role':_0x2f46b4,'profile':_0x261589,'adjustment':_0x2c29e8,'stock':_0x42d5f5,'master_shop':_0x2f65d3,'warehouse_name':_0x598e12,'unit':_0x378262,'language':_0x27636e});}catch(_0x2c6d73){console[_0x2d9c62(0x230)](_0x2c6d73),_0xc38d5a[_0x2d9c62(0x19e)](0xc8)[_0x2d9c62(0x19d)]({'message':_0x2c6d73[_0x2d9c62(0x190)]});}}),router[a0_0x22f431(0x1b0)](a0_0x22f431(0x1cb),auth,async(_0x466337,_0x155661)=>{var _0x15b5e1=a0_0x22f431;try{const _0x50054e=_0x466337['params']['id'],{warehouse_name:_0x5b1c82,Room_name:_0x502915}=_0x466337[_0x15b5e1(0x20f)],_0x592d96=await adjustment[_0x15b5e1(0x1e7)]({'_id':_0x50054e}),_0x1c2c13=_0x592d96[_0x15b5e1(0x1a6)][_0x15b5e1(0x217)](async _0x216327=>{var _0x610c2c=_0x15b5e1;if(_0x216327[_0x610c2c(0x1c7)]>0x0){var _0x3daa03=await warehouse['findOne']({'name':_0x5b1c82,'room':_0x216327[_0x610c2c(0x1db)],'warehouse_category':_0x610c2c(0x1b2)});const _0x44cffa=_0x3daa03[_0x610c2c(0x179)][_0x610c2c(0x217)](_0x48b178=>{var _0x21e16e=_0x610c2c;console['log'](_0x216327[_0x21e16e(0x1f2)]+_0x21e16e(0x211));if(_0x216327['types']==_0x21e16e(0x1c6)){if(_0x48b178['product_name']==_0x216327[_0x21e16e(0x183)]&&_0x48b178['floorlevel']==_0x216327[_0x21e16e(0x1ff)]&&_0x48b178['type']==_0x216327['type']&&_0x48b178[_0x21e16e(0x1c5)]==_0x216327['bin']&&_0x48b178[_0x21e16e(0x1d6)]==_0x216327['bay']&&_0x48b178[_0x21e16e(0x19f)]==_0x216327[_0x21e16e(0x19f)]&&_0x48b178[_0x21e16e(0x1d0)]==_0x216327[_0x21e16e(0x1d0)]&&_0x48b178[_0x21e16e(0x1ae)]==_0x216327['expiry_date']&&_0x48b178[_0x21e16e(0x228)]==_0x216327[_0x21e16e(0x228)]&&_0x48b178[_0x21e16e(0x1a8)]==_0x216327[_0x21e16e(0x1a8)]&&_0x48b178[_0x21e16e(0x203)]==_0x216327[_0x21e16e(0x203)]&&_0x48b178['_id']==_0x216327[_0x21e16e(0x239)]){var _0x412fb4;_0x412fb4=_0x216327[_0x21e16e(0x1c7)],_0x216327[_0x21e16e(0x1bc)]=='S'&&(_0x412fb4=_0x216327[_0x21e16e(0x1c7)]),_0x48b178[_0x21e16e(0x245)]=_0x48b178[_0x21e16e(0x245)]-_0x412fb4;}}else{if(_0x48b178[_0x21e16e(0x183)]==_0x216327[_0x21e16e(0x183)]&&_0x48b178[_0x21e16e(0x1ff)]==_0x216327[_0x21e16e(0x1ff)]&&_0x48b178[_0x21e16e(0x1f4)]==_0x216327['type']&&_0x48b178[_0x21e16e(0x1c5)]==_0x216327['bin']&&_0x48b178[_0x21e16e(0x1d6)]==_0x216327['bay']&&_0x48b178[_0x21e16e(0x19f)]==_0x216327['rack']&&_0x48b178[_0x21e16e(0x1d0)]==_0x216327['storage']&&_0x48b178[_0x21e16e(0x1ae)]==_0x216327[_0x21e16e(0x1ae)]&&_0x48b178[_0x21e16e(0x228)]==_0x216327[_0x21e16e(0x228)]&&_0x48b178[_0x21e16e(0x1a8)]==_0x216327[_0x21e16e(0x1a8)]&&_0x48b178[_0x21e16e(0x203)]==_0x216327[_0x21e16e(0x203)]&&_0x48b178[_0x21e16e(0x200)]==_0x216327[_0x21e16e(0x239)]){console[_0x21e16e(0x230)](_0x216327);var _0x412fb4;_0x412fb4=_0x216327['adjust_qty'],_0x216327['prod_cat']=='S'&&(_0x412fb4=_0x216327[_0x21e16e(0x1c7)]),_0x48b178[_0x21e16e(0x245)]=_0x48b178[_0x21e16e(0x245)]+_0x412fb4;}}});}return _0x3daa03;});Promise[_0x15b5e1(0x23a)](_0x1c2c13)['then'](async _0x42ee6d=>{var _0x382b16=_0x15b5e1;try{for(const _0x1efded of _0x42ee6d){await _0x1efded[_0x382b16(0x191)]();}_0x592d96[_0x382b16(0x23f)]=_0x382b16(0x240);const _0x303e08=await _0x592d96[_0x382b16(0x191)](),_0x4f375d=await master_shop[_0x382b16(0x1f7)](),_0x4ae69c=await email_settings[_0x382b16(0x1f6)](),_0x1e1f3e=await supervisor_settings['find']();var _0x2575dd=_0x592d96[_0x382b16(0x1a6)],_0x5bfe0d='',_0x1116bb;for(_0x1116bb in _0x2575dd){_0x5bfe0d+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2575dd[_0x1116bb][_0x382b16(0x183)]+_0x382b16(0x193)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2575dd[_0x1116bb][_0x382b16(0x1f8)]+_0x382b16(0x193)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2575dd[_0x1116bb][_0x382b16(0x1c7)]+_0x382b16(0x193)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2575dd[_0x1116bb][_0x382b16(0x1fe)]+_0x382b16(0x193)+_0x382b16(0x1cf)+_0x2575dd[_0x1116bb][_0x382b16(0x244)]+'</td>'+_0x382b16(0x1cf)+_0x592d96['warehouse_name']+_0x382b16(0x193)+_0x382b16(0x1cf)+_0x2575dd[_0x1116bb]['room_names']+_0x382b16(0x193)+_0x382b16(0x1cf)+_0x2575dd[_0x1116bb][_0x382b16(0x1d0)]+_0x2575dd[_0x1116bb][_0x382b16(0x19f)]+_0x2575dd[_0x1116bb][_0x382b16(0x1d6)]+_0x2575dd[_0x1116bb][_0x382b16(0x1c5)]+_0x2575dd[_0x1116bb][_0x382b16(0x1f4)][0x0]+_0x2575dd[_0x1116bb][_0x382b16(0x1ff)]+_0x382b16(0x193),'</tr>';}let _0x2fbb8=nodemailer[_0x382b16(0x20d)]({'host':_0x4ae69c[_0x382b16(0x19c)],'port':Number(_0x4ae69c[_0x382b16(0x18e)]),'secure':![],'auth':{'user':_0x4ae69c['email'],'pass':_0x4ae69c[_0x382b16(0x1ec)]}}),_0x18cf45={'from':_0x4ae69c[_0x382b16(0x17a)],'to':_0x1e1f3e[0x0][_0x382b16(0x20e)],'subject':_0x382b16(0x1b3),'attachments':[{'filename':'Logo.png','path':__dirname+_0x382b16(0x181)+'/upload/'+_0x4f375d[0x0][_0x382b16(0x1d7)],'cid':'logo'}],'html':_0x382b16(0x177)+'<html><head><title></title>'+_0x382b16(0x201)+_0x382b16(0x196)+_0x382b16(0x249)+_0x382b16(0x196)+_0x382b16(0x189)+_0x382b16(0x219)+_0x382b16(0x196)+'<h2>\x20'+_0x4f375d[0x0][_0x382b16(0x247)]+_0x382b16(0x216)+_0x382b16(0x219)+_0x382b16(0x219)+_0x382b16(0x18c)+'<div>'+_0x382b16(0x1d3)+'\x20Order\x20Number\x20:\x20'+_0x592d96[_0x382b16(0x203)]+'\x20'+_0x382b16(0x236)+_0x382b16(0x1e9)+_0x592d96[_0x382b16(0x221)]+'\x20'+'</span>'+_0x382b16(0x1cd)+_0x382b16(0x219)+_0x382b16(0x1ce)+_0x382b16(0x17c)+_0x382b16(0x16d)+_0x382b16(0x1ba)+_0x382b16(0x17d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x382b16(0x208)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x382b16(0x172)+_0x382b16(0x1c8)+_0x382b16(0x213)+_0x382b16(0x192)+'</thead>'+_0x382b16(0x1bf)+'\x20'+_0x5bfe0d+'\x20'+_0x382b16(0x1fb)+_0x382b16(0x21e)+_0x382b16(0x196)+_0x382b16(0x214)+_0x382b16(0x171)+_0x4f375d[0x0][_0x382b16(0x247)]+_0x382b16(0x1cd)+_0x382b16(0x219)+_0x382b16(0x219)+'</body></html>'};_0x2fbb8[_0x382b16(0x184)](_0x18cf45,function(_0x3488f3,_0x4a7c4f){var _0x24918c=_0x382b16;_0x3488f3?(console[_0x24918c(0x230)](_0x3488f3),console[_0x24918c(0x230)](_0x24918c(0x1af))):console[_0x24918c(0x230)](_0x24918c(0x20a));}),_0x466337[_0x382b16(0x206)](_0x382b16(0x238),'adjustment\x20Finalized\x20successfully'),_0x155661[_0x382b16(0x182)](_0x382b16(0x188)+_0x303e08[_0x382b16(0x200)]);}catch(_0x202310){console[_0x382b16(0x1b4)](_0x202310),_0x155661[_0x382b16(0x19e)](0x1f4)['json']({'error':_0x382b16(0x215)});}})[_0x15b5e1(0x174)](_0x9c44f6=>{var _0x474472=_0x15b5e1;console[_0x474472(0x1b4)](_0x9c44f6),_0x155661[_0x474472(0x19e)](0x1f4)[_0x474472(0x19d)]({'error':'An\x20error\x20occurred.'});});}catch(_0xce8b1d){console['log'](_0xce8b1d),_0x155661['status'](0xc8)[_0x15b5e1(0x19d)]({'message':_0xce8b1d[_0x15b5e1(0x190)]});}}),router[a0_0x22f431(0x227)]('/view/:id',auth,async(_0x1229d1,_0x3ea0ed)=>{var _0x2add6c=a0_0x22f431;try{const {username:_0x41f361,email:_0x28ebec,role:_0x1cb308}=_0x1229d1[_0x2add6c(0x1e6)],_0x463567=_0x1229d1['user'],_0x4505fa=await profile['findOne']({'email':_0x463567['email']}),_0x32b0ba=await master_shop['find'](),_0x584632=_0x1229d1[_0x2add6c(0x1a0)]['id'],_0x432468=await adjustment[_0x2add6c(0x1e7)]({'_id':_0x584632}),_0x300c87=await purchases[_0x2add6c(0x22e)]([{'$match':{'warehouse_name':_0x432468[_0x2add6c(0x1e5)]}},{'$unwind':_0x2add6c(0x1b5)},{'$group':{'_id':_0x2add6c(0x1be)}}]),_0x1fa74c=await product[_0x2add6c(0x1f7)]({}),_0x249238=await warehouse[_0x2add6c(0x22e)]([{'$match':{'name':_0x432468[_0x2add6c(0x1e5)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2add6c(0x207),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2add6c(0x209)},'bay':{'$first':_0x2add6c(0x1d9)},'bin':{'$first':_0x2add6c(0x1e1)},'type':{'$first':_0x2add6c(0x202)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2add6c(0x1c2)},'secondary_code':{'$first':_0x2add6c(0x23b)},'product_code':{'$first':_0x2add6c(0x226)},'storage':{'$first':_0x2add6c(0x1ea)},'rack':{'$first':_0x2add6c(0x212)},'maxPerUnit':{'$first':_0x2add6c(0x186)},'expiry_date':{'$first':_0x2add6c(0x20b)},'production_date':{'$first':_0x2add6c(0x175)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x2add6c(0x1e0)}}}]);let _0x2a60d5;if(_0x463567[_0x2add6c(0x1cc)]=='staff'){const _0x2fe625=await staff[_0x2add6c(0x1f6)]({'email':_0x463567[_0x2add6c(0x17a)]});_0x2a60d5=await warehouse['aggregate']([{'$match':{'status':_0x2add6c(0x248),'name':_0x2fe625[_0x2add6c(0x21c)],'warehouse_category':_0x2add6c(0x1b2),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x2add6c(0x22c),'name':{'$first':_0x2add6c(0x22c)}}}]);}else _0x2a60d5=await warehouse[_0x2add6c(0x22e)]([{'$match':{'status':_0x2add6c(0x248),'warehouse_category':_0x2add6c(0x1b2),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);if(_0x32b0ba[0x0]['language']==_0x2add6c(0x1d5)){var _0x589a6b=users[_0x2add6c(0x1c9)];console[_0x2add6c(0x230)](_0x589a6b);}else{if(_0x32b0ba[0x0]['language']=='Hindi')var _0x589a6b=users['Hindi'];else{if(_0x32b0ba[0x0][_0x2add6c(0x178)]==_0x2add6c(0x225))var _0x589a6b=users['German'];else{if(_0x32b0ba[0x0][_0x2add6c(0x178)]==_0x2add6c(0x235))var _0x589a6b=users[_0x2add6c(0x235)];else{if(_0x32b0ba[0x0]['language']==_0x2add6c(0x1a3))var _0x589a6b=users[_0x2add6c(0x1a3)];else{if(_0x32b0ba[0x0][_0x2add6c(0x178)]=='Portuguese\x20(BR)')var _0x589a6b=users[_0x2add6c(0x1d1)];else{if(_0x32b0ba[0x0][_0x2add6c(0x178)]==_0x2add6c(0x1eb))var _0x589a6b=users[_0x2add6c(0x1eb)];else{if(_0x32b0ba[0x0][_0x2add6c(0x178)]=='Arabic\x20(ae)')var _0x589a6b=users[_0x2add6c(0x1e2)];}}}}}}}_0x3ea0ed[_0x2add6c(0x1bd)](_0x2add6c(0x21a),{'success':_0x1229d1[_0x2add6c(0x206)](_0x2add6c(0x238)),'errors':_0x1229d1[_0x2add6c(0x206)](_0x2add6c(0x18d)),'role':_0x463567,'profile':_0x4505fa,'adjustment':_0x432468,'stock':_0x249238,'master_shop':_0x32b0ba,'warehouse_name':_0x300c87,'unit':_0x1fa74c,'language':_0x589a6b,'warehouse':_0x2a60d5});}catch(_0xdcbae1){console[_0x2add6c(0x230)](_0xdcbae1),_0x3ea0ed[_0x2add6c(0x19e)](0xc8)[_0x2add6c(0x19d)]({'message':_0xdcbae1[_0x2add6c(0x190)]});}}),router[a0_0x22f431(0x1b0)](a0_0x22f431(0x1ac),auth,async(_0x309b25,_0x1f5057)=>{var _0x2919e3=a0_0x22f431;try{const _0x344795=_0x309b25['params']['id'],_0x473605=await adjustment[_0x2919e3(0x1e7)]({'_id':_0x344795}),_0x14e1e3=await warehouse['findOne']({'name':_0x473605['warehouse_name'],'room':_0x473605[_0x2919e3(0x231)]}),{warehouse_name:_0x1b04e2,date:_0x3cb20d,prod_name:_0x2f15db,level:_0x54538a,isle:_0x1f7262,pallet:_0x16f023,stock:_0x474b39,types:_0x1bd5f2,adjust_qty:_0x24fe5b,new_adjust_qty:_0x520244,note:_0x5c23c5,Room_name:_0x284cd7,invoice:_0x39f503,JO_number:_0x404729,expiry_date:_0x24fa9b}=_0x309b25[_0x2919e3(0x20f)];if(typeof _0x2f15db==_0x2919e3(0x224))var _0x237520=[_0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x20c)]],_0x5c8950=[_0x309b25['body'][_0x2919e3(0x1f1)]],_0x3f8a6f=[_0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1c0)]],_0x5e788e=[_0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1f2)]],_0x22c899=[_0x309b25['body'][_0x2919e3(0x1f9)]],_0x2415c7=[_0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1bb)]],_0x2b61ab=[_0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x18b)]],_0x18daa8=[_0x309b25['body'][_0x2919e3(0x21f)]],_0x1cf68c=[_0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x199)]],_0x40b8be=[_0x309b25['body'][_0x2919e3(0x228)]],_0x38fc27=[_0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1ae)]],_0xb85438=[_0x309b25['body']['max_per_unit']],_0x1d7b2a=[_0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1a8)]],_0x3e96dd=[_0x309b25['body'][_0x2919e3(0x1bc)]],_0x42cbe2=[_0x309b25['body'][_0x2919e3(0x1de)]],_0x5818e1=[_0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1b1)]],_0x5d8680=[_0x309b25['body'][_0x2919e3(0x1b6)]];else var _0x237520=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x20c)]],_0x5c8950=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1f1)]],_0x3f8a6f=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1c0)]],_0x5e788e=[..._0x309b25['body'][_0x2919e3(0x1f2)]],_0x22c899=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1f9)]],_0x2415c7=[..._0x309b25['body'][_0x2919e3(0x1bb)]],_0x2b61ab=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1fe)]],_0x18daa8=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x21f)]],_0x1cf68c=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x199)]],_0x40b8be=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x228)]],_0x38fc27=[..._0x309b25[_0x2919e3(0x20f)]['expiry_date']],_0xb85438=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1ed)]],_0x1d7b2a=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1a8)]],_0x3e96dd=[..._0x309b25['body'][_0x2919e3(0x1bc)]],_0x42cbe2=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1de)]],_0x5818e1=[..._0x309b25[_0x2919e3(0x20f)][_0x2919e3(0x1b1)]],_0x5d8680=[..._0x309b25['body'][_0x2919e3(0x1b6)]];const _0x806c=_0x237520['map'](_0x297cf4=>{return _0x297cf4={'product_name':_0x297cf4};});_0x5c8950['forEach']((_0xa9ba3,_0x20893e)=>{var _0x3003fa=_0x2919e3;_0x42cbe2[_0x3003fa(0x173)]((_0x4eaa0c,_0x52699a)=>{var _0x1cfa7d=_0x3003fa;if(_0x4eaa0c==_0x1cfa7d(0x1a4)&&_0x20893e==_0x52699a){var _0x322971=_0xa9ba3[_0x1cfa7d(0x19b)](0x3);_0x806c[_0x20893e][_0x1cfa7d(0x1d0)]=_0xa9ba3[0x0],_0x806c[_0x20893e][_0x1cfa7d(0x19f)]=_0xa9ba3[0x1],_0x806c[_0x20893e][_0x1cfa7d(0x1d6)]=0x0,_0x806c[_0x20893e]['bin']=0x0,_0x806c[_0x20893e][_0x1cfa7d(0x1f4)]=_0x1cfa7d(0x17f),_0x806c[_0x20893e][_0x1cfa7d(0x1ff)]=_0x322971;}else{if(_0x4eaa0c==_0x1cfa7d(0x1dc)&&_0x20893e==_0x52699a){var _0x322971=_0xa9ba3['slice'](0x3);_0x806c[_0x20893e][_0x1cfa7d(0x1d0)]=_0xa9ba3[0x0],_0x806c[_0x20893e][_0x1cfa7d(0x19f)]=_0xa9ba3[0x1],_0x806c[_0x20893e][_0x1cfa7d(0x1d6)]=0x0,_0x806c[_0x20893e][_0x1cfa7d(0x1c5)]=0x0,_0x806c[_0x20893e][_0x1cfa7d(0x1f4)]=_0x1cfa7d(0x17f),_0x806c[_0x20893e][_0x1cfa7d(0x1ff)]=_0xa9ba3[0x5];}else{if(_0x20893e==_0x52699a){var _0x38e72a;if(_0xa9ba3[0x4]=='L')_0x38e72a=_0x1cfa7d(0x22a);else _0xa9ba3[0x4]=='F'&&(_0x38e72a=_0x1cfa7d(0x17f));_0x806c[_0x20893e][_0x1cfa7d(0x1d0)]=_0xa9ba3[0x0],_0x806c[_0x20893e][_0x1cfa7d(0x19f)]=_0xa9ba3[0x1],_0x806c[_0x20893e][_0x1cfa7d(0x1d6)]=_0xa9ba3[0x2],_0x806c[_0x20893e][_0x1cfa7d(0x1c5)]=_0xa9ba3[0x3],_0x806c[_0x20893e][_0x1cfa7d(0x1f4)]=_0x38e72a,_0x806c[_0x20893e][_0x1cfa7d(0x1ff)]=_0xa9ba3[0x5];}}}});}),_0x3f8a6f[_0x2919e3(0x173)]((_0x58bafe,_0x408226)=>{var _0x22670a=_0x2919e3;_0x806c[_0x408226][_0x22670a(0x1fc)]=_0x58bafe;}),_0x5e788e[_0x2919e3(0x173)]((_0x28f563,_0x5e004e)=>{var _0x4c96b0=_0x2919e3;_0x806c[_0x5e004e][_0x4c96b0(0x1f2)]=_0x28f563;}),_0x22c899['forEach']((_0x27cbea,_0x17c40e)=>{var _0x112943=_0x2919e3;_0x806c[_0x17c40e][_0x112943(0x1c7)]=_0x27cbea;}),_0x2415c7[_0x2919e3(0x173)]((_0xdd0301,_0x42b40b)=>{var _0x18d6dc=_0x2919e3;_0x806c[_0x42b40b][_0x18d6dc(0x1ab)]=_0xdd0301;}),_0x2b61ab[_0x2919e3(0x173)]((_0xbd64bc,_0x198d38)=>{var _0x8514be=_0x2919e3;_0x806c[_0x198d38][_0x8514be(0x1fe)]=_0xbd64bc;}),_0x18daa8['forEach']((_0x2f916b,_0x40da9a)=>{var _0xa5b92f=_0x2919e3;_0x806c[_0x40da9a][_0xa5b92f(0x244)]=_0x2f916b;}),_0x1cf68c[_0x2919e3(0x173)]((_0x343a65,_0x4b4074)=>{var _0x15cea1=_0x2919e3;_0x806c[_0x4b4074][_0x15cea1(0x1f8)]=_0x343a65;}),_0x40b8be['forEach']((_0x146ec2,_0x50132c)=>{var _0x27d8c0=_0x2919e3;_0x806c[_0x50132c][_0x27d8c0(0x228)]=_0x146ec2;}),_0x38fc27[_0x2919e3(0x173)]((_0x308425,_0x8acb72)=>{var _0x6a3313=_0x2919e3;_0x806c[_0x8acb72][_0x6a3313(0x1ae)]=_0x308425;}),_0xb85438[_0x2919e3(0x173)]((_0x16853f,_0x48472f)=>{_0x806c[_0x48472f]['maxperunit']=_0x16853f;}),_0x1d7b2a[_0x2919e3(0x173)]((_0x111747,_0x2fd8a6)=>{_0x806c[_0x2fd8a6]['production_date']=_0x111747;}),_0x3e96dd[_0x2919e3(0x173)]((_0x3ccdaf,_0xbfdde0)=>{var _0x2be784=_0x2919e3;_0x806c[_0xbfdde0][_0x2be784(0x1bc)]=_0x3ccdaf;}),_0x42cbe2[_0x2919e3(0x173)]((_0x3c9396,_0x315ff5)=>{var _0x668abf=_0x2919e3;_0x806c[_0x315ff5][_0x668abf(0x1db)]=_0x3c9396;}),_0x5818e1[_0x2919e3(0x173)]((_0x4815ba,_0x3d6bbb)=>{var _0x570987=_0x2919e3;_0x806c[_0x3d6bbb][_0x570987(0x22b)]=_0x4815ba;}),_0x5d8680[_0x2919e3(0x173)]((_0x47f127,_0x4ef544)=>{_0x806c[_0x4ef544]['secondary_code']=_0x47f127;});const _0x528ac6=_0x806c[_0x2919e3(0x1d8)](_0x4d35db=>_0x4d35db[_0x2919e3(0x1c7)]!=='0'&&_0x4d35db[_0x2919e3(0x1c7)]!=='');var _0x31ddc7=0x0;_0x528ac6['forEach'](_0x42fcec=>{var _0x3514c9=_0x2919e3;console['log'](_0x3514c9(0x241),_0x42fcec),parseInt(_0x42fcec[_0x3514c9(0x1c7)])<=0x0&&_0x31ddc7++;});if(_0x31ddc7!=0x0)return _0x309b25[_0x2919e3(0x206)](_0x2919e3(0x18d),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x1f5057[_0x2919e3(0x182)](_0x2919e3(0x1f5));_0x473605[_0x2919e3(0x1e5)]=_0x1b04e2,_0x473605[_0x2919e3(0x221)]=_0x3cb20d,_0x473605['product']=_0x528ac6,_0x473605[_0x2919e3(0x1df)]=_0x5c23c5,_0x473605[_0x2919e3(0x203)]=_0x39f503,_0x473605[_0x2919e3(0x1fd)]=_0x2919e3(0x232);const _0x51b2ae=await _0x473605['save']();_0x309b25[_0x2919e3(0x206)](_0x2919e3(0x238),_0x2919e3(0x1d4)),_0x1f5057[_0x2919e3(0x182)](_0x2919e3(0x1a9));}catch(_0x411a4d){console[_0x2919e3(0x230)](_0x411a4d);}}),router['post'](a0_0x22f431(0x1a2),async(_0x2422f6,_0x2a84d1)=>{var _0x103179=a0_0x22f431;const {primary_code:_0x424271,warehouse_data:_0x24dc83,rooms_data:_0x302ef5,Roomslist:_0x3fc307}=_0x2422f6[_0x103179(0x20f)],_0x3c221c=_0x3fc307['split'](','),_0xbb0549=[];async function _0x54cc9d(_0x12a631){var _0x4aa14a=_0x103179;const _0x5e1c0b=await warehouse[_0x4aa14a(0x22e)]([{'$match':{'name':_0x24dc83,'room':_0x12a631}},{'$unwind':_0x4aa14a(0x16f)},{'$match':{'product_details.primary_code':_0x424271}},{'$group':{'_id':_0x4aa14a(0x207),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4aa14a(0x209)},'primary_code':{'$first':_0x4aa14a(0x1c2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4aa14a(0x226)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x4aa14a(0x1e1)},'type':{'$first':_0x4aa14a(0x202)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x4aa14a(0x233)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x4aa14a(0x1ea)},'rack':{'$first':_0x4aa14a(0x212)},'expiry_date':{'$first':_0x4aa14a(0x20b)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x4aa14a(0x23e)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x4aa14a(0x194)}}}]),_0x2ebaae=await warehouse[_0x4aa14a(0x22e)]([{'$match':{'name':_0x24dc83,'room':_0x12a631}},{'$unwind':_0x4aa14a(0x16f)},{'$match':{'product_details.secondary_code':_0x424271}},{'$group':{'_id':_0x4aa14a(0x207),'name':{'$first':_0x4aa14a(0x1fa)},'product_stock':{'$first':_0x4aa14a(0x209)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4aa14a(0x23b)},'product_code':{'$first':_0x4aa14a(0x226)},'level':{'$first':_0x4aa14a(0x1d9)},'isle':{'$first':_0x4aa14a(0x1e1)},'type':{'$first':_0x4aa14a(0x202)},'pallet':{'$first':_0x4aa14a(0x180)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4aa14a(0x220)},'storage':{'$first':_0x4aa14a(0x1ea)},'rack':{'$first':_0x4aa14a(0x212)},'expiry_date':{'$first':_0x4aa14a(0x20b)},'production_date':{'$first':_0x4aa14a(0x175)},'maxPerUnit':{'$first':_0x4aa14a(0x186)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x4aa14a(0x1a5)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x4aa14a(0x1e0)}}}]);if(_0x5e1c0b[_0x4aa14a(0x1e4)]>0x0)_0xbb0549[_0x4aa14a(0x1a1)](_0x5e1c0b);else _0x2ebaae[_0x4aa14a(0x1e4)]>0x0&&_0xbb0549[_0x4aa14a(0x1a1)](_0x2ebaae);}const _0x2373bd=_0x3c221c[_0x103179(0x217)](_0x2141c8=>_0x54cc9d(_0x2141c8));await Promise['all'](_0x2373bd),_0x2a84d1['json'](_0xbb0549);}),router[a0_0x22f431(0x1b0)]('/CheckingWarehouse',async(_0x1c20df,_0x295beb)=>{var _0x481db4=a0_0x22f431;const {primaryCode:_0x55ea43,secondaryCode:_0x5ed670,productCode:_0x5b2434,level:_0x5b9683,isle:_0x3459e1,pallet:_0x392f27,warehouses:_0x3d5f85,room:_0x1295d2}=_0x1c20df[_0x481db4(0x20f)];try{const _0x511901=await warehouse['aggregate']([{'$match':{'name':_0x3d5f85,'room':_0x1295d2}},{'$unwind':_0x481db4(0x16f)},{'$match':{'product_details.level':parseInt(_0x5b9683),'product_details.isle':_0x3459e1,'product_details.pallet':parseInt(_0x392f27)}},{'$group':{'_id':_0x481db4(0x207),'name':{'$first':_0x481db4(0x1fa)},'product_stock':{'$first':_0x481db4(0x209)},'level':{'$first':_0x481db4(0x21b)},'isle':{'$first':_0x481db4(0x1c3)},'pallet':{'$first':_0x481db4(0x1b7)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x295beb[_0x481db4(0x19e)](0xc8)[_0x481db4(0x19d)](_0x511901);}catch(_0x22172a){_0x295beb[_0x481db4(0x19e)](0x194)[_0x481db4(0x19d)]({'message':_0x22172a['message']});}}),module[a0_0x22f431(0x23c)]=router;