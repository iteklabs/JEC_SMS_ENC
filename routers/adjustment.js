function a0_0x3bc7(_0x5230f0,_0x4e642a){var _0x5c7f59=a0_0x5c7f();return a0_0x3bc7=function(_0x3bc706,_0x5b57fc){_0x3bc706=_0x3bc706-0xda;var _0x7e8417=_0x5c7f59[_0x3bc706];return _0x7e8417;},a0_0x3bc7(_0x5230f0,_0x4e642a);}function a0_0x5c7f(){var _0xf6eb63=['product_stock','maxperunit','filter','warehouse_name','<tbody\x20style=\x22text-align:\x20center;\x22>','site_title','user','RMSEmail','$product_details.product_cat','/adjustment/view','express','sendMail','product_name','secondary_unit','$name','</h5>','logo','note','edit_adjustment_view','../middleware/auth','json','findById','$product_details.product_code','new_adjust_qty','role','../models/all_models','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product.room_names','floor','$product_details.type','<html><head><title></title>','toString','date','adjustment\x20add\x20successfull','<h5>','</tr>','<tr>','Error\x20Occurs','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','flash','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','10WYNZIz','Chinese','production_date','3751641ZINLqH','$product_details.level','188AYkwjQ','4OZeeTt','master','room','unit','19494YATYsZ','room_names','English\x20(US)','$product_details','random','email','Portuguese\x20(BR)','Adjustment\x20Mail','errors','False','language','\x20Order\x20Number\x20:\x20','$invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','German','English','stockBefore','id_transaction','_id','$product_details.rack','/adjustment/preview/','isAllowEdit','<h2>\x20','French','prime1','expiry_date','1991gOiEVH','host','Return\x20Goods','$product','ADJ-','staff','max_per_unit','Receiving\x20Area','body','$_id','message','adjust_qty','Primary_Units','rack','bay','\x20<>\x20','all','exports','New_Qty_Converted','$product_details.expiry_date','$product_details.maxPerUnit','<hr\x20class=\x22my-3\x22>','Arabic','string','$product.product_name','</tbody>','stock','log','prod_invoice','$product_details._id','<!DOCTYPE\x20html>','status','product_details','683435TDbbbI','split','<div>','</thead>','$product_details.bay','$product_details.bin','floorlevel','New_Qty_Converted_adj','id_transaction_from','then','Level','invoice','warehouse','render','11238jpyBSx','types','/view/add_adjustment','prod_code','get','Portuguese','An\x20error\x20occurred\x20while\x20saving\x20data.','Arabic\x20(ae)','image','$warehouse_name','padStart','$product_details.secondary_unit','Return\x20Rooms','push','</head><body>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','findOne','Enabled','second1','/upload/','edit_adjustment','\x20</h2>','adjustment\x20Finalized\x20successfully','$product_details.unit','33372xciRfd','adjustment','slice','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','error','$room','$product_details.maxProducts','save','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Raw\x20Materials','$product_details.storage','primary_code','level','Shelves','\x20Order\x20Date\x20:\x20','</div>','Ambient','params','/picking_list/PDF_adjustment_rm/','createTransport','8167296FPCukq','$product_details.batch_code','prod_name','Spanish','type','True','batch_code','prod_cat','</td>','<h5\x20style=\x22text-align:\x20left;\x22>','Hindi','Rooms','/../public','storage','aggregate','$product_details.floorlevel','$product_details.production_date','success','$product_details.secondary_code','Email\x20sent\x20successfully','redirect','bin','product','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/view/:id','find','Secondary_units','</table>','catch','2681wShYsm','$product_details.invoice','Logo.png','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','post','$isAllowEdit','$product_details.product_stock','$product_details.product_name','395833qKqqmI','forEach','$product_details.primary_code','$product_details.pallet','Floor','back','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','secondary_code','map','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','length'];a0_0x5c7f=function(){return _0xf6eb63;};return a0_0x5c7f();}var a0_0x53386d=a0_0x3bc7;(function(_0x537c4a,_0x56653d){var _0x303f7a=a0_0x3bc7,_0x2e85d9=_0x537c4a();while(!![]){try{var _0x420230=parseInt(_0x303f7a(0x138))/0x1*(parseInt(_0x303f7a(0x172))/0x2)+parseInt(_0x303f7a(0xe7))/0x3*(-parseInt(_0x303f7a(0x171))/0x4)+parseInt(_0x303f7a(0x1b1))/0x5+-parseInt(_0x303f7a(0x176))/0x6*(-parseInt(_0x303f7a(0x130))/0x7)+-parseInt(_0x303f7a(0x113))/0x8+parseInt(_0x303f7a(0x16f))/0x9*(parseInt(_0x303f7a(0x16c))/0xa)+parseInt(_0x303f7a(0x190))/0xb*(-parseInt(_0x303f7a(0xff))/0xc);if(_0x420230===_0x56653d)break;else _0x2e85d9['push'](_0x2e85d9['shift']());}catch(_0xbd8fd0){_0x2e85d9['push'](_0x2e85d9['shift']());}}}(a0_0x5c7f,0xd9192));const express=require(a0_0x53386d(0x14d)),app=express(),router=express['Router'](),auth=require(a0_0x53386d(0x156)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x53386d(0x15c)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x53386d(0xeb)]('/view',auth,async(_0x502ae5,_0x3e6c3e)=>{var _0x17a9f6=a0_0x53386d;try{const {username:_0x13f57d,email:_0x4ee2e2,role:_0x3ea3a9}=_0x502ae5[_0x17a9f6(0x149)],_0x3eae0f=_0x502ae5[_0x17a9f6(0x149)],_0x131095=await profile[_0x17a9f6(0xf7)]({'email':_0x3eae0f['email']}),_0x4f8168=await master_shop[_0x17a9f6(0x12c)]();console[_0x17a9f6(0x1ab)](_0x17a9f6(0x173),_0x4f8168);let _0x3cc4c7;if(_0x3eae0f[_0x17a9f6(0x15b)]==_0x17a9f6(0x195)){const _0x5a9220=await staff[_0x17a9f6(0xf7)]({'email':_0x3eae0f[_0x17a9f6(0x17b)]});_0x3cc4c7=await warehouse[_0x17a9f6(0x12c)]({'status':_0x17a9f6(0xf8),'name':_0x5a9220['warehouse']});}else _0x3cc4c7=await warehouse[_0x17a9f6(0x12c)]({'status':'Enabled'});const _0x16eba9=await product[_0x17a9f6(0x12c)]();let _0x265c39;if(_0x3eae0f[_0x17a9f6(0x15b)]==_0x17a9f6(0x195)){const _0x32fe29=await staff[_0x17a9f6(0xf7)]({'email':_0x3eae0f[_0x17a9f6(0x17b)]});_0x265c39=await adjustment['find']({'warehouse_name':_0x32fe29[_0x17a9f6(0xe5)]});}else _0x265c39=await adjustment[_0x17a9f6(0x121)]([{'$unwind':'$product'},{'$group':{'_id':_0x17a9f6(0x199),'invoice':{'$first':_0x17a9f6(0x182)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x17a9f6(0xf0)},'room':{'$addToSet':_0x17a9f6(0x15e)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x17a9f6(0x135)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4f8168[0x0][_0x17a9f6(0x180)]==_0x17a9f6(0x178)){var _0x5971cb=users[_0x17a9f6(0x185)];console[_0x17a9f6(0x1ab)](_0x5971cb);}else{if(_0x4f8168[0x0][_0x17a9f6(0x180)]=='Hindi')var _0x5971cb=users['Hindi'];else{if(_0x4f8168[0x0][_0x17a9f6(0x180)]==_0x17a9f6(0x184))var _0x5971cb=users['German'];else{if(_0x4f8168[0x0][_0x17a9f6(0x180)]==_0x17a9f6(0x116))var _0x5971cb=users[_0x17a9f6(0x116)];else{if(_0x4f8168[0x0][_0x17a9f6(0x180)]==_0x17a9f6(0x18d))var _0x5971cb=users[_0x17a9f6(0x18d)];else{if(_0x4f8168[0x0][_0x17a9f6(0x180)]==_0x17a9f6(0x17c))var _0x5971cb=users['Portuguese'];else{if(_0x4f8168[0x0][_0x17a9f6(0x180)]==_0x17a9f6(0x16d))var _0x5971cb=users['Chinese'];else{if(_0x4f8168[0x0]['language']==_0x17a9f6(0xee))var _0x5971cb=users['Arabic'];}}}}}}}_0x3e6c3e[_0x17a9f6(0xe6)](_0x17a9f6(0x100),{'success':_0x502ae5[_0x17a9f6(0x16a)](_0x17a9f6(0x124)),'errors':_0x502ae5[_0x17a9f6(0x16a)](_0x17a9f6(0x17e)),'role':_0x3eae0f,'profile':_0x131095,'warehouse':_0x3cc4c7,'product':_0x16eba9,'adjustment':_0x265c39,'master_shop':_0x4f8168,'language':_0x5971cb});}catch(_0x40d9aa){console[_0x17a9f6(0x1ab)](_0x40d9aa);}});async function getRandom8DigitNumber(){var _0x186839=a0_0x53386d;const _0x1586ea=0x989680,_0x3e05bb=0x5f5e0ff,_0x2d5db9=Math[_0x186839(0x15f)](Math[_0x186839(0x17a)]()*(_0x3e05bb-_0x1586ea+0x1))+_0x1586ea;var _0x3527b6;const _0x8d1089=await adjustment[_0x186839(0xf7)]({'invoice':_0x186839(0x194)+_0x2d5db9});return _0x8d1089&&_0x8d1089[_0x186839(0x142)]>0x0?_0x3527b6='ADJ-'+_0x2d5db9:_0x3527b6=_0x186839(0x194)+_0x2d5db9,_0x3527b6;}router[a0_0x53386d(0xeb)](a0_0x53386d(0xe9),auth,async(_0x79a405,_0xccfb4e)=>{var _0x357bb8=a0_0x53386d;try{const {username:_0x194ed2,email:_0x5023d6,role:_0x48792d}=_0x79a405[_0x357bb8(0x149)],_0x1d3d1c=_0x79a405[_0x357bb8(0x149)],_0x102d1a=await profile['findOne']({'email':_0x1d3d1c['email']}),_0x5f5dcb=await master_shop['find']();let _0x46a9aa;if(_0x1d3d1c['role']==_0x357bb8(0x195)){const _0x4a0d7b=await staff[_0x357bb8(0xf7)]({'email':_0x1d3d1c[_0x357bb8(0x17b)]});_0x46a9aa=await warehouse[_0x357bb8(0x121)]([{'$match':{'status':_0x357bb8(0xf8),'name':_0x4a0d7b[_0x357bb8(0xe5)],'warehouse_category':_0x357bb8(0x108),'name':{'$ne':_0x357bb8(0x192)}}},{'$group':{'_id':_0x357bb8(0x151),'name':{'$first':'$name'}}}]);}else _0x46a9aa=await warehouse[_0x357bb8(0x121)]([{'$match':{'status':_0x357bb8(0xf8),'warehouse_category':_0x357bb8(0x108),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x357bb8(0x151)}}}]);const _0x9e49c7=await product[_0x357bb8(0x12c)]({}),_0x736a19=await adjustment[_0x357bb8(0x12c)]({}),_0x254779=_0x736a19[_0x357bb8(0x142)]+0x1,_0x483a4a=_0x357bb8(0x194)+_0x254779[_0x357bb8(0x162)]()[_0x357bb8(0xf1)](0x5,'0');var _0x2c7ca3=[_0x357bb8(0x10f),'Enclosed',_0x357bb8(0xf3)];if(_0x5f5dcb[0x0][_0x357bb8(0x180)]=='English\x20(US)')var _0x11a66c=users[_0x357bb8(0x185)];else{if(_0x5f5dcb[0x0][_0x357bb8(0x180)]=='Hindi')var _0x11a66c=users[_0x357bb8(0x11d)];else{if(_0x5f5dcb[0x0][_0x357bb8(0x180)]==_0x357bb8(0x184))var _0x11a66c=users['German'];else{if(_0x5f5dcb[0x0]['language']==_0x357bb8(0x116))var _0x11a66c=users[_0x357bb8(0x116)];else{if(_0x5f5dcb[0x0][_0x357bb8(0x180)]=='French')var _0x11a66c=users['French'];else{if(_0x5f5dcb[0x0]['language']=='Portuguese\x20(BR)')var _0x11a66c=users[_0x357bb8(0xec)];else{if(_0x5f5dcb[0x0][_0x357bb8(0x180)]=='Chinese')var _0x11a66c=users[_0x357bb8(0x16d)];else{if(_0x5f5dcb[0x0][_0x357bb8(0x180)]==_0x357bb8(0xee))var _0x11a66c=users[_0x357bb8(0x1a6)];}}}}}}}const _0x1e66c9=getRandom8DigitNumber();_0x1e66c9[_0x357bb8(0xe2)](_0x10c0c9=>{var _0x5a8e6e=_0x357bb8;_0xccfb4e[_0x5a8e6e(0xe6)]('add_adjustment',{'success':_0x79a405[_0x5a8e6e(0x16a)](_0x5a8e6e(0x124)),'errors':_0x79a405[_0x5a8e6e(0x16a)]('errors'),'role':_0x1d3d1c,'profile':_0x102d1a,'warehouse':_0x46a9aa,'product':_0x9e49c7,'master_shop':_0x5f5dcb,'language':_0x11a66c,'rooms_data':_0x2c7ca3,'invoice_no':_0x10c0c9});})['catch'](_0x1807b5=>{var _0x5042e7=_0x357bb8;_0x79a405[_0x5042e7(0x16a)](_0x5042e7(0x17e),_0x5042e7(0x107)),_0xccfb4e[_0x5042e7(0x127)]('/adjustment/view');});}catch(_0x518975){console[_0x357bb8(0x1ab)](_0x518975);}}),router[a0_0x53386d(0x134)](a0_0x53386d(0xe9),auth,async(_0x161351,_0x39b396)=>{var _0x27e52a=a0_0x53386d;try{const {warehouse_name:_0x4fb0cd,date:_0x3781fc,prod_name:_0x2cb3c4,level:_0x2415d7,isle:_0x116ea7,pallet:_0x2ffa97,stock:_0x1ccf4f,types:_0x26df42,adjust_qty:_0x4999a5,new_adjust_qty:_0x5d43c3,note:_0x5e1feb,Room_name:_0x1cf0fa,invoice:_0x3da49f,JO_number:_0x4b7b15,expiry_date:_0x2196a4}=_0x161351[_0x27e52a(0x198)];if(typeof _0x2cb3c4==_0x27e52a(0x1a7))var _0x48c7d6=[_0x161351['body'][_0x27e52a(0x115)]],_0x4d4c10=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x10b)]],_0x51cc75=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x1aa)]],_0x4c6721=[_0x161351[_0x27e52a(0x198)]['types']],_0x515d96=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0xe0)]],_0x454539=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x1a2)]],_0xaa201c=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x19c)]],_0x4dc47a=[_0x161351[_0x27e52a(0x198)]['Secondary_units']],_0x5a7687=[_0x161351[_0x27e52a(0x198)]['prod_code']],_0x55321a=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x119)]],_0x1feec3=[_0x161351['body']['expiry_date']],_0x10dd3f=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x196)]],_0xa8ac34=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x16e)]],_0x4e758=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x11a)]],_0x52c7ac=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x11e)]],_0x54a7a7=[_0x161351['body'][_0x27e52a(0x18e)]],_0x789075=[_0x161351['body']['second1']],_0x514ac2=[_0x161351[_0x27e52a(0x198)][_0x27e52a(0x1ac)]],_0x2eb1d0=[_0x161351['body'][_0x27e52a(0x187)]];else var _0x48c7d6=[..._0x161351[_0x27e52a(0x198)][_0x27e52a(0x115)]],_0x4d4c10=[..._0x161351[_0x27e52a(0x198)][_0x27e52a(0x10b)]],_0x51cc75=[..._0x161351[_0x27e52a(0x198)][_0x27e52a(0x1aa)]],_0x4c6721=[..._0x161351['body'][_0x27e52a(0xe8)]],_0x515d96=[..._0x161351[_0x27e52a(0x198)][_0x27e52a(0xe0)]],_0x454539=[..._0x161351[_0x27e52a(0x198)][_0x27e52a(0x1a2)]],_0xaa201c=[..._0x161351[_0x27e52a(0x198)][_0x27e52a(0x175)]],_0x4dc47a=[..._0x161351[_0x27e52a(0x198)][_0x27e52a(0x12d)]],_0x5a7687=[..._0x161351['body'][_0x27e52a(0xea)]],_0x55321a=[..._0x161351['body'][_0x27e52a(0x119)]],_0x1feec3=[..._0x161351['body'][_0x27e52a(0x18f)]],_0x10dd3f=[..._0x161351[_0x27e52a(0x198)]['max_per_unit']],_0xa8ac34=[..._0x161351[_0x27e52a(0x198)]['production_date']],_0x4e758=[..._0x161351[_0x27e52a(0x198)]['prod_cat']],_0x52c7ac=[..._0x161351[_0x27e52a(0x198)][_0x27e52a(0x11e)]],_0x54a7a7=[..._0x161351[_0x27e52a(0x198)]['prime1']],_0x789075=[..._0x161351['body']['second1']],_0x514ac2=[..._0x161351[_0x27e52a(0x198)][_0x27e52a(0x1ac)]],_0x2eb1d0=[..._0x161351['body'][_0x27e52a(0x187)]];const _0x348532=_0x48c7d6[_0x27e52a(0x140)](_0x3c1e3f=>{return _0x3c1e3f={'product_name':_0x3c1e3f};});_0x4d4c10[_0x27e52a(0x139)]((_0x2ead2c,_0x491027)=>{_0x52c7ac['forEach']((_0x4463cd,_0x1cba35)=>{var _0x482720=a0_0x3bc7;if(_0x4463cd==_0x482720(0x197)&&_0x491027==_0x1cba35){var _0x4a24d4=_0x2ead2c[_0x482720(0x101)](0x3);_0x348532[_0x491027]['storage']=_0x2ead2c[0x0],_0x348532[_0x491027]['rack']=_0x2ead2c[0x1],_0x348532[_0x491027][_0x482720(0x19e)]=0x0,_0x348532[_0x491027]['bin']=0x0,_0x348532[_0x491027]['type']=_0x482720(0x13c),_0x348532[_0x491027]['floorlevel']=_0x4a24d4;}else{if(_0x4463cd==_0x482720(0x10c)&&_0x491027==_0x1cba35){var _0x4a24d4=_0x2ead2c['slice'](0x3);_0x348532[_0x491027][_0x482720(0x120)]=_0x2ead2c[0x0],_0x348532[_0x491027]['rack']=_0x2ead2c[0x1],_0x348532[_0x491027]['bay']=0x0,_0x348532[_0x491027][_0x482720(0x128)]=0x0,_0x348532[_0x491027]['type']=_0x482720(0x13c),_0x348532[_0x491027][_0x482720(0xdf)]=_0x2ead2c[0x5];}else{if(_0x491027==_0x1cba35){var _0x259cc2;if(_0x2ead2c[0x4]=='L')_0x259cc2=_0x482720(0xe3);else _0x2ead2c[0x4]=='F'&&(_0x259cc2='Floor');_0x348532[_0x491027][_0x482720(0x120)]=_0x2ead2c[0x0],_0x348532[_0x491027][_0x482720(0x19d)]=_0x2ead2c[0x1],_0x348532[_0x491027][_0x482720(0x19e)]=_0x2ead2c[0x2],_0x348532[_0x491027][_0x482720(0x128)]=_0x2ead2c[0x3],_0x348532[_0x491027][_0x482720(0x117)]=_0x259cc2,_0x348532[_0x491027][_0x482720(0xdf)]=_0x2ead2c[0x5];}}}});}),_0x51cc75[_0x27e52a(0x139)]((_0x20f968,_0x46b030)=>{var _0x1c5330=_0x27e52a;_0x348532[_0x46b030][_0x1c5330(0x186)]=_0x20f968;}),_0x2eb1d0[_0x27e52a(0x139)]((_0x4b2321,_0x37c525)=>{_0x348532[_0x37c525]['id_transaction_from']=_0x4b2321;}),_0x4c6721[_0x27e52a(0x139)]((_0x430c2d,_0x5e858a)=>{_0x348532[_0x5e858a]['types']=_0x430c2d;}),_0x515d96[_0x27e52a(0x139)]((_0x4e7c9e,_0x3a53b7)=>{var _0x2b7293=_0x27e52a;_0x348532[_0x3a53b7][_0x2b7293(0x19b)]=_0x4e7c9e;}),_0x454539['forEach']((_0x4688de,_0x4d6b1d)=>{var _0x10b56f=_0x27e52a;_0x348532[_0x4d6b1d][_0x10b56f(0x15a)]=_0x4688de;}),_0xaa201c['forEach']((_0x3e9022,_0x19e591)=>{var _0x48e378=_0x27e52a;_0x348532[_0x19e591][_0x48e378(0x175)]=_0x3e9022;}),_0x4dc47a['forEach']((_0x48ef73,_0x4aaad4)=>{var _0x3cdbb4=_0x27e52a;_0x348532[_0x4aaad4][_0x3cdbb4(0x150)]=_0x48ef73;}),_0x5a7687[_0x27e52a(0x139)]((_0x17eab5,_0x52c6e5)=>{_0x348532[_0x52c6e5]['product_code']=_0x17eab5;}),_0x55321a[_0x27e52a(0x139)]((_0x4100e4,_0x5c08b0)=>{var _0x5e6cf9=_0x27e52a;_0x348532[_0x5c08b0][_0x5e6cf9(0x119)]=_0x4100e4;}),_0x1feec3['forEach']((_0x1ef4a3,_0x466214)=>{_0x348532[_0x466214]['expiry_date']=_0x1ef4a3;}),_0x10dd3f[_0x27e52a(0x139)]((_0x34fd9d,_0x1e3003)=>{var _0xc0ee2e=_0x27e52a;_0x348532[_0x1e3003][_0xc0ee2e(0x144)]=_0x34fd9d;}),_0xa8ac34[_0x27e52a(0x139)]((_0x4164d0,_0x114ca9)=>{var _0x2eeb31=_0x27e52a;_0x348532[_0x114ca9][_0x2eeb31(0x16e)]=_0x4164d0;}),_0x4e758[_0x27e52a(0x139)]((_0x3142ae,_0x5debc1)=>{var _0x3f8acc=_0x27e52a;_0x348532[_0x5debc1][_0x3f8acc(0x11a)]=_0x3142ae;}),_0x52c7ac[_0x27e52a(0x139)]((_0x17e9be,_0x1758b9)=>{_0x348532[_0x1758b9]['room_names']=_0x17e9be;}),_0x54a7a7['forEach']((_0x49a4f2,_0x36ac36)=>{var _0x5a369b=_0x27e52a;_0x348532[_0x36ac36][_0x5a369b(0x10a)]=_0x49a4f2;}),_0x789075['forEach']((_0x4fde04,_0x27f714)=>{var _0x3bc304=_0x27e52a;_0x348532[_0x27f714][_0x3bc304(0x13f)]=_0x4fde04;}),_0x514ac2['forEach']((_0x32fcdc,_0x12ed83)=>{_0x348532[_0x12ed83]['invoice']=_0x32fcdc;});const _0x2670ff=_0x348532[_0x27e52a(0x145)](_0x55b05c=>_0x55b05c[_0x27e52a(0x19b)]!=='0'&&_0x55b05c[_0x27e52a(0x19b)]!=='');var _0x436060=0x0;_0x2670ff[_0x27e52a(0x139)](_0x2c42ac=>{var _0x2a62dc=_0x27e52a;console['log']('foreach\x20newproduct',_0x2c42ac),parseInt(_0x2c42ac[_0x2a62dc(0x19b)])<=0x0&&_0x436060++;});if(_0x436060!=0x0)return _0x161351[_0x27e52a(0x16a)]('errors',_0x27e52a(0x102)),_0x39b396['redirect'](_0x27e52a(0x13d));const _0x3ec1a5=new adjustment({'warehouse_name':_0x4fb0cd,'date':_0x3781fc,'product':_0x2670ff,'note':_0x5e1feb,'room':_0x1cf0fa,'invoice':_0x3da49f,'JO_number':_0x4b7b15,'expiry_date':_0x2196a4}),_0x2685ea=await _0x3ec1a5[_0x27e52a(0x106)]();_0x161351[_0x27e52a(0x16a)](_0x27e52a(0x124),_0x27e52a(0x164)),_0x39b396[_0x27e52a(0x127)](_0x27e52a(0x18a)+_0x2685ea[_0x27e52a(0x188)]);}catch(_0x7c796e){console[_0x27e52a(0x1ab)](_0x7c796e),_0x39b396['status'](0xc8)[_0x27e52a(0x157)]({'message':_0x7c796e[_0x27e52a(0x19a)]});}}),router[a0_0x53386d(0xeb)]('/preview/:id',auth,async(_0x108a07,_0x3ec3ca)=>{var _0x1cd0bc=a0_0x53386d;try{const {username:_0x5647d0,email:_0x4302cc,role:_0xd3906a}=_0x108a07[_0x1cd0bc(0x149)],_0x1b10d7=_0x108a07['user'],_0x35e7e8=await profile[_0x1cd0bc(0xf7)]({'email':_0x1b10d7['email']}),_0x5e6e60=await master_shop[_0x1cd0bc(0x12c)](),_0x3312be=_0x108a07[_0x1cd0bc(0x110)]['id'],_0x2986c9=await adjustment[_0x1cd0bc(0x158)]({'_id':_0x3312be}),_0x228faf=await purchases[_0x1cd0bc(0x121)]([{'$match':{'warehouse_name':_0x2986c9[_0x1cd0bc(0x146)]}},{'$unwind':_0x1cd0bc(0x193)},{'$group':{'_id':'$product.product_name'}}]),_0x5d463a=await product[_0x1cd0bc(0x12c)]({}),_0x58cbc8=await warehouse[_0x1cd0bc(0x121)]([{'$match':{'name':_0x2986c9[_0x1cd0bc(0x146)]}},{'$unwind':_0x1cd0bc(0x179)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1cd0bc(0x137)},'product_stock':{'$first':_0x1cd0bc(0x136)},'bay':{'$first':_0x1cd0bc(0xdd)},'bin':{'$first':_0x1cd0bc(0xde)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1cd0bc(0x122)},'primary_code':{'$first':_0x1cd0bc(0x13a)},'secondary_code':{'$first':_0x1cd0bc(0x125)},'product_code':{'$first':_0x1cd0bc(0x159)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1cd0bc(0x189)},'maxPerUnit':{'$first':_0x1cd0bc(0x1a4)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1cd0bc(0x123)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);if(_0x5e6e60[0x0][_0x1cd0bc(0x180)]==_0x1cd0bc(0x178)){var _0x471e69=users[_0x1cd0bc(0x185)];console[_0x1cd0bc(0x1ab)](_0x471e69);}else{if(_0x5e6e60[0x0][_0x1cd0bc(0x180)]==_0x1cd0bc(0x11d))var _0x471e69=users[_0x1cd0bc(0x11d)];else{if(_0x5e6e60[0x0]['language']=='German')var _0x471e69=users[_0x1cd0bc(0x184)];else{if(_0x5e6e60[0x0][_0x1cd0bc(0x180)]==_0x1cd0bc(0x116))var _0x471e69=users[_0x1cd0bc(0x116)];else{if(_0x5e6e60[0x0][_0x1cd0bc(0x180)]==_0x1cd0bc(0x18d))var _0x471e69=users[_0x1cd0bc(0x18d)];else{if(_0x5e6e60[0x0][_0x1cd0bc(0x180)]==_0x1cd0bc(0x17c))var _0x471e69=users['Portuguese'];else{if(_0x5e6e60[0x0][_0x1cd0bc(0x180)]=='Chinese')var _0x471e69=users[_0x1cd0bc(0x16d)];else{if(_0x5e6e60[0x0][_0x1cd0bc(0x180)]=='Arabic\x20(ae)')var _0x471e69=users[_0x1cd0bc(0x1a6)];}}}}}}}_0x3ec3ca[_0x1cd0bc(0xe6)](_0x1cd0bc(0x155),{'success':_0x108a07['flash'](_0x1cd0bc(0x124)),'errors':_0x108a07[_0x1cd0bc(0x16a)](_0x1cd0bc(0x17e)),'role':_0x1b10d7,'profile':_0x35e7e8,'adjustment':_0x2986c9,'stock':_0x58cbc8,'master_shop':_0x5e6e60,'warehouse_name':_0x228faf,'unit':_0x5d463a,'language':_0x471e69});}catch(_0x2e479a){console[_0x1cd0bc(0x1ab)](_0x2e479a),_0x3ec3ca[_0x1cd0bc(0x1af)](0xc8)['json']({'message':_0x2e479a[_0x1cd0bc(0x19a)]});}}),router[a0_0x53386d(0x134)]('/preview/:id',auth,async(_0x53fcb0,_0x47b40c)=>{var _0x2bf626=a0_0x53386d;try{const _0x9bf84d=_0x53fcb0[_0x2bf626(0x110)]['id'],{warehouse_name:_0x1184e5,Room_name:_0x2e2666}=_0x53fcb0['body'],_0x581bb4=await adjustment['findById']({'_id':_0x9bf84d}),_0x186c72=_0x581bb4[_0x2bf626(0x129)][_0x2bf626(0x140)](async _0xdfd303=>{var _0x1d2082=_0x2bf626;if(_0xdfd303[_0x1d2082(0x19b)]>0x0){var _0x5a870d=await warehouse[_0x1d2082(0xf7)]({'name':_0x1184e5,'room':_0xdfd303[_0x1d2082(0x177)],'warehouse_category':'Raw\x20Materials'});const _0x48f8dd=_0x5a870d[_0x1d2082(0x1b0)][_0x1d2082(0x140)](_0x12ce89=>{var _0xc71e9c=_0x1d2082;console['log'](_0xdfd303[_0xc71e9c(0xe8)]+_0xc71e9c(0x19f));if(_0xdfd303[_0xc71e9c(0xe8)]=='minus'){if(_0x12ce89[_0xc71e9c(0x14f)]==_0xdfd303[_0xc71e9c(0x14f)]&&_0x12ce89[_0xc71e9c(0xdf)]==_0xdfd303[_0xc71e9c(0xdf)]&&_0x12ce89[_0xc71e9c(0x117)]==_0xdfd303[_0xc71e9c(0x117)]&&_0x12ce89[_0xc71e9c(0x128)]==_0xdfd303[_0xc71e9c(0x128)]&&_0x12ce89[_0xc71e9c(0x19e)]==_0xdfd303['bay']&&_0x12ce89[_0xc71e9c(0x19d)]==_0xdfd303[_0xc71e9c(0x19d)]&&_0x12ce89[_0xc71e9c(0x120)]==_0xdfd303[_0xc71e9c(0x120)]&&_0x12ce89[_0xc71e9c(0x18f)]==_0xdfd303[_0xc71e9c(0x18f)]&&_0x12ce89['batch_code']==_0xdfd303[_0xc71e9c(0x119)]&&_0x12ce89[_0xc71e9c(0x16e)]==_0xdfd303['production_date']&&_0x12ce89[_0xc71e9c(0xe4)]==_0xdfd303[_0xc71e9c(0xe4)]&&_0x12ce89[_0xc71e9c(0x188)]==_0xdfd303[_0xc71e9c(0xe1)]){var _0x579481;_0x579481=_0xdfd303[_0xc71e9c(0x19b)],_0xdfd303[_0xc71e9c(0x11a)]=='S'&&(_0x579481=_0xdfd303[_0xc71e9c(0x19b)]),_0x12ce89[_0xc71e9c(0x143)]=_0x12ce89[_0xc71e9c(0x143)]-_0x579481;}}else{if(_0x12ce89[_0xc71e9c(0x14f)]==_0xdfd303[_0xc71e9c(0x14f)]&&_0x12ce89[_0xc71e9c(0xdf)]==_0xdfd303[_0xc71e9c(0xdf)]&&_0x12ce89[_0xc71e9c(0x117)]==_0xdfd303['type']&&_0x12ce89[_0xc71e9c(0x128)]==_0xdfd303[_0xc71e9c(0x128)]&&_0x12ce89[_0xc71e9c(0x19e)]==_0xdfd303['bay']&&_0x12ce89['rack']==_0xdfd303[_0xc71e9c(0x19d)]&&_0x12ce89[_0xc71e9c(0x120)]==_0xdfd303[_0xc71e9c(0x120)]&&_0x12ce89['expiry_date']==_0xdfd303['expiry_date']&&_0x12ce89[_0xc71e9c(0x119)]==_0xdfd303[_0xc71e9c(0x119)]&&_0x12ce89['production_date']==_0xdfd303[_0xc71e9c(0x16e)]&&_0x12ce89[_0xc71e9c(0xe4)]==_0xdfd303['invoice']&&_0x12ce89['_id']==_0xdfd303[_0xc71e9c(0xe1)]){console[_0xc71e9c(0x1ab)](_0xdfd303);var _0x579481;_0x579481=_0xdfd303['adjust_qty'],_0xdfd303[_0xc71e9c(0x11a)]=='S'&&(_0x579481=_0xdfd303[_0xc71e9c(0x19b)]),_0x12ce89[_0xc71e9c(0x143)]=_0x12ce89[_0xc71e9c(0x143)]+_0x579481;}}});}return _0x5a870d;});Promise['all'](_0x186c72)[_0x2bf626(0xe2)](async _0x5dd579=>{var _0x5b4859=_0x2bf626;try{for(const _0x4d20f0 of _0x5dd579){await _0x4d20f0['save']();}_0x581bb4['finalize']=_0x5b4859(0x118);const _0x31267a=await _0x581bb4[_0x5b4859(0x106)](),_0x1d70d2=await master_shop[_0x5b4859(0x12c)](),_0x1db963=await email_settings['findOne'](),_0x3c0f4b=await supervisor_settings['find']();var _0x1dd752=_0x581bb4[_0x5b4859(0x129)],_0x3d9001='',_0x99ec04;for(_0x99ec04 in _0x1dd752){_0x3d9001+='<tr>'+_0x5b4859(0xf6)+_0x1dd752[_0x99ec04]['product_name']+_0x5b4859(0x11b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1dd752[_0x99ec04]['product_code']+'</td>'+_0x5b4859(0xf6)+_0x1dd752[_0x99ec04][_0x5b4859(0x19b)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1dd752[_0x99ec04][_0x5b4859(0x175)]+'</td>'+_0x5b4859(0xf6)+_0x1dd752[_0x99ec04]['secondary_unit']+_0x5b4859(0x11b)+_0x5b4859(0xf6)+_0x581bb4['warehouse_name']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1dd752[_0x99ec04][_0x5b4859(0x177)]+'</td>'+_0x5b4859(0xf6)+_0x1dd752[_0x99ec04][_0x5b4859(0x120)]+_0x1dd752[_0x99ec04][_0x5b4859(0x19d)]+_0x1dd752[_0x99ec04][_0x5b4859(0x19e)]+_0x1dd752[_0x99ec04]['bin']+_0x1dd752[_0x99ec04]['type'][0x0]+_0x1dd752[_0x99ec04][_0x5b4859(0xdf)]+_0x5b4859(0x11b),_0x5b4859(0x166);}let _0x801034=nodemailer[_0x5b4859(0x112)]({'host':_0x1db963[_0x5b4859(0x191)],'port':Number(_0x1db963['port']),'secure':![],'auth':{'user':_0x1db963[_0x5b4859(0x17b)],'pass':_0x1db963['password']}}),_0x1e1d1c={'from':_0x1db963[_0x5b4859(0x17b)],'to':_0x3c0f4b[0x0][_0x5b4859(0x14a)],'subject':_0x5b4859(0x17d),'attachments':[{'filename':_0x5b4859(0x132),'path':__dirname+_0x5b4859(0x11f)+_0x5b4859(0xfa)+_0x1d70d2[0x0][_0x5b4859(0xef)],'cid':_0x5b4859(0x153)}],'html':_0x5b4859(0x1ae)+_0x5b4859(0x161)+_0x5b4859(0xf5)+_0x5b4859(0xdb)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x5b4859(0xdb)+_0x5b4859(0x16b)+_0x5b4859(0x10e)+_0x5b4859(0xdb)+_0x5b4859(0x18c)+_0x1d70d2[0x0][_0x5b4859(0x148)]+_0x5b4859(0xfc)+_0x5b4859(0x10e)+_0x5b4859(0x10e)+_0x5b4859(0x1a5)+_0x5b4859(0xdb)+_0x5b4859(0x11c)+_0x5b4859(0x181)+_0x581bb4['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x5b4859(0x10d)+_0x581bb4['date']+'\x20'+'</span>'+_0x5b4859(0x152)+_0x5b4859(0x10e)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5b4859(0x12a)+_0x5b4859(0x167)+_0x5b4859(0x133)+_0x5b4859(0x13e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x5b4859(0x141)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x5b4859(0x169)+_0x5b4859(0x15d)+_0x5b4859(0x183)+_0x5b4859(0x166)+_0x5b4859(0xdc)+_0x5b4859(0x147)+'\x20'+_0x3d9001+'\x20'+_0x5b4859(0x1a9)+_0x5b4859(0x12e)+_0x5b4859(0xdb)+'<strong>\x20Regards\x20</strong>'+_0x5b4859(0x165)+_0x1d70d2[0x0]['site_title']+_0x5b4859(0x152)+_0x5b4859(0x10e)+_0x5b4859(0x10e)+'</body></html>'};_0x801034[_0x5b4859(0x14e)](_0x1e1d1c,function(_0x369853,_0x4c045f){var _0x445c55=_0x5b4859;_0x369853?(console[_0x445c55(0x1ab)](_0x369853),console[_0x445c55(0x1ab)](_0x445c55(0x168))):console[_0x445c55(0x1ab)](_0x445c55(0x126));}),_0x53fcb0[_0x5b4859(0x16a)](_0x5b4859(0x124),_0x5b4859(0xfd)),_0x47b40c[_0x5b4859(0x127)](_0x5b4859(0x111)+_0x31267a['_id']);}catch(_0xeafd60){console['error'](_0xeafd60),_0x47b40c[_0x5b4859(0x1af)](0x1f4)[_0x5b4859(0x157)]({'error':_0x5b4859(0xed)});}})[_0x2bf626(0x12f)](_0x178949=>{var _0x498c8a=_0x2bf626;console[_0x498c8a(0x103)](_0x178949),_0x47b40c[_0x498c8a(0x1af)](0x1f4)[_0x498c8a(0x157)]({'error':'An\x20error\x20occurred.'});});}catch(_0x1b817f){console[_0x2bf626(0x1ab)](_0x1b817f),_0x47b40c['status'](0xc8)[_0x2bf626(0x157)]({'message':_0x1b817f['message']});}}),router[a0_0x53386d(0xeb)](a0_0x53386d(0x12b),auth,async(_0x596152,_0x29b541)=>{var _0x24584f=a0_0x53386d;try{const {username:_0x1b4492,email:_0x1d5d91,role:_0x395f2b}=_0x596152[_0x24584f(0x149)],_0x5791ae=_0x596152[_0x24584f(0x149)],_0x4b478a=await profile['findOne']({'email':_0x5791ae['email']}),_0x2e6d21=await master_shop[_0x24584f(0x12c)](),_0x18d8f0=_0x596152[_0x24584f(0x110)]['id'],_0x1f20eb=await adjustment[_0x24584f(0x158)]({'_id':_0x18d8f0}),_0x29191b=await purchases[_0x24584f(0x121)]([{'$match':{'warehouse_name':_0x1f20eb[_0x24584f(0x146)]}},{'$unwind':'$product'},{'$group':{'_id':_0x24584f(0x1a8)}}]),_0x247179=await product[_0x24584f(0x12c)]({}),_0x12ab19=await warehouse[_0x24584f(0x121)]([{'$match':{'name':_0x1f20eb[_0x24584f(0x146)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x24584f(0x1ad),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x24584f(0x136)},'bay':{'$first':_0x24584f(0xdd)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x24584f(0x160)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x24584f(0x13a)},'secondary_code':{'$first':_0x24584f(0x125)},'product_code':{'$first':_0x24584f(0x159)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x24584f(0x1a4)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x24584f(0x123)},'batch_code':{'$first':_0x24584f(0x114)},'room':{'$first':_0x24584f(0x104)}}}]);let _0x247286;if(_0x5791ae[_0x24584f(0x15b)]=='staff'){const _0x38054e=await staff['findOne']({'email':_0x5791ae['email']});_0x247286=await warehouse['aggregate']([{'$match':{'status':_0x24584f(0xf8),'name':_0x38054e[_0x24584f(0xe5)],'warehouse_category':_0x24584f(0x108),'name':{'$ne':_0x24584f(0x192)}}},{'$group':{'_id':_0x24584f(0x151),'name':{'$first':_0x24584f(0x151)}}}]);}else _0x247286=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x24584f(0x108),'name':{'$ne':_0x24584f(0x192)}}},{'$group':{'_id':_0x24584f(0x151),'name':{'$first':_0x24584f(0x151)}}}]);if(_0x2e6d21[0x0][_0x24584f(0x180)]=='English\x20(US)'){var _0x340ba7=users[_0x24584f(0x185)];console[_0x24584f(0x1ab)](_0x340ba7);}else{if(_0x2e6d21[0x0][_0x24584f(0x180)]==_0x24584f(0x11d))var _0x340ba7=users[_0x24584f(0x11d)];else{if(_0x2e6d21[0x0]['language']=='German')var _0x340ba7=users['German'];else{if(_0x2e6d21[0x0][_0x24584f(0x180)]==_0x24584f(0x116))var _0x340ba7=users['Spanish'];else{if(_0x2e6d21[0x0][_0x24584f(0x180)]==_0x24584f(0x18d))var _0x340ba7=users[_0x24584f(0x18d)];else{if(_0x2e6d21[0x0]['language']=='Portuguese\x20(BR)')var _0x340ba7=users[_0x24584f(0xec)];else{if(_0x2e6d21[0x0][_0x24584f(0x180)]=='Chinese')var _0x340ba7=users['Chinese'];else{if(_0x2e6d21[0x0][_0x24584f(0x180)]==_0x24584f(0xee))var _0x340ba7=users[_0x24584f(0x1a6)];}}}}}}}_0x29b541[_0x24584f(0xe6)](_0x24584f(0xfb),{'success':_0x596152[_0x24584f(0x16a)](_0x24584f(0x124)),'errors':_0x596152[_0x24584f(0x16a)](_0x24584f(0x17e)),'role':_0x5791ae,'profile':_0x4b478a,'adjustment':_0x1f20eb,'stock':_0x12ab19,'master_shop':_0x2e6d21,'warehouse_name':_0x29191b,'unit':_0x247179,'language':_0x340ba7,'warehouse':_0x247286});}catch(_0x33a255){console['log'](_0x33a255),_0x29b541[_0x24584f(0x1af)](0xc8)[_0x24584f(0x157)]({'message':_0x33a255[_0x24584f(0x19a)]});}}),router[a0_0x53386d(0x134)]('/view/:id',auth,async(_0x351da4,_0x1aba7d)=>{var _0x535487=a0_0x53386d;try{const _0x15fb20=_0x351da4[_0x535487(0x110)]['id'],_0x45ac93=await adjustment[_0x535487(0x158)]({'_id':_0x15fb20}),_0x2fd876=await warehouse['findOne']({'name':_0x45ac93[_0x535487(0x146)],'room':_0x45ac93[_0x535487(0x174)]}),{warehouse_name:_0x35cff7,date:_0xf6369f,prod_name:_0x3ab9d5,level:_0x2caabd,isle:_0x429288,pallet:_0x4f8797,stock:_0x130da2,types:_0x2be0b8,adjust_qty:_0x494296,new_adjust_qty:_0x5906d3,note:_0x2b3d00,Room_name:_0xc00a48,invoice:_0x4eef3b,JO_number:_0x177000,expiry_date:_0x22f490}=_0x351da4['body'];if(typeof _0x3ab9d5==_0x535487(0x1a7))var _0x3cc0a1=[_0x351da4[_0x535487(0x198)][_0x535487(0x115)]],_0x3ef88c=[_0x351da4[_0x535487(0x198)][_0x535487(0x10b)]],_0x1bbb7a=[_0x351da4[_0x535487(0x198)]['stock']],_0x2ac070=[_0x351da4[_0x535487(0x198)][_0x535487(0xe8)]],_0x300ca4=[_0x351da4[_0x535487(0x198)][_0x535487(0xe0)]],_0x5b536=[_0x351da4[_0x535487(0x198)][_0x535487(0x1a2)]],_0x5d7e0a=[_0x351da4[_0x535487(0x198)][_0x535487(0x19c)]],_0x362bc7=[_0x351da4[_0x535487(0x198)]['Secondary_units']],_0x58a34b=[_0x351da4['body']['prod_code']],_0x2291aa=[_0x351da4['body']['batch_code']],_0x3f4706=[_0x351da4[_0x535487(0x198)][_0x535487(0x18f)]],_0x1bd1c4=[_0x351da4[_0x535487(0x198)][_0x535487(0x196)]],_0x1f244f=[_0x351da4[_0x535487(0x198)][_0x535487(0x16e)]],_0x1dc2fe=[_0x351da4[_0x535487(0x198)][_0x535487(0x11a)]],_0x50aa7e=[_0x351da4['body'][_0x535487(0x11e)]],_0x3d9618=[_0x351da4['body'][_0x535487(0x18e)]],_0x360566=[_0x351da4[_0x535487(0x198)]['second1']];else var _0x3cc0a1=[..._0x351da4['body'][_0x535487(0x115)]],_0x3ef88c=[..._0x351da4[_0x535487(0x198)][_0x535487(0x10b)]],_0x1bbb7a=[..._0x351da4[_0x535487(0x198)]['stock']],_0x2ac070=[..._0x351da4[_0x535487(0x198)][_0x535487(0xe8)]],_0x300ca4=[..._0x351da4['body'][_0x535487(0xe0)]],_0x5b536=[..._0x351da4[_0x535487(0x198)][_0x535487(0x1a2)]],_0x5d7e0a=[..._0x351da4['body'][_0x535487(0x175)]],_0x362bc7=[..._0x351da4[_0x535487(0x198)][_0x535487(0x12d)]],_0x58a34b=[..._0x351da4['body'][_0x535487(0xea)]],_0x2291aa=[..._0x351da4[_0x535487(0x198)]['batch_code']],_0x3f4706=[..._0x351da4[_0x535487(0x198)]['expiry_date']],_0x1bd1c4=[..._0x351da4[_0x535487(0x198)][_0x535487(0x196)]],_0x1f244f=[..._0x351da4[_0x535487(0x198)][_0x535487(0x16e)]],_0x1dc2fe=[..._0x351da4[_0x535487(0x198)][_0x535487(0x11a)]],_0x50aa7e=[..._0x351da4[_0x535487(0x198)][_0x535487(0x11e)]],_0x3d9618=[..._0x351da4[_0x535487(0x198)][_0x535487(0x18e)]],_0x360566=[..._0x351da4[_0x535487(0x198)][_0x535487(0xf9)]];const _0x149b9b=_0x3cc0a1[_0x535487(0x140)](_0x3ef1e0=>{return _0x3ef1e0={'product_name':_0x3ef1e0};});_0x3ef88c[_0x535487(0x139)]((_0x217974,_0x42722e)=>{var _0x296640=_0x535487;_0x50aa7e[_0x296640(0x139)]((_0x5550b1,_0x4b9645)=>{var _0x3633a4=_0x296640;if(_0x5550b1=='Receiving\x20Area'&&_0x42722e==_0x4b9645){var _0x4428c4=_0x217974['slice'](0x3);_0x149b9b[_0x42722e][_0x3633a4(0x120)]=_0x217974[0x0],_0x149b9b[_0x42722e][_0x3633a4(0x19d)]=_0x217974[0x1],_0x149b9b[_0x42722e][_0x3633a4(0x19e)]=0x0,_0x149b9b[_0x42722e][_0x3633a4(0x128)]=0x0,_0x149b9b[_0x42722e][_0x3633a4(0x117)]=_0x3633a4(0x13c),_0x149b9b[_0x42722e][_0x3633a4(0xdf)]=_0x4428c4;}else{if(_0x5550b1==_0x3633a4(0x10c)&&_0x42722e==_0x4b9645){var _0x4428c4=_0x217974[_0x3633a4(0x101)](0x3);_0x149b9b[_0x42722e][_0x3633a4(0x120)]=_0x217974[0x0],_0x149b9b[_0x42722e]['rack']=_0x217974[0x1],_0x149b9b[_0x42722e]['bay']=0x0,_0x149b9b[_0x42722e]['bin']=0x0,_0x149b9b[_0x42722e]['type']=_0x3633a4(0x13c),_0x149b9b[_0x42722e]['floorlevel']=_0x217974[0x5];}else{if(_0x42722e==_0x4b9645){var _0x4167be;if(_0x217974[0x4]=='L')_0x4167be='Level';else _0x217974[0x4]=='F'&&(_0x4167be=_0x3633a4(0x13c));_0x149b9b[_0x42722e][_0x3633a4(0x120)]=_0x217974[0x0],_0x149b9b[_0x42722e]['rack']=_0x217974[0x1],_0x149b9b[_0x42722e][_0x3633a4(0x19e)]=_0x217974[0x2],_0x149b9b[_0x42722e][_0x3633a4(0x128)]=_0x217974[0x3],_0x149b9b[_0x42722e]['type']=_0x4167be,_0x149b9b[_0x42722e]['floorlevel']=_0x217974[0x5];}}}});}),_0x1bbb7a[_0x535487(0x139)]((_0x2a9c38,_0x19a2fd)=>{var _0x21b97a=_0x535487;_0x149b9b[_0x19a2fd][_0x21b97a(0x186)]=_0x2a9c38;}),_0x2ac070[_0x535487(0x139)]((_0x19f710,_0x42db78)=>{var _0x37326a=_0x535487;_0x149b9b[_0x42db78][_0x37326a(0xe8)]=_0x19f710;}),_0x300ca4[_0x535487(0x139)]((_0x562e03,_0x96e12f)=>{var _0x31b11e=_0x535487;_0x149b9b[_0x96e12f][_0x31b11e(0x19b)]=_0x562e03;}),_0x5b536['forEach']((_0x3d6d42,_0x43654e)=>{var _0x2e1afb=_0x535487;_0x149b9b[_0x43654e][_0x2e1afb(0x15a)]=_0x3d6d42;}),_0x5d7e0a['forEach']((_0x3b2834,_0x186af3)=>{var _0x3db0c8=_0x535487;_0x149b9b[_0x186af3][_0x3db0c8(0x175)]=_0x3b2834;}),_0x362bc7[_0x535487(0x139)]((_0x37f5ae,_0x4f74d4)=>{var _0x1c3622=_0x535487;_0x149b9b[_0x4f74d4][_0x1c3622(0x150)]=_0x37f5ae;}),_0x58a34b[_0x535487(0x139)]((_0x317901,_0x2db0da)=>{_0x149b9b[_0x2db0da]['product_code']=_0x317901;}),_0x2291aa[_0x535487(0x139)]((_0x17268d,_0x351421)=>{var _0x3ed5bc=_0x535487;_0x149b9b[_0x351421][_0x3ed5bc(0x119)]=_0x17268d;}),_0x3f4706[_0x535487(0x139)]((_0x36d78d,_0x403219)=>{var _0x211eff=_0x535487;_0x149b9b[_0x403219][_0x211eff(0x18f)]=_0x36d78d;}),_0x1bd1c4[_0x535487(0x139)]((_0x50f791,_0xf40eb3)=>{var _0x3159a4=_0x535487;_0x149b9b[_0xf40eb3][_0x3159a4(0x144)]=_0x50f791;}),_0x1f244f[_0x535487(0x139)]((_0x112d6c,_0x152d5c)=>{var _0x18d44a=_0x535487;_0x149b9b[_0x152d5c][_0x18d44a(0x16e)]=_0x112d6c;}),_0x1dc2fe[_0x535487(0x139)]((_0x389726,_0x2dcf68)=>{_0x149b9b[_0x2dcf68]['prod_cat']=_0x389726;}),_0x50aa7e[_0x535487(0x139)]((_0x34585a,_0x59b24b)=>{_0x149b9b[_0x59b24b]['room_names']=_0x34585a;}),_0x3d9618['forEach']((_0x205331,_0x32bfcd)=>{var _0x26c37c=_0x535487;_0x149b9b[_0x32bfcd][_0x26c37c(0x10a)]=_0x205331;}),_0x360566[_0x535487(0x139)]((_0x3f6b08,_0x43e2c7)=>{var _0x51b544=_0x535487;_0x149b9b[_0x43e2c7][_0x51b544(0x13f)]=_0x3f6b08;});const _0x500ad4=_0x149b9b[_0x535487(0x145)](_0x1c569f=>_0x1c569f[_0x535487(0x19b)]!=='0'&&_0x1c569f['adjust_qty']!=='');var _0x4aac1d=0x0;_0x500ad4['forEach'](_0x1f8997=>{var _0x48fa33=_0x535487;console[_0x48fa33(0x1ab)]('foreach\x20newproduct',_0x1f8997),parseInt(_0x1f8997[_0x48fa33(0x19b)])<=0x0&&_0x4aac1d++;});if(_0x4aac1d!=0x0)return _0x351da4[_0x535487(0x16a)]('errors',_0x535487(0x102)),_0x1aba7d['redirect'](_0x535487(0x13d));_0x45ac93[_0x535487(0x146)]=_0x35cff7,_0x45ac93[_0x535487(0x163)]=_0xf6369f,_0x45ac93[_0x535487(0x129)]=_0x500ad4,_0x45ac93[_0x535487(0x154)]=_0x2b3d00,_0x45ac93[_0x535487(0xe4)]=_0x4eef3b,_0x45ac93[_0x535487(0x18b)]=_0x535487(0x17f);const _0x547a7a=await _0x45ac93['save']();_0x351da4[_0x535487(0x16a)](_0x535487(0x124),'adjustment\x20data\x20update\x20successfully'),_0x1aba7d[_0x535487(0x127)](_0x535487(0x14c));}catch(_0x2a7b60){console[_0x535487(0x1ab)](_0x2a7b60);}}),router['post']('/barcode_scanner',async(_0x119a98,_0x11110c)=>{var _0x21a276=a0_0x53386d;const {primary_code:_0x534d11,warehouse_data:_0x42ee6e,rooms_data:_0x349b72,Roomslist:_0xe30c39}=_0x119a98['body'],_0x5c2528=_0xe30c39[_0x21a276(0xda)](','),_0x245042=[];async function _0x455b0a(_0x1f2d5f){var _0x101728=_0x21a276;const _0x506552=await warehouse[_0x101728(0x121)]([{'$match':{'name':_0x42ee6e,'room':_0x1f2d5f}},{'$unwind':_0x101728(0x179)},{'$match':{'product_details.primary_code':_0x534d11}},{'$group':{'_id':_0x101728(0x1ad),'name':{'$first':_0x101728(0x137)},'product_stock':{'$first':_0x101728(0x136)},'primary_code':{'$first':_0x101728(0x13a)},'secondary_code':{'$first':_0x101728(0x125)},'product_code':{'$first':_0x101728(0x159)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x101728(0xde)},'type':{'$first':_0x101728(0x160)},'pallet':{'$first':_0x101728(0x122)},'unit':{'$first':_0x101728(0xfe)},'secondary_unit':{'$first':_0x101728(0xf2)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x101728(0x189)},'expiry_date':{'$first':_0x101728(0x1a3)},'production_date':{'$first':_0x101728(0x123)},'maxPerUnit':{'$first':_0x101728(0x1a4)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x101728(0x104)},'invoice':{'$first':_0x101728(0x131)}}}]),_0x39123a=await warehouse[_0x101728(0x121)]([{'$match':{'name':_0x42ee6e,'room':_0x1f2d5f}},{'$unwind':_0x101728(0x179)},{'$match':{'product_details.secondary_code':_0x534d11}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x101728(0x137)},'product_stock':{'$first':_0x101728(0x136)},'primary_code':{'$first':_0x101728(0x13a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x101728(0x159)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x101728(0xde)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x101728(0x122)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x101728(0xf2)},'storage':{'$first':_0x101728(0x109)},'rack':{'$first':_0x101728(0x189)},'expiry_date':{'$first':_0x101728(0x1a3)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x101728(0x14b)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x101728(0x104)}}}]);if(_0x506552['length']>0x0)_0x245042[_0x101728(0xf4)](_0x506552);else _0x39123a[_0x101728(0x142)]>0x0&&_0x245042['push'](_0x39123a);}const _0x389f91=_0x5c2528[_0x21a276(0x140)](_0xa45050=>_0x455b0a(_0xa45050));await Promise[_0x21a276(0x1a0)](_0x389f91),_0x11110c['json'](_0x245042);}),router['post']('/CheckingWarehouse',async(_0x342bbf,_0x1ea51e)=>{var _0x23db33=a0_0x53386d;const {primaryCode:_0x42e6f8,secondaryCode:_0x53cd8b,productCode:_0x2ae0c9,level:_0x21aa95,isle:_0x2d81de,pallet:_0x36c663,warehouses:_0x2bd8c2,room:_0x31610d}=_0x342bbf['body'];try{const _0x3863d7=await warehouse[_0x23db33(0x121)]([{'$match':{'name':_0x2bd8c2,'room':_0x31610d}},{'$unwind':_0x23db33(0x179)},{'$match':{'product_details.level':parseInt(_0x21aa95),'product_details.isle':_0x2d81de,'product_details.pallet':parseInt(_0x36c663)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x23db33(0x137)},'product_stock':{'$first':_0x23db33(0x136)},'level':{'$first':_0x23db33(0x170)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x23db33(0x13b)},'maxProducts':{'$first':_0x23db33(0x105)}}}]);_0x1ea51e[_0x23db33(0x1af)](0xc8)[_0x23db33(0x157)](_0x3863d7);}catch(_0x51bee6){_0x1ea51e[_0x23db33(0x1af)](0x194)[_0x23db33(0x157)]({'message':_0x51bee6['message']});}}),module[a0_0x53386d(0x1a1)]=router;