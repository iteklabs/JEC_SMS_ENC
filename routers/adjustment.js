var a0_0x15b9ed=a0_0x272e;function a0_0x53d0(){var _0x3a4a2b=['11300YFJonF','$finalize','$product_details.bin','batch_code','status','<!DOCTYPE\x20html>','An\x20error\x20occurred.','2472294mIJcQL','secondary_unit','production_date','12zJDLfM','</div>','<span\x20style=\x22float:\x20right;\x22>','/CheckingWarehouse','_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','\x20Order\x20Number\x20:\x20','<h5\x20style=\x22text-align:\x20left;\x22>','2492876LEZQyJ','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.product_stock','rack','There\x27s\x20a\x20error\x20in\x20this\x20transaction','edit_adjustment','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','2182242MNFwfc','maxperunit','date','find','$product_details.secondary_code','second1','host','port','$product_details.type','findOne','adjust_qty','product','string','Spanish','prod_cat','Chinese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<div>','New_Qty_Converted','role','level','catch','logo','$product_details.primary_code','$name','prime1','$product_details.product_cat','Secondary_units','note','Email\x20sent\x20successfully','id_transaction','site_title','password','user','floorlevel','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<tr>','<html><head><title></title>','$invoice','back','bin','toString','prod_name','Arabic\x20(ae)','An\x20error\x20occurred\x20while\x20saving\x20data.','/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Return\x20Goods','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.floorlevel','</h5>','/../public','max_per_unit','flash','$product_details','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','product_stock','floor','ADJ-','adjustment\x20Finalized\x20successfully','English','email','$product_details._id','<strong>\x20Regards\x20</strong>','slice','</tbody>','finalize','Shelves','expiry_date','prod_invoice','</thead>','</td>','room_names','Error\x20Occurs','findById','warehouse','5cxDaaz','Return\x20Rooms','aggregate','padStart','<hr\x20class=\x22my-3\x22>','then','push','$product','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product.room_names','body','Floor','Rooms','$product_details.storage','Arabic','storage','</head><body>','../public/language/languages.json','invoice','product_details','$product.product_name','Primary_Units','isAllowEdit','5949nLeYZr','<h5>','master','redirect','post','2428216RNpXxI','sendMail','$product_details.secondary_unit','error','</tr>','$product_details.product_code','French','\x20Order\x20Date\x20:\x20','Enclosed','product_code','add_adjustment','$product_details.maxProducts','params','message','stockBefore','render','get','exports','$product_details.batch_code','German','log','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','New_Qty_Converted_adj','room','$_id','$product_details.expiry_date','5442048aGRWwG','</body></html>','$room','Receiving\x20Area','json','errors','Logo.png','$product_details.maxPerUnit','foreach\x20newproduct','\x20</h2>','createTransport','stock','$product_details.production_date','image','$product_details.bay','RMSEmail','Adjustment\x20Mail','product_name','types','/preview/:id','$date','bay','language','forEach','$product_details.unit','927204brraMc','edit_adjustment_view','/adjustment/preview/','id_transaction_from','length','Ambient','warehouse_name','map','$product_details.pallet','/adjustment/view','primary_code','staff','$product_details.rack','\x20<>\x20','prod_code','success','minus','filter','False','English\x20(US)','unit','new_adjust_qty','Portuguese\x20(BR)','Enabled','/view/:id','type','secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/barcode_scanner','save','Hindi','Raw\x20Materials','</span>','/view/add_adjustment','express','random','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','all','$product_details.product_name'];a0_0x53d0=function(){return _0x3a4a2b;};return a0_0x53d0();}(function(_0x2b4808,_0x5be521){var _0x56e174=a0_0x272e,_0x54b961=_0x2b4808();while(!![]){try{var _0x3ad6da=-parseInt(_0x56e174(0x16e))/0x1+parseInt(_0x56e174(0x19d))/0x2+-parseInt(_0x56e174(0x1b0))/0x3+-parseInt(_0x56e174(0x1a8))/0x4*(-parseInt(_0x56e174(0x1fc))/0x5)+-parseInt(_0x56e174(0x1a0))/0x6*(parseInt(_0x56e174(0x13b))/0x7)+parseInt(_0x56e174(0x155))/0x8+-parseInt(_0x56e174(0x213))/0x9*(-parseInt(_0x56e174(0x196))/0xa);if(_0x3ad6da===_0x5be521)break;else _0x54b961['push'](_0x54b961['shift']());}catch(_0x539421){_0x54b961['push'](_0x54b961['shift']());}}}(a0_0x53d0,0xe50ae));const express=require(a0_0x15b9ed(0x190)),app=express(),router=express['Router'](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0x15b9ed(0x20d)),nodemailer=require('nodemailer');router[a0_0x15b9ed(0x14b)](a0_0x15b9ed(0x1dd),auth,async(_0x2fad22,_0x34063d)=>{var _0x27a85f=a0_0x15b9ed;try{const {username:_0x63fec7,email:_0x1db43f,role:_0x575f11}=_0x2fad22[_0x27a85f(0x1d1)],_0x3baf54=_0x2fad22[_0x27a85f(0x1d1)],_0x1feb36=await profile['findOne']({'email':_0x3baf54[_0x27a85f(0x1ed)]}),_0x598f6a=await master_shop[_0x27a85f(0x1b3)]();console[_0x27a85f(0x14f)](_0x27a85f(0x138),_0x598f6a);let _0x376a9d;if(_0x3baf54[_0x27a85f(0x1c3)]==_0x27a85f(0x179)){const _0x94642b=await staff['findOne']({'email':_0x3baf54[_0x27a85f(0x1ed)]});_0x376a9d=await warehouse[_0x27a85f(0x1b3)]({'status':_0x27a85f(0x185),'name':_0x94642b[_0x27a85f(0x1fb)]});}else _0x376a9d=await warehouse['find']({'status':_0x27a85f(0x185)});const _0x12803c=await product[_0x27a85f(0x1b3)]();let _0x1d7f3a;if(_0x3baf54[_0x27a85f(0x1c3)]==_0x27a85f(0x179)){const _0x459f6a=await staff[_0x27a85f(0x1b9)]({'email':_0x3baf54[_0x27a85f(0x1ed)]});_0x1d7f3a=await adjustment[_0x27a85f(0x1b3)]({'warehouse_name':_0x459f6a[_0x27a85f(0x1fb)]});}else _0x1d7f3a=await adjustment[_0x27a85f(0x1fe)]([{'$unwind':_0x27a85f(0x203)},{'$group':{'_id':_0x27a85f(0x153),'invoice':{'$first':_0x27a85f(0x1d6)},'date':{'$first':_0x27a85f(0x169)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x27a85f(0x205)},'finalize':{'$first':_0x27a85f(0x197)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x598f6a[0x0][_0x27a85f(0x16b)]==_0x27a85f(0x181)){var _0x496448=users['English'];console[_0x27a85f(0x14f)](_0x496448);}else{if(_0x598f6a[0x0]['language']=='Hindi')var _0x496448=users[_0x27a85f(0x18c)];else{if(_0x598f6a[0x0][_0x27a85f(0x16b)]=='German')var _0x496448=users['German'];else{if(_0x598f6a[0x0][_0x27a85f(0x16b)]==_0x27a85f(0x1bd))var _0x496448=users[_0x27a85f(0x1bd)];else{if(_0x598f6a[0x0][_0x27a85f(0x16b)]==_0x27a85f(0x141))var _0x496448=users['French'];else{if(_0x598f6a[0x0][_0x27a85f(0x16b)]=='Portuguese\x20(BR)')var _0x496448=users[_0x27a85f(0x1a9)];else{if(_0x598f6a[0x0][_0x27a85f(0x16b)]==_0x27a85f(0x1bf))var _0x496448=users[_0x27a85f(0x1bf)];else{if(_0x598f6a[0x0][_0x27a85f(0x16b)]==_0x27a85f(0x1db))var _0x496448=users[_0x27a85f(0x20a)];}}}}}}}_0x34063d[_0x27a85f(0x14a)]('adjustment',{'success':_0x2fad22[_0x27a85f(0x1e5)](_0x27a85f(0x17d)),'errors':_0x2fad22['flash'](_0x27a85f(0x15a)),'role':_0x3baf54,'profile':_0x1feb36,'warehouse':_0x376a9d,'product':_0x12803c,'adjustment':_0x1d7f3a,'master_shop':_0x598f6a,'language':_0x496448});}catch(_0x36525c){console[_0x27a85f(0x14f)](_0x36525c);}});async function getRandom8DigitNumber(){var _0x5b47cf=a0_0x15b9ed;const _0x58f7db=0x989680,_0x1781ad=0x5f5e0ff,_0x506ccf=Math[_0x5b47cf(0x1e9)](Math[_0x5b47cf(0x191)]()*(_0x1781ad-_0x58f7db+0x1))+_0x58f7db;var _0x177983;const _0x5375e3=await adjustment[_0x5b47cf(0x1b9)]({'invoice':_0x5b47cf(0x1ea)+_0x506ccf});return _0x5375e3&&_0x5375e3['length']>0x0?_0x177983=_0x5b47cf(0x1ea)+_0x506ccf:_0x177983=_0x5b47cf(0x1ea)+_0x506ccf,_0x177983;}function a0_0x272e(_0x501a91,_0x244d16){var _0x53d09f=a0_0x53d0();return a0_0x272e=function(_0x272e8c,_0x40232a){_0x272e8c=_0x272e8c-0x138;var _0x169a91=_0x53d09f[_0x272e8c];return _0x169a91;},a0_0x272e(_0x501a91,_0x244d16);}router[a0_0x15b9ed(0x14b)](a0_0x15b9ed(0x18f),auth,async(_0x537ffd,_0x3898cd)=>{var _0x4a19bb=a0_0x15b9ed;try{const {username:_0x370fee,email:_0x3e9a47,role:_0x4bff0e}=_0x537ffd['user'],_0x445b81=_0x537ffd[_0x4a19bb(0x1d1)],_0x3aa3a9=await profile[_0x4a19bb(0x1b9)]({'email':_0x445b81['email']}),_0x4c2c0d=await master_shop[_0x4a19bb(0x1b3)]();let _0x25561f;if(_0x445b81['role']==_0x4a19bb(0x179)){const _0x2fb227=await staff[_0x4a19bb(0x1b9)]({'email':_0x445b81['email']});_0x25561f=await warehouse[_0x4a19bb(0x1fe)]([{'$match':{'status':_0x4a19bb(0x185),'name':_0x2fb227[_0x4a19bb(0x1fb)],'warehouse_category':_0x4a19bb(0x18d),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x25561f=await warehouse[_0x4a19bb(0x1fe)]([{'$match':{'status':_0x4a19bb(0x185),'warehouse_category':_0x4a19bb(0x18d),'name':{'$ne':_0x4a19bb(0x1df)}}},{'$group':{'_id':_0x4a19bb(0x1c8),'name':{'$first':_0x4a19bb(0x1c8)}}}]);const _0x517b35=await product['find']({}),_0x5e5000=await adjustment[_0x4a19bb(0x1b3)]({}),_0x33ed05=_0x5e5000[_0x4a19bb(0x172)]+0x1,_0x6bf8f2=_0x4a19bb(0x1ea)+_0x33ed05[_0x4a19bb(0x1d9)]()[_0x4a19bb(0x1ff)](0x5,'0');var _0x53379f=[_0x4a19bb(0x173),_0x4a19bb(0x143),_0x4a19bb(0x1fd)];if(_0x4c2c0d[0x0][_0x4a19bb(0x16b)]==_0x4a19bb(0x181))var _0x3f0d79=users[_0x4a19bb(0x1ec)];else{if(_0x4c2c0d[0x0][_0x4a19bb(0x16b)]==_0x4a19bb(0x18c))var _0x3f0d79=users[_0x4a19bb(0x18c)];else{if(_0x4c2c0d[0x0][_0x4a19bb(0x16b)]==_0x4a19bb(0x14e))var _0x3f0d79=users['German'];else{if(_0x4c2c0d[0x0]['language']=='Spanish')var _0x3f0d79=users[_0x4a19bb(0x1bd)];else{if(_0x4c2c0d[0x0]['language']==_0x4a19bb(0x141))var _0x3f0d79=users[_0x4a19bb(0x141)];else{if(_0x4c2c0d[0x0][_0x4a19bb(0x16b)]==_0x4a19bb(0x184))var _0x3f0d79=users[_0x4a19bb(0x1a9)];else{if(_0x4c2c0d[0x0][_0x4a19bb(0x16b)]==_0x4a19bb(0x1bf))var _0x3f0d79=users['Chinese'];else{if(_0x4c2c0d[0x0][_0x4a19bb(0x16b)]=='Arabic\x20(ae)')var _0x3f0d79=users[_0x4a19bb(0x20a)];}}}}}}}const _0x49d5b8=getRandom8DigitNumber();_0x49d5b8[_0x4a19bb(0x201)](_0x48e314=>{var _0x146af8=_0x4a19bb;_0x3898cd[_0x146af8(0x14a)](_0x146af8(0x145),{'success':_0x537ffd[_0x146af8(0x1e5)]('success'),'errors':_0x537ffd[_0x146af8(0x1e5)](_0x146af8(0x15a)),'role':_0x445b81,'profile':_0x3aa3a9,'warehouse':_0x25561f,'product':_0x517b35,'master_shop':_0x4c2c0d,'language':_0x3f0d79,'rooms_data':_0x53379f,'invoice_no':_0x48e314});})[_0x4a19bb(0x1c5)](_0xd9ffe7=>{var _0x50d4b4=_0x4a19bb;_0x537ffd[_0x50d4b4(0x1e5)](_0x50d4b4(0x15a),_0x50d4b4(0x1ad)),_0x3898cd[_0x50d4b4(0x139)](_0x50d4b4(0x177));});}catch(_0x4c1658){console[_0x4a19bb(0x14f)](_0x4c1658);}}),router[a0_0x15b9ed(0x13a)](a0_0x15b9ed(0x18f),auth,async(_0x19d499,_0x56830c)=>{var _0x423e71=a0_0x15b9ed;try{const {warehouse_name:_0x449592,date:_0x3e3af6,prod_name:_0x4d9fd6,level:_0x835575,isle:_0x4b20cc,pallet:_0x267bae,stock:_0x4068b1,types:_0x69a2e1,adjust_qty:_0x513bd2,new_adjust_qty:_0x447a3c,note:_0xce4ffc,Room_name:_0x8521a3,invoice:_0x1c11a5,JO_number:_0x2c41c9,expiry_date:_0x2eca6e}=_0x19d499[_0x423e71(0x206)];if(typeof _0x4d9fd6=='string')var _0x3075b2=[_0x19d499[_0x423e71(0x206)]['prod_name']],_0x572904=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x1c4)]],_0x56554b=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x160)]],_0x30fb65=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x167)]],_0x171183=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x151)]],_0xa69a50=[_0x19d499['body']['New_Qty_Converted']],_0x235125=[_0x19d499['body'][_0x423e71(0x211)]],_0x3e7175=[_0x19d499['body'][_0x423e71(0x1cb)]],_0x4b2963=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x17c)]],_0x11753e=[_0x19d499[_0x423e71(0x206)]['batch_code']],_0xf9382a=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x1f4)]],_0x124606=[_0x19d499[_0x423e71(0x206)]['max_per_unit']],_0x1d2b4d=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x19f)]],_0x18c282=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x1be)]],_0x3d5670=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x208)]],_0x230edc=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x1c9)]],_0x45b226=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x1b5)]],_0x2b1130=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x1f5)]],_0x17d080=[_0x19d499[_0x423e71(0x206)][_0x423e71(0x1ce)]];else var _0x3075b2=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x1da)]],_0x572904=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x1c4)]],_0x56554b=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x160)]],_0x30fb65=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x167)]],_0x171183=[..._0x19d499[_0x423e71(0x206)]['New_Qty_Converted_adj']],_0xa69a50=[..._0x19d499['body'][_0x423e71(0x1c2)]],_0x235125=[..._0x19d499['body']['unit']],_0x3e7175=[..._0x19d499[_0x423e71(0x206)]['Secondary_units']],_0x4b2963=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x17c)]],_0x11753e=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x199)]],_0xf9382a=[..._0x19d499['body'][_0x423e71(0x1f4)]],_0x124606=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x1e4)]],_0x1d2b4d=[..._0x19d499['body'][_0x423e71(0x19f)]],_0x18c282=[..._0x19d499['body'][_0x423e71(0x1be)]],_0x3d5670=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x208)]],_0x230edc=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x1c9)]],_0x45b226=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x1b5)]],_0x2b1130=[..._0x19d499[_0x423e71(0x206)][_0x423e71(0x1f5)]],_0x17d080=[..._0x19d499[_0x423e71(0x206)]['id_transaction']];const _0x21cc8f=_0x3075b2[_0x423e71(0x175)](_0x377ccc=>{return _0x377ccc={'product_name':_0x377ccc};});_0x572904[_0x423e71(0x16c)]((_0x6d6bc1,_0x569adb)=>{var _0x3ecd43=_0x423e71;_0x3d5670[_0x3ecd43(0x16c)]((_0x3c5ca3,_0x138ab2)=>{var _0x2ba67a=_0x3ecd43;if(_0x3c5ca3=='Receiving\x20Area'&&_0x569adb==_0x138ab2){var _0x1776e4=_0x6d6bc1[_0x2ba67a(0x1f0)](0x3);_0x21cc8f[_0x569adb][_0x2ba67a(0x20b)]=_0x6d6bc1[0x0],_0x21cc8f[_0x569adb][_0x2ba67a(0x1ac)]=_0x6d6bc1[0x1],_0x21cc8f[_0x569adb][_0x2ba67a(0x16a)]=0x0,_0x21cc8f[_0x569adb][_0x2ba67a(0x1d8)]=0x0,_0x21cc8f[_0x569adb][_0x2ba67a(0x187)]='Floor',_0x21cc8f[_0x569adb][_0x2ba67a(0x1d2)]=_0x1776e4;}else{if(_0x3c5ca3=='Shelves'&&_0x569adb==_0x138ab2){var _0x1776e4=_0x6d6bc1[_0x2ba67a(0x1f0)](0x3);_0x21cc8f[_0x569adb][_0x2ba67a(0x20b)]=_0x6d6bc1[0x0],_0x21cc8f[_0x569adb]['rack']=_0x6d6bc1[0x1],_0x21cc8f[_0x569adb][_0x2ba67a(0x16a)]=0x0,_0x21cc8f[_0x569adb][_0x2ba67a(0x1d8)]=0x0,_0x21cc8f[_0x569adb]['type']=_0x2ba67a(0x207),_0x21cc8f[_0x569adb][_0x2ba67a(0x1d2)]=_0x6d6bc1[0x5];}else{if(_0x569adb==_0x138ab2){var _0xb039f1;if(_0x6d6bc1[0x4]=='L')_0xb039f1='Level';else _0x6d6bc1[0x4]=='F'&&(_0xb039f1=_0x2ba67a(0x207));_0x21cc8f[_0x569adb]['storage']=_0x6d6bc1[0x0],_0x21cc8f[_0x569adb][_0x2ba67a(0x1ac)]=_0x6d6bc1[0x1],_0x21cc8f[_0x569adb][_0x2ba67a(0x16a)]=_0x6d6bc1[0x2],_0x21cc8f[_0x569adb][_0x2ba67a(0x1d8)]=_0x6d6bc1[0x3],_0x21cc8f[_0x569adb][_0x2ba67a(0x187)]=_0xb039f1,_0x21cc8f[_0x569adb][_0x2ba67a(0x1d2)]=_0x6d6bc1[0x5];}}}});}),_0x56554b[_0x423e71(0x16c)]((_0x564939,_0xe0fd55)=>{_0x21cc8f[_0xe0fd55]['stockBefore']=_0x564939;}),_0x17d080[_0x423e71(0x16c)]((_0x5a0994,_0x4a5305)=>{var _0x3f133c=_0x423e71;_0x21cc8f[_0x4a5305][_0x3f133c(0x171)]=_0x5a0994;}),_0x30fb65['forEach']((_0x20c055,_0x3b45f5)=>{var _0x5ba89c=_0x423e71;_0x21cc8f[_0x3b45f5][_0x5ba89c(0x167)]=_0x20c055;}),_0x171183[_0x423e71(0x16c)]((_0x336d86,_0x9c0f42)=>{_0x21cc8f[_0x9c0f42]['adjust_qty']=_0x336d86;}),_0xa69a50[_0x423e71(0x16c)]((_0x3d07c9,_0x5cc644)=>{var _0x443d37=_0x423e71;_0x21cc8f[_0x5cc644][_0x443d37(0x183)]=_0x3d07c9;}),_0x235125[_0x423e71(0x16c)]((_0x4284d6,_0x23c15b)=>{var _0x46b117=_0x423e71;_0x21cc8f[_0x23c15b][_0x46b117(0x182)]=_0x4284d6;}),_0x3e7175[_0x423e71(0x16c)]((_0x2fac0f,_0x31c253)=>{var _0x49d80e=_0x423e71;_0x21cc8f[_0x31c253][_0x49d80e(0x19e)]=_0x2fac0f;}),_0x4b2963[_0x423e71(0x16c)]((_0x252a08,_0x43e284)=>{var _0xab12e1=_0x423e71;_0x21cc8f[_0x43e284][_0xab12e1(0x144)]=_0x252a08;}),_0x11753e[_0x423e71(0x16c)]((_0x4e0c88,_0x2573ad)=>{var _0x356b5c=_0x423e71;_0x21cc8f[_0x2573ad][_0x356b5c(0x199)]=_0x4e0c88;}),_0xf9382a[_0x423e71(0x16c)]((_0x166e2b,_0x478fc8)=>{var _0x449718=_0x423e71;_0x21cc8f[_0x478fc8][_0x449718(0x1f4)]=_0x166e2b;}),_0x124606['forEach']((_0x2bb5ce,_0xd06d36)=>{var _0x1d16a1=_0x423e71;_0x21cc8f[_0xd06d36][_0x1d16a1(0x1b1)]=_0x2bb5ce;}),_0x1d2b4d[_0x423e71(0x16c)]((_0x5b3acc,_0x2dcf36)=>{var _0x22bf31=_0x423e71;_0x21cc8f[_0x2dcf36][_0x22bf31(0x19f)]=_0x5b3acc;}),_0x18c282['forEach']((_0x3d6d6b,_0x3c0415)=>{var _0x29873b=_0x423e71;_0x21cc8f[_0x3c0415][_0x29873b(0x1be)]=_0x3d6d6b;}),_0x3d5670[_0x423e71(0x16c)]((_0x42b447,_0x179f40)=>{var _0x3f442e=_0x423e71;_0x21cc8f[_0x179f40][_0x3f442e(0x1f8)]=_0x42b447;}),_0x230edc[_0x423e71(0x16c)]((_0x3249a0,_0x557037)=>{_0x21cc8f[_0x557037]['primary_code']=_0x3249a0;}),_0x45b226[_0x423e71(0x16c)]((_0x5ef176,_0x2a9221)=>{_0x21cc8f[_0x2a9221]['secondary_code']=_0x5ef176;}),_0x2b1130[_0x423e71(0x16c)]((_0x5e174d,_0x1506ec)=>{var _0x102ed1=_0x423e71;_0x21cc8f[_0x1506ec][_0x102ed1(0x20e)]=_0x5e174d;});const _0x5ac845=_0x21cc8f[_0x423e71(0x17f)](_0x5e64d4=>_0x5e64d4['adjust_qty']!=='0'&&_0x5e64d4[_0x423e71(0x1ba)]!=='');var _0x404110=0x0;_0x5ac845[_0x423e71(0x16c)](_0x38689b=>{var _0x24b66c=_0x423e71;console[_0x24b66c(0x14f)](_0x24b66c(0x15d),_0x38689b),parseInt(_0x38689b['adjust_qty'])<=0x0&&_0x404110++;});if(_0x404110!=0x0)return _0x19d499['flash']('errors',_0x423e71(0x150)),_0x56830c[_0x423e71(0x139)]('back');const _0x4113e9=new adjustment({'warehouse_name':_0x449592,'date':_0x3e3af6,'product':_0x5ac845,'note':_0xce4ffc,'room':_0x8521a3,'invoice':_0x1c11a5,'JO_number':_0x2c41c9,'expiry_date':_0x2eca6e}),_0x2e1732=await _0x4113e9[_0x423e71(0x18b)]();_0x19d499['flash']('success','adjustment\x20add\x20successfull'),_0x56830c['redirect'](_0x423e71(0x170)+_0x2e1732[_0x423e71(0x1a4)]);}catch(_0x1eadfe){console['log'](_0x1eadfe),_0x56830c[_0x423e71(0x19a)](0xc8)['json']({'message':_0x1eadfe[_0x423e71(0x148)]});}}),router[a0_0x15b9ed(0x14b)]('/preview/:id',auth,async(_0x302412,_0xb331e5)=>{var _0x39572c=a0_0x15b9ed;try{const {username:_0x5b3c0d,email:_0x3915e8,role:_0x27457c}=_0x302412[_0x39572c(0x1d1)],_0x21d20a=_0x302412[_0x39572c(0x1d1)],_0x432a56=await profile['findOne']({'email':_0x21d20a['email']}),_0xc1eb4d=await master_shop[_0x39572c(0x1b3)](),_0x5eb139=_0x302412['params']['id'],_0x3dbd56=await adjustment[_0x39572c(0x1fa)]({'_id':_0x5eb139}),_0x30afef=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3dbd56[_0x39572c(0x174)]}},{'$unwind':_0x39572c(0x203)},{'$group':{'_id':_0x39572c(0x210)}}]),_0x2c66bf=await product[_0x39572c(0x1b3)]({}),_0x36c23c=await warehouse[_0x39572c(0x1fe)]([{'$match':{'name':_0x3dbd56[_0x39572c(0x174)]}},{'$unwind':_0x39572c(0x1e6)},{'$group':{'_id':_0x39572c(0x1ee),'name':{'$first':_0x39572c(0x195)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x39572c(0x198)},'type':{'$first':_0x39572c(0x1b8)},'floorlevel':{'$first':_0x39572c(0x1e1)},'primary_code':{'$first':_0x39572c(0x1c7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x39572c(0x140)},'storage':{'$first':_0x39572c(0x209)},'rack':{'$first':_0x39572c(0x17a)},'maxPerUnit':{'$first':_0x39572c(0x15c)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x39572c(0x161)},'batch_code':{'$first':_0x39572c(0x14d)},'room':{'$first':_0x39572c(0x157)}}}]);if(_0xc1eb4d[0x0][_0x39572c(0x16b)]==_0x39572c(0x181)){var _0x5d375c=users[_0x39572c(0x1ec)];console[_0x39572c(0x14f)](_0x5d375c);}else{if(_0xc1eb4d[0x0][_0x39572c(0x16b)]==_0x39572c(0x18c))var _0x5d375c=users['Hindi'];else{if(_0xc1eb4d[0x0]['language']==_0x39572c(0x14e))var _0x5d375c=users['German'];else{if(_0xc1eb4d[0x0]['language']==_0x39572c(0x1bd))var _0x5d375c=users[_0x39572c(0x1bd)];else{if(_0xc1eb4d[0x0]['language']==_0x39572c(0x141))var _0x5d375c=users['French'];else{if(_0xc1eb4d[0x0][_0x39572c(0x16b)]=='Portuguese\x20(BR)')var _0x5d375c=users[_0x39572c(0x1a9)];else{if(_0xc1eb4d[0x0][_0x39572c(0x16b)]=='Chinese')var _0x5d375c=users[_0x39572c(0x1bf)];else{if(_0xc1eb4d[0x0][_0x39572c(0x16b)]=='Arabic\x20(ae)')var _0x5d375c=users[_0x39572c(0x20a)];}}}}}}}_0xb331e5[_0x39572c(0x14a)](_0x39572c(0x16f),{'success':_0x302412[_0x39572c(0x1e5)](_0x39572c(0x17d)),'errors':_0x302412[_0x39572c(0x1e5)](_0x39572c(0x15a)),'role':_0x21d20a,'profile':_0x432a56,'adjustment':_0x3dbd56,'stock':_0x36c23c,'master_shop':_0xc1eb4d,'warehouse_name':_0x30afef,'unit':_0x2c66bf,'language':_0x5d375c});}catch(_0x3025a2){console[_0x39572c(0x14f)](_0x3025a2),_0xb331e5[_0x39572c(0x19a)](0xc8)[_0x39572c(0x159)]({'message':_0x3025a2[_0x39572c(0x148)]});}}),router[a0_0x15b9ed(0x13a)](a0_0x15b9ed(0x168),auth,async(_0x44750f,_0x2b9382)=>{var _0x1dc543=a0_0x15b9ed;try{const _0x49fd80=_0x44750f[_0x1dc543(0x147)]['id'],{warehouse_name:_0x173c74,Room_name:_0x15087f}=_0x44750f[_0x1dc543(0x206)],_0x470201=await adjustment[_0x1dc543(0x1fa)]({'_id':_0x49fd80}),_0x35f4dc=_0x470201[_0x1dc543(0x1bb)]['map'](async _0x3389=>{var _0x30d3d8=_0x1dc543;if(_0x3389[_0x30d3d8(0x1ba)]>0x0){var _0x4a8797=await warehouse[_0x30d3d8(0x1b9)]({'name':_0x173c74,'room':_0x3389[_0x30d3d8(0x1f8)],'warehouse_category':'Raw\x20Materials'});const _0x1060f4=_0x4a8797[_0x30d3d8(0x20f)]['map'](_0x3ebfbf=>{var _0x2eda8f=_0x30d3d8;console[_0x2eda8f(0x14f)](_0x3389[_0x2eda8f(0x167)]+_0x2eda8f(0x17b));if(_0x3389[_0x2eda8f(0x167)]==_0x2eda8f(0x17e)){if(_0x3ebfbf[_0x2eda8f(0x166)]==_0x3389['product_name']&&_0x3ebfbf[_0x2eda8f(0x1d2)]==_0x3389[_0x2eda8f(0x1d2)]&&_0x3ebfbf['type']==_0x3389[_0x2eda8f(0x187)]&&_0x3ebfbf['bin']==_0x3389['bin']&&_0x3ebfbf[_0x2eda8f(0x16a)]==_0x3389[_0x2eda8f(0x16a)]&&_0x3ebfbf[_0x2eda8f(0x1ac)]==_0x3389[_0x2eda8f(0x1ac)]&&_0x3ebfbf[_0x2eda8f(0x20b)]==_0x3389[_0x2eda8f(0x20b)]&&_0x3ebfbf[_0x2eda8f(0x1f4)]==_0x3389[_0x2eda8f(0x1f4)]&&_0x3ebfbf[_0x2eda8f(0x199)]==_0x3389[_0x2eda8f(0x199)]&&_0x3ebfbf[_0x2eda8f(0x19f)]==_0x3389['production_date']&&_0x3ebfbf[_0x2eda8f(0x20e)]==_0x3389[_0x2eda8f(0x20e)]&&_0x3ebfbf[_0x2eda8f(0x1a4)]==_0x3389[_0x2eda8f(0x171)]){var _0x288744;_0x288744=_0x3389[_0x2eda8f(0x1ba)],_0x3389['prod_cat']=='S'&&(_0x288744=_0x3389[_0x2eda8f(0x1ba)]),_0x3ebfbf['product_stock']=_0x3ebfbf['product_stock']-_0x288744;}}else{if(_0x3ebfbf[_0x2eda8f(0x166)]==_0x3389[_0x2eda8f(0x166)]&&_0x3ebfbf[_0x2eda8f(0x1d2)]==_0x3389[_0x2eda8f(0x1d2)]&&_0x3ebfbf['type']==_0x3389[_0x2eda8f(0x187)]&&_0x3ebfbf[_0x2eda8f(0x1d8)]==_0x3389[_0x2eda8f(0x1d8)]&&_0x3ebfbf['bay']==_0x3389[_0x2eda8f(0x16a)]&&_0x3ebfbf['rack']==_0x3389[_0x2eda8f(0x1ac)]&&_0x3ebfbf['storage']==_0x3389[_0x2eda8f(0x20b)]&&_0x3ebfbf['expiry_date']==_0x3389[_0x2eda8f(0x1f4)]&&_0x3ebfbf[_0x2eda8f(0x199)]==_0x3389['batch_code']&&_0x3ebfbf['production_date']==_0x3389[_0x2eda8f(0x19f)]&&_0x3ebfbf[_0x2eda8f(0x20e)]==_0x3389[_0x2eda8f(0x20e)]&&_0x3ebfbf['_id']==_0x3389[_0x2eda8f(0x171)]){console[_0x2eda8f(0x14f)](_0x3389);var _0x288744;_0x288744=_0x3389[_0x2eda8f(0x1ba)],_0x3389[_0x2eda8f(0x1be)]=='S'&&(_0x288744=_0x3389['adjust_qty']),_0x3ebfbf[_0x2eda8f(0x1e8)]=_0x3ebfbf[_0x2eda8f(0x1e8)]+_0x288744;}}});}return _0x4a8797;});Promise[_0x1dc543(0x194)](_0x35f4dc)['then'](async _0x6e2a39=>{var _0x2e758f=_0x1dc543;try{for(const _0x217710 of _0x6e2a39){await _0x217710[_0x2e758f(0x18b)]();}_0x470201[_0x2e758f(0x1f2)]='True';const _0x1f120a=await _0x470201[_0x2e758f(0x18b)](),_0x3a97db=await master_shop['find'](),_0x427a31=await email_settings[_0x2e758f(0x1b9)](),_0x5bd0e7=await supervisor_settings[_0x2e758f(0x1b3)]();var _0x17ccd2=_0x470201['product'],_0x788fed='',_0x53c663;for(_0x53c663 in _0x17ccd2){_0x788fed+=_0x2e758f(0x1d4)+_0x2e758f(0x1d3)+_0x17ccd2[_0x53c663]['product_name']+_0x2e758f(0x1f7)+_0x2e758f(0x1d3)+_0x17ccd2[_0x53c663][_0x2e758f(0x144)]+_0x2e758f(0x1f7)+_0x2e758f(0x1d3)+_0x17ccd2[_0x53c663][_0x2e758f(0x1ba)]+_0x2e758f(0x1f7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x17ccd2[_0x53c663][_0x2e758f(0x182)]+_0x2e758f(0x1f7)+_0x2e758f(0x1d3)+_0x17ccd2[_0x53c663]['secondary_unit']+_0x2e758f(0x1f7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x470201['warehouse_name']+'</td>'+_0x2e758f(0x1d3)+_0x17ccd2[_0x53c663][_0x2e758f(0x1f8)]+_0x2e758f(0x1f7)+_0x2e758f(0x1d3)+_0x17ccd2[_0x53c663][_0x2e758f(0x20b)]+_0x17ccd2[_0x53c663]['rack']+_0x17ccd2[_0x53c663][_0x2e758f(0x16a)]+_0x17ccd2[_0x53c663][_0x2e758f(0x1d8)]+_0x17ccd2[_0x53c663][_0x2e758f(0x187)][0x0]+_0x17ccd2[_0x53c663][_0x2e758f(0x1d2)]+_0x2e758f(0x1f7),_0x2e758f(0x13f);}let _0xbf4a90=nodemailer[_0x2e758f(0x15f)]({'host':_0x427a31[_0x2e758f(0x1b6)],'port':Number(_0x427a31[_0x2e758f(0x1b7)]),'secure':![],'auth':{'user':_0x427a31[_0x2e758f(0x1ed)],'pass':_0x427a31[_0x2e758f(0x1d0)]}}),_0x5db5e3={'from':_0x427a31[_0x2e758f(0x1ed)],'to':_0x5bd0e7[0x0][_0x2e758f(0x164)],'subject':_0x2e758f(0x165),'attachments':[{'filename':_0x2e758f(0x15b),'path':__dirname+_0x2e758f(0x1e3)+'/upload/'+_0x3a97db[0x0][_0x2e758f(0x162)],'cid':_0x2e758f(0x1c6)}],'html':_0x2e758f(0x19b)+_0x2e758f(0x1d5)+_0x2e758f(0x20c)+_0x2e758f(0x1c1)+_0x2e758f(0x1e7)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2e758f(0x1a1)+_0x2e758f(0x1c1)+'<h2>\x20'+_0x3a97db[0x0][_0x2e758f(0x1cf)]+_0x2e758f(0x15e)+_0x2e758f(0x1a1)+_0x2e758f(0x1a1)+_0x2e758f(0x200)+_0x2e758f(0x1c1)+_0x2e758f(0x1a7)+_0x2e758f(0x1a6)+_0x470201['invoice']+'\x20'+_0x2e758f(0x1a2)+_0x2e758f(0x142)+_0x470201[_0x2e758f(0x1b2)]+'\x20'+_0x2e758f(0x18e)+'</h5>'+_0x2e758f(0x1a1)+_0x2e758f(0x192)+_0x2e758f(0x204)+_0x2e758f(0x1d4)+_0x2e758f(0x1af)+_0x2e758f(0x1e0)+_0x2e758f(0x1de)+_0x2e758f(0x189)+_0x2e758f(0x1aa)+_0x2e758f(0x1a5)+_0x2e758f(0x1c0)+_0x2e758f(0x193)+_0x2e758f(0x13f)+_0x2e758f(0x1f6)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x788fed+'\x20'+_0x2e758f(0x1f1)+'</table>'+_0x2e758f(0x1c1)+_0x2e758f(0x1ef)+_0x2e758f(0x214)+_0x3a97db[0x0][_0x2e758f(0x1cf)]+_0x2e758f(0x1e2)+_0x2e758f(0x1a1)+_0x2e758f(0x1a1)+_0x2e758f(0x156)};_0xbf4a90[_0x2e758f(0x13c)](_0x5db5e3,function(_0x154e41,_0x4be331){var _0x3817f8=_0x2e758f;_0x154e41?(console[_0x3817f8(0x14f)](_0x154e41),console['log'](_0x3817f8(0x1f9))):console['log'](_0x3817f8(0x1cd));}),_0x44750f['flash'](_0x2e758f(0x17d),_0x2e758f(0x1eb)),_0x2b9382[_0x2e758f(0x139)]('/picking_list/PDF_adjustment_rm/'+_0x1f120a['_id']);}catch(_0x3ca1a1){console[_0x2e758f(0x13e)](_0x3ca1a1),_0x2b9382[_0x2e758f(0x19a)](0x1f4)['json']({'error':_0x2e758f(0x1dc)});}})[_0x1dc543(0x1c5)](_0x2d04f3=>{var _0x99e477=_0x1dc543;console[_0x99e477(0x13e)](_0x2d04f3),_0x2b9382[_0x99e477(0x19a)](0x1f4)[_0x99e477(0x159)]({'error':_0x99e477(0x19c)});});}catch(_0x1236cf){console['log'](_0x1236cf),_0x2b9382['status'](0xc8)[_0x1dc543(0x159)]({'message':_0x1236cf['message']});}}),router['get'](a0_0x15b9ed(0x186),auth,async(_0x3fbfc7,_0x372ab3)=>{var _0x19f571=a0_0x15b9ed;try{const {username:_0x4ea78e,email:_0x5b215b,role:_0x2ce77d}=_0x3fbfc7[_0x19f571(0x1d1)],_0x28c0b2=_0x3fbfc7[_0x19f571(0x1d1)],_0x47ea73=await profile[_0x19f571(0x1b9)]({'email':_0x28c0b2[_0x19f571(0x1ed)]}),_0x3f3eda=await master_shop[_0x19f571(0x1b3)](),_0x13b934=_0x3fbfc7[_0x19f571(0x147)]['id'],_0x35e80d=await adjustment[_0x19f571(0x1fa)]({'_id':_0x13b934}),_0x2dd463=await purchases[_0x19f571(0x1fe)]([{'$match':{'warehouse_name':_0x35e80d['warehouse_name']}},{'$unwind':_0x19f571(0x203)},{'$group':{'_id':_0x19f571(0x210)}}]),_0x5535b7=await product['find']({}),_0x4b75f2=await warehouse[_0x19f571(0x1fe)]([{'$match':{'name':_0x35e80d[_0x19f571(0x174)]}},{'$unwind':_0x19f571(0x1e6)},{'$group':{'_id':_0x19f571(0x1ee),'name':{'$first':_0x19f571(0x195)},'product_stock':{'$first':_0x19f571(0x1ab)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x19f571(0x1b8)},'floorlevel':{'$first':_0x19f571(0x1e1)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x19f571(0x1b4)},'product_code':{'$first':_0x19f571(0x140)},'storage':{'$first':_0x19f571(0x209)},'rack':{'$first':_0x19f571(0x17a)},'maxPerUnit':{'$first':_0x19f571(0x15c)},'expiry_date':{'$first':_0x19f571(0x154)},'production_date':{'$first':_0x19f571(0x161)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x19f571(0x157)}}}]);let _0x5b80c8;if(_0x28c0b2[_0x19f571(0x1c3)]==_0x19f571(0x179)){const _0x2d91c9=await staff[_0x19f571(0x1b9)]({'email':_0x28c0b2[_0x19f571(0x1ed)]});_0x5b80c8=await warehouse[_0x19f571(0x1fe)]([{'$match':{'status':_0x19f571(0x185),'name':_0x2d91c9[_0x19f571(0x1fb)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x19f571(0x1df)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x5b80c8=await warehouse['aggregate']([{'$match':{'status':_0x19f571(0x185),'warehouse_category':_0x19f571(0x18d),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x19f571(0x1c8),'name':{'$first':_0x19f571(0x1c8)}}}]);if(_0x3f3eda[0x0][_0x19f571(0x16b)]==_0x19f571(0x181)){var _0x3f259e=users[_0x19f571(0x1ec)];console['log'](_0x3f259e);}else{if(_0x3f3eda[0x0]['language']==_0x19f571(0x18c))var _0x3f259e=users[_0x19f571(0x18c)];else{if(_0x3f3eda[0x0][_0x19f571(0x16b)]==_0x19f571(0x14e))var _0x3f259e=users[_0x19f571(0x14e)];else{if(_0x3f3eda[0x0][_0x19f571(0x16b)]==_0x19f571(0x1bd))var _0x3f259e=users[_0x19f571(0x1bd)];else{if(_0x3f3eda[0x0]['language']==_0x19f571(0x141))var _0x3f259e=users['French'];else{if(_0x3f3eda[0x0][_0x19f571(0x16b)]==_0x19f571(0x184))var _0x3f259e=users[_0x19f571(0x1a9)];else{if(_0x3f3eda[0x0][_0x19f571(0x16b)]==_0x19f571(0x1bf))var _0x3f259e=users[_0x19f571(0x1bf)];else{if(_0x3f3eda[0x0]['language']==_0x19f571(0x1db))var _0x3f259e=users[_0x19f571(0x20a)];}}}}}}}_0x372ab3['render'](_0x19f571(0x1ae),{'success':_0x3fbfc7['flash'](_0x19f571(0x17d)),'errors':_0x3fbfc7[_0x19f571(0x1e5)](_0x19f571(0x15a)),'role':_0x28c0b2,'profile':_0x47ea73,'adjustment':_0x35e80d,'stock':_0x4b75f2,'master_shop':_0x3f3eda,'warehouse_name':_0x2dd463,'unit':_0x5535b7,'language':_0x3f259e,'warehouse':_0x5b80c8});}catch(_0x237c12){console[_0x19f571(0x14f)](_0x237c12),_0x372ab3[_0x19f571(0x19a)](0xc8)[_0x19f571(0x159)]({'message':_0x237c12[_0x19f571(0x148)]});}}),router[a0_0x15b9ed(0x13a)](a0_0x15b9ed(0x186),auth,async(_0x2b906f,_0x4278c9)=>{var _0x8e01d9=a0_0x15b9ed;try{const _0x4efbb7=_0x2b906f[_0x8e01d9(0x147)]['id'],_0x39495c=await adjustment[_0x8e01d9(0x1fa)]({'_id':_0x4efbb7}),_0x7e7436=await warehouse[_0x8e01d9(0x1b9)]({'name':_0x39495c[_0x8e01d9(0x174)],'room':_0x39495c[_0x8e01d9(0x152)]}),{warehouse_name:_0x32a0d2,date:_0x2fbb42,prod_name:_0x22c701,level:_0x23b8f5,isle:_0x4ef267,pallet:_0x5271e9,stock:_0x41375d,types:_0x41bd70,adjust_qty:_0x3c0813,new_adjust_qty:_0x310abd,note:_0x2b89a2,Room_name:_0x400474,invoice:_0x15e906,JO_number:_0x15ec0c,expiry_date:_0xa63393}=_0x2b906f[_0x8e01d9(0x206)];if(typeof _0x22c701==_0x8e01d9(0x1bc))var _0xde81c5=[_0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1da)]],_0x372930=[_0x2b906f['body'][_0x8e01d9(0x1c4)]],_0x2d8893=[_0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x160)]],_0x436112=[_0x2b906f[_0x8e01d9(0x206)]['types']],_0x3b7b7f=[_0x2b906f['body'][_0x8e01d9(0x151)]],_0x14c60a=[_0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1c2)]],_0x5877f3=[_0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x211)]],_0x44503a=[_0x2b906f[_0x8e01d9(0x206)]['Secondary_units']],_0x5073dc=[_0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x17c)]],_0x3e7800=[_0x2b906f['body'][_0x8e01d9(0x199)]],_0x36506f=[_0x2b906f['body'][_0x8e01d9(0x1f4)]],_0x2a39c1=[_0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1e4)]],_0x2027ec=[_0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x19f)]],_0x441f41=[_0x2b906f[_0x8e01d9(0x206)]['prod_cat']],_0x2a12ee=[_0x2b906f['body'][_0x8e01d9(0x208)]],_0x19e34e=[_0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1c9)]],_0x58a356=[_0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1b5)]];else var _0xde81c5=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1da)]],_0x372930=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1c4)]],_0x2d8893=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x160)]],_0x436112=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x167)]],_0x3b7b7f=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x151)]],_0x14c60a=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1c2)]],_0x5877f3=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x182)]],_0x44503a=[..._0x2b906f[_0x8e01d9(0x206)]['Secondary_units']],_0x5073dc=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x17c)]],_0x3e7800=[..._0x2b906f['body']['batch_code']],_0x36506f=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1f4)]],_0x2a39c1=[..._0x2b906f['body']['max_per_unit']],_0x2027ec=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x19f)]],_0x441f41=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1be)]],_0x2a12ee=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x208)]],_0x19e34e=[..._0x2b906f[_0x8e01d9(0x206)][_0x8e01d9(0x1c9)]],_0x58a356=[..._0x2b906f[_0x8e01d9(0x206)]['second1']];const _0x1bbfbe=_0xde81c5[_0x8e01d9(0x175)](_0x4749b9=>{return _0x4749b9={'product_name':_0x4749b9};});_0x372930[_0x8e01d9(0x16c)]((_0x35035a,_0x1f96c6)=>{var _0x2bc54d=_0x8e01d9;_0x2a12ee[_0x2bc54d(0x16c)]((_0x3a061d,_0x4f7b90)=>{var _0x27ab96=_0x2bc54d;if(_0x3a061d==_0x27ab96(0x158)&&_0x1f96c6==_0x4f7b90){var _0x21f1b9=_0x35035a[_0x27ab96(0x1f0)](0x3);_0x1bbfbe[_0x1f96c6][_0x27ab96(0x20b)]=_0x35035a[0x0],_0x1bbfbe[_0x1f96c6][_0x27ab96(0x1ac)]=_0x35035a[0x1],_0x1bbfbe[_0x1f96c6][_0x27ab96(0x16a)]=0x0,_0x1bbfbe[_0x1f96c6]['bin']=0x0,_0x1bbfbe[_0x1f96c6][_0x27ab96(0x187)]=_0x27ab96(0x207),_0x1bbfbe[_0x1f96c6][_0x27ab96(0x1d2)]=_0x21f1b9;}else{if(_0x3a061d==_0x27ab96(0x1f3)&&_0x1f96c6==_0x4f7b90){var _0x21f1b9=_0x35035a[_0x27ab96(0x1f0)](0x3);_0x1bbfbe[_0x1f96c6][_0x27ab96(0x20b)]=_0x35035a[0x0],_0x1bbfbe[_0x1f96c6][_0x27ab96(0x1ac)]=_0x35035a[0x1],_0x1bbfbe[_0x1f96c6][_0x27ab96(0x16a)]=0x0,_0x1bbfbe[_0x1f96c6]['bin']=0x0,_0x1bbfbe[_0x1f96c6]['type']=_0x27ab96(0x207),_0x1bbfbe[_0x1f96c6]['floorlevel']=_0x35035a[0x5];}else{if(_0x1f96c6==_0x4f7b90){var _0x29065a;if(_0x35035a[0x4]=='L')_0x29065a='Level';else _0x35035a[0x4]=='F'&&(_0x29065a=_0x27ab96(0x207));_0x1bbfbe[_0x1f96c6]['storage']=_0x35035a[0x0],_0x1bbfbe[_0x1f96c6][_0x27ab96(0x1ac)]=_0x35035a[0x1],_0x1bbfbe[_0x1f96c6]['bay']=_0x35035a[0x2],_0x1bbfbe[_0x1f96c6][_0x27ab96(0x1d8)]=_0x35035a[0x3],_0x1bbfbe[_0x1f96c6][_0x27ab96(0x187)]=_0x29065a,_0x1bbfbe[_0x1f96c6][_0x27ab96(0x1d2)]=_0x35035a[0x5];}}}});}),_0x2d8893[_0x8e01d9(0x16c)]((_0x174b6e,_0x1b0408)=>{var _0x96c652=_0x8e01d9;_0x1bbfbe[_0x1b0408][_0x96c652(0x149)]=_0x174b6e;}),_0x436112[_0x8e01d9(0x16c)]((_0x2e7ccf,_0x415ff2)=>{var _0x3a954a=_0x8e01d9;_0x1bbfbe[_0x415ff2][_0x3a954a(0x167)]=_0x2e7ccf;}),_0x3b7b7f[_0x8e01d9(0x16c)]((_0x3035d2,_0x1ff8b0)=>{_0x1bbfbe[_0x1ff8b0]['adjust_qty']=_0x3035d2;}),_0x14c60a[_0x8e01d9(0x16c)]((_0x57cee8,_0x6e0c60)=>{var _0x3f5e37=_0x8e01d9;_0x1bbfbe[_0x6e0c60][_0x3f5e37(0x183)]=_0x57cee8;}),_0x5877f3['forEach']((_0x41e9a3,_0x49c998)=>{var _0x10061e=_0x8e01d9;_0x1bbfbe[_0x49c998][_0x10061e(0x182)]=_0x41e9a3;}),_0x44503a[_0x8e01d9(0x16c)]((_0x5f3dee,_0x395314)=>{var _0x4ea8b6=_0x8e01d9;_0x1bbfbe[_0x395314][_0x4ea8b6(0x19e)]=_0x5f3dee;}),_0x5073dc[_0x8e01d9(0x16c)]((_0x1c41fe,_0x17b4e6)=>{_0x1bbfbe[_0x17b4e6]['product_code']=_0x1c41fe;}),_0x3e7800['forEach']((_0x21e31a,_0x48cf56)=>{var _0x23ad3=_0x8e01d9;_0x1bbfbe[_0x48cf56][_0x23ad3(0x199)]=_0x21e31a;}),_0x36506f[_0x8e01d9(0x16c)]((_0x1dfe68,_0x1dde36)=>{var _0x277300=_0x8e01d9;_0x1bbfbe[_0x1dde36][_0x277300(0x1f4)]=_0x1dfe68;}),_0x2a39c1[_0x8e01d9(0x16c)]((_0x4b942f,_0x179401)=>{var _0x56a1f0=_0x8e01d9;_0x1bbfbe[_0x179401][_0x56a1f0(0x1b1)]=_0x4b942f;}),_0x2027ec[_0x8e01d9(0x16c)]((_0x37ad2e,_0x59f95c)=>{var _0x2a2ce5=_0x8e01d9;_0x1bbfbe[_0x59f95c][_0x2a2ce5(0x19f)]=_0x37ad2e;}),_0x441f41[_0x8e01d9(0x16c)]((_0x37159e,_0x13be32)=>{var _0x261e50=_0x8e01d9;_0x1bbfbe[_0x13be32][_0x261e50(0x1be)]=_0x37159e;}),_0x2a12ee[_0x8e01d9(0x16c)]((_0x44fa44,_0x4e59e9)=>{var _0x5a9e7e=_0x8e01d9;_0x1bbfbe[_0x4e59e9][_0x5a9e7e(0x1f8)]=_0x44fa44;}),_0x19e34e[_0x8e01d9(0x16c)]((_0x4360ef,_0xbbdea6)=>{var _0x2bc660=_0x8e01d9;_0x1bbfbe[_0xbbdea6][_0x2bc660(0x178)]=_0x4360ef;}),_0x58a356[_0x8e01d9(0x16c)]((_0x1d77d9,_0xe6e79c)=>{var _0x1fab69=_0x8e01d9;_0x1bbfbe[_0xe6e79c][_0x1fab69(0x188)]=_0x1d77d9;});const _0x508573=_0x1bbfbe['filter'](_0x2a71e9=>_0x2a71e9[_0x8e01d9(0x1ba)]!=='0'&&_0x2a71e9[_0x8e01d9(0x1ba)]!=='');var _0x344c1a=0x0;_0x508573[_0x8e01d9(0x16c)](_0x482951=>{var _0x164b2a=_0x8e01d9;console[_0x164b2a(0x14f)](_0x164b2a(0x15d),_0x482951),parseInt(_0x482951[_0x164b2a(0x1ba)])<=0x0&&_0x344c1a++;});if(_0x344c1a!=0x0)return _0x2b906f[_0x8e01d9(0x1e5)]('errors',_0x8e01d9(0x150)),_0x4278c9[_0x8e01d9(0x139)](_0x8e01d9(0x1d7));_0x39495c[_0x8e01d9(0x174)]=_0x32a0d2,_0x39495c[_0x8e01d9(0x1b2)]=_0x2fbb42,_0x39495c[_0x8e01d9(0x1bb)]=_0x508573,_0x39495c[_0x8e01d9(0x1cc)]=_0x2b89a2,_0x39495c[_0x8e01d9(0x20e)]=_0x15e906,_0x39495c[_0x8e01d9(0x212)]=_0x8e01d9(0x180);const _0x5fb7a4=await _0x39495c[_0x8e01d9(0x18b)]();_0x2b906f['flash'](_0x8e01d9(0x17d),'adjustment\x20data\x20update\x20successfully'),_0x4278c9[_0x8e01d9(0x139)]('/adjustment/view');}catch(_0x2499f4){console['log'](_0x2499f4);}}),router['post'](a0_0x15b9ed(0x18a),async(_0x27c6d0,_0x39b374)=>{var _0x2b7ac4=a0_0x15b9ed;const {primary_code:_0x3af2c0,warehouse_data:_0x8ae848,rooms_data:_0x5b00a2,Roomslist:_0x45e3a3}=_0x27c6d0['body'],_0x16faeb=_0x45e3a3['split'](','),_0x24bfad=[];async function _0x28c555(_0x5515db){var _0x40854b=a0_0x272e;const _0x532832=await warehouse[_0x40854b(0x1fe)]([{'$match':{'name':_0x8ae848,'room':_0x5515db}},{'$unwind':_0x40854b(0x1e6)},{'$match':{'product_details.primary_code':_0x3af2c0}},{'$group':{'_id':_0x40854b(0x1ee),'name':{'$first':_0x40854b(0x195)},'product_stock':{'$first':_0x40854b(0x1ab)},'primary_code':{'$first':_0x40854b(0x1c7)},'secondary_code':{'$first':_0x40854b(0x1b4)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x40854b(0x163)},'isle':{'$first':_0x40854b(0x198)},'type':{'$first':_0x40854b(0x1b8)},'pallet':{'$first':_0x40854b(0x1e1)},'unit':{'$first':_0x40854b(0x16d)},'secondary_unit':{'$first':_0x40854b(0x13d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x40854b(0x17a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x40854b(0x161)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x40854b(0x14d)},'product_cat':{'$first':_0x40854b(0x1ca)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x40854b(0x157)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x54ce65=await warehouse[_0x40854b(0x1fe)]([{'$match':{'name':_0x8ae848,'room':_0x5515db}},{'$unwind':_0x40854b(0x1e6)},{'$match':{'product_details.secondary_code':_0x3af2c0}},{'$group':{'_id':_0x40854b(0x1ee),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x40854b(0x1ab)},'primary_code':{'$first':_0x40854b(0x1c7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x40854b(0x140)},'level':{'$first':_0x40854b(0x163)},'isle':{'$first':_0x40854b(0x198)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x40854b(0x1e1)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x40854b(0x13d)},'storage':{'$first':_0x40854b(0x209)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x40854b(0x154)},'production_date':{'$first':_0x40854b(0x161)},'maxPerUnit':{'$first':_0x40854b(0x15c)},'batch_code':{'$first':_0x40854b(0x14d)},'product_cat':{'$first':_0x40854b(0x1ca)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x40854b(0x157)}}}]);if(_0x532832[_0x40854b(0x172)]>0x0)_0x24bfad[_0x40854b(0x202)](_0x532832);else _0x54ce65['length']>0x0&&_0x24bfad[_0x40854b(0x202)](_0x54ce65);}const _0x2d8727=_0x16faeb[_0x2b7ac4(0x175)](_0x3c4aea=>_0x28c555(_0x3c4aea));await Promise['all'](_0x2d8727),_0x39b374[_0x2b7ac4(0x159)](_0x24bfad);}),router[a0_0x15b9ed(0x13a)](a0_0x15b9ed(0x1a3),async(_0x3012b9,_0x3e98bc)=>{var _0x59f225=a0_0x15b9ed;const {primaryCode:_0x17181c,secondaryCode:_0x2fad36,productCode:_0x3cf6d1,level:_0x52326a,isle:_0x3932bf,pallet:_0x41ae4a,warehouses:_0x466708,room:_0x261ffe}=_0x3012b9['body'];try{const _0x3d441f=await warehouse[_0x59f225(0x1fe)]([{'$match':{'name':_0x466708,'room':_0x261ffe}},{'$unwind':_0x59f225(0x1e6)},{'$match':{'product_details.level':parseInt(_0x52326a),'product_details.isle':_0x3932bf,'product_details.pallet':parseInt(_0x41ae4a)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x59f225(0x1ab)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x59f225(0x176)},'maxProducts':{'$first':_0x59f225(0x146)}}}]);_0x3e98bc[_0x59f225(0x19a)](0xc8)[_0x59f225(0x159)](_0x3d441f);}catch(_0x252781){_0x3e98bc[_0x59f225(0x19a)](0x194)[_0x59f225(0x159)]({'message':_0x252781[_0x59f225(0x148)]});}}),module[a0_0x15b9ed(0x14c)]=router;