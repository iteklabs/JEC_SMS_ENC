var a0_0x19bc4b=a0_0x262b;function a0_0x262b(_0x35987a,_0x36d40e){var _0x3c24fd=a0_0x3c24();return a0_0x262b=function(_0x262ba6,_0x119d0c){_0x262ba6=_0x262ba6-0xc3;var _0xa2012a=_0x3c24fd[_0x262ba6];return _0xa2012a;},a0_0x262b(_0x35987a,_0x36d40e);}(function(_0x111879,_0x569c49){var _0x151661=a0_0x262b,_0x1bcb38=_0x111879();while(!![]){try{var _0x328356=parseInt(_0x151661(0xc4))/0x1*(-parseInt(_0x151661(0xf2))/0x2)+-parseInt(_0x151661(0xea))/0x3+-parseInt(_0x151661(0xe8))/0x4+parseInt(_0x151661(0x13d))/0x5*(parseInt(_0x151661(0xcf))/0x6)+-parseInt(_0x151661(0xdc))/0x7+parseInt(_0x151661(0x148))/0x8*(parseInt(_0x151661(0xc6))/0x9)+parseInt(_0x151661(0x16e))/0xa*(parseInt(_0x151661(0xe7))/0xb);if(_0x328356===_0x569c49)break;else _0x1bcb38['push'](_0x1bcb38['shift']());}catch(_0x269b5a){_0x1bcb38['push'](_0x1bcb38['shift']());}}}(a0_0x3c24,0x2f28f));const express=require(a0_0x19bc4b(0xf3)),app=express(),router=express['Router'](),auth=require(a0_0x19bc4b(0x10f)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x19bc4b(0xf0)),users=require(a0_0x19bc4b(0x14d)),nodemailer=require(a0_0x19bc4b(0x15e));router[a0_0x19bc4b(0xe6)](a0_0x19bc4b(0x172),auth,async(_0x482292,_0x297f04)=>{var _0x3e575f=a0_0x19bc4b;try{const {username:_0x257a1a,email:_0xcc5824,role:_0x179c33}=_0x482292[_0x3e575f(0x11c)],_0x3c065f=_0x482292[_0x3e575f(0x11c)],_0x3821ad=await profile[_0x3e575f(0x14b)]({'email':_0x3c065f[_0x3e575f(0x199)]}),_0x23754f=await master_shop[_0x3e575f(0x182)]();console[_0x3e575f(0x110)]('master',_0x23754f);let _0x23102a;if(_0x3c065f[_0x3e575f(0x159)]==_0x3e575f(0x150)){const _0x26aab3=await staff['findOne']({'email':_0x3c065f[_0x3e575f(0x199)]});_0x23102a=await warehouse[_0x3e575f(0x182)]({'status':'Enabled','name':_0x26aab3['warehouse']});}else _0x23102a=await warehouse[_0x3e575f(0x182)]({'status':_0x3e575f(0x174)});const _0x117d19=await product[_0x3e575f(0x182)]();let _0x5b8cac;if(_0x3c065f[_0x3e575f(0x159)]==_0x3e575f(0x150)){const _0x264862=await staff[_0x3e575f(0x14b)]({'email':_0x3c065f[_0x3e575f(0x199)]});_0x5b8cac=await adjustment[_0x3e575f(0x182)]({'warehouse_name':_0x264862[_0x3e575f(0xda)]});}else _0x5b8cac=await adjustment[_0x3e575f(0x111)]([{'$unwind':_0x3e575f(0x108)},{'$group':{'_id':_0x3e575f(0xd0),'invoice':{'$first':_0x3e575f(0x117)},'date':{'$first':_0x3e575f(0xd4)},'warehouse_name':{'$first':_0x3e575f(0x13f)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x3e575f(0x109)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x23754f[0x0][_0x3e575f(0x17f)]==_0x3e575f(0xf8)){var _0x538f1f=users[_0x3e575f(0x178)];console[_0x3e575f(0x110)](_0x538f1f);}else{if(_0x23754f[0x0][_0x3e575f(0x17f)]==_0x3e575f(0x18d))var _0x538f1f=users[_0x3e575f(0x18d)];else{if(_0x23754f[0x0][_0x3e575f(0x17f)]=='German')var _0x538f1f=users[_0x3e575f(0x120)];else{if(_0x23754f[0x0]['language']==_0x3e575f(0x14e))var _0x538f1f=users[_0x3e575f(0x14e)];else{if(_0x23754f[0x0]['language']=='French')var _0x538f1f=users['French'];else{if(_0x23754f[0x0][_0x3e575f(0x17f)]==_0x3e575f(0x145))var _0x538f1f=users[_0x3e575f(0x128)];else{if(_0x23754f[0x0][_0x3e575f(0x17f)]==_0x3e575f(0x10d))var _0x538f1f=users[_0x3e575f(0x10d)];else{if(_0x23754f[0x0][_0x3e575f(0x17f)]=='Arabic\x20(ae)')var _0x538f1f=users[_0x3e575f(0x14a)];}}}}}}}_0x297f04[_0x3e575f(0xe9)](_0x3e575f(0x129),{'success':_0x482292[_0x3e575f(0x18e)](_0x3e575f(0x197)),'errors':_0x482292['flash'](_0x3e575f(0x198)),'role':_0x3c065f,'profile':_0x3821ad,'warehouse':_0x23102a,'product':_0x117d19,'adjustment':_0x5b8cac,'master_shop':_0x23754f,'language':_0x538f1f});}catch(_0x29515c){console[_0x3e575f(0x110)](_0x29515c);}});async function getRandom8DigitNumber(){var _0x47cc0d=a0_0x19bc4b;const _0x16eca7=0x989680,_0x5094fc=0x5f5e0ff,_0x1f1a82=Math[_0x47cc0d(0x179)](Math[_0x47cc0d(0x187)]()*(_0x5094fc-_0x16eca7+0x1))+_0x16eca7;var _0x9f7faa;const _0x4335a2=await adjustment[_0x47cc0d(0x14b)]({'invoice':'ADJ-'+_0x1f1a82});return _0x4335a2&&_0x4335a2[_0x47cc0d(0xe5)]>0x0?_0x9f7faa='ADJ-'+_0x1f1a82:_0x9f7faa=_0x47cc0d(0x195)+_0x1f1a82,_0x9f7faa;}router[a0_0x19bc4b(0xe6)](a0_0x19bc4b(0xe1),auth,async(_0x2ddfda,_0xffccb0)=>{var _0x131051=a0_0x19bc4b;try{const {username:_0x2650b1,email:_0x2fa6b1,role:_0x3ec002}=_0x2ddfda[_0x131051(0x11c)],_0x85f497=_0x2ddfda[_0x131051(0x11c)],_0x56303a=await profile[_0x131051(0x14b)]({'email':_0x85f497[_0x131051(0x199)]}),_0x2f8fc0=await master_shop[_0x131051(0x182)]();let _0x5f0dd3;if(_0x85f497[_0x131051(0x159)]=='staff'){const _0x1c602e=await staff[_0x131051(0x14b)]({'email':_0x85f497['email']});_0x5f0dd3=await warehouse[_0x131051(0x111)]([{'$match':{'status':_0x131051(0x174),'name':_0x1c602e[_0x131051(0xda)],'warehouse_category':_0x131051(0x10e),'name':{'$ne':_0x131051(0x10c)}}},{'$group':{'_id':_0x131051(0x171),'name':{'$first':_0x131051(0x171)}}}]);}else _0x5f0dd3=await warehouse[_0x131051(0x111)]([{'$match':{'status':_0x131051(0x174),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x131051(0x10c)}}},{'$group':{'_id':'$name','name':{'$first':_0x131051(0x171)}}}]);const _0x106451=await product[_0x131051(0x182)]({}),_0x39231a=await adjustment[_0x131051(0x182)]({}),_0x38dc89=_0x39231a['length']+0x1,_0x54fb3c='ADJ-'+_0x38dc89[_0x131051(0x188)]()[_0x131051(0xc5)](0x5,'0');var _0x4fcba8=[_0x131051(0xc3),'Enclosed',_0x131051(0x155)];if(_0x2f8fc0[0x0][_0x131051(0x17f)]==_0x131051(0xf8))var _0x56eb77=users['English'];else{if(_0x2f8fc0[0x0][_0x131051(0x17f)]==_0x131051(0x18d))var _0x56eb77=users[_0x131051(0x18d)];else{if(_0x2f8fc0[0x0][_0x131051(0x17f)]==_0x131051(0x120))var _0x56eb77=users[_0x131051(0x120)];else{if(_0x2f8fc0[0x0][_0x131051(0x17f)]==_0x131051(0x14e))var _0x56eb77=users[_0x131051(0x14e)];else{if(_0x2f8fc0[0x0][_0x131051(0x17f)]==_0x131051(0x149))var _0x56eb77=users[_0x131051(0x149)];else{if(_0x2f8fc0[0x0]['language']==_0x131051(0x145))var _0x56eb77=users['Portuguese'];else{if(_0x2f8fc0[0x0][_0x131051(0x17f)]=='Chinese')var _0x56eb77=users[_0x131051(0x10d)];else{if(_0x2f8fc0[0x0][_0x131051(0x17f)]=='Arabic\x20(ae)')var _0x56eb77=users['Arabic'];}}}}}}}const _0x73d8a=getRandom8DigitNumber();_0x73d8a[_0x131051(0x151)](_0x4e1e3d=>{var _0x30f4cb=_0x131051;_0xffccb0['render'](_0x30f4cb(0x144),{'success':_0x2ddfda[_0x30f4cb(0x18e)]('success'),'errors':_0x2ddfda[_0x30f4cb(0x18e)](_0x30f4cb(0x198)),'role':_0x85f497,'profile':_0x56303a,'warehouse':_0x5f0dd3,'product':_0x106451,'master_shop':_0x2f8fc0,'language':_0x56eb77,'rooms_data':_0x4fcba8,'invoice_no':_0x4e1e3d});})['catch'](_0x78c6f9=>{var _0x2fcbab=_0x131051;_0x2ddfda['flash'](_0x2fcbab(0x198),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0xffccb0[_0x2fcbab(0xd7)](_0x2fcbab(0x190));});}catch(_0x1d2c45){console[_0x131051(0x110)](_0x1d2c45);}}),router[a0_0x19bc4b(0x192)]('/view/add_adjustment',auth,async(_0x4e0039,_0x2297c3)=>{var _0x599f4c=a0_0x19bc4b;try{const {warehouse_name:_0x163a27,date:_0x322191,prod_name:_0x17e946,level:_0x2ab3e7,isle:_0x22d632,pallet:_0x20f335,stock:_0x36ef46,types:_0x21f0f5,adjust_qty:_0x52517b,new_adjust_qty:_0x450600,note:_0x2c9677,Room_name:_0x31e2c9,invoice:_0x2e09ed,JO_number:_0x1cc95f,expiry_date:_0x260c52}=_0x4e0039[_0x599f4c(0x123)];if(typeof _0x17e946==_0x599f4c(0x115))var _0x4e84a9=[_0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x16f)]],_0x690932=[_0x4e0039['body'][_0x599f4c(0x140)]],_0x49e0f4=[_0x4e0039[_0x599f4c(0x123)][_0x599f4c(0xd6)]],_0x438ee7=[_0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x17c)]],_0x4f1d24=[_0x4e0039['body']['New_Qty_Converted_adj']],_0x515164=[_0x4e0039['body']['New_Qty_Converted']],_0x5c4e1a=[_0x4e0039[_0x599f4c(0x123)]['Primary_Units']],_0x39a9e8=[_0x4e0039[_0x599f4c(0x123)]['Secondary_units']],_0xc0a4e4=[_0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x191)]],_0x109964=[_0x4e0039[_0x599f4c(0x123)][_0x599f4c(0xeb)]],_0x1f0662=[_0x4e0039[_0x599f4c(0x123)]['expiry_date']],_0x4dbade=[_0x4e0039['body'][_0x599f4c(0x17e)]],_0x59e1ec=[_0x4e0039[_0x599f4c(0x123)]['production_date']],_0x51b304=[_0x4e0039[_0x599f4c(0x123)][_0x599f4c(0xdf)]],_0x48003f=[_0x4e0039[_0x599f4c(0x123)]['Rooms']],_0x1bbebc=[_0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x13a)]],_0x20b92c=[_0x4e0039[_0x599f4c(0x123)]['second1']],_0x595502=[_0x4e0039['body'][_0x599f4c(0x189)]],_0x3ec9f5=[_0x4e0039['body'][_0x599f4c(0xf5)]];else var _0x4e84a9=[..._0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x16f)]],_0x690932=[..._0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x140)]],_0x49e0f4=[..._0x4e0039[_0x599f4c(0x123)]['stock']],_0x438ee7=[..._0x4e0039[_0x599f4c(0x123)]['types']],_0x4f1d24=[..._0x4e0039[_0x599f4c(0x123)]['New_Qty_Converted_adj']],_0x515164=[..._0x4e0039[_0x599f4c(0x123)]['New_Qty_Converted']],_0x5c4e1a=[..._0x4e0039[_0x599f4c(0x123)]['unit']],_0x39a9e8=[..._0x4e0039[_0x599f4c(0x123)]['Secondary_units']],_0xc0a4e4=[..._0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x191)]],_0x109964=[..._0x4e0039[_0x599f4c(0x123)][_0x599f4c(0xeb)]],_0x1f0662=[..._0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x114)]],_0x4dbade=[..._0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x17e)]],_0x59e1ec=[..._0x4e0039[_0x599f4c(0x123)][_0x599f4c(0x17d)]],_0x51b304=[..._0x4e0039[_0x599f4c(0x123)][_0x599f4c(0xdf)]],_0x48003f=[..._0x4e0039['body'][_0x599f4c(0x15b)]],_0x1bbebc=[..._0x4e0039[_0x599f4c(0x123)]['prime1']],_0x20b92c=[..._0x4e0039[_0x599f4c(0x123)][_0x599f4c(0xe0)]],_0x595502=[..._0x4e0039['body'][_0x599f4c(0x189)]],_0x3ec9f5=[..._0x4e0039[_0x599f4c(0x123)]['id_transaction']];const _0x2d3514=_0x4e84a9['map'](_0x230814=>{return _0x230814={'product_name':_0x230814};});_0x690932[_0x599f4c(0x113)]((_0x1de202,_0x3a21f0)=>{var _0x299943=_0x599f4c;_0x48003f[_0x299943(0x113)]((_0x4298cd,_0x29ac72)=>{var _0x163be4=_0x299943;if(_0x4298cd=='Receiving\x20Area'&&_0x3a21f0==_0x29ac72){var _0x577337=_0x1de202['slice'](0x3);_0x2d3514[_0x3a21f0]['storage']=_0x1de202[0x0],_0x2d3514[_0x3a21f0][_0x163be4(0x184)]=_0x1de202[0x1],_0x2d3514[_0x3a21f0][_0x163be4(0x12a)]=0x0,_0x2d3514[_0x3a21f0][_0x163be4(0x141)]=0x0,_0x2d3514[_0x3a21f0]['type']=_0x163be4(0x143),_0x2d3514[_0x3a21f0][_0x163be4(0xdd)]=_0x577337;}else{if(_0x4298cd=='Shelves'&&_0x3a21f0==_0x29ac72){var _0x577337=_0x1de202[_0x163be4(0x12f)](0x3);_0x2d3514[_0x3a21f0][_0x163be4(0x101)]=_0x1de202[0x0],_0x2d3514[_0x3a21f0][_0x163be4(0x184)]=_0x1de202[0x1],_0x2d3514[_0x3a21f0][_0x163be4(0x12a)]=0x0,_0x2d3514[_0x3a21f0]['bin']=0x0,_0x2d3514[_0x3a21f0][_0x163be4(0x102)]=_0x163be4(0x143),_0x2d3514[_0x3a21f0][_0x163be4(0xdd)]=_0x1de202[0x5];}else{if(_0x3a21f0==_0x29ac72){var _0x1ada74;if(_0x1de202[0x4]=='L')_0x1ada74='Level';else _0x1de202[0x4]=='F'&&(_0x1ada74=_0x163be4(0x143));_0x2d3514[_0x3a21f0]['storage']=_0x1de202[0x0],_0x2d3514[_0x3a21f0][_0x163be4(0x184)]=_0x1de202[0x1],_0x2d3514[_0x3a21f0][_0x163be4(0x12a)]=_0x1de202[0x2],_0x2d3514[_0x3a21f0][_0x163be4(0x141)]=_0x1de202[0x3],_0x2d3514[_0x3a21f0][_0x163be4(0x102)]=_0x1ada74,_0x2d3514[_0x3a21f0]['floorlevel']=_0x1de202[0x5];}}}});}),_0x49e0f4[_0x599f4c(0x113)]((_0x13e9b6,_0x423d2e)=>{var _0x191f27=_0x599f4c;_0x2d3514[_0x423d2e][_0x191f27(0x125)]=_0x13e9b6;}),_0x3ec9f5[_0x599f4c(0x113)]((_0x53b72d,_0x157e73)=>{var _0x1d9437=_0x599f4c;_0x2d3514[_0x157e73][_0x1d9437(0x112)]=_0x53b72d;}),_0x438ee7[_0x599f4c(0x113)]((_0x528b1f,_0x1661bd)=>{var _0xabf077=_0x599f4c;_0x2d3514[_0x1661bd][_0xabf077(0x17c)]=_0x528b1f;}),_0x4f1d24[_0x599f4c(0x113)]((_0x3e4d09,_0x1bdece)=>{var _0x10d39e=_0x599f4c;_0x2d3514[_0x1bdece][_0x10d39e(0x12c)]=_0x3e4d09;}),_0x515164[_0x599f4c(0x113)]((_0x16cae9,_0x4ab2a9)=>{_0x2d3514[_0x4ab2a9]['new_adjust_qty']=_0x16cae9;}),_0x5c4e1a[_0x599f4c(0x113)]((_0x224b99,_0x432743)=>{var _0x43a645=_0x599f4c;_0x2d3514[_0x432743][_0x43a645(0xe4)]=_0x224b99;}),_0x39a9e8['forEach']((_0xcb776b,_0x2fb058)=>{var _0x1b9b2a=_0x599f4c;_0x2d3514[_0x2fb058][_0x1b9b2a(0xee)]=_0xcb776b;}),_0xc0a4e4[_0x599f4c(0x113)]((_0x132ddc,_0x6ddf3a)=>{var _0x57c116=_0x599f4c;_0x2d3514[_0x6ddf3a][_0x57c116(0x135)]=_0x132ddc;}),_0x109964[_0x599f4c(0x113)]((_0x5afd1a,_0x568626)=>{var _0x558cc8=_0x599f4c;_0x2d3514[_0x568626][_0x558cc8(0xeb)]=_0x5afd1a;}),_0x1f0662[_0x599f4c(0x113)]((_0x4d4359,_0x30f9e0)=>{var _0x1e017a=_0x599f4c;_0x2d3514[_0x30f9e0][_0x1e017a(0x114)]=_0x4d4359;}),_0x4dbade[_0x599f4c(0x113)]((_0x294b9e,_0x45f30d)=>{var _0x181583=_0x599f4c;_0x2d3514[_0x45f30d][_0x181583(0x134)]=_0x294b9e;}),_0x59e1ec[_0x599f4c(0x113)]((_0x430c22,_0x53dcd0)=>{var _0x4850d0=_0x599f4c;_0x2d3514[_0x53dcd0][_0x4850d0(0x17d)]=_0x430c22;}),_0x51b304['forEach']((_0xcad302,_0x2e6d40)=>{var _0x224cd4=_0x599f4c;_0x2d3514[_0x2e6d40][_0x224cd4(0xdf)]=_0xcad302;}),_0x48003f[_0x599f4c(0x113)]((_0xbf02d,_0x239670)=>{var _0x366767=_0x599f4c;_0x2d3514[_0x239670][_0x366767(0xc8)]=_0xbf02d;}),_0x1bbebc['forEach']((_0x34c121,_0x4dd267)=>{_0x2d3514[_0x4dd267]['primary_code']=_0x34c121;}),_0x20b92c[_0x599f4c(0x113)]((_0x2d4587,_0x51e3d7)=>{_0x2d3514[_0x51e3d7]['secondary_code']=_0x2d4587;}),_0x595502[_0x599f4c(0x113)]((_0x5db795,_0x1c434e)=>{var _0x3b4697=_0x599f4c;_0x2d3514[_0x1c434e][_0x3b4697(0xc7)]=_0x5db795;});const _0x5edcb1=_0x2d3514[_0x599f4c(0xde)](_0x100cbd=>_0x100cbd['adjust_qty']!=='0'&&_0x100cbd[_0x599f4c(0x12c)]!=='');var _0x2c0621=0x0;_0x5edcb1[_0x599f4c(0x113)](_0x50b9b3=>{var _0x34c3c3=_0x599f4c;console[_0x34c3c3(0x110)](_0x34c3c3(0xcd),_0x50b9b3),parseInt(_0x50b9b3[_0x34c3c3(0x12c)])<=0x0&&_0x2c0621++;});if(_0x2c0621!=0x0)return _0x4e0039[_0x599f4c(0x18e)](_0x599f4c(0x198),_0x599f4c(0xf1)),_0x2297c3[_0x599f4c(0xd7)](_0x599f4c(0x165));const _0x332ea2=new adjustment({'warehouse_name':_0x163a27,'date':_0x322191,'product':_0x5edcb1,'note':_0x2c9677,'room':_0x31e2c9,'invoice':_0x2e09ed,'JO_number':_0x1cc95f,'expiry_date':_0x260c52}),_0x7cdfe0=await _0x332ea2['save']();_0x4e0039['flash'](_0x599f4c(0x197),_0x599f4c(0xd1)),_0x2297c3[_0x599f4c(0xd7)](_0x599f4c(0x164)+_0x7cdfe0[_0x599f4c(0x131)]);}catch(_0x38b822){console[_0x599f4c(0x110)](_0x38b822),_0x2297c3['status'](0xc8)[_0x599f4c(0x18c)]({'message':_0x38b822[_0x599f4c(0x133)]});}}),router['get']('/preview/:id',auth,async(_0x21d759,_0x38fe46)=>{var _0x3cbdc8=a0_0x19bc4b;try{const {username:_0x470f51,email:_0x44fde2,role:_0x62a2a6}=_0x21d759[_0x3cbdc8(0x11c)],_0x1e1a02=_0x21d759[_0x3cbdc8(0x11c)],_0x512a00=await profile[_0x3cbdc8(0x14b)]({'email':_0x1e1a02[_0x3cbdc8(0x199)]}),_0x22530b=await master_shop[_0x3cbdc8(0x182)](),_0x86b60e=_0x21d759[_0x3cbdc8(0x15d)]['id'],_0x40d717=await adjustment[_0x3cbdc8(0x180)]({'_id':_0x86b60e}),_0x2aee2f=await purchases[_0x3cbdc8(0x111)]([{'$match':{'warehouse_name':_0x40d717[_0x3cbdc8(0x11b)]}},{'$unwind':_0x3cbdc8(0x108)},{'$group':{'_id':_0x3cbdc8(0x12d)}}]),_0x10f203=await product[_0x3cbdc8(0x182)]({}),_0x199880=await warehouse['aggregate']([{'$match':{'name':_0x40d717[_0x3cbdc8(0x11b)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3cbdc8(0x119),'name':{'$first':_0x3cbdc8(0x11e)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3cbdc8(0x16d)},'bin':{'$first':_0x3cbdc8(0x118)},'type':{'$first':_0x3cbdc8(0xe3)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3cbdc8(0x137)},'storage':{'$first':_0x3cbdc8(0x12b)},'rack':{'$first':_0x3cbdc8(0x152)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3cbdc8(0xe2)},'batch_code':{'$first':_0x3cbdc8(0xef)},'room':{'$first':_0x3cbdc8(0xff)}}}]);if(_0x22530b[0x0][_0x3cbdc8(0x17f)]==_0x3cbdc8(0xf8)){var _0x4289f7=users['English'];console[_0x3cbdc8(0x110)](_0x4289f7);}else{if(_0x22530b[0x0][_0x3cbdc8(0x17f)]==_0x3cbdc8(0x18d))var _0x4289f7=users[_0x3cbdc8(0x18d)];else{if(_0x22530b[0x0][_0x3cbdc8(0x17f)]=='German')var _0x4289f7=users[_0x3cbdc8(0x120)];else{if(_0x22530b[0x0][_0x3cbdc8(0x17f)]==_0x3cbdc8(0x14e))var _0x4289f7=users['Spanish'];else{if(_0x22530b[0x0][_0x3cbdc8(0x17f)]==_0x3cbdc8(0x149))var _0x4289f7=users['French'];else{if(_0x22530b[0x0][_0x3cbdc8(0x17f)]==_0x3cbdc8(0x145))var _0x4289f7=users[_0x3cbdc8(0x128)];else{if(_0x22530b[0x0][_0x3cbdc8(0x17f)]==_0x3cbdc8(0x10d))var _0x4289f7=users[_0x3cbdc8(0x10d)];else{if(_0x22530b[0x0]['language']==_0x3cbdc8(0x17a))var _0x4289f7=users['Arabic'];}}}}}}}_0x38fe46['render'](_0x3cbdc8(0xce),{'success':_0x21d759[_0x3cbdc8(0x18e)](_0x3cbdc8(0x197)),'errors':_0x21d759[_0x3cbdc8(0x18e)](_0x3cbdc8(0x198)),'role':_0x1e1a02,'profile':_0x512a00,'adjustment':_0x40d717,'stock':_0x199880,'master_shop':_0x22530b,'warehouse_name':_0x2aee2f,'unit':_0x10f203,'language':_0x4289f7});}catch(_0x2cf375){console[_0x3cbdc8(0x110)](_0x2cf375),_0x38fe46[_0x3cbdc8(0x124)](0xc8)['json']({'message':_0x2cf375[_0x3cbdc8(0x133)]});}}),router[a0_0x19bc4b(0x192)]('/preview/:id',auth,async(_0x47315a,_0xe53a6e)=>{var _0x540e34=a0_0x19bc4b;try{const _0x481353=_0x47315a[_0x540e34(0x15d)]['id'],{warehouse_name:_0x2c5ae7,Room_name:_0x3607c5}=_0x47315a[_0x540e34(0x123)],_0x19ce17=await adjustment[_0x540e34(0x180)]({'_id':_0x481353}),_0x2395a7=_0x19ce17[_0x540e34(0x196)][_0x540e34(0x16b)](async _0x4629f0=>{var _0x5e41f3=_0x540e34;if(_0x4629f0[_0x5e41f3(0x12c)]>0x0){var _0x56eb1b=await warehouse[_0x5e41f3(0x14b)]({'name':_0x2c5ae7,'room':_0x4629f0[_0x5e41f3(0xc8)],'warehouse_category':_0x5e41f3(0x10e)});const _0x162e69=_0x56eb1b[_0x5e41f3(0x116)][_0x5e41f3(0x16b)](_0x42e96b=>{var _0x351b93=_0x5e41f3;console[_0x351b93(0x110)](_0x4629f0[_0x351b93(0x17c)]+_0x351b93(0x16c));if(_0x4629f0[_0x351b93(0x17c)]==_0x351b93(0xf7)){if(_0x42e96b[_0x351b93(0x156)]==_0x4629f0[_0x351b93(0x156)]&&_0x42e96b['floorlevel']==_0x4629f0[_0x351b93(0xdd)]&&_0x42e96b[_0x351b93(0x102)]==_0x4629f0['type']&&_0x42e96b['bin']==_0x4629f0[_0x351b93(0x141)]&&_0x42e96b[_0x351b93(0x12a)]==_0x4629f0['bay']&&_0x42e96b[_0x351b93(0x184)]==_0x4629f0[_0x351b93(0x184)]&&_0x42e96b[_0x351b93(0x101)]==_0x4629f0[_0x351b93(0x101)]&&_0x42e96b[_0x351b93(0x114)]==_0x4629f0[_0x351b93(0x114)]&&_0x42e96b['batch_code']==_0x4629f0[_0x351b93(0xeb)]&&_0x42e96b[_0x351b93(0x17d)]==_0x4629f0[_0x351b93(0x17d)]&&_0x42e96b[_0x351b93(0xc7)]==_0x4629f0[_0x351b93(0xc7)]&&_0x42e96b['_id']==_0x4629f0[_0x351b93(0x112)]){var _0x5f0102;_0x5f0102=_0x4629f0[_0x351b93(0x12c)],_0x4629f0[_0x351b93(0xdf)]=='S'&&(_0x5f0102=_0x4629f0['adjust_qty']),_0x42e96b[_0x351b93(0xf9)]=_0x42e96b[_0x351b93(0xf9)]-_0x5f0102;}}else{if(_0x42e96b[_0x351b93(0x156)]==_0x4629f0[_0x351b93(0x156)]&&_0x42e96b[_0x351b93(0xdd)]==_0x4629f0[_0x351b93(0xdd)]&&_0x42e96b[_0x351b93(0x102)]==_0x4629f0[_0x351b93(0x102)]&&_0x42e96b['bin']==_0x4629f0[_0x351b93(0x141)]&&_0x42e96b[_0x351b93(0x12a)]==_0x4629f0['bay']&&_0x42e96b[_0x351b93(0x184)]==_0x4629f0[_0x351b93(0x184)]&&_0x42e96b[_0x351b93(0x101)]==_0x4629f0[_0x351b93(0x101)]&&_0x42e96b[_0x351b93(0x114)]==_0x4629f0[_0x351b93(0x114)]&&_0x42e96b[_0x351b93(0xeb)]==_0x4629f0[_0x351b93(0xeb)]&&_0x42e96b[_0x351b93(0x17d)]==_0x4629f0[_0x351b93(0x17d)]&&_0x42e96b[_0x351b93(0xc7)]==_0x4629f0['invoice']&&_0x42e96b[_0x351b93(0x131)]==_0x4629f0[_0x351b93(0x112)]){console[_0x351b93(0x110)](_0x4629f0);var _0x5f0102;_0x5f0102=_0x4629f0[_0x351b93(0x12c)],_0x4629f0[_0x351b93(0xdf)]=='S'&&(_0x5f0102=_0x4629f0[_0x351b93(0x12c)]),_0x42e96b[_0x351b93(0xf9)]=_0x42e96b['product_stock']+_0x5f0102;}}});}return _0x56eb1b;});Promise[_0x540e34(0x12e)](_0x2395a7)[_0x540e34(0x151)](async _0x515e40=>{var _0x44ec6c=_0x540e34;try{for(const _0xb67f2e of _0x515e40){await _0xb67f2e[_0x44ec6c(0x130)]();}_0x19ce17['finalize']=_0x44ec6c(0x14c);const _0xddd086=await _0x19ce17[_0x44ec6c(0x130)](),_0xf0ac83=await master_shop[_0x44ec6c(0x182)](),_0x4bec4f=await email_settings['findOne'](),_0x1ca267=await supervisor_settings['find']();var _0x507469=_0x19ce17['product'],_0x1fbfd5='',_0x54ed66;for(_0x54ed66 in _0x507469){_0x1fbfd5+='<tr>'+_0x44ec6c(0x10b)+_0x507469[_0x54ed66][_0x44ec6c(0x156)]+'</td>'+_0x44ec6c(0x10b)+_0x507469[_0x54ed66]['product_code']+_0x44ec6c(0x185)+_0x44ec6c(0x10b)+_0x507469[_0x54ed66][_0x44ec6c(0x12c)]+_0x44ec6c(0x185)+_0x44ec6c(0x10b)+_0x507469[_0x54ed66][_0x44ec6c(0xe4)]+'</td>'+_0x44ec6c(0x10b)+_0x507469[_0x54ed66][_0x44ec6c(0xee)]+_0x44ec6c(0x185)+_0x44ec6c(0x10b)+_0x19ce17[_0x44ec6c(0x11b)]+_0x44ec6c(0x185)+_0x44ec6c(0x10b)+_0x507469[_0x54ed66]['room_names']+_0x44ec6c(0x185)+_0x44ec6c(0x10b)+_0x507469[_0x54ed66]['storage']+_0x507469[_0x54ed66][_0x44ec6c(0x184)]+_0x507469[_0x54ed66]['bay']+_0x507469[_0x54ed66][_0x44ec6c(0x141)]+_0x507469[_0x54ed66][_0x44ec6c(0x102)][0x0]+_0x507469[_0x54ed66][_0x44ec6c(0xdd)]+_0x44ec6c(0x185),_0x44ec6c(0x175);}let _0x51aa3f=nodemailer[_0x44ec6c(0x16a)]({'host':_0x4bec4f[_0x44ec6c(0x166)],'port':Number(_0x4bec4f[_0x44ec6c(0x132)]),'secure':![],'auth':{'user':_0x4bec4f[_0x44ec6c(0x199)],'pass':_0x4bec4f[_0x44ec6c(0x13e)]}}),_0x2d50cb={'from':_0x4bec4f[_0x44ec6c(0x199)],'to':_0x1ca267[0x0][_0x44ec6c(0xfe)],'subject':'Adjustment\x20Mail','attachments':[{'filename':_0x44ec6c(0x167),'path':__dirname+_0x44ec6c(0x158)+_0x44ec6c(0x11f)+_0xf0ac83[0x0]['image'],'cid':_0x44ec6c(0x163)}],'html':_0x44ec6c(0x18a)+'<html><head><title></title>'+_0x44ec6c(0x10a)+_0x44ec6c(0xf6)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x44ec6c(0xf6)+_0x44ec6c(0x121)+_0x44ec6c(0xfb)+_0x44ec6c(0xf6)+_0x44ec6c(0x15f)+_0xf0ac83[0x0][_0x44ec6c(0x11d)]+_0x44ec6c(0x176)+_0x44ec6c(0xfb)+_0x44ec6c(0xfb)+_0x44ec6c(0x147)+_0x44ec6c(0xf6)+_0x44ec6c(0x157)+_0x44ec6c(0xcb)+_0x19ce17[_0x44ec6c(0xc7)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x44ec6c(0x186)+_0x19ce17[_0x44ec6c(0x162)]+'\x20'+_0x44ec6c(0x177)+'</h5>'+_0x44ec6c(0xfb)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x44ec6c(0x15a)+_0x44ec6c(0x183)+_0x44ec6c(0x169)+_0x44ec6c(0x153)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x44ec6c(0x173)+_0x44ec6c(0x122)+_0x44ec6c(0xfd)+_0x44ec6c(0x175)+_0x44ec6c(0xec)+_0x44ec6c(0x106)+'\x20'+_0x1fbfd5+'\x20'+'</tbody>'+_0x44ec6c(0x18b)+_0x44ec6c(0xf6)+_0x44ec6c(0x13c)+'<h5>'+_0xf0ac83[0x0][_0x44ec6c(0x11d)]+'</h5>'+_0x44ec6c(0xfb)+_0x44ec6c(0xfb)+_0x44ec6c(0x103)};_0x51aa3f['sendMail'](_0x2d50cb,function(_0x449ac8,_0x100b5b){var _0x28ac6d=_0x44ec6c;_0x449ac8?(console[_0x28ac6d(0x110)](_0x449ac8),console[_0x28ac6d(0x110)](_0x28ac6d(0x11a))):console[_0x28ac6d(0x110)](_0x28ac6d(0xdb));}),_0x47315a[_0x44ec6c(0x18e)](_0x44ec6c(0x197),'adjustment\x20Finalized\x20successfully'),_0xe53a6e[_0x44ec6c(0xd7)](_0x44ec6c(0x17b)+_0xddd086[_0x44ec6c(0x131)]);}catch(_0xed1372){console[_0x44ec6c(0x136)](_0xed1372),_0xe53a6e['status'](0x1f4)[_0x44ec6c(0x18c)]({'error':_0x44ec6c(0x100)});}})['catch'](_0x1626e2=>{var _0x29005c=_0x540e34;console['error'](_0x1626e2),_0xe53a6e[_0x29005c(0x124)](0x1f4)[_0x29005c(0x18c)]({'error':'An\x20error\x20occurred.'});});}catch(_0x349eb2){console[_0x540e34(0x110)](_0x349eb2),_0xe53a6e[_0x540e34(0x124)](0xc8)['json']({'message':_0x349eb2['message']});}}),router[a0_0x19bc4b(0xe6)]('/view/:id',auth,async(_0x1213db,_0x1f426d)=>{var _0x5015fb=a0_0x19bc4b;try{const {username:_0x4f3932,email:_0x78b6a3,role:_0xe875a9}=_0x1213db[_0x5015fb(0x11c)],_0x172c0e=_0x1213db['user'],_0x3d9ef9=await profile[_0x5015fb(0x14b)]({'email':_0x172c0e['email']}),_0x1c63dc=await master_shop[_0x5015fb(0x182)](),_0xb6c954=_0x1213db[_0x5015fb(0x15d)]['id'],_0x38a364=await adjustment[_0x5015fb(0x180)]({'_id':_0xb6c954}),_0x2d4094=await purchases[_0x5015fb(0x111)]([{'$match':{'warehouse_name':_0x38a364['warehouse_name']}},{'$unwind':_0x5015fb(0x108)},{'$group':{'_id':_0x5015fb(0x12d)}}]),_0xdc709d=await product['find']({}),_0x306fbc=await warehouse[_0x5015fb(0x111)]([{'$match':{'name':_0x38a364[_0x5015fb(0x11b)]}},{'$unwind':_0x5015fb(0x139)},{'$group':{'_id':_0x5015fb(0x119),'name':{'$first':_0x5015fb(0x11e)},'product_stock':{'$first':_0x5015fb(0x127)},'bay':{'$first':_0x5015fb(0x16d)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5015fb(0xe3)},'floorlevel':{'$first':_0x5015fb(0xca)},'primary_code':{'$first':_0x5015fb(0x170)},'secondary_code':{'$first':_0x5015fb(0xd9)},'product_code':{'$first':_0x5015fb(0x137)},'storage':{'$first':_0x5015fb(0x12b)},'rack':{'$first':_0x5015fb(0x152)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x5015fb(0x104)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x5015fb(0xef)},'room':{'$first':_0x5015fb(0xff)}}}]);let _0x56452c;if(_0x172c0e[_0x5015fb(0x159)]=='staff'){const _0x13301c=await staff[_0x5015fb(0x14b)]({'email':_0x172c0e[_0x5015fb(0x199)]});_0x56452c=await warehouse['aggregate']([{'$match':{'status':_0x5015fb(0x174),'name':_0x13301c['warehouse'],'warehouse_category':_0x5015fb(0x10e),'name':{'$ne':_0x5015fb(0x10c)}}},{'$group':{'_id':_0x5015fb(0x171),'name':{'$first':_0x5015fb(0x171)}}}]);}else _0x56452c=await warehouse[_0x5015fb(0x111)]([{'$match':{'status':_0x5015fb(0x174),'warehouse_category':_0x5015fb(0x10e),'name':{'$ne':_0x5015fb(0x10c)}}},{'$group':{'_id':_0x5015fb(0x171),'name':{'$first':_0x5015fb(0x171)}}}]);if(_0x1c63dc[0x0][_0x5015fb(0x17f)]==_0x5015fb(0xf8)){var _0x4cafac=users[_0x5015fb(0x178)];console[_0x5015fb(0x110)](_0x4cafac);}else{if(_0x1c63dc[0x0][_0x5015fb(0x17f)]==_0x5015fb(0x18d))var _0x4cafac=users[_0x5015fb(0x18d)];else{if(_0x1c63dc[0x0][_0x5015fb(0x17f)]==_0x5015fb(0x120))var _0x4cafac=users['German'];else{if(_0x1c63dc[0x0]['language']==_0x5015fb(0x14e))var _0x4cafac=users['Spanish'];else{if(_0x1c63dc[0x0][_0x5015fb(0x17f)]==_0x5015fb(0x149))var _0x4cafac=users[_0x5015fb(0x149)];else{if(_0x1c63dc[0x0][_0x5015fb(0x17f)]==_0x5015fb(0x145))var _0x4cafac=users['Portuguese'];else{if(_0x1c63dc[0x0]['language']==_0x5015fb(0x10d))var _0x4cafac=users[_0x5015fb(0x10d)];else{if(_0x1c63dc[0x0][_0x5015fb(0x17f)]=='Arabic\x20(ae)')var _0x4cafac=users['Arabic'];}}}}}}}_0x1f426d['render'](_0x5015fb(0x154),{'success':_0x1213db[_0x5015fb(0x18e)]('success'),'errors':_0x1213db['flash']('errors'),'role':_0x172c0e,'profile':_0x3d9ef9,'adjustment':_0x38a364,'stock':_0x306fbc,'master_shop':_0x1c63dc,'warehouse_name':_0x2d4094,'unit':_0xdc709d,'language':_0x4cafac,'warehouse':_0x56452c});}catch(_0x2e21eb){console[_0x5015fb(0x110)](_0x2e21eb),_0x1f426d[_0x5015fb(0x124)](0xc8)['json']({'message':_0x2e21eb[_0x5015fb(0x133)]});}}),router['post']('/view/:id',auth,async(_0xca7200,_0x540ccd)=>{var _0x19d796=a0_0x19bc4b;try{const _0xd58357=_0xca7200[_0x19d796(0x15d)]['id'],_0x45fcae=await adjustment[_0x19d796(0x180)]({'_id':_0xd58357}),_0x2217f9=await warehouse[_0x19d796(0x14b)]({'name':_0x45fcae[_0x19d796(0x11b)],'room':_0x45fcae[_0x19d796(0x105)]}),{warehouse_name:_0x32518b,date:_0x3f860a,prod_name:_0x2e96b8,level:_0x546aec,isle:_0x5e49d5,pallet:_0x1427d7,stock:_0x9df5d2,types:_0x40dd4f,adjust_qty:_0x3470c1,new_adjust_qty:_0x40b868,note:_0x54f46f,Room_name:_0x2c6ad0,invoice:_0x1c1832,JO_number:_0x53839f,expiry_date:_0x268d39}=_0xca7200['body'];if(typeof _0x2e96b8==_0x19d796(0x115))var _0x20cf04=[_0xca7200[_0x19d796(0x123)]['prod_name']],_0x4c6d54=[_0xca7200['body'][_0x19d796(0x140)]],_0x3fcd32=[_0xca7200[_0x19d796(0x123)]['stock']],_0x42aee8=[_0xca7200[_0x19d796(0x123)][_0x19d796(0x17c)]],_0x5a90e4=[_0xca7200[_0x19d796(0x123)][_0x19d796(0xfa)]],_0x31815c=[_0xca7200[_0x19d796(0x123)][_0x19d796(0xd3)]],_0x405ce5=[_0xca7200['body'][_0x19d796(0x146)]],_0x541415=[_0xca7200[_0x19d796(0x123)]['Secondary_units']],_0x387832=[_0xca7200['body'][_0x19d796(0x191)]],_0x3c9548=[_0xca7200[_0x19d796(0x123)][_0x19d796(0xeb)]],_0x5dbe19=[_0xca7200[_0x19d796(0x123)][_0x19d796(0x114)]],_0x114ee6=[_0xca7200[_0x19d796(0x123)][_0x19d796(0x17e)]],_0xf35b68=[_0xca7200[_0x19d796(0x123)][_0x19d796(0x17d)]],_0x39fda6=[_0xca7200[_0x19d796(0x123)][_0x19d796(0xdf)]],_0x4126fe=[_0xca7200['body']['Rooms']],_0x1940d4=[_0xca7200[_0x19d796(0x123)]['prime1']],_0x214e56=[_0xca7200[_0x19d796(0x123)][_0x19d796(0xe0)]];else var _0x20cf04=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0x16f)]],_0x4c6d54=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0x140)]],_0x3fcd32=[..._0xca7200['body'][_0x19d796(0xd6)]],_0x42aee8=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0x17c)]],_0x5a90e4=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0xfa)]],_0x31815c=[..._0xca7200['body'][_0x19d796(0xd3)]],_0x405ce5=[..._0xca7200['body'][_0x19d796(0xe4)]],_0x541415=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0x193)]],_0x387832=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0x191)]],_0x3c9548=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0xeb)]],_0x5dbe19=[..._0xca7200[_0x19d796(0x123)]['expiry_date']],_0x114ee6=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0x17e)]],_0xf35b68=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0x17d)]],_0x39fda6=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0xdf)]],_0x4126fe=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0x15b)]],_0x1940d4=[..._0xca7200['body'][_0x19d796(0x13a)]],_0x214e56=[..._0xca7200[_0x19d796(0x123)][_0x19d796(0xe0)]];const _0x4a3401=_0x20cf04['map'](_0x3ed823=>{return _0x3ed823={'product_name':_0x3ed823};});_0x4c6d54[_0x19d796(0x113)]((_0x31e0c7,_0x1a12ee)=>{var _0x12352e=_0x19d796;_0x4126fe[_0x12352e(0x113)]((_0x4f4e91,_0x38d33e)=>{var _0x2e46df=_0x12352e;if(_0x4f4e91==_0x2e46df(0x181)&&_0x1a12ee==_0x38d33e){var _0x211ddc=_0x31e0c7[_0x2e46df(0x12f)](0x3);_0x4a3401[_0x1a12ee][_0x2e46df(0x101)]=_0x31e0c7[0x0],_0x4a3401[_0x1a12ee][_0x2e46df(0x184)]=_0x31e0c7[0x1],_0x4a3401[_0x1a12ee][_0x2e46df(0x12a)]=0x0,_0x4a3401[_0x1a12ee]['bin']=0x0,_0x4a3401[_0x1a12ee][_0x2e46df(0x102)]=_0x2e46df(0x143),_0x4a3401[_0x1a12ee][_0x2e46df(0xdd)]=_0x211ddc;}else{if(_0x4f4e91==_0x2e46df(0x142)&&_0x1a12ee==_0x38d33e){var _0x211ddc=_0x31e0c7[_0x2e46df(0x12f)](0x3);_0x4a3401[_0x1a12ee][_0x2e46df(0x101)]=_0x31e0c7[0x0],_0x4a3401[_0x1a12ee][_0x2e46df(0x184)]=_0x31e0c7[0x1],_0x4a3401[_0x1a12ee]['bay']=0x0,_0x4a3401[_0x1a12ee][_0x2e46df(0x141)]=0x0,_0x4a3401[_0x1a12ee][_0x2e46df(0x102)]=_0x2e46df(0x143),_0x4a3401[_0x1a12ee]['floorlevel']=_0x31e0c7[0x5];}else{if(_0x1a12ee==_0x38d33e){var _0x59588e;if(_0x31e0c7[0x4]=='L')_0x59588e=_0x2e46df(0x13b);else _0x31e0c7[0x4]=='F'&&(_0x59588e=_0x2e46df(0x143));_0x4a3401[_0x1a12ee]['storage']=_0x31e0c7[0x0],_0x4a3401[_0x1a12ee][_0x2e46df(0x184)]=_0x31e0c7[0x1],_0x4a3401[_0x1a12ee][_0x2e46df(0x12a)]=_0x31e0c7[0x2],_0x4a3401[_0x1a12ee][_0x2e46df(0x141)]=_0x31e0c7[0x3],_0x4a3401[_0x1a12ee][_0x2e46df(0x102)]=_0x59588e,_0x4a3401[_0x1a12ee][_0x2e46df(0xdd)]=_0x31e0c7[0x5];}}}});}),_0x3fcd32['forEach']((_0x5186bc,_0x30609f)=>{_0x4a3401[_0x30609f]['stockBefore']=_0x5186bc;}),_0x42aee8['forEach']((_0x283e96,_0x971fb4)=>{var _0x5d8ec6=_0x19d796;_0x4a3401[_0x971fb4][_0x5d8ec6(0x17c)]=_0x283e96;}),_0x5a90e4['forEach']((_0x47229d,_0x588a9e)=>{var _0x52e88a=_0x19d796;_0x4a3401[_0x588a9e][_0x52e88a(0x12c)]=_0x47229d;}),_0x31815c[_0x19d796(0x113)]((_0x817f11,_0x1ea858)=>{var _0x586d07=_0x19d796;_0x4a3401[_0x1ea858][_0x586d07(0xd2)]=_0x817f11;}),_0x405ce5[_0x19d796(0x113)]((_0x320aba,_0x1424dd)=>{var _0x524e57=_0x19d796;_0x4a3401[_0x1424dd][_0x524e57(0xe4)]=_0x320aba;}),_0x541415[_0x19d796(0x113)]((_0x552b83,_0x5b06ff)=>{var _0xc78f23=_0x19d796;_0x4a3401[_0x5b06ff][_0xc78f23(0xee)]=_0x552b83;}),_0x387832[_0x19d796(0x113)]((_0x11b7f9,_0x12f611)=>{var _0x54abb0=_0x19d796;_0x4a3401[_0x12f611][_0x54abb0(0x135)]=_0x11b7f9;}),_0x3c9548[_0x19d796(0x113)]((_0x42db03,_0x1d130d)=>{var _0x21c2ab=_0x19d796;_0x4a3401[_0x1d130d][_0x21c2ab(0xeb)]=_0x42db03;}),_0x5dbe19[_0x19d796(0x113)]((_0x131ff2,_0x4b0933)=>{var _0x2de8bf=_0x19d796;_0x4a3401[_0x4b0933][_0x2de8bf(0x114)]=_0x131ff2;}),_0x114ee6[_0x19d796(0x113)]((_0x1f0113,_0x5bfe5f)=>{var _0x154f63=_0x19d796;_0x4a3401[_0x5bfe5f][_0x154f63(0x134)]=_0x1f0113;}),_0xf35b68[_0x19d796(0x113)]((_0x21825,_0x4e3672)=>{var _0x864292=_0x19d796;_0x4a3401[_0x4e3672][_0x864292(0x17d)]=_0x21825;}),_0x39fda6[_0x19d796(0x113)]((_0x5e9338,_0x5a12b0)=>{var _0x454c66=_0x19d796;_0x4a3401[_0x5a12b0][_0x454c66(0xdf)]=_0x5e9338;}),_0x4126fe[_0x19d796(0x113)]((_0xb612d5,_0x14655d)=>{var _0x26dced=_0x19d796;_0x4a3401[_0x14655d][_0x26dced(0xc8)]=_0xb612d5;}),_0x1940d4['forEach']((_0x148a38,_0x16ed68)=>{var _0x4e6083=_0x19d796;_0x4a3401[_0x16ed68][_0x4e6083(0xcc)]=_0x148a38;}),_0x214e56[_0x19d796(0x113)]((_0x2ed150,_0x3fe59a)=>{_0x4a3401[_0x3fe59a]['secondary_code']=_0x2ed150;});const _0xb0767c=_0x4a3401[_0x19d796(0xde)](_0x519110=>_0x519110[_0x19d796(0x12c)]!=='0'&&_0x519110[_0x19d796(0x12c)]!=='');var _0x20ddcc=0x0;_0xb0767c[_0x19d796(0x113)](_0x4498c5=>{var _0x6896e5=_0x19d796;console[_0x6896e5(0x110)]('foreach\x20newproduct',_0x4498c5),parseInt(_0x4498c5[_0x6896e5(0x12c)])<=0x0&&_0x20ddcc++;});if(_0x20ddcc!=0x0)return _0xca7200[_0x19d796(0x18e)](_0x19d796(0x198),_0x19d796(0xf1)),_0x540ccd[_0x19d796(0xd7)](_0x19d796(0x165));_0x45fcae['warehouse_name']=_0x32518b,_0x45fcae[_0x19d796(0x162)]=_0x3f860a,_0x45fcae[_0x19d796(0x196)]=_0xb0767c,_0x45fcae[_0x19d796(0x126)]=_0x54f46f,_0x45fcae[_0x19d796(0xc7)]=_0x1c1832,_0x45fcae[_0x19d796(0x161)]='False';const _0x881888=await _0x45fcae[_0x19d796(0x130)]();_0xca7200[_0x19d796(0x18e)](_0x19d796(0x197),_0x19d796(0x19a)),_0x540ccd[_0x19d796(0xd7)](_0x19d796(0x190));}catch(_0x4a8d2b){console['log'](_0x4a8d2b);}}),router[a0_0x19bc4b(0x192)](a0_0x19bc4b(0x18f),async(_0xbecb57,_0x3d3de5)=>{var _0x5635c1=a0_0x19bc4b;const {primary_code:_0x27f1f7,warehouse_data:_0x31ac6c,rooms_data:_0x719580,Roomslist:_0x14851e}=_0xbecb57[_0x5635c1(0x123)],_0x55ae49=_0x14851e[_0x5635c1(0x160)](','),_0x4ee216=[];async function _0x105c05(_0x449a4d){var _0x3fb8d1=_0x5635c1;const _0xe88926=await warehouse[_0x3fb8d1(0x111)]([{'$match':{'name':_0x31ac6c,'room':_0x449a4d}},{'$unwind':_0x3fb8d1(0x139)},{'$match':{'product_details.primary_code':_0x27f1f7}},{'$group':{'_id':_0x3fb8d1(0x119),'name':{'$first':_0x3fb8d1(0x11e)},'product_stock':{'$first':_0x3fb8d1(0x127)},'primary_code':{'$first':_0x3fb8d1(0x170)},'secondary_code':{'$first':_0x3fb8d1(0xd9)},'product_code':{'$first':_0x3fb8d1(0x137)},'level':{'$first':_0x3fb8d1(0x16d)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3fb8d1(0xe3)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x3fb8d1(0xfc)},'secondary_unit':{'$first':_0x3fb8d1(0xc9)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3fb8d1(0x152)},'expiry_date':{'$first':_0x3fb8d1(0x104)},'production_date':{'$first':_0x3fb8d1(0xe2)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x3fb8d1(0xef)},'product_cat':{'$first':_0x3fb8d1(0x194)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3fb8d1(0xff)},'invoice':{'$first':_0x3fb8d1(0x168)}}}]),_0x157022=await warehouse[_0x3fb8d1(0x111)]([{'$match':{'name':_0x31ac6c,'room':_0x449a4d}},{'$unwind':_0x3fb8d1(0x139)},{'$match':{'product_details.secondary_code':_0x27f1f7}},{'$group':{'_id':_0x3fb8d1(0x119),'name':{'$first':_0x3fb8d1(0x11e)},'product_stock':{'$first':_0x3fb8d1(0x127)},'primary_code':{'$first':_0x3fb8d1(0x170)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3fb8d1(0x137)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3fb8d1(0xe3)},'pallet':{'$first':_0x3fb8d1(0xca)},'unit':{'$first':_0x3fb8d1(0xfc)},'secondary_unit':{'$first':_0x3fb8d1(0xc9)},'storage':{'$first':_0x3fb8d1(0x12b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3fb8d1(0x104)},'production_date':{'$first':_0x3fb8d1(0xe2)},'maxPerUnit':{'$first':_0x3fb8d1(0xf4)},'batch_code':{'$first':_0x3fb8d1(0xef)},'product_cat':{'$first':_0x3fb8d1(0x194)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3fb8d1(0xff)}}}]);if(_0xe88926[_0x3fb8d1(0xe5)]>0x0)_0x4ee216[_0x3fb8d1(0xd8)](_0xe88926);else _0x157022['length']>0x0&&_0x4ee216[_0x3fb8d1(0xd8)](_0x157022);}const _0x3989ff=_0x55ae49[_0x5635c1(0x16b)](_0x5b811e=>_0x105c05(_0x5b811e));await Promise['all'](_0x3989ff),_0x3d3de5['json'](_0x4ee216);}),router[a0_0x19bc4b(0x192)](a0_0x19bc4b(0xed),async(_0x27ba9e,_0x5f13d5)=>{var _0xc84a1d=a0_0x19bc4b;const {primaryCode:_0x3dc0d4,secondaryCode:_0x5f1535,productCode:_0x2d09bd,level:_0x9a6955,isle:_0x54f932,pallet:_0x1dd9fe,warehouses:_0x73accf,room:_0x803511}=_0x27ba9e[_0xc84a1d(0x123)];try{const _0x434ed1=await warehouse[_0xc84a1d(0x111)]([{'$match':{'name':_0x73accf,'room':_0x803511}},{'$unwind':_0xc84a1d(0x139)},{'$match':{'product_details.level':parseInt(_0x9a6955),'product_details.isle':_0x54f932,'product_details.pallet':parseInt(_0x1dd9fe)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xc84a1d(0x11e)},'product_stock':{'$first':_0xc84a1d(0x127)},'level':{'$first':_0xc84a1d(0x14f)},'isle':{'$first':_0xc84a1d(0x15c)},'pallet':{'$first':_0xc84a1d(0x138)},'maxProducts':{'$first':_0xc84a1d(0x107)}}}]);_0x5f13d5[_0xc84a1d(0x124)](0xc8)[_0xc84a1d(0x18c)](_0x434ed1);}catch(_0x2ec221){_0x5f13d5[_0xc84a1d(0x124)](0x194)['json']({'message':_0x2ec221[_0xc84a1d(0x133)]});}}),module[a0_0x19bc4b(0xd5)]=router;function a0_0x3c24(){var _0x1eebe4=['Arabic','findOne','True','../public/language/languages.json','Spanish','$product_details.level','staff','then','$product_details.rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','edit_adjustment','Return\x20Rooms','product_name','<h5\x20style=\x22text-align:\x20left;\x22>','/../public','role','<tr>','Rooms','$product_details.isle','params','nodemailer','<h2>\x20','split','isAllowEdit','date','logo','/adjustment/preview/','back','host','Logo.png','$product_details.invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','createTransport','map','\x20<>\x20','$product_details.bay','8590oRsZfY','prod_name','$product_details.primary_code','$name','/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Enabled','</tr>','\x20</h2>','</span>','English','floor','Arabic\x20(ae)','/picking_list/PDF_adjustment_rm/','types','production_date','max_per_unit','language','findById','Receiving\x20Area','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','rack','</td>','\x20Order\x20Date\x20:\x20','random','toString','prod_invoice','<!DOCTYPE\x20html>','</table>','json','Hindi','flash','/barcode_scanner','/adjustment/view','prod_code','post','Secondary_units','$product_details.product_cat','ADJ-','product','success','errors','email','adjustment\x20data\x20update\x20successfully','Ambient','68YHiXLN','padStart','9hweXNH','invoice','room_names','$product_details.secondary_unit','$product_details.floorlevel','\x20Order\x20Number\x20:\x20','primary_code','foreach\x20newproduct','edit_adjustment_view','306462JwUmmx','$_id','adjustment\x20add\x20successfull','new_adjust_qty','New_Qty_Converted','$date','exports','stock','redirect','push','$product_details.secondary_code','warehouse','Email\x20sent\x20successfully','1989372kEHXJY','floorlevel','filter','prod_cat','second1','/view/add_adjustment','$product_details.production_date','$product_details.type','unit','length','get','12287tPrMGT','1164996cdzJGo','render','752544BfWSXB','batch_code','</thead>','/CheckingWarehouse','secondary_unit','$product_details.batch_code','../models/all_models','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','1982SSXwTM','express','$product_details.maxPerUnit','id_transaction','<div>','minus','English\x20(US)','product_stock','New_Qty_Converted_adj','</div>','$product_details.unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','RMSEmail','$room','An\x20error\x20occurred\x20while\x20saving\x20data.','storage','type','</body></html>','$product_details.expiry_date','room','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.maxProducts','$product','$isAllowEdit','</head><body>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Return\x20Goods','Chinese','Raw\x20Materials','../middleware/auth','log','aggregate','id_transaction_from','forEach','expiry_date','string','product_details','$invoice','$product_details.bin','$product_details._id','Error\x20Occurs','warehouse_name','user','site_title','$product_details.product_name','/upload/','German','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','body','status','stockBefore','note','$product_details.product_stock','Portuguese','adjustment','bay','$product_details.storage','adjust_qty','$product.product_name','all','slice','save','_id','port','message','maxperunit','product_code','error','$product_details.product_code','$product_details.pallet','$product_details','prime1','Level','<strong>\x20Regards\x20</strong>','5sTajOS','password','$warehouse_name','level','bin','Shelves','Floor','add_adjustment','Portuguese\x20(BR)','Primary_Units','<hr\x20class=\x22my-3\x22>','610144kVirfC','French'];a0_0x3c24=function(){return _0x1eebe4;};return a0_0x3c24();}