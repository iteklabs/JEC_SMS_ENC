var a0_0x3b0b97=a0_0x47bb;(function(_0xe36a5f,_0x5e06a6){var _0x5c5200=a0_0x47bb,_0x1cb7a9=_0xe36a5f();while(!![]){try{var _0x13889e=parseInt(_0x5c5200(0x12a))/0x1*(parseInt(_0x5c5200(0xe7))/0x2)+-parseInt(_0x5c5200(0x79))/0x3+parseInt(_0x5c5200(0x11d))/0x4+-parseInt(_0x5c5200(0x9a))/0x5+-parseInt(_0x5c5200(0x8b))/0x6+-parseInt(_0x5c5200(0xd2))/0x7*(-parseInt(_0x5c5200(0xba))/0x8)+-parseInt(_0x5c5200(0x12b))/0x9;if(_0x13889e===_0x5e06a6)break;else _0x1cb7a9['push'](_0x1cb7a9['shift']());}catch(_0x2cbb36){_0x1cb7a9['push'](_0x1cb7a9['shift']());}}}(a0_0x33cf,0x4d429));const express=require(a0_0x3b0b97(0x9e)),app=express(),router=express[a0_0x3b0b97(0x10d)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0x3b0b97(0x135)),nodemailer=require('nodemailer');router['get']('/view',auth,async(_0x57f6d4,_0x479a12)=>{var _0x1d8411=a0_0x3b0b97;try{const {username:_0x96d52b,email:_0x37e726,role:_0x39bb60}=_0x57f6d4['user'],_0x12dfaa=_0x57f6d4['user'],_0x33e945=await profile[_0x1d8411(0xcc)]({'email':_0x12dfaa['email']}),_0x386941=await master_shop[_0x1d8411(0x106)]();console['log'](_0x1d8411(0xf9),_0x386941);let _0x3d0159;if(_0x12dfaa[_0x1d8411(0x112)]==_0x1d8411(0x142)){const _0x85df78=await staff[_0x1d8411(0xcc)]({'email':_0x12dfaa[_0x1d8411(0x11b)]});_0x3d0159=await warehouse[_0x1d8411(0x106)]({'status':_0x1d8411(0xeb),'name':_0x85df78[_0x1d8411(0xb3)]});}else _0x3d0159=await warehouse['find']({'status':_0x1d8411(0xeb)});const _0x59770c=await product['find']();let _0x3b329d;if(_0x12dfaa[_0x1d8411(0x112)]=='staff'){const _0x1cb9a6=await staff[_0x1d8411(0xcc)]({'email':_0x12dfaa['email']});_0x3b329d=await adjustment[_0x1d8411(0x106)]({'warehouse_name':_0x1cb9a6['warehouse']});}else _0x3b329d=await adjustment['aggregate']([{'$unwind':_0x1d8411(0xcd)},{'$group':{'_id':'$_id','invoice':{'$first':_0x1d8411(0xb9)},'date':{'$first':_0x1d8411(0x71)},'warehouse_name':{'$first':_0x1d8411(0xb2)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x1d8411(0x70)},'isAllowEdit':{'$first':_0x1d8411(0xbc)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x386941[0x0][_0x1d8411(0xee)]=='English\x20(US)'){var _0x4b12bf=users[_0x1d8411(0x97)];console[_0x1d8411(0x13e)](_0x4b12bf);}else{if(_0x386941[0x0][_0x1d8411(0xee)]=='Hindi')var _0x4b12bf=users[_0x1d8411(0x113)];else{if(_0x386941[0x0][_0x1d8411(0xee)]==_0x1d8411(0x122))var _0x4b12bf=users['German'];else{if(_0x386941[0x0][_0x1d8411(0xee)]=='Spanish')var _0x4b12bf=users[_0x1d8411(0x13c)];else{if(_0x386941[0x0][_0x1d8411(0xee)]==_0x1d8411(0xec))var _0x4b12bf=users[_0x1d8411(0xec)];else{if(_0x386941[0x0][_0x1d8411(0xee)]==_0x1d8411(0x12e))var _0x4b12bf=users[_0x1d8411(0x13d)];else{if(_0x386941[0x0][_0x1d8411(0xee)]==_0x1d8411(0xdf))var _0x4b12bf=users[_0x1d8411(0xdf)];else{if(_0x386941[0x0][_0x1d8411(0xee)]==_0x1d8411(0x8e))var _0x4b12bf=users['Arabic'];}}}}}}}_0x479a12[_0x1d8411(0xc7)](_0x1d8411(0x11f),{'success':_0x57f6d4[_0x1d8411(0x144)]('success'),'errors':_0x57f6d4[_0x1d8411(0x144)](_0x1d8411(0xe0)),'role':_0x12dfaa,'profile':_0x33e945,'warehouse':_0x3d0159,'product':_0x59770c,'adjustment':_0x3b329d,'master_shop':_0x386941,'language':_0x4b12bf});}catch(_0xfa039b){console[_0x1d8411(0x13e)](_0xfa039b);}});function a0_0x47bb(_0x302fc5,_0x33228e){var _0x33cfa5=a0_0x33cf();return a0_0x47bb=function(_0x47bb19,_0x53ee52){_0x47bb19=_0x47bb19-0x6e;var _0x18b258=_0x33cfa5[_0x47bb19];return _0x18b258;},a0_0x47bb(_0x302fc5,_0x33228e);}function a0_0x33cf(){var _0x48d58a=['</tbody>','$product_details.expiry_date','sendMail','product_stock','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','createTransport','product_details','status','<table\x20style=\x22width:\x20100%\x20!important;\x22>','slice','$product_details','adjustment\x20Finalized\x20successfully','warehouse_name','push','$product_details.floorlevel','290346wkzJJA','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','New_Qty_Converted','Arabic\x20(ae)','English\x20(US)','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.secondary_unit','types','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$room','string','all','English','New_Qty_Converted_adj','$product.product_name','1486455VFvaKZ','save','$product_details._id','note','express','$product_details.product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','edit_adjustment_view','True','</h5>','Return\x20Rooms','$product_details.production_date','new_adjust_qty','bin','isAllowEdit','padStart','filter','$product_details.secondary_code','secondary_unit','bay','<html><head><title></title>','rack','production_date','/../public','$warehouse_name','warehouse','then','foreach\x20newproduct','product','/upload/','product_name','$invoice','441368BKfnJr','unit','$isAllowEdit','get','</div>','</body></html>','length','Ambient','Error\x20Occurs','minus','storage','stock','Floor','render','/view/add_adjustment','prod_code','$product_details.storage','json','findOne','$product','Rooms','\x20<>\x20','</head><body>','prod_name','63aQqDjc','params','body','max_per_unit','secondary_code','adjustment\x20data\x20update\x20successfully','$name','/picking_list/PDF_adjustment_rm/','False','finalize','catch','batch_code','back','Chinese','errors','redirect','Enclosed','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.bin','$product_details.isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','123398BrSRuF','Secondary_units','second1','$product_details.maxPerUnit','Enabled','French','<h5>','language','An\x20error\x20occurred\x20while\x20saving\x20data.','user','host','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','ADJ-','prod_invoice','success','RMSEmail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.product_cat','master','adjust_qty','<span\x20style=\x22float:\x20right;\x22>','id_transaction_from','prod_cat','map','type','floorlevel','password','room_names','<tbody\x20style=\x22text-align:\x20center;\x22>','adjustment\x20add\x20successfull','$product_details.maxProducts','find','forEach','site_title','logo','$product_details.batch_code','/view/:id','split','Router','Email\x20sent\x20successfully','<strong>\x20Regards\x20</strong>','<!DOCTYPE\x20html>','</thead>','role','Hindi','$product_details.bay','post','product_code','</span>','/adjustment/view','</table>','\x20</h2>','email','maxperunit','2113148ueErck','$product_details.type','adjustment','Shelves','$product_details.rack','German','expiry_date','</td>','<h2>\x20','findById','<tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Return\x20Goods','4ijzcoB','2089575pKRzEc','\x20Order\x20Date\x20:\x20','$product_details.product_stock','Portuguese\x20(BR)','Arabic','Raw\x20Materials','stockBefore','$product_details.invoice','/CheckingWarehouse','Level','../public/language/languages.json','/adjustment/preview/','$product_details.product_name','primary_code','aggregate','$product_details.primary_code','_id','Spanish','Portuguese','log','room','</tr>','/preview/:id','staff','level','flash','Receiving\x20Area','prime1','$finalize','$date','Primary_Units','id_transaction','message','Adjustment\x20Mail','<h5\x20style=\x22text-align:\x20left;\x22>','error','<div>','1131924kiCXOu','$product_details.unit','invoice'];a0_0x33cf=function(){return _0x48d58a;};return a0_0x33cf();}async function getRandom8DigitNumber(){var _0x2441e8=a0_0x3b0b97;const _0x2032d5=0x989680,_0x2af9ed=0x5f5e0ff,_0x5584e7=Math['floor'](Math['random']()*(_0x2af9ed-_0x2032d5+0x1))+_0x2032d5;var _0x199ac6;const _0x53f32a=await adjustment[_0x2441e8(0xcc)]({'invoice':_0x2441e8(0xf3)+_0x5584e7});return _0x53f32a&&_0x53f32a['length']>0x0?_0x199ac6='ADJ-'+_0x5584e7:_0x199ac6=_0x2441e8(0xf3)+_0x5584e7,_0x199ac6;}router[a0_0x3b0b97(0xbd)](a0_0x3b0b97(0xc8),auth,async(_0x4a9744,_0x18560a)=>{var _0x3423b7=a0_0x3b0b97;try{const {username:_0x453441,email:_0x498975,role:_0x3fc0aa}=_0x4a9744[_0x3423b7(0xf0)],_0x1931bb=_0x4a9744[_0x3423b7(0xf0)],_0x569d85=await profile[_0x3423b7(0xcc)]({'email':_0x1931bb[_0x3423b7(0x11b)]}),_0x4df8e7=await master_shop['find']();let _0x2f7da6;if(_0x1931bb[_0x3423b7(0x112)]==_0x3423b7(0x142)){const _0x456872=await staff[_0x3423b7(0xcc)]({'email':_0x1931bb['email']});_0x2f7da6=await warehouse[_0x3423b7(0x139)]([{'$match':{'status':_0x3423b7(0xeb),'name':_0x456872[_0x3423b7(0xb3)],'warehouse_category':_0x3423b7(0x130),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x3423b7(0xd8)}}}]);}else _0x2f7da6=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':_0x3423b7(0x129)}}},{'$group':{'_id':_0x3423b7(0xd8),'name':{'$first':_0x3423b7(0xd8)}}}]);const _0xb98ac9=await product['find']({}),_0x18f153=await adjustment[_0x3423b7(0x106)]({}),_0x2d0988=_0x18f153[_0x3423b7(0xc0)]+0x1,_0x11fed6=_0x3423b7(0xf3)+_0x2d0988['toString']()[_0x3423b7(0xa9)](0x5,'0');var _0xff21f0=[_0x3423b7(0xc1),_0x3423b7(0xe2),_0x3423b7(0xa4)];if(_0x4df8e7[0x0][_0x3423b7(0xee)]=='English\x20(US)')var _0x3f6fba=users[_0x3423b7(0x97)];else{if(_0x4df8e7[0x0][_0x3423b7(0xee)]=='Hindi')var _0x3f6fba=users[_0x3423b7(0x113)];else{if(_0x4df8e7[0x0][_0x3423b7(0xee)]==_0x3423b7(0x122))var _0x3f6fba=users[_0x3423b7(0x122)];else{if(_0x4df8e7[0x0][_0x3423b7(0xee)]==_0x3423b7(0x13c))var _0x3f6fba=users[_0x3423b7(0x13c)];else{if(_0x4df8e7[0x0][_0x3423b7(0xee)]=='French')var _0x3f6fba=users[_0x3423b7(0xec)];else{if(_0x4df8e7[0x0][_0x3423b7(0xee)]==_0x3423b7(0x12e))var _0x3f6fba=users['Portuguese'];else{if(_0x4df8e7[0x0]['language']==_0x3423b7(0xdf))var _0x3f6fba=users[_0x3423b7(0xdf)];else{if(_0x4df8e7[0x0]['language']==_0x3423b7(0x8e))var _0x3f6fba=users[_0x3423b7(0x12f)];}}}}}}}const _0x18d705=getRandom8DigitNumber();_0x18d705[_0x3423b7(0xb4)](_0x5c0ea7=>{var _0x196da9=_0x3423b7;_0x18560a['render']('add_adjustment',{'success':_0x4a9744[_0x196da9(0x144)](_0x196da9(0xf5)),'errors':_0x4a9744['flash'](_0x196da9(0xe0)),'role':_0x1931bb,'profile':_0x569d85,'warehouse':_0x2f7da6,'product':_0xb98ac9,'master_shop':_0x4df8e7,'language':_0x3f6fba,'rooms_data':_0xff21f0,'invoice_no':_0x5c0ea7});})[_0x3423b7(0xdc)](_0x37bae2=>{var _0x3e89a4=_0x3423b7;_0x4a9744[_0x3e89a4(0x144)](_0x3e89a4(0xe0),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x18560a[_0x3e89a4(0xe1)](_0x3e89a4(0x118));});}catch(_0x39c756){console[_0x3423b7(0x13e)](_0x39c756);}}),router[a0_0x3b0b97(0x115)](a0_0x3b0b97(0xc8),auth,async(_0x2d7aa5,_0x177fc3)=>{var _0x5d5ab2=a0_0x3b0b97;try{const {warehouse_name:_0x418e59,date:_0x76b18a,prod_name:_0x54bc08,level:_0x18cfa4,isle:_0x178d4a,pallet:_0x560dce,stock:_0x895772,types:_0x1e7900,adjust_qty:_0x1a68f2,new_adjust_qty:_0x3458e2,note:_0x2c7348,Room_name:_0x18728a,invoice:_0x4640db,JO_number:_0xd15766,expiry_date:_0x16f484}=_0x2d7aa5[_0x5d5ab2(0xd4)];if(typeof _0x54bc08==_0x5d5ab2(0x95))var _0x208ff6=[_0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xd1)]],_0x3fc7c2=[_0x2d7aa5[_0x5d5ab2(0xd4)]['level']],_0x3bd4f6=[_0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xc5)]],_0x5654aa=[_0x2d7aa5['body'][_0x5d5ab2(0x92)]],_0x159be1=[_0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0x98)]],_0x26d0cb=[_0x2d7aa5['body'][_0x5d5ab2(0x8d)]],_0x56c952=[_0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0x72)]],_0x22eefb=[_0x2d7aa5[_0x5d5ab2(0xd4)]['Secondary_units']],_0x2d96a3=[_0x2d7aa5[_0x5d5ab2(0xd4)]['prod_code']],_0x57fe1b=[_0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xdd)]],_0x3c0b9b=[_0x2d7aa5['body']['expiry_date']],_0x15aae5=[_0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xd5)]],_0x36e790=[_0x2d7aa5[_0x5d5ab2(0xd4)]['production_date']],_0x3f45d3=[_0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xfd)]],_0x4fefda=[_0x2d7aa5[_0x5d5ab2(0xd4)]['Rooms']],_0x23fe90=[_0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0x6f)]],_0x118ac4=[_0x2d7aa5['body'][_0x5d5ab2(0xe9)]],_0x274dd4=[_0x2d7aa5['body'][_0x5d5ab2(0xf4)]],_0x6a551a=[_0x2d7aa5['body'][_0x5d5ab2(0x73)]];else var _0x208ff6=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xd1)]],_0x3fc7c2=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0x143)]],_0x3bd4f6=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xc5)]],_0x5654aa=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0x92)]],_0x159be1=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0x98)]],_0x26d0cb=[..._0x2d7aa5['body']['New_Qty_Converted']],_0x56c952=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xbb)]],_0x22eefb=[..._0x2d7aa5[_0x5d5ab2(0xd4)]['Secondary_units']],_0x2d96a3=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xc9)]],_0x57fe1b=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xdd)]],_0x3c0b9b=[..._0x2d7aa5['body'][_0x5d5ab2(0x123)]],_0x15aae5=[..._0x2d7aa5[_0x5d5ab2(0xd4)]['max_per_unit']],_0x36e790=[..._0x2d7aa5['body'][_0x5d5ab2(0xb0)]],_0x3f45d3=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xfd)]],_0x4fefda=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xce)]],_0x23fe90=[..._0x2d7aa5[_0x5d5ab2(0xd4)]['prime1']],_0x118ac4=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xe9)]],_0x274dd4=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0xf4)]],_0x6a551a=[..._0x2d7aa5[_0x5d5ab2(0xd4)][_0x5d5ab2(0x73)]];const _0x521b5b=_0x208ff6[_0x5d5ab2(0xfe)](_0x37b76c=>{return _0x37b76c={'product_name':_0x37b76c};});_0x3fc7c2['forEach']((_0x332c08,_0x14f565)=>{_0x4fefda['forEach']((_0x110604,_0x5db940)=>{var _0x5d54b6=a0_0x47bb;if(_0x110604==_0x5d54b6(0x6e)&&_0x14f565==_0x5db940){var _0x2f9dfb=_0x332c08['slice'](0x3);_0x521b5b[_0x14f565][_0x5d54b6(0xc4)]=_0x332c08[0x0],_0x521b5b[_0x14f565]['rack']=_0x332c08[0x1],_0x521b5b[_0x14f565]['bay']=0x0,_0x521b5b[_0x14f565][_0x5d54b6(0xa7)]=0x0,_0x521b5b[_0x14f565]['type']='Floor',_0x521b5b[_0x14f565][_0x5d54b6(0x100)]=_0x2f9dfb;}else{if(_0x110604==_0x5d54b6(0x120)&&_0x14f565==_0x5db940){var _0x2f9dfb=_0x332c08[_0x5d54b6(0x85)](0x3);_0x521b5b[_0x14f565][_0x5d54b6(0xc4)]=_0x332c08[0x0],_0x521b5b[_0x14f565][_0x5d54b6(0xaf)]=_0x332c08[0x1],_0x521b5b[_0x14f565]['bay']=0x0,_0x521b5b[_0x14f565][_0x5d54b6(0xa7)]=0x0,_0x521b5b[_0x14f565]['type']=_0x5d54b6(0xc6),_0x521b5b[_0x14f565][_0x5d54b6(0x100)]=_0x332c08[0x5];}else{if(_0x14f565==_0x5db940){var _0x5186f1;if(_0x332c08[0x4]=='L')_0x5186f1=_0x5d54b6(0x134);else _0x332c08[0x4]=='F'&&(_0x5186f1=_0x5d54b6(0xc6));_0x521b5b[_0x14f565]['storage']=_0x332c08[0x0],_0x521b5b[_0x14f565][_0x5d54b6(0xaf)]=_0x332c08[0x1],_0x521b5b[_0x14f565][_0x5d54b6(0xad)]=_0x332c08[0x2],_0x521b5b[_0x14f565][_0x5d54b6(0xa7)]=_0x332c08[0x3],_0x521b5b[_0x14f565][_0x5d54b6(0xff)]=_0x5186f1,_0x521b5b[_0x14f565]['floorlevel']=_0x332c08[0x5];}}}});}),_0x3bd4f6['forEach']((_0x518afb,_0x450512)=>{var _0x5553e1=_0x5d5ab2;_0x521b5b[_0x450512][_0x5553e1(0x131)]=_0x518afb;}),_0x6a551a[_0x5d5ab2(0x107)]((_0x5907a6,_0x253034)=>{var _0x3acecf=_0x5d5ab2;_0x521b5b[_0x253034][_0x3acecf(0xfc)]=_0x5907a6;}),_0x5654aa[_0x5d5ab2(0x107)]((_0x3158ec,_0x5cfdf7)=>{_0x521b5b[_0x5cfdf7]['types']=_0x3158ec;}),_0x159be1[_0x5d5ab2(0x107)]((_0x1097a8,_0x33f75f)=>{var _0x5ead9c=_0x5d5ab2;_0x521b5b[_0x33f75f][_0x5ead9c(0xfa)]=_0x1097a8;}),_0x26d0cb[_0x5d5ab2(0x107)]((_0x8247c8,_0x2d799e)=>{var _0x29473c=_0x5d5ab2;_0x521b5b[_0x2d799e][_0x29473c(0xa6)]=_0x8247c8;}),_0x56c952[_0x5d5ab2(0x107)]((_0x1196bf,_0xf8a81f)=>{var _0x45366c=_0x5d5ab2;_0x521b5b[_0xf8a81f][_0x45366c(0xbb)]=_0x1196bf;}),_0x22eefb['forEach']((_0x2f9ee6,_0x508083)=>{var _0x3756ea=_0x5d5ab2;_0x521b5b[_0x508083][_0x3756ea(0xac)]=_0x2f9ee6;}),_0x2d96a3[_0x5d5ab2(0x107)]((_0x21d4f8,_0x35067d)=>{var _0x48e944=_0x5d5ab2;_0x521b5b[_0x35067d][_0x48e944(0x116)]=_0x21d4f8;}),_0x57fe1b[_0x5d5ab2(0x107)]((_0x5ce2bc,_0x7668fe)=>{var _0x46eb88=_0x5d5ab2;_0x521b5b[_0x7668fe][_0x46eb88(0xdd)]=_0x5ce2bc;}),_0x3c0b9b[_0x5d5ab2(0x107)]((_0x1171b4,_0x15bd8a)=>{var _0x412fbf=_0x5d5ab2;_0x521b5b[_0x15bd8a][_0x412fbf(0x123)]=_0x1171b4;}),_0x15aae5['forEach']((_0x49156c,_0x1e3393)=>{var _0x53d06d=_0x5d5ab2;_0x521b5b[_0x1e3393][_0x53d06d(0x11c)]=_0x49156c;}),_0x36e790[_0x5d5ab2(0x107)]((_0x84f909,_0x49f6b1)=>{var _0x566424=_0x5d5ab2;_0x521b5b[_0x49f6b1][_0x566424(0xb0)]=_0x84f909;}),_0x3f45d3['forEach']((_0x34244c,_0x40fe42)=>{_0x521b5b[_0x40fe42]['prod_cat']=_0x34244c;}),_0x4fefda[_0x5d5ab2(0x107)]((_0x1efec0,_0x427301)=>{_0x521b5b[_0x427301]['room_names']=_0x1efec0;}),_0x23fe90[_0x5d5ab2(0x107)]((_0x20a081,_0x4147c8)=>{_0x521b5b[_0x4147c8]['primary_code']=_0x20a081;}),_0x118ac4[_0x5d5ab2(0x107)]((_0x219056,_0x513e2c)=>{_0x521b5b[_0x513e2c]['secondary_code']=_0x219056;}),_0x274dd4[_0x5d5ab2(0x107)]((_0x5d4b29,_0x56d239)=>{var _0xf8774=_0x5d5ab2;_0x521b5b[_0x56d239][_0xf8774(0x7b)]=_0x5d4b29;});const _0x9dbed1=_0x521b5b[_0x5d5ab2(0xaa)](_0x41e6d6=>_0x41e6d6['adjust_qty']!=='0'&&_0x41e6d6[_0x5d5ab2(0xfa)]!=='');var _0x14d5c0=0x0;_0x9dbed1[_0x5d5ab2(0x107)](_0x2a13e4=>{var _0x15c85f=_0x5d5ab2;console[_0x15c85f(0x13e)](_0x15c85f(0xb5),_0x2a13e4),parseInt(_0x2a13e4[_0x15c85f(0xfa)])<=0x0&&_0x14d5c0++;});if(_0x14d5c0!=0x0)return _0x2d7aa5[_0x5d5ab2(0x144)](_0x5d5ab2(0xe0),_0x5d5ab2(0x80)),_0x177fc3[_0x5d5ab2(0xe1)](_0x5d5ab2(0xde));const _0x33c94f=new adjustment({'warehouse_name':_0x418e59,'date':_0x76b18a,'product':_0x9dbed1,'note':_0x2c7348,'room':_0x18728a,'invoice':_0x4640db,'JO_number':_0xd15766,'expiry_date':_0x16f484}),_0x5323c1=await _0x33c94f[_0x5d5ab2(0x9b)]();_0x2d7aa5['flash'](_0x5d5ab2(0xf5),_0x5d5ab2(0x104)),_0x177fc3[_0x5d5ab2(0xe1)](_0x5d5ab2(0x136)+_0x5323c1['_id']);}catch(_0x1cf417){console['log'](_0x1cf417),_0x177fc3['status'](0xc8)[_0x5d5ab2(0xcb)]({'message':_0x1cf417['message']});}}),router[a0_0x3b0b97(0xbd)](a0_0x3b0b97(0x141),auth,async(_0x5af311,_0x317bc6)=>{var _0x2ca7c0=a0_0x3b0b97;try{const {username:_0x322adb,email:_0x2a0764,role:_0x2bd0b7}=_0x5af311['user'],_0x2ab761=_0x5af311[_0x2ca7c0(0xf0)],_0x583bcd=await profile['findOne']({'email':_0x2ab761['email']}),_0x4840d6=await master_shop[_0x2ca7c0(0x106)](),_0x44657a=_0x5af311[_0x2ca7c0(0xd3)]['id'],_0x958972=await adjustment[_0x2ca7c0(0x126)]({'_id':_0x44657a}),_0x21b335=await purchases[_0x2ca7c0(0x139)]([{'$match':{'warehouse_name':_0x958972[_0x2ca7c0(0x88)]}},{'$unwind':_0x2ca7c0(0xcd)},{'$group':{'_id':_0x2ca7c0(0x99)}}]),_0x36382e=await product['find']({}),_0x293eb9=await warehouse[_0x2ca7c0(0x139)]([{'$match':{'name':_0x958972[_0x2ca7c0(0x88)]}},{'$unwind':_0x2ca7c0(0x86)},{'$group':{'_id':_0x2ca7c0(0x9c),'name':{'$first':_0x2ca7c0(0x137)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x2ca7c0(0xe4)},'type':{'$first':_0x2ca7c0(0x11e)},'floorlevel':{'$first':_0x2ca7c0(0x8a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2ca7c0(0x9f)},'storage':{'$first':_0x2ca7c0(0xca)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x2ca7c0(0xea)},'expiry_date':{'$first':_0x2ca7c0(0x7d)},'production_date':{'$first':_0x2ca7c0(0xa5)},'batch_code':{'$first':_0x2ca7c0(0x10a)},'room':{'$first':_0x2ca7c0(0x94)}}}]);if(_0x4840d6[0x0]['language']==_0x2ca7c0(0x8f)){var _0x15d37b=users['English'];console[_0x2ca7c0(0x13e)](_0x15d37b);}else{if(_0x4840d6[0x0][_0x2ca7c0(0xee)]==_0x2ca7c0(0x113))var _0x15d37b=users[_0x2ca7c0(0x113)];else{if(_0x4840d6[0x0][_0x2ca7c0(0xee)]==_0x2ca7c0(0x122))var _0x15d37b=users['German'];else{if(_0x4840d6[0x0][_0x2ca7c0(0xee)]=='Spanish')var _0x15d37b=users['Spanish'];else{if(_0x4840d6[0x0]['language']==_0x2ca7c0(0xec))var _0x15d37b=users['French'];else{if(_0x4840d6[0x0][_0x2ca7c0(0xee)]==_0x2ca7c0(0x12e))var _0x15d37b=users['Portuguese'];else{if(_0x4840d6[0x0][_0x2ca7c0(0xee)]=='Chinese')var _0x15d37b=users[_0x2ca7c0(0xdf)];else{if(_0x4840d6[0x0][_0x2ca7c0(0xee)]==_0x2ca7c0(0x8e))var _0x15d37b=users[_0x2ca7c0(0x12f)];}}}}}}}_0x317bc6['render'](_0x2ca7c0(0xa1),{'success':_0x5af311[_0x2ca7c0(0x144)](_0x2ca7c0(0xf5)),'errors':_0x5af311['flash'](_0x2ca7c0(0xe0)),'role':_0x2ab761,'profile':_0x583bcd,'adjustment':_0x958972,'stock':_0x293eb9,'master_shop':_0x4840d6,'warehouse_name':_0x21b335,'unit':_0x36382e,'language':_0x15d37b});}catch(_0x511f6d){console['log'](_0x511f6d),_0x317bc6[_0x2ca7c0(0x83)](0xc8)[_0x2ca7c0(0xcb)]({'message':_0x511f6d['message']});}}),router[a0_0x3b0b97(0x115)]('/preview/:id',auth,async(_0x59ca49,_0x325bb1)=>{var _0x1e1b93=a0_0x3b0b97;try{const _0xdf73ca=_0x59ca49[_0x1e1b93(0xd3)]['id'],{warehouse_name:_0x42b5a0,Room_name:_0xbaee66}=_0x59ca49[_0x1e1b93(0xd4)],_0x9ad786=await adjustment[_0x1e1b93(0x126)]({'_id':_0xdf73ca}),_0x4f829f=_0x9ad786[_0x1e1b93(0xb6)][_0x1e1b93(0xfe)](async _0x6eddb1=>{var _0x4d5830=_0x1e1b93;if(_0x6eddb1[_0x4d5830(0xfa)]>0x0){var _0x3bfd81=await warehouse[_0x4d5830(0xcc)]({'name':_0x42b5a0,'room':_0x6eddb1[_0x4d5830(0x102)],'warehouse_category':_0x4d5830(0x130)});const _0x29331e=_0x3bfd81[_0x4d5830(0x82)][_0x4d5830(0xfe)](_0x6b53ac=>{var _0x1b433a=_0x4d5830;console['log'](_0x6eddb1[_0x1b433a(0x92)]+_0x1b433a(0xcf));if(_0x6eddb1[_0x1b433a(0x92)]==_0x1b433a(0xc3)){if(_0x6b53ac[_0x1b433a(0xb8)]==_0x6eddb1[_0x1b433a(0xb8)]&&_0x6b53ac[_0x1b433a(0x100)]==_0x6eddb1['floorlevel']&&_0x6b53ac[_0x1b433a(0xff)]==_0x6eddb1[_0x1b433a(0xff)]&&_0x6b53ac[_0x1b433a(0xa7)]==_0x6eddb1[_0x1b433a(0xa7)]&&_0x6b53ac[_0x1b433a(0xad)]==_0x6eddb1[_0x1b433a(0xad)]&&_0x6b53ac['rack']==_0x6eddb1[_0x1b433a(0xaf)]&&_0x6b53ac['storage']==_0x6eddb1[_0x1b433a(0xc4)]&&_0x6b53ac[_0x1b433a(0x123)]==_0x6eddb1['expiry_date']&&_0x6b53ac['batch_code']==_0x6eddb1['batch_code']&&_0x6b53ac[_0x1b433a(0xb0)]==_0x6eddb1[_0x1b433a(0xb0)]&&_0x6b53ac[_0x1b433a(0x7b)]==_0x6eddb1[_0x1b433a(0x7b)]&&_0x6b53ac[_0x1b433a(0x13b)]==_0x6eddb1['id_transaction_from']){var _0x549b8e;_0x549b8e=_0x6eddb1['adjust_qty'],_0x6eddb1['prod_cat']=='S'&&(_0x549b8e=_0x6eddb1[_0x1b433a(0xfa)]),_0x6b53ac[_0x1b433a(0x7f)]=_0x6b53ac[_0x1b433a(0x7f)]-_0x549b8e;}}else{if(_0x6b53ac['product_name']==_0x6eddb1[_0x1b433a(0xb8)]&&_0x6b53ac[_0x1b433a(0x100)]==_0x6eddb1['floorlevel']&&_0x6b53ac['type']==_0x6eddb1[_0x1b433a(0xff)]&&_0x6b53ac[_0x1b433a(0xa7)]==_0x6eddb1[_0x1b433a(0xa7)]&&_0x6b53ac[_0x1b433a(0xad)]==_0x6eddb1['bay']&&_0x6b53ac[_0x1b433a(0xaf)]==_0x6eddb1[_0x1b433a(0xaf)]&&_0x6b53ac[_0x1b433a(0xc4)]==_0x6eddb1[_0x1b433a(0xc4)]&&_0x6b53ac['expiry_date']==_0x6eddb1[_0x1b433a(0x123)]&&_0x6b53ac[_0x1b433a(0xdd)]==_0x6eddb1['batch_code']&&_0x6b53ac[_0x1b433a(0xb0)]==_0x6eddb1[_0x1b433a(0xb0)]&&_0x6b53ac[_0x1b433a(0x7b)]==_0x6eddb1[_0x1b433a(0x7b)]&&_0x6b53ac['_id']==_0x6eddb1[_0x1b433a(0xfc)]){console['log'](_0x6eddb1);var _0x549b8e;_0x549b8e=_0x6eddb1[_0x1b433a(0xfa)],_0x6eddb1[_0x1b433a(0xfd)]=='S'&&(_0x549b8e=_0x6eddb1[_0x1b433a(0xfa)]),_0x6b53ac[_0x1b433a(0x7f)]=_0x6b53ac[_0x1b433a(0x7f)]+_0x549b8e;}}});}return _0x3bfd81;});Promise[_0x1e1b93(0x96)](_0x4f829f)['then'](async _0x3740f6=>{var _0x72e9eb=_0x1e1b93;try{for(const _0x4f3fc0 of _0x3740f6){await _0x4f3fc0[_0x72e9eb(0x9b)]();}_0x9ad786[_0x72e9eb(0xdb)]=_0x72e9eb(0xa2);const _0x3817e1=await _0x9ad786[_0x72e9eb(0x9b)](),_0x3e7666=await master_shop['find'](),_0x4a3ba7=await email_settings[_0x72e9eb(0xcc)](),_0x36fa0b=await supervisor_settings['find']();var _0x2e4103=_0x9ad786[_0x72e9eb(0xb6)],_0x48230c='',_0x4a847a;for(_0x4a847a in _0x2e4103){_0x48230c+=_0x72e9eb(0x127)+_0x72e9eb(0x93)+_0x2e4103[_0x4a847a][_0x72e9eb(0xb8)]+'</td>'+_0x72e9eb(0x93)+_0x2e4103[_0x4a847a]['product_code']+_0x72e9eb(0x124)+_0x72e9eb(0x93)+_0x2e4103[_0x4a847a]['adjust_qty']+_0x72e9eb(0x124)+_0x72e9eb(0x93)+_0x2e4103[_0x4a847a][_0x72e9eb(0xbb)]+_0x72e9eb(0x124)+_0x72e9eb(0x93)+_0x2e4103[_0x4a847a][_0x72e9eb(0xac)]+_0x72e9eb(0x124)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9ad786[_0x72e9eb(0x88)]+_0x72e9eb(0x124)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2e4103[_0x4a847a]['room_names']+_0x72e9eb(0x124)+_0x72e9eb(0x93)+_0x2e4103[_0x4a847a][_0x72e9eb(0xc4)]+_0x2e4103[_0x4a847a]['rack']+_0x2e4103[_0x4a847a]['bay']+_0x2e4103[_0x4a847a]['bin']+_0x2e4103[_0x4a847a][_0x72e9eb(0xff)][0x0]+_0x2e4103[_0x4a847a]['floorlevel']+_0x72e9eb(0x124),_0x72e9eb(0x140);}let _0x5d57bd=nodemailer[_0x72e9eb(0x81)]({'host':_0x4a3ba7[_0x72e9eb(0xf1)],'port':Number(_0x4a3ba7['port']),'secure':![],'auth':{'user':_0x4a3ba7[_0x72e9eb(0x11b)],'pass':_0x4a3ba7[_0x72e9eb(0x101)]}}),_0x13228d={'from':_0x4a3ba7[_0x72e9eb(0x11b)],'to':_0x36fa0b[0x0][_0x72e9eb(0xf6)],'subject':_0x72e9eb(0x75),'attachments':[{'filename':'Logo.png','path':__dirname+_0x72e9eb(0xb1)+_0x72e9eb(0xb7)+_0x3e7666[0x0]['image'],'cid':_0x72e9eb(0x109)}],'html':_0x72e9eb(0x110)+_0x72e9eb(0xae)+_0x72e9eb(0xd0)+_0x72e9eb(0x78)+_0x72e9eb(0x8c)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x72e9eb(0xbe)+_0x72e9eb(0x78)+_0x72e9eb(0x125)+_0x3e7666[0x0][_0x72e9eb(0x108)]+_0x72e9eb(0x11a)+_0x72e9eb(0xbe)+_0x72e9eb(0xbe)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x72e9eb(0x76)+'\x20Order\x20Number\x20:\x20'+_0x9ad786[_0x72e9eb(0x7b)]+'\x20'+_0x72e9eb(0xfb)+_0x72e9eb(0x12c)+_0x9ad786['date']+'\x20'+_0x72e9eb(0x117)+_0x72e9eb(0xa3)+_0x72e9eb(0xbe)+_0x72e9eb(0x84)+_0x72e9eb(0x90)+_0x72e9eb(0x127)+_0x72e9eb(0xe6)+_0x72e9eb(0x128)+_0x72e9eb(0xe3)+_0x72e9eb(0xa0)+_0x72e9eb(0xf2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x72e9eb(0xf7)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x72e9eb(0x140)+_0x72e9eb(0x111)+_0x72e9eb(0x103)+'\x20'+_0x48230c+'\x20'+_0x72e9eb(0x7c)+_0x72e9eb(0x119)+_0x72e9eb(0x78)+_0x72e9eb(0x10f)+_0x72e9eb(0xed)+_0x3e7666[0x0][_0x72e9eb(0x108)]+'</h5>'+'</div>'+'</div>'+_0x72e9eb(0xbf)};_0x5d57bd[_0x72e9eb(0x7e)](_0x13228d,function(_0x5ee8fc,_0x48d505){var _0x5bfbb9=_0x72e9eb;_0x5ee8fc?(console[_0x5bfbb9(0x13e)](_0x5ee8fc),console[_0x5bfbb9(0x13e)](_0x5bfbb9(0xc2))):console[_0x5bfbb9(0x13e)](_0x5bfbb9(0x10e));}),_0x59ca49[_0x72e9eb(0x144)](_0x72e9eb(0xf5),_0x72e9eb(0x87)),_0x325bb1[_0x72e9eb(0xe1)](_0x72e9eb(0xd9)+_0x3817e1[_0x72e9eb(0x13b)]);}catch(_0x2b5111){console[_0x72e9eb(0x77)](_0x2b5111),_0x325bb1[_0x72e9eb(0x83)](0x1f4)[_0x72e9eb(0xcb)]({'error':_0x72e9eb(0xef)});}})[_0x1e1b93(0xdc)](_0x60a7e8=>{var _0x2301a2=_0x1e1b93;console['error'](_0x60a7e8),_0x325bb1[_0x2301a2(0x83)](0x1f4)[_0x2301a2(0xcb)]({'error':'An\x20error\x20occurred.'});});}catch(_0x227744){console[_0x1e1b93(0x13e)](_0x227744),_0x325bb1[_0x1e1b93(0x83)](0xc8)['json']({'message':_0x227744[_0x1e1b93(0x74)]});}}),router[a0_0x3b0b97(0xbd)]('/view/:id',auth,async(_0x1fa7c3,_0x2b9268)=>{var _0x42cdd4=a0_0x3b0b97;try{const {username:_0x3b773f,email:_0x35ff8d,role:_0x177b41}=_0x1fa7c3['user'],_0x2e6e4f=_0x1fa7c3['user'],_0x4b2f2a=await profile[_0x42cdd4(0xcc)]({'email':_0x2e6e4f['email']}),_0xa5f289=await master_shop['find'](),_0x11f0e2=_0x1fa7c3[_0x42cdd4(0xd3)]['id'],_0x36fb6c=await adjustment[_0x42cdd4(0x126)]({'_id':_0x11f0e2}),_0x11f662=await purchases[_0x42cdd4(0x139)]([{'$match':{'warehouse_name':_0x36fb6c[_0x42cdd4(0x88)]}},{'$unwind':_0x42cdd4(0xcd)},{'$group':{'_id':_0x42cdd4(0x99)}}]),_0x51a157=await product[_0x42cdd4(0x106)]({}),_0x332905=await warehouse[_0x42cdd4(0x139)]([{'$match':{'name':_0x36fb6c[_0x42cdd4(0x88)]}},{'$unwind':_0x42cdd4(0x86)},{'$group':{'_id':_0x42cdd4(0x9c),'name':{'$first':_0x42cdd4(0x137)},'product_stock':{'$first':_0x42cdd4(0x12d)},'bay':{'$first':_0x42cdd4(0x114)},'bin':{'$first':_0x42cdd4(0xe4)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x42cdd4(0x8a)},'primary_code':{'$first':_0x42cdd4(0x13a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x42cdd4(0x9f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x42cdd4(0x121)},'maxPerUnit':{'$first':_0x42cdd4(0xea)},'expiry_date':{'$first':_0x42cdd4(0x7d)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x42cdd4(0x10a)},'room':{'$first':'$room'}}}]);let _0x219266;if(_0x2e6e4f['role']=='staff'){const _0x97d209=await staff[_0x42cdd4(0xcc)]({'email':_0x2e6e4f[_0x42cdd4(0x11b)]});_0x219266=await warehouse[_0x42cdd4(0x139)]([{'$match':{'status':_0x42cdd4(0xeb),'name':_0x97d209[_0x42cdd4(0xb3)],'warehouse_category':_0x42cdd4(0x130),'name':{'$ne':_0x42cdd4(0x129)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x219266=await warehouse[_0x42cdd4(0x139)]([{'$match':{'status':_0x42cdd4(0xeb),'warehouse_category':_0x42cdd4(0x130),'name':{'$ne':_0x42cdd4(0x129)}}},{'$group':{'_id':'$name','name':{'$first':_0x42cdd4(0xd8)}}}]);if(_0xa5f289[0x0][_0x42cdd4(0xee)]==_0x42cdd4(0x8f)){var _0x47518f=users[_0x42cdd4(0x97)];console[_0x42cdd4(0x13e)](_0x47518f);}else{if(_0xa5f289[0x0][_0x42cdd4(0xee)]==_0x42cdd4(0x113))var _0x47518f=users['Hindi'];else{if(_0xa5f289[0x0]['language']==_0x42cdd4(0x122))var _0x47518f=users[_0x42cdd4(0x122)];else{if(_0xa5f289[0x0][_0x42cdd4(0xee)]==_0x42cdd4(0x13c))var _0x47518f=users['Spanish'];else{if(_0xa5f289[0x0][_0x42cdd4(0xee)]=='French')var _0x47518f=users[_0x42cdd4(0xec)];else{if(_0xa5f289[0x0]['language']==_0x42cdd4(0x12e))var _0x47518f=users[_0x42cdd4(0x13d)];else{if(_0xa5f289[0x0][_0x42cdd4(0xee)]=='Chinese')var _0x47518f=users[_0x42cdd4(0xdf)];else{if(_0xa5f289[0x0][_0x42cdd4(0xee)]==_0x42cdd4(0x8e))var _0x47518f=users[_0x42cdd4(0x12f)];}}}}}}}_0x2b9268[_0x42cdd4(0xc7)]('edit_adjustment',{'success':_0x1fa7c3['flash']('success'),'errors':_0x1fa7c3['flash'](_0x42cdd4(0xe0)),'role':_0x2e6e4f,'profile':_0x4b2f2a,'adjustment':_0x36fb6c,'stock':_0x332905,'master_shop':_0xa5f289,'warehouse_name':_0x11f662,'unit':_0x51a157,'language':_0x47518f,'warehouse':_0x219266});}catch(_0x11dcff){console[_0x42cdd4(0x13e)](_0x11dcff),_0x2b9268[_0x42cdd4(0x83)](0xc8)[_0x42cdd4(0xcb)]({'message':_0x11dcff[_0x42cdd4(0x74)]});}}),router[a0_0x3b0b97(0x115)](a0_0x3b0b97(0x10b),auth,async(_0x463dbe,_0x5110cb)=>{var _0x3f566b=a0_0x3b0b97;try{const _0xc8394c=_0x463dbe[_0x3f566b(0xd3)]['id'],_0x3b7532=await adjustment[_0x3f566b(0x126)]({'_id':_0xc8394c}),_0xeee366=await warehouse[_0x3f566b(0xcc)]({'name':_0x3b7532[_0x3f566b(0x88)],'room':_0x3b7532[_0x3f566b(0x13f)]}),{warehouse_name:_0x30f67b,date:_0x550cbd,prod_name:_0x2d4f56,level:_0x488401,isle:_0x2cb803,pallet:_0x41a150,stock:_0x4597ac,types:_0x115e5f,adjust_qty:_0x43325b,new_adjust_qty:_0x223577,note:_0x1e9e7d,Room_name:_0x636057,invoice:_0x5c7efa,JO_number:_0x5335c8,expiry_date:_0x128d93}=_0x463dbe[_0x3f566b(0xd4)];if(typeof _0x2d4f56==_0x3f566b(0x95))var _0x5df1ef=[_0x463dbe['body']['prod_name']],_0xb8f548=[_0x463dbe[_0x3f566b(0xd4)]['level']],_0x1b4cbf=[_0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xc5)]],_0x55e1a8=[_0x463dbe['body'][_0x3f566b(0x92)]],_0x5836a8=[_0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0x98)]],_0x1418e5=[_0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0x8d)]],_0x11f813=[_0x463dbe['body'][_0x3f566b(0x72)]],_0x35fd2e=[_0x463dbe['body'][_0x3f566b(0xe8)]],_0x23c585=[_0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xc9)]],_0x889c3d=[_0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xdd)]],_0x1e86ce=[_0x463dbe['body'][_0x3f566b(0x123)]],_0x5584ed=[_0x463dbe[_0x3f566b(0xd4)]['max_per_unit']],_0x38be87=[_0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xb0)]],_0x3254f6=[_0x463dbe['body'][_0x3f566b(0xfd)]],_0x61b975=[_0x463dbe[_0x3f566b(0xd4)]['Rooms']],_0x5ee1df=[_0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0x6f)]],_0x48320f=[_0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xe9)]];else var _0x5df1ef=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xd1)]],_0xb8f548=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0x143)]],_0x1b4cbf=[..._0x463dbe['body']['stock']],_0x55e1a8=[..._0x463dbe[_0x3f566b(0xd4)]['types']],_0x5836a8=[..._0x463dbe['body'][_0x3f566b(0x98)]],_0x1418e5=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0x8d)]],_0x11f813=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xbb)]],_0x35fd2e=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xe8)]],_0x23c585=[..._0x463dbe[_0x3f566b(0xd4)]['prod_code']],_0x889c3d=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xdd)]],_0x1e86ce=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0x123)]],_0x5584ed=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xd5)]],_0x38be87=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xb0)]],_0x3254f6=[..._0x463dbe['body'][_0x3f566b(0xfd)]],_0x61b975=[..._0x463dbe[_0x3f566b(0xd4)]['Rooms']],_0x5ee1df=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0x6f)]],_0x48320f=[..._0x463dbe[_0x3f566b(0xd4)][_0x3f566b(0xe9)]];const _0x34a84f=_0x5df1ef[_0x3f566b(0xfe)](_0x467b7f=>{return _0x467b7f={'product_name':_0x467b7f};});_0xb8f548[_0x3f566b(0x107)]((_0x3f946d,_0x8a736b)=>{var _0x3ae806=_0x3f566b;_0x61b975[_0x3ae806(0x107)]((_0x354e1b,_0x2e44fd)=>{var _0x34c012=_0x3ae806;if(_0x354e1b==_0x34c012(0x6e)&&_0x8a736b==_0x2e44fd){var _0x1d2200=_0x3f946d['slice'](0x3);_0x34a84f[_0x8a736b][_0x34c012(0xc4)]=_0x3f946d[0x0],_0x34a84f[_0x8a736b]['rack']=_0x3f946d[0x1],_0x34a84f[_0x8a736b][_0x34c012(0xad)]=0x0,_0x34a84f[_0x8a736b]['bin']=0x0,_0x34a84f[_0x8a736b]['type']=_0x34c012(0xc6),_0x34a84f[_0x8a736b][_0x34c012(0x100)]=_0x1d2200;}else{if(_0x354e1b==_0x34c012(0x120)&&_0x8a736b==_0x2e44fd){var _0x1d2200=_0x3f946d[_0x34c012(0x85)](0x3);_0x34a84f[_0x8a736b][_0x34c012(0xc4)]=_0x3f946d[0x0],_0x34a84f[_0x8a736b][_0x34c012(0xaf)]=_0x3f946d[0x1],_0x34a84f[_0x8a736b]['bay']=0x0,_0x34a84f[_0x8a736b][_0x34c012(0xa7)]=0x0,_0x34a84f[_0x8a736b]['type']=_0x34c012(0xc6),_0x34a84f[_0x8a736b][_0x34c012(0x100)]=_0x3f946d[0x5];}else{if(_0x8a736b==_0x2e44fd){var _0x4a6f0d;if(_0x3f946d[0x4]=='L')_0x4a6f0d=_0x34c012(0x134);else _0x3f946d[0x4]=='F'&&(_0x4a6f0d=_0x34c012(0xc6));_0x34a84f[_0x8a736b]['storage']=_0x3f946d[0x0],_0x34a84f[_0x8a736b][_0x34c012(0xaf)]=_0x3f946d[0x1],_0x34a84f[_0x8a736b][_0x34c012(0xad)]=_0x3f946d[0x2],_0x34a84f[_0x8a736b][_0x34c012(0xa7)]=_0x3f946d[0x3],_0x34a84f[_0x8a736b][_0x34c012(0xff)]=_0x4a6f0d,_0x34a84f[_0x8a736b][_0x34c012(0x100)]=_0x3f946d[0x5];}}}});}),_0x1b4cbf['forEach']((_0x520f98,_0x36eb2b)=>{var _0x3e4652=_0x3f566b;_0x34a84f[_0x36eb2b][_0x3e4652(0x131)]=_0x520f98;}),_0x55e1a8[_0x3f566b(0x107)]((_0x565864,_0x129599)=>{var _0x38b997=_0x3f566b;_0x34a84f[_0x129599][_0x38b997(0x92)]=_0x565864;}),_0x5836a8[_0x3f566b(0x107)]((_0x4655b8,_0x48ec7f)=>{_0x34a84f[_0x48ec7f]['adjust_qty']=_0x4655b8;}),_0x1418e5['forEach']((_0x4c11d8,_0x11450f)=>{var _0x545b72=_0x3f566b;_0x34a84f[_0x11450f][_0x545b72(0xa6)]=_0x4c11d8;}),_0x11f813[_0x3f566b(0x107)]((_0x16f466,_0x22e85e)=>{var _0x1ddb36=_0x3f566b;_0x34a84f[_0x22e85e][_0x1ddb36(0xbb)]=_0x16f466;}),_0x35fd2e[_0x3f566b(0x107)]((_0x3092f3,_0x409690)=>{var _0x252a00=_0x3f566b;_0x34a84f[_0x409690][_0x252a00(0xac)]=_0x3092f3;}),_0x23c585[_0x3f566b(0x107)]((_0x3b76cc,_0x228a59)=>{var _0x125f65=_0x3f566b;_0x34a84f[_0x228a59][_0x125f65(0x116)]=_0x3b76cc;}),_0x889c3d[_0x3f566b(0x107)]((_0x283dff,_0x1e284a)=>{var _0x3b534a=_0x3f566b;_0x34a84f[_0x1e284a][_0x3b534a(0xdd)]=_0x283dff;}),_0x1e86ce[_0x3f566b(0x107)]((_0x409f36,_0x1e4d44)=>{var _0x10c391=_0x3f566b;_0x34a84f[_0x1e4d44][_0x10c391(0x123)]=_0x409f36;}),_0x5584ed['forEach']((_0x4a7d1a,_0x382bc3)=>{var _0xd72619=_0x3f566b;_0x34a84f[_0x382bc3][_0xd72619(0x11c)]=_0x4a7d1a;}),_0x38be87[_0x3f566b(0x107)]((_0x333fab,_0x19890c)=>{_0x34a84f[_0x19890c]['production_date']=_0x333fab;}),_0x3254f6['forEach']((_0x1b4781,_0x1ea803)=>{_0x34a84f[_0x1ea803]['prod_cat']=_0x1b4781;}),_0x61b975[_0x3f566b(0x107)]((_0x556461,_0x47c174)=>{var _0x34d757=_0x3f566b;_0x34a84f[_0x47c174][_0x34d757(0x102)]=_0x556461;}),_0x5ee1df[_0x3f566b(0x107)]((_0x3861fe,_0x4c35c6)=>{var _0x3cbd6a=_0x3f566b;_0x34a84f[_0x4c35c6][_0x3cbd6a(0x138)]=_0x3861fe;}),_0x48320f['forEach']((_0x1fdd67,_0x4cf61d)=>{var _0x3be49=_0x3f566b;_0x34a84f[_0x4cf61d][_0x3be49(0xd6)]=_0x1fdd67;});const _0x2f465f=_0x34a84f[_0x3f566b(0xaa)](_0xc1acf5=>_0xc1acf5[_0x3f566b(0xfa)]!=='0'&&_0xc1acf5[_0x3f566b(0xfa)]!=='');var _0x470636=0x0;_0x2f465f['forEach'](_0x584d49=>{var _0x370ecb=_0x3f566b;console[_0x370ecb(0x13e)](_0x370ecb(0xb5),_0x584d49),parseInt(_0x584d49[_0x370ecb(0xfa)])<=0x0&&_0x470636++;});if(_0x470636!=0x0)return _0x463dbe[_0x3f566b(0x144)](_0x3f566b(0xe0),_0x3f566b(0x80)),_0x5110cb[_0x3f566b(0xe1)](_0x3f566b(0xde));_0x3b7532['warehouse_name']=_0x30f67b,_0x3b7532['date']=_0x550cbd,_0x3b7532['product']=_0x2f465f,_0x3b7532[_0x3f566b(0x9d)]=_0x1e9e7d,_0x3b7532[_0x3f566b(0x7b)]=_0x5c7efa,_0x3b7532[_0x3f566b(0xa8)]=_0x3f566b(0xda);const _0x4cf7bd=await _0x3b7532[_0x3f566b(0x9b)]();_0x463dbe[_0x3f566b(0x144)](_0x3f566b(0xf5),_0x3f566b(0xd7)),_0x5110cb[_0x3f566b(0xe1)]('/adjustment/view');}catch(_0x280a2a){console[_0x3f566b(0x13e)](_0x280a2a);}}),router[a0_0x3b0b97(0x115)]('/barcode_scanner',async(_0x572e8a,_0x59b5c4)=>{var _0x365517=a0_0x3b0b97;const {primary_code:_0x74cfd4,warehouse_data:_0x5c7a2f,rooms_data:_0x16e5ab,Roomslist:_0x52233b}=_0x572e8a[_0x365517(0xd4)],_0xbbd7fc=_0x52233b[_0x365517(0x10c)](','),_0x2ad577=[];async function _0x4618ac(_0x5daea1){var _0x9446cc=_0x365517;const _0x40502e=await warehouse['aggregate']([{'$match':{'name':_0x5c7a2f,'room':_0x5daea1}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x74cfd4}},{'$group':{'_id':_0x9446cc(0x9c),'name':{'$first':_0x9446cc(0x137)},'product_stock':{'$first':_0x9446cc(0x12d)},'primary_code':{'$first':_0x9446cc(0x13a)},'secondary_code':{'$first':_0x9446cc(0xab)},'product_code':{'$first':_0x9446cc(0x9f)},'level':{'$first':_0x9446cc(0x114)},'isle':{'$first':_0x9446cc(0xe4)},'type':{'$first':_0x9446cc(0x11e)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x9446cc(0x7a)},'secondary_unit':{'$first':_0x9446cc(0x91)},'storage':{'$first':_0x9446cc(0xca)},'rack':{'$first':_0x9446cc(0x121)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x9446cc(0xa5)},'maxPerUnit':{'$first':_0x9446cc(0xea)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x9446cc(0xf8)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x9446cc(0x94)},'invoice':{'$first':_0x9446cc(0x132)}}}]),_0x3aa701=await warehouse['aggregate']([{'$match':{'name':_0x5c7a2f,'room':_0x5daea1}},{'$unwind':_0x9446cc(0x86)},{'$match':{'product_details.secondary_code':_0x74cfd4}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x9446cc(0x137)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x9446cc(0xab)},'product_code':{'$first':_0x9446cc(0x9f)},'level':{'$first':_0x9446cc(0x114)},'isle':{'$first':_0x9446cc(0xe4)},'type':{'$first':_0x9446cc(0x11e)},'pallet':{'$first':_0x9446cc(0x8a)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x9446cc(0x121)},'expiry_date':{'$first':_0x9446cc(0x7d)},'production_date':{'$first':_0x9446cc(0xa5)},'maxPerUnit':{'$first':_0x9446cc(0xea)},'batch_code':{'$first':_0x9446cc(0x10a)},'product_cat':{'$first':_0x9446cc(0xf8)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x9446cc(0x94)}}}]);if(_0x40502e[_0x9446cc(0xc0)]>0x0)_0x2ad577['push'](_0x40502e);else _0x3aa701[_0x9446cc(0xc0)]>0x0&&_0x2ad577[_0x9446cc(0x89)](_0x3aa701);}const _0x3facbd=_0xbbd7fc['map'](_0x218363=>_0x4618ac(_0x218363));await Promise[_0x365517(0x96)](_0x3facbd),_0x59b5c4[_0x365517(0xcb)](_0x2ad577);}),router['post'](a0_0x3b0b97(0x133),async(_0x59411f,_0x47d15f)=>{var _0x5a0ba7=a0_0x3b0b97;const {primaryCode:_0x59b17e,secondaryCode:_0x3e89c2,productCode:_0x400cbd,level:_0x2490fe,isle:_0x1b3df6,pallet:_0x387b1f,warehouses:_0x245641,room:_0x3782d0}=_0x59411f[_0x5a0ba7(0xd4)];try{const _0x13a3a4=await warehouse[_0x5a0ba7(0x139)]([{'$match':{'name':_0x245641,'room':_0x3782d0}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x2490fe),'product_details.isle':_0x1b3df6,'product_details.pallet':parseInt(_0x387b1f)}},{'$group':{'_id':_0x5a0ba7(0x9c),'name':{'$first':_0x5a0ba7(0x137)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x5a0ba7(0xe5)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x5a0ba7(0x105)}}}]);_0x47d15f['status'](0xc8)[_0x5a0ba7(0xcb)](_0x13a3a4);}catch(_0x21ec07){_0x47d15f[_0x5a0ba7(0x83)](0x194)[_0x5a0ba7(0xcb)]({'message':_0x21ec07[_0x5a0ba7(0x74)]});}}),module['exports']=router;