var a0_0xa170e7=a0_0x3cfe;(function(_0x5442bc,_0x2ed2bd){var _0x200b1b=a0_0x3cfe,_0x2a1090=_0x5442bc();while(!![]){try{var _0x381460=-parseInt(_0x200b1b(0xea))/0x1*(parseInt(_0x200b1b(0xb2))/0x2)+-parseInt(_0x200b1b(0x122))/0x3*(parseInt(_0x200b1b(0xcc))/0x4)+-parseInt(_0x200b1b(0x102))/0x5*(-parseInt(_0x200b1b(0xfa))/0x6)+parseInt(_0x200b1b(0x104))/0x7+parseInt(_0x200b1b(0xf4))/0x8*(-parseInt(_0x200b1b(0x16b))/0x9)+parseInt(_0x200b1b(0x142))/0xa*(parseInt(_0x200b1b(0xb1))/0xb)+-parseInt(_0x200b1b(0xe4))/0xc*(parseInt(_0x200b1b(0x9d))/0xd);if(_0x381460===_0x2ed2bd)break;else _0x2a1090['push'](_0x2a1090['shift']());}catch(_0x5ba72e){_0x2a1090['push'](_0x2a1090['shift']());}}}(a0_0x25f0,0xe76e6));function a0_0x25f0(){var _0x5d3b32=['$product_details.expiry_date','<!DOCTYPE\x20html>','/adjustment/view','$product_details.type','push','add_adjustment','nodemailer','prod_invoice','flash','$product_details.floorlevel','<h2>\x20','status','production_date','render','/adjustment/preview/','$product_details.secondary_unit','all','Portuguese','port','8tutgoZ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','batch_code','</div>','random','date','invoice','prod_cat','post','$product_details.unit','level','/preview/:id','$product_details.production_date','errors','$product_details.batch_code','product_stock','English','<h5>','filter','/view/add_adjustment','Email\x20sent\x20successfully','back','aggregate','$product_details','1356LEWUrp','rack','find','\x20Order\x20Date\x20:\x20','product_code','../models/all_models','321lUfqPj','success','prod_code','edit_adjustment','$product_details.bin','bin','$product_details.maxPerUnit','stock','storage','unit','5256904PkSuFM','type','get','$product_details.bay','New_Qty_Converted','role','1390224VxzSum','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','slice','Ambient','warehouse','English\x20(US)','</tbody>','<html><head><title></title>','15YnXLWZ','exports','10436720VCqifX','$product_details.rack','$date','site_title','../middleware/auth','body','warehouse_name','<span\x20style=\x22float:\x20right;\x22>','map','language','message','primary_code','<tr>','redirect','Floor','There\x27s\x20a\x20error\x20in\x20this\x20transaction','catch','$product_details.product_stock','Spanish','Error\x20Occurs','user','/picking_list/PDF_adjustment_rm/','save','split','</head><body>','Rooms','German','An\x20error\x20occurred.','$product_details.product_code','adjust_qty','496479FcawdM','room_names','$product_details.product_name','floorlevel','email','types','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','prod_name','RMSEmail','$product_details.product_cat','_id','second1','secondary_unit','Return\x20Goods','maxperunit','$product_details.maxProducts','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.invoice','id_transaction_from','</table>','Hindi','bay','$_id','Enabled','/CheckingWarehouse','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','createTransport','note','host','</span>','1420mpzqQW','/upload/','secondary_code','then','\x20<>\x20','json','../public/language/languages.json','length','Arabic\x20(ae)','string','\x20</h2>','</body></html>','French','stockBefore','$name','True','<div>','Level','$product_details.storage','prime1','$room','express','log','/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<tbody\x20style=\x22text-align:\x20center;\x22>','New_Qty_Converted_adj','findOne','new_adjust_qty','Chinese','$product_details.level','ADJ-','forEach','Receiving\x20Area','$product','False','Arabic','isAllowEdit','Return\x20Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','9bZEJSS','max_per_unit','$product.product_name','$product_details._id','</h5>','product_name','password','34879ngmzpw','$invoice','product','Portuguese\x20(BR)','params','findById','padStart','staff','/barcode_scanner','master','id_transaction','\x20Order\x20Number\x20:\x20','$product_details.pallet','Secondary_units','$product_details.primary_code','</td>','$product_details.secondary_code','/view/:id','adjustment','</tr>','58773QEbMRo','4396ZuMvkz','expiry_date','$product_details.isle','error','Raw\x20Materials','adjustment\x20data\x20update\x20successfully','</thead>'];a0_0x25f0=function(){return _0x5d3b32;};return a0_0x25f0();}const express=require(a0_0xa170e7(0x157)),app=express(),router=express['Router'](),auth=require(a0_0xa170e7(0x108)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0xa170e7(0xe9)),users=require(a0_0xa170e7(0x148)),nodemailer=require(a0_0xa170e7(0xbf));function a0_0x3cfe(_0x18af41,_0x4a4edf){var _0x25f053=a0_0x25f0();return a0_0x3cfe=function(_0x3cfe5e,_0x330192){_0x3cfe5e=_0x3cfe5e-0x9c;var _0x59d306=_0x25f053[_0x3cfe5e];return _0x59d306;},a0_0x3cfe(_0x18af41,_0x4a4edf);}router[a0_0xa170e7(0xf6)](a0_0xa170e7(0x159),auth,async(_0x9beb71,_0x2206b3)=>{var _0x313434=a0_0xa170e7;try{const {username:_0x462e8d,email:_0x2a2951,role:_0x262826}=_0x9beb71['user'],_0x25e86c=_0x9beb71[_0x313434(0x118)],_0x764e6b=await profile[_0x313434(0x15d)]({'email':_0x25e86c['email']}),_0xb84a0=await master_shop[_0x313434(0xe6)]();console[_0x313434(0x158)](_0x313434(0xa6),_0xb84a0);let _0x55cb57;if(_0x25e86c['role']==_0x313434(0xa4)){const _0x4d6893=await staff[_0x313434(0x15d)]({'email':_0x25e86c[_0x313434(0x126)]});_0x55cb57=await warehouse['find']({'status':_0x313434(0x139),'name':_0x4d6893[_0x313434(0xfe)]});}else _0x55cb57=await warehouse[_0x313434(0xe6)]({'status':_0x313434(0x139)});const _0x24fab8=await product['find']();let _0x56a6ce;if(_0x25e86c[_0x313434(0xf9)]=='staff'){const _0x394960=await staff[_0x313434(0x15d)]({'email':_0x25e86c['email']});_0x56a6ce=await adjustment[_0x313434(0xe6)]({'warehouse_name':_0x394960[_0x313434(0xfe)]});}else _0x56a6ce=await adjustment['aggregate']([{'$unwind':_0x313434(0x164)},{'$group':{'_id':_0x313434(0x138),'invoice':{'$first':_0x313434(0x9e)},'date':{'$first':_0x313434(0x106)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xb84a0[0x0][_0x313434(0x10d)]==_0x313434(0xff)){var _0x51f65e=users['English'];console[_0x313434(0x158)](_0x51f65e);}else{if(_0xb84a0[0x0][_0x313434(0x10d)]==_0x313434(0x136))var _0x51f65e=users[_0x313434(0x136)];else{if(_0xb84a0[0x0][_0x313434(0x10d)]==_0x313434(0x11e))var _0x51f65e=users['German'];else{if(_0xb84a0[0x0][_0x313434(0x10d)]==_0x313434(0x116))var _0x51f65e=users[_0x313434(0x116)];else{if(_0xb84a0[0x0][_0x313434(0x10d)]==_0x313434(0x14e))var _0x51f65e=users[_0x313434(0x14e)];else{if(_0xb84a0[0x0][_0x313434(0x10d)]==_0x313434(0xa0))var _0x51f65e=users[_0x313434(0xca)];else{if(_0xb84a0[0x0][_0x313434(0x10d)]==_0x313434(0x15f))var _0x51f65e=users[_0x313434(0x15f)];else{if(_0xb84a0[0x0][_0x313434(0x10d)]==_0x313434(0x14a))var _0x51f65e=users['Arabic'];}}}}}}}_0x2206b3['render'](_0x313434(0xaf),{'success':_0x9beb71[_0x313434(0xc1)](_0x313434(0xeb)),'errors':_0x9beb71[_0x313434(0xc1)](_0x313434(0xd9)),'role':_0x25e86c,'profile':_0x764e6b,'warehouse':_0x55cb57,'product':_0x24fab8,'adjustment':_0x56a6ce,'master_shop':_0xb84a0,'language':_0x51f65e});}catch(_0x1e83d4){console[_0x313434(0x158)](_0x1e83d4);}});async function getRandom8DigitNumber(){var _0x3264c9=a0_0xa170e7;const _0x4feeec=0x989680,_0x4a71e2=0x5f5e0ff,_0x597da8=Math['floor'](Math[_0x3264c9(0xd0)]()*(_0x4a71e2-_0x4feeec+0x1))+_0x4feeec;var _0x325798;const _0x1870a1=await adjustment['findOne']({'invoice':'ADJ-'+_0x597da8});return _0x1870a1&&_0x1870a1[_0x3264c9(0x149)]>0x0?_0x325798='ADJ-'+_0x597da8:_0x325798=_0x3264c9(0x161)+_0x597da8,_0x325798;}router[a0_0xa170e7(0xf6)](a0_0xa170e7(0xdf),auth,async(_0x597e05,_0x4d92c9)=>{var _0xe793d0=a0_0xa170e7;try{const {username:_0x450bca,email:_0x2f5ff0,role:_0x42077b}=_0x597e05[_0xe793d0(0x118)],_0x1af62c=_0x597e05['user'],_0x37b02e=await profile['findOne']({'email':_0x1af62c[_0xe793d0(0x126)]}),_0x575b75=await master_shop[_0xe793d0(0xe6)]();let _0x19fd81;if(_0x1af62c['role']==_0xe793d0(0xa4)){const _0x427546=await staff['findOne']({'email':_0x1af62c[_0xe793d0(0x126)]});_0x19fd81=await warehouse['aggregate']([{'$match':{'status':_0xe793d0(0x139),'name':_0x427546[_0xe793d0(0xfe)],'warehouse_category':_0xe793d0(0xb6),'name':{'$ne':_0xe793d0(0x12f)}}},{'$group':{'_id':_0xe793d0(0x150),'name':{'$first':_0xe793d0(0x150)}}}]);}else _0x19fd81=await warehouse[_0xe793d0(0xe2)]([{'$match':{'status':_0xe793d0(0x139),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0xe793d0(0x12f)}}},{'$group':{'_id':'$name','name':{'$first':_0xe793d0(0x150)}}}]);const _0xd4cd9b=await product['find']({}),_0x3df903=await adjustment[_0xe793d0(0xe6)]({}),_0x2d35f1=_0x3df903[_0xe793d0(0x149)]+0x1,_0x2fc6a5=_0xe793d0(0x161)+_0x2d35f1['toString']()[_0xe793d0(0xa3)](0x5,'0');var _0x1c3ca6=[_0xe793d0(0xfd),'Enclosed',_0xe793d0(0x168)];if(_0x575b75[0x0][_0xe793d0(0x10d)]=='English\x20(US)')var _0x186d9f=users[_0xe793d0(0xdc)];else{if(_0x575b75[0x0][_0xe793d0(0x10d)]==_0xe793d0(0x136))var _0x186d9f=users[_0xe793d0(0x136)];else{if(_0x575b75[0x0][_0xe793d0(0x10d)]=='German')var _0x186d9f=users[_0xe793d0(0x11e)];else{if(_0x575b75[0x0][_0xe793d0(0x10d)]==_0xe793d0(0x116))var _0x186d9f=users[_0xe793d0(0x116)];else{if(_0x575b75[0x0][_0xe793d0(0x10d)]==_0xe793d0(0x14e))var _0x186d9f=users[_0xe793d0(0x14e)];else{if(_0x575b75[0x0]['language']==_0xe793d0(0xa0))var _0x186d9f=users[_0xe793d0(0xca)];else{if(_0x575b75[0x0][_0xe793d0(0x10d)]==_0xe793d0(0x15f))var _0x186d9f=users[_0xe793d0(0x15f)];else{if(_0x575b75[0x0][_0xe793d0(0x10d)]==_0xe793d0(0x14a))var _0x186d9f=users[_0xe793d0(0x166)];}}}}}}}const _0x536605=getRandom8DigitNumber();_0x536605[_0xe793d0(0x145)](_0x3e1f89=>{var _0xfb2002=_0xe793d0;_0x4d92c9[_0xfb2002(0xc6)](_0xfb2002(0xbe),{'success':_0x597e05[_0xfb2002(0xc1)](_0xfb2002(0xeb)),'errors':_0x597e05[_0xfb2002(0xc1)](_0xfb2002(0xd9)),'role':_0x1af62c,'profile':_0x37b02e,'warehouse':_0x19fd81,'product':_0xd4cd9b,'master_shop':_0x575b75,'language':_0x186d9f,'rooms_data':_0x1c3ca6,'invoice_no':_0x3e1f89});})[_0xe793d0(0x114)](_0x3acef5=>{var _0xb97fea=_0xe793d0;_0x597e05[_0xb97fea(0xc1)]('errors',_0xb97fea(0x113)),_0x4d92c9[_0xb97fea(0x111)](_0xb97fea(0xbb));});}catch(_0x4d2b0a){console[_0xe793d0(0x158)](_0x4d2b0a);}}),router[a0_0xa170e7(0xd4)](a0_0xa170e7(0xdf),auth,async(_0x41274c,_0x3cacb0)=>{var _0x3f6ecf=a0_0xa170e7;try{const {warehouse_name:_0x5e5701,date:_0x2f9b9c,prod_name:_0x2644da,level:_0x9d577d,isle:_0x271451,pallet:_0x228929,stock:_0x12be32,types:_0x3fc5da,adjust_qty:_0x1c81e1,new_adjust_qty:_0x509452,note:_0x4fdc39,Room_name:_0x4ed3cb,invoice:_0x586b0b,JO_number:_0x5c15f4,expiry_date:_0x28cb4e}=_0x41274c[_0x3f6ecf(0x109)];if(typeof _0x2644da==_0x3f6ecf(0x14b))var _0x555110=[_0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0x129)]],_0x25ad7d=[_0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xd6)]],_0x40cf59=[_0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xf1)]],_0x8720d1=[_0x41274c[_0x3f6ecf(0x109)]['types']],_0x5cec78=[_0x41274c['body'][_0x3f6ecf(0x15c)]],_0x44977f=[_0x41274c['body'][_0x3f6ecf(0xf8)]],_0x4c47d0=[_0x41274c[_0x3f6ecf(0x109)]['Primary_Units']],_0x4bd468=[_0x41274c[_0x3f6ecf(0x109)]['Secondary_units']],_0xefb465=[_0x41274c['body'][_0x3f6ecf(0xec)]],_0x5c996b=[_0x41274c[_0x3f6ecf(0x109)]['batch_code']],_0x25978b=[_0x41274c['body'][_0x3f6ecf(0xb3)]],_0x3d8fee=[_0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0x16c)]],_0xaab7ab=[_0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xc5)]],_0x574755=[_0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xd3)]],_0x10e762=[_0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0x11d)]],_0x41a968=[_0x41274c['body'][_0x3f6ecf(0x155)]],_0x3b599f=[_0x41274c['body'][_0x3f6ecf(0x12d)]],_0x395bb5=[_0x41274c['body'][_0x3f6ecf(0xc0)]],_0x1cc128=[_0x41274c['body'][_0x3f6ecf(0xa7)]];else var _0x555110=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0x129)]],_0x25ad7d=[..._0x41274c['body'][_0x3f6ecf(0xd6)]],_0x40cf59=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xf1)]],_0x8720d1=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0x127)]],_0x5cec78=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0x15c)]],_0x44977f=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xf8)]],_0x4c47d0=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xf3)]],_0x4bd468=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xaa)]],_0xefb465=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xec)]],_0x5c996b=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xce)]],_0x25978b=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xb3)]],_0x3d8fee=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0x16c)]],_0xaab7ab=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xc5)]],_0x574755=[..._0x41274c[_0x3f6ecf(0x109)]['prod_cat']],_0x10e762=[..._0x41274c['body'][_0x3f6ecf(0x11d)]],_0x41a968=[..._0x41274c['body']['prime1']],_0x3b599f=[..._0x41274c['body'][_0x3f6ecf(0x12d)]],_0x395bb5=[..._0x41274c['body']['prod_invoice']],_0x1cc128=[..._0x41274c[_0x3f6ecf(0x109)][_0x3f6ecf(0xa7)]];const _0x535e5d=_0x555110[_0x3f6ecf(0x10c)](_0x5ca206=>{return _0x5ca206={'product_name':_0x5ca206};});_0x25ad7d[_0x3f6ecf(0x162)]((_0x445a21,_0x46b4ee)=>{var _0x587e47=_0x3f6ecf;_0x10e762[_0x587e47(0x162)]((_0x560572,_0x3e7c1a)=>{var _0x19c0c0=_0x587e47;if(_0x560572==_0x19c0c0(0x163)&&_0x46b4ee==_0x3e7c1a){var _0x4ec686=_0x445a21['slice'](0x3);_0x535e5d[_0x46b4ee][_0x19c0c0(0xf2)]=_0x445a21[0x0],_0x535e5d[_0x46b4ee][_0x19c0c0(0xe5)]=_0x445a21[0x1],_0x535e5d[_0x46b4ee][_0x19c0c0(0x137)]=0x0,_0x535e5d[_0x46b4ee][_0x19c0c0(0xef)]=0x0,_0x535e5d[_0x46b4ee][_0x19c0c0(0xf5)]=_0x19c0c0(0x112),_0x535e5d[_0x46b4ee]['floorlevel']=_0x4ec686;}else{if(_0x560572=='Shelves'&&_0x46b4ee==_0x3e7c1a){var _0x4ec686=_0x445a21[_0x19c0c0(0xfc)](0x3);_0x535e5d[_0x46b4ee]['storage']=_0x445a21[0x0],_0x535e5d[_0x46b4ee][_0x19c0c0(0xe5)]=_0x445a21[0x1],_0x535e5d[_0x46b4ee]['bay']=0x0,_0x535e5d[_0x46b4ee][_0x19c0c0(0xef)]=0x0,_0x535e5d[_0x46b4ee]['type']=_0x19c0c0(0x112),_0x535e5d[_0x46b4ee][_0x19c0c0(0x125)]=_0x445a21[0x5];}else{if(_0x46b4ee==_0x3e7c1a){var _0x115608;if(_0x445a21[0x4]=='L')_0x115608=_0x19c0c0(0x153);else _0x445a21[0x4]=='F'&&(_0x115608=_0x19c0c0(0x112));_0x535e5d[_0x46b4ee][_0x19c0c0(0xf2)]=_0x445a21[0x0],_0x535e5d[_0x46b4ee][_0x19c0c0(0xe5)]=_0x445a21[0x1],_0x535e5d[_0x46b4ee][_0x19c0c0(0x137)]=_0x445a21[0x2],_0x535e5d[_0x46b4ee]['bin']=_0x445a21[0x3],_0x535e5d[_0x46b4ee]['type']=_0x115608,_0x535e5d[_0x46b4ee]['floorlevel']=_0x445a21[0x5];}}}});}),_0x40cf59[_0x3f6ecf(0x162)]((_0x4fca28,_0x1ad331)=>{var _0x443325=_0x3f6ecf;_0x535e5d[_0x1ad331][_0x443325(0x14f)]=_0x4fca28;}),_0x1cc128[_0x3f6ecf(0x162)]((_0x64050f,_0x1f1fce)=>{var _0x373e02=_0x3f6ecf;_0x535e5d[_0x1f1fce][_0x373e02(0x134)]=_0x64050f;}),_0x8720d1[_0x3f6ecf(0x162)]((_0x5db21d,_0x700082)=>{var _0x1edf4a=_0x3f6ecf;_0x535e5d[_0x700082][_0x1edf4a(0x127)]=_0x5db21d;}),_0x5cec78[_0x3f6ecf(0x162)]((_0x255fd2,_0x542a88)=>{_0x535e5d[_0x542a88]['adjust_qty']=_0x255fd2;}),_0x44977f[_0x3f6ecf(0x162)]((_0x29e036,_0x105649)=>{_0x535e5d[_0x105649]['new_adjust_qty']=_0x29e036;}),_0x4c47d0[_0x3f6ecf(0x162)]((_0x32c8ca,_0x59f819)=>{var _0x31adf1=_0x3f6ecf;_0x535e5d[_0x59f819][_0x31adf1(0xf3)]=_0x32c8ca;}),_0x4bd468[_0x3f6ecf(0x162)]((_0x4bd895,_0x48faed)=>{var _0x156880=_0x3f6ecf;_0x535e5d[_0x48faed][_0x156880(0x12e)]=_0x4bd895;}),_0xefb465['forEach']((_0x2fe06c,_0x21f782)=>{_0x535e5d[_0x21f782]['product_code']=_0x2fe06c;}),_0x5c996b[_0x3f6ecf(0x162)]((_0x3751e0,_0x53241b)=>{var _0x43657f=_0x3f6ecf;_0x535e5d[_0x53241b][_0x43657f(0xce)]=_0x3751e0;}),_0x25978b['forEach']((_0x27d9e4,_0x38d018)=>{var _0x4772b=_0x3f6ecf;_0x535e5d[_0x38d018][_0x4772b(0xb3)]=_0x27d9e4;}),_0x3d8fee['forEach']((_0x839412,_0x75be6a)=>{var _0x14396f=_0x3f6ecf;_0x535e5d[_0x75be6a][_0x14396f(0x130)]=_0x839412;}),_0xaab7ab[_0x3f6ecf(0x162)]((_0x4050a4,_0xb937c9)=>{var _0x42c973=_0x3f6ecf;_0x535e5d[_0xb937c9][_0x42c973(0xc5)]=_0x4050a4;}),_0x574755[_0x3f6ecf(0x162)]((_0x524e90,_0xa6cab3)=>{var _0x3a455c=_0x3f6ecf;_0x535e5d[_0xa6cab3][_0x3a455c(0xd3)]=_0x524e90;}),_0x10e762['forEach']((_0x3f2090,_0x2c5ae3)=>{_0x535e5d[_0x2c5ae3]['room_names']=_0x3f2090;}),_0x41a968[_0x3f6ecf(0x162)]((_0xa5ed2a,_0x335dda)=>{var _0x404f85=_0x3f6ecf;_0x535e5d[_0x335dda][_0x404f85(0x10f)]=_0xa5ed2a;}),_0x3b599f[_0x3f6ecf(0x162)]((_0x590d87,_0x4367e9)=>{var _0x14c71f=_0x3f6ecf;_0x535e5d[_0x4367e9][_0x14c71f(0x144)]=_0x590d87;}),_0x395bb5['forEach']((_0x577d67,_0x3180bb)=>{var _0x4715da=_0x3f6ecf;_0x535e5d[_0x3180bb][_0x4715da(0xd2)]=_0x577d67;});const _0x10f718=_0x535e5d[_0x3f6ecf(0xde)](_0x27e197=>_0x27e197[_0x3f6ecf(0x121)]!=='0'&&_0x27e197[_0x3f6ecf(0x121)]!=='');var _0x466d30=0x0;_0x10f718[_0x3f6ecf(0x162)](_0x2883ea=>{console['log']('foreach\x20newproduct',_0x2883ea),parseInt(_0x2883ea['adjust_qty'])<=0x0&&_0x466d30++;});if(_0x466d30!=0x0)return _0x41274c['flash'](_0x3f6ecf(0xd9),_0x3f6ecf(0x16a)),_0x3cacb0['redirect']('back');const _0xb7123f=new adjustment({'warehouse_name':_0x5e5701,'date':_0x2f9b9c,'product':_0x10f718,'note':_0x4fdc39,'room':_0x4ed3cb,'invoice':_0x586b0b,'JO_number':_0x5c15f4,'expiry_date':_0x28cb4e}),_0x74d632=await _0xb7123f[_0x3f6ecf(0x11a)]();_0x41274c[_0x3f6ecf(0xc1)](_0x3f6ecf(0xeb),'adjustment\x20add\x20successfull'),_0x3cacb0['redirect'](_0x3f6ecf(0xc7)+_0x74d632[_0x3f6ecf(0x12c)]);}catch(_0x2c40c3){console[_0x3f6ecf(0x158)](_0x2c40c3),_0x3cacb0[_0x3f6ecf(0xc4)](0xc8)['json']({'message':_0x2c40c3['message']});}}),router[a0_0xa170e7(0xf6)](a0_0xa170e7(0xd7),auth,async(_0x58b684,_0xf34227)=>{var _0x2b6ce3=a0_0xa170e7;try{const {username:_0x372872,email:_0x29e23e,role:_0x41c912}=_0x58b684[_0x2b6ce3(0x118)],_0x4db940=_0x58b684[_0x2b6ce3(0x118)],_0x52e61e=await profile[_0x2b6ce3(0x15d)]({'email':_0x4db940[_0x2b6ce3(0x126)]}),_0x4eb432=await master_shop[_0x2b6ce3(0xe6)](),_0x38d117=_0x58b684[_0x2b6ce3(0xa1)]['id'],_0x1917a8=await adjustment[_0x2b6ce3(0xa2)]({'_id':_0x38d117}),_0x380356=await purchases[_0x2b6ce3(0xe2)]([{'$match':{'warehouse_name':_0x1917a8['warehouse_name']}},{'$unwind':_0x2b6ce3(0x164)},{'$group':{'_id':_0x2b6ce3(0x16d)}}]),_0x39b269=await product['find']({}),_0x5a7f6a=await warehouse[_0x2b6ce3(0xe2)]([{'$match':{'name':_0x1917a8[_0x2b6ce3(0x10a)]}},{'$unwind':_0x2b6ce3(0xe3)},{'$group':{'_id':_0x2b6ce3(0x16e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2b6ce3(0x115)},'bay':{'$first':_0x2b6ce3(0xf7)},'bin':{'$first':_0x2b6ce3(0xee)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x2b6ce3(0xc2)},'primary_code':{'$first':_0x2b6ce3(0xab)},'secondary_code':{'$first':_0x2b6ce3(0xad)},'product_code':{'$first':_0x2b6ce3(0x120)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2b6ce3(0x105)},'maxPerUnit':{'$first':_0x2b6ce3(0xf0)},'expiry_date':{'$first':_0x2b6ce3(0xb9)},'production_date':{'$first':_0x2b6ce3(0xd8)},'batch_code':{'$first':_0x2b6ce3(0xda)},'room':{'$first':'$room'}}}]);if(_0x4eb432[0x0][_0x2b6ce3(0x10d)]==_0x2b6ce3(0xff)){var _0x441d65=users[_0x2b6ce3(0xdc)];console['log'](_0x441d65);}else{if(_0x4eb432[0x0][_0x2b6ce3(0x10d)]==_0x2b6ce3(0x136))var _0x441d65=users['Hindi'];else{if(_0x4eb432[0x0][_0x2b6ce3(0x10d)]==_0x2b6ce3(0x11e))var _0x441d65=users['German'];else{if(_0x4eb432[0x0][_0x2b6ce3(0x10d)]==_0x2b6ce3(0x116))var _0x441d65=users[_0x2b6ce3(0x116)];else{if(_0x4eb432[0x0][_0x2b6ce3(0x10d)]==_0x2b6ce3(0x14e))var _0x441d65=users[_0x2b6ce3(0x14e)];else{if(_0x4eb432[0x0][_0x2b6ce3(0x10d)]==_0x2b6ce3(0xa0))var _0x441d65=users[_0x2b6ce3(0xca)];else{if(_0x4eb432[0x0]['language']=='Chinese')var _0x441d65=users['Chinese'];else{if(_0x4eb432[0x0][_0x2b6ce3(0x10d)]==_0x2b6ce3(0x14a))var _0x441d65=users['Arabic'];}}}}}}}_0xf34227[_0x2b6ce3(0xc6)]('edit_adjustment_view',{'success':_0x58b684['flash'](_0x2b6ce3(0xeb)),'errors':_0x58b684['flash'](_0x2b6ce3(0xd9)),'role':_0x4db940,'profile':_0x52e61e,'adjustment':_0x1917a8,'stock':_0x5a7f6a,'master_shop':_0x4eb432,'warehouse_name':_0x380356,'unit':_0x39b269,'language':_0x441d65});}catch(_0xe61ec){console[_0x2b6ce3(0x158)](_0xe61ec),_0xf34227[_0x2b6ce3(0xc4)](0xc8)[_0x2b6ce3(0x147)]({'message':_0xe61ec[_0x2b6ce3(0x10e)]});}}),router[a0_0xa170e7(0xd4)]('/preview/:id',auth,async(_0x4a6abf,_0x4f05b1)=>{var _0x5db38e=a0_0xa170e7;try{const _0x3599ef=_0x4a6abf[_0x5db38e(0xa1)]['id'],{warehouse_name:_0x2acc68,Room_name:_0x5a610b}=_0x4a6abf['body'],_0x43f929=await adjustment[_0x5db38e(0xa2)]({'_id':_0x3599ef}),_0x141909=_0x43f929['product']['map'](async _0x4d4b97=>{var _0x4579e7=_0x5db38e;if(_0x4d4b97[_0x4579e7(0x121)]>0x0){var _0x112001=await warehouse[_0x4579e7(0x15d)]({'name':_0x2acc68,'room':_0x4d4b97[_0x4579e7(0x123)],'warehouse_category':'Raw\x20Materials'});const _0x9755d8=_0x112001['product_details'][_0x4579e7(0x10c)](_0x5d2d05=>{var _0x2a4b70=_0x4579e7;console[_0x2a4b70(0x158)](_0x4d4b97['types']+_0x2a4b70(0x146));if(_0x4d4b97['types']=='minus'){if(_0x5d2d05['product_name']==_0x4d4b97[_0x2a4b70(0x170)]&&_0x5d2d05[_0x2a4b70(0x125)]==_0x4d4b97[_0x2a4b70(0x125)]&&_0x5d2d05[_0x2a4b70(0xf5)]==_0x4d4b97[_0x2a4b70(0xf5)]&&_0x5d2d05[_0x2a4b70(0xef)]==_0x4d4b97[_0x2a4b70(0xef)]&&_0x5d2d05['bay']==_0x4d4b97[_0x2a4b70(0x137)]&&_0x5d2d05[_0x2a4b70(0xe5)]==_0x4d4b97[_0x2a4b70(0xe5)]&&_0x5d2d05[_0x2a4b70(0xf2)]==_0x4d4b97[_0x2a4b70(0xf2)]&&_0x5d2d05[_0x2a4b70(0xb3)]==_0x4d4b97[_0x2a4b70(0xb3)]&&_0x5d2d05[_0x2a4b70(0xce)]==_0x4d4b97[_0x2a4b70(0xce)]&&_0x5d2d05['production_date']==_0x4d4b97['production_date']&&_0x5d2d05[_0x2a4b70(0xd2)]==_0x4d4b97[_0x2a4b70(0xd2)]&&_0x5d2d05['_id']==_0x4d4b97[_0x2a4b70(0x134)]){var _0x17cb5b;_0x17cb5b=_0x4d4b97[_0x2a4b70(0x121)],_0x4d4b97[_0x2a4b70(0xd3)]=='S'&&(_0x17cb5b=_0x4d4b97[_0x2a4b70(0x121)]),_0x5d2d05[_0x2a4b70(0xdb)]=_0x5d2d05[_0x2a4b70(0xdb)]-_0x17cb5b;}}else{if(_0x5d2d05['product_name']==_0x4d4b97[_0x2a4b70(0x170)]&&_0x5d2d05[_0x2a4b70(0x125)]==_0x4d4b97[_0x2a4b70(0x125)]&&_0x5d2d05['type']==_0x4d4b97[_0x2a4b70(0xf5)]&&_0x5d2d05[_0x2a4b70(0xef)]==_0x4d4b97[_0x2a4b70(0xef)]&&_0x5d2d05[_0x2a4b70(0x137)]==_0x4d4b97['bay']&&_0x5d2d05[_0x2a4b70(0xe5)]==_0x4d4b97['rack']&&_0x5d2d05['storage']==_0x4d4b97['storage']&&_0x5d2d05[_0x2a4b70(0xb3)]==_0x4d4b97[_0x2a4b70(0xb3)]&&_0x5d2d05['batch_code']==_0x4d4b97[_0x2a4b70(0xce)]&&_0x5d2d05[_0x2a4b70(0xc5)]==_0x4d4b97['production_date']&&_0x5d2d05[_0x2a4b70(0xd2)]==_0x4d4b97[_0x2a4b70(0xd2)]&&_0x5d2d05['_id']==_0x4d4b97[_0x2a4b70(0x134)]){console[_0x2a4b70(0x158)](_0x4d4b97);var _0x17cb5b;_0x17cb5b=_0x4d4b97['adjust_qty'],_0x4d4b97[_0x2a4b70(0xd3)]=='S'&&(_0x17cb5b=_0x4d4b97['adjust_qty']),_0x5d2d05[_0x2a4b70(0xdb)]=_0x5d2d05[_0x2a4b70(0xdb)]+_0x17cb5b;}}});}return _0x112001;});Promise[_0x5db38e(0xc9)](_0x141909)[_0x5db38e(0x145)](async _0x59d172=>{var _0x4d3ce6=_0x5db38e;try{for(const _0x1ebf40 of _0x59d172){await _0x1ebf40[_0x4d3ce6(0x11a)]();}_0x43f929['finalize']=_0x4d3ce6(0x151);const _0x19265a=await _0x43f929[_0x4d3ce6(0x11a)](),_0x5d2c14=await master_shop[_0x4d3ce6(0xe6)](),_0x21e848=await email_settings[_0x4d3ce6(0x15d)](),_0x4f6780=await supervisor_settings[_0x4d3ce6(0xe6)]();var _0x36e975=_0x43f929[_0x4d3ce6(0x9f)],_0x34c301='',_0x1c6d0b;for(_0x1c6d0b in _0x36e975){_0x34c301+='<tr>'+_0x4d3ce6(0x13b)+_0x36e975[_0x1c6d0b][_0x4d3ce6(0x170)]+_0x4d3ce6(0xac)+_0x4d3ce6(0x13b)+_0x36e975[_0x1c6d0b][_0x4d3ce6(0xe8)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x36e975[_0x1c6d0b]['adjust_qty']+_0x4d3ce6(0xac)+_0x4d3ce6(0x13b)+_0x36e975[_0x1c6d0b]['unit']+_0x4d3ce6(0xac)+_0x4d3ce6(0x13b)+_0x36e975[_0x1c6d0b][_0x4d3ce6(0x12e)]+_0x4d3ce6(0xac)+_0x4d3ce6(0x13b)+_0x43f929[_0x4d3ce6(0x10a)]+'</td>'+_0x4d3ce6(0x13b)+_0x36e975[_0x1c6d0b][_0x4d3ce6(0x123)]+_0x4d3ce6(0xac)+_0x4d3ce6(0x13b)+_0x36e975[_0x1c6d0b][_0x4d3ce6(0xf2)]+_0x36e975[_0x1c6d0b][_0x4d3ce6(0xe5)]+_0x36e975[_0x1c6d0b][_0x4d3ce6(0x137)]+_0x36e975[_0x1c6d0b]['bin']+_0x36e975[_0x1c6d0b][_0x4d3ce6(0xf5)][0x0]+_0x36e975[_0x1c6d0b][_0x4d3ce6(0x125)]+_0x4d3ce6(0xac),_0x4d3ce6(0xb0);}let _0xed5cd5=nodemailer[_0x4d3ce6(0x13e)]({'host':_0x21e848[_0x4d3ce6(0x140)],'port':Number(_0x21e848[_0x4d3ce6(0xcb)]),'secure':![],'auth':{'user':_0x21e848[_0x4d3ce6(0x126)],'pass':_0x21e848[_0x4d3ce6(0x9c)]}}),_0x3ccb87={'from':_0x21e848[_0x4d3ce6(0x126)],'to':_0x4f6780[0x0][_0x4d3ce6(0x12a)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x4d3ce6(0x143)+_0x5d2c14[0x0]['image'],'cid':'logo'}],'html':_0x4d3ce6(0xba)+_0x4d3ce6(0x101)+_0x4d3ce6(0x11c)+_0x4d3ce6(0x152)+_0x4d3ce6(0x128)+_0x4d3ce6(0x152)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x4d3ce6(0xcf)+_0x4d3ce6(0x152)+_0x4d3ce6(0xc3)+_0x5d2c14[0x0][_0x4d3ce6(0x107)]+_0x4d3ce6(0x14c)+_0x4d3ce6(0xcf)+_0x4d3ce6(0xcf)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x4d3ce6(0x132)+_0x4d3ce6(0xa8)+_0x43f929[_0x4d3ce6(0xd2)]+'\x20'+_0x4d3ce6(0x10b)+_0x4d3ce6(0xe7)+_0x43f929[_0x4d3ce6(0xd1)]+'\x20'+_0x4d3ce6(0x141)+_0x4d3ce6(0x16f)+_0x4d3ce6(0xcf)+_0x4d3ce6(0x13c)+_0x4d3ce6(0xfb)+_0x4d3ce6(0x110)+_0x4d3ce6(0x13d)+_0x4d3ce6(0xcd)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x4d3ce6(0x15a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x4d3ce6(0x169)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+_0x4d3ce6(0xb8)+_0x4d3ce6(0x15b)+'\x20'+_0x34c301+'\x20'+_0x4d3ce6(0x100)+_0x4d3ce6(0x135)+_0x4d3ce6(0x152)+'<strong>\x20Regards\x20</strong>'+_0x4d3ce6(0xdd)+_0x5d2c14[0x0][_0x4d3ce6(0x107)]+_0x4d3ce6(0x16f)+_0x4d3ce6(0xcf)+_0x4d3ce6(0xcf)+_0x4d3ce6(0x14d)};_0xed5cd5['sendMail'](_0x3ccb87,function(_0x11d33a,_0x38df63){var _0x1d3759=_0x4d3ce6;_0x11d33a?(console[_0x1d3759(0x158)](_0x11d33a),console[_0x1d3759(0x158)](_0x1d3759(0x117))):console[_0x1d3759(0x158)](_0x1d3759(0xe0));}),_0x4a6abf['flash'](_0x4d3ce6(0xeb),'adjustment\x20Finalized\x20successfully'),_0x4f05b1[_0x4d3ce6(0x111)](_0x4d3ce6(0x119)+_0x19265a['_id']);}catch(_0x3b6585){console[_0x4d3ce6(0xb5)](_0x3b6585),_0x4f05b1[_0x4d3ce6(0xc4)](0x1f4)[_0x4d3ce6(0x147)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x5db38e(0x114)](_0xb4e6ab=>{var _0xa6af05=_0x5db38e;console[_0xa6af05(0xb5)](_0xb4e6ab),_0x4f05b1[_0xa6af05(0xc4)](0x1f4)['json']({'error':_0xa6af05(0x11f)});});}catch(_0x29b697){console['log'](_0x29b697),_0x4f05b1[_0x5db38e(0xc4)](0xc8)[_0x5db38e(0x147)]({'message':_0x29b697[_0x5db38e(0x10e)]});}}),router[a0_0xa170e7(0xf6)](a0_0xa170e7(0xae),auth,async(_0x19dc88,_0x4aeb8d)=>{var _0x4d3a94=a0_0xa170e7;try{const {username:_0x1b7d02,email:_0x472d9a,role:_0x2c74a2}=_0x19dc88['user'],_0x245ad9=_0x19dc88[_0x4d3a94(0x118)],_0x2ff58c=await profile['findOne']({'email':_0x245ad9[_0x4d3a94(0x126)]}),_0x14f9b0=await master_shop['find'](),_0x15fe0d=_0x19dc88[_0x4d3a94(0xa1)]['id'],_0x4373cb=await adjustment[_0x4d3a94(0xa2)]({'_id':_0x15fe0d}),_0x4f5161=await purchases[_0x4d3a94(0xe2)]([{'$match':{'warehouse_name':_0x4373cb[_0x4d3a94(0x10a)]}},{'$unwind':_0x4d3a94(0x164)},{'$group':{'_id':'$product.product_name'}}]),_0x260e53=await product[_0x4d3a94(0xe6)]({}),_0x39f056=await warehouse['aggregate']([{'$match':{'name':_0x4373cb['warehouse_name']}},{'$unwind':_0x4d3a94(0xe3)},{'$group':{'_id':_0x4d3a94(0x16e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4d3a94(0x115)},'bay':{'$first':_0x4d3a94(0xf7)},'bin':{'$first':_0x4d3a94(0xee)},'type':{'$first':_0x4d3a94(0xbc)},'floorlevel':{'$first':_0x4d3a94(0xc2)},'primary_code':{'$first':_0x4d3a94(0xab)},'secondary_code':{'$first':_0x4d3a94(0xad)},'product_code':{'$first':_0x4d3a94(0x120)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x4d3a94(0xf0)},'expiry_date':{'$first':_0x4d3a94(0xb9)},'production_date':{'$first':_0x4d3a94(0xd8)},'batch_code':{'$first':_0x4d3a94(0xda)},'room':{'$first':_0x4d3a94(0x156)}}}]);let _0x2bf291;if(_0x245ad9[_0x4d3a94(0xf9)]==_0x4d3a94(0xa4)){const _0x18dbef=await staff[_0x4d3a94(0x15d)]({'email':_0x245ad9[_0x4d3a94(0x126)]});_0x2bf291=await warehouse[_0x4d3a94(0xe2)]([{'$match':{'status':_0x4d3a94(0x139),'name':_0x18dbef[_0x4d3a94(0xfe)],'warehouse_category':_0x4d3a94(0xb6),'name':{'$ne':_0x4d3a94(0x12f)}}},{'$group':{'_id':_0x4d3a94(0x150),'name':{'$first':_0x4d3a94(0x150)}}}]);}else _0x2bf291=await warehouse['aggregate']([{'$match':{'status':_0x4d3a94(0x139),'warehouse_category':_0x4d3a94(0xb6),'name':{'$ne':_0x4d3a94(0x12f)}}},{'$group':{'_id':'$name','name':{'$first':_0x4d3a94(0x150)}}}]);if(_0x14f9b0[0x0][_0x4d3a94(0x10d)]==_0x4d3a94(0xff)){var _0x5bad2d=users[_0x4d3a94(0xdc)];console[_0x4d3a94(0x158)](_0x5bad2d);}else{if(_0x14f9b0[0x0][_0x4d3a94(0x10d)]==_0x4d3a94(0x136))var _0x5bad2d=users[_0x4d3a94(0x136)];else{if(_0x14f9b0[0x0][_0x4d3a94(0x10d)]==_0x4d3a94(0x11e))var _0x5bad2d=users[_0x4d3a94(0x11e)];else{if(_0x14f9b0[0x0][_0x4d3a94(0x10d)]==_0x4d3a94(0x116))var _0x5bad2d=users['Spanish'];else{if(_0x14f9b0[0x0][_0x4d3a94(0x10d)]=='French')var _0x5bad2d=users[_0x4d3a94(0x14e)];else{if(_0x14f9b0[0x0]['language']==_0x4d3a94(0xa0))var _0x5bad2d=users[_0x4d3a94(0xca)];else{if(_0x14f9b0[0x0][_0x4d3a94(0x10d)]=='Chinese')var _0x5bad2d=users['Chinese'];else{if(_0x14f9b0[0x0][_0x4d3a94(0x10d)]=='Arabic\x20(ae)')var _0x5bad2d=users[_0x4d3a94(0x166)];}}}}}}}_0x4aeb8d[_0x4d3a94(0xc6)](_0x4d3a94(0xed),{'success':_0x19dc88['flash'](_0x4d3a94(0xeb)),'errors':_0x19dc88[_0x4d3a94(0xc1)](_0x4d3a94(0xd9)),'role':_0x245ad9,'profile':_0x2ff58c,'adjustment':_0x4373cb,'stock':_0x39f056,'master_shop':_0x14f9b0,'warehouse_name':_0x4f5161,'unit':_0x260e53,'language':_0x5bad2d,'warehouse':_0x2bf291});}catch(_0x14e42f){console['log'](_0x14e42f),_0x4aeb8d[_0x4d3a94(0xc4)](0xc8)[_0x4d3a94(0x147)]({'message':_0x14e42f[_0x4d3a94(0x10e)]});}}),router[a0_0xa170e7(0xd4)](a0_0xa170e7(0xae),auth,async(_0x2ad35b,_0x28eb55)=>{var _0x26c5aa=a0_0xa170e7;try{const _0x16f346=_0x2ad35b[_0x26c5aa(0xa1)]['id'],_0x13768e=await adjustment[_0x26c5aa(0xa2)]({'_id':_0x16f346}),_0xe31798=await warehouse[_0x26c5aa(0x15d)]({'name':_0x13768e[_0x26c5aa(0x10a)],'room':_0x13768e['room']}),{warehouse_name:_0x2568f9,date:_0x4d1a94,prod_name:_0x13ba36,level:_0x397320,isle:_0x37f204,pallet:_0x5b93bd,stock:_0x5452ac,types:_0x52cdfd,adjust_qty:_0x2c632e,new_adjust_qty:_0x44abb7,note:_0x31d94f,Room_name:_0x266fb8,invoice:_0x1e61a1,JO_number:_0x1fbce9,expiry_date:_0x36e15a}=_0x2ad35b['body'];if(typeof _0x13ba36==_0x26c5aa(0x14b))var _0x555141=[_0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0x129)]],_0x395d83=[_0x2ad35b['body'][_0x26c5aa(0xd6)]],_0x505586=[_0x2ad35b[_0x26c5aa(0x109)]['stock']],_0x11e2bb=[_0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0x127)]],_0x2d9b5a=[_0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0x15c)]],_0x45c9c2=[_0x2ad35b[_0x26c5aa(0x109)]['New_Qty_Converted']],_0x2d96c5=[_0x2ad35b[_0x26c5aa(0x109)]['Primary_Units']],_0x91a8f6=[_0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0xaa)]],_0x5a7f0b=[_0x2ad35b[_0x26c5aa(0x109)]['prod_code']],_0x5ca480=[_0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0xce)]],_0x2955a0=[_0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0xb3)]],_0x2ae1be=[_0x2ad35b[_0x26c5aa(0x109)]['max_per_unit']],_0x2eaa19=[_0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0xc5)]],_0x5a6c03=[_0x2ad35b['body'][_0x26c5aa(0xd3)]],_0x58a7b9=[_0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0x11d)]],_0xd2074b=[_0x2ad35b['body'][_0x26c5aa(0x155)]],_0x2abdac=[_0x2ad35b['body'][_0x26c5aa(0x12d)]];else var _0x555141=[..._0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0x129)]],_0x395d83=[..._0x2ad35b[_0x26c5aa(0x109)]['level']],_0x505586=[..._0x2ad35b['body']['stock']],_0x11e2bb=[..._0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0x127)]],_0x2d9b5a=[..._0x2ad35b[_0x26c5aa(0x109)]['New_Qty_Converted_adj']],_0x45c9c2=[..._0x2ad35b[_0x26c5aa(0x109)]['New_Qty_Converted']],_0x2d96c5=[..._0x2ad35b[_0x26c5aa(0x109)]['unit']],_0x91a8f6=[..._0x2ad35b['body'][_0x26c5aa(0xaa)]],_0x5a7f0b=[..._0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0xec)]],_0x5ca480=[..._0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0xce)]],_0x2955a0=[..._0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0xb3)]],_0x2ae1be=[..._0x2ad35b[_0x26c5aa(0x109)]['max_per_unit']],_0x2eaa19=[..._0x2ad35b[_0x26c5aa(0x109)]['production_date']],_0x5a6c03=[..._0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0xd3)]],_0x58a7b9=[..._0x2ad35b[_0x26c5aa(0x109)]['Rooms']],_0xd2074b=[..._0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0x155)]],_0x2abdac=[..._0x2ad35b[_0x26c5aa(0x109)][_0x26c5aa(0x12d)]];const _0x355ad8=_0x555141['map'](_0x5f2f0e=>{return _0x5f2f0e={'product_name':_0x5f2f0e};});_0x395d83[_0x26c5aa(0x162)]((_0x572ef5,_0x2ddbbd)=>{_0x58a7b9['forEach']((_0x42c931,_0x21f9c4)=>{var _0x8ba988=a0_0x3cfe;if(_0x42c931=='Receiving\x20Area'&&_0x2ddbbd==_0x21f9c4){var _0x11e9a6=_0x572ef5[_0x8ba988(0xfc)](0x3);_0x355ad8[_0x2ddbbd][_0x8ba988(0xf2)]=_0x572ef5[0x0],_0x355ad8[_0x2ddbbd]['rack']=_0x572ef5[0x1],_0x355ad8[_0x2ddbbd][_0x8ba988(0x137)]=0x0,_0x355ad8[_0x2ddbbd]['bin']=0x0,_0x355ad8[_0x2ddbbd]['type']=_0x8ba988(0x112),_0x355ad8[_0x2ddbbd][_0x8ba988(0x125)]=_0x11e9a6;}else{if(_0x42c931=='Shelves'&&_0x2ddbbd==_0x21f9c4){var _0x11e9a6=_0x572ef5[_0x8ba988(0xfc)](0x3);_0x355ad8[_0x2ddbbd][_0x8ba988(0xf2)]=_0x572ef5[0x0],_0x355ad8[_0x2ddbbd][_0x8ba988(0xe5)]=_0x572ef5[0x1],_0x355ad8[_0x2ddbbd][_0x8ba988(0x137)]=0x0,_0x355ad8[_0x2ddbbd]['bin']=0x0,_0x355ad8[_0x2ddbbd]['type']=_0x8ba988(0x112),_0x355ad8[_0x2ddbbd][_0x8ba988(0x125)]=_0x572ef5[0x5];}else{if(_0x2ddbbd==_0x21f9c4){var _0x1f84b3;if(_0x572ef5[0x4]=='L')_0x1f84b3=_0x8ba988(0x153);else _0x572ef5[0x4]=='F'&&(_0x1f84b3=_0x8ba988(0x112));_0x355ad8[_0x2ddbbd][_0x8ba988(0xf2)]=_0x572ef5[0x0],_0x355ad8[_0x2ddbbd]['rack']=_0x572ef5[0x1],_0x355ad8[_0x2ddbbd][_0x8ba988(0x137)]=_0x572ef5[0x2],_0x355ad8[_0x2ddbbd]['bin']=_0x572ef5[0x3],_0x355ad8[_0x2ddbbd][_0x8ba988(0xf5)]=_0x1f84b3,_0x355ad8[_0x2ddbbd][_0x8ba988(0x125)]=_0x572ef5[0x5];}}}});}),_0x505586[_0x26c5aa(0x162)]((_0xecdc91,_0x4cab42)=>{var _0xa6e485=_0x26c5aa;_0x355ad8[_0x4cab42][_0xa6e485(0x14f)]=_0xecdc91;}),_0x11e2bb[_0x26c5aa(0x162)]((_0x2d071d,_0x513ff9)=>{var _0x5887e9=_0x26c5aa;_0x355ad8[_0x513ff9][_0x5887e9(0x127)]=_0x2d071d;}),_0x2d9b5a[_0x26c5aa(0x162)]((_0x48070a,_0x4ead27)=>{var _0x340045=_0x26c5aa;_0x355ad8[_0x4ead27][_0x340045(0x121)]=_0x48070a;}),_0x45c9c2[_0x26c5aa(0x162)]((_0x1260ed,_0x1c2e40)=>{var _0x7c13d7=_0x26c5aa;_0x355ad8[_0x1c2e40][_0x7c13d7(0x15e)]=_0x1260ed;}),_0x2d96c5['forEach']((_0x433cf5,_0x2def50)=>{_0x355ad8[_0x2def50]['unit']=_0x433cf5;}),_0x91a8f6[_0x26c5aa(0x162)]((_0x309544,_0x54d61b)=>{var _0x3361f5=_0x26c5aa;_0x355ad8[_0x54d61b][_0x3361f5(0x12e)]=_0x309544;}),_0x5a7f0b[_0x26c5aa(0x162)]((_0x441e94,_0x10a69d)=>{var _0x20bf89=_0x26c5aa;_0x355ad8[_0x10a69d][_0x20bf89(0xe8)]=_0x441e94;}),_0x5ca480['forEach']((_0x184489,_0x2e33be)=>{var _0x3fa8f7=_0x26c5aa;_0x355ad8[_0x2e33be][_0x3fa8f7(0xce)]=_0x184489;}),_0x2955a0[_0x26c5aa(0x162)]((_0x44eb62,_0x2840a1)=>{var _0x5df27d=_0x26c5aa;_0x355ad8[_0x2840a1][_0x5df27d(0xb3)]=_0x44eb62;}),_0x2ae1be['forEach']((_0x4fe836,_0x35ff8a)=>{var _0x3d8cf2=_0x26c5aa;_0x355ad8[_0x35ff8a][_0x3d8cf2(0x130)]=_0x4fe836;}),_0x2eaa19['forEach']((_0x50535e,_0x253be4)=>{_0x355ad8[_0x253be4]['production_date']=_0x50535e;}),_0x5a6c03[_0x26c5aa(0x162)]((_0x38cc68,_0x1a4348)=>{var _0x36c551=_0x26c5aa;_0x355ad8[_0x1a4348][_0x36c551(0xd3)]=_0x38cc68;}),_0x58a7b9[_0x26c5aa(0x162)]((_0xac10ee,_0x135287)=>{var _0x4835d6=_0x26c5aa;_0x355ad8[_0x135287][_0x4835d6(0x123)]=_0xac10ee;}),_0xd2074b[_0x26c5aa(0x162)]((_0x409dba,_0x3ae2a0)=>{_0x355ad8[_0x3ae2a0]['primary_code']=_0x409dba;}),_0x2abdac[_0x26c5aa(0x162)]((_0x5577af,_0x4123f4)=>{var _0x480ed3=_0x26c5aa;_0x355ad8[_0x4123f4][_0x480ed3(0x144)]=_0x5577af;});const _0x301f84=_0x355ad8[_0x26c5aa(0xde)](_0x5eb1d7=>_0x5eb1d7['adjust_qty']!=='0'&&_0x5eb1d7[_0x26c5aa(0x121)]!=='');var _0x1e2059=0x0;_0x301f84['forEach'](_0x5c5792=>{var _0x5d0848=_0x26c5aa;console['log']('foreach\x20newproduct',_0x5c5792),parseInt(_0x5c5792[_0x5d0848(0x121)])<=0x0&&_0x1e2059++;});if(_0x1e2059!=0x0)return _0x2ad35b[_0x26c5aa(0xc1)](_0x26c5aa(0xd9),_0x26c5aa(0x16a)),_0x28eb55[_0x26c5aa(0x111)](_0x26c5aa(0xe1));_0x13768e[_0x26c5aa(0x10a)]=_0x2568f9,_0x13768e[_0x26c5aa(0xd1)]=_0x4d1a94,_0x13768e[_0x26c5aa(0x9f)]=_0x301f84,_0x13768e[_0x26c5aa(0x13f)]=_0x31d94f,_0x13768e[_0x26c5aa(0xd2)]=_0x1e61a1,_0x13768e[_0x26c5aa(0x167)]=_0x26c5aa(0x165);const _0x55d77f=await _0x13768e[_0x26c5aa(0x11a)]();_0x2ad35b[_0x26c5aa(0xc1)]('success',_0x26c5aa(0xb7)),_0x28eb55[_0x26c5aa(0x111)](_0x26c5aa(0xbb));}catch(_0x451b48){console[_0x26c5aa(0x158)](_0x451b48);}}),router['post'](a0_0xa170e7(0xa5),async(_0x22c542,_0x23eeef)=>{var _0x4cf900=a0_0xa170e7;const {primary_code:_0xdc9040,warehouse_data:_0x497997,rooms_data:_0x284ff2,Roomslist:_0x309435}=_0x22c542[_0x4cf900(0x109)],_0x1eb1bb=_0x309435[_0x4cf900(0x11b)](','),_0x57378d=[];async function _0x27c194(_0x432eda){var _0x1dfe2b=_0x4cf900;const _0xc5aebc=await warehouse[_0x1dfe2b(0xe2)]([{'$match':{'name':_0x497997,'room':_0x432eda}},{'$unwind':_0x1dfe2b(0xe3)},{'$match':{'product_details.primary_code':_0xdc9040}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1dfe2b(0x124)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x1dfe2b(0xab)},'secondary_code':{'$first':_0x1dfe2b(0xad)},'product_code':{'$first':_0x1dfe2b(0x120)},'level':{'$first':_0x1dfe2b(0xf7)},'isle':{'$first':_0x1dfe2b(0xee)},'type':{'$first':_0x1dfe2b(0xbc)},'pallet':{'$first':_0x1dfe2b(0xc2)},'unit':{'$first':_0x1dfe2b(0xd5)},'secondary_unit':{'$first':_0x1dfe2b(0xc8)},'storage':{'$first':_0x1dfe2b(0x154)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1dfe2b(0xb9)},'production_date':{'$first':_0x1dfe2b(0xd8)},'maxPerUnit':{'$first':_0x1dfe2b(0xf0)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x1dfe2b(0x12b)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1dfe2b(0x156)},'invoice':{'$first':_0x1dfe2b(0x133)}}}]),_0x285675=await warehouse[_0x1dfe2b(0xe2)]([{'$match':{'name':_0x497997,'room':_0x432eda}},{'$unwind':_0x1dfe2b(0xe3)},{'$match':{'product_details.secondary_code':_0xdc9040}},{'$group':{'_id':_0x1dfe2b(0x16e),'name':{'$first':_0x1dfe2b(0x124)},'product_stock':{'$first':_0x1dfe2b(0x115)},'primary_code':{'$first':_0x1dfe2b(0xab)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1dfe2b(0x120)},'level':{'$first':_0x1dfe2b(0xf7)},'isle':{'$first':_0x1dfe2b(0xee)},'type':{'$first':_0x1dfe2b(0xbc)},'pallet':{'$first':_0x1dfe2b(0xc2)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1dfe2b(0x105)},'expiry_date':{'$first':_0x1dfe2b(0xb9)},'production_date':{'$first':_0x1dfe2b(0xd8)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x1dfe2b(0xda)},'product_cat':{'$first':_0x1dfe2b(0x12b)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x1dfe2b(0x156)}}}]);if(_0xc5aebc[_0x1dfe2b(0x149)]>0x0)_0x57378d[_0x1dfe2b(0xbd)](_0xc5aebc);else _0x285675[_0x1dfe2b(0x149)]>0x0&&_0x57378d[_0x1dfe2b(0xbd)](_0x285675);}const _0x4e9419=_0x1eb1bb[_0x4cf900(0x10c)](_0x6c2b07=>_0x27c194(_0x6c2b07));await Promise[_0x4cf900(0xc9)](_0x4e9419),_0x23eeef[_0x4cf900(0x147)](_0x57378d);}),router[a0_0xa170e7(0xd4)](a0_0xa170e7(0x13a),async(_0x1dbc5f,_0x1c50ba)=>{var _0x55addc=a0_0xa170e7;const {primaryCode:_0xb61fba,secondaryCode:_0x1c43c2,productCode:_0x4793fc,level:_0x75afb4,isle:_0x197a2a,pallet:_0x5d2bcd,warehouses:_0x1fca84,room:_0x46a382}=_0x1dbc5f['body'];try{const _0x5ba8a5=await warehouse[_0x55addc(0xe2)]([{'$match':{'name':_0x1fca84,'room':_0x46a382}},{'$unwind':_0x55addc(0xe3)},{'$match':{'product_details.level':parseInt(_0x75afb4),'product_details.isle':_0x197a2a,'product_details.pallet':parseInt(_0x5d2bcd)}},{'$group':{'_id':_0x55addc(0x16e),'name':{'$first':_0x55addc(0x124)},'product_stock':{'$first':_0x55addc(0x115)},'level':{'$first':_0x55addc(0x160)},'isle':{'$first':_0x55addc(0xb4)},'pallet':{'$first':_0x55addc(0xa9)},'maxProducts':{'$first':_0x55addc(0x131)}}}]);_0x1c50ba[_0x55addc(0xc4)](0xc8)[_0x55addc(0x147)](_0x5ba8a5);}catch(_0x41b5cd){_0x1c50ba['status'](0x194)['json']({'message':_0x41b5cd['message']});}}),module[a0_0xa170e7(0x103)]=router;