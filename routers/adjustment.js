var a0_0x4a3a54=a0_0x316a;(function(_0xa5571a,_0x271d03){var _0x25972c=a0_0x316a,_0x4c3085=_0xa5571a();while(!![]){try{var _0x448a3d=parseInt(_0x25972c(0x10a))/0x1*(parseInt(_0x25972c(0x190))/0x2)+parseInt(_0x25972c(0x18d))/0x3+parseInt(_0x25972c(0x186))/0x4*(-parseInt(_0x25972c(0x1c7))/0x5)+-parseInt(_0x25972c(0x1c0))/0x6+parseInt(_0x25972c(0x180))/0x7*(parseInt(_0x25972c(0x115))/0x8)+-parseInt(_0x25972c(0x1a0))/0x9+parseInt(_0x25972c(0x14f))/0xa;if(_0x448a3d===_0x271d03)break;else _0x4c3085['push'](_0x4c3085['shift']());}catch(_0x3fb8d4){_0x4c3085['push'](_0x4c3085['shift']());}}}(a0_0xa9e8,0xcdba5));const express=require(a0_0x4a3a54(0x160)),app=express(),router=express[a0_0x4a3a54(0x168)](),auth=require(a0_0x4a3a54(0x10f)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x4a3a54(0x11d)),users=require(a0_0x4a3a54(0x18f)),nodemailer=require('nodemailer');function a0_0xa9e8(){var _0x469095=['You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','edit_adjustment','product_code','body','6645051HMbTDX','Secondary_units','then','redirect','$product_details.pallet','_id','finalize','log','$product_details.bin','New_Qty_Converted','$product_details.product_code','Arabic','New_Qty_Converted_adj','errors','expiry_date','RMSEmail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.secondary_code','<h5>','/upload/','map','slice','Adjustment\x20Mail','role','$product.room_names','max_per_unit','<hr\x20class=\x22my-3\x22>','adjustment\x20add\x20successfull','secondary_unit','Spanish','\x20<>\x20','find','1364502aqqpXL','<strong>\x20Regards\x20</strong>','length','$product_details','English','product','params','40990ubzFft','Level','$isAllowEdit','json','floorlevel','</h5>','save','<tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','adjustment\x20data\x20update\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','<html><head><title></title>','get','password','Email\x20sent\x20successfully','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','6546WEDTWd','minus','findById','new_adjust_qty','German','../middleware/auth','room','$product','$product_details.storage','/adjustment/preview/','bin','4432GhaOGX','$product_details.bay','Return\x20Goods','French','$product_details.product_name','Portuguese\x20(BR)','error','$product_details.maxPerUnit','../models/all_models','string','back','product_name','prod_cat','<h2>\x20','floor','staff','Raw\x20Materials','/view','Floor','render','$product_details.rack','maxperunit','master','prime1','types','</body></html>','Hindi','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.floorlevel','catch','user','adjust_qty','Enabled','warehouse_name','$product_details.primary_code','$product_details.product_cat','</tr>','Receiving\x20Area','/view/add_adjustment','edit_adjustment_view','primary_code','</td>','stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<span\x20style=\x22float:\x20right;\x22>','Portuguese','$product_details.production_date','$product_details.batch_code','type','message','sendMail','status','Chinese','storage','\x20Order\x20Number\x20:\x20','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','foreach\x20newproduct','12479480DoJiib','$date','unit','bay','second1','\x20</h2>','Shelves','Logo.png','aggregate','An\x20error\x20occurred.','$product_details.type','<!DOCTYPE\x20html>','port','/adjustment/view','forEach','Ambient','$room','express','room_names','image','$finalize','True','$warehouse_name','Rooms','ADJ-','Router','level','$product.product_name','product_details','Arabic\x20(ae)','post','Primary_Units','$product_details.expiry_date','id_transaction','$product_details.product_stock','</table>','flash','</div>','$name','id_transaction_from','$product_details.isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','production_date','$product_details._id','English\x20(US)','prod_code','email','rack','site_title','6881XHyCoM','$product_details.level','/CheckingWarehouse','push','<h5\x20style=\x22text-align:\x20left;\x22>','batch_code','20etQzCR','</head><body>','success','$product_details.unit','language','all','<table\x20style=\x22width:\x20100%\x20!important;\x22>','92079hRUEMo','warehouse','../public/language/languages.json','8lQkgSv','$product_details.maxProducts','createTransport','prod_name','logo','<div>','findOne','$product_details.invoice','$product_details.secondary_unit','prod_invoice','stockBefore','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'];a0_0xa9e8=function(){return _0x469095;};return a0_0xa9e8();}router[a0_0x4a3a54(0x1d5)](a0_0x4a3a54(0x126),auth,async(_0x5ed336,_0x12334c)=>{var _0x20b2f3=a0_0x4a3a54;try{const {username:_0x43dd5f,email:_0x2aaf90,role:_0x12b1c9}=_0x5ed336[_0x20b2f3(0x133)],_0x3e9675=_0x5ed336['user'],_0x2795e6=await profile[_0x20b2f3(0x196)]({'email':_0x3e9675['email']}),_0x453617=await master_shop[_0x20b2f3(0x1bf)]();console['log'](_0x20b2f3(0x12b),_0x453617);let _0x274e9b;if(_0x3e9675[_0x20b2f3(0x1b7)]==_0x20b2f3(0x124)){const _0x575933=await staff['findOne']({'email':_0x3e9675[_0x20b2f3(0x17d)]});_0x274e9b=await warehouse['find']({'status':_0x20b2f3(0x135),'name':_0x575933[_0x20b2f3(0x18e)]});}else _0x274e9b=await warehouse['find']({'status':_0x20b2f3(0x135)});const _0x5c5077=await product[_0x20b2f3(0x1bf)]();let _0x7b1668;if(_0x3e9675[_0x20b2f3(0x1b7)]==_0x20b2f3(0x124)){const _0x35ed65=await staff['findOne']({'email':_0x3e9675[_0x20b2f3(0x17d)]});_0x7b1668=await adjustment[_0x20b2f3(0x1bf)]({'warehouse_name':_0x35ed65['warehouse']});}else _0x7b1668=await adjustment['aggregate']([{'$unwind':_0x20b2f3(0x111)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x20b2f3(0x150)},'warehouse_name':{'$first':_0x20b2f3(0x165)},'room':{'$addToSet':_0x20b2f3(0x1b8)},'finalize':{'$first':_0x20b2f3(0x163)},'isAllowEdit':{'$first':_0x20b2f3(0x1c9)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x453617[0x0]['language']=='English\x20(US)'){var _0x5cabbd=users[_0x20b2f3(0x1c4)];console[_0x20b2f3(0x1a7)](_0x5cabbd);}else{if(_0x453617[0x0][_0x20b2f3(0x18a)]==_0x20b2f3(0x12f))var _0x5cabbd=users[_0x20b2f3(0x12f)];else{if(_0x453617[0x0][_0x20b2f3(0x18a)]=='German')var _0x5cabbd=users[_0x20b2f3(0x10e)];else{if(_0x453617[0x0][_0x20b2f3(0x18a)]==_0x20b2f3(0x1bd))var _0x5cabbd=users[_0x20b2f3(0x1bd)];else{if(_0x453617[0x0][_0x20b2f3(0x18a)]==_0x20b2f3(0x118))var _0x5cabbd=users[_0x20b2f3(0x118)];else{if(_0x453617[0x0][_0x20b2f3(0x18a)]=='Portuguese\x20(BR)')var _0x5cabbd=users[_0x20b2f3(0x142)];else{if(_0x453617[0x0][_0x20b2f3(0x18a)]==_0x20b2f3(0x149))var _0x5cabbd=users['Chinese'];else{if(_0x453617[0x0][_0x20b2f3(0x18a)]=='Arabic\x20(ae)')var _0x5cabbd=users[_0x20b2f3(0x1ab)];}}}}}}}_0x12334c[_0x20b2f3(0x128)]('adjustment',{'success':_0x5ed336[_0x20b2f3(0x173)]('success'),'errors':_0x5ed336[_0x20b2f3(0x173)]('errors'),'role':_0x3e9675,'profile':_0x2795e6,'warehouse':_0x274e9b,'product':_0x5c5077,'adjustment':_0x7b1668,'master_shop':_0x453617,'language':_0x5cabbd});}catch(_0x59abbb){console[_0x20b2f3(0x1a7)](_0x59abbb);}});function a0_0x316a(_0x2608d5,_0x35c248){var _0xa9e806=a0_0xa9e8();return a0_0x316a=function(_0x316a9d,_0x2bb66d){_0x316a9d=_0x316a9d-0x109;var _0x3b6c44=_0xa9e806[_0x316a9d];return _0x3b6c44;},a0_0x316a(_0x2608d5,_0x35c248);}async function getRandom8DigitNumber(){var _0x5152d4=a0_0x4a3a54;const _0x461037=0x989680,_0x3528c3=0x5f5e0ff,_0x4da5bc=Math[_0x5152d4(0x123)](Math['random']()*(_0x3528c3-_0x461037+0x1))+_0x461037;var _0x5a6ea8;const _0x496bf3=await adjustment[_0x5152d4(0x196)]({'invoice':_0x5152d4(0x167)+_0x4da5bc});return _0x496bf3&&_0x496bf3[_0x5152d4(0x1c2)]>0x0?_0x5a6ea8=_0x5152d4(0x167)+_0x4da5bc:_0x5a6ea8=_0x5152d4(0x167)+_0x4da5bc,_0x5a6ea8;}router[a0_0x4a3a54(0x1d5)](a0_0x4a3a54(0x13b),auth,async(_0x4ed45e,_0x595db2)=>{var _0x30d62d=a0_0x4a3a54;try{const {username:_0x2e29a2,email:_0x5e0680,role:_0x54949f}=_0x4ed45e[_0x30d62d(0x133)],_0x467231=_0x4ed45e[_0x30d62d(0x133)],_0x204a2b=await profile[_0x30d62d(0x196)]({'email':_0x467231[_0x30d62d(0x17d)]}),_0x4d4e81=await master_shop[_0x30d62d(0x1bf)]();let _0x46d7e2;if(_0x467231['role']=='staff'){const _0x3fa125=await staff[_0x30d62d(0x196)]({'email':_0x467231[_0x30d62d(0x17d)]});_0x46d7e2=await warehouse[_0x30d62d(0x157)]([{'$match':{'status':_0x30d62d(0x135),'name':_0x3fa125['warehouse'],'warehouse_category':_0x30d62d(0x125),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x30d62d(0x175)}}}]);}else _0x46d7e2=await warehouse[_0x30d62d(0x157)]([{'$match':{'status':_0x30d62d(0x135),'warehouse_category':_0x30d62d(0x125),'name':{'$ne':_0x30d62d(0x117)}}},{'$group':{'_id':_0x30d62d(0x175),'name':{'$first':'$name'}}}]);const _0x2b0848=await product[_0x30d62d(0x1bf)]({}),_0x14c10b=await adjustment['find']({}),_0x29fff9=_0x14c10b[_0x30d62d(0x1c2)]+0x1,_0xf2d60b=_0x30d62d(0x167)+_0x29fff9['toString']()['padStart'](0x5,'0');var _0x125e09=[_0x30d62d(0x15e),'Enclosed','Return\x20Rooms'];if(_0x4d4e81[0x0][_0x30d62d(0x18a)]==_0x30d62d(0x17b))var _0x5df68a=users[_0x30d62d(0x1c4)];else{if(_0x4d4e81[0x0][_0x30d62d(0x18a)]==_0x30d62d(0x12f))var _0x5df68a=users[_0x30d62d(0x12f)];else{if(_0x4d4e81[0x0][_0x30d62d(0x18a)]==_0x30d62d(0x10e))var _0x5df68a=users[_0x30d62d(0x10e)];else{if(_0x4d4e81[0x0][_0x30d62d(0x18a)]==_0x30d62d(0x1bd))var _0x5df68a=users[_0x30d62d(0x1bd)];else{if(_0x4d4e81[0x0][_0x30d62d(0x18a)]==_0x30d62d(0x118))var _0x5df68a=users[_0x30d62d(0x118)];else{if(_0x4d4e81[0x0]['language']==_0x30d62d(0x11a))var _0x5df68a=users[_0x30d62d(0x142)];else{if(_0x4d4e81[0x0][_0x30d62d(0x18a)]==_0x30d62d(0x149))var _0x5df68a=users['Chinese'];else{if(_0x4d4e81[0x0][_0x30d62d(0x18a)]==_0x30d62d(0x16c))var _0x5df68a=users['Arabic'];}}}}}}}const _0x373f5c=getRandom8DigitNumber();_0x373f5c[_0x30d62d(0x1a2)](_0xcf630c=>{var _0x1e81d2=_0x30d62d;_0x595db2[_0x1e81d2(0x128)]('add_adjustment',{'success':_0x4ed45e['flash'](_0x1e81d2(0x188)),'errors':_0x4ed45e[_0x1e81d2(0x173)](_0x1e81d2(0x1ad)),'role':_0x467231,'profile':_0x204a2b,'warehouse':_0x46d7e2,'product':_0x2b0848,'master_shop':_0x4d4e81,'language':_0x5df68a,'rooms_data':_0x125e09,'invoice_no':_0xcf630c});})[_0x30d62d(0x132)](_0x2bcb4b=>{var _0x1a4659=_0x30d62d;_0x4ed45e[_0x1a4659(0x173)]('errors',_0x1a4659(0x130)),_0x595db2['redirect'](_0x1a4659(0x15c));});}catch(_0x3d6252){console[_0x30d62d(0x1a7)](_0x3d6252);}}),router[a0_0x4a3a54(0x16d)](a0_0x4a3a54(0x13b),auth,async(_0x1c85c0,_0x25a296)=>{var _0x1824e5=a0_0x4a3a54;try{const {warehouse_name:_0x1a816f,date:_0x15826b,prod_name:_0x399d3d,level:_0x17da0b,isle:_0x409f5c,pallet:_0x487833,stock:_0x203620,types:_0x29be9c,adjust_qty:_0x5d2304,new_adjust_qty:_0x3dd0c6,note:_0x5daab2,Room_name:_0x2e63f6,invoice:_0x5402a7,JO_number:_0x3ed5aa,expiry_date:_0x54a210}=_0x1c85c0[_0x1824e5(0x19f)];if(typeof _0x399d3d=='string')var _0xd18025=[_0x1c85c0[_0x1824e5(0x19f)]['prod_name']],_0x54e1e8=[_0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x169)]],_0x1ead75=[_0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x13f)]],_0x1a1164=[_0x1c85c0['body'][_0x1824e5(0x12d)]],_0x27a403=[_0x1c85c0['body'][_0x1824e5(0x1ac)]],_0x2b42ae=[_0x1c85c0['body'][_0x1824e5(0x1a9)]],_0x4c0831=[_0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x16e)]],_0x278e3a=[_0x1c85c0['body'][_0x1824e5(0x1a1)]],_0x2f1a4e=[_0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x17c)]],_0x1d4281=[_0x1c85c0['body']['batch_code']],_0x21edf9=[_0x1c85c0[_0x1824e5(0x19f)]['expiry_date']],_0x126beb=[_0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x1b9)]],_0x3538e8=[_0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x179)]],_0x2fd2bf=[_0x1c85c0['body'][_0x1824e5(0x121)]],_0x9ebbf2=[_0x1c85c0[_0x1824e5(0x19f)]['Rooms']],_0x152eea=[_0x1c85c0[_0x1824e5(0x19f)]['prime1']],_0x1b981f=[_0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x153)]],_0x3ec3d6=[_0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x199)]],_0x938c40=[_0x1c85c0['body'][_0x1824e5(0x170)]];else var _0xd18025=[..._0x1c85c0[_0x1824e5(0x19f)]['prod_name']],_0x54e1e8=[..._0x1c85c0[_0x1824e5(0x19f)]['level']],_0x1ead75=[..._0x1c85c0['body'][_0x1824e5(0x13f)]],_0x1a1164=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x12d)]],_0x27a403=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x1ac)]],_0x2b42ae=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x1a9)]],_0x4c0831=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x151)]],_0x278e3a=[..._0x1c85c0['body'][_0x1824e5(0x1a1)]],_0x2f1a4e=[..._0x1c85c0['body'][_0x1824e5(0x17c)]],_0x1d4281=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x185)]],_0x21edf9=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x1ae)]],_0x126beb=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x1b9)]],_0x3538e8=[..._0x1c85c0['body'][_0x1824e5(0x179)]],_0x2fd2bf=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x121)]],_0x9ebbf2=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x166)]],_0x152eea=[..._0x1c85c0['body'][_0x1824e5(0x12c)]],_0x1b981f=[..._0x1c85c0['body'][_0x1824e5(0x153)]],_0x3ec3d6=[..._0x1c85c0['body'][_0x1824e5(0x199)]],_0x938c40=[..._0x1c85c0[_0x1824e5(0x19f)][_0x1824e5(0x170)]];const _0x6eca84=_0xd18025['map'](_0x4ef31d=>{return _0x4ef31d={'product_name':_0x4ef31d};});_0x54e1e8['forEach']((_0x3b2d6e,_0x5c41f9)=>{_0x9ebbf2['forEach']((_0x589b07,_0x7d8f33)=>{var _0x46cec0=a0_0x316a;if(_0x589b07==_0x46cec0(0x13a)&&_0x5c41f9==_0x7d8f33){var _0x3daa7a=_0x3b2d6e[_0x46cec0(0x1b5)](0x3);_0x6eca84[_0x5c41f9][_0x46cec0(0x14a)]=_0x3b2d6e[0x0],_0x6eca84[_0x5c41f9][_0x46cec0(0x17e)]=_0x3b2d6e[0x1],_0x6eca84[_0x5c41f9]['bay']=0x0,_0x6eca84[_0x5c41f9]['bin']=0x0,_0x6eca84[_0x5c41f9]['type']=_0x46cec0(0x127),_0x6eca84[_0x5c41f9]['floorlevel']=_0x3daa7a;}else{if(_0x589b07==_0x46cec0(0x155)&&_0x5c41f9==_0x7d8f33){var _0x3daa7a=_0x3b2d6e['slice'](0x3);_0x6eca84[_0x5c41f9][_0x46cec0(0x14a)]=_0x3b2d6e[0x0],_0x6eca84[_0x5c41f9][_0x46cec0(0x17e)]=_0x3b2d6e[0x1],_0x6eca84[_0x5c41f9][_0x46cec0(0x152)]=0x0,_0x6eca84[_0x5c41f9]['bin']=0x0,_0x6eca84[_0x5c41f9]['type']=_0x46cec0(0x127),_0x6eca84[_0x5c41f9][_0x46cec0(0x1cb)]=_0x3b2d6e[0x5];}else{if(_0x5c41f9==_0x7d8f33){var _0x367489;if(_0x3b2d6e[0x4]=='L')_0x367489='Level';else _0x3b2d6e[0x4]=='F'&&(_0x367489=_0x46cec0(0x127));_0x6eca84[_0x5c41f9][_0x46cec0(0x14a)]=_0x3b2d6e[0x0],_0x6eca84[_0x5c41f9]['rack']=_0x3b2d6e[0x1],_0x6eca84[_0x5c41f9]['bay']=_0x3b2d6e[0x2],_0x6eca84[_0x5c41f9][_0x46cec0(0x114)]=_0x3b2d6e[0x3],_0x6eca84[_0x5c41f9][_0x46cec0(0x145)]=_0x367489,_0x6eca84[_0x5c41f9][_0x46cec0(0x1cb)]=_0x3b2d6e[0x5];}}}});}),_0x1ead75[_0x1824e5(0x15d)]((_0x1e82e8,_0x220102)=>{var _0x79d143=_0x1824e5;_0x6eca84[_0x220102][_0x79d143(0x19a)]=_0x1e82e8;}),_0x938c40[_0x1824e5(0x15d)]((_0x158045,_0x2703cd)=>{var _0x4875a7=_0x1824e5;_0x6eca84[_0x2703cd][_0x4875a7(0x176)]=_0x158045;}),_0x1a1164['forEach']((_0xb73502,_0x3936e6)=>{var _0x5deb7a=_0x1824e5;_0x6eca84[_0x3936e6][_0x5deb7a(0x12d)]=_0xb73502;}),_0x27a403[_0x1824e5(0x15d)]((_0x484f67,_0x41ad30)=>{var _0x4ccf26=_0x1824e5;_0x6eca84[_0x41ad30][_0x4ccf26(0x134)]=_0x484f67;}),_0x2b42ae['forEach']((_0x705791,_0x306624)=>{var _0x46dde7=_0x1824e5;_0x6eca84[_0x306624][_0x46dde7(0x10d)]=_0x705791;}),_0x4c0831[_0x1824e5(0x15d)]((_0x172738,_0x35c817)=>{var _0x51b955=_0x1824e5;_0x6eca84[_0x35c817][_0x51b955(0x151)]=_0x172738;}),_0x278e3a[_0x1824e5(0x15d)]((_0x2fe278,_0x3b9152)=>{_0x6eca84[_0x3b9152]['secondary_unit']=_0x2fe278;}),_0x2f1a4e['forEach']((_0x34590d,_0x38313b)=>{var _0x256e65=_0x1824e5;_0x6eca84[_0x38313b][_0x256e65(0x19e)]=_0x34590d;}),_0x1d4281[_0x1824e5(0x15d)]((_0x5e9cd9,_0x4b56d6)=>{var _0x1fc38c=_0x1824e5;_0x6eca84[_0x4b56d6][_0x1fc38c(0x185)]=_0x5e9cd9;}),_0x21edf9['forEach']((_0x447dd3,_0x5339e2)=>{var _0x143aed=_0x1824e5;_0x6eca84[_0x5339e2][_0x143aed(0x1ae)]=_0x447dd3;}),_0x126beb['forEach']((_0x433f0e,_0x292873)=>{var _0x423fab=_0x1824e5;_0x6eca84[_0x292873][_0x423fab(0x12a)]=_0x433f0e;}),_0x3538e8[_0x1824e5(0x15d)]((_0x56df4b,_0x3965b4)=>{var _0x5b7b0f=_0x1824e5;_0x6eca84[_0x3965b4][_0x5b7b0f(0x179)]=_0x56df4b;}),_0x2fd2bf[_0x1824e5(0x15d)]((_0xfc07ba,_0x59534e)=>{var _0x3a68f2=_0x1824e5;_0x6eca84[_0x59534e][_0x3a68f2(0x121)]=_0xfc07ba;}),_0x9ebbf2[_0x1824e5(0x15d)]((_0x2adfde,_0x43ae40)=>{_0x6eca84[_0x43ae40]['room_names']=_0x2adfde;}),_0x152eea[_0x1824e5(0x15d)]((_0x3128fb,_0x4cba21)=>{_0x6eca84[_0x4cba21]['primary_code']=_0x3128fb;}),_0x1b981f[_0x1824e5(0x15d)]((_0x142b47,_0xc4553a)=>{_0x6eca84[_0xc4553a]['secondary_code']=_0x142b47;}),_0x3ec3d6[_0x1824e5(0x15d)]((_0x42fc28,_0x2b8d2a)=>{var _0x538dcd=_0x1824e5;_0x6eca84[_0x2b8d2a][_0x538dcd(0x14c)]=_0x42fc28;});const _0x415919=_0x6eca84['filter'](_0x5d7641=>_0x5d7641[_0x1824e5(0x134)]!=='0'&&_0x5d7641['adjust_qty']!=='');var _0x41fc08=0x0;_0x415919['forEach'](_0x37a033=>{var _0x430887=_0x1824e5;console[_0x430887(0x1a7)](_0x430887(0x14e),_0x37a033),parseInt(_0x37a033[_0x430887(0x134)])<=0x0&&_0x41fc08++;});if(_0x41fc08!=0x0)return _0x1c85c0[_0x1824e5(0x173)](_0x1824e5(0x1ad),_0x1824e5(0x19c)),_0x25a296[_0x1824e5(0x1a3)](_0x1824e5(0x11f));const _0x7aab16=new adjustment({'warehouse_name':_0x1a816f,'date':_0x15826b,'product':_0x415919,'note':_0x5daab2,'room':_0x2e63f6,'invoice':_0x5402a7,'JO_number':_0x3ed5aa,'expiry_date':_0x54a210}),_0x12c821=await _0x7aab16[_0x1824e5(0x1cd)]();_0x1c85c0[_0x1824e5(0x173)](_0x1824e5(0x188),_0x1824e5(0x1bb)),_0x25a296[_0x1824e5(0x1a3)](_0x1824e5(0x113)+_0x12c821['_id']);}catch(_0xca43){console[_0x1824e5(0x1a7)](_0xca43),_0x25a296[_0x1824e5(0x148)](0xc8)['json']({'message':_0xca43[_0x1824e5(0x146)]});}}),router[a0_0x4a3a54(0x1d5)]('/preview/:id',auth,async(_0x4d780b,_0x5a702c)=>{var _0x588223=a0_0x4a3a54;try{const {username:_0x33d30f,email:_0x14087a,role:_0x4931f9}=_0x4d780b[_0x588223(0x133)],_0x305332=_0x4d780b[_0x588223(0x133)],_0x8ec5fc=await profile[_0x588223(0x196)]({'email':_0x305332[_0x588223(0x17d)]}),_0x3437d0=await master_shop[_0x588223(0x1bf)](),_0x4ea3fb=_0x4d780b[_0x588223(0x1c6)]['id'],_0x2b510e=await adjustment[_0x588223(0x10c)]({'_id':_0x4ea3fb}),_0x5c1d21=await purchases[_0x588223(0x157)]([{'$match':{'warehouse_name':_0x2b510e[_0x588223(0x136)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x2118d3=await product[_0x588223(0x1bf)]({}),_0x52b2ee=await warehouse[_0x588223(0x157)]([{'$match':{'name':_0x2b510e[_0x588223(0x136)]}},{'$unwind':_0x588223(0x1c3)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x588223(0x119)},'product_stock':{'$first':_0x588223(0x171)},'bay':{'$first':_0x588223(0x116)},'bin':{'$first':_0x588223(0x1a8)},'type':{'$first':_0x588223(0x159)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x588223(0x1aa)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);if(_0x3437d0[0x0]['language']==_0x588223(0x17b)){var _0x27a4ea=users['English'];console[_0x588223(0x1a7)](_0x27a4ea);}else{if(_0x3437d0[0x0][_0x588223(0x18a)]==_0x588223(0x12f))var _0x27a4ea=users['Hindi'];else{if(_0x3437d0[0x0]['language']=='German')var _0x27a4ea=users[_0x588223(0x10e)];else{if(_0x3437d0[0x0]['language']==_0x588223(0x1bd))var _0x27a4ea=users['Spanish'];else{if(_0x3437d0[0x0][_0x588223(0x18a)]==_0x588223(0x118))var _0x27a4ea=users[_0x588223(0x118)];else{if(_0x3437d0[0x0][_0x588223(0x18a)]==_0x588223(0x11a))var _0x27a4ea=users[_0x588223(0x142)];else{if(_0x3437d0[0x0][_0x588223(0x18a)]==_0x588223(0x149))var _0x27a4ea=users[_0x588223(0x149)];else{if(_0x3437d0[0x0]['language']==_0x588223(0x16c))var _0x27a4ea=users[_0x588223(0x1ab)];}}}}}}}_0x5a702c[_0x588223(0x128)](_0x588223(0x13c),{'success':_0x4d780b[_0x588223(0x173)](_0x588223(0x188)),'errors':_0x4d780b[_0x588223(0x173)]('errors'),'role':_0x305332,'profile':_0x8ec5fc,'adjustment':_0x2b510e,'stock':_0x52b2ee,'master_shop':_0x3437d0,'warehouse_name':_0x5c1d21,'unit':_0x2118d3,'language':_0x27a4ea});}catch(_0x3e3ac8){console[_0x588223(0x1a7)](_0x3e3ac8),_0x5a702c[_0x588223(0x148)](0xc8)[_0x588223(0x1ca)]({'message':_0x3e3ac8[_0x588223(0x146)]});}}),router[a0_0x4a3a54(0x16d)]('/preview/:id',auth,async(_0x5c88cd,_0x294f06)=>{var _0x30e69d=a0_0x4a3a54;try{const _0x41903f=_0x5c88cd[_0x30e69d(0x1c6)]['id'],{warehouse_name:_0x2abfd2,Room_name:_0x59581d}=_0x5c88cd['body'],_0x1f73e1=await adjustment['findById']({'_id':_0x41903f}),_0x5a503a=_0x1f73e1[_0x30e69d(0x1c5)][_0x30e69d(0x1b4)](async _0x2e94fa=>{var _0x37848f=_0x30e69d;if(_0x2e94fa[_0x37848f(0x134)]>0x0){var _0x128161=await warehouse[_0x37848f(0x196)]({'name':_0x2abfd2,'room':_0x2e94fa['room_names'],'warehouse_category':_0x37848f(0x125)});const _0x852210=_0x128161[_0x37848f(0x16b)][_0x37848f(0x1b4)](_0x357f98=>{var _0x4f4fe9=_0x37848f;console[_0x4f4fe9(0x1a7)](_0x2e94fa[_0x4f4fe9(0x12d)]+_0x4f4fe9(0x1be));if(_0x2e94fa[_0x4f4fe9(0x12d)]==_0x4f4fe9(0x10b)){if(_0x357f98[_0x4f4fe9(0x120)]==_0x2e94fa[_0x4f4fe9(0x120)]&&_0x357f98[_0x4f4fe9(0x1cb)]==_0x2e94fa[_0x4f4fe9(0x1cb)]&&_0x357f98[_0x4f4fe9(0x145)]==_0x2e94fa['type']&&_0x357f98[_0x4f4fe9(0x114)]==_0x2e94fa[_0x4f4fe9(0x114)]&&_0x357f98[_0x4f4fe9(0x152)]==_0x2e94fa['bay']&&_0x357f98[_0x4f4fe9(0x17e)]==_0x2e94fa[_0x4f4fe9(0x17e)]&&_0x357f98[_0x4f4fe9(0x14a)]==_0x2e94fa[_0x4f4fe9(0x14a)]&&_0x357f98[_0x4f4fe9(0x1ae)]==_0x2e94fa['expiry_date']&&_0x357f98[_0x4f4fe9(0x185)]==_0x2e94fa['batch_code']&&_0x357f98[_0x4f4fe9(0x179)]==_0x2e94fa[_0x4f4fe9(0x179)]&&_0x357f98[_0x4f4fe9(0x14c)]==_0x2e94fa[_0x4f4fe9(0x14c)]&&_0x357f98[_0x4f4fe9(0x1a5)]==_0x2e94fa[_0x4f4fe9(0x176)]){var _0x144039;_0x144039=_0x2e94fa[_0x4f4fe9(0x134)],_0x2e94fa[_0x4f4fe9(0x121)]=='S'&&(_0x144039=_0x2e94fa[_0x4f4fe9(0x134)]),_0x357f98['product_stock']=_0x357f98['product_stock']-_0x144039;}}else{if(_0x357f98[_0x4f4fe9(0x120)]==_0x2e94fa[_0x4f4fe9(0x120)]&&_0x357f98['floorlevel']==_0x2e94fa[_0x4f4fe9(0x1cb)]&&_0x357f98['type']==_0x2e94fa[_0x4f4fe9(0x145)]&&_0x357f98[_0x4f4fe9(0x114)]==_0x2e94fa[_0x4f4fe9(0x114)]&&_0x357f98[_0x4f4fe9(0x152)]==_0x2e94fa[_0x4f4fe9(0x152)]&&_0x357f98[_0x4f4fe9(0x17e)]==_0x2e94fa[_0x4f4fe9(0x17e)]&&_0x357f98[_0x4f4fe9(0x14a)]==_0x2e94fa[_0x4f4fe9(0x14a)]&&_0x357f98[_0x4f4fe9(0x1ae)]==_0x2e94fa['expiry_date']&&_0x357f98['batch_code']==_0x2e94fa[_0x4f4fe9(0x185)]&&_0x357f98[_0x4f4fe9(0x179)]==_0x2e94fa['production_date']&&_0x357f98[_0x4f4fe9(0x14c)]==_0x2e94fa[_0x4f4fe9(0x14c)]&&_0x357f98[_0x4f4fe9(0x1a5)]==_0x2e94fa[_0x4f4fe9(0x176)]){console['log'](_0x2e94fa);var _0x144039;_0x144039=_0x2e94fa[_0x4f4fe9(0x134)],_0x2e94fa[_0x4f4fe9(0x121)]=='S'&&(_0x144039=_0x2e94fa[_0x4f4fe9(0x134)]),_0x357f98['product_stock']=_0x357f98['product_stock']+_0x144039;}}});}return _0x128161;});Promise[_0x30e69d(0x18b)](_0x5a503a)['then'](async _0x6916d8=>{var _0x32e856=_0x30e69d;try{for(const _0xc116f6 of _0x6916d8){await _0xc116f6[_0x32e856(0x1cd)]();}_0x1f73e1[_0x32e856(0x1a6)]=_0x32e856(0x164);const _0x1de413=await _0x1f73e1['save'](),_0x5f56b7=await master_shop[_0x32e856(0x1bf)](),_0x54b877=await email_settings[_0x32e856(0x196)](),_0x465c37=await supervisor_settings[_0x32e856(0x1bf)]();var _0x10ee63=_0x1f73e1[_0x32e856(0x1c5)],_0x477a1c='',_0x40864b;for(_0x40864b in _0x10ee63){_0x477a1c+=_0x32e856(0x1ce)+_0x32e856(0x109)+_0x10ee63[_0x40864b][_0x32e856(0x120)]+_0x32e856(0x13e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10ee63[_0x40864b][_0x32e856(0x19e)]+_0x32e856(0x13e)+_0x32e856(0x109)+_0x10ee63[_0x40864b][_0x32e856(0x134)]+'</td>'+_0x32e856(0x109)+_0x10ee63[_0x40864b][_0x32e856(0x151)]+_0x32e856(0x13e)+_0x32e856(0x109)+_0x10ee63[_0x40864b][_0x32e856(0x1bc)]+_0x32e856(0x13e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1f73e1['warehouse_name']+_0x32e856(0x13e)+_0x32e856(0x109)+_0x10ee63[_0x40864b][_0x32e856(0x161)]+_0x32e856(0x13e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10ee63[_0x40864b][_0x32e856(0x14a)]+_0x10ee63[_0x40864b][_0x32e856(0x17e)]+_0x10ee63[_0x40864b][_0x32e856(0x152)]+_0x10ee63[_0x40864b]['bin']+_0x10ee63[_0x40864b][_0x32e856(0x145)][0x0]+_0x10ee63[_0x40864b][_0x32e856(0x1cb)]+'</td>',_0x32e856(0x139);}let _0x5439b3=nodemailer[_0x32e856(0x192)]({'host':_0x54b877['host'],'port':Number(_0x54b877[_0x32e856(0x15b)]),'secure':![],'auth':{'user':_0x54b877[_0x32e856(0x17d)],'pass':_0x54b877[_0x32e856(0x1d6)]}}),_0x2a6b85={'from':_0x54b877['email'],'to':_0x465c37[0x0][_0x32e856(0x1af)],'subject':_0x32e856(0x1b6),'attachments':[{'filename':_0x32e856(0x156),'path':__dirname+'/../public'+_0x32e856(0x1b3)+_0x5f56b7[0x0][_0x32e856(0x162)],'cid':_0x32e856(0x194)}],'html':_0x32e856(0x15a)+_0x32e856(0x1d4)+_0x32e856(0x187)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x32e856(0x195)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x32e856(0x174)+_0x32e856(0x195)+_0x32e856(0x122)+_0x5f56b7[0x0]['site_title']+_0x32e856(0x154)+_0x32e856(0x174)+_0x32e856(0x174)+_0x32e856(0x1ba)+_0x32e856(0x195)+_0x32e856(0x184)+_0x32e856(0x14b)+_0x1f73e1[_0x32e856(0x14c)]+'\x20'+_0x32e856(0x141)+'\x20Order\x20Date\x20:\x20'+_0x1f73e1['date']+'\x20'+'</span>'+_0x32e856(0x1cc)+_0x32e856(0x174)+_0x32e856(0x18c)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x32e856(0x1ce)+_0x32e856(0x1cf)+_0x32e856(0x1d1)+_0x32e856(0x140)+_0x32e856(0x1b0)+_0x32e856(0x1d3)+_0x32e856(0x19b)+_0x32e856(0x178)+_0x32e856(0x14d)+_0x32e856(0x139)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x477a1c+'\x20'+'</tbody>'+_0x32e856(0x172)+'<div>'+_0x32e856(0x1c1)+_0x32e856(0x1b2)+_0x5f56b7[0x0][_0x32e856(0x17f)]+_0x32e856(0x1cc)+_0x32e856(0x174)+_0x32e856(0x174)+_0x32e856(0x12e)};_0x5439b3[_0x32e856(0x147)](_0x2a6b85,function(_0x5057b5,_0xc2c0a7){var _0x3d9e4e=_0x32e856;_0x5057b5?(console[_0x3d9e4e(0x1a7)](_0x5057b5),console[_0x3d9e4e(0x1a7)]('Error\x20Occurs')):console[_0x3d9e4e(0x1a7)](_0x3d9e4e(0x1d7));}),_0x5c88cd[_0x32e856(0x173)]('success','adjustment\x20Finalized\x20successfully'),_0x294f06[_0x32e856(0x1a3)]('/picking_list/PDF_adjustment_rm/'+_0x1de413[_0x32e856(0x1a5)]);}catch(_0x1d34b1){console['error'](_0x1d34b1),_0x294f06[_0x32e856(0x148)](0x1f4)[_0x32e856(0x1ca)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x30e69d(0x132)](_0xb99efc=>{var _0x443a17=_0x30e69d;console[_0x443a17(0x11b)](_0xb99efc),_0x294f06['status'](0x1f4)['json']({'error':_0x443a17(0x158)});});}catch(_0xba4d4c){console['log'](_0xba4d4c),_0x294f06[_0x30e69d(0x148)](0xc8)[_0x30e69d(0x1ca)]({'message':_0xba4d4c[_0x30e69d(0x146)]});}}),router[a0_0x4a3a54(0x1d5)](a0_0x4a3a54(0x1d0),auth,async(_0x5d1023,_0x3a7a62)=>{var _0x212679=a0_0x4a3a54;try{const {username:_0x585201,email:_0x3ea854,role:_0x5bb7ed}=_0x5d1023[_0x212679(0x133)],_0x361d89=_0x5d1023['user'],_0x421ffd=await profile[_0x212679(0x196)]({'email':_0x361d89[_0x212679(0x17d)]}),_0x50e066=await master_shop[_0x212679(0x1bf)](),_0x34a9ae=_0x5d1023[_0x212679(0x1c6)]['id'],_0x90c79c=await adjustment[_0x212679(0x10c)]({'_id':_0x34a9ae}),_0x388042=await purchases[_0x212679(0x157)]([{'$match':{'warehouse_name':_0x90c79c['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x212679(0x16a)}}]),_0x27475a=await product[_0x212679(0x1bf)]({}),_0x221bdc=await warehouse['aggregate']([{'$match':{'name':_0x90c79c[_0x212679(0x136)]}},{'$unwind':_0x212679(0x1c3)},{'$group':{'_id':_0x212679(0x17a),'name':{'$first':_0x212679(0x119)},'product_stock':{'$first':_0x212679(0x171)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x212679(0x1a8)},'type':{'$first':_0x212679(0x159)},'floorlevel':{'$first':_0x212679(0x131)},'primary_code':{'$first':_0x212679(0x137)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x212679(0x1aa)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x212679(0x129)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x212679(0x143)},'batch_code':{'$first':_0x212679(0x144)},'room':{'$first':_0x212679(0x15f)}}}]);let _0x49d486;if(_0x361d89['role']=='staff'){const _0x4e1c92=await staff[_0x212679(0x196)]({'email':_0x361d89[_0x212679(0x17d)]});_0x49d486=await warehouse['aggregate']([{'$match':{'status':_0x212679(0x135),'name':_0x4e1c92[_0x212679(0x18e)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x212679(0x117)}}},{'$group':{'_id':_0x212679(0x175),'name':{'$first':_0x212679(0x175)}}}]);}else _0x49d486=await warehouse[_0x212679(0x157)]([{'$match':{'status':_0x212679(0x135),'warehouse_category':_0x212679(0x125),'name':{'$ne':_0x212679(0x117)}}},{'$group':{'_id':_0x212679(0x175),'name':{'$first':'$name'}}}]);if(_0x50e066[0x0][_0x212679(0x18a)]=='English\x20(US)'){var _0x54201b=users[_0x212679(0x1c4)];console[_0x212679(0x1a7)](_0x54201b);}else{if(_0x50e066[0x0][_0x212679(0x18a)]==_0x212679(0x12f))var _0x54201b=users[_0x212679(0x12f)];else{if(_0x50e066[0x0][_0x212679(0x18a)]=='German')var _0x54201b=users[_0x212679(0x10e)];else{if(_0x50e066[0x0][_0x212679(0x18a)]==_0x212679(0x1bd))var _0x54201b=users[_0x212679(0x1bd)];else{if(_0x50e066[0x0][_0x212679(0x18a)]==_0x212679(0x118))var _0x54201b=users[_0x212679(0x118)];else{if(_0x50e066[0x0][_0x212679(0x18a)]==_0x212679(0x11a))var _0x54201b=users['Portuguese'];else{if(_0x50e066[0x0]['language']==_0x212679(0x149))var _0x54201b=users[_0x212679(0x149)];else{if(_0x50e066[0x0]['language']=='Arabic\x20(ae)')var _0x54201b=users[_0x212679(0x1ab)];}}}}}}}_0x3a7a62[_0x212679(0x128)](_0x212679(0x19d),{'success':_0x5d1023[_0x212679(0x173)](_0x212679(0x188)),'errors':_0x5d1023[_0x212679(0x173)](_0x212679(0x1ad)),'role':_0x361d89,'profile':_0x421ffd,'adjustment':_0x90c79c,'stock':_0x221bdc,'master_shop':_0x50e066,'warehouse_name':_0x388042,'unit':_0x27475a,'language':_0x54201b,'warehouse':_0x49d486});}catch(_0x2c88ac){console[_0x212679(0x1a7)](_0x2c88ac),_0x3a7a62[_0x212679(0x148)](0xc8)[_0x212679(0x1ca)]({'message':_0x2c88ac[_0x212679(0x146)]});}}),router[a0_0x4a3a54(0x16d)](a0_0x4a3a54(0x1d0),auth,async(_0x270cbc,_0x2d88ac)=>{var _0x5beaef=a0_0x4a3a54;try{const _0x349d73=_0x270cbc[_0x5beaef(0x1c6)]['id'],_0x3e2aeb=await adjustment[_0x5beaef(0x10c)]({'_id':_0x349d73}),_0x1a66c5=await warehouse[_0x5beaef(0x196)]({'name':_0x3e2aeb[_0x5beaef(0x136)],'room':_0x3e2aeb[_0x5beaef(0x110)]}),{warehouse_name:_0x10aebb,date:_0x54392a,prod_name:_0x418d84,level:_0x5af83d,isle:_0x49ed7f,pallet:_0x544e2a,stock:_0x48c831,types:_0x502d03,adjust_qty:_0x3199e1,new_adjust_qty:_0x1675b7,note:_0x5d1584,Room_name:_0x3df11c,invoice:_0x2cc625,JO_number:_0x476eb3,expiry_date:_0x1ea016}=_0x270cbc[_0x5beaef(0x19f)];if(typeof _0x418d84==_0x5beaef(0x11e))var _0x2c3694=[_0x270cbc['body'][_0x5beaef(0x193)]],_0x5d53e6=[_0x270cbc[_0x5beaef(0x19f)]['level']],_0x5a6f89=[_0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x13f)]],_0x437df0=[_0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x12d)]],_0x547cf1=[_0x270cbc[_0x5beaef(0x19f)]['New_Qty_Converted_adj']],_0x73528a=[_0x270cbc['body'][_0x5beaef(0x1a9)]],_0x2651c2=[_0x270cbc['body'][_0x5beaef(0x16e)]],_0x121d53=[_0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x1a1)]],_0x1b47b3=[_0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x17c)]],_0x2992d8=[_0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x185)]],_0x12f324=[_0x270cbc[_0x5beaef(0x19f)]['expiry_date']],_0x443d4d=[_0x270cbc['body'][_0x5beaef(0x1b9)]],_0x456b64=[_0x270cbc[_0x5beaef(0x19f)]['production_date']],_0x11ed86=[_0x270cbc[_0x5beaef(0x19f)]['prod_cat']],_0x2254a0=[_0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x166)]],_0x489405=[_0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x12c)]],_0x453a7f=[_0x270cbc['body'][_0x5beaef(0x153)]];else var _0x2c3694=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x193)]],_0x5d53e6=[..._0x270cbc['body'][_0x5beaef(0x169)]],_0x5a6f89=[..._0x270cbc['body'][_0x5beaef(0x13f)]],_0x437df0=[..._0x270cbc[_0x5beaef(0x19f)]['types']],_0x547cf1=[..._0x270cbc[_0x5beaef(0x19f)]['New_Qty_Converted_adj']],_0x73528a=[..._0x270cbc[_0x5beaef(0x19f)]['New_Qty_Converted']],_0x2651c2=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x151)]],_0x121d53=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x1a1)]],_0x1b47b3=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x17c)]],_0x2992d8=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x185)]],_0x12f324=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x1ae)]],_0x443d4d=[..._0x270cbc['body']['max_per_unit']],_0x456b64=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x179)]],_0x11ed86=[..._0x270cbc[_0x5beaef(0x19f)]['prod_cat']],_0x2254a0=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x166)]],_0x489405=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x12c)]],_0x453a7f=[..._0x270cbc[_0x5beaef(0x19f)][_0x5beaef(0x153)]];const _0x2ad7fd=_0x2c3694['map'](_0x574ec3=>{return _0x574ec3={'product_name':_0x574ec3};});_0x5d53e6[_0x5beaef(0x15d)]((_0x4fca08,_0x1f2633)=>{_0x2254a0['forEach']((_0x4f3521,_0x2bca5d)=>{var _0x3e7824=a0_0x316a;if(_0x4f3521==_0x3e7824(0x13a)&&_0x1f2633==_0x2bca5d){var _0x4c7e85=_0x4fca08[_0x3e7824(0x1b5)](0x3);_0x2ad7fd[_0x1f2633]['storage']=_0x4fca08[0x0],_0x2ad7fd[_0x1f2633]['rack']=_0x4fca08[0x1],_0x2ad7fd[_0x1f2633][_0x3e7824(0x152)]=0x0,_0x2ad7fd[_0x1f2633][_0x3e7824(0x114)]=0x0,_0x2ad7fd[_0x1f2633][_0x3e7824(0x145)]=_0x3e7824(0x127),_0x2ad7fd[_0x1f2633]['floorlevel']=_0x4c7e85;}else{if(_0x4f3521==_0x3e7824(0x155)&&_0x1f2633==_0x2bca5d){var _0x4c7e85=_0x4fca08[_0x3e7824(0x1b5)](0x3);_0x2ad7fd[_0x1f2633][_0x3e7824(0x14a)]=_0x4fca08[0x0],_0x2ad7fd[_0x1f2633]['rack']=_0x4fca08[0x1],_0x2ad7fd[_0x1f2633][_0x3e7824(0x152)]=0x0,_0x2ad7fd[_0x1f2633][_0x3e7824(0x114)]=0x0,_0x2ad7fd[_0x1f2633][_0x3e7824(0x145)]=_0x3e7824(0x127),_0x2ad7fd[_0x1f2633][_0x3e7824(0x1cb)]=_0x4fca08[0x5];}else{if(_0x1f2633==_0x2bca5d){var _0xf8ca64;if(_0x4fca08[0x4]=='L')_0xf8ca64=_0x3e7824(0x1c8);else _0x4fca08[0x4]=='F'&&(_0xf8ca64=_0x3e7824(0x127));_0x2ad7fd[_0x1f2633][_0x3e7824(0x14a)]=_0x4fca08[0x0],_0x2ad7fd[_0x1f2633][_0x3e7824(0x17e)]=_0x4fca08[0x1],_0x2ad7fd[_0x1f2633][_0x3e7824(0x152)]=_0x4fca08[0x2],_0x2ad7fd[_0x1f2633][_0x3e7824(0x114)]=_0x4fca08[0x3],_0x2ad7fd[_0x1f2633][_0x3e7824(0x145)]=_0xf8ca64,_0x2ad7fd[_0x1f2633]['floorlevel']=_0x4fca08[0x5];}}}});}),_0x5a6f89[_0x5beaef(0x15d)]((_0xd66b14,_0x36e11f)=>{var _0x1add26=_0x5beaef;_0x2ad7fd[_0x36e11f][_0x1add26(0x19a)]=_0xd66b14;}),_0x437df0['forEach']((_0x50e1ee,_0x544ac6)=>{_0x2ad7fd[_0x544ac6]['types']=_0x50e1ee;}),_0x547cf1['forEach']((_0x2d57b1,_0x592a40)=>{var _0x4249f2=_0x5beaef;_0x2ad7fd[_0x592a40][_0x4249f2(0x134)]=_0x2d57b1;}),_0x73528a[_0x5beaef(0x15d)]((_0x491eba,_0x2a25dc)=>{var _0x5d0340=_0x5beaef;_0x2ad7fd[_0x2a25dc][_0x5d0340(0x10d)]=_0x491eba;}),_0x2651c2[_0x5beaef(0x15d)]((_0x1bc0b4,_0x265ccb)=>{var _0x4e5203=_0x5beaef;_0x2ad7fd[_0x265ccb][_0x4e5203(0x151)]=_0x1bc0b4;}),_0x121d53[_0x5beaef(0x15d)]((_0x50f22d,_0x227404)=>{var _0x4beb37=_0x5beaef;_0x2ad7fd[_0x227404][_0x4beb37(0x1bc)]=_0x50f22d;}),_0x1b47b3['forEach']((_0x9904ff,_0x3045c2)=>{var _0x9d8acd=_0x5beaef;_0x2ad7fd[_0x3045c2][_0x9d8acd(0x19e)]=_0x9904ff;}),_0x2992d8[_0x5beaef(0x15d)]((_0x1ddaf9,_0x245faf)=>{var _0xaae625=_0x5beaef;_0x2ad7fd[_0x245faf][_0xaae625(0x185)]=_0x1ddaf9;}),_0x12f324['forEach']((_0x115510,_0x137245)=>{var _0x3035d4=_0x5beaef;_0x2ad7fd[_0x137245][_0x3035d4(0x1ae)]=_0x115510;}),_0x443d4d[_0x5beaef(0x15d)]((_0x352c06,_0x37d3bc)=>{var _0x470f30=_0x5beaef;_0x2ad7fd[_0x37d3bc][_0x470f30(0x12a)]=_0x352c06;}),_0x456b64['forEach']((_0x479edc,_0x295c47)=>{var _0x254507=_0x5beaef;_0x2ad7fd[_0x295c47][_0x254507(0x179)]=_0x479edc;}),_0x11ed86[_0x5beaef(0x15d)]((_0x5ac8cb,_0x57a3bf)=>{var _0x26f4e7=_0x5beaef;_0x2ad7fd[_0x57a3bf][_0x26f4e7(0x121)]=_0x5ac8cb;}),_0x2254a0[_0x5beaef(0x15d)]((_0x3798da,_0xa36b3e)=>{var _0x37055c=_0x5beaef;_0x2ad7fd[_0xa36b3e][_0x37055c(0x161)]=_0x3798da;}),_0x489405[_0x5beaef(0x15d)]((_0x901a72,_0x16e721)=>{var _0x4d94e4=_0x5beaef;_0x2ad7fd[_0x16e721][_0x4d94e4(0x13d)]=_0x901a72;}),_0x453a7f[_0x5beaef(0x15d)]((_0x1b6d5e,_0xdfdc02)=>{_0x2ad7fd[_0xdfdc02]['secondary_code']=_0x1b6d5e;});const _0x2cd418=_0x2ad7fd['filter'](_0x201e2c=>_0x201e2c[_0x5beaef(0x134)]!=='0'&&_0x201e2c['adjust_qty']!=='');var _0x3fc1ee=0x0;_0x2cd418[_0x5beaef(0x15d)](_0x1879b7=>{var _0x15d479=_0x5beaef;console[_0x15d479(0x1a7)](_0x15d479(0x14e),_0x1879b7),parseInt(_0x1879b7[_0x15d479(0x134)])<=0x0&&_0x3fc1ee++;});if(_0x3fc1ee!=0x0)return _0x270cbc[_0x5beaef(0x173)](_0x5beaef(0x1ad),_0x5beaef(0x19c)),_0x2d88ac['redirect'](_0x5beaef(0x11f));_0x3e2aeb['warehouse_name']=_0x10aebb,_0x3e2aeb['date']=_0x54392a,_0x3e2aeb[_0x5beaef(0x1c5)]=_0x2cd418,_0x3e2aeb['note']=_0x5d1584,_0x3e2aeb['invoice']=_0x2cc625,_0x3e2aeb['isAllowEdit']='False';const _0x3cf504=await _0x3e2aeb[_0x5beaef(0x1cd)]();_0x270cbc['flash'](_0x5beaef(0x188),_0x5beaef(0x1d2)),_0x2d88ac[_0x5beaef(0x1a3)](_0x5beaef(0x15c));}catch(_0x448963){console[_0x5beaef(0x1a7)](_0x448963);}}),router['post']('/barcode_scanner',async(_0x33aa0f,_0x10e0fc)=>{var _0xd9f4c3=a0_0x4a3a54;const {primary_code:_0x38b1f9,warehouse_data:_0x2b3518,rooms_data:_0x9f3be1,Roomslist:_0x4c0055}=_0x33aa0f['body'],_0x59a7f3=_0x4c0055['split'](','),_0x496678=[];async function _0x2a84c5(_0x5e1aa2){var _0x332ad6=a0_0x316a;const _0x3c3fb7=await warehouse[_0x332ad6(0x157)]([{'$match':{'name':_0x2b3518,'room':_0x5e1aa2}},{'$unwind':_0x332ad6(0x1c3)},{'$match':{'product_details.primary_code':_0x38b1f9}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x332ad6(0x119)},'product_stock':{'$first':_0x332ad6(0x171)},'primary_code':{'$first':_0x332ad6(0x137)},'secondary_code':{'$first':_0x332ad6(0x1b1)},'product_code':{'$first':_0x332ad6(0x1aa)},'level':{'$first':_0x332ad6(0x116)},'isle':{'$first':_0x332ad6(0x1a8)},'type':{'$first':_0x332ad6(0x159)},'pallet':{'$first':_0x332ad6(0x131)},'unit':{'$first':_0x332ad6(0x189)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x332ad6(0x112)},'rack':{'$first':_0x332ad6(0x129)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x332ad6(0x11c)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x332ad6(0x138)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x332ad6(0x15f)},'invoice':{'$first':_0x332ad6(0x197)}}}]),_0xac0a91=await warehouse[_0x332ad6(0x157)]([{'$match':{'name':_0x2b3518,'room':_0x5e1aa2}},{'$unwind':_0x332ad6(0x1c3)},{'$match':{'product_details.secondary_code':_0x38b1f9}},{'$group':{'_id':_0x332ad6(0x17a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x332ad6(0x171)},'primary_code':{'$first':_0x332ad6(0x137)},'secondary_code':{'$first':_0x332ad6(0x1b1)},'product_code':{'$first':_0x332ad6(0x1aa)},'level':{'$first':_0x332ad6(0x116)},'isle':{'$first':_0x332ad6(0x1a8)},'type':{'$first':_0x332ad6(0x159)},'pallet':{'$first':_0x332ad6(0x131)},'unit':{'$first':_0x332ad6(0x189)},'secondary_unit':{'$first':_0x332ad6(0x198)},'storage':{'$first':_0x332ad6(0x112)},'rack':{'$first':_0x332ad6(0x129)},'expiry_date':{'$first':_0x332ad6(0x16f)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x332ad6(0x144)},'product_cat':{'$first':_0x332ad6(0x138)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x332ad6(0x15f)}}}]);if(_0x3c3fb7['length']>0x0)_0x496678[_0x332ad6(0x183)](_0x3c3fb7);else _0xac0a91[_0x332ad6(0x1c2)]>0x0&&_0x496678[_0x332ad6(0x183)](_0xac0a91);}const _0x2b6041=_0x59a7f3[_0xd9f4c3(0x1b4)](_0x4f3502=>_0x2a84c5(_0x4f3502));await Promise['all'](_0x2b6041),_0x10e0fc[_0xd9f4c3(0x1ca)](_0x496678);}),router[a0_0x4a3a54(0x16d)](a0_0x4a3a54(0x182),async(_0x17682a,_0x5bd2f5)=>{var _0x111b0d=a0_0x4a3a54;const {primaryCode:_0x5c5307,secondaryCode:_0x337813,productCode:_0x2f5042,level:_0x3987e0,isle:_0x3ee064,pallet:_0x3b9622,warehouses:_0x3f3e92,room:_0xae698c}=_0x17682a[_0x111b0d(0x19f)];try{const _0x35e84f=await warehouse[_0x111b0d(0x157)]([{'$match':{'name':_0x3f3e92,'room':_0xae698c}},{'$unwind':_0x111b0d(0x1c3)},{'$match':{'product_details.level':parseInt(_0x3987e0),'product_details.isle':_0x3ee064,'product_details.pallet':parseInt(_0x3b9622)}},{'$group':{'_id':_0x111b0d(0x17a),'name':{'$first':_0x111b0d(0x119)},'product_stock':{'$first':_0x111b0d(0x171)},'level':{'$first':_0x111b0d(0x181)},'isle':{'$first':_0x111b0d(0x177)},'pallet':{'$first':_0x111b0d(0x1a4)},'maxProducts':{'$first':_0x111b0d(0x191)}}}]);_0x5bd2f5[_0x111b0d(0x148)](0xc8)['json'](_0x35e84f);}catch(_0x419a2e){_0x5bd2f5[_0x111b0d(0x148)](0x194)[_0x111b0d(0x1ca)]({'message':_0x419a2e[_0x111b0d(0x146)]});}}),module['exports']=router;