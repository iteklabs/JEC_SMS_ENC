var a0_0x37997a=a0_0x4472;(function(_0x1e66c2,_0x3ba8eb){var _0x2c67d3=a0_0x4472,_0x264495=_0x1e66c2();while(!![]){try{var _0x4026d0=parseInt(_0x2c67d3(0x16e))/0x1+-parseInt(_0x2c67d3(0x131))/0x2+parseInt(_0x2c67d3(0x140))/0x3+-parseInt(_0x2c67d3(0x17c))/0x4*(-parseInt(_0x2c67d3(0x17d))/0x5)+parseInt(_0x2c67d3(0x1dc))/0x6*(-parseInt(_0x2c67d3(0x186))/0x7)+parseInt(_0x2c67d3(0x137))/0x8*(-parseInt(_0x2c67d3(0x15c))/0x9)+parseInt(_0x2c67d3(0x200))/0xa*(-parseInt(_0x2c67d3(0x182))/0xb);if(_0x4026d0===_0x3ba8eb)break;else _0x264495['push'](_0x264495['shift']());}catch(_0x50e5f3){_0x264495['push'](_0x264495['shift']());}}}(a0_0x4eb1,0x1c11b));const express=require('express'),app=express(),router=express[a0_0x37997a(0x198)](),auth=require(a0_0x37997a(0x1ec)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x37997a(0x18d)),users=require(a0_0x37997a(0x165)),nodemailer=require(a0_0x37997a(0x189));router[a0_0x37997a(0x19a)](a0_0x37997a(0x171),auth,async(_0x1b444c,_0x553790)=>{var _0x179745=a0_0x37997a;try{const {username:_0x383b24,email:_0x3e8894,role:_0x352eb8}=_0x1b444c[_0x179745(0x173)],_0x5462fe=_0x1b444c[_0x179745(0x173)],_0x6ed32b=await profile[_0x179745(0x159)]({'email':_0x5462fe[_0x179745(0x1da)]}),_0x800d2e=await master_shop[_0x179745(0x1f6)]();console[_0x179745(0x152)]('master',_0x800d2e);let _0x378bcc;if(_0x5462fe[_0x179745(0x149)]==_0x179745(0x164)){const _0x3d6359=await staff[_0x179745(0x159)]({'email':_0x5462fe[_0x179745(0x1da)]});_0x378bcc=await warehouse['find']({'status':_0x179745(0x153),'name':_0x3d6359[_0x179745(0x1ed)]});}else _0x378bcc=await warehouse[_0x179745(0x1f6)]({'status':_0x179745(0x153)});const _0x683fe=await product[_0x179745(0x1f6)]();let _0x106ab5;if(_0x5462fe['role']==_0x179745(0x164)){const _0xc890f3=await staff[_0x179745(0x159)]({'email':_0x5462fe[_0x179745(0x1da)]});_0x106ab5=await adjustment[_0x179745(0x1f6)]({'warehouse_name':_0xc890f3[_0x179745(0x1ed)]});}else _0x106ab5=await adjustment[_0x179745(0x1de)]([{'$unwind':_0x179745(0x170)},{'$group':{'_id':_0x179745(0x1e8),'invoice':{'$first':_0x179745(0x147)},'date':{'$first':_0x179745(0x174)},'warehouse_name':{'$first':_0x179745(0x1ab)},'room':{'$addToSet':_0x179745(0x161)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x179745(0x151)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x800d2e[0x0][_0x179745(0x1e7)]==_0x179745(0x1ae)){var _0x16f459=users[_0x179745(0x188)];console['log'](_0x16f459);}else{if(_0x800d2e[0x0]['language']==_0x179745(0x1d6))var _0x16f459=users['Hindi'];else{if(_0x800d2e[0x0][_0x179745(0x1e7)]=='German')var _0x16f459=users[_0x179745(0x13d)];else{if(_0x800d2e[0x0][_0x179745(0x1e7)]==_0x179745(0x17e))var _0x16f459=users[_0x179745(0x17e)];else{if(_0x800d2e[0x0][_0x179745(0x1e7)]==_0x179745(0x192))var _0x16f459=users[_0x179745(0x192)];else{if(_0x800d2e[0x0][_0x179745(0x1e7)]==_0x179745(0x1cf))var _0x16f459=users['Portuguese'];else{if(_0x800d2e[0x0]['language']=='Chinese')var _0x16f459=users['Chinese'];else{if(_0x800d2e[0x0][_0x179745(0x1e7)]==_0x179745(0x1a6))var _0x16f459=users['Arabic'];}}}}}}}_0x553790['render']('adjustment',{'success':_0x1b444c['flash'](_0x179745(0x1df)),'errors':_0x1b444c['flash'](_0x179745(0x155)),'role':_0x5462fe,'profile':_0x6ed32b,'warehouse':_0x378bcc,'product':_0x683fe,'adjustment':_0x106ab5,'master_shop':_0x800d2e,'language':_0x16f459});}catch(_0x6bd4d5){console[_0x179745(0x152)](_0x6bd4d5);}});function a0_0x4472(_0x371499,_0x1b2030){var _0x4eb14f=a0_0x4eb1();return a0_0x4472=function(_0x44727d,_0x126369){_0x44727d=_0x44727d-0x131;var _0x426ea9=_0x4eb14f[_0x44727d];return _0x426ea9;},a0_0x4472(_0x371499,_0x1b2030);}async function getRandom8DigitNumber(){var _0x3d051b=a0_0x37997a;const _0x3e55d5=0x989680,_0x43f49a=0x5f5e0ff,_0x4ae725=Math[_0x3d051b(0x135)](Math['random']()*(_0x43f49a-_0x3e55d5+0x1))+_0x3e55d5;var _0x188119;const _0x31da62=await adjustment[_0x3d051b(0x159)]({'invoice':'ADJ-'+_0x4ae725});return _0x31da62&&_0x31da62[_0x3d051b(0x19b)]>0x0?_0x188119=_0x3d051b(0x1e6)+_0x4ae725:_0x188119='ADJ-'+_0x4ae725,_0x188119;}function a0_0x4eb1(){var _0x1c4f98=['post','<table\x20style=\x22width:\x20100%\x20!important;\x22>','room_names','minus','bay','An\x20error\x20occurred.','Portuguese\x20(BR)','<tr>','/adjustment/view','_id','$room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.expiry_date','Hindi','$product_details._id','adjustment\x20Finalized\x20successfully','$product_details.type','email','adjustment\x20add\x20successfull','67932bbngKs','Chinese','aggregate','success','Level','<html><head><title></title>','<hr\x20class=\x22my-3\x22>','True','port','$product_details.secondary_code','ADJ-','language','$_id','types','findById','createTransport','../middleware/auth','warehouse','$product_details.unit','$product_details.batch_code','/upload/','save','unit','Shelves','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','find','prod_invoice','<tbody\x20style=\x22text-align:\x20center;\x22>','expiry_date','room','$product_details.rack','$product_details.primary_code','$product_details.isle','all','$name','30EZlAmX','product_name','Return\x20Goods','48314fMCLgf','edit_adjustment_view','string','map','floor','id_transaction_from','16BSLgLx','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','An\x20error\x20occurred\x20while\x20saving\x20data.','\x20<>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','prod_code','German','bin','Raw\x20Materials','487350MhEeZc','$product.product_name','adjust_qty','$product_details.level','</body></html>','product_code','/view/:id','$invoice','$product_details','role','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</thead>','type','Logo.png','Floor','site_title','render','$isAllowEdit','log','Enabled','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','errors','</tr>','foreach\x20newproduct','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','findOne','add_adjustment','forEach','248652kDhtll','$product_details.product_cat','New_Qty_Converted','</td>','redirect','$product.room_names','$product_details.production_date','flash','staff','../public/language/languages.json','Adjustment\x20Mail','<strong>\x20Regards\x20</strong>','Receiving\x20Area','padStart','$product_details.product_name','RMSEmail','adjustment\x20data\x20update\x20successfully','</tbody>','165445nJQtgy','status','$product','/view','stock','user','$date','maxperunit','id_transaction','<div>','sendMail','$product_details.product_stock','$product_details.bay','prime1','28CeaNQs','83675bVcCTj','Spanish','primary_code','params','product_details','462418mCPWSf','<span\x20style=\x22float:\x20right;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','message','77ULERGO','Email\x20sent\x20successfully','English','nodemailer','$product_details.storage','then','\x20</h2>','../models/all_models','Rooms','</div>','product','$product_details.pallet','French','storage','back','exports','catch','$product_details.floorlevel','Router','$product_details.bin','get','length','slice','New_Qty_Converted_adj','/adjustment/preview/','</h5>','split','invoice','production_date','</span>','error','/../public','Arabic\x20(ae)','json','filter','rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$warehouse_name','Secondary_units','/view/add_adjustment','English\x20(US)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<!DOCTYPE\x20html>','secondary_code','floorlevel','body','stockBefore','/barcode_scanner','date','push','max_per_unit','Primary_Units','batch_code','product_stock','$product_details.maxPerUnit','prod_cat','new_adjust_qty','/preview/:id','</table>','warehouse_name','$product_details.secondary_unit','second1','prod_name','level','host','/CheckingWarehouse'];a0_0x4eb1=function(){return _0x1c4f98;};return a0_0x4eb1();}router[a0_0x37997a(0x19a)](a0_0x37997a(0x1ad),auth,async(_0x30ebc2,_0x13f6d8)=>{var _0x321f6b=a0_0x37997a;try{const {username:_0x14793c,email:_0x2f36a9,role:_0x8a1d2a}=_0x30ebc2[_0x321f6b(0x173)],_0x38cc29=_0x30ebc2[_0x321f6b(0x173)],_0x5efd7f=await profile[_0x321f6b(0x159)]({'email':_0x38cc29[_0x321f6b(0x1da)]}),_0x3abf31=await master_shop[_0x321f6b(0x1f6)]();let _0x56824c;if(_0x38cc29[_0x321f6b(0x149)]==_0x321f6b(0x164)){const _0x5d2cd7=await staff[_0x321f6b(0x159)]({'email':_0x38cc29[_0x321f6b(0x1da)]});_0x56824c=await warehouse[_0x321f6b(0x1de)]([{'$match':{'status':'Enabled','name':_0x5d2cd7['warehouse'],'warehouse_category':_0x321f6b(0x13f),'name':{'$ne':_0x321f6b(0x202)}}},{'$group':{'_id':_0x321f6b(0x1ff),'name':{'$first':'$name'}}}]);}else _0x56824c=await warehouse[_0x321f6b(0x1de)]([{'$match':{'status':'Enabled','warehouse_category':_0x321f6b(0x13f),'name':{'$ne':_0x321f6b(0x202)}}},{'$group':{'_id':_0x321f6b(0x1ff),'name':{'$first':_0x321f6b(0x1ff)}}}]);const _0x3c520e=await product[_0x321f6b(0x1f6)]({}),_0x20169f=await adjustment[_0x321f6b(0x1f6)]({}),_0x5ce2ac=_0x20169f['length']+0x1,_0x244689='ADJ-'+_0x5ce2ac['toString']()[_0x321f6b(0x169)](0x5,'0');var _0x135272=['Ambient','Enclosed','Return\x20Rooms'];if(_0x3abf31[0x0]['language']==_0x321f6b(0x1ae))var _0x229ba4=users[_0x321f6b(0x188)];else{if(_0x3abf31[0x0][_0x321f6b(0x1e7)]==_0x321f6b(0x1d6))var _0x229ba4=users[_0x321f6b(0x1d6)];else{if(_0x3abf31[0x0][_0x321f6b(0x1e7)]==_0x321f6b(0x13d))var _0x229ba4=users['German'];else{if(_0x3abf31[0x0]['language']==_0x321f6b(0x17e))var _0x229ba4=users[_0x321f6b(0x17e)];else{if(_0x3abf31[0x0][_0x321f6b(0x1e7)]==_0x321f6b(0x192))var _0x229ba4=users[_0x321f6b(0x192)];else{if(_0x3abf31[0x0][_0x321f6b(0x1e7)]==_0x321f6b(0x1cf))var _0x229ba4=users['Portuguese'];else{if(_0x3abf31[0x0][_0x321f6b(0x1e7)]=='Chinese')var _0x229ba4=users[_0x321f6b(0x1dd)];else{if(_0x3abf31[0x0][_0x321f6b(0x1e7)]==_0x321f6b(0x1a6))var _0x229ba4=users['Arabic'];}}}}}}}const _0x4a8661=getRandom8DigitNumber();_0x4a8661[_0x321f6b(0x18b)](_0x390877=>{var _0x962e7b=_0x321f6b;_0x13f6d8[_0x962e7b(0x150)](_0x962e7b(0x15a),{'success':_0x30ebc2[_0x962e7b(0x163)](_0x962e7b(0x1df)),'errors':_0x30ebc2['flash'](_0x962e7b(0x155)),'role':_0x38cc29,'profile':_0x5efd7f,'warehouse':_0x56824c,'product':_0x3c520e,'master_shop':_0x3abf31,'language':_0x229ba4,'rooms_data':_0x135272,'invoice_no':_0x390877});})['catch'](_0x6742c8=>{var _0x114ac5=_0x321f6b;_0x30ebc2['flash']('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x13f6d8[_0x114ac5(0x160)](_0x114ac5(0x1d1));});}catch(_0x1e0785){console[_0x321f6b(0x152)](_0x1e0785);}}),router[a0_0x37997a(0x1c9)](a0_0x37997a(0x1ad),auth,async(_0x19ac2d,_0x29f9ed)=>{var _0x347774=a0_0x37997a;try{const {warehouse_name:_0x55da02,date:_0x44b261,prod_name:_0x23c108,level:_0x3fd39a,isle:_0x1a5a00,pallet:_0x1d9b6e,stock:_0x5de2ce,types:_0x564bd4,adjust_qty:_0x1ab884,new_adjust_qty:_0x43963b,note:_0x22c22b,Room_name:_0x24a14b,invoice:_0x191a15,JO_number:_0x41855c,expiry_date:_0x290554}=_0x19ac2d[_0x347774(0x1b4)];if(typeof _0x23c108==_0x347774(0x133))var _0x311674=[_0x19ac2d['body'][_0x347774(0x1c5)]],_0xf28de9=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1c6)]],_0x325376=[_0x19ac2d['body'][_0x347774(0x172)]],_0x393a7a=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1e9)]],_0x248e21=[_0x19ac2d[_0x347774(0x1b4)]['New_Qty_Converted_adj']],_0xc2837e=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x15e)]],_0x696a6=[_0x19ac2d['body'][_0x347774(0x1ba)]],_0x416bbb=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1ac)]],_0x4d2666=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x13c)]],_0x3d254d=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1bb)]],_0x14629d=[_0x19ac2d['body']['expiry_date']],_0xe5db3=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1b9)]],_0x1e80f9=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1a2)]],_0x4de892=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1be)]],_0x269020=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x18e)]],_0x435c02=[_0x19ac2d['body'][_0x347774(0x17b)]],_0x274a51=[_0x19ac2d[_0x347774(0x1b4)]['second1']],_0x145b36=[_0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1f7)]],_0x46c249=[_0x19ac2d['body'][_0x347774(0x176)]];else var _0x311674=[..._0x19ac2d[_0x347774(0x1b4)]['prod_name']],_0xf28de9=[..._0x19ac2d[_0x347774(0x1b4)]['level']],_0x325376=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x172)]],_0x393a7a=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1e9)]],_0x248e21=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x19d)]],_0xc2837e=[..._0x19ac2d[_0x347774(0x1b4)]['New_Qty_Converted']],_0x696a6=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1f2)]],_0x416bbb=[..._0x19ac2d['body'][_0x347774(0x1ac)]],_0x4d2666=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x13c)]],_0x3d254d=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1bb)]],_0x14629d=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1f9)]],_0xe5db3=[..._0x19ac2d[_0x347774(0x1b4)]['max_per_unit']],_0x1e80f9=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1a2)]],_0x4de892=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1be)]],_0x269020=[..._0x19ac2d['body'][_0x347774(0x18e)]],_0x435c02=[..._0x19ac2d[_0x347774(0x1b4)]['prime1']],_0x274a51=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x1c4)]],_0x145b36=[..._0x19ac2d['body'][_0x347774(0x1f7)]],_0x46c249=[..._0x19ac2d[_0x347774(0x1b4)][_0x347774(0x176)]];const _0x384e1a=_0x311674[_0x347774(0x134)](_0x25578f=>{return _0x25578f={'product_name':_0x25578f};});_0xf28de9['forEach']((_0x330880,_0x7756af)=>{var _0x3668e9=_0x347774;_0x269020[_0x3668e9(0x15b)]((_0x58075c,_0xcb3bb6)=>{var _0x577bd7=_0x3668e9;if(_0x58075c==_0x577bd7(0x168)&&_0x7756af==_0xcb3bb6){var _0x504f83=_0x330880[_0x577bd7(0x19c)](0x3);_0x384e1a[_0x7756af]['storage']=_0x330880[0x0],_0x384e1a[_0x7756af][_0x577bd7(0x1a9)]=_0x330880[0x1],_0x384e1a[_0x7756af][_0x577bd7(0x1cd)]=0x0,_0x384e1a[_0x7756af][_0x577bd7(0x13e)]=0x0,_0x384e1a[_0x7756af]['type']=_0x577bd7(0x14e),_0x384e1a[_0x7756af][_0x577bd7(0x1b3)]=_0x504f83;}else{if(_0x58075c==_0x577bd7(0x1f3)&&_0x7756af==_0xcb3bb6){var _0x504f83=_0x330880[_0x577bd7(0x19c)](0x3);_0x384e1a[_0x7756af][_0x577bd7(0x193)]=_0x330880[0x0],_0x384e1a[_0x7756af]['rack']=_0x330880[0x1],_0x384e1a[_0x7756af][_0x577bd7(0x1cd)]=0x0,_0x384e1a[_0x7756af][_0x577bd7(0x13e)]=0x0,_0x384e1a[_0x7756af][_0x577bd7(0x14c)]=_0x577bd7(0x14e),_0x384e1a[_0x7756af][_0x577bd7(0x1b3)]=_0x330880[0x5];}else{if(_0x7756af==_0xcb3bb6){var _0xa303f0;if(_0x330880[0x4]=='L')_0xa303f0='Level';else _0x330880[0x4]=='F'&&(_0xa303f0=_0x577bd7(0x14e));_0x384e1a[_0x7756af][_0x577bd7(0x193)]=_0x330880[0x0],_0x384e1a[_0x7756af]['rack']=_0x330880[0x1],_0x384e1a[_0x7756af][_0x577bd7(0x1cd)]=_0x330880[0x2],_0x384e1a[_0x7756af][_0x577bd7(0x13e)]=_0x330880[0x3],_0x384e1a[_0x7756af][_0x577bd7(0x14c)]=_0xa303f0,_0x384e1a[_0x7756af][_0x577bd7(0x1b3)]=_0x330880[0x5];}}}});}),_0x325376['forEach']((_0x4491db,_0x5e318f)=>{var _0x42a123=_0x347774;_0x384e1a[_0x5e318f][_0x42a123(0x1b5)]=_0x4491db;}),_0x46c249[_0x347774(0x15b)]((_0x3f9c35,_0x400574)=>{var _0x2085a3=_0x347774;_0x384e1a[_0x400574][_0x2085a3(0x136)]=_0x3f9c35;}),_0x393a7a[_0x347774(0x15b)]((_0x4934d8,_0x41600f)=>{var _0x4ea024=_0x347774;_0x384e1a[_0x41600f][_0x4ea024(0x1e9)]=_0x4934d8;}),_0x248e21['forEach']((_0x516eed,_0x5d5480)=>{var _0x4a2977=_0x347774;_0x384e1a[_0x5d5480][_0x4a2977(0x142)]=_0x516eed;}),_0xc2837e[_0x347774(0x15b)]((_0x4fb70d,_0x5187fc)=>{var _0x33d23c=_0x347774;_0x384e1a[_0x5187fc][_0x33d23c(0x1bf)]=_0x4fb70d;}),_0x696a6['forEach']((_0x266baa,_0x1ae253)=>{var _0x45de15=_0x347774;_0x384e1a[_0x1ae253][_0x45de15(0x1f2)]=_0x266baa;}),_0x416bbb[_0x347774(0x15b)]((_0x12f9f3,_0x81b511)=>{_0x384e1a[_0x81b511]['secondary_unit']=_0x12f9f3;}),_0x4d2666[_0x347774(0x15b)]((_0x48f870,_0x3ee8ab)=>{var _0x3fac11=_0x347774;_0x384e1a[_0x3ee8ab][_0x3fac11(0x145)]=_0x48f870;}),_0x3d254d[_0x347774(0x15b)]((_0x8cc968,_0x172c99)=>{var _0x51058a=_0x347774;_0x384e1a[_0x172c99][_0x51058a(0x1bb)]=_0x8cc968;}),_0x14629d[_0x347774(0x15b)]((_0x31de04,_0x54e253)=>{var _0x24151c=_0x347774;_0x384e1a[_0x54e253][_0x24151c(0x1f9)]=_0x31de04;}),_0xe5db3['forEach']((_0x5e6ce1,_0x416912)=>{var _0x2b80a1=_0x347774;_0x384e1a[_0x416912][_0x2b80a1(0x175)]=_0x5e6ce1;}),_0x1e80f9[_0x347774(0x15b)]((_0x551c6e,_0x1fc3e3)=>{_0x384e1a[_0x1fc3e3]['production_date']=_0x551c6e;}),_0x4de892[_0x347774(0x15b)]((_0x40e323,_0x321da5)=>{var _0x4a5bee=_0x347774;_0x384e1a[_0x321da5][_0x4a5bee(0x1be)]=_0x40e323;}),_0x269020[_0x347774(0x15b)]((_0xa25a6a,_0x1440a4)=>{_0x384e1a[_0x1440a4]['room_names']=_0xa25a6a;}),_0x435c02[_0x347774(0x15b)]((_0x47e7fb,_0xf64ceb)=>{var _0x463104=_0x347774;_0x384e1a[_0xf64ceb][_0x463104(0x17f)]=_0x47e7fb;}),_0x274a51[_0x347774(0x15b)]((_0x3498a6,_0x4153bc)=>{var _0x506542=_0x347774;_0x384e1a[_0x4153bc][_0x506542(0x1b2)]=_0x3498a6;}),_0x145b36['forEach']((_0x430a03,_0x421805)=>{var _0x5e7d12=_0x347774;_0x384e1a[_0x421805][_0x5e7d12(0x1a1)]=_0x430a03;});const _0x495081=_0x384e1a[_0x347774(0x1a8)](_0x5222cf=>_0x5222cf[_0x347774(0x142)]!=='0'&&_0x5222cf[_0x347774(0x142)]!=='');var _0x5e033b=0x0;_0x495081[_0x347774(0x15b)](_0x5da1e4=>{var _0x41de1c=_0x347774;console[_0x41de1c(0x152)](_0x41de1c(0x157),_0x5da1e4),parseInt(_0x5da1e4['adjust_qty'])<=0x0&&_0x5e033b++;});if(_0x5e033b!=0x0)return _0x19ac2d[_0x347774(0x163)](_0x347774(0x155),_0x347774(0x138)),_0x29f9ed[_0x347774(0x160)]('back');const _0x1a5c39=new adjustment({'warehouse_name':_0x55da02,'date':_0x44b261,'product':_0x495081,'note':_0x22c22b,'room':_0x24a14b,'invoice':_0x191a15,'JO_number':_0x41855c,'expiry_date':_0x290554}),_0x258402=await _0x1a5c39['save']();_0x19ac2d[_0x347774(0x163)]('success',_0x347774(0x1db)),_0x29f9ed['redirect'](_0x347774(0x19e)+_0x258402[_0x347774(0x1d2)]);}catch(_0x59e40f){console['log'](_0x59e40f),_0x29f9ed['status'](0xc8)[_0x347774(0x1a7)]({'message':_0x59e40f[_0x347774(0x185)]});}}),router[a0_0x37997a(0x19a)](a0_0x37997a(0x1c0),auth,async(_0x20b56c,_0x1c0740)=>{var _0x100608=a0_0x37997a;try{const {username:_0x5e63ce,email:_0x205ebe,role:_0x339d15}=_0x20b56c[_0x100608(0x173)],_0x4da431=_0x20b56c[_0x100608(0x173)],_0x45638f=await profile[_0x100608(0x159)]({'email':_0x4da431[_0x100608(0x1da)]}),_0x440cae=await master_shop[_0x100608(0x1f6)](),_0x434b37=_0x20b56c[_0x100608(0x180)]['id'],_0x52c77e=await adjustment[_0x100608(0x1ea)]({'_id':_0x434b37}),_0x5b2516=await purchases[_0x100608(0x1de)]([{'$match':{'warehouse_name':_0x52c77e[_0x100608(0x1c2)]}},{'$unwind':_0x100608(0x170)},{'$group':{'_id':_0x100608(0x141)}}]),_0x1ea576=await product[_0x100608(0x1f6)]({}),_0x45e357=await warehouse[_0x100608(0x1de)]([{'$match':{'name':_0x52c77e[_0x100608(0x1c2)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x100608(0x1d7),'name':{'$first':_0x100608(0x16a)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x100608(0x199)},'type':{'$first':_0x100608(0x1d9)},'floorlevel':{'$first':_0x100608(0x197)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x100608(0x1e5)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x100608(0x18a)},'rack':{'$first':_0x100608(0x1fb)},'maxPerUnit':{'$first':_0x100608(0x1bd)},'expiry_date':{'$first':_0x100608(0x1d5)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x100608(0x1ef)},'room':{'$first':_0x100608(0x1d3)}}}]);if(_0x440cae[0x0][_0x100608(0x1e7)]==_0x100608(0x1ae)){var _0x46adeb=users['English'];console[_0x100608(0x152)](_0x46adeb);}else{if(_0x440cae[0x0]['language']==_0x100608(0x1d6))var _0x46adeb=users['Hindi'];else{if(_0x440cae[0x0]['language']==_0x100608(0x13d))var _0x46adeb=users[_0x100608(0x13d)];else{if(_0x440cae[0x0]['language']==_0x100608(0x17e))var _0x46adeb=users[_0x100608(0x17e)];else{if(_0x440cae[0x0][_0x100608(0x1e7)]==_0x100608(0x192))var _0x46adeb=users[_0x100608(0x192)];else{if(_0x440cae[0x0][_0x100608(0x1e7)]==_0x100608(0x1cf))var _0x46adeb=users['Portuguese'];else{if(_0x440cae[0x0]['language']==_0x100608(0x1dd))var _0x46adeb=users[_0x100608(0x1dd)];else{if(_0x440cae[0x0][_0x100608(0x1e7)]==_0x100608(0x1a6))var _0x46adeb=users[_0x100608(0x1f4)];}}}}}}}_0x1c0740['render'](_0x100608(0x132),{'success':_0x20b56c['flash']('success'),'errors':_0x20b56c[_0x100608(0x163)](_0x100608(0x155)),'role':_0x4da431,'profile':_0x45638f,'adjustment':_0x52c77e,'stock':_0x45e357,'master_shop':_0x440cae,'warehouse_name':_0x5b2516,'unit':_0x1ea576,'language':_0x46adeb});}catch(_0xd451b7){console[_0x100608(0x152)](_0xd451b7),_0x1c0740[_0x100608(0x16f)](0xc8)[_0x100608(0x1a7)]({'message':_0xd451b7[_0x100608(0x185)]});}}),router[a0_0x37997a(0x1c9)](a0_0x37997a(0x1c0),auth,async(_0x9ab80e,_0x3fbcc2)=>{var _0x31e205=a0_0x37997a;try{const _0x2cae60=_0x9ab80e[_0x31e205(0x180)]['id'],{warehouse_name:_0xf1a3d0,Room_name:_0x368500}=_0x9ab80e[_0x31e205(0x1b4)],_0x3bc0de=await adjustment[_0x31e205(0x1ea)]({'_id':_0x2cae60}),_0x43edd8=_0x3bc0de['product']['map'](async _0x4b6372=>{var _0x1e3dec=_0x31e205;if(_0x4b6372[_0x1e3dec(0x142)]>0x0){var _0x5f4dfa=await warehouse[_0x1e3dec(0x159)]({'name':_0xf1a3d0,'room':_0x4b6372[_0x1e3dec(0x1cb)],'warehouse_category':_0x1e3dec(0x13f)});const _0x59cb55=_0x5f4dfa[_0x1e3dec(0x181)][_0x1e3dec(0x134)](_0x422e7b=>{var _0x549c2e=_0x1e3dec;console['log'](_0x4b6372[_0x549c2e(0x1e9)]+_0x549c2e(0x13a));if(_0x4b6372[_0x549c2e(0x1e9)]==_0x549c2e(0x1cc)){if(_0x422e7b[_0x549c2e(0x201)]==_0x4b6372[_0x549c2e(0x201)]&&_0x422e7b[_0x549c2e(0x1b3)]==_0x4b6372[_0x549c2e(0x1b3)]&&_0x422e7b['type']==_0x4b6372[_0x549c2e(0x14c)]&&_0x422e7b[_0x549c2e(0x13e)]==_0x4b6372[_0x549c2e(0x13e)]&&_0x422e7b['bay']==_0x4b6372[_0x549c2e(0x1cd)]&&_0x422e7b[_0x549c2e(0x1a9)]==_0x4b6372[_0x549c2e(0x1a9)]&&_0x422e7b[_0x549c2e(0x193)]==_0x4b6372[_0x549c2e(0x193)]&&_0x422e7b[_0x549c2e(0x1f9)]==_0x4b6372['expiry_date']&&_0x422e7b['batch_code']==_0x4b6372[_0x549c2e(0x1bb)]&&_0x422e7b[_0x549c2e(0x1a2)]==_0x4b6372['production_date']&&_0x422e7b[_0x549c2e(0x1a1)]==_0x4b6372[_0x549c2e(0x1a1)]&&_0x422e7b[_0x549c2e(0x1d2)]==_0x4b6372[_0x549c2e(0x136)]){var _0x49af81;_0x49af81=_0x4b6372[_0x549c2e(0x142)],_0x4b6372[_0x549c2e(0x1be)]=='S'&&(_0x49af81=_0x4b6372[_0x549c2e(0x142)]),_0x422e7b[_0x549c2e(0x1bc)]=_0x422e7b[_0x549c2e(0x1bc)]-_0x49af81;}}else{if(_0x422e7b[_0x549c2e(0x201)]==_0x4b6372[_0x549c2e(0x201)]&&_0x422e7b['floorlevel']==_0x4b6372[_0x549c2e(0x1b3)]&&_0x422e7b[_0x549c2e(0x14c)]==_0x4b6372[_0x549c2e(0x14c)]&&_0x422e7b[_0x549c2e(0x13e)]==_0x4b6372[_0x549c2e(0x13e)]&&_0x422e7b[_0x549c2e(0x1cd)]==_0x4b6372[_0x549c2e(0x1cd)]&&_0x422e7b['rack']==_0x4b6372[_0x549c2e(0x1a9)]&&_0x422e7b[_0x549c2e(0x193)]==_0x4b6372[_0x549c2e(0x193)]&&_0x422e7b['expiry_date']==_0x4b6372[_0x549c2e(0x1f9)]&&_0x422e7b[_0x549c2e(0x1bb)]==_0x4b6372[_0x549c2e(0x1bb)]&&_0x422e7b[_0x549c2e(0x1a2)]==_0x4b6372[_0x549c2e(0x1a2)]&&_0x422e7b[_0x549c2e(0x1a1)]==_0x4b6372['invoice']&&_0x422e7b[_0x549c2e(0x1d2)]==_0x4b6372[_0x549c2e(0x136)]){console[_0x549c2e(0x152)](_0x4b6372);var _0x49af81;_0x49af81=_0x4b6372['adjust_qty'],_0x4b6372[_0x549c2e(0x1be)]=='S'&&(_0x49af81=_0x4b6372[_0x549c2e(0x142)]),_0x422e7b[_0x549c2e(0x1bc)]=_0x422e7b[_0x549c2e(0x1bc)]+_0x49af81;}}});}return _0x5f4dfa;});Promise[_0x31e205(0x1fe)](_0x43edd8)[_0x31e205(0x18b)](async _0x392b95=>{var _0x31df8e=_0x31e205;try{for(const _0x1472f4 of _0x392b95){await _0x1472f4['save']();}_0x3bc0de['finalize']=_0x31df8e(0x1e3);const _0x587cc9=await _0x3bc0de[_0x31df8e(0x1f1)](),_0x24bbcf=await master_shop[_0x31df8e(0x1f6)](),_0x1c0998=await email_settings[_0x31df8e(0x159)](),_0x1184e9=await supervisor_settings[_0x31df8e(0x1f6)]();var _0x872d40=_0x3bc0de[_0x31df8e(0x190)],_0x441105='',_0x3d95cc;for(_0x3d95cc in _0x872d40){_0x441105+=_0x31df8e(0x1d0)+_0x31df8e(0x14a)+_0x872d40[_0x3d95cc][_0x31df8e(0x201)]+'</td>'+_0x31df8e(0x14a)+_0x872d40[_0x3d95cc]['product_code']+_0x31df8e(0x15f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x872d40[_0x3d95cc][_0x31df8e(0x142)]+_0x31df8e(0x15f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x872d40[_0x3d95cc][_0x31df8e(0x1f2)]+_0x31df8e(0x15f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x872d40[_0x3d95cc]['secondary_unit']+_0x31df8e(0x15f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3bc0de[_0x31df8e(0x1c2)]+'</td>'+_0x31df8e(0x14a)+_0x872d40[_0x3d95cc][_0x31df8e(0x1cb)]+_0x31df8e(0x15f)+_0x31df8e(0x14a)+_0x872d40[_0x3d95cc]['storage']+_0x872d40[_0x3d95cc][_0x31df8e(0x1a9)]+_0x872d40[_0x3d95cc][_0x31df8e(0x1cd)]+_0x872d40[_0x3d95cc][_0x31df8e(0x13e)]+_0x872d40[_0x3d95cc][_0x31df8e(0x14c)][0x0]+_0x872d40[_0x3d95cc][_0x31df8e(0x1b3)]+_0x31df8e(0x15f),_0x31df8e(0x156);}let _0x44da94=nodemailer[_0x31df8e(0x1eb)]({'host':_0x1c0998[_0x31df8e(0x1c7)],'port':Number(_0x1c0998[_0x31df8e(0x1e4)]),'secure':![],'auth':{'user':_0x1c0998['email'],'pass':_0x1c0998['password']}}),_0x2ae894={'from':_0x1c0998['email'],'to':_0x1184e9[0x0][_0x31df8e(0x16b)],'subject':_0x31df8e(0x166),'attachments':[{'filename':_0x31df8e(0x14d),'path':__dirname+_0x31df8e(0x1a5)+_0x31df8e(0x1f0)+_0x24bbcf[0x0]['image'],'cid':'logo'}],'html':_0x31df8e(0x1b1)+_0x31df8e(0x1e1)+'</head><body>'+_0x31df8e(0x177)+_0x31df8e(0x1b0)+_0x31df8e(0x177)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x31df8e(0x18f)+_0x31df8e(0x177)+'<h2>\x20'+_0x24bbcf[0x0][_0x31df8e(0x14f)]+_0x31df8e(0x18c)+_0x31df8e(0x18f)+_0x31df8e(0x18f)+_0x31df8e(0x1e2)+_0x31df8e(0x177)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x3bc0de['invoice']+'\x20'+_0x31df8e(0x183)+'\x20Order\x20Date\x20:\x20'+_0x3bc0de[_0x31df8e(0x1b7)]+'\x20'+_0x31df8e(0x1a3)+'</h5>'+'</div>'+_0x31df8e(0x1ca)+_0x31df8e(0x158)+_0x31df8e(0x1d0)+_0x31df8e(0x13b)+_0x31df8e(0x1d4)+_0x31df8e(0x184)+_0x31df8e(0x1aa)+_0x31df8e(0x1f5)+_0x31df8e(0x154)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x31df8e(0x1af)+_0x31df8e(0x156)+_0x31df8e(0x14b)+_0x31df8e(0x1f8)+'\x20'+_0x441105+'\x20'+_0x31df8e(0x16d)+_0x31df8e(0x1c1)+_0x31df8e(0x177)+_0x31df8e(0x167)+'<h5>'+_0x24bbcf[0x0]['site_title']+_0x31df8e(0x19f)+_0x31df8e(0x18f)+_0x31df8e(0x18f)+_0x31df8e(0x144)};_0x44da94[_0x31df8e(0x178)](_0x2ae894,function(_0x43eb9e,_0x2bfe23){var _0x44d793=_0x31df8e;_0x43eb9e?(console['log'](_0x43eb9e),console[_0x44d793(0x152)]('Error\x20Occurs')):console[_0x44d793(0x152)](_0x44d793(0x187));}),_0x9ab80e[_0x31df8e(0x163)]('success',_0x31df8e(0x1d8)),_0x3fbcc2[_0x31df8e(0x160)]('/picking_list/PDF_adjustment_rm/'+_0x587cc9[_0x31df8e(0x1d2)]);}catch(_0x2f3f1d){console['error'](_0x2f3f1d),_0x3fbcc2['status'](0x1f4)[_0x31df8e(0x1a7)]({'error':_0x31df8e(0x139)});}})[_0x31e205(0x196)](_0x500522=>{var _0x10a3ba=_0x31e205;console[_0x10a3ba(0x1a4)](_0x500522),_0x3fbcc2[_0x10a3ba(0x16f)](0x1f4)[_0x10a3ba(0x1a7)]({'error':_0x10a3ba(0x1ce)});});}catch(_0x4d7eb7){console[_0x31e205(0x152)](_0x4d7eb7),_0x3fbcc2[_0x31e205(0x16f)](0xc8)[_0x31e205(0x1a7)]({'message':_0x4d7eb7[_0x31e205(0x185)]});}}),router[a0_0x37997a(0x19a)]('/view/:id',auth,async(_0x208ca3,_0x3d963a)=>{var _0x9a8d07=a0_0x37997a;try{const {username:_0x35d1e5,email:_0x12392e,role:_0x33516d}=_0x208ca3[_0x9a8d07(0x173)],_0x51c349=_0x208ca3[_0x9a8d07(0x173)],_0x45ca4b=await profile[_0x9a8d07(0x159)]({'email':_0x51c349[_0x9a8d07(0x1da)]}),_0x4a905e=await master_shop[_0x9a8d07(0x1f6)](),_0x5c6c62=_0x208ca3[_0x9a8d07(0x180)]['id'],_0x589ca3=await adjustment[_0x9a8d07(0x1ea)]({'_id':_0x5c6c62}),_0xb913cd=await purchases['aggregate']([{'$match':{'warehouse_name':_0x589ca3[_0x9a8d07(0x1c2)]}},{'$unwind':_0x9a8d07(0x170)},{'$group':{'_id':_0x9a8d07(0x141)}}]),_0x16807=await product[_0x9a8d07(0x1f6)]({}),_0x21dda9=await warehouse[_0x9a8d07(0x1de)]([{'$match':{'name':_0x589ca3[_0x9a8d07(0x1c2)]}},{'$unwind':_0x9a8d07(0x148)},{'$group':{'_id':_0x9a8d07(0x1d7),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x9a8d07(0x17a)},'bin':{'$first':_0x9a8d07(0x199)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x9a8d07(0x197)},'primary_code':{'$first':_0x9a8d07(0x1fc)},'secondary_code':{'$first':_0x9a8d07(0x1e5)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x9a8d07(0x18a)},'rack':{'$first':_0x9a8d07(0x1fb)},'maxPerUnit':{'$first':_0x9a8d07(0x1bd)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x9a8d07(0x162)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x9a8d07(0x1d3)}}}]);let _0x39c5a9;if(_0x51c349[_0x9a8d07(0x149)]==_0x9a8d07(0x164)){const _0x1c67e4=await staff[_0x9a8d07(0x159)]({'email':_0x51c349[_0x9a8d07(0x1da)]});_0x39c5a9=await warehouse[_0x9a8d07(0x1de)]([{'$match':{'status':_0x9a8d07(0x153),'name':_0x1c67e4[_0x9a8d07(0x1ed)],'warehouse_category':_0x9a8d07(0x13f),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x9a8d07(0x1ff),'name':{'$first':_0x9a8d07(0x1ff)}}}]);}else _0x39c5a9=await warehouse[_0x9a8d07(0x1de)]([{'$match':{'status':_0x9a8d07(0x153),'warehouse_category':_0x9a8d07(0x13f),'name':{'$ne':_0x9a8d07(0x202)}}},{'$group':{'_id':_0x9a8d07(0x1ff),'name':{'$first':_0x9a8d07(0x1ff)}}}]);if(_0x4a905e[0x0][_0x9a8d07(0x1e7)]==_0x9a8d07(0x1ae)){var _0x433c0b=users['English'];console[_0x9a8d07(0x152)](_0x433c0b);}else{if(_0x4a905e[0x0][_0x9a8d07(0x1e7)]==_0x9a8d07(0x1d6))var _0x433c0b=users[_0x9a8d07(0x1d6)];else{if(_0x4a905e[0x0][_0x9a8d07(0x1e7)]==_0x9a8d07(0x13d))var _0x433c0b=users[_0x9a8d07(0x13d)];else{if(_0x4a905e[0x0][_0x9a8d07(0x1e7)]=='Spanish')var _0x433c0b=users['Spanish'];else{if(_0x4a905e[0x0]['language']==_0x9a8d07(0x192))var _0x433c0b=users[_0x9a8d07(0x192)];else{if(_0x4a905e[0x0][_0x9a8d07(0x1e7)]==_0x9a8d07(0x1cf))var _0x433c0b=users['Portuguese'];else{if(_0x4a905e[0x0]['language']==_0x9a8d07(0x1dd))var _0x433c0b=users['Chinese'];else{if(_0x4a905e[0x0][_0x9a8d07(0x1e7)]==_0x9a8d07(0x1a6))var _0x433c0b=users['Arabic'];}}}}}}}_0x3d963a[_0x9a8d07(0x150)]('edit_adjustment',{'success':_0x208ca3[_0x9a8d07(0x163)](_0x9a8d07(0x1df)),'errors':_0x208ca3['flash']('errors'),'role':_0x51c349,'profile':_0x45ca4b,'adjustment':_0x589ca3,'stock':_0x21dda9,'master_shop':_0x4a905e,'warehouse_name':_0xb913cd,'unit':_0x16807,'language':_0x433c0b,'warehouse':_0x39c5a9});}catch(_0x58486c){console['log'](_0x58486c),_0x3d963a[_0x9a8d07(0x16f)](0xc8)[_0x9a8d07(0x1a7)]({'message':_0x58486c[_0x9a8d07(0x185)]});}}),router['post'](a0_0x37997a(0x146),auth,async(_0x236b25,_0x423681)=>{var _0x1ce513=a0_0x37997a;try{const _0xefd32d=_0x236b25['params']['id'],_0x33491d=await adjustment['findById']({'_id':_0xefd32d}),_0xc8c4aa=await warehouse[_0x1ce513(0x159)]({'name':_0x33491d[_0x1ce513(0x1c2)],'room':_0x33491d[_0x1ce513(0x1fa)]}),{warehouse_name:_0x3ba9c2,date:_0x18849f,prod_name:_0x4dbd4c,level:_0x2e2b26,isle:_0x4c8535,pallet:_0x7d5185,stock:_0x45e281,types:_0x401698,adjust_qty:_0x49eb03,new_adjust_qty:_0x26948d,note:_0x4dd705,Room_name:_0x283693,invoice:_0x22eac1,JO_number:_0x389ef3,expiry_date:_0x51888e}=_0x236b25['body'];if(typeof _0x4dbd4c==_0x1ce513(0x133))var _0x30e97a=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1c5)]],_0x48fb94=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1c6)]],_0xdf52c4=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x172)]],_0x27e692=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1e9)]],_0xc92aa8=[_0x236b25[_0x1ce513(0x1b4)]['New_Qty_Converted_adj']],_0x414976=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x15e)]],_0x38cc81=[_0x236b25['body'][_0x1ce513(0x1ba)]],_0x1daeb3=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1ac)]],_0xaa5d04=[_0x236b25[_0x1ce513(0x1b4)]['prod_code']],_0xae0b08=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1bb)]],_0xdb9c13=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1f9)]],_0x284447=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1b9)]],_0x36a98c=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1a2)]],_0x5abbb9=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1be)]],_0x17f079=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x18e)]],_0x11091c=[_0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x17b)]],_0x14d32a=[_0x236b25['body'][_0x1ce513(0x1c4)]];else var _0x30e97a=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1c5)]],_0x48fb94=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1c6)]],_0xdf52c4=[..._0x236b25['body'][_0x1ce513(0x172)]],_0x27e692=[..._0x236b25['body'][_0x1ce513(0x1e9)]],_0xc92aa8=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x19d)]],_0x414976=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x15e)]],_0x38cc81=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1f2)]],_0x1daeb3=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1ac)]],_0xaa5d04=[..._0x236b25[_0x1ce513(0x1b4)]['prod_code']],_0xae0b08=[..._0x236b25['body'][_0x1ce513(0x1bb)]],_0xdb9c13=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1f9)]],_0x284447=[..._0x236b25[_0x1ce513(0x1b4)]['max_per_unit']],_0x36a98c=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1a2)]],_0x5abbb9=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1be)]],_0x17f079=[..._0x236b25[_0x1ce513(0x1b4)]['Rooms']],_0x11091c=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x17b)]],_0x14d32a=[..._0x236b25[_0x1ce513(0x1b4)][_0x1ce513(0x1c4)]];const _0x3c5d66=_0x30e97a[_0x1ce513(0x134)](_0x43c82f=>{return _0x43c82f={'product_name':_0x43c82f};});_0x48fb94[_0x1ce513(0x15b)]((_0x389dfa,_0x1fb190)=>{var _0x19abce=_0x1ce513;_0x17f079[_0x19abce(0x15b)]((_0x5ed540,_0x562d34)=>{var _0x20d820=_0x19abce;if(_0x5ed540==_0x20d820(0x168)&&_0x1fb190==_0x562d34){var _0x2fbda3=_0x389dfa[_0x20d820(0x19c)](0x3);_0x3c5d66[_0x1fb190][_0x20d820(0x193)]=_0x389dfa[0x0],_0x3c5d66[_0x1fb190][_0x20d820(0x1a9)]=_0x389dfa[0x1],_0x3c5d66[_0x1fb190]['bay']=0x0,_0x3c5d66[_0x1fb190][_0x20d820(0x13e)]=0x0,_0x3c5d66[_0x1fb190]['type']=_0x20d820(0x14e),_0x3c5d66[_0x1fb190]['floorlevel']=_0x2fbda3;}else{if(_0x5ed540==_0x20d820(0x1f3)&&_0x1fb190==_0x562d34){var _0x2fbda3=_0x389dfa[_0x20d820(0x19c)](0x3);_0x3c5d66[_0x1fb190][_0x20d820(0x193)]=_0x389dfa[0x0],_0x3c5d66[_0x1fb190]['rack']=_0x389dfa[0x1],_0x3c5d66[_0x1fb190][_0x20d820(0x1cd)]=0x0,_0x3c5d66[_0x1fb190][_0x20d820(0x13e)]=0x0,_0x3c5d66[_0x1fb190][_0x20d820(0x14c)]=_0x20d820(0x14e),_0x3c5d66[_0x1fb190][_0x20d820(0x1b3)]=_0x389dfa[0x5];}else{if(_0x1fb190==_0x562d34){var _0x47f576;if(_0x389dfa[0x4]=='L')_0x47f576=_0x20d820(0x1e0);else _0x389dfa[0x4]=='F'&&(_0x47f576=_0x20d820(0x14e));_0x3c5d66[_0x1fb190][_0x20d820(0x193)]=_0x389dfa[0x0],_0x3c5d66[_0x1fb190][_0x20d820(0x1a9)]=_0x389dfa[0x1],_0x3c5d66[_0x1fb190][_0x20d820(0x1cd)]=_0x389dfa[0x2],_0x3c5d66[_0x1fb190][_0x20d820(0x13e)]=_0x389dfa[0x3],_0x3c5d66[_0x1fb190][_0x20d820(0x14c)]=_0x47f576,_0x3c5d66[_0x1fb190][_0x20d820(0x1b3)]=_0x389dfa[0x5];}}}});}),_0xdf52c4[_0x1ce513(0x15b)]((_0x55bb90,_0x1fc4b3)=>{_0x3c5d66[_0x1fc4b3]['stockBefore']=_0x55bb90;}),_0x27e692[_0x1ce513(0x15b)]((_0x254545,_0xffd1c7)=>{_0x3c5d66[_0xffd1c7]['types']=_0x254545;}),_0xc92aa8[_0x1ce513(0x15b)]((_0x118d99,_0x47aeb8)=>{var _0x2d8294=_0x1ce513;_0x3c5d66[_0x47aeb8][_0x2d8294(0x142)]=_0x118d99;}),_0x414976[_0x1ce513(0x15b)]((_0x634fb6,_0x430983)=>{var _0x4cd2f8=_0x1ce513;_0x3c5d66[_0x430983][_0x4cd2f8(0x1bf)]=_0x634fb6;}),_0x38cc81[_0x1ce513(0x15b)]((_0x1aece2,_0x47df52)=>{var _0x43e474=_0x1ce513;_0x3c5d66[_0x47df52][_0x43e474(0x1f2)]=_0x1aece2;}),_0x1daeb3[_0x1ce513(0x15b)]((_0x410c66,_0x26e14f)=>{_0x3c5d66[_0x26e14f]['secondary_unit']=_0x410c66;}),_0xaa5d04[_0x1ce513(0x15b)]((_0x3b0c86,_0xb90024)=>{var _0x21eb3c=_0x1ce513;_0x3c5d66[_0xb90024][_0x21eb3c(0x145)]=_0x3b0c86;}),_0xae0b08[_0x1ce513(0x15b)]((_0x465f86,_0x36e33c)=>{var _0x1a51f1=_0x1ce513;_0x3c5d66[_0x36e33c][_0x1a51f1(0x1bb)]=_0x465f86;}),_0xdb9c13[_0x1ce513(0x15b)]((_0x46c1cd,_0x45ac8d)=>{var _0x418ac7=_0x1ce513;_0x3c5d66[_0x45ac8d][_0x418ac7(0x1f9)]=_0x46c1cd;}),_0x284447[_0x1ce513(0x15b)]((_0x22c5bc,_0x527756)=>{var _0x2703dc=_0x1ce513;_0x3c5d66[_0x527756][_0x2703dc(0x175)]=_0x22c5bc;}),_0x36a98c[_0x1ce513(0x15b)]((_0x2d0bf1,_0x2479e1)=>{var _0x7e2c87=_0x1ce513;_0x3c5d66[_0x2479e1][_0x7e2c87(0x1a2)]=_0x2d0bf1;}),_0x5abbb9[_0x1ce513(0x15b)]((_0x40b1b1,_0x427f20)=>{var _0x1b10ea=_0x1ce513;_0x3c5d66[_0x427f20][_0x1b10ea(0x1be)]=_0x40b1b1;}),_0x17f079['forEach']((_0x479ab7,_0x18a73f)=>{var _0x36770b=_0x1ce513;_0x3c5d66[_0x18a73f][_0x36770b(0x1cb)]=_0x479ab7;}),_0x11091c['forEach']((_0x5c465b,_0x2ee6b3)=>{var _0x2b8a88=_0x1ce513;_0x3c5d66[_0x2ee6b3][_0x2b8a88(0x17f)]=_0x5c465b;}),_0x14d32a[_0x1ce513(0x15b)]((_0x5a4aaf,_0x29b2df)=>{var _0x325ebe=_0x1ce513;_0x3c5d66[_0x29b2df][_0x325ebe(0x1b2)]=_0x5a4aaf;});const _0x1e5417=_0x3c5d66['filter'](_0x38de52=>_0x38de52[_0x1ce513(0x142)]!=='0'&&_0x38de52[_0x1ce513(0x142)]!=='');var _0x3bfdf5=0x0;_0x1e5417[_0x1ce513(0x15b)](_0x36173d=>{var _0x9e1467=_0x1ce513;console['log'](_0x9e1467(0x157),_0x36173d),parseInt(_0x36173d['adjust_qty'])<=0x0&&_0x3bfdf5++;});if(_0x3bfdf5!=0x0)return _0x236b25[_0x1ce513(0x163)](_0x1ce513(0x155),_0x1ce513(0x138)),_0x423681[_0x1ce513(0x160)](_0x1ce513(0x194));_0x33491d[_0x1ce513(0x1c2)]=_0x3ba9c2,_0x33491d[_0x1ce513(0x1b7)]=_0x18849f,_0x33491d[_0x1ce513(0x190)]=_0x1e5417,_0x33491d['note']=_0x4dd705,_0x33491d['invoice']=_0x22eac1,_0x33491d['isAllowEdit']='False';const _0x622a1a=await _0x33491d[_0x1ce513(0x1f1)]();_0x236b25[_0x1ce513(0x163)]('success',_0x1ce513(0x16c)),_0x423681[_0x1ce513(0x160)]('/adjustment/view');}catch(_0xa7f95c){console['log'](_0xa7f95c);}}),router[a0_0x37997a(0x1c9)](a0_0x37997a(0x1b6),async(_0x6f1ec1,_0xdb2d99)=>{var _0x5a28fd=a0_0x37997a;const {primary_code:_0x4e5d8e,warehouse_data:_0x2b230b,rooms_data:_0x4a3546,Roomslist:_0x3c7bb5}=_0x6f1ec1[_0x5a28fd(0x1b4)],_0x58ec86=_0x3c7bb5[_0x5a28fd(0x1a0)](','),_0x359fb6=[];async function _0x477e65(_0x596b71){var _0x1776c2=_0x5a28fd;const _0x4d740d=await warehouse[_0x1776c2(0x1de)]([{'$match':{'name':_0x2b230b,'room':_0x596b71}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x4e5d8e}},{'$group':{'_id':_0x1776c2(0x1d7),'name':{'$first':_0x1776c2(0x16a)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1776c2(0x1e5)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x1776c2(0x17a)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1776c2(0x1d9)},'pallet':{'$first':_0x1776c2(0x197)},'unit':{'$first':_0x1776c2(0x1ee)},'secondary_unit':{'$first':_0x1776c2(0x1c3)},'storage':{'$first':_0x1776c2(0x18a)},'rack':{'$first':_0x1776c2(0x1fb)},'expiry_date':{'$first':_0x1776c2(0x1d5)},'production_date':{'$first':_0x1776c2(0x162)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x1776c2(0x1ef)},'product_cat':{'$first':_0x1776c2(0x15d)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1776c2(0x1d3)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x49d69b=await warehouse[_0x1776c2(0x1de)]([{'$match':{'name':_0x2b230b,'room':_0x596b71}},{'$unwind':_0x1776c2(0x148)},{'$match':{'product_details.secondary_code':_0x4e5d8e}},{'$group':{'_id':_0x1776c2(0x1d7),'name':{'$first':_0x1776c2(0x16a)},'product_stock':{'$first':_0x1776c2(0x179)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1776c2(0x1e5)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x1776c2(0x17a)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1776c2(0x1d9)},'pallet':{'$first':_0x1776c2(0x197)},'unit':{'$first':_0x1776c2(0x1ee)},'secondary_unit':{'$first':_0x1776c2(0x1c3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1776c2(0x1d5)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x1776c2(0x1bd)},'batch_code':{'$first':_0x1776c2(0x1ef)},'product_cat':{'$first':_0x1776c2(0x15d)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x4d740d[_0x1776c2(0x19b)]>0x0)_0x359fb6['push'](_0x4d740d);else _0x49d69b[_0x1776c2(0x19b)]>0x0&&_0x359fb6[_0x1776c2(0x1b8)](_0x49d69b);}const _0x45a315=_0x58ec86[_0x5a28fd(0x134)](_0x14833d=>_0x477e65(_0x14833d));await Promise[_0x5a28fd(0x1fe)](_0x45a315),_0xdb2d99[_0x5a28fd(0x1a7)](_0x359fb6);}),router['post'](a0_0x37997a(0x1c8),async(_0x3a1ef4,_0x33a3dc)=>{var _0x2f8ea8=a0_0x37997a;const {primaryCode:_0x9a743a,secondaryCode:_0x3a131,productCode:_0x39a5d1,level:_0x48fa14,isle:_0x144afe,pallet:_0x13f4a4,warehouses:_0x31710d,room:_0x4e232d}=_0x3a1ef4[_0x2f8ea8(0x1b4)];try{const _0xc830f9=await warehouse[_0x2f8ea8(0x1de)]([{'$match':{'name':_0x31710d,'room':_0x4e232d}},{'$unwind':_0x2f8ea8(0x148)},{'$match':{'product_details.level':parseInt(_0x48fa14),'product_details.isle':_0x144afe,'product_details.pallet':parseInt(_0x13f4a4)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2f8ea8(0x16a)},'product_stock':{'$first':_0x2f8ea8(0x179)},'level':{'$first':_0x2f8ea8(0x143)},'isle':{'$first':_0x2f8ea8(0x1fd)},'pallet':{'$first':_0x2f8ea8(0x191)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x33a3dc['status'](0xc8)[_0x2f8ea8(0x1a7)](_0xc830f9);}catch(_0x333a21){_0x33a3dc[_0x2f8ea8(0x16f)](0x194)[_0x2f8ea8(0x1a7)]({'message':_0x333a21['message']});}}),module[a0_0x37997a(0x195)]=router;