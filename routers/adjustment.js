function a0_0x30fb(){var _0x550aab=['filter','then','secondary_unit','rack','toString','/preview/:id','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.bay','save','New_Qty_Converted','\x20Order\x20Date\x20:\x20','Adjustment\x20Mail','Floor','$product_details.bin','Router','830400McEwUZ','Shelves','warehouse','$product_details.floorlevel','edit_adjustment','product_code','German','room_names','product_stock','aggregate','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Arabic','minus','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Email\x20sent\x20successfully','bin','$product_details.storage','nodemailer','$product_details.invoice','batch_code','/adjustment/view','prod_name','_id','$product_details._id','$isAllowEdit','$date','all','\x20Order\x20Number\x20:\x20','$product_details.secondary_unit','95695EKRBAt','42jbjWpu','French','errors','bay','prod_invoice','Spanish','adjustment\x20add\x20successfull','Return\x20Goods','log','Portuguese','$product_details.expiry_date','5668240iZEzYc','stock','$product_details.secondary_code','Level','id_transaction_from','../public/language/languages.json','$product_details.product_cat','Error\x20Occurs','$_id','</span>','$product_details.production_date','$product.room_names','$product.product_name','new_adjust_qty','unit','adjustment','<tr>','prod_cat','params','user','\x20</h2>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','render','isAllowEdit','adjust_qty','$product_details.primary_code','floor','$product_details.level','Rooms','back','note','findById','map','type','<html><head><title></title>','padStart','product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','language','$invoice','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','message','adjustment\x20Finalized\x20successfully','<strong>\x20Regards\x20</strong>','expiry_date','status','find','Arabic\x20(ae)','$product_details.maxPerUnit','random','</tr>','host','email','warehouse_name','English','redirect','66090GpNbIg','types','$product_details.pallet','English\x20(US)','Enabled','slice','master','<span\x20style=\x22float:\x20right;\x22>','Raw\x20Materials','second1','push','site_title','</div>','product_details','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/adjustment/preview/','$room','length','error','Chinese','body','14145860EnXTtF','Ambient','$product','catch','New_Qty_Converted_adj','prime1','prod_code','</body></html>','split','211631Czpaod','logo','secondary_code','product_name','Logo.png','/view','30KYUXvY','$product_details','id_transaction','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.product_stock','findOne','/view/:id','room','stockBefore','<h5>','</thead>','/picking_list/PDF_adjustment_rm/','<h2>\x20','sendMail','$product_details.batch_code','success','/../public','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$name','$product_details.isle','<tbody\x20style=\x22text-align:\x20center;\x22>','Hindi','<div>','add_adjustment','json','11GITrjX','Receiving\x20Area','/CheckingWarehouse','</td>','/upload/','production_date','flash','exports','9kkkPsq','staff','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','forEach','$product_details.product_name','primary_code','role','max_per_unit','invoice','floorlevel','Portuguese\x20(BR)','post','foreach\x20newproduct','storage','Primary_Units','True','$product_details.product_code','date','string','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.unit','$product_details.rack','Return\x20Rooms','/barcode_scanner','804279SAVPFb','get','Secondary_units','edit_adjustment_view','RMSEmail','ADJ-','password','level','createTransport'];a0_0x30fb=function(){return _0x550aab;};return a0_0x30fb();}var a0_0x5daec5=a0_0x1159;(function(_0x1205f6,_0xdf1d0a){var _0x27d984=a0_0x1159,_0x374831=_0x1205f6();while(!![]){try{var _0x190039=parseInt(_0x27d984(0x1c9))/0x1+-parseInt(_0x27d984(0x1aa))/0x2*(parseInt(_0x27d984(0x1cf))/0x3)+-parseInt(_0x27d984(0x221))/0x4+-parseInt(_0x27d984(0x23e))/0x5*(parseInt(_0x27d984(0x23f))/0x6)+parseInt(_0x27d984(0x209))/0x7+parseInt(_0x27d984(0x24a))/0x8*(-parseInt(_0x27d984(0x1f1))/0x9)+parseInt(_0x27d984(0x1c0))/0xa*(parseInt(_0x27d984(0x1e9))/0xb);if(_0x190039===_0xdf1d0a)break;else _0x374831['push'](_0x374831['shift']());}catch(_0x15d77a){_0x374831['push'](_0x374831['shift']());}}}(a0_0x30fb,0x58071));const express=require('express'),app=express(),router=express[a0_0x5daec5(0x220)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0x5daec5(0x24f)),nodemailer=require(a0_0x5daec5(0x232));function a0_0x1159(_0x321df3,_0x2be291){var _0x30fb66=a0_0x30fb();return a0_0x1159=function(_0x1159c0,_0x31a8ec){_0x1159c0=_0x1159c0-0x1a9;var _0x49f69b=_0x30fb66[_0x1159c0];return _0x49f69b;},a0_0x1159(_0x321df3,_0x2be291);}router[a0_0x5daec5(0x20a)](a0_0x5daec5(0x1ce),auth,async(_0x4cc3ac,_0x502a41)=>{var _0x317004=a0_0x5daec5;try{const {username:_0x5df499,email:_0x49f53c,role:_0x400715}=_0x4cc3ac['user'],_0x37f7f5=_0x4cc3ac[_0x317004(0x25d)],_0x244e38=await profile['findOne']({'email':_0x37f7f5[_0x317004(0x27e)]}),_0x44d74b=await master_shop[_0x317004(0x278)]();console[_0x317004(0x247)](_0x317004(0x1b0),_0x44d74b);let _0x51f70e;if(_0x37f7f5['role']==_0x317004(0x1f2)){const _0x515b4b=await staff['findOne']({'email':_0x37f7f5['email']});_0x51f70e=await warehouse[_0x317004(0x278)]({'status':_0x317004(0x1ae),'name':_0x515b4b[_0x317004(0x223)]});}else _0x51f70e=await warehouse[_0x317004(0x278)]({'status':_0x317004(0x1ae)});const _0x394902=await product[_0x317004(0x278)]();let _0x788bb1;if(_0x37f7f5[_0x317004(0x1f7)]==_0x317004(0x1f2)){const _0x481a23=await staff[_0x317004(0x1d4)]({'email':_0x37f7f5[_0x317004(0x27e)]});_0x788bb1=await adjustment[_0x317004(0x278)]({'warehouse_name':_0x481a23[_0x317004(0x223)]});}else _0x788bb1=await adjustment[_0x317004(0x22a)]([{'$unwind':_0x317004(0x1c2)},{'$group':{'_id':_0x317004(0x252),'invoice':{'$first':_0x317004(0x271)},'date':{'$first':_0x317004(0x23a)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x317004(0x255)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x317004(0x239)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x44d74b[0x0][_0x317004(0x270)]==_0x317004(0x1ad)){var _0x2cf4cc=users[_0x317004(0x280)];console['log'](_0x2cf4cc);}else{if(_0x44d74b[0x0][_0x317004(0x270)]==_0x317004(0x1e5))var _0x2cf4cc=users[_0x317004(0x1e5)];else{if(_0x44d74b[0x0][_0x317004(0x270)]==_0x317004(0x227))var _0x2cf4cc=users['German'];else{if(_0x44d74b[0x0]['language']==_0x317004(0x244))var _0x2cf4cc=users[_0x317004(0x244)];else{if(_0x44d74b[0x0]['language']==_0x317004(0x240))var _0x2cf4cc=users[_0x317004(0x240)];else{if(_0x44d74b[0x0][_0x317004(0x270)]==_0x317004(0x1fb))var _0x2cf4cc=users[_0x317004(0x248)];else{if(_0x44d74b[0x0]['language']==_0x317004(0x1be))var _0x2cf4cc=users['Chinese'];else{if(_0x44d74b[0x0][_0x317004(0x270)]==_0x317004(0x279))var _0x2cf4cc=users[_0x317004(0x22c)];}}}}}}}_0x502a41[_0x317004(0x260)](_0x317004(0x259),{'success':_0x4cc3ac[_0x317004(0x1ef)]('success'),'errors':_0x4cc3ac[_0x317004(0x1ef)](_0x317004(0x241)),'role':_0x37f7f5,'profile':_0x244e38,'warehouse':_0x51f70e,'product':_0x394902,'adjustment':_0x788bb1,'master_shop':_0x44d74b,'language':_0x2cf4cc});}catch(_0x1f9fd1){console[_0x317004(0x247)](_0x1f9fd1);}});async function getRandom8DigitNumber(){var _0x48f39c=a0_0x5daec5;const _0x595fe6=0x989680,_0x4c8e3d=0x5f5e0ff,_0x3d0ea6=Math[_0x48f39c(0x264)](Math[_0x48f39c(0x27b)]()*(_0x4c8e3d-_0x595fe6+0x1))+_0x595fe6;var _0x2a2bc4;const _0x5a3a6f=await adjustment[_0x48f39c(0x1d4)]({'invoice':'ADJ-'+_0x3d0ea6});return _0x5a3a6f&&_0x5a3a6f['length']>0x0?_0x2a2bc4='ADJ-'+_0x3d0ea6:_0x2a2bc4=_0x48f39c(0x20e)+_0x3d0ea6,_0x2a2bc4;}router[a0_0x5daec5(0x20a)]('/view/add_adjustment',auth,async(_0x18a38c,_0xff1125)=>{var _0x63b9a4=a0_0x5daec5;try{const {username:_0x5788ae,email:_0x52f8f5,role:_0x199653}=_0x18a38c[_0x63b9a4(0x25d)],_0x4a0076=_0x18a38c['user'],_0x22e5e9=await profile[_0x63b9a4(0x1d4)]({'email':_0x4a0076[_0x63b9a4(0x27e)]}),_0x36bbd2=await master_shop[_0x63b9a4(0x278)]();let _0x294b4a;if(_0x4a0076[_0x63b9a4(0x1f7)]==_0x63b9a4(0x1f2)){const _0x206f49=await staff[_0x63b9a4(0x1d4)]({'email':_0x4a0076[_0x63b9a4(0x27e)]});_0x294b4a=await warehouse['aggregate']([{'$match':{'status':_0x63b9a4(0x1ae),'name':_0x206f49[_0x63b9a4(0x223)],'warehouse_category':_0x63b9a4(0x1b2),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x63b9a4(0x1e2),'name':{'$first':_0x63b9a4(0x1e2)}}}]);}else _0x294b4a=await warehouse[_0x63b9a4(0x22a)]([{'$match':{'status':_0x63b9a4(0x1ae),'warehouse_category':_0x63b9a4(0x1b2),'name':{'$ne':_0x63b9a4(0x246)}}},{'$group':{'_id':_0x63b9a4(0x1e2),'name':{'$first':_0x63b9a4(0x1e2)}}}]);const _0x53d8e3=await product[_0x63b9a4(0x278)]({}),_0x475db7=await adjustment[_0x63b9a4(0x278)]({}),_0x165530=_0x475db7[_0x63b9a4(0x1bc)]+0x1,_0x254e17=_0x63b9a4(0x20e)+_0x165530[_0x63b9a4(0x216)]()[_0x63b9a4(0x26d)](0x5,'0');var _0x1ce065=[_0x63b9a4(0x1c1),'Enclosed',_0x63b9a4(0x207)];if(_0x36bbd2[0x0][_0x63b9a4(0x270)]==_0x63b9a4(0x1ad))var _0x5573a0=users['English'];else{if(_0x36bbd2[0x0][_0x63b9a4(0x270)]==_0x63b9a4(0x1e5))var _0x5573a0=users[_0x63b9a4(0x1e5)];else{if(_0x36bbd2[0x0][_0x63b9a4(0x270)]==_0x63b9a4(0x227))var _0x5573a0=users[_0x63b9a4(0x227)];else{if(_0x36bbd2[0x0][_0x63b9a4(0x270)]==_0x63b9a4(0x244))var _0x5573a0=users[_0x63b9a4(0x244)];else{if(_0x36bbd2[0x0][_0x63b9a4(0x270)]==_0x63b9a4(0x240))var _0x5573a0=users[_0x63b9a4(0x240)];else{if(_0x36bbd2[0x0][_0x63b9a4(0x270)]==_0x63b9a4(0x1fb))var _0x5573a0=users[_0x63b9a4(0x248)];else{if(_0x36bbd2[0x0][_0x63b9a4(0x270)]==_0x63b9a4(0x1be))var _0x5573a0=users[_0x63b9a4(0x1be)];else{if(_0x36bbd2[0x0][_0x63b9a4(0x270)]==_0x63b9a4(0x279))var _0x5573a0=users[_0x63b9a4(0x22c)];}}}}}}}const _0x4dc41d=getRandom8DigitNumber();_0x4dc41d[_0x63b9a4(0x213)](_0x14b923=>{var _0x2a5f2a=_0x63b9a4;_0xff1125['render'](_0x2a5f2a(0x1e7),{'success':_0x18a38c[_0x2a5f2a(0x1ef)](_0x2a5f2a(0x1de)),'errors':_0x18a38c[_0x2a5f2a(0x1ef)](_0x2a5f2a(0x241)),'role':_0x4a0076,'profile':_0x22e5e9,'warehouse':_0x294b4a,'product':_0x53d8e3,'master_shop':_0x36bbd2,'language':_0x5573a0,'rooms_data':_0x1ce065,'invoice_no':_0x14b923});})[_0x63b9a4(0x1c3)](_0x2ea1ad=>{var _0x548412=_0x63b9a4;_0x18a38c[_0x548412(0x1ef)](_0x548412(0x241),_0x548412(0x1e1)),_0xff1125['redirect'](_0x548412(0x235));});}catch(_0x1acdcd){console[_0x63b9a4(0x247)](_0x1acdcd);}}),router[a0_0x5daec5(0x1fc)]('/view/add_adjustment',auth,async(_0x433f71,_0x5a32e0)=>{var _0x21c5c2=a0_0x5daec5;try{const {warehouse_name:_0x4108a2,date:_0x480ed7,prod_name:_0x3ca992,level:_0x3ba92a,isle:_0x148a08,pallet:_0x1bcb4a,stock:_0xca44bf,types:_0x551591,adjust_qty:_0x477b0a,new_adjust_qty:_0x11229d,note:_0xc47e4f,Room_name:_0x417da4,invoice:_0x231112,JO_number:_0x1db71e,expiry_date:_0x568383}=_0x433f71[_0x21c5c2(0x1bf)];if(typeof _0x3ca992==_0x21c5c2(0x203))var _0x45fbfe=[_0x433f71['body'][_0x21c5c2(0x236)]],_0xa105a9=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x210)]],_0x33477b=[_0x433f71[_0x21c5c2(0x1bf)]['stock']],_0x5329e7=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1ab)]],_0x4faa22=[_0x433f71['body'][_0x21c5c2(0x1c4)]],_0x2e9497=[_0x433f71[_0x21c5c2(0x1bf)]['New_Qty_Converted']],_0x8c0128=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1ff)]],_0x55cba4=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x20b)]],_0x4486d0=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1c6)]],_0x18b78e=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x234)]],_0x595c13=[_0x433f71['body'][_0x21c5c2(0x276)]],_0x57d9c7=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1f8)]],_0x3737cc=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1ee)]],_0x241f53=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x25b)]],_0x4754ba=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x266)]],_0x13cb12=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1c5)]],_0x48e8b3=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1b3)]],_0x5381dc=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x243)]],_0x4af787=[_0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1d1)]];else var _0x45fbfe=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x236)]],_0xa105a9=[..._0x433f71['body'][_0x21c5c2(0x210)]],_0x33477b=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x24b)]],_0x5329e7=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1ab)]],_0x4faa22=[..._0x433f71['body'][_0x21c5c2(0x1c4)]],_0x2e9497=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x21b)]],_0x8c0128=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x258)]],_0x55cba4=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x20b)]],_0x4486d0=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1c6)]],_0x18b78e=[..._0x433f71[_0x21c5c2(0x1bf)]['batch_code']],_0x595c13=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x276)]],_0x57d9c7=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1f8)]],_0x3737cc=[..._0x433f71[_0x21c5c2(0x1bf)]['production_date']],_0x241f53=[..._0x433f71[_0x21c5c2(0x1bf)]['prod_cat']],_0x4754ba=[..._0x433f71['body']['Rooms']],_0x13cb12=[..._0x433f71[_0x21c5c2(0x1bf)]['prime1']],_0x48e8b3=[..._0x433f71['body'][_0x21c5c2(0x1b3)]],_0x5381dc=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x243)]],_0x4af787=[..._0x433f71[_0x21c5c2(0x1bf)][_0x21c5c2(0x1d1)]];const _0x5a4231=_0x45fbfe['map'](_0x4149de=>{return _0x4149de={'product_name':_0x4149de};});_0xa105a9[_0x21c5c2(0x1f4)]((_0x2dc903,_0xbd6a03)=>{var _0x3e4f13=_0x21c5c2;_0x4754ba[_0x3e4f13(0x1f4)]((_0x47dc1c,_0xad4c9c)=>{var _0x3007d8=_0x3e4f13;if(_0x47dc1c=='Receiving\x20Area'&&_0xbd6a03==_0xad4c9c){var _0x433530=_0x2dc903['slice'](0x3);_0x5a4231[_0xbd6a03][_0x3007d8(0x1fe)]=_0x2dc903[0x0],_0x5a4231[_0xbd6a03]['rack']=_0x2dc903[0x1],_0x5a4231[_0xbd6a03][_0x3007d8(0x242)]=0x0,_0x5a4231[_0xbd6a03][_0x3007d8(0x230)]=0x0,_0x5a4231[_0xbd6a03][_0x3007d8(0x26b)]=_0x3007d8(0x21e),_0x5a4231[_0xbd6a03][_0x3007d8(0x1fa)]=_0x433530;}else{if(_0x47dc1c=='Shelves'&&_0xbd6a03==_0xad4c9c){var _0x433530=_0x2dc903[_0x3007d8(0x1af)](0x3);_0x5a4231[_0xbd6a03][_0x3007d8(0x1fe)]=_0x2dc903[0x0],_0x5a4231[_0xbd6a03][_0x3007d8(0x215)]=_0x2dc903[0x1],_0x5a4231[_0xbd6a03]['bay']=0x0,_0x5a4231[_0xbd6a03][_0x3007d8(0x230)]=0x0,_0x5a4231[_0xbd6a03][_0x3007d8(0x26b)]=_0x3007d8(0x21e),_0x5a4231[_0xbd6a03]['floorlevel']=_0x2dc903[0x5];}else{if(_0xbd6a03==_0xad4c9c){var _0x32aedb;if(_0x2dc903[0x4]=='L')_0x32aedb='Level';else _0x2dc903[0x4]=='F'&&(_0x32aedb=_0x3007d8(0x21e));_0x5a4231[_0xbd6a03][_0x3007d8(0x1fe)]=_0x2dc903[0x0],_0x5a4231[_0xbd6a03][_0x3007d8(0x215)]=_0x2dc903[0x1],_0x5a4231[_0xbd6a03][_0x3007d8(0x242)]=_0x2dc903[0x2],_0x5a4231[_0xbd6a03][_0x3007d8(0x230)]=_0x2dc903[0x3],_0x5a4231[_0xbd6a03][_0x3007d8(0x26b)]=_0x32aedb,_0x5a4231[_0xbd6a03][_0x3007d8(0x1fa)]=_0x2dc903[0x5];}}}});}),_0x33477b[_0x21c5c2(0x1f4)]((_0x20eb70,_0x139c17)=>{var _0x51479e=_0x21c5c2;_0x5a4231[_0x139c17][_0x51479e(0x1d7)]=_0x20eb70;}),_0x4af787[_0x21c5c2(0x1f4)]((_0x3c0959,_0x434fd9)=>{var _0x213369=_0x21c5c2;_0x5a4231[_0x434fd9][_0x213369(0x24e)]=_0x3c0959;}),_0x5329e7[_0x21c5c2(0x1f4)]((_0x11cb8d,_0x13b59b)=>{_0x5a4231[_0x13b59b]['types']=_0x11cb8d;}),_0x4faa22[_0x21c5c2(0x1f4)]((_0x484851,_0x9ea7a5)=>{_0x5a4231[_0x9ea7a5]['adjust_qty']=_0x484851;}),_0x2e9497[_0x21c5c2(0x1f4)]((_0x20d87a,_0x2f6425)=>{var _0x31be5e=_0x21c5c2;_0x5a4231[_0x2f6425][_0x31be5e(0x257)]=_0x20d87a;}),_0x8c0128[_0x21c5c2(0x1f4)]((_0x500d2d,_0x16fced)=>{_0x5a4231[_0x16fced]['unit']=_0x500d2d;}),_0x55cba4[_0x21c5c2(0x1f4)]((_0x3fce37,_0x4a8a51)=>{_0x5a4231[_0x4a8a51]['secondary_unit']=_0x3fce37;}),_0x4486d0[_0x21c5c2(0x1f4)]((_0x535890,_0x4c2de4)=>{var _0x5c86d6=_0x21c5c2;_0x5a4231[_0x4c2de4][_0x5c86d6(0x226)]=_0x535890;}),_0x18b78e[_0x21c5c2(0x1f4)]((_0x2265d4,_0x511de9)=>{var _0xfc4641=_0x21c5c2;_0x5a4231[_0x511de9][_0xfc4641(0x234)]=_0x2265d4;}),_0x595c13[_0x21c5c2(0x1f4)]((_0x32cd13,_0x3a9a71)=>{var _0x2f59d1=_0x21c5c2;_0x5a4231[_0x3a9a71][_0x2f59d1(0x276)]=_0x32cd13;}),_0x57d9c7[_0x21c5c2(0x1f4)]((_0x28b807,_0x233d3f)=>{_0x5a4231[_0x233d3f]['maxperunit']=_0x28b807;}),_0x3737cc[_0x21c5c2(0x1f4)]((_0x2d38e2,_0x160f5a)=>{var _0x41ec10=_0x21c5c2;_0x5a4231[_0x160f5a][_0x41ec10(0x1ee)]=_0x2d38e2;}),_0x241f53['forEach']((_0x1e2b3d,_0x34c1a2)=>{var _0x36403f=_0x21c5c2;_0x5a4231[_0x34c1a2][_0x36403f(0x25b)]=_0x1e2b3d;}),_0x4754ba[_0x21c5c2(0x1f4)]((_0x5d4f55,_0x3ddfdc)=>{var _0x29dffa=_0x21c5c2;_0x5a4231[_0x3ddfdc][_0x29dffa(0x228)]=_0x5d4f55;}),_0x13cb12['forEach']((_0x20a217,_0x36b368)=>{var _0x3ba4c4=_0x21c5c2;_0x5a4231[_0x36b368][_0x3ba4c4(0x1f6)]=_0x20a217;}),_0x48e8b3[_0x21c5c2(0x1f4)]((_0x271b71,_0x33ff9e)=>{var _0x1cbda5=_0x21c5c2;_0x5a4231[_0x33ff9e][_0x1cbda5(0x1cb)]=_0x271b71;}),_0x5381dc['forEach']((_0x2f5256,_0x2194ac)=>{var _0x3bde2a=_0x21c5c2;_0x5a4231[_0x2194ac][_0x3bde2a(0x1f9)]=_0x2f5256;});const _0x533f65=_0x5a4231[_0x21c5c2(0x212)](_0x2feec8=>_0x2feec8[_0x21c5c2(0x262)]!=='0'&&_0x2feec8[_0x21c5c2(0x262)]!=='');var _0x1093e1=0x0;_0x533f65[_0x21c5c2(0x1f4)](_0x4c2a1f=>{var _0x24c565=_0x21c5c2;console[_0x24c565(0x247)]('foreach\x20newproduct',_0x4c2a1f),parseInt(_0x4c2a1f[_0x24c565(0x262)])<=0x0&&_0x1093e1++;});if(_0x1093e1!=0x0)return _0x433f71['flash']('errors',_0x21c5c2(0x218)),_0x5a32e0['redirect']('back');const _0x43d599=new adjustment({'warehouse_name':_0x4108a2,'date':_0x480ed7,'product':_0x533f65,'note':_0xc47e4f,'room':_0x417da4,'invoice':_0x231112,'JO_number':_0x1db71e,'expiry_date':_0x568383}),_0x7bf0e6=await _0x43d599[_0x21c5c2(0x21a)]();_0x433f71[_0x21c5c2(0x1ef)]('success',_0x21c5c2(0x245)),_0x5a32e0[_0x21c5c2(0x1a9)](_0x21c5c2(0x1ba)+_0x7bf0e6['_id']);}catch(_0x354cb5){console[_0x21c5c2(0x247)](_0x354cb5),_0x5a32e0['status'](0xc8)['json']({'message':_0x354cb5['message']});}}),router[a0_0x5daec5(0x20a)](a0_0x5daec5(0x217),auth,async(_0x527dc3,_0x3eeca8)=>{var _0x4faf9d=a0_0x5daec5;try{const {username:_0x4e2dde,email:_0x5b9c8a,role:_0x4ca7f4}=_0x527dc3[_0x4faf9d(0x25d)],_0x1687dc=_0x527dc3[_0x4faf9d(0x25d)],_0xa01526=await profile[_0x4faf9d(0x1d4)]({'email':_0x1687dc['email']}),_0xa3e7e2=await master_shop[_0x4faf9d(0x278)](),_0x560ee2=_0x527dc3['params']['id'],_0x160838=await adjustment[_0x4faf9d(0x269)]({'_id':_0x560ee2}),_0x47aeae=await purchases['aggregate']([{'$match':{'warehouse_name':_0x160838[_0x4faf9d(0x27f)]}},{'$unwind':_0x4faf9d(0x1c2)},{'$group':{'_id':_0x4faf9d(0x256)}}]),_0x3d3208=await product['find']({}),_0x580739=await warehouse['aggregate']([{'$match':{'name':_0x160838['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4faf9d(0x238),'name':{'$first':_0x4faf9d(0x1f5)},'product_stock':{'$first':_0x4faf9d(0x1d3)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4faf9d(0x263)},'secondary_code':{'$first':_0x4faf9d(0x24c)},'product_code':{'$first':_0x4faf9d(0x201)},'storage':{'$first':_0x4faf9d(0x231)},'rack':{'$first':_0x4faf9d(0x206)},'maxPerUnit':{'$first':_0x4faf9d(0x27a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4faf9d(0x1dd)},'room':{'$first':_0x4faf9d(0x1bb)}}}]);if(_0xa3e7e2[0x0][_0x4faf9d(0x270)]==_0x4faf9d(0x1ad)){var _0x881cb=users[_0x4faf9d(0x280)];console[_0x4faf9d(0x247)](_0x881cb);}else{if(_0xa3e7e2[0x0][_0x4faf9d(0x270)]==_0x4faf9d(0x1e5))var _0x881cb=users[_0x4faf9d(0x1e5)];else{if(_0xa3e7e2[0x0]['language']=='German')var _0x881cb=users['German'];else{if(_0xa3e7e2[0x0][_0x4faf9d(0x270)]==_0x4faf9d(0x244))var _0x881cb=users['Spanish'];else{if(_0xa3e7e2[0x0]['language']==_0x4faf9d(0x240))var _0x881cb=users['French'];else{if(_0xa3e7e2[0x0][_0x4faf9d(0x270)]==_0x4faf9d(0x1fb))var _0x881cb=users['Portuguese'];else{if(_0xa3e7e2[0x0][_0x4faf9d(0x270)]=='Chinese')var _0x881cb=users[_0x4faf9d(0x1be)];else{if(_0xa3e7e2[0x0][_0x4faf9d(0x270)]=='Arabic\x20(ae)')var _0x881cb=users[_0x4faf9d(0x22c)];}}}}}}}_0x3eeca8[_0x4faf9d(0x260)](_0x4faf9d(0x20c),{'success':_0x527dc3['flash']('success'),'errors':_0x527dc3[_0x4faf9d(0x1ef)](_0x4faf9d(0x241)),'role':_0x1687dc,'profile':_0xa01526,'adjustment':_0x160838,'stock':_0x580739,'master_shop':_0xa3e7e2,'warehouse_name':_0x47aeae,'unit':_0x3d3208,'language':_0x881cb});}catch(_0x43cbd5){console['log'](_0x43cbd5),_0x3eeca8[_0x4faf9d(0x277)](0xc8)[_0x4faf9d(0x1e8)]({'message':_0x43cbd5[_0x4faf9d(0x273)]});}}),router[a0_0x5daec5(0x1fc)](a0_0x5daec5(0x217),auth,async(_0x4da105,_0x284848)=>{var _0x7e41e4=a0_0x5daec5;try{const _0x30a87a=_0x4da105[_0x7e41e4(0x25c)]['id'],{warehouse_name:_0x653f08,Room_name:_0x4c95a2}=_0x4da105[_0x7e41e4(0x1bf)],_0x55cfa0=await adjustment['findById']({'_id':_0x30a87a}),_0x1d1a34=_0x55cfa0[_0x7e41e4(0x26e)][_0x7e41e4(0x26a)](async _0x5a4a24=>{var _0x3b73fd=_0x7e41e4;if(_0x5a4a24['adjust_qty']>0x0){var _0x6c358a=await warehouse[_0x3b73fd(0x1d4)]({'name':_0x653f08,'room':_0x5a4a24[_0x3b73fd(0x228)],'warehouse_category':_0x3b73fd(0x1b2)});const _0x369feb=_0x6c358a[_0x3b73fd(0x1b7)]['map'](_0x10392a=>{var _0x3f16ae=_0x3b73fd;console[_0x3f16ae(0x247)](_0x5a4a24[_0x3f16ae(0x1ab)]+'\x20<>\x20');if(_0x5a4a24[_0x3f16ae(0x1ab)]==_0x3f16ae(0x22d)){if(_0x10392a[_0x3f16ae(0x1cc)]==_0x5a4a24[_0x3f16ae(0x1cc)]&&_0x10392a['floorlevel']==_0x5a4a24['floorlevel']&&_0x10392a[_0x3f16ae(0x26b)]==_0x5a4a24['type']&&_0x10392a[_0x3f16ae(0x230)]==_0x5a4a24[_0x3f16ae(0x230)]&&_0x10392a[_0x3f16ae(0x242)]==_0x5a4a24[_0x3f16ae(0x242)]&&_0x10392a[_0x3f16ae(0x215)]==_0x5a4a24[_0x3f16ae(0x215)]&&_0x10392a[_0x3f16ae(0x1fe)]==_0x5a4a24[_0x3f16ae(0x1fe)]&&_0x10392a[_0x3f16ae(0x276)]==_0x5a4a24[_0x3f16ae(0x276)]&&_0x10392a[_0x3f16ae(0x234)]==_0x5a4a24[_0x3f16ae(0x234)]&&_0x10392a['production_date']==_0x5a4a24[_0x3f16ae(0x1ee)]&&_0x10392a[_0x3f16ae(0x1f9)]==_0x5a4a24[_0x3f16ae(0x1f9)]&&_0x10392a[_0x3f16ae(0x237)]==_0x5a4a24[_0x3f16ae(0x24e)]){var _0x4d4b25;_0x4d4b25=_0x5a4a24[_0x3f16ae(0x262)],_0x5a4a24[_0x3f16ae(0x25b)]=='S'&&(_0x4d4b25=_0x5a4a24[_0x3f16ae(0x262)]),_0x10392a[_0x3f16ae(0x229)]=_0x10392a['product_stock']-_0x4d4b25;}}else{if(_0x10392a[_0x3f16ae(0x1cc)]==_0x5a4a24['product_name']&&_0x10392a[_0x3f16ae(0x1fa)]==_0x5a4a24[_0x3f16ae(0x1fa)]&&_0x10392a[_0x3f16ae(0x26b)]==_0x5a4a24['type']&&_0x10392a[_0x3f16ae(0x230)]==_0x5a4a24[_0x3f16ae(0x230)]&&_0x10392a[_0x3f16ae(0x242)]==_0x5a4a24['bay']&&_0x10392a['rack']==_0x5a4a24[_0x3f16ae(0x215)]&&_0x10392a[_0x3f16ae(0x1fe)]==_0x5a4a24[_0x3f16ae(0x1fe)]&&_0x10392a['expiry_date']==_0x5a4a24[_0x3f16ae(0x276)]&&_0x10392a[_0x3f16ae(0x234)]==_0x5a4a24[_0x3f16ae(0x234)]&&_0x10392a['production_date']==_0x5a4a24[_0x3f16ae(0x1ee)]&&_0x10392a['invoice']==_0x5a4a24[_0x3f16ae(0x1f9)]&&_0x10392a[_0x3f16ae(0x237)]==_0x5a4a24[_0x3f16ae(0x24e)]){console[_0x3f16ae(0x247)](_0x5a4a24);var _0x4d4b25;_0x4d4b25=_0x5a4a24[_0x3f16ae(0x262)],_0x5a4a24[_0x3f16ae(0x25b)]=='S'&&(_0x4d4b25=_0x5a4a24[_0x3f16ae(0x262)]),_0x10392a[_0x3f16ae(0x229)]=_0x10392a['product_stock']+_0x4d4b25;}}});}return _0x6c358a;});Promise['all'](_0x1d1a34)['then'](async _0x374c7c=>{var _0x5624f2=_0x7e41e4;try{for(const _0x390d0a of _0x374c7c){await _0x390d0a[_0x5624f2(0x21a)]();}_0x55cfa0['finalize']=_0x5624f2(0x200);const _0x12762c=await _0x55cfa0[_0x5624f2(0x21a)](),_0x13d467=await master_shop[_0x5624f2(0x278)](),_0x14f9c3=await email_settings[_0x5624f2(0x1d4)](),_0x5cb48c=await supervisor_settings['find']();var _0x284f2c=_0x55cfa0[_0x5624f2(0x26e)],_0x5ca8ca='',_0x4d6a4b;for(_0x4d6a4b in _0x284f2c){_0x5ca8ca+=_0x5624f2(0x25a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x284f2c[_0x4d6a4b][_0x5624f2(0x1cc)]+_0x5624f2(0x1ec)+_0x5624f2(0x25f)+_0x284f2c[_0x4d6a4b]['product_code']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x284f2c[_0x4d6a4b]['adjust_qty']+_0x5624f2(0x1ec)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x284f2c[_0x4d6a4b][_0x5624f2(0x258)]+_0x5624f2(0x1ec)+_0x5624f2(0x25f)+_0x284f2c[_0x4d6a4b][_0x5624f2(0x214)]+_0x5624f2(0x1ec)+_0x5624f2(0x25f)+_0x55cfa0['warehouse_name']+'</td>'+_0x5624f2(0x25f)+_0x284f2c[_0x4d6a4b][_0x5624f2(0x228)]+_0x5624f2(0x1ec)+_0x5624f2(0x25f)+_0x284f2c[_0x4d6a4b][_0x5624f2(0x1fe)]+_0x284f2c[_0x4d6a4b][_0x5624f2(0x215)]+_0x284f2c[_0x4d6a4b][_0x5624f2(0x242)]+_0x284f2c[_0x4d6a4b][_0x5624f2(0x230)]+_0x284f2c[_0x4d6a4b]['type'][0x0]+_0x284f2c[_0x4d6a4b][_0x5624f2(0x1fa)]+_0x5624f2(0x1ec),_0x5624f2(0x27c);}let _0x2c099a=nodemailer[_0x5624f2(0x211)]({'host':_0x14f9c3[_0x5624f2(0x27d)],'port':Number(_0x14f9c3['port']),'secure':![],'auth':{'user':_0x14f9c3['email'],'pass':_0x14f9c3[_0x5624f2(0x20f)]}}),_0xf99b4d={'from':_0x14f9c3[_0x5624f2(0x27e)],'to':_0x5cb48c[0x0][_0x5624f2(0x20d)],'subject':_0x5624f2(0x21d),'attachments':[{'filename':_0x5624f2(0x1cd),'path':__dirname+_0x5624f2(0x1df)+_0x5624f2(0x1ed)+_0x13d467[0x0]['image'],'cid':_0x5624f2(0x1ca)}],'html':'<!DOCTYPE\x20html>'+_0x5624f2(0x26c)+'</head><body>'+'<div>'+_0x5624f2(0x272)+'<div>'+_0x5624f2(0x1f3)+_0x5624f2(0x1b6)+_0x5624f2(0x1e6)+_0x5624f2(0x1db)+_0x13d467[0x0][_0x5624f2(0x1b5)]+_0x5624f2(0x25e)+_0x5624f2(0x1b6)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x5624f2(0x1e6)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x5624f2(0x23c)+_0x55cfa0[_0x5624f2(0x1f9)]+'\x20'+_0x5624f2(0x1b1)+_0x5624f2(0x21c)+_0x55cfa0[_0x5624f2(0x202)]+'\x20'+_0x5624f2(0x253)+'</h5>'+'</div>'+_0x5624f2(0x22b)+_0x5624f2(0x1d2)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x5624f2(0x22e)+_0x5624f2(0x26f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x5624f2(0x1b9)+_0x5624f2(0x204)+_0x5624f2(0x1e0)+_0x5624f2(0x27c)+_0x5624f2(0x1d9)+_0x5624f2(0x1e4)+'\x20'+_0x5ca8ca+'\x20'+'</tbody>'+'</table>'+_0x5624f2(0x1e6)+_0x5624f2(0x275)+_0x5624f2(0x1d8)+_0x13d467[0x0][_0x5624f2(0x1b5)]+'</h5>'+_0x5624f2(0x1b6)+_0x5624f2(0x1b6)+_0x5624f2(0x1c7)};_0x2c099a[_0x5624f2(0x1dc)](_0xf99b4d,function(_0xc1ce81,_0x31930e){var _0x57b106=_0x5624f2;_0xc1ce81?(console[_0x57b106(0x247)](_0xc1ce81),console[_0x57b106(0x247)](_0x57b106(0x251))):console[_0x57b106(0x247)](_0x57b106(0x22f));}),_0x4da105[_0x5624f2(0x1ef)](_0x5624f2(0x1de),_0x5624f2(0x274)),_0x284848['redirect'](_0x5624f2(0x1da)+_0x12762c[_0x5624f2(0x237)]);}catch(_0x14219f){console[_0x5624f2(0x1bd)](_0x14219f),_0x284848[_0x5624f2(0x277)](0x1f4)[_0x5624f2(0x1e8)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x7e41e4(0x1c3)](_0x53132a=>{var _0x4bdc06=_0x7e41e4;console[_0x4bdc06(0x1bd)](_0x53132a),_0x284848[_0x4bdc06(0x277)](0x1f4)[_0x4bdc06(0x1e8)]({'error':'An\x20error\x20occurred.'});});}catch(_0x468492){console[_0x7e41e4(0x247)](_0x468492),_0x284848[_0x7e41e4(0x277)](0xc8)[_0x7e41e4(0x1e8)]({'message':_0x468492[_0x7e41e4(0x273)]});}}),router[a0_0x5daec5(0x20a)]('/view/:id',auth,async(_0x576670,_0x439302)=>{var _0x350da6=a0_0x5daec5;try{const {username:_0x2cbf83,email:_0x471d0b,role:_0x5ab470}=_0x576670['user'],_0x8f3b59=_0x576670[_0x350da6(0x25d)],_0x138fd8=await profile[_0x350da6(0x1d4)]({'email':_0x8f3b59[_0x350da6(0x27e)]}),_0x4b681f=await master_shop[_0x350da6(0x278)](),_0x4283fa=_0x576670['params']['id'],_0xa61660=await adjustment[_0x350da6(0x269)]({'_id':_0x4283fa}),_0x27f7d7=await purchases[_0x350da6(0x22a)]([{'$match':{'warehouse_name':_0xa61660[_0x350da6(0x27f)]}},{'$unwind':_0x350da6(0x1c2)},{'$group':{'_id':_0x350da6(0x256)}}]),_0x57c151=await product[_0x350da6(0x278)]({}),_0x1f56cb=await warehouse[_0x350da6(0x22a)]([{'$match':{'name':_0xa61660[_0x350da6(0x27f)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x350da6(0x1d3)},'bay':{'$first':_0x350da6(0x219)},'bin':{'$first':_0x350da6(0x21f)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x350da6(0x224)},'primary_code':{'$first':_0x350da6(0x263)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x350da6(0x201)},'storage':{'$first':_0x350da6(0x231)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x350da6(0x27a)},'expiry_date':{'$first':_0x350da6(0x249)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x350da6(0x1dd)},'room':{'$first':'$room'}}}]);let _0x189c95;if(_0x8f3b59[_0x350da6(0x1f7)]==_0x350da6(0x1f2)){const _0x2a04c2=await staff[_0x350da6(0x1d4)]({'email':_0x8f3b59['email']});_0x189c95=await warehouse[_0x350da6(0x22a)]([{'$match':{'status':_0x350da6(0x1ae),'name':_0x2a04c2[_0x350da6(0x223)],'warehouse_category':_0x350da6(0x1b2),'name':{'$ne':_0x350da6(0x246)}}},{'$group':{'_id':_0x350da6(0x1e2),'name':{'$first':_0x350da6(0x1e2)}}}]);}else _0x189c95=await warehouse[_0x350da6(0x22a)]([{'$match':{'status':_0x350da6(0x1ae),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x350da6(0x246)}}},{'$group':{'_id':_0x350da6(0x1e2),'name':{'$first':_0x350da6(0x1e2)}}}]);if(_0x4b681f[0x0][_0x350da6(0x270)]==_0x350da6(0x1ad)){var _0x32d8d8=users[_0x350da6(0x280)];console[_0x350da6(0x247)](_0x32d8d8);}else{if(_0x4b681f[0x0][_0x350da6(0x270)]=='Hindi')var _0x32d8d8=users[_0x350da6(0x1e5)];else{if(_0x4b681f[0x0][_0x350da6(0x270)]=='German')var _0x32d8d8=users[_0x350da6(0x227)];else{if(_0x4b681f[0x0]['language']==_0x350da6(0x244))var _0x32d8d8=users[_0x350da6(0x244)];else{if(_0x4b681f[0x0]['language']==_0x350da6(0x240))var _0x32d8d8=users[_0x350da6(0x240)];else{if(_0x4b681f[0x0][_0x350da6(0x270)]==_0x350da6(0x1fb))var _0x32d8d8=users[_0x350da6(0x248)];else{if(_0x4b681f[0x0]['language']==_0x350da6(0x1be))var _0x32d8d8=users['Chinese'];else{if(_0x4b681f[0x0][_0x350da6(0x270)]=='Arabic\x20(ae)')var _0x32d8d8=users[_0x350da6(0x22c)];}}}}}}}_0x439302[_0x350da6(0x260)](_0x350da6(0x225),{'success':_0x576670[_0x350da6(0x1ef)](_0x350da6(0x1de)),'errors':_0x576670[_0x350da6(0x1ef)](_0x350da6(0x241)),'role':_0x8f3b59,'profile':_0x138fd8,'adjustment':_0xa61660,'stock':_0x1f56cb,'master_shop':_0x4b681f,'warehouse_name':_0x27f7d7,'unit':_0x57c151,'language':_0x32d8d8,'warehouse':_0x189c95});}catch(_0x5b8094){console[_0x350da6(0x247)](_0x5b8094),_0x439302[_0x350da6(0x277)](0xc8)[_0x350da6(0x1e8)]({'message':_0x5b8094[_0x350da6(0x273)]});}}),router[a0_0x5daec5(0x1fc)](a0_0x5daec5(0x1d5),auth,async(_0x4b6cb5,_0x3af8ff)=>{var _0xca879c=a0_0x5daec5;try{const _0x2a780c=_0x4b6cb5['params']['id'],_0x1328d=await adjustment[_0xca879c(0x269)]({'_id':_0x2a780c}),_0x2a458f=await warehouse[_0xca879c(0x1d4)]({'name':_0x1328d[_0xca879c(0x27f)],'room':_0x1328d[_0xca879c(0x1d6)]}),{warehouse_name:_0x3db83a,date:_0x438da6,prod_name:_0xfbc766,level:_0x2c675e,isle:_0x5c3857,pallet:_0x49fce2,stock:_0xbdbe32,types:_0x41bfd2,adjust_qty:_0x28d87b,new_adjust_qty:_0x318c73,note:_0x34c6fc,Room_name:_0x4adc0f,invoice:_0x573b2b,JO_number:_0x3922e7,expiry_date:_0x32c63b}=_0x4b6cb5[_0xca879c(0x1bf)];if(typeof _0xfbc766==_0xca879c(0x203))var _0x8c3a49=[_0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x236)]],_0x578688=[_0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x210)]],_0x3793d1=[_0x4b6cb5[_0xca879c(0x1bf)]['stock']],_0x4dc443=[_0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x1ab)]],_0x5c405c=[_0x4b6cb5['body'][_0xca879c(0x1c4)]],_0x3ffdaf=[_0x4b6cb5[_0xca879c(0x1bf)]['New_Qty_Converted']],_0x4e5a79=[_0x4b6cb5['body']['Primary_Units']],_0x17a14d=[_0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x20b)]],_0x64aa45=[_0x4b6cb5[_0xca879c(0x1bf)]['prod_code']],_0x2162d3=[_0x4b6cb5['body'][_0xca879c(0x234)]],_0x4909f3=[_0x4b6cb5['body'][_0xca879c(0x276)]],_0x13d1e8=[_0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x1f8)]],_0x3c9865=[_0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x1ee)]],_0x5b2f49=[_0x4b6cb5['body'][_0xca879c(0x25b)]],_0x245ebd=[_0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x266)]],_0x59f5df=[_0x4b6cb5[_0xca879c(0x1bf)]['prime1']],_0x3e8150=[_0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x1b3)]];else var _0x8c3a49=[..._0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x236)]],_0x578688=[..._0x4b6cb5['body'][_0xca879c(0x210)]],_0x3793d1=[..._0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x24b)]],_0x4dc443=[..._0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x1ab)]],_0x5c405c=[..._0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x1c4)]],_0x3ffdaf=[..._0x4b6cb5['body'][_0xca879c(0x21b)]],_0x4e5a79=[..._0x4b6cb5['body'][_0xca879c(0x258)]],_0x17a14d=[..._0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x20b)]],_0x64aa45=[..._0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x1c6)]],_0x2162d3=[..._0x4b6cb5[_0xca879c(0x1bf)]['batch_code']],_0x4909f3=[..._0x4b6cb5['body'][_0xca879c(0x276)]],_0x13d1e8=[..._0x4b6cb5['body'][_0xca879c(0x1f8)]],_0x3c9865=[..._0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x1ee)]],_0x5b2f49=[..._0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x25b)]],_0x245ebd=[..._0x4b6cb5[_0xca879c(0x1bf)]['Rooms']],_0x59f5df=[..._0x4b6cb5[_0xca879c(0x1bf)][_0xca879c(0x1c5)]],_0x3e8150=[..._0x4b6cb5['body'][_0xca879c(0x1b3)]];const _0x6c13bc=_0x8c3a49[_0xca879c(0x26a)](_0x96d349=>{return _0x96d349={'product_name':_0x96d349};});_0x578688[_0xca879c(0x1f4)]((_0x6f10d4,_0x2def7c)=>{var _0x4e0703=_0xca879c;_0x245ebd[_0x4e0703(0x1f4)]((_0x25c9b6,_0x42d2d2)=>{var _0x4beaea=_0x4e0703;if(_0x25c9b6==_0x4beaea(0x1ea)&&_0x2def7c==_0x42d2d2){var _0x41697f=_0x6f10d4[_0x4beaea(0x1af)](0x3);_0x6c13bc[_0x2def7c][_0x4beaea(0x1fe)]=_0x6f10d4[0x0],_0x6c13bc[_0x2def7c][_0x4beaea(0x215)]=_0x6f10d4[0x1],_0x6c13bc[_0x2def7c]['bay']=0x0,_0x6c13bc[_0x2def7c][_0x4beaea(0x230)]=0x0,_0x6c13bc[_0x2def7c]['type']=_0x4beaea(0x21e),_0x6c13bc[_0x2def7c]['floorlevel']=_0x41697f;}else{if(_0x25c9b6==_0x4beaea(0x222)&&_0x2def7c==_0x42d2d2){var _0x41697f=_0x6f10d4[_0x4beaea(0x1af)](0x3);_0x6c13bc[_0x2def7c][_0x4beaea(0x1fe)]=_0x6f10d4[0x0],_0x6c13bc[_0x2def7c][_0x4beaea(0x215)]=_0x6f10d4[0x1],_0x6c13bc[_0x2def7c][_0x4beaea(0x242)]=0x0,_0x6c13bc[_0x2def7c][_0x4beaea(0x230)]=0x0,_0x6c13bc[_0x2def7c][_0x4beaea(0x26b)]=_0x4beaea(0x21e),_0x6c13bc[_0x2def7c][_0x4beaea(0x1fa)]=_0x6f10d4[0x5];}else{if(_0x2def7c==_0x42d2d2){var _0x424db1;if(_0x6f10d4[0x4]=='L')_0x424db1=_0x4beaea(0x24d);else _0x6f10d4[0x4]=='F'&&(_0x424db1=_0x4beaea(0x21e));_0x6c13bc[_0x2def7c][_0x4beaea(0x1fe)]=_0x6f10d4[0x0],_0x6c13bc[_0x2def7c][_0x4beaea(0x215)]=_0x6f10d4[0x1],_0x6c13bc[_0x2def7c]['bay']=_0x6f10d4[0x2],_0x6c13bc[_0x2def7c]['bin']=_0x6f10d4[0x3],_0x6c13bc[_0x2def7c]['type']=_0x424db1,_0x6c13bc[_0x2def7c][_0x4beaea(0x1fa)]=_0x6f10d4[0x5];}}}});}),_0x3793d1[_0xca879c(0x1f4)]((_0x568d2c,_0x5313b5)=>{var _0x3f04ba=_0xca879c;_0x6c13bc[_0x5313b5][_0x3f04ba(0x1d7)]=_0x568d2c;}),_0x4dc443[_0xca879c(0x1f4)]((_0x4abef3,_0x1de4f9)=>{_0x6c13bc[_0x1de4f9]['types']=_0x4abef3;}),_0x5c405c[_0xca879c(0x1f4)]((_0x6de98b,_0x488076)=>{var _0x1d19dc=_0xca879c;_0x6c13bc[_0x488076][_0x1d19dc(0x262)]=_0x6de98b;}),_0x3ffdaf[_0xca879c(0x1f4)]((_0x574311,_0x5a1265)=>{var _0x114b20=_0xca879c;_0x6c13bc[_0x5a1265][_0x114b20(0x257)]=_0x574311;}),_0x4e5a79[_0xca879c(0x1f4)]((_0x35359d,_0x238153)=>{var _0x3e9732=_0xca879c;_0x6c13bc[_0x238153][_0x3e9732(0x258)]=_0x35359d;}),_0x17a14d['forEach']((_0x4b1a0a,_0x13f236)=>{_0x6c13bc[_0x13f236]['secondary_unit']=_0x4b1a0a;}),_0x64aa45[_0xca879c(0x1f4)]((_0x19193f,_0x15a3f5)=>{var _0x4b12af=_0xca879c;_0x6c13bc[_0x15a3f5][_0x4b12af(0x226)]=_0x19193f;}),_0x2162d3['forEach']((_0x2049fb,_0x81cef5)=>{var _0x40bacc=_0xca879c;_0x6c13bc[_0x81cef5][_0x40bacc(0x234)]=_0x2049fb;}),_0x4909f3['forEach']((_0x409579,_0x45eae4)=>{_0x6c13bc[_0x45eae4]['expiry_date']=_0x409579;}),_0x13d1e8[_0xca879c(0x1f4)]((_0x3b0358,_0x225f8e)=>{_0x6c13bc[_0x225f8e]['maxperunit']=_0x3b0358;}),_0x3c9865[_0xca879c(0x1f4)]((_0x4c19c9,_0x1fa8b6)=>{var _0x527242=_0xca879c;_0x6c13bc[_0x1fa8b6][_0x527242(0x1ee)]=_0x4c19c9;}),_0x5b2f49[_0xca879c(0x1f4)]((_0x5eea04,_0x2ca1c2)=>{var _0x5ec6fe=_0xca879c;_0x6c13bc[_0x2ca1c2][_0x5ec6fe(0x25b)]=_0x5eea04;}),_0x245ebd[_0xca879c(0x1f4)]((_0x831414,_0x3395d9)=>{_0x6c13bc[_0x3395d9]['room_names']=_0x831414;}),_0x59f5df['forEach']((_0x20967e,_0xb26d32)=>{var _0x4f8e91=_0xca879c;_0x6c13bc[_0xb26d32][_0x4f8e91(0x1f6)]=_0x20967e;}),_0x3e8150[_0xca879c(0x1f4)]((_0x19f075,_0x53f7bb)=>{var _0x1ae9b4=_0xca879c;_0x6c13bc[_0x53f7bb][_0x1ae9b4(0x1cb)]=_0x19f075;});const _0x2c43f8=_0x6c13bc[_0xca879c(0x212)](_0x115499=>_0x115499[_0xca879c(0x262)]!=='0'&&_0x115499[_0xca879c(0x262)]!=='');var _0x476575=0x0;_0x2c43f8[_0xca879c(0x1f4)](_0x5168a3=>{var _0x5cade4=_0xca879c;console[_0x5cade4(0x247)](_0x5cade4(0x1fd),_0x5168a3),parseInt(_0x5168a3['adjust_qty'])<=0x0&&_0x476575++;});if(_0x476575!=0x0)return _0x4b6cb5[_0xca879c(0x1ef)](_0xca879c(0x241),_0xca879c(0x218)),_0x3af8ff[_0xca879c(0x1a9)](_0xca879c(0x267));_0x1328d['warehouse_name']=_0x3db83a,_0x1328d['date']=_0x438da6,_0x1328d[_0xca879c(0x26e)]=_0x2c43f8,_0x1328d[_0xca879c(0x268)]=_0x34c6fc,_0x1328d[_0xca879c(0x1f9)]=_0x573b2b,_0x1328d[_0xca879c(0x261)]='False';const _0x53f056=await _0x1328d[_0xca879c(0x21a)]();_0x4b6cb5['flash'](_0xca879c(0x1de),'adjustment\x20data\x20update\x20successfully'),_0x3af8ff[_0xca879c(0x1a9)](_0xca879c(0x235));}catch(_0x379c6d){console['log'](_0x379c6d);}}),router[a0_0x5daec5(0x1fc)](a0_0x5daec5(0x208),async(_0x36465e,_0x383efb)=>{var _0x297dd1=a0_0x5daec5;const {primary_code:_0x3e37f5,warehouse_data:_0x5ecfdf,rooms_data:_0x480a1e,Roomslist:_0x4bb1e6}=_0x36465e[_0x297dd1(0x1bf)],_0x4fa3c0=_0x4bb1e6[_0x297dd1(0x1c8)](','),_0x1a65f3=[];async function _0x49db9a(_0x2f618f){var _0x529a88=_0x297dd1;const _0x16b91d=await warehouse['aggregate']([{'$match':{'name':_0x5ecfdf,'room':_0x2f618f}},{'$unwind':_0x529a88(0x1d0)},{'$match':{'product_details.primary_code':_0x3e37f5}},{'$group':{'_id':_0x529a88(0x238),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x529a88(0x263)},'secondary_code':{'$first':_0x529a88(0x24c)},'product_code':{'$first':_0x529a88(0x201)},'level':{'$first':_0x529a88(0x219)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x529a88(0x1b8)},'pallet':{'$first':_0x529a88(0x224)},'unit':{'$first':_0x529a88(0x205)},'secondary_unit':{'$first':_0x529a88(0x23d)},'storage':{'$first':_0x529a88(0x231)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x529a88(0x249)},'production_date':{'$first':_0x529a88(0x254)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x529a88(0x1dd)},'product_cat':{'$first':_0x529a88(0x250)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x529a88(0x1bb)},'invoice':{'$first':_0x529a88(0x233)}}}]),_0xd7b4e5=await warehouse['aggregate']([{'$match':{'name':_0x5ecfdf,'room':_0x2f618f}},{'$unwind':_0x529a88(0x1d0)},{'$match':{'product_details.secondary_code':_0x3e37f5}},{'$group':{'_id':_0x529a88(0x238),'name':{'$first':_0x529a88(0x1f5)},'product_stock':{'$first':_0x529a88(0x1d3)},'primary_code':{'$first':_0x529a88(0x263)},'secondary_code':{'$first':_0x529a88(0x24c)},'product_code':{'$first':_0x529a88(0x201)},'level':{'$first':_0x529a88(0x219)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x529a88(0x1b8)},'pallet':{'$first':_0x529a88(0x224)},'unit':{'$first':_0x529a88(0x205)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x529a88(0x231)},'rack':{'$first':_0x529a88(0x206)},'expiry_date':{'$first':_0x529a88(0x249)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x529a88(0x27a)},'batch_code':{'$first':_0x529a88(0x1dd)},'product_cat':{'$first':_0x529a88(0x250)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x529a88(0x1bb)}}}]);if(_0x16b91d[_0x529a88(0x1bc)]>0x0)_0x1a65f3[_0x529a88(0x1b4)](_0x16b91d);else _0xd7b4e5[_0x529a88(0x1bc)]>0x0&&_0x1a65f3[_0x529a88(0x1b4)](_0xd7b4e5);}const _0x3f2bd3=_0x4fa3c0[_0x297dd1(0x26a)](_0x1e7aec=>_0x49db9a(_0x1e7aec));await Promise[_0x297dd1(0x23b)](_0x3f2bd3),_0x383efb['json'](_0x1a65f3);}),router[a0_0x5daec5(0x1fc)](a0_0x5daec5(0x1eb),async(_0x25ad20,_0x2c0abf)=>{var _0x215634=a0_0x5daec5;const {primaryCode:_0x495382,secondaryCode:_0x3931d3,productCode:_0x1911f4,level:_0x50587e,isle:_0xda33c4,pallet:_0x13b750,warehouses:_0x2a33d8,room:_0x4994cc}=_0x25ad20[_0x215634(0x1bf)];try{const _0x67d09a=await warehouse[_0x215634(0x22a)]([{'$match':{'name':_0x2a33d8,'room':_0x4994cc}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x50587e),'product_details.isle':_0xda33c4,'product_details.pallet':parseInt(_0x13b750)}},{'$group':{'_id':_0x215634(0x238),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x215634(0x265)},'isle':{'$first':_0x215634(0x1e3)},'pallet':{'$first':_0x215634(0x1ac)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2c0abf[_0x215634(0x277)](0xc8)[_0x215634(0x1e8)](_0x67d09a);}catch(_0x5d435e){_0x2c0abf[_0x215634(0x277)](0x194)[_0x215634(0x1e8)]({'message':_0x5d435e['message']});}}),module[a0_0x5daec5(0x1f0)]=router;