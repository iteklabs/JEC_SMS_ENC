var a0_0xcb26e=a0_0xa4b7;function a0_0x4c78(){var _0x567243=['$product_details._id','_id','push','unit','172biFVqC','production_date','Email\x20sent\x20successfully','../public/language/languages.json','$product_details.invoice','$warehouse_name','product_details','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','adjustment\x20add\x20successfull','storage','minus','9853ThKzbB','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.production_date','back','$product_details.product_stock','</table>','findOne','stockBefore','$product_details.floorlevel','Enclosed','$invoice','Return\x20Goods','image','role','error','batch_code','stock','finalize','second1','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','then','adjustment','$product_details.bay','<tr>','Ambient','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','An\x20error\x20occurred.','product_name','</span>','ADJ-','$product_details.expiry_date','$product_details.maxProducts','floorlevel','slice','level','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','bay','Primary_Units','random','success','primary_code','/../public','product','../models/all_models','length','id_transaction','maxperunit','26131257BAbBNA','prod_invoice','types','German','$product_details.pallet','New_Qty_Converted_adj','edit_adjustment','</div>','errors','/CheckingWarehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','nodemailer','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.secondary_code','message','save','$product_details.batch_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<h5>','body','find','site_title','686586SkHggf','Portuguese\x20(BR)','max_per_unit','edit_adjustment_view','<h2>\x20','get','False','room_names','$product_details','Floor','/picking_list/PDF_adjustment_rm/','add_adjustment','Arabic\x20(ae)','Hindi','3782256FwqdBF','$product_details.secondary_unit','</thead>','user','Chinese','type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Portuguese','padStart','<h5\x20style=\x22text-align:\x20left;\x22>','room','Spanish','<table\x20style=\x22width:\x20100%\x20!important;\x22>','</tbody>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/adjustment/view','product_stock','product_code','An\x20error\x20occurred\x20while\x20saving\x20data.','Level','invoice','isAllowEdit','$product_details.product_code','adjust_qty','Rooms','email','Enabled','foreach\x20newproduct','map','English','date','expiry_date','/upload/','post','all','$date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product.product_name','split','staff','language','$finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.unit','rack','<strong>\x20Regards\x20</strong>','Raw\x20Materials','$product_details.product_name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','secondary_unit','\x20Order\x20Date\x20:\x20','Arabic','$product_details.level','forEach','</tr>','544604Gqxmoz','$room','$_id','adjustment\x20data\x20update\x20successfully','Receiving\x20Area','$isAllowEdit','$product_details.storage','render','toString','redirect','json','status','/preview/:id','7167580fTWWDr','/view/:id','filter','35XGqWNK','/view/add_adjustment','$name','$product_details.isle','new_adjust_qty','\x20</h2>','<div>','</body></html>','$product','$product_details.maxPerUnit','6027048jZVImh','$product_details.bin','warehouse_name','flash','$product.room_names','prime1','<hr\x20class=\x22my-3\x22>','English\x20(US)','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','French','prod_cat','</td>','Secondary_units','/barcode_scanner','aggregate','$product_details.product_cat','prod_name','</head><body>','secondary_code','findById','bin','id_transaction_from','prod_code','string','host','catch','log','\x20<>\x20','warehouse','Shelves','<span\x20style=\x22float:\x20right;\x22>','adjustment\x20Finalized\x20successfully','params','/view','$product_details.rack','New_Qty_Converted','exports','$product_details.primary_code','$product_details.type'];a0_0x4c78=function(){return _0x567243;};return a0_0x4c78();}(function(_0x2a2fc0,_0x2d4935){var _0x1bedbb=a0_0xa4b7,_0x4406d4=_0x2a2fc0();while(!![]){try{var _0x303301=-parseInt(_0x1bedbb(0x133))/0x1*(parseInt(_0x1bedbb(0x203))/0x2)+-parseInt(_0x1bedbb(0x186))/0x3+-parseInt(_0x1bedbb(0x1bd))/0x4+parseInt(_0x1bedbb(0x1ca))/0x5+-parseInt(_0x1bedbb(0x178))/0x6*(parseInt(_0x1bedbb(0x1cd))/0x7)+-parseInt(_0x1bedbb(0x1d7))/0x8+parseInt(_0x1bedbb(0x162))/0x9;if(_0x303301===_0x2d4935)break;else _0x4406d4['push'](_0x4406d4['shift']());}catch(_0x1f70ab){_0x4406d4['push'](_0x4406d4['shift']());}}}(a0_0x4c78,0xbb4d8));const express=require('express'),app=express(),router=express['Router'](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0xcb26e(0x15e)),users=require(a0_0xcb26e(0x206)),nodemailer=require(a0_0xcb26e(0x16d));router[a0_0xcb26e(0x17d)](a0_0xcb26e(0x1f9),auth,async(_0x25562e,_0x3517c1)=>{var _0x2a4e5d=a0_0xcb26e;try{const {username:_0x52df93,email:_0x1d2611,role:_0x1dcfb2}=_0x25562e[_0x2a4e5d(0x189)],_0xc4087=_0x25562e[_0x2a4e5d(0x189)],_0x2e693f=await profile['findOne']({'email':_0xc4087['email']}),_0x150007=await master_shop[_0x2a4e5d(0x176)]();console[_0x2a4e5d(0x1f2)]('master',_0x150007);let _0x4f7d9b;if(_0xc4087[_0x2a4e5d(0x140)]==_0x2a4e5d(0x1ad)){const _0x1b7068=await staff[_0x2a4e5d(0x139)]({'email':_0xc4087['email']});_0x4f7d9b=await warehouse[_0x2a4e5d(0x176)]({'status':_0x2a4e5d(0x1a0),'name':_0x1b7068[_0x2a4e5d(0x1f4)]});}else _0x4f7d9b=await warehouse[_0x2a4e5d(0x176)]({'status':'Enabled'});const _0x135877=await product['find']();let _0x3ec373;if(_0xc4087[_0x2a4e5d(0x140)]==_0x2a4e5d(0x1ad)){const _0x1206fe=await staff[_0x2a4e5d(0x139)]({'email':_0xc4087[_0x2a4e5d(0x19f)]});_0x3ec373=await adjustment[_0x2a4e5d(0x176)]({'warehouse_name':_0x1206fe[_0x2a4e5d(0x1f4)]});}else _0x3ec373=await adjustment[_0x2a4e5d(0x1e6)]([{'$unwind':'$product'},{'$group':{'_id':_0x2a4e5d(0x1bf),'invoice':{'$first':_0x2a4e5d(0x13d)},'date':{'$first':_0x2a4e5d(0x1a9)},'warehouse_name':{'$first':_0x2a4e5d(0x208)},'room':{'$addToSet':_0x2a4e5d(0x1db)},'finalize':{'$first':_0x2a4e5d(0x1af)},'isAllowEdit':{'$first':_0x2a4e5d(0x1c2)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x150007[0x0][_0x2a4e5d(0x1ae)]=='English\x20(US)'){var _0x2d8c19=users['English'];console[_0x2a4e5d(0x1f2)](_0x2d8c19);}else{if(_0x150007[0x0][_0x2a4e5d(0x1ae)]==_0x2a4e5d(0x185))var _0x2d8c19=users[_0x2a4e5d(0x185)];else{if(_0x150007[0x0]['language']==_0x2a4e5d(0x165))var _0x2d8c19=users[_0x2a4e5d(0x165)];else{if(_0x150007[0x0][_0x2a4e5d(0x1ae)]==_0x2a4e5d(0x191))var _0x2d8c19=users[_0x2a4e5d(0x191)];else{if(_0x150007[0x0][_0x2a4e5d(0x1ae)]==_0x2a4e5d(0x1e1))var _0x2d8c19=users[_0x2a4e5d(0x1e1)];else{if(_0x150007[0x0]['language']==_0x2a4e5d(0x179))var _0x2d8c19=users[_0x2a4e5d(0x18d)];else{if(_0x150007[0x0]['language']==_0x2a4e5d(0x18a))var _0x2d8c19=users['Chinese'];else{if(_0x150007[0x0][_0x2a4e5d(0x1ae)]==_0x2a4e5d(0x184))var _0x2d8c19=users[_0x2a4e5d(0x1b9)];}}}}}}}_0x3517c1[_0x2a4e5d(0x1c4)](_0x2a4e5d(0x148),{'success':_0x25562e[_0x2a4e5d(0x1da)](_0x2a4e5d(0x15a)),'errors':_0x25562e[_0x2a4e5d(0x1da)](_0x2a4e5d(0x16a)),'role':_0xc4087,'profile':_0x2e693f,'warehouse':_0x4f7d9b,'product':_0x135877,'adjustment':_0x3ec373,'master_shop':_0x150007,'language':_0x2d8c19});}catch(_0x36900b){console[_0x2a4e5d(0x1f2)](_0x36900b);}});async function getRandom8DigitNumber(){var _0x2608e2=a0_0xcb26e;const _0xa10802=0x989680,_0x3057c6=0x5f5e0ff,_0x3d48c2=Math['floor'](Math[_0x2608e2(0x159)]()*(_0x3057c6-_0xa10802+0x1))+_0xa10802;var _0x550e08;const _0x447a83=await adjustment[_0x2608e2(0x139)]({'invoice':'ADJ-'+_0x3d48c2});return _0x447a83&&_0x447a83[_0x2608e2(0x15f)]>0x0?_0x550e08=_0x2608e2(0x150)+_0x3d48c2:_0x550e08=_0x2608e2(0x150)+_0x3d48c2,_0x550e08;}function a0_0xa4b7(_0x42b207,_0x34b57e){var _0x4c78e6=a0_0x4c78();return a0_0xa4b7=function(_0xa4b7f7,_0x34c508){_0xa4b7f7=_0xa4b7f7-0x12f;var _0x202017=_0x4c78e6[_0xa4b7f7];return _0x202017;},a0_0xa4b7(_0x42b207,_0x34b57e);}router[a0_0xcb26e(0x17d)](a0_0xcb26e(0x1ce),auth,async(_0x57d388,_0x1afedb)=>{var _0x58373e=a0_0xcb26e;try{const {username:_0x3f2161,email:_0x3729f4,role:_0x2f5aee}=_0x57d388['user'],_0x95bee0=_0x57d388['user'],_0x583f1a=await profile[_0x58373e(0x139)]({'email':_0x95bee0[_0x58373e(0x19f)]}),_0x104e3e=await master_shop[_0x58373e(0x176)]();let _0x2f9447;if(_0x95bee0[_0x58373e(0x140)]==_0x58373e(0x1ad)){const _0x375beb=await staff[_0x58373e(0x139)]({'email':_0x95bee0[_0x58373e(0x19f)]});_0x2f9447=await warehouse['aggregate']([{'$match':{'status':_0x58373e(0x1a0),'name':_0x375beb[_0x58373e(0x1f4)],'warehouse_category':_0x58373e(0x1b4),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x58373e(0x1cf)}}}]);}else _0x2f9447=await warehouse[_0x58373e(0x1e6)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x58373e(0x1cf),'name':{'$first':_0x58373e(0x1cf)}}}]);const _0x59e2ab=await product[_0x58373e(0x176)]({}),_0x5b1b7e=await adjustment['find']({}),_0x5cc071=_0x5b1b7e[_0x58373e(0x15f)]+0x1,_0x36300a=_0x58373e(0x150)+_0x5cc071[_0x58373e(0x1c5)]()[_0x58373e(0x18e)](0x5,'0');var _0xcc7f5c=[_0x58373e(0x14b),_0x58373e(0x13c),'Return\x20Rooms'];if(_0x104e3e[0x0]['language']==_0x58373e(0x1de))var _0x4df8f4=users[_0x58373e(0x1a3)];else{if(_0x104e3e[0x0][_0x58373e(0x1ae)]==_0x58373e(0x185))var _0x4df8f4=users[_0x58373e(0x185)];else{if(_0x104e3e[0x0][_0x58373e(0x1ae)]==_0x58373e(0x165))var _0x4df8f4=users[_0x58373e(0x165)];else{if(_0x104e3e[0x0][_0x58373e(0x1ae)]==_0x58373e(0x191))var _0x4df8f4=users[_0x58373e(0x191)];else{if(_0x104e3e[0x0][_0x58373e(0x1ae)]==_0x58373e(0x1e1))var _0x4df8f4=users[_0x58373e(0x1e1)];else{if(_0x104e3e[0x0]['language']==_0x58373e(0x179))var _0x4df8f4=users['Portuguese'];else{if(_0x104e3e[0x0][_0x58373e(0x1ae)]==_0x58373e(0x18a))var _0x4df8f4=users[_0x58373e(0x18a)];else{if(_0x104e3e[0x0][_0x58373e(0x1ae)]==_0x58373e(0x184))var _0x4df8f4=users['Arabic'];}}}}}}}const _0x546eab=getRandom8DigitNumber();_0x546eab[_0x58373e(0x147)](_0x470328=>{var _0x437a4b=_0x58373e;_0x1afedb[_0x437a4b(0x1c4)](_0x437a4b(0x183),{'success':_0x57d388[_0x437a4b(0x1da)](_0x437a4b(0x15a)),'errors':_0x57d388[_0x437a4b(0x1da)]('errors'),'role':_0x95bee0,'profile':_0x583f1a,'warehouse':_0x2f9447,'product':_0x59e2ab,'master_shop':_0x104e3e,'language':_0x4df8f4,'rooms_data':_0xcc7f5c,'invoice_no':_0x470328});})[_0x58373e(0x1f1)](_0x2660bc=>{var _0x46f0a6=_0x58373e;_0x57d388['flash'](_0x46f0a6(0x16a),_0x46f0a6(0x1b6)),_0x1afedb[_0x46f0a6(0x1c6)](_0x46f0a6(0x195));});}catch(_0x3f9b54){console[_0x58373e(0x1f2)](_0x3f9b54);}}),router['post'](a0_0xcb26e(0x1ce),auth,async(_0x4409a9,_0x4e6253)=>{var _0x191f82=a0_0xcb26e;try{const {warehouse_name:_0x41043e,date:_0x566ea3,prod_name:_0x4d02d0,level:_0x2004bb,isle:_0x5e4431,pallet:_0x31dce4,stock:_0x19359c,types:_0x5d4de3,adjust_qty:_0x2aa877,new_adjust_qty:_0x46e440,note:_0x48ff61,Room_name:_0x3f754a,invoice:_0x153eb0,JO_number:_0x3d9d8b,expiry_date:_0xba4a05}=_0x4409a9['body'];if(typeof _0x4d02d0==_0x191f82(0x1ef))var _0x24db6b=[_0x4409a9[_0x191f82(0x175)]['prod_name']],_0x536951=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x155)]],_0x4c45ce=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x143)]],_0x58abaa=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x164)]],_0x5f3540=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x167)]],_0xcf30a1=[_0x4409a9['body']['New_Qty_Converted']],_0x532cb8=[_0x4409a9['body'][_0x191f82(0x158)]],_0x2f5b09=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x1e4)]],_0x2fcd41=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x1ee)]],_0x133e4f=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x142)]],_0x251e16=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x1a5)]],_0x46e9c3=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x17a)]],_0x154e8e=[_0x4409a9['body']['production_date']],_0x40b795=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x1e2)]],_0x3ba906=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x19e)]],_0x5ed32e=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x1dc)]],_0x5d8012=[_0x4409a9[_0x191f82(0x175)][_0x191f82(0x145)]],_0x47dbfe=[_0x4409a9[_0x191f82(0x175)]['prod_invoice']],_0x15db25=[_0x4409a9['body'][_0x191f82(0x160)]];else var _0x24db6b=[..._0x4409a9['body'][_0x191f82(0x1e8)]],_0x536951=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x155)]],_0x4c45ce=[..._0x4409a9[_0x191f82(0x175)]['stock']],_0x58abaa=[..._0x4409a9['body'][_0x191f82(0x164)]],_0x5f3540=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x167)]],_0xcf30a1=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x1fb)]],_0x532cb8=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x202)]],_0x2f5b09=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x1e4)]],_0x2fcd41=[..._0x4409a9['body'][_0x191f82(0x1ee)]],_0x133e4f=[..._0x4409a9['body'][_0x191f82(0x142)]],_0x251e16=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x1a5)]],_0x46e9c3=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x17a)]],_0x154e8e=[..._0x4409a9['body'][_0x191f82(0x204)]],_0x40b795=[..._0x4409a9[_0x191f82(0x175)]['prod_cat']],_0x3ba906=[..._0x4409a9['body'][_0x191f82(0x19e)]],_0x5ed32e=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x1dc)]],_0x5d8012=[..._0x4409a9[_0x191f82(0x175)]['second1']],_0x47dbfe=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x163)]],_0x15db25=[..._0x4409a9[_0x191f82(0x175)][_0x191f82(0x160)]];const _0x1c24b=_0x24db6b[_0x191f82(0x1a2)](_0x1beb96=>{return _0x1beb96={'product_name':_0x1beb96};});_0x536951[_0x191f82(0x1bb)]((_0x9e6fd1,_0x16a684)=>{var _0x86e8ad=_0x191f82;_0x3ba906[_0x86e8ad(0x1bb)]((_0x403994,_0x65a46a)=>{var _0xe1aaf3=_0x86e8ad;if(_0x403994==_0xe1aaf3(0x1c1)&&_0x16a684==_0x65a46a){var _0x34897b=_0x9e6fd1[_0xe1aaf3(0x154)](0x3);_0x1c24b[_0x16a684]['storage']=_0x9e6fd1[0x0],_0x1c24b[_0x16a684][_0xe1aaf3(0x1b2)]=_0x9e6fd1[0x1],_0x1c24b[_0x16a684][_0xe1aaf3(0x157)]=0x0,_0x1c24b[_0x16a684][_0xe1aaf3(0x1ec)]=0x0,_0x1c24b[_0x16a684][_0xe1aaf3(0x18b)]='Floor',_0x1c24b[_0x16a684][_0xe1aaf3(0x153)]=_0x34897b;}else{if(_0x403994==_0xe1aaf3(0x1f5)&&_0x16a684==_0x65a46a){var _0x34897b=_0x9e6fd1[_0xe1aaf3(0x154)](0x3);_0x1c24b[_0x16a684]['storage']=_0x9e6fd1[0x0],_0x1c24b[_0x16a684][_0xe1aaf3(0x1b2)]=_0x9e6fd1[0x1],_0x1c24b[_0x16a684][_0xe1aaf3(0x157)]=0x0,_0x1c24b[_0x16a684][_0xe1aaf3(0x1ec)]=0x0,_0x1c24b[_0x16a684][_0xe1aaf3(0x18b)]='Floor',_0x1c24b[_0x16a684][_0xe1aaf3(0x153)]=_0x9e6fd1[0x5];}else{if(_0x16a684==_0x65a46a){var _0x5db691;if(_0x9e6fd1[0x4]=='L')_0x5db691=_0xe1aaf3(0x199);else _0x9e6fd1[0x4]=='F'&&(_0x5db691='Floor');_0x1c24b[_0x16a684]['storage']=_0x9e6fd1[0x0],_0x1c24b[_0x16a684][_0xe1aaf3(0x1b2)]=_0x9e6fd1[0x1],_0x1c24b[_0x16a684][_0xe1aaf3(0x157)]=_0x9e6fd1[0x2],_0x1c24b[_0x16a684][_0xe1aaf3(0x1ec)]=_0x9e6fd1[0x3],_0x1c24b[_0x16a684][_0xe1aaf3(0x18b)]=_0x5db691,_0x1c24b[_0x16a684][_0xe1aaf3(0x153)]=_0x9e6fd1[0x5];}}}});}),_0x4c45ce[_0x191f82(0x1bb)]((_0x2d0fcc,_0x4e5ec8)=>{var _0x2e6834=_0x191f82;_0x1c24b[_0x4e5ec8][_0x2e6834(0x13a)]=_0x2d0fcc;}),_0x15db25['forEach']((_0x5d37e8,_0x9da828)=>{var _0x44a1b9=_0x191f82;_0x1c24b[_0x9da828][_0x44a1b9(0x1ed)]=_0x5d37e8;}),_0x58abaa[_0x191f82(0x1bb)]((_0x5312cf,_0x3d1ba0)=>{var _0x3dd858=_0x191f82;_0x1c24b[_0x3d1ba0][_0x3dd858(0x164)]=_0x5312cf;}),_0x5f3540[_0x191f82(0x1bb)]((_0xbbe048,_0x20a3e5)=>{var _0x4d5252=_0x191f82;_0x1c24b[_0x20a3e5][_0x4d5252(0x19d)]=_0xbbe048;}),_0xcf30a1['forEach']((_0x5d1170,_0x128597)=>{var _0x37637d=_0x191f82;_0x1c24b[_0x128597][_0x37637d(0x1d1)]=_0x5d1170;}),_0x532cb8[_0x191f82(0x1bb)]((_0x5bdcc7,_0x39e070)=>{var _0x1773b3=_0x191f82;_0x1c24b[_0x39e070][_0x1773b3(0x202)]=_0x5bdcc7;}),_0x2f5b09[_0x191f82(0x1bb)]((_0x204ba6,_0x197a60)=>{var _0x4cb545=_0x191f82;_0x1c24b[_0x197a60][_0x4cb545(0x1b7)]=_0x204ba6;}),_0x2fcd41[_0x191f82(0x1bb)]((_0x5a06b6,_0x29f9fd)=>{var _0x5a692e=_0x191f82;_0x1c24b[_0x29f9fd][_0x5a692e(0x197)]=_0x5a06b6;}),_0x133e4f[_0x191f82(0x1bb)]((_0x171a3c,_0x4a25e4)=>{var _0x1d8f3c=_0x191f82;_0x1c24b[_0x4a25e4][_0x1d8f3c(0x142)]=_0x171a3c;}),_0x251e16[_0x191f82(0x1bb)]((_0x286774,_0x11688d)=>{var _0x348d6=_0x191f82;_0x1c24b[_0x11688d][_0x348d6(0x1a5)]=_0x286774;}),_0x46e9c3[_0x191f82(0x1bb)]((_0x1c6e24,_0x20abcf)=>{_0x1c24b[_0x20abcf]['maxperunit']=_0x1c6e24;}),_0x154e8e[_0x191f82(0x1bb)]((_0x3070dd,_0x51589d)=>{_0x1c24b[_0x51589d]['production_date']=_0x3070dd;}),_0x40b795['forEach']((_0xa03280,_0x4e71be)=>{var _0x174868=_0x191f82;_0x1c24b[_0x4e71be][_0x174868(0x1e2)]=_0xa03280;}),_0x3ba906[_0x191f82(0x1bb)]((_0xc89fc0,_0x2a19ff)=>{_0x1c24b[_0x2a19ff]['room_names']=_0xc89fc0;}),_0x5ed32e[_0x191f82(0x1bb)]((_0x3ba51d,_0x1b19b1)=>{var _0x5478d3=_0x191f82;_0x1c24b[_0x1b19b1][_0x5478d3(0x15b)]=_0x3ba51d;}),_0x5d8012[_0x191f82(0x1bb)]((_0x52128c,_0xcf3d0a)=>{var _0xb2d73d=_0x191f82;_0x1c24b[_0xcf3d0a][_0xb2d73d(0x1ea)]=_0x52128c;}),_0x47dbfe[_0x191f82(0x1bb)]((_0x119008,_0x3ecd7e)=>{var _0x20f1ba=_0x191f82;_0x1c24b[_0x3ecd7e][_0x20f1ba(0x19a)]=_0x119008;});const _0x1d10ed=_0x1c24b[_0x191f82(0x1cc)](_0x330e87=>_0x330e87['adjust_qty']!=='0'&&_0x330e87[_0x191f82(0x19d)]!=='');var _0x2cb30a=0x0;_0x1d10ed[_0x191f82(0x1bb)](_0x5890c1=>{var _0x4e02d8=_0x191f82;console['log'](_0x4e02d8(0x1a1),_0x5890c1),parseInt(_0x5890c1[_0x4e02d8(0x19d)])<=0x0&&_0x2cb30a++;});if(_0x2cb30a!=0x0)return _0x4409a9['flash'](_0x191f82(0x16a),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x4e6253[_0x191f82(0x1c6)](_0x191f82(0x136));const _0x47cf15=new adjustment({'warehouse_name':_0x41043e,'date':_0x566ea3,'product':_0x1d10ed,'note':_0x48ff61,'room':_0x3f754a,'invoice':_0x153eb0,'JO_number':_0x3d9d8b,'expiry_date':_0xba4a05}),_0x444a7a=await _0x47cf15[_0x191f82(0x171)]();_0x4409a9[_0x191f82(0x1da)](_0x191f82(0x15a),_0x191f82(0x130)),_0x4e6253[_0x191f82(0x1c6)]('/adjustment/preview/'+_0x444a7a['_id']);}catch(_0x3e4be3){console[_0x191f82(0x1f2)](_0x3e4be3),_0x4e6253[_0x191f82(0x1c8)](0xc8)[_0x191f82(0x1c7)]({'message':_0x3e4be3['message']});}}),router[a0_0xcb26e(0x17d)]('/preview/:id',auth,async(_0x31cea5,_0x338da6)=>{var _0x3015b4=a0_0xcb26e;try{const {username:_0xbdae30,email:_0xbca604,role:_0x5a76e7}=_0x31cea5[_0x3015b4(0x189)],_0x15a64d=_0x31cea5[_0x3015b4(0x189)],_0x38f43b=await profile[_0x3015b4(0x139)]({'email':_0x15a64d['email']}),_0x5c5e4c=await master_shop[_0x3015b4(0x176)](),_0x2e068f=_0x31cea5[_0x3015b4(0x1f8)]['id'],_0x5d1ee4=await adjustment[_0x3015b4(0x1eb)]({'_id':_0x2e068f}),_0x2e66b5=await purchases['aggregate']([{'$match':{'warehouse_name':_0x5d1ee4[_0x3015b4(0x1d9)]}},{'$unwind':'$product'},{'$group':{'_id':_0x3015b4(0x1ab)}}]),_0x547767=await product[_0x3015b4(0x176)]({}),_0x2fae2b=await warehouse[_0x3015b4(0x1e6)]([{'$match':{'name':_0x5d1ee4[_0x3015b4(0x1d9)]}},{'$unwind':_0x3015b4(0x180)},{'$group':{'_id':_0x3015b4(0x1ff),'name':{'$first':_0x3015b4(0x1b5)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3015b4(0x149)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3015b4(0x1fe)},'floorlevel':{'$first':_0x3015b4(0x13b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3015b4(0x16f)},'product_code':{'$first':_0x3015b4(0x19c)},'storage':{'$first':_0x3015b4(0x1c3)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3015b4(0x135)},'batch_code':{'$first':_0x3015b4(0x172)},'room':{'$first':_0x3015b4(0x1be)}}}]);if(_0x5c5e4c[0x0][_0x3015b4(0x1ae)]==_0x3015b4(0x1de)){var _0x4299c6=users['English'];console['log'](_0x4299c6);}else{if(_0x5c5e4c[0x0]['language']=='Hindi')var _0x4299c6=users[_0x3015b4(0x185)];else{if(_0x5c5e4c[0x0][_0x3015b4(0x1ae)]==_0x3015b4(0x165))var _0x4299c6=users[_0x3015b4(0x165)];else{if(_0x5c5e4c[0x0][_0x3015b4(0x1ae)]=='Spanish')var _0x4299c6=users[_0x3015b4(0x191)];else{if(_0x5c5e4c[0x0]['language']==_0x3015b4(0x1e1))var _0x4299c6=users[_0x3015b4(0x1e1)];else{if(_0x5c5e4c[0x0][_0x3015b4(0x1ae)]==_0x3015b4(0x179))var _0x4299c6=users[_0x3015b4(0x18d)];else{if(_0x5c5e4c[0x0][_0x3015b4(0x1ae)]==_0x3015b4(0x18a))var _0x4299c6=users[_0x3015b4(0x18a)];else{if(_0x5c5e4c[0x0]['language']==_0x3015b4(0x184))var _0x4299c6=users[_0x3015b4(0x1b9)];}}}}}}}_0x338da6[_0x3015b4(0x1c4)](_0x3015b4(0x17b),{'success':_0x31cea5['flash'](_0x3015b4(0x15a)),'errors':_0x31cea5[_0x3015b4(0x1da)](_0x3015b4(0x16a)),'role':_0x15a64d,'profile':_0x38f43b,'adjustment':_0x5d1ee4,'stock':_0x2fae2b,'master_shop':_0x5c5e4c,'warehouse_name':_0x2e66b5,'unit':_0x547767,'language':_0x4299c6});}catch(_0x3e4df2){console[_0x3015b4(0x1f2)](_0x3e4df2),_0x338da6[_0x3015b4(0x1c8)](0xc8)[_0x3015b4(0x1c7)]({'message':_0x3e4df2[_0x3015b4(0x170)]});}}),router[a0_0xcb26e(0x1a7)](a0_0xcb26e(0x1c9),auth,async(_0x174957,_0x35f4af)=>{var _0x35f525=a0_0xcb26e;try{const _0x55b586=_0x174957[_0x35f525(0x1f8)]['id'],{warehouse_name:_0x3bd5f3,Room_name:_0x1749a4}=_0x174957[_0x35f525(0x175)],_0x106408=await adjustment['findById']({'_id':_0x55b586}),_0x279416=_0x106408[_0x35f525(0x15d)]['map'](async _0x1fd83f=>{var _0x1a15bf=_0x35f525;if(_0x1fd83f[_0x1a15bf(0x19d)]>0x0){var _0x27f7f9=await warehouse[_0x1a15bf(0x139)]({'name':_0x3bd5f3,'room':_0x1fd83f[_0x1a15bf(0x17f)],'warehouse_category':_0x1a15bf(0x1b4)});const _0x3d96a0=_0x27f7f9[_0x1a15bf(0x209)][_0x1a15bf(0x1a2)](_0x29899a=>{var _0x2ceaf2=_0x1a15bf;console[_0x2ceaf2(0x1f2)](_0x1fd83f[_0x2ceaf2(0x164)]+_0x2ceaf2(0x1f3));if(_0x1fd83f['types']==_0x2ceaf2(0x132)){if(_0x29899a[_0x2ceaf2(0x14e)]==_0x1fd83f[_0x2ceaf2(0x14e)]&&_0x29899a[_0x2ceaf2(0x153)]==_0x1fd83f[_0x2ceaf2(0x153)]&&_0x29899a['type']==_0x1fd83f[_0x2ceaf2(0x18b)]&&_0x29899a[_0x2ceaf2(0x1ec)]==_0x1fd83f[_0x2ceaf2(0x1ec)]&&_0x29899a[_0x2ceaf2(0x157)]==_0x1fd83f['bay']&&_0x29899a['rack']==_0x1fd83f['rack']&&_0x29899a[_0x2ceaf2(0x131)]==_0x1fd83f['storage']&&_0x29899a[_0x2ceaf2(0x1a5)]==_0x1fd83f['expiry_date']&&_0x29899a['batch_code']==_0x1fd83f['batch_code']&&_0x29899a[_0x2ceaf2(0x204)]==_0x1fd83f[_0x2ceaf2(0x204)]&&_0x29899a['invoice']==_0x1fd83f[_0x2ceaf2(0x19a)]&&_0x29899a[_0x2ceaf2(0x200)]==_0x1fd83f['id_transaction_from']){var _0x6995cc;_0x6995cc=_0x1fd83f[_0x2ceaf2(0x19d)],_0x1fd83f[_0x2ceaf2(0x1e2)]=='S'&&(_0x6995cc=_0x1fd83f[_0x2ceaf2(0x19d)]),_0x29899a[_0x2ceaf2(0x196)]=_0x29899a[_0x2ceaf2(0x196)]-_0x6995cc;}}else{if(_0x29899a[_0x2ceaf2(0x14e)]==_0x1fd83f['product_name']&&_0x29899a[_0x2ceaf2(0x153)]==_0x1fd83f[_0x2ceaf2(0x153)]&&_0x29899a[_0x2ceaf2(0x18b)]==_0x1fd83f['type']&&_0x29899a[_0x2ceaf2(0x1ec)]==_0x1fd83f['bin']&&_0x29899a[_0x2ceaf2(0x157)]==_0x1fd83f[_0x2ceaf2(0x157)]&&_0x29899a['rack']==_0x1fd83f['rack']&&_0x29899a[_0x2ceaf2(0x131)]==_0x1fd83f[_0x2ceaf2(0x131)]&&_0x29899a[_0x2ceaf2(0x1a5)]==_0x1fd83f[_0x2ceaf2(0x1a5)]&&_0x29899a[_0x2ceaf2(0x142)]==_0x1fd83f['batch_code']&&_0x29899a[_0x2ceaf2(0x204)]==_0x1fd83f[_0x2ceaf2(0x204)]&&_0x29899a[_0x2ceaf2(0x19a)]==_0x1fd83f[_0x2ceaf2(0x19a)]&&_0x29899a[_0x2ceaf2(0x200)]==_0x1fd83f['id_transaction_from']){console[_0x2ceaf2(0x1f2)](_0x1fd83f);var _0x6995cc;_0x6995cc=_0x1fd83f[_0x2ceaf2(0x19d)],_0x1fd83f['prod_cat']=='S'&&(_0x6995cc=_0x1fd83f[_0x2ceaf2(0x19d)]),_0x29899a[_0x2ceaf2(0x196)]=_0x29899a['product_stock']+_0x6995cc;}}});}return _0x27f7f9;});Promise['all'](_0x279416)['then'](async _0x1734dc=>{var _0x356a86=_0x35f525;try{for(const _0x16beca of _0x1734dc){await _0x16beca[_0x356a86(0x171)]();}_0x106408[_0x356a86(0x144)]='True';const _0x4f057d=await _0x106408[_0x356a86(0x171)](),_0x15a35c=await master_shop['find'](),_0x195d5b=await email_settings[_0x356a86(0x139)](),_0x1e76fc=await supervisor_settings['find']();var _0x59f7c2=_0x106408[_0x356a86(0x15d)],_0x1b2fe0='',_0x176346;for(_0x176346 in _0x59f7c2){_0x1b2fe0+=_0x356a86(0x14a)+_0x356a86(0x16e)+_0x59f7c2[_0x176346][_0x356a86(0x14e)]+_0x356a86(0x1e3)+_0x356a86(0x16e)+_0x59f7c2[_0x176346][_0x356a86(0x197)]+'</td>'+_0x356a86(0x16e)+_0x59f7c2[_0x176346][_0x356a86(0x19d)]+_0x356a86(0x1e3)+_0x356a86(0x16e)+_0x59f7c2[_0x176346][_0x356a86(0x202)]+_0x356a86(0x1e3)+_0x356a86(0x16e)+_0x59f7c2[_0x176346]['secondary_unit']+_0x356a86(0x1e3)+_0x356a86(0x16e)+_0x106408[_0x356a86(0x1d9)]+'</td>'+_0x356a86(0x16e)+_0x59f7c2[_0x176346]['room_names']+'</td>'+_0x356a86(0x16e)+_0x59f7c2[_0x176346][_0x356a86(0x131)]+_0x59f7c2[_0x176346][_0x356a86(0x1b2)]+_0x59f7c2[_0x176346]['bay']+_0x59f7c2[_0x176346][_0x356a86(0x1ec)]+_0x59f7c2[_0x176346][_0x356a86(0x18b)][0x0]+_0x59f7c2[_0x176346]['floorlevel']+_0x356a86(0x1e3),_0x356a86(0x1bc);}let _0x508f75=nodemailer['createTransport']({'host':_0x195d5b[_0x356a86(0x1f0)],'port':Number(_0x195d5b['port']),'secure':![],'auth':{'user':_0x195d5b[_0x356a86(0x19f)],'pass':_0x195d5b['password']}}),_0x42c0e4={'from':_0x195d5b[_0x356a86(0x19f)],'to':_0x1e76fc[0x0]['RMSEmail'],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x356a86(0x15c)+_0x356a86(0x1a6)+_0x15a35c[0x0][_0x356a86(0x13f)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x356a86(0x1e9)+'<div>'+_0x356a86(0x173)+_0x356a86(0x1d3)+_0x356a86(0x12f)+_0x356a86(0x169)+_0x356a86(0x1d3)+_0x356a86(0x17c)+_0x15a35c[0x0]['site_title']+_0x356a86(0x1d2)+_0x356a86(0x169)+_0x356a86(0x169)+_0x356a86(0x1dd)+_0x356a86(0x1d3)+_0x356a86(0x18f)+'\x20Order\x20Number\x20:\x20'+_0x106408['invoice']+'\x20'+_0x356a86(0x1f6)+_0x356a86(0x1b8)+_0x106408['date']+'\x20'+_0x356a86(0x14f)+_0x356a86(0x1df)+_0x356a86(0x169)+_0x356a86(0x192)+_0x356a86(0x194)+_0x356a86(0x14a)+_0x356a86(0x1e0)+_0x356a86(0x1aa)+_0x356a86(0x16c)+_0x356a86(0x1b0)+_0x356a86(0x146)+_0x356a86(0x14c)+_0x356a86(0x134)+_0x356a86(0x18c)+_0x356a86(0x1bc)+_0x356a86(0x188)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1b2fe0+'\x20'+_0x356a86(0x193)+_0x356a86(0x138)+'<div>'+_0x356a86(0x1b3)+_0x356a86(0x174)+_0x15a35c[0x0][_0x356a86(0x177)]+'</h5>'+_0x356a86(0x169)+_0x356a86(0x169)+_0x356a86(0x1d4)};_0x508f75['sendMail'](_0x42c0e4,function(_0x5b719e,_0x2cbad7){var _0x1a3509=_0x356a86;_0x5b719e?(console[_0x1a3509(0x1f2)](_0x5b719e),console[_0x1a3509(0x1f2)]('Error\x20Occurs')):console[_0x1a3509(0x1f2)](_0x1a3509(0x205));}),_0x174957[_0x356a86(0x1da)]('success',_0x356a86(0x1f7)),_0x35f4af['redirect'](_0x356a86(0x182)+_0x4f057d['_id']);}catch(_0x3e4b11){console[_0x356a86(0x141)](_0x3e4b11),_0x35f4af[_0x356a86(0x1c8)](0x1f4)[_0x356a86(0x1c7)]({'error':_0x356a86(0x198)});}})[_0x35f525(0x1f1)](_0x45e5c9=>{var _0x1b6bb5=_0x35f525;console['error'](_0x45e5c9),_0x35f4af['status'](0x1f4)[_0x1b6bb5(0x1c7)]({'error':_0x1b6bb5(0x14d)});});}catch(_0x31e42c){console['log'](_0x31e42c),_0x35f4af[_0x35f525(0x1c8)](0xc8)[_0x35f525(0x1c7)]({'message':_0x31e42c[_0x35f525(0x170)]});}}),router[a0_0xcb26e(0x17d)](a0_0xcb26e(0x1cb),auth,async(_0x2596d6,_0xc6aad7)=>{var _0x39e81f=a0_0xcb26e;try{const {username:_0x163e2f,email:_0xb1823e,role:_0x5a41f5}=_0x2596d6[_0x39e81f(0x189)],_0x1eb52c=_0x2596d6[_0x39e81f(0x189)],_0x331488=await profile['findOne']({'email':_0x1eb52c[_0x39e81f(0x19f)]}),_0x1ab923=await master_shop[_0x39e81f(0x176)](),_0x4bf9fa=_0x2596d6['params']['id'],_0x4c81f2=await adjustment[_0x39e81f(0x1eb)]({'_id':_0x4bf9fa}),_0xf29a90=await purchases[_0x39e81f(0x1e6)]([{'$match':{'warehouse_name':_0x4c81f2['warehouse_name']}},{'$unwind':_0x39e81f(0x1d5)},{'$group':{'_id':_0x39e81f(0x1ab)}}]),_0xff78c1=await product['find']({}),_0x17dd1f=await warehouse[_0x39e81f(0x1e6)]([{'$match':{'name':_0x4c81f2[_0x39e81f(0x1d9)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x39e81f(0x1ff),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x39e81f(0x137)},'bay':{'$first':_0x39e81f(0x149)},'bin':{'$first':_0x39e81f(0x1d8)},'type':{'$first':_0x39e81f(0x1fe)},'floorlevel':{'$first':_0x39e81f(0x13b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x39e81f(0x16f)},'product_code':{'$first':_0x39e81f(0x19c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x39e81f(0x1fa)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x39e81f(0x151)},'production_date':{'$first':_0x39e81f(0x135)},'batch_code':{'$first':_0x39e81f(0x172)},'room':{'$first':_0x39e81f(0x1be)}}}]);let _0x3f167b;if(_0x1eb52c['role']==_0x39e81f(0x1ad)){const _0x1dffc0=await staff[_0x39e81f(0x139)]({'email':_0x1eb52c[_0x39e81f(0x19f)]});_0x3f167b=await warehouse[_0x39e81f(0x1e6)]([{'$match':{'status':_0x39e81f(0x1a0),'name':_0x1dffc0['warehouse'],'warehouse_category':_0x39e81f(0x1b4),'name':{'$ne':_0x39e81f(0x13e)}}},{'$group':{'_id':_0x39e81f(0x1cf),'name':{'$first':_0x39e81f(0x1cf)}}}]);}else _0x3f167b=await warehouse[_0x39e81f(0x1e6)]([{'$match':{'status':_0x39e81f(0x1a0),'warehouse_category':_0x39e81f(0x1b4),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x39e81f(0x1cf),'name':{'$first':_0x39e81f(0x1cf)}}}]);if(_0x1ab923[0x0][_0x39e81f(0x1ae)]==_0x39e81f(0x1de)){var _0x96f5ab=users[_0x39e81f(0x1a3)];console[_0x39e81f(0x1f2)](_0x96f5ab);}else{if(_0x1ab923[0x0][_0x39e81f(0x1ae)]=='Hindi')var _0x96f5ab=users[_0x39e81f(0x185)];else{if(_0x1ab923[0x0][_0x39e81f(0x1ae)]=='German')var _0x96f5ab=users[_0x39e81f(0x165)];else{if(_0x1ab923[0x0][_0x39e81f(0x1ae)]==_0x39e81f(0x191))var _0x96f5ab=users[_0x39e81f(0x191)];else{if(_0x1ab923[0x0][_0x39e81f(0x1ae)]==_0x39e81f(0x1e1))var _0x96f5ab=users[_0x39e81f(0x1e1)];else{if(_0x1ab923[0x0][_0x39e81f(0x1ae)]==_0x39e81f(0x179))var _0x96f5ab=users[_0x39e81f(0x18d)];else{if(_0x1ab923[0x0][_0x39e81f(0x1ae)]==_0x39e81f(0x18a))var _0x96f5ab=users[_0x39e81f(0x18a)];else{if(_0x1ab923[0x0][_0x39e81f(0x1ae)]==_0x39e81f(0x184))var _0x96f5ab=users[_0x39e81f(0x1b9)];}}}}}}}_0xc6aad7[_0x39e81f(0x1c4)](_0x39e81f(0x168),{'success':_0x2596d6['flash'](_0x39e81f(0x15a)),'errors':_0x2596d6[_0x39e81f(0x1da)](_0x39e81f(0x16a)),'role':_0x1eb52c,'profile':_0x331488,'adjustment':_0x4c81f2,'stock':_0x17dd1f,'master_shop':_0x1ab923,'warehouse_name':_0xf29a90,'unit':_0xff78c1,'language':_0x96f5ab,'warehouse':_0x3f167b});}catch(_0x581faa){console[_0x39e81f(0x1f2)](_0x581faa),_0xc6aad7[_0x39e81f(0x1c8)](0xc8)[_0x39e81f(0x1c7)]({'message':_0x581faa[_0x39e81f(0x170)]});}}),router[a0_0xcb26e(0x1a7)](a0_0xcb26e(0x1cb),auth,async(_0x49863f,_0x314710)=>{var _0x2d6618=a0_0xcb26e;try{const _0xfd6a25=_0x49863f['params']['id'],_0x28b021=await adjustment[_0x2d6618(0x1eb)]({'_id':_0xfd6a25}),_0x3d6ef4=await warehouse[_0x2d6618(0x139)]({'name':_0x28b021[_0x2d6618(0x1d9)],'room':_0x28b021[_0x2d6618(0x190)]}),{warehouse_name:_0x3e5118,date:_0x52c97f,prod_name:_0x214975,level:_0x44dbbc,isle:_0x28138c,pallet:_0x2b8023,stock:_0x3e4ad0,types:_0x4f2cde,adjust_qty:_0x516c0f,new_adjust_qty:_0x104138,note:_0x83629a,Room_name:_0x2bcc0c,invoice:_0x2c1616,JO_number:_0x52bc29,expiry_date:_0x5c7890}=_0x49863f[_0x2d6618(0x175)];if(typeof _0x214975==_0x2d6618(0x1ef))var _0x356e13=[_0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1e8)]],_0x356f28=[_0x49863f[_0x2d6618(0x175)][_0x2d6618(0x155)]],_0x4e496b=[_0x49863f[_0x2d6618(0x175)][_0x2d6618(0x143)]],_0x13eca2=[_0x49863f[_0x2d6618(0x175)]['types']],_0x131fc4=[_0x49863f['body']['New_Qty_Converted_adj']],_0x5ee150=[_0x49863f['body']['New_Qty_Converted']],_0x1b0fee=[_0x49863f[_0x2d6618(0x175)]['Primary_Units']],_0x3c6a3f=[_0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1e4)]],_0x23c489=[_0x49863f['body'][_0x2d6618(0x1ee)]],_0x33362=[_0x49863f['body']['batch_code']],_0x190f6b=[_0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1a5)]],_0xd6d8f9=[_0x49863f[_0x2d6618(0x175)]['max_per_unit']],_0x35f263=[_0x49863f[_0x2d6618(0x175)][_0x2d6618(0x204)]],_0x417d70=[_0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1e2)]],_0x290e77=[_0x49863f['body'][_0x2d6618(0x19e)]],_0xf3b26a=[_0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1dc)]],_0x83f514=[_0x49863f['body']['second1']];else var _0x356e13=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1e8)]],_0x356f28=[..._0x49863f['body'][_0x2d6618(0x155)]],_0x4e496b=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x143)]],_0x13eca2=[..._0x49863f['body'][_0x2d6618(0x164)]],_0x131fc4=[..._0x49863f[_0x2d6618(0x175)]['New_Qty_Converted_adj']],_0x5ee150=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1fb)]],_0x1b0fee=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x202)]],_0x3c6a3f=[..._0x49863f['body'][_0x2d6618(0x1e4)]],_0x23c489=[..._0x49863f['body'][_0x2d6618(0x1ee)]],_0x33362=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x142)]],_0x190f6b=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1a5)]],_0xd6d8f9=[..._0x49863f['body'][_0x2d6618(0x17a)]],_0x35f263=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x204)]],_0x417d70=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1e2)]],_0x290e77=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x19e)]],_0xf3b26a=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x1dc)]],_0x83f514=[..._0x49863f[_0x2d6618(0x175)][_0x2d6618(0x145)]];const _0x4b3a2f=_0x356e13['map'](_0x119565=>{return _0x119565={'product_name':_0x119565};});_0x356f28[_0x2d6618(0x1bb)]((_0x3e3528,_0x39b640)=>{_0x290e77['forEach']((_0x16d7e9,_0x2902aa)=>{var _0x4e0afb=a0_0xa4b7;if(_0x16d7e9==_0x4e0afb(0x1c1)&&_0x39b640==_0x2902aa){var _0x35900b=_0x3e3528[_0x4e0afb(0x154)](0x3);_0x4b3a2f[_0x39b640][_0x4e0afb(0x131)]=_0x3e3528[0x0],_0x4b3a2f[_0x39b640]['rack']=_0x3e3528[0x1],_0x4b3a2f[_0x39b640]['bay']=0x0,_0x4b3a2f[_0x39b640][_0x4e0afb(0x1ec)]=0x0,_0x4b3a2f[_0x39b640][_0x4e0afb(0x18b)]='Floor',_0x4b3a2f[_0x39b640][_0x4e0afb(0x153)]=_0x35900b;}else{if(_0x16d7e9==_0x4e0afb(0x1f5)&&_0x39b640==_0x2902aa){var _0x35900b=_0x3e3528['slice'](0x3);_0x4b3a2f[_0x39b640][_0x4e0afb(0x131)]=_0x3e3528[0x0],_0x4b3a2f[_0x39b640][_0x4e0afb(0x1b2)]=_0x3e3528[0x1],_0x4b3a2f[_0x39b640][_0x4e0afb(0x157)]=0x0,_0x4b3a2f[_0x39b640]['bin']=0x0,_0x4b3a2f[_0x39b640][_0x4e0afb(0x18b)]=_0x4e0afb(0x181),_0x4b3a2f[_0x39b640][_0x4e0afb(0x153)]=_0x3e3528[0x5];}else{if(_0x39b640==_0x2902aa){var _0x3af745;if(_0x3e3528[0x4]=='L')_0x3af745='Level';else _0x3e3528[0x4]=='F'&&(_0x3af745=_0x4e0afb(0x181));_0x4b3a2f[_0x39b640][_0x4e0afb(0x131)]=_0x3e3528[0x0],_0x4b3a2f[_0x39b640][_0x4e0afb(0x1b2)]=_0x3e3528[0x1],_0x4b3a2f[_0x39b640]['bay']=_0x3e3528[0x2],_0x4b3a2f[_0x39b640][_0x4e0afb(0x1ec)]=_0x3e3528[0x3],_0x4b3a2f[_0x39b640][_0x4e0afb(0x18b)]=_0x3af745,_0x4b3a2f[_0x39b640]['floorlevel']=_0x3e3528[0x5];}}}});}),_0x4e496b[_0x2d6618(0x1bb)]((_0x3a28f5,_0x261290)=>{var _0xa869c6=_0x2d6618;_0x4b3a2f[_0x261290][_0xa869c6(0x13a)]=_0x3a28f5;}),_0x13eca2[_0x2d6618(0x1bb)]((_0xad28fe,_0x1b5d34)=>{var _0x219860=_0x2d6618;_0x4b3a2f[_0x1b5d34][_0x219860(0x164)]=_0xad28fe;}),_0x131fc4[_0x2d6618(0x1bb)]((_0x4166e7,_0x2a0d95)=>{var _0x1ad656=_0x2d6618;_0x4b3a2f[_0x2a0d95][_0x1ad656(0x19d)]=_0x4166e7;}),_0x5ee150['forEach']((_0x46a1f6,_0x53bb9b)=>{_0x4b3a2f[_0x53bb9b]['new_adjust_qty']=_0x46a1f6;}),_0x1b0fee[_0x2d6618(0x1bb)]((_0x577184,_0x464864)=>{var _0x360e35=_0x2d6618;_0x4b3a2f[_0x464864][_0x360e35(0x202)]=_0x577184;}),_0x3c6a3f[_0x2d6618(0x1bb)]((_0x83f33a,_0x8bedeb)=>{var _0x266454=_0x2d6618;_0x4b3a2f[_0x8bedeb][_0x266454(0x1b7)]=_0x83f33a;}),_0x23c489['forEach']((_0x144ccc,_0x386e3b)=>{var _0x2dda15=_0x2d6618;_0x4b3a2f[_0x386e3b][_0x2dda15(0x197)]=_0x144ccc;}),_0x33362[_0x2d6618(0x1bb)]((_0x483cf1,_0x38722c)=>{var _0x5910f9=_0x2d6618;_0x4b3a2f[_0x38722c][_0x5910f9(0x142)]=_0x483cf1;}),_0x190f6b[_0x2d6618(0x1bb)]((_0x456eeb,_0x2cd9bf)=>{var _0x15064c=_0x2d6618;_0x4b3a2f[_0x2cd9bf][_0x15064c(0x1a5)]=_0x456eeb;}),_0xd6d8f9['forEach']((_0x6f0964,_0xf8ce92)=>{var _0xdb755=_0x2d6618;_0x4b3a2f[_0xf8ce92][_0xdb755(0x161)]=_0x6f0964;}),_0x35f263[_0x2d6618(0x1bb)]((_0x3a4c34,_0x1f6f2b)=>{var _0x594c8c=_0x2d6618;_0x4b3a2f[_0x1f6f2b][_0x594c8c(0x204)]=_0x3a4c34;}),_0x417d70[_0x2d6618(0x1bb)]((_0x13ed79,_0x1fefde)=>{var _0x527e26=_0x2d6618;_0x4b3a2f[_0x1fefde][_0x527e26(0x1e2)]=_0x13ed79;}),_0x290e77['forEach']((_0x2b18b9,_0x36f650)=>{var _0x2f322f=_0x2d6618;_0x4b3a2f[_0x36f650][_0x2f322f(0x17f)]=_0x2b18b9;}),_0xf3b26a[_0x2d6618(0x1bb)]((_0x281cca,_0x2a2b7b)=>{var _0x4e3919=_0x2d6618;_0x4b3a2f[_0x2a2b7b][_0x4e3919(0x15b)]=_0x281cca;}),_0x83f514[_0x2d6618(0x1bb)]((_0x5a11d3,_0x3fd8e3)=>{var _0x466a78=_0x2d6618;_0x4b3a2f[_0x3fd8e3][_0x466a78(0x1ea)]=_0x5a11d3;});const _0xf7c377=_0x4b3a2f['filter'](_0x4bae51=>_0x4bae51[_0x2d6618(0x19d)]!=='0'&&_0x4bae51['adjust_qty']!=='');var _0x37e478=0x0;_0xf7c377['forEach'](_0x347f58=>{var _0x5463cc=_0x2d6618;console[_0x5463cc(0x1f2)]('foreach\x20newproduct',_0x347f58),parseInt(_0x347f58[_0x5463cc(0x19d)])<=0x0&&_0x37e478++;});if(_0x37e478!=0x0)return _0x49863f[_0x2d6618(0x1da)]('errors',_0x2d6618(0x156)),_0x314710['redirect']('back');_0x28b021['warehouse_name']=_0x3e5118,_0x28b021[_0x2d6618(0x1a4)]=_0x52c97f,_0x28b021[_0x2d6618(0x15d)]=_0xf7c377,_0x28b021['note']=_0x83629a,_0x28b021[_0x2d6618(0x19a)]=_0x2c1616,_0x28b021[_0x2d6618(0x19b)]=_0x2d6618(0x17e);const _0x1a5ccc=await _0x28b021['save']();_0x49863f[_0x2d6618(0x1da)](_0x2d6618(0x15a),_0x2d6618(0x1c0)),_0x314710[_0x2d6618(0x1c6)](_0x2d6618(0x195));}catch(_0x5aadb2){console[_0x2d6618(0x1f2)](_0x5aadb2);}}),router[a0_0xcb26e(0x1a7)](a0_0xcb26e(0x1e5),async(_0x55cbff,_0x5c3a68)=>{var _0x50ded4=a0_0xcb26e;const {primary_code:_0x381fd5,warehouse_data:_0x32ec53,rooms_data:_0x37c539,Roomslist:_0x14971f}=_0x55cbff['body'],_0x296c53=_0x14971f[_0x50ded4(0x1ac)](','),_0x5bff72=[];async function _0x5a2444(_0x400061){var _0x3d7d30=_0x50ded4;const _0x5f0aff=await warehouse[_0x3d7d30(0x1e6)]([{'$match':{'name':_0x32ec53,'room':_0x400061}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x381fd5}},{'$group':{'_id':_0x3d7d30(0x1ff),'name':{'$first':_0x3d7d30(0x1b5)},'product_stock':{'$first':_0x3d7d30(0x137)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3d7d30(0x16f)},'product_code':{'$first':_0x3d7d30(0x19c)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x3d7d30(0x1d8)},'type':{'$first':_0x3d7d30(0x1fe)},'pallet':{'$first':_0x3d7d30(0x13b)},'unit':{'$first':_0x3d7d30(0x1b1)},'secondary_unit':{'$first':_0x3d7d30(0x187)},'storage':{'$first':_0x3d7d30(0x1c3)},'rack':{'$first':_0x3d7d30(0x1fa)},'expiry_date':{'$first':_0x3d7d30(0x151)},'production_date':{'$first':_0x3d7d30(0x135)},'maxPerUnit':{'$first':_0x3d7d30(0x1d6)},'batch_code':{'$first':_0x3d7d30(0x172)},'product_cat':{'$first':_0x3d7d30(0x1e7)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3d7d30(0x1be)},'invoice':{'$first':_0x3d7d30(0x207)}}}]),_0xc6443f=await warehouse[_0x3d7d30(0x1e6)]([{'$match':{'name':_0x32ec53,'room':_0x400061}},{'$unwind':_0x3d7d30(0x180)},{'$match':{'product_details.secondary_code':_0x381fd5}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3d7d30(0x1b5)},'product_stock':{'$first':_0x3d7d30(0x137)},'primary_code':{'$first':_0x3d7d30(0x1fd)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3d7d30(0x19c)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3d7d30(0x1fe)},'pallet':{'$first':_0x3d7d30(0x13b)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x3d7d30(0x187)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3d7d30(0x1fa)},'expiry_date':{'$first':_0x3d7d30(0x151)},'production_date':{'$first':_0x3d7d30(0x135)},'maxPerUnit':{'$first':_0x3d7d30(0x1d6)},'batch_code':{'$first':_0x3d7d30(0x172)},'product_cat':{'$first':_0x3d7d30(0x1e7)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3d7d30(0x1be)}}}]);if(_0x5f0aff[_0x3d7d30(0x15f)]>0x0)_0x5bff72[_0x3d7d30(0x201)](_0x5f0aff);else _0xc6443f[_0x3d7d30(0x15f)]>0x0&&_0x5bff72[_0x3d7d30(0x201)](_0xc6443f);}const _0x487c2e=_0x296c53[_0x50ded4(0x1a2)](_0x33f26b=>_0x5a2444(_0x33f26b));await Promise[_0x50ded4(0x1a8)](_0x487c2e),_0x5c3a68[_0x50ded4(0x1c7)](_0x5bff72);}),router[a0_0xcb26e(0x1a7)](a0_0xcb26e(0x16b),async(_0x4dfdc9,_0x563eef)=>{var _0x292d07=a0_0xcb26e;const {primaryCode:_0x5f1534,secondaryCode:_0x129239,productCode:_0x10da44,level:_0x1ec65f,isle:_0x1b0b41,pallet:_0x194558,warehouses:_0x46a838,room:_0x561f56}=_0x4dfdc9[_0x292d07(0x175)];try{const _0x5f3e20=await warehouse['aggregate']([{'$match':{'name':_0x46a838,'room':_0x561f56}},{'$unwind':_0x292d07(0x180)},{'$match':{'product_details.level':parseInt(_0x1ec65f),'product_details.isle':_0x1b0b41,'product_details.pallet':parseInt(_0x194558)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x292d07(0x1b5)},'product_stock':{'$first':_0x292d07(0x137)},'level':{'$first':_0x292d07(0x1ba)},'isle':{'$first':_0x292d07(0x1d0)},'pallet':{'$first':_0x292d07(0x166)},'maxProducts':{'$first':_0x292d07(0x152)}}}]);_0x563eef[_0x292d07(0x1c8)](0xc8)[_0x292d07(0x1c7)](_0x5f3e20);}catch(_0x9e5c78){_0x563eef[_0x292d07(0x1c8)](0x194)['json']({'message':_0x9e5c78[_0x292d07(0x170)]});}}),module[a0_0xcb26e(0x1fc)]=router;