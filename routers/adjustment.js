function a0_0x20e0(){var _0x2feb69=['product_name','/view/add_adjustment','production_date','$product_details.isle','user','post','second1','$name','findById','secondary_code','get','warehouse','expiry_date','filter','$product_details.product_cat','</tr>','Spanish','/CheckingWarehouse','prod_cat','\x20</h2>','random','image','$product_details.production_date','secondary_unit','Primary_Units','$product_details','product_code','</thead>','Return\x20Goods','Raw\x20Materials','toString','batch_code','French','$product.room_names','</tbody>','../middleware/auth','password','English\x20(US)','3030Hwonda','Hindi','site_title','10085WNHelX','all','Arabic\x20(ae)','$product_details.expiry_date','string','forEach','German','find','port','33MFsYeh','\x20<>\x20','$product.product_name','Secondary_units','/../public','$product_details.product_code','foreach\x20newproduct','$room','flash','findOne','Enabled','629254wmpKsr','product','date','$product_details.secondary_code','10214172baTmnK','id_transaction','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.bay','2361898kJqkha','1736MhaqNC','adjustment\x20add\x20successfull','$product_details.unit','product_stock','edit_adjustment_view','$product_details.floorlevel','$product_details.batch_code','exports','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','prod_code','adjustment','master','aggregate','new_adjust_qty','English','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','types','Portuguese','New_Qty_Converted_adj','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','prime1','$product_details.type','nodemailer','render','$product','<tr>','maxperunit','Chinese','map','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','../public/language/languages.json','</td>','errors','adjustment\x20data\x20update\x20successfully','type','$product_details.primary_code','body','Level','Portuguese\x20(BR)','$product_details._id','json','isAllowEdit','adjust_qty','adjustment\x20Finalized\x20successfully','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/view','slice','prod_name','bin','floor','</body></html>','id_transaction_from','language','Receiving\x20Area','message','$warehouse_name','room_names','</div>','Logo.png','</table>','back','28272NyyHcV','length','status','$product_details.secondary_unit','unit','<h2>\x20','ADJ-','stock','invoice','<tbody\x20style=\x22text-align:\x20center;\x22>','/adjustment/view','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.product_name','level','storage','room','floorlevel','RMSEmail','email','An\x20error\x20occurred.','product_details','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.rack','max_per_unit','Return\x20Rooms','<html><head><title></title>','\x20Order\x20Number\x20:\x20','$product_details.level','edit_adjustment','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','success','$product_details.invoice','$product_details.maxPerUnit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','1539pcCfYl','Floor','warehouse_name','save','push','/preview/:id','</h5>','/adjustment/preview/','$product_details.pallet','<strong>\x20Regards\x20</strong>','$_id','<div>','$product_details.bin','_id','log','error','$product_details.storage','host','</span>','bay','add_adjustment','role','Email\x20sent\x20successfully','stockBefore','New_Qty_Converted','note','staff','Arabic','catch','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.maxProducts','4816NUNKOe','prod_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Rooms','params','/barcode_scanner','$isAllowEdit','finalize','</head><body>','redirect','rack','$product_details.product_stock','primary_code','3353290clPJmg'];a0_0x20e0=function(){return _0x2feb69;};return a0_0x20e0();}var a0_0x480f66=a0_0x39e4;(function(_0xf10338,_0x5b2f52){var _0xe727fb=a0_0x39e4,_0x492a07=_0xf10338();while(!![]){try{var _0x3625e0=parseInt(_0xe727fb(0x21c))/0x1+-parseInt(_0xe727fb(0x224))/0x2+parseInt(_0xe727fb(0x1b2))/0x3*(-parseInt(_0xe727fb(0x1d1))/0x4)+parseInt(_0xe727fb(0x208))/0x5*(parseInt(_0xe727fb(0x205))/0x6)+parseInt(_0xe727fb(0x225))/0x7*(parseInt(_0xe727fb(0x263))/0x8)+-parseInt(_0xe727fb(0x220))/0x9+-parseInt(_0xe727fb(0x1de))/0xa*(-parseInt(_0xe727fb(0x211))/0xb);if(_0x3625e0===_0x5b2f52)break;else _0x492a07['push'](_0x492a07['shift']());}catch(_0x481702){_0x492a07['push'](_0x492a07['shift']());}}}(a0_0x20e0,0x91b0d));function a0_0x39e4(_0x9e75ef,_0x25509f){var _0x20e085=a0_0x20e0();return a0_0x39e4=function(_0x39e463,_0x50a27c){_0x39e463=_0x39e463-0x192;var _0x3887e5=_0x20e085[_0x39e463];return _0x3887e5;},a0_0x39e4(_0x9e75ef,_0x25509f);}const express=require('express'),app=express(),router=express['Router'](),auth=require(a0_0x480f66(0x202)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0x480f66(0x244)),nodemailer=require(a0_0x480f66(0x23b));router['get'](a0_0x480f66(0x253),auth,async(_0x49645f,_0x500379)=>{var _0x147837=a0_0x480f66;try{const {username:_0x50d7bf,email:_0x5a3f82,role:_0x19a39f}=_0x49645f['user'],_0x548d40=_0x49645f[_0x147837(0x1e3)],_0x2f4799=await profile[_0x147837(0x21a)]({'email':_0x548d40[_0x147837(0x1a1)]}),_0x61cf5b=await master_shop['find']();console[_0x147837(0x1c0)](_0x147837(0x230),_0x61cf5b);let _0x46ee18;if(_0x548d40[_0x147837(0x1c7)]=='staff'){const _0x36e208=await staff[_0x147837(0x21a)]({'email':_0x548d40[_0x147837(0x1a1)]});_0x46ee18=await warehouse[_0x147837(0x20f)]({'status':_0x147837(0x21b),'name':_0x36e208[_0x147837(0x1ea)]});}else _0x46ee18=await warehouse[_0x147837(0x20f)]({'status':_0x147837(0x21b)});const _0x54a8f1=await product[_0x147837(0x20f)]();let _0x294ee1;if(_0x548d40[_0x147837(0x1c7)]==_0x147837(0x1cc)){const _0x324c12=await staff[_0x147837(0x21a)]({'email':_0x548d40[_0x147837(0x1a1)]});_0x294ee1=await adjustment[_0x147837(0x20f)]({'warehouse_name':_0x324c12[_0x147837(0x1ea)]});}else _0x294ee1=await adjustment[_0x147837(0x231)]([{'$unwind':'$product'},{'$group':{'_id':_0x147837(0x1bc),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x147837(0x25d)},'room':{'$addToSet':_0x147837(0x200)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x147837(0x1d7)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x61cf5b[0x0][_0x147837(0x25a)]==_0x147837(0x204)){var _0x413f06=users[_0x147837(0x233)];console[_0x147837(0x1c0)](_0x413f06);}else{if(_0x61cf5b[0x0][_0x147837(0x25a)]==_0x147837(0x206))var _0x413f06=users['Hindi'];else{if(_0x61cf5b[0x0][_0x147837(0x25a)]==_0x147837(0x20e))var _0x413f06=users['German'];else{if(_0x61cf5b[0x0][_0x147837(0x25a)]=='Spanish')var _0x413f06=users[_0x147837(0x1ef)];else{if(_0x61cf5b[0x0][_0x147837(0x25a)]==_0x147837(0x1ff))var _0x413f06=users[_0x147837(0x1ff)];else{if(_0x61cf5b[0x0]['language']=='Portuguese\x20(BR)')var _0x413f06=users[_0x147837(0x236)];else{if(_0x61cf5b[0x0][_0x147837(0x25a)]=='Chinese')var _0x413f06=users[_0x147837(0x240)];else{if(_0x61cf5b[0x0][_0x147837(0x25a)]==_0x147837(0x20a))var _0x413f06=users[_0x147837(0x1cd)];}}}}}}}_0x500379[_0x147837(0x23c)](_0x147837(0x22f),{'success':_0x49645f[_0x147837(0x219)](_0x147837(0x1ad)),'errors':_0x49645f['flash'](_0x147837(0x246)),'role':_0x548d40,'profile':_0x2f4799,'warehouse':_0x46ee18,'product':_0x54a8f1,'adjustment':_0x294ee1,'master_shop':_0x61cf5b,'language':_0x413f06});}catch(_0x31f81b){console['log'](_0x31f81b);}});async function getRandom8DigitNumber(){var _0x514798=a0_0x480f66;const _0x30dbf1=0x989680,_0x3daa60=0x5f5e0ff,_0x3c7c71=Math[_0x514798(0x257)](Math[_0x514798(0x1f3)]()*(_0x3daa60-_0x30dbf1+0x1))+_0x30dbf1;var _0x23168e;const _0x558ddb=await adjustment[_0x514798(0x21a)]({'invoice':_0x514798(0x195)+_0x3c7c71});return _0x558ddb&&_0x558ddb[_0x514798(0x264)]>0x0?_0x23168e='ADJ-'+_0x3c7c71:_0x23168e=_0x514798(0x195)+_0x3c7c71,_0x23168e;}router[a0_0x480f66(0x1e9)]('/view/add_adjustment',auth,async(_0x329d67,_0x1500b3)=>{var _0x25e9ff=a0_0x480f66;try{const {username:_0x435767,email:_0x521c71,role:_0x8e2473}=_0x329d67['user'],_0x2b2593=_0x329d67[_0x25e9ff(0x1e3)],_0x119683=await profile[_0x25e9ff(0x21a)]({'email':_0x2b2593[_0x25e9ff(0x1a1)]}),_0x20a441=await master_shop[_0x25e9ff(0x20f)]();let _0x305d42;if(_0x2b2593[_0x25e9ff(0x1c7)]==_0x25e9ff(0x1cc)){const _0x5d2720=await staff[_0x25e9ff(0x21a)]({'email':_0x2b2593[_0x25e9ff(0x1a1)]});_0x305d42=await warehouse[_0x25e9ff(0x231)]([{'$match':{'status':_0x25e9ff(0x21b),'name':_0x5d2720[_0x25e9ff(0x1ea)],'warehouse_category':_0x25e9ff(0x1fc),'name':{'$ne':_0x25e9ff(0x1fb)}}},{'$group':{'_id':_0x25e9ff(0x1e6),'name':{'$first':_0x25e9ff(0x1e6)}}}]);}else _0x305d42=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x25e9ff(0x1e6),'name':{'$first':_0x25e9ff(0x1e6)}}}]);const _0x125913=await product[_0x25e9ff(0x20f)]({}),_0x359be2=await adjustment['find']({}),_0x17a067=_0x359be2[_0x25e9ff(0x264)]+0x1,_0x16a2a2=_0x25e9ff(0x195)+_0x17a067[_0x25e9ff(0x1fd)]()['padStart'](0x5,'0');var _0xbc6608=['Ambient','Enclosed',_0x25e9ff(0x1a7)];if(_0x20a441[0x0]['language']==_0x25e9ff(0x204))var _0x3f3513=users[_0x25e9ff(0x233)];else{if(_0x20a441[0x0][_0x25e9ff(0x25a)]==_0x25e9ff(0x206))var _0x3f3513=users[_0x25e9ff(0x206)];else{if(_0x20a441[0x0]['language']=='German')var _0x3f3513=users[_0x25e9ff(0x20e)];else{if(_0x20a441[0x0][_0x25e9ff(0x25a)]==_0x25e9ff(0x1ef))var _0x3f3513=users[_0x25e9ff(0x1ef)];else{if(_0x20a441[0x0][_0x25e9ff(0x25a)]=='French')var _0x3f3513=users[_0x25e9ff(0x1ff)];else{if(_0x20a441[0x0]['language']==_0x25e9ff(0x24c))var _0x3f3513=users[_0x25e9ff(0x236)];else{if(_0x20a441[0x0][_0x25e9ff(0x25a)]==_0x25e9ff(0x240))var _0x3f3513=users[_0x25e9ff(0x240)];else{if(_0x20a441[0x0]['language']==_0x25e9ff(0x20a))var _0x3f3513=users['Arabic'];}}}}}}}const _0x5fdaf5=getRandom8DigitNumber();_0x5fdaf5['then'](_0x3006e5=>{var _0x5b5236=_0x25e9ff;_0x1500b3['render'](_0x5b5236(0x1c6),{'success':_0x329d67[_0x5b5236(0x219)](_0x5b5236(0x1ad)),'errors':_0x329d67['flash'](_0x5b5236(0x246)),'role':_0x2b2593,'profile':_0x119683,'warehouse':_0x305d42,'product':_0x125913,'master_shop':_0x20a441,'language':_0x3f3513,'rooms_data':_0xbc6608,'invoice_no':_0x3006e5});})[_0x25e9ff(0x1ce)](_0x433f53=>{var _0x36d5c5=_0x25e9ff;_0x329d67[_0x36d5c5(0x219)](_0x36d5c5(0x246),_0x36d5c5(0x1cf)),_0x1500b3[_0x36d5c5(0x1da)](_0x36d5c5(0x199));});}catch(_0x4dd885){console[_0x25e9ff(0x1c0)](_0x4dd885);}}),router[a0_0x480f66(0x1e4)](a0_0x480f66(0x1e0),auth,async(_0xe2684a,_0x526322)=>{var _0x3f2160=a0_0x480f66;try{const {warehouse_name:_0x48d768,date:_0x1ffdcb,prod_name:_0x5d9332,level:_0x32f3ec,isle:_0x55960d,pallet:_0x3aae67,stock:_0x45ca0a,types:_0x2a27c3,adjust_qty:_0x4eceb6,new_adjust_qty:_0x2f5319,note:_0x2cd392,Room_name:_0x2165d3,invoice:_0x48ebfc,JO_number:_0x3e30c8,expiry_date:_0x3fb6e0}=_0xe2684a['body'];if(typeof _0x5d9332==_0x3f2160(0x20c))var _0xd90eb6=[_0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x255)]],_0xaeee5e=[_0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x19c)]],_0xc4d2c1=[_0xe2684a['body'][_0x3f2160(0x196)]],_0x2cc434=[_0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x235)]],_0x29d148=[_0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x237)]],_0x2622af=[_0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x1ca)]],_0x351020=[_0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x1f7)]],_0x40d5f1=[_0xe2684a[_0x3f2160(0x24a)]['Secondary_units']],_0x3667df=[_0xe2684a['body'][_0x3f2160(0x22e)]],_0x1779b1=[_0xe2684a['body'][_0x3f2160(0x1fe)]],_0xbc951a=[_0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x1eb)]],_0x8e3acc=[_0xe2684a['body'][_0x3f2160(0x1a6)]],_0x389853=[_0xe2684a[_0x3f2160(0x24a)]['production_date']],_0x5d246c=[_0xe2684a[_0x3f2160(0x24a)]['prod_cat']],_0x22723b=[_0xe2684a['body'][_0x3f2160(0x1d4)]],_0xd1c4eb=[_0xe2684a['body'][_0x3f2160(0x239)]],_0xaea626=[_0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x1e5)]],_0x42bea3=[_0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x1d2)]],_0x41d347=[_0xe2684a['body'][_0x3f2160(0x221)]];else var _0xd90eb6=[..._0xe2684a['body'][_0x3f2160(0x255)]],_0xaeee5e=[..._0xe2684a['body'][_0x3f2160(0x19c)]],_0xc4d2c1=[..._0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x196)]],_0x2cc434=[..._0xe2684a[_0x3f2160(0x24a)]['types']],_0x29d148=[..._0xe2684a['body'][_0x3f2160(0x237)]],_0x2622af=[..._0xe2684a['body'][_0x3f2160(0x1ca)]],_0x351020=[..._0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x193)]],_0x40d5f1=[..._0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x214)]],_0x3667df=[..._0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x22e)]],_0x1779b1=[..._0xe2684a[_0x3f2160(0x24a)]['batch_code']],_0xbc951a=[..._0xe2684a['body'][_0x3f2160(0x1eb)]],_0x8e3acc=[..._0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x1a6)]],_0x389853=[..._0xe2684a['body'][_0x3f2160(0x1e1)]],_0x5d246c=[..._0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x1f1)]],_0x22723b=[..._0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x1d4)]],_0xd1c4eb=[..._0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x239)]],_0xaea626=[..._0xe2684a[_0x3f2160(0x24a)][_0x3f2160(0x1e5)]],_0x42bea3=[..._0xe2684a[_0x3f2160(0x24a)]['prod_invoice']],_0x41d347=[..._0xe2684a['body'][_0x3f2160(0x221)]];const _0xfa8a8f=_0xd90eb6[_0x3f2160(0x241)](_0x3b11e5=>{return _0x3b11e5={'product_name':_0x3b11e5};});_0xaeee5e[_0x3f2160(0x20d)]((_0x4fb4d8,_0x3845e6)=>{_0x22723b['forEach']((_0x1b3497,_0x5210ae)=>{var _0x549965=a0_0x39e4;if(_0x1b3497==_0x549965(0x25b)&&_0x3845e6==_0x5210ae){var _0x42ef51=_0x4fb4d8[_0x549965(0x254)](0x3);_0xfa8a8f[_0x3845e6][_0x549965(0x19d)]=_0x4fb4d8[0x0],_0xfa8a8f[_0x3845e6][_0x549965(0x1db)]=_0x4fb4d8[0x1],_0xfa8a8f[_0x3845e6][_0x549965(0x1c5)]=0x0,_0xfa8a8f[_0x3845e6][_0x549965(0x256)]=0x0,_0xfa8a8f[_0x3845e6][_0x549965(0x248)]=_0x549965(0x1b3),_0xfa8a8f[_0x3845e6][_0x549965(0x19f)]=_0x42ef51;}else{if(_0x1b3497=='Shelves'&&_0x3845e6==_0x5210ae){var _0x42ef51=_0x4fb4d8[_0x549965(0x254)](0x3);_0xfa8a8f[_0x3845e6][_0x549965(0x19d)]=_0x4fb4d8[0x0],_0xfa8a8f[_0x3845e6][_0x549965(0x1db)]=_0x4fb4d8[0x1],_0xfa8a8f[_0x3845e6][_0x549965(0x1c5)]=0x0,_0xfa8a8f[_0x3845e6][_0x549965(0x256)]=0x0,_0xfa8a8f[_0x3845e6][_0x549965(0x248)]=_0x549965(0x1b3),_0xfa8a8f[_0x3845e6]['floorlevel']=_0x4fb4d8[0x5];}else{if(_0x3845e6==_0x5210ae){var _0x2affbb;if(_0x4fb4d8[0x4]=='L')_0x2affbb=_0x549965(0x24b);else _0x4fb4d8[0x4]=='F'&&(_0x2affbb=_0x549965(0x1b3));_0xfa8a8f[_0x3845e6][_0x549965(0x19d)]=_0x4fb4d8[0x0],_0xfa8a8f[_0x3845e6][_0x549965(0x1db)]=_0x4fb4d8[0x1],_0xfa8a8f[_0x3845e6][_0x549965(0x1c5)]=_0x4fb4d8[0x2],_0xfa8a8f[_0x3845e6][_0x549965(0x256)]=_0x4fb4d8[0x3],_0xfa8a8f[_0x3845e6][_0x549965(0x248)]=_0x2affbb,_0xfa8a8f[_0x3845e6]['floorlevel']=_0x4fb4d8[0x5];}}}});}),_0xc4d2c1[_0x3f2160(0x20d)]((_0x248f9c,_0x28c3e4)=>{var _0x246f98=_0x3f2160;_0xfa8a8f[_0x28c3e4][_0x246f98(0x1c9)]=_0x248f9c;}),_0x41d347[_0x3f2160(0x20d)]((_0x450ec1,_0x52e736)=>{_0xfa8a8f[_0x52e736]['id_transaction_from']=_0x450ec1;}),_0x2cc434['forEach']((_0x320bf9,_0x174d16)=>{var _0x3c8b11=_0x3f2160;_0xfa8a8f[_0x174d16][_0x3c8b11(0x235)]=_0x320bf9;}),_0x29d148[_0x3f2160(0x20d)]((_0x55423a,_0xc8a4e4)=>{var _0x36ca07=_0x3f2160;_0xfa8a8f[_0xc8a4e4][_0x36ca07(0x250)]=_0x55423a;}),_0x2622af['forEach']((_0x4f3dc0,_0x3b6712)=>{var _0x4e67df=_0x3f2160;_0xfa8a8f[_0x3b6712][_0x4e67df(0x232)]=_0x4f3dc0;}),_0x351020[_0x3f2160(0x20d)]((_0x57039f,_0x20a6b7)=>{_0xfa8a8f[_0x20a6b7]['unit']=_0x57039f;}),_0x40d5f1['forEach']((_0x43d7a3,_0x32ec86)=>{_0xfa8a8f[_0x32ec86]['secondary_unit']=_0x43d7a3;}),_0x3667df[_0x3f2160(0x20d)]((_0x56c7d3,_0x44cc62)=>{var _0x30a33d=_0x3f2160;_0xfa8a8f[_0x44cc62][_0x30a33d(0x1f9)]=_0x56c7d3;}),_0x1779b1[_0x3f2160(0x20d)]((_0x4eaf55,_0x2d6319)=>{_0xfa8a8f[_0x2d6319]['batch_code']=_0x4eaf55;}),_0xbc951a[_0x3f2160(0x20d)]((_0x280e71,_0x40112a)=>{var _0xa2aa71=_0x3f2160;_0xfa8a8f[_0x40112a][_0xa2aa71(0x1eb)]=_0x280e71;}),_0x8e3acc['forEach']((_0x125a42,_0x17bc84)=>{_0xfa8a8f[_0x17bc84]['maxperunit']=_0x125a42;}),_0x389853['forEach']((_0x1e2905,_0x298319)=>{var _0x1d3cd4=_0x3f2160;_0xfa8a8f[_0x298319][_0x1d3cd4(0x1e1)]=_0x1e2905;}),_0x5d246c[_0x3f2160(0x20d)]((_0x6820ce,_0x5a0cc0)=>{var _0x5c91ae=_0x3f2160;_0xfa8a8f[_0x5a0cc0][_0x5c91ae(0x1f1)]=_0x6820ce;}),_0x22723b[_0x3f2160(0x20d)]((_0x62cf4e,_0x5bb16e)=>{var _0x24d46e=_0x3f2160;_0xfa8a8f[_0x5bb16e][_0x24d46e(0x25e)]=_0x62cf4e;}),_0xd1c4eb[_0x3f2160(0x20d)]((_0xa295c8,_0x5bcc21)=>{var _0x24d05a=_0x3f2160;_0xfa8a8f[_0x5bcc21][_0x24d05a(0x1dd)]=_0xa295c8;}),_0xaea626[_0x3f2160(0x20d)]((_0x40096e,_0x29e092)=>{var _0x2196d8=_0x3f2160;_0xfa8a8f[_0x29e092][_0x2196d8(0x1e8)]=_0x40096e;}),_0x42bea3[_0x3f2160(0x20d)]((_0x314424,_0x46d703)=>{var _0x347a8b=_0x3f2160;_0xfa8a8f[_0x46d703][_0x347a8b(0x197)]=_0x314424;});const _0x3f43e6=_0xfa8a8f['filter'](_0x55469d=>_0x55469d[_0x3f2160(0x250)]!=='0'&&_0x55469d['adjust_qty']!=='');var _0x2361c9=0x0;_0x3f43e6[_0x3f2160(0x20d)](_0x344830=>{var _0x8e072f=_0x3f2160;console[_0x8e072f(0x1c0)](_0x8e072f(0x217),_0x344830),parseInt(_0x344830[_0x8e072f(0x250)])<=0x0&&_0x2361c9++;});if(_0x2361c9!=0x0)return _0xe2684a[_0x3f2160(0x219)]('errors',_0x3f2160(0x234)),_0x526322['redirect'](_0x3f2160(0x262));const _0x5bd324=new adjustment({'warehouse_name':_0x48d768,'date':_0x1ffdcb,'product':_0x3f43e6,'note':_0x2cd392,'room':_0x2165d3,'invoice':_0x48ebfc,'JO_number':_0x3e30c8,'expiry_date':_0x3fb6e0}),_0x545739=await _0x5bd324[_0x3f2160(0x1b5)]();_0xe2684a['flash'](_0x3f2160(0x1ad),_0x3f2160(0x226)),_0x526322[_0x3f2160(0x1da)](_0x3f2160(0x1b9)+_0x545739['_id']);}catch(_0x13f8f2){console[_0x3f2160(0x1c0)](_0x13f8f2),_0x526322['status'](0xc8)[_0x3f2160(0x24e)]({'message':_0x13f8f2[_0x3f2160(0x25c)]});}}),router['get'](a0_0x480f66(0x1b7),auth,async(_0x19b71c,_0x2c5703)=>{var _0x205741=a0_0x480f66;try{const {username:_0x598b7b,email:_0x3267db,role:_0x66ba3c}=_0x19b71c[_0x205741(0x1e3)],_0x26eca8=_0x19b71c['user'],_0x4bd1bd=await profile[_0x205741(0x21a)]({'email':_0x26eca8[_0x205741(0x1a1)]}),_0x44db2c=await master_shop[_0x205741(0x20f)](),_0x2aa0dc=_0x19b71c[_0x205741(0x1d5)]['id'],_0x36f091=await adjustment['findById']({'_id':_0x2aa0dc}),_0x559331=await purchases[_0x205741(0x231)]([{'$match':{'warehouse_name':_0x36f091[_0x205741(0x1b4)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x3c192b=await product[_0x205741(0x20f)]({}),_0x429d14=await warehouse[_0x205741(0x231)]([{'$match':{'name':_0x36f091['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x205741(0x24d),'name':{'$first':_0x205741(0x19b)},'product_stock':{'$first':_0x205741(0x1dc)},'bay':{'$first':_0x205741(0x223)},'bin':{'$first':_0x205741(0x1be)},'type':{'$first':_0x205741(0x23a)},'floorlevel':{'$first':_0x205741(0x22a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x205741(0x21f)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x205741(0x1c2)},'rack':{'$first':_0x205741(0x1a5)},'maxPerUnit':{'$first':_0x205741(0x1af)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);if(_0x44db2c[0x0][_0x205741(0x25a)]==_0x205741(0x204)){var _0x1b0003=users[_0x205741(0x233)];console[_0x205741(0x1c0)](_0x1b0003);}else{if(_0x44db2c[0x0][_0x205741(0x25a)]==_0x205741(0x206))var _0x1b0003=users[_0x205741(0x206)];else{if(_0x44db2c[0x0][_0x205741(0x25a)]==_0x205741(0x20e))var _0x1b0003=users[_0x205741(0x20e)];else{if(_0x44db2c[0x0][_0x205741(0x25a)]==_0x205741(0x1ef))var _0x1b0003=users[_0x205741(0x1ef)];else{if(_0x44db2c[0x0]['language']==_0x205741(0x1ff))var _0x1b0003=users['French'];else{if(_0x44db2c[0x0][_0x205741(0x25a)]==_0x205741(0x24c))var _0x1b0003=users['Portuguese'];else{if(_0x44db2c[0x0]['language']=='Chinese')var _0x1b0003=users[_0x205741(0x240)];else{if(_0x44db2c[0x0][_0x205741(0x25a)]==_0x205741(0x20a))var _0x1b0003=users[_0x205741(0x1cd)];}}}}}}}_0x2c5703[_0x205741(0x23c)](_0x205741(0x229),{'success':_0x19b71c[_0x205741(0x219)](_0x205741(0x1ad)),'errors':_0x19b71c[_0x205741(0x219)](_0x205741(0x246)),'role':_0x26eca8,'profile':_0x4bd1bd,'adjustment':_0x36f091,'stock':_0x429d14,'master_shop':_0x44db2c,'warehouse_name':_0x559331,'unit':_0x3c192b,'language':_0x1b0003});}catch(_0x29168a){console[_0x205741(0x1c0)](_0x29168a),_0x2c5703[_0x205741(0x265)](0xc8)['json']({'message':_0x29168a[_0x205741(0x25c)]});}}),router[a0_0x480f66(0x1e4)](a0_0x480f66(0x1b7),auth,async(_0xd55115,_0x405260)=>{var _0x5e16ce=a0_0x480f66;try{const _0x3714f6=_0xd55115[_0x5e16ce(0x1d5)]['id'],{warehouse_name:_0x50ce76,Room_name:_0x7c88a8}=_0xd55115[_0x5e16ce(0x24a)],_0x3780ef=await adjustment[_0x5e16ce(0x1e7)]({'_id':_0x3714f6}),_0x374b8b=_0x3780ef['product'][_0x5e16ce(0x241)](async _0xb18964=>{var _0x190f2c=_0x5e16ce;if(_0xb18964['adjust_qty']>0x0){var _0x59b833=await warehouse[_0x190f2c(0x21a)]({'name':_0x50ce76,'room':_0xb18964[_0x190f2c(0x25e)],'warehouse_category':'Raw\x20Materials'});const _0x29cc72=_0x59b833[_0x190f2c(0x1a3)][_0x190f2c(0x241)](_0x13cfc7=>{var _0x12c9e6=_0x190f2c;console[_0x12c9e6(0x1c0)](_0xb18964[_0x12c9e6(0x235)]+_0x12c9e6(0x212));if(_0xb18964[_0x12c9e6(0x235)]=='minus'){if(_0x13cfc7[_0x12c9e6(0x1df)]==_0xb18964[_0x12c9e6(0x1df)]&&_0x13cfc7[_0x12c9e6(0x19f)]==_0xb18964[_0x12c9e6(0x19f)]&&_0x13cfc7[_0x12c9e6(0x248)]==_0xb18964['type']&&_0x13cfc7[_0x12c9e6(0x256)]==_0xb18964[_0x12c9e6(0x256)]&&_0x13cfc7[_0x12c9e6(0x1c5)]==_0xb18964[_0x12c9e6(0x1c5)]&&_0x13cfc7[_0x12c9e6(0x1db)]==_0xb18964['rack']&&_0x13cfc7[_0x12c9e6(0x19d)]==_0xb18964[_0x12c9e6(0x19d)]&&_0x13cfc7['expiry_date']==_0xb18964[_0x12c9e6(0x1eb)]&&_0x13cfc7[_0x12c9e6(0x1fe)]==_0xb18964['batch_code']&&_0x13cfc7['production_date']==_0xb18964[_0x12c9e6(0x1e1)]&&_0x13cfc7[_0x12c9e6(0x197)]==_0xb18964['invoice']&&_0x13cfc7[_0x12c9e6(0x1bf)]==_0xb18964['id_transaction_from']){var _0x5b5c25;_0x5b5c25=_0xb18964[_0x12c9e6(0x250)],_0xb18964[_0x12c9e6(0x1f1)]=='S'&&(_0x5b5c25=_0xb18964[_0x12c9e6(0x250)]),_0x13cfc7['product_stock']=_0x13cfc7[_0x12c9e6(0x228)]-_0x5b5c25;}}else{if(_0x13cfc7[_0x12c9e6(0x1df)]==_0xb18964[_0x12c9e6(0x1df)]&&_0x13cfc7[_0x12c9e6(0x19f)]==_0xb18964[_0x12c9e6(0x19f)]&&_0x13cfc7[_0x12c9e6(0x248)]==_0xb18964[_0x12c9e6(0x248)]&&_0x13cfc7[_0x12c9e6(0x256)]==_0xb18964[_0x12c9e6(0x256)]&&_0x13cfc7[_0x12c9e6(0x1c5)]==_0xb18964[_0x12c9e6(0x1c5)]&&_0x13cfc7[_0x12c9e6(0x1db)]==_0xb18964['rack']&&_0x13cfc7[_0x12c9e6(0x19d)]==_0xb18964[_0x12c9e6(0x19d)]&&_0x13cfc7[_0x12c9e6(0x1eb)]==_0xb18964[_0x12c9e6(0x1eb)]&&_0x13cfc7['batch_code']==_0xb18964['batch_code']&&_0x13cfc7[_0x12c9e6(0x1e1)]==_0xb18964[_0x12c9e6(0x1e1)]&&_0x13cfc7[_0x12c9e6(0x197)]==_0xb18964[_0x12c9e6(0x197)]&&_0x13cfc7[_0x12c9e6(0x1bf)]==_0xb18964[_0x12c9e6(0x259)]){console[_0x12c9e6(0x1c0)](_0xb18964);var _0x5b5c25;_0x5b5c25=_0xb18964['adjust_qty'],_0xb18964[_0x12c9e6(0x1f1)]=='S'&&(_0x5b5c25=_0xb18964[_0x12c9e6(0x250)]),_0x13cfc7[_0x12c9e6(0x228)]=_0x13cfc7[_0x12c9e6(0x228)]+_0x5b5c25;}}});}return _0x59b833;});Promise[_0x5e16ce(0x209)](_0x374b8b)['then'](async _0x5a9e75=>{var _0x3b63d5=_0x5e16ce;try{for(const _0x1c4e83 of _0x5a9e75){await _0x1c4e83[_0x3b63d5(0x1b5)]();}_0x3780ef[_0x3b63d5(0x1d8)]='True';const _0x3782fd=await _0x3780ef[_0x3b63d5(0x1b5)](),_0x5241ef=await master_shop['find'](),_0x47e502=await email_settings[_0x3b63d5(0x21a)](),_0x1f0160=await supervisor_settings[_0x3b63d5(0x20f)]();var _0x2589f3=_0x3780ef[_0x3b63d5(0x21d)],_0xc0a523='',_0x32b8f7;for(_0x32b8f7 in _0x2589f3){_0xc0a523+=_0x3b63d5(0x23e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2589f3[_0x32b8f7][_0x3b63d5(0x1df)]+_0x3b63d5(0x245)+_0x3b63d5(0x1ac)+_0x2589f3[_0x32b8f7][_0x3b63d5(0x1f9)]+_0x3b63d5(0x245)+_0x3b63d5(0x1ac)+_0x2589f3[_0x32b8f7][_0x3b63d5(0x250)]+_0x3b63d5(0x245)+_0x3b63d5(0x1ac)+_0x2589f3[_0x32b8f7][_0x3b63d5(0x193)]+'</td>'+_0x3b63d5(0x1ac)+_0x2589f3[_0x32b8f7][_0x3b63d5(0x1f6)]+_0x3b63d5(0x245)+_0x3b63d5(0x1ac)+_0x3780ef[_0x3b63d5(0x1b4)]+_0x3b63d5(0x245)+_0x3b63d5(0x1ac)+_0x2589f3[_0x32b8f7]['room_names']+_0x3b63d5(0x245)+_0x3b63d5(0x1ac)+_0x2589f3[_0x32b8f7][_0x3b63d5(0x19d)]+_0x2589f3[_0x32b8f7][_0x3b63d5(0x1db)]+_0x2589f3[_0x32b8f7][_0x3b63d5(0x1c5)]+_0x2589f3[_0x32b8f7]['bin']+_0x2589f3[_0x32b8f7]['type'][0x0]+_0x2589f3[_0x32b8f7][_0x3b63d5(0x19f)]+_0x3b63d5(0x245),_0x3b63d5(0x1ee);}let _0x32b602=nodemailer['createTransport']({'host':_0x47e502[_0x3b63d5(0x1c3)],'port':Number(_0x47e502[_0x3b63d5(0x210)]),'secure':![],'auth':{'user':_0x47e502['email'],'pass':_0x47e502[_0x3b63d5(0x203)]}}),_0x2fe295={'from':_0x47e502[_0x3b63d5(0x1a1)],'to':_0x1f0160[0x0][_0x3b63d5(0x1a0)],'subject':'Adjustment\x20Mail','attachments':[{'filename':_0x3b63d5(0x260),'path':__dirname+_0x3b63d5(0x215)+'/upload/'+_0x5241ef[0x0][_0x3b63d5(0x1f4)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x3b63d5(0x1a8)+_0x3b63d5(0x1d9)+_0x3b63d5(0x1bd)+_0x3b63d5(0x252)+_0x3b63d5(0x1bd)+_0x3b63d5(0x22d)+_0x3b63d5(0x25f)+'<div>'+_0x3b63d5(0x194)+_0x5241ef[0x0]['site_title']+_0x3b63d5(0x1f2)+'</div>'+_0x3b63d5(0x25f)+'<hr\x20class=\x22my-3\x22>'+_0x3b63d5(0x1bd)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x3b63d5(0x1a9)+_0x3780ef[_0x3b63d5(0x197)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x3780ef['date']+'\x20'+_0x3b63d5(0x1c4)+_0x3b63d5(0x1b8)+_0x3b63d5(0x25f)+_0x3b63d5(0x1a4)+_0x3b63d5(0x243)+_0x3b63d5(0x23e)+_0x3b63d5(0x238)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x3b63d5(0x222)+_0x3b63d5(0x1d3)+_0x3b63d5(0x242)+_0x3b63d5(0x1b0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x3b63d5(0x1b1)+'</tr>'+_0x3b63d5(0x1fa)+_0x3b63d5(0x198)+'\x20'+_0xc0a523+'\x20'+_0x3b63d5(0x201)+_0x3b63d5(0x261)+_0x3b63d5(0x1bd)+_0x3b63d5(0x1bb)+'<h5>'+_0x5241ef[0x0][_0x3b63d5(0x207)]+'</h5>'+'</div>'+_0x3b63d5(0x25f)+_0x3b63d5(0x258)};_0x32b602['sendMail'](_0x2fe295,function(_0x154074,_0x3e6cb6){var _0x13c4bd=_0x3b63d5;_0x154074?(console['log'](_0x154074),console[_0x13c4bd(0x1c0)]('Error\x20Occurs')):console[_0x13c4bd(0x1c0)](_0x13c4bd(0x1c8));}),_0xd55115[_0x3b63d5(0x219)]('success',_0x3b63d5(0x251)),_0x405260[_0x3b63d5(0x1da)]('/picking_list/PDF_adjustment_rm/'+_0x3782fd['_id']);}catch(_0x2413c3){console[_0x3b63d5(0x1c1)](_0x2413c3),_0x405260[_0x3b63d5(0x265)](0x1f4)[_0x3b63d5(0x24e)]({'error':_0x3b63d5(0x19a)});}})[_0x5e16ce(0x1ce)](_0x3a6af5=>{var _0x16e056=_0x5e16ce;console[_0x16e056(0x1c1)](_0x3a6af5),_0x405260['status'](0x1f4)[_0x16e056(0x24e)]({'error':_0x16e056(0x1a2)});});}catch(_0x4cefdf){console[_0x5e16ce(0x1c0)](_0x4cefdf),_0x405260[_0x5e16ce(0x265)](0xc8)[_0x5e16ce(0x24e)]({'message':_0x4cefdf[_0x5e16ce(0x25c)]});}}),router[a0_0x480f66(0x1e9)]('/view/:id',auth,async(_0xd6816e,_0x3ef36d)=>{var _0x544beb=a0_0x480f66;try{const {username:_0x318cfc,email:_0x8f0bec,role:_0x202742}=_0xd6816e[_0x544beb(0x1e3)],_0xc83427=_0xd6816e[_0x544beb(0x1e3)],_0x276aa8=await profile['findOne']({'email':_0xc83427['email']}),_0x3495fc=await master_shop['find'](),_0x289aa0=_0xd6816e[_0x544beb(0x1d5)]['id'],_0x21d40e=await adjustment[_0x544beb(0x1e7)]({'_id':_0x289aa0}),_0x5c09ca=await purchases[_0x544beb(0x231)]([{'$match':{'warehouse_name':_0x21d40e[_0x544beb(0x1b4)]}},{'$unwind':_0x544beb(0x23d)},{'$group':{'_id':_0x544beb(0x213)}}]),_0x16865=await product[_0x544beb(0x20f)]({}),_0x7964c3=await warehouse[_0x544beb(0x231)]([{'$match':{'name':_0x21d40e[_0x544beb(0x1b4)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x544beb(0x24d),'name':{'$first':_0x544beb(0x19b)},'product_stock':{'$first':_0x544beb(0x1dc)},'bay':{'$first':_0x544beb(0x223)},'bin':{'$first':_0x544beb(0x1be)},'type':{'$first':_0x544beb(0x23a)},'floorlevel':{'$first':_0x544beb(0x22a)},'primary_code':{'$first':_0x544beb(0x249)},'secondary_code':{'$first':_0x544beb(0x21f)},'product_code':{'$first':_0x544beb(0x216)},'storage':{'$first':_0x544beb(0x1c2)},'rack':{'$first':_0x544beb(0x1a5)},'maxPerUnit':{'$first':_0x544beb(0x1af)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x544beb(0x1f5)},'batch_code':{'$first':_0x544beb(0x22b)},'room':{'$first':_0x544beb(0x218)}}}]);let _0x52e510;if(_0xc83427[_0x544beb(0x1c7)]==_0x544beb(0x1cc)){const _0x143345=await staff[_0x544beb(0x21a)]({'email':_0xc83427[_0x544beb(0x1a1)]});_0x52e510=await warehouse['aggregate']([{'$match':{'status':_0x544beb(0x21b),'name':_0x143345['warehouse'],'warehouse_category':_0x544beb(0x1fc),'name':{'$ne':_0x544beb(0x1fb)}}},{'$group':{'_id':_0x544beb(0x1e6),'name':{'$first':_0x544beb(0x1e6)}}}]);}else _0x52e510=await warehouse[_0x544beb(0x231)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':_0x544beb(0x1fb)}}},{'$group':{'_id':_0x544beb(0x1e6),'name':{'$first':_0x544beb(0x1e6)}}}]);if(_0x3495fc[0x0][_0x544beb(0x25a)]=='English\x20(US)'){var _0x44b15d=users['English'];console[_0x544beb(0x1c0)](_0x44b15d);}else{if(_0x3495fc[0x0]['language']=='Hindi')var _0x44b15d=users[_0x544beb(0x206)];else{if(_0x3495fc[0x0][_0x544beb(0x25a)]==_0x544beb(0x20e))var _0x44b15d=users[_0x544beb(0x20e)];else{if(_0x3495fc[0x0][_0x544beb(0x25a)]==_0x544beb(0x1ef))var _0x44b15d=users['Spanish'];else{if(_0x3495fc[0x0][_0x544beb(0x25a)]==_0x544beb(0x1ff))var _0x44b15d=users[_0x544beb(0x1ff)];else{if(_0x3495fc[0x0]['language']==_0x544beb(0x24c))var _0x44b15d=users['Portuguese'];else{if(_0x3495fc[0x0][_0x544beb(0x25a)]==_0x544beb(0x240))var _0x44b15d=users[_0x544beb(0x240)];else{if(_0x3495fc[0x0][_0x544beb(0x25a)]==_0x544beb(0x20a))var _0x44b15d=users[_0x544beb(0x1cd)];}}}}}}}_0x3ef36d[_0x544beb(0x23c)](_0x544beb(0x1ab),{'success':_0xd6816e[_0x544beb(0x219)](_0x544beb(0x1ad)),'errors':_0xd6816e[_0x544beb(0x219)]('errors'),'role':_0xc83427,'profile':_0x276aa8,'adjustment':_0x21d40e,'stock':_0x7964c3,'master_shop':_0x3495fc,'warehouse_name':_0x5c09ca,'unit':_0x16865,'language':_0x44b15d,'warehouse':_0x52e510});}catch(_0x382774){console['log'](_0x382774),_0x3ef36d['status'](0xc8)['json']({'message':_0x382774[_0x544beb(0x25c)]});}}),router[a0_0x480f66(0x1e4)]('/view/:id',auth,async(_0xc12cde,_0xd3cf52)=>{var _0x424559=a0_0x480f66;try{const _0x4be303=_0xc12cde[_0x424559(0x1d5)]['id'],_0x52d302=await adjustment[_0x424559(0x1e7)]({'_id':_0x4be303}),_0x391916=await warehouse[_0x424559(0x21a)]({'name':_0x52d302[_0x424559(0x1b4)],'room':_0x52d302[_0x424559(0x19e)]}),{warehouse_name:_0x172c7d,date:_0x5548d3,prod_name:_0x417baf,level:_0x17b5de,isle:_0x5ebb00,pallet:_0xee240d,stock:_0x1b1dd1,types:_0x58f93,adjust_qty:_0x5904e3,new_adjust_qty:_0x4a4d73,note:_0x4d301a,Room_name:_0x3d4e19,invoice:_0x34b65f,JO_number:_0xb2bb9a,expiry_date:_0x3b8b7f}=_0xc12cde[_0x424559(0x24a)];if(typeof _0x417baf==_0x424559(0x20c))var _0x3f8646=[_0xc12cde[_0x424559(0x24a)][_0x424559(0x255)]],_0x50d99d=[_0xc12cde[_0x424559(0x24a)][_0x424559(0x19c)]],_0x30b8c4=[_0xc12cde['body'][_0x424559(0x196)]],_0x1b70d6=[_0xc12cde[_0x424559(0x24a)][_0x424559(0x235)]],_0x12d5f0=[_0xc12cde['body'][_0x424559(0x237)]],_0x37b13e=[_0xc12cde[_0x424559(0x24a)][_0x424559(0x1ca)]],_0x145c04=[_0xc12cde[_0x424559(0x24a)]['Primary_Units']],_0x21fba5=[_0xc12cde[_0x424559(0x24a)][_0x424559(0x214)]],_0xd42c61=[_0xc12cde[_0x424559(0x24a)][_0x424559(0x22e)]],_0x4ae4ab=[_0xc12cde['body'][_0x424559(0x1fe)]],_0x7b7ff2=[_0xc12cde['body']['expiry_date']],_0x5e83d9=[_0xc12cde[_0x424559(0x24a)][_0x424559(0x1a6)]],_0x1b3a78=[_0xc12cde[_0x424559(0x24a)][_0x424559(0x1e1)]],_0x46dc3b=[_0xc12cde[_0x424559(0x24a)][_0x424559(0x1f1)]],_0x396594=[_0xc12cde['body'][_0x424559(0x1d4)]],_0x32e8ad=[_0xc12cde[_0x424559(0x24a)]['prime1']],_0x10242e=[_0xc12cde[_0x424559(0x24a)]['second1']];else var _0x3f8646=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x255)]],_0x50d99d=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x19c)]],_0x30b8c4=[..._0xc12cde['body'][_0x424559(0x196)]],_0x1b70d6=[..._0xc12cde[_0x424559(0x24a)]['types']],_0x12d5f0=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x237)]],_0x37b13e=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x1ca)]],_0x145c04=[..._0xc12cde['body'][_0x424559(0x193)]],_0x21fba5=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x214)]],_0xd42c61=[..._0xc12cde[_0x424559(0x24a)]['prod_code']],_0x4ae4ab=[..._0xc12cde[_0x424559(0x24a)]['batch_code']],_0x7b7ff2=[..._0xc12cde[_0x424559(0x24a)]['expiry_date']],_0x5e83d9=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x1a6)]],_0x1b3a78=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x1e1)]],_0x46dc3b=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x1f1)]],_0x396594=[..._0xc12cde[_0x424559(0x24a)]['Rooms']],_0x32e8ad=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x239)]],_0x10242e=[..._0xc12cde[_0x424559(0x24a)][_0x424559(0x1e5)]];const _0x5b2731=_0x3f8646['map'](_0x5746a5=>{return _0x5746a5={'product_name':_0x5746a5};});_0x50d99d[_0x424559(0x20d)]((_0x54609f,_0x1c24c9)=>{var _0x3b26fc=_0x424559;_0x396594[_0x3b26fc(0x20d)]((_0x2f1188,_0x1317a3)=>{var _0x3e9c2a=_0x3b26fc;if(_0x2f1188==_0x3e9c2a(0x25b)&&_0x1c24c9==_0x1317a3){var _0x734103=_0x54609f[_0x3e9c2a(0x254)](0x3);_0x5b2731[_0x1c24c9][_0x3e9c2a(0x19d)]=_0x54609f[0x0],_0x5b2731[_0x1c24c9]['rack']=_0x54609f[0x1],_0x5b2731[_0x1c24c9][_0x3e9c2a(0x1c5)]=0x0,_0x5b2731[_0x1c24c9][_0x3e9c2a(0x256)]=0x0,_0x5b2731[_0x1c24c9][_0x3e9c2a(0x248)]=_0x3e9c2a(0x1b3),_0x5b2731[_0x1c24c9][_0x3e9c2a(0x19f)]=_0x734103;}else{if(_0x2f1188=='Shelves'&&_0x1c24c9==_0x1317a3){var _0x734103=_0x54609f[_0x3e9c2a(0x254)](0x3);_0x5b2731[_0x1c24c9][_0x3e9c2a(0x19d)]=_0x54609f[0x0],_0x5b2731[_0x1c24c9]['rack']=_0x54609f[0x1],_0x5b2731[_0x1c24c9][_0x3e9c2a(0x1c5)]=0x0,_0x5b2731[_0x1c24c9][_0x3e9c2a(0x256)]=0x0,_0x5b2731[_0x1c24c9][_0x3e9c2a(0x248)]=_0x3e9c2a(0x1b3),_0x5b2731[_0x1c24c9][_0x3e9c2a(0x19f)]=_0x54609f[0x5];}else{if(_0x1c24c9==_0x1317a3){var _0x256762;if(_0x54609f[0x4]=='L')_0x256762='Level';else _0x54609f[0x4]=='F'&&(_0x256762=_0x3e9c2a(0x1b3));_0x5b2731[_0x1c24c9][_0x3e9c2a(0x19d)]=_0x54609f[0x0],_0x5b2731[_0x1c24c9][_0x3e9c2a(0x1db)]=_0x54609f[0x1],_0x5b2731[_0x1c24c9][_0x3e9c2a(0x1c5)]=_0x54609f[0x2],_0x5b2731[_0x1c24c9][_0x3e9c2a(0x256)]=_0x54609f[0x3],_0x5b2731[_0x1c24c9][_0x3e9c2a(0x248)]=_0x256762,_0x5b2731[_0x1c24c9][_0x3e9c2a(0x19f)]=_0x54609f[0x5];}}}});}),_0x30b8c4[_0x424559(0x20d)]((_0x24424e,_0x28c3a9)=>{var _0x150471=_0x424559;_0x5b2731[_0x28c3a9][_0x150471(0x1c9)]=_0x24424e;}),_0x1b70d6[_0x424559(0x20d)]((_0x2ee0a7,_0x3801dd)=>{var _0x179ed9=_0x424559;_0x5b2731[_0x3801dd][_0x179ed9(0x235)]=_0x2ee0a7;}),_0x12d5f0[_0x424559(0x20d)]((_0x9fedf5,_0x348380)=>{var _0x2847b8=_0x424559;_0x5b2731[_0x348380][_0x2847b8(0x250)]=_0x9fedf5;}),_0x37b13e['forEach']((_0x41551d,_0x11a02f)=>{var _0x57a025=_0x424559;_0x5b2731[_0x11a02f][_0x57a025(0x232)]=_0x41551d;}),_0x145c04[_0x424559(0x20d)]((_0x5ac022,_0x1a6016)=>{var _0x46beef=_0x424559;_0x5b2731[_0x1a6016][_0x46beef(0x193)]=_0x5ac022;}),_0x21fba5['forEach']((_0x1242ab,_0xa6e7c3)=>{_0x5b2731[_0xa6e7c3]['secondary_unit']=_0x1242ab;}),_0xd42c61['forEach']((_0x159917,_0x340f4b)=>{var _0x236c12=_0x424559;_0x5b2731[_0x340f4b][_0x236c12(0x1f9)]=_0x159917;}),_0x4ae4ab[_0x424559(0x20d)]((_0xa038a6,_0x244b77)=>{_0x5b2731[_0x244b77]['batch_code']=_0xa038a6;}),_0x7b7ff2['forEach']((_0x2aaf0f,_0x56b74c)=>{_0x5b2731[_0x56b74c]['expiry_date']=_0x2aaf0f;}),_0x5e83d9[_0x424559(0x20d)]((_0x443917,_0x5d1cd5)=>{var _0x21bde1=_0x424559;_0x5b2731[_0x5d1cd5][_0x21bde1(0x23f)]=_0x443917;}),_0x1b3a78['forEach']((_0x3147dd,_0x2b6fae)=>{var _0x46b9c9=_0x424559;_0x5b2731[_0x2b6fae][_0x46b9c9(0x1e1)]=_0x3147dd;}),_0x46dc3b['forEach']((_0x235976,_0x2bd5a3)=>{_0x5b2731[_0x2bd5a3]['prod_cat']=_0x235976;}),_0x396594[_0x424559(0x20d)]((_0x364083,_0x2ec31f)=>{var _0x20e3de=_0x424559;_0x5b2731[_0x2ec31f][_0x20e3de(0x25e)]=_0x364083;}),_0x32e8ad[_0x424559(0x20d)]((_0x4d22a7,_0x50af8b)=>{var _0x21df59=_0x424559;_0x5b2731[_0x50af8b][_0x21df59(0x1dd)]=_0x4d22a7;}),_0x10242e[_0x424559(0x20d)]((_0x9d8175,_0x30cb2e)=>{var _0x5b3ec4=_0x424559;_0x5b2731[_0x30cb2e][_0x5b3ec4(0x1e8)]=_0x9d8175;});const _0x15b21e=_0x5b2731[_0x424559(0x1ec)](_0x48ca9a=>_0x48ca9a[_0x424559(0x250)]!=='0'&&_0x48ca9a[_0x424559(0x250)]!=='');var _0x1eeaa8=0x0;_0x15b21e['forEach'](_0x3d2b85=>{var _0x3e102a=_0x424559;console[_0x3e102a(0x1c0)]('foreach\x20newproduct',_0x3d2b85),parseInt(_0x3d2b85['adjust_qty'])<=0x0&&_0x1eeaa8++;});if(_0x1eeaa8!=0x0)return _0xc12cde[_0x424559(0x219)](_0x424559(0x246),_0x424559(0x234)),_0xd3cf52[_0x424559(0x1da)](_0x424559(0x262));_0x52d302['warehouse_name']=_0x172c7d,_0x52d302[_0x424559(0x21e)]=_0x5548d3,_0x52d302[_0x424559(0x21d)]=_0x15b21e,_0x52d302[_0x424559(0x1cb)]=_0x4d301a,_0x52d302[_0x424559(0x197)]=_0x34b65f,_0x52d302[_0x424559(0x24f)]='False';const _0x19a9e5=await _0x52d302[_0x424559(0x1b5)]();_0xc12cde[_0x424559(0x219)](_0x424559(0x1ad),_0x424559(0x247)),_0xd3cf52[_0x424559(0x1da)](_0x424559(0x199));}catch(_0x3f7e53){console['log'](_0x3f7e53);}}),router['post'](a0_0x480f66(0x1d6),async(_0x4a1166,_0x11a954)=>{var _0x559164=a0_0x480f66;const {primary_code:_0x56388a,warehouse_data:_0x3439e5,rooms_data:_0x95c9af,Roomslist:_0x427cc4}=_0x4a1166['body'],_0x5d7afb=_0x427cc4['split'](','),_0x415712=[];async function _0x44178d(_0x4f9f37){var _0x27d15f=a0_0x39e4;const _0x2d1bc2=await warehouse[_0x27d15f(0x231)]([{'$match':{'name':_0x3439e5,'room':_0x4f9f37}},{'$unwind':_0x27d15f(0x1f8)},{'$match':{'product_details.primary_code':_0x56388a}},{'$group':{'_id':_0x27d15f(0x24d),'name':{'$first':_0x27d15f(0x19b)},'product_stock':{'$first':_0x27d15f(0x1dc)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x27d15f(0x21f)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x27d15f(0x223)},'isle':{'$first':_0x27d15f(0x1be)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x27d15f(0x22a)},'unit':{'$first':_0x27d15f(0x227)},'secondary_unit':{'$first':_0x27d15f(0x192)},'storage':{'$first':_0x27d15f(0x1c2)},'rack':{'$first':_0x27d15f(0x1a5)},'expiry_date':{'$first':_0x27d15f(0x20b)},'production_date':{'$first':_0x27d15f(0x1f5)},'maxPerUnit':{'$first':_0x27d15f(0x1af)},'batch_code':{'$first':_0x27d15f(0x22b)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x27d15f(0x218)},'invoice':{'$first':_0x27d15f(0x1ae)}}}]),_0xa58c4f=await warehouse[_0x27d15f(0x231)]([{'$match':{'name':_0x3439e5,'room':_0x4f9f37}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x56388a}},{'$group':{'_id':_0x27d15f(0x24d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x27d15f(0x21f)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x27d15f(0x1be)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x27d15f(0x227)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x27d15f(0x1c2)},'rack':{'$first':_0x27d15f(0x1a5)},'expiry_date':{'$first':_0x27d15f(0x20b)},'production_date':{'$first':_0x27d15f(0x1f5)},'maxPerUnit':{'$first':_0x27d15f(0x1af)},'batch_code':{'$first':_0x27d15f(0x22b)},'product_cat':{'$first':_0x27d15f(0x1ed)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x27d15f(0x218)}}}]);if(_0x2d1bc2[_0x27d15f(0x264)]>0x0)_0x415712[_0x27d15f(0x1b6)](_0x2d1bc2);else _0xa58c4f['length']>0x0&&_0x415712['push'](_0xa58c4f);}const _0x393a0b=_0x5d7afb[_0x559164(0x241)](_0x45a10f=>_0x44178d(_0x45a10f));await Promise[_0x559164(0x209)](_0x393a0b),_0x11a954[_0x559164(0x24e)](_0x415712);}),router[a0_0x480f66(0x1e4)](a0_0x480f66(0x1f0),async(_0x7f7f1,_0x370cb6)=>{var _0x47be7a=a0_0x480f66;const {primaryCode:_0x3ca513,secondaryCode:_0xb3e2fc,productCode:_0x196461,level:_0x40f6a5,isle:_0xdbad99,pallet:_0x318d36,warehouses:_0x5b65fb,room:_0x15a4a9}=_0x7f7f1['body'];try{const _0x2e6d24=await warehouse[_0x47be7a(0x231)]([{'$match':{'name':_0x5b65fb,'room':_0x15a4a9}},{'$unwind':_0x47be7a(0x1f8)},{'$match':{'product_details.level':parseInt(_0x40f6a5),'product_details.isle':_0xdbad99,'product_details.pallet':parseInt(_0x318d36)}},{'$group':{'_id':_0x47be7a(0x24d),'name':{'$first':_0x47be7a(0x19b)},'product_stock':{'$first':_0x47be7a(0x1dc)},'level':{'$first':_0x47be7a(0x1aa)},'isle':{'$first':_0x47be7a(0x1e2)},'pallet':{'$first':_0x47be7a(0x1ba)},'maxProducts':{'$first':_0x47be7a(0x1d0)}}}]);_0x370cb6[_0x47be7a(0x265)](0xc8)['json'](_0x2e6d24);}catch(_0x1d8be6){_0x370cb6[_0x47be7a(0x265)](0x194)[_0x47be7a(0x24e)]({'message':_0x1d8be6[_0x47be7a(0x25c)]});}}),module[a0_0x480f66(0x22c)]=router;