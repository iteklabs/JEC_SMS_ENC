var a0_0x3e59bd=a0_0x2c7b;(function(_0x18fde5,_0x45301f){var _0x3fe60f=a0_0x2c7b,_0x251dd7=_0x18fde5();while(!![]){try{var _0x58da59=parseInt(_0x3fe60f(0x1ab))/0x1+parseInt(_0x3fe60f(0x200))/0x2*(parseInt(_0x3fe60f(0x15a))/0x3)+parseInt(_0x3fe60f(0x142))/0x4+parseInt(_0x3fe60f(0x154))/0x5+parseInt(_0x3fe60f(0x1a0))/0x6+-parseInt(_0x3fe60f(0x16a))/0x7+-parseInt(_0x3fe60f(0x183))/0x8*(parseInt(_0x3fe60f(0x1d0))/0x9);if(_0x58da59===_0x45301f)break;else _0x251dd7['push'](_0x251dd7['shift']());}catch(_0x55d12d){_0x251dd7['push'](_0x251dd7['shift']());}}}(a0_0x4750,0xe609d));const express=require('express'),app=express(),router=express[a0_0x3e59bd(0x1d4)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0x3e59bd(0x1ed)),nodemailer=require('nodemailer');router[a0_0x3e59bd(0x14d)](a0_0x3e59bd(0x148),auth,async(_0x17a3cf,_0x1db134)=>{var _0x571bec=a0_0x3e59bd;try{const {username:_0x4bd420,email:_0x42e8c7,role:_0xe55e72}=_0x17a3cf[_0x571bec(0x1be)],_0x27fe6c=_0x17a3cf[_0x571bec(0x1be)],_0x50f7c5=await profile[_0x571bec(0x141)]({'email':_0x27fe6c[_0x571bec(0x203)]}),_0x14a2f2=await master_shop[_0x571bec(0x1e0)]();console[_0x571bec(0x1bf)]('master',_0x14a2f2);let _0x32be19;if(_0x27fe6c[_0x571bec(0x1fd)]==_0x571bec(0x1b4)){const _0x76e30e=await staff['findOne']({'email':_0x27fe6c[_0x571bec(0x203)]});_0x32be19=await warehouse['find']({'status':'Enabled','name':_0x76e30e[_0x571bec(0x1c6)]});}else _0x32be19=await warehouse[_0x571bec(0x1e0)]({'status':_0x571bec(0x1e7)});const _0xddb7d5=await product[_0x571bec(0x1e0)]();let _0x5b75d1;if(_0x27fe6c[_0x571bec(0x1fd)]=='staff'){const _0x5a6669=await staff['findOne']({'email':_0x27fe6c[_0x571bec(0x203)]});_0x5b75d1=await adjustment[_0x571bec(0x1e0)]({'warehouse_name':_0x5a6669['warehouse']});}else _0x5b75d1=await adjustment[_0x571bec(0x202)]([{'$unwind':_0x571bec(0x1d5)},{'$group':{'_id':_0x571bec(0x1ff),'invoice':{'$first':_0x571bec(0x1a4)},'date':{'$first':_0x571bec(0x1f5)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x571bec(0x1eb)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x571bec(0x1f6)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x14a2f2[0x0][_0x571bec(0x19a)]==_0x571bec(0x193)){var _0x49fcba=users[_0x571bec(0x1bd)];console['log'](_0x49fcba);}else{if(_0x14a2f2[0x0][_0x571bec(0x19a)]==_0x571bec(0x17e))var _0x49fcba=users[_0x571bec(0x17e)];else{if(_0x14a2f2[0x0][_0x571bec(0x19a)]==_0x571bec(0x16f))var _0x49fcba=users['German'];else{if(_0x14a2f2[0x0][_0x571bec(0x19a)]=='Spanish')var _0x49fcba=users['Spanish'];else{if(_0x14a2f2[0x0][_0x571bec(0x19a)]=='French')var _0x49fcba=users[_0x571bec(0x1b6)];else{if(_0x14a2f2[0x0][_0x571bec(0x19a)]==_0x571bec(0x180))var _0x49fcba=users[_0x571bec(0x164)];else{if(_0x14a2f2[0x0][_0x571bec(0x19a)]==_0x571bec(0x174))var _0x49fcba=users['Chinese'];else{if(_0x14a2f2[0x0][_0x571bec(0x19a)]==_0x571bec(0x1ad))var _0x49fcba=users[_0x571bec(0x1e5)];}}}}}}}_0x1db134[_0x571bec(0x1b3)]('adjustment',{'success':_0x17a3cf[_0x571bec(0x146)](_0x571bec(0x171)),'errors':_0x17a3cf['flash'](_0x571bec(0x199)),'role':_0x27fe6c,'profile':_0x50f7c5,'warehouse':_0x32be19,'product':_0xddb7d5,'adjustment':_0x5b75d1,'master_shop':_0x14a2f2,'language':_0x49fcba});}catch(_0x53274d){console[_0x571bec(0x1bf)](_0x53274d);}});async function getRandom8DigitNumber(){var _0x184e6b=a0_0x3e59bd;const _0x2846fb=0x989680,_0xf581a5=0x5f5e0ff,_0x50b711=Math['floor'](Math[_0x184e6b(0x19d)]()*(_0xf581a5-_0x2846fb+0x1))+_0x2846fb;var _0xd387ae;const _0xc5ed9a=await adjustment[_0x184e6b(0x141)]({'invoice':_0x184e6b(0x1c2)+_0x50b711});return _0xc5ed9a&&_0xc5ed9a[_0x184e6b(0x1b7)]>0x0?_0xd387ae='ADJ-'+_0x50b711:_0xd387ae=_0x184e6b(0x1c2)+_0x50b711,_0xd387ae;}router[a0_0x3e59bd(0x14d)](a0_0x3e59bd(0x1ec),auth,async(_0x36d9a0,_0x409c23)=>{var _0x441336=a0_0x3e59bd;try{const {username:_0x5e0010,email:_0x3b8578,role:_0x1a3275}=_0x36d9a0[_0x441336(0x1be)],_0x2dcae7=_0x36d9a0[_0x441336(0x1be)],_0x3fe168=await profile[_0x441336(0x141)]({'email':_0x2dcae7['email']}),_0x3c0617=await master_shop[_0x441336(0x1e0)]();let _0x342f8c;if(_0x2dcae7[_0x441336(0x1fd)]==_0x441336(0x1b4)){const _0x22787c=await staff['findOne']({'email':_0x2dcae7[_0x441336(0x203)]});_0x342f8c=await warehouse[_0x441336(0x202)]([{'$match':{'status':'Enabled','name':_0x22787c['warehouse'],'warehouse_category':_0x441336(0x172),'name':{'$ne':_0x441336(0x1cb)}}},{'$group':{'_id':_0x441336(0x201),'name':{'$first':_0x441336(0x201)}}}]);}else _0x342f8c=await warehouse[_0x441336(0x202)]([{'$match':{'status':_0x441336(0x1e7),'warehouse_category':_0x441336(0x172),'name':{'$ne':_0x441336(0x1cb)}}},{'$group':{'_id':_0x441336(0x201),'name':{'$first':_0x441336(0x201)}}}]);const _0x2d249d=await product['find']({}),_0x967f7d=await adjustment[_0x441336(0x1e0)]({}),_0x71844c=_0x967f7d[_0x441336(0x1b7)]+0x1,_0x2554b1='ADJ-'+_0x71844c[_0x441336(0x13a)]()[_0x441336(0x1f1)](0x5,'0');var _0x29be0=[_0x441336(0x147),_0x441336(0x13e),_0x441336(0x1f3)];if(_0x3c0617[0x0][_0x441336(0x19a)]==_0x441336(0x193))var _0x30ee66=users['English'];else{if(_0x3c0617[0x0][_0x441336(0x19a)]==_0x441336(0x17e))var _0x30ee66=users[_0x441336(0x17e)];else{if(_0x3c0617[0x0][_0x441336(0x19a)]==_0x441336(0x16f))var _0x30ee66=users[_0x441336(0x16f)];else{if(_0x3c0617[0x0][_0x441336(0x19a)]=='Spanish')var _0x30ee66=users['Spanish'];else{if(_0x3c0617[0x0]['language']==_0x441336(0x1b6))var _0x30ee66=users[_0x441336(0x1b6)];else{if(_0x3c0617[0x0]['language']==_0x441336(0x180))var _0x30ee66=users[_0x441336(0x164)];else{if(_0x3c0617[0x0]['language']==_0x441336(0x174))var _0x30ee66=users[_0x441336(0x174)];else{if(_0x3c0617[0x0]['language']==_0x441336(0x1ad))var _0x30ee66=users['Arabic'];}}}}}}}const _0x32ecca=getRandom8DigitNumber();_0x32ecca[_0x441336(0x189)](_0x234590=>{var _0x4a73e3=_0x441336;_0x409c23[_0x4a73e3(0x1b3)]('add_adjustment',{'success':_0x36d9a0[_0x4a73e3(0x146)]('success'),'errors':_0x36d9a0[_0x4a73e3(0x146)](_0x4a73e3(0x199)),'role':_0x2dcae7,'profile':_0x3fe168,'warehouse':_0x342f8c,'product':_0x2d249d,'master_shop':_0x3c0617,'language':_0x30ee66,'rooms_data':_0x29be0,'invoice_no':_0x234590});})[_0x441336(0x18c)](_0x5b3992=>{var _0x17a14c=_0x441336;_0x36d9a0[_0x17a14c(0x146)](_0x17a14c(0x199),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x409c23[_0x17a14c(0x159)](_0x17a14c(0x1af));});}catch(_0x294b44){console[_0x441336(0x1bf)](_0x294b44);}}),router[a0_0x3e59bd(0x14c)](a0_0x3e59bd(0x1ec),auth,async(_0x1f5208,_0x803d31)=>{var _0x10c176=a0_0x3e59bd;try{const {warehouse_name:_0x498645,date:_0x44c8a9,prod_name:_0x2b4132,level:_0x1ed92a,isle:_0x42a21b,pallet:_0x4a9454,stock:_0x3f29d6,types:_0x44ed5e,adjust_qty:_0x5c783c,new_adjust_qty:_0x1d2333,note:_0x29b96c,Room_name:_0x5d0a7d,invoice:_0x4c27ef,JO_number:_0x51898e,expiry_date:_0x386bff}=_0x1f5208[_0x10c176(0x165)];if(typeof _0x2b4132==_0x10c176(0x152))var _0x2644e3=[_0x1f5208['body'][_0x10c176(0x16b)]],_0x3c3e97=[_0x1f5208['body']['level']],_0x449394=[_0x1f5208[_0x10c176(0x165)][_0x10c176(0x15b)]],_0x309949=[_0x1f5208[_0x10c176(0x165)]['types']],_0x35b4fa=[_0x1f5208[_0x10c176(0x165)][_0x10c176(0x1e4)]],_0x504fa6=[_0x1f5208[_0x10c176(0x165)]['New_Qty_Converted']],_0x48cdf4=[_0x1f5208[_0x10c176(0x165)][_0x10c176(0x190)]],_0x194801=[_0x1f5208[_0x10c176(0x165)][_0x10c176(0x1db)]],_0x4f021d=[_0x1f5208[_0x10c176(0x165)]['prod_code']],_0xed9f6d=[_0x1f5208[_0x10c176(0x165)][_0x10c176(0x160)]],_0x13a688=[_0x1f5208[_0x10c176(0x165)][_0x10c176(0x134)]],_0x971b9d=[_0x1f5208[_0x10c176(0x165)]['max_per_unit']],_0x272745=[_0x1f5208['body'][_0x10c176(0x1cc)]],_0x9fa66a=[_0x1f5208['body'][_0x10c176(0x13b)]],_0x3cf2b9=[_0x1f5208[_0x10c176(0x165)][_0x10c176(0x1ce)]],_0x393245=[_0x1f5208[_0x10c176(0x165)][_0x10c176(0x181)]],_0x1f2439=[_0x1f5208['body'][_0x10c176(0x1e2)]],_0x1bae50=[_0x1f5208[_0x10c176(0x165)]['prod_invoice']],_0x4395b2=[_0x1f5208['body'][_0x10c176(0x1ca)]];else var _0x2644e3=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x16b)]],_0x3c3e97=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x176)]],_0x449394=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x15b)]],_0x309949=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x1de)]],_0x35b4fa=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x1e4)]],_0x504fa6=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x15d)]],_0x48cdf4=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x1f4)]],_0x194801=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x1db)]],_0x4f021d=[..._0x1f5208['body'][_0x10c176(0x1bb)]],_0xed9f6d=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x160)]],_0x13a688=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x134)]],_0x971b9d=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x1c1)]],_0x272745=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x1cc)]],_0x9fa66a=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x13b)]],_0x3cf2b9=[..._0x1f5208[_0x10c176(0x165)]['Rooms']],_0x393245=[..._0x1f5208[_0x10c176(0x165)][_0x10c176(0x181)]],_0x1f2439=[..._0x1f5208['body']['second1']],_0x1bae50=[..._0x1f5208[_0x10c176(0x165)]['prod_invoice']],_0x4395b2=[..._0x1f5208[_0x10c176(0x165)]['id_transaction']];const _0x16620a=_0x2644e3['map'](_0x12e89c=>{return _0x12e89c={'product_name':_0x12e89c};});_0x3c3e97['forEach']((_0x4f2365,_0x50f87c)=>{var _0x38b434=_0x10c176;_0x3cf2b9[_0x38b434(0x18d)]((_0x180510,_0x4154b4)=>{var _0x2056c6=_0x38b434;if(_0x180510=='Receiving\x20Area'&&_0x50f87c==_0x4154b4){var _0x4b9afd=_0x4f2365[_0x2056c6(0x1ea)](0x3);_0x16620a[_0x50f87c][_0x2056c6(0x19b)]=_0x4f2365[0x0],_0x16620a[_0x50f87c][_0x2056c6(0x145)]=_0x4f2365[0x1],_0x16620a[_0x50f87c][_0x2056c6(0x173)]=0x0,_0x16620a[_0x50f87c][_0x2056c6(0x1a7)]=0x0,_0x16620a[_0x50f87c][_0x2056c6(0x194)]=_0x2056c6(0x140),_0x16620a[_0x50f87c][_0x2056c6(0x1e9)]=_0x4b9afd;}else{if(_0x180510==_0x2056c6(0x1d8)&&_0x50f87c==_0x4154b4){var _0x4b9afd=_0x4f2365[_0x2056c6(0x1ea)](0x3);_0x16620a[_0x50f87c][_0x2056c6(0x19b)]=_0x4f2365[0x0],_0x16620a[_0x50f87c][_0x2056c6(0x145)]=_0x4f2365[0x1],_0x16620a[_0x50f87c]['bay']=0x0,_0x16620a[_0x50f87c][_0x2056c6(0x1a7)]=0x0,_0x16620a[_0x50f87c]['type']=_0x2056c6(0x140),_0x16620a[_0x50f87c][_0x2056c6(0x1e9)]=_0x4f2365[0x5];}else{if(_0x50f87c==_0x4154b4){var _0x194377;if(_0x4f2365[0x4]=='L')_0x194377=_0x2056c6(0x161);else _0x4f2365[0x4]=='F'&&(_0x194377=_0x2056c6(0x140));_0x16620a[_0x50f87c][_0x2056c6(0x19b)]=_0x4f2365[0x0],_0x16620a[_0x50f87c][_0x2056c6(0x145)]=_0x4f2365[0x1],_0x16620a[_0x50f87c][_0x2056c6(0x173)]=_0x4f2365[0x2],_0x16620a[_0x50f87c][_0x2056c6(0x1a7)]=_0x4f2365[0x3],_0x16620a[_0x50f87c]['type']=_0x194377,_0x16620a[_0x50f87c][_0x2056c6(0x1e9)]=_0x4f2365[0x5];}}}});}),_0x449394[_0x10c176(0x18d)]((_0x290c9d,_0x2d8f68)=>{var _0x18bed0=_0x10c176;_0x16620a[_0x2d8f68][_0x18bed0(0x1a1)]=_0x290c9d;}),_0x4395b2[_0x10c176(0x18d)]((_0x1d3502,_0x5d6b08)=>{_0x16620a[_0x5d6b08]['id_transaction_from']=_0x1d3502;}),_0x309949[_0x10c176(0x18d)]((_0x569535,_0x1baf85)=>{var _0x416ad8=_0x10c176;_0x16620a[_0x1baf85][_0x416ad8(0x1de)]=_0x569535;}),_0x35b4fa[_0x10c176(0x18d)]((_0x29b180,_0xa54ba3)=>{var _0x2476bf=_0x10c176;_0x16620a[_0xa54ba3][_0x2476bf(0x14f)]=_0x29b180;}),_0x504fa6['forEach']((_0x1ce9f8,_0x28c276)=>{var _0x8576fd=_0x10c176;_0x16620a[_0x28c276][_0x8576fd(0x178)]=_0x1ce9f8;}),_0x48cdf4[_0x10c176(0x18d)]((_0x25d2b0,_0x2aaf0a)=>{var _0x1f9c44=_0x10c176;_0x16620a[_0x2aaf0a][_0x1f9c44(0x1f4)]=_0x25d2b0;}),_0x194801[_0x10c176(0x18d)]((_0x2bb1c3,_0x3cf0a6)=>{var _0x88249b=_0x10c176;_0x16620a[_0x3cf0a6][_0x88249b(0x17b)]=_0x2bb1c3;}),_0x4f021d[_0x10c176(0x18d)]((_0x26f3fc,_0x2b85a7)=>{var _0x4e6f67=_0x10c176;_0x16620a[_0x2b85a7][_0x4e6f67(0x14b)]=_0x26f3fc;}),_0xed9f6d['forEach']((_0x57c916,_0x2d7cb6)=>{var _0x3d91d0=_0x10c176;_0x16620a[_0x2d7cb6][_0x3d91d0(0x160)]=_0x57c916;}),_0x13a688[_0x10c176(0x18d)]((_0x488100,_0x45a89f)=>{var _0x19d6a8=_0x10c176;_0x16620a[_0x45a89f][_0x19d6a8(0x134)]=_0x488100;}),_0x971b9d[_0x10c176(0x18d)]((_0x21bb85,_0x59cc36)=>{var _0x509f1b=_0x10c176;_0x16620a[_0x59cc36][_0x509f1b(0x1fc)]=_0x21bb85;}),_0x272745[_0x10c176(0x18d)]((_0x4ee16b,_0x1f36c2)=>{_0x16620a[_0x1f36c2]['production_date']=_0x4ee16b;}),_0x9fa66a[_0x10c176(0x18d)]((_0x1a2458,_0x33511a)=>{var _0x376aa4=_0x10c176;_0x16620a[_0x33511a][_0x376aa4(0x13b)]=_0x1a2458;}),_0x3cf2b9[_0x10c176(0x18d)]((_0x37e2be,_0x82d655)=>{var _0x18c25f=_0x10c176;_0x16620a[_0x82d655][_0x18c25f(0x1ac)]=_0x37e2be;}),_0x393245[_0x10c176(0x18d)]((_0x4c88fc,_0x436982)=>{_0x16620a[_0x436982]['primary_code']=_0x4c88fc;}),_0x1f2439[_0x10c176(0x18d)]((_0x5e4d9b,_0x4c44d1)=>{var _0x6af821=_0x10c176;_0x16620a[_0x4c44d1][_0x6af821(0x1e3)]=_0x5e4d9b;}),_0x1bae50[_0x10c176(0x18d)]((_0x3c1522,_0x51e541)=>{var _0x210581=_0x10c176;_0x16620a[_0x51e541][_0x210581(0x1f9)]=_0x3c1522;});const _0x339d2b=_0x16620a[_0x10c176(0x177)](_0x401e68=>_0x401e68['adjust_qty']!=='0'&&_0x401e68[_0x10c176(0x14f)]!=='');var _0x2d9545=0x0;_0x339d2b[_0x10c176(0x18d)](_0x1313ed=>{var _0x3f900c=_0x10c176;console[_0x3f900c(0x1bf)](_0x3f900c(0x1e8),_0x1313ed),parseInt(_0x1313ed['adjust_qty'])<=0x0&&_0x2d9545++;});if(_0x2d9545!=0x0)return _0x1f5208['flash'](_0x10c176(0x199),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x803d31['redirect']('back');const _0x277ba1=new adjustment({'warehouse_name':_0x498645,'date':_0x44c8a9,'product':_0x339d2b,'note':_0x29b96c,'room':_0x5d0a7d,'invoice':_0x4c27ef,'JO_number':_0x51898e,'expiry_date':_0x386bff}),_0x525d9e=await _0x277ba1['save']();_0x1f5208[_0x10c176(0x146)](_0x10c176(0x171),_0x10c176(0x1a2)),_0x803d31[_0x10c176(0x159)]('/adjustment/preview/'+_0x525d9e[_0x10c176(0x17c)]);}catch(_0x332c53){console[_0x10c176(0x1bf)](_0x332c53),_0x803d31[_0x10c176(0x138)](0xc8)[_0x10c176(0x1a6)]({'message':_0x332c53[_0x10c176(0x16d)]});}}),router[a0_0x3e59bd(0x14d)](a0_0x3e59bd(0x1a9),auth,async(_0x2df93c,_0x12a274)=>{var _0xdb365a=a0_0x3e59bd;try{const {username:_0x144653,email:_0x190863,role:_0x4a62bb}=_0x2df93c[_0xdb365a(0x1be)],_0x1090a0=_0x2df93c['user'],_0x431369=await profile[_0xdb365a(0x141)]({'email':_0x1090a0[_0xdb365a(0x203)]}),_0xf0d0e5=await master_shop['find'](),_0x59ba59=_0x2df93c['params']['id'],_0x581924=await adjustment[_0xdb365a(0x1fa)]({'_id':_0x59ba59}),_0x382cff=await purchases['aggregate']([{'$match':{'warehouse_name':_0x581924[_0xdb365a(0x158)]}},{'$unwind':_0xdb365a(0x1d5)},{'$group':{'_id':_0xdb365a(0x143)}}]),_0x4b7d87=await product['find']({}),_0x16df3e=await warehouse[_0xdb365a(0x202)]([{'$match':{'name':_0x581924[_0xdb365a(0x158)]}},{'$unwind':_0xdb365a(0x196)},{'$group':{'_id':_0xdb365a(0x135),'name':{'$first':_0xdb365a(0x186)},'product_stock':{'$first':_0xdb365a(0x15f)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xdb365a(0x166)},'floorlevel':{'$first':_0xdb365a(0x163)},'primary_code':{'$first':_0xdb365a(0x1d3)},'secondary_code':{'$first':_0xdb365a(0x182)},'product_code':{'$first':_0xdb365a(0x175)},'storage':{'$first':_0xdb365a(0x1b2)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0xdb365a(0x14e)},'production_date':{'$first':_0xdb365a(0x1ee)},'batch_code':{'$first':_0xdb365a(0x167)},'room':{'$first':_0xdb365a(0x18a)}}}]);if(_0xf0d0e5[0x0][_0xdb365a(0x19a)]=='English\x20(US)'){var _0x2a6042=users[_0xdb365a(0x1bd)];console[_0xdb365a(0x1bf)](_0x2a6042);}else{if(_0xf0d0e5[0x0][_0xdb365a(0x19a)]=='Hindi')var _0x2a6042=users[_0xdb365a(0x17e)];else{if(_0xf0d0e5[0x0]['language']==_0xdb365a(0x16f))var _0x2a6042=users['German'];else{if(_0xf0d0e5[0x0][_0xdb365a(0x19a)]=='Spanish')var _0x2a6042=users[_0xdb365a(0x162)];else{if(_0xf0d0e5[0x0][_0xdb365a(0x19a)]==_0xdb365a(0x1b6))var _0x2a6042=users['French'];else{if(_0xf0d0e5[0x0][_0xdb365a(0x19a)]==_0xdb365a(0x180))var _0x2a6042=users[_0xdb365a(0x164)];else{if(_0xf0d0e5[0x0][_0xdb365a(0x19a)]==_0xdb365a(0x174))var _0x2a6042=users[_0xdb365a(0x174)];else{if(_0xf0d0e5[0x0][_0xdb365a(0x19a)]==_0xdb365a(0x1ad))var _0x2a6042=users['Arabic'];}}}}}}}_0x12a274[_0xdb365a(0x1b3)](_0xdb365a(0x1c5),{'success':_0x2df93c[_0xdb365a(0x146)](_0xdb365a(0x171)),'errors':_0x2df93c[_0xdb365a(0x146)](_0xdb365a(0x199)),'role':_0x1090a0,'profile':_0x431369,'adjustment':_0x581924,'stock':_0x16df3e,'master_shop':_0xf0d0e5,'warehouse_name':_0x382cff,'unit':_0x4b7d87,'language':_0x2a6042});}catch(_0x11e1ce){console[_0xdb365a(0x1bf)](_0x11e1ce),_0x12a274[_0xdb365a(0x138)](0xc8)[_0xdb365a(0x1a6)]({'message':_0x11e1ce[_0xdb365a(0x16d)]});}}),router[a0_0x3e59bd(0x14c)](a0_0x3e59bd(0x1a9),auth,async(_0x499a76,_0x3978ef)=>{var _0x2bbc4d=a0_0x3e59bd;try{const _0x20d568=_0x499a76['params']['id'],{warehouse_name:_0x530153,Room_name:_0x4b67cf}=_0x499a76[_0x2bbc4d(0x165)],_0x34f501=await adjustment['findById']({'_id':_0x20d568}),_0x294289=_0x34f501[_0x2bbc4d(0x1ba)][_0x2bbc4d(0x16e)](async _0x230b8d=>{var _0x5b93d2=_0x2bbc4d;if(_0x230b8d[_0x5b93d2(0x14f)]>0x0){var _0xab935e=await warehouse[_0x5b93d2(0x141)]({'name':_0x530153,'room':_0x230b8d[_0x5b93d2(0x1ac)],'warehouse_category':_0x5b93d2(0x172)});const _0xe49c2c=_0xab935e[_0x5b93d2(0x14a)]['map'](_0x41fb9d=>{var _0x57d946=_0x5b93d2;console[_0x57d946(0x1bf)](_0x230b8d[_0x57d946(0x1de)]+_0x57d946(0x150));if(_0x230b8d[_0x57d946(0x1de)]==_0x57d946(0x1ef)){if(_0x41fb9d[_0x57d946(0x1fe)]==_0x230b8d[_0x57d946(0x1fe)]&&_0x41fb9d['floorlevel']==_0x230b8d[_0x57d946(0x1e9)]&&_0x41fb9d[_0x57d946(0x194)]==_0x230b8d[_0x57d946(0x194)]&&_0x41fb9d[_0x57d946(0x1a7)]==_0x230b8d[_0x57d946(0x1a7)]&&_0x41fb9d[_0x57d946(0x173)]==_0x230b8d[_0x57d946(0x173)]&&_0x41fb9d[_0x57d946(0x145)]==_0x230b8d['rack']&&_0x41fb9d[_0x57d946(0x19b)]==_0x230b8d[_0x57d946(0x19b)]&&_0x41fb9d['expiry_date']==_0x230b8d[_0x57d946(0x134)]&&_0x41fb9d[_0x57d946(0x160)]==_0x230b8d[_0x57d946(0x160)]&&_0x41fb9d[_0x57d946(0x1cc)]==_0x230b8d[_0x57d946(0x1cc)]&&_0x41fb9d[_0x57d946(0x1f9)]==_0x230b8d[_0x57d946(0x1f9)]&&_0x41fb9d[_0x57d946(0x17c)]==_0x230b8d[_0x57d946(0x1e6)]){var _0x22f089;_0x22f089=_0x230b8d[_0x57d946(0x14f)],_0x230b8d[_0x57d946(0x13b)]=='S'&&(_0x22f089=_0x230b8d[_0x57d946(0x14f)]),_0x41fb9d[_0x57d946(0x1bc)]=_0x41fb9d[_0x57d946(0x1bc)]-_0x22f089;}}else{if(_0x41fb9d['product_name']==_0x230b8d[_0x57d946(0x1fe)]&&_0x41fb9d[_0x57d946(0x1e9)]==_0x230b8d[_0x57d946(0x1e9)]&&_0x41fb9d[_0x57d946(0x194)]==_0x230b8d[_0x57d946(0x194)]&&_0x41fb9d['bin']==_0x230b8d[_0x57d946(0x1a7)]&&_0x41fb9d['bay']==_0x230b8d[_0x57d946(0x173)]&&_0x41fb9d[_0x57d946(0x145)]==_0x230b8d[_0x57d946(0x145)]&&_0x41fb9d[_0x57d946(0x19b)]==_0x230b8d['storage']&&_0x41fb9d[_0x57d946(0x134)]==_0x230b8d['expiry_date']&&_0x41fb9d[_0x57d946(0x160)]==_0x230b8d[_0x57d946(0x160)]&&_0x41fb9d[_0x57d946(0x1cc)]==_0x230b8d['production_date']&&_0x41fb9d[_0x57d946(0x1f9)]==_0x230b8d[_0x57d946(0x1f9)]&&_0x41fb9d[_0x57d946(0x17c)]==_0x230b8d['id_transaction_from']){console[_0x57d946(0x1bf)](_0x230b8d);var _0x22f089;_0x22f089=_0x230b8d[_0x57d946(0x14f)],_0x230b8d[_0x57d946(0x13b)]=='S'&&(_0x22f089=_0x230b8d[_0x57d946(0x14f)]),_0x41fb9d['product_stock']=_0x41fb9d[_0x57d946(0x1bc)]+_0x22f089;}}});}return _0xab935e;});Promise[_0x2bbc4d(0x169)](_0x294289)['then'](async _0x346ff7=>{var _0x1e64e1=_0x2bbc4d;try{for(const _0x4c25dd of _0x346ff7){await _0x4c25dd[_0x1e64e1(0x188)]();}_0x34f501[_0x1e64e1(0x1f7)]='True';const _0x5b63fd=await _0x34f501[_0x1e64e1(0x188)](),_0x21a770=await master_shop[_0x1e64e1(0x1e0)](),_0x217424=await email_settings[_0x1e64e1(0x141)](),_0x4e62eb=await supervisor_settings['find']();var _0x83f9ea=_0x34f501[_0x1e64e1(0x1ba)],_0x175479='',_0x401982;for(_0x401982 in _0x83f9ea){_0x175479+=_0x1e64e1(0x155)+_0x1e64e1(0x1b8)+_0x83f9ea[_0x401982][_0x1e64e1(0x1fe)]+_0x1e64e1(0x198)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x83f9ea[_0x401982][_0x1e64e1(0x14b)]+_0x1e64e1(0x198)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x83f9ea[_0x401982][_0x1e64e1(0x14f)]+_0x1e64e1(0x198)+_0x1e64e1(0x1b8)+_0x83f9ea[_0x401982][_0x1e64e1(0x1f4)]+_0x1e64e1(0x198)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x83f9ea[_0x401982]['secondary_unit']+_0x1e64e1(0x198)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x34f501[_0x1e64e1(0x158)]+_0x1e64e1(0x198)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x83f9ea[_0x401982][_0x1e64e1(0x1ac)]+_0x1e64e1(0x198)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x83f9ea[_0x401982][_0x1e64e1(0x19b)]+_0x83f9ea[_0x401982][_0x1e64e1(0x145)]+_0x83f9ea[_0x401982]['bay']+_0x83f9ea[_0x401982][_0x1e64e1(0x1a7)]+_0x83f9ea[_0x401982][_0x1e64e1(0x194)][0x0]+_0x83f9ea[_0x401982][_0x1e64e1(0x1e9)]+_0x1e64e1(0x198),_0x1e64e1(0x1e1);}let _0xd6010c=nodemailer[_0x1e64e1(0x17d)]({'host':_0x217424[_0x1e64e1(0x1c9)],'port':Number(_0x217424[_0x1e64e1(0x17a)]),'secure':![],'auth':{'user':_0x217424[_0x1e64e1(0x203)],'pass':_0x217424['password']}}),_0x3cbf7b={'from':_0x217424['email'],'to':_0x4e62eb[0x0][_0x1e64e1(0x13d)],'subject':_0x1e64e1(0x1da),'attachments':[{'filename':'Logo.png','path':__dirname+_0x1e64e1(0x13c)+_0x1e64e1(0x18e)+_0x21a770[0x0]['image'],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x1e64e1(0x1d2)+_0x1e64e1(0x1b0)+_0x1e64e1(0x137)+_0x1e64e1(0x1b1)+_0x1e64e1(0x137)+_0x1e64e1(0x15e)+'</div>'+'<div>'+_0x1e64e1(0x149)+_0x21a770[0x0][_0x1e64e1(0x191)]+_0x1e64e1(0x184)+_0x1e64e1(0x1dd)+_0x1e64e1(0x1dd)+_0x1e64e1(0x1b9)+_0x1e64e1(0x137)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x1e64e1(0x1dc)+_0x34f501['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x1e64e1(0x1d7)+_0x34f501['date']+'\x20'+_0x1e64e1(0x179)+_0x1e64e1(0x153)+'</div>'+_0x1e64e1(0x1ae)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x1e64e1(0x1f0)+_0x1e64e1(0x18f)+_0x1e64e1(0x1fb)+_0x1e64e1(0x197)+_0x1e64e1(0x192)+_0x1e64e1(0x1d1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x1e64e1(0x1e1)+_0x1e64e1(0x1c0)+_0x1e64e1(0x1c8)+'\x20'+_0x175479+'\x20'+_0x1e64e1(0x19e)+_0x1e64e1(0x187)+_0x1e64e1(0x137)+_0x1e64e1(0x1a3)+_0x1e64e1(0x1a8)+_0x21a770[0x0][_0x1e64e1(0x191)]+_0x1e64e1(0x153)+_0x1e64e1(0x1dd)+'</div>'+'</body></html>'};_0xd6010c[_0x1e64e1(0x18b)](_0x3cbf7b,function(_0x2f9174,_0x1b66ca){var _0x2d7088=_0x1e64e1;_0x2f9174?(console[_0x2d7088(0x1bf)](_0x2f9174),console[_0x2d7088(0x1bf)](_0x2d7088(0x133))):console[_0x2d7088(0x1bf)](_0x2d7088(0x151));}),_0x499a76['flash'](_0x1e64e1(0x171),_0x1e64e1(0x1aa)),_0x3978ef[_0x1e64e1(0x159)](_0x1e64e1(0x1c3)+_0x5b63fd['_id']);}catch(_0x4f23b9){console[_0x1e64e1(0x13f)](_0x4f23b9),_0x3978ef[_0x1e64e1(0x138)](0x1f4)[_0x1e64e1(0x1a6)]({'error':_0x1e64e1(0x144)});}})['catch'](_0x24be04=>{var _0x197d86=_0x2bbc4d;console[_0x197d86(0x13f)](_0x24be04),_0x3978ef[_0x197d86(0x138)](0x1f4)[_0x197d86(0x1a6)]({'error':'An\x20error\x20occurred.'});});}catch(_0x1a1ef6){console[_0x2bbc4d(0x1bf)](_0x1a1ef6),_0x3978ef[_0x2bbc4d(0x138)](0xc8)['json']({'message':_0x1a1ef6[_0x2bbc4d(0x16d)]});}}),router[a0_0x3e59bd(0x14d)](a0_0x3e59bd(0x1df),auth,async(_0x17c63a,_0x4f452c)=>{var _0x4fc4da=a0_0x3e59bd;try{const {username:_0x3154bc,email:_0x55179a,role:_0x4829f9}=_0x17c63a[_0x4fc4da(0x1be)],_0xdefecc=_0x17c63a[_0x4fc4da(0x1be)],_0x939c=await profile[_0x4fc4da(0x141)]({'email':_0xdefecc['email']}),_0x53b93c=await master_shop['find'](),_0x301fa5=_0x17c63a[_0x4fc4da(0x1d9)]['id'],_0xf20fc=await adjustment[_0x4fc4da(0x1fa)]({'_id':_0x301fa5}),_0x3f930e=await purchases[_0x4fc4da(0x202)]([{'$match':{'warehouse_name':_0xf20fc[_0x4fc4da(0x158)]}},{'$unwind':'$product'},{'$group':{'_id':_0x4fc4da(0x143)}}]),_0x132ea8=await product[_0x4fc4da(0x1e0)]({}),_0x310213=await warehouse[_0x4fc4da(0x202)]([{'$match':{'name':_0xf20fc[_0x4fc4da(0x158)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4fc4da(0x186)},'product_stock':{'$first':_0x4fc4da(0x15f)},'bay':{'$first':_0x4fc4da(0x1f2)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4fc4da(0x163)},'primary_code':{'$first':_0x4fc4da(0x1d3)},'secondary_code':{'$first':_0x4fc4da(0x182)},'product_code':{'$first':_0x4fc4da(0x175)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4fc4da(0x1a5)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4fc4da(0x1ee)},'batch_code':{'$first':_0x4fc4da(0x167)},'room':{'$first':_0x4fc4da(0x18a)}}}]);let _0x102af8;if(_0xdefecc[_0x4fc4da(0x1fd)]=='staff'){const _0x401cf5=await staff[_0x4fc4da(0x141)]({'email':_0xdefecc[_0x4fc4da(0x203)]});_0x102af8=await warehouse[_0x4fc4da(0x202)]([{'$match':{'status':'Enabled','name':_0x401cf5['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x4fc4da(0x1cb)}}},{'$group':{'_id':_0x4fc4da(0x201),'name':{'$first':_0x4fc4da(0x201)}}}]);}else _0x102af8=await warehouse['aggregate']([{'$match':{'status':_0x4fc4da(0x1e7),'warehouse_category':_0x4fc4da(0x172),'name':{'$ne':_0x4fc4da(0x1cb)}}},{'$group':{'_id':_0x4fc4da(0x201),'name':{'$first':_0x4fc4da(0x201)}}}]);if(_0x53b93c[0x0]['language']==_0x4fc4da(0x193)){var _0x38efb1=users['English'];console['log'](_0x38efb1);}else{if(_0x53b93c[0x0]['language']==_0x4fc4da(0x17e))var _0x38efb1=users[_0x4fc4da(0x17e)];else{if(_0x53b93c[0x0]['language']==_0x4fc4da(0x16f))var _0x38efb1=users['German'];else{if(_0x53b93c[0x0][_0x4fc4da(0x19a)]==_0x4fc4da(0x162))var _0x38efb1=users['Spanish'];else{if(_0x53b93c[0x0][_0x4fc4da(0x19a)]==_0x4fc4da(0x1b6))var _0x38efb1=users[_0x4fc4da(0x1b6)];else{if(_0x53b93c[0x0][_0x4fc4da(0x19a)]==_0x4fc4da(0x180))var _0x38efb1=users[_0x4fc4da(0x164)];else{if(_0x53b93c[0x0][_0x4fc4da(0x19a)]==_0x4fc4da(0x174))var _0x38efb1=users[_0x4fc4da(0x174)];else{if(_0x53b93c[0x0][_0x4fc4da(0x19a)]==_0x4fc4da(0x1ad))var _0x38efb1=users[_0x4fc4da(0x1e5)];}}}}}}}_0x4f452c[_0x4fc4da(0x1b3)](_0x4fc4da(0x19f),{'success':_0x17c63a[_0x4fc4da(0x146)]('success'),'errors':_0x17c63a[_0x4fc4da(0x146)](_0x4fc4da(0x199)),'role':_0xdefecc,'profile':_0x939c,'adjustment':_0xf20fc,'stock':_0x310213,'master_shop':_0x53b93c,'warehouse_name':_0x3f930e,'unit':_0x132ea8,'language':_0x38efb1,'warehouse':_0x102af8});}catch(_0x2aea00){console[_0x4fc4da(0x1bf)](_0x2aea00),_0x4f452c[_0x4fc4da(0x138)](0xc8)['json']({'message':_0x2aea00[_0x4fc4da(0x16d)]});}}),router['post']('/view/:id',auth,async(_0xc2b3f6,_0x44ff92)=>{var _0x5b961d=a0_0x3e59bd;try{const _0x55aa70=_0xc2b3f6[_0x5b961d(0x1d9)]['id'],_0x12e999=await adjustment[_0x5b961d(0x1fa)]({'_id':_0x55aa70}),_0x327a3d=await warehouse[_0x5b961d(0x141)]({'name':_0x12e999[_0x5b961d(0x158)],'room':_0x12e999[_0x5b961d(0x1c4)]}),{warehouse_name:_0x271fb3,date:_0x4824b4,prod_name:_0x46dd7d,level:_0x520266,isle:_0x406b61,pallet:_0x183d2b,stock:_0x2a0dcc,types:_0x575bb8,adjust_qty:_0x5f030f,new_adjust_qty:_0x243780,note:_0x4f6b7f,Room_name:_0x303a7e,invoice:_0x34dcce,JO_number:_0x107917,expiry_date:_0x408fd2}=_0xc2b3f6[_0x5b961d(0x165)];if(typeof _0x46dd7d==_0x5b961d(0x152))var _0x4f01fc=[_0xc2b3f6['body'][_0x5b961d(0x16b)]],_0x59bdf0=[_0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x176)]],_0x19cb9f=[_0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x15b)]],_0x2f98fe=[_0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1de)]],_0x17979f=[_0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1e4)]],_0x8cc6cf=[_0xc2b3f6['body'][_0x5b961d(0x15d)]],_0x587496=[_0xc2b3f6['body'][_0x5b961d(0x190)]],_0x5b46ce=[_0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1db)]],_0x5c726a=[_0xc2b3f6['body'][_0x5b961d(0x1bb)]],_0x5a258e=[_0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x160)]],_0x16d074=[_0xc2b3f6['body'][_0x5b961d(0x134)]],_0x5ab7b0=[_0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1c1)]],_0x535b4a=[_0xc2b3f6['body'][_0x5b961d(0x1cc)]],_0x2e311c=[_0xc2b3f6[_0x5b961d(0x165)]['prod_cat']],_0x462e02=[_0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1ce)]],_0x3252a9=[_0xc2b3f6['body']['prime1']],_0x3a8fe6=[_0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1e2)]];else var _0x4f01fc=[..._0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x16b)]],_0x59bdf0=[..._0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x176)]],_0x19cb9f=[..._0xc2b3f6['body'][_0x5b961d(0x15b)]],_0x2f98fe=[..._0xc2b3f6['body'][_0x5b961d(0x1de)]],_0x17979f=[..._0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1e4)]],_0x8cc6cf=[..._0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x15d)]],_0x587496=[..._0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1f4)]],_0x5b46ce=[..._0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1db)]],_0x5c726a=[..._0xc2b3f6['body'][_0x5b961d(0x1bb)]],_0x5a258e=[..._0xc2b3f6['body'][_0x5b961d(0x160)]],_0x16d074=[..._0xc2b3f6['body'][_0x5b961d(0x134)]],_0x5ab7b0=[..._0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1c1)]],_0x535b4a=[..._0xc2b3f6['body'][_0x5b961d(0x1cc)]],_0x2e311c=[..._0xc2b3f6[_0x5b961d(0x165)]['prod_cat']],_0x462e02=[..._0xc2b3f6[_0x5b961d(0x165)][_0x5b961d(0x1ce)]],_0x3252a9=[..._0xc2b3f6[_0x5b961d(0x165)]['prime1']],_0x3a8fe6=[..._0xc2b3f6[_0x5b961d(0x165)]['second1']];const _0x20ccce=_0x4f01fc['map'](_0x505836=>{return _0x505836={'product_name':_0x505836};});_0x59bdf0['forEach']((_0x2e84fc,_0x444763)=>{_0x462e02['forEach']((_0x369fcf,_0x2cb58e)=>{var _0x4e42c1=a0_0x2c7b;if(_0x369fcf==_0x4e42c1(0x1d6)&&_0x444763==_0x2cb58e){var _0x1ad4e6=_0x2e84fc[_0x4e42c1(0x1ea)](0x3);_0x20ccce[_0x444763][_0x4e42c1(0x19b)]=_0x2e84fc[0x0],_0x20ccce[_0x444763][_0x4e42c1(0x145)]=_0x2e84fc[0x1],_0x20ccce[_0x444763][_0x4e42c1(0x173)]=0x0,_0x20ccce[_0x444763]['bin']=0x0,_0x20ccce[_0x444763]['type']='Floor',_0x20ccce[_0x444763][_0x4e42c1(0x1e9)]=_0x1ad4e6;}else{if(_0x369fcf==_0x4e42c1(0x1d8)&&_0x444763==_0x2cb58e){var _0x1ad4e6=_0x2e84fc[_0x4e42c1(0x1ea)](0x3);_0x20ccce[_0x444763][_0x4e42c1(0x19b)]=_0x2e84fc[0x0],_0x20ccce[_0x444763][_0x4e42c1(0x145)]=_0x2e84fc[0x1],_0x20ccce[_0x444763][_0x4e42c1(0x173)]=0x0,_0x20ccce[_0x444763][_0x4e42c1(0x1a7)]=0x0,_0x20ccce[_0x444763][_0x4e42c1(0x194)]=_0x4e42c1(0x140),_0x20ccce[_0x444763][_0x4e42c1(0x1e9)]=_0x2e84fc[0x5];}else{if(_0x444763==_0x2cb58e){var _0x5cf1ef;if(_0x2e84fc[0x4]=='L')_0x5cf1ef=_0x4e42c1(0x161);else _0x2e84fc[0x4]=='F'&&(_0x5cf1ef='Floor');_0x20ccce[_0x444763][_0x4e42c1(0x19b)]=_0x2e84fc[0x0],_0x20ccce[_0x444763]['rack']=_0x2e84fc[0x1],_0x20ccce[_0x444763][_0x4e42c1(0x173)]=_0x2e84fc[0x2],_0x20ccce[_0x444763][_0x4e42c1(0x1a7)]=_0x2e84fc[0x3],_0x20ccce[_0x444763][_0x4e42c1(0x194)]=_0x5cf1ef,_0x20ccce[_0x444763][_0x4e42c1(0x1e9)]=_0x2e84fc[0x5];}}}});}),_0x19cb9f['forEach']((_0x216ad8,_0x4af47c)=>{var _0x4fb8d7=_0x5b961d;_0x20ccce[_0x4af47c][_0x4fb8d7(0x1a1)]=_0x216ad8;}),_0x2f98fe['forEach']((_0x1ae7a5,_0x420329)=>{var _0x32b16b=_0x5b961d;_0x20ccce[_0x420329][_0x32b16b(0x1de)]=_0x1ae7a5;}),_0x17979f[_0x5b961d(0x18d)]((_0x11f843,_0x3fa61a)=>{var _0x3a09d8=_0x5b961d;_0x20ccce[_0x3fa61a][_0x3a09d8(0x14f)]=_0x11f843;}),_0x8cc6cf[_0x5b961d(0x18d)]((_0x4b5e11,_0x37e70a)=>{_0x20ccce[_0x37e70a]['new_adjust_qty']=_0x4b5e11;}),_0x587496[_0x5b961d(0x18d)]((_0x19d1f3,_0x57ad48)=>{var _0x1d0e0=_0x5b961d;_0x20ccce[_0x57ad48][_0x1d0e0(0x1f4)]=_0x19d1f3;}),_0x5b46ce[_0x5b961d(0x18d)]((_0x3f13f8,_0x8fe135)=>{var _0x34fbe3=_0x5b961d;_0x20ccce[_0x8fe135][_0x34fbe3(0x17b)]=_0x3f13f8;}),_0x5c726a['forEach']((_0x14605b,_0x16a1e2)=>{_0x20ccce[_0x16a1e2]['product_code']=_0x14605b;}),_0x5a258e[_0x5b961d(0x18d)]((_0x2b8ba5,_0x535121)=>{var _0x477af9=_0x5b961d;_0x20ccce[_0x535121][_0x477af9(0x160)]=_0x2b8ba5;}),_0x16d074[_0x5b961d(0x18d)]((_0x4a9af2,_0x357ad6)=>{var _0x5ac72c=_0x5b961d;_0x20ccce[_0x357ad6][_0x5ac72c(0x134)]=_0x4a9af2;}),_0x5ab7b0[_0x5b961d(0x18d)]((_0x15e7b8,_0x3d5006)=>{_0x20ccce[_0x3d5006]['maxperunit']=_0x15e7b8;}),_0x535b4a['forEach']((_0x4c1cfc,_0x24d51a)=>{var _0xf10301=_0x5b961d;_0x20ccce[_0x24d51a][_0xf10301(0x1cc)]=_0x4c1cfc;}),_0x2e311c[_0x5b961d(0x18d)]((_0x57ee73,_0x44551a)=>{var _0x2acc34=_0x5b961d;_0x20ccce[_0x44551a][_0x2acc34(0x13b)]=_0x57ee73;}),_0x462e02[_0x5b961d(0x18d)]((_0x5722a2,_0x44967c)=>{var _0xdf9b9a=_0x5b961d;_0x20ccce[_0x44967c][_0xdf9b9a(0x1ac)]=_0x5722a2;}),_0x3252a9['forEach']((_0x5ce919,_0x236f96)=>{_0x20ccce[_0x236f96]['primary_code']=_0x5ce919;}),_0x3a8fe6['forEach']((_0x2955a7,_0x132b36)=>{var _0x3e7afb=_0x5b961d;_0x20ccce[_0x132b36][_0x3e7afb(0x1e3)]=_0x2955a7;});const _0x46ec54=_0x20ccce[_0x5b961d(0x177)](_0x221054=>_0x221054[_0x5b961d(0x14f)]!=='0'&&_0x221054[_0x5b961d(0x14f)]!=='');var _0x370187=0x0;_0x46ec54['forEach'](_0x25e2bc=>{var _0x80a852=_0x5b961d;console['log']('foreach\x20newproduct',_0x25e2bc),parseInt(_0x25e2bc[_0x80a852(0x14f)])<=0x0&&_0x370187++;});if(_0x370187!=0x0)return _0xc2b3f6[_0x5b961d(0x146)](_0x5b961d(0x199),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x44ff92[_0x5b961d(0x159)](_0x5b961d(0x15c));_0x12e999[_0x5b961d(0x158)]=_0x271fb3,_0x12e999[_0x5b961d(0x157)]=_0x4824b4,_0x12e999['product']=_0x46ec54,_0x12e999[_0x5b961d(0x195)]=_0x4f6b7f,_0x12e999['invoice']=_0x34dcce,_0x12e999[_0x5b961d(0x1b5)]=_0x5b961d(0x1f8);const _0x6e5157=await _0x12e999['save']();_0xc2b3f6[_0x5b961d(0x146)]('success',_0x5b961d(0x136)),_0x44ff92[_0x5b961d(0x159)](_0x5b961d(0x1af));}catch(_0x56ee6d){console[_0x5b961d(0x1bf)](_0x56ee6d);}}),router['post'](a0_0x3e59bd(0x1c7),async(_0x5d8639,_0x231bf0)=>{var _0x4c091f=a0_0x3e59bd;const {primary_code:_0x2cecad,warehouse_data:_0x764768,rooms_data:_0xb391d0,Roomslist:_0x5b727a}=_0x5d8639[_0x4c091f(0x165)],_0xb99aa1=_0x5b727a[_0x4c091f(0x1cd)](','),_0x5ea669=[];async function _0x469756(_0x22a79c){var _0x49a7a9=_0x4c091f;const _0x240696=await warehouse[_0x49a7a9(0x202)]([{'$match':{'name':_0x764768,'room':_0x22a79c}},{'$unwind':_0x49a7a9(0x196)},{'$match':{'product_details.primary_code':_0x2cecad}},{'$group':{'_id':_0x49a7a9(0x135),'name':{'$first':_0x49a7a9(0x186)},'product_stock':{'$first':_0x49a7a9(0x15f)},'primary_code':{'$first':_0x49a7a9(0x1d3)},'secondary_code':{'$first':_0x49a7a9(0x182)},'product_code':{'$first':_0x49a7a9(0x175)},'level':{'$first':_0x49a7a9(0x1f2)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x49a7a9(0x163)},'unit':{'$first':_0x49a7a9(0x19c)},'secondary_unit':{'$first':_0x49a7a9(0x170)},'storage':{'$first':_0x49a7a9(0x1b2)},'rack':{'$first':_0x49a7a9(0x1a5)},'expiry_date':{'$first':_0x49a7a9(0x14e)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x49a7a9(0x17f)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x49a7a9(0x18a)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x49becc=await warehouse[_0x49a7a9(0x202)]([{'$match':{'name':_0x764768,'room':_0x22a79c}},{'$unwind':_0x49a7a9(0x196)},{'$match':{'product_details.secondary_code':_0x2cecad}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x49a7a9(0x15f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x49a7a9(0x182)},'product_code':{'$first':_0x49a7a9(0x175)},'level':{'$first':_0x49a7a9(0x1f2)},'isle':{'$first':_0x49a7a9(0x156)},'type':{'$first':_0x49a7a9(0x166)},'pallet':{'$first':_0x49a7a9(0x163)},'unit':{'$first':_0x49a7a9(0x19c)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x49a7a9(0x1b2)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x49a7a9(0x14e)},'production_date':{'$first':_0x49a7a9(0x1ee)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x49a7a9(0x167)},'product_cat':{'$first':_0x49a7a9(0x17f)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x49a7a9(0x18a)}}}]);if(_0x240696[_0x49a7a9(0x1b7)]>0x0)_0x5ea669[_0x49a7a9(0x168)](_0x240696);else _0x49becc[_0x49a7a9(0x1b7)]>0x0&&_0x5ea669[_0x49a7a9(0x168)](_0x49becc);}const _0xac1f11=_0xb99aa1[_0x4c091f(0x16e)](_0x66118=>_0x469756(_0x66118));await Promise[_0x4c091f(0x169)](_0xac1f11),_0x231bf0[_0x4c091f(0x1a6)](_0x5ea669);}),router['post'](a0_0x3e59bd(0x1cf),async(_0x517c21,_0x57bc6f)=>{var _0x5ef584=a0_0x3e59bd;const {primaryCode:_0x208617,secondaryCode:_0x10a52b,productCode:_0x1cfe55,level:_0x2361eb,isle:_0x40f4b5,pallet:_0x42b242,warehouses:_0x2eaa95,room:_0x46ff59}=_0x517c21[_0x5ef584(0x165)];try{const _0x453fff=await warehouse['aggregate']([{'$match':{'name':_0x2eaa95,'room':_0x46ff59}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x2361eb),'product_details.isle':_0x40f4b5,'product_details.pallet':parseInt(_0x42b242)}},{'$group':{'_id':_0x5ef584(0x135),'name':{'$first':_0x5ef584(0x186)},'product_stock':{'$first':_0x5ef584(0x15f)},'level':{'$first':_0x5ef584(0x139)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x5ef584(0x16c)}}}]);_0x57bc6f[_0x5ef584(0x138)](0xc8)['json'](_0x453fff);}catch(_0x1f2f6b){_0x57bc6f[_0x5ef584(0x138)](0x194)[_0x5ef584(0x1a6)]({'message':_0x1f2f6b['message']});}}),module[a0_0x3e59bd(0x185)]=router;function a0_0x2c7b(_0x5e11cc,_0x101be6){var _0x4750e4=a0_0x4750();return a0_0x2c7b=function(_0x2c7b7d,_0x4f56d9){_0x2c7b7d=_0x2c7b7d-0x133;var _0x385b70=_0x4750e4[_0x2c7b7d];return _0x385b70;},a0_0x2c7b(_0x5e11cc,_0x101be6);}function a0_0x4750(){var _0x264128=['port','secondary_unit','_id','createTransport','Hindi','$product_details.product_cat','Portuguese\x20(BR)','prime1','$product_details.secondary_code','16BeIOJk','\x20</h2>','exports','$product_details.product_name','</table>','save','then','$room','sendMail','catch','forEach','/upload/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Primary_Units','site_title','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','English\x20(US)','type','note','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','</td>','errors','language','storage','$product_details.unit','random','</tbody>','edit_adjustment','4859880tobosv','stockBefore','adjustment\x20add\x20successfull','<strong>\x20Regards\x20</strong>','$invoice','$product_details.rack','json','bin','<h5>','/preview/:id','adjustment\x20Finalized\x20successfully','521624dCCkOS','room_names','Arabic\x20(ae)','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/adjustment/view','</head><body>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.storage','render','staff','isAllowEdit','French','length','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<hr\x20class=\x22my-3\x22>','product','prod_code','product_stock','English','user','log','</thead>','max_per_unit','ADJ-','/picking_list/PDF_adjustment_rm/','room','edit_adjustment_view','warehouse','/barcode_scanner','<tbody\x20style=\x22text-align:\x20center;\x22>','host','id_transaction','Return\x20Goods','production_date','split','Rooms','/CheckingWarehouse','6448203ZXDuwC','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<html><head><title></title>','$product_details.primary_code','Router','$product','Receiving\x20Area','\x20Order\x20Date\x20:\x20','Shelves','params','Adjustment\x20Mail','Secondary_units','\x20Order\x20Number\x20:\x20','</div>','types','/view/:id','find','</tr>','second1','secondary_code','New_Qty_Converted_adj','Arabic','id_transaction_from','Enabled','foreach\x20newproduct','floorlevel','slice','$product.room_names','/view/add_adjustment','../public/language/languages.json','$product_details.production_date','minus','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','padStart','$product_details.bay','Return\x20Rooms','unit','$date','$isAllowEdit','finalize','False','invoice','findById','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','maxperunit','role','product_name','$_id','24xhBkNt','$name','aggregate','email','Error\x20Occurs','expiry_date','$product_details._id','adjustment\x20data\x20update\x20successfully','<div>','status','$product_details.level','toString','prod_cat','/../public','RMSEmail','Enclosed','error','Floor','findOne','4821020nsOIyP','$product.product_name','An\x20error\x20occurred\x20while\x20saving\x20data.','rack','flash','Ambient','/view','<h2>\x20','product_details','product_code','post','get','$product_details.expiry_date','adjust_qty','\x20<>\x20','Email\x20sent\x20successfully','string','</h5>','3869385fPPrTC','<tr>','$product_details.bin','date','warehouse_name','redirect','114801JrjcUB','stock','back','New_Qty_Converted','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.product_stock','batch_code','Level','Spanish','$product_details.floorlevel','Portuguese','body','$product_details.type','$product_details.batch_code','push','all','9763383cINKeg','prod_name','$product_details.maxProducts','message','map','German','$product_details.secondary_unit','success','Raw\x20Materials','bay','Chinese','$product_details.product_code','level','filter','new_adjust_qty','</span>'];a0_0x4750=function(){return _0x264128;};return a0_0x4750();}