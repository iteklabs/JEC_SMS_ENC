var a0_0xd14ba9=a0_0x25f7;(function(_0x2d5855,_0x28ba6f){var _0x350862=a0_0x25f7,_0x3355a2=_0x2d5855();while(!![]){try{var _0x2f5d83=-parseInt(_0x350862(0x8d))/0x1*(-parseInt(_0x350862(0x8f))/0x2)+parseInt(_0x350862(0xf4))/0x3+-parseInt(_0x350862(0x12f))/0x4+-parseInt(_0x350862(0xf3))/0x5+-parseInt(_0x350862(0xa0))/0x6*(-parseInt(_0x350862(0x91))/0x7)+parseInt(_0x350862(0xf0))/0x8*(parseInt(_0x350862(0x15a))/0x9)+-parseInt(_0x350862(0xbf))/0xa*(parseInt(_0x350862(0x100))/0xb);if(_0x2f5d83===_0x28ba6f)break;else _0x3355a2['push'](_0x3355a2['shift']());}catch(_0x5ed673){_0x3355a2['push'](_0x3355a2['shift']());}}}(a0_0x3b7a,0x6e659));const express=require(a0_0xd14ba9(0x7d)),app=express(),router=express[a0_0xd14ba9(0x8b)](),auth=require(a0_0xd14ba9(0xeb)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require('../public/language/languages.json'),nodemailer=require(a0_0xd14ba9(0xe9));router[a0_0xd14ba9(0x116)](a0_0xd14ba9(0xd9),auth,async(_0x4d74f5,_0x256620)=>{var _0x13150a=a0_0xd14ba9;try{const {username:_0x51237b,email:_0x258db8,role:_0x38aff7}=_0x4d74f5[_0x13150a(0x105)],_0x4024c4=_0x4d74f5['user'],_0x39e5b8=await profile['findOne']({'email':_0x4024c4[_0x13150a(0xfd)]}),_0x84e67c=await master_shop[_0x13150a(0x124)]();console[_0x13150a(0x141)](_0x13150a(0x94),_0x84e67c);let _0x223272;if(_0x4024c4[_0x13150a(0xe3)]==_0x13150a(0x85)){const _0x385a93=await staff[_0x13150a(0xa5)]({'email':_0x4024c4['email']});_0x223272=await warehouse[_0x13150a(0x124)]({'status':'Enabled','name':_0x385a93['warehouse']});}else _0x223272=await warehouse[_0x13150a(0x124)]({'status':_0x13150a(0x126)});const _0x427abb=await product[_0x13150a(0x124)]();let _0x33a69c;if(_0x4024c4[_0x13150a(0xe3)]=='staff'){const _0x363b59=await staff[_0x13150a(0xa5)]({'email':_0x4024c4[_0x13150a(0xfd)]});_0x33a69c=await adjustment['find']({'warehouse_name':_0x363b59[_0x13150a(0xf5)]});}else _0x33a69c=await adjustment[_0x13150a(0x13a)]([{'$unwind':'$product'},{'$group':{'_id':_0x13150a(0x120),'invoice':{'$first':_0x13150a(0xc2)},'date':{'$first':_0x13150a(0xa7)},'warehouse_name':{'$first':_0x13150a(0x12b)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x13150a(0xd0)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x84e67c[0x0][_0x13150a(0xd2)]==_0x13150a(0x14f)){var _0x3bd676=users[_0x13150a(0x155)];console[_0x13150a(0x141)](_0x3bd676);}else{if(_0x84e67c[0x0]['language']==_0x13150a(0x93))var _0x3bd676=users[_0x13150a(0x93)];else{if(_0x84e67c[0x0][_0x13150a(0xd2)]=='German')var _0x3bd676=users['German'];else{if(_0x84e67c[0x0][_0x13150a(0xd2)]==_0x13150a(0x99))var _0x3bd676=users[_0x13150a(0x99)];else{if(_0x84e67c[0x0][_0x13150a(0xd2)]=='French')var _0x3bd676=users['French'];else{if(_0x84e67c[0x0][_0x13150a(0xd2)]==_0x13150a(0xd5))var _0x3bd676=users['Portuguese'];else{if(_0x84e67c[0x0][_0x13150a(0xd2)]==_0x13150a(0x149))var _0x3bd676=users['Chinese'];else{if(_0x84e67c[0x0][_0x13150a(0xd2)]==_0x13150a(0xb5))var _0x3bd676=users[_0x13150a(0x102)];}}}}}}}_0x256620[_0x13150a(0x81)]('adjustment',{'success':_0x4d74f5['flash'](_0x13150a(0xec)),'errors':_0x4d74f5['flash'](_0x13150a(0x135)),'role':_0x4024c4,'profile':_0x39e5b8,'warehouse':_0x223272,'product':_0x427abb,'adjustment':_0x33a69c,'master_shop':_0x84e67c,'language':_0x3bd676});}catch(_0x327ca4){console[_0x13150a(0x141)](_0x327ca4);}});function a0_0x25f7(_0x50600c,_0x40feab){var _0x3b7a60=a0_0x3b7a();return a0_0x25f7=function(_0x25f725,_0x1a9b05){_0x25f725=_0x25f725-0x7d;var _0x36d6ee=_0x3b7a60[_0x25f725];return _0x36d6ee;},a0_0x25f7(_0x50600c,_0x40feab);}async function getRandom8DigitNumber(){var _0x36cf92=a0_0xd14ba9;const _0x4d85af=0x989680,_0x1993d3=0x5f5e0ff,_0x564732=Math[_0x36cf92(0xa2)](Math[_0x36cf92(0xb1)]()*(_0x1993d3-_0x4d85af+0x1))+_0x4d85af;var _0x45fec7;const _0x2d8044=await adjustment[_0x36cf92(0xa5)]({'invoice':_0x36cf92(0xf1)+_0x564732});return _0x2d8044&&_0x2d8044[_0x36cf92(0x123)]>0x0?_0x45fec7='ADJ-'+_0x564732:_0x45fec7=_0x36cf92(0xf1)+_0x564732,_0x45fec7;}function a0_0x3b7a(){var _0x385ae1=['map','product_name','Spanish','$product_details.maxProducts','German','id_transaction_from','\x20Order\x20Number\x20:\x20','padStart','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','8994RvQIPJ','filter','floor','adjustment\x20data\x20update\x20successfully','sendMail','findOne','$product_details.primary_code','$date','New_Qty_Converted_adj','Secondary_units','True','minus','types','Error\x20Occurs','exports','</body></html>','catch','random','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product','/view/:id','Arabic\x20(ae)','$name','$product_details.product_stock','redirect','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','slice','False','\x20<>\x20','Logo.png','max_per_unit','10KSKJNF','back','\x20Order\x20Date\x20:\x20','$invoice','prod_cat','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','batch_code','secondary_unit','$room','foreach\x20newproduct','unit','/view/add_adjustment','_id','port','Level','image','Floor','$finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','language','Adjustment\x20Mail','add_adjustment','Portuguese\x20(BR)','stock','$product_details.batch_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/view','product_code','$product_details.storage','password','primary_code','createTransport','Enclosed','production_date','$product_details.floorlevel','<tbody\x20style=\x22text-align:\x20center;\x22>','role','</table>','Raw\x20Materials','$product_details','An\x20error\x20occurred\x20while\x20saving\x20data.','$product.product_name','nodemailer','prod_invoice','../middleware/auth','success','forEach','RMSEmail','$product_details.product_code','16616MbSBhW','ADJ-','</tr>','574570wyjalS','393180QSIivN','warehouse','date','Shelves','$product_details.isle','toString','invoice','/upload/','adjustment\x20Finalized\x20successfully','email','$product_details.secondary_unit','Rooms','1224971nkbPzg','prod_name','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.unit','user','/../public','$product_details.bay','isAllowEdit','split','<table\x20style=\x22width:\x20100%\x20!important;\x22>','edit_adjustment_view','/preview/:id','Receiving\x20Area','</div>','New_Qty_Converted','Email\x20sent\x20successfully','<strong>\x20Regards\x20</strong>','bin','$product_details.pallet','</head><body>','<hr\x20class=\x22my-3\x22>','get','push','post','prime1','rack','new_adjust_qty','maxperunit','/adjustment/view','level','room_names','$_id','$product_details.expiry_date','$product_details._id','length','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Enabled','\x20</h2>','/barcode_scanner','Portuguese','params','$warehouse_name','$product_details.type','$product_details.product_name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','1389100mRGbod','body','<div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Return\x20Goods','$product','errors','adjust_qty','string','</thead>','flash','aggregate','$product_details.bin','then','<h5\x20style=\x22text-align:\x20left;\x22>','<!DOCTYPE\x20html>','</td>','warehouse_name','log','json','expiry_date','id_transaction','$product_details.secondary_code','site_title','$product_details.production_date','$product_details.maxPerUnit','Chinese','message','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','error','findById','floorlevel','English\x20(US)','save','status','French','product_details','stockBefore','English','prod_code','Primary_Units','bay','</h5>','351qiFlAu','express','/adjustment/preview/','$product_details.product_cat','type','render','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','storage','$product_details.invoice','staff','Return\x20Rooms','</tbody>','$product_details.rack','room','adjustment\x20add\x20successfull','Router','<span\x20style=\x22float:\x20right;\x22>','1214ICeLpg','secondary_code','2QAwGLt','$product_details.level','3794qjcmWX','finalize','Hindi','master','second1','product_stock'];a0_0x3b7a=function(){return _0x385ae1;};return a0_0x3b7a();}router[a0_0xd14ba9(0x116)](a0_0xd14ba9(0xca),auth,async(_0x15c784,_0x4225ce)=>{var _0x2ac298=a0_0xd14ba9;try{const {username:_0x2f6022,email:_0x44a9bf,role:_0x2901e3}=_0x15c784[_0x2ac298(0x105)],_0x424878=_0x15c784[_0x2ac298(0x105)],_0x4af46e=await profile[_0x2ac298(0xa5)]({'email':_0x424878[_0x2ac298(0xfd)]}),_0x2041c3=await master_shop[_0x2ac298(0x124)]();let _0x204c88;if(_0x424878[_0x2ac298(0xe3)]==_0x2ac298(0x85)){const _0x91aee9=await staff[_0x2ac298(0xa5)]({'email':_0x424878[_0x2ac298(0xfd)]});_0x204c88=await warehouse[_0x2ac298(0x13a)]([{'$match':{'status':_0x2ac298(0x126),'name':_0x91aee9[_0x2ac298(0xf5)],'warehouse_category':_0x2ac298(0xe5),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x2ac298(0xb6),'name':{'$first':'$name'}}}]);}else _0x204c88=await warehouse[_0x2ac298(0x13a)]([{'$match':{'status':_0x2ac298(0x126),'warehouse_category':_0x2ac298(0xe5),'name':{'$ne':_0x2ac298(0x133)}}},{'$group':{'_id':_0x2ac298(0xb6),'name':{'$first':_0x2ac298(0xb6)}}}]);const _0x3554ed=await product[_0x2ac298(0x124)]({}),_0x4c65ae=await adjustment[_0x2ac298(0x124)]({}),_0xf923e5=_0x4c65ae[_0x2ac298(0x123)]+0x1,_0xb8f16='ADJ-'+_0xf923e5[_0x2ac298(0xf9)]()[_0x2ac298(0x9e)](0x5,'0');var _0x273ea8=['Ambient',_0x2ac298(0xdf),_0x2ac298(0x86)];if(_0x2041c3[0x0][_0x2ac298(0xd2)]=='English\x20(US)')var _0x4364d1=users[_0x2ac298(0x155)];else{if(_0x2041c3[0x0][_0x2ac298(0xd2)]==_0x2ac298(0x93))var _0x4364d1=users[_0x2ac298(0x93)];else{if(_0x2041c3[0x0][_0x2ac298(0xd2)]==_0x2ac298(0x9b))var _0x4364d1=users[_0x2ac298(0x9b)];else{if(_0x2041c3[0x0][_0x2ac298(0xd2)]=='Spanish')var _0x4364d1=users[_0x2ac298(0x99)];else{if(_0x2041c3[0x0][_0x2ac298(0xd2)]=='French')var _0x4364d1=users[_0x2ac298(0x152)];else{if(_0x2041c3[0x0][_0x2ac298(0xd2)]==_0x2ac298(0xd5))var _0x4364d1=users[_0x2ac298(0x129)];else{if(_0x2041c3[0x0][_0x2ac298(0xd2)]==_0x2ac298(0x149))var _0x4364d1=users['Chinese'];else{if(_0x2041c3[0x0][_0x2ac298(0xd2)]==_0x2ac298(0xb5))var _0x4364d1=users['Arabic'];}}}}}}}const _0x3abf08=getRandom8DigitNumber();_0x3abf08['then'](_0x108d54=>{var _0x393dc8=_0x2ac298;_0x4225ce[_0x393dc8(0x81)](_0x393dc8(0xd4),{'success':_0x15c784['flash']('success'),'errors':_0x15c784['flash'](_0x393dc8(0x135)),'role':_0x424878,'profile':_0x4af46e,'warehouse':_0x204c88,'product':_0x3554ed,'master_shop':_0x2041c3,'language':_0x4364d1,'rooms_data':_0x273ea8,'invoice_no':_0x108d54});})[_0x2ac298(0xb0)](_0x4756c0=>{var _0x1e0df5=_0x2ac298;_0x15c784['flash'](_0x1e0df5(0x135),_0x1e0df5(0x12e)),_0x4225ce['redirect'](_0x1e0df5(0x11d));});}catch(_0x522a1a){console[_0x2ac298(0x141)](_0x522a1a);}}),router[a0_0xd14ba9(0x118)]('/view/add_adjustment',auth,async(_0xcab4f8,_0x2e5a2d)=>{var _0x25fc0b=a0_0xd14ba9;try{const {warehouse_name:_0x150dff,date:_0x1907a7,prod_name:_0x7f1dbc,level:_0x361f3d,isle:_0x3aaa5b,pallet:_0x459bf5,stock:_0x19fb9e,types:_0x56d1af,adjust_qty:_0x111705,new_adjust_qty:_0x37553c,note:_0x1908f4,Room_name:_0x326df3,invoice:_0x325090,JO_number:_0x10fb53,expiry_date:_0x10f3d2}=_0xcab4f8[_0x25fc0b(0x130)];if(typeof _0x7f1dbc==_0x25fc0b(0x137))var _0x2144cb=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0x101)]],_0x431bc1=[_0xcab4f8[_0x25fc0b(0x130)]['level']],_0x24f587=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xd6)]],_0x257b3a=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xac)]],_0x111a85=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xa8)]],_0x4b1f4a=[_0xcab4f8[_0x25fc0b(0x130)]['New_Qty_Converted']],_0xb98fb=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0x157)]],_0x215acc=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xa9)]],_0x5570e3=[_0xcab4f8['body'][_0x25fc0b(0x156)]],_0x1c3f8e=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xc5)]],_0x489838=[_0xcab4f8[_0x25fc0b(0x130)]['expiry_date']],_0x40aef2=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xbe)]],_0x384427=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xe0)]],_0x17534d=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xc3)]],_0x1c71ee=[_0xcab4f8[_0x25fc0b(0x130)]['Rooms']],_0x2095fe=[_0xcab4f8['body'][_0x25fc0b(0x119)]],_0xd916cf=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0x95)]],_0x529c05=[_0xcab4f8['body'][_0x25fc0b(0xea)]],_0x191ea5=[_0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0x144)]];else var _0x2144cb=[..._0xcab4f8['body'][_0x25fc0b(0x101)]],_0x431bc1=[..._0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0x11e)]],_0x24f587=[..._0xcab4f8['body']['stock']],_0x257b3a=[..._0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xac)]],_0x111a85=[..._0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xa8)]],_0x4b1f4a=[..._0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0x10f)]],_0xb98fb=[..._0xcab4f8['body'][_0x25fc0b(0xc9)]],_0x215acc=[..._0xcab4f8['body'][_0x25fc0b(0xa9)]],_0x5570e3=[..._0xcab4f8['body'][_0x25fc0b(0x156)]],_0x1c3f8e=[..._0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xc5)]],_0x489838=[..._0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0x143)]],_0x40aef2=[..._0xcab4f8['body'][_0x25fc0b(0xbe)]],_0x384427=[..._0xcab4f8['body'][_0x25fc0b(0xe0)]],_0x17534d=[..._0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0xc3)]],_0x1c71ee=[..._0xcab4f8['body']['Rooms']],_0x2095fe=[..._0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0x119)]],_0xd916cf=[..._0xcab4f8['body'][_0x25fc0b(0x95)]],_0x529c05=[..._0xcab4f8['body'][_0x25fc0b(0xea)]],_0x191ea5=[..._0xcab4f8[_0x25fc0b(0x130)][_0x25fc0b(0x144)]];const _0x23a1fb=_0x2144cb[_0x25fc0b(0x97)](_0x15f2e0=>{return _0x15f2e0={'product_name':_0x15f2e0};});_0x431bc1[_0x25fc0b(0xed)]((_0x2711be,_0x125132)=>{var _0x3cb86b=_0x25fc0b;_0x1c71ee[_0x3cb86b(0xed)]((_0x5f5d0e,_0xcbe105)=>{var _0x31f2f7=_0x3cb86b;if(_0x5f5d0e==_0x31f2f7(0x10d)&&_0x125132==_0xcbe105){var _0x5c00b7=_0x2711be[_0x31f2f7(0xba)](0x3);_0x23a1fb[_0x125132][_0x31f2f7(0x83)]=_0x2711be[0x0],_0x23a1fb[_0x125132]['rack']=_0x2711be[0x1],_0x23a1fb[_0x125132][_0x31f2f7(0x158)]=0x0,_0x23a1fb[_0x125132][_0x31f2f7(0x112)]=0x0,_0x23a1fb[_0x125132][_0x31f2f7(0x80)]=_0x31f2f7(0xcf),_0x23a1fb[_0x125132]['floorlevel']=_0x5c00b7;}else{if(_0x5f5d0e==_0x31f2f7(0xf7)&&_0x125132==_0xcbe105){var _0x5c00b7=_0x2711be[_0x31f2f7(0xba)](0x3);_0x23a1fb[_0x125132][_0x31f2f7(0x83)]=_0x2711be[0x0],_0x23a1fb[_0x125132][_0x31f2f7(0x11a)]=_0x2711be[0x1],_0x23a1fb[_0x125132][_0x31f2f7(0x158)]=0x0,_0x23a1fb[_0x125132][_0x31f2f7(0x112)]=0x0,_0x23a1fb[_0x125132][_0x31f2f7(0x80)]=_0x31f2f7(0xcf),_0x23a1fb[_0x125132]['floorlevel']=_0x2711be[0x5];}else{if(_0x125132==_0xcbe105){var _0x504951;if(_0x2711be[0x4]=='L')_0x504951=_0x31f2f7(0xcd);else _0x2711be[0x4]=='F'&&(_0x504951=_0x31f2f7(0xcf));_0x23a1fb[_0x125132][_0x31f2f7(0x83)]=_0x2711be[0x0],_0x23a1fb[_0x125132][_0x31f2f7(0x11a)]=_0x2711be[0x1],_0x23a1fb[_0x125132][_0x31f2f7(0x158)]=_0x2711be[0x2],_0x23a1fb[_0x125132][_0x31f2f7(0x112)]=_0x2711be[0x3],_0x23a1fb[_0x125132]['type']=_0x504951,_0x23a1fb[_0x125132][_0x31f2f7(0x14e)]=_0x2711be[0x5];}}}});}),_0x24f587[_0x25fc0b(0xed)]((_0x4cbcfb,_0x3c141f)=>{var _0x25e60b=_0x25fc0b;_0x23a1fb[_0x3c141f][_0x25e60b(0x154)]=_0x4cbcfb;}),_0x191ea5[_0x25fc0b(0xed)]((_0x3c7787,_0xe2f93)=>{_0x23a1fb[_0xe2f93]['id_transaction_from']=_0x3c7787;}),_0x257b3a[_0x25fc0b(0xed)]((_0x1fa20b,_0x7d8dcb)=>{var _0x3d633e=_0x25fc0b;_0x23a1fb[_0x7d8dcb][_0x3d633e(0xac)]=_0x1fa20b;}),_0x111a85['forEach']((_0x1e63c5,_0x5b273d)=>{var _0x39931b=_0x25fc0b;_0x23a1fb[_0x5b273d][_0x39931b(0x136)]=_0x1e63c5;}),_0x4b1f4a[_0x25fc0b(0xed)]((_0x40cbb0,_0x1831d3)=>{_0x23a1fb[_0x1831d3]['new_adjust_qty']=_0x40cbb0;}),_0xb98fb[_0x25fc0b(0xed)]((_0x59a5a5,_0xeac60e)=>{var _0x31abf4=_0x25fc0b;_0x23a1fb[_0xeac60e][_0x31abf4(0xc9)]=_0x59a5a5;}),_0x215acc[_0x25fc0b(0xed)]((_0x1b6e0b,_0x2b3ee6)=>{var _0x404b69=_0x25fc0b;_0x23a1fb[_0x2b3ee6][_0x404b69(0xc6)]=_0x1b6e0b;}),_0x5570e3[_0x25fc0b(0xed)]((_0x12a365,_0x3add3a)=>{var _0x5d8c5d=_0x25fc0b;_0x23a1fb[_0x3add3a][_0x5d8c5d(0xda)]=_0x12a365;}),_0x1c3f8e[_0x25fc0b(0xed)]((_0x5186a4,_0x3efe4b)=>{var _0x9ec3ac=_0x25fc0b;_0x23a1fb[_0x3efe4b][_0x9ec3ac(0xc5)]=_0x5186a4;}),_0x489838[_0x25fc0b(0xed)]((_0x464586,_0x16c86d)=>{var _0x19e703=_0x25fc0b;_0x23a1fb[_0x16c86d][_0x19e703(0x143)]=_0x464586;}),_0x40aef2['forEach']((_0x54f846,_0x369e48)=>{var _0x81ca34=_0x25fc0b;_0x23a1fb[_0x369e48][_0x81ca34(0x11c)]=_0x54f846;}),_0x384427[_0x25fc0b(0xed)]((_0xc8eb43,_0x2531a5)=>{_0x23a1fb[_0x2531a5]['production_date']=_0xc8eb43;}),_0x17534d[_0x25fc0b(0xed)]((_0x2386b0,_0x43423e)=>{var _0x26e407=_0x25fc0b;_0x23a1fb[_0x43423e][_0x26e407(0xc3)]=_0x2386b0;}),_0x1c71ee[_0x25fc0b(0xed)]((_0x397f21,_0x4f7b02)=>{var _0x248200=_0x25fc0b;_0x23a1fb[_0x4f7b02][_0x248200(0x11f)]=_0x397f21;}),_0x2095fe[_0x25fc0b(0xed)]((_0x4b182d,_0x547f3)=>{var _0x216333=_0x25fc0b;_0x23a1fb[_0x547f3][_0x216333(0xdd)]=_0x4b182d;}),_0xd916cf['forEach']((_0x58b6fb,_0x51e9e4)=>{_0x23a1fb[_0x51e9e4]['secondary_code']=_0x58b6fb;}),_0x529c05['forEach']((_0x6dad7d,_0xc617c2)=>{_0x23a1fb[_0xc617c2]['invoice']=_0x6dad7d;});const _0x2c90c9=_0x23a1fb[_0x25fc0b(0xa1)](_0x5c5f44=>_0x5c5f44[_0x25fc0b(0x136)]!=='0'&&_0x5c5f44[_0x25fc0b(0x136)]!=='');var _0x447709=0x0;_0x2c90c9[_0x25fc0b(0xed)](_0x252908=>{var _0x3ccd0e=_0x25fc0b;console[_0x3ccd0e(0x141)](_0x3ccd0e(0xc8),_0x252908),parseInt(_0x252908['adjust_qty'])<=0x0&&_0x447709++;});if(_0x447709!=0x0)return _0xcab4f8[_0x25fc0b(0x139)](_0x25fc0b(0x135),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x2e5a2d[_0x25fc0b(0xb8)]('back');const _0x1018bd=new adjustment({'warehouse_name':_0x150dff,'date':_0x1907a7,'product':_0x2c90c9,'note':_0x1908f4,'room':_0x326df3,'invoice':_0x325090,'JO_number':_0x10fb53,'expiry_date':_0x10f3d2}),_0x31ca4e=await _0x1018bd[_0x25fc0b(0x150)]();_0xcab4f8[_0x25fc0b(0x139)](_0x25fc0b(0xec),_0x25fc0b(0x8a)),_0x2e5a2d[_0x25fc0b(0xb8)](_0x25fc0b(0x7e)+_0x31ca4e[_0x25fc0b(0xcb)]);}catch(_0x418fcb){console[_0x25fc0b(0x141)](_0x418fcb),_0x2e5a2d[_0x25fc0b(0x151)](0xc8)[_0x25fc0b(0x142)]({'message':_0x418fcb['message']});}}),router[a0_0xd14ba9(0x116)]('/preview/:id',auth,async(_0xc5c0da,_0x385664)=>{var _0x1fe1b8=a0_0xd14ba9;try{const {username:_0x219118,email:_0x511d3c,role:_0x528259}=_0xc5c0da[_0x1fe1b8(0x105)],_0xcbd9f5=_0xc5c0da[_0x1fe1b8(0x105)],_0x366484=await profile[_0x1fe1b8(0xa5)]({'email':_0xcbd9f5[_0x1fe1b8(0xfd)]}),_0x552575=await master_shop[_0x1fe1b8(0x124)](),_0x210edb=_0xc5c0da['params']['id'],_0x45cbfd=await adjustment[_0x1fe1b8(0x14d)]({'_id':_0x210edb}),_0x450714=await purchases[_0x1fe1b8(0x13a)]([{'$match':{'warehouse_name':_0x45cbfd[_0x1fe1b8(0x140)]}},{'$unwind':_0x1fe1b8(0x134)},{'$group':{'_id':_0x1fe1b8(0xe8)}}]),_0x3ecd57=await product['find']({}),_0x2837b6=await warehouse['aggregate']([{'$match':{'name':_0x45cbfd[_0x1fe1b8(0x140)]}},{'$unwind':_0x1fe1b8(0xe6)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1fe1b8(0x12d)},'product_stock':{'$first':_0x1fe1b8(0xb7)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1fe1b8(0x13b)},'type':{'$first':_0x1fe1b8(0x12c)},'floorlevel':{'$first':_0x1fe1b8(0xe1)},'primary_code':{'$first':_0x1fe1b8(0xa6)},'secondary_code':{'$first':_0x1fe1b8(0x145)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x1fe1b8(0xdb)},'rack':{'$first':_0x1fe1b8(0x88)},'maxPerUnit':{'$first':_0x1fe1b8(0x148)},'expiry_date':{'$first':_0x1fe1b8(0x121)},'production_date':{'$first':_0x1fe1b8(0x147)},'batch_code':{'$first':_0x1fe1b8(0xd7)},'room':{'$first':'$room'}}}]);if(_0x552575[0x0][_0x1fe1b8(0xd2)]==_0x1fe1b8(0x14f)){var _0x519629=users[_0x1fe1b8(0x155)];console[_0x1fe1b8(0x141)](_0x519629);}else{if(_0x552575[0x0][_0x1fe1b8(0xd2)]=='Hindi')var _0x519629=users[_0x1fe1b8(0x93)];else{if(_0x552575[0x0][_0x1fe1b8(0xd2)]==_0x1fe1b8(0x9b))var _0x519629=users[_0x1fe1b8(0x9b)];else{if(_0x552575[0x0][_0x1fe1b8(0xd2)]==_0x1fe1b8(0x99))var _0x519629=users['Spanish'];else{if(_0x552575[0x0][_0x1fe1b8(0xd2)]=='French')var _0x519629=users['French'];else{if(_0x552575[0x0][_0x1fe1b8(0xd2)]==_0x1fe1b8(0xd5))var _0x519629=users[_0x1fe1b8(0x129)];else{if(_0x552575[0x0]['language']==_0x1fe1b8(0x149))var _0x519629=users['Chinese'];else{if(_0x552575[0x0]['language']==_0x1fe1b8(0xb5))var _0x519629=users['Arabic'];}}}}}}}_0x385664[_0x1fe1b8(0x81)](_0x1fe1b8(0x10b),{'success':_0xc5c0da['flash'](_0x1fe1b8(0xec)),'errors':_0xc5c0da[_0x1fe1b8(0x139)]('errors'),'role':_0xcbd9f5,'profile':_0x366484,'adjustment':_0x45cbfd,'stock':_0x2837b6,'master_shop':_0x552575,'warehouse_name':_0x450714,'unit':_0x3ecd57,'language':_0x519629});}catch(_0x5d9a58){console['log'](_0x5d9a58),_0x385664[_0x1fe1b8(0x151)](0xc8)[_0x1fe1b8(0x142)]({'message':_0x5d9a58['message']});}}),router[a0_0xd14ba9(0x118)](a0_0xd14ba9(0x10c),auth,async(_0x1020b9,_0x3817a5)=>{var _0x55f879=a0_0xd14ba9;try{const _0x25bc13=_0x1020b9['params']['id'],{warehouse_name:_0x376713,Room_name:_0x5f375b}=_0x1020b9[_0x55f879(0x130)],_0x5c86c2=await adjustment[_0x55f879(0x14d)]({'_id':_0x25bc13}),_0x2250c5=_0x5c86c2[_0x55f879(0xb3)][_0x55f879(0x97)](async _0x1722e6=>{var _0x223f00=_0x55f879;if(_0x1722e6['adjust_qty']>0x0){var _0x114d05=await warehouse['findOne']({'name':_0x376713,'room':_0x1722e6['room_names'],'warehouse_category':_0x223f00(0xe5)});const _0x41401e=_0x114d05[_0x223f00(0x153)]['map'](_0x5213e4=>{var _0x2009df=_0x223f00;console[_0x2009df(0x141)](_0x1722e6[_0x2009df(0xac)]+_0x2009df(0xbc));if(_0x1722e6[_0x2009df(0xac)]==_0x2009df(0xab)){if(_0x5213e4[_0x2009df(0x98)]==_0x1722e6[_0x2009df(0x98)]&&_0x5213e4[_0x2009df(0x14e)]==_0x1722e6[_0x2009df(0x14e)]&&_0x5213e4[_0x2009df(0x80)]==_0x1722e6[_0x2009df(0x80)]&&_0x5213e4['bin']==_0x1722e6['bin']&&_0x5213e4[_0x2009df(0x158)]==_0x1722e6[_0x2009df(0x158)]&&_0x5213e4[_0x2009df(0x11a)]==_0x1722e6[_0x2009df(0x11a)]&&_0x5213e4[_0x2009df(0x83)]==_0x1722e6[_0x2009df(0x83)]&&_0x5213e4['expiry_date']==_0x1722e6[_0x2009df(0x143)]&&_0x5213e4['batch_code']==_0x1722e6[_0x2009df(0xc5)]&&_0x5213e4[_0x2009df(0xe0)]==_0x1722e6[_0x2009df(0xe0)]&&_0x5213e4[_0x2009df(0xfa)]==_0x1722e6['invoice']&&_0x5213e4[_0x2009df(0xcb)]==_0x1722e6['id_transaction_from']){var _0x24ef91;_0x24ef91=_0x1722e6[_0x2009df(0x136)],_0x1722e6[_0x2009df(0xc3)]=='S'&&(_0x24ef91=_0x1722e6[_0x2009df(0x136)]),_0x5213e4[_0x2009df(0x96)]=_0x5213e4[_0x2009df(0x96)]-_0x24ef91;}}else{if(_0x5213e4['product_name']==_0x1722e6[_0x2009df(0x98)]&&_0x5213e4[_0x2009df(0x14e)]==_0x1722e6[_0x2009df(0x14e)]&&_0x5213e4[_0x2009df(0x80)]==_0x1722e6[_0x2009df(0x80)]&&_0x5213e4[_0x2009df(0x112)]==_0x1722e6[_0x2009df(0x112)]&&_0x5213e4[_0x2009df(0x158)]==_0x1722e6[_0x2009df(0x158)]&&_0x5213e4[_0x2009df(0x11a)]==_0x1722e6[_0x2009df(0x11a)]&&_0x5213e4[_0x2009df(0x83)]==_0x1722e6[_0x2009df(0x83)]&&_0x5213e4[_0x2009df(0x143)]==_0x1722e6[_0x2009df(0x143)]&&_0x5213e4[_0x2009df(0xc5)]==_0x1722e6[_0x2009df(0xc5)]&&_0x5213e4['production_date']==_0x1722e6[_0x2009df(0xe0)]&&_0x5213e4['invoice']==_0x1722e6[_0x2009df(0xfa)]&&_0x5213e4[_0x2009df(0xcb)]==_0x1722e6[_0x2009df(0x9c)]){console[_0x2009df(0x141)](_0x1722e6);var _0x24ef91;_0x24ef91=_0x1722e6[_0x2009df(0x136)],_0x1722e6[_0x2009df(0xc3)]=='S'&&(_0x24ef91=_0x1722e6[_0x2009df(0x136)]),_0x5213e4[_0x2009df(0x96)]=_0x5213e4[_0x2009df(0x96)]+_0x24ef91;}}});}return _0x114d05;});Promise['all'](_0x2250c5)[_0x55f879(0x13c)](async _0x26bc2e=>{var _0x486721=_0x55f879;try{for(const _0x20ea01 of _0x26bc2e){await _0x20ea01[_0x486721(0x150)]();}_0x5c86c2[_0x486721(0x92)]=_0x486721(0xaa);const _0x2ca33d=await _0x5c86c2['save'](),_0x3eeeec=await master_shop['find'](),_0x33ac8b=await email_settings[_0x486721(0xa5)](),_0x1a0a0d=await supervisor_settings[_0x486721(0x124)]();var _0x455451=_0x5c86c2[_0x486721(0xb3)],_0x7945c0='',_0x39704a;for(_0x39704a in _0x455451){_0x7945c0+='<tr>'+_0x486721(0xb2)+_0x455451[_0x39704a][_0x486721(0x98)]+'</td>'+_0x486721(0xb2)+_0x455451[_0x39704a][_0x486721(0xda)]+_0x486721(0x13f)+_0x486721(0xb2)+_0x455451[_0x39704a][_0x486721(0x136)]+_0x486721(0x13f)+_0x486721(0xb2)+_0x455451[_0x39704a]['unit']+'</td>'+_0x486721(0xb2)+_0x455451[_0x39704a][_0x486721(0xc6)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5c86c2['warehouse_name']+_0x486721(0x13f)+_0x486721(0xb2)+_0x455451[_0x39704a]['room_names']+_0x486721(0x13f)+_0x486721(0xb2)+_0x455451[_0x39704a][_0x486721(0x83)]+_0x455451[_0x39704a][_0x486721(0x11a)]+_0x455451[_0x39704a][_0x486721(0x158)]+_0x455451[_0x39704a][_0x486721(0x112)]+_0x455451[_0x39704a]['type'][0x0]+_0x455451[_0x39704a]['floorlevel']+_0x486721(0x13f),_0x486721(0xf2);}let _0x372ea9=nodemailer[_0x486721(0xde)]({'host':_0x33ac8b['host'],'port':Number(_0x33ac8b[_0x486721(0xcc)]),'secure':![],'auth':{'user':_0x33ac8b['email'],'pass':_0x33ac8b[_0x486721(0xdc)]}}),_0x497a8d={'from':_0x33ac8b[_0x486721(0xfd)],'to':_0x1a0a0d[0x0][_0x486721(0xee)],'subject':_0x486721(0xd3),'attachments':[{'filename':_0x486721(0xbd),'path':__dirname+_0x486721(0x106)+_0x486721(0xfb)+_0x3eeeec[0x0][_0x486721(0xce)],'cid':'logo'}],'html':_0x486721(0x13e)+'<html><head><title></title>'+_0x486721(0x114)+_0x486721(0x131)+_0x486721(0x82)+_0x486721(0x131)+_0x486721(0x14b)+_0x486721(0x10e)+_0x486721(0x131)+'<h2>\x20'+_0x3eeeec[0x0][_0x486721(0x146)]+_0x486721(0x127)+_0x486721(0x10e)+_0x486721(0x10e)+_0x486721(0x115)+_0x486721(0x131)+_0x486721(0x13d)+_0x486721(0x9d)+_0x5c86c2[_0x486721(0xfa)]+'\x20'+_0x486721(0x8c)+_0x486721(0xc1)+_0x5c86c2[_0x486721(0xf6)]+'\x20'+'</span>'+_0x486721(0x159)+_0x486721(0x10e)+_0x486721(0x10a)+_0x486721(0xd8)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x486721(0x9f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x486721(0x103)+_0x486721(0x132)+_0x486721(0xd1)+_0x486721(0xb9)+_0x486721(0x125)+'</tr>'+_0x486721(0x138)+_0x486721(0xe2)+'\x20'+_0x7945c0+'\x20'+_0x486721(0x87)+_0x486721(0xe4)+_0x486721(0x131)+_0x486721(0x111)+'<h5>'+_0x3eeeec[0x0][_0x486721(0x146)]+_0x486721(0x159)+_0x486721(0x10e)+_0x486721(0x10e)+_0x486721(0xaf)};_0x372ea9[_0x486721(0xa4)](_0x497a8d,function(_0x33b074,_0x6e6adc){var _0xb64833=_0x486721;_0x33b074?(console[_0xb64833(0x141)](_0x33b074),console[_0xb64833(0x141)](_0xb64833(0xad))):console[_0xb64833(0x141)](_0xb64833(0x110));}),_0x1020b9[_0x486721(0x139)](_0x486721(0xec),_0x486721(0xfc)),_0x3817a5[_0x486721(0xb8)]('/picking_list/PDF_adjustment_rm/'+_0x2ca33d[_0x486721(0xcb)]);}catch(_0x5883c4){console[_0x486721(0x14c)](_0x5883c4),_0x3817a5[_0x486721(0x151)](0x1f4)['json']({'error':_0x486721(0xe7)});}})[_0x55f879(0xb0)](_0x36c238=>{var _0xf5ad73=_0x55f879;console[_0xf5ad73(0x14c)](_0x36c238),_0x3817a5[_0xf5ad73(0x151)](0x1f4)[_0xf5ad73(0x142)]({'error':'An\x20error\x20occurred.'});});}catch(_0x5bfe66){console['log'](_0x5bfe66),_0x3817a5[_0x55f879(0x151)](0xc8)[_0x55f879(0x142)]({'message':_0x5bfe66[_0x55f879(0x14a)]});}}),router[a0_0xd14ba9(0x116)](a0_0xd14ba9(0xb4),auth,async(_0x5c8caf,_0x548d9d)=>{var _0x283a94=a0_0xd14ba9;try{const {username:_0x4bfd09,email:_0x7a57b3,role:_0x3ce467}=_0x5c8caf[_0x283a94(0x105)],_0x4df491=_0x5c8caf[_0x283a94(0x105)],_0x33cfbf=await profile[_0x283a94(0xa5)]({'email':_0x4df491[_0x283a94(0xfd)]}),_0x410a2d=await master_shop[_0x283a94(0x124)](),_0xdf1d5b=_0x5c8caf[_0x283a94(0x12a)]['id'],_0x43d4f7=await adjustment['findById']({'_id':_0xdf1d5b}),_0x10d2b0=await purchases[_0x283a94(0x13a)]([{'$match':{'warehouse_name':_0x43d4f7[_0x283a94(0x140)]}},{'$unwind':_0x283a94(0x134)},{'$group':{'_id':_0x283a94(0xe8)}}]),_0x419764=await product['find']({}),_0x240c09=await warehouse[_0x283a94(0x13a)]([{'$match':{'name':_0x43d4f7[_0x283a94(0x140)]}},{'$unwind':_0x283a94(0xe6)},{'$group':{'_id':_0x283a94(0x122),'name':{'$first':_0x283a94(0x12d)},'product_stock':{'$first':_0x283a94(0xb7)},'bay':{'$first':_0x283a94(0x107)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x283a94(0xe1)},'primary_code':{'$first':_0x283a94(0xa6)},'secondary_code':{'$first':_0x283a94(0x145)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x283a94(0x148)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x283a94(0x147)},'batch_code':{'$first':_0x283a94(0xd7)},'room':{'$first':_0x283a94(0xc7)}}}]);let _0x3d596b;if(_0x4df491[_0x283a94(0xe3)]==_0x283a94(0x85)){const _0x344254=await staff[_0x283a94(0xa5)]({'email':_0x4df491[_0x283a94(0xfd)]});_0x3d596b=await warehouse[_0x283a94(0x13a)]([{'$match':{'status':_0x283a94(0x126),'name':_0x344254[_0x283a94(0xf5)],'warehouse_category':_0x283a94(0xe5),'name':{'$ne':_0x283a94(0x133)}}},{'$group':{'_id':_0x283a94(0xb6),'name':{'$first':_0x283a94(0xb6)}}}]);}else _0x3d596b=await warehouse[_0x283a94(0x13a)]([{'$match':{'status':_0x283a94(0x126),'warehouse_category':_0x283a94(0xe5),'name':{'$ne':_0x283a94(0x133)}}},{'$group':{'_id':'$name','name':{'$first':_0x283a94(0xb6)}}}]);if(_0x410a2d[0x0][_0x283a94(0xd2)]==_0x283a94(0x14f)){var _0x51174a=users[_0x283a94(0x155)];console[_0x283a94(0x141)](_0x51174a);}else{if(_0x410a2d[0x0][_0x283a94(0xd2)]==_0x283a94(0x93))var _0x51174a=users[_0x283a94(0x93)];else{if(_0x410a2d[0x0]['language']=='German')var _0x51174a=users[_0x283a94(0x9b)];else{if(_0x410a2d[0x0][_0x283a94(0xd2)]==_0x283a94(0x99))var _0x51174a=users[_0x283a94(0x99)];else{if(_0x410a2d[0x0][_0x283a94(0xd2)]==_0x283a94(0x152))var _0x51174a=users['French'];else{if(_0x410a2d[0x0]['language']==_0x283a94(0xd5))var _0x51174a=users['Portuguese'];else{if(_0x410a2d[0x0][_0x283a94(0xd2)]==_0x283a94(0x149))var _0x51174a=users[_0x283a94(0x149)];else{if(_0x410a2d[0x0][_0x283a94(0xd2)]==_0x283a94(0xb5))var _0x51174a=users[_0x283a94(0x102)];}}}}}}}_0x548d9d[_0x283a94(0x81)]('edit_adjustment',{'success':_0x5c8caf[_0x283a94(0x139)](_0x283a94(0xec)),'errors':_0x5c8caf['flash'](_0x283a94(0x135)),'role':_0x4df491,'profile':_0x33cfbf,'adjustment':_0x43d4f7,'stock':_0x240c09,'master_shop':_0x410a2d,'warehouse_name':_0x10d2b0,'unit':_0x419764,'language':_0x51174a,'warehouse':_0x3d596b});}catch(_0x248eb5){console[_0x283a94(0x141)](_0x248eb5),_0x548d9d['status'](0xc8)['json']({'message':_0x248eb5[_0x283a94(0x14a)]});}}),router['post'](a0_0xd14ba9(0xb4),auth,async(_0x4c1a05,_0x5b867d)=>{var _0x570463=a0_0xd14ba9;try{const _0x2c4dc3=_0x4c1a05[_0x570463(0x12a)]['id'],_0x168637=await adjustment[_0x570463(0x14d)]({'_id':_0x2c4dc3}),_0x37b3cd=await warehouse['findOne']({'name':_0x168637['warehouse_name'],'room':_0x168637[_0x570463(0x89)]}),{warehouse_name:_0x545c46,date:_0x26a785,prod_name:_0x450b68,level:_0x4ef461,isle:_0x106c77,pallet:_0x2df768,stock:_0x75a2bd,types:_0x49bce6,adjust_qty:_0xcb84a2,new_adjust_qty:_0x24f961,note:_0x2bf222,Room_name:_0x3ae0c2,invoice:_0x4b4780,JO_number:_0x3be25a,expiry_date:_0x2a9409}=_0x4c1a05[_0x570463(0x130)];if(typeof _0x450b68==_0x570463(0x137))var _0x5a3c47=[_0x4c1a05[_0x570463(0x130)]['prod_name']],_0x3c38ce=[_0x4c1a05[_0x570463(0x130)][_0x570463(0x11e)]],_0x1e1dd5=[_0x4c1a05[_0x570463(0x130)]['stock']],_0x3c1f50=[_0x4c1a05[_0x570463(0x130)][_0x570463(0xac)]],_0x17bfa5=[_0x4c1a05[_0x570463(0x130)]['New_Qty_Converted_adj']],_0xf416b5=[_0x4c1a05['body'][_0x570463(0x10f)]],_0x84cd47=[_0x4c1a05[_0x570463(0x130)][_0x570463(0x157)]],_0x43b4a6=[_0x4c1a05[_0x570463(0x130)][_0x570463(0xa9)]],_0x26db70=[_0x4c1a05['body'][_0x570463(0x156)]],_0x5c1ecc=[_0x4c1a05['body'][_0x570463(0xc5)]],_0x23cf28=[_0x4c1a05['body'][_0x570463(0x143)]],_0x30064b=[_0x4c1a05['body']['max_per_unit']],_0x8627c9=[_0x4c1a05['body'][_0x570463(0xe0)]],_0x52b95b=[_0x4c1a05[_0x570463(0x130)][_0x570463(0xc3)]],_0x5601b9=[_0x4c1a05[_0x570463(0x130)][_0x570463(0xff)]],_0x164588=[_0x4c1a05['body'][_0x570463(0x119)]],_0x4687aa=[_0x4c1a05[_0x570463(0x130)][_0x570463(0x95)]];else var _0x5a3c47=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0x101)]],_0x3c38ce=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0x11e)]],_0x1e1dd5=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0xd6)]],_0x3c1f50=[..._0x4c1a05['body']['types']],_0x17bfa5=[..._0x4c1a05[_0x570463(0x130)]['New_Qty_Converted_adj']],_0xf416b5=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0x10f)]],_0x84cd47=[..._0x4c1a05['body'][_0x570463(0xc9)]],_0x43b4a6=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0xa9)]],_0x26db70=[..._0x4c1a05['body'][_0x570463(0x156)]],_0x5c1ecc=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0xc5)]],_0x23cf28=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0x143)]],_0x30064b=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0xbe)]],_0x8627c9=[..._0x4c1a05['body'][_0x570463(0xe0)]],_0x52b95b=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0xc3)]],_0x5601b9=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0xff)]],_0x164588=[..._0x4c1a05[_0x570463(0x130)][_0x570463(0x119)]],_0x4687aa=[..._0x4c1a05[_0x570463(0x130)]['second1']];const _0x1b36c2=_0x5a3c47[_0x570463(0x97)](_0x5b2784=>{return _0x5b2784={'product_name':_0x5b2784};});_0x3c38ce['forEach']((_0x24e5ca,_0xe2a98c)=>{var _0x295b06=_0x570463;_0x5601b9[_0x295b06(0xed)]((_0x3b59bf,_0x40649e)=>{var _0x24d07e=_0x295b06;if(_0x3b59bf==_0x24d07e(0x10d)&&_0xe2a98c==_0x40649e){var _0x1855ef=_0x24e5ca[_0x24d07e(0xba)](0x3);_0x1b36c2[_0xe2a98c][_0x24d07e(0x83)]=_0x24e5ca[0x0],_0x1b36c2[_0xe2a98c][_0x24d07e(0x11a)]=_0x24e5ca[0x1],_0x1b36c2[_0xe2a98c][_0x24d07e(0x158)]=0x0,_0x1b36c2[_0xe2a98c]['bin']=0x0,_0x1b36c2[_0xe2a98c][_0x24d07e(0x80)]=_0x24d07e(0xcf),_0x1b36c2[_0xe2a98c]['floorlevel']=_0x1855ef;}else{if(_0x3b59bf==_0x24d07e(0xf7)&&_0xe2a98c==_0x40649e){var _0x1855ef=_0x24e5ca['slice'](0x3);_0x1b36c2[_0xe2a98c][_0x24d07e(0x83)]=_0x24e5ca[0x0],_0x1b36c2[_0xe2a98c][_0x24d07e(0x11a)]=_0x24e5ca[0x1],_0x1b36c2[_0xe2a98c]['bay']=0x0,_0x1b36c2[_0xe2a98c][_0x24d07e(0x112)]=0x0,_0x1b36c2[_0xe2a98c][_0x24d07e(0x80)]='Floor',_0x1b36c2[_0xe2a98c][_0x24d07e(0x14e)]=_0x24e5ca[0x5];}else{if(_0xe2a98c==_0x40649e){var _0x41661b;if(_0x24e5ca[0x4]=='L')_0x41661b='Level';else _0x24e5ca[0x4]=='F'&&(_0x41661b=_0x24d07e(0xcf));_0x1b36c2[_0xe2a98c][_0x24d07e(0x83)]=_0x24e5ca[0x0],_0x1b36c2[_0xe2a98c][_0x24d07e(0x11a)]=_0x24e5ca[0x1],_0x1b36c2[_0xe2a98c][_0x24d07e(0x158)]=_0x24e5ca[0x2],_0x1b36c2[_0xe2a98c]['bin']=_0x24e5ca[0x3],_0x1b36c2[_0xe2a98c][_0x24d07e(0x80)]=_0x41661b,_0x1b36c2[_0xe2a98c][_0x24d07e(0x14e)]=_0x24e5ca[0x5];}}}});}),_0x1e1dd5[_0x570463(0xed)]((_0x43444b,_0x20361d)=>{_0x1b36c2[_0x20361d]['stockBefore']=_0x43444b;}),_0x3c1f50['forEach']((_0x5dbe7e,_0x588123)=>{var _0x6fba14=_0x570463;_0x1b36c2[_0x588123][_0x6fba14(0xac)]=_0x5dbe7e;}),_0x17bfa5[_0x570463(0xed)]((_0x1599f8,_0x5974cd)=>{_0x1b36c2[_0x5974cd]['adjust_qty']=_0x1599f8;}),_0xf416b5[_0x570463(0xed)]((_0x5c3e50,_0xe48991)=>{var _0x20fe17=_0x570463;_0x1b36c2[_0xe48991][_0x20fe17(0x11b)]=_0x5c3e50;}),_0x84cd47[_0x570463(0xed)]((_0x43777b,_0x2b8393)=>{var _0x578359=_0x570463;_0x1b36c2[_0x2b8393][_0x578359(0xc9)]=_0x43777b;}),_0x43b4a6[_0x570463(0xed)]((_0x4e3517,_0x53c3de)=>{_0x1b36c2[_0x53c3de]['secondary_unit']=_0x4e3517;}),_0x26db70['forEach']((_0x138ced,_0x5e5840)=>{var _0x1bcfb6=_0x570463;_0x1b36c2[_0x5e5840][_0x1bcfb6(0xda)]=_0x138ced;}),_0x5c1ecc[_0x570463(0xed)]((_0x3dce0c,_0x1df489)=>{_0x1b36c2[_0x1df489]['batch_code']=_0x3dce0c;}),_0x23cf28['forEach']((_0x4bb0fc,_0xf6c6b6)=>{var _0x2bc8cd=_0x570463;_0x1b36c2[_0xf6c6b6][_0x2bc8cd(0x143)]=_0x4bb0fc;}),_0x30064b['forEach']((_0x2d4d01,_0x3826c4)=>{_0x1b36c2[_0x3826c4]['maxperunit']=_0x2d4d01;}),_0x8627c9[_0x570463(0xed)]((_0xaa985b,_0x49e7b0)=>{_0x1b36c2[_0x49e7b0]['production_date']=_0xaa985b;}),_0x52b95b[_0x570463(0xed)]((_0xa910b3,_0x3ee213)=>{var _0x57e593=_0x570463;_0x1b36c2[_0x3ee213][_0x57e593(0xc3)]=_0xa910b3;}),_0x5601b9[_0x570463(0xed)]((_0x423575,_0x2c7fb8)=>{var _0xc67a7c=_0x570463;_0x1b36c2[_0x2c7fb8][_0xc67a7c(0x11f)]=_0x423575;}),_0x164588[_0x570463(0xed)]((_0x194ab1,_0x3574ce)=>{_0x1b36c2[_0x3574ce]['primary_code']=_0x194ab1;}),_0x4687aa[_0x570463(0xed)]((_0x2b2aee,_0x4d15c8)=>{var _0x76d698=_0x570463;_0x1b36c2[_0x4d15c8][_0x76d698(0x8e)]=_0x2b2aee;});const _0x41c248=_0x1b36c2[_0x570463(0xa1)](_0x53e4d4=>_0x53e4d4['adjust_qty']!=='0'&&_0x53e4d4[_0x570463(0x136)]!=='');var _0x415b58=0x0;_0x41c248[_0x570463(0xed)](_0x14119e=>{var _0x46bb50=_0x570463;console['log'](_0x46bb50(0xc8),_0x14119e),parseInt(_0x14119e[_0x46bb50(0x136)])<=0x0&&_0x415b58++;});if(_0x415b58!=0x0)return _0x4c1a05[_0x570463(0x139)]('errors',_0x570463(0xc4)),_0x5b867d[_0x570463(0xb8)](_0x570463(0xc0));_0x168637['warehouse_name']=_0x545c46,_0x168637[_0x570463(0xf6)]=_0x26a785,_0x168637[_0x570463(0xb3)]=_0x41c248,_0x168637['note']=_0x2bf222,_0x168637[_0x570463(0xfa)]=_0x4b4780,_0x168637[_0x570463(0x108)]=_0x570463(0xbb);const _0xd4e331=await _0x168637[_0x570463(0x150)]();_0x4c1a05[_0x570463(0x139)](_0x570463(0xec),_0x570463(0xa3)),_0x5b867d[_0x570463(0xb8)](_0x570463(0x11d));}catch(_0x554f10){console['log'](_0x554f10);}}),router[a0_0xd14ba9(0x118)](a0_0xd14ba9(0x128),async(_0x1ccaa6,_0x4a052c)=>{var _0x452ee4=a0_0xd14ba9;const {primary_code:_0x53a27b,warehouse_data:_0x45efb0,rooms_data:_0x16a9d7,Roomslist:_0x581da8}=_0x1ccaa6[_0x452ee4(0x130)],_0x1c5182=_0x581da8[_0x452ee4(0x109)](','),_0x2b3f24=[];async function _0x5b32d8(_0xe50c98){var _0x19fe23=_0x452ee4;const _0x3d99e9=await warehouse[_0x19fe23(0x13a)]([{'$match':{'name':_0x45efb0,'room':_0xe50c98}},{'$unwind':_0x19fe23(0xe6)},{'$match':{'product_details.primary_code':_0x53a27b}},{'$group':{'_id':_0x19fe23(0x122),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x19fe23(0xb7)},'primary_code':{'$first':_0x19fe23(0xa6)},'secondary_code':{'$first':_0x19fe23(0x145)},'product_code':{'$first':_0x19fe23(0xef)},'level':{'$first':_0x19fe23(0x107)},'isle':{'$first':_0x19fe23(0x13b)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x19fe23(0xe1)},'unit':{'$first':_0x19fe23(0x104)},'secondary_unit':{'$first':_0x19fe23(0xfe)},'storage':{'$first':_0x19fe23(0xdb)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x19fe23(0x121)},'production_date':{'$first':_0x19fe23(0x147)},'maxPerUnit':{'$first':_0x19fe23(0x148)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x19fe23(0x7f)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x19fe23(0xc7)},'invoice':{'$first':_0x19fe23(0x84)}}}]),_0x471eca=await warehouse['aggregate']([{'$match':{'name':_0x45efb0,'room':_0xe50c98}},{'$unwind':_0x19fe23(0xe6)},{'$match':{'product_details.secondary_code':_0x53a27b}},{'$group':{'_id':_0x19fe23(0x122),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x19fe23(0xb7)},'primary_code':{'$first':_0x19fe23(0xa6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x19fe23(0xef)},'level':{'$first':_0x19fe23(0x107)},'isle':{'$first':_0x19fe23(0x13b)},'type':{'$first':_0x19fe23(0x12c)},'pallet':{'$first':_0x19fe23(0xe1)},'unit':{'$first':_0x19fe23(0x104)},'secondary_unit':{'$first':_0x19fe23(0xfe)},'storage':{'$first':_0x19fe23(0xdb)},'rack':{'$first':_0x19fe23(0x88)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x19fe23(0x147)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x19fe23(0xd7)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x3d99e9[_0x19fe23(0x123)]>0x0)_0x2b3f24[_0x19fe23(0x117)](_0x3d99e9);else _0x471eca[_0x19fe23(0x123)]>0x0&&_0x2b3f24[_0x19fe23(0x117)](_0x471eca);}const _0x235cc5=_0x1c5182['map'](_0x26b66f=>_0x5b32d8(_0x26b66f));await Promise['all'](_0x235cc5),_0x4a052c[_0x452ee4(0x142)](_0x2b3f24);}),router[a0_0xd14ba9(0x118)]('/CheckingWarehouse',async(_0x55ed3e,_0x1b945d)=>{var _0x4117f6=a0_0xd14ba9;const {primaryCode:_0x186b71,secondaryCode:_0xe67ec3,productCode:_0x18cc19,level:_0x1bc071,isle:_0x3eb5ce,pallet:_0x4ce965,warehouses:_0x27b449,room:_0x594135}=_0x55ed3e[_0x4117f6(0x130)];try{const _0x35f74b=await warehouse[_0x4117f6(0x13a)]([{'$match':{'name':_0x27b449,'room':_0x594135}},{'$unwind':_0x4117f6(0xe6)},{'$match':{'product_details.level':parseInt(_0x1bc071),'product_details.isle':_0x3eb5ce,'product_details.pallet':parseInt(_0x4ce965)}},{'$group':{'_id':_0x4117f6(0x122),'name':{'$first':_0x4117f6(0x12d)},'product_stock':{'$first':_0x4117f6(0xb7)},'level':{'$first':_0x4117f6(0x90)},'isle':{'$first':_0x4117f6(0xf8)},'pallet':{'$first':_0x4117f6(0x113)},'maxProducts':{'$first':_0x4117f6(0x9a)}}}]);_0x1b945d['status'](0xc8)[_0x4117f6(0x142)](_0x35f74b);}catch(_0x3fe1f8){_0x1b945d[_0x4117f6(0x151)](0x194)['json']({'message':_0x3fe1f8['message']});}}),module[a0_0xd14ba9(0xae)]=router;