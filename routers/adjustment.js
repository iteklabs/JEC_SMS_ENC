var a0_0x19008e=a0_0x3711;function a0_0x2f6b(){var _0x13489b=['language','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<html><head><title></title>','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','floorlevel','master','expiry_date','<h5\x20style=\x22text-align:\x20left;\x22>','type','max_per_unit','Arabic\x20(ae)','/../public','$room','/adjustment/view','product_stock','product_details','product_name','adjustment','second1','padStart','$product_details.product_cat','Secondary_units','Return\x20Goods','Rooms','types','$product_details.secondary_code','secondary_code','Portuguese\x20(BR)','8NShuCY','level','$product_details.product_name','24635Vcyimh','flash','\x20Order\x20Number\x20:\x20','filter','Enabled','forEach','user','$product_details.level','Primary_Units','render','Receiving\x20Area','findById','site_title','map','warehouse_name','$product_details.production_date','$product','\x20<>\x20','$warehouse_name','find','$product_details.isle','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.product_stock','2227272qASMXd','</tbody>','minus','French','/barcode_scanner','/view/:id','4981479NDOIKM','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','toString','$product_details.invoice','params','Spanish','5714814PBvliS','json','split','findOne','secondary_unit','staff','$_id','success','unit','Chinese','Floor','random','/picking_list/PDF_adjustment_rm/','$product_details.primary_code','$product_details','room','<strong>\x20Regards\x20</strong>','<span\x20style=\x22float:\x20right;\x22>','body','bay','$product_details.batch_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<h5>','ADJ-','add_adjustment','</tr>','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','email','/view/add_adjustment','length','save','string','invoice','German','warehouse','new_adjust_qty','\x20Order\x20Date\x20:\x20','message','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','image','Return\x20Rooms','Level','Hindi','prime1','stock','/adjustment/preview/','prod_cat','Arabic','New_Qty_Converted_adj','<div>','storage','adjustment\x20add\x20successfull','$product_details.maxProducts','get','$product_details.maxPerUnit','nodemailer','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','</td>','English\x20(US)','../public/language/languages.json','post','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','logo','</table>','<tbody\x20style=\x22text-align:\x20center;\x22>','host','sendMail','$product_details.pallet','stockBefore','</head><body>','Adjustment\x20Mail','product','date','role','error','foreach\x20newproduct','New_Qty_Converted','False','Error\x20Occurs','1998KndrMq','True','$product_details.rack','catch','errors','$product_details.type','../middleware/auth','$product_details._id','</thead>','finalize','\x20</h2>','adjust_qty','English','3009796kvspDO','Logo.png','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','production_date','then','log','maxperunit','batch_code','<hr\x20class=\x22my-3\x22>','edit_adjustment_view','$product_details.unit','$product_details.expiry_date','$name','push','379179NUgOmD','Email\x20sent\x20successfully','</span>','$product.product_name','/upload/','status','There\x27s\x20a\x20error\x20in\x20this\x20transaction','room_names','prod_invoice','$product_details.product_code','$product_details.floorlevel','note','slice','_id','$product_details.secondary_unit','$isAllowEdit','/view','redirect','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','1033187GHbGjS','</h5>','/CheckingWarehouse','adjustment\x20Finalized\x20successfully','edit_adjustment','back','/preview/:id','product_code','</div>','id_transaction_from','prod_name','bin','Shelves','exports','isAllowEdit','Raw\x20Materials','$product_details.storage','$finalize','rack','../models/all_models','prod_code','$product.room_names'];a0_0x2f6b=function(){return _0x13489b;};return a0_0x2f6b();}(function(_0x2ce1c6,_0x4ed4ab){var _0x256f6e=a0_0x3711,_0x4ec6ab=_0x2ce1c6();while(!![]){try{var _0x4c3635=parseInt(_0x256f6e(0x28d))/0x1+-parseInt(_0x256f6e(0x26b))/0x2+parseInt(_0x256f6e(0x208))/0x3+parseInt(_0x256f6e(0x202))/0x4+parseInt(_0x256f6e(0x1eb))/0x5*(-parseInt(_0x256f6e(0x25e))/0x6)+parseInt(_0x256f6e(0x20e))/0x7+parseInt(_0x256f6e(0x1e8))/0x8*(parseInt(_0x256f6e(0x27a))/0x9);if(_0x4c3635===_0x4ed4ab)break;else _0x4ec6ab['push'](_0x4ec6ab['shift']());}catch(_0x3374a0){_0x4ec6ab['push'](_0x4ec6ab['shift']());}}}(a0_0x2f6b,0xeb372));const express=require('express'),app=express(),router=express['Router'](),auth=require(a0_0x19008e(0x264)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x19008e(0x2a0)),users=require(a0_0x19008e(0x24a)),nodemailer=require(a0_0x19008e(0x246));router[a0_0x19008e(0x244)](a0_0x19008e(0x28a),auth,async(_0x4a2f17,_0x20ff74)=>{var _0x242a40=a0_0x19008e;try{const {username:_0x5a3843,email:_0x83f245,role:_0x436013}=_0x4a2f17[_0x242a40(0x1f1)],_0x389c6b=_0x4a2f17[_0x242a40(0x1f1)],_0x4de519=await profile['findOne']({'email':_0x389c6b['email']}),_0x3929e9=await master_shop[_0x242a40(0x1fe)]();console['log'](_0x242a40(0x2a9),_0x3929e9);let _0x40e364;if(_0x389c6b[_0x242a40(0x258)]==_0x242a40(0x213)){const _0x506c67=await staff[_0x242a40(0x211)]({'email':_0x389c6b[_0x242a40(0x22a)]});_0x40e364=await warehouse[_0x242a40(0x1fe)]({'status':_0x242a40(0x1ef),'name':_0x506c67['warehouse']});}else _0x40e364=await warehouse[_0x242a40(0x1fe)]({'status':_0x242a40(0x1ef)});const _0x3ce5da=await product[_0x242a40(0x1fe)]();let _0x59c6ac;if(_0x389c6b[_0x242a40(0x258)]==_0x242a40(0x213)){const _0x2895b9=await staff[_0x242a40(0x211)]({'email':_0x389c6b[_0x242a40(0x22a)]});_0x59c6ac=await adjustment['find']({'warehouse_name':_0x2895b9[_0x242a40(0x231)]});}else _0x59c6ac=await adjustment['aggregate']([{'$unwind':_0x242a40(0x1fb)},{'$group':{'_id':_0x242a40(0x214),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x242a40(0x1fd)},'room':{'$addToSet':_0x242a40(0x2a2)},'finalize':{'$first':_0x242a40(0x29e)},'isAllowEdit':{'$first':_0x242a40(0x289)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3929e9[0x0][_0x242a40(0x2a3)]==_0x242a40(0x249)){var _0x40a142=users[_0x242a40(0x26a)];console[_0x242a40(0x271)](_0x40a142);}else{if(_0x3929e9[0x0][_0x242a40(0x2a3)]==_0x242a40(0x239))var _0x40a142=users[_0x242a40(0x239)];else{if(_0x3929e9[0x0][_0x242a40(0x2a3)]==_0x242a40(0x230))var _0x40a142=users['German'];else{if(_0x3929e9[0x0]['language']==_0x242a40(0x20d))var _0x40a142=users[_0x242a40(0x20d)];else{if(_0x3929e9[0x0]['language']==_0x242a40(0x205))var _0x40a142=users[_0x242a40(0x205)];else{if(_0x3929e9[0x0]['language']=='Portuguese\x20(BR)')var _0x40a142=users[_0x242a40(0x26d)];else{if(_0x3929e9[0x0][_0x242a40(0x2a3)]==_0x242a40(0x217))var _0x40a142=users[_0x242a40(0x217)];else{if(_0x3929e9[0x0]['language']==_0x242a40(0x2ae))var _0x40a142=users['Arabic'];}}}}}}}_0x20ff74[_0x242a40(0x1f4)](_0x242a40(0x2b5),{'success':_0x4a2f17['flash'](_0x242a40(0x215)),'errors':_0x4a2f17[_0x242a40(0x1ec)](_0x242a40(0x262)),'role':_0x389c6b,'profile':_0x4de519,'warehouse':_0x40e364,'product':_0x3ce5da,'adjustment':_0x59c6ac,'master_shop':_0x3929e9,'language':_0x40a142});}catch(_0x44c031){console[_0x242a40(0x271)](_0x44c031);}});function a0_0x3711(_0x3c694b,_0x1c4417){var _0x2f6b3f=a0_0x2f6b();return a0_0x3711=function(_0x371110,_0x3605ea){_0x371110=_0x371110-0x1e4;var _0x45e91a=_0x2f6b3f[_0x371110];return _0x45e91a;},a0_0x3711(_0x3c694b,_0x1c4417);}async function getRandom8DigitNumber(){var _0x20f162=a0_0x19008e;const _0x197d27=0x989680,_0x4018d6=0x5f5e0ff,_0x250ca7=Math['floor'](Math[_0x20f162(0x219)]()*(_0x4018d6-_0x197d27+0x1))+_0x197d27;var _0x5b264a;const _0x3a69f9=await adjustment[_0x20f162(0x211)]({'invoice':_0x20f162(0x225)+_0x250ca7});return _0x3a69f9&&_0x3a69f9[_0x20f162(0x22c)]>0x0?_0x5b264a=_0x20f162(0x225)+_0x250ca7:_0x5b264a=_0x20f162(0x225)+_0x250ca7,_0x5b264a;}router[a0_0x19008e(0x244)](a0_0x19008e(0x22b),auth,async(_0x17a378,_0x41b5da)=>{var _0x14a856=a0_0x19008e;try{const {username:_0x18962f,email:_0x37d53d,role:_0x1af522}=_0x17a378[_0x14a856(0x1f1)],_0x1b1c8f=_0x17a378[_0x14a856(0x1f1)],_0x31b867=await profile['findOne']({'email':_0x1b1c8f[_0x14a856(0x22a)]}),_0x3dd222=await master_shop['find']();let _0x451a4a;if(_0x1b1c8f['role']==_0x14a856(0x213)){const _0x487cf4=await staff[_0x14a856(0x211)]({'email':_0x1b1c8f[_0x14a856(0x22a)]});_0x451a4a=await warehouse['aggregate']([{'$match':{'status':_0x14a856(0x1ef),'name':_0x487cf4[_0x14a856(0x231)],'warehouse_category':_0x14a856(0x29c),'name':{'$ne':_0x14a856(0x2ba)}}},{'$group':{'_id':_0x14a856(0x278),'name':{'$first':'$name'}}}]);}else _0x451a4a=await warehouse[_0x14a856(0x228)]([{'$match':{'status':'Enabled','warehouse_category':_0x14a856(0x29c),'name':{'$ne':_0x14a856(0x2ba)}}},{'$group':{'_id':_0x14a856(0x278),'name':{'$first':_0x14a856(0x278)}}}]);const _0x477fd3=await product['find']({}),_0x77d136=await adjustment['find']({}),_0x46d9cf=_0x77d136[_0x14a856(0x22c)]+0x1,_0x276deb=_0x14a856(0x225)+_0x46d9cf[_0x14a856(0x20a)]()[_0x14a856(0x2b7)](0x5,'0');var _0x200c67=['Ambient','Enclosed',_0x14a856(0x237)];if(_0x3dd222[0x0][_0x14a856(0x2a3)]=='English\x20(US)')var _0x3ed1d7=users[_0x14a856(0x26a)];else{if(_0x3dd222[0x0][_0x14a856(0x2a3)]=='Hindi')var _0x3ed1d7=users[_0x14a856(0x239)];else{if(_0x3dd222[0x0][_0x14a856(0x2a3)]==_0x14a856(0x230))var _0x3ed1d7=users[_0x14a856(0x230)];else{if(_0x3dd222[0x0][_0x14a856(0x2a3)]==_0x14a856(0x20d))var _0x3ed1d7=users[_0x14a856(0x20d)];else{if(_0x3dd222[0x0][_0x14a856(0x2a3)]==_0x14a856(0x205))var _0x3ed1d7=users[_0x14a856(0x205)];else{if(_0x3dd222[0x0][_0x14a856(0x2a3)]=='Portuguese\x20(BR)')var _0x3ed1d7=users[_0x14a856(0x26d)];else{if(_0x3dd222[0x0][_0x14a856(0x2a3)]==_0x14a856(0x217))var _0x3ed1d7=users[_0x14a856(0x217)];else{if(_0x3dd222[0x0][_0x14a856(0x2a3)]=='Arabic\x20(ae)')var _0x3ed1d7=users[_0x14a856(0x23e)];}}}}}}}const _0x28bf33=getRandom8DigitNumber();_0x28bf33[_0x14a856(0x270)](_0x343dd1=>{var _0x4aa9d3=_0x14a856;_0x41b5da[_0x4aa9d3(0x1f4)](_0x4aa9d3(0x226),{'success':_0x17a378[_0x4aa9d3(0x1ec)](_0x4aa9d3(0x215)),'errors':_0x17a378[_0x4aa9d3(0x1ec)](_0x4aa9d3(0x262)),'role':_0x1b1c8f,'profile':_0x31b867,'warehouse':_0x451a4a,'product':_0x477fd3,'master_shop':_0x3dd222,'language':_0x3ed1d7,'rooms_data':_0x200c67,'invoice_no':_0x343dd1});})[_0x14a856(0x261)](_0x3641e5=>{var _0x3d0d17=_0x14a856;_0x17a378['flash'](_0x3d0d17(0x262),_0x3d0d17(0x280)),_0x41b5da[_0x3d0d17(0x28b)](_0x3d0d17(0x2b1));});}catch(_0xb7ad36){console[_0x14a856(0x271)](_0xb7ad36);}}),router[a0_0x19008e(0x24b)](a0_0x19008e(0x22b),auth,async(_0x1f69d4,_0x53b30a)=>{var _0x23515d=a0_0x19008e;try{const {warehouse_name:_0x35a163,date:_0x1bcd76,prod_name:_0x51d054,level:_0x27a773,isle:_0x41f2b2,pallet:_0x48f9d5,stock:_0x103670,types:_0x5e631d,adjust_qty:_0x485114,new_adjust_qty:_0x440fd9,note:_0x37898b,Room_name:_0x5e6a18,invoice:_0x48f09d,JO_number:_0x45150c,expiry_date:_0xa1c310}=_0x1f69d4[_0x23515d(0x220)];if(typeof _0x51d054==_0x23515d(0x22e))var _0x582118=[_0x1f69d4[_0x23515d(0x220)]['prod_name']],_0x288e1f=[_0x1f69d4[_0x23515d(0x220)]['level']],_0x3fe4ad=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x23b)]],_0x59784d=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x1e4)]],_0x40db08=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x23f)]],_0x2a7454=[_0x1f69d4['body']['New_Qty_Converted']],_0x19d70a=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x1f3)]],_0x1b2ce3=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x2b9)]],_0xfbac86=[_0x1f69d4['body']['prod_code']],_0x45d9e9=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x273)]],_0x14c612=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x2aa)]],_0x6e6cb5=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x2ad)]],_0x534ab3=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x26f)]],_0x317d30=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x23d)]],_0x5b517c=[_0x1f69d4[_0x23515d(0x220)]['Rooms']],_0x588f5d=[_0x1f69d4['body']['prime1']],_0x27f1ed=[_0x1f69d4['body'][_0x23515d(0x2b6)]],_0x5b2ed5=[_0x1f69d4[_0x23515d(0x220)][_0x23515d(0x282)]],_0x59cf8b=[_0x1f69d4[_0x23515d(0x220)]['id_transaction']];else var _0x582118=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x297)]],_0x288e1f=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x1e9)]],_0x3fe4ad=[..._0x1f69d4['body'][_0x23515d(0x23b)]],_0x59784d=[..._0x1f69d4[_0x23515d(0x220)]['types']],_0x40db08=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x23f)]],_0x2a7454=[..._0x1f69d4['body'][_0x23515d(0x25b)]],_0x19d70a=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x216)]],_0x1b2ce3=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x2b9)]],_0xfbac86=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x2a1)]],_0x45d9e9=[..._0x1f69d4['body'][_0x23515d(0x273)]],_0x14c612=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x2aa)]],_0x6e6cb5=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x2ad)]],_0x534ab3=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x26f)]],_0x317d30=[..._0x1f69d4[_0x23515d(0x220)]['prod_cat']],_0x5b517c=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x2bb)]],_0x588f5d=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x23a)]],_0x27f1ed=[..._0x1f69d4[_0x23515d(0x220)]['second1']],_0x5b2ed5=[..._0x1f69d4[_0x23515d(0x220)][_0x23515d(0x282)]],_0x59cf8b=[..._0x1f69d4[_0x23515d(0x220)]['id_transaction']];const _0x588c33=_0x582118[_0x23515d(0x1f8)](_0x5e3c90=>{return _0x5e3c90={'product_name':_0x5e3c90};});_0x288e1f[_0x23515d(0x1f0)]((_0x44a28b,_0x172332)=>{var _0x5bfe75=_0x23515d;_0x5b517c[_0x5bfe75(0x1f0)]((_0x3f9759,_0x44a4c4)=>{var _0x37395c=_0x5bfe75;if(_0x3f9759==_0x37395c(0x1f5)&&_0x172332==_0x44a4c4){var _0x3f461d=_0x44a28b['slice'](0x3);_0x588c33[_0x172332]['storage']=_0x44a28b[0x0],_0x588c33[_0x172332][_0x37395c(0x29f)]=_0x44a28b[0x1],_0x588c33[_0x172332][_0x37395c(0x221)]=0x0,_0x588c33[_0x172332][_0x37395c(0x298)]=0x0,_0x588c33[_0x172332][_0x37395c(0x2ac)]=_0x37395c(0x218),_0x588c33[_0x172332]['floorlevel']=_0x3f461d;}else{if(_0x3f9759=='Shelves'&&_0x172332==_0x44a4c4){var _0x3f461d=_0x44a28b[_0x37395c(0x286)](0x3);_0x588c33[_0x172332][_0x37395c(0x241)]=_0x44a28b[0x0],_0x588c33[_0x172332][_0x37395c(0x29f)]=_0x44a28b[0x1],_0x588c33[_0x172332][_0x37395c(0x221)]=0x0,_0x588c33[_0x172332][_0x37395c(0x298)]=0x0,_0x588c33[_0x172332][_0x37395c(0x2ac)]=_0x37395c(0x218),_0x588c33[_0x172332][_0x37395c(0x2a8)]=_0x44a28b[0x5];}else{if(_0x172332==_0x44a4c4){var _0x2783d8;if(_0x44a28b[0x4]=='L')_0x2783d8=_0x37395c(0x238);else _0x44a28b[0x4]=='F'&&(_0x2783d8=_0x37395c(0x218));_0x588c33[_0x172332]['storage']=_0x44a28b[0x0],_0x588c33[_0x172332][_0x37395c(0x29f)]=_0x44a28b[0x1],_0x588c33[_0x172332][_0x37395c(0x221)]=_0x44a28b[0x2],_0x588c33[_0x172332]['bin']=_0x44a28b[0x3],_0x588c33[_0x172332]['type']=_0x2783d8,_0x588c33[_0x172332][_0x37395c(0x2a8)]=_0x44a28b[0x5];}}}});}),_0x3fe4ad[_0x23515d(0x1f0)]((_0x496068,_0x32ecf3)=>{var _0x4141ec=_0x23515d;_0x588c33[_0x32ecf3][_0x4141ec(0x253)]=_0x496068;}),_0x59cf8b[_0x23515d(0x1f0)]((_0xf09c38,_0x5bdbd3)=>{_0x588c33[_0x5bdbd3]['id_transaction_from']=_0xf09c38;}),_0x59784d[_0x23515d(0x1f0)]((_0x2c744f,_0xe0e113)=>{_0x588c33[_0xe0e113]['types']=_0x2c744f;}),_0x40db08[_0x23515d(0x1f0)]((_0x3ee067,_0x46245c)=>{var _0x45bf5e=_0x23515d;_0x588c33[_0x46245c][_0x45bf5e(0x269)]=_0x3ee067;}),_0x2a7454['forEach']((_0x3767fd,_0x3eec90)=>{var _0x41c2a8=_0x23515d;_0x588c33[_0x3eec90][_0x41c2a8(0x232)]=_0x3767fd;}),_0x19d70a['forEach']((_0x54b8cc,_0x2eb4ef)=>{var _0x2df352=_0x23515d;_0x588c33[_0x2eb4ef][_0x2df352(0x216)]=_0x54b8cc;}),_0x1b2ce3[_0x23515d(0x1f0)]((_0x4189a5,_0x26c971)=>{_0x588c33[_0x26c971]['secondary_unit']=_0x4189a5;}),_0xfbac86['forEach']((_0x4ea18f,_0x46a87f)=>{var _0x88887d=_0x23515d;_0x588c33[_0x46a87f][_0x88887d(0x294)]=_0x4ea18f;}),_0x45d9e9[_0x23515d(0x1f0)]((_0xf56838,_0x379c66)=>{var _0x135048=_0x23515d;_0x588c33[_0x379c66][_0x135048(0x273)]=_0xf56838;}),_0x14c612[_0x23515d(0x1f0)]((_0x22151f,_0x386f84)=>{var _0x1142e9=_0x23515d;_0x588c33[_0x386f84][_0x1142e9(0x2aa)]=_0x22151f;}),_0x6e6cb5[_0x23515d(0x1f0)]((_0xe9ae9d,_0x4330e7)=>{var _0x5995d6=_0x23515d;_0x588c33[_0x4330e7][_0x5995d6(0x272)]=_0xe9ae9d;}),_0x534ab3[_0x23515d(0x1f0)]((_0x215ca3,_0x541d9f)=>{var _0x5d7516=_0x23515d;_0x588c33[_0x541d9f][_0x5d7516(0x26f)]=_0x215ca3;}),_0x317d30[_0x23515d(0x1f0)]((_0x7bf4a4,_0x1e9094)=>{_0x588c33[_0x1e9094]['prod_cat']=_0x7bf4a4;}),_0x5b517c[_0x23515d(0x1f0)]((_0xb26485,_0x18323c)=>{var _0xe51b47=_0x23515d;_0x588c33[_0x18323c][_0xe51b47(0x281)]=_0xb26485;}),_0x588f5d[_0x23515d(0x1f0)]((_0x2c1477,_0x5ca437)=>{_0x588c33[_0x5ca437]['primary_code']=_0x2c1477;}),_0x27f1ed[_0x23515d(0x1f0)]((_0x3e5176,_0x465afb)=>{var _0x17abe1=_0x23515d;_0x588c33[_0x465afb][_0x17abe1(0x1e6)]=_0x3e5176;}),_0x5b2ed5['forEach']((_0xa41bf5,_0x15de21)=>{_0x588c33[_0x15de21]['invoice']=_0xa41bf5;});const _0x324160=_0x588c33['filter'](_0x1f1b7c=>_0x1f1b7c['adjust_qty']!=='0'&&_0x1f1b7c[_0x23515d(0x269)]!=='');var _0x555592=0x0;_0x324160[_0x23515d(0x1f0)](_0x43552f=>{var _0x4a55f0=_0x23515d;console[_0x4a55f0(0x271)](_0x4a55f0(0x25a),_0x43552f),parseInt(_0x43552f[_0x4a55f0(0x269)])<=0x0&&_0x555592++;});if(_0x555592!=0x0)return _0x1f69d4[_0x23515d(0x1ec)]('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x53b30a['redirect'](_0x23515d(0x292));const _0x5d59a8=new adjustment({'warehouse_name':_0x35a163,'date':_0x1bcd76,'product':_0x324160,'note':_0x37898b,'room':_0x5e6a18,'invoice':_0x48f09d,'JO_number':_0x45150c,'expiry_date':_0xa1c310}),_0x1d779d=await _0x5d59a8['save']();_0x1f69d4[_0x23515d(0x1ec)](_0x23515d(0x215),_0x23515d(0x242)),_0x53b30a[_0x23515d(0x28b)](_0x23515d(0x23c)+_0x1d779d[_0x23515d(0x287)]);}catch(_0x1bd1c7){console[_0x23515d(0x271)](_0x1bd1c7),_0x53b30a['status'](0xc8)[_0x23515d(0x20f)]({'message':_0x1bd1c7[_0x23515d(0x234)]});}}),router[a0_0x19008e(0x244)](a0_0x19008e(0x293),auth,async(_0x2a6d43,_0x2c93f8)=>{var _0x1f4329=a0_0x19008e;try{const {username:_0x18e224,email:_0x3fc66f,role:_0x564aa3}=_0x2a6d43[_0x1f4329(0x1f1)],_0x3a58a1=_0x2a6d43[_0x1f4329(0x1f1)],_0x393743=await profile[_0x1f4329(0x211)]({'email':_0x3a58a1[_0x1f4329(0x22a)]}),_0x287451=await master_shop[_0x1f4329(0x1fe)](),_0x578b5b=_0x2a6d43[_0x1f4329(0x20c)]['id'],_0x9caaf8=await adjustment['findById']({'_id':_0x578b5b}),_0x5b555b=await purchases[_0x1f4329(0x228)]([{'$match':{'warehouse_name':_0x9caaf8[_0x1f4329(0x1f9)]}},{'$unwind':_0x1f4329(0x1fb)},{'$group':{'_id':'$product.product_name'}}]),_0x3541f0=await product['find']({}),_0x39b638=await warehouse[_0x1f4329(0x228)]([{'$match':{'name':_0x9caaf8[_0x1f4329(0x1f9)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1f4329(0x265),'name':{'$first':_0x1f4329(0x1ea)},'product_stock':{'$first':_0x1f4329(0x201)},'bay':{'$first':_0x1f4329(0x2a6)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x1f4329(0x263)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1f4329(0x21b)},'secondary_code':{'$first':_0x1f4329(0x1e5)},'product_code':{'$first':_0x1f4329(0x283)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1f4329(0x260)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x1f4329(0x277)},'production_date':{'$first':_0x1f4329(0x1fa)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x1f4329(0x2b0)}}}]);if(_0x287451[0x0][_0x1f4329(0x2a3)]=='English\x20(US)'){var _0x5f5be9=users['English'];console[_0x1f4329(0x271)](_0x5f5be9);}else{if(_0x287451[0x0][_0x1f4329(0x2a3)]==_0x1f4329(0x239))var _0x5f5be9=users['Hindi'];else{if(_0x287451[0x0][_0x1f4329(0x2a3)]=='German')var _0x5f5be9=users[_0x1f4329(0x230)];else{if(_0x287451[0x0][_0x1f4329(0x2a3)]=='Spanish')var _0x5f5be9=users['Spanish'];else{if(_0x287451[0x0][_0x1f4329(0x2a3)]==_0x1f4329(0x205))var _0x5f5be9=users[_0x1f4329(0x205)];else{if(_0x287451[0x0][_0x1f4329(0x2a3)]==_0x1f4329(0x1e7))var _0x5f5be9=users[_0x1f4329(0x26d)];else{if(_0x287451[0x0][_0x1f4329(0x2a3)]==_0x1f4329(0x217))var _0x5f5be9=users[_0x1f4329(0x217)];else{if(_0x287451[0x0][_0x1f4329(0x2a3)]==_0x1f4329(0x2ae))var _0x5f5be9=users['Arabic'];}}}}}}}_0x2c93f8['render'](_0x1f4329(0x275),{'success':_0x2a6d43[_0x1f4329(0x1ec)](_0x1f4329(0x215)),'errors':_0x2a6d43[_0x1f4329(0x1ec)](_0x1f4329(0x262)),'role':_0x3a58a1,'profile':_0x393743,'adjustment':_0x9caaf8,'stock':_0x39b638,'master_shop':_0x287451,'warehouse_name':_0x5b555b,'unit':_0x3541f0,'language':_0x5f5be9});}catch(_0x774a3f){console[_0x1f4329(0x271)](_0x774a3f),_0x2c93f8[_0x1f4329(0x27f)](0xc8)[_0x1f4329(0x20f)]({'message':_0x774a3f[_0x1f4329(0x234)]});}}),router[a0_0x19008e(0x24b)]('/preview/:id',auth,async(_0x195b32,_0xb540a0)=>{var _0x3c7aba=a0_0x19008e;try{const _0x3fb159=_0x195b32[_0x3c7aba(0x20c)]['id'],{warehouse_name:_0x2ad835,Room_name:_0x37dd87}=_0x195b32[_0x3c7aba(0x220)],_0x3c9dab=await adjustment[_0x3c7aba(0x1f6)]({'_id':_0x3fb159}),_0x5f50b0=_0x3c9dab[_0x3c7aba(0x256)][_0x3c7aba(0x1f8)](async _0x2a9158=>{var _0x3b4d31=_0x3c7aba;if(_0x2a9158[_0x3b4d31(0x269)]>0x0){var _0x58e93f=await warehouse[_0x3b4d31(0x211)]({'name':_0x2ad835,'room':_0x2a9158[_0x3b4d31(0x281)],'warehouse_category':_0x3b4d31(0x29c)});const _0x1c03d3=_0x58e93f[_0x3b4d31(0x2b3)]['map'](_0x595a55=>{var _0x58b52c=_0x3b4d31;console[_0x58b52c(0x271)](_0x2a9158[_0x58b52c(0x1e4)]+_0x58b52c(0x1fc));if(_0x2a9158[_0x58b52c(0x1e4)]==_0x58b52c(0x204)){if(_0x595a55['product_name']==_0x2a9158[_0x58b52c(0x2b4)]&&_0x595a55[_0x58b52c(0x2a8)]==_0x2a9158['floorlevel']&&_0x595a55[_0x58b52c(0x2ac)]==_0x2a9158[_0x58b52c(0x2ac)]&&_0x595a55[_0x58b52c(0x298)]==_0x2a9158[_0x58b52c(0x298)]&&_0x595a55[_0x58b52c(0x221)]==_0x2a9158[_0x58b52c(0x221)]&&_0x595a55[_0x58b52c(0x29f)]==_0x2a9158[_0x58b52c(0x29f)]&&_0x595a55[_0x58b52c(0x241)]==_0x2a9158['storage']&&_0x595a55[_0x58b52c(0x2aa)]==_0x2a9158[_0x58b52c(0x2aa)]&&_0x595a55[_0x58b52c(0x273)]==_0x2a9158[_0x58b52c(0x273)]&&_0x595a55[_0x58b52c(0x26f)]==_0x2a9158['production_date']&&_0x595a55['invoice']==_0x2a9158[_0x58b52c(0x22f)]&&_0x595a55[_0x58b52c(0x287)]==_0x2a9158[_0x58b52c(0x296)]){var _0x52a22c;_0x52a22c=_0x2a9158['adjust_qty'],_0x2a9158[_0x58b52c(0x23d)]=='S'&&(_0x52a22c=_0x2a9158[_0x58b52c(0x269)]),_0x595a55['product_stock']=_0x595a55['product_stock']-_0x52a22c;}}else{if(_0x595a55[_0x58b52c(0x2b4)]==_0x2a9158[_0x58b52c(0x2b4)]&&_0x595a55['floorlevel']==_0x2a9158['floorlevel']&&_0x595a55[_0x58b52c(0x2ac)]==_0x2a9158[_0x58b52c(0x2ac)]&&_0x595a55[_0x58b52c(0x298)]==_0x2a9158[_0x58b52c(0x298)]&&_0x595a55[_0x58b52c(0x221)]==_0x2a9158[_0x58b52c(0x221)]&&_0x595a55['rack']==_0x2a9158[_0x58b52c(0x29f)]&&_0x595a55[_0x58b52c(0x241)]==_0x2a9158[_0x58b52c(0x241)]&&_0x595a55[_0x58b52c(0x2aa)]==_0x2a9158[_0x58b52c(0x2aa)]&&_0x595a55[_0x58b52c(0x273)]==_0x2a9158[_0x58b52c(0x273)]&&_0x595a55[_0x58b52c(0x26f)]==_0x2a9158['production_date']&&_0x595a55[_0x58b52c(0x22f)]==_0x2a9158['invoice']&&_0x595a55['_id']==_0x2a9158['id_transaction_from']){console[_0x58b52c(0x271)](_0x2a9158);var _0x52a22c;_0x52a22c=_0x2a9158[_0x58b52c(0x269)],_0x2a9158[_0x58b52c(0x23d)]=='S'&&(_0x52a22c=_0x2a9158[_0x58b52c(0x269)]),_0x595a55[_0x58b52c(0x2b2)]=_0x595a55[_0x58b52c(0x2b2)]+_0x52a22c;}}});}return _0x58e93f;});Promise['all'](_0x5f50b0)[_0x3c7aba(0x270)](async _0x1d43dc=>{var _0x2a1f44=_0x3c7aba;try{for(const _0x2e46b2 of _0x1d43dc){await _0x2e46b2[_0x2a1f44(0x22d)]();}_0x3c9dab[_0x2a1f44(0x267)]=_0x2a1f44(0x25f);const _0x4cbbda=await _0x3c9dab[_0x2a1f44(0x22d)](),_0x1fd2bc=await master_shop[_0x2a1f44(0x1fe)](),_0x340212=await email_settings[_0x2a1f44(0x211)](),_0x391882=await supervisor_settings[_0x2a1f44(0x1fe)]();var _0x1a3e17=_0x3c9dab[_0x2a1f44(0x256)],_0x2ccedc='',_0x3bda4e;for(_0x3bda4e in _0x1a3e17){_0x2ccedc+='<tr>'+_0x2a1f44(0x223)+_0x1a3e17[_0x3bda4e]['product_name']+'</td>'+_0x2a1f44(0x223)+_0x1a3e17[_0x3bda4e][_0x2a1f44(0x294)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a3e17[_0x3bda4e][_0x2a1f44(0x269)]+_0x2a1f44(0x248)+_0x2a1f44(0x223)+_0x1a3e17[_0x3bda4e][_0x2a1f44(0x216)]+_0x2a1f44(0x248)+_0x2a1f44(0x223)+_0x1a3e17[_0x3bda4e][_0x2a1f44(0x212)]+_0x2a1f44(0x248)+_0x2a1f44(0x223)+_0x3c9dab['warehouse_name']+_0x2a1f44(0x248)+_0x2a1f44(0x223)+_0x1a3e17[_0x3bda4e][_0x2a1f44(0x281)]+_0x2a1f44(0x248)+_0x2a1f44(0x223)+_0x1a3e17[_0x3bda4e][_0x2a1f44(0x241)]+_0x1a3e17[_0x3bda4e]['rack']+_0x1a3e17[_0x3bda4e]['bay']+_0x1a3e17[_0x3bda4e][_0x2a1f44(0x298)]+_0x1a3e17[_0x3bda4e][_0x2a1f44(0x2ac)][0x0]+_0x1a3e17[_0x3bda4e][_0x2a1f44(0x2a8)]+_0x2a1f44(0x248),_0x2a1f44(0x227);}let _0x48e62e=nodemailer['createTransport']({'host':_0x340212[_0x2a1f44(0x250)],'port':Number(_0x340212['port']),'secure':![],'auth':{'user':_0x340212[_0x2a1f44(0x22a)],'pass':_0x340212['password']}}),_0x16b8ab={'from':_0x340212[_0x2a1f44(0x22a)],'to':_0x391882[0x0]['RMSEmail'],'subject':_0x2a1f44(0x255),'attachments':[{'filename':_0x2a1f44(0x26c),'path':__dirname+_0x2a1f44(0x2af)+_0x2a1f44(0x27e)+_0x1fd2bc[0x0][_0x2a1f44(0x236)],'cid':_0x2a1f44(0x24d)}],'html':'<!DOCTYPE\x20html>'+_0x2a1f44(0x2a5)+_0x2a1f44(0x254)+_0x2a1f44(0x240)+_0x2a1f44(0x200)+_0x2a1f44(0x240)+_0x2a1f44(0x28c)+_0x2a1f44(0x295)+_0x2a1f44(0x240)+'<h2>\x20'+_0x1fd2bc[0x0]['site_title']+_0x2a1f44(0x268)+_0x2a1f44(0x295)+_0x2a1f44(0x295)+_0x2a1f44(0x274)+_0x2a1f44(0x240)+_0x2a1f44(0x2ab)+_0x2a1f44(0x1ed)+_0x3c9dab[_0x2a1f44(0x22f)]+'\x20'+_0x2a1f44(0x21f)+_0x2a1f44(0x233)+_0x3c9dab[_0x2a1f44(0x257)]+'\x20'+_0x2a1f44(0x27c)+'</h5>'+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2a1f44(0x2a4)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2a1f44(0x235)+_0x2a1f44(0x229)+_0x2a1f44(0x26e)+_0x2a1f44(0x24c)+_0x2a1f44(0x2a7)+_0x2a1f44(0x209)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x2a1f44(0x227)+_0x2a1f44(0x266)+_0x2a1f44(0x24f)+'\x20'+_0x2ccedc+'\x20'+_0x2a1f44(0x203)+_0x2a1f44(0x24e)+'<div>'+_0x2a1f44(0x21e)+_0x2a1f44(0x224)+_0x1fd2bc[0x0][_0x2a1f44(0x1f7)]+_0x2a1f44(0x28e)+'</div>'+'</div>'+'</body></html>'};_0x48e62e[_0x2a1f44(0x251)](_0x16b8ab,function(_0x6f4d7c,_0x405fde){var _0x3c1d0a=_0x2a1f44;_0x6f4d7c?(console['log'](_0x6f4d7c),console[_0x3c1d0a(0x271)](_0x3c1d0a(0x25d))):console[_0x3c1d0a(0x271)](_0x3c1d0a(0x27b));}),_0x195b32['flash'](_0x2a1f44(0x215),_0x2a1f44(0x290)),_0xb540a0['redirect'](_0x2a1f44(0x21a)+_0x4cbbda[_0x2a1f44(0x287)]);}catch(_0x26c306){console[_0x2a1f44(0x259)](_0x26c306),_0xb540a0[_0x2a1f44(0x27f)](0x1f4)[_0x2a1f44(0x20f)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x3c7aba(0x261)](_0x137e4b=>{var _0x34f905=_0x3c7aba;console['error'](_0x137e4b),_0xb540a0[_0x34f905(0x27f)](0x1f4)[_0x34f905(0x20f)]({'error':'An\x20error\x20occurred.'});});}catch(_0x3645b8){console[_0x3c7aba(0x271)](_0x3645b8),_0xb540a0['status'](0xc8)[_0x3c7aba(0x20f)]({'message':_0x3645b8['message']});}}),router[a0_0x19008e(0x244)](a0_0x19008e(0x207),auth,async(_0x4cecdf,_0x2dbcb9)=>{var _0x3e2203=a0_0x19008e;try{const {username:_0x500199,email:_0x1d0999,role:_0x51e2cf}=_0x4cecdf[_0x3e2203(0x1f1)],_0x2c518f=_0x4cecdf[_0x3e2203(0x1f1)],_0x36f148=await profile['findOne']({'email':_0x2c518f[_0x3e2203(0x22a)]}),_0x4f2fdb=await master_shop[_0x3e2203(0x1fe)](),_0x2ac8b7=_0x4cecdf[_0x3e2203(0x20c)]['id'],_0x3ca3d9=await adjustment['findById']({'_id':_0x2ac8b7}),_0x5095b4=await purchases[_0x3e2203(0x228)]([{'$match':{'warehouse_name':_0x3ca3d9[_0x3e2203(0x1f9)]}},{'$unwind':_0x3e2203(0x1fb)},{'$group':{'_id':_0x3e2203(0x27d)}}]),_0x12a73e=await product[_0x3e2203(0x1fe)]({}),_0x391510=await warehouse[_0x3e2203(0x228)]([{'$match':{'name':_0x3ca3d9[_0x3e2203(0x1f9)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3e2203(0x265),'name':{'$first':_0x3e2203(0x1ea)},'product_stock':{'$first':_0x3e2203(0x201)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3e2203(0x263)},'floorlevel':{'$first':_0x3e2203(0x284)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3e2203(0x1e5)},'product_code':{'$first':_0x3e2203(0x283)},'storage':{'$first':_0x3e2203(0x29d)},'rack':{'$first':_0x3e2203(0x260)},'maxPerUnit':{'$first':_0x3e2203(0x245)},'expiry_date':{'$first':_0x3e2203(0x277)},'production_date':{'$first':_0x3e2203(0x1fa)},'batch_code':{'$first':_0x3e2203(0x222)},'room':{'$first':_0x3e2203(0x2b0)}}}]);let _0x417f86;if(_0x2c518f['role']==_0x3e2203(0x213)){const _0x21c1e7=await staff['findOne']({'email':_0x2c518f[_0x3e2203(0x22a)]});_0x417f86=await warehouse[_0x3e2203(0x228)]([{'$match':{'status':'Enabled','name':_0x21c1e7['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x3e2203(0x2ba)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x417f86=await warehouse['aggregate']([{'$match':{'status':_0x3e2203(0x1ef),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x3e2203(0x2ba)}}},{'$group':{'_id':'$name','name':{'$first':_0x3e2203(0x278)}}}]);if(_0x4f2fdb[0x0][_0x3e2203(0x2a3)]==_0x3e2203(0x249)){var _0x1b29cb=users[_0x3e2203(0x26a)];console[_0x3e2203(0x271)](_0x1b29cb);}else{if(_0x4f2fdb[0x0][_0x3e2203(0x2a3)]==_0x3e2203(0x239))var _0x1b29cb=users[_0x3e2203(0x239)];else{if(_0x4f2fdb[0x0][_0x3e2203(0x2a3)]==_0x3e2203(0x230))var _0x1b29cb=users[_0x3e2203(0x230)];else{if(_0x4f2fdb[0x0][_0x3e2203(0x2a3)]==_0x3e2203(0x20d))var _0x1b29cb=users['Spanish'];else{if(_0x4f2fdb[0x0][_0x3e2203(0x2a3)]==_0x3e2203(0x205))var _0x1b29cb=users[_0x3e2203(0x205)];else{if(_0x4f2fdb[0x0][_0x3e2203(0x2a3)]==_0x3e2203(0x1e7))var _0x1b29cb=users['Portuguese'];else{if(_0x4f2fdb[0x0]['language']==_0x3e2203(0x217))var _0x1b29cb=users['Chinese'];else{if(_0x4f2fdb[0x0][_0x3e2203(0x2a3)]==_0x3e2203(0x2ae))var _0x1b29cb=users[_0x3e2203(0x23e)];}}}}}}}_0x2dbcb9[_0x3e2203(0x1f4)](_0x3e2203(0x291),{'success':_0x4cecdf[_0x3e2203(0x1ec)](_0x3e2203(0x215)),'errors':_0x4cecdf[_0x3e2203(0x1ec)](_0x3e2203(0x262)),'role':_0x2c518f,'profile':_0x36f148,'adjustment':_0x3ca3d9,'stock':_0x391510,'master_shop':_0x4f2fdb,'warehouse_name':_0x5095b4,'unit':_0x12a73e,'language':_0x1b29cb,'warehouse':_0x417f86});}catch(_0x56d149){console['log'](_0x56d149),_0x2dbcb9[_0x3e2203(0x27f)](0xc8)[_0x3e2203(0x20f)]({'message':_0x56d149[_0x3e2203(0x234)]});}}),router[a0_0x19008e(0x24b)](a0_0x19008e(0x207),auth,async(_0x5af8b7,_0x5cc932)=>{var _0x5a4a34=a0_0x19008e;try{const _0x57f4b2=_0x5af8b7[_0x5a4a34(0x20c)]['id'],_0x1deb7a=await adjustment[_0x5a4a34(0x1f6)]({'_id':_0x57f4b2}),_0x42908d=await warehouse[_0x5a4a34(0x211)]({'name':_0x1deb7a[_0x5a4a34(0x1f9)],'room':_0x1deb7a[_0x5a4a34(0x21d)]}),{warehouse_name:_0x1b0901,date:_0x4650d8,prod_name:_0x2b2508,level:_0x417453,isle:_0x195ad8,pallet:_0x5dcd3d,stock:_0x29cfce,types:_0x3dde8d,adjust_qty:_0x3ed8c6,new_adjust_qty:_0x434fdf,note:_0x46f803,Room_name:_0x1758e0,invoice:_0x1199ad,JO_number:_0xa6f9ad,expiry_date:_0x531deb}=_0x5af8b7[_0x5a4a34(0x220)];if(typeof _0x2b2508==_0x5a4a34(0x22e))var _0x479e87=[_0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x297)]],_0x324d59=[_0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x1e9)]],_0x3b84d4=[_0x5af8b7['body'][_0x5a4a34(0x23b)]],_0x93d2ac=[_0x5af8b7['body'][_0x5a4a34(0x1e4)]],_0x85fa7f=[_0x5af8b7['body']['New_Qty_Converted_adj']],_0x265337=[_0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x25b)]],_0x420b71=[_0x5af8b7['body'][_0x5a4a34(0x1f3)]],_0x2d0065=[_0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x2b9)]],_0x320464=[_0x5af8b7['body'][_0x5a4a34(0x2a1)]],_0x270a88=[_0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x273)]],_0xad57db=[_0x5af8b7['body'][_0x5a4a34(0x2aa)]],_0x4e3c5d=[_0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x2ad)]],_0x4de038=[_0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x26f)]],_0x329ada=[_0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x23d)]],_0x3a5b61=[_0x5af8b7['body'][_0x5a4a34(0x2bb)]],_0x5bf600=[_0x5af8b7['body']['prime1']],_0x4e6ae8=[_0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x2b6)]];else var _0x479e87=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x297)]],_0x324d59=[..._0x5af8b7['body']['level']],_0x3b84d4=[..._0x5af8b7['body'][_0x5a4a34(0x23b)]],_0x93d2ac=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x1e4)]],_0x85fa7f=[..._0x5af8b7['body'][_0x5a4a34(0x23f)]],_0x265337=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x25b)]],_0x420b71=[..._0x5af8b7['body'][_0x5a4a34(0x216)]],_0x2d0065=[..._0x5af8b7['body'][_0x5a4a34(0x2b9)]],_0x320464=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x2a1)]],_0x270a88=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x273)]],_0xad57db=[..._0x5af8b7['body'][_0x5a4a34(0x2aa)]],_0x4e3c5d=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x2ad)]],_0x4de038=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x26f)]],_0x329ada=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x23d)]],_0x3a5b61=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x2bb)]],_0x5bf600=[..._0x5af8b7['body'][_0x5a4a34(0x23a)]],_0x4e6ae8=[..._0x5af8b7[_0x5a4a34(0x220)][_0x5a4a34(0x2b6)]];const _0x299ebf=_0x479e87['map'](_0x50a1e4=>{return _0x50a1e4={'product_name':_0x50a1e4};});_0x324d59[_0x5a4a34(0x1f0)]((_0x3dd138,_0x33510)=>{_0x3a5b61['forEach']((_0xe90a0a,_0x296bd4)=>{var _0x57be91=a0_0x3711;if(_0xe90a0a==_0x57be91(0x1f5)&&_0x33510==_0x296bd4){var _0x15fdb2=_0x3dd138['slice'](0x3);_0x299ebf[_0x33510][_0x57be91(0x241)]=_0x3dd138[0x0],_0x299ebf[_0x33510]['rack']=_0x3dd138[0x1],_0x299ebf[_0x33510][_0x57be91(0x221)]=0x0,_0x299ebf[_0x33510][_0x57be91(0x298)]=0x0,_0x299ebf[_0x33510][_0x57be91(0x2ac)]=_0x57be91(0x218),_0x299ebf[_0x33510]['floorlevel']=_0x15fdb2;}else{if(_0xe90a0a==_0x57be91(0x299)&&_0x33510==_0x296bd4){var _0x15fdb2=_0x3dd138[_0x57be91(0x286)](0x3);_0x299ebf[_0x33510][_0x57be91(0x241)]=_0x3dd138[0x0],_0x299ebf[_0x33510][_0x57be91(0x29f)]=_0x3dd138[0x1],_0x299ebf[_0x33510]['bay']=0x0,_0x299ebf[_0x33510][_0x57be91(0x298)]=0x0,_0x299ebf[_0x33510]['type']=_0x57be91(0x218),_0x299ebf[_0x33510]['floorlevel']=_0x3dd138[0x5];}else{if(_0x33510==_0x296bd4){var _0x3c358c;if(_0x3dd138[0x4]=='L')_0x3c358c=_0x57be91(0x238);else _0x3dd138[0x4]=='F'&&(_0x3c358c=_0x57be91(0x218));_0x299ebf[_0x33510]['storage']=_0x3dd138[0x0],_0x299ebf[_0x33510][_0x57be91(0x29f)]=_0x3dd138[0x1],_0x299ebf[_0x33510][_0x57be91(0x221)]=_0x3dd138[0x2],_0x299ebf[_0x33510][_0x57be91(0x298)]=_0x3dd138[0x3],_0x299ebf[_0x33510][_0x57be91(0x2ac)]=_0x3c358c,_0x299ebf[_0x33510]['floorlevel']=_0x3dd138[0x5];}}}});}),_0x3b84d4[_0x5a4a34(0x1f0)]((_0x3c2e5c,_0x262a96)=>{var _0x3ad034=_0x5a4a34;_0x299ebf[_0x262a96][_0x3ad034(0x253)]=_0x3c2e5c;}),_0x93d2ac[_0x5a4a34(0x1f0)]((_0x3bd6a6,_0x60ba54)=>{var _0x478f05=_0x5a4a34;_0x299ebf[_0x60ba54][_0x478f05(0x1e4)]=_0x3bd6a6;}),_0x85fa7f[_0x5a4a34(0x1f0)]((_0xb5f16c,_0x30b247)=>{var _0xdba481=_0x5a4a34;_0x299ebf[_0x30b247][_0xdba481(0x269)]=_0xb5f16c;}),_0x265337[_0x5a4a34(0x1f0)]((_0x1b7db0,_0x535b67)=>{var _0x3ff8cd=_0x5a4a34;_0x299ebf[_0x535b67][_0x3ff8cd(0x232)]=_0x1b7db0;}),_0x420b71['forEach']((_0x2b51ed,_0x176f84)=>{var _0x40fcbf=_0x5a4a34;_0x299ebf[_0x176f84][_0x40fcbf(0x216)]=_0x2b51ed;}),_0x2d0065[_0x5a4a34(0x1f0)]((_0x5ab9c2,_0x4abab7)=>{var _0x12b919=_0x5a4a34;_0x299ebf[_0x4abab7][_0x12b919(0x212)]=_0x5ab9c2;}),_0x320464[_0x5a4a34(0x1f0)]((_0x146791,_0x37a38c)=>{var _0x290b0a=_0x5a4a34;_0x299ebf[_0x37a38c][_0x290b0a(0x294)]=_0x146791;}),_0x270a88[_0x5a4a34(0x1f0)]((_0x89ce0c,_0xa08dfc)=>{var _0x17dfeb=_0x5a4a34;_0x299ebf[_0xa08dfc][_0x17dfeb(0x273)]=_0x89ce0c;}),_0xad57db[_0x5a4a34(0x1f0)]((_0x22c71a,_0x58dfcb)=>{var _0x29111e=_0x5a4a34;_0x299ebf[_0x58dfcb][_0x29111e(0x2aa)]=_0x22c71a;}),_0x4e3c5d[_0x5a4a34(0x1f0)]((_0x15b0ea,_0x3cf478)=>{var _0x2c03f9=_0x5a4a34;_0x299ebf[_0x3cf478][_0x2c03f9(0x272)]=_0x15b0ea;}),_0x4de038[_0x5a4a34(0x1f0)]((_0x43616e,_0x3bc308)=>{var _0x21fb8d=_0x5a4a34;_0x299ebf[_0x3bc308][_0x21fb8d(0x26f)]=_0x43616e;}),_0x329ada[_0x5a4a34(0x1f0)]((_0x2cb30a,_0x90b45d)=>{var _0x4a9696=_0x5a4a34;_0x299ebf[_0x90b45d][_0x4a9696(0x23d)]=_0x2cb30a;}),_0x3a5b61[_0x5a4a34(0x1f0)]((_0x2f326a,_0x509629)=>{var _0x32bbd1=_0x5a4a34;_0x299ebf[_0x509629][_0x32bbd1(0x281)]=_0x2f326a;}),_0x5bf600[_0x5a4a34(0x1f0)]((_0x1b0208,_0x4f2f8a)=>{_0x299ebf[_0x4f2f8a]['primary_code']=_0x1b0208;}),_0x4e6ae8['forEach']((_0x2c298d,_0x6ea0e4)=>{var _0x4ecc1c=_0x5a4a34;_0x299ebf[_0x6ea0e4][_0x4ecc1c(0x1e6)]=_0x2c298d;});const _0x14dfaf=_0x299ebf[_0x5a4a34(0x1ee)](_0x440e4f=>_0x440e4f[_0x5a4a34(0x269)]!=='0'&&_0x440e4f[_0x5a4a34(0x269)]!=='');var _0x4781fd=0x0;_0x14dfaf[_0x5a4a34(0x1f0)](_0xd4b976=>{var _0x380e91=_0x5a4a34;console[_0x380e91(0x271)](_0x380e91(0x25a),_0xd4b976),parseInt(_0xd4b976[_0x380e91(0x269)])<=0x0&&_0x4781fd++;});if(_0x4781fd!=0x0)return _0x5af8b7[_0x5a4a34(0x1ec)](_0x5a4a34(0x262),_0x5a4a34(0x247)),_0x5cc932[_0x5a4a34(0x28b)](_0x5a4a34(0x292));_0x1deb7a['warehouse_name']=_0x1b0901,_0x1deb7a['date']=_0x4650d8,_0x1deb7a[_0x5a4a34(0x256)]=_0x14dfaf,_0x1deb7a[_0x5a4a34(0x285)]=_0x46f803,_0x1deb7a[_0x5a4a34(0x22f)]=_0x1199ad,_0x1deb7a[_0x5a4a34(0x29b)]=_0x5a4a34(0x25c);const _0x50fccb=await _0x1deb7a[_0x5a4a34(0x22d)]();_0x5af8b7['flash'](_0x5a4a34(0x215),'adjustment\x20data\x20update\x20successfully'),_0x5cc932[_0x5a4a34(0x28b)](_0x5a4a34(0x2b1));}catch(_0x2c5725){console[_0x5a4a34(0x271)](_0x2c5725);}}),router[a0_0x19008e(0x24b)](a0_0x19008e(0x206),async(_0x56fee6,_0x5a812c)=>{var _0x365c45=a0_0x19008e;const {primary_code:_0x2db95e,warehouse_data:_0xc0e57a,rooms_data:_0x3691ae,Roomslist:_0xf2db16}=_0x56fee6[_0x365c45(0x220)],_0x5b5a9d=_0xf2db16[_0x365c45(0x210)](','),_0x1e0c4b=[];async function _0x217db4(_0x153dbf){var _0x346840=_0x365c45;const _0x511360=await warehouse[_0x346840(0x228)]([{'$match':{'name':_0xc0e57a,'room':_0x153dbf}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x2db95e}},{'$group':{'_id':_0x346840(0x265),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x346840(0x201)},'primary_code':{'$first':_0x346840(0x21b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x346840(0x283)},'level':{'$first':_0x346840(0x2a6)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x346840(0x284)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x346840(0x288)},'storage':{'$first':_0x346840(0x29d)},'rack':{'$first':_0x346840(0x260)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x346840(0x1fa)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x346840(0x222)},'product_cat':{'$first':_0x346840(0x2b8)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x346840(0x2b0)},'invoice':{'$first':_0x346840(0x20b)}}}]),_0x45c0f3=await warehouse[_0x346840(0x228)]([{'$match':{'name':_0xc0e57a,'room':_0x153dbf}},{'$unwind':_0x346840(0x21c)},{'$match':{'product_details.secondary_code':_0x2db95e}},{'$group':{'_id':_0x346840(0x265),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x346840(0x201)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x346840(0x1e5)},'product_code':{'$first':_0x346840(0x283)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x346840(0x263)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x346840(0x276)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x346840(0x29d)},'rack':{'$first':_0x346840(0x260)},'expiry_date':{'$first':_0x346840(0x277)},'production_date':{'$first':_0x346840(0x1fa)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x346840(0x222)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x511360[_0x346840(0x22c)]>0x0)_0x1e0c4b['push'](_0x511360);else _0x45c0f3[_0x346840(0x22c)]>0x0&&_0x1e0c4b[_0x346840(0x279)](_0x45c0f3);}const _0x3edf3a=_0x5b5a9d[_0x365c45(0x1f8)](_0x5313ee=>_0x217db4(_0x5313ee));await Promise['all'](_0x3edf3a),_0x5a812c[_0x365c45(0x20f)](_0x1e0c4b);}),router[a0_0x19008e(0x24b)](a0_0x19008e(0x28f),async(_0x50d807,_0x2dc384)=>{var _0x52acd1=a0_0x19008e;const {primaryCode:_0xe7b7ac,secondaryCode:_0x45b4d3,productCode:_0x2405ad,level:_0x2256d6,isle:_0x3e5f83,pallet:_0x539c89,warehouses:_0x2ad298,room:_0x4d3ac9}=_0x50d807['body'];try{const _0x10256c=await warehouse[_0x52acd1(0x228)]([{'$match':{'name':_0x2ad298,'room':_0x4d3ac9}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x2256d6),'product_details.isle':_0x3e5f83,'product_details.pallet':parseInt(_0x539c89)}},{'$group':{'_id':_0x52acd1(0x265),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x52acd1(0x201)},'level':{'$first':_0x52acd1(0x1f2)},'isle':{'$first':_0x52acd1(0x1ff)},'pallet':{'$first':_0x52acd1(0x252)},'maxProducts':{'$first':_0x52acd1(0x243)}}}]);_0x2dc384['status'](0xc8)['json'](_0x10256c);}catch(_0x3cf5d5){_0x2dc384[_0x52acd1(0x27f)](0x194)[_0x52acd1(0x20f)]({'message':_0x3cf5d5[_0x52acd1(0x234)]});}}),module[a0_0x19008e(0x29a)]=router;