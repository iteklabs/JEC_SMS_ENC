var a0_0x1aac4a=a0_0x41d0;(function(_0x769662,_0x127a5f){var _0xaf9896=a0_0x41d0,_0x45d2ad=_0x769662();while(!![]){try{var _0x1adbe5=-parseInt(_0xaf9896(0x229))/0x1*(parseInt(_0xaf9896(0x1cc))/0x2)+parseInt(_0xaf9896(0x1c5))/0x3*(-parseInt(_0xaf9896(0x1e0))/0x4)+-parseInt(_0xaf9896(0x20f))/0x5*(parseInt(_0xaf9896(0x1eb))/0x6)+parseInt(_0xaf9896(0x208))/0x7*(-parseInt(_0xaf9896(0x205))/0x8)+-parseInt(_0xaf9896(0x1b6))/0x9+parseInt(_0xaf9896(0x206))/0xa+-parseInt(_0xaf9896(0x1ca))/0xb*(-parseInt(_0xaf9896(0x1fe))/0xc);if(_0x1adbe5===_0x127a5f)break;else _0x45d2ad['push'](_0x45d2ad['shift']());}catch(_0x585829){_0x45d2ad['push'](_0x45d2ad['shift']());}}}(a0_0x4dbb,0x846d5));const express=require(a0_0x1aac4a(0x269)),app=express(),router=express[a0_0x1aac4a(0x246)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x1aac4a(0x1ba)),users=require(a0_0x1aac4a(0x1ee)),nodemailer=require(a0_0x1aac4a(0x1d5));router[a0_0x1aac4a(0x20c)](a0_0x1aac4a(0x1c1),auth,async(_0xc97055,_0x4d7aa5)=>{var _0x33a4c6=a0_0x1aac4a;try{const {username:_0x2684ff,email:_0x14f5ab,role:_0x5ab7a7}=_0xc97055[_0x33a4c6(0x22f)],_0x4f57ba=_0xc97055['user'],_0x142f65=await profile[_0x33a4c6(0x27b)]({'email':_0x4f57ba[_0x33a4c6(0x1e1)]}),_0x232c49=await master_shop[_0x33a4c6(0x24f)]();console['log']('master',_0x232c49);let _0x968dc3;if(_0x4f57ba[_0x33a4c6(0x28f)]=='staff'){const _0x24d9c9=await staff['findOne']({'email':_0x4f57ba['email']});_0x968dc3=await warehouse['find']({'status':'Enabled','name':_0x24d9c9[_0x33a4c6(0x1e9)]});}else _0x968dc3=await warehouse[_0x33a4c6(0x24f)]({'status':_0x33a4c6(0x1ef)});const _0x3314e4=await product[_0x33a4c6(0x24f)]();let _0x3546de;if(_0x4f57ba[_0x33a4c6(0x28f)]==_0x33a4c6(0x253)){const _0x41b1e2=await staff[_0x33a4c6(0x27b)]({'email':_0x4f57ba['email']});_0x3546de=await adjustment[_0x33a4c6(0x24f)]({'warehouse_name':_0x41b1e2[_0x33a4c6(0x1e9)]});}else _0x3546de=await adjustment[_0x33a4c6(0x26b)]([{'$unwind':'$product'},{'$group':{'_id':_0x33a4c6(0x1c8),'invoice':{'$first':_0x33a4c6(0x21c)},'date':{'$first':_0x33a4c6(0x263)},'warehouse_name':{'$first':_0x33a4c6(0x234)},'room':{'$addToSet':_0x33a4c6(0x249)},'finalize':{'$first':_0x33a4c6(0x244)},'isAllowEdit':{'$first':_0x33a4c6(0x1bf)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x232c49[0x0]['language']==_0x33a4c6(0x239)){var _0x194392=users[_0x33a4c6(0x25f)];console[_0x33a4c6(0x230)](_0x194392);}else{if(_0x232c49[0x0][_0x33a4c6(0x292)]=='Hindi')var _0x194392=users[_0x33a4c6(0x247)];else{if(_0x232c49[0x0][_0x33a4c6(0x292)]=='German')var _0x194392=users[_0x33a4c6(0x1c2)];else{if(_0x232c49[0x0][_0x33a4c6(0x292)]=='Spanish')var _0x194392=users[_0x33a4c6(0x238)];else{if(_0x232c49[0x0][_0x33a4c6(0x292)]==_0x33a4c6(0x24c))var _0x194392=users['French'];else{if(_0x232c49[0x0][_0x33a4c6(0x292)]==_0x33a4c6(0x283))var _0x194392=users[_0x33a4c6(0x282)];else{if(_0x232c49[0x0]['language']==_0x33a4c6(0x1d8))var _0x194392=users['Chinese'];else{if(_0x232c49[0x0]['language']==_0x33a4c6(0x21a))var _0x194392=users[_0x33a4c6(0x23c)];}}}}}}}_0x4d7aa5['render']('adjustment',{'success':_0xc97055[_0x33a4c6(0x207)]('success'),'errors':_0xc97055['flash']('errors'),'role':_0x4f57ba,'profile':_0x142f65,'warehouse':_0x968dc3,'product':_0x3314e4,'adjustment':_0x3546de,'master_shop':_0x232c49,'language':_0x194392});}catch(_0x595d92){console[_0x33a4c6(0x230)](_0x595d92);}});function a0_0x41d0(_0x45eb4f,_0x22f70d){var _0x4dbb70=a0_0x4dbb();return a0_0x41d0=function(_0x41d074,_0x23d4bf){_0x41d074=_0x41d074-0x1b5;var _0x3f65e7=_0x4dbb70[_0x41d074];return _0x3f65e7;},a0_0x41d0(_0x45eb4f,_0x22f70d);}function a0_0x4dbb(){var _0x33e8c1=['$product_details.rack','product_code','stock','secondary_code','/adjustment/view','level','error','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','catch','Arabic\x20(ae)','/view/add_adjustment','$invoice','$product_details.bay','Enclosed','random','filter','room','redirect','errors','</head><body>','length','save','$product_details.expiry_date','product_name','2YVWtYl','An\x20error\x20occurred.','$product_details.bin','/preview/:id','primary_code','$product_details.primary_code','user','log','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','type','$warehouse_name','expiry_date','</table>','unit','Spanish','English\x20(US)','$product_details.pallet','RMSEmail','Arabic','bay','floor','product','site_title','Primary_Units','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<span\x20style=\x22float:\x20right;\x22>','$finalize','/adjustment/preview/','Router','Hindi','$product','$product.room_names','<div>','$product_details','French','$product_details.floorlevel','types','find','product_stock','then','Secondary_units','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','New_Qty_Converted_adj','$product_details.maxPerUnit','$product_details.level','prime1','$product_details.type','maxperunit','Receiving\x20Area','\x20Order\x20Number\x20:\x20','message','render','English','date','True','status','$date','Adjustment\x20Mail','$product_details.product_stock','<h5>','$name','invoice','express','\x20</h2>','aggregate','note','logo','map','$product_details.product_code','batch_code','production_date','prod_name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</tbody>','Rooms','warehouse_name','/upload/','adjustment\x20Finalized\x20successfully','$product_details.secondary_code','$product_details.secondary_unit','findOne','post','Return\x20Rooms','exports','max_per_unit','rack','slice','Portuguese','Portuguese\x20(BR)','foreach\x20newproduct','isAllowEdit','json','$room','toString','/picking_list/PDF_adjustment_rm/','secondary_unit','\x20<>\x20','prod_cat','createTransport','_id','role','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','adjustment\x20data\x20update\x20successfully','language','</tr>','997686egZSJM','Ambient','storage','stockBefore','../models/all_models','back','/view/:id','/CheckingWarehouse','$product_details.batch_code','$isAllowEdit','<h2>\x20','/view','German','bin','<!DOCTYPE\x20html>','279861ursmwM','Shelves','$product_details.storage','$_id','edit_adjustment','9867JUqbtL','second1','13742RidBnh','</thead>','New_Qty_Converted','adjustment\x20add\x20successfull','There\x27s\x20a\x20error\x20in\x20this\x20transaction','adjust_qty','host','Level','$product_details.unit','nodemailer','</div>','<hr\x20class=\x22my-3\x22>','Chinese','split','Error\x20Occurs','ADJ-','port','</td>','room_names','Raw\x20Materials','12UYVpbq','email','id_transaction','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<tr>','params','floorlevel','success','all','warehouse','$product_details._id','400506DkSGbR','Email\x20sent\x20successfully','body','../public/language/languages.json','Enabled','password','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','product_details','push','$product_details.product_cat','Floor','Return\x20Goods','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.product_name','id_transaction_from','<h5\x20style=\x22text-align:\x20left;\x22>','string','new_adjust_qty','18180wVgjXh','findById','forEach','$product_details.invoice','sendMail','Logo.png','prod_code','10448txdTYk','6457820MyniVK','flash','2450cVbDQQ','$product_details.maxProducts','$product_details.production_date','add_adjustment','get','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/../public','45EbsYzr','\x20Order\x20Date\x20:\x20'];a0_0x4dbb=function(){return _0x33e8c1;};return a0_0x4dbb();}async function getRandom8DigitNumber(){var _0x2515f3=a0_0x1aac4a;const _0x228717=0x989680,_0x2fbbe5=0x5f5e0ff,_0x1c3d41=Math[_0x2515f3(0x23e)](Math[_0x2515f3(0x21f)]()*(_0x2fbbe5-_0x228717+0x1))+_0x228717;var _0x54a438;const _0x3bdfa3=await adjustment[_0x2515f3(0x27b)]({'invoice':_0x2515f3(0x1db)+_0x1c3d41});return _0x3bdfa3&&_0x3bdfa3[_0x2515f3(0x225)]>0x0?_0x54a438=_0x2515f3(0x1db)+_0x1c3d41:_0x54a438='ADJ-'+_0x1c3d41,_0x54a438;}router[a0_0x1aac4a(0x20c)](a0_0x1aac4a(0x21b),auth,async(_0x459f9f,_0x560c48)=>{var _0x3433e1=a0_0x1aac4a;try{const {username:_0x3f9819,email:_0x1b8f66,role:_0xf65ce1}=_0x459f9f[_0x3433e1(0x22f)],_0x27f4e7=_0x459f9f[_0x3433e1(0x22f)],_0x4898d5=await profile[_0x3433e1(0x27b)]({'email':_0x27f4e7[_0x3433e1(0x1e1)]}),_0x3d2a21=await master_shop[_0x3433e1(0x24f)]();let _0x4bba85;if(_0x27f4e7[_0x3433e1(0x28f)]==_0x3433e1(0x253)){const _0x16533b=await staff[_0x3433e1(0x27b)]({'email':_0x27f4e7[_0x3433e1(0x1e1)]});_0x4bba85=await warehouse['aggregate']([{'$match':{'status':_0x3433e1(0x1ef),'name':_0x16533b[_0x3433e1(0x1e9)],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x3433e1(0x267),'name':{'$first':'$name'}}}]);}else _0x4bba85=await warehouse['aggregate']([{'$match':{'status':_0x3433e1(0x1ef),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x3433e1(0x1f6)}}},{'$group':{'_id':_0x3433e1(0x267),'name':{'$first':_0x3433e1(0x267)}}}]);const _0x3c669d=await product[_0x3433e1(0x24f)]({}),_0x19acd7=await adjustment[_0x3433e1(0x24f)]({}),_0x439448=_0x19acd7[_0x3433e1(0x225)]+0x1,_0x1fa9e5=_0x3433e1(0x1db)+_0x439448[_0x3433e1(0x288)]()['padStart'](0x5,'0');var _0x40ffa4=[_0x3433e1(0x1b7),_0x3433e1(0x21e),_0x3433e1(0x27d)];if(_0x3d2a21[0x0][_0x3433e1(0x292)]==_0x3433e1(0x239))var _0x367315=users[_0x3433e1(0x25f)];else{if(_0x3d2a21[0x0][_0x3433e1(0x292)]==_0x3433e1(0x247))var _0x367315=users[_0x3433e1(0x247)];else{if(_0x3d2a21[0x0][_0x3433e1(0x292)]==_0x3433e1(0x1c2))var _0x367315=users[_0x3433e1(0x1c2)];else{if(_0x3d2a21[0x0][_0x3433e1(0x292)]==_0x3433e1(0x238))var _0x367315=users[_0x3433e1(0x238)];else{if(_0x3d2a21[0x0][_0x3433e1(0x292)]==_0x3433e1(0x24c))var _0x367315=users[_0x3433e1(0x24c)];else{if(_0x3d2a21[0x0][_0x3433e1(0x292)]==_0x3433e1(0x283))var _0x367315=users['Portuguese'];else{if(_0x3d2a21[0x0][_0x3433e1(0x292)]==_0x3433e1(0x1d8))var _0x367315=users[_0x3433e1(0x1d8)];else{if(_0x3d2a21[0x0][_0x3433e1(0x292)]==_0x3433e1(0x21a))var _0x367315=users[_0x3433e1(0x23c)];}}}}}}}const _0x4fbc26=getRandom8DigitNumber();_0x4fbc26[_0x3433e1(0x251)](_0x2ee1b4=>{var _0x31e6b0=_0x3433e1;_0x560c48[_0x31e6b0(0x25e)](_0x31e6b0(0x20b),{'success':_0x459f9f[_0x31e6b0(0x207)](_0x31e6b0(0x1e7)),'errors':_0x459f9f[_0x31e6b0(0x207)]('errors'),'role':_0x27f4e7,'profile':_0x4898d5,'warehouse':_0x4bba85,'product':_0x3c669d,'master_shop':_0x3d2a21,'language':_0x367315,'rooms_data':_0x40ffa4,'invoice_no':_0x2ee1b4});})['catch'](_0x20bacd=>{var _0x112d2d=_0x3433e1;_0x459f9f[_0x112d2d(0x207)](_0x112d2d(0x223),_0x112d2d(0x1d0)),_0x560c48[_0x112d2d(0x222)]('/adjustment/view');});}catch(_0x217c58){console[_0x3433e1(0x230)](_0x217c58);}}),router['post'](a0_0x1aac4a(0x21b),auth,async(_0x102caf,_0x18b4c2)=>{var _0x25c7ed=a0_0x1aac4a;try{const {warehouse_name:_0x2cac0b,date:_0x432131,prod_name:_0x1901a2,level:_0x3048cf,isle:_0x124987,pallet:_0x191223,stock:_0x31402e,types:_0xf1d8c2,adjust_qty:_0x2fb87b,new_adjust_qty:_0x4586fd,note:_0x21c64e,Room_name:_0x1f2080,invoice:_0x2f502a,JO_number:_0x495921,expiry_date:_0x4b4500}=_0x102caf[_0x25c7ed(0x1ed)];if(typeof _0x1901a2=='string')var _0x585b7b=[_0x102caf[_0x25c7ed(0x1ed)]['prod_name']],_0x401d2e=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x216)]],_0x1f3f00=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x213)]],_0x40c9f7=[_0x102caf['body'][_0x25c7ed(0x24e)]],_0x48dd2b=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x255)]],_0x5077bd=[_0x102caf['body'][_0x25c7ed(0x1ce)]],_0xdc7dcd=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x241)]],_0x245d6d=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x252)]],_0x55a036=[_0x102caf['body'][_0x25c7ed(0x204)]],_0x4ec3f=[_0x102caf[_0x25c7ed(0x1ed)]['batch_code']],_0x288434=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x235)]],_0x29f8d4=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x27f)]],_0x52abc1=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x271)]],_0x36c8e4=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x28c)]],_0x5da62b=[_0x102caf['body']['Rooms']],_0x20eb6a=[_0x102caf[_0x25c7ed(0x1ed)]['prime1']],_0x18fd81=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x1cb)]],_0x3e293d=[_0x102caf[_0x25c7ed(0x1ed)]['prod_invoice']],_0x220759=[_0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x1e2)]];else var _0x585b7b=[..._0x102caf['body'][_0x25c7ed(0x272)]],_0x401d2e=[..._0x102caf[_0x25c7ed(0x1ed)]['level']],_0x1f3f00=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x213)]],_0x40c9f7=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x24e)]],_0x48dd2b=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x255)]],_0x5077bd=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x1ce)]],_0xdc7dcd=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x237)]],_0x245d6d=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x252)]],_0x55a036=[..._0x102caf[_0x25c7ed(0x1ed)]['prod_code']],_0x4ec3f=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x270)]],_0x288434=[..._0x102caf['body'][_0x25c7ed(0x235)]],_0x29f8d4=[..._0x102caf['body']['max_per_unit']],_0x52abc1=[..._0x102caf['body'][_0x25c7ed(0x271)]],_0x36c8e4=[..._0x102caf[_0x25c7ed(0x1ed)]['prod_cat']],_0x5da62b=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x275)]],_0x20eb6a=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x258)]],_0x18fd81=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x1cb)]],_0x3e293d=[..._0x102caf['body']['prod_invoice']],_0x220759=[..._0x102caf[_0x25c7ed(0x1ed)][_0x25c7ed(0x1e2)]];const _0x4f08ba=_0x585b7b[_0x25c7ed(0x26e)](_0x3574e0=>{return _0x3574e0={'product_name':_0x3574e0};});_0x401d2e[_0x25c7ed(0x200)]((_0x3c98d1,_0x43aa98)=>{var _0x5053df=_0x25c7ed;_0x5da62b[_0x5053df(0x200)]((_0x336e48,_0x442b00)=>{var _0x3f8c6c=_0x5053df;if(_0x336e48==_0x3f8c6c(0x25b)&&_0x43aa98==_0x442b00){var _0x2f31b7=_0x3c98d1[_0x3f8c6c(0x281)](0x3);_0x4f08ba[_0x43aa98][_0x3f8c6c(0x1b8)]=_0x3c98d1[0x0],_0x4f08ba[_0x43aa98][_0x3f8c6c(0x280)]=_0x3c98d1[0x1],_0x4f08ba[_0x43aa98][_0x3f8c6c(0x23d)]=0x0,_0x4f08ba[_0x43aa98][_0x3f8c6c(0x1c3)]=0x0,_0x4f08ba[_0x43aa98][_0x3f8c6c(0x233)]=_0x3f8c6c(0x1f5),_0x4f08ba[_0x43aa98][_0x3f8c6c(0x1e6)]=_0x2f31b7;}else{if(_0x336e48==_0x3f8c6c(0x1c6)&&_0x43aa98==_0x442b00){var _0x2f31b7=_0x3c98d1[_0x3f8c6c(0x281)](0x3);_0x4f08ba[_0x43aa98]['storage']=_0x3c98d1[0x0],_0x4f08ba[_0x43aa98]['rack']=_0x3c98d1[0x1],_0x4f08ba[_0x43aa98][_0x3f8c6c(0x23d)]=0x0,_0x4f08ba[_0x43aa98][_0x3f8c6c(0x1c3)]=0x0,_0x4f08ba[_0x43aa98][_0x3f8c6c(0x233)]=_0x3f8c6c(0x1f5),_0x4f08ba[_0x43aa98]['floorlevel']=_0x3c98d1[0x5];}else{if(_0x43aa98==_0x442b00){var _0x437dce;if(_0x3c98d1[0x4]=='L')_0x437dce=_0x3f8c6c(0x1d3);else _0x3c98d1[0x4]=='F'&&(_0x437dce='Floor');_0x4f08ba[_0x43aa98][_0x3f8c6c(0x1b8)]=_0x3c98d1[0x0],_0x4f08ba[_0x43aa98][_0x3f8c6c(0x280)]=_0x3c98d1[0x1],_0x4f08ba[_0x43aa98][_0x3f8c6c(0x23d)]=_0x3c98d1[0x2],_0x4f08ba[_0x43aa98][_0x3f8c6c(0x1c3)]=_0x3c98d1[0x3],_0x4f08ba[_0x43aa98][_0x3f8c6c(0x233)]=_0x437dce,_0x4f08ba[_0x43aa98][_0x3f8c6c(0x1e6)]=_0x3c98d1[0x5];}}}});}),_0x1f3f00[_0x25c7ed(0x200)]((_0x2e3791,_0x244c45)=>{var _0x28e51c=_0x25c7ed;_0x4f08ba[_0x244c45][_0x28e51c(0x1b9)]=_0x2e3791;}),_0x220759['forEach']((_0x42c621,_0x41c467)=>{var _0x4209c0=_0x25c7ed;_0x4f08ba[_0x41c467][_0x4209c0(0x1fa)]=_0x42c621;}),_0x40c9f7[_0x25c7ed(0x200)]((_0x2769ef,_0x77e4dd)=>{var _0x5d93a9=_0x25c7ed;_0x4f08ba[_0x77e4dd][_0x5d93a9(0x24e)]=_0x2769ef;}),_0x48dd2b['forEach']((_0xa3821c,_0x19ee6a)=>{var _0x149657=_0x25c7ed;_0x4f08ba[_0x19ee6a][_0x149657(0x1d1)]=_0xa3821c;}),_0x5077bd[_0x25c7ed(0x200)]((_0x1af376,_0x2e8f3a)=>{_0x4f08ba[_0x2e8f3a]['new_adjust_qty']=_0x1af376;}),_0xdc7dcd[_0x25c7ed(0x200)]((_0x2eff3b,_0x35b605)=>{_0x4f08ba[_0x35b605]['unit']=_0x2eff3b;}),_0x245d6d['forEach']((_0x1041a9,_0x24c418)=>{_0x4f08ba[_0x24c418]['secondary_unit']=_0x1041a9;}),_0x55a036[_0x25c7ed(0x200)]((_0x5cfce2,_0x5595b7)=>{_0x4f08ba[_0x5595b7]['product_code']=_0x5cfce2;}),_0x4ec3f['forEach']((_0x47c3eb,_0x3ea766)=>{_0x4f08ba[_0x3ea766]['batch_code']=_0x47c3eb;}),_0x288434[_0x25c7ed(0x200)]((_0x29446d,_0x54101a)=>{var _0x2334be=_0x25c7ed;_0x4f08ba[_0x54101a][_0x2334be(0x235)]=_0x29446d;}),_0x29f8d4[_0x25c7ed(0x200)]((_0x3fba8e,_0x25493c)=>{_0x4f08ba[_0x25493c]['maxperunit']=_0x3fba8e;}),_0x52abc1[_0x25c7ed(0x200)]((_0x3cd607,_0x72c79e)=>{var _0x5a8ee8=_0x25c7ed;_0x4f08ba[_0x72c79e][_0x5a8ee8(0x271)]=_0x3cd607;}),_0x36c8e4['forEach']((_0x44f241,_0x15d77a)=>{_0x4f08ba[_0x15d77a]['prod_cat']=_0x44f241;}),_0x5da62b[_0x25c7ed(0x200)]((_0x4468ec,_0x7842dd)=>{var _0x116a60=_0x25c7ed;_0x4f08ba[_0x7842dd][_0x116a60(0x1de)]=_0x4468ec;}),_0x20eb6a[_0x25c7ed(0x200)]((_0x5526f0,_0x205463)=>{var _0x1d0f0c=_0x25c7ed;_0x4f08ba[_0x205463][_0x1d0f0c(0x22d)]=_0x5526f0;}),_0x18fd81[_0x25c7ed(0x200)]((_0x40bfe9,_0x101853)=>{var _0x4860ea=_0x25c7ed;_0x4f08ba[_0x101853][_0x4860ea(0x214)]=_0x40bfe9;}),_0x3e293d[_0x25c7ed(0x200)]((_0x2e38ba,_0x5aef63)=>{var _0x3be6f8=_0x25c7ed;_0x4f08ba[_0x5aef63][_0x3be6f8(0x268)]=_0x2e38ba;});const _0x3b3f13=_0x4f08ba['filter'](_0x502feb=>_0x502feb[_0x25c7ed(0x1d1)]!=='0'&&_0x502feb[_0x25c7ed(0x1d1)]!=='');var _0x2ebfe2=0x0;_0x3b3f13[_0x25c7ed(0x200)](_0x476d73=>{var _0x5d615c=_0x25c7ed;console[_0x5d615c(0x230)](_0x5d615c(0x284),_0x476d73),parseInt(_0x476d73[_0x5d615c(0x1d1)])<=0x0&&_0x2ebfe2++;});if(_0x2ebfe2!=0x0)return _0x102caf['flash'](_0x25c7ed(0x223),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x18b4c2['redirect'](_0x25c7ed(0x1bb));const _0x4753ea=new adjustment({'warehouse_name':_0x2cac0b,'date':_0x432131,'product':_0x3b3f13,'note':_0x21c64e,'room':_0x1f2080,'invoice':_0x2f502a,'JO_number':_0x495921,'expiry_date':_0x4b4500}),_0x460b5d=await _0x4753ea['save']();_0x102caf[_0x25c7ed(0x207)]('success',_0x25c7ed(0x1cf)),_0x18b4c2[_0x25c7ed(0x222)](_0x25c7ed(0x245)+_0x460b5d[_0x25c7ed(0x28e)]);}catch(_0x205d1b){console[_0x25c7ed(0x230)](_0x205d1b),_0x18b4c2['status'](0xc8)[_0x25c7ed(0x286)]({'message':_0x205d1b[_0x25c7ed(0x25d)]});}}),router[a0_0x1aac4a(0x20c)]('/preview/:id',auth,async(_0xfa62c0,_0x12e6b2)=>{var _0x417bcc=a0_0x1aac4a;try{const {username:_0x3752cb,email:_0x8429f9,role:_0x58815a}=_0xfa62c0[_0x417bcc(0x22f)],_0x5cfd89=_0xfa62c0[_0x417bcc(0x22f)],_0x204897=await profile[_0x417bcc(0x27b)]({'email':_0x5cfd89[_0x417bcc(0x1e1)]}),_0x663f39=await master_shop[_0x417bcc(0x24f)](),_0x20319f=_0xfa62c0['params']['id'],_0x87599d=await adjustment['findById']({'_id':_0x20319f}),_0x20b453=await purchases[_0x417bcc(0x26b)]([{'$match':{'warehouse_name':_0x87599d[_0x417bcc(0x276)]}},{'$unwind':_0x417bcc(0x248)},{'$group':{'_id':'$product.product_name'}}]),_0x14b63f=await product[_0x417bcc(0x24f)]({}),_0x50703b=await warehouse[_0x417bcc(0x26b)]([{'$match':{'name':_0x87599d[_0x417bcc(0x276)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x417bcc(0x21d)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x417bcc(0x259)},'floorlevel':{'$first':_0x417bcc(0x24d)},'primary_code':{'$first':_0x417bcc(0x22e)},'secondary_code':{'$first':_0x417bcc(0x279)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x417bcc(0x1c7)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x417bcc(0x20a)},'batch_code':{'$first':_0x417bcc(0x1be)},'room':{'$first':_0x417bcc(0x287)}}}]);if(_0x663f39[0x0][_0x417bcc(0x292)]==_0x417bcc(0x239)){var _0x25e68f=users['English'];console[_0x417bcc(0x230)](_0x25e68f);}else{if(_0x663f39[0x0]['language']==_0x417bcc(0x247))var _0x25e68f=users['Hindi'];else{if(_0x663f39[0x0][_0x417bcc(0x292)]==_0x417bcc(0x1c2))var _0x25e68f=users[_0x417bcc(0x1c2)];else{if(_0x663f39[0x0][_0x417bcc(0x292)]==_0x417bcc(0x238))var _0x25e68f=users[_0x417bcc(0x238)];else{if(_0x663f39[0x0][_0x417bcc(0x292)]==_0x417bcc(0x24c))var _0x25e68f=users[_0x417bcc(0x24c)];else{if(_0x663f39[0x0][_0x417bcc(0x292)]==_0x417bcc(0x283))var _0x25e68f=users[_0x417bcc(0x282)];else{if(_0x663f39[0x0][_0x417bcc(0x292)]==_0x417bcc(0x1d8))var _0x25e68f=users[_0x417bcc(0x1d8)];else{if(_0x663f39[0x0][_0x417bcc(0x292)]==_0x417bcc(0x21a))var _0x25e68f=users[_0x417bcc(0x23c)];}}}}}}}_0x12e6b2[_0x417bcc(0x25e)]('edit_adjustment_view',{'success':_0xfa62c0[_0x417bcc(0x207)](_0x417bcc(0x1e7)),'errors':_0xfa62c0['flash']('errors'),'role':_0x5cfd89,'profile':_0x204897,'adjustment':_0x87599d,'stock':_0x50703b,'master_shop':_0x663f39,'warehouse_name':_0x20b453,'unit':_0x14b63f,'language':_0x25e68f});}catch(_0x54ced1){console[_0x417bcc(0x230)](_0x54ced1),_0x12e6b2['status'](0xc8)['json']({'message':_0x54ced1['message']});}}),router[a0_0x1aac4a(0x27c)](a0_0x1aac4a(0x22c),auth,async(_0x1a8d7d,_0x45ce7c)=>{var _0x2052aa=a0_0x1aac4a;try{const _0x357f86=_0x1a8d7d[_0x2052aa(0x1e5)]['id'],{warehouse_name:_0x2024f4,Room_name:_0x5108c7}=_0x1a8d7d['body'],_0x12429d=await adjustment['findById']({'_id':_0x357f86}),_0x258016=_0x12429d[_0x2052aa(0x23f)][_0x2052aa(0x26e)](async _0x5ebabf=>{var _0x45ccf1=_0x2052aa;if(_0x5ebabf[_0x45ccf1(0x1d1)]>0x0){var _0x452746=await warehouse[_0x45ccf1(0x27b)]({'name':_0x2024f4,'room':_0x5ebabf[_0x45ccf1(0x1de)],'warehouse_category':_0x45ccf1(0x1df)});const _0x47bd3a=_0x452746[_0x45ccf1(0x1f2)][_0x45ccf1(0x26e)](_0x250a60=>{var _0x3486d2=_0x45ccf1;console[_0x3486d2(0x230)](_0x5ebabf[_0x3486d2(0x24e)]+_0x3486d2(0x28b));if(_0x5ebabf[_0x3486d2(0x24e)]=='minus'){if(_0x250a60[_0x3486d2(0x228)]==_0x5ebabf[_0x3486d2(0x228)]&&_0x250a60[_0x3486d2(0x1e6)]==_0x5ebabf[_0x3486d2(0x1e6)]&&_0x250a60['type']==_0x5ebabf[_0x3486d2(0x233)]&&_0x250a60[_0x3486d2(0x1c3)]==_0x5ebabf['bin']&&_0x250a60[_0x3486d2(0x23d)]==_0x5ebabf[_0x3486d2(0x23d)]&&_0x250a60[_0x3486d2(0x280)]==_0x5ebabf[_0x3486d2(0x280)]&&_0x250a60[_0x3486d2(0x1b8)]==_0x5ebabf['storage']&&_0x250a60[_0x3486d2(0x235)]==_0x5ebabf[_0x3486d2(0x235)]&&_0x250a60['batch_code']==_0x5ebabf[_0x3486d2(0x270)]&&_0x250a60[_0x3486d2(0x271)]==_0x5ebabf['production_date']&&_0x250a60[_0x3486d2(0x268)]==_0x5ebabf[_0x3486d2(0x268)]&&_0x250a60[_0x3486d2(0x28e)]==_0x5ebabf[_0x3486d2(0x1fa)]){var _0x2f59af;_0x2f59af=_0x5ebabf[_0x3486d2(0x1d1)],_0x5ebabf['prod_cat']=='S'&&(_0x2f59af=_0x5ebabf['adjust_qty']),_0x250a60[_0x3486d2(0x250)]=_0x250a60[_0x3486d2(0x250)]-_0x2f59af;}}else{if(_0x250a60[_0x3486d2(0x228)]==_0x5ebabf[_0x3486d2(0x228)]&&_0x250a60[_0x3486d2(0x1e6)]==_0x5ebabf['floorlevel']&&_0x250a60['type']==_0x5ebabf[_0x3486d2(0x233)]&&_0x250a60[_0x3486d2(0x1c3)]==_0x5ebabf[_0x3486d2(0x1c3)]&&_0x250a60[_0x3486d2(0x23d)]==_0x5ebabf[_0x3486d2(0x23d)]&&_0x250a60[_0x3486d2(0x280)]==_0x5ebabf[_0x3486d2(0x280)]&&_0x250a60[_0x3486d2(0x1b8)]==_0x5ebabf[_0x3486d2(0x1b8)]&&_0x250a60['expiry_date']==_0x5ebabf[_0x3486d2(0x235)]&&_0x250a60[_0x3486d2(0x270)]==_0x5ebabf['batch_code']&&_0x250a60['production_date']==_0x5ebabf['production_date']&&_0x250a60['invoice']==_0x5ebabf['invoice']&&_0x250a60[_0x3486d2(0x28e)]==_0x5ebabf[_0x3486d2(0x1fa)]){console[_0x3486d2(0x230)](_0x5ebabf);var _0x2f59af;_0x2f59af=_0x5ebabf['adjust_qty'],_0x5ebabf[_0x3486d2(0x28c)]=='S'&&(_0x2f59af=_0x5ebabf[_0x3486d2(0x1d1)]),_0x250a60[_0x3486d2(0x250)]=_0x250a60[_0x3486d2(0x250)]+_0x2f59af;}}});}return _0x452746;});Promise[_0x2052aa(0x1e8)](_0x258016)['then'](async _0x51dfb8=>{var _0x781fbe=_0x2052aa;try{for(const _0x47c7d2 of _0x51dfb8){await _0x47c7d2[_0x781fbe(0x226)]();}_0x12429d['finalize']=_0x781fbe(0x261);const _0x459edc=await _0x12429d[_0x781fbe(0x226)](),_0x46c40e=await master_shop[_0x781fbe(0x24f)](),_0x4c9122=await email_settings['findOne'](),_0x3fcaf5=await supervisor_settings[_0x781fbe(0x24f)]();var _0x2d4e61=_0x12429d[_0x781fbe(0x23f)],_0x4559d6='',_0x17ca17;for(_0x17ca17 in _0x2d4e61){_0x4559d6+=_0x781fbe(0x1e4)+_0x781fbe(0x242)+_0x2d4e61[_0x17ca17][_0x781fbe(0x228)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2d4e61[_0x17ca17][_0x781fbe(0x212)]+_0x781fbe(0x1dd)+_0x781fbe(0x242)+_0x2d4e61[_0x17ca17][_0x781fbe(0x1d1)]+_0x781fbe(0x1dd)+_0x781fbe(0x242)+_0x2d4e61[_0x17ca17]['unit']+_0x781fbe(0x1dd)+_0x781fbe(0x242)+_0x2d4e61[_0x17ca17][_0x781fbe(0x28a)]+'</td>'+_0x781fbe(0x242)+_0x12429d[_0x781fbe(0x276)]+_0x781fbe(0x1dd)+_0x781fbe(0x242)+_0x2d4e61[_0x17ca17][_0x781fbe(0x1de)]+'</td>'+_0x781fbe(0x242)+_0x2d4e61[_0x17ca17][_0x781fbe(0x1b8)]+_0x2d4e61[_0x17ca17][_0x781fbe(0x280)]+_0x2d4e61[_0x17ca17][_0x781fbe(0x23d)]+_0x2d4e61[_0x17ca17]['bin']+_0x2d4e61[_0x17ca17][_0x781fbe(0x233)][0x0]+_0x2d4e61[_0x17ca17][_0x781fbe(0x1e6)]+'</td>',_0x781fbe(0x1b5);}let _0x504d43=nodemailer[_0x781fbe(0x28d)]({'host':_0x4c9122[_0x781fbe(0x1d2)],'port':Number(_0x4c9122[_0x781fbe(0x1dc)]),'secure':![],'auth':{'user':_0x4c9122[_0x781fbe(0x1e1)],'pass':_0x4c9122[_0x781fbe(0x1f0)]}}),_0x11a760={'from':_0x4c9122[_0x781fbe(0x1e1)],'to':_0x3fcaf5[0x0][_0x781fbe(0x23b)],'subject':_0x781fbe(0x264),'attachments':[{'filename':_0x781fbe(0x203),'path':__dirname+_0x781fbe(0x20e)+_0x781fbe(0x277)+_0x46c40e[0x0]['image'],'cid':_0x781fbe(0x26d)}],'html':_0x781fbe(0x1c4)+'<html><head><title></title>'+_0x781fbe(0x224)+_0x781fbe(0x24a)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x781fbe(0x24a)+_0x781fbe(0x1f7)+_0x781fbe(0x1d6)+_0x781fbe(0x24a)+_0x781fbe(0x1c0)+_0x46c40e[0x0][_0x781fbe(0x240)]+_0x781fbe(0x26a)+_0x781fbe(0x1d6)+_0x781fbe(0x1d6)+_0x781fbe(0x1d7)+_0x781fbe(0x24a)+_0x781fbe(0x1fb)+_0x781fbe(0x25c)+_0x12429d['invoice']+'\x20'+_0x781fbe(0x243)+_0x781fbe(0x210)+_0x12429d[_0x781fbe(0x260)]+'\x20'+'</span>'+_0x781fbe(0x231)+_0x781fbe(0x1d6)+_0x781fbe(0x1e3)+_0x781fbe(0x273)+'<tr>'+_0x781fbe(0x254)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x781fbe(0x218)+_0x781fbe(0x232)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x781fbe(0x20d)+_0x781fbe(0x290)+_0x781fbe(0x1b5)+_0x781fbe(0x1cd)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4559d6+'\x20'+_0x781fbe(0x274)+_0x781fbe(0x236)+_0x781fbe(0x24a)+'<strong>\x20Regards\x20</strong>'+_0x781fbe(0x266)+_0x46c40e[0x0][_0x781fbe(0x240)]+_0x781fbe(0x231)+_0x781fbe(0x1d6)+_0x781fbe(0x1d6)+'</body></html>'};_0x504d43[_0x781fbe(0x202)](_0x11a760,function(_0x33d1a5,_0x51377e){var _0x41ec9d=_0x781fbe;_0x33d1a5?(console['log'](_0x33d1a5),console[_0x41ec9d(0x230)](_0x41ec9d(0x1da))):console[_0x41ec9d(0x230)](_0x41ec9d(0x1ec));}),_0x1a8d7d[_0x781fbe(0x207)](_0x781fbe(0x1e7),_0x781fbe(0x278)),_0x45ce7c[_0x781fbe(0x222)](_0x781fbe(0x289)+_0x459edc[_0x781fbe(0x28e)]);}catch(_0x249e01){console[_0x781fbe(0x217)](_0x249e01),_0x45ce7c[_0x781fbe(0x262)](0x1f4)[_0x781fbe(0x286)]({'error':_0x781fbe(0x1f8)});}})[_0x2052aa(0x219)](_0x32e02c=>{var _0xbac11c=_0x2052aa;console[_0xbac11c(0x217)](_0x32e02c),_0x45ce7c[_0xbac11c(0x262)](0x1f4)[_0xbac11c(0x286)]({'error':_0xbac11c(0x22a)});});}catch(_0x13667d){console['log'](_0x13667d),_0x45ce7c[_0x2052aa(0x262)](0xc8)[_0x2052aa(0x286)]({'message':_0x13667d['message']});}}),router[a0_0x1aac4a(0x20c)](a0_0x1aac4a(0x1bc),auth,async(_0x66523a,_0x1bf0b7)=>{var _0x15ef1f=a0_0x1aac4a;try{const {username:_0x4e7e9d,email:_0x3019b2,role:_0x74d4bb}=_0x66523a[_0x15ef1f(0x22f)],_0x7d71f5=_0x66523a[_0x15ef1f(0x22f)],_0x490ba5=await profile[_0x15ef1f(0x27b)]({'email':_0x7d71f5[_0x15ef1f(0x1e1)]}),_0x2bc398=await master_shop[_0x15ef1f(0x24f)](),_0x48f9a3=_0x66523a[_0x15ef1f(0x1e5)]['id'],_0x20a14a=await adjustment[_0x15ef1f(0x1ff)]({'_id':_0x48f9a3}),_0x232613=await purchases[_0x15ef1f(0x26b)]([{'$match':{'warehouse_name':_0x20a14a[_0x15ef1f(0x276)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x12f959=await product[_0x15ef1f(0x24f)]({}),_0xebd1b0=await warehouse[_0x15ef1f(0x26b)]([{'$match':{'name':_0x20a14a['warehouse_name']}},{'$unwind':_0x15ef1f(0x24b)},{'$group':{'_id':_0x15ef1f(0x1ea),'name':{'$first':_0x15ef1f(0x1f9)},'product_stock':{'$first':_0x15ef1f(0x265)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x15ef1f(0x22b)},'type':{'$first':_0x15ef1f(0x259)},'floorlevel':{'$first':_0x15ef1f(0x24d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x15ef1f(0x26f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x15ef1f(0x227)},'production_date':{'$first':_0x15ef1f(0x20a)},'batch_code':{'$first':_0x15ef1f(0x1be)},'room':{'$first':_0x15ef1f(0x287)}}}]);let _0x3de976;if(_0x7d71f5[_0x15ef1f(0x28f)]=='staff'){const _0x52eb1b=await staff[_0x15ef1f(0x27b)]({'email':_0x7d71f5[_0x15ef1f(0x1e1)]});_0x3de976=await warehouse[_0x15ef1f(0x26b)]([{'$match':{'status':_0x15ef1f(0x1ef),'name':_0x52eb1b[_0x15ef1f(0x1e9)],'warehouse_category':_0x15ef1f(0x1df),'name':{'$ne':_0x15ef1f(0x1f6)}}},{'$group':{'_id':_0x15ef1f(0x267),'name':{'$first':_0x15ef1f(0x267)}}}]);}else _0x3de976=await warehouse[_0x15ef1f(0x26b)]([{'$match':{'status':_0x15ef1f(0x1ef),'warehouse_category':_0x15ef1f(0x1df),'name':{'$ne':_0x15ef1f(0x1f6)}}},{'$group':{'_id':_0x15ef1f(0x267),'name':{'$first':_0x15ef1f(0x267)}}}]);if(_0x2bc398[0x0][_0x15ef1f(0x292)]=='English\x20(US)'){var _0x155b30=users[_0x15ef1f(0x25f)];console['log'](_0x155b30);}else{if(_0x2bc398[0x0][_0x15ef1f(0x292)]==_0x15ef1f(0x247))var _0x155b30=users['Hindi'];else{if(_0x2bc398[0x0][_0x15ef1f(0x292)]==_0x15ef1f(0x1c2))var _0x155b30=users[_0x15ef1f(0x1c2)];else{if(_0x2bc398[0x0][_0x15ef1f(0x292)]==_0x15ef1f(0x238))var _0x155b30=users['Spanish'];else{if(_0x2bc398[0x0][_0x15ef1f(0x292)]==_0x15ef1f(0x24c))var _0x155b30=users['French'];else{if(_0x2bc398[0x0][_0x15ef1f(0x292)]==_0x15ef1f(0x283))var _0x155b30=users['Portuguese'];else{if(_0x2bc398[0x0][_0x15ef1f(0x292)]==_0x15ef1f(0x1d8))var _0x155b30=users[_0x15ef1f(0x1d8)];else{if(_0x2bc398[0x0][_0x15ef1f(0x292)]=='Arabic\x20(ae)')var _0x155b30=users[_0x15ef1f(0x23c)];}}}}}}}_0x1bf0b7[_0x15ef1f(0x25e)](_0x15ef1f(0x1c9),{'success':_0x66523a[_0x15ef1f(0x207)](_0x15ef1f(0x1e7)),'errors':_0x66523a[_0x15ef1f(0x207)](_0x15ef1f(0x223)),'role':_0x7d71f5,'profile':_0x490ba5,'adjustment':_0x20a14a,'stock':_0xebd1b0,'master_shop':_0x2bc398,'warehouse_name':_0x232613,'unit':_0x12f959,'language':_0x155b30,'warehouse':_0x3de976});}catch(_0x31b112){console['log'](_0x31b112),_0x1bf0b7['status'](0xc8)[_0x15ef1f(0x286)]({'message':_0x31b112[_0x15ef1f(0x25d)]});}}),router[a0_0x1aac4a(0x27c)]('/view/:id',auth,async(_0x1bb40b,_0x515032)=>{var _0x203ad2=a0_0x1aac4a;try{const _0x4d6ee1=_0x1bb40b['params']['id'],_0x336191=await adjustment['findById']({'_id':_0x4d6ee1}),_0x5e09ac=await warehouse[_0x203ad2(0x27b)]({'name':_0x336191[_0x203ad2(0x276)],'room':_0x336191[_0x203ad2(0x221)]}),{warehouse_name:_0x1279d1,date:_0x1f9de5,prod_name:_0x2384be,level:_0x453bb8,isle:_0x1b92c4,pallet:_0x12b399,stock:_0x17ce84,types:_0x2ed339,adjust_qty:_0x33ff6d,new_adjust_qty:_0x2c2879,note:_0x3ba624,Room_name:_0x37bbbd,invoice:_0x3095ff,JO_number:_0x12c555,expiry_date:_0x416bdf}=_0x1bb40b['body'];if(typeof _0x2384be==_0x203ad2(0x1fc))var _0x541c0d=[_0x1bb40b[_0x203ad2(0x1ed)]['prod_name']],_0x15da9d=[_0x1bb40b[_0x203ad2(0x1ed)]['level']],_0x122c52=[_0x1bb40b[_0x203ad2(0x1ed)]['stock']],_0x18a7b5=[_0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x24e)]],_0x5c140c=[_0x1bb40b[_0x203ad2(0x1ed)]['New_Qty_Converted_adj']],_0x4596fc=[_0x1bb40b['body'][_0x203ad2(0x1ce)]],_0x55985b=[_0x1bb40b['body']['Primary_Units']],_0x1e5fff=[_0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x252)]],_0xe1012f=[_0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x204)]],_0x10e740=[_0x1bb40b[_0x203ad2(0x1ed)]['batch_code']],_0x2f08b5=[_0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x235)]],_0x34f59b=[_0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x27f)]],_0xbc9abb=[_0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x271)]],_0x3f7c14=[_0x1bb40b[_0x203ad2(0x1ed)]['prod_cat']],_0x2e55ea=[_0x1bb40b['body'][_0x203ad2(0x275)]],_0x623903=[_0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x258)]],_0xc82dd6=[_0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x1cb)]];else var _0x541c0d=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x272)]],_0x15da9d=[..._0x1bb40b[_0x203ad2(0x1ed)]['level']],_0x122c52=[..._0x1bb40b['body'][_0x203ad2(0x213)]],_0x18a7b5=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x24e)]],_0x5c140c=[..._0x1bb40b[_0x203ad2(0x1ed)]['New_Qty_Converted_adj']],_0x4596fc=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x1ce)]],_0x55985b=[..._0x1bb40b['body']['unit']],_0x1e5fff=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x252)]],_0xe1012f=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x204)]],_0x10e740=[..._0x1bb40b['body'][_0x203ad2(0x270)]],_0x2f08b5=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x235)]],_0x34f59b=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x27f)]],_0xbc9abb=[..._0x1bb40b['body'][_0x203ad2(0x271)]],_0x3f7c14=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x28c)]],_0x2e55ea=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x275)]],_0x623903=[..._0x1bb40b[_0x203ad2(0x1ed)][_0x203ad2(0x258)]],_0xc82dd6=[..._0x1bb40b[_0x203ad2(0x1ed)]['second1']];const _0xaac5a6=_0x541c0d['map'](_0x5837e8=>{return _0x5837e8={'product_name':_0x5837e8};});_0x15da9d[_0x203ad2(0x200)]((_0x3fdb58,_0x471476)=>{var _0x4cacd0=_0x203ad2;_0x2e55ea[_0x4cacd0(0x200)]((_0x97d572,_0x82869a)=>{var _0x17f593=_0x4cacd0;if(_0x97d572==_0x17f593(0x25b)&&_0x471476==_0x82869a){var _0x3a2f72=_0x3fdb58['slice'](0x3);_0xaac5a6[_0x471476][_0x17f593(0x1b8)]=_0x3fdb58[0x0],_0xaac5a6[_0x471476]['rack']=_0x3fdb58[0x1],_0xaac5a6[_0x471476][_0x17f593(0x23d)]=0x0,_0xaac5a6[_0x471476][_0x17f593(0x1c3)]=0x0,_0xaac5a6[_0x471476][_0x17f593(0x233)]=_0x17f593(0x1f5),_0xaac5a6[_0x471476]['floorlevel']=_0x3a2f72;}else{if(_0x97d572==_0x17f593(0x1c6)&&_0x471476==_0x82869a){var _0x3a2f72=_0x3fdb58[_0x17f593(0x281)](0x3);_0xaac5a6[_0x471476][_0x17f593(0x1b8)]=_0x3fdb58[0x0],_0xaac5a6[_0x471476]['rack']=_0x3fdb58[0x1],_0xaac5a6[_0x471476][_0x17f593(0x23d)]=0x0,_0xaac5a6[_0x471476]['bin']=0x0,_0xaac5a6[_0x471476]['type']=_0x17f593(0x1f5),_0xaac5a6[_0x471476][_0x17f593(0x1e6)]=_0x3fdb58[0x5];}else{if(_0x471476==_0x82869a){var _0x5cc3fd;if(_0x3fdb58[0x4]=='L')_0x5cc3fd=_0x17f593(0x1d3);else _0x3fdb58[0x4]=='F'&&(_0x5cc3fd=_0x17f593(0x1f5));_0xaac5a6[_0x471476]['storage']=_0x3fdb58[0x0],_0xaac5a6[_0x471476][_0x17f593(0x280)]=_0x3fdb58[0x1],_0xaac5a6[_0x471476][_0x17f593(0x23d)]=_0x3fdb58[0x2],_0xaac5a6[_0x471476][_0x17f593(0x1c3)]=_0x3fdb58[0x3],_0xaac5a6[_0x471476]['type']=_0x5cc3fd,_0xaac5a6[_0x471476]['floorlevel']=_0x3fdb58[0x5];}}}});}),_0x122c52[_0x203ad2(0x200)]((_0x6c644d,_0x5b42a8)=>{var _0xbfd8fd=_0x203ad2;_0xaac5a6[_0x5b42a8][_0xbfd8fd(0x1b9)]=_0x6c644d;}),_0x18a7b5[_0x203ad2(0x200)]((_0x1855e1,_0x50a181)=>{var _0x96d1a9=_0x203ad2;_0xaac5a6[_0x50a181][_0x96d1a9(0x24e)]=_0x1855e1;}),_0x5c140c[_0x203ad2(0x200)]((_0x383c9c,_0x177ad2)=>{var _0x21efbf=_0x203ad2;_0xaac5a6[_0x177ad2][_0x21efbf(0x1d1)]=_0x383c9c;}),_0x4596fc['forEach']((_0x524197,_0x384e19)=>{var _0x82d861=_0x203ad2;_0xaac5a6[_0x384e19][_0x82d861(0x1fd)]=_0x524197;}),_0x55985b[_0x203ad2(0x200)]((_0x4da419,_0x34fb25)=>{var _0x399069=_0x203ad2;_0xaac5a6[_0x34fb25][_0x399069(0x237)]=_0x4da419;}),_0x1e5fff['forEach']((_0x3788e6,_0x55fd8d)=>{var _0x27770d=_0x203ad2;_0xaac5a6[_0x55fd8d][_0x27770d(0x28a)]=_0x3788e6;}),_0xe1012f[_0x203ad2(0x200)]((_0x4bb911,_0x3ee7a2)=>{var _0x2bfb93=_0x203ad2;_0xaac5a6[_0x3ee7a2][_0x2bfb93(0x212)]=_0x4bb911;}),_0x10e740['forEach']((_0x4bf541,_0x22bd39)=>{var _0x464c24=_0x203ad2;_0xaac5a6[_0x22bd39][_0x464c24(0x270)]=_0x4bf541;}),_0x2f08b5[_0x203ad2(0x200)]((_0x51e7f9,_0x3ca1f4)=>{var _0x5ac234=_0x203ad2;_0xaac5a6[_0x3ca1f4][_0x5ac234(0x235)]=_0x51e7f9;}),_0x34f59b[_0x203ad2(0x200)]((_0x3592c5,_0x1b7401)=>{var _0x2534b8=_0x203ad2;_0xaac5a6[_0x1b7401][_0x2534b8(0x25a)]=_0x3592c5;}),_0xbc9abb[_0x203ad2(0x200)]((_0x3363bf,_0x2bc998)=>{var _0x31063a=_0x203ad2;_0xaac5a6[_0x2bc998][_0x31063a(0x271)]=_0x3363bf;}),_0x3f7c14[_0x203ad2(0x200)]((_0xacfc2c,_0x7871)=>{var _0x4cdb44=_0x203ad2;_0xaac5a6[_0x7871][_0x4cdb44(0x28c)]=_0xacfc2c;}),_0x2e55ea[_0x203ad2(0x200)]((_0x3aaa9b,_0x2f06a7)=>{var _0x746922=_0x203ad2;_0xaac5a6[_0x2f06a7][_0x746922(0x1de)]=_0x3aaa9b;}),_0x623903[_0x203ad2(0x200)]((_0x361270,_0x303075)=>{_0xaac5a6[_0x303075]['primary_code']=_0x361270;}),_0xc82dd6[_0x203ad2(0x200)]((_0x494adf,_0x4e8f1d)=>{var _0x1449a8=_0x203ad2;_0xaac5a6[_0x4e8f1d][_0x1449a8(0x214)]=_0x494adf;});const _0x57f497=_0xaac5a6[_0x203ad2(0x220)](_0x53b7a2=>_0x53b7a2[_0x203ad2(0x1d1)]!=='0'&&_0x53b7a2[_0x203ad2(0x1d1)]!=='');var _0xa1d23b=0x0;_0x57f497['forEach'](_0x313ecf=>{var _0x487bed=_0x203ad2;console[_0x487bed(0x230)](_0x487bed(0x284),_0x313ecf),parseInt(_0x313ecf['adjust_qty'])<=0x0&&_0xa1d23b++;});if(_0xa1d23b!=0x0)return _0x1bb40b[_0x203ad2(0x207)](_0x203ad2(0x223),_0x203ad2(0x1f1)),_0x515032[_0x203ad2(0x222)](_0x203ad2(0x1bb));_0x336191[_0x203ad2(0x276)]=_0x1279d1,_0x336191[_0x203ad2(0x260)]=_0x1f9de5,_0x336191[_0x203ad2(0x23f)]=_0x57f497,_0x336191[_0x203ad2(0x26c)]=_0x3ba624,_0x336191[_0x203ad2(0x268)]=_0x3095ff,_0x336191[_0x203ad2(0x285)]='False';const _0x567ad0=await _0x336191[_0x203ad2(0x226)]();_0x1bb40b[_0x203ad2(0x207)](_0x203ad2(0x1e7),_0x203ad2(0x291)),_0x515032['redirect'](_0x203ad2(0x215));}catch(_0x432466){console[_0x203ad2(0x230)](_0x432466);}}),router[a0_0x1aac4a(0x27c)]('/barcode_scanner',async(_0x3ec4dd,_0xbfdb42)=>{var _0xf7c0dd=a0_0x1aac4a;const {primary_code:_0x4c9f2d,warehouse_data:_0x5532d2,rooms_data:_0x2025b1,Roomslist:_0x1c9819}=_0x3ec4dd['body'],_0x5baf79=_0x1c9819[_0xf7c0dd(0x1d9)](','),_0x1c0d98=[];async function _0x24fe2e(_0x3cc11){var _0x55b39a=_0xf7c0dd;const _0x46d0f6=await warehouse[_0x55b39a(0x26b)]([{'$match':{'name':_0x5532d2,'room':_0x3cc11}},{'$unwind':_0x55b39a(0x24b)},{'$match':{'product_details.primary_code':_0x4c9f2d}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x55b39a(0x1f9)},'product_stock':{'$first':_0x55b39a(0x265)},'primary_code':{'$first':_0x55b39a(0x22e)},'secondary_code':{'$first':_0x55b39a(0x279)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x55b39a(0x21d)},'isle':{'$first':_0x55b39a(0x22b)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x55b39a(0x24d)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x55b39a(0x1c7)},'rack':{'$first':_0x55b39a(0x211)},'expiry_date':{'$first':_0x55b39a(0x227)},'production_date':{'$first':_0x55b39a(0x20a)},'maxPerUnit':{'$first':_0x55b39a(0x256)},'batch_code':{'$first':_0x55b39a(0x1be)},'product_cat':{'$first':_0x55b39a(0x1f4)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x55b39a(0x201)}}}]),_0x5e7799=await warehouse['aggregate']([{'$match':{'name':_0x5532d2,'room':_0x3cc11}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4c9f2d}},{'$group':{'_id':_0x55b39a(0x1ea),'name':{'$first':_0x55b39a(0x1f9)},'product_stock':{'$first':_0x55b39a(0x265)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x55b39a(0x279)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x55b39a(0x22b)},'type':{'$first':_0x55b39a(0x259)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x55b39a(0x1d4)},'secondary_unit':{'$first':_0x55b39a(0x27a)},'storage':{'$first':_0x55b39a(0x1c7)},'rack':{'$first':_0x55b39a(0x211)},'expiry_date':{'$first':_0x55b39a(0x227)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x55b39a(0x256)},'batch_code':{'$first':_0x55b39a(0x1be)},'product_cat':{'$first':_0x55b39a(0x1f4)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x55b39a(0x287)}}}]);if(_0x46d0f6[_0x55b39a(0x225)]>0x0)_0x1c0d98[_0x55b39a(0x1f3)](_0x46d0f6);else _0x5e7799['length']>0x0&&_0x1c0d98[_0x55b39a(0x1f3)](_0x5e7799);}const _0x1829c1=_0x5baf79[_0xf7c0dd(0x26e)](_0x543f9e=>_0x24fe2e(_0x543f9e));await Promise[_0xf7c0dd(0x1e8)](_0x1829c1),_0xbfdb42['json'](_0x1c0d98);}),router[a0_0x1aac4a(0x27c)](a0_0x1aac4a(0x1bd),async(_0x280442,_0x51f807)=>{var _0x21ee17=a0_0x1aac4a;const {primaryCode:_0x54fe52,secondaryCode:_0x511b52,productCode:_0x53252a,level:_0x41733a,isle:_0x454425,pallet:_0x42608d,warehouses:_0x3d3031,room:_0x241a97}=_0x280442['body'];try{const _0x12011f=await warehouse[_0x21ee17(0x26b)]([{'$match':{'name':_0x3d3031,'room':_0x241a97}},{'$unwind':_0x21ee17(0x24b)},{'$match':{'product_details.level':parseInt(_0x41733a),'product_details.isle':_0x454425,'product_details.pallet':parseInt(_0x42608d)}},{'$group':{'_id':_0x21ee17(0x1ea),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x21ee17(0x257)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x21ee17(0x23a)},'maxProducts':{'$first':_0x21ee17(0x209)}}}]);_0x51f807[_0x21ee17(0x262)](0xc8)[_0x21ee17(0x286)](_0x12011f);}catch(_0x203d57){_0x51f807[_0x21ee17(0x262)](0x194)[_0x21ee17(0x286)]({'message':_0x203d57[_0x21ee17(0x25d)]});}}),module[a0_0x1aac4a(0x27e)]=router;