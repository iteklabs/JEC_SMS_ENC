var a0_0x125d22=a0_0x3eba;(function(_0x498229,_0x1960ca){var _0x351dd5=a0_0x3eba,_0x1a0bef=_0x498229();while(!![]){try{var _0x40eec1=parseInt(_0x351dd5(0x166))/0x1*(parseInt(_0x351dd5(0x15d))/0x2)+parseInt(_0x351dd5(0x179))/0x3+parseInt(_0x351dd5(0x10e))/0x4+-parseInt(_0x351dd5(0x182))/0x5+parseInt(_0x351dd5(0x1a7))/0x6*(-parseInt(_0x351dd5(0x140))/0x7)+-parseInt(_0x351dd5(0xee))/0x8+-parseInt(_0x351dd5(0x186))/0x9;if(_0x40eec1===_0x1960ca)break;else _0x1a0bef['push'](_0x1a0bef['shift']());}catch(_0x527e9e){_0x1a0bef['push'](_0x1a0bef['shift']());}}}(a0_0x4343,0xd8878));const express=require('express'),app=express(),router=express[a0_0x125d22(0x127)](),auth=require(a0_0x125d22(0x1a2)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0x125d22(0x13e)),nodemailer=require(a0_0x125d22(0x196));router[a0_0x125d22(0x14f)]('/view',auth,async(_0x2e85d2,_0xeba07e)=>{var _0x4e648e=a0_0x125d22;try{const {username:_0x515423,email:_0x252de5,role:_0x235c70}=_0x2e85d2[_0x4e648e(0x16b)],_0x2276e3=_0x2e85d2[_0x4e648e(0x16b)],_0x15a589=await profile[_0x4e648e(0x11c)]({'email':_0x2276e3[_0x4e648e(0x13d)]}),_0x258f88=await master_shop[_0x4e648e(0x11a)]();console[_0x4e648e(0x1a8)](_0x4e648e(0xf4),_0x258f88);let _0x288619;if(_0x2276e3['role']=='staff'){const _0x43b251=await staff[_0x4e648e(0x11c)]({'email':_0x2276e3[_0x4e648e(0x13d)]});_0x288619=await warehouse[_0x4e648e(0x11a)]({'status':_0x4e648e(0x149),'name':_0x43b251[_0x4e648e(0x18a)]});}else _0x288619=await warehouse[_0x4e648e(0x11a)]({'status':_0x4e648e(0x149)});const _0x4b24ac=await product[_0x4e648e(0x11a)]();let _0x4cc629;if(_0x2276e3['role']==_0x4e648e(0x15f)){const _0x3d3fd4=await staff[_0x4e648e(0x11c)]({'email':_0x2276e3[_0x4e648e(0x13d)]});_0x4cc629=await adjustment[_0x4e648e(0x11a)]({'warehouse_name':_0x3d3fd4[_0x4e648e(0x18a)]});}else _0x4cc629=await adjustment['aggregate']([{'$unwind':_0x4e648e(0x177)},{'$group':{'_id':'$_id','invoice':{'$first':_0x4e648e(0x156)},'date':{'$first':_0x4e648e(0x195)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x4e648e(0x118)},'finalize':{'$first':_0x4e648e(0x132)},'isAllowEdit':{'$first':_0x4e648e(0x161)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x258f88[0x0][_0x4e648e(0x142)]==_0x4e648e(0x192)){var _0x22aa8e=users[_0x4e648e(0x114)];console[_0x4e648e(0x1a8)](_0x22aa8e);}else{if(_0x258f88[0x0][_0x4e648e(0x142)]==_0x4e648e(0x12a))var _0x22aa8e=users[_0x4e648e(0x12a)];else{if(_0x258f88[0x0][_0x4e648e(0x142)]==_0x4e648e(0x19f))var _0x22aa8e=users[_0x4e648e(0x19f)];else{if(_0x258f88[0x0]['language']==_0x4e648e(0x101))var _0x22aa8e=users[_0x4e648e(0x101)];else{if(_0x258f88[0x0][_0x4e648e(0x142)]==_0x4e648e(0xf9))var _0x22aa8e=users[_0x4e648e(0xf9)];else{if(_0x258f88[0x0][_0x4e648e(0x142)]==_0x4e648e(0x14e))var _0x22aa8e=users[_0x4e648e(0x108)];else{if(_0x258f88[0x0][_0x4e648e(0x142)]==_0x4e648e(0x116))var _0x22aa8e=users[_0x4e648e(0x116)];else{if(_0x258f88[0x0][_0x4e648e(0x142)]==_0x4e648e(0xf2))var _0x22aa8e=users[_0x4e648e(0x157)];}}}}}}}_0xeba07e[_0x4e648e(0xea)](_0x4e648e(0x143),{'success':_0x2e85d2['flash'](_0x4e648e(0x158)),'errors':_0x2e85d2[_0x4e648e(0x102)](_0x4e648e(0x14b)),'role':_0x2276e3,'profile':_0x15a589,'warehouse':_0x288619,'product':_0x4b24ac,'adjustment':_0x4cc629,'master_shop':_0x258f88,'language':_0x22aa8e});}catch(_0x42e94a){console[_0x4e648e(0x1a8)](_0x42e94a);}});function a0_0x3eba(_0x18c8a2,_0x3497ed){var _0x4343d2=a0_0x4343();return a0_0x3eba=function(_0x3eba75,_0x497faf){_0x3eba75=_0x3eba75-0xe2;var _0x5e2727=_0x4343d2[_0x3eba75];return _0x5e2727;},a0_0x3eba(_0x18c8a2,_0x3497ed);}function a0_0x4343(){var _0x48b672=['product_details','unit','$product_details.product_cat','types','$invoice','Arabic','success','maxperunit','edit_adjustment_view','Floor','</h5>','122EBNTyl','new_adjust_qty','staff','RMSEmail','$isAllowEdit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/adjustment/preview/','prime1','prod_cat','14853ylkgex','warehouse_name','isAllowEdit','invoice','bay','user','toString','/CheckingWarehouse','json','\x20Order\x20Date\x20:\x20','second1','batch_code','split','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','New_Qty_Converted_adj','storage','$product_details.bin','$product','secondary_code','3555336xbCjhS','$product_details.invoice','catch','adjustment\x20Finalized\x20successfully','Primary_Units','<span\x20style=\x22float:\x20right;\x22>','/upload/','id_transaction','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','8536515FNdgHA','$product_details.maxProducts','$product_details.production_date','room_names','463770SZXqBg','</thead>','slice','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','warehouse','$product_details.type','Receiving\x20Area','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.product_stock','\x20<>\x20','port','id_transaction_from','English\x20(US)','$product_details.pallet','length','$date','nodemailer','Return\x20Goods','$product_details.batch_code','$product_details.secondary_unit','primary_code','logo','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','map','Secondary_units','German','</tbody>','Email\x20sent\x20successfully','../middleware/auth','Return\x20Rooms','note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','bin','588uzWauM','log','product_code','Enclosed','ADJ-','createTransport','site_title','\x20</h2>','stock','$product_details.storage','adjust_qty','padStart','message','/preview/:id','all','_id','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','type','/adjustment/view','</div>','finalize','floorlevel','prod_name','edit_adjustment','product_name','product_stock','render','Ambient','max_per_unit','findById','8214680yshvdT','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','production_date','/view/:id','Arabic\x20(ae)','<h2>\x20','master','/view/add_adjustment','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<tbody\x20style=\x22text-align:\x20center;\x22>','adjustment\x20add\x20successfull','French','<table\x20style=\x22width:\x20100%\x20!important;\x22>','body','Adjustment\x20Mail','\x20Order\x20Number\x20:\x20','Rooms','$product_details.bay','foreach\x20newproduct','Spanish','flash','prod_code','push','Level','adjustment\x20data\x20update\x20successfully','<html><head><title></title>','Portuguese','secondary_unit','prod_invoice','/../public','host','$product_details.primary_code','6892148sSQuBZ','expiry_date','stockBefore','$product_details.product_name','<!DOCTYPE\x20html>','An\x20error\x20occurred.','English','<tr>','Chinese','$product_details','$product.room_names','save','find','aggregate','findOne','$room','level','params','<strong>\x20Regards\x20</strong>','$product_details.expiry_date','forEach','</body></html>','<hr\x20class=\x22my-3\x22>','product','</table>','Router','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','then','Hindi','$product.product_name','$product_details.secondary_code','room','minus','date','Shelves','New_Qty_Converted','$finalize','$product_details.floorlevel','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.rack','</tr>','$product_details.maxPerUnit','string','random','$product_details._id','error','status','email','../public/language/languages.json','post','10115wassiB','<div>','language','adjustment','floor','role','exports','rack','back','Enabled','<h5>','errors','redirect','$name','Portuguese\x20(BR)','get','Raw\x20Materials','$product_details.product_code'];a0_0x4343=function(){return _0x48b672;};return a0_0x4343();}async function getRandom8DigitNumber(){var _0x456ef2=a0_0x125d22;const _0x3c88de=0x989680,_0x374b4f=0x5f5e0ff,_0x33e974=Math[_0x456ef2(0x144)](Math[_0x456ef2(0x139)]()*(_0x374b4f-_0x3c88de+0x1))+_0x3c88de;var _0x1367b7;const _0x388dcc=await adjustment['findOne']({'invoice':_0x456ef2(0x1ab)+_0x33e974});return _0x388dcc&&_0x388dcc[_0x456ef2(0x194)]>0x0?_0x1367b7=_0x456ef2(0x1ab)+_0x33e974:_0x1367b7='ADJ-'+_0x33e974,_0x1367b7;}router[a0_0x125d22(0x14f)](a0_0x125d22(0xf5),auth,async(_0x93d03e,_0x101e14)=>{var _0x4b1820=a0_0x125d22;try{const {username:_0x3ad3fd,email:_0x58a392,role:_0x99c401}=_0x93d03e[_0x4b1820(0x16b)],_0x3ceecd=_0x93d03e[_0x4b1820(0x16b)],_0x3df014=await profile['findOne']({'email':_0x3ceecd[_0x4b1820(0x13d)]}),_0x325c33=await master_shop['find']();let _0x35539d;if(_0x3ceecd[_0x4b1820(0x145)]==_0x4b1820(0x15f)){const _0x19552b=await staff[_0x4b1820(0x11c)]({'email':_0x3ceecd['email']});_0x35539d=await warehouse[_0x4b1820(0x11b)]([{'$match':{'status':_0x4b1820(0x149),'name':_0x19552b[_0x4b1820(0x18a)],'warehouse_category':_0x4b1820(0x150),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x4b1820(0x14d),'name':{'$first':_0x4b1820(0x14d)}}}]);}else _0x35539d=await warehouse['aggregate']([{'$match':{'status':_0x4b1820(0x149),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x4b1820(0x197)}}},{'$group':{'_id':_0x4b1820(0x14d),'name':{'$first':'$name'}}}]);const _0x4874c3=await product[_0x4b1820(0x11a)]({}),_0x145ffc=await adjustment[_0x4b1820(0x11a)]({}),_0x457159=_0x145ffc[_0x4b1820(0x194)]+0x1,_0x2fa2af=_0x4b1820(0x1ab)+_0x457159[_0x4b1820(0x16c)]()[_0x4b1820(0x1b2)](0x5,'0');var _0x2150f7=[_0x4b1820(0xeb),_0x4b1820(0x1aa),_0x4b1820(0x1a3)];if(_0x325c33[0x0][_0x4b1820(0x142)]==_0x4b1820(0x192))var _0x431940=users[_0x4b1820(0x114)];else{if(_0x325c33[0x0]['language']=='Hindi')var _0x431940=users[_0x4b1820(0x12a)];else{if(_0x325c33[0x0]['language']==_0x4b1820(0x19f))var _0x431940=users[_0x4b1820(0x19f)];else{if(_0x325c33[0x0][_0x4b1820(0x142)]==_0x4b1820(0x101))var _0x431940=users[_0x4b1820(0x101)];else{if(_0x325c33[0x0][_0x4b1820(0x142)]==_0x4b1820(0xf9))var _0x431940=users[_0x4b1820(0xf9)];else{if(_0x325c33[0x0][_0x4b1820(0x142)]==_0x4b1820(0x14e))var _0x431940=users[_0x4b1820(0x108)];else{if(_0x325c33[0x0][_0x4b1820(0x142)]==_0x4b1820(0x116))var _0x431940=users[_0x4b1820(0x116)];else{if(_0x325c33[0x0][_0x4b1820(0x142)]==_0x4b1820(0xf2))var _0x431940=users['Arabic'];}}}}}}}const _0x35d9cd=getRandom8DigitNumber();_0x35d9cd['then'](_0x2885cd=>{var _0x5ce258=_0x4b1820;_0x101e14[_0x5ce258(0xea)]('add_adjustment',{'success':_0x93d03e[_0x5ce258(0x102)](_0x5ce258(0x158)),'errors':_0x93d03e[_0x5ce258(0x102)](_0x5ce258(0x14b)),'role':_0x3ceecd,'profile':_0x3df014,'warehouse':_0x35539d,'product':_0x4874c3,'master_shop':_0x325c33,'language':_0x431940,'rooms_data':_0x2150f7,'invoice_no':_0x2885cd});})['catch'](_0x412d73=>{var _0x4ef940=_0x4b1820;_0x93d03e[_0x4ef940(0x102)](_0x4ef940(0x14b),_0x4ef940(0x18d)),_0x101e14[_0x4ef940(0x14c)](_0x4ef940(0xe2));});}catch(_0x2a6655){console[_0x4b1820(0x1a8)](_0x2a6655);}}),router[a0_0x125d22(0x13f)]('/view/add_adjustment',auth,async(_0x440bca,_0x33004e)=>{var _0x4d32ca=a0_0x125d22;try{const {warehouse_name:_0x52b38b,date:_0x566e8a,prod_name:_0xba2da4,level:_0x57541f,isle:_0x51d010,pallet:_0x507593,stock:_0x1c642c,types:_0x61928c,adjust_qty:_0xc78ef8,new_adjust_qty:_0x3d68bd,note:_0x32d2ce,Room_name:_0x42e996,invoice:_0x5063b7,JO_number:_0x46b0b9,expiry_date:_0x11e4a2}=_0x440bca[_0x4d32ca(0xfb)];if(typeof _0xba2da4==_0x4d32ca(0x138))var _0x1b7f95=[_0x440bca['body']['prod_name']],_0x15ae03=[_0x440bca['body'][_0x4d32ca(0x11e)]],_0x12674f=[_0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x1af)]],_0x360561=[_0x440bca[_0x4d32ca(0xfb)]['types']],_0x5f0434=[_0x440bca['body'][_0x4d32ca(0x174)]],_0x51e451=[_0x440bca[_0x4d32ca(0xfb)]['New_Qty_Converted']],_0x73f658=[_0x440bca[_0x4d32ca(0xfb)]['Primary_Units']],_0x11b966=[_0x440bca['body'][_0x4d32ca(0x19e)]],_0x9b01b9=[_0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x103)]],_0xd47143=[_0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x171)]],_0x27468a=[_0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x10f)]],_0x1ca901=[_0x440bca[_0x4d32ca(0xfb)]['max_per_unit']],_0x2efe1d=[_0x440bca['body'][_0x4d32ca(0xf0)]],_0xe55805=[_0x440bca[_0x4d32ca(0xfb)]['prod_cat']],_0x3e5101=[_0x440bca['body'][_0x4d32ca(0xfe)]],_0x162f48=[_0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x164)]],_0x407b71=[_0x440bca['body']['second1']],_0x1c73a8=[_0x440bca[_0x4d32ca(0xfb)]['prod_invoice']],_0x35a101=[_0x440bca['body'][_0x4d32ca(0x180)]];else var _0x1b7f95=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0xe6)]],_0x15ae03=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x11e)]],_0x12674f=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x1af)]],_0x360561=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x155)]],_0x5f0434=[..._0x440bca['body'][_0x4d32ca(0x174)]],_0x51e451=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x131)]],_0x73f658=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x153)]],_0x11b966=[..._0x440bca[_0x4d32ca(0xfb)]['Secondary_units']],_0x9b01b9=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x103)]],_0xd47143=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x171)]],_0x27468a=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x10f)]],_0x1ca901=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0xec)]],_0x2efe1d=[..._0x440bca['body'][_0x4d32ca(0xf0)]],_0xe55805=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x165)]],_0x3e5101=[..._0x440bca['body'][_0x4d32ca(0xfe)]],_0x162f48=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x164)]],_0x407b71=[..._0x440bca['body'][_0x4d32ca(0x170)]],_0x1c73a8=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x10a)]],_0x35a101=[..._0x440bca[_0x4d32ca(0xfb)][_0x4d32ca(0x180)]];const _0x24e0b5=_0x1b7f95['map'](_0x1e562e=>{return _0x1e562e={'product_name':_0x1e562e};});_0x15ae03[_0x4d32ca(0x122)]((_0x43288d,_0x3b1ba0)=>{var _0x23af55=_0x4d32ca;_0x3e5101[_0x23af55(0x122)]((_0x2e5e82,_0x308809)=>{var _0x5962d7=_0x23af55;if(_0x2e5e82==_0x5962d7(0x18c)&&_0x3b1ba0==_0x308809){var _0x326932=_0x43288d[_0x5962d7(0x188)](0x3);_0x24e0b5[_0x3b1ba0][_0x5962d7(0x175)]=_0x43288d[0x0],_0x24e0b5[_0x3b1ba0][_0x5962d7(0x147)]=_0x43288d[0x1],_0x24e0b5[_0x3b1ba0][_0x5962d7(0x16a)]=0x0,_0x24e0b5[_0x3b1ba0][_0x5962d7(0x1a6)]=0x0,_0x24e0b5[_0x3b1ba0]['type']=_0x5962d7(0x15b),_0x24e0b5[_0x3b1ba0][_0x5962d7(0xe5)]=_0x326932;}else{if(_0x2e5e82==_0x5962d7(0x130)&&_0x3b1ba0==_0x308809){var _0x326932=_0x43288d[_0x5962d7(0x188)](0x3);_0x24e0b5[_0x3b1ba0][_0x5962d7(0x175)]=_0x43288d[0x0],_0x24e0b5[_0x3b1ba0][_0x5962d7(0x147)]=_0x43288d[0x1],_0x24e0b5[_0x3b1ba0]['bay']=0x0,_0x24e0b5[_0x3b1ba0]['bin']=0x0,_0x24e0b5[_0x3b1ba0][_0x5962d7(0x1b9)]=_0x5962d7(0x15b),_0x24e0b5[_0x3b1ba0]['floorlevel']=_0x43288d[0x5];}else{if(_0x3b1ba0==_0x308809){var _0x766133;if(_0x43288d[0x4]=='L')_0x766133=_0x5962d7(0x105);else _0x43288d[0x4]=='F'&&(_0x766133='Floor');_0x24e0b5[_0x3b1ba0]['storage']=_0x43288d[0x0],_0x24e0b5[_0x3b1ba0]['rack']=_0x43288d[0x1],_0x24e0b5[_0x3b1ba0]['bay']=_0x43288d[0x2],_0x24e0b5[_0x3b1ba0][_0x5962d7(0x1a6)]=_0x43288d[0x3],_0x24e0b5[_0x3b1ba0][_0x5962d7(0x1b9)]=_0x766133,_0x24e0b5[_0x3b1ba0][_0x5962d7(0xe5)]=_0x43288d[0x5];}}}});}),_0x12674f[_0x4d32ca(0x122)]((_0x367822,_0x591637)=>{_0x24e0b5[_0x591637]['stockBefore']=_0x367822;}),_0x35a101[_0x4d32ca(0x122)]((_0x532510,_0x33ec65)=>{var _0x176aea=_0x4d32ca;_0x24e0b5[_0x33ec65][_0x176aea(0x191)]=_0x532510;}),_0x360561[_0x4d32ca(0x122)]((_0x5856aa,_0x369be8)=>{var _0x106281=_0x4d32ca;_0x24e0b5[_0x369be8][_0x106281(0x155)]=_0x5856aa;}),_0x5f0434[_0x4d32ca(0x122)]((_0x5523da,_0x3de488)=>{var _0x3f1c65=_0x4d32ca;_0x24e0b5[_0x3de488][_0x3f1c65(0x1b1)]=_0x5523da;}),_0x51e451[_0x4d32ca(0x122)]((_0x3ca79b,_0x3a2ea3)=>{var _0x2f2537=_0x4d32ca;_0x24e0b5[_0x3a2ea3][_0x2f2537(0x15e)]=_0x3ca79b;}),_0x73f658[_0x4d32ca(0x122)]((_0x555e10,_0x4b7c6d)=>{_0x24e0b5[_0x4b7c6d]['unit']=_0x555e10;}),_0x11b966[_0x4d32ca(0x122)]((_0x3c11ac,_0x4dac43)=>{var _0x48c525=_0x4d32ca;_0x24e0b5[_0x4dac43][_0x48c525(0x109)]=_0x3c11ac;}),_0x9b01b9[_0x4d32ca(0x122)]((_0x4907a7,_0x3dbe88)=>{var _0x216c27=_0x4d32ca;_0x24e0b5[_0x3dbe88][_0x216c27(0x1a9)]=_0x4907a7;}),_0xd47143['forEach']((_0x45a937,_0x2e78e3)=>{var _0x3e23b2=_0x4d32ca;_0x24e0b5[_0x2e78e3][_0x3e23b2(0x171)]=_0x45a937;}),_0x27468a[_0x4d32ca(0x122)]((_0x4f7b3a,_0x149774)=>{_0x24e0b5[_0x149774]['expiry_date']=_0x4f7b3a;}),_0x1ca901['forEach']((_0x3443f9,_0x3838fe)=>{_0x24e0b5[_0x3838fe]['maxperunit']=_0x3443f9;}),_0x2efe1d[_0x4d32ca(0x122)]((_0x41f1c8,_0x3da569)=>{var _0x4b209d=_0x4d32ca;_0x24e0b5[_0x3da569][_0x4b209d(0xf0)]=_0x41f1c8;}),_0xe55805['forEach']((_0x15a563,_0x15c986)=>{_0x24e0b5[_0x15c986]['prod_cat']=_0x15a563;}),_0x3e5101[_0x4d32ca(0x122)]((_0x59de2e,_0xa09a2b)=>{var _0x3f0a19=_0x4d32ca;_0x24e0b5[_0xa09a2b][_0x3f0a19(0x185)]=_0x59de2e;}),_0x162f48[_0x4d32ca(0x122)]((_0x31e202,_0x3b6cb7)=>{var _0x378dde=_0x4d32ca;_0x24e0b5[_0x3b6cb7][_0x378dde(0x19a)]=_0x31e202;}),_0x407b71[_0x4d32ca(0x122)]((_0x301803,_0x5087dc)=>{_0x24e0b5[_0x5087dc]['secondary_code']=_0x301803;}),_0x1c73a8[_0x4d32ca(0x122)]((_0x286c62,_0x516ebb)=>{_0x24e0b5[_0x516ebb]['invoice']=_0x286c62;});const _0x3ee2e7=_0x24e0b5['filter'](_0x4041cb=>_0x4041cb[_0x4d32ca(0x1b1)]!=='0'&&_0x4041cb['adjust_qty']!=='');var _0x426f25=0x0;_0x3ee2e7[_0x4d32ca(0x122)](_0x47b928=>{var _0x353a20=_0x4d32ca;console[_0x353a20(0x1a8)](_0x353a20(0x100),_0x47b928),parseInt(_0x47b928[_0x353a20(0x1b1)])<=0x0&&_0x426f25++;});if(_0x426f25!=0x0)return _0x440bca[_0x4d32ca(0x102)](_0x4d32ca(0x14b),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x33004e[_0x4d32ca(0x14c)](_0x4d32ca(0x148));const _0x21b9c0=new adjustment({'warehouse_name':_0x52b38b,'date':_0x566e8a,'product':_0x3ee2e7,'note':_0x32d2ce,'room':_0x42e996,'invoice':_0x5063b7,'JO_number':_0x46b0b9,'expiry_date':_0x11e4a2}),_0x47c63e=await _0x21b9c0[_0x4d32ca(0x119)]();_0x440bca[_0x4d32ca(0x102)]('success',_0x4d32ca(0xf8)),_0x33004e[_0x4d32ca(0x14c)](_0x4d32ca(0x163)+_0x47c63e['_id']);}catch(_0x409664){console[_0x4d32ca(0x1a8)](_0x409664),_0x33004e[_0x4d32ca(0x13c)](0xc8)[_0x4d32ca(0x16e)]({'message':_0x409664['message']});}}),router[a0_0x125d22(0x14f)](a0_0x125d22(0x1b4),auth,async(_0x333f33,_0x69f384)=>{var _0x3e7139=a0_0x125d22;try{const {username:_0x33161d,email:_0x2ebcae,role:_0x43400a}=_0x333f33['user'],_0x5ce05c=_0x333f33[_0x3e7139(0x16b)],_0x598fd1=await profile[_0x3e7139(0x11c)]({'email':_0x5ce05c[_0x3e7139(0x13d)]}),_0xfa078a=await master_shop['find'](),_0x32c7f7=_0x333f33['params']['id'],_0x20112c=await adjustment[_0x3e7139(0xed)]({'_id':_0x32c7f7}),_0x3687a8=await purchases[_0x3e7139(0x11b)]([{'$match':{'warehouse_name':_0x20112c['warehouse_name']}},{'$unwind':_0x3e7139(0x177)},{'$group':{'_id':'$product.product_name'}}]),_0x478459=await product['find']({}),_0x509e45=await warehouse['aggregate']([{'$match':{'name':_0x20112c[_0x3e7139(0x167)]}},{'$unwind':_0x3e7139(0x117)},{'$group':{'_id':_0x3e7139(0x13a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3e7139(0x18e)},'bay':{'$first':_0x3e7139(0xff)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3e7139(0x18b)},'floorlevel':{'$first':_0x3e7139(0x133)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3e7139(0x12c)},'product_code':{'$first':_0x3e7139(0x151)},'storage':{'$first':_0x3e7139(0x1b0)},'rack':{'$first':_0x3e7139(0x135)},'maxPerUnit':{'$first':_0x3e7139(0x137)},'expiry_date':{'$first':_0x3e7139(0x121)},'production_date':{'$first':_0x3e7139(0x184)},'batch_code':{'$first':_0x3e7139(0x198)},'room':{'$first':_0x3e7139(0x11d)}}}]);if(_0xfa078a[0x0][_0x3e7139(0x142)]=='English\x20(US)'){var _0x2d9836=users[_0x3e7139(0x114)];console['log'](_0x2d9836);}else{if(_0xfa078a[0x0]['language']==_0x3e7139(0x12a))var _0x2d9836=users[_0x3e7139(0x12a)];else{if(_0xfa078a[0x0][_0x3e7139(0x142)]==_0x3e7139(0x19f))var _0x2d9836=users[_0x3e7139(0x19f)];else{if(_0xfa078a[0x0][_0x3e7139(0x142)]==_0x3e7139(0x101))var _0x2d9836=users['Spanish'];else{if(_0xfa078a[0x0][_0x3e7139(0x142)]==_0x3e7139(0xf9))var _0x2d9836=users[_0x3e7139(0xf9)];else{if(_0xfa078a[0x0][_0x3e7139(0x142)]=='Portuguese\x20(BR)')var _0x2d9836=users[_0x3e7139(0x108)];else{if(_0xfa078a[0x0][_0x3e7139(0x142)]==_0x3e7139(0x116))var _0x2d9836=users[_0x3e7139(0x116)];else{if(_0xfa078a[0x0][_0x3e7139(0x142)]=='Arabic\x20(ae)')var _0x2d9836=users[_0x3e7139(0x157)];}}}}}}}_0x69f384[_0x3e7139(0xea)](_0x3e7139(0x15a),{'success':_0x333f33[_0x3e7139(0x102)](_0x3e7139(0x158)),'errors':_0x333f33[_0x3e7139(0x102)](_0x3e7139(0x14b)),'role':_0x5ce05c,'profile':_0x598fd1,'adjustment':_0x20112c,'stock':_0x509e45,'master_shop':_0xfa078a,'warehouse_name':_0x3687a8,'unit':_0x478459,'language':_0x2d9836});}catch(_0x3f8028){console['log'](_0x3f8028),_0x69f384['status'](0xc8)['json']({'message':_0x3f8028[_0x3e7139(0x1b3)]});}}),router[a0_0x125d22(0x13f)]('/preview/:id',auth,async(_0x55a0af,_0x5dca31)=>{var _0x459de9=a0_0x125d22;try{const _0x2b364d=_0x55a0af['params']['id'],{warehouse_name:_0x11fe96,Room_name:_0x5aa908}=_0x55a0af[_0x459de9(0xfb)],_0x509637=await adjustment[_0x459de9(0xed)]({'_id':_0x2b364d}),_0x4ac3a0=_0x509637[_0x459de9(0x125)]['map'](async _0x311beb=>{var _0x2de8da=_0x459de9;if(_0x311beb[_0x2de8da(0x1b1)]>0x0){var _0x1dbc2f=await warehouse[_0x2de8da(0x11c)]({'name':_0x11fe96,'room':_0x311beb[_0x2de8da(0x185)],'warehouse_category':_0x2de8da(0x150)});const _0x30a36d=_0x1dbc2f[_0x2de8da(0x152)][_0x2de8da(0x19d)](_0x5e0678=>{var _0x28226a=_0x2de8da;console[_0x28226a(0x1a8)](_0x311beb[_0x28226a(0x155)]+_0x28226a(0x18f));if(_0x311beb[_0x28226a(0x155)]==_0x28226a(0x12e)){if(_0x5e0678['product_name']==_0x311beb[_0x28226a(0xe8)]&&_0x5e0678[_0x28226a(0xe5)]==_0x311beb[_0x28226a(0xe5)]&&_0x5e0678[_0x28226a(0x1b9)]==_0x311beb[_0x28226a(0x1b9)]&&_0x5e0678['bin']==_0x311beb[_0x28226a(0x1a6)]&&_0x5e0678['bay']==_0x311beb['bay']&&_0x5e0678[_0x28226a(0x147)]==_0x311beb['rack']&&_0x5e0678[_0x28226a(0x175)]==_0x311beb['storage']&&_0x5e0678[_0x28226a(0x10f)]==_0x311beb[_0x28226a(0x10f)]&&_0x5e0678[_0x28226a(0x171)]==_0x311beb[_0x28226a(0x171)]&&_0x5e0678[_0x28226a(0xf0)]==_0x311beb[_0x28226a(0xf0)]&&_0x5e0678[_0x28226a(0x169)]==_0x311beb[_0x28226a(0x169)]&&_0x5e0678['_id']==_0x311beb[_0x28226a(0x191)]){var _0x1b9996;_0x1b9996=_0x311beb['adjust_qty'],_0x311beb[_0x28226a(0x165)]=='S'&&(_0x1b9996=_0x311beb[_0x28226a(0x1b1)]),_0x5e0678[_0x28226a(0xe9)]=_0x5e0678['product_stock']-_0x1b9996;}}else{if(_0x5e0678['product_name']==_0x311beb[_0x28226a(0xe8)]&&_0x5e0678[_0x28226a(0xe5)]==_0x311beb[_0x28226a(0xe5)]&&_0x5e0678['type']==_0x311beb[_0x28226a(0x1b9)]&&_0x5e0678[_0x28226a(0x1a6)]==_0x311beb[_0x28226a(0x1a6)]&&_0x5e0678['bay']==_0x311beb[_0x28226a(0x16a)]&&_0x5e0678[_0x28226a(0x147)]==_0x311beb[_0x28226a(0x147)]&&_0x5e0678[_0x28226a(0x175)]==_0x311beb['storage']&&_0x5e0678[_0x28226a(0x10f)]==_0x311beb[_0x28226a(0x10f)]&&_0x5e0678['batch_code']==_0x311beb[_0x28226a(0x171)]&&_0x5e0678[_0x28226a(0xf0)]==_0x311beb['production_date']&&_0x5e0678['invoice']==_0x311beb[_0x28226a(0x169)]&&_0x5e0678[_0x28226a(0x1b6)]==_0x311beb[_0x28226a(0x191)]){console[_0x28226a(0x1a8)](_0x311beb);var _0x1b9996;_0x1b9996=_0x311beb[_0x28226a(0x1b1)],_0x311beb[_0x28226a(0x165)]=='S'&&(_0x1b9996=_0x311beb['adjust_qty']),_0x5e0678[_0x28226a(0xe9)]=_0x5e0678[_0x28226a(0xe9)]+_0x1b9996;}}});}return _0x1dbc2f;});Promise[_0x459de9(0x1b5)](_0x4ac3a0)[_0x459de9(0x129)](async _0x2a4425=>{var _0xd47f67=_0x459de9;try{for(const _0x1213a5 of _0x2a4425){await _0x1213a5[_0xd47f67(0x119)]();}_0x509637[_0xd47f67(0xe4)]='True';const _0x201f03=await _0x509637[_0xd47f67(0x119)](),_0x21aea1=await master_shop[_0xd47f67(0x11a)](),_0x10c392=await email_settings[_0xd47f67(0x11c)](),_0x5c900b=await supervisor_settings['find']();var _0x2c5387=_0x509637['product'],_0x5ce86f='',_0x3527c3;for(_0x3527c3 in _0x2c5387){_0x5ce86f+=_0xd47f67(0x115)+_0xd47f67(0x189)+_0x2c5387[_0x3527c3][_0xd47f67(0xe8)]+_0xd47f67(0x1b7)+_0xd47f67(0x189)+_0x2c5387[_0x3527c3]['product_code']+'</td>'+_0xd47f67(0x189)+_0x2c5387[_0x3527c3][_0xd47f67(0x1b1)]+_0xd47f67(0x1b7)+_0xd47f67(0x189)+_0x2c5387[_0x3527c3][_0xd47f67(0x153)]+_0xd47f67(0x1b7)+_0xd47f67(0x189)+_0x2c5387[_0x3527c3][_0xd47f67(0x109)]+_0xd47f67(0x1b7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x509637[_0xd47f67(0x167)]+_0xd47f67(0x1b7)+_0xd47f67(0x189)+_0x2c5387[_0x3527c3][_0xd47f67(0x185)]+_0xd47f67(0x1b7)+_0xd47f67(0x189)+_0x2c5387[_0x3527c3]['storage']+_0x2c5387[_0x3527c3][_0xd47f67(0x147)]+_0x2c5387[_0x3527c3][_0xd47f67(0x16a)]+_0x2c5387[_0x3527c3][_0xd47f67(0x1a6)]+_0x2c5387[_0x3527c3][_0xd47f67(0x1b9)][0x0]+_0x2c5387[_0x3527c3][_0xd47f67(0xe5)]+_0xd47f67(0x1b7),_0xd47f67(0x136);}let _0x1e3cee=nodemailer[_0xd47f67(0x1ac)]({'host':_0x10c392[_0xd47f67(0x10c)],'port':Number(_0x10c392[_0xd47f67(0x190)]),'secure':![],'auth':{'user':_0x10c392[_0xd47f67(0x13d)],'pass':_0x10c392['password']}}),_0x3eed80={'from':_0x10c392[_0xd47f67(0x13d)],'to':_0x5c900b[0x0][_0xd47f67(0x160)],'subject':_0xd47f67(0xfc),'attachments':[{'filename':'Logo.png','path':__dirname+_0xd47f67(0x10b)+_0xd47f67(0x17f)+_0x21aea1[0x0]['image'],'cid':_0xd47f67(0x19b)}],'html':_0xd47f67(0x112)+_0xd47f67(0x107)+'</head><body>'+_0xd47f67(0x141)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0xd47f67(0x141)+_0xd47f67(0x181)+_0xd47f67(0xe3)+_0xd47f67(0x141)+_0xd47f67(0xf3)+_0x21aea1[0x0][_0xd47f67(0x1ad)]+_0xd47f67(0x1ae)+_0xd47f67(0xe3)+_0xd47f67(0xe3)+_0xd47f67(0x124)+_0xd47f67(0x141)+_0xd47f67(0x134)+_0xd47f67(0xfd)+_0x509637[_0xd47f67(0x169)]+'\x20'+_0xd47f67(0x17e)+_0xd47f67(0x16f)+_0x509637[_0xd47f67(0x12f)]+'\x20'+'</span>'+_0xd47f67(0x15c)+_0xd47f67(0xe3)+_0xd47f67(0xfa)+_0xd47f67(0xef)+'<tr>'+_0xd47f67(0xf6)+_0xd47f67(0x19c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0xd47f67(0x128)+_0xd47f67(0x1b8)+_0xd47f67(0x1a5)+_0xd47f67(0x173)+_0xd47f67(0x162)+_0xd47f67(0x136)+_0xd47f67(0x187)+_0xd47f67(0xf7)+'\x20'+_0x5ce86f+'\x20'+_0xd47f67(0x1a0)+_0xd47f67(0x126)+_0xd47f67(0x141)+_0xd47f67(0x120)+_0xd47f67(0x14a)+_0x21aea1[0x0]['site_title']+_0xd47f67(0x15c)+'</div>'+'</div>'+_0xd47f67(0x123)};_0x1e3cee['sendMail'](_0x3eed80,function(_0x16dbd8,_0x22d9a9){var _0x91f622=_0xd47f67;_0x16dbd8?(console['log'](_0x16dbd8),console[_0x91f622(0x1a8)]('Error\x20Occurs')):console[_0x91f622(0x1a8)](_0x91f622(0x1a1));}),_0x55a0af[_0xd47f67(0x102)](_0xd47f67(0x158),_0xd47f67(0x17c)),_0x5dca31[_0xd47f67(0x14c)]('/picking_list/PDF_adjustment_rm/'+_0x201f03[_0xd47f67(0x1b6)]);}catch(_0x5b40b0){console['error'](_0x5b40b0),_0x5dca31[_0xd47f67(0x13c)](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x459de9(0x17b)](_0x3d803b=>{var _0x6028c7=_0x459de9;console[_0x6028c7(0x13b)](_0x3d803b),_0x5dca31[_0x6028c7(0x13c)](0x1f4)[_0x6028c7(0x16e)]({'error':_0x6028c7(0x113)});});}catch(_0x5a2db8){console[_0x459de9(0x1a8)](_0x5a2db8),_0x5dca31[_0x459de9(0x13c)](0xc8)[_0x459de9(0x16e)]({'message':_0x5a2db8[_0x459de9(0x1b3)]});}}),router[a0_0x125d22(0x14f)](a0_0x125d22(0xf1),auth,async(_0x4b821b,_0x7b1400)=>{var _0x286dae=a0_0x125d22;try{const {username:_0x1a047e,email:_0x504822,role:_0x36c5c9}=_0x4b821b['user'],_0x5a4516=_0x4b821b[_0x286dae(0x16b)],_0x5a61cc=await profile[_0x286dae(0x11c)]({'email':_0x5a4516[_0x286dae(0x13d)]}),_0x2a0ed9=await master_shop['find'](),_0x12260c=_0x4b821b[_0x286dae(0x11f)]['id'],_0x4cc32d=await adjustment[_0x286dae(0xed)]({'_id':_0x12260c}),_0x1cf3f0=await purchases[_0x286dae(0x11b)]([{'$match':{'warehouse_name':_0x4cc32d[_0x286dae(0x167)]}},{'$unwind':_0x286dae(0x177)},{'$group':{'_id':_0x286dae(0x12b)}}]),_0x2f7872=await product[_0x286dae(0x11a)]({}),_0x1b4c4b=await warehouse[_0x286dae(0x11b)]([{'$match':{'name':_0x4cc32d[_0x286dae(0x167)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x286dae(0x13a),'name':{'$first':_0x286dae(0x111)},'product_stock':{'$first':_0x286dae(0x18e)},'bay':{'$first':_0x286dae(0xff)},'bin':{'$first':_0x286dae(0x176)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x286dae(0x10d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x286dae(0x151)},'storage':{'$first':_0x286dae(0x1b0)},'rack':{'$first':_0x286dae(0x135)},'maxPerUnit':{'$first':_0x286dae(0x137)},'expiry_date':{'$first':_0x286dae(0x121)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x286dae(0x11d)}}}]);let _0x4312cf;if(_0x5a4516['role']=='staff'){const _0x4debda=await staff[_0x286dae(0x11c)]({'email':_0x5a4516[_0x286dae(0x13d)]});_0x4312cf=await warehouse[_0x286dae(0x11b)]([{'$match':{'status':'Enabled','name':_0x4debda[_0x286dae(0x18a)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x286dae(0x197)}}},{'$group':{'_id':'$name','name':{'$first':_0x286dae(0x14d)}}}]);}else _0x4312cf=await warehouse[_0x286dae(0x11b)]([{'$match':{'status':_0x286dae(0x149),'warehouse_category':_0x286dae(0x150),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x286dae(0x14d),'name':{'$first':_0x286dae(0x14d)}}}]);if(_0x2a0ed9[0x0][_0x286dae(0x142)]==_0x286dae(0x192)){var _0x43ac7d=users[_0x286dae(0x114)];console[_0x286dae(0x1a8)](_0x43ac7d);}else{if(_0x2a0ed9[0x0][_0x286dae(0x142)]==_0x286dae(0x12a))var _0x43ac7d=users[_0x286dae(0x12a)];else{if(_0x2a0ed9[0x0]['language']==_0x286dae(0x19f))var _0x43ac7d=users[_0x286dae(0x19f)];else{if(_0x2a0ed9[0x0][_0x286dae(0x142)]==_0x286dae(0x101))var _0x43ac7d=users[_0x286dae(0x101)];else{if(_0x2a0ed9[0x0][_0x286dae(0x142)]==_0x286dae(0xf9))var _0x43ac7d=users['French'];else{if(_0x2a0ed9[0x0][_0x286dae(0x142)]==_0x286dae(0x14e))var _0x43ac7d=users[_0x286dae(0x108)];else{if(_0x2a0ed9[0x0]['language']=='Chinese')var _0x43ac7d=users['Chinese'];else{if(_0x2a0ed9[0x0][_0x286dae(0x142)]==_0x286dae(0xf2))var _0x43ac7d=users['Arabic'];}}}}}}}_0x7b1400[_0x286dae(0xea)](_0x286dae(0xe7),{'success':_0x4b821b[_0x286dae(0x102)](_0x286dae(0x158)),'errors':_0x4b821b[_0x286dae(0x102)](_0x286dae(0x14b)),'role':_0x5a4516,'profile':_0x5a61cc,'adjustment':_0x4cc32d,'stock':_0x1b4c4b,'master_shop':_0x2a0ed9,'warehouse_name':_0x1cf3f0,'unit':_0x2f7872,'language':_0x43ac7d,'warehouse':_0x4312cf});}catch(_0x59c299){console[_0x286dae(0x1a8)](_0x59c299),_0x7b1400[_0x286dae(0x13c)](0xc8)[_0x286dae(0x16e)]({'message':_0x59c299[_0x286dae(0x1b3)]});}}),router[a0_0x125d22(0x13f)](a0_0x125d22(0xf1),auth,async(_0x336dd2,_0x426fe2)=>{var _0x5c5af7=a0_0x125d22;try{const _0x14f77f=_0x336dd2[_0x5c5af7(0x11f)]['id'],_0x1ea7f5=await adjustment[_0x5c5af7(0xed)]({'_id':_0x14f77f}),_0x4d4b8e=await warehouse['findOne']({'name':_0x1ea7f5['warehouse_name'],'room':_0x1ea7f5[_0x5c5af7(0x12d)]}),{warehouse_name:_0x4ca66f,date:_0x5149c1,prod_name:_0x29d1a3,level:_0xcc9638,isle:_0x31e591,pallet:_0x43e7c5,stock:_0x5471a3,types:_0x3c53a8,adjust_qty:_0x246bfe,new_adjust_qty:_0x320299,note:_0xd56de5,Room_name:_0x46bf43,invoice:_0x71499e,JO_number:_0xdab760,expiry_date:_0x531a3c}=_0x336dd2[_0x5c5af7(0xfb)];if(typeof _0x29d1a3==_0x5c5af7(0x138))var _0x24c063=[_0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0xe6)]],_0x5e22c2=[_0x336dd2['body'][_0x5c5af7(0x11e)]],_0x33a7ec=[_0x336dd2['body'][_0x5c5af7(0x1af)]],_0x497447=[_0x336dd2['body'][_0x5c5af7(0x155)]],_0x4eb640=[_0x336dd2['body']['New_Qty_Converted_adj']],_0x20c87e=[_0x336dd2[_0x5c5af7(0xfb)]['New_Qty_Converted']],_0x248107=[_0x336dd2['body'][_0x5c5af7(0x17d)]],_0x4865f4=[_0x336dd2['body'][_0x5c5af7(0x19e)]],_0x2310df=[_0x336dd2[_0x5c5af7(0xfb)]['prod_code']],_0x5c12ef=[_0x336dd2['body'][_0x5c5af7(0x171)]],_0x378537=[_0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0x10f)]],_0x2a8a9d=[_0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0xec)]],_0x2e15c8=[_0x336dd2[_0x5c5af7(0xfb)]['production_date']],_0x1170d2=[_0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0x165)]],_0x25c4ce=[_0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0xfe)]],_0x2d93bb=[_0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0x164)]],_0x5a66e0=[_0x336dd2[_0x5c5af7(0xfb)]['second1']];else var _0x24c063=[..._0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0xe6)]],_0x5e22c2=[..._0x336dd2['body'][_0x5c5af7(0x11e)]],_0x33a7ec=[..._0x336dd2[_0x5c5af7(0xfb)]['stock']],_0x497447=[..._0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0x155)]],_0x4eb640=[..._0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0x174)]],_0x20c87e=[..._0x336dd2[_0x5c5af7(0xfb)]['New_Qty_Converted']],_0x248107=[..._0x336dd2[_0x5c5af7(0xfb)]['unit']],_0x4865f4=[..._0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0x19e)]],_0x2310df=[..._0x336dd2['body'][_0x5c5af7(0x103)]],_0x5c12ef=[..._0x336dd2[_0x5c5af7(0xfb)]['batch_code']],_0x378537=[..._0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0x10f)]],_0x2a8a9d=[..._0x336dd2[_0x5c5af7(0xfb)]['max_per_unit']],_0x2e15c8=[..._0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0xf0)]],_0x1170d2=[..._0x336dd2['body'][_0x5c5af7(0x165)]],_0x25c4ce=[..._0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0xfe)]],_0x2d93bb=[..._0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0x164)]],_0x5a66e0=[..._0x336dd2[_0x5c5af7(0xfb)][_0x5c5af7(0x170)]];const _0x18dded=_0x24c063[_0x5c5af7(0x19d)](_0x2d3dcf=>{return _0x2d3dcf={'product_name':_0x2d3dcf};});_0x5e22c2[_0x5c5af7(0x122)]((_0x19961a,_0x1bf46c)=>{var _0x21d010=_0x5c5af7;_0x25c4ce[_0x21d010(0x122)]((_0x5ed98f,_0x477d53)=>{var _0x14b39a=_0x21d010;if(_0x5ed98f=='Receiving\x20Area'&&_0x1bf46c==_0x477d53){var _0x2f0bee=_0x19961a[_0x14b39a(0x188)](0x3);_0x18dded[_0x1bf46c][_0x14b39a(0x175)]=_0x19961a[0x0],_0x18dded[_0x1bf46c]['rack']=_0x19961a[0x1],_0x18dded[_0x1bf46c][_0x14b39a(0x16a)]=0x0,_0x18dded[_0x1bf46c][_0x14b39a(0x1a6)]=0x0,_0x18dded[_0x1bf46c][_0x14b39a(0x1b9)]=_0x14b39a(0x15b),_0x18dded[_0x1bf46c][_0x14b39a(0xe5)]=_0x2f0bee;}else{if(_0x5ed98f==_0x14b39a(0x130)&&_0x1bf46c==_0x477d53){var _0x2f0bee=_0x19961a[_0x14b39a(0x188)](0x3);_0x18dded[_0x1bf46c]['storage']=_0x19961a[0x0],_0x18dded[_0x1bf46c]['rack']=_0x19961a[0x1],_0x18dded[_0x1bf46c]['bay']=0x0,_0x18dded[_0x1bf46c][_0x14b39a(0x1a6)]=0x0,_0x18dded[_0x1bf46c][_0x14b39a(0x1b9)]=_0x14b39a(0x15b),_0x18dded[_0x1bf46c][_0x14b39a(0xe5)]=_0x19961a[0x5];}else{if(_0x1bf46c==_0x477d53){var _0x4c8635;if(_0x19961a[0x4]=='L')_0x4c8635=_0x14b39a(0x105);else _0x19961a[0x4]=='F'&&(_0x4c8635=_0x14b39a(0x15b));_0x18dded[_0x1bf46c]['storage']=_0x19961a[0x0],_0x18dded[_0x1bf46c][_0x14b39a(0x147)]=_0x19961a[0x1],_0x18dded[_0x1bf46c]['bay']=_0x19961a[0x2],_0x18dded[_0x1bf46c][_0x14b39a(0x1a6)]=_0x19961a[0x3],_0x18dded[_0x1bf46c][_0x14b39a(0x1b9)]=_0x4c8635,_0x18dded[_0x1bf46c][_0x14b39a(0xe5)]=_0x19961a[0x5];}}}});}),_0x33a7ec['forEach']((_0x2df5a0,_0x35c34e)=>{var _0x1c4c88=_0x5c5af7;_0x18dded[_0x35c34e][_0x1c4c88(0x110)]=_0x2df5a0;}),_0x497447[_0x5c5af7(0x122)]((_0x532ff6,_0x7a0c68)=>{var _0x3bedc5=_0x5c5af7;_0x18dded[_0x7a0c68][_0x3bedc5(0x155)]=_0x532ff6;}),_0x4eb640[_0x5c5af7(0x122)]((_0x56a071,_0x493c71)=>{var _0x54fee1=_0x5c5af7;_0x18dded[_0x493c71][_0x54fee1(0x1b1)]=_0x56a071;}),_0x20c87e[_0x5c5af7(0x122)]((_0x5321fa,_0x5d802d)=>{_0x18dded[_0x5d802d]['new_adjust_qty']=_0x5321fa;}),_0x248107[_0x5c5af7(0x122)]((_0x479324,_0x59852a)=>{var _0x2dd140=_0x5c5af7;_0x18dded[_0x59852a][_0x2dd140(0x153)]=_0x479324;}),_0x4865f4['forEach']((_0x8d807,_0x5540c7)=>{var _0x43c55e=_0x5c5af7;_0x18dded[_0x5540c7][_0x43c55e(0x109)]=_0x8d807;}),_0x2310df[_0x5c5af7(0x122)]((_0x2af138,_0x22fc3b)=>{_0x18dded[_0x22fc3b]['product_code']=_0x2af138;}),_0x5c12ef[_0x5c5af7(0x122)]((_0x18652f,_0x6f306e)=>{var _0x5e393f=_0x5c5af7;_0x18dded[_0x6f306e][_0x5e393f(0x171)]=_0x18652f;}),_0x378537[_0x5c5af7(0x122)]((_0x46cc12,_0x331301)=>{var _0x4a7d37=_0x5c5af7;_0x18dded[_0x331301][_0x4a7d37(0x10f)]=_0x46cc12;}),_0x2a8a9d[_0x5c5af7(0x122)]((_0xf9674,_0x37fe67)=>{var _0x493868=_0x5c5af7;_0x18dded[_0x37fe67][_0x493868(0x159)]=_0xf9674;}),_0x2e15c8[_0x5c5af7(0x122)]((_0x1c9b96,_0x421bf3)=>{var _0x2faab4=_0x5c5af7;_0x18dded[_0x421bf3][_0x2faab4(0xf0)]=_0x1c9b96;}),_0x1170d2[_0x5c5af7(0x122)]((_0x11b797,_0x2069e6)=>{_0x18dded[_0x2069e6]['prod_cat']=_0x11b797;}),_0x25c4ce['forEach']((_0x357217,_0x3abf44)=>{_0x18dded[_0x3abf44]['room_names']=_0x357217;}),_0x2d93bb[_0x5c5af7(0x122)]((_0x525605,_0x1d31d1)=>{var _0x2ddeef=_0x5c5af7;_0x18dded[_0x1d31d1][_0x2ddeef(0x19a)]=_0x525605;}),_0x5a66e0[_0x5c5af7(0x122)]((_0xa14541,_0x4fd085)=>{var _0x1e4a93=_0x5c5af7;_0x18dded[_0x4fd085][_0x1e4a93(0x178)]=_0xa14541;});const _0x1a197a=_0x18dded['filter'](_0x234b20=>_0x234b20[_0x5c5af7(0x1b1)]!=='0'&&_0x234b20[_0x5c5af7(0x1b1)]!=='');var _0xbcb5ce=0x0;_0x1a197a[_0x5c5af7(0x122)](_0xa494cf=>{var _0x2501c2=_0x5c5af7;console[_0x2501c2(0x1a8)](_0x2501c2(0x100),_0xa494cf),parseInt(_0xa494cf[_0x2501c2(0x1b1)])<=0x0&&_0xbcb5ce++;});if(_0xbcb5ce!=0x0)return _0x336dd2[_0x5c5af7(0x102)](_0x5c5af7(0x14b),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x426fe2[_0x5c5af7(0x14c)](_0x5c5af7(0x148));_0x1ea7f5[_0x5c5af7(0x167)]=_0x4ca66f,_0x1ea7f5['date']=_0x5149c1,_0x1ea7f5[_0x5c5af7(0x125)]=_0x1a197a,_0x1ea7f5[_0x5c5af7(0x1a4)]=_0xd56de5,_0x1ea7f5[_0x5c5af7(0x169)]=_0x71499e,_0x1ea7f5[_0x5c5af7(0x168)]='False';const _0x8755f9=await _0x1ea7f5[_0x5c5af7(0x119)]();_0x336dd2[_0x5c5af7(0x102)](_0x5c5af7(0x158),_0x5c5af7(0x106)),_0x426fe2[_0x5c5af7(0x14c)](_0x5c5af7(0xe2));}catch(_0x517da7){console[_0x5c5af7(0x1a8)](_0x517da7);}}),router[a0_0x125d22(0x13f)]('/barcode_scanner',async(_0x20cd7d,_0x5b4040)=>{var _0x2f0c15=a0_0x125d22;const {primary_code:_0x27737b,warehouse_data:_0x3a1c4f,rooms_data:_0x39370f,Roomslist:_0x464330}=_0x20cd7d['body'],_0x402db7=_0x464330[_0x2f0c15(0x172)](','),_0x25aab7=[];async function _0x1ab799(_0x4cd831){var _0x2c676b=_0x2f0c15;const _0x55b0e2=await warehouse[_0x2c676b(0x11b)]([{'$match':{'name':_0x3a1c4f,'room':_0x4cd831}},{'$unwind':_0x2c676b(0x117)},{'$match':{'product_details.primary_code':_0x27737b}},{'$group':{'_id':_0x2c676b(0x13a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2c676b(0x12c)},'product_code':{'$first':_0x2c676b(0x151)},'level':{'$first':_0x2c676b(0xff)},'isle':{'$first':_0x2c676b(0x176)},'type':{'$first':_0x2c676b(0x18b)},'pallet':{'$first':_0x2c676b(0x133)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2c676b(0x199)},'storage':{'$first':_0x2c676b(0x1b0)},'rack':{'$first':_0x2c676b(0x135)},'expiry_date':{'$first':_0x2c676b(0x121)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x2c676b(0x137)},'batch_code':{'$first':_0x2c676b(0x198)},'product_cat':{'$first':_0x2c676b(0x154)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x2c676b(0x11d)},'invoice':{'$first':_0x2c676b(0x17a)}}}]),_0x1c4012=await warehouse[_0x2c676b(0x11b)]([{'$match':{'name':_0x3a1c4f,'room':_0x4cd831}},{'$unwind':_0x2c676b(0x117)},{'$match':{'product_details.secondary_code':_0x27737b}},{'$group':{'_id':_0x2c676b(0x13a),'name':{'$first':_0x2c676b(0x111)},'product_stock':{'$first':_0x2c676b(0x18e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2c676b(0x12c)},'product_code':{'$first':_0x2c676b(0x151)},'level':{'$first':_0x2c676b(0xff)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x2c676b(0x18b)},'pallet':{'$first':_0x2c676b(0x133)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2c676b(0x199)},'storage':{'$first':_0x2c676b(0x1b0)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2c676b(0x121)},'production_date':{'$first':_0x2c676b(0x184)},'maxPerUnit':{'$first':_0x2c676b(0x137)},'batch_code':{'$first':_0x2c676b(0x198)},'product_cat':{'$first':_0x2c676b(0x154)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2c676b(0x11d)}}}]);if(_0x55b0e2['length']>0x0)_0x25aab7[_0x2c676b(0x104)](_0x55b0e2);else _0x1c4012['length']>0x0&&_0x25aab7[_0x2c676b(0x104)](_0x1c4012);}const _0x309e35=_0x402db7[_0x2f0c15(0x19d)](_0x3b4545=>_0x1ab799(_0x3b4545));await Promise[_0x2f0c15(0x1b5)](_0x309e35),_0x5b4040[_0x2f0c15(0x16e)](_0x25aab7);}),router[a0_0x125d22(0x13f)](a0_0x125d22(0x16d),async(_0x2833f5,_0xfddcb1)=>{var _0xd5d84f=a0_0x125d22;const {primaryCode:_0x1de3e1,secondaryCode:_0x2fa684,productCode:_0x1954be,level:_0x56b393,isle:_0x190ab6,pallet:_0x1df76e,warehouses:_0x34468c,room:_0x3ebe8a}=_0x2833f5[_0xd5d84f(0xfb)];try{const _0xdbf840=await warehouse[_0xd5d84f(0x11b)]([{'$match':{'name':_0x34468c,'room':_0x3ebe8a}},{'$unwind':_0xd5d84f(0x117)},{'$match':{'product_details.level':parseInt(_0x56b393),'product_details.isle':_0x190ab6,'product_details.pallet':parseInt(_0x1df76e)}},{'$group':{'_id':_0xd5d84f(0x13a),'name':{'$first':_0xd5d84f(0x111)},'product_stock':{'$first':_0xd5d84f(0x18e)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0xd5d84f(0x193)},'maxProducts':{'$first':_0xd5d84f(0x183)}}}]);_0xfddcb1['status'](0xc8)[_0xd5d84f(0x16e)](_0xdbf840);}catch(_0x4fb2d2){_0xfddcb1['status'](0x194)[_0xd5d84f(0x16e)]({'message':_0x4fb2d2[_0xd5d84f(0x1b3)]});}}),module[a0_0x125d22(0x146)]=router;