function a0_0x4a6d(_0x4279e1,_0x322992){var _0x3fe125=a0_0x3fe1();return a0_0x4a6d=function(_0x4a6dff,_0x236bee){_0x4a6dff=_0x4a6dff-0x19f;var _0x3368d3=_0x3fe125[_0x4a6dff];return _0x3368d3;},a0_0x4a6d(_0x4279e1,_0x322992);}var a0_0x3a73a9=a0_0x4a6d;(function(_0x39a64a,_0x3a90b6){var _0x238eb7=a0_0x4a6d,_0x272d08=_0x39a64a();while(!![]){try{var _0x50b7a7=-parseInt(_0x238eb7(0x279))/0x1+-parseInt(_0x238eb7(0x276))/0x2*(parseInt(_0x238eb7(0x239))/0x3)+parseInt(_0x238eb7(0x1c8))/0x4*(-parseInt(_0x238eb7(0x1a9))/0x5)+-parseInt(_0x238eb7(0x26e))/0x6*(-parseInt(_0x238eb7(0x1ea))/0x7)+-parseInt(_0x238eb7(0x212))/0x8*(-parseInt(_0x238eb7(0x201))/0x9)+-parseInt(_0x238eb7(0x1f7))/0xa*(parseInt(_0x238eb7(0x22c))/0xb)+parseInt(_0x238eb7(0x1f3))/0xc*(parseInt(_0x238eb7(0x1bd))/0xd);if(_0x50b7a7===_0x3a90b6)break;else _0x272d08['push'](_0x272d08['shift']());}catch(_0x302c7f){_0x272d08['push'](_0x272d08['shift']());}}}(a0_0x3fe1,0x2b08d));const express=require(a0_0x3a73a9(0x210)),app=express(),router=express['Router'](),auth=require(a0_0x3a73a9(0x230)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x3a73a9(0x24c)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x3a73a9(0x1e7));router[a0_0x3a73a9(0x215)](a0_0x3a73a9(0x214),auth,async(_0xf3ec84,_0xcc5b80)=>{var _0x51eea7=a0_0x3a73a9;try{const {username:_0x405ff0,email:_0x56d944,role:_0x5ba1a1}=_0xf3ec84[_0x51eea7(0x1b9)],_0x510673=_0xf3ec84['user'],_0x123eca=await profile['findOne']({'email':_0x510673[_0x51eea7(0x1bf)]}),_0x1d0b3a=await master_shop[_0x51eea7(0x1e5)]();console[_0x51eea7(0x1a5)](_0x51eea7(0x1e6),_0x1d0b3a);let _0x529624;if(_0x510673['role']==_0x51eea7(0x1fb)){const _0x303f3a=await staff[_0x51eea7(0x224)]({'email':_0x510673[_0x51eea7(0x1bf)]});_0x529624=await warehouse['find']({'status':_0x51eea7(0x1d9),'name':_0x303f3a[_0x51eea7(0x1a2)]});}else _0x529624=await warehouse['find']({'status':_0x51eea7(0x1d9)});const _0x9ec041=await product[_0x51eea7(0x1e5)]();let _0x31535d;if(_0x510673['role']==_0x51eea7(0x1fb)){const _0x2991af=await staff[_0x51eea7(0x224)]({'email':_0x510673['email']});_0x31535d=await adjustment['find']({'warehouse_name':_0x2991af[_0x51eea7(0x1a2)]});}else _0x31535d=await adjustment[_0x51eea7(0x1a0)]([{'$unwind':_0x51eea7(0x20a)},{'$group':{'_id':_0x51eea7(0x254),'invoice':{'$first':_0x51eea7(0x1dd)},'date':{'$first':_0x51eea7(0x20b)},'warehouse_name':{'$first':_0x51eea7(0x1ef)},'room':{'$addToSet':_0x51eea7(0x1d8)},'finalize':{'$first':_0x51eea7(0x1be)},'isAllowEdit':{'$first':_0x51eea7(0x1d7)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1d0b3a[0x0][_0x51eea7(0x1b6)]=='English\x20(US)'){var _0x531a57=users['English'];console[_0x51eea7(0x1a5)](_0x531a57);}else{if(_0x1d0b3a[0x0][_0x51eea7(0x1b6)]==_0x51eea7(0x205))var _0x531a57=users[_0x51eea7(0x205)];else{if(_0x1d0b3a[0x0][_0x51eea7(0x1b6)]==_0x51eea7(0x20f))var _0x531a57=users[_0x51eea7(0x20f)];else{if(_0x1d0b3a[0x0][_0x51eea7(0x1b6)]==_0x51eea7(0x1c9))var _0x531a57=users[_0x51eea7(0x1c9)];else{if(_0x1d0b3a[0x0]['language']=='French')var _0x531a57=users['French'];else{if(_0x1d0b3a[0x0][_0x51eea7(0x1b6)]==_0x51eea7(0x1e0))var _0x531a57=users[_0x51eea7(0x231)];else{if(_0x1d0b3a[0x0][_0x51eea7(0x1b6)]==_0x51eea7(0x26d))var _0x531a57=users['Chinese'];else{if(_0x1d0b3a[0x0][_0x51eea7(0x1b6)]==_0x51eea7(0x204))var _0x531a57=users[_0x51eea7(0x1eb)];}}}}}}}_0xcc5b80[_0x51eea7(0x249)](_0x51eea7(0x221),{'success':_0xf3ec84['flash'](_0x51eea7(0x233)),'errors':_0xf3ec84[_0x51eea7(0x1a4)](_0x51eea7(0x1b5)),'role':_0x510673,'profile':_0x123eca,'warehouse':_0x529624,'product':_0x9ec041,'adjustment':_0x31535d,'master_shop':_0x1d0b3a,'language':_0x531a57});}catch(_0x4adf35){console[_0x51eea7(0x1a5)](_0x4adf35);}});async function getRandom8DigitNumber(){var _0x22a1bc=a0_0x3a73a9;const _0x5e100d=0x989680,_0x479fab=0x5f5e0ff,_0x32eb9f=Math[_0x22a1bc(0x229)](Math[_0x22a1bc(0x21d)]()*(_0x479fab-_0x5e100d+0x1))+_0x5e100d;var _0x3c51a8;const _0x1e37ed=await adjustment['findOne']({'invoice':'ADJ-'+_0x32eb9f});return _0x1e37ed&&_0x1e37ed['length']>0x0?_0x3c51a8='ADJ-'+_0x32eb9f:_0x3c51a8=_0x22a1bc(0x270)+_0x32eb9f,_0x3c51a8;}function a0_0x3fe1(){var _0x5c0ad5=['expiry_date','<h5\x20style=\x22text-align:\x20left;\x22>','/CheckingWarehouse','$invoice','<h2>\x20','sendMail','Portuguese\x20(BR)','invoice','$product_details.product_code','Primary_Units','$product_details.secondary_unit','find','master','nodemailer','unit','redirect','3815DZMNko','Arabic','$product_details.pallet','Receiving\x20Area','/picking_list/PDF_adjustment_rm/','$warehouse_name','exports','product_details','</head><body>','2220zxMLAy','English','rack','string','7260ZtHFiy','floorlevel','back','$product_details.bay','staff','message','post','product_name','prod_invoice','params','117SoFlsq','Shelves','$product_details.isle','Arabic\x20(ae)','Hindi','English\x20(US)','then','<strong>\x20Regards\x20</strong>','Return\x20Rooms','$product','$date','<h5>','push','logo','German','express','password','91144BqDElX','room_names','/view','get','filter','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product.product_name','/view/add_adjustment','type','add_adjustment','status','random','toString','$product_details.bin','/barcode_scanner','adjustment','role','bay','findOne','/view/:id','Floor','second1','maxperunit','floor','image','</td>','2398LqOYzQ','json','<div>','/adjustment/preview/','../middleware/auth','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','success','_id','French','id_transaction_from','product','$product_details.product_cat','9675bUUBTc','foreach\x20newproduct','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','RMSEmail','adjustment\x20Finalized\x20successfully','$product_details.secondary_code','New_Qty_Converted','batch_code','False','save','$product_details._id','note','catch','$product_details','<tr>','\x20<>\x20','render','Logo.png','body','../models/all_models','<!DOCTYPE\x20html>','storage','all','padStart','types','$product_details.maxPerUnit','Rooms','$_id','prod_cat','There\x27s\x20a\x20error\x20in\x20this\x20transaction','length','$product_details.product_name','Error\x20Occurs','Adjustment\x20Mail','level','max_per_unit','Raw\x20Materials','$product_details.storage','adjust_qty','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Enclosed','new_adjust_qty','edit_adjustment','$room','host','stockBefore','An\x20error\x20occurred\x20while\x20saving\x20data.','Email\x20sent\x20successfully','$product_details.batch_code','$product_details.rack','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','isAllowEdit','Chinese','798OkxGOw','adjustment\x20add\x20successfull','ADJ-','findById','id_transaction','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','bin','</body></html>','202njVemK','</h5>','\x20</h2>','322131TAEujl','prime1','$name','/adjustment/view','aggregate','error','warehouse','secondary_unit','flash','log','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</div>','stock','58455fTVgqE','product_stock','$product_details.primary_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.expiry_date','map','port','product_code','Level','/../public','site_title','$product_details.unit','errors','language','room','$product_details.floorlevel','user','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Ambient','$product_details.type','58461cHbCdS','$finalize','email','forEach','Secondary_units','$product_details.product_stock','slice','prod_name','date','Return\x20Goods','primary_code','24AJOENy','Spanish','warehouse_name','<span\x20style=\x22float:\x20right;\x22>','/preview/:id','New_Qty_Converted_adj','\x20Order\x20Number\x20:\x20','secondary_code','$product_details.production_date','production_date','createTransport','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','\x20Order\x20Date\x20:\x20','</thead>','prod_code','$isAllowEdit','$product.room_names','Enabled'];a0_0x3fe1=function(){return _0x5c0ad5;};return a0_0x3fe1();}router['get'](a0_0x3a73a9(0x219),auth,async(_0x42ca98,_0x557a28)=>{var _0x19ac10=a0_0x3a73a9;try{const {username:_0x39cfa2,email:_0x418406,role:_0x1c0db9}=_0x42ca98['user'],_0x3f3710=_0x42ca98[_0x19ac10(0x1b9)],_0x1cc2f9=await profile[_0x19ac10(0x224)]({'email':_0x3f3710[_0x19ac10(0x1bf)]}),_0xabc47a=await master_shop['find']();let _0x3bc7d7;if(_0x3f3710[_0x19ac10(0x222)]==_0x19ac10(0x1fb)){const _0x3b301e=await staff['findOne']({'email':_0x3f3710[_0x19ac10(0x1bf)]});_0x3bc7d7=await warehouse[_0x19ac10(0x1a0)]([{'$match':{'status':_0x19ac10(0x1d9),'name':_0x3b301e[_0x19ac10(0x1a2)],'warehouse_category':_0x19ac10(0x25d),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x19ac10(0x27b),'name':{'$first':_0x19ac10(0x27b)}}}]);}else _0x3bc7d7=await warehouse[_0x19ac10(0x1a0)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':_0x19ac10(0x1c6)}}},{'$group':{'_id':_0x19ac10(0x27b),'name':{'$first':_0x19ac10(0x27b)}}}]);const _0x22bc5f=await product[_0x19ac10(0x1e5)]({}),_0xca1c2b=await adjustment[_0x19ac10(0x1e5)]({}),_0x1bf782=_0xca1c2b['length']+0x1,_0x3334ec=_0x19ac10(0x270)+_0x1bf782[_0x19ac10(0x21e)]()[_0x19ac10(0x250)](0x5,'0');var _0x1a246a=[_0x19ac10(0x1bb),_0x19ac10(0x261),_0x19ac10(0x209)];if(_0xabc47a[0x0][_0x19ac10(0x1b6)]=='English\x20(US)')var _0x1dbc83=users['English'];else{if(_0xabc47a[0x0][_0x19ac10(0x1b6)]=='Hindi')var _0x1dbc83=users[_0x19ac10(0x205)];else{if(_0xabc47a[0x0][_0x19ac10(0x1b6)]==_0x19ac10(0x20f))var _0x1dbc83=users[_0x19ac10(0x20f)];else{if(_0xabc47a[0x0][_0x19ac10(0x1b6)]==_0x19ac10(0x1c9))var _0x1dbc83=users[_0x19ac10(0x1c9)];else{if(_0xabc47a[0x0][_0x19ac10(0x1b6)]==_0x19ac10(0x235))var _0x1dbc83=users['French'];else{if(_0xabc47a[0x0][_0x19ac10(0x1b6)]=='Portuguese\x20(BR)')var _0x1dbc83=users[_0x19ac10(0x231)];else{if(_0xabc47a[0x0][_0x19ac10(0x1b6)]==_0x19ac10(0x26d))var _0x1dbc83=users[_0x19ac10(0x26d)];else{if(_0xabc47a[0x0][_0x19ac10(0x1b6)]==_0x19ac10(0x204))var _0x1dbc83=users[_0x19ac10(0x1eb)];}}}}}}}const _0x1eb38d=getRandom8DigitNumber();_0x1eb38d[_0x19ac10(0x207)](_0x412349=>{var _0x6d74be=_0x19ac10;_0x557a28['render'](_0x6d74be(0x21b),{'success':_0x42ca98[_0x6d74be(0x1a4)]('success'),'errors':_0x42ca98[_0x6d74be(0x1a4)](_0x6d74be(0x1b5)),'role':_0x3f3710,'profile':_0x1cc2f9,'warehouse':_0x3bc7d7,'product':_0x22bc5f,'master_shop':_0xabc47a,'language':_0x1dbc83,'rooms_data':_0x1a246a,'invoice_no':_0x412349});})['catch'](_0x6ae189=>{var _0x28463e=_0x19ac10;_0x42ca98[_0x28463e(0x1a4)](_0x28463e(0x1b5),_0x28463e(0x256)),_0x557a28['redirect'](_0x28463e(0x19f));});}catch(_0x57ec57){console[_0x19ac10(0x1a5)](_0x57ec57);}}),router[a0_0x3a73a9(0x1fd)](a0_0x3a73a9(0x219),auth,async(_0x4a206f,_0xa2f800)=>{var _0x44b9cd=a0_0x3a73a9;try{const {warehouse_name:_0x5933da,date:_0x34639b,prod_name:_0x251d6d,level:_0x82994d,isle:_0x3629ef,pallet:_0x47a1b8,stock:_0x5898cd,types:_0x4de6a0,adjust_qty:_0x3d04ac,new_adjust_qty:_0x4b7252,note:_0x3090d9,Room_name:_0x2a3757,invoice:_0x3b0fb4,JO_number:_0x4b3ec6,expiry_date:_0x5f108e}=_0x4a206f['body'];if(typeof _0x251d6d=='string')var _0x57b498=[_0x4a206f[_0x44b9cd(0x24b)]['prod_name']],_0x126598=[_0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x25b)]],_0x58a1d4=[_0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x1a8)]],_0x8a868e=[_0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x251)]],_0x335426=[_0x4a206f[_0x44b9cd(0x24b)]['New_Qty_Converted_adj']],_0x4581c9=[_0x4a206f[_0x44b9cd(0x24b)]['New_Qty_Converted']],_0x4ef896=[_0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x1e3)]],_0x3cb9bf=[_0x4a206f[_0x44b9cd(0x24b)]['Secondary_units']],_0x18afc3=[_0x4a206f[_0x44b9cd(0x24b)]['prod_code']],_0x360167=[_0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x240)]],_0x487174=[_0x4a206f['body'][_0x44b9cd(0x1da)]],_0x34fe9a=[_0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x25c)]],_0x2a51da=[_0x4a206f[_0x44b9cd(0x24b)]['production_date']],_0x1fce75=[_0x4a206f['body'][_0x44b9cd(0x255)]],_0x50d797=[_0x4a206f[_0x44b9cd(0x24b)]['Rooms']],_0x34a5f7=[_0x4a206f[_0x44b9cd(0x24b)]['prime1']],_0x410c52=[_0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x227)]],_0x1cd8a8=[_0x4a206f['body'][_0x44b9cd(0x1ff)]],_0x545626=[_0x4a206f['body']['id_transaction']];else var _0x57b498=[..._0x4a206f['body'][_0x44b9cd(0x1c4)]],_0x126598=[..._0x4a206f['body']['level']],_0x58a1d4=[..._0x4a206f['body']['stock']],_0x8a868e=[..._0x4a206f[_0x44b9cd(0x24b)]['types']],_0x335426=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x1cd)]],_0x4581c9=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x23f)]],_0x4ef896=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x1e8)]],_0x3cb9bf=[..._0x4a206f[_0x44b9cd(0x24b)]['Secondary_units']],_0x18afc3=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x1d6)]],_0x360167=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x240)]],_0x487174=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x1da)]],_0x34fe9a=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x25c)]],_0x2a51da=[..._0x4a206f['body']['production_date']],_0x1fce75=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x255)]],_0x50d797=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x253)]],_0x34a5f7=[..._0x4a206f['body'][_0x44b9cd(0x27a)]],_0x410c52=[..._0x4a206f[_0x44b9cd(0x24b)]['second1']],_0x1cd8a8=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x1ff)]],_0x545626=[..._0x4a206f[_0x44b9cd(0x24b)][_0x44b9cd(0x272)]];const _0x50d98a=_0x57b498[_0x44b9cd(0x1ae)](_0x24d031=>{return _0x24d031={'product_name':_0x24d031};});_0x126598[_0x44b9cd(0x1c0)]((_0x4f646d,_0x491dd8)=>{_0x50d797['forEach']((_0x443a60,_0x46730a)=>{var _0xc5f9bf=a0_0x4a6d;if(_0x443a60==_0xc5f9bf(0x1ed)&&_0x491dd8==_0x46730a){var _0x25ae28=_0x4f646d[_0xc5f9bf(0x1c3)](0x3);_0x50d98a[_0x491dd8][_0xc5f9bf(0x24e)]=_0x4f646d[0x0],_0x50d98a[_0x491dd8][_0xc5f9bf(0x1f5)]=_0x4f646d[0x1],_0x50d98a[_0x491dd8][_0xc5f9bf(0x223)]=0x0,_0x50d98a[_0x491dd8][_0xc5f9bf(0x274)]=0x0,_0x50d98a[_0x491dd8][_0xc5f9bf(0x21a)]=_0xc5f9bf(0x226),_0x50d98a[_0x491dd8]['floorlevel']=_0x25ae28;}else{if(_0x443a60=='Shelves'&&_0x491dd8==_0x46730a){var _0x25ae28=_0x4f646d[_0xc5f9bf(0x1c3)](0x3);_0x50d98a[_0x491dd8][_0xc5f9bf(0x24e)]=_0x4f646d[0x0],_0x50d98a[_0x491dd8][_0xc5f9bf(0x1f5)]=_0x4f646d[0x1],_0x50d98a[_0x491dd8][_0xc5f9bf(0x223)]=0x0,_0x50d98a[_0x491dd8][_0xc5f9bf(0x274)]=0x0,_0x50d98a[_0x491dd8]['type']='Floor',_0x50d98a[_0x491dd8][_0xc5f9bf(0x1f8)]=_0x4f646d[0x5];}else{if(_0x491dd8==_0x46730a){var _0x596d52;if(_0x4f646d[0x4]=='L')_0x596d52=_0xc5f9bf(0x1b1);else _0x4f646d[0x4]=='F'&&(_0x596d52=_0xc5f9bf(0x226));_0x50d98a[_0x491dd8][_0xc5f9bf(0x24e)]=_0x4f646d[0x0],_0x50d98a[_0x491dd8]['rack']=_0x4f646d[0x1],_0x50d98a[_0x491dd8][_0xc5f9bf(0x223)]=_0x4f646d[0x2],_0x50d98a[_0x491dd8][_0xc5f9bf(0x274)]=_0x4f646d[0x3],_0x50d98a[_0x491dd8][_0xc5f9bf(0x21a)]=_0x596d52,_0x50d98a[_0x491dd8][_0xc5f9bf(0x1f8)]=_0x4f646d[0x5];}}}});}),_0x58a1d4[_0x44b9cd(0x1c0)]((_0x1fdce9,_0x1ad3bd)=>{var _0x5cd98e=_0x44b9cd;_0x50d98a[_0x1ad3bd][_0x5cd98e(0x266)]=_0x1fdce9;}),_0x545626[_0x44b9cd(0x1c0)]((_0x2dfb9b,_0x2a032e)=>{_0x50d98a[_0x2a032e]['id_transaction_from']=_0x2dfb9b;}),_0x8a868e[_0x44b9cd(0x1c0)]((_0x17d426,_0x53cdf9)=>{var _0x4cdce0=_0x44b9cd;_0x50d98a[_0x53cdf9][_0x4cdce0(0x251)]=_0x17d426;}),_0x335426[_0x44b9cd(0x1c0)]((_0x34dacf,_0x373018)=>{var _0x4eea50=_0x44b9cd;_0x50d98a[_0x373018][_0x4eea50(0x25f)]=_0x34dacf;}),_0x4581c9['forEach']((_0x4c43b7,_0x3f1e86)=>{var _0x23de9b=_0x44b9cd;_0x50d98a[_0x3f1e86][_0x23de9b(0x262)]=_0x4c43b7;}),_0x4ef896[_0x44b9cd(0x1c0)]((_0x51e230,_0x2c25b8)=>{_0x50d98a[_0x2c25b8]['unit']=_0x51e230;}),_0x3cb9bf['forEach']((_0x232642,_0x228572)=>{var _0x638fc1=_0x44b9cd;_0x50d98a[_0x228572][_0x638fc1(0x1a3)]=_0x232642;}),_0x18afc3[_0x44b9cd(0x1c0)]((_0x321260,_0x54a1cf)=>{var _0x34db32=_0x44b9cd;_0x50d98a[_0x54a1cf][_0x34db32(0x1b0)]=_0x321260;}),_0x360167[_0x44b9cd(0x1c0)]((_0x5cf516,_0x52e427)=>{var _0x4c8d16=_0x44b9cd;_0x50d98a[_0x52e427][_0x4c8d16(0x240)]=_0x5cf516;}),_0x487174[_0x44b9cd(0x1c0)]((_0x13eb90,_0x5ea1d9)=>{var _0x3189c2=_0x44b9cd;_0x50d98a[_0x5ea1d9][_0x3189c2(0x1da)]=_0x13eb90;}),_0x34fe9a['forEach']((_0x5dbfd4,_0x2a6502)=>{_0x50d98a[_0x2a6502]['maxperunit']=_0x5dbfd4;}),_0x2a51da['forEach']((_0x3afbd5,_0x63ff24)=>{var _0x3ab92e=_0x44b9cd;_0x50d98a[_0x63ff24][_0x3ab92e(0x1d1)]=_0x3afbd5;}),_0x1fce75[_0x44b9cd(0x1c0)]((_0xeeca51,_0x1f638b)=>{var _0x326c69=_0x44b9cd;_0x50d98a[_0x1f638b][_0x326c69(0x255)]=_0xeeca51;}),_0x50d797[_0x44b9cd(0x1c0)]((_0x1fdaf4,_0x4831f9)=>{var _0x271da2=_0x44b9cd;_0x50d98a[_0x4831f9][_0x271da2(0x213)]=_0x1fdaf4;}),_0x34a5f7['forEach']((_0x4227f3,_0x207908)=>{var _0x2a07b9=_0x44b9cd;_0x50d98a[_0x207908][_0x2a07b9(0x1c7)]=_0x4227f3;}),_0x410c52[_0x44b9cd(0x1c0)]((_0x33d50e,_0x3d405c)=>{_0x50d98a[_0x3d405c]['secondary_code']=_0x33d50e;}),_0x1cd8a8[_0x44b9cd(0x1c0)]((_0x3b3ea0,_0x2c512c)=>{var _0x44c9d1=_0x44b9cd;_0x50d98a[_0x2c512c][_0x44c9d1(0x1e1)]=_0x3b3ea0;});const _0x113822=_0x50d98a[_0x44b9cd(0x216)](_0x15db6f=>_0x15db6f[_0x44b9cd(0x25f)]!=='0'&&_0x15db6f[_0x44b9cd(0x25f)]!=='');var _0x1f757b=0x0;_0x113822[_0x44b9cd(0x1c0)](_0x50cdb6=>{var _0x466cb4=_0x44b9cd;console[_0x466cb4(0x1a5)](_0x466cb4(0x23a),_0x50cdb6),parseInt(_0x50cdb6[_0x466cb4(0x25f)])<=0x0&&_0x1f757b++;});if(_0x1f757b!=0x0)return _0x4a206f['flash'](_0x44b9cd(0x1b5),_0x44b9cd(0x260)),_0xa2f800[_0x44b9cd(0x1e9)](_0x44b9cd(0x1f9));const _0x56d8f3=new adjustment({'warehouse_name':_0x5933da,'date':_0x34639b,'product':_0x113822,'note':_0x3090d9,'room':_0x2a3757,'invoice':_0x3b0fb4,'JO_number':_0x4b3ec6,'expiry_date':_0x5f108e}),_0x15aa73=await _0x56d8f3[_0x44b9cd(0x242)]();_0x4a206f[_0x44b9cd(0x1a4)](_0x44b9cd(0x233),_0x44b9cd(0x26f)),_0xa2f800[_0x44b9cd(0x1e9)](_0x44b9cd(0x22f)+_0x15aa73[_0x44b9cd(0x234)]);}catch(_0x3a1c62){console[_0x44b9cd(0x1a5)](_0x3a1c62),_0xa2f800['status'](0xc8)[_0x44b9cd(0x22d)]({'message':_0x3a1c62[_0x44b9cd(0x1fc)]});}}),router['get'](a0_0x3a73a9(0x1cc),auth,async(_0x160d5a,_0x9f5af5)=>{var _0x128e87=a0_0x3a73a9;try{const {username:_0x1cf91c,email:_0x40db31,role:_0x459d79}=_0x160d5a[_0x128e87(0x1b9)],_0x23cf4d=_0x160d5a[_0x128e87(0x1b9)],_0x5ac19a=await profile[_0x128e87(0x224)]({'email':_0x23cf4d['email']}),_0x1bfd9f=await master_shop['find'](),_0x239d4e=_0x160d5a[_0x128e87(0x200)]['id'],_0x17b192=await adjustment['findById']({'_id':_0x239d4e}),_0x25db7=await purchases[_0x128e87(0x1a0)]([{'$match':{'warehouse_name':_0x17b192[_0x128e87(0x1ca)]}},{'$unwind':_0x128e87(0x20a)},{'$group':{'_id':_0x128e87(0x218)}}]),_0x4737ad=await product[_0x128e87(0x1e5)]({}),_0x33cc91=await warehouse['aggregate']([{'$match':{'name':_0x17b192[_0x128e87(0x1ca)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x128e87(0x243),'name':{'$first':_0x128e87(0x258)},'product_stock':{'$first':_0x128e87(0x1c2)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x128e87(0x21f)},'type':{'$first':_0x128e87(0x1bc)},'floorlevel':{'$first':_0x128e87(0x1b8)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x128e87(0x23e)},'product_code':{'$first':_0x128e87(0x1e2)},'storage':{'$first':_0x128e87(0x25e)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x128e87(0x252)},'expiry_date':{'$first':_0x128e87(0x1ad)},'production_date':{'$first':_0x128e87(0x1d0)},'batch_code':{'$first':_0x128e87(0x269)},'room':{'$first':'$room'}}}]);if(_0x1bfd9f[0x0][_0x128e87(0x1b6)]==_0x128e87(0x206)){var _0xece7d5=users[_0x128e87(0x1f4)];console[_0x128e87(0x1a5)](_0xece7d5);}else{if(_0x1bfd9f[0x0]['language']==_0x128e87(0x205))var _0xece7d5=users[_0x128e87(0x205)];else{if(_0x1bfd9f[0x0][_0x128e87(0x1b6)]==_0x128e87(0x20f))var _0xece7d5=users[_0x128e87(0x20f)];else{if(_0x1bfd9f[0x0][_0x128e87(0x1b6)]==_0x128e87(0x1c9))var _0xece7d5=users[_0x128e87(0x1c9)];else{if(_0x1bfd9f[0x0][_0x128e87(0x1b6)]==_0x128e87(0x235))var _0xece7d5=users[_0x128e87(0x235)];else{if(_0x1bfd9f[0x0]['language']==_0x128e87(0x1e0))var _0xece7d5=users['Portuguese'];else{if(_0x1bfd9f[0x0]['language']=='Chinese')var _0xece7d5=users[_0x128e87(0x26d)];else{if(_0x1bfd9f[0x0][_0x128e87(0x1b6)]==_0x128e87(0x204))var _0xece7d5=users[_0x128e87(0x1eb)];}}}}}}}_0x9f5af5[_0x128e87(0x249)]('edit_adjustment_view',{'success':_0x160d5a['flash'](_0x128e87(0x233)),'errors':_0x160d5a['flash']('errors'),'role':_0x23cf4d,'profile':_0x5ac19a,'adjustment':_0x17b192,'stock':_0x33cc91,'master_shop':_0x1bfd9f,'warehouse_name':_0x25db7,'unit':_0x4737ad,'language':_0xece7d5});}catch(_0x320f94){console[_0x128e87(0x1a5)](_0x320f94),_0x9f5af5[_0x128e87(0x21c)](0xc8)[_0x128e87(0x22d)]({'message':_0x320f94[_0x128e87(0x1fc)]});}}),router[a0_0x3a73a9(0x1fd)](a0_0x3a73a9(0x1cc),auth,async(_0x5c8359,_0x3dd84b)=>{var _0x1e85b8=a0_0x3a73a9;try{const _0x249482=_0x5c8359[_0x1e85b8(0x200)]['id'],{warehouse_name:_0x265fcc,Room_name:_0x31ea0f}=_0x5c8359['body'],_0x53d876=await adjustment[_0x1e85b8(0x271)]({'_id':_0x249482}),_0x55abbe=_0x53d876[_0x1e85b8(0x237)][_0x1e85b8(0x1ae)](async _0x5c5d2b=>{var _0x11376f=_0x1e85b8;if(_0x5c5d2b[_0x11376f(0x25f)]>0x0){var _0x123ab6=await warehouse[_0x11376f(0x224)]({'name':_0x265fcc,'room':_0x5c5d2b[_0x11376f(0x213)],'warehouse_category':_0x11376f(0x25d)});const _0x21a83f=_0x123ab6[_0x11376f(0x1f1)]['map'](_0x5b15f9=>{var _0x14bb31=_0x11376f;console[_0x14bb31(0x1a5)](_0x5c5d2b['types']+_0x14bb31(0x248));if(_0x5c5d2b[_0x14bb31(0x251)]=='minus'){if(_0x5b15f9[_0x14bb31(0x1fe)]==_0x5c5d2b[_0x14bb31(0x1fe)]&&_0x5b15f9[_0x14bb31(0x1f8)]==_0x5c5d2b[_0x14bb31(0x1f8)]&&_0x5b15f9['type']==_0x5c5d2b[_0x14bb31(0x21a)]&&_0x5b15f9[_0x14bb31(0x274)]==_0x5c5d2b[_0x14bb31(0x274)]&&_0x5b15f9[_0x14bb31(0x223)]==_0x5c5d2b[_0x14bb31(0x223)]&&_0x5b15f9['rack']==_0x5c5d2b[_0x14bb31(0x1f5)]&&_0x5b15f9[_0x14bb31(0x24e)]==_0x5c5d2b[_0x14bb31(0x24e)]&&_0x5b15f9[_0x14bb31(0x1da)]==_0x5c5d2b[_0x14bb31(0x1da)]&&_0x5b15f9[_0x14bb31(0x240)]==_0x5c5d2b[_0x14bb31(0x240)]&&_0x5b15f9[_0x14bb31(0x1d1)]==_0x5c5d2b['production_date']&&_0x5b15f9[_0x14bb31(0x1e1)]==_0x5c5d2b[_0x14bb31(0x1e1)]&&_0x5b15f9[_0x14bb31(0x234)]==_0x5c5d2b['id_transaction_from']){var _0x3a788c;_0x3a788c=_0x5c5d2b['adjust_qty'],_0x5c5d2b[_0x14bb31(0x255)]=='S'&&(_0x3a788c=_0x5c5d2b['adjust_qty']),_0x5b15f9[_0x14bb31(0x1aa)]=_0x5b15f9['product_stock']-_0x3a788c;}}else{if(_0x5b15f9[_0x14bb31(0x1fe)]==_0x5c5d2b[_0x14bb31(0x1fe)]&&_0x5b15f9[_0x14bb31(0x1f8)]==_0x5c5d2b[_0x14bb31(0x1f8)]&&_0x5b15f9['type']==_0x5c5d2b[_0x14bb31(0x21a)]&&_0x5b15f9[_0x14bb31(0x274)]==_0x5c5d2b[_0x14bb31(0x274)]&&_0x5b15f9[_0x14bb31(0x223)]==_0x5c5d2b[_0x14bb31(0x223)]&&_0x5b15f9[_0x14bb31(0x1f5)]==_0x5c5d2b[_0x14bb31(0x1f5)]&&_0x5b15f9[_0x14bb31(0x24e)]==_0x5c5d2b[_0x14bb31(0x24e)]&&_0x5b15f9[_0x14bb31(0x1da)]==_0x5c5d2b[_0x14bb31(0x1da)]&&_0x5b15f9[_0x14bb31(0x240)]==_0x5c5d2b[_0x14bb31(0x240)]&&_0x5b15f9['production_date']==_0x5c5d2b[_0x14bb31(0x1d1)]&&_0x5b15f9['invoice']==_0x5c5d2b['invoice']&&_0x5b15f9[_0x14bb31(0x234)]==_0x5c5d2b[_0x14bb31(0x236)]){console['log'](_0x5c5d2b);var _0x3a788c;_0x3a788c=_0x5c5d2b[_0x14bb31(0x25f)],_0x5c5d2b[_0x14bb31(0x255)]=='S'&&(_0x3a788c=_0x5c5d2b[_0x14bb31(0x25f)]),_0x5b15f9['product_stock']=_0x5b15f9[_0x14bb31(0x1aa)]+_0x3a788c;}}});}return _0x123ab6;});Promise[_0x1e85b8(0x24f)](_0x55abbe)[_0x1e85b8(0x207)](async _0x11caab=>{var _0x3d08f9=_0x1e85b8;try{for(const _0x1446c4 of _0x11caab){await _0x1446c4[_0x3d08f9(0x242)]();}_0x53d876['finalize']='True';const _0x2e4f42=await _0x53d876[_0x3d08f9(0x242)](),_0x1bbddd=await master_shop['find'](),_0x42788b=await email_settings[_0x3d08f9(0x224)](),_0x5b44b5=await supervisor_settings[_0x3d08f9(0x1e5)]();var _0x1f5e0c=_0x53d876['product'],_0x42a01e='',_0x5cda9a;for(_0x5cda9a in _0x1f5e0c){_0x42a01e+=_0x3d08f9(0x247)+_0x3d08f9(0x1a6)+_0x1f5e0c[_0x5cda9a]['product_name']+_0x3d08f9(0x22b)+_0x3d08f9(0x1a6)+_0x1f5e0c[_0x5cda9a][_0x3d08f9(0x1b0)]+_0x3d08f9(0x22b)+_0x3d08f9(0x1a6)+_0x1f5e0c[_0x5cda9a][_0x3d08f9(0x25f)]+_0x3d08f9(0x22b)+_0x3d08f9(0x1a6)+_0x1f5e0c[_0x5cda9a]['unit']+_0x3d08f9(0x22b)+_0x3d08f9(0x1a6)+_0x1f5e0c[_0x5cda9a][_0x3d08f9(0x1a3)]+_0x3d08f9(0x22b)+_0x3d08f9(0x1a6)+_0x53d876[_0x3d08f9(0x1ca)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1f5e0c[_0x5cda9a][_0x3d08f9(0x213)]+_0x3d08f9(0x22b)+_0x3d08f9(0x1a6)+_0x1f5e0c[_0x5cda9a][_0x3d08f9(0x24e)]+_0x1f5e0c[_0x5cda9a][_0x3d08f9(0x1f5)]+_0x1f5e0c[_0x5cda9a][_0x3d08f9(0x223)]+_0x1f5e0c[_0x5cda9a]['bin']+_0x1f5e0c[_0x5cda9a][_0x3d08f9(0x21a)][0x0]+_0x1f5e0c[_0x5cda9a]['floorlevel']+_0x3d08f9(0x22b),'</tr>';}let _0x401c3f=nodemailer[_0x3d08f9(0x1d2)]({'host':_0x42788b[_0x3d08f9(0x265)],'port':Number(_0x42788b[_0x3d08f9(0x1af)]),'secure':![],'auth':{'user':_0x42788b[_0x3d08f9(0x1bf)],'pass':_0x42788b[_0x3d08f9(0x211)]}}),_0x2ed711={'from':_0x42788b['email'],'to':_0x5b44b5[0x0][_0x3d08f9(0x23c)],'subject':_0x3d08f9(0x25a),'attachments':[{'filename':_0x3d08f9(0x24a),'path':__dirname+_0x3d08f9(0x1b2)+'/upload/'+_0x1bbddd[0x0][_0x3d08f9(0x22a)],'cid':_0x3d08f9(0x20e)}],'html':_0x3d08f9(0x24d)+'<html><head><title></title>'+_0x3d08f9(0x1f2)+_0x3d08f9(0x22e)+_0x3d08f9(0x1ac)+_0x3d08f9(0x22e)+_0x3d08f9(0x26b)+_0x3d08f9(0x1a7)+_0x3d08f9(0x22e)+_0x3d08f9(0x1de)+_0x1bbddd[0x0][_0x3d08f9(0x1b3)]+_0x3d08f9(0x278)+_0x3d08f9(0x1a7)+_0x3d08f9(0x1a7)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x3d08f9(0x1db)+_0x3d08f9(0x1ce)+_0x53d876['invoice']+'\x20'+_0x3d08f9(0x1cb)+_0x3d08f9(0x1d4)+_0x53d876['date']+'\x20'+'</span>'+_0x3d08f9(0x277)+_0x3d08f9(0x1a7)+_0x3d08f9(0x1ba)+_0x3d08f9(0x273)+_0x3d08f9(0x247)+_0x3d08f9(0x1d3)+_0x3d08f9(0x23b)+_0x3d08f9(0x217)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x3d08f9(0x232)+'</tr>'+_0x3d08f9(0x1d5)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x42a01e+'\x20'+'</tbody>'+'</table>'+_0x3d08f9(0x22e)+_0x3d08f9(0x208)+_0x3d08f9(0x20c)+_0x1bbddd[0x0][_0x3d08f9(0x1b3)]+_0x3d08f9(0x277)+_0x3d08f9(0x1a7)+_0x3d08f9(0x1a7)+_0x3d08f9(0x275)};_0x401c3f[_0x3d08f9(0x1df)](_0x2ed711,function(_0x46dc78,_0x2acf94){var _0x528705=_0x3d08f9;_0x46dc78?(console[_0x528705(0x1a5)](_0x46dc78),console['log'](_0x528705(0x259))):console['log'](_0x528705(0x268));}),_0x5c8359[_0x3d08f9(0x1a4)](_0x3d08f9(0x233),_0x3d08f9(0x23d)),_0x3dd84b[_0x3d08f9(0x1e9)](_0x3d08f9(0x1ee)+_0x2e4f42[_0x3d08f9(0x234)]);}catch(_0x378a2c){console[_0x3d08f9(0x1a1)](_0x378a2c),_0x3dd84b[_0x3d08f9(0x21c)](0x1f4)[_0x3d08f9(0x22d)]({'error':_0x3d08f9(0x267)});}})[_0x1e85b8(0x245)](_0x4f6840=>{var _0x2fd810=_0x1e85b8;console[_0x2fd810(0x1a1)](_0x4f6840),_0x3dd84b[_0x2fd810(0x21c)](0x1f4)[_0x2fd810(0x22d)]({'error':'An\x20error\x20occurred.'});});}catch(_0x448617){console[_0x1e85b8(0x1a5)](_0x448617),_0x3dd84b[_0x1e85b8(0x21c)](0xc8)[_0x1e85b8(0x22d)]({'message':_0x448617[_0x1e85b8(0x1fc)]});}}),router[a0_0x3a73a9(0x215)](a0_0x3a73a9(0x225),auth,async(_0x58d587,_0xca13a4)=>{var _0x47bccd=a0_0x3a73a9;try{const {username:_0x212e45,email:_0x5325d2,role:_0x5d260}=_0x58d587[_0x47bccd(0x1b9)],_0x5cc8de=_0x58d587['user'],_0x162b00=await profile[_0x47bccd(0x224)]({'email':_0x5cc8de[_0x47bccd(0x1bf)]}),_0x518e8b=await master_shop[_0x47bccd(0x1e5)](),_0x1a3dd0=_0x58d587['params']['id'],_0x59599d=await adjustment['findById']({'_id':_0x1a3dd0}),_0x4b6a07=await purchases[_0x47bccd(0x1a0)]([{'$match':{'warehouse_name':_0x59599d[_0x47bccd(0x1ca)]}},{'$unwind':_0x47bccd(0x20a)},{'$group':{'_id':_0x47bccd(0x218)}}]),_0x568d36=await product[_0x47bccd(0x1e5)]({}),_0x11ad79=await warehouse['aggregate']([{'$match':{'name':_0x59599d[_0x47bccd(0x1ca)]}},{'$unwind':_0x47bccd(0x246)},{'$group':{'_id':_0x47bccd(0x243),'name':{'$first':_0x47bccd(0x258)},'product_stock':{'$first':_0x47bccd(0x1c2)},'bay':{'$first':_0x47bccd(0x1fa)},'bin':{'$first':_0x47bccd(0x21f)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x47bccd(0x1b8)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x47bccd(0x23e)},'product_code':{'$first':_0x47bccd(0x1e2)},'storage':{'$first':_0x47bccd(0x25e)},'rack':{'$first':_0x47bccd(0x26a)},'maxPerUnit':{'$first':_0x47bccd(0x252)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x47bccd(0x1d0)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x47bccd(0x264)}}}]);let _0xa5a552;if(_0x5cc8de[_0x47bccd(0x222)]==_0x47bccd(0x1fb)){const _0x17d2a3=await staff['findOne']({'email':_0x5cc8de['email']});_0xa5a552=await warehouse[_0x47bccd(0x1a0)]([{'$match':{'status':_0x47bccd(0x1d9),'name':_0x17d2a3[_0x47bccd(0x1a2)],'warehouse_category':_0x47bccd(0x25d),'name':{'$ne':_0x47bccd(0x1c6)}}},{'$group':{'_id':_0x47bccd(0x27b),'name':{'$first':_0x47bccd(0x27b)}}}]);}else _0xa5a552=await warehouse[_0x47bccd(0x1a0)]([{'$match':{'status':_0x47bccd(0x1d9),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x47bccd(0x1c6)}}},{'$group':{'_id':'$name','name':{'$first':_0x47bccd(0x27b)}}}]);if(_0x518e8b[0x0][_0x47bccd(0x1b6)]=='English\x20(US)'){var _0x5ac44d=users[_0x47bccd(0x1f4)];console[_0x47bccd(0x1a5)](_0x5ac44d);}else{if(_0x518e8b[0x0][_0x47bccd(0x1b6)]=='Hindi')var _0x5ac44d=users['Hindi'];else{if(_0x518e8b[0x0][_0x47bccd(0x1b6)]==_0x47bccd(0x20f))var _0x5ac44d=users[_0x47bccd(0x20f)];else{if(_0x518e8b[0x0][_0x47bccd(0x1b6)]==_0x47bccd(0x1c9))var _0x5ac44d=users['Spanish'];else{if(_0x518e8b[0x0][_0x47bccd(0x1b6)]=='French')var _0x5ac44d=users[_0x47bccd(0x235)];else{if(_0x518e8b[0x0]['language']==_0x47bccd(0x1e0))var _0x5ac44d=users['Portuguese'];else{if(_0x518e8b[0x0][_0x47bccd(0x1b6)]=='Chinese')var _0x5ac44d=users[_0x47bccd(0x26d)];else{if(_0x518e8b[0x0][_0x47bccd(0x1b6)]==_0x47bccd(0x204))var _0x5ac44d=users[_0x47bccd(0x1eb)];}}}}}}}_0xca13a4['render'](_0x47bccd(0x263),{'success':_0x58d587[_0x47bccd(0x1a4)](_0x47bccd(0x233)),'errors':_0x58d587[_0x47bccd(0x1a4)](_0x47bccd(0x1b5)),'role':_0x5cc8de,'profile':_0x162b00,'adjustment':_0x59599d,'stock':_0x11ad79,'master_shop':_0x518e8b,'warehouse_name':_0x4b6a07,'unit':_0x568d36,'language':_0x5ac44d,'warehouse':_0xa5a552});}catch(_0x254e1c){console[_0x47bccd(0x1a5)](_0x254e1c),_0xca13a4['status'](0xc8)[_0x47bccd(0x22d)]({'message':_0x254e1c[_0x47bccd(0x1fc)]});}}),router['post'](a0_0x3a73a9(0x225),auth,async(_0x251167,_0x80be94)=>{var _0x248f91=a0_0x3a73a9;try{const _0x4868a7=_0x251167[_0x248f91(0x200)]['id'],_0x4b67a1=await adjustment[_0x248f91(0x271)]({'_id':_0x4868a7}),_0x5b8743=await warehouse[_0x248f91(0x224)]({'name':_0x4b67a1[_0x248f91(0x1ca)],'room':_0x4b67a1[_0x248f91(0x1b7)]}),{warehouse_name:_0x5057df,date:_0xa498f3,prod_name:_0xa5e707,level:_0x25ca44,isle:_0x22cc71,pallet:_0x193e48,stock:_0x4e3428,types:_0x2c3a4d,adjust_qty:_0x4b82d4,new_adjust_qty:_0x4f82b9,note:_0x46f32e,Room_name:_0x3f26fc,invoice:_0x3b254a,JO_number:_0x3af540,expiry_date:_0x555caa}=_0x251167[_0x248f91(0x24b)];if(typeof _0xa5e707==_0x248f91(0x1f6))var _0x38636b=[_0x251167[_0x248f91(0x24b)]['prod_name']],_0x20623d=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x25b)]],_0x36942e=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x1a8)]],_0xc2da09=[_0x251167['body']['types']],_0x309a31=[_0x251167['body'][_0x248f91(0x1cd)]],_0x378c21=[_0x251167['body'][_0x248f91(0x23f)]],_0x4a5182=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x1e3)]],_0x5e610e=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x1c1)]],_0x41b06a=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x1d6)]],_0x3161a2=[_0x251167[_0x248f91(0x24b)]['batch_code']],_0x47d43b=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x1da)]],_0x59a690=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x25c)]],_0x5e55be=[_0x251167[_0x248f91(0x24b)]['production_date']],_0x59dc19=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x255)]],_0x28818c=[_0x251167['body']['Rooms']],_0x2cea78=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x27a)]],_0x38d4bb=[_0x251167[_0x248f91(0x24b)][_0x248f91(0x227)]];else var _0x38636b=[..._0x251167[_0x248f91(0x24b)][_0x248f91(0x1c4)]],_0x20623d=[..._0x251167[_0x248f91(0x24b)][_0x248f91(0x25b)]],_0x36942e=[..._0x251167['body'][_0x248f91(0x1a8)]],_0xc2da09=[..._0x251167['body'][_0x248f91(0x251)]],_0x309a31=[..._0x251167[_0x248f91(0x24b)]['New_Qty_Converted_adj']],_0x378c21=[..._0x251167[_0x248f91(0x24b)][_0x248f91(0x23f)]],_0x4a5182=[..._0x251167[_0x248f91(0x24b)]['unit']],_0x5e610e=[..._0x251167[_0x248f91(0x24b)]['Secondary_units']],_0x41b06a=[..._0x251167[_0x248f91(0x24b)][_0x248f91(0x1d6)]],_0x3161a2=[..._0x251167[_0x248f91(0x24b)]['batch_code']],_0x47d43b=[..._0x251167[_0x248f91(0x24b)][_0x248f91(0x1da)]],_0x59a690=[..._0x251167['body'][_0x248f91(0x25c)]],_0x5e55be=[..._0x251167[_0x248f91(0x24b)]['production_date']],_0x59dc19=[..._0x251167[_0x248f91(0x24b)]['prod_cat']],_0x28818c=[..._0x251167[_0x248f91(0x24b)][_0x248f91(0x253)]],_0x2cea78=[..._0x251167[_0x248f91(0x24b)][_0x248f91(0x27a)]],_0x38d4bb=[..._0x251167[_0x248f91(0x24b)][_0x248f91(0x227)]];const _0x3029c5=_0x38636b['map'](_0x26b9b5=>{return _0x26b9b5={'product_name':_0x26b9b5};});_0x20623d[_0x248f91(0x1c0)]((_0x254271,_0xa93853)=>{var _0x467e1d=_0x248f91;_0x28818c[_0x467e1d(0x1c0)]((_0x50e0e0,_0x486a59)=>{var _0x51acb9=_0x467e1d;if(_0x50e0e0=='Receiving\x20Area'&&_0xa93853==_0x486a59){var _0x51d93f=_0x254271[_0x51acb9(0x1c3)](0x3);_0x3029c5[_0xa93853][_0x51acb9(0x24e)]=_0x254271[0x0],_0x3029c5[_0xa93853][_0x51acb9(0x1f5)]=_0x254271[0x1],_0x3029c5[_0xa93853][_0x51acb9(0x223)]=0x0,_0x3029c5[_0xa93853][_0x51acb9(0x274)]=0x0,_0x3029c5[_0xa93853]['type']=_0x51acb9(0x226),_0x3029c5[_0xa93853][_0x51acb9(0x1f8)]=_0x51d93f;}else{if(_0x50e0e0==_0x51acb9(0x202)&&_0xa93853==_0x486a59){var _0x51d93f=_0x254271[_0x51acb9(0x1c3)](0x3);_0x3029c5[_0xa93853][_0x51acb9(0x24e)]=_0x254271[0x0],_0x3029c5[_0xa93853]['rack']=_0x254271[0x1],_0x3029c5[_0xa93853][_0x51acb9(0x223)]=0x0,_0x3029c5[_0xa93853][_0x51acb9(0x274)]=0x0,_0x3029c5[_0xa93853][_0x51acb9(0x21a)]=_0x51acb9(0x226),_0x3029c5[_0xa93853]['floorlevel']=_0x254271[0x5];}else{if(_0xa93853==_0x486a59){var _0x104aa1;if(_0x254271[0x4]=='L')_0x104aa1=_0x51acb9(0x1b1);else _0x254271[0x4]=='F'&&(_0x104aa1=_0x51acb9(0x226));_0x3029c5[_0xa93853][_0x51acb9(0x24e)]=_0x254271[0x0],_0x3029c5[_0xa93853]['rack']=_0x254271[0x1],_0x3029c5[_0xa93853][_0x51acb9(0x223)]=_0x254271[0x2],_0x3029c5[_0xa93853][_0x51acb9(0x274)]=_0x254271[0x3],_0x3029c5[_0xa93853]['type']=_0x104aa1,_0x3029c5[_0xa93853][_0x51acb9(0x1f8)]=_0x254271[0x5];}}}});}),_0x36942e[_0x248f91(0x1c0)]((_0x3f7be9,_0x2e2ff1)=>{var _0x3be41e=_0x248f91;_0x3029c5[_0x2e2ff1][_0x3be41e(0x266)]=_0x3f7be9;}),_0xc2da09[_0x248f91(0x1c0)]((_0x4478fe,_0x4af6ec)=>{var _0x2e5f4b=_0x248f91;_0x3029c5[_0x4af6ec][_0x2e5f4b(0x251)]=_0x4478fe;}),_0x309a31[_0x248f91(0x1c0)]((_0x2b7b6a,_0x548346)=>{var _0xabb3b=_0x248f91;_0x3029c5[_0x548346][_0xabb3b(0x25f)]=_0x2b7b6a;}),_0x378c21[_0x248f91(0x1c0)]((_0x5bd9b6,_0x207f7f)=>{_0x3029c5[_0x207f7f]['new_adjust_qty']=_0x5bd9b6;}),_0x4a5182['forEach']((_0xed89c6,_0x56d069)=>{var _0x12ad2d=_0x248f91;_0x3029c5[_0x56d069][_0x12ad2d(0x1e8)]=_0xed89c6;}),_0x5e610e[_0x248f91(0x1c0)]((_0x28a5b6,_0xcbf593)=>{var _0xe53023=_0x248f91;_0x3029c5[_0xcbf593][_0xe53023(0x1a3)]=_0x28a5b6;}),_0x41b06a['forEach']((_0x3eb4e7,_0x495d3f)=>{_0x3029c5[_0x495d3f]['product_code']=_0x3eb4e7;}),_0x3161a2['forEach']((_0x505d06,_0x3f77bf)=>{var _0x440485=_0x248f91;_0x3029c5[_0x3f77bf][_0x440485(0x240)]=_0x505d06;}),_0x47d43b[_0x248f91(0x1c0)]((_0x2eb7e9,_0x5cc376)=>{var _0x258cbf=_0x248f91;_0x3029c5[_0x5cc376][_0x258cbf(0x1da)]=_0x2eb7e9;}),_0x59a690[_0x248f91(0x1c0)]((_0x5bfa3f,_0x7e60c5)=>{var _0x3817f7=_0x248f91;_0x3029c5[_0x7e60c5][_0x3817f7(0x228)]=_0x5bfa3f;}),_0x5e55be[_0x248f91(0x1c0)]((_0x6f1866,_0x416d87)=>{var _0x5a2be9=_0x248f91;_0x3029c5[_0x416d87][_0x5a2be9(0x1d1)]=_0x6f1866;}),_0x59dc19['forEach']((_0x571ad1,_0x5e12b1)=>{var _0x2c44c3=_0x248f91;_0x3029c5[_0x5e12b1][_0x2c44c3(0x255)]=_0x571ad1;}),_0x28818c['forEach']((_0xbf108b,_0x20f527)=>{_0x3029c5[_0x20f527]['room_names']=_0xbf108b;}),_0x2cea78['forEach']((_0xe96b41,_0x1d5077)=>{var _0xa28a84=_0x248f91;_0x3029c5[_0x1d5077][_0xa28a84(0x1c7)]=_0xe96b41;}),_0x38d4bb[_0x248f91(0x1c0)]((_0x2b32d1,_0x28e975)=>{var _0x10ddaa=_0x248f91;_0x3029c5[_0x28e975][_0x10ddaa(0x1cf)]=_0x2b32d1;});const _0x2e88ec=_0x3029c5['filter'](_0x237d0c=>_0x237d0c[_0x248f91(0x25f)]!=='0'&&_0x237d0c[_0x248f91(0x25f)]!=='');var _0x5a9cdc=0x0;_0x2e88ec['forEach'](_0x39465b=>{var _0x3ad9c7=_0x248f91;console['log'](_0x3ad9c7(0x23a),_0x39465b),parseInt(_0x39465b[_0x3ad9c7(0x25f)])<=0x0&&_0x5a9cdc++;});if(_0x5a9cdc!=0x0)return _0x251167[_0x248f91(0x1a4)]('errors',_0x248f91(0x260)),_0x80be94[_0x248f91(0x1e9)](_0x248f91(0x1f9));_0x4b67a1[_0x248f91(0x1ca)]=_0x5057df,_0x4b67a1[_0x248f91(0x1c5)]=_0xa498f3,_0x4b67a1[_0x248f91(0x237)]=_0x2e88ec,_0x4b67a1[_0x248f91(0x244)]=_0x46f32e,_0x4b67a1[_0x248f91(0x1e1)]=_0x3b254a,_0x4b67a1[_0x248f91(0x26c)]=_0x248f91(0x241);const _0x407c64=await _0x4b67a1[_0x248f91(0x242)]();_0x251167[_0x248f91(0x1a4)]('success','adjustment\x20data\x20update\x20successfully'),_0x80be94[_0x248f91(0x1e9)](_0x248f91(0x19f));}catch(_0x57c82f){console[_0x248f91(0x1a5)](_0x57c82f);}}),router[a0_0x3a73a9(0x1fd)](a0_0x3a73a9(0x220),async(_0x39e90f,_0xdccb7c)=>{var _0x2313c3=a0_0x3a73a9;const {primary_code:_0x23ce0f,warehouse_data:_0x465666,rooms_data:_0x59d06e,Roomslist:_0x5e6719}=_0x39e90f[_0x2313c3(0x24b)],_0xf561b0=_0x5e6719['split'](','),_0x12ea68=[];async function _0x419765(_0x14427b){var _0x4d7445=_0x2313c3;const _0x372189=await warehouse[_0x4d7445(0x1a0)]([{'$match':{'name':_0x465666,'room':_0x14427b}},{'$unwind':_0x4d7445(0x246)},{'$match':{'product_details.primary_code':_0x23ce0f}},{'$group':{'_id':_0x4d7445(0x243),'name':{'$first':_0x4d7445(0x258)},'product_stock':{'$first':_0x4d7445(0x1c2)},'primary_code':{'$first':_0x4d7445(0x1ab)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4d7445(0x1e2)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x4d7445(0x21f)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4d7445(0x1e4)},'storage':{'$first':_0x4d7445(0x25e)},'rack':{'$first':_0x4d7445(0x26a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4d7445(0x1d0)},'maxPerUnit':{'$first':_0x4d7445(0x252)},'batch_code':{'$first':_0x4d7445(0x269)},'product_cat':{'$first':_0x4d7445(0x238)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x4d7445(0x264)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x4af062=await warehouse[_0x4d7445(0x1a0)]([{'$match':{'name':_0x465666,'room':_0x14427b}},{'$unwind':_0x4d7445(0x246)},{'$match':{'product_details.secondary_code':_0x23ce0f}},{'$group':{'_id':_0x4d7445(0x243),'name':{'$first':_0x4d7445(0x258)},'product_stock':{'$first':_0x4d7445(0x1c2)},'primary_code':{'$first':_0x4d7445(0x1ab)},'secondary_code':{'$first':_0x4d7445(0x23e)},'product_code':{'$first':_0x4d7445(0x1e2)},'level':{'$first':_0x4d7445(0x1fa)},'isle':{'$first':_0x4d7445(0x21f)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x4d7445(0x1b8)},'unit':{'$first':_0x4d7445(0x1b4)},'secondary_unit':{'$first':_0x4d7445(0x1e4)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4d7445(0x1ad)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x4d7445(0x269)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x372189[_0x4d7445(0x257)]>0x0)_0x12ea68[_0x4d7445(0x20d)](_0x372189);else _0x4af062[_0x4d7445(0x257)]>0x0&&_0x12ea68['push'](_0x4af062);}const _0x3ecf97=_0xf561b0['map'](_0x1d4381=>_0x419765(_0x1d4381));await Promise[_0x2313c3(0x24f)](_0x3ecf97),_0xdccb7c[_0x2313c3(0x22d)](_0x12ea68);}),router['post'](a0_0x3a73a9(0x1dc),async(_0x543e5c,_0x5d1f6a)=>{var _0x5324c6=a0_0x3a73a9;const {primaryCode:_0x1c546b,secondaryCode:_0x49a679,productCode:_0x1dcfdd,level:_0x50c6e5,isle:_0xc186c9,pallet:_0x31ab81,warehouses:_0x12883d,room:_0x31267b}=_0x543e5c[_0x5324c6(0x24b)];try{const _0x14c99a=await warehouse[_0x5324c6(0x1a0)]([{'$match':{'name':_0x12883d,'room':_0x31267b}},{'$unwind':_0x5324c6(0x246)},{'$match':{'product_details.level':parseInt(_0x50c6e5),'product_details.isle':_0xc186c9,'product_details.pallet':parseInt(_0x31ab81)}},{'$group':{'_id':_0x5324c6(0x243),'name':{'$first':_0x5324c6(0x258)},'product_stock':{'$first':_0x5324c6(0x1c2)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x5324c6(0x203)},'pallet':{'$first':_0x5324c6(0x1ec)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x5d1f6a['status'](0xc8)[_0x5324c6(0x22d)](_0x14c99a);}catch(_0x487a77){_0x5d1f6a[_0x5324c6(0x21c)](0x194)[_0x5324c6(0x22d)]({'message':_0x487a77[_0x5324c6(0x1fc)]});}}),module[a0_0x3a73a9(0x1f0)]=router;