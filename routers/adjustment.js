function a0_0x2c9b(){var _0x333e5d=['Secondary_units','toString','<tbody\x20style=\x22text-align:\x20center;\x22>','back','slice','save','$date','isAllowEdit','bin','add_adjustment','json','$product_details.floorlevel','Rooms','render','True','Enclosed','flash','errors','2984070HzMoCD','$product_details','$product_details.storage','exports','$product_details.maxPerUnit','$product_details.type','/preview/:id','/upload/','storage','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.pallet','</head><body>','room','ADJ-','Router','Floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','error','/picking_list/PDF_adjustment_rm/','max_per_unit','Enabled','/adjustment/view','production_date','$product_details.secondary_unit','\x20Order\x20Number\x20:\x20','3836664lAGbCc','log','Adjustment\x20Mail','/../public','adjustment','$product_details.production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','English','prod_code','<span\x20style=\x22float:\x20right;\x22>','Email\x20sent\x20successfully','1275945fOtTkJ','5474802wLuFqP','2468034JbCkLQ','role','$product_details._id','foreach\x20newproduct','stockBefore','rack','post','host','English\x20(US)','prime1','Portuguese','product_stock','</td>','adjust_qty','language','id_transaction_from','$product_details.bay','$product','Return\x20Rooms','invoice','batch_code','Hindi','redirect','Portuguese\x20(BR)','95706rFZdMj','email','floorlevel','Return\x20Goods','<!DOCTYPE\x20html>','filter','_id','padStart','message','staff','Ambient','new_adjust_qty','French','nodemailer','stock','\x20<>\x20','string','$product_details.product_name','adjustment\x20data\x20update\x20successfully','69sOXMBg','prod_cat','$product_details.isle','product','id_transaction','German','../public/language/languages.json','An\x20error\x20occurred.','</table>','$product.product_name','types','expiry_date','adjustment\x20add\x20successfull','warehouse_name','Spanish','$product_details.expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','product_details','prod_name','Arabic','<html><head><title></title>','An\x20error\x20occurred\x20while\x20saving\x20data.','<h2>\x20','/adjustment/preview/','length','$product_details.primary_code','$product_details.invoice','edit_adjustment','$product_details.maxProducts','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','</span>','../models/all_models','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$room','New_Qty_Converted_adj','type','user','createTransport','level','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.product_code','map','body','</div>','$isAllowEdit','findOne','</h5>','then','$product_details.unit','$product_details.secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Error\x20Occurs','port','$name','forEach','<tr>','$finalize','88FGmXqe','logo','Chinese','$product_details.batch_code','edit_adjustment_view','bay','</tr>','/view/:id','find','secondary_unit','$product.room_names','<h5>','note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/view/add_adjustment','findById','aggregate','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','express','push','Shelves','date','second1','get','all','split','primary_code','prod_invoice','New_Qty_Converted','Receiving\x20Area','6230014xTGKwf','image','secondary_code','/view','warehouse','unit','product_code','params','$product_details.product_stock','$product_details.product_cat','$product_details.rack','Raw\x20Materials','Primary_Units','catch','False','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.bin','status','Level','Arabic\x20(ae)','success','maxperunit','<div>','room_names'];a0_0x2c9b=function(){return _0x333e5d;};return a0_0x2c9b();}var a0_0x1f8ae7=a0_0x3cb3;(function(_0x1bcd69,_0xaade9e){var _0x2c142c=a0_0x3cb3,_0x4719d8=_0x1bcd69();while(!![]){try{var _0x4c0b0a=-parseInt(_0x2c142c(0x187))/0x1+parseInt(_0x2c142c(0x1a1))/0x2*(parseInt(_0x2c142c(0x1b4))/0x3)+-parseInt(_0x2c142c(0x17c))/0x4+parseInt(_0x2c142c(0x162))/0x5+-parseInt(_0x2c142c(0x188))/0x6+-parseInt(_0x2c142c(0x138))/0x7+parseInt(_0x2c142c(0x119))/0x8*(parseInt(_0x2c142c(0x189))/0x9);if(_0x4c0b0a===_0xaade9e)break;else _0x4719d8['push'](_0x4719d8['shift']());}catch(_0x32cbe4){_0x4719d8['push'](_0x4719d8['shift']());}}}(a0_0x2c9b,0xa51f3));const express=require(a0_0x1f8ae7(0x12c)),app=express(),router=express[a0_0x1f8ae7(0x171)](),auth=require(a0_0x1f8ae7(0x12a)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x1f8ae7(0x1d4)),users=require(a0_0x1f8ae7(0x1ba)),nodemailer=require(a0_0x1f8ae7(0x1ae));router['get'](a0_0x1f8ae7(0x13b),auth,async(_0x36de66,_0x1b7811)=>{var _0x35a5de=a0_0x1f8ae7;try{const {username:_0x4ad491,email:_0xe66c81,role:_0x4c17c7}=_0x36de66[_0x35a5de(0x1d9)],_0x1116ce=_0x36de66[_0x35a5de(0x1d9)],_0x4ae304=await profile['findOne']({'email':_0x1116ce[_0x35a5de(0x1a2)]}),_0x5a4d14=await master_shop[_0x35a5de(0x121)]();console[_0x35a5de(0x17d)]('master',_0x5a4d14);let _0x1e71a9;if(_0x1116ce['role']=='staff'){const _0x4c8496=await staff[_0x35a5de(0x1e2)]({'email':_0x1116ce[_0x35a5de(0x1a2)]});_0x1e71a9=await warehouse[_0x35a5de(0x121)]({'status':'Enabled','name':_0x4c8496[_0x35a5de(0x13c)]});}else _0x1e71a9=await warehouse[_0x35a5de(0x121)]({'status':'Enabled'});const _0x47ae49=await product['find']();let _0x5d7f8f;if(_0x1116ce['role']==_0x35a5de(0x1aa)){const _0x2a518d=await staff[_0x35a5de(0x1e2)]({'email':_0x1116ce[_0x35a5de(0x1a2)]});_0x5d7f8f=await adjustment[_0x35a5de(0x121)]({'warehouse_name':_0x2a518d['warehouse']});}else _0x5d7f8f=await adjustment[_0x35a5de(0x129)]([{'$unwind':_0x35a5de(0x19a)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x35a5de(0x156)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x35a5de(0x123)},'finalize':{'$first':_0x35a5de(0x1ed)},'isAllowEdit':{'$first':_0x35a5de(0x1e1)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x5a4d14[0x0]['language']==_0x35a5de(0x191)){var _0xfc951=users[_0x35a5de(0x183)];console[_0x35a5de(0x17d)](_0xfc951);}else{if(_0x5a4d14[0x0][_0x35a5de(0x197)]==_0x35a5de(0x19e))var _0xfc951=users[_0x35a5de(0x19e)];else{if(_0x5a4d14[0x0][_0x35a5de(0x197)]==_0x35a5de(0x1b9))var _0xfc951=users[_0x35a5de(0x1b9)];else{if(_0x5a4d14[0x0][_0x35a5de(0x197)]==_0x35a5de(0x1c2))var _0xfc951=users['Spanish'];else{if(_0x5a4d14[0x0][_0x35a5de(0x197)]=='French')var _0xfc951=users['French'];else{if(_0x5a4d14[0x0][_0x35a5de(0x197)]==_0x35a5de(0x1a0))var _0xfc951=users[_0x35a5de(0x193)];else{if(_0x5a4d14[0x0][_0x35a5de(0x197)]==_0x35a5de(0x11b))var _0xfc951=users[_0x35a5de(0x11b)];else{if(_0x5a4d14[0x0]['language']==_0x35a5de(0x14b))var _0xfc951=users[_0x35a5de(0x1c8)];}}}}}}}_0x1b7811[_0x35a5de(0x15d)](_0x35a5de(0x180),{'success':_0x36de66[_0x35a5de(0x160)]('success'),'errors':_0x36de66[_0x35a5de(0x160)](_0x35a5de(0x161)),'role':_0x1116ce,'profile':_0x4ae304,'warehouse':_0x1e71a9,'product':_0x47ae49,'adjustment':_0x5d7f8f,'master_shop':_0x5a4d14,'language':_0xfc951});}catch(_0xbe0d3e){console[_0x35a5de(0x17d)](_0xbe0d3e);}});async function getRandom8DigitNumber(){var _0x28a8a1=a0_0x1f8ae7;const _0x5bca3c=0x989680,_0x3ff565=0x5f5e0ff,_0x167023=Math['floor'](Math['random']()*(_0x3ff565-_0x5bca3c+0x1))+_0x5bca3c;var _0x460223;const _0x436b16=await adjustment[_0x28a8a1(0x1e2)]({'invoice':_0x28a8a1(0x170)+_0x167023});return _0x436b16&&_0x436b16[_0x28a8a1(0x1cd)]>0x0?_0x460223=_0x28a8a1(0x170)+_0x167023:_0x460223=_0x28a8a1(0x170)+_0x167023,_0x460223;}function a0_0x3cb3(_0x289f73,_0x44be70){var _0x2c9b76=a0_0x2c9b();return a0_0x3cb3=function(_0x3cb338,_0x353820){_0x3cb338=_0x3cb338-0x119;var _0x335c75=_0x2c9b76[_0x3cb338];return _0x335c75;},a0_0x3cb3(_0x289f73,_0x44be70);}router[a0_0x1f8ae7(0x131)](a0_0x1f8ae7(0x127),auth,async(_0x2e8bbb,_0x5467e4)=>{var _0x49b220=a0_0x1f8ae7;try{const {username:_0x241d22,email:_0x8ab349,role:_0x3f5ced}=_0x2e8bbb[_0x49b220(0x1d9)],_0x5c9c05=_0x2e8bbb[_0x49b220(0x1d9)],_0x5ad02e=await profile['findOne']({'email':_0x5c9c05['email']}),_0x4b8489=await master_shop[_0x49b220(0x121)]();let _0x25a2d7;if(_0x5c9c05['role']=='staff'){const _0x163f6e=await staff[_0x49b220(0x1e2)]({'email':_0x5c9c05[_0x49b220(0x1a2)]});_0x25a2d7=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x163f6e[_0x49b220(0x13c)],'warehouse_category':_0x49b220(0x143),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x49b220(0x1ea),'name':{'$first':_0x49b220(0x1ea)}}}]);}else _0x25a2d7=await warehouse[_0x49b220(0x129)]([{'$match':{'status':_0x49b220(0x177),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x49b220(0x1a4)}}},{'$group':{'_id':_0x49b220(0x1ea),'name':{'$first':_0x49b220(0x1ea)}}}]);const _0x4f0f5c=await product['find']({}),_0x1a5f67=await adjustment[_0x49b220(0x121)]({}),_0x43618e=_0x1a5f67[_0x49b220(0x1cd)]+0x1,_0x3ed056=_0x49b220(0x170)+_0x43618e[_0x49b220(0x151)]()[_0x49b220(0x1a8)](0x5,'0');var _0x516471=[_0x49b220(0x1ab),_0x49b220(0x15f),_0x49b220(0x19b)];if(_0x4b8489[0x0]['language']==_0x49b220(0x191))var _0x1fae2f=users[_0x49b220(0x183)];else{if(_0x4b8489[0x0][_0x49b220(0x197)]==_0x49b220(0x19e))var _0x1fae2f=users[_0x49b220(0x19e)];else{if(_0x4b8489[0x0]['language']==_0x49b220(0x1b9))var _0x1fae2f=users[_0x49b220(0x1b9)];else{if(_0x4b8489[0x0][_0x49b220(0x197)]==_0x49b220(0x1c2))var _0x1fae2f=users['Spanish'];else{if(_0x4b8489[0x0][_0x49b220(0x197)]==_0x49b220(0x1ad))var _0x1fae2f=users[_0x49b220(0x1ad)];else{if(_0x4b8489[0x0][_0x49b220(0x197)]==_0x49b220(0x1a0))var _0x1fae2f=users[_0x49b220(0x193)];else{if(_0x4b8489[0x0]['language']==_0x49b220(0x11b))var _0x1fae2f=users[_0x49b220(0x11b)];else{if(_0x4b8489[0x0]['language']==_0x49b220(0x14b))var _0x1fae2f=users[_0x49b220(0x1c8)];}}}}}}}const _0x386850=getRandom8DigitNumber();_0x386850[_0x49b220(0x1e4)](_0x4f4f12=>{var _0x49bd28=_0x49b220;_0x5467e4[_0x49bd28(0x15d)](_0x49bd28(0x159),{'success':_0x2e8bbb['flash']('success'),'errors':_0x2e8bbb['flash'](_0x49bd28(0x161)),'role':_0x5c9c05,'profile':_0x5ad02e,'warehouse':_0x25a2d7,'product':_0x4f0f5c,'master_shop':_0x4b8489,'language':_0x1fae2f,'rooms_data':_0x516471,'invoice_no':_0x4f4f12});})[_0x49b220(0x145)](_0x39137d=>{var _0x4ba6df=_0x49b220;_0x2e8bbb['flash'](_0x4ba6df(0x161),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x5467e4[_0x4ba6df(0x19f)](_0x4ba6df(0x178));});}catch(_0x5ec567){console['log'](_0x5ec567);}}),router['post'](a0_0x1f8ae7(0x127),auth,async(_0x722e00,_0x20ae21)=>{var _0x58a715=a0_0x1f8ae7;try{const {warehouse_name:_0x5d4ab0,date:_0x31a41c,prod_name:_0x37ff12,level:_0x4d66c9,isle:_0x2b9dd8,pallet:_0x47a389,stock:_0xab3b3b,types:_0x57b367,adjust_qty:_0x1bb505,new_adjust_qty:_0x164d7f,note:_0x1ba645,Room_name:_0x19715b,invoice:_0x1626c4,JO_number:_0x37bdc3,expiry_date:_0x18b6e9}=_0x722e00[_0x58a715(0x1df)];if(typeof _0x37ff12==_0x58a715(0x1b1))var _0x4f24cc=[_0x722e00['body'][_0x58a715(0x1c7)]],_0x2dbc42=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x1db)]],_0x315d67=[_0x722e00[_0x58a715(0x1df)]['stock']],_0x152cec=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x1be)]],_0x4c7884=[_0x722e00['body']['New_Qty_Converted_adj']],_0x24f2cc=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x136)]],_0x520a19=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x144)]],_0xcbcc80=[_0x722e00[_0x58a715(0x1df)]['Secondary_units']],_0x2a2244=[_0x722e00[_0x58a715(0x1df)]['prod_code']],_0x1718f6=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x19d)]],_0x219788=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x1bf)]],_0x36f2=[_0x722e00[_0x58a715(0x1df)]['max_per_unit']],_0x352988=[_0x722e00['body'][_0x58a715(0x179)]],_0x4b8b52=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x1b5)]],_0x18fa38=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x15c)]],_0x295d24=[_0x722e00['body'][_0x58a715(0x192)]],_0x237924=[_0x722e00['body']['second1']],_0x52c9b8=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x135)]],_0x3c1efa=[_0x722e00[_0x58a715(0x1df)][_0x58a715(0x1b8)]];else var _0x4f24cc=[..._0x722e00['body'][_0x58a715(0x1c7)]],_0x2dbc42=[..._0x722e00['body'][_0x58a715(0x1db)]],_0x315d67=[..._0x722e00[_0x58a715(0x1df)][_0x58a715(0x1af)]],_0x152cec=[..._0x722e00[_0x58a715(0x1df)][_0x58a715(0x1be)]],_0x4c7884=[..._0x722e00['body'][_0x58a715(0x1d7)]],_0x24f2cc=[..._0x722e00[_0x58a715(0x1df)][_0x58a715(0x136)]],_0x520a19=[..._0x722e00[_0x58a715(0x1df)]['unit']],_0xcbcc80=[..._0x722e00['body'][_0x58a715(0x150)]],_0x2a2244=[..._0x722e00[_0x58a715(0x1df)][_0x58a715(0x184)]],_0x1718f6=[..._0x722e00['body'][_0x58a715(0x19d)]],_0x219788=[..._0x722e00[_0x58a715(0x1df)]['expiry_date']],_0x36f2=[..._0x722e00[_0x58a715(0x1df)][_0x58a715(0x176)]],_0x352988=[..._0x722e00['body'][_0x58a715(0x179)]],_0x4b8b52=[..._0x722e00[_0x58a715(0x1df)][_0x58a715(0x1b5)]],_0x18fa38=[..._0x722e00[_0x58a715(0x1df)]['Rooms']],_0x295d24=[..._0x722e00['body'][_0x58a715(0x192)]],_0x237924=[..._0x722e00[_0x58a715(0x1df)][_0x58a715(0x130)]],_0x52c9b8=[..._0x722e00[_0x58a715(0x1df)][_0x58a715(0x135)]],_0x3c1efa=[..._0x722e00[_0x58a715(0x1df)][_0x58a715(0x1b8)]];const _0x1e933c=_0x4f24cc['map'](_0x24fb79=>{return _0x24fb79={'product_name':_0x24fb79};});_0x2dbc42[_0x58a715(0x1eb)]((_0x519c92,_0x12dd66)=>{var _0x240033=_0x58a715;_0x18fa38[_0x240033(0x1eb)]((_0x39c96d,_0x117850)=>{var _0x57703a=_0x240033;if(_0x39c96d==_0x57703a(0x137)&&_0x12dd66==_0x117850){var _0x67a282=_0x519c92[_0x57703a(0x154)](0x3);_0x1e933c[_0x12dd66][_0x57703a(0x16a)]=_0x519c92[0x0],_0x1e933c[_0x12dd66][_0x57703a(0x18e)]=_0x519c92[0x1],_0x1e933c[_0x12dd66][_0x57703a(0x11e)]=0x0,_0x1e933c[_0x12dd66][_0x57703a(0x158)]=0x0,_0x1e933c[_0x12dd66][_0x57703a(0x1d8)]=_0x57703a(0x172),_0x1e933c[_0x12dd66][_0x57703a(0x1a3)]=_0x67a282;}else{if(_0x39c96d==_0x57703a(0x12e)&&_0x12dd66==_0x117850){var _0x67a282=_0x519c92[_0x57703a(0x154)](0x3);_0x1e933c[_0x12dd66][_0x57703a(0x16a)]=_0x519c92[0x0],_0x1e933c[_0x12dd66][_0x57703a(0x18e)]=_0x519c92[0x1],_0x1e933c[_0x12dd66][_0x57703a(0x11e)]=0x0,_0x1e933c[_0x12dd66]['bin']=0x0,_0x1e933c[_0x12dd66]['type']='Floor',_0x1e933c[_0x12dd66][_0x57703a(0x1a3)]=_0x519c92[0x5];}else{if(_0x12dd66==_0x117850){var _0x590220;if(_0x519c92[0x4]=='L')_0x590220=_0x57703a(0x14a);else _0x519c92[0x4]=='F'&&(_0x590220='Floor');_0x1e933c[_0x12dd66][_0x57703a(0x16a)]=_0x519c92[0x0],_0x1e933c[_0x12dd66][_0x57703a(0x18e)]=_0x519c92[0x1],_0x1e933c[_0x12dd66][_0x57703a(0x11e)]=_0x519c92[0x2],_0x1e933c[_0x12dd66][_0x57703a(0x158)]=_0x519c92[0x3],_0x1e933c[_0x12dd66][_0x57703a(0x1d8)]=_0x590220,_0x1e933c[_0x12dd66]['floorlevel']=_0x519c92[0x5];}}}});}),_0x315d67[_0x58a715(0x1eb)]((_0x4fa3d7,_0x3db940)=>{var _0x104a71=_0x58a715;_0x1e933c[_0x3db940][_0x104a71(0x18d)]=_0x4fa3d7;}),_0x3c1efa[_0x58a715(0x1eb)]((_0x2893d2,_0x2ace4f)=>{var _0x38d20a=_0x58a715;_0x1e933c[_0x2ace4f][_0x38d20a(0x198)]=_0x2893d2;}),_0x152cec['forEach']((_0x13a434,_0x571d7c)=>{_0x1e933c[_0x571d7c]['types']=_0x13a434;}),_0x4c7884[_0x58a715(0x1eb)]((_0x5eda4f,_0x2402f8)=>{var _0x324de8=_0x58a715;_0x1e933c[_0x2402f8][_0x324de8(0x196)]=_0x5eda4f;}),_0x24f2cc[_0x58a715(0x1eb)]((_0x4b7fe2,_0x54d56d)=>{var _0x1f8d81=_0x58a715;_0x1e933c[_0x54d56d][_0x1f8d81(0x1ac)]=_0x4b7fe2;}),_0x520a19[_0x58a715(0x1eb)]((_0x174eaa,_0x13769a)=>{var _0x2a5663=_0x58a715;_0x1e933c[_0x13769a][_0x2a5663(0x13d)]=_0x174eaa;}),_0xcbcc80[_0x58a715(0x1eb)]((_0x2a4d28,_0xd2fa92)=>{var _0x25e1d0=_0x58a715;_0x1e933c[_0xd2fa92][_0x25e1d0(0x122)]=_0x2a4d28;}),_0x2a2244['forEach']((_0x45d0e4,_0x4c47be)=>{var _0x5d5278=_0x58a715;_0x1e933c[_0x4c47be][_0x5d5278(0x13e)]=_0x45d0e4;}),_0x1718f6['forEach']((_0x51b462,_0x2cba57)=>{_0x1e933c[_0x2cba57]['batch_code']=_0x51b462;}),_0x219788[_0x58a715(0x1eb)]((_0x4590cd,_0x1e9244)=>{var _0x234fc4=_0x58a715;_0x1e933c[_0x1e9244][_0x234fc4(0x1bf)]=_0x4590cd;}),_0x36f2['forEach']((_0x25d2f6,_0x14dbc7)=>{var _0xbddab7=_0x58a715;_0x1e933c[_0x14dbc7][_0xbddab7(0x14d)]=_0x25d2f6;}),_0x352988[_0x58a715(0x1eb)]((_0x5b0578,_0x32b72b)=>{_0x1e933c[_0x32b72b]['production_date']=_0x5b0578;}),_0x4b8b52['forEach']((_0x45ca94,_0x37ec34)=>{var _0x439943=_0x58a715;_0x1e933c[_0x37ec34][_0x439943(0x1b5)]=_0x45ca94;}),_0x18fa38[_0x58a715(0x1eb)]((_0x1c110c,_0x1dbfe3)=>{var _0x58c55a=_0x58a715;_0x1e933c[_0x1dbfe3][_0x58c55a(0x14f)]=_0x1c110c;}),_0x295d24[_0x58a715(0x1eb)]((_0x2091ec,_0x4cc71b)=>{var _0x5c33c6=_0x58a715;_0x1e933c[_0x4cc71b][_0x5c33c6(0x134)]=_0x2091ec;}),_0x237924[_0x58a715(0x1eb)]((_0x33c942,_0x2395b1)=>{var _0x919bce=_0x58a715;_0x1e933c[_0x2395b1][_0x919bce(0x13a)]=_0x33c942;}),_0x52c9b8[_0x58a715(0x1eb)]((_0x4be3d1,_0x5a8ddf)=>{var _0x501ec9=_0x58a715;_0x1e933c[_0x5a8ddf][_0x501ec9(0x19c)]=_0x4be3d1;});const _0x2939bb=_0x1e933c[_0x58a715(0x1a6)](_0x140610=>_0x140610['adjust_qty']!=='0'&&_0x140610['adjust_qty']!=='');var _0x1acb8b=0x0;_0x2939bb[_0x58a715(0x1eb)](_0x2860fb=>{var _0x37b77f=_0x58a715;console[_0x37b77f(0x17d)](_0x37b77f(0x18c),_0x2860fb),parseInt(_0x2860fb[_0x37b77f(0x196)])<=0x0&&_0x1acb8b++;});if(_0x1acb8b!=0x0)return _0x722e00[_0x58a715(0x160)]('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x20ae21[_0x58a715(0x19f)](_0x58a715(0x153));const _0x428c87=new adjustment({'warehouse_name':_0x5d4ab0,'date':_0x31a41c,'product':_0x2939bb,'note':_0x1ba645,'room':_0x19715b,'invoice':_0x1626c4,'JO_number':_0x37bdc3,'expiry_date':_0x18b6e9}),_0x361cdc=await _0x428c87['save']();_0x722e00[_0x58a715(0x160)](_0x58a715(0x14c),_0x58a715(0x1c0)),_0x20ae21['redirect'](_0x58a715(0x1cc)+_0x361cdc[_0x58a715(0x1a7)]);}catch(_0x3a8986){console[_0x58a715(0x17d)](_0x3a8986),_0x20ae21[_0x58a715(0x149)](0xc8)[_0x58a715(0x15a)]({'message':_0x3a8986[_0x58a715(0x1a9)]});}}),router[a0_0x1f8ae7(0x131)](a0_0x1f8ae7(0x168),auth,async(_0xd97dc2,_0x5b6d45)=>{var _0x3f29d3=a0_0x1f8ae7;try{const {username:_0x26ad82,email:_0x528741,role:_0x28269b}=_0xd97dc2['user'],_0x4ab1ef=_0xd97dc2[_0x3f29d3(0x1d9)],_0x17a398=await profile['findOne']({'email':_0x4ab1ef['email']}),_0x145b93=await master_shop['find'](),_0x5d04b2=_0xd97dc2[_0x3f29d3(0x13f)]['id'],_0x92b245=await adjustment[_0x3f29d3(0x128)]({'_id':_0x5d04b2}),_0x1c6983=await purchases[_0x3f29d3(0x129)]([{'$match':{'warehouse_name':_0x92b245[_0x3f29d3(0x1c1)]}},{'$unwind':'$product'},{'$group':{'_id':_0x3f29d3(0x1bd)}}]),_0xe983a1=await product['find']({}),_0x1729ce=await warehouse[_0x3f29d3(0x129)]([{'$match':{'name':_0x92b245['warehouse_name']}},{'$unwind':_0x3f29d3(0x163)},{'$group':{'_id':_0x3f29d3(0x18b),'name':{'$first':_0x3f29d3(0x1b2)},'product_stock':{'$first':_0x3f29d3(0x140)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3f29d3(0x167)},'floorlevel':{'$first':_0x3f29d3(0x15b)},'primary_code':{'$first':_0x3f29d3(0x1ce)},'secondary_code':{'$first':_0x3f29d3(0x1e6)},'product_code':{'$first':_0x3f29d3(0x1dd)},'storage':{'$first':_0x3f29d3(0x164)},'rack':{'$first':_0x3f29d3(0x142)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x3f29d3(0x1c3)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);if(_0x145b93[0x0][_0x3f29d3(0x197)]=='English\x20(US)'){var _0x1916b6=users['English'];console[_0x3f29d3(0x17d)](_0x1916b6);}else{if(_0x145b93[0x0][_0x3f29d3(0x197)]=='Hindi')var _0x1916b6=users[_0x3f29d3(0x19e)];else{if(_0x145b93[0x0][_0x3f29d3(0x197)]==_0x3f29d3(0x1b9))var _0x1916b6=users[_0x3f29d3(0x1b9)];else{if(_0x145b93[0x0][_0x3f29d3(0x197)]==_0x3f29d3(0x1c2))var _0x1916b6=users[_0x3f29d3(0x1c2)];else{if(_0x145b93[0x0]['language']=='French')var _0x1916b6=users[_0x3f29d3(0x1ad)];else{if(_0x145b93[0x0][_0x3f29d3(0x197)]=='Portuguese\x20(BR)')var _0x1916b6=users[_0x3f29d3(0x193)];else{if(_0x145b93[0x0][_0x3f29d3(0x197)]==_0x3f29d3(0x11b))var _0x1916b6=users['Chinese'];else{if(_0x145b93[0x0][_0x3f29d3(0x197)]=='Arabic\x20(ae)')var _0x1916b6=users[_0x3f29d3(0x1c8)];}}}}}}}_0x5b6d45[_0x3f29d3(0x15d)](_0x3f29d3(0x11d),{'success':_0xd97dc2[_0x3f29d3(0x160)](_0x3f29d3(0x14c)),'errors':_0xd97dc2['flash'](_0x3f29d3(0x161)),'role':_0x4ab1ef,'profile':_0x17a398,'adjustment':_0x92b245,'stock':_0x1729ce,'master_shop':_0x145b93,'warehouse_name':_0x1c6983,'unit':_0xe983a1,'language':_0x1916b6});}catch(_0x5034f2){console[_0x3f29d3(0x17d)](_0x5034f2),_0x5b6d45[_0x3f29d3(0x149)](0xc8)[_0x3f29d3(0x15a)]({'message':_0x5034f2[_0x3f29d3(0x1a9)]});}}),router['post'](a0_0x1f8ae7(0x168),auth,async(_0x1bc3f5,_0x4d6617)=>{var _0x28af86=a0_0x1f8ae7;try{const _0x35e1c7=_0x1bc3f5[_0x28af86(0x13f)]['id'],{warehouse_name:_0x3c8b41,Room_name:_0x2df06f}=_0x1bc3f5[_0x28af86(0x1df)],_0x29a4c1=await adjustment['findById']({'_id':_0x35e1c7}),_0x207b3b=_0x29a4c1[_0x28af86(0x1b7)][_0x28af86(0x1de)](async _0x190bb=>{var _0x2f149e=_0x28af86;if(_0x190bb[_0x2f149e(0x196)]>0x0){var _0x78d02e=await warehouse[_0x2f149e(0x1e2)]({'name':_0x3c8b41,'room':_0x190bb[_0x2f149e(0x14f)],'warehouse_category':'Raw\x20Materials'});const _0x30c4d9=_0x78d02e[_0x2f149e(0x1c6)][_0x2f149e(0x1de)](_0x4129f9=>{var _0x26112e=_0x2f149e;console['log'](_0x190bb['types']+_0x26112e(0x1b0));if(_0x190bb['types']=='minus'){if(_0x4129f9['product_name']==_0x190bb[_0x26112e(0x16b)]&&_0x4129f9[_0x26112e(0x1a3)]==_0x190bb['floorlevel']&&_0x4129f9['type']==_0x190bb['type']&&_0x4129f9[_0x26112e(0x158)]==_0x190bb[_0x26112e(0x158)]&&_0x4129f9[_0x26112e(0x11e)]==_0x190bb[_0x26112e(0x11e)]&&_0x4129f9['rack']==_0x190bb['rack']&&_0x4129f9[_0x26112e(0x16a)]==_0x190bb['storage']&&_0x4129f9[_0x26112e(0x1bf)]==_0x190bb[_0x26112e(0x1bf)]&&_0x4129f9[_0x26112e(0x19d)]==_0x190bb['batch_code']&&_0x4129f9[_0x26112e(0x179)]==_0x190bb[_0x26112e(0x179)]&&_0x4129f9['invoice']==_0x190bb['invoice']&&_0x4129f9[_0x26112e(0x1a7)]==_0x190bb[_0x26112e(0x198)]){var _0xc3631f;_0xc3631f=_0x190bb['adjust_qty'],_0x190bb['prod_cat']=='S'&&(_0xc3631f=_0x190bb[_0x26112e(0x196)]),_0x4129f9[_0x26112e(0x194)]=_0x4129f9[_0x26112e(0x194)]-_0xc3631f;}}else{if(_0x4129f9['product_name']==_0x190bb[_0x26112e(0x16b)]&&_0x4129f9[_0x26112e(0x1a3)]==_0x190bb[_0x26112e(0x1a3)]&&_0x4129f9[_0x26112e(0x1d8)]==_0x190bb['type']&&_0x4129f9['bin']==_0x190bb[_0x26112e(0x158)]&&_0x4129f9[_0x26112e(0x11e)]==_0x190bb['bay']&&_0x4129f9['rack']==_0x190bb[_0x26112e(0x18e)]&&_0x4129f9[_0x26112e(0x16a)]==_0x190bb[_0x26112e(0x16a)]&&_0x4129f9[_0x26112e(0x1bf)]==_0x190bb[_0x26112e(0x1bf)]&&_0x4129f9[_0x26112e(0x19d)]==_0x190bb[_0x26112e(0x19d)]&&_0x4129f9['production_date']==_0x190bb[_0x26112e(0x179)]&&_0x4129f9[_0x26112e(0x19c)]==_0x190bb[_0x26112e(0x19c)]&&_0x4129f9[_0x26112e(0x1a7)]==_0x190bb[_0x26112e(0x198)]){console['log'](_0x190bb);var _0xc3631f;_0xc3631f=_0x190bb[_0x26112e(0x196)],_0x190bb[_0x26112e(0x1b5)]=='S'&&(_0xc3631f=_0x190bb[_0x26112e(0x196)]),_0x4129f9[_0x26112e(0x194)]=_0x4129f9[_0x26112e(0x194)]+_0xc3631f;}}});}return _0x78d02e;});Promise[_0x28af86(0x132)](_0x207b3b)['then'](async _0x5a1a65=>{var _0x14849b=_0x28af86;try{for(const _0x376ff1 of _0x5a1a65){await _0x376ff1['save']();}_0x29a4c1['finalize']=_0x14849b(0x15e);const _0x475ce9=await _0x29a4c1[_0x14849b(0x155)](),_0x6a886b=await master_shop[_0x14849b(0x121)](),_0x387f0f=await email_settings['findOne'](),_0x2a6d04=await supervisor_settings[_0x14849b(0x121)]();var _0x2f0399=_0x29a4c1[_0x14849b(0x1b7)],_0x50be9c='',_0x51bad0;for(_0x51bad0 in _0x2f0399){_0x50be9c+=_0x14849b(0x1ec)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2f0399[_0x51bad0][_0x14849b(0x16b)]+_0x14849b(0x195)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2f0399[_0x51bad0][_0x14849b(0x13e)]+_0x14849b(0x195)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2f0399[_0x51bad0][_0x14849b(0x196)]+'</td>'+_0x14849b(0x1dc)+_0x2f0399[_0x51bad0][_0x14849b(0x13d)]+_0x14849b(0x195)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2f0399[_0x51bad0][_0x14849b(0x122)]+'</td>'+_0x14849b(0x1dc)+_0x29a4c1[_0x14849b(0x1c1)]+_0x14849b(0x195)+_0x14849b(0x1dc)+_0x2f0399[_0x51bad0][_0x14849b(0x14f)]+_0x14849b(0x195)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2f0399[_0x51bad0][_0x14849b(0x16a)]+_0x2f0399[_0x51bad0][_0x14849b(0x18e)]+_0x2f0399[_0x51bad0][_0x14849b(0x11e)]+_0x2f0399[_0x51bad0]['bin']+_0x2f0399[_0x51bad0][_0x14849b(0x1d8)][0x0]+_0x2f0399[_0x51bad0][_0x14849b(0x1a3)]+_0x14849b(0x195),_0x14849b(0x11f);}let _0x5a2382=nodemailer[_0x14849b(0x1da)]({'host':_0x387f0f[_0x14849b(0x190)],'port':Number(_0x387f0f[_0x14849b(0x1e9)]),'secure':![],'auth':{'user':_0x387f0f['email'],'pass':_0x387f0f['password']}}),_0x401e20={'from':_0x387f0f[_0x14849b(0x1a2)],'to':_0x2a6d04[0x0]['RMSEmail'],'subject':_0x14849b(0x17e),'attachments':[{'filename':'Logo.png','path':__dirname+_0x14849b(0x17f)+_0x14849b(0x169)+_0x6a886b[0x0][_0x14849b(0x139)],'cid':_0x14849b(0x11a)}],'html':_0x14849b(0x1a5)+_0x14849b(0x1c9)+_0x14849b(0x16e)+_0x14849b(0x14e)+_0x14849b(0x147)+_0x14849b(0x14e)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x14849b(0x1e0)+_0x14849b(0x14e)+_0x14849b(0x1cb)+_0x6a886b[0x0]['site_title']+'\x20</h2>'+_0x14849b(0x1e0)+_0x14849b(0x1e0)+'<hr\x20class=\x22my-3\x22>'+_0x14849b(0x14e)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x14849b(0x17b)+_0x29a4c1[_0x14849b(0x19c)]+'\x20'+_0x14849b(0x185)+'\x20Order\x20Date\x20:\x20'+_0x29a4c1['date']+'\x20'+_0x14849b(0x1d3)+_0x14849b(0x1e3)+_0x14849b(0x1e0)+_0x14849b(0x1d5)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x14849b(0x12b)+_0x14849b(0x16c)+_0x14849b(0x173)+_0x14849b(0x1c4)+_0x14849b(0x182)+_0x14849b(0x1c5)+_0x14849b(0x1e7)+_0x14849b(0x126)+'</tr>'+'</thead>'+_0x14849b(0x152)+'\x20'+_0x50be9c+'\x20'+'</tbody>'+_0x14849b(0x1bc)+_0x14849b(0x14e)+'<strong>\x20Regards\x20</strong>'+_0x14849b(0x124)+_0x6a886b[0x0]['site_title']+'</h5>'+_0x14849b(0x1e0)+_0x14849b(0x1e0)+'</body></html>'};_0x5a2382['sendMail'](_0x401e20,function(_0x5ab14d,_0x305e75){var _0x54c7aa=_0x14849b;_0x5ab14d?(console[_0x54c7aa(0x17d)](_0x5ab14d),console['log'](_0x54c7aa(0x1e8))):console[_0x54c7aa(0x17d)](_0x54c7aa(0x186));}),_0x1bc3f5[_0x14849b(0x160)]('success','adjustment\x20Finalized\x20successfully'),_0x4d6617[_0x14849b(0x19f)](_0x14849b(0x175)+_0x475ce9['_id']);}catch(_0x5e2f1e){console['error'](_0x5e2f1e),_0x4d6617[_0x14849b(0x149)](0x1f4)[_0x14849b(0x15a)]({'error':_0x14849b(0x1ca)});}})['catch'](_0x2c447d=>{var _0x6a90db=_0x28af86;console[_0x6a90db(0x174)](_0x2c447d),_0x4d6617[_0x6a90db(0x149)](0x1f4)['json']({'error':_0x6a90db(0x1bb)});});}catch(_0x2dd8b6){console[_0x28af86(0x17d)](_0x2dd8b6),_0x4d6617[_0x28af86(0x149)](0xc8)[_0x28af86(0x15a)]({'message':_0x2dd8b6['message']});}}),router[a0_0x1f8ae7(0x131)](a0_0x1f8ae7(0x120),auth,async(_0xb99c0e,_0x1ff1d4)=>{var _0x1408c8=a0_0x1f8ae7;try{const {username:_0x6f73e6,email:_0x3fd9dd,role:_0x1bae02}=_0xb99c0e[_0x1408c8(0x1d9)],_0x426071=_0xb99c0e[_0x1408c8(0x1d9)],_0x1c5b86=await profile[_0x1408c8(0x1e2)]({'email':_0x426071[_0x1408c8(0x1a2)]}),_0x395ea4=await master_shop[_0x1408c8(0x121)](),_0xcfc5ce=_0xb99c0e[_0x1408c8(0x13f)]['id'],_0x131614=await adjustment['findById']({'_id':_0xcfc5ce}),_0x3c508b=await purchases['aggregate']([{'$match':{'warehouse_name':_0x131614[_0x1408c8(0x1c1)]}},{'$unwind':_0x1408c8(0x19a)},{'$group':{'_id':'$product.product_name'}}]),_0x478e25=await product[_0x1408c8(0x121)]({}),_0x4a01ca=await warehouse['aggregate']([{'$match':{'name':_0x131614['warehouse_name']}},{'$unwind':_0x1408c8(0x163)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1408c8(0x1b2)},'product_stock':{'$first':_0x1408c8(0x140)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x1408c8(0x167)},'floorlevel':{'$first':_0x1408c8(0x15b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1408c8(0x1e6)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1408c8(0x142)},'maxPerUnit':{'$first':_0x1408c8(0x166)},'expiry_date':{'$first':_0x1408c8(0x1c3)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1408c8(0x11c)},'room':{'$first':_0x1408c8(0x1d6)}}}]);let _0x5c5633;if(_0x426071[_0x1408c8(0x18a)]==_0x1408c8(0x1aa)){const _0x26d3be=await staff[_0x1408c8(0x1e2)]({'email':_0x426071[_0x1408c8(0x1a2)]});_0x5c5633=await warehouse[_0x1408c8(0x129)]([{'$match':{'status':_0x1408c8(0x177),'name':_0x26d3be[_0x1408c8(0x13c)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x1408c8(0x1a4)}}},{'$group':{'_id':_0x1408c8(0x1ea),'name':{'$first':_0x1408c8(0x1ea)}}}]);}else _0x5c5633=await warehouse[_0x1408c8(0x129)]([{'$match':{'status':_0x1408c8(0x177),'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x1408c8(0x1ea),'name':{'$first':_0x1408c8(0x1ea)}}}]);if(_0x395ea4[0x0][_0x1408c8(0x197)]==_0x1408c8(0x191)){var _0x69fcc4=users['English'];console[_0x1408c8(0x17d)](_0x69fcc4);}else{if(_0x395ea4[0x0][_0x1408c8(0x197)]==_0x1408c8(0x19e))var _0x69fcc4=users[_0x1408c8(0x19e)];else{if(_0x395ea4[0x0][_0x1408c8(0x197)]==_0x1408c8(0x1b9))var _0x69fcc4=users[_0x1408c8(0x1b9)];else{if(_0x395ea4[0x0]['language']==_0x1408c8(0x1c2))var _0x69fcc4=users[_0x1408c8(0x1c2)];else{if(_0x395ea4[0x0]['language']=='French')var _0x69fcc4=users[_0x1408c8(0x1ad)];else{if(_0x395ea4[0x0][_0x1408c8(0x197)]=='Portuguese\x20(BR)')var _0x69fcc4=users['Portuguese'];else{if(_0x395ea4[0x0][_0x1408c8(0x197)]==_0x1408c8(0x11b))var _0x69fcc4=users[_0x1408c8(0x11b)];else{if(_0x395ea4[0x0][_0x1408c8(0x197)]=='Arabic\x20(ae)')var _0x69fcc4=users[_0x1408c8(0x1c8)];}}}}}}}_0x1ff1d4['render'](_0x1408c8(0x1d0),{'success':_0xb99c0e[_0x1408c8(0x160)](_0x1408c8(0x14c)),'errors':_0xb99c0e[_0x1408c8(0x160)](_0x1408c8(0x161)),'role':_0x426071,'profile':_0x1c5b86,'adjustment':_0x131614,'stock':_0x4a01ca,'master_shop':_0x395ea4,'warehouse_name':_0x3c508b,'unit':_0x478e25,'language':_0x69fcc4,'warehouse':_0x5c5633});}catch(_0x3fcd1f){console[_0x1408c8(0x17d)](_0x3fcd1f),_0x1ff1d4[_0x1408c8(0x149)](0xc8)[_0x1408c8(0x15a)]({'message':_0x3fcd1f[_0x1408c8(0x1a9)]});}}),router[a0_0x1f8ae7(0x18f)](a0_0x1f8ae7(0x120),auth,async(_0x169926,_0x507a5a)=>{var _0x5a5490=a0_0x1f8ae7;try{const _0x28647d=_0x169926[_0x5a5490(0x13f)]['id'],_0x52cdbf=await adjustment[_0x5a5490(0x128)]({'_id':_0x28647d}),_0x2a7003=await warehouse[_0x5a5490(0x1e2)]({'name':_0x52cdbf[_0x5a5490(0x1c1)],'room':_0x52cdbf[_0x5a5490(0x16f)]}),{warehouse_name:_0x3af2f3,date:_0x158129,prod_name:_0x3c43a4,level:_0x4645d0,isle:_0x93e8eb,pallet:_0x1a8442,stock:_0x387e47,types:_0x368b45,adjust_qty:_0x54531b,new_adjust_qty:_0x34ecf6,note:_0x326a4d,Room_name:_0x369ed3,invoice:_0x5a355c,JO_number:_0x417da1,expiry_date:_0x534161}=_0x169926['body'];if(typeof _0x3c43a4==_0x5a5490(0x1b1))var _0xd79873=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x1c7)]],_0x3c66c0=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x1db)]],_0x1f4c44=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x1af)]],_0x4adbed=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x1be)]],_0x4de528=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x1d7)]],_0x397491=[_0x169926[_0x5a5490(0x1df)]['New_Qty_Converted']],_0x3f857f=[_0x169926['body'][_0x5a5490(0x144)]],_0x7d2753=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x150)]],_0x3f915e=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x184)]],_0x37d02b=[_0x169926['body'][_0x5a5490(0x19d)]],_0x2a288b=[_0x169926['body'][_0x5a5490(0x1bf)]],_0x106811=[_0x169926[_0x5a5490(0x1df)]['max_per_unit']],_0x3abdc3=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x179)]],_0x8b325f=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x1b5)]],_0x7c541e=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x15c)]],_0xf2664c=[_0x169926[_0x5a5490(0x1df)][_0x5a5490(0x192)]],_0x177c47=[_0x169926['body'][_0x5a5490(0x130)]];else var _0xd79873=[..._0x169926['body']['prod_name']],_0x3c66c0=[..._0x169926['body'][_0x5a5490(0x1db)]],_0x1f4c44=[..._0x169926['body'][_0x5a5490(0x1af)]],_0x4adbed=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x1be)]],_0x4de528=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x1d7)]],_0x397491=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x136)]],_0x3f857f=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x13d)]],_0x7d2753=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x150)]],_0x3f915e=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x184)]],_0x37d02b=[..._0x169926[_0x5a5490(0x1df)]['batch_code']],_0x2a288b=[..._0x169926['body'][_0x5a5490(0x1bf)]],_0x106811=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x176)]],_0x3abdc3=[..._0x169926['body'][_0x5a5490(0x179)]],_0x8b325f=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x1b5)]],_0x7c541e=[..._0x169926[_0x5a5490(0x1df)]['Rooms']],_0xf2664c=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x192)]],_0x177c47=[..._0x169926[_0x5a5490(0x1df)][_0x5a5490(0x130)]];const _0xbc1fbd=_0xd79873[_0x5a5490(0x1de)](_0x1aa2aa=>{return _0x1aa2aa={'product_name':_0x1aa2aa};});_0x3c66c0[_0x5a5490(0x1eb)]((_0x5979e3,_0x9801a6)=>{var _0x261ef5=_0x5a5490;_0x7c541e[_0x261ef5(0x1eb)]((_0x3fbd16,_0x278e7c)=>{var _0x5a2d16=_0x261ef5;if(_0x3fbd16==_0x5a2d16(0x137)&&_0x9801a6==_0x278e7c){var _0x17d8d3=_0x5979e3[_0x5a2d16(0x154)](0x3);_0xbc1fbd[_0x9801a6][_0x5a2d16(0x16a)]=_0x5979e3[0x0],_0xbc1fbd[_0x9801a6][_0x5a2d16(0x18e)]=_0x5979e3[0x1],_0xbc1fbd[_0x9801a6][_0x5a2d16(0x11e)]=0x0,_0xbc1fbd[_0x9801a6][_0x5a2d16(0x158)]=0x0,_0xbc1fbd[_0x9801a6]['type']=_0x5a2d16(0x172),_0xbc1fbd[_0x9801a6]['floorlevel']=_0x17d8d3;}else{if(_0x3fbd16==_0x5a2d16(0x12e)&&_0x9801a6==_0x278e7c){var _0x17d8d3=_0x5979e3['slice'](0x3);_0xbc1fbd[_0x9801a6][_0x5a2d16(0x16a)]=_0x5979e3[0x0],_0xbc1fbd[_0x9801a6][_0x5a2d16(0x18e)]=_0x5979e3[0x1],_0xbc1fbd[_0x9801a6][_0x5a2d16(0x11e)]=0x0,_0xbc1fbd[_0x9801a6][_0x5a2d16(0x158)]=0x0,_0xbc1fbd[_0x9801a6][_0x5a2d16(0x1d8)]=_0x5a2d16(0x172),_0xbc1fbd[_0x9801a6][_0x5a2d16(0x1a3)]=_0x5979e3[0x5];}else{if(_0x9801a6==_0x278e7c){var _0x15a9f4;if(_0x5979e3[0x4]=='L')_0x15a9f4='Level';else _0x5979e3[0x4]=='F'&&(_0x15a9f4=_0x5a2d16(0x172));_0xbc1fbd[_0x9801a6]['storage']=_0x5979e3[0x0],_0xbc1fbd[_0x9801a6]['rack']=_0x5979e3[0x1],_0xbc1fbd[_0x9801a6][_0x5a2d16(0x11e)]=_0x5979e3[0x2],_0xbc1fbd[_0x9801a6][_0x5a2d16(0x158)]=_0x5979e3[0x3],_0xbc1fbd[_0x9801a6][_0x5a2d16(0x1d8)]=_0x15a9f4,_0xbc1fbd[_0x9801a6][_0x5a2d16(0x1a3)]=_0x5979e3[0x5];}}}});}),_0x1f4c44['forEach']((_0x31b065,_0x5251d6)=>{var _0x252344=_0x5a5490;_0xbc1fbd[_0x5251d6][_0x252344(0x18d)]=_0x31b065;}),_0x4adbed[_0x5a5490(0x1eb)]((_0x21a4d3,_0x3a1f55)=>{var _0x1b6c08=_0x5a5490;_0xbc1fbd[_0x3a1f55][_0x1b6c08(0x1be)]=_0x21a4d3;}),_0x4de528[_0x5a5490(0x1eb)]((_0x44494d,_0x2efe06)=>{_0xbc1fbd[_0x2efe06]['adjust_qty']=_0x44494d;}),_0x397491[_0x5a5490(0x1eb)]((_0x1a0201,_0x2c5473)=>{var _0x264efa=_0x5a5490;_0xbc1fbd[_0x2c5473][_0x264efa(0x1ac)]=_0x1a0201;}),_0x3f857f[_0x5a5490(0x1eb)]((_0xe1c526,_0x12718d)=>{_0xbc1fbd[_0x12718d]['unit']=_0xe1c526;}),_0x7d2753[_0x5a5490(0x1eb)]((_0x35e8e1,_0x377150)=>{var _0x21d168=_0x5a5490;_0xbc1fbd[_0x377150][_0x21d168(0x122)]=_0x35e8e1;}),_0x3f915e[_0x5a5490(0x1eb)]((_0x1fa5ac,_0x32017e)=>{var _0x15412e=_0x5a5490;_0xbc1fbd[_0x32017e][_0x15412e(0x13e)]=_0x1fa5ac;}),_0x37d02b[_0x5a5490(0x1eb)]((_0x218008,_0x49a095)=>{var _0x5c3f05=_0x5a5490;_0xbc1fbd[_0x49a095][_0x5c3f05(0x19d)]=_0x218008;}),_0x2a288b['forEach']((_0x209362,_0x8c5d72)=>{var _0x391070=_0x5a5490;_0xbc1fbd[_0x8c5d72][_0x391070(0x1bf)]=_0x209362;}),_0x106811[_0x5a5490(0x1eb)]((_0x433531,_0x4cc0a4)=>{var _0x3dcd20=_0x5a5490;_0xbc1fbd[_0x4cc0a4][_0x3dcd20(0x14d)]=_0x433531;}),_0x3abdc3[_0x5a5490(0x1eb)]((_0x179d28,_0x1aa405)=>{var _0x5c371b=_0x5a5490;_0xbc1fbd[_0x1aa405][_0x5c371b(0x179)]=_0x179d28;}),_0x8b325f['forEach']((_0x37e1e7,_0x12d4d6)=>{var _0x20a789=_0x5a5490;_0xbc1fbd[_0x12d4d6][_0x20a789(0x1b5)]=_0x37e1e7;}),_0x7c541e[_0x5a5490(0x1eb)]((_0xfa8355,_0xe11632)=>{var _0x1ddc9a=_0x5a5490;_0xbc1fbd[_0xe11632][_0x1ddc9a(0x14f)]=_0xfa8355;}),_0xf2664c['forEach']((_0x2c2fa0,_0x17f887)=>{var _0x4dab27=_0x5a5490;_0xbc1fbd[_0x17f887][_0x4dab27(0x134)]=_0x2c2fa0;}),_0x177c47['forEach']((_0x448156,_0x5722e2)=>{var _0x4c0c9f=_0x5a5490;_0xbc1fbd[_0x5722e2][_0x4c0c9f(0x13a)]=_0x448156;});const _0x4d545f=_0xbc1fbd['filter'](_0x512202=>_0x512202[_0x5a5490(0x196)]!=='0'&&_0x512202[_0x5a5490(0x196)]!=='');var _0x3cf086=0x0;_0x4d545f[_0x5a5490(0x1eb)](_0x1795d9=>{var _0x44f719=_0x5a5490;console['log'](_0x44f719(0x18c),_0x1795d9),parseInt(_0x1795d9['adjust_qty'])<=0x0&&_0x3cf086++;});if(_0x3cf086!=0x0)return _0x169926[_0x5a5490(0x160)](_0x5a5490(0x161),_0x5a5490(0x1d2)),_0x507a5a[_0x5a5490(0x19f)]('back');_0x52cdbf[_0x5a5490(0x1c1)]=_0x3af2f3,_0x52cdbf[_0x5a5490(0x12f)]=_0x158129,_0x52cdbf['product']=_0x4d545f,_0x52cdbf[_0x5a5490(0x125)]=_0x326a4d,_0x52cdbf[_0x5a5490(0x19c)]=_0x5a355c,_0x52cdbf[_0x5a5490(0x157)]=_0x5a5490(0x146);const _0x36f1dd=await _0x52cdbf[_0x5a5490(0x155)]();_0x169926[_0x5a5490(0x160)](_0x5a5490(0x14c),_0x5a5490(0x1b3)),_0x507a5a[_0x5a5490(0x19f)](_0x5a5490(0x178));}catch(_0x9b48c7){console['log'](_0x9b48c7);}}),router['post']('/barcode_scanner',async(_0x10592f,_0x4477ce)=>{var _0x14b465=a0_0x1f8ae7;const {primary_code:_0x47d714,warehouse_data:_0x37cf26,rooms_data:_0x38573a,Roomslist:_0x4f52c8}=_0x10592f[_0x14b465(0x1df)],_0x3adc9b=_0x4f52c8[_0x14b465(0x133)](','),_0x1aa286=[];async function _0x11139b(_0x3f8585){var _0x358098=_0x14b465;const _0x5e26a2=await warehouse[_0x358098(0x129)]([{'$match':{'name':_0x37cf26,'room':_0x3f8585}},{'$unwind':_0x358098(0x163)},{'$match':{'product_details.primary_code':_0x47d714}},{'$group':{'_id':_0x358098(0x18b),'name':{'$first':_0x358098(0x1b2)},'product_stock':{'$first':_0x358098(0x140)},'primary_code':{'$first':_0x358098(0x1ce)},'secondary_code':{'$first':_0x358098(0x1e6)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x358098(0x199)},'isle':{'$first':_0x358098(0x148)},'type':{'$first':_0x358098(0x167)},'pallet':{'$first':_0x358098(0x15b)},'unit':{'$first':_0x358098(0x1e5)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x358098(0x164)},'rack':{'$first':_0x358098(0x142)},'expiry_date':{'$first':_0x358098(0x1c3)},'production_date':{'$first':_0x358098(0x181)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x358098(0x11c)},'product_cat':{'$first':_0x358098(0x141)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x358098(0x1d6)},'invoice':{'$first':_0x358098(0x1cf)}}}]),_0xeef499=await warehouse['aggregate']([{'$match':{'name':_0x37cf26,'room':_0x3f8585}},{'$unwind':_0x358098(0x163)},{'$match':{'product_details.secondary_code':_0x47d714}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x358098(0x140)},'primary_code':{'$first':_0x358098(0x1ce)},'secondary_code':{'$first':_0x358098(0x1e6)},'product_code':{'$first':_0x358098(0x1dd)},'level':{'$first':_0x358098(0x199)},'isle':{'$first':_0x358098(0x148)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x358098(0x15b)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x358098(0x17a)},'storage':{'$first':_0x358098(0x164)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x358098(0x141)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x358098(0x1d6)}}}]);if(_0x5e26a2['length']>0x0)_0x1aa286[_0x358098(0x12d)](_0x5e26a2);else _0xeef499['length']>0x0&&_0x1aa286[_0x358098(0x12d)](_0xeef499);}const _0xe3e1fe=_0x3adc9b['map'](_0x403014=>_0x11139b(_0x403014));await Promise['all'](_0xe3e1fe),_0x4477ce[_0x14b465(0x15a)](_0x1aa286);}),router['post']('/CheckingWarehouse',async(_0x3a3eab,_0x2f8d08)=>{var _0x178694=a0_0x1f8ae7;const {primaryCode:_0x39224b,secondaryCode:_0x59e3d1,productCode:_0x8ab792,level:_0x284baf,isle:_0x6a02e8,pallet:_0x82b4c1,warehouses:_0x297f8a,room:_0x56e1c5}=_0x3a3eab[_0x178694(0x1df)];try{const _0xe194b7=await warehouse[_0x178694(0x129)]([{'$match':{'name':_0x297f8a,'room':_0x56e1c5}},{'$unwind':_0x178694(0x163)},{'$match':{'product_details.level':parseInt(_0x284baf),'product_details.isle':_0x6a02e8,'product_details.pallet':parseInt(_0x82b4c1)}},{'$group':{'_id':_0x178694(0x18b),'name':{'$first':_0x178694(0x1b2)},'product_stock':{'$first':_0x178694(0x140)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x178694(0x1b6)},'pallet':{'$first':_0x178694(0x16d)},'maxProducts':{'$first':_0x178694(0x1d1)}}}]);_0x2f8d08[_0x178694(0x149)](0xc8)[_0x178694(0x15a)](_0xe194b7);}catch(_0x4aaadb){_0x2f8d08['status'](0x194)[_0x178694(0x15a)]({'message':_0x4aaadb[_0x178694(0x1a9)]});}}),module[a0_0x1f8ae7(0x165)]=router;