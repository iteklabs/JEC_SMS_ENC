var a0_0x4c336d=a0_0x35d5;(function(_0x40f720,_0x179977){var _0x1f62d6=a0_0x35d5,_0x5c6d1f=_0x40f720();while(!![]){try{var _0x46c31d=-parseInt(_0x1f62d6(0x102))/0x1*(parseInt(_0x1f62d6(0xa7))/0x2)+-parseInt(_0x1f62d6(0xed))/0x3+parseInt(_0x1f62d6(0x14a))/0x4*(-parseInt(_0x1f62d6(0xf3))/0x5)+-parseInt(_0x1f62d6(0x103))/0x6*(parseInt(_0x1f62d6(0x141))/0x7)+parseInt(_0x1f62d6(0x10f))/0x8*(parseInt(_0x1f62d6(0xe0))/0x9)+-parseInt(_0x1f62d6(0xdb))/0xa*(parseInt(_0x1f62d6(0x152))/0xb)+parseInt(_0x1f62d6(0xf6))/0xc*(parseInt(_0x1f62d6(0x13c))/0xd);if(_0x46c31d===_0x179977)break;else _0x5c6d1f['push'](_0x5c6d1f['shift']());}catch(_0x17c629){_0x5c6d1f['push'](_0x5c6d1f['shift']());}}}(a0_0x706c,0xb671a));const express=require(a0_0x4c336d(0x116)),app=express(),router=express[a0_0x4c336d(0xc4)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_logs,adjustment_finished,email_settings,supervisor_settings,invoice_for_adjustment}=require(a0_0x4c336d(0x142)),users=require(a0_0x4c336d(0x106)),nodemailer=require('nodemailer');router[a0_0x4c336d(0x132)](a0_0x4c336d(0xb7),auth,async(_0x25b040,_0x3a4988)=>{var _0x6453ef=a0_0x4c336d;try{const {username:_0xfb5a75,email:_0x329beb,role:_0x38bc94}=_0x25b040[_0x6453ef(0x143)],_0x286c53=_0x25b040[_0x6453ef(0x143)],_0x2f6a0a=await profile[_0x6453ef(0x134)]({'email':_0x286c53[_0x6453ef(0x11f)]}),_0x160d92=await master_shop['find']();let _0x4591af;if(_0x286c53[_0x6453ef(0x11c)]==_0x6453ef(0xb9)){const _0xa9ecf0=await staff['findOne']({'email':_0x286c53[_0x6453ef(0x11f)]});_0x4591af=await warehouse[_0x6453ef(0xff)]({'status':'Enabled','name':_0xa9ecf0[_0x6453ef(0x147)]});}else _0x4591af=await warehouse['find']({'status':_0x6453ef(0x135)});const _0x2f079d=await product[_0x6453ef(0xff)]();let _0x28db14;if(_0x286c53[_0x6453ef(0x11c)]==_0x6453ef(0xb9)){const _0x4d740e=await staff[_0x6453ef(0x134)]({'email':_0x286c53[_0x6453ef(0x11f)]});_0x28db14=await adjustment_finished['find']({'warehouse_name':_0x4d740e['warehouse']});}else _0x28db14=await adjustment_finished[_0x6453ef(0xf2)]([{'$match':{'type_of_transaction':_0x6453ef(0x14f)}},{'$unwind':'$product'},{'$group':{'_id':_0x6453ef(0x12e),'invoice':{'$first':_0x6453ef(0xb1)},'date':{'$first':_0x6453ef(0xdf)},'warehouse_name':{'$first':_0x6453ef(0xe2)},'room':{'$addToSet':_0x6453ef(0x156)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x160d92[0x0][_0x6453ef(0x114)]==_0x6453ef(0xee)){var _0x21b178=users[_0x6453ef(0x10a)];console[_0x6453ef(0x146)](_0x21b178);}else{if(_0x160d92[0x0]['language']==_0x6453ef(0x115))var _0x21b178=users['Hindi'];else{if(_0x160d92[0x0][_0x6453ef(0x114)]==_0x6453ef(0xfb))var _0x21b178=users[_0x6453ef(0xfb)];else{if(_0x160d92[0x0]['language']==_0x6453ef(0xce))var _0x21b178=users[_0x6453ef(0xce)];else{if(_0x160d92[0x0][_0x6453ef(0x114)]==_0x6453ef(0x123))var _0x21b178=users[_0x6453ef(0x123)];else{if(_0x160d92[0x0][_0x6453ef(0x114)]==_0x6453ef(0xac))var _0x21b178=users[_0x6453ef(0xc6)];else{if(_0x160d92[0x0][_0x6453ef(0x114)]==_0x6453ef(0x107))var _0x21b178=users[_0x6453ef(0x107)];else{if(_0x160d92[0x0]['language']==_0x6453ef(0xf1))var _0x21b178=users[_0x6453ef(0xe9)];}}}}}}}_0x3a4988[_0x6453ef(0xf9)](_0x6453ef(0xca),{'success':_0x25b040['flash'](_0x6453ef(0x12c)),'errors':_0x25b040['flash'](_0x6453ef(0xda)),'role':_0x286c53,'profile':_0x2f6a0a,'warehouse':_0x4591af,'product':_0x2f079d,'adjustment':_0x28db14,'master_shop':_0x160d92,'language':_0x21b178});}catch(_0x2a0787){console[_0x6453ef(0x146)](_0x2a0787);}}),router['get'](a0_0x4c336d(0x13e),auth,async(_0xcf7809,_0x1ca87a)=>{var _0x2f908c=a0_0x4c336d;try{const {username:_0xf678a3,email:_0x4e7551,role:_0x3fde7f}=_0xcf7809[_0x2f908c(0x143)],_0x582e5b=_0xcf7809[_0x2f908c(0x143)],_0x5b47d3=await profile['findOne']({'email':_0x582e5b[_0x2f908c(0x11f)]}),_0xfbe214=await master_shop['find']();let _0x13efe1;if(_0x582e5b['role']==_0x2f908c(0xb9)){const _0x476b8f=await staff[_0x2f908c(0x134)]({'email':_0x582e5b['email']});_0x13efe1=await warehouse[_0x2f908c(0xff)]({'status':_0x2f908c(0x135),'name':_0x476b8f['warehouse']});}else _0x13efe1=await warehouse[_0x2f908c(0xff)]({'status':_0x2f908c(0x135)});const _0x5d5aee=await product[_0x2f908c(0xff)]();let _0x12d2a7;if(_0x582e5b['role']==_0x2f908c(0xb9)){const _0x6967f5=await staff[_0x2f908c(0x134)]({'email':_0x582e5b[_0x2f908c(0x11f)]});_0x12d2a7=await adjustment_finished[_0x2f908c(0xff)]({'warehouse_name':_0x6967f5[_0x2f908c(0x147)]});}else _0x12d2a7=await adjustment_finished[_0x2f908c(0xf2)]([{'$match':{'type_of_transaction':_0x2f908c(0x109)}},{'$unwind':_0x2f908c(0x149)},{'$group':{'_id':_0x2f908c(0x12e),'invoice':{'$first':_0x2f908c(0xb1)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x2f908c(0x156)},'finalize':{'$first':_0x2f908c(0xd9)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0xfbe214[0x0][_0x2f908c(0x114)]==_0x2f908c(0xee))var _0x6f94ec=users[_0x2f908c(0x10a)];else{if(_0xfbe214[0x0][_0x2f908c(0x114)]==_0x2f908c(0x115))var _0x6f94ec=users[_0x2f908c(0x115)];else{if(_0xfbe214[0x0][_0x2f908c(0x114)]=='German')var _0x6f94ec=users['German'];else{if(_0xfbe214[0x0][_0x2f908c(0x114)]=='Spanish')var _0x6f94ec=users[_0x2f908c(0xce)];else{if(_0xfbe214[0x0][_0x2f908c(0x114)]==_0x2f908c(0x123))var _0x6f94ec=users[_0x2f908c(0x123)];else{if(_0xfbe214[0x0][_0x2f908c(0x114)]=='Portuguese\x20(BR)')var _0x6f94ec=users[_0x2f908c(0xc6)];else{if(_0xfbe214[0x0][_0x2f908c(0x114)]=='Chinese')var _0x6f94ec=users[_0x2f908c(0x107)];else{if(_0xfbe214[0x0][_0x2f908c(0x114)]==_0x2f908c(0xf1))var _0x6f94ec=users[_0x2f908c(0xe9)];}}}}}}}_0x1ca87a['render'](_0x2f908c(0xf7),{'success':_0xcf7809[_0x2f908c(0x138)](_0x2f908c(0x12c)),'errors':_0xcf7809[_0x2f908c(0x138)](_0x2f908c(0xda)),'role':_0x582e5b,'profile':_0x5b47d3,'warehouse':_0x13efe1,'product':_0x5d5aee,'adjustment':_0x12d2a7,'master_shop':_0xfbe214,'language':_0x6f94ec});}catch(_0x1404db){console[_0x2f908c(0x146)](_0x1404db);}});function a0_0x706c(){var _0x405bb9=['express','id_transaction','product','ADJF-','_id','</td>','role','random','$product_details.product_code','email','expiry_date','/view/:id','prod_cat','French','warehouse_name','$product_details.bay','all','secondary_unit','filter','$product_details.bin','room_names','push','success','An\x20error\x20occurred.','$_id','message','new_adjust_qty','findById','get','/barcode_scanner','findOne','Enabled','product_name','An\x20error\x20occurred\x20while\x20saving\x20data.','flash','prod_code','Adjustment\x20Finalize\x20Successfully','status','1691443ONqtHa','maxPerUnit','/view_logs','Primary_Units','catch','161JMfjgJ','../models/all_models','user','stockBefore','adjustment\x20add\x20successfull','log','warehouse','/view/add_adjustment_logs','$product','4pGXLdp','JO_number','params','toString','adjust_qty','own','getFullYear','/adjustment_finished/view','2123mzsvGy','$product_details.maxProducts','/picking_list/PDF_adjustmentFinal/','string','$product.room_names','product_stock','padStart','date','$product_details.secondary_code','product_date','production_date','$product.product_name','product_code','add_adjustment_finished_logs','<tr>','$product_details.floorlevel','New_Qty_Converted','2230DvnbCw','id_transaction_from','$product_details.invoice','minus','$product_details.product_stock','Portuguese\x20(BR)','product_details','length','Ambient','add_adjustment_finished','$invoice','back','split','purchases_data','invoice_init','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/view','stock','staff','finalize','add','True','$product_details.expiry_date','adjustment\x20data\x20update\x20successfully','foreach\x20newproduct','$name','$room','$product_details._id','$product_details','Router','level','Portuguese','$product_details.batch_code','$product_details.primary_code','note','adjustment_finished','Enclosed','prod_name','/adjustment_finished/preview/','Spanish','</tr>','prod_invoice','Secondary_units','room','/preview/:id','json','types','/CheckingWarehouse','$product_details.storage','DRY\x20GOODS','$finalize','errors','8730KxxpfA','forEach','$product_details.rack','$product_details.secondary_unit','$date','108747harapL','slice','$warehouse_name','Rooms','save','$product_details.unit','then','invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Arabic','New_Qty_Converted_adj','$product_details.product_name','post','2963562ZQqFgH','English\x20(US)','/view/add_adjustment','map','Arabic\x20(ae)','aggregate','2624945mZfelJ','$product_details.production_date','edit_adjustment_finished','156BJOtvU','adjustment_finished_logs','$product_details.maxPerUnit','render','master','German','floor','LOG-ADJ-','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','find','Return\x20Rooms','unit','263dfYhmX','30642mIExLL','body','error','../public/language/languages.json','Chinese','$product_details.type','logs','English','edit_adjustment_finished_view','ADJ-','batch_code','/adjustment/view','760ugBjMg','redirect','getMonth','match','bay','language','Hindi'];a0_0x706c=function(){return _0x405bb9;};return a0_0x706c();}async function getRandom8DigitNumber(){var _0x138779=a0_0x4c336d;const _0x28cf02=0x989680,_0x1225c9=0x5f5e0ff,_0x159db0=Math[_0x138779(0xfc)](Math[_0x138779(0x11d)]()*(_0x1225c9-_0x28cf02+0x1))+_0x28cf02;var _0x2d82dd;const _0x1b4bc1=await adjustment_finished[_0x138779(0x134)]({'invoice':_0x138779(0x119)+_0x159db0});return _0x1b4bc1&&_0x1b4bc1[_0x138779(0xae)]>0x0?_0x2d82dd=_0x138779(0x119)+_0x159db0:_0x2d82dd=_0x138779(0x119)+_0x159db0,_0x2d82dd;}function a0_0x35d5(_0x2062fe,_0x1d43ea){var _0x706c5b=a0_0x706c();return a0_0x35d5=function(_0x35d536,_0x5d5a21){_0x35d536=_0x35d536-0xa0;var _0x536bf6=_0x706c5b[_0x35d536];return _0x536bf6;},a0_0x35d5(_0x2062fe,_0x1d43ea);}router[a0_0x4c336d(0x132)](a0_0x4c336d(0xef),auth,async(_0x3eabae,_0x342811)=>{var _0x554ef1=a0_0x4c336d;try{const {username:_0x5cb242,email:_0x4b0b39,role:_0xf8aae0}=_0x3eabae[_0x554ef1(0x143)],_0x108c1e=_0x3eabae['user'],_0x4e2d25=await profile['findOne']({'email':_0x108c1e[_0x554ef1(0x11f)]}),_0xba014a=await master_shop['find']();let _0x5644ff;if(_0x108c1e['role']=='staff'){const _0x496e81=await staff[_0x554ef1(0x134)]({'email':_0x108c1e[_0x554ef1(0x11f)]});_0x5644ff=await warehouse['aggregate']([{'$match':{'status':_0x554ef1(0x135),'name':_0x496e81[_0x554ef1(0x147)]}},{'$group':{'_id':_0x554ef1(0xc0),'name':{'$first':_0x554ef1(0xc0)}}}]);}else _0x5644ff=await warehouse[_0x554ef1(0xf2)]([{'$match':{'status':_0x554ef1(0x135)}},{'$group':{'_id':_0x554ef1(0xc0),'name':{'$first':_0x554ef1(0xc0)}}}]);const _0x4dde4a=await product[_0x554ef1(0xff)]({}),_0x3e511a=await adjustment_finished[_0x554ef1(0xff)](),_0x3d9415=_0x3e511a['length']+0x1,_0x5d6a30=_0x554ef1(0x119)+_0x3d9415[_0x554ef1(0x14d)]()['padStart'](0x5,'0');var _0x1f3ef6=['Ambient',_0x554ef1(0xcb),'Return\x20Rooms'];if(_0xba014a[0x0][_0x554ef1(0x114)]==_0x554ef1(0xee))var _0x6658a5=users['English'];else{if(_0xba014a[0x0][_0x554ef1(0x114)]==_0x554ef1(0x115))var _0x6658a5=users[_0x554ef1(0x115)];else{if(_0xba014a[0x0][_0x554ef1(0x114)]==_0x554ef1(0xfb))var _0x6658a5=users[_0x554ef1(0xfb)];else{if(_0xba014a[0x0][_0x554ef1(0x114)]==_0x554ef1(0xce))var _0x6658a5=users['Spanish'];else{if(_0xba014a[0x0][_0x554ef1(0x114)]==_0x554ef1(0x123))var _0x6658a5=users[_0x554ef1(0x123)];else{if(_0xba014a[0x0][_0x554ef1(0x114)]==_0x554ef1(0xac))var _0x6658a5=users[_0x554ef1(0xc6)];else{if(_0xba014a[0x0][_0x554ef1(0x114)]=='Chinese')var _0x6658a5=users[_0x554ef1(0x107)];else{if(_0xba014a[0x0][_0x554ef1(0x114)]==_0x554ef1(0xf1))var _0x6658a5=users[_0x554ef1(0xe9)];}}}}}}}const _0x3035d2=getRandom8DigitNumber();_0x3035d2['then'](_0x20f099=>{var _0x4e8210=_0x554ef1;_0x342811[_0x4e8210(0xf9)](_0x4e8210(0xb0),{'success':_0x3eabae[_0x4e8210(0x138)]('success'),'errors':_0x3eabae[_0x4e8210(0x138)](_0x4e8210(0xda)),'role':_0x108c1e,'profile':_0x4e2d25,'warehouse':_0x5644ff,'product':_0x4dde4a,'master_shop':_0xba014a,'language':_0x6658a5,'rooms_data':_0x1f3ef6,'invoice_no':_0x20f099});})[_0x554ef1(0x140)](_0x136d46=>{var _0x4e3194=_0x554ef1;_0x3eabae[_0x4e3194(0x138)](_0x4e3194(0xda),_0x4e3194(0xe8)),_0x342811[_0x4e3194(0x110)](_0x4e3194(0x10e));});}catch(_0x2208a6){console[_0x554ef1(0x146)](_0x2208a6);}}),router[a0_0x4c336d(0xec)](a0_0x4c336d(0xef),auth,async(_0x316bb5,_0x10e978)=>{var _0x28c92d=a0_0x4c336d;try{const {warehouse_name:_0x21e13c,date:_0x40ec8d,prod_name:_0x28e914,level:_0x1638ed,isle:_0x105b0d,pallet:_0x28d6f3,stock:_0x47677b,types:_0x2bc560,adjust_qty:_0x4190ac,new_adjust_qty:_0x292f84,note:_0x5a4b07,Room_name:_0x1d4ebb,JO_number:_0x1bac08,expiry_date:_0x166a1f,PO_number:_0x1b7e75,ReqBy:_0x3e4291,dateofreq:_0x2ad2be,typeservicesData:_0x3669eb,destination:_0x1eaa88,deliverydate:_0x4e5a23,driver:_0x2dea46,plate:_0x327fe1,van:_0x3f8dad,DRSI:_0x454d75,typevehicle:_0x24b1d7,TSU:_0x20095f,TFU:_0x14b09b}=_0x316bb5[_0x28c92d(0x104)];if(typeof _0x28e914==_0x28c92d(0x155))var _0x3227d7=[_0x316bb5[_0x28c92d(0x104)]['prod_name']],_0x16b244=[_0x316bb5[_0x28c92d(0x104)][_0x28c92d(0xc5)]],_0x5ef1e4=[_0x316bb5[_0x28c92d(0x104)]['stock']],_0xe32773=[_0x316bb5[_0x28c92d(0x104)]['types']],_0x26a922=[_0x316bb5[_0x28c92d(0x104)][_0x28c92d(0xea)]],_0x48f331=[_0x316bb5[_0x28c92d(0x104)][_0x28c92d(0xa6)]],_0x49fe0d=[_0x316bb5[_0x28c92d(0x104)]['Primary_Units']],_0xbb286=[_0x316bb5[_0x28c92d(0x104)]['Secondary_units']],_0x29ff4a=[_0x316bb5[_0x28c92d(0x104)]['prod_code']],_0x1e33a1=[_0x316bb5['body'][_0x28c92d(0x10d)]],_0x434e92=[_0x316bb5[_0x28c92d(0x104)][_0x28c92d(0x120)]],_0x36a2cd=[_0x316bb5[_0x28c92d(0x104)][_0x28c92d(0x15b)]],_0xece2c9=[_0x316bb5[_0x28c92d(0x104)][_0x28c92d(0x122)]],_0x513fcd=[_0x316bb5[_0x28c92d(0x104)][_0x28c92d(0xe3)]],_0x7642e8=[_0x316bb5[_0x28c92d(0x104)][_0x28c92d(0x13d)]],_0x4740ed=[_0x316bb5['body'][_0x28c92d(0xd0)]],_0x2767ec=[_0x316bb5['body'][_0x28c92d(0xa8)]];else var _0x3227d7=[..._0x316bb5[_0x28c92d(0x104)][_0x28c92d(0xcc)]],_0x16b244=[..._0x316bb5[_0x28c92d(0x104)]['level']],_0x5ef1e4=[..._0x316bb5[_0x28c92d(0x104)][_0x28c92d(0xb8)]],_0xe32773=[..._0x316bb5['body']['types']],_0x26a922=[..._0x316bb5[_0x28c92d(0x104)]['New_Qty_Converted_adj']],_0x48f331=[..._0x316bb5[_0x28c92d(0x104)][_0x28c92d(0xa6)]],_0x49fe0d=[..._0x316bb5['body'][_0x28c92d(0x13f)]],_0xbb286=[..._0x316bb5['body'][_0x28c92d(0xd1)]],_0x29ff4a=[..._0x316bb5[_0x28c92d(0x104)][_0x28c92d(0x139)]],_0x1e33a1=[..._0x316bb5[_0x28c92d(0x104)][_0x28c92d(0x10d)]],_0x434e92=[..._0x316bb5[_0x28c92d(0x104)]['expiry_date']],_0x36a2cd=[..._0x316bb5[_0x28c92d(0x104)][_0x28c92d(0x15b)]],_0xece2c9=[..._0x316bb5[_0x28c92d(0x104)][_0x28c92d(0x122)]],_0x513fcd=[..._0x316bb5['body'][_0x28c92d(0xe3)]],_0x7642e8=[..._0x316bb5['body'][_0x28c92d(0x13d)]],_0x4740ed=[..._0x316bb5[_0x28c92d(0x104)][_0x28c92d(0xd0)]],_0x2767ec=[..._0x316bb5['body'][_0x28c92d(0xa8)]];const _0x50473b=_0x3227d7[_0x28c92d(0xf0)](_0x3221d7=>{return _0x3221d7={'product_name':_0x3221d7};});_0x16b244[_0x28c92d(0xdc)]((_0x2ee014,_0x267325)=>{var _0xb8b59=_0x28c92d,_0x396ac1=_0x2ee014['match'](/[A-Za-z]+/)[0x0],_0x326ac0=parseInt(_0x2ee014[_0xb8b59(0x112)](/\d+/)[0x0]);_0x50473b[_0x267325][_0xb8b59(0xc5)]=_0x396ac1,_0x50473b[_0x267325][_0xb8b59(0x113)]=_0x326ac0;}),_0x2767ec[_0x28c92d(0xdc)]((_0x53e629,_0x406d9b)=>{var _0x3ce5f5=_0x28c92d;_0x50473b[_0x406d9b][_0x3ce5f5(0x117)]=_0x53e629;}),_0x5ef1e4['forEach']((_0x35caf3,_0x12d768)=>{_0x50473b[_0x12d768]['stockBefore']=_0x35caf3;}),_0xe32773[_0x28c92d(0xdc)]((_0x28276a,_0x3a5186)=>{var _0x2ced72=_0x28c92d;_0x50473b[_0x3a5186][_0x2ced72(0xd5)]=_0x28276a;}),_0x26a922[_0x28c92d(0xdc)]((_0x467be5,_0xbc392e)=>{_0x50473b[_0xbc392e]['adjust_qty']=_0x467be5;}),_0x48f331[_0x28c92d(0xdc)]((_0x2d3a14,_0x25307d)=>{var _0x5360c0=_0x28c92d;_0x50473b[_0x25307d][_0x5360c0(0x130)]=_0x2d3a14;}),_0x49fe0d[_0x28c92d(0xdc)]((_0x4979db,_0x59f40f)=>{var _0x1f0496=_0x28c92d;_0x50473b[_0x59f40f][_0x1f0496(0x101)]=_0x4979db;}),_0xbb286[_0x28c92d(0xdc)]((_0x4f694d,_0x2061bd)=>{var _0x46df2e=_0x28c92d;_0x50473b[_0x2061bd][_0x46df2e(0x127)]=_0x4f694d;}),_0x29ff4a[_0x28c92d(0xdc)]((_0x339237,_0x5db743)=>{_0x50473b[_0x5db743]['product_code']=_0x339237;}),_0x1e33a1[_0x28c92d(0xdc)]((_0x2e712c,_0x8cbe5e)=>{var _0x5cfb5b=_0x28c92d;_0x50473b[_0x8cbe5e][_0x5cfb5b(0x10d)]=_0x2e712c;}),_0x434e92[_0x28c92d(0xdc)]((_0x530851,_0x5e1bbc)=>{var _0x15e4a5=_0x28c92d;_0x50473b[_0x5e1bbc][_0x15e4a5(0x120)]=_0x530851;}),_0x36a2cd[_0x28c92d(0xdc)]((_0x331358,_0x1b90b2)=>{var _0x3c9e14=_0x28c92d;_0x50473b[_0x1b90b2][_0x3c9e14(0xa0)]=_0x331358;}),_0xece2c9['forEach']((_0x37a630,_0x5f416a)=>{_0x50473b[_0x5f416a]['prod_cat']=_0x37a630;}),_0x513fcd[_0x28c92d(0xdc)]((_0xf95850,_0x5144df)=>{var _0x701d8d=_0x28c92d;_0x50473b[_0x5144df][_0x701d8d(0x12a)]=_0xf95850;}),_0x7642e8[_0x28c92d(0xdc)]((_0x52d639,_0x2e0686)=>{var _0x307606=_0x28c92d;_0x50473b[_0x2e0686][_0x307606(0x13d)]=_0x52d639;}),_0x4740ed[_0x28c92d(0xdc)]((_0x29019e,_0x23c12b)=>{var _0x5f1606=_0x28c92d;_0x50473b[_0x23c12b][_0x5f1606(0xe7)]=_0x29019e;});const _0x540ef3=_0x50473b[_0x28c92d(0x128)](_0x325390=>_0x325390[_0x28c92d(0x14e)]!=='0'&&_0x325390[_0x28c92d(0x14e)]!=='');var _0x162142=0x0;_0x540ef3[_0x28c92d(0xdc)](_0x32409f=>{var _0x462c68=_0x28c92d;console[_0x462c68(0x146)]('foreach\x20newproduct',_0x32409f),parseInt(_0x32409f[_0x462c68(0x14e)])<=0x0&&_0x162142++;});if(_0x162142!=0x0)return _0x316bb5['flash'](_0x28c92d(0xda),_0x28c92d(0xfe)),_0x10e978['redirect'](_0x28c92d(0xb2));const _0x1db431=new invoice_for_adjustment();await _0x1db431[_0x28c92d(0xe4)]();const _0x5711af=new adjustment_finished({'warehouse_name':_0x21e13c,'date':_0x40ec8d,'product':_0x540ef3,'note':_0x5a4b07,'room':_0x1d4ebb,'invoice':_0x28c92d(0x10c)+_0x1db431[_0x28c92d(0xb5)][_0x28c92d(0x14d)]()[_0x28c92d(0x158)](0x8,'0'),'JO_number':_0x1bac08,'expiry_date':_0x166a1f,'PO_number':_0x1b7e75,'RequestedBy':_0x3e4291,'DateofRequest':_0x2ad2be,'typeservices':_0x3669eb,'destination':_0x1eaa88,'deliverydate':_0x4e5a23,'driver':_0x2dea46,'plate':_0x327fe1,'van':_0x3f8dad,'DRSI':_0x454d75,'typevehicle':_0x24b1d7,'TSU':_0x20095f,'TFU':_0x14b09b}),_0x280462=await _0x5711af['save']();_0x316bb5[_0x28c92d(0x138)](_0x28c92d(0x12c),_0x28c92d(0x145)),_0x10e978[_0x28c92d(0x110)](_0x28c92d(0xcd)+_0x280462[_0x28c92d(0x11a)]);}catch(_0x52dc1e){console[_0x28c92d(0x146)](_0x52dc1e),_0x10e978[_0x28c92d(0x13b)](0xc8)[_0x28c92d(0xd4)]({'message':_0x52dc1e[_0x28c92d(0x12f)]});}}),router[a0_0x4c336d(0x132)](a0_0x4c336d(0x148),auth,async(_0x193261,_0x2e94b6)=>{var _0x410557=a0_0x4c336d;try{const {username:_0xe4bac3,email:_0xcc5ea9,role:_0x42c809}=_0x193261['user'],_0x1ec889=_0x193261[_0x410557(0x143)],_0x1a9981=await profile[_0x410557(0x134)]({'email':_0x1ec889[_0x410557(0x11f)]}),_0x2b9e75=await master_shop[_0x410557(0xff)]();let _0x432c0f;if(_0x1ec889['role']==_0x410557(0xb9)){const _0x2dc72f=await staff[_0x410557(0x134)]({'email':_0x1ec889[_0x410557(0x11f)]});_0x432c0f=await warehouse[_0x410557(0xf2)]([{'$match':{'status':'Enabled','name':_0x2dc72f[_0x410557(0x147)]}},{'$group':{'_id':_0x410557(0xc0),'name':{'$first':_0x410557(0xc0)}}}]);}else _0x432c0f=await warehouse[_0x410557(0xf2)]([{'$match':{'status':_0x410557(0x135)}},{'$group':{'_id':_0x410557(0xc0),'name':{'$first':_0x410557(0xc0)}}}]);const _0x3b75d5=await product[_0x410557(0xff)](),_0x5420c1=await adjustment_finished[_0x410557(0xff)](),_0x1cffd6=_0x5420c1[_0x410557(0xae)]+0x1,_0x4317b3=_0x410557(0x119)+_0x1cffd6[_0x410557(0x14d)]()[_0x410557(0x158)](0x5,'0');var _0x542d15=[_0x410557(0xaf),_0x410557(0xcb),_0x410557(0x100)];if(_0x2b9e75[0x0][_0x410557(0x114)]==_0x410557(0xee))var _0x1c07cc=users[_0x410557(0x10a)];else{if(_0x2b9e75[0x0][_0x410557(0x114)]==_0x410557(0x115))var _0x1c07cc=users['Hindi'];else{if(_0x2b9e75[0x0]['language']=='German')var _0x1c07cc=users['German'];else{if(_0x2b9e75[0x0][_0x410557(0x114)]==_0x410557(0xce))var _0x1c07cc=users[_0x410557(0xce)];else{if(_0x2b9e75[0x0][_0x410557(0x114)]==_0x410557(0x123))var _0x1c07cc=users[_0x410557(0x123)];else{if(_0x2b9e75[0x0][_0x410557(0x114)]=='Portuguese\x20(BR)')var _0x1c07cc=users[_0x410557(0xc6)];else{if(_0x2b9e75[0x0][_0x410557(0x114)]==_0x410557(0x107))var _0x1c07cc=users[_0x410557(0x107)];else{if(_0x2b9e75[0x0][_0x410557(0x114)]==_0x410557(0xf1))var _0x1c07cc=users[_0x410557(0xe9)];}}}}}}}const _0xf2d09d=getRandom8DigitNumber();_0xf2d09d[_0x410557(0xe6)](_0x13797d=>{var _0x5e58bb=_0x410557;_0x2e94b6[_0x5e58bb(0xf9)](_0x5e58bb(0xa3),{'success':_0x193261['flash'](_0x5e58bb(0x12c)),'errors':_0x193261['flash'](_0x5e58bb(0xda)),'role':_0x1ec889,'profile':_0x1a9981,'warehouse':_0x432c0f,'product':_0x3b75d5,'master_shop':_0x2b9e75,'language':_0x1c07cc,'rooms_data':_0x542d15,'invoice_no':_0x13797d});})['catch'](_0x1d2399=>{var _0x5a6647=_0x410557;_0x193261['flash']('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2e94b6['redirect'](_0x5a6647(0x10e));});}catch(_0x6dcae1){console[_0x410557(0x146)](_0x6dcae1);}}),router[a0_0x4c336d(0xec)]('/view/add_adjustment_logs',auth,async(_0x1681d8,_0x56dc0a)=>{var _0x5aea99=a0_0x4c336d;try{const {warehouse_name:_0x4223c9,date:_0x1e220e,prod_name:_0x43613f,level:_0x7bf805,isle:_0x3f98c9,pallet:_0x1b6f93,stock:_0x307b61,types:_0x12b4bc,adjust_qty:_0x197c22,new_adjust_qty:_0x2b73c4,note:_0x504bbf,Room_name:_0x1ef81d,JO_number:_0x2448a9,expiry_date:_0xc168cc,type_of_transaction:_0x4e0300,PO_number:_0x4c1252,ReqBy:_0xb71533,dateofreq:_0x1567cc,typeservicesData:_0x14b145,destination:_0x554925,deliverydate:_0x29a459,driver:_0x5c5302,plate:_0x1df967,van:_0x189844,DRSI:_0x3c0aed,typevehicle:_0x172bb5,TSU:_0x1f05aa,TFU:_0x10fc7a}=_0x1681d8[_0x5aea99(0x104)];if(typeof _0x43613f==_0x5aea99(0x155))var _0x345399=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xcc)]],_0x46fcba=[_0x1681d8['body'][_0x5aea99(0xc5)]],_0xc3171e=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xb8)]],_0x1cb693=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xd5)]],_0x4de9ca=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xea)]],_0x4889d3=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xa6)]],_0x1eb7c7=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0x13f)]],_0x5004c3=[_0x1681d8[_0x5aea99(0x104)]['Secondary_units']],_0x3e9597=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0x139)]],_0x4a52e7=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0x10d)]],_0x4e5ea9=[_0x1681d8['body'][_0x5aea99(0x120)]],_0x43166d=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0x15b)]],_0x2321ef=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0x122)]],_0x4bdbab=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xe3)]],_0x12db07=[_0x1681d8[_0x5aea99(0x104)]['maxPerUnit']],_0x2acd5f=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xd0)]],_0x38fc0f=[_0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xa8)]];else var _0x345399=[..._0x1681d8['body'][_0x5aea99(0xcc)]],_0x46fcba=[..._0x1681d8['body'][_0x5aea99(0xc5)]],_0xc3171e=[..._0x1681d8[_0x5aea99(0x104)]['stock']],_0x1cb693=[..._0x1681d8['body'][_0x5aea99(0xd5)]],_0x4de9ca=[..._0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xea)]],_0x4889d3=[..._0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xa6)]],_0x1eb7c7=[..._0x1681d8['body'][_0x5aea99(0x13f)]],_0x5004c3=[..._0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xd1)]],_0x3e9597=[..._0x1681d8[_0x5aea99(0x104)][_0x5aea99(0x139)]],_0x4a52e7=[..._0x1681d8['body'][_0x5aea99(0x10d)]],_0x4e5ea9=[..._0x1681d8['body'][_0x5aea99(0x120)]],_0x43166d=[..._0x1681d8['body'][_0x5aea99(0x15b)]],_0x2321ef=[..._0x1681d8[_0x5aea99(0x104)][_0x5aea99(0x122)]],_0x4bdbab=[..._0x1681d8[_0x5aea99(0x104)][_0x5aea99(0xe3)]],_0x12db07=[..._0x1681d8['body'][_0x5aea99(0x13d)]],_0x2acd5f=[..._0x1681d8['body']['prod_invoice']],_0x38fc0f=[..._0x1681d8['body'][_0x5aea99(0xa8)]];const _0x43d602=_0x345399['map'](_0x1ee4bf=>{return _0x1ee4bf={'product_name':_0x1ee4bf};});_0x46fcba[_0x5aea99(0xdc)]((_0x3d6d1b,_0x3fdb9e)=>{var _0x54e5fe=_0x5aea99,_0x3c3f40=_0x3d6d1b[_0x54e5fe(0x112)](/[A-Za-z]+/)[0x0],_0x35a06d=parseInt(_0x3d6d1b[_0x54e5fe(0x112)](/\d+/)[0x0]);_0x43d602[_0x3fdb9e]['level']=_0x3c3f40,_0x43d602[_0x3fdb9e][_0x54e5fe(0x113)]=_0x35a06d;}),_0x38fc0f[_0x5aea99(0xdc)]((_0x11b843,_0x6d940e)=>{var _0x1927fa=_0x5aea99;_0x43d602[_0x6d940e][_0x1927fa(0x117)]=_0x11b843;}),_0xc3171e[_0x5aea99(0xdc)]((_0x3e3a2f,_0x379de4)=>{var _0x5a7057=_0x5aea99;_0x43d602[_0x379de4][_0x5a7057(0x144)]=_0x3e3a2f;}),_0x1cb693[_0x5aea99(0xdc)]((_0x17b970,_0x43cfd6)=>{_0x43d602[_0x43cfd6]['types']=_0x17b970;}),_0x4de9ca[_0x5aea99(0xdc)]((_0x48737f,_0x1c8a71)=>{var _0x46a79d=_0x5aea99;_0x43d602[_0x1c8a71][_0x46a79d(0x14e)]=_0x48737f;}),_0x4889d3['forEach']((_0x21d705,_0x5b82b3)=>{var _0x5c551d=_0x5aea99;_0x43d602[_0x5b82b3][_0x5c551d(0x130)]=_0x21d705;}),_0x1eb7c7[_0x5aea99(0xdc)]((_0x1c9528,_0x18b6d2)=>{var _0x181fbd=_0x5aea99;_0x43d602[_0x18b6d2][_0x181fbd(0x101)]=_0x1c9528;}),_0x5004c3[_0x5aea99(0xdc)]((_0x2b7280,_0x210028)=>{_0x43d602[_0x210028]['secondary_unit']=_0x2b7280;}),_0x3e9597[_0x5aea99(0xdc)]((_0x1e77fe,_0x278106)=>{var _0x14d4c7=_0x5aea99;_0x43d602[_0x278106][_0x14d4c7(0xa2)]=_0x1e77fe;}),_0x4a52e7[_0x5aea99(0xdc)]((_0x4e630d,_0xc048ac)=>{_0x43d602[_0xc048ac]['batch_code']=_0x4e630d;}),_0x4e5ea9[_0x5aea99(0xdc)]((_0x360459,_0x55f760)=>{var _0x484a46=_0x5aea99;_0x43d602[_0x55f760][_0x484a46(0x120)]=_0x360459;}),_0x43166d[_0x5aea99(0xdc)]((_0x410796,_0x35fd9e)=>{var _0x2e7248=_0x5aea99;_0x43d602[_0x35fd9e][_0x2e7248(0xa0)]=_0x410796;}),_0x2321ef[_0x5aea99(0xdc)]((_0x51e3e4,_0x311a5a)=>{var _0x5e9f33=_0x5aea99;_0x43d602[_0x311a5a][_0x5e9f33(0x122)]=_0x51e3e4;}),_0x4bdbab[_0x5aea99(0xdc)]((_0x4187df,_0x58f070)=>{var _0x38431f=_0x5aea99;_0x43d602[_0x58f070][_0x38431f(0x12a)]=_0x4187df;}),_0x12db07[_0x5aea99(0xdc)]((_0x30ce12,_0x4cd907)=>{var _0x22067f=_0x5aea99;_0x43d602[_0x4cd907][_0x22067f(0x13d)]=_0x30ce12;}),_0x2acd5f['forEach']((_0x32ae54,_0x439536)=>{var _0x105ea7=_0x5aea99;_0x43d602[_0x439536][_0x105ea7(0xe7)]=_0x32ae54;});const _0x9c0040=_0x43d602['filter'](_0x3fe09d=>_0x3fe09d['adjust_qty']!=='0'&&_0x3fe09d[_0x5aea99(0x14e)]!=='');var _0xcac1a0=0x0;_0x9c0040[_0x5aea99(0xdc)](_0x4e65b9=>{var _0x1ae525=_0x5aea99;console['log'](_0x1ae525(0xbf),_0x4e65b9),parseInt(_0x4e65b9[_0x1ae525(0x14e)])<=0x0&&_0xcac1a0++;});if(_0xcac1a0!=0x0)return _0x1681d8['flash'](_0x5aea99(0xda),_0x5aea99(0xfe)),_0x56dc0a[_0x5aea99(0x110)]('back');const _0x1ac13b=new adjustment_logs();await _0x1ac13b[_0x5aea99(0xe4)]();const _0x5657d4=new adjustment_finished({'warehouse_name':_0x4223c9,'date':_0x1e220e,'product':_0x9c0040,'note':_0x504bbf,'room':_0x1ef81d,'invoice':_0x5aea99(0xfd)+_0x1ac13b[_0x5aea99(0xb5)]['toString']()[_0x5aea99(0x158)](0x8,'0'),'JO_number':_0x2448a9,'expiry_date':_0xc168cc,'type_of_transaction':_0x4e0300,'PO_number':_0x4c1252,'RequestedBy':_0xb71533,'DateofRequest':_0x1567cc,'typeservices':_0x14b145,'destination':_0x554925,'deliverydate':_0x29a459,'driver':_0x5c5302,'plate':_0x1df967,'van':_0x189844,'DRSI':_0x3c0aed,'typevehicle':_0x172bb5,'TSU':_0x1f05aa,'TFU':_0x10fc7a}),_0x3d01d7=await _0x5657d4[_0x5aea99(0xe4)]();_0x1681d8[_0x5aea99(0x138)](_0x5aea99(0x12c),_0x5aea99(0x145)),_0x56dc0a['redirect'](_0x5aea99(0xcd)+_0x3d01d7[_0x5aea99(0x11a)]);}catch(_0x495f2d){console[_0x5aea99(0x146)](_0x495f2d),_0x56dc0a['status'](0xc8)[_0x5aea99(0xd4)]({'message':_0x495f2d['message']});}}),router[a0_0x4c336d(0x132)](a0_0x4c336d(0xd3),auth,async(_0x399a14,_0x3eca64)=>{var _0x29ee07=a0_0x4c336d;try{const {username:_0x35c624,email:_0x4563c4,role:_0x1b931c}=_0x399a14[_0x29ee07(0x143)],_0x56f6f6=_0x399a14[_0x29ee07(0x143)],_0x241fc0=await profile[_0x29ee07(0x134)]({'email':_0x56f6f6[_0x29ee07(0x11f)]}),_0x35c76f=await master_shop[_0x29ee07(0xff)](),_0x4a6ca1=_0x399a14[_0x29ee07(0x14c)]['id'],_0x55cfe8=await adjustment_finished['findById']({'_id':_0x4a6ca1}),_0x17593f=await purchases['aggregate']([{'$match':{'warehouse_name':_0x55cfe8[_0x29ee07(0x124)]}},{'$unwind':_0x29ee07(0x149)},{'$group':{'_id':_0x29ee07(0xa1)}}]);console[_0x29ee07(0x146)](_0x29ee07(0xb4),_0x17593f);const _0x1a0ad5=await product['find']({}),_0x2281a6=await warehouse[_0x29ee07(0xf2)]([{'$match':{'name':_0x55cfe8[_0x29ee07(0x124)]}},{'$unwind':_0x29ee07(0xc3)},{'$group':{'_id':_0x29ee07(0xc2),'name':{'$first':_0x29ee07(0xeb)},'product_stock':{'$first':_0x29ee07(0xab)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x29ee07(0x129)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x29ee07(0xc8)},'secondary_code':{'$first':_0x29ee07(0x15a)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x29ee07(0xd7)},'rack':{'$first':_0x29ee07(0xdd)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x29ee07(0xf4)},'batch_code':{'$first':_0x29ee07(0xc7)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':'$room'}}}]);if(_0x35c76f[0x0]['language']==_0x29ee07(0xee)){var _0x440025=users[_0x29ee07(0x10a)];console[_0x29ee07(0x146)](_0x440025);}else{if(_0x35c76f[0x0][_0x29ee07(0x114)]==_0x29ee07(0x115))var _0x440025=users[_0x29ee07(0x115)];else{if(_0x35c76f[0x0][_0x29ee07(0x114)]==_0x29ee07(0xfb))var _0x440025=users['German'];else{if(_0x35c76f[0x0][_0x29ee07(0x114)]=='Spanish')var _0x440025=users[_0x29ee07(0xce)];else{if(_0x35c76f[0x0][_0x29ee07(0x114)]==_0x29ee07(0x123))var _0x440025=users['French'];else{if(_0x35c76f[0x0]['language']=='Portuguese\x20(BR)')var _0x440025=users[_0x29ee07(0xc6)];else{if(_0x35c76f[0x0][_0x29ee07(0x114)]==_0x29ee07(0x107))var _0x440025=users[_0x29ee07(0x107)];else{if(_0x35c76f[0x0][_0x29ee07(0x114)]==_0x29ee07(0xf1))var _0x440025=users[_0x29ee07(0xe9)];}}}}}}}_0x3eca64['render'](_0x29ee07(0x10b),{'success':_0x399a14['flash'](_0x29ee07(0x12c)),'errors':_0x399a14[_0x29ee07(0x138)](_0x29ee07(0xda)),'role':_0x56f6f6,'profile':_0x241fc0,'adjustment':_0x55cfe8,'stock':_0x2281a6,'master_shop':_0x35c76f,'warehouse_name':_0x17593f,'unit':_0x1a0ad5,'language':_0x440025});}catch(_0x14d195){console[_0x29ee07(0x146)](_0x14d195),_0x3eca64[_0x29ee07(0x13b)](0xc8)[_0x29ee07(0xd4)]({'message':_0x14d195[_0x29ee07(0x12f)]});}}),router[a0_0x4c336d(0xec)](a0_0x4c336d(0xd3),auth,async(_0x3d0abf,_0x50722b)=>{var _0x4cee7a=a0_0x4c336d;try{const {invoice:_0x268d6d,warehouse_name:_0x1524f8,Room_name:_0x2eacc1}=_0x3d0abf[_0x4cee7a(0x104)],_0x5e2078=_0x3d0abf[_0x4cee7a(0x14c)]['id'],_0x330d0d=await adjustment_finished[_0x4cee7a(0x131)]({'_id':_0x5e2078});var _0x537be5;const _0xc83965=_0x330d0d[_0x4cee7a(0x118)]['map'](async _0x349822=>{var _0x5ecb9f=_0x4cee7a;if(_0x349822[_0x5ecb9f(0x14e)]>0x0){_0x537be5=await warehouse[_0x5ecb9f(0x134)]({'name':_0x1524f8,'room':_0x349822[_0x5ecb9f(0x12a)]});const _0x545995=_0x537be5[_0x5ecb9f(0xad)][_0x5ecb9f(0xf0)](_0xec9755=>{var _0x3b78ca=_0x5ecb9f;console[_0x3b78ca(0x146)](_0x349822['types']);if(_0x349822[_0x3b78ca(0xd5)]=='minus')_0xec9755[_0x3b78ca(0x11a)]==_0x349822[_0x3b78ca(0x117)]&&(_0xec9755[_0x3b78ca(0x157)]=_0xec9755[_0x3b78ca(0x157)]-_0x349822['adjust_qty']);else _0x349822['types']==_0x3b78ca(0xbb)&&(_0xec9755[_0x3b78ca(0x11a)]==_0x349822[_0x3b78ca(0x117)]&&(_0xec9755[_0x3b78ca(0x157)]=_0xec9755[_0x3b78ca(0x157)]+_0x349822[_0x3b78ca(0x14e)]));});}return _0x537be5;});Promise[_0x4cee7a(0x126)](_0xc83965)[_0x4cee7a(0xe6)](async _0x52a735=>{var _0x22f34c=_0x4cee7a;try{for(const _0x30c020 of _0x52a735){await _0x30c020['save']();}_0x330d0d[_0x22f34c(0xba)]=_0x22f34c(0xbc);const _0x477cbb=await _0x330d0d[_0x22f34c(0xe4)](),_0x76a08=await master_shop[_0x22f34c(0xff)](),_0x1f6527=await email_settings[_0x22f34c(0x134)](),_0x5a5f3d=await supervisor_settings[_0x22f34c(0xff)]();var _0x69cc1d=_0x330d0d[_0x22f34c(0x118)],_0x51a75='',_0x54ce18;for(_0x54ce18 in _0x69cc1d){var _0x5a2583='FG';_0x330d0d[_0x22f34c(0x124)]==_0x22f34c(0xd8)&&(_0x5a2583='DG'),_0x51a75+=_0x22f34c(0xa4)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x69cc1d[_0x54ce18][_0x22f34c(0x136)]+'</td>'+_0x22f34c(0xb6)+_0x69cc1d[_0x54ce18]['product_code']+_0x22f34c(0x11b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x69cc1d[_0x54ce18]['adjust_qty']+_0x22f34c(0x11b)+_0x22f34c(0xb6)+_0x69cc1d[_0x54ce18]['unit']+_0x22f34c(0x11b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x69cc1d[_0x54ce18][_0x22f34c(0x127)]+_0x22f34c(0x11b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x330d0d[_0x22f34c(0x124)]+_0x22f34c(0x11b)+_0x22f34c(0xb6)+_0x69cc1d[_0x54ce18][_0x22f34c(0x12a)]+_0x22f34c(0x11b)+_0x22f34c(0xb6)+_0x5a2583+_0x69cc1d[_0x54ce18][_0x22f34c(0x113)]+'</td>'+_0x22f34c(0xcf);}_0x3d0abf[_0x22f34c(0x138)](_0x22f34c(0x12c),_0x22f34c(0x13a)),_0x50722b[_0x22f34c(0x110)](_0x22f34c(0x154)+_0x477cbb[_0x22f34c(0x11a)]);}catch(_0x29d780){console[_0x22f34c(0x105)](_0x29d780),_0x50722b['status'](0x1f4)['json']({'error':_0x22f34c(0x137)});}})[_0x4cee7a(0x140)](_0x33856a=>{var _0x105ee8=_0x4cee7a;console[_0x105ee8(0x105)](_0x33856a),_0x50722b['status'](0x1f4)['json']({'error':_0x105ee8(0x12d)});});}catch(_0x203291){_0x50722b[_0x4cee7a(0xd4)]({'message':_0x203291[_0x4cee7a(0x12f)]});}}),router[a0_0x4c336d(0x132)](a0_0x4c336d(0x121),auth,async(_0x5bc1fe,_0x5a77f5)=>{var _0x5278cd=a0_0x4c336d;try{const {username:_0x5cd985,email:_0x5bd46b,role:_0x129d6d}=_0x5bc1fe['user'],_0x8e6fe7=_0x5bc1fe[_0x5278cd(0x143)],_0x457478=await profile[_0x5278cd(0x134)]({'email':_0x8e6fe7[_0x5278cd(0x11f)]}),_0x49957b=await master_shop[_0x5278cd(0xff)]();console[_0x5278cd(0x146)](_0x5278cd(0xfa),_0x49957b);const _0x26a085=_0x5bc1fe[_0x5278cd(0x14c)]['id'],_0x57d701=await adjustment_finished[_0x5278cd(0x131)]({'_id':_0x26a085});let _0x113863=new Date(_0x57d701[_0x5278cd(0x120)]),_0xdd3f0c=('0'+_0x113863['getDate']())[_0x5278cd(0xe1)](-0x2),_0x51355a=('0'+(_0x113863[_0x5278cd(0x111)]()+0x1))[_0x5278cd(0xe1)](-0x2),_0x5af80b=_0x113863[_0x5278cd(0x150)](),_0x544ccc=_0x5af80b+'-'+_0x51355a+'-'+_0xdd3f0c;var _0x52028c=[_0x5278cd(0xaf),_0x5278cd(0xcb),'Return\x20Rooms'];const _0xd61db8=await purchases[_0x5278cd(0xf2)]([{'$match':{'warehouse_name':_0x57d701['warehouse_name']}},{'$unwind':_0x5278cd(0x149)},{'$group':{'_id':_0x5278cd(0xa1)}}]);console[_0x5278cd(0x146)](_0x5278cd(0xb4),_0xd61db8);const _0x22e780=await product['find']({}),_0x2449ca=await warehouse[_0x5278cd(0xf2)]([{'$match':{'name':_0x57d701[_0x5278cd(0x124)],'room':_0x57d701[_0x5278cd(0xd2)]}},{'$unwind':_0x5278cd(0xc3)},{'$group':{'_id':_0x5278cd(0xc2),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5278cd(0xab)},'bay':{'$first':_0x5278cd(0x125)},'bin':{'$first':_0x5278cd(0x129)},'type':{'$first':_0x5278cd(0x108)},'floorlevel':{'$first':_0x5278cd(0xa5)},'primary_code':{'$first':_0x5278cd(0xc8)},'secondary_code':{'$first':_0x5278cd(0x15a)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5278cd(0xd7)},'rack':{'$first':'$product_details.rack'}}}]);if(_0x49957b[0x0]['language']==_0x5278cd(0xee)){var _0x554efa=users[_0x5278cd(0x10a)];console[_0x5278cd(0x146)](_0x554efa);}else{if(_0x49957b[0x0]['language']==_0x5278cd(0x115))var _0x554efa=users[_0x5278cd(0x115)];else{if(_0x49957b[0x0][_0x5278cd(0x114)]=='German')var _0x554efa=users['German'];else{if(_0x49957b[0x0][_0x5278cd(0x114)]=='Spanish')var _0x554efa=users[_0x5278cd(0xce)];else{if(_0x49957b[0x0]['language']==_0x5278cd(0x123))var _0x554efa=users[_0x5278cd(0x123)];else{if(_0x49957b[0x0][_0x5278cd(0x114)]=='Portuguese\x20(BR)')var _0x554efa=users['Portuguese'];else{if(_0x49957b[0x0][_0x5278cd(0x114)]==_0x5278cd(0x107))var _0x554efa=users[_0x5278cd(0x107)];else{if(_0x49957b[0x0][_0x5278cd(0x114)]==_0x5278cd(0xf1))var _0x554efa=users[_0x5278cd(0xe9)];}}}}}}}_0x5a77f5[_0x5278cd(0xf9)](_0x5278cd(0xf5),{'success':_0x5bc1fe['flash']('success'),'errors':_0x5bc1fe[_0x5278cd(0x138)](_0x5278cd(0xda)),'role':_0x8e6fe7,'profile':_0x457478,'adjustment':_0x57d701,'stock':_0x2449ca,'master_shop':_0x49957b,'warehouse_name':_0xd61db8,'unit':_0x22e780,'language':_0x554efa,'rooms_data':_0x52028c,'ed_fullDate':_0x544ccc});}catch(_0xd8bfcd){console['log'](_0xd8bfcd),_0x5a77f5[_0x5278cd(0x13b)](0xc8)[_0x5278cd(0xd4)]({'message':_0xd8bfcd[_0x5278cd(0x12f)]});}}),router['post'](a0_0x4c336d(0x121),auth,async(_0x9a18d,_0x23cd68)=>{var _0x1ced16=a0_0x4c336d;try{const _0x400ed1=_0x9a18d[_0x1ced16(0x14c)]['id'],_0x4eaeb7=await adjustment_finished[_0x1ced16(0x131)]({'_id':_0x400ed1}),_0x169bfe=await warehouse[_0x1ced16(0x134)]({'name':_0x4eaeb7[_0x1ced16(0x124)],'room':_0x4eaeb7[_0x1ced16(0xd2)]}),{warehouse_name:_0x458ba3,date:_0x2c7a5c,prod_name:_0x72bfc5,level:_0x494a76,isle:_0x4ae8ca,pallet:_0xa359bd,stock:_0x128496,types:_0x24137c,adjust_qty:_0x5a1a3d,new_adjust_qty:_0x366436,note:_0x25fb73,Room_name:_0x3c479e,invoice:_0x4d06bd,JO_number:_0x12ffab}=_0x9a18d[_0x1ced16(0x104)];if(typeof _0x72bfc5=='string')var _0x497a0c=[_0x9a18d[_0x1ced16(0x104)][_0x1ced16(0xcc)]],_0x2c0ef6=[_0x9a18d[_0x1ced16(0x104)]['level']],_0x2f9512=[_0x9a18d[_0x1ced16(0x104)][_0x1ced16(0xb8)]],_0x43df46=[_0x9a18d[_0x1ced16(0x104)][_0x1ced16(0xd5)]],_0x25566d=[_0x9a18d['body'][_0x1ced16(0x14e)]],_0xe0bf3d=[_0x9a18d[_0x1ced16(0x104)]['new_adjust_qty']],_0x187629=[_0x9a18d['body']['prod_code']],_0x4420e4=[_0x9a18d[_0x1ced16(0x104)]['unit']],_0x580d00=[_0x9a18d['body'][_0x1ced16(0xd1)]],_0x25edc2=[_0x9a18d[_0x1ced16(0x104)][_0x1ced16(0x10d)]],_0x3950d9=[_0x9a18d[_0x1ced16(0x104)][_0x1ced16(0x120)]];else var _0x497a0c=[..._0x9a18d['body']['prod_name']],_0x2c0ef6=[..._0x9a18d['body']['level']],_0x2f9512=[..._0x9a18d['body'][_0x1ced16(0xb8)]],_0x43df46=[..._0x9a18d[_0x1ced16(0x104)][_0x1ced16(0xd5)]],_0x25566d=[..._0x9a18d[_0x1ced16(0x104)][_0x1ced16(0x14e)]],_0xe0bf3d=[..._0x9a18d['body'][_0x1ced16(0x130)]],_0x187629=[..._0x9a18d['body'][_0x1ced16(0x139)]],_0x4420e4=[..._0x9a18d[_0x1ced16(0x104)][_0x1ced16(0x101)]],_0x580d00=[..._0x9a18d[_0x1ced16(0x104)][_0x1ced16(0xd1)]],_0x25edc2=[..._0x9a18d[_0x1ced16(0x104)][_0x1ced16(0x10d)]],_0x3950d9=[..._0x9a18d[_0x1ced16(0x104)][_0x1ced16(0x120)]];const _0x2eeaad=_0x497a0c[_0x1ced16(0xf0)](_0xd5df25=>{return _0xd5df25={'product_name':_0xd5df25};});_0x2c0ef6[_0x1ced16(0xdc)]((_0x578454,_0x541c4b)=>{var _0x456544=_0x1ced16;_0x2eeaad[_0x541c4b][_0x456544(0x113)]=_0x578454;}),_0x2f9512['forEach']((_0x5daa70,_0x467b53)=>{var _0x12e779=_0x1ced16;_0x2eeaad[_0x467b53][_0x12e779(0x144)]=_0x5daa70;}),_0x43df46[_0x1ced16(0xdc)]((_0x21edfb,_0x360a7c)=>{var _0x42af4f=_0x1ced16;_0x2eeaad[_0x360a7c][_0x42af4f(0xd5)]=_0x21edfb;}),_0x25566d[_0x1ced16(0xdc)]((_0x2901da,_0x5d6589)=>{var _0x2dfd26=_0x1ced16;_0x2eeaad[_0x5d6589][_0x2dfd26(0x14e)]=_0x2901da;}),_0xe0bf3d[_0x1ced16(0xdc)]((_0x196741,_0x250d69)=>{var _0x5f285f=_0x1ced16;_0x2eeaad[_0x250d69][_0x5f285f(0x130)]=_0x196741;}),_0x4420e4[_0x1ced16(0xdc)]((_0x4b925d,_0x1f6559)=>{var _0xa2f346=_0x1ced16;_0x2eeaad[_0x1f6559][_0xa2f346(0x101)]=_0x4b925d;}),_0x580d00[_0x1ced16(0xdc)]((_0x3dbf54,_0x209c37)=>{var _0x238bc9=_0x1ced16;_0x2eeaad[_0x209c37][_0x238bc9(0x127)]=_0x3dbf54;}),_0x187629[_0x1ced16(0xdc)]((_0x2a7ab0,_0x4544f5)=>{var _0x50268a=_0x1ced16;_0x2eeaad[_0x4544f5][_0x50268a(0xa2)]=_0x2a7ab0;}),_0x25edc2[_0x1ced16(0xdc)]((_0x35e56a,_0x1cb94a)=>{var _0x508a25=_0x1ced16;_0x2eeaad[_0x1cb94a][_0x508a25(0x10d)]=_0x35e56a;}),_0x3950d9[_0x1ced16(0xdc)]((_0x4f41f4,_0x10f0f6)=>{var _0x11bf75=_0x1ced16;_0x2eeaad[_0x10f0f6][_0x11bf75(0x120)]=_0x4f41f4;});const _0x5e54f7=_0x2eeaad[_0x1ced16(0x128)](_0x560205=>_0x560205[_0x1ced16(0x14e)]!=='0'&&_0x560205['adjust_qty']!=='');var _0x23bc24=0x0;_0x5e54f7[_0x1ced16(0xdc)](_0xd529ce=>{var _0x4597ec=_0x1ced16;console[_0x4597ec(0x146)](_0x4597ec(0xbf),_0xd529ce),parseInt(_0xd529ce['adjust_qty'])<=0x0&&_0x23bc24++;});if(_0x23bc24!=0x0)return _0x9a18d['flash'](_0x1ced16(0xda),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x23cd68['redirect'](_0x1ced16(0xb2));_0x4eaeb7['warehouse_name']=_0x458ba3,_0x4eaeb7[_0x1ced16(0x159)]=_0x2c7a5c,_0x4eaeb7[_0x1ced16(0x118)]=_0x5e54f7,_0x4eaeb7[_0x1ced16(0xc9)]=_0x25fb73,_0x4eaeb7['room']=_0x3c479e,_0x4eaeb7[_0x1ced16(0xe7)]=_0x4d06bd,_0x4eaeb7[_0x1ced16(0x14b)]=_0x12ffab;const _0x3a0904=await _0x4eaeb7[_0x1ced16(0xe4)](),_0x483716=await warehouse[_0x1ced16(0x134)]({'name':_0x458ba3,'room':_0x3c479e});_0x3a0904[_0x1ced16(0x118)]['forEach'](_0x3f29d5=>{var _0xd41197=_0x1ced16;const _0x211d88=_0x483716[_0xd41197(0xad)][_0xd41197(0xf0)](_0x570850=>{var _0x431c40=_0xd41197;_0x3f29d5[_0x431c40(0xd5)]==_0x431c40(0xaa)?_0x570850[_0x431c40(0x136)]==_0x3f29d5[_0x431c40(0x136)]&&_0x570850['bay']==_0x3f29d5['bay']&&(_0x570850[_0x431c40(0x157)]=parseInt(_0x570850[_0x431c40(0x157)])-parseInt(_0x3f29d5[_0x431c40(0x14e)])):_0x570850[_0x431c40(0x136)]==_0x3f29d5[_0x431c40(0x136)]&&_0x570850[_0x431c40(0x113)]==_0x3f29d5[_0x431c40(0x113)]&&(_0x570850['product_stock']=parseInt(_0x570850['product_stock'])+parseInt(_0x3f29d5['adjust_qty']));});}),await _0x483716[_0x1ced16(0xe4)](),_0x9a18d[_0x1ced16(0x138)]('success',_0x1ced16(0xbe)),_0x23cd68[_0x1ced16(0x110)](_0x1ced16(0x151));}catch(_0x2a58c5){console[_0x1ced16(0x146)](_0x2a58c5);}}),router[a0_0x4c336d(0xec)](a0_0x4c336d(0x133),async(_0x46aab4,_0x30b972)=>{var _0xf68d04=a0_0x4c336d;const {primary_code:_0x38e7cb,warehouse_data:_0x4dc639,rooms_data:_0x220796,Roomslist:_0xbfa754}=_0x46aab4[_0xf68d04(0x104)],_0x25b690=_0xbfa754[_0xf68d04(0xb3)](','),_0x204914=[];async function _0x4d4298(_0x4f6bfa){var _0x60451f=_0xf68d04;const _0x2c3bfd=await warehouse[_0x60451f(0xf2)]([{'$match':{'name':_0x4dc639,'room':_0x4f6bfa}},{'$unwind':_0x60451f(0xc3)},{'$match':{'product_details.primary_code':_0x38e7cb}},{'$group':{'_id':_0x60451f(0xc2),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x60451f(0xab)},'primary_code':{'$first':_0x60451f(0xc8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.level'},'bay':{'$first':_0x60451f(0x125)},'type':{'$first':_0x60451f(0x108)},'pallet':{'$first':_0x60451f(0xa5)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x60451f(0xde)},'storage':{'$first':_0x60451f(0xd7)},'rack':{'$first':_0x60451f(0xdd)},'expiry_date':{'$first':_0x60451f(0xbd)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x60451f(0xc7)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x60451f(0xf8)},'roomNamed':{'$first':_0x60451f(0xc1)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x553c34=await warehouse['aggregate']([{'$match':{'name':_0x4dc639,'room':_0x4f6bfa}},{'$unwind':_0x60451f(0xc3)},{'$match':{'product_details.secondary_code':_0x38e7cb}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x60451f(0xeb)},'product_stock':{'$first':_0x60451f(0xab)},'primary_code':{'$first':_0x60451f(0xc8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x60451f(0x11e)},'level':{'$first':'$product_details.level'},'bay':{'$first':_0x60451f(0x125)},'type':{'$first':_0x60451f(0x108)},'pallet':{'$first':_0x60451f(0xa5)},'unit':{'$first':_0x60451f(0xe5)},'secondary_unit':{'$first':_0x60451f(0xde)},'storage':{'$first':_0x60451f(0xd7)},'rack':{'$first':_0x60451f(0xdd)},'expiry_date':{'$first':_0x60451f(0xbd)},'production_date':{'$first':_0x60451f(0xf4)},'batch_code':{'$first':_0x60451f(0xc7)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x60451f(0xc1)},'invoice':{'$first':_0x60451f(0xa9)}}}]);if(_0x2c3bfd[_0x60451f(0xae)]>0x0)_0x204914['push'](_0x2c3bfd);else _0x553c34[_0x60451f(0xae)]>0x0&&_0x204914[_0x60451f(0x12b)](_0x553c34);}const _0x174184=_0x25b690[_0xf68d04(0xf0)](_0x494bb3=>_0x4d4298(_0x494bb3));await Promise['all'](_0x174184),_0x30b972[_0xf68d04(0xd4)](_0x204914);}),router[a0_0x4c336d(0xec)](a0_0x4c336d(0xd6),async(_0x28c51f,_0x19e581)=>{var _0x2152ac=a0_0x4c336d;const {productCode:_0x5b9a7a,bay:_0x3d155b,warehouses:_0x161385,room:_0x16bc89}=_0x28c51f[_0x2152ac(0x104)];console[_0x2152ac(0x146)](_0x28c51f[_0x2152ac(0x104)]);try{const _0x55bb8b=await warehouse['aggregate']([{'$match':{'name':_0x161385,'room':_0x16bc89}},{'$unwind':_0x2152ac(0xc3)},{'$match':{'product_details.bay':parseInt(_0x3d155b)}},{'$group':{'_id':_0x2152ac(0xc2),'name':{'$first':_0x2152ac(0xeb)},'product_stock':{'$first':_0x2152ac(0xab)},'bay':{'$first':_0x2152ac(0x125)},'maxProducts':{'$first':_0x2152ac(0x153)}}}]);_0x19e581['status'](0xc8)[_0x2152ac(0xd4)](_0x55bb8b);}catch(_0x3871b5){_0x19e581['status'](0x194)[_0x2152ac(0xd4)]({'message':_0x3871b5['message']});}}),module['exports']=router;