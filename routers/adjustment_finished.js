var a0_0x231f6b=a0_0x5d18;(function(_0x2c4ff0,_0x16c2dd){var _0x328bbb=a0_0x5d18,_0x35177c=_0x2c4ff0();while(!![]){try{var _0x388393=parseInt(_0x328bbb(0x19f))/0x1*(parseInt(_0x328bbb(0x17f))/0x2)+-parseInt(_0x328bbb(0x1cd))/0x3*(parseInt(_0x328bbb(0x1b5))/0x4)+parseInt(_0x328bbb(0x19b))/0x5*(-parseInt(_0x328bbb(0x17c))/0x6)+parseInt(_0x328bbb(0x1f3))/0x7*(-parseInt(_0x328bbb(0x17e))/0x8)+-parseInt(_0x328bbb(0x1fa))/0x9*(parseInt(_0x328bbb(0x1cc))/0xa)+parseInt(_0x328bbb(0x167))/0xb*(-parseInt(_0x328bbb(0x16c))/0xc)+parseInt(_0x328bbb(0x1be))/0xd;if(_0x388393===_0x16c2dd)break;else _0x35177c['push'](_0x35177c['shift']());}catch(_0x58db2d){_0x35177c['push'](_0x35177c['shift']());}}}(a0_0xe308,0xbca27));const express=require('express'),app=express(),router=express[a0_0x231f6b(0x16a)](),auth=require(a0_0x231f6b(0x1e0)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_logs,adjustment_finished,email_settings,supervisor_settings,invoice_for_adjustment}=require(a0_0x231f6b(0x208)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x231f6b(0x1ee));router[a0_0x231f6b(0x210)](a0_0x231f6b(0x1d0),auth,async(_0x93330c,_0x42f496)=>{var _0x1ad56c=a0_0x231f6b;try{const {username:_0x46d33f,email:_0x4755a6,role:_0x305099}=_0x93330c[_0x1ad56c(0x1a5)],_0x4dbac7=_0x93330c[_0x1ad56c(0x1a5)],_0x42a277=await profile[_0x1ad56c(0x1f2)]({'email':_0x4dbac7[_0x1ad56c(0x204)]}),_0x16af57=await master_shop[_0x1ad56c(0x1bd)]();let _0xdae24b;if(_0x4dbac7[_0x1ad56c(0x195)]==_0x1ad56c(0x1c0)){const _0x1b611b=await staff[_0x1ad56c(0x1f2)]({'email':_0x4dbac7[_0x1ad56c(0x204)]});_0xdae24b=await warehouse['find']({'status':_0x1ad56c(0x1de),'name':_0x1b611b['warehouse']});}else _0xdae24b=await warehouse['find']({'status':_0x1ad56c(0x1de)});const _0x4c11a2=await product[_0x1ad56c(0x1bd)]();let _0x4e9e91;if(_0x4dbac7[_0x1ad56c(0x195)]==_0x1ad56c(0x1c0)){const _0x26b45b=await staff[_0x1ad56c(0x1f2)]({'email':_0x4dbac7[_0x1ad56c(0x204)]});_0x4e9e91=await adjustment_finished['find']({'warehouse_name':_0x26b45b[_0x1ad56c(0x20d)]});}else _0x4e9e91=await adjustment_finished[_0x1ad56c(0x1f4)]([{'$match':{'type_of_transaction':_0x1ad56c(0x214)}},{'$unwind':_0x1ad56c(0x1d1)},{'$group':{'_id':_0x1ad56c(0x20e),'invoice':{'$first':_0x1ad56c(0x1cf)},'date':{'$first':_0x1ad56c(0x1e2)},'warehouse_name':{'$first':_0x1ad56c(0x213)},'room':{'$addToSet':_0x1ad56c(0x1a1)},'finalize':{'$first':_0x1ad56c(0x197)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x16af57[0x0][_0x1ad56c(0x1c3)]==_0x1ad56c(0x192)){var _0x5e4b2c=users['English'];console[_0x1ad56c(0x161)](_0x5e4b2c);}else{if(_0x16af57[0x0][_0x1ad56c(0x1c3)]==_0x1ad56c(0x16b))var _0x5e4b2c=users[_0x1ad56c(0x16b)];else{if(_0x16af57[0x0][_0x1ad56c(0x1c3)]==_0x1ad56c(0x1c7))var _0x5e4b2c=users[_0x1ad56c(0x1c7)];else{if(_0x16af57[0x0][_0x1ad56c(0x1c3)]==_0x1ad56c(0x1d4))var _0x5e4b2c=users[_0x1ad56c(0x1d4)];else{if(_0x16af57[0x0][_0x1ad56c(0x1c3)]==_0x1ad56c(0x196))var _0x5e4b2c=users[_0x1ad56c(0x196)];else{if(_0x16af57[0x0][_0x1ad56c(0x1c3)]==_0x1ad56c(0x169))var _0x5e4b2c=users[_0x1ad56c(0x18b)];else{if(_0x16af57[0x0]['language']==_0x1ad56c(0x171))var _0x5e4b2c=users[_0x1ad56c(0x171)];else{if(_0x16af57[0x0][_0x1ad56c(0x1c3)]==_0x1ad56c(0x187))var _0x5e4b2c=users[_0x1ad56c(0x1fb)];}}}}}}}_0x42f496[_0x1ad56c(0x1b6)](_0x1ad56c(0x1ae),{'success':_0x93330c['flash'](_0x1ad56c(0x165)),'errors':_0x93330c[_0x1ad56c(0x1ca)](_0x1ad56c(0x1d3)),'role':_0x4dbac7,'profile':_0x42a277,'warehouse':_0xdae24b,'product':_0x4c11a2,'adjustment':_0x4e9e91,'master_shop':_0x16af57,'language':_0x5e4b2c});}catch(_0x783352){console[_0x1ad56c(0x161)](_0x783352);}}),router[a0_0x231f6b(0x210)](a0_0x231f6b(0x1eb),auth,async(_0x2235cf,_0x33bbc3)=>{var _0x4adf78=a0_0x231f6b;try{const {username:_0x2092db,email:_0x3a3226,role:_0x270485}=_0x2235cf[_0x4adf78(0x1a5)],_0x2d4e07=_0x2235cf[_0x4adf78(0x1a5)],_0x35adae=await profile[_0x4adf78(0x1f2)]({'email':_0x2d4e07[_0x4adf78(0x204)]}),_0x5c6a70=await master_shop[_0x4adf78(0x1bd)]();let _0x5b6a5c;if(_0x2d4e07['role']==_0x4adf78(0x1c0)){const _0x129514=await staff[_0x4adf78(0x1f2)]({'email':_0x2d4e07['email']});_0x5b6a5c=await warehouse[_0x4adf78(0x1bd)]({'status':_0x4adf78(0x1de),'name':_0x129514[_0x4adf78(0x20d)]});}else _0x5b6a5c=await warehouse[_0x4adf78(0x1bd)]({'status':_0x4adf78(0x1de)});const _0x2fadbb=await product[_0x4adf78(0x1bd)]();let _0x1b048d;if(_0x2d4e07[_0x4adf78(0x195)]==_0x4adf78(0x1c0)){const _0x380c23=await staff[_0x4adf78(0x1f2)]({'email':_0x2d4e07[_0x4adf78(0x204)]});_0x1b048d=await adjustment_finished[_0x4adf78(0x1bd)]({'warehouse_name':_0x380c23['warehouse']});}else _0x1b048d=await adjustment_finished[_0x4adf78(0x1f4)]([{'$match':{'type_of_transaction':'logs'}},{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x4adf78(0x1cf)},'date':{'$first':_0x4adf78(0x1e2)},'warehouse_name':{'$first':_0x4adf78(0x213)},'room':{'$addToSet':_0x4adf78(0x1a1)},'finalize':{'$first':_0x4adf78(0x197)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x5c6a70[0x0]['language']=='English\x20(US)')var _0x5946a7=users[_0x4adf78(0x1e5)];else{if(_0x5c6a70[0x0][_0x4adf78(0x1c3)]==_0x4adf78(0x16b))var _0x5946a7=users[_0x4adf78(0x16b)];else{if(_0x5c6a70[0x0][_0x4adf78(0x1c3)]=='German')var _0x5946a7=users[_0x4adf78(0x1c7)];else{if(_0x5c6a70[0x0][_0x4adf78(0x1c3)]==_0x4adf78(0x1d4))var _0x5946a7=users[_0x4adf78(0x1d4)];else{if(_0x5c6a70[0x0][_0x4adf78(0x1c3)]==_0x4adf78(0x196))var _0x5946a7=users[_0x4adf78(0x196)];else{if(_0x5c6a70[0x0][_0x4adf78(0x1c3)]==_0x4adf78(0x169))var _0x5946a7=users['Portuguese'];else{if(_0x5c6a70[0x0]['language']=='Chinese')var _0x5946a7=users[_0x4adf78(0x171)];else{if(_0x5c6a70[0x0][_0x4adf78(0x1c3)]==_0x4adf78(0x187))var _0x5946a7=users[_0x4adf78(0x1fb)];}}}}}}}_0x33bbc3[_0x4adf78(0x1b6)](_0x4adf78(0x1a7),{'success':_0x2235cf['flash']('success'),'errors':_0x2235cf[_0x4adf78(0x1ca)](_0x4adf78(0x1d3)),'role':_0x2d4e07,'profile':_0x35adae,'warehouse':_0x5b6a5c,'product':_0x2fadbb,'adjustment':_0x1b048d,'master_shop':_0x5c6a70,'language':_0x5946a7});}catch(_0x4f545b){console[_0x4adf78(0x161)](_0x4f545b);}});function a0_0xe308(){var _0x4988c6=['$product_details','post','$warehouse_name','own','/view/add_adjustment','log','/CheckingWarehouse','stock','adjust_qty','success','types','11FEVvnN','product_code','Portuguese\x20(BR)','Router','Hindi','15648084TqKbWs','ADJF-','finalize','An\x20error\x20occurred\x20while\x20saving\x20data.','add_adjustment_finished','Chinese','product_details','product_date','length','$product_details.type','floor','/view/add_adjustment_logs','invoice_init','DRY\x20GOODS','True','then','1824lwRKux','add','123776btIvEI','2EUuPKj','Primary_Units','/adjustment_finished/preview/','Rooms','id_transaction_from','product_name','date','prod_name','Arabic\x20(ae)','foreach\x20newproduct','product','catch','Portuguese','bay','edit_adjustment_finished_view','prod_code','$product_details.primary_code','</tr>','prod_invoice','English\x20(US)','$product_details.batch_code','body','role','French','$finalize','adjustment\x20add\x20successfull','master','Ambient','3865EPpmef','ADJ-','warehouse_name','$product.product_name','600179ZOaIUU','$product_details.bay','$product.room_names','$product_details.expiry_date','level','maxPerUnit','user','padStart','adjustment_finished_logs','$product_details.invoice','message','forEach','getFullYear','stockBefore','add_adjustment_finished_logs','adjustment_finished','$product_details.product_stock','new_adjust_qty','product_stock','$product_details.floorlevel','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','split','4fhClkk','render','$product_details.product_code','_id','New_Qty_Converted_adj','<tr>','invoice','back','find','54566200OFRrFM','secondary_unit','staff','LOG-ADJ-','/picking_list/PDF_adjustmentFinal/','language','minus','map','$product_details._id','German','unit','$room','flash','Enclosed','2116640JcFMhL','987303rkLLKS','json','$invoice','/view','$product','JO_number','errors','Spanish','/preview/:id','status','New_Qty_Converted','redirect','push','save','purchases_data','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.product_name','Enabled','match','../middleware/auth','id_transaction','$date','room_names','Secondary_units','English','An\x20error\x20occurred.','$name','random','Return\x20Rooms','$product_details.maxProducts','/view_logs','$product_details.secondary_unit','$product_details.secondary_code','nodemailer','prod_cat','params','$product_details.production_date','findOne','497qcTyya','aggregate','$product_details.maxPerUnit','slice','string','/adjustment_finished/view','$product_details.bin','45vAJmvL','Arabic','filter','$product_details.rack','all','/view/:id','findById','error','</td>','adjustment\x20data\x20update\x20successfully','email','/adjustment/view','$product_details.level','$product_details.storage','../models/all_models','toString','production_date','expiry_date','batch_code','warehouse','$_id','Adjustment\x20Finalize\x20Successfully','get'];a0_0xe308=function(){return _0x4988c6;};return a0_0xe308();}async function getRandom8DigitNumber(){var _0x22ecd9=a0_0x231f6b;const _0x51476a=0x989680,_0x549d2c=0x5f5e0ff,_0x2566f1=Math[_0x22ecd9(0x176)](Math[_0x22ecd9(0x1e8)]()*(_0x549d2c-_0x51476a+0x1))+_0x51476a;var _0x4b2fc8;const _0x351da0=await adjustment_finished[_0x22ecd9(0x1f2)]({'invoice':'ADJF-'+_0x2566f1});return _0x351da0&&_0x351da0[_0x22ecd9(0x174)]>0x0?_0x4b2fc8=_0x22ecd9(0x16d)+_0x2566f1:_0x4b2fc8='ADJF-'+_0x2566f1,_0x4b2fc8;}function a0_0x5d18(_0x2b59e1,_0x3968b8){var _0xe30851=a0_0xe308();return a0_0x5d18=function(_0x5d18ff,_0x21dd14){_0x5d18ff=_0x5d18ff-0x160;var _0x411d21=_0xe30851[_0x5d18ff];return _0x411d21;},a0_0x5d18(_0x2b59e1,_0x3968b8);}router[a0_0x231f6b(0x210)]('/view/add_adjustment',auth,async(_0x32a503,_0x23c794)=>{var _0x30b5fd=a0_0x231f6b;try{const {username:_0xaad4d0,email:_0x4681a5,role:_0x3ec5aa}=_0x32a503[_0x30b5fd(0x1a5)],_0x2b585e=_0x32a503[_0x30b5fd(0x1a5)],_0x38adde=await profile[_0x30b5fd(0x1f2)]({'email':_0x2b585e[_0x30b5fd(0x204)]}),_0x497ad=await master_shop['find']();let _0x4ba700;if(_0x2b585e[_0x30b5fd(0x195)]=='staff'){const _0x37c3f4=await staff['findOne']({'email':_0x2b585e[_0x30b5fd(0x204)]});_0x4ba700=await warehouse[_0x30b5fd(0x1f4)]([{'$match':{'status':_0x30b5fd(0x1de),'name':_0x37c3f4[_0x30b5fd(0x20d)]}},{'$group':{'_id':_0x30b5fd(0x1e7),'name':{'$first':'$name'}}}]);}else _0x4ba700=await warehouse[_0x30b5fd(0x1f4)]([{'$match':{'status':_0x30b5fd(0x1de)}},{'$group':{'_id':_0x30b5fd(0x1e7),'name':{'$first':_0x30b5fd(0x1e7)}}}]);const _0x481e04=await product['find']({}),_0xb1ee91=await adjustment_finished[_0x30b5fd(0x1bd)](),_0x5974cd=_0xb1ee91[_0x30b5fd(0x174)]+0x1,_0x4d8c3d='ADJF-'+_0x5974cd['toString']()['padStart'](0x5,'0');var _0x1ea93f=[_0x30b5fd(0x19a),'Enclosed',_0x30b5fd(0x1e9)];if(_0x497ad[0x0]['language']==_0x30b5fd(0x192))var _0x5d07fa=users[_0x30b5fd(0x1e5)];else{if(_0x497ad[0x0][_0x30b5fd(0x1c3)]=='Hindi')var _0x5d07fa=users['Hindi'];else{if(_0x497ad[0x0][_0x30b5fd(0x1c3)]==_0x30b5fd(0x1c7))var _0x5d07fa=users[_0x30b5fd(0x1c7)];else{if(_0x497ad[0x0]['language']==_0x30b5fd(0x1d4))var _0x5d07fa=users[_0x30b5fd(0x1d4)];else{if(_0x497ad[0x0][_0x30b5fd(0x1c3)]==_0x30b5fd(0x196))var _0x5d07fa=users[_0x30b5fd(0x196)];else{if(_0x497ad[0x0][_0x30b5fd(0x1c3)]==_0x30b5fd(0x169))var _0x5d07fa=users[_0x30b5fd(0x18b)];else{if(_0x497ad[0x0]['language']==_0x30b5fd(0x171))var _0x5d07fa=users[_0x30b5fd(0x171)];else{if(_0x497ad[0x0][_0x30b5fd(0x1c3)]=='Arabic\x20(ae)')var _0x5d07fa=users[_0x30b5fd(0x1fb)];}}}}}}}const _0x294827=getRandom8DigitNumber();_0x294827['then'](_0x11f112=>{var _0x19602b=_0x30b5fd;_0x23c794[_0x19602b(0x1b6)](_0x19602b(0x170),{'success':_0x32a503[_0x19602b(0x1ca)]('success'),'errors':_0x32a503['flash'](_0x19602b(0x1d3)),'role':_0x2b585e,'profile':_0x38adde,'warehouse':_0x4ba700,'product':_0x481e04,'master_shop':_0x497ad,'language':_0x5d07fa,'rooms_data':_0x1ea93f,'invoice_no':_0x11f112});})[_0x30b5fd(0x18a)](_0x2e09b1=>{var _0x1f9d7c=_0x30b5fd;_0x32a503[_0x1f9d7c(0x1ca)](_0x1f9d7c(0x1d3),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x23c794[_0x1f9d7c(0x1d8)](_0x1f9d7c(0x205));});}catch(_0x430519){console['log'](_0x430519);}}),router[a0_0x231f6b(0x212)](a0_0x231f6b(0x160),auth,async(_0x5dc0a5,_0x17ebb7)=>{var _0x5dd663=a0_0x231f6b;try{const {warehouse_name:_0x46b594,date:_0x208be9,prod_name:_0x2a098e,level:_0x41012a,isle:_0x309443,pallet:_0x4f8af8,stock:_0x76684e,types:_0x42566b,adjust_qty:_0x372058,new_adjust_qty:_0x502760,note:_0x56f1c8,Room_name:_0x58abb2,JO_number:_0x10ab49,expiry_date:_0x3da9a3,PO_number:_0xb8218e,ReqBy:_0x2fe150,dateofreq:_0x5e16f9,typeservicesData:_0x147f38,destination:_0xed3834,deliverydate:_0x3454de,driver:_0x13dc50,plate:_0x49b206,van:_0x63e6a8,DRSI:_0x33061b,typevehicle:_0x3ef682,TSU:_0x5e8dee,TFU:_0x37c4df}=_0x5dc0a5[_0x5dd663(0x194)];if(typeof _0x2a098e==_0x5dd663(0x1f7))var _0x59df0a=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x186)]],_0x50126d=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x1a3)]],_0x249dc7=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x163)]],_0x56bf14=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x166)]],_0x28bb1e=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x1b9)]],_0x5a668e=[_0x5dc0a5['body'][_0x5dd663(0x1d7)]],_0x230366=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x180)]],_0x10b9c1=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x1e4)]],_0x5e45e9=[_0x5dc0a5['body'][_0x5dd663(0x18e)]],_0x395039=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x20c)]],_0x4527be=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x20b)]],_0x437216=[_0x5dc0a5['body'][_0x5dd663(0x173)]],_0x170b07=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x1ef)]],_0x476e8f=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x182)]],_0x1d19f1=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x1a4)]],_0x5eff80=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x191)]],_0x2de02b=[_0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x183)]];else var _0x59df0a=[..._0x5dc0a5['body'][_0x5dd663(0x186)]],_0x50126d=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x1a3)]],_0x249dc7=[..._0x5dc0a5[_0x5dd663(0x194)]['stock']],_0x56bf14=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x166)]],_0x28bb1e=[..._0x5dc0a5['body'][_0x5dd663(0x1b9)]],_0x5a668e=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x1d7)]],_0x230366=[..._0x5dc0a5[_0x5dd663(0x194)]['Primary_Units']],_0x10b9c1=[..._0x5dc0a5['body'][_0x5dd663(0x1e4)]],_0x5e45e9=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x18e)]],_0x395039=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x20c)]],_0x4527be=[..._0x5dc0a5[_0x5dd663(0x194)]['expiry_date']],_0x437216=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x173)]],_0x170b07=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x1ef)]],_0x476e8f=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x182)]],_0x1d19f1=[..._0x5dc0a5['body']['maxPerUnit']],_0x5eff80=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x191)]],_0x2de02b=[..._0x5dc0a5[_0x5dd663(0x194)][_0x5dd663(0x183)]];const _0x50f674=_0x59df0a[_0x5dd663(0x1c5)](_0x5e2d8b=>{return _0x5e2d8b={'product_name':_0x5e2d8b};});_0x50126d[_0x5dd663(0x1aa)]((_0x22e353,_0x307d1e)=>{var _0x85325c=_0x5dd663,_0x283aa1=_0x22e353['match'](/[A-Za-z]+/)[0x0],_0x176cf7=parseInt(_0x22e353['match'](/\d+/)[0x0]);_0x50f674[_0x307d1e][_0x85325c(0x1a3)]=_0x283aa1,_0x50f674[_0x307d1e][_0x85325c(0x18c)]=_0x176cf7;}),_0x2de02b['forEach']((_0x4e5878,_0x2231fe)=>{var _0x200dda=_0x5dd663;_0x50f674[_0x2231fe][_0x200dda(0x1e1)]=_0x4e5878;}),_0x249dc7['forEach']((_0x3f6a3b,_0x4889be)=>{_0x50f674[_0x4889be]['stockBefore']=_0x3f6a3b;}),_0x56bf14['forEach']((_0x3b4bdf,_0x2e0d37)=>{var _0x2435fb=_0x5dd663;_0x50f674[_0x2e0d37][_0x2435fb(0x166)]=_0x3b4bdf;}),_0x28bb1e[_0x5dd663(0x1aa)]((_0x4f11c9,_0x396e86)=>{var _0x4dc1b4=_0x5dd663;_0x50f674[_0x396e86][_0x4dc1b4(0x164)]=_0x4f11c9;}),_0x5a668e[_0x5dd663(0x1aa)]((_0x333ae4,_0x2a3c83)=>{var _0x154ee7=_0x5dd663;_0x50f674[_0x2a3c83][_0x154ee7(0x1b0)]=_0x333ae4;}),_0x230366[_0x5dd663(0x1aa)]((_0x5ad882,_0x1c9317)=>{var _0x4f4980=_0x5dd663;_0x50f674[_0x1c9317][_0x4f4980(0x1c8)]=_0x5ad882;}),_0x10b9c1[_0x5dd663(0x1aa)]((_0xe91dfe,_0x58904f)=>{var _0x36644b=_0x5dd663;_0x50f674[_0x58904f][_0x36644b(0x1bf)]=_0xe91dfe;}),_0x5e45e9['forEach']((_0x4f0334,_0x42f159)=>{_0x50f674[_0x42f159]['product_code']=_0x4f0334;}),_0x395039[_0x5dd663(0x1aa)]((_0x5419b2,_0x261c7c)=>{var _0x495251=_0x5dd663;_0x50f674[_0x261c7c][_0x495251(0x20c)]=_0x5419b2;}),_0x4527be[_0x5dd663(0x1aa)]((_0x177cef,_0x4686f3)=>{var _0x1e7396=_0x5dd663;_0x50f674[_0x4686f3][_0x1e7396(0x20b)]=_0x177cef;}),_0x437216['forEach']((_0x36df04,_0x5ebdea)=>{var _0x33d946=_0x5dd663;_0x50f674[_0x5ebdea][_0x33d946(0x20a)]=_0x36df04;}),_0x170b07[_0x5dd663(0x1aa)]((_0x11292d,_0x59d4e9)=>{_0x50f674[_0x59d4e9]['prod_cat']=_0x11292d;}),_0x476e8f[_0x5dd663(0x1aa)]((_0x3c4214,_0x45a3e3)=>{var _0x595ccf=_0x5dd663;_0x50f674[_0x45a3e3][_0x595ccf(0x1e3)]=_0x3c4214;}),_0x1d19f1['forEach']((_0x8e8f8e,_0x162add)=>{_0x50f674[_0x162add]['maxPerUnit']=_0x8e8f8e;}),_0x5eff80[_0x5dd663(0x1aa)]((_0xee2973,_0x36b94f)=>{_0x50f674[_0x36b94f]['invoice']=_0xee2973;});const _0x1b3c78=_0x50f674[_0x5dd663(0x1fc)](_0x17e28d=>_0x17e28d[_0x5dd663(0x164)]!=='0'&&_0x17e28d[_0x5dd663(0x164)]!=='');var _0x191add=0x0;_0x1b3c78['forEach'](_0x596961=>{var _0x8e4e42=_0x5dd663;console[_0x8e4e42(0x161)]('foreach\x20newproduct',_0x596961),parseInt(_0x596961[_0x8e4e42(0x164)])<=0x0&&_0x191add++;});if(_0x191add!=0x0)return _0x5dc0a5['flash'](_0x5dd663(0x1d3),_0x5dd663(0x1dc)),_0x17ebb7[_0x5dd663(0x1d8)]('back');const _0x29a454=new invoice_for_adjustment();await _0x29a454[_0x5dd663(0x1da)]();const _0x4b8927=new adjustment_finished({'warehouse_name':_0x46b594,'date':_0x208be9,'product':_0x1b3c78,'note':_0x56f1c8,'room':_0x58abb2,'invoice':_0x5dd663(0x19c)+_0x29a454[_0x5dd663(0x178)][_0x5dd663(0x209)]()[_0x5dd663(0x1a6)](0x8,'0'),'JO_number':_0x10ab49,'expiry_date':_0x3da9a3,'PO_number':_0xb8218e,'RequestedBy':_0x2fe150,'DateofRequest':_0x5e16f9,'typeservices':_0x147f38,'destination':_0xed3834,'deliverydate':_0x3454de,'driver':_0x13dc50,'plate':_0x49b206,'van':_0x63e6a8,'DRSI':_0x33061b,'typevehicle':_0x3ef682,'TSU':_0x5e8dee,'TFU':_0x37c4df}),_0x14059b=await _0x4b8927[_0x5dd663(0x1da)]();_0x5dc0a5[_0x5dd663(0x1ca)](_0x5dd663(0x165),_0x5dd663(0x198)),_0x17ebb7[_0x5dd663(0x1d8)](_0x5dd663(0x181)+_0x14059b[_0x5dd663(0x1b8)]);}catch(_0x7e9ab7){console[_0x5dd663(0x161)](_0x7e9ab7),_0x17ebb7[_0x5dd663(0x1d6)](0xc8)[_0x5dd663(0x1ce)]({'message':_0x7e9ab7[_0x5dd663(0x1a9)]});}}),router['get'](a0_0x231f6b(0x177),auth,async(_0x1eae92,_0xdb81f0)=>{var _0x17f92d=a0_0x231f6b;try{const {username:_0x389077,email:_0x3588eb,role:_0x30bfb8}=_0x1eae92[_0x17f92d(0x1a5)],_0x3e156b=_0x1eae92[_0x17f92d(0x1a5)],_0x230182=await profile['findOne']({'email':_0x3e156b[_0x17f92d(0x204)]}),_0x53fca3=await master_shop[_0x17f92d(0x1bd)]();let _0x811afd;if(_0x3e156b[_0x17f92d(0x195)]=='staff'){const _0x151955=await staff[_0x17f92d(0x1f2)]({'email':_0x3e156b[_0x17f92d(0x204)]});_0x811afd=await warehouse[_0x17f92d(0x1f4)]([{'$match':{'status':_0x17f92d(0x1de),'name':_0x151955[_0x17f92d(0x20d)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x811afd=await warehouse[_0x17f92d(0x1f4)]([{'$match':{'status':_0x17f92d(0x1de)}},{'$group':{'_id':_0x17f92d(0x1e7),'name':{'$first':_0x17f92d(0x1e7)}}}]);const _0x43c804=await product[_0x17f92d(0x1bd)](),_0x4b038f=await adjustment_finished[_0x17f92d(0x1bd)](),_0x45d222=_0x4b038f[_0x17f92d(0x174)]+0x1,_0x5dcb79=_0x17f92d(0x16d)+_0x45d222[_0x17f92d(0x209)]()[_0x17f92d(0x1a6)](0x5,'0');var _0x3a7fe9=['Ambient',_0x17f92d(0x1cb),'Return\x20Rooms'];if(_0x53fca3[0x0]['language']==_0x17f92d(0x192))var _0x37fc49=users[_0x17f92d(0x1e5)];else{if(_0x53fca3[0x0][_0x17f92d(0x1c3)]=='Hindi')var _0x37fc49=users[_0x17f92d(0x16b)];else{if(_0x53fca3[0x0][_0x17f92d(0x1c3)]==_0x17f92d(0x1c7))var _0x37fc49=users[_0x17f92d(0x1c7)];else{if(_0x53fca3[0x0][_0x17f92d(0x1c3)]==_0x17f92d(0x1d4))var _0x37fc49=users[_0x17f92d(0x1d4)];else{if(_0x53fca3[0x0][_0x17f92d(0x1c3)]==_0x17f92d(0x196))var _0x37fc49=users[_0x17f92d(0x196)];else{if(_0x53fca3[0x0]['language']==_0x17f92d(0x169))var _0x37fc49=users[_0x17f92d(0x18b)];else{if(_0x53fca3[0x0]['language']==_0x17f92d(0x171))var _0x37fc49=users[_0x17f92d(0x171)];else{if(_0x53fca3[0x0][_0x17f92d(0x1c3)]=='Arabic\x20(ae)')var _0x37fc49=users['Arabic'];}}}}}}}const _0x1619ff=getRandom8DigitNumber();_0x1619ff['then'](_0x5c5d23=>{var _0x2956b8=_0x17f92d;_0xdb81f0[_0x2956b8(0x1b6)](_0x2956b8(0x1ad),{'success':_0x1eae92[_0x2956b8(0x1ca)]('success'),'errors':_0x1eae92['flash'](_0x2956b8(0x1d3)),'role':_0x3e156b,'profile':_0x230182,'warehouse':_0x811afd,'product':_0x43c804,'master_shop':_0x53fca3,'language':_0x37fc49,'rooms_data':_0x3a7fe9,'invoice_no':_0x5c5d23});})[_0x17f92d(0x18a)](_0x19e35a=>{var _0x222753=_0x17f92d;_0x1eae92[_0x222753(0x1ca)](_0x222753(0x1d3),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0xdb81f0[_0x222753(0x1d8)](_0x222753(0x205));});}catch(_0x1b1d30){console[_0x17f92d(0x161)](_0x1b1d30);}}),router[a0_0x231f6b(0x212)](a0_0x231f6b(0x177),auth,async(_0x50c177,_0x2937a0)=>{var _0x4ab52b=a0_0x231f6b;try{const {warehouse_name:_0x550a6b,date:_0x36a7a5,prod_name:_0x41e855,level:_0x1c7423,isle:_0x10edea,pallet:_0x4e3d5f,stock:_0x475420,types:_0x2eb4ec,adjust_qty:_0x17267a,new_adjust_qty:_0x396e49,note:_0x21a838,Room_name:_0x4f9730,JO_number:_0x54e4cc,expiry_date:_0x5d107c,type_of_transaction:_0x3b7487,PO_number:_0x47bf52,ReqBy:_0x314af7,dateofreq:_0x28232e,typeservicesData:_0x2ac02f,destination:_0x2bc9a1,deliverydate:_0x3334fa,driver:_0x23f399,plate:_0x54f7eb,van:_0x16d994,DRSI:_0x50d5b7,typevehicle:_0x5e7d9c,TSU:_0x9ff05,TFU:_0x365e2e}=_0x50c177[_0x4ab52b(0x194)];if(typeof _0x41e855=='string')var _0x3a911a=[_0x50c177[_0x4ab52b(0x194)]['prod_name']],_0x51edca=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x1a3)]],_0x2a9765=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x163)]],_0x4531a5=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x166)]],_0x48e29d=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x1b9)]],_0x329241=[_0x50c177[_0x4ab52b(0x194)]['New_Qty_Converted']],_0x10f878=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x180)]],_0x372080=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x1e4)]],_0x5e7dd4=[_0x50c177['body'][_0x4ab52b(0x18e)]],_0x14b40c=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x20c)]],_0x24b795=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x20b)]],_0x283db6=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x173)]],_0x2d63c2=[_0x50c177['body'][_0x4ab52b(0x1ef)]],_0x2186b8=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x182)]],_0x5bb9d8=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x1a4)]],_0x72e6b=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x191)]],_0xcfe974=[_0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x183)]];else var _0x3a911a=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x186)]],_0x51edca=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x1a3)]],_0x2a9765=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x163)]],_0x4531a5=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x166)]],_0x48e29d=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x1b9)]],_0x329241=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x1d7)]],_0x10f878=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x180)]],_0x372080=[..._0x50c177['body'][_0x4ab52b(0x1e4)]],_0x5e7dd4=[..._0x50c177['body'][_0x4ab52b(0x18e)]],_0x14b40c=[..._0x50c177['body'][_0x4ab52b(0x20c)]],_0x24b795=[..._0x50c177['body'][_0x4ab52b(0x20b)]],_0x283db6=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x173)]],_0x2d63c2=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x1ef)]],_0x2186b8=[..._0x50c177['body'][_0x4ab52b(0x182)]],_0x5bb9d8=[..._0x50c177['body'][_0x4ab52b(0x1a4)]],_0x72e6b=[..._0x50c177[_0x4ab52b(0x194)][_0x4ab52b(0x191)]],_0xcfe974=[..._0x50c177[_0x4ab52b(0x194)]['id_transaction_from']];const _0x352aed=_0x3a911a[_0x4ab52b(0x1c5)](_0x3693e6=>{return _0x3693e6={'product_name':_0x3693e6};});_0x51edca['forEach']((_0x7887de,_0x1cb252)=>{var _0x2feefc=_0x4ab52b,_0x291264=_0x7887de['match'](/[A-Za-z]+/)[0x0],_0x551b09=parseInt(_0x7887de[_0x2feefc(0x1df)](/\d+/)[0x0]);_0x352aed[_0x1cb252]['level']=_0x291264,_0x352aed[_0x1cb252][_0x2feefc(0x18c)]=_0x551b09;}),_0xcfe974[_0x4ab52b(0x1aa)]((_0x38de5f,_0xf53d2d)=>{var _0xe475a6=_0x4ab52b;_0x352aed[_0xf53d2d][_0xe475a6(0x1e1)]=_0x38de5f;}),_0x2a9765[_0x4ab52b(0x1aa)]((_0x3cee45,_0xf82ca5)=>{var _0x3c371e=_0x4ab52b;_0x352aed[_0xf82ca5][_0x3c371e(0x1ac)]=_0x3cee45;}),_0x4531a5[_0x4ab52b(0x1aa)]((_0x279288,_0x1e4503)=>{_0x352aed[_0x1e4503]['types']=_0x279288;}),_0x48e29d[_0x4ab52b(0x1aa)]((_0x479e71,_0x58224d)=>{var _0x5755a5=_0x4ab52b;_0x352aed[_0x58224d][_0x5755a5(0x164)]=_0x479e71;}),_0x329241[_0x4ab52b(0x1aa)]((_0x19d817,_0x2b86fa)=>{var _0x4eb9b4=_0x4ab52b;_0x352aed[_0x2b86fa][_0x4eb9b4(0x1b0)]=_0x19d817;}),_0x10f878[_0x4ab52b(0x1aa)]((_0x4caeae,_0x6ee788)=>{var _0x2c7623=_0x4ab52b;_0x352aed[_0x6ee788][_0x2c7623(0x1c8)]=_0x4caeae;}),_0x372080[_0x4ab52b(0x1aa)]((_0x2fd669,_0x21e0d3)=>{var _0xac3844=_0x4ab52b;_0x352aed[_0x21e0d3][_0xac3844(0x1bf)]=_0x2fd669;}),_0x5e7dd4[_0x4ab52b(0x1aa)]((_0x56d455,_0x2fe0b1)=>{var _0x16a692=_0x4ab52b;_0x352aed[_0x2fe0b1][_0x16a692(0x168)]=_0x56d455;}),_0x14b40c['forEach']((_0x20210d,_0x5cb83d)=>{var _0x4b7730=_0x4ab52b;_0x352aed[_0x5cb83d][_0x4b7730(0x20c)]=_0x20210d;}),_0x24b795[_0x4ab52b(0x1aa)]((_0x4ed75a,_0x1eebd3)=>{var _0x2672fe=_0x4ab52b;_0x352aed[_0x1eebd3][_0x2672fe(0x20b)]=_0x4ed75a;}),_0x283db6['forEach']((_0x8e7728,_0x224c51)=>{var _0x465350=_0x4ab52b;_0x352aed[_0x224c51][_0x465350(0x20a)]=_0x8e7728;}),_0x2d63c2['forEach']((_0x138c40,_0x38ad79)=>{var _0x5d89eb=_0x4ab52b;_0x352aed[_0x38ad79][_0x5d89eb(0x1ef)]=_0x138c40;}),_0x2186b8[_0x4ab52b(0x1aa)]((_0x334fac,_0x216cd2)=>{var _0x97253d=_0x4ab52b;_0x352aed[_0x216cd2][_0x97253d(0x1e3)]=_0x334fac;}),_0x5bb9d8[_0x4ab52b(0x1aa)]((_0x399fbf,_0x4178c0)=>{var _0x8f9fc3=_0x4ab52b;_0x352aed[_0x4178c0][_0x8f9fc3(0x1a4)]=_0x399fbf;}),_0x72e6b[_0x4ab52b(0x1aa)]((_0x21d89c,_0x4d2080)=>{var _0x23ea72=_0x4ab52b;_0x352aed[_0x4d2080][_0x23ea72(0x1bb)]=_0x21d89c;});const _0x431859=_0x352aed[_0x4ab52b(0x1fc)](_0x253bcb=>_0x253bcb[_0x4ab52b(0x164)]!=='0'&&_0x253bcb[_0x4ab52b(0x164)]!=='');var _0x43b012=0x0;_0x431859[_0x4ab52b(0x1aa)](_0x258704=>{var _0x2afad6=_0x4ab52b;console[_0x2afad6(0x161)]('foreach\x20newproduct',_0x258704),parseInt(_0x258704[_0x2afad6(0x164)])<=0x0&&_0x43b012++;});if(_0x43b012!=0x0)return _0x50c177[_0x4ab52b(0x1ca)]('errors',_0x4ab52b(0x1dc)),_0x2937a0['redirect'](_0x4ab52b(0x1bc));const _0x4e8223=new adjustment_logs();await _0x4e8223['save']();const _0x416512=new adjustment_finished({'warehouse_name':_0x550a6b,'date':_0x36a7a5,'product':_0x431859,'note':_0x21a838,'room':_0x4f9730,'invoice':_0x4ab52b(0x1c1)+_0x4e8223[_0x4ab52b(0x178)][_0x4ab52b(0x209)]()[_0x4ab52b(0x1a6)](0x8,'0'),'JO_number':_0x54e4cc,'expiry_date':_0x5d107c,'type_of_transaction':_0x3b7487,'PO_number':_0x47bf52,'RequestedBy':_0x314af7,'DateofRequest':_0x28232e,'typeservices':_0x2ac02f,'destination':_0x2bc9a1,'deliverydate':_0x3334fa,'driver':_0x23f399,'plate':_0x54f7eb,'van':_0x16d994,'DRSI':_0x50d5b7,'typevehicle':_0x5e7d9c,'TSU':_0x9ff05,'TFU':_0x365e2e}),_0x19dbb8=await _0x416512[_0x4ab52b(0x1da)]();_0x50c177[_0x4ab52b(0x1ca)](_0x4ab52b(0x165),_0x4ab52b(0x198)),_0x2937a0['redirect'](_0x4ab52b(0x181)+_0x19dbb8[_0x4ab52b(0x1b8)]);}catch(_0xd5def8){console[_0x4ab52b(0x161)](_0xd5def8),_0x2937a0[_0x4ab52b(0x1d6)](0xc8)[_0x4ab52b(0x1ce)]({'message':_0xd5def8['message']});}}),router['get'](a0_0x231f6b(0x1d5),auth,async(_0x141479,_0x42e257)=>{var _0x13f278=a0_0x231f6b;try{const {username:_0x2663ec,email:_0xb21117,role:_0x56aa3e}=_0x141479[_0x13f278(0x1a5)],_0x4d8585=_0x141479[_0x13f278(0x1a5)],_0x364b3f=await profile[_0x13f278(0x1f2)]({'email':_0x4d8585[_0x13f278(0x204)]}),_0xe5a8cc=await master_shop['find'](),_0xf1959f=_0x141479[_0x13f278(0x1f0)]['id'],_0xcc59fb=await adjustment_finished[_0x13f278(0x200)]({'_id':_0xf1959f}),_0x41076e=await purchases[_0x13f278(0x1f4)]([{'$match':{'warehouse_name':_0xcc59fb[_0x13f278(0x19d)]}},{'$unwind':'$product'},{'$group':{'_id':_0x13f278(0x19e)}}]);console['log']('purchases_data',_0x41076e);const _0x202b43=await product['find']({}),_0x6cf808=await warehouse[_0x13f278(0x1f4)]([{'$match':{'name':_0xcc59fb[_0x13f278(0x19d)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x13f278(0x1dd)},'product_stock':{'$first':_0x13f278(0x1af)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x13f278(0x1f9)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x13f278(0x1b2)},'primary_code':{'$first':_0x13f278(0x18f)},'secondary_code':{'$first':_0x13f278(0x1ed)},'product_code':{'$first':_0x13f278(0x1b7)},'storage':{'$first':_0x13f278(0x207)},'rack':{'$first':_0x13f278(0x1fd)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x13f278(0x1f1)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x13f278(0x1f5)},'room':{'$first':_0x13f278(0x1c9)}}}]);if(_0xe5a8cc[0x0][_0x13f278(0x1c3)]==_0x13f278(0x192)){var _0x4a9491=users[_0x13f278(0x1e5)];console[_0x13f278(0x161)](_0x4a9491);}else{if(_0xe5a8cc[0x0][_0x13f278(0x1c3)]==_0x13f278(0x16b))var _0x4a9491=users[_0x13f278(0x16b)];else{if(_0xe5a8cc[0x0][_0x13f278(0x1c3)]==_0x13f278(0x1c7))var _0x4a9491=users[_0x13f278(0x1c7)];else{if(_0xe5a8cc[0x0][_0x13f278(0x1c3)]==_0x13f278(0x1d4))var _0x4a9491=users[_0x13f278(0x1d4)];else{if(_0xe5a8cc[0x0][_0x13f278(0x1c3)]==_0x13f278(0x196))var _0x4a9491=users[_0x13f278(0x196)];else{if(_0xe5a8cc[0x0][_0x13f278(0x1c3)]==_0x13f278(0x169))var _0x4a9491=users['Portuguese'];else{if(_0xe5a8cc[0x0][_0x13f278(0x1c3)]=='Chinese')var _0x4a9491=users[_0x13f278(0x171)];else{if(_0xe5a8cc[0x0][_0x13f278(0x1c3)]==_0x13f278(0x187))var _0x4a9491=users[_0x13f278(0x1fb)];}}}}}}}_0x42e257[_0x13f278(0x1b6)](_0x13f278(0x18d),{'success':_0x141479[_0x13f278(0x1ca)](_0x13f278(0x165)),'errors':_0x141479[_0x13f278(0x1ca)]('errors'),'role':_0x4d8585,'profile':_0x364b3f,'adjustment':_0xcc59fb,'stock':_0x6cf808,'master_shop':_0xe5a8cc,'warehouse_name':_0x41076e,'unit':_0x202b43,'language':_0x4a9491});}catch(_0x21fc65){console[_0x13f278(0x161)](_0x21fc65),_0x42e257[_0x13f278(0x1d6)](0xc8)[_0x13f278(0x1ce)]({'message':_0x21fc65['message']});}}),router[a0_0x231f6b(0x212)]('/preview/:id',auth,async(_0x2f43d6,_0x4f00e4)=>{var _0x23de6a=a0_0x231f6b;try{const {invoice:_0x2f0ea0,warehouse_name:_0xb106df,Room_name:_0x16eeca}=_0x2f43d6['body'],_0x5e562d=_0x2f43d6['params']['id'],_0x4dc9eb=await adjustment_finished[_0x23de6a(0x200)]({'_id':_0x5e562d});var _0x55ef40;const _0xe6efd5=_0x4dc9eb[_0x23de6a(0x189)]['map'](async _0x4493a6=>{var _0x57a63b=_0x23de6a;if(_0x4493a6['adjust_qty']>0x0){_0x55ef40=await warehouse[_0x57a63b(0x1f2)]({'name':_0xb106df,'room':_0x4493a6['room_names']});const _0x1ff0dc=_0x55ef40[_0x57a63b(0x172)][_0x57a63b(0x1c5)](_0x18e1be=>{var _0x4cafe1=_0x57a63b;console[_0x4cafe1(0x161)](_0x4493a6[_0x4cafe1(0x166)]);if(_0x4493a6[_0x4cafe1(0x166)]=='minus')_0x18e1be['_id']==_0x4493a6[_0x4cafe1(0x1e1)]&&(_0x18e1be[_0x4cafe1(0x1b1)]=_0x18e1be[_0x4cafe1(0x1b1)]-_0x4493a6[_0x4cafe1(0x164)]);else _0x4493a6[_0x4cafe1(0x166)]==_0x4cafe1(0x17d)&&(_0x18e1be['_id']==_0x4493a6[_0x4cafe1(0x1e1)]&&(_0x18e1be[_0x4cafe1(0x1b1)]=_0x18e1be[_0x4cafe1(0x1b1)]+_0x4493a6[_0x4cafe1(0x164)]));});}return _0x55ef40;});Promise[_0x23de6a(0x1fe)](_0xe6efd5)[_0x23de6a(0x17b)](async _0x1013d3=>{var _0x1aa482=_0x23de6a;try{for(const _0x58af3e of _0x1013d3){await _0x58af3e[_0x1aa482(0x1da)]();}_0x4dc9eb[_0x1aa482(0x16e)]=_0x1aa482(0x17a);const _0x2e4124=await _0x4dc9eb[_0x1aa482(0x1da)](),_0x4fab3a=await master_shop[_0x1aa482(0x1bd)](),_0x43b43c=await email_settings['findOne'](),_0x3213ae=await supervisor_settings[_0x1aa482(0x1bd)]();var _0x301bd7=_0x4dc9eb['product'],_0x320194='',_0x12df8e;for(_0x12df8e in _0x301bd7){var _0x22571e='FG';_0x4dc9eb[_0x1aa482(0x19d)]==_0x1aa482(0x179)&&(_0x22571e='DG'),_0x320194+=_0x1aa482(0x1ba)+_0x1aa482(0x1b3)+_0x301bd7[_0x12df8e][_0x1aa482(0x184)]+_0x1aa482(0x202)+_0x1aa482(0x1b3)+_0x301bd7[_0x12df8e][_0x1aa482(0x168)]+_0x1aa482(0x202)+_0x1aa482(0x1b3)+_0x301bd7[_0x12df8e]['adjust_qty']+'</td>'+_0x1aa482(0x1b3)+_0x301bd7[_0x12df8e]['unit']+_0x1aa482(0x202)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x301bd7[_0x12df8e][_0x1aa482(0x1bf)]+_0x1aa482(0x202)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4dc9eb['warehouse_name']+_0x1aa482(0x202)+_0x1aa482(0x1b3)+_0x301bd7[_0x12df8e][_0x1aa482(0x1e3)]+_0x1aa482(0x202)+_0x1aa482(0x1b3)+_0x22571e+_0x301bd7[_0x12df8e]['bay']+_0x1aa482(0x202)+_0x1aa482(0x190);}_0x2f43d6[_0x1aa482(0x1ca)]('success',_0x1aa482(0x20f)),_0x4f00e4[_0x1aa482(0x1d8)](_0x1aa482(0x1c2)+_0x2e4124[_0x1aa482(0x1b8)]);}catch(_0x553d6e){console[_0x1aa482(0x201)](_0x553d6e),_0x4f00e4[_0x1aa482(0x1d6)](0x1f4)[_0x1aa482(0x1ce)]({'error':_0x1aa482(0x16f)});}})['catch'](_0x3dc10f=>{var _0x4f2222=_0x23de6a;console[_0x4f2222(0x201)](_0x3dc10f),_0x4f00e4[_0x4f2222(0x1d6)](0x1f4)[_0x4f2222(0x1ce)]({'error':_0x4f2222(0x1e6)});});}catch(_0x2775ca){_0x4f00e4[_0x23de6a(0x1ce)]({'message':_0x2775ca['message']});}}),router[a0_0x231f6b(0x210)]('/view/:id',auth,async(_0x2bfcab,_0x32c92d)=>{var _0x63dc2d=a0_0x231f6b;try{const {username:_0x426e37,email:_0x57bc75,role:_0x27bb13}=_0x2bfcab[_0x63dc2d(0x1a5)],_0x97ddce=_0x2bfcab['user'],_0x38254a=await profile['findOne']({'email':_0x97ddce[_0x63dc2d(0x204)]}),_0x26d894=await master_shop[_0x63dc2d(0x1bd)]();console[_0x63dc2d(0x161)](_0x63dc2d(0x199),_0x26d894);const _0x31f359=_0x2bfcab['params']['id'],_0x43e126=await adjustment_finished[_0x63dc2d(0x200)]({'_id':_0x31f359});let _0x388934=new Date(_0x43e126[_0x63dc2d(0x20b)]),_0x5737e9=('0'+_0x388934['getDate']())['slice'](-0x2),_0x116009=('0'+(_0x388934['getMonth']()+0x1))[_0x63dc2d(0x1f6)](-0x2),_0x1f43d5=_0x388934[_0x63dc2d(0x1ab)](),_0x175d51=_0x1f43d5+'-'+_0x116009+'-'+_0x5737e9;var _0x26ca76=['Ambient',_0x63dc2d(0x1cb),_0x63dc2d(0x1e9)];const _0x2bdcf2=await purchases[_0x63dc2d(0x1f4)]([{'$match':{'warehouse_name':_0x43e126[_0x63dc2d(0x19d)]}},{'$unwind':_0x63dc2d(0x1d1)},{'$group':{'_id':'$product.product_name'}}]);console[_0x63dc2d(0x161)](_0x63dc2d(0x1db),_0x2bdcf2);const _0x284a85=await product[_0x63dc2d(0x1bd)]({}),_0x357914=await warehouse[_0x63dc2d(0x1f4)]([{'$match':{'name':_0x43e126['warehouse_name'],'room':_0x43e126['room']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x63dc2d(0x1c6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x63dc2d(0x1af)},'bay':{'$first':_0x63dc2d(0x1a0)},'bin':{'$first':_0x63dc2d(0x1f9)},'type':{'$first':_0x63dc2d(0x175)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x63dc2d(0x18f)},'secondary_code':{'$first':_0x63dc2d(0x1ed)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x63dc2d(0x207)},'rack':{'$first':_0x63dc2d(0x1fd)}}}]);if(_0x26d894[0x0][_0x63dc2d(0x1c3)]=='English\x20(US)'){var _0x4c9a0a=users['English'];console[_0x63dc2d(0x161)](_0x4c9a0a);}else{if(_0x26d894[0x0][_0x63dc2d(0x1c3)]==_0x63dc2d(0x16b))var _0x4c9a0a=users[_0x63dc2d(0x16b)];else{if(_0x26d894[0x0]['language']==_0x63dc2d(0x1c7))var _0x4c9a0a=users[_0x63dc2d(0x1c7)];else{if(_0x26d894[0x0][_0x63dc2d(0x1c3)]==_0x63dc2d(0x1d4))var _0x4c9a0a=users[_0x63dc2d(0x1d4)];else{if(_0x26d894[0x0][_0x63dc2d(0x1c3)]=='French')var _0x4c9a0a=users[_0x63dc2d(0x196)];else{if(_0x26d894[0x0][_0x63dc2d(0x1c3)]==_0x63dc2d(0x169))var _0x4c9a0a=users[_0x63dc2d(0x18b)];else{if(_0x26d894[0x0]['language']==_0x63dc2d(0x171))var _0x4c9a0a=users[_0x63dc2d(0x171)];else{if(_0x26d894[0x0][_0x63dc2d(0x1c3)]=='Arabic\x20(ae)')var _0x4c9a0a=users['Arabic'];}}}}}}}_0x32c92d[_0x63dc2d(0x1b6)]('edit_adjustment_finished',{'success':_0x2bfcab[_0x63dc2d(0x1ca)](_0x63dc2d(0x165)),'errors':_0x2bfcab[_0x63dc2d(0x1ca)](_0x63dc2d(0x1d3)),'role':_0x97ddce,'profile':_0x38254a,'adjustment':_0x43e126,'stock':_0x357914,'master_shop':_0x26d894,'warehouse_name':_0x2bdcf2,'unit':_0x284a85,'language':_0x4c9a0a,'rooms_data':_0x26ca76,'ed_fullDate':_0x175d51});}catch(_0x4bce2c){console[_0x63dc2d(0x161)](_0x4bce2c),_0x32c92d[_0x63dc2d(0x1d6)](0xc8)[_0x63dc2d(0x1ce)]({'message':_0x4bce2c['message']});}}),router[a0_0x231f6b(0x212)](a0_0x231f6b(0x1ff),auth,async(_0x4c6fff,_0x1d4015)=>{var _0x1f2295=a0_0x231f6b;try{const _0xf436ce=_0x4c6fff[_0x1f2295(0x1f0)]['id'],_0xaf2f77=await adjustment_finished[_0x1f2295(0x200)]({'_id':_0xf436ce}),_0x4fbf90=await warehouse[_0x1f2295(0x1f2)]({'name':_0xaf2f77[_0x1f2295(0x19d)],'room':_0xaf2f77['room']}),{warehouse_name:_0x46d3b8,date:_0x267440,prod_name:_0x1c50ad,level:_0x38348e,isle:_0x4fa7ab,pallet:_0x3bf31e,stock:_0x4836a7,types:_0x37a903,adjust_qty:_0x10d873,new_adjust_qty:_0x51922b,note:_0x3e0e5e,Room_name:_0x4c6b51,invoice:_0x592eb9,JO_number:_0x41824e}=_0x4c6fff[_0x1f2295(0x194)];if(typeof _0x1c50ad==_0x1f2295(0x1f7))var _0x145baf=[_0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x186)]],_0x24213e=[_0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x1a3)]],_0x279607=[_0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x163)]],_0x584bfc=[_0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x166)]],_0x5621e5=[_0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x164)]],_0x5ef816=[_0x4c6fff[_0x1f2295(0x194)]['new_adjust_qty']],_0x772d6d=[_0x4c6fff['body'][_0x1f2295(0x18e)]],_0x368722=[_0x4c6fff['body'][_0x1f2295(0x1c8)]],_0x1c5a8f=[_0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x1e4)]],_0x9c001a=[_0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x20c)]],_0xbe9ac6=[_0x4c6fff['body'][_0x1f2295(0x20b)]];else var _0x145baf=[..._0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x186)]],_0x24213e=[..._0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x1a3)]],_0x279607=[..._0x4c6fff['body'][_0x1f2295(0x163)]],_0x584bfc=[..._0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x166)]],_0x5621e5=[..._0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x164)]],_0x5ef816=[..._0x4c6fff[_0x1f2295(0x194)]['new_adjust_qty']],_0x772d6d=[..._0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x18e)]],_0x368722=[..._0x4c6fff[_0x1f2295(0x194)][_0x1f2295(0x1c8)]],_0x1c5a8f=[..._0x4c6fff[_0x1f2295(0x194)]['Secondary_units']],_0x9c001a=[..._0x4c6fff['body'][_0x1f2295(0x20c)]],_0xbe9ac6=[..._0x4c6fff[_0x1f2295(0x194)]['expiry_date']];const _0x392c6b=_0x145baf[_0x1f2295(0x1c5)](_0x253cb6=>{return _0x253cb6={'product_name':_0x253cb6};});_0x24213e[_0x1f2295(0x1aa)]((_0x56585b,_0x127978)=>{var _0x583437=_0x1f2295;_0x392c6b[_0x127978][_0x583437(0x18c)]=_0x56585b;}),_0x279607[_0x1f2295(0x1aa)]((_0x54379d,_0x2901c2)=>{var _0x168819=_0x1f2295;_0x392c6b[_0x2901c2][_0x168819(0x1ac)]=_0x54379d;}),_0x584bfc['forEach']((_0x50dc85,_0x5aa956)=>{var _0x5f138c=_0x1f2295;_0x392c6b[_0x5aa956][_0x5f138c(0x166)]=_0x50dc85;}),_0x5621e5[_0x1f2295(0x1aa)]((_0x2f9ff4,_0x3e1dac)=>{var _0x3c2488=_0x1f2295;_0x392c6b[_0x3e1dac][_0x3c2488(0x164)]=_0x2f9ff4;}),_0x5ef816[_0x1f2295(0x1aa)]((_0x36eabc,_0xbb292a)=>{var _0x3a939f=_0x1f2295;_0x392c6b[_0xbb292a][_0x3a939f(0x1b0)]=_0x36eabc;}),_0x368722[_0x1f2295(0x1aa)]((_0x372d00,_0x354ec4)=>{var _0x4ec371=_0x1f2295;_0x392c6b[_0x354ec4][_0x4ec371(0x1c8)]=_0x372d00;}),_0x1c5a8f[_0x1f2295(0x1aa)]((_0x492500,_0x257bc5)=>{_0x392c6b[_0x257bc5]['secondary_unit']=_0x492500;}),_0x772d6d[_0x1f2295(0x1aa)]((_0x23b691,_0x46702c)=>{var _0x1f0914=_0x1f2295;_0x392c6b[_0x46702c][_0x1f0914(0x168)]=_0x23b691;}),_0x9c001a['forEach']((_0xd49d16,_0x7d88e2)=>{var _0x32c4e9=_0x1f2295;_0x392c6b[_0x7d88e2][_0x32c4e9(0x20c)]=_0xd49d16;}),_0xbe9ac6[_0x1f2295(0x1aa)]((_0x4ccdaf,_0x573523)=>{_0x392c6b[_0x573523]['expiry_date']=_0x4ccdaf;});const _0x262dc2=_0x392c6b[_0x1f2295(0x1fc)](_0x232546=>_0x232546['adjust_qty']!=='0'&&_0x232546['adjust_qty']!=='');var _0x5bd041=0x0;_0x262dc2[_0x1f2295(0x1aa)](_0x5ef31f=>{var _0x3a0aaf=_0x1f2295;console['log'](_0x3a0aaf(0x188),_0x5ef31f),parseInt(_0x5ef31f[_0x3a0aaf(0x164)])<=0x0&&_0x5bd041++;});if(_0x5bd041!=0x0)return _0x4c6fff[_0x1f2295(0x1ca)]('errors',_0x1f2295(0x1dc)),_0x1d4015['redirect'](_0x1f2295(0x1bc));_0xaf2f77['warehouse_name']=_0x46d3b8,_0xaf2f77[_0x1f2295(0x185)]=_0x267440,_0xaf2f77[_0x1f2295(0x189)]=_0x262dc2,_0xaf2f77['note']=_0x3e0e5e,_0xaf2f77['room']=_0x4c6b51,_0xaf2f77[_0x1f2295(0x1bb)]=_0x592eb9,_0xaf2f77[_0x1f2295(0x1d2)]=_0x41824e;const _0x164c0a=await _0xaf2f77['save'](),_0x2491ba=await warehouse[_0x1f2295(0x1f2)]({'name':_0x46d3b8,'room':_0x4c6b51});_0x164c0a[_0x1f2295(0x189)][_0x1f2295(0x1aa)](_0x1e84ff=>{var _0x599f41=_0x1f2295;const _0x3e7fa7=_0x2491ba[_0x599f41(0x172)][_0x599f41(0x1c5)](_0x5c7fe1=>{var _0x1cde86=_0x599f41;_0x1e84ff[_0x1cde86(0x166)]==_0x1cde86(0x1c4)?_0x5c7fe1[_0x1cde86(0x184)]==_0x1e84ff[_0x1cde86(0x184)]&&_0x5c7fe1[_0x1cde86(0x18c)]==_0x1e84ff['bay']&&(_0x5c7fe1['product_stock']=parseInt(_0x5c7fe1['product_stock'])-parseInt(_0x1e84ff[_0x1cde86(0x164)])):_0x5c7fe1[_0x1cde86(0x184)]==_0x1e84ff[_0x1cde86(0x184)]&&_0x5c7fe1[_0x1cde86(0x18c)]==_0x1e84ff[_0x1cde86(0x18c)]&&(_0x5c7fe1[_0x1cde86(0x1b1)]=parseInt(_0x5c7fe1[_0x1cde86(0x1b1)])+parseInt(_0x1e84ff[_0x1cde86(0x164)]));});}),await _0x2491ba[_0x1f2295(0x1da)](),_0x4c6fff['flash'](_0x1f2295(0x165),_0x1f2295(0x203)),_0x1d4015[_0x1f2295(0x1d8)](_0x1f2295(0x1f8));}catch(_0x2ff6ed){console[_0x1f2295(0x161)](_0x2ff6ed);}}),router[a0_0x231f6b(0x212)]('/barcode_scanner',async(_0x5a6690,_0x3b1a92)=>{var _0x4e481c=a0_0x231f6b;const {primary_code:_0x238483,warehouse_data:_0x2f3d94,rooms_data:_0x370557,Roomslist:_0x2639c5}=_0x5a6690['body'],_0x1b887f=_0x2639c5[_0x4e481c(0x1b4)](','),_0x4ddde2=[];async function _0x3a006a(_0xe55569){var _0x24807f=_0x4e481c;const _0x48761c=await warehouse[_0x24807f(0x1f4)]([{'$match':{'name':_0x2f3d94,'room':_0xe55569}},{'$unwind':_0x24807f(0x211)},{'$match':{'product_details.primary_code':_0x238483}},{'$group':{'_id':_0x24807f(0x1c6),'name':{'$first':_0x24807f(0x1dd)},'product_stock':{'$first':_0x24807f(0x1af)},'primary_code':{'$first':_0x24807f(0x18f)},'secondary_code':{'$first':_0x24807f(0x1ed)},'product_code':{'$first':_0x24807f(0x1b7)},'level':{'$first':_0x24807f(0x206)},'bay':{'$first':_0x24807f(0x1a0)},'type':{'$first':_0x24807f(0x175)},'pallet':{'$first':_0x24807f(0x1b2)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x24807f(0x1ec)},'storage':{'$first':_0x24807f(0x207)},'rack':{'$first':_0x24807f(0x1fd)},'expiry_date':{'$first':_0x24807f(0x1a2)},'production_date':{'$first':_0x24807f(0x1f1)},'batch_code':{'$first':_0x24807f(0x193)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x24807f(0x1f5)},'roomNamed':{'$first':_0x24807f(0x1c9)},'invoice':{'$first':_0x24807f(0x1a8)}}}]),_0x2dcdae=await warehouse[_0x24807f(0x1f4)]([{'$match':{'name':_0x2f3d94,'room':_0xe55569}},{'$unwind':_0x24807f(0x211)},{'$match':{'product_details.secondary_code':_0x238483}},{'$group':{'_id':_0x24807f(0x1c6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x24807f(0x1af)},'primary_code':{'$first':_0x24807f(0x18f)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x24807f(0x1b7)},'level':{'$first':_0x24807f(0x206)},'bay':{'$first':_0x24807f(0x1a0)},'type':{'$first':_0x24807f(0x175)},'pallet':{'$first':_0x24807f(0x1b2)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x24807f(0x1ec)},'storage':{'$first':_0x24807f(0x207)},'rack':{'$first':_0x24807f(0x1fd)},'expiry_date':{'$first':_0x24807f(0x1a2)},'production_date':{'$first':_0x24807f(0x1f1)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x24807f(0x1c9)},'invoice':{'$first':_0x24807f(0x1a8)}}}]);if(_0x48761c[_0x24807f(0x174)]>0x0)_0x4ddde2[_0x24807f(0x1d9)](_0x48761c);else _0x2dcdae['length']>0x0&&_0x4ddde2[_0x24807f(0x1d9)](_0x2dcdae);}const _0x18f362=_0x1b887f['map'](_0x477ffb=>_0x3a006a(_0x477ffb));await Promise['all'](_0x18f362),_0x3b1a92[_0x4e481c(0x1ce)](_0x4ddde2);}),router[a0_0x231f6b(0x212)](a0_0x231f6b(0x162),async(_0x4724ce,_0x5c2a42)=>{var _0x350a57=a0_0x231f6b;const {productCode:_0x4daa04,bay:_0xe51461,warehouses:_0x17740e,room:_0xc5ae4}=_0x4724ce['body'];console[_0x350a57(0x161)](_0x4724ce[_0x350a57(0x194)]);try{const _0x296185=await warehouse['aggregate']([{'$match':{'name':_0x17740e,'room':_0xc5ae4}},{'$unwind':_0x350a57(0x211)},{'$match':{'product_details.bay':parseInt(_0xe51461)}},{'$group':{'_id':_0x350a57(0x1c6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x350a57(0x1af)},'bay':{'$first':_0x350a57(0x1a0)},'maxProducts':{'$first':_0x350a57(0x1ea)}}}]);_0x5c2a42[_0x350a57(0x1d6)](0xc8)[_0x350a57(0x1ce)](_0x296185);}catch(_0x1ea555){_0x5c2a42[_0x350a57(0x1d6)](0x194)[_0x350a57(0x1ce)]({'message':_0x1ea555[_0x350a57(0x1a9)]});}}),module['exports']=router;