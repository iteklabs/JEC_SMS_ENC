var a0_0x1615b1=a0_0x11de;(function(_0x10923d,_0x29c98e){var _0x2985de=a0_0x11de,_0x342502=_0x10923d();while(!![]){try{var _0x2f6e54=parseInt(_0x2985de(0x13e))/0x1*(parseInt(_0x2985de(0xdd))/0x2)+parseInt(_0x2985de(0xec))/0x3+parseInt(_0x2985de(0x143))/0x4+parseInt(_0x2985de(0x108))/0x5+-parseInt(_0x2985de(0x16c))/0x6*(parseInt(_0x2985de(0x172))/0x7)+parseInt(_0x2985de(0x11c))/0x8*(-parseInt(_0x2985de(0xe4))/0x9)+parseInt(_0x2985de(0x123))/0xa*(-parseInt(_0x2985de(0x146))/0xb);if(_0x2f6e54===_0x29c98e)break;else _0x342502['push'](_0x342502['shift']());}catch(_0x4120f1){_0x342502['push'](_0x342502['shift']());}}}(a0_0xfc5e,0x315c1));function a0_0x11de(_0x310b86,_0x48d795){var _0xfc5e3f=a0_0xfc5e();return a0_0x11de=function(_0x11de9b,_0x1e5f8a){_0x11de9b=_0x11de9b-0xdb;var _0x2e8993=_0xfc5e3f[_0x11de9b];return _0x2e8993;},a0_0x11de(_0x310b86,_0x48d795);}function a0_0xfc5e(){var _0x42b23c=['get','English','express','push','bay','565159ykWpOf','/adjustment_finished/preview/','product_details','warehouse_name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','logs','Arabic','$product_details._id','unit','findById','id_transaction_from','/adjustment/view','id_transaction','$product_details.secondary_code','$product','JO_number','New_Qty_Converted','$invoice','Rooms','_id','save','add','master','$product_details.floorlevel','body','German','1522vbHpoQ','An\x20error\x20occurred\x20while\x20saving\x20data.','status','Enabled','json','$product_details.storage','product_name','53028NRycRC','split','Portuguese\x20(BR)','Adjustment\x20Finalize\x20Successfully','Secondary_units','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','add_adjustment_finished_logs','Ambient','631500gKrYjn','$_id','map','secondary_unit','Enclosed','edit_adjustment_finished','room_names','getFullYear','aggregate','Return\x20Rooms','prod_code','types','$product_details.maxProducts','/preview/:id','batch_code','Chinese','toString','ADJ-','email','../models/all_models','$product_details.level','ADJF-','findOne','flash','DRY\x20GOODS','getDate','$product_details.expiry_date','invoice_init','1464190QAIhSN','padStart','length','prod_invoice','message','product_stock','$product_details.type','$product_details.invoice','$warehouse_name','expiry_date','error','language','adjustment_finished_logs','product_code','$product_details.batch_code','$product.product_name','edit_adjustment_finished_view','New_Qty_Converted_adj','role','$product_details','392ScBrPh','$room','Arabic\x20(ae)','/view/add_adjustment','prod_cat','adjustment\x20add\x20successfull','warehouse','133030HPFFfD','errors','$name','stock','minus','$date','find','<tr>','match','all','Hindi','level','Portuguese','staff','English\x20(US)','/view/:id','$product_details.unit','back','room','$product_details.primary_code','post','$product_details.bin','product_date','adjust_qty','params','nodemailer','$product_details.product_code','303NRmaaX','Primary_Units','forEach','invoice','prod_name','1011404YZtTuA','getMonth','exports','143sVAhzh','LOG-ADJ-','foreach\x20newproduct','$product_details.product_name','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','filter','floor','$product_details.rack','/view_logs','maxPerUnit','date','$product.room_names','finalize','product','slice','$product_details.product_stock','$product_details.production_date','note','purchases_data','production_date','French','user','string','$product_details.secondary_unit','log','random','</td>','$product_details.maxPerUnit','new_adjust_qty','render','Spanish','stockBefore','redirect','/view/add_adjustment_logs','$product_details.bay','success','catch','then','24gwRhmS'];a0_0xfc5e=function(){return _0x42b23c;};return a0_0xfc5e();}const express=require(a0_0x1615b1(0x16f)),app=express(),router=express['Router'](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_logs,adjustment_finished,email_settings,supervisor_settings,invoice_for_adjustment}=require(a0_0x1615b1(0xff)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x1615b1(0x13c));router[a0_0x1615b1(0x16d)]('/view',auth,async(_0x25455f,_0x7e29e3)=>{var _0x2624e5=a0_0x1615b1;try{const {username:_0x48e0ab,email:_0x2d627e,role:_0x346215}=_0x25455f[_0x2624e5(0x15b)],_0x35882b=_0x25455f[_0x2624e5(0x15b)],_0x996819=await profile[_0x2624e5(0x102)]({'email':_0x35882b[_0x2624e5(0xfe)]}),_0x37bcea=await master_shop[_0x2624e5(0x129)]();let _0x7c602e;if(_0x35882b[_0x2624e5(0x11a)]==_0x2624e5(0x130)){const _0xac0bb3=await staff[_0x2624e5(0x102)]({'email':_0x35882b[_0x2624e5(0xfe)]});_0x7c602e=await warehouse[_0x2624e5(0x129)]({'status':_0x2624e5(0xe0),'name':_0xac0bb3[_0x2624e5(0x122)]});}else _0x7c602e=await warehouse[_0x2624e5(0x129)]({'status':'Enabled'});const _0x5ed602=await product[_0x2624e5(0x129)]();let _0x579412;if(_0x35882b[_0x2624e5(0x11a)]==_0x2624e5(0x130)){const _0x395b01=await staff[_0x2624e5(0x102)]({'email':_0x35882b[_0x2624e5(0xfe)]});_0x579412=await adjustment_finished['find']({'warehouse_name':_0x395b01['warehouse']});}else _0x579412=await adjustment_finished[_0x2624e5(0xf4)]([{'$match':{'type_of_transaction':'own'}},{'$unwind':_0x2624e5(0x180)},{'$group':{'_id':_0x2624e5(0xed),'invoice':{'$first':_0x2624e5(0x183)},'date':{'$first':_0x2624e5(0x128)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x2624e5(0x151)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x37bcea[0x0][_0x2624e5(0x113)]==_0x2624e5(0x131)){var _0x183f11=users['English'];console[_0x2624e5(0x15e)](_0x183f11);}else{if(_0x37bcea[0x0][_0x2624e5(0x113)]==_0x2624e5(0x12d))var _0x183f11=users[_0x2624e5(0x12d)];else{if(_0x37bcea[0x0]['language']==_0x2624e5(0xdc))var _0x183f11=users['German'];else{if(_0x37bcea[0x0]['language']=='Spanish')var _0x183f11=users['Spanish'];else{if(_0x37bcea[0x0]['language']==_0x2624e5(0x15a))var _0x183f11=users[_0x2624e5(0x15a)];else{if(_0x37bcea[0x0][_0x2624e5(0x113)]=='Portuguese\x20(BR)')var _0x183f11=users[_0x2624e5(0x12f)];else{if(_0x37bcea[0x0][_0x2624e5(0x113)]==_0x2624e5(0xfb))var _0x183f11=users['Chinese'];else{if(_0x37bcea[0x0][_0x2624e5(0x113)]==_0x2624e5(0x11e))var _0x183f11=users[_0x2624e5(0x178)];}}}}}}}_0x7e29e3['render']('adjustment_finished',{'success':_0x25455f[_0x2624e5(0x103)](_0x2624e5(0x169)),'errors':_0x25455f[_0x2624e5(0x103)](_0x2624e5(0x124)),'role':_0x35882b,'profile':_0x996819,'warehouse':_0x7c602e,'product':_0x5ed602,'adjustment':_0x579412,'master_shop':_0x37bcea,'language':_0x183f11});}catch(_0x232f4a){console[_0x2624e5(0x15e)](_0x232f4a);}}),router['get'](a0_0x1615b1(0x14e),auth,async(_0x2f00d5,_0x276cb1)=>{var _0x2a3122=a0_0x1615b1;try{const {username:_0x3b392b,email:_0xd8e2f7,role:_0x500ffb}=_0x2f00d5['user'],_0x2ec121=_0x2f00d5[_0x2a3122(0x15b)],_0x13efbe=await profile[_0x2a3122(0x102)]({'email':_0x2ec121[_0x2a3122(0xfe)]}),_0x460863=await master_shop[_0x2a3122(0x129)]();let _0x386767;if(_0x2ec121[_0x2a3122(0x11a)]==_0x2a3122(0x130)){const _0x1b5242=await staff[_0x2a3122(0x102)]({'email':_0x2ec121[_0x2a3122(0xfe)]});_0x386767=await warehouse[_0x2a3122(0x129)]({'status':'Enabled','name':_0x1b5242[_0x2a3122(0x122)]});}else _0x386767=await warehouse[_0x2a3122(0x129)]({'status':_0x2a3122(0xe0)});const _0x343054=await product[_0x2a3122(0x129)]();let _0x12ce2a;if(_0x2ec121[_0x2a3122(0x11a)]=='staff'){const _0x459125=await staff[_0x2a3122(0x102)]({'email':_0x2ec121[_0x2a3122(0xfe)]});_0x12ce2a=await adjustment_finished['find']({'warehouse_name':_0x459125[_0x2a3122(0x122)]});}else _0x12ce2a=await adjustment_finished[_0x2a3122(0xf4)]([{'$match':{'type_of_transaction':_0x2a3122(0x177)}},{'$unwind':_0x2a3122(0x180)},{'$group':{'_id':'$_id','invoice':{'$first':_0x2a3122(0x183)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x2a3122(0x110)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x460863[0x0][_0x2a3122(0x113)]==_0x2a3122(0x131))var _0x3e3d11=users['English'];else{if(_0x460863[0x0][_0x2a3122(0x113)]==_0x2a3122(0x12d))var _0x3e3d11=users[_0x2a3122(0x12d)];else{if(_0x460863[0x0][_0x2a3122(0x113)]==_0x2a3122(0xdc))var _0x3e3d11=users['German'];else{if(_0x460863[0x0][_0x2a3122(0x113)]==_0x2a3122(0x164))var _0x3e3d11=users[_0x2a3122(0x164)];else{if(_0x460863[0x0][_0x2a3122(0x113)]==_0x2a3122(0x15a))var _0x3e3d11=users[_0x2a3122(0x15a)];else{if(_0x460863[0x0][_0x2a3122(0x113)]=='Portuguese\x20(BR)')var _0x3e3d11=users[_0x2a3122(0x12f)];else{if(_0x460863[0x0]['language']==_0x2a3122(0xfb))var _0x3e3d11=users[_0x2a3122(0xfb)];else{if(_0x460863[0x0][_0x2a3122(0x113)]==_0x2a3122(0x11e))var _0x3e3d11=users['Arabic'];}}}}}}}_0x276cb1[_0x2a3122(0x163)](_0x2a3122(0x114),{'success':_0x2f00d5[_0x2a3122(0x103)](_0x2a3122(0x169)),'errors':_0x2f00d5['flash'](_0x2a3122(0x124)),'role':_0x2ec121,'profile':_0x13efbe,'warehouse':_0x386767,'product':_0x343054,'adjustment':_0x12ce2a,'master_shop':_0x460863,'language':_0x3e3d11});}catch(_0xf28e81){console[_0x2a3122(0x15e)](_0xf28e81);}});async function getRandom8DigitNumber(){var _0x2d6007=a0_0x1615b1;const _0x2e6da1=0x989680,_0x53903c=0x5f5e0ff,_0x4dbc92=Math[_0x2d6007(0x14c)](Math[_0x2d6007(0x15f)]()*(_0x53903c-_0x2e6da1+0x1))+_0x2e6da1;var _0x84636d;const _0x47de5a=await adjustment_finished[_0x2d6007(0x102)]({'invoice':_0x2d6007(0x101)+_0x4dbc92});return _0x47de5a&&_0x47de5a['length']>0x0?_0x84636d='ADJF-'+_0x4dbc92:_0x84636d=_0x2d6007(0x101)+_0x4dbc92,_0x84636d;}router['get'](a0_0x1615b1(0x11f),auth,async(_0x5118ce,_0x429888)=>{var _0x559c14=a0_0x1615b1;try{const {username:_0x3508cc,email:_0x29d49f,role:_0x24f5b9}=_0x5118ce[_0x559c14(0x15b)],_0x92cbc8=_0x5118ce[_0x559c14(0x15b)],_0x56b0fe=await profile[_0x559c14(0x102)]({'email':_0x92cbc8[_0x559c14(0xfe)]}),_0x1a2eaf=await master_shop[_0x559c14(0x129)]();let _0x404fe4;if(_0x92cbc8[_0x559c14(0x11a)]==_0x559c14(0x130)){const _0x2f6394=await staff['findOne']({'email':_0x92cbc8['email']});_0x404fe4=await warehouse['aggregate']([{'$match':{'status':_0x559c14(0xe0),'name':_0x2f6394[_0x559c14(0x122)]}},{'$group':{'_id':_0x559c14(0x125),'name':{'$first':'$name'}}}]);}else _0x404fe4=await warehouse[_0x559c14(0xf4)]([{'$match':{'status':_0x559c14(0xe0)}},{'$group':{'_id':_0x559c14(0x125),'name':{'$first':_0x559c14(0x125)}}}]);const _0x477188=await product[_0x559c14(0x129)]({}),_0x404b35=await adjustment_finished[_0x559c14(0x129)](),_0x24966b=_0x404b35[_0x559c14(0x10a)]+0x1,_0x18b0bb='ADJF-'+_0x24966b[_0x559c14(0xfc)]()['padStart'](0x5,'0');var _0x337446=[_0x559c14(0xeb),_0x559c14(0xf0),_0x559c14(0xf5)];if(_0x1a2eaf[0x0]['language']==_0x559c14(0x131))var _0x2c2bd5=users[_0x559c14(0x16e)];else{if(_0x1a2eaf[0x0]['language']==_0x559c14(0x12d))var _0x2c2bd5=users['Hindi'];else{if(_0x1a2eaf[0x0][_0x559c14(0x113)]=='German')var _0x2c2bd5=users[_0x559c14(0xdc)];else{if(_0x1a2eaf[0x0]['language']==_0x559c14(0x164))var _0x2c2bd5=users['Spanish'];else{if(_0x1a2eaf[0x0]['language']==_0x559c14(0x15a))var _0x2c2bd5=users[_0x559c14(0x15a)];else{if(_0x1a2eaf[0x0][_0x559c14(0x113)]==_0x559c14(0xe6))var _0x2c2bd5=users[_0x559c14(0x12f)];else{if(_0x1a2eaf[0x0][_0x559c14(0x113)]==_0x559c14(0xfb))var _0x2c2bd5=users['Chinese'];else{if(_0x1a2eaf[0x0][_0x559c14(0x113)]==_0x559c14(0x11e))var _0x2c2bd5=users[_0x559c14(0x178)];}}}}}}}const _0x244cae=getRandom8DigitNumber();_0x244cae[_0x559c14(0x16b)](_0x22be08=>{var _0x3b3eab=_0x559c14;_0x429888[_0x3b3eab(0x163)]('add_adjustment_finished',{'success':_0x5118ce[_0x3b3eab(0x103)](_0x3b3eab(0x169)),'errors':_0x5118ce[_0x3b3eab(0x103)](_0x3b3eab(0x124)),'role':_0x92cbc8,'profile':_0x56b0fe,'warehouse':_0x404fe4,'product':_0x477188,'master_shop':_0x1a2eaf,'language':_0x2c2bd5,'rooms_data':_0x337446,'invoice_no':_0x22be08});})[_0x559c14(0x16a)](_0x5caae5=>{var _0x3fbb74=_0x559c14;_0x5118ce[_0x3fbb74(0x103)](_0x3fbb74(0x124),_0x3fbb74(0x176)),_0x429888[_0x3fbb74(0x166)]('/adjustment/view');});}catch(_0x177b84){console[_0x559c14(0x15e)](_0x177b84);}}),router[a0_0x1615b1(0x137)](a0_0x1615b1(0x11f),auth,async(_0x200da4,_0x4ebc5e)=>{var _0xd3e231=a0_0x1615b1;try{const {warehouse_name:_0x315d2d,date:_0x4d8f73,prod_name:_0x34d3ab,level:_0xe73976,isle:_0x31e5da,pallet:_0x1d6020,stock:_0x1501f7,types:_0xbc697d,adjust_qty:_0x524d46,new_adjust_qty:_0x39b1b5,note:_0x1a7a44,Room_name:_0x49cbbe,JO_number:_0x49e202,expiry_date:_0x3fa84e,PO_number:_0x3b3b50,ReqBy:_0xb0d58e,dateofreq:_0x408fe7,typeservicesData:_0x227b5e,destination:_0x3686da,deliverydate:_0x55dedd,driver:_0x113dc6,plate:_0x5ceb33,van:_0x29b68e,DRSI:_0x3022b8,typevehicle:_0x4326d5,TSU:_0x4ffa9b,TFU:_0x97095e}=_0x200da4[_0xd3e231(0xdb)];if(typeof _0x34d3ab==_0xd3e231(0x15c))var _0x3cec25=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x142)]],_0x40e4c8=[_0x200da4['body'][_0xd3e231(0x12e)]],_0x2cd46b=[_0x200da4['body'][_0xd3e231(0x126)]],_0x265584=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0xf7)]],_0x6d3830=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x119)]],_0x381580=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x182)]],_0x1745ca=[_0x200da4[_0xd3e231(0xdb)]['Primary_Units']],_0x8b4a5d=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0xe8)]],_0x107bc7=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0xf6)]],_0x31f6e7=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0xfa)]],_0x297b51=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x111)]],_0x4670e8=[_0x200da4[_0xd3e231(0xdb)]['product_date']],_0x5215db=[_0x200da4[_0xd3e231(0xdb)]['prod_cat']],_0xf03b50=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x184)]],_0x503373=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x14f)]],_0x1c67ba=[_0x200da4['body'][_0xd3e231(0x10b)]],_0x7599bc=[_0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x17c)]];else var _0x3cec25=[..._0x200da4['body'][_0xd3e231(0x142)]],_0x40e4c8=[..._0x200da4['body'][_0xd3e231(0x12e)]],_0x2cd46b=[..._0x200da4[_0xd3e231(0xdb)]['stock']],_0x265584=[..._0x200da4['body'][_0xd3e231(0xf7)]],_0x6d3830=[..._0x200da4['body'][_0xd3e231(0x119)]],_0x381580=[..._0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x182)]],_0x1745ca=[..._0x200da4['body'][_0xd3e231(0x13f)]],_0x8b4a5d=[..._0x200da4[_0xd3e231(0xdb)]['Secondary_units']],_0x107bc7=[..._0x200da4[_0xd3e231(0xdb)][_0xd3e231(0xf6)]],_0x31f6e7=[..._0x200da4['body']['batch_code']],_0x297b51=[..._0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x111)]],_0x4670e8=[..._0x200da4['body'][_0xd3e231(0x139)]],_0x5215db=[..._0x200da4[_0xd3e231(0xdb)]['prod_cat']],_0xf03b50=[..._0x200da4[_0xd3e231(0xdb)]['Rooms']],_0x503373=[..._0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x14f)]],_0x1c67ba=[..._0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x10b)]],_0x7599bc=[..._0x200da4[_0xd3e231(0xdb)][_0xd3e231(0x17c)]];const _0x1e7523=_0x3cec25[_0xd3e231(0xee)](_0x43f7da=>{return _0x43f7da={'product_name':_0x43f7da};});_0x40e4c8['forEach']((_0x489026,_0x1058db)=>{var _0x463b04=_0xd3e231,_0x25f854=_0x489026['match'](/[A-Za-z]+/)[0x0],_0x8e6cac=parseInt(_0x489026[_0x463b04(0x12b)](/\d+/)[0x0]);_0x1e7523[_0x1058db][_0x463b04(0x12e)]=_0x25f854,_0x1e7523[_0x1058db][_0x463b04(0x171)]=_0x8e6cac;}),_0x7599bc[_0xd3e231(0x140)]((_0x22fa05,_0x3c2c78)=>{_0x1e7523[_0x3c2c78]['id_transaction']=_0x22fa05;}),_0x2cd46b['forEach']((_0x2318f5,_0x2bdab9)=>{var _0x507ec9=_0xd3e231;_0x1e7523[_0x2bdab9][_0x507ec9(0x165)]=_0x2318f5;}),_0x265584['forEach']((_0x1f0288,_0x19d612)=>{var _0x520faa=_0xd3e231;_0x1e7523[_0x19d612][_0x520faa(0xf7)]=_0x1f0288;}),_0x6d3830[_0xd3e231(0x140)]((_0x53ce1b,_0xfc08c)=>{var _0x5e12b7=_0xd3e231;_0x1e7523[_0xfc08c][_0x5e12b7(0x13a)]=_0x53ce1b;}),_0x381580['forEach']((_0x37b8f0,_0x400554)=>{var _0x29c714=_0xd3e231;_0x1e7523[_0x400554][_0x29c714(0x162)]=_0x37b8f0;}),_0x1745ca[_0xd3e231(0x140)]((_0x7cbfa6,_0x7c1aba)=>{var _0x14d32e=_0xd3e231;_0x1e7523[_0x7c1aba][_0x14d32e(0x17a)]=_0x7cbfa6;}),_0x8b4a5d[_0xd3e231(0x140)]((_0x507fbd,_0x40a85b)=>{var _0x5e738b=_0xd3e231;_0x1e7523[_0x40a85b][_0x5e738b(0xef)]=_0x507fbd;}),_0x107bc7[_0xd3e231(0x140)]((_0x280d63,_0x4edcee)=>{var _0x167a07=_0xd3e231;_0x1e7523[_0x4edcee][_0x167a07(0x115)]=_0x280d63;}),_0x31f6e7[_0xd3e231(0x140)]((_0x17e376,_0xe79ac5)=>{var _0x3b141c=_0xd3e231;_0x1e7523[_0xe79ac5][_0x3b141c(0xfa)]=_0x17e376;}),_0x297b51[_0xd3e231(0x140)]((_0xa0e9ef,_0x46f43e)=>{_0x1e7523[_0x46f43e]['expiry_date']=_0xa0e9ef;}),_0x4670e8['forEach']((_0xb01645,_0x51c925)=>{var _0xfff838=_0xd3e231;_0x1e7523[_0x51c925][_0xfff838(0x159)]=_0xb01645;}),_0x5215db[_0xd3e231(0x140)]((_0x10ffac,_0x1252fa)=>{var _0x2efe85=_0xd3e231;_0x1e7523[_0x1252fa][_0x2efe85(0x120)]=_0x10ffac;}),_0xf03b50[_0xd3e231(0x140)]((_0x4f5c40,_0x31c7e3)=>{var _0xef28ef=_0xd3e231;_0x1e7523[_0x31c7e3][_0xef28ef(0xf2)]=_0x4f5c40;}),_0x503373['forEach']((_0x63e1be,_0x59e056)=>{var _0x725d04=_0xd3e231;_0x1e7523[_0x59e056][_0x725d04(0x14f)]=_0x63e1be;}),_0x1c67ba[_0xd3e231(0x140)]((_0x58934a,_0x358541)=>{var _0x143c1f=_0xd3e231;_0x1e7523[_0x358541][_0x143c1f(0x141)]=_0x58934a;});const _0x57ac46=_0x1e7523[_0xd3e231(0x14b)](_0x525a17=>_0x525a17[_0xd3e231(0x13a)]!=='0'&&_0x525a17[_0xd3e231(0x13a)]!=='');var _0x2cc7af=0x0;_0x57ac46['forEach'](_0x3a7632=>{var _0x18c97d=_0xd3e231;console[_0x18c97d(0x15e)](_0x18c97d(0x148),_0x3a7632),parseInt(_0x3a7632[_0x18c97d(0x13a)])<=0x0&&_0x2cc7af++;});if(_0x2cc7af!=0x0)return _0x200da4[_0xd3e231(0x103)](_0xd3e231(0x124),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x4ebc5e[_0xd3e231(0x166)](_0xd3e231(0x134));const _0x16009f=new invoice_for_adjustment();await _0x16009f['save']();const _0x286102=new adjustment_finished({'warehouse_name':_0x315d2d,'date':_0x4d8f73,'product':_0x57ac46,'note':_0x1a7a44,'room':_0x49cbbe,'invoice':_0xd3e231(0xfd)+_0x16009f['invoice_init'][_0xd3e231(0xfc)]()['padStart'](0x8,'0'),'JO_number':_0x49e202,'expiry_date':_0x3fa84e,'PO_number':_0x3b3b50,'RequestedBy':_0xb0d58e,'DateofRequest':_0x408fe7,'typeservices':_0x227b5e,'destination':_0x3686da,'deliverydate':_0x55dedd,'driver':_0x113dc6,'plate':_0x5ceb33,'van':_0x29b68e,'DRSI':_0x3022b8,'typevehicle':_0x4326d5,'TSU':_0x4ffa9b,'TFU':_0x97095e}),_0x2e5fdc=await _0x286102['save']();_0x200da4['flash']('success',_0xd3e231(0x121)),_0x4ebc5e[_0xd3e231(0x166)](_0xd3e231(0x173)+_0x2e5fdc[_0xd3e231(0x185)]);}catch(_0xd3a290){console[_0xd3e231(0x15e)](_0xd3a290),_0x4ebc5e[_0xd3e231(0xdf)](0xc8)[_0xd3e231(0xe1)]({'message':_0xd3a290[_0xd3e231(0x10c)]});}}),router[a0_0x1615b1(0x16d)](a0_0x1615b1(0x167),auth,async(_0x3a095a,_0x37de9a)=>{var _0x41b7de=a0_0x1615b1;try{const {username:_0x5116bd,email:_0x5e18ce,role:_0x370f4d}=_0x3a095a[_0x41b7de(0x15b)],_0x48240d=_0x3a095a['user'],_0xd7792f=await profile[_0x41b7de(0x102)]({'email':_0x48240d['email']}),_0x116240=await master_shop[_0x41b7de(0x129)]();let _0x1d3ff7;if(_0x48240d[_0x41b7de(0x11a)]==_0x41b7de(0x130)){const _0xd4cfe9=await staff[_0x41b7de(0x102)]({'email':_0x48240d[_0x41b7de(0xfe)]});_0x1d3ff7=await warehouse['aggregate']([{'$match':{'status':_0x41b7de(0xe0),'name':_0xd4cfe9[_0x41b7de(0x122)]}},{'$group':{'_id':_0x41b7de(0x125),'name':{'$first':_0x41b7de(0x125)}}}]);}else _0x1d3ff7=await warehouse['aggregate']([{'$match':{'status':_0x41b7de(0xe0)}},{'$group':{'_id':_0x41b7de(0x125),'name':{'$first':_0x41b7de(0x125)}}}]);const _0x1974e2=await product['find'](),_0x564c73=await adjustment_finished[_0x41b7de(0x129)](),_0xe557f1=_0x564c73[_0x41b7de(0x10a)]+0x1,_0x3bc073='ADJF-'+_0xe557f1[_0x41b7de(0xfc)]()['padStart'](0x5,'0');var _0x356f71=['Ambient',_0x41b7de(0xf0),_0x41b7de(0xf5)];if(_0x116240[0x0][_0x41b7de(0x113)]==_0x41b7de(0x131))var _0x51bf78=users[_0x41b7de(0x16e)];else{if(_0x116240[0x0][_0x41b7de(0x113)]==_0x41b7de(0x12d))var _0x51bf78=users[_0x41b7de(0x12d)];else{if(_0x116240[0x0][_0x41b7de(0x113)]==_0x41b7de(0xdc))var _0x51bf78=users[_0x41b7de(0xdc)];else{if(_0x116240[0x0][_0x41b7de(0x113)]==_0x41b7de(0x164))var _0x51bf78=users['Spanish'];else{if(_0x116240[0x0][_0x41b7de(0x113)]==_0x41b7de(0x15a))var _0x51bf78=users['French'];else{if(_0x116240[0x0][_0x41b7de(0x113)]=='Portuguese\x20(BR)')var _0x51bf78=users['Portuguese'];else{if(_0x116240[0x0][_0x41b7de(0x113)]==_0x41b7de(0xfb))var _0x51bf78=users[_0x41b7de(0xfb)];else{if(_0x116240[0x0][_0x41b7de(0x113)]=='Arabic\x20(ae)')var _0x51bf78=users[_0x41b7de(0x178)];}}}}}}}const _0x3b3a3e=getRandom8DigitNumber();_0x3b3a3e[_0x41b7de(0x16b)](_0x4a45fb=>{var _0x2244d8=_0x41b7de;_0x37de9a[_0x2244d8(0x163)](_0x2244d8(0xea),{'success':_0x3a095a[_0x2244d8(0x103)](_0x2244d8(0x169)),'errors':_0x3a095a['flash'](_0x2244d8(0x124)),'role':_0x48240d,'profile':_0xd7792f,'warehouse':_0x1d3ff7,'product':_0x1974e2,'master_shop':_0x116240,'language':_0x51bf78,'rooms_data':_0x356f71,'invoice_no':_0x4a45fb});})[_0x41b7de(0x16a)](_0x2b3081=>{var _0x4729fc=_0x41b7de;_0x3a095a[_0x4729fc(0x103)](_0x4729fc(0x124),_0x4729fc(0x176)),_0x37de9a['redirect'](_0x4729fc(0x17d));});}catch(_0x344a56){console[_0x41b7de(0x15e)](_0x344a56);}}),router[a0_0x1615b1(0x137)](a0_0x1615b1(0x167),auth,async(_0x384fad,_0x3f3ec7)=>{var _0x2e9d17=a0_0x1615b1;try{const {warehouse_name:_0x4e8b4c,date:_0x57bb77,prod_name:_0x10531a,level:_0x3e6664,isle:_0x54e41c,pallet:_0x36e9af,stock:_0x1b5d4d,types:_0x4a9cf3,adjust_qty:_0x121a72,new_adjust_qty:_0x351c98,note:_0x202638,Room_name:_0x3c1f84,JO_number:_0x5c1e35,expiry_date:_0x4cf577,type_of_transaction:_0x251bbc,PO_number:_0x56810c,ReqBy:_0x224601,dateofreq:_0x2dba6e,typeservicesData:_0x1d5204,destination:_0x4e208d,deliverydate:_0x57b1c4,driver:_0x48ee81,plate:_0x184098,van:_0x165879,DRSI:_0x39f16c,typevehicle:_0x4f7c64,TSU:_0x1d9107,TFU:_0x20d574}=_0x384fad[_0x2e9d17(0xdb)];if(typeof _0x10531a==_0x2e9d17(0x15c))var _0x2ae4ff=[_0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x142)]],_0x5e8624=[_0x384fad['body'][_0x2e9d17(0x12e)]],_0x1744e8=[_0x384fad['body'][_0x2e9d17(0x126)]],_0xcf6f6=[_0x384fad['body'][_0x2e9d17(0xf7)]],_0x110f5f=[_0x384fad['body'][_0x2e9d17(0x119)]],_0x28e7ae=[_0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x182)]],_0x252463=[_0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x13f)]],_0x1edd30=[_0x384fad['body'][_0x2e9d17(0xe8)]],_0x2459db=[_0x384fad['body'][_0x2e9d17(0xf6)]],_0x2472f4=[_0x384fad['body'][_0x2e9d17(0xfa)]],_0x21c551=[_0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x111)]],_0x52f852=[_0x384fad[_0x2e9d17(0xdb)]['product_date']],_0x13d51c=[_0x384fad['body'][_0x2e9d17(0x120)]],_0x23ece3=[_0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x184)]],_0x510f90=[_0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x14f)]],_0xcf288=[_0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x10b)]],_0x469c25=[_0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x17c)]];else var _0x2ae4ff=[..._0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x142)]],_0x5e8624=[..._0x384fad['body'][_0x2e9d17(0x12e)]],_0x1744e8=[..._0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x126)]],_0xcf6f6=[..._0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0xf7)]],_0x110f5f=[..._0x384fad[_0x2e9d17(0xdb)]['New_Qty_Converted_adj']],_0x28e7ae=[..._0x384fad['body'][_0x2e9d17(0x182)]],_0x252463=[..._0x384fad[_0x2e9d17(0xdb)]['Primary_Units']],_0x1edd30=[..._0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0xe8)]],_0x2459db=[..._0x384fad['body'][_0x2e9d17(0xf6)]],_0x2472f4=[..._0x384fad['body'][_0x2e9d17(0xfa)]],_0x21c551=[..._0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x111)]],_0x52f852=[..._0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x139)]],_0x13d51c=[..._0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x120)]],_0x23ece3=[..._0x384fad[_0x2e9d17(0xdb)]['Rooms']],_0x510f90=[..._0x384fad[_0x2e9d17(0xdb)]['maxPerUnit']],_0xcf288=[..._0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x10b)]],_0x469c25=[..._0x384fad[_0x2e9d17(0xdb)][_0x2e9d17(0x17c)]];const _0xd42ad2=_0x2ae4ff['map'](_0x341bc2=>{return _0x341bc2={'product_name':_0x341bc2};});_0x5e8624[_0x2e9d17(0x140)]((_0x4264f4,_0xca3369)=>{var _0x5757df=_0x2e9d17,_0x10850b=_0x4264f4[_0x5757df(0x12b)](/[A-Za-z]+/)[0x0],_0x3d2106=parseInt(_0x4264f4[_0x5757df(0x12b)](/\d+/)[0x0]);_0xd42ad2[_0xca3369][_0x5757df(0x12e)]=_0x10850b,_0xd42ad2[_0xca3369][_0x5757df(0x171)]=_0x3d2106;}),_0x469c25[_0x2e9d17(0x140)]((_0x2b076d,_0x3ab982)=>{var _0x2d3ecc=_0x2e9d17;_0xd42ad2[_0x3ab982][_0x2d3ecc(0x17e)]=_0x2b076d;}),_0x1744e8[_0x2e9d17(0x140)]((_0x28cd1b,_0x38517d)=>{var _0x38a437=_0x2e9d17;_0xd42ad2[_0x38517d][_0x38a437(0x165)]=_0x28cd1b;}),_0xcf6f6[_0x2e9d17(0x140)]((_0x2f671e,_0x25a91c)=>{var _0x47dadb=_0x2e9d17;_0xd42ad2[_0x25a91c][_0x47dadb(0xf7)]=_0x2f671e;}),_0x110f5f[_0x2e9d17(0x140)]((_0x3b7f29,_0x335efb)=>{var _0x2829b7=_0x2e9d17;_0xd42ad2[_0x335efb][_0x2829b7(0x13a)]=_0x3b7f29;}),_0x28e7ae['forEach']((_0x11df4a,_0x252d04)=>{_0xd42ad2[_0x252d04]['new_adjust_qty']=_0x11df4a;}),_0x252463[_0x2e9d17(0x140)]((_0x1d8219,_0x3be9a4)=>{_0xd42ad2[_0x3be9a4]['unit']=_0x1d8219;}),_0x1edd30[_0x2e9d17(0x140)]((_0x44f572,_0x138ced)=>{var _0x2e5364=_0x2e9d17;_0xd42ad2[_0x138ced][_0x2e5364(0xef)]=_0x44f572;}),_0x2459db[_0x2e9d17(0x140)]((_0x38bfc4,_0x1f342c)=>{var _0x57adec=_0x2e9d17;_0xd42ad2[_0x1f342c][_0x57adec(0x115)]=_0x38bfc4;}),_0x2472f4[_0x2e9d17(0x140)]((_0x35c4f0,_0x5ed257)=>{var _0x4faccd=_0x2e9d17;_0xd42ad2[_0x5ed257][_0x4faccd(0xfa)]=_0x35c4f0;}),_0x21c551['forEach']((_0xef8273,_0x2005ba)=>{var _0x562a4d=_0x2e9d17;_0xd42ad2[_0x2005ba][_0x562a4d(0x111)]=_0xef8273;}),_0x52f852[_0x2e9d17(0x140)]((_0x57dca7,_0xbd2760)=>{var _0x102ce6=_0x2e9d17;_0xd42ad2[_0xbd2760][_0x102ce6(0x159)]=_0x57dca7;}),_0x13d51c[_0x2e9d17(0x140)]((_0x5680b4,_0x153ef1)=>{var _0x19f1f2=_0x2e9d17;_0xd42ad2[_0x153ef1][_0x19f1f2(0x120)]=_0x5680b4;}),_0x23ece3[_0x2e9d17(0x140)]((_0x462ef0,_0x5aff8f)=>{var _0xc5076c=_0x2e9d17;_0xd42ad2[_0x5aff8f][_0xc5076c(0xf2)]=_0x462ef0;}),_0x510f90['forEach']((_0x42cbdd,_0x1af2df)=>{var _0x5e96b3=_0x2e9d17;_0xd42ad2[_0x1af2df][_0x5e96b3(0x14f)]=_0x42cbdd;}),_0xcf288['forEach']((_0x1ac32d,_0x18b9e3)=>{var _0x5bc768=_0x2e9d17;_0xd42ad2[_0x18b9e3][_0x5bc768(0x141)]=_0x1ac32d;});const _0x2f6a10=_0xd42ad2['filter'](_0x15f29c=>_0x15f29c[_0x2e9d17(0x13a)]!=='0'&&_0x15f29c[_0x2e9d17(0x13a)]!=='');var _0x1aefd4=0x0;_0x2f6a10[_0x2e9d17(0x140)](_0x1e0b23=>{var _0x25ea52=_0x2e9d17;console[_0x25ea52(0x15e)](_0x25ea52(0x148),_0x1e0b23),parseInt(_0x1e0b23[_0x25ea52(0x13a)])<=0x0&&_0x1aefd4++;});if(_0x1aefd4!=0x0)return _0x384fad[_0x2e9d17(0x103)](_0x2e9d17(0x124),_0x2e9d17(0x14a)),_0x3f3ec7[_0x2e9d17(0x166)](_0x2e9d17(0x134));const _0x26fc54=new adjustment_logs();await _0x26fc54[_0x2e9d17(0x186)]();const _0x5b184c=new adjustment_finished({'warehouse_name':_0x4e8b4c,'date':_0x57bb77,'product':_0x2f6a10,'note':_0x202638,'room':_0x3c1f84,'invoice':_0x2e9d17(0x147)+_0x26fc54[_0x2e9d17(0x107)][_0x2e9d17(0xfc)]()[_0x2e9d17(0x109)](0x8,'0'),'JO_number':_0x5c1e35,'expiry_date':_0x4cf577,'type_of_transaction':_0x251bbc,'PO_number':_0x56810c,'RequestedBy':_0x224601,'DateofRequest':_0x2dba6e,'typeservices':_0x1d5204,'destination':_0x4e208d,'deliverydate':_0x57b1c4,'driver':_0x48ee81,'plate':_0x184098,'van':_0x165879,'DRSI':_0x39f16c,'typevehicle':_0x4f7c64,'TSU':_0x1d9107,'TFU':_0x20d574}),_0x948406=await _0x5b184c['save']();_0x384fad['flash'](_0x2e9d17(0x169),'adjustment\x20add\x20successfull'),_0x3f3ec7['redirect']('/adjustment_finished/preview/'+_0x948406['_id']);}catch(_0x573808){console[_0x2e9d17(0x15e)](_0x573808),_0x3f3ec7[_0x2e9d17(0xdf)](0xc8)[_0x2e9d17(0xe1)]({'message':_0x573808['message']});}}),router[a0_0x1615b1(0x16d)]('/preview/:id',auth,async(_0x263b23,_0x471314)=>{var _0x33f237=a0_0x1615b1;try{const {username:_0x2cf6da,email:_0x4f1e73,role:_0xc9a1b2}=_0x263b23[_0x33f237(0x15b)],_0x18a1c1=_0x263b23['user'],_0x5e5a8b=await profile[_0x33f237(0x102)]({'email':_0x18a1c1[_0x33f237(0xfe)]}),_0x2d1e66=await master_shop[_0x33f237(0x129)](),_0x5816aa=_0x263b23['params']['id'],_0x244972=await adjustment_finished[_0x33f237(0x17b)]({'_id':_0x5816aa}),_0x414761=await purchases[_0x33f237(0xf4)]([{'$match':{'warehouse_name':_0x244972['warehouse_name']}},{'$unwind':_0x33f237(0x180)},{'$group':{'_id':'$product.product_name'}}]);console[_0x33f237(0x15e)](_0x33f237(0x158),_0x414761);const _0x58a1bf=await product[_0x33f237(0x129)]({}),_0x421aa3=await warehouse[_0x33f237(0xf4)]([{'$match':{'name':_0x244972['warehouse_name']}},{'$unwind':_0x33f237(0x11b)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x33f237(0x168)},'bin':{'$first':_0x33f237(0x138)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x33f237(0x136)},'secondary_code':{'$first':_0x33f237(0x17f)},'product_code':{'$first':_0x33f237(0x13d)},'storage':{'$first':_0x33f237(0xe2)},'rack':{'$first':_0x33f237(0x14d)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x33f237(0x156)},'batch_code':{'$first':_0x33f237(0x116)},'maxPerUnit':{'$first':_0x33f237(0x161)},'room':{'$first':'$room'}}}]);if(_0x2d1e66[0x0][_0x33f237(0x113)]==_0x33f237(0x131)){var _0xce69d7=users[_0x33f237(0x16e)];console[_0x33f237(0x15e)](_0xce69d7);}else{if(_0x2d1e66[0x0][_0x33f237(0x113)]==_0x33f237(0x12d))var _0xce69d7=users[_0x33f237(0x12d)];else{if(_0x2d1e66[0x0][_0x33f237(0x113)]==_0x33f237(0xdc))var _0xce69d7=users[_0x33f237(0xdc)];else{if(_0x2d1e66[0x0][_0x33f237(0x113)]=='Spanish')var _0xce69d7=users[_0x33f237(0x164)];else{if(_0x2d1e66[0x0][_0x33f237(0x113)]==_0x33f237(0x15a))var _0xce69d7=users[_0x33f237(0x15a)];else{if(_0x2d1e66[0x0][_0x33f237(0x113)]==_0x33f237(0xe6))var _0xce69d7=users['Portuguese'];else{if(_0x2d1e66[0x0][_0x33f237(0x113)]==_0x33f237(0xfb))var _0xce69d7=users[_0x33f237(0xfb)];else{if(_0x2d1e66[0x0][_0x33f237(0x113)]=='Arabic\x20(ae)')var _0xce69d7=users[_0x33f237(0x178)];}}}}}}}_0x471314[_0x33f237(0x163)](_0x33f237(0x118),{'success':_0x263b23['flash'](_0x33f237(0x169)),'errors':_0x263b23[_0x33f237(0x103)](_0x33f237(0x124)),'role':_0x18a1c1,'profile':_0x5e5a8b,'adjustment':_0x244972,'stock':_0x421aa3,'master_shop':_0x2d1e66,'warehouse_name':_0x414761,'unit':_0x58a1bf,'language':_0xce69d7});}catch(_0x5b243e){console[_0x33f237(0x15e)](_0x5b243e),_0x471314[_0x33f237(0xdf)](0xc8)[_0x33f237(0xe1)]({'message':_0x5b243e[_0x33f237(0x10c)]});}}),router[a0_0x1615b1(0x137)](a0_0x1615b1(0xf9),auth,async(_0x3fc057,_0x57a6b3)=>{var _0x587958=a0_0x1615b1;try{const {invoice:_0x338a5b,warehouse_name:_0x569674,Room_name:_0x3e65aa}=_0x3fc057[_0x587958(0xdb)],_0x6f4d03=_0x3fc057[_0x587958(0x13b)]['id'],_0x426f30=await adjustment_finished[_0x587958(0x17b)]({'_id':_0x6f4d03});var _0x55d5d8;const _0xd7b8ee=_0x426f30['product'][_0x587958(0xee)](async _0x1d8688=>{var _0x3ee9dc=_0x587958;if(_0x1d8688[_0x3ee9dc(0x13a)]>0x0){_0x55d5d8=await warehouse[_0x3ee9dc(0x102)]({'name':_0x569674,'room':_0x1d8688[_0x3ee9dc(0xf2)]});const _0x3e1439=_0x55d5d8['product_details'][_0x3ee9dc(0xee)](_0x3812fd=>{var _0xc3260e=_0x3ee9dc;console[_0xc3260e(0x15e)](_0x1d8688[_0xc3260e(0xf7)]);if(_0x1d8688['types']=='minus')_0x3812fd[_0xc3260e(0x185)]==_0x1d8688[_0xc3260e(0x17e)]&&(_0x3812fd[_0xc3260e(0x10d)]=_0x3812fd[_0xc3260e(0x10d)]-_0x1d8688[_0xc3260e(0x13a)]);else _0x1d8688[_0xc3260e(0xf7)]==_0xc3260e(0x187)&&(_0x3812fd[_0xc3260e(0x185)]==_0x1d8688[_0xc3260e(0x17e)]&&(_0x3812fd[_0xc3260e(0x10d)]=_0x3812fd[_0xc3260e(0x10d)]+_0x1d8688['adjust_qty']));});}return _0x55d5d8;});Promise[_0x587958(0x12c)](_0xd7b8ee)[_0x587958(0x16b)](async _0x8dc158=>{var _0x50c9b3=_0x587958;try{for(const _0x529e23 of _0x8dc158){await _0x529e23['save']();}_0x426f30[_0x50c9b3(0x152)]='True';const _0x461861=await _0x426f30[_0x50c9b3(0x186)](),_0x23c0b4=await master_shop[_0x50c9b3(0x129)](),_0x37f5c9=await email_settings[_0x50c9b3(0x102)](),_0x204da0=await supervisor_settings[_0x50c9b3(0x129)]();var _0x56be60=_0x426f30[_0x50c9b3(0x153)],_0x42e691='',_0x26a8eb;for(_0x26a8eb in _0x56be60){var _0x672211='FG';_0x426f30[_0x50c9b3(0x175)]==_0x50c9b3(0x104)&&(_0x672211='DG'),_0x42e691+=_0x50c9b3(0x12a)+_0x50c9b3(0xe9)+_0x56be60[_0x26a8eb]['product_name']+_0x50c9b3(0x160)+_0x50c9b3(0xe9)+_0x56be60[_0x26a8eb][_0x50c9b3(0x115)]+_0x50c9b3(0x160)+_0x50c9b3(0xe9)+_0x56be60[_0x26a8eb][_0x50c9b3(0x13a)]+_0x50c9b3(0x160)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x56be60[_0x26a8eb][_0x50c9b3(0x17a)]+_0x50c9b3(0x160)+_0x50c9b3(0xe9)+_0x56be60[_0x26a8eb][_0x50c9b3(0xef)]+_0x50c9b3(0x160)+_0x50c9b3(0xe9)+_0x426f30[_0x50c9b3(0x175)]+_0x50c9b3(0x160)+_0x50c9b3(0xe9)+_0x56be60[_0x26a8eb][_0x50c9b3(0xf2)]+_0x50c9b3(0x160)+_0x50c9b3(0xe9)+_0x672211+_0x56be60[_0x26a8eb][_0x50c9b3(0x171)]+_0x50c9b3(0x160)+'</tr>';}_0x3fc057['flash'](_0x50c9b3(0x169),_0x50c9b3(0xe7)),_0x57a6b3[_0x50c9b3(0x166)]('/picking_list/PDF_adjustmentFinal/'+_0x461861[_0x50c9b3(0x185)]);}catch(_0x33b526){console[_0x50c9b3(0x112)](_0x33b526),_0x57a6b3[_0x50c9b3(0xdf)](0x1f4)[_0x50c9b3(0xe1)]({'error':_0x50c9b3(0xde)});}})[_0x587958(0x16a)](_0x10c2dc=>{var _0x918a15=_0x587958;console[_0x918a15(0x112)](_0x10c2dc),_0x57a6b3[_0x918a15(0xdf)](0x1f4)[_0x918a15(0xe1)]({'error':'An\x20error\x20occurred.'});});}catch(_0x22fdf7){_0x57a6b3[_0x587958(0xe1)]({'message':_0x22fdf7[_0x587958(0x10c)]});}}),router[a0_0x1615b1(0x16d)](a0_0x1615b1(0x132),auth,async(_0x37f364,_0x3109b4)=>{var _0x30533a=a0_0x1615b1;try{const {username:_0x563e7e,email:_0x2a93ee,role:_0x2b342f}=_0x37f364['user'],_0x5b2340=_0x37f364[_0x30533a(0x15b)],_0x3fb399=await profile[_0x30533a(0x102)]({'email':_0x5b2340[_0x30533a(0xfe)]}),_0x207324=await master_shop['find']();console[_0x30533a(0x15e)](_0x30533a(0x188),_0x207324);const _0x15e441=_0x37f364[_0x30533a(0x13b)]['id'],_0x577805=await adjustment_finished[_0x30533a(0x17b)]({'_id':_0x15e441});let _0x441f17=new Date(_0x577805[_0x30533a(0x111)]),_0x47ef50=('0'+_0x441f17[_0x30533a(0x105)]())[_0x30533a(0x154)](-0x2),_0x208f58=('0'+(_0x441f17[_0x30533a(0x144)]()+0x1))[_0x30533a(0x154)](-0x2),_0x3f042b=_0x441f17[_0x30533a(0xf3)](),_0x3d54f4=_0x3f042b+'-'+_0x208f58+'-'+_0x47ef50;var _0x7f184b=[_0x30533a(0xeb),_0x30533a(0xf0),'Return\x20Rooms'];const _0x369569=await purchases[_0x30533a(0xf4)]([{'$match':{'warehouse_name':_0x577805['warehouse_name']}},{'$unwind':_0x30533a(0x180)},{'$group':{'_id':_0x30533a(0x117)}}]);console[_0x30533a(0x15e)](_0x30533a(0x158),_0x369569);const _0x3e3fe0=await product[_0x30533a(0x129)]({}),_0x39a0f4=await warehouse[_0x30533a(0xf4)]([{'$match':{'name':_0x577805[_0x30533a(0x175)],'room':_0x577805[_0x30533a(0x135)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x30533a(0x179),'name':{'$first':_0x30533a(0x149)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x30533a(0x168)},'bin':{'$first':_0x30533a(0x138)},'type':{'$first':_0x30533a(0x10e)},'floorlevel':{'$first':_0x30533a(0x189)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x30533a(0x17f)},'product_code':{'$first':_0x30533a(0x13d)},'storage':{'$first':_0x30533a(0xe2)},'rack':{'$first':'$product_details.rack'}}}]);if(_0x207324[0x0][_0x30533a(0x113)]==_0x30533a(0x131)){var _0x1871bf=users[_0x30533a(0x16e)];console[_0x30533a(0x15e)](_0x1871bf);}else{if(_0x207324[0x0]['language']==_0x30533a(0x12d))var _0x1871bf=users['Hindi'];else{if(_0x207324[0x0][_0x30533a(0x113)]=='German')var _0x1871bf=users[_0x30533a(0xdc)];else{if(_0x207324[0x0][_0x30533a(0x113)]==_0x30533a(0x164))var _0x1871bf=users[_0x30533a(0x164)];else{if(_0x207324[0x0][_0x30533a(0x113)]==_0x30533a(0x15a))var _0x1871bf=users[_0x30533a(0x15a)];else{if(_0x207324[0x0][_0x30533a(0x113)]==_0x30533a(0xe6))var _0x1871bf=users[_0x30533a(0x12f)];else{if(_0x207324[0x0][_0x30533a(0x113)]==_0x30533a(0xfb))var _0x1871bf=users['Chinese'];else{if(_0x207324[0x0][_0x30533a(0x113)]==_0x30533a(0x11e))var _0x1871bf=users[_0x30533a(0x178)];}}}}}}}_0x3109b4[_0x30533a(0x163)](_0x30533a(0xf1),{'success':_0x37f364[_0x30533a(0x103)](_0x30533a(0x169)),'errors':_0x37f364[_0x30533a(0x103)](_0x30533a(0x124)),'role':_0x5b2340,'profile':_0x3fb399,'adjustment':_0x577805,'stock':_0x39a0f4,'master_shop':_0x207324,'warehouse_name':_0x369569,'unit':_0x3e3fe0,'language':_0x1871bf,'rooms_data':_0x7f184b,'ed_fullDate':_0x3d54f4});}catch(_0x31802a){console[_0x30533a(0x15e)](_0x31802a),_0x3109b4['status'](0xc8)[_0x30533a(0xe1)]({'message':_0x31802a['message']});}}),router[a0_0x1615b1(0x137)]('/view/:id',auth,async(_0x4cc1de,_0x12dc88)=>{var _0x580938=a0_0x1615b1;try{const _0x1983e2=_0x4cc1de[_0x580938(0x13b)]['id'],_0x503d11=await adjustment_finished[_0x580938(0x17b)]({'_id':_0x1983e2}),_0x4c6a8f=await warehouse[_0x580938(0x102)]({'name':_0x503d11[_0x580938(0x175)],'room':_0x503d11[_0x580938(0x135)]}),{warehouse_name:_0x5d605c,date:_0x802354,prod_name:_0x14b11d,level:_0x1e3f6d,isle:_0x28f6e7,pallet:_0x4488ab,stock:_0x12d2f9,types:_0xe2d8ff,adjust_qty:_0x55b139,new_adjust_qty:_0x1de0b1,note:_0x2c299c,Room_name:_0x36631f,invoice:_0x4dc140,JO_number:_0x12f016}=_0x4cc1de[_0x580938(0xdb)];if(typeof _0x14b11d==_0x580938(0x15c))var _0x38159b=[_0x4cc1de[_0x580938(0xdb)][_0x580938(0x142)]],_0xc642e3=[_0x4cc1de[_0x580938(0xdb)][_0x580938(0x12e)]],_0x523146=[_0x4cc1de[_0x580938(0xdb)]['stock']],_0x2c466a=[_0x4cc1de[_0x580938(0xdb)][_0x580938(0xf7)]],_0x4005a4=[_0x4cc1de[_0x580938(0xdb)]['adjust_qty']],_0x413a81=[_0x4cc1de['body'][_0x580938(0x162)]],_0x5508b0=[_0x4cc1de[_0x580938(0xdb)][_0x580938(0xf6)]],_0x40c241=[_0x4cc1de[_0x580938(0xdb)]['unit']],_0x150a60=[_0x4cc1de[_0x580938(0xdb)][_0x580938(0xe8)]],_0x390597=[_0x4cc1de[_0x580938(0xdb)][_0x580938(0xfa)]],_0x54bb9c=[_0x4cc1de['body'][_0x580938(0x111)]];else var _0x38159b=[..._0x4cc1de['body'][_0x580938(0x142)]],_0xc642e3=[..._0x4cc1de[_0x580938(0xdb)][_0x580938(0x12e)]],_0x523146=[..._0x4cc1de[_0x580938(0xdb)][_0x580938(0x126)]],_0x2c466a=[..._0x4cc1de['body']['types']],_0x4005a4=[..._0x4cc1de[_0x580938(0xdb)][_0x580938(0x13a)]],_0x413a81=[..._0x4cc1de[_0x580938(0xdb)][_0x580938(0x162)]],_0x5508b0=[..._0x4cc1de[_0x580938(0xdb)][_0x580938(0xf6)]],_0x40c241=[..._0x4cc1de[_0x580938(0xdb)][_0x580938(0x17a)]],_0x150a60=[..._0x4cc1de[_0x580938(0xdb)]['Secondary_units']],_0x390597=[..._0x4cc1de[_0x580938(0xdb)]['batch_code']],_0x54bb9c=[..._0x4cc1de[_0x580938(0xdb)]['expiry_date']];const _0x4c8564=_0x38159b[_0x580938(0xee)](_0x244b63=>{return _0x244b63={'product_name':_0x244b63};});_0xc642e3[_0x580938(0x140)]((_0x3d50ca,_0x1904e5)=>{var _0x3dde74=_0x580938;_0x4c8564[_0x1904e5][_0x3dde74(0x171)]=_0x3d50ca;}),_0x523146[_0x580938(0x140)]((_0x3ec8fc,_0x54f689)=>{var _0x2bc97c=_0x580938;_0x4c8564[_0x54f689][_0x2bc97c(0x165)]=_0x3ec8fc;}),_0x2c466a[_0x580938(0x140)]((_0x30b4c6,_0x2ee6be)=>{var _0x57bff1=_0x580938;_0x4c8564[_0x2ee6be][_0x57bff1(0xf7)]=_0x30b4c6;}),_0x4005a4[_0x580938(0x140)]((_0xdc2a29,_0x15f16a)=>{var _0x51968e=_0x580938;_0x4c8564[_0x15f16a][_0x51968e(0x13a)]=_0xdc2a29;}),_0x413a81[_0x580938(0x140)]((_0x26833b,_0x457487)=>{var _0xdb575a=_0x580938;_0x4c8564[_0x457487][_0xdb575a(0x162)]=_0x26833b;}),_0x40c241[_0x580938(0x140)]((_0x5518bf,_0x334fa8)=>{var _0x9b6360=_0x580938;_0x4c8564[_0x334fa8][_0x9b6360(0x17a)]=_0x5518bf;}),_0x150a60[_0x580938(0x140)]((_0x5bdbe0,_0x497066)=>{var _0x1f58e4=_0x580938;_0x4c8564[_0x497066][_0x1f58e4(0xef)]=_0x5bdbe0;}),_0x5508b0[_0x580938(0x140)]((_0x106284,_0x29d3da)=>{var _0x3c00f2=_0x580938;_0x4c8564[_0x29d3da][_0x3c00f2(0x115)]=_0x106284;}),_0x390597[_0x580938(0x140)]((_0x2f4b90,_0x412e5c)=>{var _0x54ba17=_0x580938;_0x4c8564[_0x412e5c][_0x54ba17(0xfa)]=_0x2f4b90;}),_0x54bb9c[_0x580938(0x140)]((_0x116369,_0x2bfa61)=>{_0x4c8564[_0x2bfa61]['expiry_date']=_0x116369;});const _0x5adad1=_0x4c8564[_0x580938(0x14b)](_0x27a74a=>_0x27a74a['adjust_qty']!=='0'&&_0x27a74a[_0x580938(0x13a)]!=='');var _0x560884=0x0;_0x5adad1[_0x580938(0x140)](_0x368082=>{var _0x12ba38=_0x580938;console[_0x12ba38(0x15e)](_0x12ba38(0x148),_0x368082),parseInt(_0x368082['adjust_qty'])<=0x0&&_0x560884++;});if(_0x560884!=0x0)return _0x4cc1de[_0x580938(0x103)](_0x580938(0x124),_0x580938(0x14a)),_0x12dc88[_0x580938(0x166)](_0x580938(0x134));_0x503d11[_0x580938(0x175)]=_0x5d605c,_0x503d11[_0x580938(0x150)]=_0x802354,_0x503d11[_0x580938(0x153)]=_0x5adad1,_0x503d11[_0x580938(0x157)]=_0x2c299c,_0x503d11[_0x580938(0x135)]=_0x36631f,_0x503d11[_0x580938(0x141)]=_0x4dc140,_0x503d11[_0x580938(0x181)]=_0x12f016;const _0x1bd7de=await _0x503d11['save'](),_0x3b917a=await warehouse['findOne']({'name':_0x5d605c,'room':_0x36631f});_0x1bd7de[_0x580938(0x153)][_0x580938(0x140)](_0x20c669=>{var _0x2f0790=_0x580938;const _0x2bb31f=_0x3b917a[_0x2f0790(0x174)]['map'](_0x5ec226=>{var _0x2c4fb2=_0x2f0790;_0x20c669[_0x2c4fb2(0xf7)]==_0x2c4fb2(0x127)?_0x5ec226['product_name']==_0x20c669['product_name']&&_0x5ec226[_0x2c4fb2(0x171)]==_0x20c669[_0x2c4fb2(0x171)]&&(_0x5ec226[_0x2c4fb2(0x10d)]=parseInt(_0x5ec226['product_stock'])-parseInt(_0x20c669['adjust_qty'])):_0x5ec226['product_name']==_0x20c669[_0x2c4fb2(0xe3)]&&_0x5ec226['bay']==_0x20c669['bay']&&(_0x5ec226['product_stock']=parseInt(_0x5ec226[_0x2c4fb2(0x10d)])+parseInt(_0x20c669[_0x2c4fb2(0x13a)]));});}),await _0x3b917a[_0x580938(0x186)](),_0x4cc1de[_0x580938(0x103)](_0x580938(0x169),'adjustment\x20data\x20update\x20successfully'),_0x12dc88['redirect']('/adjustment_finished/view');}catch(_0x41d214){console[_0x580938(0x15e)](_0x41d214);}}),router[a0_0x1615b1(0x137)]('/barcode_scanner',async(_0x361cd5,_0x10b750)=>{var _0x1eeb78=a0_0x1615b1;const {primary_code:_0x445588,warehouse_data:_0x1ed4fd,rooms_data:_0x41485d,Roomslist:_0x5b5e52}=_0x361cd5['body'],_0x5e73f1=_0x5b5e52[_0x1eeb78(0xe5)](','),_0xd7c955=[];async function _0x37dfe2(_0x505e58){var _0x4c4426=_0x1eeb78;const _0x5b3393=await warehouse['aggregate']([{'$match':{'name':_0x1ed4fd,'room':_0x505e58}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x445588}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4c4426(0x149)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x4c4426(0x136)},'secondary_code':{'$first':_0x4c4426(0x17f)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4c4426(0x100)},'bay':{'$first':_0x4c4426(0x168)},'type':{'$first':_0x4c4426(0x10e)},'pallet':{'$first':_0x4c4426(0x189)},'unit':{'$first':_0x4c4426(0x133)},'secondary_unit':{'$first':_0x4c4426(0x15d)},'storage':{'$first':_0x4c4426(0xe2)},'rack':{'$first':_0x4c4426(0x14d)},'expiry_date':{'$first':_0x4c4426(0x106)},'production_date':{'$first':_0x4c4426(0x156)},'batch_code':{'$first':_0x4c4426(0x116)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x4c4426(0x161)},'roomNamed':{'$first':_0x4c4426(0x11d)},'invoice':{'$first':_0x4c4426(0x10f)}}}]),_0x52a4dc=await warehouse[_0x4c4426(0xf4)]([{'$match':{'name':_0x1ed4fd,'room':_0x505e58}},{'$unwind':_0x4c4426(0x11b)},{'$match':{'product_details.secondary_code':_0x445588}},{'$group':{'_id':_0x4c4426(0x179),'name':{'$first':_0x4c4426(0x149)},'product_stock':{'$first':_0x4c4426(0x155)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4c4426(0x100)},'bay':{'$first':'$product_details.bay'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x4c4426(0x189)},'unit':{'$first':_0x4c4426(0x133)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x4c4426(0xe2)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4c4426(0x116)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x4c4426(0x11d)},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x5b3393[_0x4c4426(0x10a)]>0x0)_0xd7c955[_0x4c4426(0x170)](_0x5b3393);else _0x52a4dc[_0x4c4426(0x10a)]>0x0&&_0xd7c955['push'](_0x52a4dc);}const _0x360764=_0x5e73f1[_0x1eeb78(0xee)](_0x5aa3a9=>_0x37dfe2(_0x5aa3a9));await Promise[_0x1eeb78(0x12c)](_0x360764),_0x10b750['json'](_0xd7c955);}),router[a0_0x1615b1(0x137)]('/CheckingWarehouse',async(_0x3a3089,_0x30abdb)=>{var _0x5a51cf=a0_0x1615b1;const {productCode:_0x9240ad,bay:_0x90d716,warehouses:_0x478a40,room:_0x1ce670}=_0x3a3089[_0x5a51cf(0xdb)];console[_0x5a51cf(0x15e)](_0x3a3089['body']);try{const _0x2962f2=await warehouse[_0x5a51cf(0xf4)]([{'$match':{'name':_0x478a40,'room':_0x1ce670}},{'$unwind':_0x5a51cf(0x11b)},{'$match':{'product_details.bay':parseInt(_0x90d716)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5a51cf(0x155)},'bay':{'$first':_0x5a51cf(0x168)},'maxProducts':{'$first':_0x5a51cf(0xf8)}}}]);_0x30abdb['status'](0xc8)[_0x5a51cf(0xe1)](_0x2962f2);}catch(_0xf6b4ef){_0x30abdb[_0x5a51cf(0xdf)](0x194)['json']({'message':_0xf6b4ef[_0x5a51cf(0x10c)]});}}),module[a0_0x1615b1(0x145)]=router;