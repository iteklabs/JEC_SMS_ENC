var a0_0x4d5dc0=a0_0x3fb2;(function(_0x1d25e1,_0x2f69df){var _0x4a3233=a0_0x3fb2,_0xa1ce0e=_0x1d25e1();while(!![]){try{var _0x46ebcf=-parseInt(_0x4a3233(0x1dd))/0x1+-parseInt(_0x4a3233(0x1c7))/0x2+parseInt(_0x4a3233(0x20f))/0x3+-parseInt(_0x4a3233(0x251))/0x4+-parseInt(_0x4a3233(0x214))/0x5+parseInt(_0x4a3233(0x1d9))/0x6*(-parseInt(_0x4a3233(0x1db))/0x7)+parseInt(_0x4a3233(0x211))/0x8;if(_0x46ebcf===_0x2f69df)break;else _0xa1ce0e['push'](_0xa1ce0e['shift']());}catch(_0x5ebde2){_0xa1ce0e['push'](_0xa1ce0e['shift']());}}}(a0_0x5342,0xe992f));const express=require(a0_0x4d5dc0(0x23a)),app=express(),router=express[a0_0x4d5dc0(0x207)](),auth=require(a0_0x4d5dc0(0x204)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_logs,adjustment_finished,email_settings,supervisor_settings,invoice_for_adjustment}=require(a0_0x4d5dc0(0x261)),users=require(a0_0x4d5dc0(0x1df)),nodemailer=require(a0_0x4d5dc0(0x1c2));function a0_0x3fb2(_0x468394,_0x4b7f6e){var _0x534295=a0_0x5342();return a0_0x3fb2=function(_0x3fb23f,_0x6aa77d){_0x3fb23f=_0x3fb23f-0x1bc;var _0x3cb3ad=_0x534295[_0x3fb23f];return _0x3cb3ad;},a0_0x3fb2(_0x468394,_0x4b7f6e);}router[a0_0x4d5dc0(0x206)]('/view',auth,async(_0x2b2b2f,_0xec08e2)=>{var _0x432286=a0_0x4d5dc0;try{const {username:_0x306e73,email:_0x1f0a48,role:_0x4c1048}=_0x2b2b2f[_0x432286(0x23f)],_0x3c1fa2=_0x2b2b2f[_0x432286(0x23f)],_0x2cfd72=await profile[_0x432286(0x1fa)]({'email':_0x3c1fa2['email']}),_0x1016df=await master_shop['find']();let _0x339cfa;if(_0x3c1fa2[_0x432286(0x1f5)]=='staff'){const _0x42efcc=await staff[_0x432286(0x1fa)]({'email':_0x3c1fa2[_0x432286(0x259)]});_0x339cfa=await warehouse[_0x432286(0x245)]({'status':_0x432286(0x25e),'name':_0x42efcc[_0x432286(0x227)]});}else _0x339cfa=await warehouse[_0x432286(0x245)]({'status':_0x432286(0x25e)});const _0x791bd7=await product['find']();let _0x31cf4a;if(_0x3c1fa2[_0x432286(0x1f5)]==_0x432286(0x26a)){const _0x1c4884=await staff[_0x432286(0x1fa)]({'email':_0x3c1fa2[_0x432286(0x259)]});_0x31cf4a=await adjustment_finished['find']({'warehouse_name':_0x1c4884['warehouse']});}else _0x31cf4a=await adjustment_finished[_0x432286(0x1c3)]([{'$match':{'type_of_transaction':_0x432286(0x1d7)}},{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x432286(0x24b)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x432286(0x202)},'finalize':{'$first':_0x432286(0x241)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x1016df[0x0][_0x432286(0x254)]==_0x432286(0x255)){var _0x18422d=users[_0x432286(0x20a)];console[_0x432286(0x218)](_0x18422d);}else{if(_0x1016df[0x0][_0x432286(0x254)]=='Hindi')var _0x18422d=users[_0x432286(0x1d6)];else{if(_0x1016df[0x0][_0x432286(0x254)]==_0x432286(0x20c))var _0x18422d=users['German'];else{if(_0x1016df[0x0]['language']=='Spanish')var _0x18422d=users['Spanish'];else{if(_0x1016df[0x0]['language']==_0x432286(0x205))var _0x18422d=users[_0x432286(0x205)];else{if(_0x1016df[0x0][_0x432286(0x254)]=='Portuguese\x20(BR)')var _0x18422d=users['Portuguese'];else{if(_0x1016df[0x0]['language']==_0x432286(0x23e))var _0x18422d=users[_0x432286(0x23e)];else{if(_0x1016df[0x0]['language']==_0x432286(0x1c8))var _0x18422d=users[_0x432286(0x1ff)];}}}}}}}_0xec08e2[_0x432286(0x242)](_0x432286(0x243),{'success':_0x2b2b2f[_0x432286(0x1cb)](_0x432286(0x25d)),'errors':_0x2b2b2f[_0x432286(0x1cb)](_0x432286(0x22c)),'role':_0x3c1fa2,'profile':_0x2cfd72,'warehouse':_0x339cfa,'product':_0x791bd7,'adjustment':_0x31cf4a,'master_shop':_0x1016df,'language':_0x18422d});}catch(_0x5bd127){console[_0x432286(0x218)](_0x5bd127);}}),router[a0_0x4d5dc0(0x206)](a0_0x4d5dc0(0x20e),auth,async(_0x1c1838,_0x17c67b)=>{var _0x384bf2=a0_0x4d5dc0;try{const {username:_0x363fda,email:_0x4bd674,role:_0x4eb1aa}=_0x1c1838[_0x384bf2(0x23f)],_0x5cbe79=_0x1c1838['user'],_0x528c1d=await profile[_0x384bf2(0x1fa)]({'email':_0x5cbe79[_0x384bf2(0x259)]}),_0x208f1a=await master_shop[_0x384bf2(0x245)]();let _0x285dab;if(_0x5cbe79[_0x384bf2(0x1f5)]==_0x384bf2(0x26a)){const _0x3d94cb=await staff[_0x384bf2(0x1fa)]({'email':_0x5cbe79[_0x384bf2(0x259)]});_0x285dab=await warehouse[_0x384bf2(0x245)]({'status':_0x384bf2(0x25e),'name':_0x3d94cb[_0x384bf2(0x227)]});}else _0x285dab=await warehouse['find']({'status':_0x384bf2(0x25e)});const _0x1d02f5=await product[_0x384bf2(0x245)]();let _0x2ac806;if(_0x5cbe79['role']==_0x384bf2(0x26a)){const _0x32bba4=await staff[_0x384bf2(0x1fa)]({'email':_0x5cbe79['email']});_0x2ac806=await adjustment_finished[_0x384bf2(0x245)]({'warehouse_name':_0x32bba4[_0x384bf2(0x227)]});}else _0x2ac806=await adjustment_finished['aggregate']([{'$match':{'type_of_transaction':'logs'}},{'$unwind':_0x384bf2(0x1c0)},{'$group':{'_id':_0x384bf2(0x236),'invoice':{'$first':'$invoice'},'date':{'$first':_0x384bf2(0x257)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x384bf2(0x202)},'finalize':{'$first':_0x384bf2(0x241)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x208f1a[0x0][_0x384bf2(0x254)]==_0x384bf2(0x255))var _0x43603f=users['English'];else{if(_0x208f1a[0x0]['language']==_0x384bf2(0x1d6))var _0x43603f=users[_0x384bf2(0x1d6)];else{if(_0x208f1a[0x0][_0x384bf2(0x254)]==_0x384bf2(0x20c))var _0x43603f=users['German'];else{if(_0x208f1a[0x0][_0x384bf2(0x254)]==_0x384bf2(0x208))var _0x43603f=users['Spanish'];else{if(_0x208f1a[0x0][_0x384bf2(0x254)]==_0x384bf2(0x205))var _0x43603f=users['French'];else{if(_0x208f1a[0x0]['language']==_0x384bf2(0x216))var _0x43603f=users['Portuguese'];else{if(_0x208f1a[0x0][_0x384bf2(0x254)]=='Chinese')var _0x43603f=users[_0x384bf2(0x23e)];else{if(_0x208f1a[0x0][_0x384bf2(0x254)]=='Arabic\x20(ae)')var _0x43603f=users[_0x384bf2(0x1ff)];}}}}}}}_0x17c67b['render'](_0x384bf2(0x22e),{'success':_0x1c1838[_0x384bf2(0x1cb)](_0x384bf2(0x25d)),'errors':_0x1c1838['flash']('errors'),'role':_0x5cbe79,'profile':_0x528c1d,'warehouse':_0x285dab,'product':_0x1d02f5,'adjustment':_0x2ac806,'master_shop':_0x208f1a,'language':_0x43603f});}catch(_0x18d61b){console['log'](_0x18d61b);}});function a0_0x5342(){var _0x5d9720=['batch_code','Adjustment\x20Finalize\x20Successfully','language','English\x20(US)','$product_details.type','$date','$product_details','email','ADJF-','exports','match','success','Enabled','note','True','../models/all_models','prod_code','$product_details.storage','Enclosed','maxPerUnit','$product_details._id','</td>','save','$product_details.expiry_date','staff','New_Qty_Converted','foreach\x20newproduct','$product_details.bin','room_names','$product','$product.product_name','nodemailer','aggregate','/preview/:id','message','purchases_data','2185804ZPnHoq','Arabic\x20(ae)','$product_details.product_stock','params','flash','$product_details.rack','id_transaction','adjust_qty','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','unit','map','production_date','/CheckingWarehouse','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Hindi','own','Return\x20Rooms','30wSXVGE','/picking_list/PDF_adjustmentFinal/','519526CDkUua','product_stock','1791735cvxlvn','$room','../public/language/languages.json','/adjustment/view','$product_details.batch_code','product_code','all','$product_details.floorlevel','DRY\x20GOODS','prod_invoice','/adjustment_finished/view','edit_adjustment_finished_view','getDate','minus','An\x20error\x20occurred\x20while\x20saving\x20data.','post','findById','/view/add_adjustment','warehouse_name','ADJ-','expiry_date','error','status','secondary_unit','role','json','/adjustment_finished/preview/','/view/add_adjustment_logs','edit_adjustment_finished','findOne','Portuguese','product','$product_details.secondary_unit','random','Arabic','length','bay','$product.room_names','$product_details.product_code','../middleware/auth','French','get','Router','Spanish','redirect','English','padStart','German','Secondary_units','/view_logs','3173316pyEEVq','string','45657360rQDFhT','filter','catch','8546100bPTXcA','/view/:id','Portuguese\x20(BR)','$product_details.primary_code','log','$product_details.maxPerUnit','_id','invoice','New_Qty_Converted_adj','types','product_name','adjustment\x20add\x20successfull','$product_details.product_name','product_date','$product_details.invoice','stockBefore','$name','<tr>','$product_details.maxProducts','warehouse','add_adjustment_finished_logs','finalize','new_adjust_qty','prod_name','errors','$product_details.secondary_code','adjustment_finished_logs','master','add_adjustment_finished','floor','$product_details.production_date','forEach','getMonth','then','$_id','body','Primary_Units','id_transaction_from','express','$product_details.bay','Ambient','room','Chinese','user','Rooms','$finalize','render','adjustment_finished','prod_cat','find','toString','back','adjustment\x20data\x20update\x20successfully','level','invoice_init','$invoice','JO_number','$product_details.level','stock','add','getFullYear','3373104VCnPKF'];a0_0x5342=function(){return _0x5d9720;};return a0_0x5342();}async function getRandom8DigitNumber(){var _0x3e6f5f=a0_0x4d5dc0;const _0x262464=0x989680,_0x1b84c2=0x5f5e0ff,_0x1e96e4=Math[_0x3e6f5f(0x231)](Math[_0x3e6f5f(0x1fe)]()*(_0x1b84c2-_0x262464+0x1))+_0x262464;var _0x385e0c;const _0x2876f4=await adjustment_finished[_0x3e6f5f(0x1fa)]({'invoice':_0x3e6f5f(0x25a)+_0x1e96e4});return _0x2876f4&&_0x2876f4[_0x3e6f5f(0x200)]>0x0?_0x385e0c=_0x3e6f5f(0x25a)+_0x1e96e4:_0x385e0c=_0x3e6f5f(0x25a)+_0x1e96e4,_0x385e0c;}router['get'](a0_0x4d5dc0(0x1ee),auth,async(_0x3c4270,_0x5d20c0)=>{var _0x5bbc5c=a0_0x4d5dc0;try{const {username:_0x66ba46,email:_0x1232a1,role:_0x21a635}=_0x3c4270[_0x5bbc5c(0x23f)],_0xea42cd=_0x3c4270[_0x5bbc5c(0x23f)],_0x56c308=await profile[_0x5bbc5c(0x1fa)]({'email':_0xea42cd['email']}),_0x1e10ce=await master_shop[_0x5bbc5c(0x245)]();let _0x579628;if(_0xea42cd[_0x5bbc5c(0x1f5)]==_0x5bbc5c(0x26a)){const _0x3f0dd5=await staff[_0x5bbc5c(0x1fa)]({'email':_0xea42cd[_0x5bbc5c(0x259)]});_0x579628=await warehouse[_0x5bbc5c(0x1c3)]([{'$match':{'status':'Enabled','name':_0x3f0dd5['warehouse']}},{'$group':{'_id':_0x5bbc5c(0x224),'name':{'$first':_0x5bbc5c(0x224)}}}]);}else _0x579628=await warehouse['aggregate']([{'$match':{'status':_0x5bbc5c(0x25e)}},{'$group':{'_id':_0x5bbc5c(0x224),'name':{'$first':_0x5bbc5c(0x224)}}}]);const _0x3938fb=await product['find']({}),_0x5e6536=await adjustment_finished[_0x5bbc5c(0x245)](),_0x2c6001=_0x5e6536[_0x5bbc5c(0x200)]+0x1,_0x5aeb92=_0x5bbc5c(0x25a)+_0x2c6001[_0x5bbc5c(0x246)]()[_0x5bbc5c(0x20b)](0x5,'0');var _0x2d8007=[_0x5bbc5c(0x23c),_0x5bbc5c(0x264),_0x5bbc5c(0x1d8)];if(_0x1e10ce[0x0][_0x5bbc5c(0x254)]==_0x5bbc5c(0x255))var _0x2192b7=users[_0x5bbc5c(0x20a)];else{if(_0x1e10ce[0x0][_0x5bbc5c(0x254)]==_0x5bbc5c(0x1d6))var _0x2192b7=users[_0x5bbc5c(0x1d6)];else{if(_0x1e10ce[0x0][_0x5bbc5c(0x254)]==_0x5bbc5c(0x20c))var _0x2192b7=users[_0x5bbc5c(0x20c)];else{if(_0x1e10ce[0x0][_0x5bbc5c(0x254)]==_0x5bbc5c(0x208))var _0x2192b7=users['Spanish'];else{if(_0x1e10ce[0x0][_0x5bbc5c(0x254)]==_0x5bbc5c(0x205))var _0x2192b7=users['French'];else{if(_0x1e10ce[0x0][_0x5bbc5c(0x254)]==_0x5bbc5c(0x216))var _0x2192b7=users[_0x5bbc5c(0x1fb)];else{if(_0x1e10ce[0x0][_0x5bbc5c(0x254)]==_0x5bbc5c(0x23e))var _0x2192b7=users[_0x5bbc5c(0x23e)];else{if(_0x1e10ce[0x0][_0x5bbc5c(0x254)]=='Arabic\x20(ae)')var _0x2192b7=users[_0x5bbc5c(0x1ff)];}}}}}}}const _0x509064=getRandom8DigitNumber();_0x509064[_0x5bbc5c(0x235)](_0x578b57=>{var _0x32a3ae=_0x5bbc5c;_0x5d20c0[_0x32a3ae(0x242)](_0x32a3ae(0x230),{'success':_0x3c4270[_0x32a3ae(0x1cb)](_0x32a3ae(0x25d)),'errors':_0x3c4270[_0x32a3ae(0x1cb)](_0x32a3ae(0x22c)),'role':_0xea42cd,'profile':_0x56c308,'warehouse':_0x579628,'product':_0x3938fb,'master_shop':_0x1e10ce,'language':_0x2192b7,'rooms_data':_0x2d8007,'invoice_no':_0x578b57});})[_0x5bbc5c(0x213)](_0x4a05be=>{var _0x3d380e=_0x5bbc5c;_0x3c4270[_0x3d380e(0x1cb)]('errors',_0x3d380e(0x1d5)),_0x5d20c0[_0x3d380e(0x209)](_0x3d380e(0x1e0));});}catch(_0x96f638){console[_0x5bbc5c(0x218)](_0x96f638);}}),router[a0_0x4d5dc0(0x1ec)](a0_0x4d5dc0(0x1ee),auth,async(_0x56bcca,_0x1c4efc)=>{var _0x2db1c6=a0_0x4d5dc0;try{const {warehouse_name:_0x22865e,date:_0x2ad67d,prod_name:_0x1e9f48,level:_0x132070,isle:_0xe3a526,pallet:_0x1d610a,stock:_0x9b2fe9,types:_0x1be867,adjust_qty:_0xbde6c9,new_adjust_qty:_0x4208e8,note:_0x47e600,Room_name:_0x5bc571,JO_number:_0x144519,expiry_date:_0x5d3bb9,PO_number:_0x1b84ac,ReqBy:_0xf6e40e,dateofreq:_0x29a7ff,typeservicesData:_0x5098c1,destination:_0x4a95c9,deliverydate:_0x1d7044,driver:_0x4c83f7,plate:_0x36e35a,van:_0x458a4b,DRSI:_0x54bc56,typevehicle:_0x2db7f6,TSU:_0x455ea3,TFU:_0x4fe51b}=_0x56bcca[_0x2db1c6(0x237)];if(typeof _0x1e9f48=='string')var _0x48293b=[_0x56bcca['body']['prod_name']],_0x4539ab=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x249)]],_0x18ce08=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x24e)]],_0x5bdc6e=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x21d)]],_0x3eb470=[_0x56bcca['body'][_0x2db1c6(0x21c)]],_0x390892=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x1bc)]],_0x4e5b74=[_0x56bcca[_0x2db1c6(0x237)]['Primary_Units']],_0x8ff046=[_0x56bcca['body']['Secondary_units']],_0x518664=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x262)]],_0x594015=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x252)]],_0x4beaaa=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x1f1)]],_0x528932=[_0x56bcca['body'][_0x2db1c6(0x221)]],_0x28b22a=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x244)]],_0x3226e0=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x240)]],_0x3c2ae2=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x265)]],_0x1c68a2=[_0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x1e6)]],_0x16454b=[_0x56bcca['body'][_0x2db1c6(0x239)]];else var _0x48293b=[..._0x56bcca[_0x2db1c6(0x237)]['prod_name']],_0x4539ab=[..._0x56bcca[_0x2db1c6(0x237)]['level']],_0x18ce08=[..._0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x24e)]],_0x5bdc6e=[..._0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x21d)]],_0x3eb470=[..._0x56bcca[_0x2db1c6(0x237)]['New_Qty_Converted_adj']],_0x390892=[..._0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x1bc)]],_0x4e5b74=[..._0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x238)]],_0x8ff046=[..._0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x20d)]],_0x518664=[..._0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x262)]],_0x594015=[..._0x56bcca['body'][_0x2db1c6(0x252)]],_0x4beaaa=[..._0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x1f1)]],_0x528932=[..._0x56bcca['body'][_0x2db1c6(0x221)]],_0x28b22a=[..._0x56bcca['body'][_0x2db1c6(0x244)]],_0x3226e0=[..._0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x240)]],_0x3c2ae2=[..._0x56bcca['body'][_0x2db1c6(0x265)]],_0x1c68a2=[..._0x56bcca[_0x2db1c6(0x237)]['prod_invoice']],_0x16454b=[..._0x56bcca[_0x2db1c6(0x237)][_0x2db1c6(0x239)]];const _0x19bc6f=_0x48293b[_0x2db1c6(0x1d1)](_0x2f5ac4=>{return _0x2f5ac4={'product_name':_0x2f5ac4};});_0x4539ab[_0x2db1c6(0x233)]((_0x7ac7ef,_0x2214eb)=>{var _0x390318=_0x2db1c6,_0x59cf26=_0x7ac7ef['match'](/[A-Za-z]+/)[0x0],_0x1b8ac5=parseInt(_0x7ac7ef['match'](/\d+/)[0x0]);_0x19bc6f[_0x2214eb]['level']=_0x59cf26,_0x19bc6f[_0x2214eb][_0x390318(0x201)]=_0x1b8ac5;}),_0x16454b['forEach']((_0x3b69b0,_0x25e50f)=>{var _0x31096b=_0x2db1c6;_0x19bc6f[_0x25e50f][_0x31096b(0x1cd)]=_0x3b69b0;}),_0x18ce08[_0x2db1c6(0x233)]((_0x2c2785,_0x39cf5b)=>{_0x19bc6f[_0x39cf5b]['stockBefore']=_0x2c2785;}),_0x5bdc6e['forEach']((_0x59a4cf,_0x3a4d88)=>{_0x19bc6f[_0x3a4d88]['types']=_0x59a4cf;}),_0x3eb470[_0x2db1c6(0x233)]((_0x1e5f56,_0x9931d2)=>{var _0x18763d=_0x2db1c6;_0x19bc6f[_0x9931d2][_0x18763d(0x1ce)]=_0x1e5f56;}),_0x390892[_0x2db1c6(0x233)]((_0x4cee20,_0x4d131b)=>{var _0x1c3927=_0x2db1c6;_0x19bc6f[_0x4d131b][_0x1c3927(0x22a)]=_0x4cee20;}),_0x4e5b74[_0x2db1c6(0x233)]((_0x2a9e6e,_0x29432b)=>{_0x19bc6f[_0x29432b]['unit']=_0x2a9e6e;}),_0x8ff046[_0x2db1c6(0x233)]((_0x565bad,_0x2c0ad4)=>{var _0x1e2fc8=_0x2db1c6;_0x19bc6f[_0x2c0ad4][_0x1e2fc8(0x1f4)]=_0x565bad;}),_0x518664['forEach']((_0x101235,_0x1c5162)=>{_0x19bc6f[_0x1c5162]['product_code']=_0x101235;}),_0x594015[_0x2db1c6(0x233)]((_0x5d61f8,_0x3b0b08)=>{var _0x384fae=_0x2db1c6;_0x19bc6f[_0x3b0b08][_0x384fae(0x252)]=_0x5d61f8;}),_0x4beaaa[_0x2db1c6(0x233)]((_0x490312,_0x1a41d0)=>{_0x19bc6f[_0x1a41d0]['expiry_date']=_0x490312;}),_0x528932[_0x2db1c6(0x233)]((_0xc362d4,_0x3ee9a7)=>{_0x19bc6f[_0x3ee9a7]['production_date']=_0xc362d4;}),_0x28b22a[_0x2db1c6(0x233)]((_0x2a31ae,_0x210def)=>{var _0x23c3f1=_0x2db1c6;_0x19bc6f[_0x210def][_0x23c3f1(0x244)]=_0x2a31ae;}),_0x3226e0[_0x2db1c6(0x233)]((_0x4360d4,_0x13d1d2)=>{_0x19bc6f[_0x13d1d2]['room_names']=_0x4360d4;}),_0x3c2ae2[_0x2db1c6(0x233)]((_0x1c42fd,_0x558996)=>{var _0x188ad6=_0x2db1c6;_0x19bc6f[_0x558996][_0x188ad6(0x265)]=_0x1c42fd;}),_0x1c68a2[_0x2db1c6(0x233)]((_0x425a4b,_0x2d07fe)=>{var _0xd61281=_0x2db1c6;_0x19bc6f[_0x2d07fe][_0xd61281(0x21b)]=_0x425a4b;});const _0x360396=_0x19bc6f[_0x2db1c6(0x212)](_0x568baf=>_0x568baf[_0x2db1c6(0x1ce)]!=='0'&&_0x568baf[_0x2db1c6(0x1ce)]!=='');var _0x448f2e=0x0;_0x360396[_0x2db1c6(0x233)](_0x32c8fe=>{var _0x5916d6=_0x2db1c6;console[_0x5916d6(0x218)]('foreach\x20newproduct',_0x32c8fe),parseInt(_0x32c8fe['adjust_qty'])<=0x0&&_0x448f2e++;});if(_0x448f2e!=0x0)return _0x56bcca[_0x2db1c6(0x1cb)]('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x1c4efc['redirect'](_0x2db1c6(0x247));const _0x26250d=new invoice_for_adjustment();await _0x26250d['save']();const _0x2945fb=new adjustment_finished({'warehouse_name':_0x22865e,'date':_0x2ad67d,'product':_0x360396,'note':_0x47e600,'room':_0x5bc571,'invoice':_0x2db1c6(0x1f0)+_0x26250d['invoice_init'][_0x2db1c6(0x246)]()[_0x2db1c6(0x20b)](0x8,'0'),'JO_number':_0x144519,'expiry_date':_0x5d3bb9,'PO_number':_0x1b84ac,'RequestedBy':_0xf6e40e,'DateofRequest':_0x29a7ff,'typeservices':_0x5098c1,'destination':_0x4a95c9,'deliverydate':_0x1d7044,'driver':_0x4c83f7,'plate':_0x36e35a,'van':_0x458a4b,'DRSI':_0x54bc56,'typevehicle':_0x2db7f6,'TSU':_0x455ea3,'TFU':_0x4fe51b}),_0x2fd7b8=await _0x2945fb['save']();_0x56bcca['flash'](_0x2db1c6(0x25d),_0x2db1c6(0x21f)),_0x1c4efc[_0x2db1c6(0x209)](_0x2db1c6(0x1f7)+_0x2fd7b8['_id']);}catch(_0x4542be){console[_0x2db1c6(0x218)](_0x4542be),_0x1c4efc[_0x2db1c6(0x1f3)](0xc8)['json']({'message':_0x4542be['message']});}}),router['get']('/view/add_adjustment_logs',auth,async(_0x32999a,_0x1183f4)=>{var _0x388d12=a0_0x4d5dc0;try{const {username:_0x82da0d,email:_0x2a5ac7,role:_0x48ec8f}=_0x32999a['user'],_0x244131=_0x32999a['user'],_0x6bb791=await profile[_0x388d12(0x1fa)]({'email':_0x244131[_0x388d12(0x259)]}),_0xd728a4=await master_shop[_0x388d12(0x245)]();let _0x4a5ec0;if(_0x244131['role']==_0x388d12(0x26a)){const _0x1850ae=await staff[_0x388d12(0x1fa)]({'email':_0x244131[_0x388d12(0x259)]});_0x4a5ec0=await warehouse[_0x388d12(0x1c3)]([{'$match':{'status':_0x388d12(0x25e),'name':_0x1850ae['warehouse']}},{'$group':{'_id':_0x388d12(0x224),'name':{'$first':_0x388d12(0x224)}}}]);}else _0x4a5ec0=await warehouse[_0x388d12(0x1c3)]([{'$match':{'status':_0x388d12(0x25e)}},{'$group':{'_id':_0x388d12(0x224),'name':{'$first':_0x388d12(0x224)}}}]);const _0x58b7cc=await product['find'](),_0x19e871=await adjustment_finished[_0x388d12(0x245)](),_0x34eb2a=_0x19e871[_0x388d12(0x200)]+0x1,_0x3f18dc=_0x388d12(0x25a)+_0x34eb2a['toString']()[_0x388d12(0x20b)](0x5,'0');var _0x2d529a=[_0x388d12(0x23c),_0x388d12(0x264),_0x388d12(0x1d8)];if(_0xd728a4[0x0]['language']==_0x388d12(0x255))var _0x53e9ac=users[_0x388d12(0x20a)];else{if(_0xd728a4[0x0][_0x388d12(0x254)]==_0x388d12(0x1d6))var _0x53e9ac=users[_0x388d12(0x1d6)];else{if(_0xd728a4[0x0][_0x388d12(0x254)]==_0x388d12(0x20c))var _0x53e9ac=users[_0x388d12(0x20c)];else{if(_0xd728a4[0x0][_0x388d12(0x254)]=='Spanish')var _0x53e9ac=users[_0x388d12(0x208)];else{if(_0xd728a4[0x0][_0x388d12(0x254)]==_0x388d12(0x205))var _0x53e9ac=users['French'];else{if(_0xd728a4[0x0][_0x388d12(0x254)]==_0x388d12(0x216))var _0x53e9ac=users[_0x388d12(0x1fb)];else{if(_0xd728a4[0x0][_0x388d12(0x254)]==_0x388d12(0x23e))var _0x53e9ac=users[_0x388d12(0x23e)];else{if(_0xd728a4[0x0][_0x388d12(0x254)]=='Arabic\x20(ae)')var _0x53e9ac=users['Arabic'];}}}}}}}const _0x51ddb3=getRandom8DigitNumber();_0x51ddb3[_0x388d12(0x235)](_0x2ee3c7=>{var _0x34aea4=_0x388d12;_0x1183f4[_0x34aea4(0x242)](_0x34aea4(0x228),{'success':_0x32999a[_0x34aea4(0x1cb)](_0x34aea4(0x25d)),'errors':_0x32999a['flash'](_0x34aea4(0x22c)),'role':_0x244131,'profile':_0x6bb791,'warehouse':_0x4a5ec0,'product':_0x58b7cc,'master_shop':_0xd728a4,'language':_0x53e9ac,'rooms_data':_0x2d529a,'invoice_no':_0x2ee3c7});})[_0x388d12(0x213)](_0x166e6d=>{var _0x3bd932=_0x388d12;_0x32999a[_0x3bd932(0x1cb)](_0x3bd932(0x22c),_0x3bd932(0x1d5)),_0x1183f4[_0x3bd932(0x209)](_0x3bd932(0x1e0));});}catch(_0x61ab57){console[_0x388d12(0x218)](_0x61ab57);}}),router[a0_0x4d5dc0(0x1ec)](a0_0x4d5dc0(0x1f8),auth,async(_0x24f370,_0x53ab21)=>{var _0x2b63a0=a0_0x4d5dc0;try{const {warehouse_name:_0x11e84d,date:_0x9cb5f4,prod_name:_0x271ac7,level:_0x9ace30,isle:_0x1e6bfc,pallet:_0xfd1c8c,stock:_0x5c7247,types:_0x372761,adjust_qty:_0x2cba5f,new_adjust_qty:_0x5692d9,note:_0x2586fe,Room_name:_0x3c599b,JO_number:_0x1592a5,expiry_date:_0x2aeb3e,type_of_transaction:_0x19d5d5,PO_number:_0x9eee00,ReqBy:_0x320718,dateofreq:_0x127e78,typeservicesData:_0xe60de2,destination:_0x315820,deliverydate:_0x54ab17,driver:_0x317f14,plate:_0x2e06bd,van:_0x3a9877,DRSI:_0x479747,typevehicle:_0x50185e,TSU:_0x11e81c,TFU:_0x3434e7}=_0x24f370[_0x2b63a0(0x237)];if(typeof _0x271ac7=='string')var _0x471639=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x22b)]],_0x451ff1=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x249)]],_0x1bdfb3=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x24e)]],_0x1d672b=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x21d)]],_0x5d642e=[_0x24f370[_0x2b63a0(0x237)]['New_Qty_Converted_adj']],_0x4a359f=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x1bc)]],_0x4f8dff=[_0x24f370['body'][_0x2b63a0(0x238)]],_0x15564d=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x20d)]],_0x24772e=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x262)]],_0x596721=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x252)]],_0x11bb17=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x1f1)]],_0x4ee66b=[_0x24f370['body']['product_date']],_0x50ed97=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x244)]],_0x1fd064=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x240)]],_0x3f3fb7=[_0x24f370['body'][_0x2b63a0(0x265)]],_0x536222=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x1e6)]],_0x14fa32=[_0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x239)]];else var _0x471639=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x22b)]],_0x451ff1=[..._0x24f370['body'][_0x2b63a0(0x249)]],_0x1bdfb3=[..._0x24f370['body'][_0x2b63a0(0x24e)]],_0x1d672b=[..._0x24f370[_0x2b63a0(0x237)]['types']],_0x5d642e=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x21c)]],_0x4a359f=[..._0x24f370['body'][_0x2b63a0(0x1bc)]],_0x4f8dff=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x238)]],_0x15564d=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x20d)]],_0x24772e=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x262)]],_0x596721=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x252)]],_0x11bb17=[..._0x24f370['body'][_0x2b63a0(0x1f1)]],_0x4ee66b=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x221)]],_0x50ed97=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x244)]],_0x1fd064=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x240)]],_0x3f3fb7=[..._0x24f370['body'][_0x2b63a0(0x265)]],_0x536222=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x1e6)]],_0x14fa32=[..._0x24f370[_0x2b63a0(0x237)][_0x2b63a0(0x239)]];const _0x3e537a=_0x471639[_0x2b63a0(0x1d1)](_0x4a9174=>{return _0x4a9174={'product_name':_0x4a9174};});_0x451ff1[_0x2b63a0(0x233)]((_0x901a9f,_0x5e7b5e)=>{var _0x4e6c09=_0x2b63a0,_0xcd7280=_0x901a9f[_0x4e6c09(0x25c)](/[A-Za-z]+/)[0x0],_0x4d25be=parseInt(_0x901a9f[_0x4e6c09(0x25c)](/\d+/)[0x0]);_0x3e537a[_0x5e7b5e][_0x4e6c09(0x249)]=_0xcd7280,_0x3e537a[_0x5e7b5e][_0x4e6c09(0x201)]=_0x4d25be;}),_0x14fa32[_0x2b63a0(0x233)]((_0x19be23,_0x18a5f6)=>{var _0x150169=_0x2b63a0;_0x3e537a[_0x18a5f6][_0x150169(0x1cd)]=_0x19be23;}),_0x1bdfb3[_0x2b63a0(0x233)]((_0x5802bc,_0x4ad9e4)=>{_0x3e537a[_0x4ad9e4]['stockBefore']=_0x5802bc;}),_0x1d672b[_0x2b63a0(0x233)]((_0x5add79,_0x91b03e)=>{var _0x2c4327=_0x2b63a0;_0x3e537a[_0x91b03e][_0x2c4327(0x21d)]=_0x5add79;}),_0x5d642e[_0x2b63a0(0x233)]((_0x4c81c0,_0x1e27c2)=>{var _0x1e810b=_0x2b63a0;_0x3e537a[_0x1e27c2][_0x1e810b(0x1ce)]=_0x4c81c0;}),_0x4a359f[_0x2b63a0(0x233)]((_0x577e88,_0x26e72b)=>{var _0x1b6aaf=_0x2b63a0;_0x3e537a[_0x26e72b][_0x1b6aaf(0x22a)]=_0x577e88;}),_0x4f8dff[_0x2b63a0(0x233)]((_0x2e555c,_0x1499c0)=>{_0x3e537a[_0x1499c0]['unit']=_0x2e555c;}),_0x15564d['forEach']((_0x4d7d86,_0x17865a)=>{var _0x4b41b4=_0x2b63a0;_0x3e537a[_0x17865a][_0x4b41b4(0x1f4)]=_0x4d7d86;}),_0x24772e['forEach']((_0x11ce54,_0xcdfe4c)=>{var _0x557134=_0x2b63a0;_0x3e537a[_0xcdfe4c][_0x557134(0x1e2)]=_0x11ce54;}),_0x596721['forEach']((_0xa2ba8a,_0x83e9b4)=>{var _0x15bce8=_0x2b63a0;_0x3e537a[_0x83e9b4][_0x15bce8(0x252)]=_0xa2ba8a;}),_0x11bb17[_0x2b63a0(0x233)]((_0x52f87a,_0x2af234)=>{var _0x595477=_0x2b63a0;_0x3e537a[_0x2af234][_0x595477(0x1f1)]=_0x52f87a;}),_0x4ee66b[_0x2b63a0(0x233)]((_0x1867d5,_0x4155c7)=>{var _0x45c269=_0x2b63a0;_0x3e537a[_0x4155c7][_0x45c269(0x1d2)]=_0x1867d5;}),_0x50ed97['forEach']((_0x4d7bec,_0x43a088)=>{var _0x58b8fe=_0x2b63a0;_0x3e537a[_0x43a088][_0x58b8fe(0x244)]=_0x4d7bec;}),_0x1fd064['forEach']((_0xa17839,_0x1044a9)=>{var _0x4a99e2=_0x2b63a0;_0x3e537a[_0x1044a9][_0x4a99e2(0x1bf)]=_0xa17839;}),_0x3f3fb7[_0x2b63a0(0x233)]((_0x981386,_0x28570a)=>{var _0x5c9d11=_0x2b63a0;_0x3e537a[_0x28570a][_0x5c9d11(0x265)]=_0x981386;}),_0x536222[_0x2b63a0(0x233)]((_0x572db0,_0x446258)=>{var _0x361c65=_0x2b63a0;_0x3e537a[_0x446258][_0x361c65(0x21b)]=_0x572db0;});const _0x4c5417=_0x3e537a[_0x2b63a0(0x212)](_0x366b20=>_0x366b20[_0x2b63a0(0x1ce)]!=='0'&&_0x366b20[_0x2b63a0(0x1ce)]!=='');var _0x4f34fc=0x0;_0x4c5417['forEach'](_0x5f5e0b=>{var _0x2264c4=_0x2b63a0;console[_0x2264c4(0x218)](_0x2264c4(0x1bd),_0x5f5e0b),parseInt(_0x5f5e0b[_0x2264c4(0x1ce)])<=0x0&&_0x4f34fc++;});if(_0x4f34fc!=0x0)return _0x24f370['flash'](_0x2b63a0(0x22c),_0x2b63a0(0x1cf)),_0x53ab21['redirect'](_0x2b63a0(0x247));const _0x4a38f9=new adjustment_logs();await _0x4a38f9[_0x2b63a0(0x268)]();const _0x2daa20=new adjustment_finished({'warehouse_name':_0x11e84d,'date':_0x9cb5f4,'product':_0x4c5417,'note':_0x2586fe,'room':_0x3c599b,'invoice':'LOG-ADJ-'+_0x4a38f9[_0x2b63a0(0x24a)][_0x2b63a0(0x246)]()['padStart'](0x8,'0'),'JO_number':_0x1592a5,'expiry_date':_0x2aeb3e,'type_of_transaction':_0x19d5d5,'PO_number':_0x9eee00,'RequestedBy':_0x320718,'DateofRequest':_0x127e78,'typeservices':_0xe60de2,'destination':_0x315820,'deliverydate':_0x54ab17,'driver':_0x317f14,'plate':_0x2e06bd,'van':_0x3a9877,'DRSI':_0x479747,'typevehicle':_0x50185e,'TSU':_0x11e81c,'TFU':_0x3434e7}),_0x42dccb=await _0x2daa20[_0x2b63a0(0x268)]();_0x24f370['flash'](_0x2b63a0(0x25d),_0x2b63a0(0x21f)),_0x53ab21['redirect'](_0x2b63a0(0x1f7)+_0x42dccb[_0x2b63a0(0x21a)]);}catch(_0x228ea5){console[_0x2b63a0(0x218)](_0x228ea5),_0x53ab21['status'](0xc8)['json']({'message':_0x228ea5[_0x2b63a0(0x1c5)]});}}),router[a0_0x4d5dc0(0x206)](a0_0x4d5dc0(0x1c4),auth,async(_0x54de0f,_0x4d69eb)=>{var _0x3c81e0=a0_0x4d5dc0;try{const {username:_0x89f71a,email:_0x4ef70a,role:_0x5d38cb}=_0x54de0f[_0x3c81e0(0x23f)],_0x3f5b2c=_0x54de0f[_0x3c81e0(0x23f)],_0x869af2=await profile['findOne']({'email':_0x3f5b2c[_0x3c81e0(0x259)]}),_0x424fb2=await master_shop[_0x3c81e0(0x245)](),_0x417896=_0x54de0f[_0x3c81e0(0x1ca)]['id'],_0x4831f9=await adjustment_finished['findById']({'_id':_0x417896}),_0x2e0edd=await purchases[_0x3c81e0(0x1c3)]([{'$match':{'warehouse_name':_0x4831f9[_0x3c81e0(0x1ef)]}},{'$unwind':_0x3c81e0(0x1c0)},{'$group':{'_id':_0x3c81e0(0x1c1)}}]);console['log']('purchases_data',_0x2e0edd);const _0x38493b=await product[_0x3c81e0(0x245)]({}),_0x9f8c07=await warehouse[_0x3c81e0(0x1c3)]([{'$match':{'name':_0x4831f9[_0x3c81e0(0x1ef)]}},{'$unwind':_0x3c81e0(0x258)},{'$group':{'_id':_0x3c81e0(0x266),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3c81e0(0x1c9)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x3c81e0(0x1be)},'type':{'$first':_0x3c81e0(0x256)},'floorlevel':{'$first':_0x3c81e0(0x1e4)},'primary_code':{'$first':_0x3c81e0(0x217)},'secondary_code':{'$first':_0x3c81e0(0x22d)},'product_code':{'$first':_0x3c81e0(0x203)},'storage':{'$first':_0x3c81e0(0x263)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3c81e0(0x269)},'production_date':{'$first':_0x3c81e0(0x232)},'batch_code':{'$first':_0x3c81e0(0x1e1)},'maxPerUnit':{'$first':_0x3c81e0(0x219)},'room':{'$first':_0x3c81e0(0x1de)}}}]);if(_0x424fb2[0x0][_0x3c81e0(0x254)]==_0x3c81e0(0x255)){var _0x10604f=users[_0x3c81e0(0x20a)];console[_0x3c81e0(0x218)](_0x10604f);}else{if(_0x424fb2[0x0][_0x3c81e0(0x254)]=='Hindi')var _0x10604f=users[_0x3c81e0(0x1d6)];else{if(_0x424fb2[0x0]['language']==_0x3c81e0(0x20c))var _0x10604f=users[_0x3c81e0(0x20c)];else{if(_0x424fb2[0x0][_0x3c81e0(0x254)]=='Spanish')var _0x10604f=users[_0x3c81e0(0x208)];else{if(_0x424fb2[0x0]['language']==_0x3c81e0(0x205))var _0x10604f=users[_0x3c81e0(0x205)];else{if(_0x424fb2[0x0][_0x3c81e0(0x254)]==_0x3c81e0(0x216))var _0x10604f=users[_0x3c81e0(0x1fb)];else{if(_0x424fb2[0x0][_0x3c81e0(0x254)]==_0x3c81e0(0x23e))var _0x10604f=users[_0x3c81e0(0x23e)];else{if(_0x424fb2[0x0]['language']==_0x3c81e0(0x1c8))var _0x10604f=users[_0x3c81e0(0x1ff)];}}}}}}}_0x4d69eb[_0x3c81e0(0x242)](_0x3c81e0(0x1e8),{'success':_0x54de0f[_0x3c81e0(0x1cb)](_0x3c81e0(0x25d)),'errors':_0x54de0f['flash']('errors'),'role':_0x3f5b2c,'profile':_0x869af2,'adjustment':_0x4831f9,'stock':_0x9f8c07,'master_shop':_0x424fb2,'warehouse_name':_0x2e0edd,'unit':_0x38493b,'language':_0x10604f});}catch(_0x2278ef){console[_0x3c81e0(0x218)](_0x2278ef),_0x4d69eb[_0x3c81e0(0x1f3)](0xc8)[_0x3c81e0(0x1f6)]({'message':_0x2278ef[_0x3c81e0(0x1c5)]});}}),router[a0_0x4d5dc0(0x1ec)](a0_0x4d5dc0(0x1c4),auth,async(_0x3010db,_0x2a1ad9)=>{var _0x25372f=a0_0x4d5dc0;try{const {invoice:_0x3cffd6,warehouse_name:_0x15f7b3,Room_name:_0x2ea5ed}=_0x3010db[_0x25372f(0x237)],_0x58f110=_0x3010db[_0x25372f(0x1ca)]['id'],_0x564592=await adjustment_finished[_0x25372f(0x1ed)]({'_id':_0x58f110});var _0x218679;const _0x364754=_0x564592[_0x25372f(0x1fc)][_0x25372f(0x1d1)](async _0x79532=>{var _0x52033e=_0x25372f;if(_0x79532[_0x52033e(0x1ce)]>0x0){_0x218679=await warehouse[_0x52033e(0x1fa)]({'name':_0x15f7b3,'room':_0x79532[_0x52033e(0x1bf)]});const _0x5c9882=_0x218679['product_details'][_0x52033e(0x1d1)](_0x2ead11=>{var _0x299cd8=_0x52033e;console['log'](_0x79532[_0x299cd8(0x21d)]);if(_0x79532[_0x299cd8(0x21d)]==_0x299cd8(0x1ea))_0x2ead11[_0x299cd8(0x21a)]==_0x79532[_0x299cd8(0x1cd)]&&(_0x2ead11[_0x299cd8(0x1dc)]=_0x2ead11['product_stock']-_0x79532[_0x299cd8(0x1ce)]);else _0x79532[_0x299cd8(0x21d)]==_0x299cd8(0x24f)&&(_0x2ead11['_id']==_0x79532[_0x299cd8(0x1cd)]&&(_0x2ead11[_0x299cd8(0x1dc)]=_0x2ead11['product_stock']+_0x79532[_0x299cd8(0x1ce)]));});}return _0x218679;});Promise[_0x25372f(0x1e3)](_0x364754)['then'](async _0x466304=>{var _0x57d341=_0x25372f;try{for(const _0x1a4122 of _0x466304){await _0x1a4122[_0x57d341(0x268)]();}_0x564592[_0x57d341(0x229)]=_0x57d341(0x260);const _0x53fa8b=await _0x564592[_0x57d341(0x268)](),_0x2b5f14=await master_shop[_0x57d341(0x245)](),_0x43d706=await email_settings[_0x57d341(0x1fa)](),_0x11d426=await supervisor_settings[_0x57d341(0x245)]();var _0x3658bf=_0x564592[_0x57d341(0x1fc)],_0x2779c7='',_0x4f7c7f;for(_0x4f7c7f in _0x3658bf){var _0x22c601='FG';_0x564592[_0x57d341(0x1ef)]==_0x57d341(0x1e5)&&(_0x22c601='DG'),_0x2779c7+=_0x57d341(0x225)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3658bf[_0x4f7c7f][_0x57d341(0x21e)]+'</td>'+_0x57d341(0x1d4)+_0x3658bf[_0x4f7c7f]['product_code']+_0x57d341(0x267)+_0x57d341(0x1d4)+_0x3658bf[_0x4f7c7f][_0x57d341(0x1ce)]+_0x57d341(0x267)+_0x57d341(0x1d4)+_0x3658bf[_0x4f7c7f][_0x57d341(0x1d0)]+_0x57d341(0x267)+_0x57d341(0x1d4)+_0x3658bf[_0x4f7c7f][_0x57d341(0x1f4)]+_0x57d341(0x267)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x564592[_0x57d341(0x1ef)]+_0x57d341(0x267)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3658bf[_0x4f7c7f][_0x57d341(0x1bf)]+_0x57d341(0x267)+_0x57d341(0x1d4)+_0x22c601+_0x3658bf[_0x4f7c7f]['bay']+_0x57d341(0x267)+'</tr>';}_0x3010db[_0x57d341(0x1cb)]('success',_0x57d341(0x253)),_0x2a1ad9[_0x57d341(0x209)](_0x57d341(0x1da)+_0x53fa8b[_0x57d341(0x21a)]);}catch(_0x57d62d){console['error'](_0x57d62d),_0x2a1ad9['status'](0x1f4)[_0x57d341(0x1f6)]({'error':_0x57d341(0x1eb)});}})[_0x25372f(0x213)](_0x17ee2b=>{var _0x5bedd1=_0x25372f;console[_0x5bedd1(0x1f2)](_0x17ee2b),_0x2a1ad9[_0x5bedd1(0x1f3)](0x1f4)[_0x5bedd1(0x1f6)]({'error':'An\x20error\x20occurred.'});});}catch(_0x26616e){_0x2a1ad9[_0x25372f(0x1f6)]({'message':_0x26616e[_0x25372f(0x1c5)]});}}),router['get'](a0_0x4d5dc0(0x215),auth,async(_0x5970fb,_0x1224f2)=>{var _0x4046f0=a0_0x4d5dc0;try{const {username:_0x1ead57,email:_0x3e56aa,role:_0x4e1170}=_0x5970fb[_0x4046f0(0x23f)],_0x3a2c80=_0x5970fb['user'],_0x5b8d70=await profile['findOne']({'email':_0x3a2c80[_0x4046f0(0x259)]}),_0xd25d29=await master_shop[_0x4046f0(0x245)]();console[_0x4046f0(0x218)](_0x4046f0(0x22f),_0xd25d29);const _0x2c78bc=_0x5970fb['params']['id'],_0x1b7538=await adjustment_finished[_0x4046f0(0x1ed)]({'_id':_0x2c78bc});let _0x50c975=new Date(_0x1b7538[_0x4046f0(0x1f1)]),_0x4ea897=('0'+_0x50c975[_0x4046f0(0x1e9)]())['slice'](-0x2),_0x29da31=('0'+(_0x50c975[_0x4046f0(0x234)]()+0x1))['slice'](-0x2),_0x85d4b3=_0x50c975[_0x4046f0(0x250)](),_0x8510ae=_0x85d4b3+'-'+_0x29da31+'-'+_0x4ea897;var _0x31fcde=['Ambient','Enclosed',_0x4046f0(0x1d8)];const _0x57b47e=await purchases[_0x4046f0(0x1c3)]([{'$match':{'warehouse_name':_0x1b7538[_0x4046f0(0x1ef)]}},{'$unwind':'$product'},{'$group':{'_id':_0x4046f0(0x1c1)}}]);console['log'](_0x4046f0(0x1c6),_0x57b47e);const _0x3387d9=await product[_0x4046f0(0x245)]({}),_0x15ae0e=await warehouse['aggregate']([{'$match':{'name':_0x1b7538[_0x4046f0(0x1ef)],'room':_0x1b7538[_0x4046f0(0x23d)]}},{'$unwind':_0x4046f0(0x258)},{'$group':{'_id':_0x4046f0(0x266),'name':{'$first':_0x4046f0(0x220)},'product_stock':{'$first':_0x4046f0(0x1c9)},'bay':{'$first':_0x4046f0(0x23b)},'bin':{'$first':_0x4046f0(0x1be)},'type':{'$first':_0x4046f0(0x256)},'floorlevel':{'$first':_0x4046f0(0x1e4)},'primary_code':{'$first':_0x4046f0(0x217)},'secondary_code':{'$first':_0x4046f0(0x22d)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4046f0(0x263)},'rack':{'$first':_0x4046f0(0x1cc)}}}]);if(_0xd25d29[0x0]['language']=='English\x20(US)'){var _0x1d5e95=users['English'];console[_0x4046f0(0x218)](_0x1d5e95);}else{if(_0xd25d29[0x0][_0x4046f0(0x254)]=='Hindi')var _0x1d5e95=users[_0x4046f0(0x1d6)];else{if(_0xd25d29[0x0][_0x4046f0(0x254)]==_0x4046f0(0x20c))var _0x1d5e95=users[_0x4046f0(0x20c)];else{if(_0xd25d29[0x0][_0x4046f0(0x254)]=='Spanish')var _0x1d5e95=users['Spanish'];else{if(_0xd25d29[0x0]['language']==_0x4046f0(0x205))var _0x1d5e95=users[_0x4046f0(0x205)];else{if(_0xd25d29[0x0][_0x4046f0(0x254)]==_0x4046f0(0x216))var _0x1d5e95=users[_0x4046f0(0x1fb)];else{if(_0xd25d29[0x0][_0x4046f0(0x254)]==_0x4046f0(0x23e))var _0x1d5e95=users['Chinese'];else{if(_0xd25d29[0x0][_0x4046f0(0x254)]==_0x4046f0(0x1c8))var _0x1d5e95=users[_0x4046f0(0x1ff)];}}}}}}}_0x1224f2[_0x4046f0(0x242)](_0x4046f0(0x1f9),{'success':_0x5970fb[_0x4046f0(0x1cb)](_0x4046f0(0x25d)),'errors':_0x5970fb[_0x4046f0(0x1cb)](_0x4046f0(0x22c)),'role':_0x3a2c80,'profile':_0x5b8d70,'adjustment':_0x1b7538,'stock':_0x15ae0e,'master_shop':_0xd25d29,'warehouse_name':_0x57b47e,'unit':_0x3387d9,'language':_0x1d5e95,'rooms_data':_0x31fcde,'ed_fullDate':_0x8510ae});}catch(_0x54f478){console[_0x4046f0(0x218)](_0x54f478),_0x1224f2['status'](0xc8)[_0x4046f0(0x1f6)]({'message':_0x54f478[_0x4046f0(0x1c5)]});}}),router[a0_0x4d5dc0(0x1ec)](a0_0x4d5dc0(0x215),auth,async(_0x1ea357,_0x4a5c80)=>{var _0x550dc8=a0_0x4d5dc0;try{const _0x1029c1=_0x1ea357['params']['id'],_0x547304=await adjustment_finished[_0x550dc8(0x1ed)]({'_id':_0x1029c1}),_0x1817b3=await warehouse[_0x550dc8(0x1fa)]({'name':_0x547304[_0x550dc8(0x1ef)],'room':_0x547304[_0x550dc8(0x23d)]}),{warehouse_name:_0x39dcd5,date:_0x31ac01,prod_name:_0xabb7ac,level:_0x462299,isle:_0x41548c,pallet:_0x3b5c1f,stock:_0x61ce8e,types:_0x85ba7,adjust_qty:_0x2d8200,new_adjust_qty:_0x2af752,note:_0x13efa9,Room_name:_0xc74a89,invoice:_0x5669f1,JO_number:_0x4ad968}=_0x1ea357[_0x550dc8(0x237)];if(typeof _0xabb7ac==_0x550dc8(0x210))var _0x4ddf5a=[_0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x22b)]],_0x37a34b=[_0x1ea357['body'][_0x550dc8(0x249)]],_0x31ec13=[_0x1ea357[_0x550dc8(0x237)]['stock']],_0x29d560=[_0x1ea357[_0x550dc8(0x237)]['types']],_0x2ff7cb=[_0x1ea357['body'][_0x550dc8(0x1ce)]],_0x2cbbc2=[_0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x22a)]],_0x5954f8=[_0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x262)]],_0x2cfeca=[_0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x1d0)]],_0x516799=[_0x1ea357['body'][_0x550dc8(0x20d)]],_0x32b5b4=[_0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x252)]],_0x31a8be=[_0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x1f1)]];else var _0x4ddf5a=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x22b)]],_0x37a34b=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x249)]],_0x31ec13=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x24e)]],_0x29d560=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x21d)]],_0x2ff7cb=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x1ce)]],_0x2cbbc2=[..._0x1ea357['body']['new_adjust_qty']],_0x5954f8=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x262)]],_0x2cfeca=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x1d0)]],_0x516799=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x20d)]],_0x32b5b4=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x252)]],_0x31a8be=[..._0x1ea357[_0x550dc8(0x237)][_0x550dc8(0x1f1)]];const _0x1fbc98=_0x4ddf5a[_0x550dc8(0x1d1)](_0x3a59c5=>{return _0x3a59c5={'product_name':_0x3a59c5};});_0x37a34b[_0x550dc8(0x233)]((_0x1de2aa,_0x3a4f06)=>{_0x1fbc98[_0x3a4f06]['bay']=_0x1de2aa;}),_0x31ec13[_0x550dc8(0x233)]((_0x2304ec,_0x371755)=>{var _0x8abb3a=_0x550dc8;_0x1fbc98[_0x371755][_0x8abb3a(0x223)]=_0x2304ec;}),_0x29d560['forEach']((_0x4d70f4,_0x1f7650)=>{var _0x331122=_0x550dc8;_0x1fbc98[_0x1f7650][_0x331122(0x21d)]=_0x4d70f4;}),_0x2ff7cb[_0x550dc8(0x233)]((_0x157f13,_0x3f0cce)=>{_0x1fbc98[_0x3f0cce]['adjust_qty']=_0x157f13;}),_0x2cbbc2[_0x550dc8(0x233)]((_0x350da9,_0x47fd7a)=>{var _0x298fd2=_0x550dc8;_0x1fbc98[_0x47fd7a][_0x298fd2(0x22a)]=_0x350da9;}),_0x2cfeca[_0x550dc8(0x233)]((_0x369139,_0x521236)=>{_0x1fbc98[_0x521236]['unit']=_0x369139;}),_0x516799[_0x550dc8(0x233)]((_0x3aedfb,_0x488a1c)=>{var _0x2096cf=_0x550dc8;_0x1fbc98[_0x488a1c][_0x2096cf(0x1f4)]=_0x3aedfb;}),_0x5954f8[_0x550dc8(0x233)]((_0x2b0052,_0x535fbf)=>{var _0x3cbdfc=_0x550dc8;_0x1fbc98[_0x535fbf][_0x3cbdfc(0x1e2)]=_0x2b0052;}),_0x32b5b4[_0x550dc8(0x233)]((_0x156668,_0x453fbb)=>{_0x1fbc98[_0x453fbb]['batch_code']=_0x156668;}),_0x31a8be['forEach']((_0x369da7,_0x8e28b7)=>{var _0x46b466=_0x550dc8;_0x1fbc98[_0x8e28b7][_0x46b466(0x1f1)]=_0x369da7;});const _0x31a290=_0x1fbc98[_0x550dc8(0x212)](_0x11219d=>_0x11219d['adjust_qty']!=='0'&&_0x11219d[_0x550dc8(0x1ce)]!=='');var _0x5af9da=0x0;_0x31a290[_0x550dc8(0x233)](_0xe8d63a=>{var _0x1223b4=_0x550dc8;console['log'](_0x1223b4(0x1bd),_0xe8d63a),parseInt(_0xe8d63a['adjust_qty'])<=0x0&&_0x5af9da++;});if(_0x5af9da!=0x0)return _0x1ea357[_0x550dc8(0x1cb)](_0x550dc8(0x22c),_0x550dc8(0x1cf)),_0x4a5c80[_0x550dc8(0x209)]('back');_0x547304[_0x550dc8(0x1ef)]=_0x39dcd5,_0x547304['date']=_0x31ac01,_0x547304[_0x550dc8(0x1fc)]=_0x31a290,_0x547304[_0x550dc8(0x25f)]=_0x13efa9,_0x547304[_0x550dc8(0x23d)]=_0xc74a89,_0x547304['invoice']=_0x5669f1,_0x547304[_0x550dc8(0x24c)]=_0x4ad968;const _0x34f4bc=await _0x547304[_0x550dc8(0x268)](),_0x25e397=await warehouse[_0x550dc8(0x1fa)]({'name':_0x39dcd5,'room':_0xc74a89});_0x34f4bc['product'][_0x550dc8(0x233)](_0x2a4a95=>{var _0x494b3c=_0x550dc8;const _0x3b6d14=_0x25e397['product_details'][_0x494b3c(0x1d1)](_0x2d48c6=>{var _0x209c96=_0x494b3c;_0x2a4a95[_0x209c96(0x21d)]==_0x209c96(0x1ea)?_0x2d48c6[_0x209c96(0x21e)]==_0x2a4a95[_0x209c96(0x21e)]&&_0x2d48c6[_0x209c96(0x201)]==_0x2a4a95[_0x209c96(0x201)]&&(_0x2d48c6[_0x209c96(0x1dc)]=parseInt(_0x2d48c6[_0x209c96(0x1dc)])-parseInt(_0x2a4a95['adjust_qty'])):_0x2d48c6[_0x209c96(0x21e)]==_0x2a4a95[_0x209c96(0x21e)]&&_0x2d48c6['bay']==_0x2a4a95[_0x209c96(0x201)]&&(_0x2d48c6[_0x209c96(0x1dc)]=parseInt(_0x2d48c6[_0x209c96(0x1dc)])+parseInt(_0x2a4a95[_0x209c96(0x1ce)]));});}),await _0x25e397[_0x550dc8(0x268)](),_0x1ea357['flash'](_0x550dc8(0x25d),_0x550dc8(0x248)),_0x4a5c80[_0x550dc8(0x209)](_0x550dc8(0x1e7));}catch(_0x2455bf){console[_0x550dc8(0x218)](_0x2455bf);}}),router[a0_0x4d5dc0(0x1ec)]('/barcode_scanner',async(_0x60d8a9,_0x2aae35)=>{var _0x597ac1=a0_0x4d5dc0;const {primary_code:_0x28dab1,warehouse_data:_0x4b5ab8,rooms_data:_0x1dc4a2,Roomslist:_0x5b0678}=_0x60d8a9['body'],_0x3f8950=_0x5b0678['split'](','),_0x14487a=[];async function _0x503156(_0x14e44d){var _0xea2b8a=a0_0x3fb2;const _0x40d3dc=await warehouse[_0xea2b8a(0x1c3)]([{'$match':{'name':_0x4b5ab8,'room':_0x14e44d}},{'$unwind':_0xea2b8a(0x258)},{'$match':{'product_details.primary_code':_0x28dab1}},{'$group':{'_id':_0xea2b8a(0x266),'name':{'$first':_0xea2b8a(0x220)},'product_stock':{'$first':_0xea2b8a(0x1c9)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xea2b8a(0x22d)},'product_code':{'$first':_0xea2b8a(0x203)},'level':{'$first':_0xea2b8a(0x24d)},'bay':{'$first':_0xea2b8a(0x23b)},'type':{'$first':_0xea2b8a(0x256)},'pallet':{'$first':_0xea2b8a(0x1e4)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xea2b8a(0x1fd)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xea2b8a(0x1cc)},'expiry_date':{'$first':_0xea2b8a(0x269)},'production_date':{'$first':_0xea2b8a(0x232)},'batch_code':{'$first':_0xea2b8a(0x1e1)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0xea2b8a(0x219)},'roomNamed':{'$first':_0xea2b8a(0x1de)},'invoice':{'$first':_0xea2b8a(0x222)}}}]),_0x561167=await warehouse[_0xea2b8a(0x1c3)]([{'$match':{'name':_0x4b5ab8,'room':_0x14e44d}},{'$unwind':_0xea2b8a(0x258)},{'$match':{'product_details.secondary_code':_0x28dab1}},{'$group':{'_id':_0xea2b8a(0x266),'name':{'$first':_0xea2b8a(0x220)},'product_stock':{'$first':_0xea2b8a(0x1c9)},'primary_code':{'$first':_0xea2b8a(0x217)},'secondary_code':{'$first':_0xea2b8a(0x22d)},'product_code':{'$first':_0xea2b8a(0x203)},'level':{'$first':_0xea2b8a(0x24d)},'bay':{'$first':'$product_details.bay'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0xea2b8a(0x1e4)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xea2b8a(0x1cc)},'expiry_date':{'$first':_0xea2b8a(0x269)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0xea2b8a(0x1e1)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0xea2b8a(0x219)},'roomNamed':{'$first':_0xea2b8a(0x1de)},'invoice':{'$first':_0xea2b8a(0x222)}}}]);if(_0x40d3dc[_0xea2b8a(0x200)]>0x0)_0x14487a['push'](_0x40d3dc);else _0x561167[_0xea2b8a(0x200)]>0x0&&_0x14487a['push'](_0x561167);}const _0x15ef48=_0x3f8950[_0x597ac1(0x1d1)](_0x13d947=>_0x503156(_0x13d947));await Promise[_0x597ac1(0x1e3)](_0x15ef48),_0x2aae35[_0x597ac1(0x1f6)](_0x14487a);}),router['post'](a0_0x4d5dc0(0x1d3),async(_0x1d5ed9,_0xe6ea82)=>{var _0x415449=a0_0x4d5dc0;const {productCode:_0x5a888f,bay:_0xc21f72,warehouses:_0x157786,room:_0x37220c}=_0x1d5ed9[_0x415449(0x237)];console['log'](_0x1d5ed9[_0x415449(0x237)]);try{const _0x4b61bc=await warehouse[_0x415449(0x1c3)]([{'$match':{'name':_0x157786,'room':_0x37220c}},{'$unwind':_0x415449(0x258)},{'$match':{'product_details.bay':parseInt(_0xc21f72)}},{'$group':{'_id':_0x415449(0x266),'name':{'$first':_0x415449(0x220)},'product_stock':{'$first':_0x415449(0x1c9)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x415449(0x226)}}}]);_0xe6ea82['status'](0xc8)['json'](_0x4b61bc);}catch(_0x4c0676){_0xe6ea82[_0x415449(0x1f3)](0x194)[_0x415449(0x1f6)]({'message':_0x4c0676[_0x415449(0x1c5)]});}}),module[a0_0x4d5dc0(0x25b)]=router;