function a0_0xb417(_0x2dd392,_0x4f03b9){var _0x16a2fb=a0_0x16a2();return a0_0xb417=function(_0xb417d1,_0x40f565){_0xb417d1=_0xb417d1-0x170;var _0x24b8b2=_0x16a2fb[_0xb417d1];return _0x24b8b2;},a0_0xb417(_0x2dd392,_0x4f03b9);}var a0_0x192a53=a0_0xb417;function a0_0x16a2(){var _0x1a3f94=['$product_details.expiry_date','$product.product_name','new_adjust_qty','/adjustment/view','email','filter','json','then','DRY\x20GOODS','product_details','$product_details.level','New_Qty_Converted','Portuguese','redirect','edit_adjustment_finished_view','$name','push','product_date','/adjustment_finished/preview/','role','$product_details.production_date','</tr>','$product.room_names','$finalize','Return\x20Rooms','French','$product_details.product_name','stock','findById','English','product','random','flash','toString','render','adjust_qty','padStart','4488qlnctA','New_Qty_Converted_adj','errors','$product_details._id','product_stock','aggregate','length','$product_details.batch_code','$date','post','getFullYear','_id','$product_details.type','Enclosed','bay','all','$product_details.maxPerUnit','warehouse','finalize','slice','error','$product_details.product_code','$product_details.bay','Adjustment\x20Finalize\x20Successfully','1136536cnGWVC','params','/CheckingWarehouse','$product_details.maxProducts','body','An\x20error\x20occurred\x20while\x20saving\x20data.','findOne','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','forEach','Arabic\x20(ae)','799686kbCggU','language','English\x20(US)','Hindi','express','/adjustment_finished/view','$product_details.product_stock','foreach\x20newproduct','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','1264770oXNPQS','True','$product','$product_details.secondary_unit','ADJF-','invoice_init','$product_details.secondary_code','product_code','/view/add_adjustment','2330BuoPRo','$product_details.primary_code','stockBefore','adjustment\x20add\x20successfull','$product_details.storage','/picking_list/PDF_adjustmentFinal/','note','message','save','prod_name','status','level','maxPerUnit','Primary_Units','/view','../models/all_models','product_name','$_id','success','JO_number','split','German','$product_details','add_adjustment_finished','$product_details.unit','$product_details.rack','Rooms','3GgbGLN','Chinese','id_transaction','warehouse_name','prod_cat','id_transaction_from','251284mJfMXc','$invoice','</td>','9pHKekV','secondary_unit','date','find','string','invoice','$warehouse_name','room_names','7326rHDDQR','own','/view/:id','staff','$room','master','logs','LOG-ADJ-','minus','prod_invoice','Enabled','room','Spanish','user','types','batch_code','expiry_date','../middleware/auth','Portuguese\x20(BR)','2190356ANsYYh','get','Arabic','production_date','9016sMSVGL','unit','add_adjustment_finished_logs','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/view_logs','adjustment_finished','$product_details.invoice','exports','match','Ambient','log','ADJ-','prod_code','$product_details.bin','/view/add_adjustment_logs','map','edit_adjustment_finished','back','purchases_data','<tr>','catch','$product_details.floorlevel','Secondary_units','getMonth'];a0_0x16a2=function(){return _0x1a3f94;};return a0_0x16a2();}(function(_0x336ebc,_0x45f966){var _0xeb5a85=a0_0xb417,_0x3abb56=_0x336ebc();while(!![]){try{var _0x25fb3d=-parseInt(_0xeb5a85(0x218))/0x1*(-parseInt(_0xeb5a85(0x21e))/0x2)+parseInt(_0xeb5a85(0x221))/0x3*(-parseInt(_0xeb5a85(0x188))/0x4)+parseInt(_0xeb5a85(0x1f4))/0x5+parseInt(_0xeb5a85(0x175))/0x6*(parseInt(_0xeb5a85(0x18c))/0x7)+parseInt(_0xeb5a85(0x1e1))/0x8+parseInt(_0xeb5a85(0x1eb))/0x9+parseInt(_0xeb5a85(0x1fd))/0xa*(parseInt(_0xeb5a85(0x1c9))/0xb);if(_0x25fb3d===_0x45f966)break;else _0x3abb56['push'](_0x3abb56['shift']());}catch(_0x5ce34d){_0x3abb56['push'](_0x3abb56['shift']());}}}(a0_0x16a2,0xd83f2));const express=require(a0_0x192a53(0x1ef)),app=express(),router=express['Router'](),auth=require(a0_0x192a53(0x186)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_logs,adjustment_finished,email_settings,supervisor_settings,invoice_for_adjustment}=require(a0_0x192a53(0x20c)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x192a53(0x189)](a0_0x192a53(0x20b),auth,async(_0x2e85fc,_0x55a083)=>{var _0x43ad13=a0_0x192a53;try{const {username:_0x4bd6ae,email:_0xb13d22,role:_0x9e7646}=_0x2e85fc[_0x43ad13(0x182)],_0x454dae=_0x2e85fc[_0x43ad13(0x182)],_0xe9857c=await profile[_0x43ad13(0x1e7)]({'email':_0x454dae['email']}),_0x4a714e=await master_shop[_0x43ad13(0x170)]();let _0x2aed33;if(_0x454dae[_0x43ad13(0x1b7)]==_0x43ad13(0x178)){const _0x47e303=await staff[_0x43ad13(0x1e7)]({'email':_0x454dae[_0x43ad13(0x1a8)]});_0x2aed33=await warehouse['find']({'status':_0x43ad13(0x17f),'name':_0x47e303[_0x43ad13(0x1da)]});}else _0x2aed33=await warehouse[_0x43ad13(0x170)]({'status':_0x43ad13(0x17f)});const _0x13b493=await product[_0x43ad13(0x170)]();let _0x39e2e9;if(_0x454dae['role']==_0x43ad13(0x178)){const _0x27a8c7=await staff[_0x43ad13(0x1e7)]({'email':_0x454dae[_0x43ad13(0x1a8)]});_0x39e2e9=await adjustment_finished['find']({'warehouse_name':_0x27a8c7[_0x43ad13(0x1da)]});}else _0x39e2e9=await adjustment_finished[_0x43ad13(0x1ce)]([{'$match':{'type_of_transaction':_0x43ad13(0x176)}},{'$unwind':_0x43ad13(0x1f6)},{'$group':{'_id':_0x43ad13(0x20e),'invoice':{'$first':_0x43ad13(0x21f)},'date':{'$first':_0x43ad13(0x1d1)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x43ad13(0x1bb)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x4a714e[0x0][_0x43ad13(0x1ec)]==_0x43ad13(0x1ed)){var _0x58f8cd=users[_0x43ad13(0x1c1)];console[_0x43ad13(0x196)](_0x58f8cd);}else{if(_0x4a714e[0x0][_0x43ad13(0x1ec)]=='Hindi')var _0x58f8cd=users['Hindi'];else{if(_0x4a714e[0x0][_0x43ad13(0x1ec)]=='German')var _0x58f8cd=users[_0x43ad13(0x212)];else{if(_0x4a714e[0x0][_0x43ad13(0x1ec)]=='Spanish')var _0x58f8cd=users[_0x43ad13(0x181)];else{if(_0x4a714e[0x0]['language']=='French')var _0x58f8cd=users[_0x43ad13(0x1bd)];else{if(_0x4a714e[0x0]['language']=='Portuguese\x20(BR)')var _0x58f8cd=users[_0x43ad13(0x1b0)];else{if(_0x4a714e[0x0]['language']==_0x43ad13(0x219))var _0x58f8cd=users[_0x43ad13(0x219)];else{if(_0x4a714e[0x0][_0x43ad13(0x1ec)]==_0x43ad13(0x1ea))var _0x58f8cd=users[_0x43ad13(0x18a)];}}}}}}}_0x55a083[_0x43ad13(0x1c6)](_0x43ad13(0x191),{'success':_0x2e85fc[_0x43ad13(0x1c4)](_0x43ad13(0x20f)),'errors':_0x2e85fc[_0x43ad13(0x1c4)](_0x43ad13(0x1cb)),'role':_0x454dae,'profile':_0xe9857c,'warehouse':_0x2aed33,'product':_0x13b493,'adjustment':_0x39e2e9,'master_shop':_0x4a714e,'language':_0x58f8cd});}catch(_0x43dd72){console[_0x43ad13(0x196)](_0x43dd72);}}),router[a0_0x192a53(0x189)](a0_0x192a53(0x190),auth,async(_0x29d93b,_0x4db269)=>{var _0x4dca39=a0_0x192a53;try{const {username:_0x45a4a9,email:_0x3a8ee8,role:_0x39ba6b}=_0x29d93b[_0x4dca39(0x182)],_0x41590a=_0x29d93b[_0x4dca39(0x182)],_0x44c5e6=await profile[_0x4dca39(0x1e7)]({'email':_0x41590a['email']}),_0x14c97b=await master_shop[_0x4dca39(0x170)]();let _0x395de4;if(_0x41590a['role']==_0x4dca39(0x178)){const _0x13306b=await staff[_0x4dca39(0x1e7)]({'email':_0x41590a[_0x4dca39(0x1a8)]});_0x395de4=await warehouse['find']({'status':'Enabled','name':_0x13306b[_0x4dca39(0x1da)]});}else _0x395de4=await warehouse[_0x4dca39(0x170)]({'status':_0x4dca39(0x17f)});const _0x2bf7f0=await product[_0x4dca39(0x170)]();let _0x1a08d4;if(_0x41590a[_0x4dca39(0x1b7)]==_0x4dca39(0x178)){const _0x505909=await staff[_0x4dca39(0x1e7)]({'email':_0x41590a[_0x4dca39(0x1a8)]});_0x1a08d4=await adjustment_finished['find']({'warehouse_name':_0x505909[_0x4dca39(0x1da)]});}else _0x1a08d4=await adjustment_finished['aggregate']([{'$match':{'type_of_transaction':_0x4dca39(0x17b)}},{'$unwind':'$product'},{'$group':{'_id':_0x4dca39(0x20e),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x4dca39(0x173)},'room':{'$addToSet':_0x4dca39(0x1ba)},'finalize':{'$first':_0x4dca39(0x1bb)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x14c97b[0x0][_0x4dca39(0x1ec)]=='English\x20(US)')var _0x1b1bb9=users[_0x4dca39(0x1c1)];else{if(_0x14c97b[0x0][_0x4dca39(0x1ec)]==_0x4dca39(0x1ee))var _0x1b1bb9=users['Hindi'];else{if(_0x14c97b[0x0][_0x4dca39(0x1ec)]==_0x4dca39(0x212))var _0x1b1bb9=users[_0x4dca39(0x212)];else{if(_0x14c97b[0x0]['language']==_0x4dca39(0x181))var _0x1b1bb9=users['Spanish'];else{if(_0x14c97b[0x0]['language']==_0x4dca39(0x1bd))var _0x1b1bb9=users[_0x4dca39(0x1bd)];else{if(_0x14c97b[0x0][_0x4dca39(0x1ec)]==_0x4dca39(0x187))var _0x1b1bb9=users[_0x4dca39(0x1b0)];else{if(_0x14c97b[0x0][_0x4dca39(0x1ec)]==_0x4dca39(0x219))var _0x1b1bb9=users[_0x4dca39(0x219)];else{if(_0x14c97b[0x0][_0x4dca39(0x1ec)]==_0x4dca39(0x1ea))var _0x1b1bb9=users[_0x4dca39(0x18a)];}}}}}}}_0x4db269['render']('adjustment_finished_logs',{'success':_0x29d93b[_0x4dca39(0x1c4)](_0x4dca39(0x20f)),'errors':_0x29d93b[_0x4dca39(0x1c4)](_0x4dca39(0x1cb)),'role':_0x41590a,'profile':_0x44c5e6,'warehouse':_0x395de4,'product':_0x2bf7f0,'adjustment':_0x1a08d4,'master_shop':_0x14c97b,'language':_0x1b1bb9});}catch(_0xa6f900){console[_0x4dca39(0x196)](_0xa6f900);}});async function getRandom8DigitNumber(){var _0x1b2663=a0_0x192a53;const _0x1da7a5=0x989680,_0x4cf98b=0x5f5e0ff,_0x18b31a=Math['floor'](Math[_0x1b2663(0x1c3)]()*(_0x4cf98b-_0x1da7a5+0x1))+_0x1da7a5;var _0x36b8b6;const _0xd8e328=await adjustment_finished[_0x1b2663(0x1e7)]({'invoice':_0x1b2663(0x1f8)+_0x18b31a});return _0xd8e328&&_0xd8e328[_0x1b2663(0x1cf)]>0x0?_0x36b8b6=_0x1b2663(0x1f8)+_0x18b31a:_0x36b8b6=_0x1b2663(0x1f8)+_0x18b31a,_0x36b8b6;}router[a0_0x192a53(0x189)](a0_0x192a53(0x1fc),auth,async(_0x5e3ef9,_0x5826dd)=>{var _0x1e8cc7=a0_0x192a53;try{const {username:_0x3b1856,email:_0x55feb0,role:_0xbadced}=_0x5e3ef9[_0x1e8cc7(0x182)],_0x2a9932=_0x5e3ef9['user'],_0x33714a=await profile[_0x1e8cc7(0x1e7)]({'email':_0x2a9932[_0x1e8cc7(0x1a8)]}),_0xcdcc5d=await master_shop[_0x1e8cc7(0x170)]();let _0x229e70;if(_0x2a9932[_0x1e8cc7(0x1b7)]==_0x1e8cc7(0x178)){const _0x286197=await staff[_0x1e8cc7(0x1e7)]({'email':_0x2a9932[_0x1e8cc7(0x1a8)]});_0x229e70=await warehouse[_0x1e8cc7(0x1ce)]([{'$match':{'status':_0x1e8cc7(0x17f),'name':_0x286197[_0x1e8cc7(0x1da)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x229e70=await warehouse[_0x1e8cc7(0x1ce)]([{'$match':{'status':_0x1e8cc7(0x17f)}},{'$group':{'_id':_0x1e8cc7(0x1b3),'name':{'$first':'$name'}}}]);const _0x23cff5=await product[_0x1e8cc7(0x170)]({}),_0x5e39f3=await adjustment_finished[_0x1e8cc7(0x170)](),_0x340d7=_0x5e39f3[_0x1e8cc7(0x1cf)]+0x1,_0x424537=_0x1e8cc7(0x1f8)+_0x340d7[_0x1e8cc7(0x1c5)]()[_0x1e8cc7(0x1c8)](0x5,'0');var _0x9adc58=[_0x1e8cc7(0x195),_0x1e8cc7(0x1d6),_0x1e8cc7(0x1bc)];if(_0xcdcc5d[0x0][_0x1e8cc7(0x1ec)]==_0x1e8cc7(0x1ed))var _0x425176=users[_0x1e8cc7(0x1c1)];else{if(_0xcdcc5d[0x0]['language']==_0x1e8cc7(0x1ee))var _0x425176=users[_0x1e8cc7(0x1ee)];else{if(_0xcdcc5d[0x0][_0x1e8cc7(0x1ec)]==_0x1e8cc7(0x212))var _0x425176=users[_0x1e8cc7(0x212)];else{if(_0xcdcc5d[0x0]['language']==_0x1e8cc7(0x181))var _0x425176=users[_0x1e8cc7(0x181)];else{if(_0xcdcc5d[0x0][_0x1e8cc7(0x1ec)]==_0x1e8cc7(0x1bd))var _0x425176=users[_0x1e8cc7(0x1bd)];else{if(_0xcdcc5d[0x0][_0x1e8cc7(0x1ec)]==_0x1e8cc7(0x187))var _0x425176=users[_0x1e8cc7(0x1b0)];else{if(_0xcdcc5d[0x0][_0x1e8cc7(0x1ec)]==_0x1e8cc7(0x219))var _0x425176=users[_0x1e8cc7(0x219)];else{if(_0xcdcc5d[0x0]['language']==_0x1e8cc7(0x1ea))var _0x425176=users[_0x1e8cc7(0x18a)];}}}}}}}const _0x379642=getRandom8DigitNumber();_0x379642[_0x1e8cc7(0x1ab)](_0x4e022e=>{var _0x380dc0=_0x1e8cc7;_0x5826dd['render'](_0x380dc0(0x214),{'success':_0x5e3ef9['flash']('success'),'errors':_0x5e3ef9[_0x380dc0(0x1c4)](_0x380dc0(0x1cb)),'role':_0x2a9932,'profile':_0x33714a,'warehouse':_0x229e70,'product':_0x23cff5,'master_shop':_0xcdcc5d,'language':_0x425176,'rooms_data':_0x9adc58,'invoice_no':_0x4e022e});})[_0x1e8cc7(0x1a0)](_0x472cd6=>{var _0x8a43c5=_0x1e8cc7;_0x5e3ef9['flash']('errors',_0x8a43c5(0x18f)),_0x5826dd[_0x8a43c5(0x1b1)](_0x8a43c5(0x1a7));});}catch(_0x13afdb){console[_0x1e8cc7(0x196)](_0x13afdb);}}),router[a0_0x192a53(0x1d2)](a0_0x192a53(0x1fc),auth,async(_0x2e8ff3,_0x32f3cf)=>{var _0x33d5b6=a0_0x192a53;try{const {warehouse_name:_0x4ee3ce,date:_0x21740b,prod_name:_0x23aa34,level:_0x4dcef9,isle:_0x15811a,pallet:_0x5711ee,stock:_0x1dab5e,types:_0x6e7f1c,adjust_qty:_0x58659b,new_adjust_qty:_0x5de2f1,note:_0x32460b,Room_name:_0x242094,JO_number:_0x5b1f1a,expiry_date:_0x4a004e,PO_number:_0x48cd20,ReqBy:_0xe90628,dateofreq:_0x5079f4,typeservicesData:_0x3f66ea,destination:_0x3ca8d7,deliverydate:_0x2c6320,driver:_0x557f62,plate:_0x294330,van:_0x239c31,DRSI:_0x40cb2f,typevehicle:_0x355168,TSU:_0x34723c,TFU:_0x49ba26}=_0x2e8ff3[_0x33d5b6(0x1e5)];if(typeof _0x23aa34==_0x33d5b6(0x171))var _0x86a09a=[_0x2e8ff3[_0x33d5b6(0x1e5)]['prod_name']],_0x592518=[_0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x208)]],_0x5ca89d=[_0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x1bf)]],_0x58da41=[_0x2e8ff3['body'][_0x33d5b6(0x183)]],_0x37513d=[_0x2e8ff3[_0x33d5b6(0x1e5)]['New_Qty_Converted_adj']],_0x1956e2=[_0x2e8ff3['body'][_0x33d5b6(0x1af)]],_0x1ab035=[_0x2e8ff3['body'][_0x33d5b6(0x20a)]],_0x9b7421=[_0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x1a2)]],_0x2ab6dc=[_0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x198)]],_0x1bc26c=[_0x2e8ff3['body']['batch_code']],_0x162eea=[_0x2e8ff3['body']['expiry_date']],_0x1faa21=[_0x2e8ff3['body'][_0x33d5b6(0x1b5)]],_0x55f902=[_0x2e8ff3['body'][_0x33d5b6(0x21c)]],_0x3d6fd5=[_0x2e8ff3['body'][_0x33d5b6(0x217)]],_0x1a9728=[_0x2e8ff3['body'][_0x33d5b6(0x209)]],_0x1a907f=[_0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x17e)]],_0x38ccac=[_0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x21d)]];else var _0x86a09a=[..._0x2e8ff3['body'][_0x33d5b6(0x206)]],_0x592518=[..._0x2e8ff3['body'][_0x33d5b6(0x208)]],_0x5ca89d=[..._0x2e8ff3['body'][_0x33d5b6(0x1bf)]],_0x58da41=[..._0x2e8ff3[_0x33d5b6(0x1e5)]['types']],_0x37513d=[..._0x2e8ff3['body'][_0x33d5b6(0x1ca)]],_0x1956e2=[..._0x2e8ff3['body'][_0x33d5b6(0x1af)]],_0x1ab035=[..._0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x20a)]],_0x9b7421=[..._0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x1a2)]],_0x2ab6dc=[..._0x2e8ff3['body'][_0x33d5b6(0x198)]],_0x1bc26c=[..._0x2e8ff3['body'][_0x33d5b6(0x184)]],_0x162eea=[..._0x2e8ff3[_0x33d5b6(0x1e5)]['expiry_date']],_0x1faa21=[..._0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x1b5)]],_0x55f902=[..._0x2e8ff3['body'][_0x33d5b6(0x21c)]],_0x3d6fd5=[..._0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x217)]],_0x1a9728=[..._0x2e8ff3['body'][_0x33d5b6(0x209)]],_0x1a907f=[..._0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x17e)]],_0x38ccac=[..._0x2e8ff3[_0x33d5b6(0x1e5)][_0x33d5b6(0x21d)]];const _0x4bdba4=_0x86a09a[_0x33d5b6(0x19b)](_0x433859=>{return _0x433859={'product_name':_0x433859};});_0x592518[_0x33d5b6(0x1e9)]((_0x33d85e,_0x3da494)=>{var _0x340493=_0x33d5b6,_0x5c1db1=_0x33d85e[_0x340493(0x194)](/[A-Za-z]+/)[0x0],_0x5316b0=parseInt(_0x33d85e[_0x340493(0x194)](/\d+/)[0x0]);_0x4bdba4[_0x3da494][_0x340493(0x208)]=_0x5c1db1,_0x4bdba4[_0x3da494][_0x340493(0x1d7)]=_0x5316b0;}),_0x38ccac[_0x33d5b6(0x1e9)]((_0x4de5e5,_0x1569e4)=>{var _0x102e37=_0x33d5b6;_0x4bdba4[_0x1569e4][_0x102e37(0x21a)]=_0x4de5e5;}),_0x5ca89d[_0x33d5b6(0x1e9)]((_0x5c35d9,_0x2571a1)=>{_0x4bdba4[_0x2571a1]['stockBefore']=_0x5c35d9;}),_0x58da41[_0x33d5b6(0x1e9)]((_0x505686,_0x46bde1)=>{var _0x1dbd01=_0x33d5b6;_0x4bdba4[_0x46bde1][_0x1dbd01(0x183)]=_0x505686;}),_0x37513d[_0x33d5b6(0x1e9)]((_0x3f7873,_0x9980cf)=>{var _0x42ebf6=_0x33d5b6;_0x4bdba4[_0x9980cf][_0x42ebf6(0x1c7)]=_0x3f7873;}),_0x1956e2[_0x33d5b6(0x1e9)]((_0x4748bc,_0x22b16b)=>{var _0x16a684=_0x33d5b6;_0x4bdba4[_0x22b16b][_0x16a684(0x1a6)]=_0x4748bc;}),_0x1ab035[_0x33d5b6(0x1e9)]((_0x9f2b07,_0x4b328b)=>{var _0x551aa1=_0x33d5b6;_0x4bdba4[_0x4b328b][_0x551aa1(0x18d)]=_0x9f2b07;}),_0x9b7421[_0x33d5b6(0x1e9)]((_0xeb1d44,_0x19dc91)=>{var _0xb84e1b=_0x33d5b6;_0x4bdba4[_0x19dc91][_0xb84e1b(0x222)]=_0xeb1d44;}),_0x2ab6dc[_0x33d5b6(0x1e9)]((_0x1e3338,_0x1e6ff2)=>{var _0x45d2ee=_0x33d5b6;_0x4bdba4[_0x1e6ff2][_0x45d2ee(0x1fb)]=_0x1e3338;}),_0x1bc26c['forEach']((_0x23419e,_0x5cd6c6)=>{var _0x1abbe2=_0x33d5b6;_0x4bdba4[_0x5cd6c6][_0x1abbe2(0x184)]=_0x23419e;}),_0x162eea['forEach']((_0x31a818,_0x8f4eb9)=>{var _0x1591ff=_0x33d5b6;_0x4bdba4[_0x8f4eb9][_0x1591ff(0x185)]=_0x31a818;}),_0x1faa21[_0x33d5b6(0x1e9)]((_0x37adfd,_0x21e084)=>{_0x4bdba4[_0x21e084]['production_date']=_0x37adfd;}),_0x55f902[_0x33d5b6(0x1e9)]((_0x1a5150,_0xbb11d6)=>{var _0x5d806d=_0x33d5b6;_0x4bdba4[_0xbb11d6][_0x5d806d(0x21c)]=_0x1a5150;}),_0x3d6fd5[_0x33d5b6(0x1e9)]((_0x106856,_0x145f6c)=>{var _0xd7d8a1=_0x33d5b6;_0x4bdba4[_0x145f6c][_0xd7d8a1(0x174)]=_0x106856;}),_0x1a9728['forEach']((_0x1362e2,_0x5ebc96)=>{var _0x3019c7=_0x33d5b6;_0x4bdba4[_0x5ebc96][_0x3019c7(0x209)]=_0x1362e2;}),_0x1a907f['forEach']((_0x288ef4,_0x3d5c0d)=>{var _0x14c56f=_0x33d5b6;_0x4bdba4[_0x3d5c0d][_0x14c56f(0x172)]=_0x288ef4;});const _0x5e2592=_0x4bdba4[_0x33d5b6(0x1a9)](_0x5e8e01=>_0x5e8e01['adjust_qty']!=='0'&&_0x5e8e01[_0x33d5b6(0x1c7)]!=='');var _0x3a1a85=0x0;_0x5e2592['forEach'](_0x18afd6=>{var _0x3e6871=_0x33d5b6;console[_0x3e6871(0x196)]('foreach\x20newproduct',_0x18afd6),parseInt(_0x18afd6[_0x3e6871(0x1c7)])<=0x0&&_0x3a1a85++;});if(_0x3a1a85!=0x0)return _0x2e8ff3[_0x33d5b6(0x1c4)]('errors',_0x33d5b6(0x1f3)),_0x32f3cf['redirect']('back');const _0x24b13a=new invoice_for_adjustment();await _0x24b13a['save']();const _0x14c4df=new adjustment_finished({'warehouse_name':_0x4ee3ce,'date':_0x21740b,'product':_0x5e2592,'note':_0x32460b,'room':_0x242094,'invoice':_0x33d5b6(0x197)+_0x24b13a[_0x33d5b6(0x1f9)][_0x33d5b6(0x1c5)]()[_0x33d5b6(0x1c8)](0x8,'0'),'JO_number':_0x5b1f1a,'expiry_date':_0x4a004e,'PO_number':_0x48cd20,'RequestedBy':_0xe90628,'DateofRequest':_0x5079f4,'typeservices':_0x3f66ea,'destination':_0x3ca8d7,'deliverydate':_0x2c6320,'driver':_0x557f62,'plate':_0x294330,'van':_0x239c31,'DRSI':_0x40cb2f,'typevehicle':_0x355168,'TSU':_0x34723c,'TFU':_0x49ba26}),_0x524277=await _0x14c4df[_0x33d5b6(0x205)]();_0x2e8ff3[_0x33d5b6(0x1c4)]('success',_0x33d5b6(0x200)),_0x32f3cf[_0x33d5b6(0x1b1)](_0x33d5b6(0x1b6)+_0x524277[_0x33d5b6(0x1d4)]);}catch(_0xeadc67){console['log'](_0xeadc67),_0x32f3cf[_0x33d5b6(0x207)](0xc8)[_0x33d5b6(0x1aa)]({'message':_0xeadc67[_0x33d5b6(0x204)]});}}),router[a0_0x192a53(0x189)](a0_0x192a53(0x19a),auth,async(_0xfc4d83,_0xb6f8bf)=>{var _0x43a6bc=a0_0x192a53;try{const {username:_0x59dfc6,email:_0x459608,role:_0x21db3c}=_0xfc4d83['user'],_0x5b652b=_0xfc4d83[_0x43a6bc(0x182)],_0x311f68=await profile[_0x43a6bc(0x1e7)]({'email':_0x5b652b[_0x43a6bc(0x1a8)]}),_0xf04f4f=await master_shop['find']();let _0x1e4675;if(_0x5b652b[_0x43a6bc(0x1b7)]==_0x43a6bc(0x178)){const _0x59322e=await staff[_0x43a6bc(0x1e7)]({'email':_0x5b652b['email']});_0x1e4675=await warehouse[_0x43a6bc(0x1ce)]([{'$match':{'status':_0x43a6bc(0x17f),'name':_0x59322e[_0x43a6bc(0x1da)]}},{'$group':{'_id':_0x43a6bc(0x1b3),'name':{'$first':_0x43a6bc(0x1b3)}}}]);}else _0x1e4675=await warehouse['aggregate']([{'$match':{'status':_0x43a6bc(0x17f)}},{'$group':{'_id':_0x43a6bc(0x1b3),'name':{'$first':_0x43a6bc(0x1b3)}}}]);const _0x5394ac=await product[_0x43a6bc(0x170)](),_0x399b0d=await adjustment_finished[_0x43a6bc(0x170)](),_0x35aaea=_0x399b0d[_0x43a6bc(0x1cf)]+0x1,_0x367b9b='ADJF-'+_0x35aaea['toString']()[_0x43a6bc(0x1c8)](0x5,'0');var _0x42b2da=[_0x43a6bc(0x195),'Enclosed','Return\x20Rooms'];if(_0xf04f4f[0x0][_0x43a6bc(0x1ec)]==_0x43a6bc(0x1ed))var _0x3fc059=users[_0x43a6bc(0x1c1)];else{if(_0xf04f4f[0x0][_0x43a6bc(0x1ec)]==_0x43a6bc(0x1ee))var _0x3fc059=users[_0x43a6bc(0x1ee)];else{if(_0xf04f4f[0x0][_0x43a6bc(0x1ec)]=='German')var _0x3fc059=users[_0x43a6bc(0x212)];else{if(_0xf04f4f[0x0]['language']==_0x43a6bc(0x181))var _0x3fc059=users[_0x43a6bc(0x181)];else{if(_0xf04f4f[0x0]['language']==_0x43a6bc(0x1bd))var _0x3fc059=users[_0x43a6bc(0x1bd)];else{if(_0xf04f4f[0x0][_0x43a6bc(0x1ec)]==_0x43a6bc(0x187))var _0x3fc059=users['Portuguese'];else{if(_0xf04f4f[0x0][_0x43a6bc(0x1ec)]=='Chinese')var _0x3fc059=users['Chinese'];else{if(_0xf04f4f[0x0][_0x43a6bc(0x1ec)]=='Arabic\x20(ae)')var _0x3fc059=users[_0x43a6bc(0x18a)];}}}}}}}const _0xcd9aaf=getRandom8DigitNumber();_0xcd9aaf['then'](_0x1f2be3=>{var _0x2867db=_0x43a6bc;_0xb6f8bf[_0x2867db(0x1c6)](_0x2867db(0x18e),{'success':_0xfc4d83[_0x2867db(0x1c4)](_0x2867db(0x20f)),'errors':_0xfc4d83[_0x2867db(0x1c4)](_0x2867db(0x1cb)),'role':_0x5b652b,'profile':_0x311f68,'warehouse':_0x1e4675,'product':_0x5394ac,'master_shop':_0xf04f4f,'language':_0x3fc059,'rooms_data':_0x42b2da,'invoice_no':_0x1f2be3});})[_0x43a6bc(0x1a0)](_0x291cb2=>{var _0x31a6f2=_0x43a6bc;_0xfc4d83[_0x31a6f2(0x1c4)](_0x31a6f2(0x1cb),_0x31a6f2(0x18f)),_0xb6f8bf[_0x31a6f2(0x1b1)]('/adjustment/view');});}catch(_0x2f604e){console[_0x43a6bc(0x196)](_0x2f604e);}}),router[a0_0x192a53(0x1d2)](a0_0x192a53(0x19a),auth,async(_0x21b86c,_0x1f31d6)=>{var _0x657049=a0_0x192a53;try{const {warehouse_name:_0x63ca36,date:_0x1fc817,prod_name:_0x38f4c1,level:_0x5377d2,isle:_0x234af5,pallet:_0x2ea9b5,stock:_0x7231fd,types:_0x43ef0d,adjust_qty:_0x2d22b7,new_adjust_qty:_0x14d9be,note:_0x1ab579,Room_name:_0x114688,JO_number:_0xb2b02b,expiry_date:_0x2f4d11,type_of_transaction:_0x4463b9,PO_number:_0xace6a4,ReqBy:_0x5b6728,dateofreq:_0x2ac530,typeservicesData:_0x378759,destination:_0x404d3c,deliverydate:_0x17b3dc,driver:_0x2ca9fd,plate:_0x39b331,van:_0x45c716,DRSI:_0x5ae63f,typevehicle:_0x2b2b47,TSU:_0x5662f1,TFU:_0x199d32}=_0x21b86c[_0x657049(0x1e5)];if(typeof _0x38f4c1==_0x657049(0x171))var _0x30b09f=[_0x21b86c['body'][_0x657049(0x206)]],_0x39f1fb=[_0x21b86c[_0x657049(0x1e5)][_0x657049(0x208)]],_0x15e22d=[_0x21b86c[_0x657049(0x1e5)][_0x657049(0x1bf)]],_0x584fdd=[_0x21b86c['body'][_0x657049(0x183)]],_0xecc15e=[_0x21b86c['body'][_0x657049(0x1ca)]],_0x5a5b9b=[_0x21b86c['body'][_0x657049(0x1af)]],_0x2196ad=[_0x21b86c[_0x657049(0x1e5)]['Primary_Units']],_0x1c58e1=[_0x21b86c['body']['Secondary_units']],_0x158482=[_0x21b86c[_0x657049(0x1e5)][_0x657049(0x198)]],_0x7fcdce=[_0x21b86c[_0x657049(0x1e5)][_0x657049(0x184)]],_0x3a032c=[_0x21b86c['body'][_0x657049(0x185)]],_0x4bb977=[_0x21b86c[_0x657049(0x1e5)][_0x657049(0x1b5)]],_0xca44e=[_0x21b86c[_0x657049(0x1e5)][_0x657049(0x21c)]],_0x7f53ae=[_0x21b86c[_0x657049(0x1e5)][_0x657049(0x217)]],_0x1f8bb9=[_0x21b86c['body'][_0x657049(0x209)]],_0x2cc9c0=[_0x21b86c[_0x657049(0x1e5)][_0x657049(0x17e)]],_0x551bd4=[_0x21b86c[_0x657049(0x1e5)][_0x657049(0x21d)]];else var _0x30b09f=[..._0x21b86c[_0x657049(0x1e5)][_0x657049(0x206)]],_0x39f1fb=[..._0x21b86c[_0x657049(0x1e5)][_0x657049(0x208)]],_0x15e22d=[..._0x21b86c['body'][_0x657049(0x1bf)]],_0x584fdd=[..._0x21b86c[_0x657049(0x1e5)][_0x657049(0x183)]],_0xecc15e=[..._0x21b86c['body']['New_Qty_Converted_adj']],_0x5a5b9b=[..._0x21b86c[_0x657049(0x1e5)][_0x657049(0x1af)]],_0x2196ad=[..._0x21b86c['body'][_0x657049(0x20a)]],_0x1c58e1=[..._0x21b86c[_0x657049(0x1e5)][_0x657049(0x1a2)]],_0x158482=[..._0x21b86c['body'][_0x657049(0x198)]],_0x7fcdce=[..._0x21b86c['body'][_0x657049(0x184)]],_0x3a032c=[..._0x21b86c['body'][_0x657049(0x185)]],_0x4bb977=[..._0x21b86c[_0x657049(0x1e5)][_0x657049(0x1b5)]],_0xca44e=[..._0x21b86c['body'][_0x657049(0x21c)]],_0x7f53ae=[..._0x21b86c['body']['Rooms']],_0x1f8bb9=[..._0x21b86c[_0x657049(0x1e5)][_0x657049(0x209)]],_0x2cc9c0=[..._0x21b86c[_0x657049(0x1e5)]['prod_invoice']],_0x551bd4=[..._0x21b86c[_0x657049(0x1e5)][_0x657049(0x21d)]];const _0x470a76=_0x30b09f['map'](_0x563bab=>{return _0x563bab={'product_name':_0x563bab};});_0x39f1fb[_0x657049(0x1e9)]((_0x4e9ada,_0x4e6ba8)=>{var _0xaab2bc=_0x657049,_0x4ec4c5=_0x4e9ada[_0xaab2bc(0x194)](/[A-Za-z]+/)[0x0],_0x232bba=parseInt(_0x4e9ada[_0xaab2bc(0x194)](/\d+/)[0x0]);_0x470a76[_0x4e6ba8][_0xaab2bc(0x208)]=_0x4ec4c5,_0x470a76[_0x4e6ba8][_0xaab2bc(0x1d7)]=_0x232bba;}),_0x551bd4[_0x657049(0x1e9)]((_0x73fe1a,_0x4410cd)=>{var _0x20d24e=_0x657049;_0x470a76[_0x4410cd][_0x20d24e(0x21a)]=_0x73fe1a;}),_0x15e22d[_0x657049(0x1e9)]((_0x4ba86a,_0x11888b)=>{var _0x48b141=_0x657049;_0x470a76[_0x11888b][_0x48b141(0x1ff)]=_0x4ba86a;}),_0x584fdd['forEach']((_0x4f7f92,_0x547b06)=>{_0x470a76[_0x547b06]['types']=_0x4f7f92;}),_0xecc15e[_0x657049(0x1e9)]((_0xed6288,_0x2a7bef)=>{var _0x3c05a4=_0x657049;_0x470a76[_0x2a7bef][_0x3c05a4(0x1c7)]=_0xed6288;}),_0x5a5b9b[_0x657049(0x1e9)]((_0x5ca54a,_0x295a65)=>{var _0x4c7ace=_0x657049;_0x470a76[_0x295a65][_0x4c7ace(0x1a6)]=_0x5ca54a;}),_0x2196ad[_0x657049(0x1e9)]((_0x416069,_0xb4a1c4)=>{var _0x596c77=_0x657049;_0x470a76[_0xb4a1c4][_0x596c77(0x18d)]=_0x416069;}),_0x1c58e1[_0x657049(0x1e9)]((_0x4353b8,_0x1a6f0e)=>{var _0x1d2fc1=_0x657049;_0x470a76[_0x1a6f0e][_0x1d2fc1(0x222)]=_0x4353b8;}),_0x158482[_0x657049(0x1e9)]((_0x48bbf6,_0x4874e4)=>{var _0x201249=_0x657049;_0x470a76[_0x4874e4][_0x201249(0x1fb)]=_0x48bbf6;}),_0x7fcdce[_0x657049(0x1e9)]((_0x58bcfd,_0x4f7b91)=>{var _0x13fc37=_0x657049;_0x470a76[_0x4f7b91][_0x13fc37(0x184)]=_0x58bcfd;}),_0x3a032c[_0x657049(0x1e9)]((_0x4c2946,_0x515845)=>{var _0x5ef4f6=_0x657049;_0x470a76[_0x515845][_0x5ef4f6(0x185)]=_0x4c2946;}),_0x4bb977[_0x657049(0x1e9)]((_0x3fd5bc,_0x3ae8e8)=>{var _0x12ea7e=_0x657049;_0x470a76[_0x3ae8e8][_0x12ea7e(0x18b)]=_0x3fd5bc;}),_0xca44e[_0x657049(0x1e9)]((_0x4094be,_0xfb48b1)=>{var _0x1bc57d=_0x657049;_0x470a76[_0xfb48b1][_0x1bc57d(0x21c)]=_0x4094be;}),_0x7f53ae[_0x657049(0x1e9)]((_0x5a35c3,_0x1bca8b)=>{var _0x3f67f6=_0x657049;_0x470a76[_0x1bca8b][_0x3f67f6(0x174)]=_0x5a35c3;}),_0x1f8bb9[_0x657049(0x1e9)]((_0x50f2a7,_0x237622)=>{var _0xa44b28=_0x657049;_0x470a76[_0x237622][_0xa44b28(0x209)]=_0x50f2a7;}),_0x2cc9c0[_0x657049(0x1e9)]((_0x380cae,_0x1f312e)=>{_0x470a76[_0x1f312e]['invoice']=_0x380cae;});const _0x20e8d0=_0x470a76[_0x657049(0x1a9)](_0x33071b=>_0x33071b[_0x657049(0x1c7)]!=='0'&&_0x33071b['adjust_qty']!=='');var _0x359865=0x0;_0x20e8d0[_0x657049(0x1e9)](_0xe54a6=>{var _0x1020fc=_0x657049;console[_0x1020fc(0x196)](_0x1020fc(0x1f2),_0xe54a6),parseInt(_0xe54a6[_0x1020fc(0x1c7)])<=0x0&&_0x359865++;});if(_0x359865!=0x0)return _0x21b86c[_0x657049(0x1c4)](_0x657049(0x1cb),_0x657049(0x1f3)),_0x1f31d6[_0x657049(0x1b1)](_0x657049(0x19d));const _0x14d9f5=new adjustment_logs();await _0x14d9f5[_0x657049(0x205)]();const _0xd75f0b=new adjustment_finished({'warehouse_name':_0x63ca36,'date':_0x1fc817,'product':_0x20e8d0,'note':_0x1ab579,'room':_0x114688,'invoice':_0x657049(0x17c)+_0x14d9f5[_0x657049(0x1f9)][_0x657049(0x1c5)]()['padStart'](0x8,'0'),'JO_number':_0xb2b02b,'expiry_date':_0x2f4d11,'type_of_transaction':_0x4463b9,'PO_number':_0xace6a4,'RequestedBy':_0x5b6728,'DateofRequest':_0x2ac530,'typeservices':_0x378759,'destination':_0x404d3c,'deliverydate':_0x17b3dc,'driver':_0x2ca9fd,'plate':_0x39b331,'van':_0x45c716,'DRSI':_0x5ae63f,'typevehicle':_0x2b2b47,'TSU':_0x5662f1,'TFU':_0x199d32}),_0x20e7ad=await _0xd75f0b['save']();_0x21b86c['flash'](_0x657049(0x20f),_0x657049(0x200)),_0x1f31d6[_0x657049(0x1b1)](_0x657049(0x1b6)+_0x20e7ad['_id']);}catch(_0x27f3b8){console['log'](_0x27f3b8),_0x1f31d6[_0x657049(0x207)](0xc8)['json']({'message':_0x27f3b8[_0x657049(0x204)]});}}),router[a0_0x192a53(0x189)]('/preview/:id',auth,async(_0x416042,_0x470ff1)=>{var _0x565ff6=a0_0x192a53;try{const {username:_0x2964a2,email:_0x317d2d,role:_0x279484}=_0x416042[_0x565ff6(0x182)],_0x385eb7=_0x416042[_0x565ff6(0x182)],_0x5f425e=await profile['findOne']({'email':_0x385eb7[_0x565ff6(0x1a8)]}),_0x3ff406=await master_shop[_0x565ff6(0x170)](),_0xcb8ea0=_0x416042[_0x565ff6(0x1e2)]['id'],_0x4f0c85=await adjustment_finished[_0x565ff6(0x1c0)]({'_id':_0xcb8ea0}),_0x3cac4b=await purchases[_0x565ff6(0x1ce)]([{'$match':{'warehouse_name':_0x4f0c85['warehouse_name']}},{'$unwind':_0x565ff6(0x1f6)},{'$group':{'_id':'$product.product_name'}}]);console[_0x565ff6(0x196)](_0x565ff6(0x19e),_0x3cac4b);const _0xc6c40f=await product[_0x565ff6(0x170)]({}),_0x2a4f2c=await warehouse[_0x565ff6(0x1ce)]([{'$match':{'name':_0x4f0c85['warehouse_name']}},{'$unwind':_0x565ff6(0x213)},{'$group':{'_id':_0x565ff6(0x1cc),'name':{'$first':_0x565ff6(0x1be)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x565ff6(0x1df)},'bin':{'$first':_0x565ff6(0x199)},'type':{'$first':_0x565ff6(0x1d5)},'floorlevel':{'$first':_0x565ff6(0x1a1)},'primary_code':{'$first':_0x565ff6(0x1fe)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x565ff6(0x1de)},'storage':{'$first':_0x565ff6(0x201)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x565ff6(0x1a4)},'production_date':{'$first':_0x565ff6(0x1b8)},'batch_code':{'$first':_0x565ff6(0x1d0)},'maxPerUnit':{'$first':_0x565ff6(0x1d9)},'room':{'$first':_0x565ff6(0x179)}}}]);if(_0x3ff406[0x0][_0x565ff6(0x1ec)]=='English\x20(US)'){var _0x4ae2d4=users[_0x565ff6(0x1c1)];console[_0x565ff6(0x196)](_0x4ae2d4);}else{if(_0x3ff406[0x0][_0x565ff6(0x1ec)]==_0x565ff6(0x1ee))var _0x4ae2d4=users[_0x565ff6(0x1ee)];else{if(_0x3ff406[0x0][_0x565ff6(0x1ec)]==_0x565ff6(0x212))var _0x4ae2d4=users['German'];else{if(_0x3ff406[0x0]['language']==_0x565ff6(0x181))var _0x4ae2d4=users[_0x565ff6(0x181)];else{if(_0x3ff406[0x0][_0x565ff6(0x1ec)]==_0x565ff6(0x1bd))var _0x4ae2d4=users[_0x565ff6(0x1bd)];else{if(_0x3ff406[0x0][_0x565ff6(0x1ec)]==_0x565ff6(0x187))var _0x4ae2d4=users['Portuguese'];else{if(_0x3ff406[0x0][_0x565ff6(0x1ec)]==_0x565ff6(0x219))var _0x4ae2d4=users[_0x565ff6(0x219)];else{if(_0x3ff406[0x0][_0x565ff6(0x1ec)]==_0x565ff6(0x1ea))var _0x4ae2d4=users[_0x565ff6(0x18a)];}}}}}}}_0x470ff1[_0x565ff6(0x1c6)](_0x565ff6(0x1b2),{'success':_0x416042[_0x565ff6(0x1c4)]('success'),'errors':_0x416042['flash'](_0x565ff6(0x1cb)),'role':_0x385eb7,'profile':_0x5f425e,'adjustment':_0x4f0c85,'stock':_0x2a4f2c,'master_shop':_0x3ff406,'warehouse_name':_0x3cac4b,'unit':_0xc6c40f,'language':_0x4ae2d4});}catch(_0x54409a){console[_0x565ff6(0x196)](_0x54409a),_0x470ff1[_0x565ff6(0x207)](0xc8)[_0x565ff6(0x1aa)]({'message':_0x54409a[_0x565ff6(0x204)]});}}),router['post']('/preview/:id',auth,async(_0xad6b76,_0x4aafd5)=>{var _0x4996cc=a0_0x192a53;try{const {invoice:_0x22e709,warehouse_name:_0x1b6146,Room_name:_0x2f5bce}=_0xad6b76[_0x4996cc(0x1e5)],_0x1455dd=_0xad6b76[_0x4996cc(0x1e2)]['id'],_0x30244c=await adjustment_finished['findById']({'_id':_0x1455dd});var _0x4a04cf;const _0xba0733=_0x30244c[_0x4996cc(0x1c2)]['map'](async _0x386a6b=>{var _0x2eb7f8=_0x4996cc;if(_0x386a6b[_0x2eb7f8(0x1c7)]>0x0){_0x4a04cf=await warehouse['findOne']({'name':_0x1b6146,'room':_0x386a6b[_0x2eb7f8(0x174)]});const _0x348cac=_0x4a04cf[_0x2eb7f8(0x1ad)][_0x2eb7f8(0x19b)](_0x55ea0c=>{var _0x54bdb6=_0x2eb7f8;console[_0x54bdb6(0x196)](_0x386a6b[_0x54bdb6(0x183)]);if(_0x386a6b['types']==_0x54bdb6(0x17d))_0x55ea0c['_id']==_0x386a6b[_0x54bdb6(0x21a)]&&(_0x55ea0c[_0x54bdb6(0x1cd)]=_0x55ea0c[_0x54bdb6(0x1cd)]-_0x386a6b[_0x54bdb6(0x1c7)]);else _0x386a6b[_0x54bdb6(0x183)]=='add'&&(_0x55ea0c[_0x54bdb6(0x1d4)]==_0x386a6b[_0x54bdb6(0x21a)]&&(_0x55ea0c[_0x54bdb6(0x1cd)]=_0x55ea0c[_0x54bdb6(0x1cd)]+_0x386a6b[_0x54bdb6(0x1c7)]));});}return _0x4a04cf;});Promise['all'](_0xba0733)['then'](async _0x263705=>{var _0x4f05ad=_0x4996cc;try{for(const _0x487899 of _0x263705){await _0x487899[_0x4f05ad(0x205)]();}_0x30244c[_0x4f05ad(0x1db)]=_0x4f05ad(0x1f5);const _0x49c664=await _0x30244c[_0x4f05ad(0x205)](),_0x4add55=await master_shop[_0x4f05ad(0x170)](),_0x489f08=await email_settings[_0x4f05ad(0x1e7)](),_0x2f2897=await supervisor_settings[_0x4f05ad(0x170)]();var _0xde3f20=_0x30244c['product'],_0x460303='',_0x5ac14c;for(_0x5ac14c in _0xde3f20){var _0xa23b88='FG';_0x30244c['warehouse_name']==_0x4f05ad(0x1ac)&&(_0xa23b88='DG'),_0x460303+=_0x4f05ad(0x19f)+_0x4f05ad(0x1e8)+_0xde3f20[_0x5ac14c][_0x4f05ad(0x20d)]+_0x4f05ad(0x220)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xde3f20[_0x5ac14c]['product_code']+_0x4f05ad(0x220)+_0x4f05ad(0x1e8)+_0xde3f20[_0x5ac14c][_0x4f05ad(0x1c7)]+_0x4f05ad(0x220)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xde3f20[_0x5ac14c][_0x4f05ad(0x18d)]+_0x4f05ad(0x220)+_0x4f05ad(0x1e8)+_0xde3f20[_0x5ac14c][_0x4f05ad(0x222)]+_0x4f05ad(0x220)+_0x4f05ad(0x1e8)+_0x30244c[_0x4f05ad(0x21b)]+_0x4f05ad(0x220)+_0x4f05ad(0x1e8)+_0xde3f20[_0x5ac14c][_0x4f05ad(0x174)]+_0x4f05ad(0x220)+_0x4f05ad(0x1e8)+_0xa23b88+_0xde3f20[_0x5ac14c]['bay']+_0x4f05ad(0x220)+_0x4f05ad(0x1b9);}_0xad6b76[_0x4f05ad(0x1c4)](_0x4f05ad(0x20f),_0x4f05ad(0x1e0)),_0x4aafd5[_0x4f05ad(0x1b1)](_0x4f05ad(0x202)+_0x49c664[_0x4f05ad(0x1d4)]);}catch(_0x52b5df){console[_0x4f05ad(0x1dd)](_0x52b5df),_0x4aafd5[_0x4f05ad(0x207)](0x1f4)[_0x4f05ad(0x1aa)]({'error':_0x4f05ad(0x1e6)});}})[_0x4996cc(0x1a0)](_0xa97c36=>{var _0x2dbe3f=_0x4996cc;console[_0x2dbe3f(0x1dd)](_0xa97c36),_0x4aafd5['status'](0x1f4)[_0x2dbe3f(0x1aa)]({'error':'An\x20error\x20occurred.'});});}catch(_0x2b6883){_0x4aafd5[_0x4996cc(0x1aa)]({'message':_0x2b6883['message']});}}),router[a0_0x192a53(0x189)](a0_0x192a53(0x177),auth,async(_0x1ddb4e,_0x5efe59)=>{var _0x2ce91e=a0_0x192a53;try{const {username:_0x5856d7,email:_0x7edd4f,role:_0x117f29}=_0x1ddb4e[_0x2ce91e(0x182)],_0x127ed2=_0x1ddb4e[_0x2ce91e(0x182)],_0x17a88b=await profile['findOne']({'email':_0x127ed2[_0x2ce91e(0x1a8)]}),_0x31b13a=await master_shop[_0x2ce91e(0x170)]();console[_0x2ce91e(0x196)](_0x2ce91e(0x17a),_0x31b13a);const _0x32e14b=_0x1ddb4e[_0x2ce91e(0x1e2)]['id'],_0x35b258=await adjustment_finished['findById']({'_id':_0x32e14b});let _0x4ae9ce=new Date(_0x35b258[_0x2ce91e(0x185)]),_0x4fbef9=('0'+_0x4ae9ce['getDate']())[_0x2ce91e(0x1dc)](-0x2),_0x28bf1c=('0'+(_0x4ae9ce[_0x2ce91e(0x1a3)]()+0x1))[_0x2ce91e(0x1dc)](-0x2),_0x5aa67e=_0x4ae9ce[_0x2ce91e(0x1d3)](),_0x1698ab=_0x5aa67e+'-'+_0x28bf1c+'-'+_0x4fbef9;var _0x3f6a28=['Ambient',_0x2ce91e(0x1d6),_0x2ce91e(0x1bc)];const _0x2b32fb=await purchases[_0x2ce91e(0x1ce)]([{'$match':{'warehouse_name':_0x35b258['warehouse_name']}},{'$unwind':_0x2ce91e(0x1f6)},{'$group':{'_id':_0x2ce91e(0x1a5)}}]);console['log'](_0x2ce91e(0x19e),_0x2b32fb);const _0x25766e=await product[_0x2ce91e(0x170)]({}),_0x486e00=await warehouse[_0x2ce91e(0x1ce)]([{'$match':{'name':_0x35b258[_0x2ce91e(0x21b)],'room':_0x35b258[_0x2ce91e(0x180)]}},{'$unwind':_0x2ce91e(0x213)},{'$group':{'_id':_0x2ce91e(0x1cc),'name':{'$first':_0x2ce91e(0x1be)},'product_stock':{'$first':_0x2ce91e(0x1f1)},'bay':{'$first':_0x2ce91e(0x1df)},'bin':{'$first':_0x2ce91e(0x199)},'type':{'$first':_0x2ce91e(0x1d5)},'floorlevel':{'$first':_0x2ce91e(0x1a1)},'primary_code':{'$first':_0x2ce91e(0x1fe)},'secondary_code':{'$first':_0x2ce91e(0x1fa)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2ce91e(0x216)}}}]);if(_0x31b13a[0x0]['language']==_0x2ce91e(0x1ed)){var _0x1bdb51=users[_0x2ce91e(0x1c1)];console[_0x2ce91e(0x196)](_0x1bdb51);}else{if(_0x31b13a[0x0]['language']==_0x2ce91e(0x1ee))var _0x1bdb51=users[_0x2ce91e(0x1ee)];else{if(_0x31b13a[0x0][_0x2ce91e(0x1ec)]==_0x2ce91e(0x212))var _0x1bdb51=users[_0x2ce91e(0x212)];else{if(_0x31b13a[0x0][_0x2ce91e(0x1ec)]==_0x2ce91e(0x181))var _0x1bdb51=users['Spanish'];else{if(_0x31b13a[0x0][_0x2ce91e(0x1ec)]==_0x2ce91e(0x1bd))var _0x1bdb51=users[_0x2ce91e(0x1bd)];else{if(_0x31b13a[0x0][_0x2ce91e(0x1ec)]=='Portuguese\x20(BR)')var _0x1bdb51=users[_0x2ce91e(0x1b0)];else{if(_0x31b13a[0x0][_0x2ce91e(0x1ec)]==_0x2ce91e(0x219))var _0x1bdb51=users[_0x2ce91e(0x219)];else{if(_0x31b13a[0x0][_0x2ce91e(0x1ec)]==_0x2ce91e(0x1ea))var _0x1bdb51=users[_0x2ce91e(0x18a)];}}}}}}}_0x5efe59[_0x2ce91e(0x1c6)](_0x2ce91e(0x19c),{'success':_0x1ddb4e[_0x2ce91e(0x1c4)]('success'),'errors':_0x1ddb4e[_0x2ce91e(0x1c4)](_0x2ce91e(0x1cb)),'role':_0x127ed2,'profile':_0x17a88b,'adjustment':_0x35b258,'stock':_0x486e00,'master_shop':_0x31b13a,'warehouse_name':_0x2b32fb,'unit':_0x25766e,'language':_0x1bdb51,'rooms_data':_0x3f6a28,'ed_fullDate':_0x1698ab});}catch(_0x3a525b){console['log'](_0x3a525b),_0x5efe59[_0x2ce91e(0x207)](0xc8)[_0x2ce91e(0x1aa)]({'message':_0x3a525b['message']});}}),router[a0_0x192a53(0x1d2)](a0_0x192a53(0x177),auth,async(_0xb3eaaa,_0x361237)=>{var _0x9ec1aa=a0_0x192a53;try{const _0x1a4dd0=_0xb3eaaa[_0x9ec1aa(0x1e2)]['id'],_0x2b5063=await adjustment_finished[_0x9ec1aa(0x1c0)]({'_id':_0x1a4dd0}),_0x2053a0=await warehouse[_0x9ec1aa(0x1e7)]({'name':_0x2b5063[_0x9ec1aa(0x21b)],'room':_0x2b5063['room']}),{warehouse_name:_0x3226e0,date:_0x508000,prod_name:_0xcf955,level:_0x416ea1,isle:_0x56fadc,pallet:_0x557452,stock:_0xa108e3,types:_0x5d9b67,adjust_qty:_0x4e2c42,new_adjust_qty:_0x472e46,note:_0x263edd,Room_name:_0x301903,invoice:_0x2cc689,JO_number:_0x520bf5}=_0xb3eaaa[_0x9ec1aa(0x1e5)];if(typeof _0xcf955=='string')var _0x2e2e95=[_0xb3eaaa['body'][_0x9ec1aa(0x206)]],_0x55e6a8=[_0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x208)]],_0x4a31d0=[_0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x1bf)]],_0x25ebda=[_0xb3eaaa[_0x9ec1aa(0x1e5)]['types']],_0x25507a=[_0xb3eaaa['body'][_0x9ec1aa(0x1c7)]],_0x54752b=[_0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x1a6)]],_0x26fbf5=[_0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x198)]],_0x5eac00=[_0xb3eaaa['body']['unit']],_0x5d9dc5=[_0xb3eaaa[_0x9ec1aa(0x1e5)]['Secondary_units']],_0x14d2ed=[_0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x184)]],_0x3b76b5=[_0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x185)]];else var _0x2e2e95=[..._0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x206)]],_0x55e6a8=[..._0xb3eaaa['body'][_0x9ec1aa(0x208)]],_0x4a31d0=[..._0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x1bf)]],_0x25ebda=[..._0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x183)]],_0x25507a=[..._0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x1c7)]],_0x54752b=[..._0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x1a6)]],_0x26fbf5=[..._0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x198)]],_0x5eac00=[..._0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x18d)]],_0x5d9dc5=[..._0xb3eaaa[_0x9ec1aa(0x1e5)]['Secondary_units']],_0x14d2ed=[..._0xb3eaaa[_0x9ec1aa(0x1e5)][_0x9ec1aa(0x184)]],_0x3b76b5=[..._0xb3eaaa[_0x9ec1aa(0x1e5)]['expiry_date']];const _0x381d26=_0x2e2e95['map'](_0x4f53a9=>{return _0x4f53a9={'product_name':_0x4f53a9};});_0x55e6a8['forEach']((_0x21f3f9,_0x3ff1a8)=>{var _0x2c02c8=_0x9ec1aa;_0x381d26[_0x3ff1a8][_0x2c02c8(0x1d7)]=_0x21f3f9;}),_0x4a31d0[_0x9ec1aa(0x1e9)]((_0x147b48,_0x4ff3a1)=>{var _0x2caa44=_0x9ec1aa;_0x381d26[_0x4ff3a1][_0x2caa44(0x1ff)]=_0x147b48;}),_0x25ebda[_0x9ec1aa(0x1e9)]((_0x27c288,_0x2574a0)=>{var _0x4ac728=_0x9ec1aa;_0x381d26[_0x2574a0][_0x4ac728(0x183)]=_0x27c288;}),_0x25507a[_0x9ec1aa(0x1e9)]((_0x1e8746,_0x155214)=>{var _0x44ef51=_0x9ec1aa;_0x381d26[_0x155214][_0x44ef51(0x1c7)]=_0x1e8746;}),_0x54752b[_0x9ec1aa(0x1e9)]((_0x4bde58,_0x4b4f0a)=>{_0x381d26[_0x4b4f0a]['new_adjust_qty']=_0x4bde58;}),_0x5eac00[_0x9ec1aa(0x1e9)]((_0x5b65a3,_0x580f83)=>{var _0x327997=_0x9ec1aa;_0x381d26[_0x580f83][_0x327997(0x18d)]=_0x5b65a3;}),_0x5d9dc5[_0x9ec1aa(0x1e9)]((_0x1e9e05,_0x41d5ee)=>{var _0x1e62e1=_0x9ec1aa;_0x381d26[_0x41d5ee][_0x1e62e1(0x222)]=_0x1e9e05;}),_0x26fbf5[_0x9ec1aa(0x1e9)]((_0x56376a,_0x455d1e)=>{_0x381d26[_0x455d1e]['product_code']=_0x56376a;}),_0x14d2ed[_0x9ec1aa(0x1e9)]((_0x3b25c3,_0x2b1335)=>{var _0x2925c9=_0x9ec1aa;_0x381d26[_0x2b1335][_0x2925c9(0x184)]=_0x3b25c3;}),_0x3b76b5[_0x9ec1aa(0x1e9)]((_0x2f26a9,_0x5bc729)=>{var _0x2ae31c=_0x9ec1aa;_0x381d26[_0x5bc729][_0x2ae31c(0x185)]=_0x2f26a9;});const _0x4c702d=_0x381d26[_0x9ec1aa(0x1a9)](_0x220c45=>_0x220c45[_0x9ec1aa(0x1c7)]!=='0'&&_0x220c45[_0x9ec1aa(0x1c7)]!=='');var _0x5afd56=0x0;_0x4c702d[_0x9ec1aa(0x1e9)](_0x30da6d=>{var _0x25475d=_0x9ec1aa;console[_0x25475d(0x196)]('foreach\x20newproduct',_0x30da6d),parseInt(_0x30da6d[_0x25475d(0x1c7)])<=0x0&&_0x5afd56++;});if(_0x5afd56!=0x0)return _0xb3eaaa[_0x9ec1aa(0x1c4)]('errors',_0x9ec1aa(0x1f3)),_0x361237['redirect'](_0x9ec1aa(0x19d));_0x2b5063[_0x9ec1aa(0x21b)]=_0x3226e0,_0x2b5063[_0x9ec1aa(0x223)]=_0x508000,_0x2b5063[_0x9ec1aa(0x1c2)]=_0x4c702d,_0x2b5063[_0x9ec1aa(0x203)]=_0x263edd,_0x2b5063['room']=_0x301903,_0x2b5063[_0x9ec1aa(0x172)]=_0x2cc689,_0x2b5063[_0x9ec1aa(0x210)]=_0x520bf5;const _0x446322=await _0x2b5063[_0x9ec1aa(0x205)](),_0x105294=await warehouse[_0x9ec1aa(0x1e7)]({'name':_0x3226e0,'room':_0x301903});_0x446322[_0x9ec1aa(0x1c2)][_0x9ec1aa(0x1e9)](_0x331c18=>{var _0x31d2ae=_0x9ec1aa;const _0x13640d=_0x105294[_0x31d2ae(0x1ad)][_0x31d2ae(0x19b)](_0x326edb=>{var _0x258eeb=_0x31d2ae;_0x331c18[_0x258eeb(0x183)]=='minus'?_0x326edb[_0x258eeb(0x20d)]==_0x331c18[_0x258eeb(0x20d)]&&_0x326edb['bay']==_0x331c18[_0x258eeb(0x1d7)]&&(_0x326edb[_0x258eeb(0x1cd)]=parseInt(_0x326edb['product_stock'])-parseInt(_0x331c18['adjust_qty'])):_0x326edb[_0x258eeb(0x20d)]==_0x331c18[_0x258eeb(0x20d)]&&_0x326edb[_0x258eeb(0x1d7)]==_0x331c18[_0x258eeb(0x1d7)]&&(_0x326edb['product_stock']=parseInt(_0x326edb[_0x258eeb(0x1cd)])+parseInt(_0x331c18[_0x258eeb(0x1c7)]));});}),await _0x105294[_0x9ec1aa(0x205)](),_0xb3eaaa[_0x9ec1aa(0x1c4)](_0x9ec1aa(0x20f),'adjustment\x20data\x20update\x20successfully'),_0x361237[_0x9ec1aa(0x1b1)](_0x9ec1aa(0x1f0));}catch(_0x4984c5){console[_0x9ec1aa(0x196)](_0x4984c5);}}),router['post']('/barcode_scanner',async(_0x541cb7,_0x27be45)=>{var _0x1a75b4=a0_0x192a53;const {primary_code:_0x44295b,warehouse_data:_0x54aca7,rooms_data:_0x14efbb,Roomslist:_0x32be01}=_0x541cb7[_0x1a75b4(0x1e5)],_0x2a9866=_0x32be01[_0x1a75b4(0x211)](','),_0x26b721=[];async function _0x4f1ae7(_0x5dd326){var _0x5a0412=_0x1a75b4;const _0x292eaf=await warehouse[_0x5a0412(0x1ce)]([{'$match':{'name':_0x54aca7,'room':_0x5dd326}},{'$unwind':_0x5a0412(0x213)},{'$match':{'product_details.primary_code':_0x44295b}},{'$group':{'_id':_0x5a0412(0x1cc),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5a0412(0x1de)},'level':{'$first':_0x5a0412(0x1ae)},'bay':{'$first':_0x5a0412(0x1df)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5a0412(0x215)},'secondary_unit':{'$first':_0x5a0412(0x1f7)},'storage':{'$first':_0x5a0412(0x201)},'rack':{'$first':_0x5a0412(0x216)},'expiry_date':{'$first':_0x5a0412(0x1a4)},'production_date':{'$first':_0x5a0412(0x1b8)},'batch_code':{'$first':_0x5a0412(0x1d0)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x5a0412(0x192)}}}]),_0x237f6c=await warehouse[_0x5a0412(0x1ce)]([{'$match':{'name':_0x54aca7,'room':_0x5dd326}},{'$unwind':_0x5a0412(0x213)},{'$match':{'product_details.secondary_code':_0x44295b}},{'$group':{'_id':_0x5a0412(0x1cc),'name':{'$first':_0x5a0412(0x1be)},'product_stock':{'$first':_0x5a0412(0x1f1)},'primary_code':{'$first':_0x5a0412(0x1fe)},'secondary_code':{'$first':_0x5a0412(0x1fa)},'product_code':{'$first':_0x5a0412(0x1de)},'level':{'$first':_0x5a0412(0x1ae)},'bay':{'$first':_0x5a0412(0x1df)},'type':{'$first':_0x5a0412(0x1d5)},'pallet':{'$first':_0x5a0412(0x1a1)},'unit':{'$first':_0x5a0412(0x215)},'secondary_unit':{'$first':_0x5a0412(0x1f7)},'storage':{'$first':_0x5a0412(0x201)},'rack':{'$first':_0x5a0412(0x216)},'expiry_date':{'$first':_0x5a0412(0x1a4)},'production_date':{'$first':_0x5a0412(0x1b8)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x5a0412(0x179)},'invoice':{'$first':_0x5a0412(0x192)}}}]);if(_0x292eaf['length']>0x0)_0x26b721['push'](_0x292eaf);else _0x237f6c[_0x5a0412(0x1cf)]>0x0&&_0x26b721[_0x5a0412(0x1b4)](_0x237f6c);}const _0x345d2c=_0x2a9866[_0x1a75b4(0x19b)](_0x87101f=>_0x4f1ae7(_0x87101f));await Promise[_0x1a75b4(0x1d8)](_0x345d2c),_0x27be45[_0x1a75b4(0x1aa)](_0x26b721);}),router[a0_0x192a53(0x1d2)](a0_0x192a53(0x1e3),async(_0x5a9dc4,_0x492085)=>{var _0x4a004d=a0_0x192a53;const {productCode:_0x171319,bay:_0x2f43b5,warehouses:_0x4dc36f,room:_0x36399d}=_0x5a9dc4['body'];console[_0x4a004d(0x196)](_0x5a9dc4[_0x4a004d(0x1e5)]);try{const _0x4abf9e=await warehouse[_0x4a004d(0x1ce)]([{'$match':{'name':_0x4dc36f,'room':_0x36399d}},{'$unwind':_0x4a004d(0x213)},{'$match':{'product_details.bay':parseInt(_0x2f43b5)}},{'$group':{'_id':_0x4a004d(0x1cc),'name':{'$first':_0x4a004d(0x1be)},'product_stock':{'$first':_0x4a004d(0x1f1)},'bay':{'$first':_0x4a004d(0x1df)},'maxProducts':{'$first':_0x4a004d(0x1e4)}}}]);_0x492085[_0x4a004d(0x207)](0xc8)['json'](_0x4abf9e);}catch(_0x536d70){_0x492085[_0x4a004d(0x207)](0x194)[_0x4a004d(0x1aa)]({'message':_0x536d70[_0x4a004d(0x204)]});}}),module[a0_0x192a53(0x193)]=router;