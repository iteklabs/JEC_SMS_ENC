function a0_0x1ba6(){var _0x3b394d=['$product_details.product_name','status','/view','3633570lejDRD','post','role','../models/all_models','$product_details.invoice','purchases_data','/preview/:id','findById','edit_adjustment_finished_view','436443IysMuD','$invoice','invoice_init','An\x20error\x20occurred\x20while\x20saving\x20data.','6lCGpiQ','error','There\x27s\x20a\x20error\x20in\x20this\x20transaction','product_name','$product.room_names','$product_details.bay','level','all','slice','$product_details.primary_code','<tr>','12AaZjPp','Primary_Units','../public/language/languages.json','An\x20error\x20occurred.','Return\x20Rooms','$product_details.unit','$product_details.floorlevel','/view/add_adjustment_logs','</td>','True','Arabic','room','English','warehouse','$product','id_transaction','Arabic\x20(ae)','9fIeTew','$room','stock','</tr>','$product_details.level','prod_name','user','prod_code','find','$product_details','$product_details.maxPerUnit','catch','edit_adjustment_finished','room_names','language','/view/:id','76577jkjDAx','_id','$product_details.type','prod_cat','$product_details.bin','Portuguese\x20(BR)','French','adjustment\x20data\x20update\x20successfully','/view/add_adjustment','2825911SQLBBk','$product_details.rack','$name','invoice','ADJF-','then','expiry_date','warehouse_name','$product_details.secondary_code','New_Qty_Converted_adj','Router','push','master','body','Enabled','$product_details._id','German','$finalize','random','floor','Ambient','length','/adjustment_finished/view','finalize','ADJ-','Secondary_units','types','product_details','map','date','English\x20(US)','findOne','add_adjustment_finished_logs','$_id','product','save','Spanish','json','../middleware/auth','match','2717800Bxmzme','adjust_qty','$date','/picking_list/PDF_adjustmentFinal/','$product_details.storage','/adjustment/view','maxPerUnit','$product_details.product_code','4MJZtDV','id_transaction_from','2001280RGhVQn','product_date','adjustment\x20add\x20successfull','$product_details.expiry_date','aggregate','add','new_adjust_qty','$product_details.batch_code','back','padStart','success','prod_invoice','$product.product_name','$product_details.production_date','add_adjustment_finished','stockBefore','render','/barcode_scanner','logs','get','batch_code','flash','$product_details.secondary_unit','foreach\x20newproduct','minus','252273UqzdZt','own','production_date','18CdvTEo','toString','Enclosed','split','$warehouse_name','email','filter','secondary_unit','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','staff','/adjustment_finished/preview/','Chinese','Hindi','Portuguese','nodemailer','product_stock','log','$product_details.product_stock','$product_details.maxProducts','exports','params','New_Qty_Converted','message','string','errors','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_code','Adjustment\x20Finalize\x20Successfully','bay','redirect','unit','Rooms','forEach'];a0_0x1ba6=function(){return _0x3b394d;};return a0_0x1ba6();}var a0_0xfa02de=a0_0x5df3;(function(_0x111455,_0x5c04e0){var _0x4ab36b=a0_0x5df3,_0x24a183=_0x111455();while(!![]){try{var _0x426fe2=parseInt(_0x4ab36b(0x194))/0x1*(parseInt(_0x4ab36b(0x168))/0x2)+-parseInt(_0x4ab36b(0x164))/0x3*(-parseInt(_0x4ab36b(0x1cd))/0x4)+parseInt(_0x4ab36b(0x1cf))/0x5+-parseInt(_0x4ab36b(0x1eb))/0x6*(parseInt(_0x4ab36b(0x1e8))/0x7)+-parseInt(_0x4ab36b(0x1c5))/0x8+parseInt(_0x4ab36b(0x184))/0x9*(-parseInt(_0x4ab36b(0x20f))/0xa)+-parseInt(_0x4ab36b(0x19d))/0xb*(-parseInt(_0x4ab36b(0x173))/0xc);if(_0x426fe2===_0x5c04e0)break;else _0x24a183['push'](_0x24a183['shift']());}catch(_0x2b44a0){_0x24a183['push'](_0x24a183['shift']());}}}(a0_0x1ba6,0x35ff2));const express=require('express'),app=express(),router=express[a0_0xfa02de(0x1a7)](),auth=require(a0_0xfa02de(0x1c3)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_logs,adjustment_finished,email_settings,supervisor_settings,invoice_for_adjustment}=require(a0_0xfa02de(0x15e)),users=require(a0_0xfa02de(0x175)),nodemailer=require(a0_0xfa02de(0x1f9));function a0_0x5df3(_0xa7267b,_0xf96c7a){var _0x1ba68f=a0_0x1ba6();return a0_0x5df3=function(_0x5df31b,_0x155800){_0x5df31b=_0x5df31b-0x15c;var _0x9353b=_0x1ba68f[_0x5df31b];return _0x9353b;},a0_0x5df3(_0xa7267b,_0xf96c7a);}router[a0_0xfa02de(0x1e2)](a0_0xfa02de(0x20e),auth,async(_0x521409,_0x2b25c3)=>{var _0x596313=a0_0xfa02de;try{const {username:_0xc6ff91,email:_0x25af85,role:_0x27e978}=_0x521409[_0x596313(0x18a)],_0x25a3f6=_0x521409[_0x596313(0x18a)],_0x4bc00b=await profile[_0x596313(0x1bc)]({'email':_0x25a3f6[_0x596313(0x1f0)]}),_0x42df48=await master_shop[_0x596313(0x18c)]();let _0x3f4a02;if(_0x25a3f6[_0x596313(0x15d)]==_0x596313(0x1f4)){const _0xcc866b=await staff['findOne']({'email':_0x25a3f6[_0x596313(0x1f0)]});_0x3f4a02=await warehouse[_0x596313(0x18c)]({'status':'Enabled','name':_0xcc866b[_0x596313(0x180)]});}else _0x3f4a02=await warehouse[_0x596313(0x18c)]({'status':_0x596313(0x1ab)});const _0x14736b=await product[_0x596313(0x18c)]();let _0x28e307;if(_0x25a3f6[_0x596313(0x15d)]==_0x596313(0x1f4)){const _0x46a342=await staff['findOne']({'email':_0x25a3f6['email']});_0x28e307=await adjustment_finished[_0x596313(0x18c)]({'warehouse_name':_0x46a342[_0x596313(0x180)]});}else _0x28e307=await adjustment_finished[_0x596313(0x1d3)]([{'$match':{'type_of_transaction':_0x596313(0x1e9)}},{'$unwind':_0x596313(0x181)},{'$group':{'_id':_0x596313(0x1be),'invoice':{'$first':'$invoice'},'date':{'$first':_0x596313(0x1c7)},'warehouse_name':{'$first':_0x596313(0x1ef)},'room':{'$addToSet':_0x596313(0x16c)},'finalize':{'$first':_0x596313(0x1ae)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x42df48[0x0][_0x596313(0x192)]==_0x596313(0x1bb)){var _0x40da08=users['English'];console['log'](_0x40da08);}else{if(_0x42df48[0x0][_0x596313(0x192)]==_0x596313(0x1f7))var _0x40da08=users[_0x596313(0x1f7)];else{if(_0x42df48[0x0][_0x596313(0x192)]==_0x596313(0x1ad))var _0x40da08=users['German'];else{if(_0x42df48[0x0][_0x596313(0x192)]==_0x596313(0x1c1))var _0x40da08=users[_0x596313(0x1c1)];else{if(_0x42df48[0x0]['language']=='French')var _0x40da08=users['French'];else{if(_0x42df48[0x0][_0x596313(0x192)]==_0x596313(0x199))var _0x40da08=users[_0x596313(0x1f8)];else{if(_0x42df48[0x0]['language']==_0x596313(0x1f6))var _0x40da08=users[_0x596313(0x1f6)];else{if(_0x42df48[0x0]['language']==_0x596313(0x183))var _0x40da08=users[_0x596313(0x17d)];}}}}}}}_0x2b25c3['render']('adjustment_finished',{'success':_0x521409[_0x596313(0x1e4)](_0x596313(0x1d9)),'errors':_0x521409[_0x596313(0x1e4)](_0x596313(0x203)),'role':_0x25a3f6,'profile':_0x4bc00b,'warehouse':_0x3f4a02,'product':_0x14736b,'adjustment':_0x28e307,'master_shop':_0x42df48,'language':_0x40da08});}catch(_0x4825c8){console[_0x596313(0x1fb)](_0x4825c8);}}),router[a0_0xfa02de(0x1e2)]('/view_logs',auth,async(_0x5c2b88,_0x52f6b2)=>{var _0x235ebc=a0_0xfa02de;try{const {username:_0x3c4b40,email:_0x3aa996,role:_0x3ccbcc}=_0x5c2b88[_0x235ebc(0x18a)],_0x29986a=_0x5c2b88[_0x235ebc(0x18a)],_0x48d506=await profile['findOne']({'email':_0x29986a[_0x235ebc(0x1f0)]}),_0x165a93=await master_shop['find']();let _0x7f0d22;if(_0x29986a['role']==_0x235ebc(0x1f4)){const _0x4392d5=await staff[_0x235ebc(0x1bc)]({'email':_0x29986a[_0x235ebc(0x1f0)]});_0x7f0d22=await warehouse['find']({'status':'Enabled','name':_0x4392d5[_0x235ebc(0x180)]});}else _0x7f0d22=await warehouse[_0x235ebc(0x18c)]({'status':'Enabled'});const _0x5d3b67=await product[_0x235ebc(0x18c)]();let _0x43bbb0;if(_0x29986a[_0x235ebc(0x15d)]==_0x235ebc(0x1f4)){const _0x195e8c=await staff[_0x235ebc(0x1bc)]({'email':_0x29986a[_0x235ebc(0x1f0)]});_0x43bbb0=await adjustment_finished['find']({'warehouse_name':_0x195e8c[_0x235ebc(0x180)]});}else _0x43bbb0=await adjustment_finished[_0x235ebc(0x1d3)]([{'$match':{'type_of_transaction':_0x235ebc(0x1e1)}},{'$unwind':'$product'},{'$group':{'_id':_0x235ebc(0x1be),'invoice':{'$first':_0x235ebc(0x165)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x235ebc(0x1ef)},'room':{'$addToSet':_0x235ebc(0x16c)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x165a93[0x0][_0x235ebc(0x192)]==_0x235ebc(0x1bb))var _0x4d2575=users['English'];else{if(_0x165a93[0x0][_0x235ebc(0x192)]=='Hindi')var _0x4d2575=users[_0x235ebc(0x1f7)];else{if(_0x165a93[0x0][_0x235ebc(0x192)]=='German')var _0x4d2575=users[_0x235ebc(0x1ad)];else{if(_0x165a93[0x0][_0x235ebc(0x192)]==_0x235ebc(0x1c1))var _0x4d2575=users['Spanish'];else{if(_0x165a93[0x0]['language']==_0x235ebc(0x19a))var _0x4d2575=users[_0x235ebc(0x19a)];else{if(_0x165a93[0x0]['language']==_0x235ebc(0x199))var _0x4d2575=users[_0x235ebc(0x1f8)];else{if(_0x165a93[0x0][_0x235ebc(0x192)]==_0x235ebc(0x1f6))var _0x4d2575=users['Chinese'];else{if(_0x165a93[0x0]['language']==_0x235ebc(0x183))var _0x4d2575=users[_0x235ebc(0x17d)];}}}}}}}_0x52f6b2[_0x235ebc(0x1df)]('adjustment_finished_logs',{'success':_0x5c2b88[_0x235ebc(0x1e4)]('success'),'errors':_0x5c2b88[_0x235ebc(0x1e4)](_0x235ebc(0x203)),'role':_0x29986a,'profile':_0x48d506,'warehouse':_0x7f0d22,'product':_0x5d3b67,'adjustment':_0x43bbb0,'master_shop':_0x165a93,'language':_0x4d2575});}catch(_0x1763a5){console['log'](_0x1763a5);}});async function getRandom8DigitNumber(){var _0x1a1593=a0_0xfa02de;const _0x1a3af6=0x989680,_0x48570e=0x5f5e0ff,_0x5dca44=Math[_0x1a1593(0x1b0)](Math[_0x1a1593(0x1af)]()*(_0x48570e-_0x1a3af6+0x1))+_0x1a3af6;var _0x4b4a64;const _0x25d8d7=await adjustment_finished[_0x1a1593(0x1bc)]({'invoice':_0x1a1593(0x1a1)+_0x5dca44});return _0x25d8d7&&_0x25d8d7[_0x1a1593(0x1b2)]>0x0?_0x4b4a64=_0x1a1593(0x1a1)+_0x5dca44:_0x4b4a64=_0x1a1593(0x1a1)+_0x5dca44,_0x4b4a64;}router[a0_0xfa02de(0x1e2)](a0_0xfa02de(0x19c),auth,async(_0x21d24f,_0x25fb67)=>{var _0x3acc28=a0_0xfa02de;try{const {username:_0x226b9a,email:_0x19eda3,role:_0x20b39f}=_0x21d24f[_0x3acc28(0x18a)],_0x405658=_0x21d24f[_0x3acc28(0x18a)],_0x2a963c=await profile[_0x3acc28(0x1bc)]({'email':_0x405658[_0x3acc28(0x1f0)]}),_0x15578a=await master_shop[_0x3acc28(0x18c)]();let _0x25aedb;if(_0x405658[_0x3acc28(0x15d)]=='staff'){const _0xe9fbf6=await staff[_0x3acc28(0x1bc)]({'email':_0x405658['email']});_0x25aedb=await warehouse[_0x3acc28(0x1d3)]([{'$match':{'status':_0x3acc28(0x1ab),'name':_0xe9fbf6[_0x3acc28(0x180)]}},{'$group':{'_id':_0x3acc28(0x19f),'name':{'$first':_0x3acc28(0x19f)}}}]);}else _0x25aedb=await warehouse[_0x3acc28(0x1d3)]([{'$match':{'status':_0x3acc28(0x1ab)}},{'$group':{'_id':_0x3acc28(0x19f),'name':{'$first':'$name'}}}]);const _0xca0173=await product[_0x3acc28(0x18c)]({}),_0x3de1e4=await adjustment_finished[_0x3acc28(0x18c)](),_0x3ab381=_0x3de1e4[_0x3acc28(0x1b2)]+0x1,_0x215547='ADJF-'+_0x3ab381[_0x3acc28(0x1ec)]()[_0x3acc28(0x1d8)](0x5,'0');var _0x2a8936=[_0x3acc28(0x1b1),_0x3acc28(0x1ed),'Return\x20Rooms'];if(_0x15578a[0x0][_0x3acc28(0x192)]==_0x3acc28(0x1bb))var _0x204344=users[_0x3acc28(0x17f)];else{if(_0x15578a[0x0][_0x3acc28(0x192)]=='Hindi')var _0x204344=users[_0x3acc28(0x1f7)];else{if(_0x15578a[0x0][_0x3acc28(0x192)]==_0x3acc28(0x1ad))var _0x204344=users['German'];else{if(_0x15578a[0x0][_0x3acc28(0x192)]=='Spanish')var _0x204344=users[_0x3acc28(0x1c1)];else{if(_0x15578a[0x0]['language']=='French')var _0x204344=users[_0x3acc28(0x19a)];else{if(_0x15578a[0x0][_0x3acc28(0x192)]==_0x3acc28(0x199))var _0x204344=users[_0x3acc28(0x1f8)];else{if(_0x15578a[0x0]['language']==_0x3acc28(0x1f6))var _0x204344=users[_0x3acc28(0x1f6)];else{if(_0x15578a[0x0][_0x3acc28(0x192)]=='Arabic\x20(ae)')var _0x204344=users[_0x3acc28(0x17d)];}}}}}}}const _0x3b5607=getRandom8DigitNumber();_0x3b5607['then'](_0x576c76=>{var _0x570b24=_0x3acc28;_0x25fb67[_0x570b24(0x1df)](_0x570b24(0x1dd),{'success':_0x21d24f['flash'](_0x570b24(0x1d9)),'errors':_0x21d24f[_0x570b24(0x1e4)](_0x570b24(0x203)),'role':_0x405658,'profile':_0x2a963c,'warehouse':_0x25aedb,'product':_0xca0173,'master_shop':_0x15578a,'language':_0x204344,'rooms_data':_0x2a8936,'invoice_no':_0x576c76});})[_0x3acc28(0x18f)](_0x45e893=>{var _0x8d42af=_0x3acc28;_0x21d24f[_0x8d42af(0x1e4)]('errors',_0x8d42af(0x16a)),_0x25fb67[_0x8d42af(0x208)]('/adjustment/view');});}catch(_0x450bc8){console[_0x3acc28(0x1fb)](_0x450bc8);}}),router['post'](a0_0xfa02de(0x19c),auth,async(_0x26ae4c,_0x34f1b2)=>{var _0x57e3bf=a0_0xfa02de;try{const {warehouse_name:_0x1f94d9,date:_0x4d5346,prod_name:_0xfa0c33,level:_0x12428d,isle:_0x22e722,pallet:_0x571c77,stock:_0x73241c,types:_0x528b99,adjust_qty:_0x19bb20,new_adjust_qty:_0x10ebf4,note:_0x53b2df,Room_name:_0x4c99ef,JO_number:_0x413c4f,expiry_date:_0x4a24e3,PO_number:_0x589884,ReqBy:_0x40aa97,dateofreq:_0xb1f4c9,typeservicesData:_0x277396,destination:_0x17ac1,deliverydate:_0x28f550,driver:_0x416eaa,plate:_0x2ba7db,van:_0x493d68,DRSI:_0x2d9551,typevehicle:_0x5408c5,TSU:_0x4a4836,TFU:_0x3d29af}=_0x26ae4c[_0x57e3bf(0x1aa)];if(typeof _0xfa0c33==_0x57e3bf(0x202))var _0x109eda=[_0x26ae4c['body'][_0x57e3bf(0x189)]],_0x37d744=[_0x26ae4c['body'][_0x57e3bf(0x16e)]],_0x1fc172=[_0x26ae4c['body'][_0x57e3bf(0x186)]],_0x3a824e=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1b7)]],_0x594b63=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1a6)]],_0x53b107=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x200)]],_0x437670=[_0x26ae4c[_0x57e3bf(0x1aa)]['Primary_Units']],_0x2a04da=[_0x26ae4c[_0x57e3bf(0x1aa)]['Secondary_units']],_0xbd7170=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x18b)]],_0x6680c2=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1e3)]],_0x193374=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1a3)]],_0x5a154b=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1d0)]],_0x22e651=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x197)]],_0x1ab9b6=[_0x26ae4c[_0x57e3bf(0x1aa)]['Rooms']],_0x4c849f=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1cb)]],_0x29f512=[_0x26ae4c[_0x57e3bf(0x1aa)]['prod_invoice']],_0x56a9fb=[_0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1ce)]];else var _0x109eda=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x189)]],_0x37d744=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x16e)]],_0x1fc172=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x186)]],_0x3a824e=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1b7)]],_0x594b63=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1a6)]],_0x53b107=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x200)]],_0x437670=[..._0x26ae4c['body'][_0x57e3bf(0x174)]],_0x2a04da=[..._0x26ae4c['body'][_0x57e3bf(0x1b6)]],_0xbd7170=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x18b)]],_0x6680c2=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1e3)]],_0x193374=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1a3)]],_0x5a154b=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1d0)]],_0x22e651=[..._0x26ae4c['body']['prod_cat']],_0x1ab9b6=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x20a)]],_0x4c849f=[..._0x26ae4c['body']['maxPerUnit']],_0x29f512=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1da)]],_0x56a9fb=[..._0x26ae4c[_0x57e3bf(0x1aa)][_0x57e3bf(0x1ce)]];const _0x16ce24=_0x109eda['map'](_0x4b135c=>{return _0x4b135c={'product_name':_0x4b135c};});_0x37d744['forEach']((_0xa7b405,_0x214337)=>{var _0x33526d=_0x57e3bf,_0x5f082f=_0xa7b405[_0x33526d(0x1c4)](/[A-Za-z]+/)[0x0],_0x5ef6f8=parseInt(_0xa7b405[_0x33526d(0x1c4)](/\d+/)[0x0]);_0x16ce24[_0x214337][_0x33526d(0x16e)]=_0x5f082f,_0x16ce24[_0x214337][_0x33526d(0x207)]=_0x5ef6f8;}),_0x56a9fb[_0x57e3bf(0x20b)]((_0xdc86c4,_0x556b07)=>{_0x16ce24[_0x556b07]['id_transaction']=_0xdc86c4;}),_0x1fc172[_0x57e3bf(0x20b)]((_0x3ed075,_0x53f902)=>{_0x16ce24[_0x53f902]['stockBefore']=_0x3ed075;}),_0x3a824e['forEach']((_0x3fd006,_0x46f384)=>{var _0x2fe137=_0x57e3bf;_0x16ce24[_0x46f384][_0x2fe137(0x1b7)]=_0x3fd006;}),_0x594b63['forEach']((_0x261091,_0x2fd35b)=>{var _0x25e68a=_0x57e3bf;_0x16ce24[_0x2fd35b][_0x25e68a(0x1c6)]=_0x261091;}),_0x53b107[_0x57e3bf(0x20b)]((_0x3eda6d,_0x3aaa07)=>{var _0x424413=_0x57e3bf;_0x16ce24[_0x3aaa07][_0x424413(0x1d5)]=_0x3eda6d;}),_0x437670[_0x57e3bf(0x20b)]((_0x3211b9,_0x240150)=>{var _0x4b3fc=_0x57e3bf;_0x16ce24[_0x240150][_0x4b3fc(0x209)]=_0x3211b9;}),_0x2a04da[_0x57e3bf(0x20b)]((_0x35e8d8,_0x194c46)=>{var _0x3347ad=_0x57e3bf;_0x16ce24[_0x194c46][_0x3347ad(0x1f2)]=_0x35e8d8;}),_0xbd7170[_0x57e3bf(0x20b)]((_0x3faa6f,_0xd8be5)=>{var _0x3f355b=_0x57e3bf;_0x16ce24[_0xd8be5][_0x3f355b(0x205)]=_0x3faa6f;}),_0x6680c2[_0x57e3bf(0x20b)]((_0x3b337f,_0x53322c)=>{var _0x13c75d=_0x57e3bf;_0x16ce24[_0x53322c][_0x13c75d(0x1e3)]=_0x3b337f;}),_0x193374['forEach']((_0x53cea0,_0x1de390)=>{_0x16ce24[_0x1de390]['expiry_date']=_0x53cea0;}),_0x5a154b[_0x57e3bf(0x20b)]((_0x5238e1,_0x7f018e)=>{var _0xe4ad39=_0x57e3bf;_0x16ce24[_0x7f018e][_0xe4ad39(0x1ea)]=_0x5238e1;}),_0x22e651[_0x57e3bf(0x20b)]((_0x2a1102,_0x3c6ce0)=>{var _0x1ffe2c=_0x57e3bf;_0x16ce24[_0x3c6ce0][_0x1ffe2c(0x197)]=_0x2a1102;}),_0x1ab9b6[_0x57e3bf(0x20b)]((_0x4d8a65,_0x450a65)=>{var _0x5d1a06=_0x57e3bf;_0x16ce24[_0x450a65][_0x5d1a06(0x191)]=_0x4d8a65;}),_0x4c849f[_0x57e3bf(0x20b)]((_0x234086,_0x93c0e6)=>{_0x16ce24[_0x93c0e6]['maxPerUnit']=_0x234086;}),_0x29f512[_0x57e3bf(0x20b)]((_0x620f70,_0x3c601a)=>{var _0x5a592c=_0x57e3bf;_0x16ce24[_0x3c601a][_0x5a592c(0x1a0)]=_0x620f70;});const _0x452ffc=_0x16ce24[_0x57e3bf(0x1f1)](_0x39b0ea=>_0x39b0ea['adjust_qty']!=='0'&&_0x39b0ea[_0x57e3bf(0x1c6)]!=='');var _0x3da2bf=0x0;_0x452ffc['forEach'](_0x5d79dd=>{var _0x200fab=_0x57e3bf;console[_0x200fab(0x1fb)](_0x200fab(0x1e6),_0x5d79dd),parseInt(_0x5d79dd['adjust_qty'])<=0x0&&_0x3da2bf++;});if(_0x3da2bf!=0x0)return _0x26ae4c[_0x57e3bf(0x1e4)](_0x57e3bf(0x203),_0x57e3bf(0x1f3)),_0x34f1b2[_0x57e3bf(0x208)](_0x57e3bf(0x1d7));const _0x9d581f=new invoice_for_adjustment();await _0x9d581f[_0x57e3bf(0x1c0)]();const _0x21b73b=new adjustment_finished({'warehouse_name':_0x1f94d9,'date':_0x4d5346,'product':_0x452ffc,'note':_0x53b2df,'room':_0x4c99ef,'invoice':_0x57e3bf(0x1b5)+_0x9d581f['invoice_init'][_0x57e3bf(0x1ec)]()['padStart'](0x8,'0'),'JO_number':_0x413c4f,'expiry_date':_0x4a24e3,'PO_number':_0x589884,'RequestedBy':_0x40aa97,'DateofRequest':_0xb1f4c9,'typeservices':_0x277396,'destination':_0x17ac1,'deliverydate':_0x28f550,'driver':_0x416eaa,'plate':_0x2ba7db,'van':_0x493d68,'DRSI':_0x2d9551,'typevehicle':_0x5408c5,'TSU':_0x4a4836,'TFU':_0x3d29af}),_0x5b6733=await _0x21b73b[_0x57e3bf(0x1c0)]();_0x26ae4c[_0x57e3bf(0x1e4)](_0x57e3bf(0x1d9),_0x57e3bf(0x1d1)),_0x34f1b2[_0x57e3bf(0x208)](_0x57e3bf(0x1f5)+_0x5b6733[_0x57e3bf(0x195)]);}catch(_0x3db087){console[_0x57e3bf(0x1fb)](_0x3db087),_0x34f1b2['status'](0xc8)[_0x57e3bf(0x1c2)]({'message':_0x3db087[_0x57e3bf(0x201)]});}}),router['get'](a0_0xfa02de(0x17a),auth,async(_0x2a19cb,_0x715c99)=>{var _0x29f167=a0_0xfa02de;try{const {username:_0x22214f,email:_0x1514af,role:_0x4219bf}=_0x2a19cb[_0x29f167(0x18a)],_0x3d2167=_0x2a19cb[_0x29f167(0x18a)],_0xb8031b=await profile['findOne']({'email':_0x3d2167[_0x29f167(0x1f0)]}),_0xf35a28=await master_shop[_0x29f167(0x18c)]();let _0x58a721;if(_0x3d2167[_0x29f167(0x15d)]==_0x29f167(0x1f4)){const _0x20a868=await staff[_0x29f167(0x1bc)]({'email':_0x3d2167[_0x29f167(0x1f0)]});_0x58a721=await warehouse['aggregate']([{'$match':{'status':_0x29f167(0x1ab),'name':_0x20a868['warehouse']}},{'$group':{'_id':'$name','name':{'$first':_0x29f167(0x19f)}}}]);}else _0x58a721=await warehouse[_0x29f167(0x1d3)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x29f167(0x19f),'name':{'$first':_0x29f167(0x19f)}}}]);const _0x1aa628=await product[_0x29f167(0x18c)](),_0x454a26=await adjustment_finished[_0x29f167(0x18c)](),_0x17be75=_0x454a26['length']+0x1,_0x1743ea=_0x29f167(0x1a1)+_0x17be75[_0x29f167(0x1ec)]()[_0x29f167(0x1d8)](0x5,'0');var _0x26e694=[_0x29f167(0x1b1),'Enclosed',_0x29f167(0x177)];if(_0xf35a28[0x0][_0x29f167(0x192)]==_0x29f167(0x1bb))var _0x119da1=users['English'];else{if(_0xf35a28[0x0][_0x29f167(0x192)]==_0x29f167(0x1f7))var _0x119da1=users['Hindi'];else{if(_0xf35a28[0x0][_0x29f167(0x192)]==_0x29f167(0x1ad))var _0x119da1=users['German'];else{if(_0xf35a28[0x0][_0x29f167(0x192)]=='Spanish')var _0x119da1=users[_0x29f167(0x1c1)];else{if(_0xf35a28[0x0][_0x29f167(0x192)]=='French')var _0x119da1=users[_0x29f167(0x19a)];else{if(_0xf35a28[0x0][_0x29f167(0x192)]==_0x29f167(0x199))var _0x119da1=users['Portuguese'];else{if(_0xf35a28[0x0][_0x29f167(0x192)]=='Chinese')var _0x119da1=users[_0x29f167(0x1f6)];else{if(_0xf35a28[0x0][_0x29f167(0x192)]==_0x29f167(0x183))var _0x119da1=users[_0x29f167(0x17d)];}}}}}}}const _0x12f6b0=getRandom8DigitNumber();_0x12f6b0['then'](_0x5a22f6=>{var _0x365ee3=_0x29f167;_0x715c99[_0x365ee3(0x1df)](_0x365ee3(0x1bd),{'success':_0x2a19cb[_0x365ee3(0x1e4)](_0x365ee3(0x1d9)),'errors':_0x2a19cb[_0x365ee3(0x1e4)](_0x365ee3(0x203)),'role':_0x3d2167,'profile':_0xb8031b,'warehouse':_0x58a721,'product':_0x1aa628,'master_shop':_0xf35a28,'language':_0x119da1,'rooms_data':_0x26e694,'invoice_no':_0x5a22f6});})[_0x29f167(0x18f)](_0x4cc851=>{var _0x4ab3aa=_0x29f167;_0x2a19cb[_0x4ab3aa(0x1e4)](_0x4ab3aa(0x203),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x715c99[_0x4ab3aa(0x208)](_0x4ab3aa(0x1ca));});}catch(_0x5cf770){console['log'](_0x5cf770);}}),router[a0_0xfa02de(0x15c)](a0_0xfa02de(0x17a),auth,async(_0x233475,_0x9f7dff)=>{var _0x2371b2=a0_0xfa02de;try{const {warehouse_name:_0x7617e4,date:_0x3302df,prod_name:_0x6d9f63,level:_0x107017,isle:_0x38119d,pallet:_0x171272,stock:_0x371dc0,types:_0xd77a5b,adjust_qty:_0x16c363,new_adjust_qty:_0xa50f9c,note:_0x4fab13,Room_name:_0x4c1336,JO_number:_0x176d84,expiry_date:_0x59e5bb,type_of_transaction:_0x46bd7c,PO_number:_0x5e903e,ReqBy:_0x4130c3,dateofreq:_0x36cf6f,typeservicesData:_0x1f8652,destination:_0x4a71da,deliverydate:_0x1885f9,driver:_0x40d67a,plate:_0x4c76e2,van:_0x494c3c,DRSI:_0x3fd9fe,typevehicle:_0x30305d,TSU:_0x582176,TFU:_0x1ca77c}=_0x233475[_0x2371b2(0x1aa)];if(typeof _0x6d9f63=='string')var _0x575c73=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x189)]],_0x352622=[_0x233475[_0x2371b2(0x1aa)]['level']],_0xdbfb71=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x186)]],_0x2a6eb3=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x1b7)]],_0x283903=[_0x233475['body']['New_Qty_Converted_adj']],_0x3a6152=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x200)]],_0x4bb9f3=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x174)]],_0x478a87=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x1b6)]],_0x3abf5e=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x18b)]],_0xe0cab1=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x1e3)]],_0x1e06e7=[_0x233475['body'][_0x2371b2(0x1a3)]],_0x546da4=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x1d0)]],_0x5b0f5f=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x197)]],_0x1ab503=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x20a)]],_0x492126=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x1cb)]],_0x1717aa=[_0x233475[_0x2371b2(0x1aa)]['prod_invoice']],_0x32c1af=[_0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x1ce)]];else var _0x575c73=[..._0x233475['body'][_0x2371b2(0x189)]],_0x352622=[..._0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x16e)]],_0xdbfb71=[..._0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x186)]],_0x2a6eb3=[..._0x233475['body']['types']],_0x283903=[..._0x233475['body']['New_Qty_Converted_adj']],_0x3a6152=[..._0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x200)]],_0x4bb9f3=[..._0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x174)]],_0x478a87=[..._0x233475['body'][_0x2371b2(0x1b6)]],_0x3abf5e=[..._0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x18b)]],_0xe0cab1=[..._0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x1e3)]],_0x1e06e7=[..._0x233475[_0x2371b2(0x1aa)]['expiry_date']],_0x546da4=[..._0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x1d0)]],_0x5b0f5f=[..._0x233475['body'][_0x2371b2(0x197)]],_0x1ab503=[..._0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x20a)]],_0x492126=[..._0x233475['body']['maxPerUnit']],_0x1717aa=[..._0x233475['body'][_0x2371b2(0x1da)]],_0x32c1af=[..._0x233475[_0x2371b2(0x1aa)][_0x2371b2(0x1ce)]];const _0x344544=_0x575c73[_0x2371b2(0x1b9)](_0x10edfc=>{return _0x10edfc={'product_name':_0x10edfc};});_0x352622[_0x2371b2(0x20b)]((_0x5e6398,_0x4c95d0)=>{var _0x2c88e1=_0x2371b2,_0x17afb0=_0x5e6398['match'](/[A-Za-z]+/)[0x0],_0x10ac87=parseInt(_0x5e6398[_0x2c88e1(0x1c4)](/\d+/)[0x0]);_0x344544[_0x4c95d0][_0x2c88e1(0x16e)]=_0x17afb0,_0x344544[_0x4c95d0]['bay']=_0x10ac87;}),_0x32c1af[_0x2371b2(0x20b)]((_0x57bdee,_0x5972d2)=>{var _0x40f127=_0x2371b2;_0x344544[_0x5972d2][_0x40f127(0x182)]=_0x57bdee;}),_0xdbfb71[_0x2371b2(0x20b)]((_0x19e817,_0x17de36)=>{var _0x74aa3e=_0x2371b2;_0x344544[_0x17de36][_0x74aa3e(0x1de)]=_0x19e817;}),_0x2a6eb3[_0x2371b2(0x20b)]((_0x4eae23,_0x184d34)=>{var _0x4f637a=_0x2371b2;_0x344544[_0x184d34][_0x4f637a(0x1b7)]=_0x4eae23;}),_0x283903[_0x2371b2(0x20b)]((_0x21a93a,_0x1904a5)=>{_0x344544[_0x1904a5]['adjust_qty']=_0x21a93a;}),_0x3a6152[_0x2371b2(0x20b)]((_0x19a241,_0x4653e6)=>{var _0x28a32d=_0x2371b2;_0x344544[_0x4653e6][_0x28a32d(0x1d5)]=_0x19a241;}),_0x4bb9f3[_0x2371b2(0x20b)]((_0x2e1b9f,_0x5c701e)=>{_0x344544[_0x5c701e]['unit']=_0x2e1b9f;}),_0x478a87[_0x2371b2(0x20b)]((_0x9b9d21,_0x399b49)=>{var _0x3e3337=_0x2371b2;_0x344544[_0x399b49][_0x3e3337(0x1f2)]=_0x9b9d21;}),_0x3abf5e[_0x2371b2(0x20b)]((_0x34e56e,_0x49ded0)=>{var _0x46082b=_0x2371b2;_0x344544[_0x49ded0][_0x46082b(0x205)]=_0x34e56e;}),_0xe0cab1['forEach']((_0x264f5e,_0x62d3c9)=>{_0x344544[_0x62d3c9]['batch_code']=_0x264f5e;}),_0x1e06e7[_0x2371b2(0x20b)]((_0x1f75c6,_0x19ed41)=>{_0x344544[_0x19ed41]['expiry_date']=_0x1f75c6;}),_0x546da4['forEach']((_0x2ed276,_0x4f20c1)=>{var _0x2a1cff=_0x2371b2;_0x344544[_0x4f20c1][_0x2a1cff(0x1ea)]=_0x2ed276;}),_0x5b0f5f['forEach']((_0x5ce79a,_0x2f268d)=>{var _0x256c62=_0x2371b2;_0x344544[_0x2f268d][_0x256c62(0x197)]=_0x5ce79a;}),_0x1ab503[_0x2371b2(0x20b)]((_0x43a8a5,_0x4fe2be)=>{var _0x58ad05=_0x2371b2;_0x344544[_0x4fe2be][_0x58ad05(0x191)]=_0x43a8a5;}),_0x492126['forEach']((_0x3be76e,_0x413dbb)=>{var _0x24824a=_0x2371b2;_0x344544[_0x413dbb][_0x24824a(0x1cb)]=_0x3be76e;}),_0x1717aa[_0x2371b2(0x20b)]((_0x1383f9,_0x5c6574)=>{_0x344544[_0x5c6574]['invoice']=_0x1383f9;});const _0x5f273d=_0x344544[_0x2371b2(0x1f1)](_0x421379=>_0x421379['adjust_qty']!=='0'&&_0x421379[_0x2371b2(0x1c6)]!=='');var _0x50d386=0x0;_0x5f273d[_0x2371b2(0x20b)](_0x5bda3b=>{var _0x24662e=_0x2371b2;console['log'](_0x24662e(0x1e6),_0x5bda3b),parseInt(_0x5bda3b[_0x24662e(0x1c6)])<=0x0&&_0x50d386++;});if(_0x50d386!=0x0)return _0x233475[_0x2371b2(0x1e4)]('errors',_0x2371b2(0x1f3)),_0x9f7dff[_0x2371b2(0x208)](_0x2371b2(0x1d7));const _0x526cb5=new adjustment_logs();await _0x526cb5['save']();const _0x3c8e71=new adjustment_finished({'warehouse_name':_0x7617e4,'date':_0x3302df,'product':_0x5f273d,'note':_0x4fab13,'room':_0x4c1336,'invoice':'LOG-ADJ-'+_0x526cb5[_0x2371b2(0x166)]['toString']()[_0x2371b2(0x1d8)](0x8,'0'),'JO_number':_0x176d84,'expiry_date':_0x59e5bb,'type_of_transaction':_0x46bd7c,'PO_number':_0x5e903e,'RequestedBy':_0x4130c3,'DateofRequest':_0x36cf6f,'typeservices':_0x1f8652,'destination':_0x4a71da,'deliverydate':_0x1885f9,'driver':_0x40d67a,'plate':_0x4c76e2,'van':_0x494c3c,'DRSI':_0x3fd9fe,'typevehicle':_0x30305d,'TSU':_0x582176,'TFU':_0x1ca77c}),_0x582206=await _0x3c8e71[_0x2371b2(0x1c0)]();_0x233475[_0x2371b2(0x1e4)](_0x2371b2(0x1d9),'adjustment\x20add\x20successfull'),_0x9f7dff[_0x2371b2(0x208)](_0x2371b2(0x1f5)+_0x582206[_0x2371b2(0x195)]);}catch(_0x21930b){console[_0x2371b2(0x1fb)](_0x21930b),_0x9f7dff[_0x2371b2(0x20d)](0xc8)['json']({'message':_0x21930b['message']});}}),router[a0_0xfa02de(0x1e2)](a0_0xfa02de(0x161),auth,async(_0xec56d2,_0x20f904)=>{var _0x157f7b=a0_0xfa02de;try{const {username:_0x195450,email:_0x10002f,role:_0x40bc1e}=_0xec56d2['user'],_0xdc3d65=_0xec56d2[_0x157f7b(0x18a)],_0x2b327f=await profile[_0x157f7b(0x1bc)]({'email':_0xdc3d65['email']}),_0x4400cc=await master_shop['find'](),_0x3d216c=_0xec56d2[_0x157f7b(0x1ff)]['id'],_0x388f62=await adjustment_finished['findById']({'_id':_0x3d216c}),_0x2c7232=await purchases[_0x157f7b(0x1d3)]([{'$match':{'warehouse_name':_0x388f62[_0x157f7b(0x1a4)]}},{'$unwind':_0x157f7b(0x181)},{'$group':{'_id':_0x157f7b(0x1db)}}]);console[_0x157f7b(0x1fb)](_0x157f7b(0x160),_0x2c7232);const _0x23ff16=await product[_0x157f7b(0x18c)]({}),_0x29e5b9=await warehouse['aggregate']([{'$match':{'name':_0x388f62[_0x157f7b(0x1a4)]}},{'$unwind':_0x157f7b(0x18d)},{'$group':{'_id':_0x157f7b(0x1ac),'name':{'$first':_0x157f7b(0x20c)},'product_stock':{'$first':_0x157f7b(0x1fc)},'bay':{'$first':_0x157f7b(0x16d)},'bin':{'$first':_0x157f7b(0x198)},'type':{'$first':_0x157f7b(0x196)},'floorlevel':{'$first':_0x157f7b(0x179)},'primary_code':{'$first':_0x157f7b(0x171)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x157f7b(0x1cc)},'storage':{'$first':_0x157f7b(0x1c9)},'rack':{'$first':_0x157f7b(0x19e)},'expiry_date':{'$first':_0x157f7b(0x1d2)},'production_date':{'$first':_0x157f7b(0x1dc)},'batch_code':{'$first':_0x157f7b(0x1d6)},'maxPerUnit':{'$first':_0x157f7b(0x18e)},'room':{'$first':_0x157f7b(0x185)}}}]);if(_0x4400cc[0x0]['language']==_0x157f7b(0x1bb)){var _0x1694c1=users[_0x157f7b(0x17f)];console[_0x157f7b(0x1fb)](_0x1694c1);}else{if(_0x4400cc[0x0][_0x157f7b(0x192)]==_0x157f7b(0x1f7))var _0x1694c1=users[_0x157f7b(0x1f7)];else{if(_0x4400cc[0x0]['language']==_0x157f7b(0x1ad))var _0x1694c1=users[_0x157f7b(0x1ad)];else{if(_0x4400cc[0x0]['language']=='Spanish')var _0x1694c1=users['Spanish'];else{if(_0x4400cc[0x0][_0x157f7b(0x192)]==_0x157f7b(0x19a))var _0x1694c1=users[_0x157f7b(0x19a)];else{if(_0x4400cc[0x0]['language']=='Portuguese\x20(BR)')var _0x1694c1=users[_0x157f7b(0x1f8)];else{if(_0x4400cc[0x0][_0x157f7b(0x192)]=='Chinese')var _0x1694c1=users['Chinese'];else{if(_0x4400cc[0x0][_0x157f7b(0x192)]==_0x157f7b(0x183))var _0x1694c1=users[_0x157f7b(0x17d)];}}}}}}}_0x20f904[_0x157f7b(0x1df)](_0x157f7b(0x163),{'success':_0xec56d2[_0x157f7b(0x1e4)]('success'),'errors':_0xec56d2[_0x157f7b(0x1e4)](_0x157f7b(0x203)),'role':_0xdc3d65,'profile':_0x2b327f,'adjustment':_0x388f62,'stock':_0x29e5b9,'master_shop':_0x4400cc,'warehouse_name':_0x2c7232,'unit':_0x23ff16,'language':_0x1694c1});}catch(_0x14fff8){console[_0x157f7b(0x1fb)](_0x14fff8),_0x20f904[_0x157f7b(0x20d)](0xc8)[_0x157f7b(0x1c2)]({'message':_0x14fff8[_0x157f7b(0x201)]});}}),router['post']('/preview/:id',auth,async(_0x502177,_0x399f9e)=>{var _0x5d4bbb=a0_0xfa02de;try{const {invoice:_0x520e75,warehouse_name:_0x2da731,Room_name:_0x18d84c}=_0x502177[_0x5d4bbb(0x1aa)],_0x2c8e85=_0x502177[_0x5d4bbb(0x1ff)]['id'],_0x59ba9e=await adjustment_finished[_0x5d4bbb(0x162)]({'_id':_0x2c8e85});var _0x216255;const _0x1c0ee4=_0x59ba9e[_0x5d4bbb(0x1bf)][_0x5d4bbb(0x1b9)](async _0x56f36f=>{var _0x4fd5b1=_0x5d4bbb;if(_0x56f36f[_0x4fd5b1(0x1c6)]>0x0){_0x216255=await warehouse[_0x4fd5b1(0x1bc)]({'name':_0x2da731,'room':_0x56f36f['room_names']});const _0x3c5cec=_0x216255[_0x4fd5b1(0x1b8)][_0x4fd5b1(0x1b9)](_0x5ac71a=>{var _0x21ff5f=_0x4fd5b1;console['log'](_0x56f36f[_0x21ff5f(0x1b7)]);if(_0x56f36f[_0x21ff5f(0x1b7)]==_0x21ff5f(0x1e7))_0x5ac71a['_id']==_0x56f36f[_0x21ff5f(0x182)]&&(_0x5ac71a[_0x21ff5f(0x1fa)]=_0x5ac71a['product_stock']-_0x56f36f['adjust_qty']);else _0x56f36f[_0x21ff5f(0x1b7)]==_0x21ff5f(0x1d4)&&(_0x5ac71a[_0x21ff5f(0x195)]==_0x56f36f['id_transaction']&&(_0x5ac71a[_0x21ff5f(0x1fa)]=_0x5ac71a[_0x21ff5f(0x1fa)]+_0x56f36f[_0x21ff5f(0x1c6)]));});}return _0x216255;});Promise['all'](_0x1c0ee4)[_0x5d4bbb(0x1a2)](async _0x3e0123=>{var _0x1f7180=_0x5d4bbb;try{for(const _0xba9585 of _0x3e0123){await _0xba9585[_0x1f7180(0x1c0)]();}_0x59ba9e[_0x1f7180(0x1b4)]=_0x1f7180(0x17c);const _0x3519b2=await _0x59ba9e['save'](),_0x23fae2=await master_shop[_0x1f7180(0x18c)](),_0xb90c56=await email_settings[_0x1f7180(0x1bc)](),_0x172f28=await supervisor_settings['find']();var _0x3d464a=_0x59ba9e[_0x1f7180(0x1bf)],_0x516929='',_0x2bc046;for(_0x2bc046 in _0x3d464a){var _0x4d4409='FG';_0x59ba9e[_0x1f7180(0x1a4)]=='DRY\x20GOODS'&&(_0x4d4409='DG'),_0x516929+=_0x1f7180(0x172)+_0x1f7180(0x204)+_0x3d464a[_0x2bc046][_0x1f7180(0x16b)]+_0x1f7180(0x17b)+_0x1f7180(0x204)+_0x3d464a[_0x2bc046][_0x1f7180(0x205)]+'</td>'+_0x1f7180(0x204)+_0x3d464a[_0x2bc046]['adjust_qty']+'</td>'+_0x1f7180(0x204)+_0x3d464a[_0x2bc046][_0x1f7180(0x209)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3d464a[_0x2bc046][_0x1f7180(0x1f2)]+_0x1f7180(0x17b)+_0x1f7180(0x204)+_0x59ba9e['warehouse_name']+_0x1f7180(0x17b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3d464a[_0x2bc046]['room_names']+'</td>'+_0x1f7180(0x204)+_0x4d4409+_0x3d464a[_0x2bc046][_0x1f7180(0x207)]+_0x1f7180(0x17b)+_0x1f7180(0x187);}_0x502177[_0x1f7180(0x1e4)](_0x1f7180(0x1d9),_0x1f7180(0x206)),_0x399f9e['redirect'](_0x1f7180(0x1c8)+_0x3519b2[_0x1f7180(0x195)]);}catch(_0xfaa0df){console[_0x1f7180(0x169)](_0xfaa0df),_0x399f9e[_0x1f7180(0x20d)](0x1f4)[_0x1f7180(0x1c2)]({'error':_0x1f7180(0x167)});}})['catch'](_0x1b52a4=>{var _0x5e4bcf=_0x5d4bbb;console['error'](_0x1b52a4),_0x399f9e[_0x5e4bcf(0x20d)](0x1f4)[_0x5e4bcf(0x1c2)]({'error':_0x5e4bcf(0x176)});});}catch(_0x177b9b){_0x399f9e[_0x5d4bbb(0x1c2)]({'message':_0x177b9b['message']});}}),router[a0_0xfa02de(0x1e2)](a0_0xfa02de(0x193),auth,async(_0x5b94b8,_0x339ff6)=>{var _0x552810=a0_0xfa02de;try{const {username:_0x2628f7,email:_0x3c8124,role:_0x2e4ffb}=_0x5b94b8[_0x552810(0x18a)],_0x4ef8e8=_0x5b94b8[_0x552810(0x18a)],_0x4651d6=await profile[_0x552810(0x1bc)]({'email':_0x4ef8e8[_0x552810(0x1f0)]}),_0x3ceabd=await master_shop[_0x552810(0x18c)]();console[_0x552810(0x1fb)](_0x552810(0x1a9),_0x3ceabd);const _0x3e1de6=_0x5b94b8[_0x552810(0x1ff)]['id'],_0x210100=await adjustment_finished[_0x552810(0x162)]({'_id':_0x3e1de6});let _0x41e809=new Date(_0x210100['expiry_date']),_0x28a7c2=('0'+_0x41e809['getDate']())[_0x552810(0x170)](-0x2),_0x5f2314=('0'+(_0x41e809['getMonth']()+0x1))[_0x552810(0x170)](-0x2),_0x42654c=_0x41e809['getFullYear'](),_0x9060b3=_0x42654c+'-'+_0x5f2314+'-'+_0x28a7c2;var _0xbb24fa=[_0x552810(0x1b1),_0x552810(0x1ed),_0x552810(0x177)];const _0x2c4592=await purchases[_0x552810(0x1d3)]([{'$match':{'warehouse_name':_0x210100[_0x552810(0x1a4)]}},{'$unwind':_0x552810(0x181)},{'$group':{'_id':'$product.product_name'}}]);console[_0x552810(0x1fb)](_0x552810(0x160),_0x2c4592);const _0x852e24=await product['find']({}),_0x32d519=await warehouse[_0x552810(0x1d3)]([{'$match':{'name':_0x210100[_0x552810(0x1a4)],'room':_0x210100[_0x552810(0x17e)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x552810(0x1ac),'name':{'$first':_0x552810(0x20c)},'product_stock':{'$first':_0x552810(0x1fc)},'bay':{'$first':_0x552810(0x16d)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x552810(0x171)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x552810(0x1c9)},'rack':{'$first':_0x552810(0x19e)}}}]);if(_0x3ceabd[0x0][_0x552810(0x192)]=='English\x20(US)'){var _0x3a4d49=users[_0x552810(0x17f)];console[_0x552810(0x1fb)](_0x3a4d49);}else{if(_0x3ceabd[0x0][_0x552810(0x192)]==_0x552810(0x1f7))var _0x3a4d49=users[_0x552810(0x1f7)];else{if(_0x3ceabd[0x0][_0x552810(0x192)]==_0x552810(0x1ad))var _0x3a4d49=users[_0x552810(0x1ad)];else{if(_0x3ceabd[0x0][_0x552810(0x192)]==_0x552810(0x1c1))var _0x3a4d49=users[_0x552810(0x1c1)];else{if(_0x3ceabd[0x0][_0x552810(0x192)]=='French')var _0x3a4d49=users[_0x552810(0x19a)];else{if(_0x3ceabd[0x0][_0x552810(0x192)]==_0x552810(0x199))var _0x3a4d49=users[_0x552810(0x1f8)];else{if(_0x3ceabd[0x0][_0x552810(0x192)]==_0x552810(0x1f6))var _0x3a4d49=users[_0x552810(0x1f6)];else{if(_0x3ceabd[0x0][_0x552810(0x192)]=='Arabic\x20(ae)')var _0x3a4d49=users[_0x552810(0x17d)];}}}}}}}_0x339ff6[_0x552810(0x1df)](_0x552810(0x190),{'success':_0x5b94b8[_0x552810(0x1e4)](_0x552810(0x1d9)),'errors':_0x5b94b8[_0x552810(0x1e4)](_0x552810(0x203)),'role':_0x4ef8e8,'profile':_0x4651d6,'adjustment':_0x210100,'stock':_0x32d519,'master_shop':_0x3ceabd,'warehouse_name':_0x2c4592,'unit':_0x852e24,'language':_0x3a4d49,'rooms_data':_0xbb24fa,'ed_fullDate':_0x9060b3});}catch(_0x459efe){console['log'](_0x459efe),_0x339ff6['status'](0xc8)[_0x552810(0x1c2)]({'message':_0x459efe['message']});}}),router['post'](a0_0xfa02de(0x193),auth,async(_0x15f599,_0x5c2f6f)=>{var _0x3a8391=a0_0xfa02de;try{const _0x254257=_0x15f599['params']['id'],_0x5dbe58=await adjustment_finished[_0x3a8391(0x162)]({'_id':_0x254257}),_0x8c99d5=await warehouse[_0x3a8391(0x1bc)]({'name':_0x5dbe58[_0x3a8391(0x1a4)],'room':_0x5dbe58['room']}),{warehouse_name:_0x52eeec,date:_0x1a0c5c,prod_name:_0x5c642d,level:_0x282069,isle:_0x565d41,pallet:_0x923018,stock:_0x5a5102,types:_0x22ba47,adjust_qty:_0x569d96,new_adjust_qty:_0xe8c83b,note:_0x92951a,Room_name:_0x48f49e,invoice:_0x16fa25,JO_number:_0x1bbe6e}=_0x15f599[_0x3a8391(0x1aa)];if(typeof _0x5c642d=='string')var _0xacd7f=[_0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x189)]],_0x3eace0=[_0x15f599['body'][_0x3a8391(0x16e)]],_0x352398=[_0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x186)]],_0x428264=[_0x15f599['body'][_0x3a8391(0x1b7)]],_0x11e520=[_0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x1c6)]],_0x4e882a=[_0x15f599['body'][_0x3a8391(0x1d5)]],_0x36fe29=[_0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x18b)]],_0x140e64=[_0x15f599[_0x3a8391(0x1aa)]['unit']],_0x397a6f=[_0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x1b6)]],_0x2a458c=[_0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x1e3)]],_0x42bf6f=[_0x15f599['body'][_0x3a8391(0x1a3)]];else var _0xacd7f=[..._0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x189)]],_0x3eace0=[..._0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x16e)]],_0x352398=[..._0x15f599['body']['stock']],_0x428264=[..._0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x1b7)]],_0x11e520=[..._0x15f599['body'][_0x3a8391(0x1c6)]],_0x4e882a=[..._0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x1d5)]],_0x36fe29=[..._0x15f599['body'][_0x3a8391(0x18b)]],_0x140e64=[..._0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x209)]],_0x397a6f=[..._0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x1b6)]],_0x2a458c=[..._0x15f599['body'][_0x3a8391(0x1e3)]],_0x42bf6f=[..._0x15f599[_0x3a8391(0x1aa)][_0x3a8391(0x1a3)]];const _0x19c937=_0xacd7f[_0x3a8391(0x1b9)](_0x46cfe8=>{return _0x46cfe8={'product_name':_0x46cfe8};});_0x3eace0['forEach']((_0x4d08da,_0x5b05bb)=>{_0x19c937[_0x5b05bb]['bay']=_0x4d08da;}),_0x352398['forEach']((_0x2f385f,_0x1d6592)=>{var _0x1020c6=_0x3a8391;_0x19c937[_0x1d6592][_0x1020c6(0x1de)]=_0x2f385f;}),_0x428264['forEach']((_0x2725d2,_0x11469c)=>{var _0x5a349e=_0x3a8391;_0x19c937[_0x11469c][_0x5a349e(0x1b7)]=_0x2725d2;}),_0x11e520[_0x3a8391(0x20b)]((_0x5af76c,_0x4e62f8)=>{var _0x4e5fc2=_0x3a8391;_0x19c937[_0x4e62f8][_0x4e5fc2(0x1c6)]=_0x5af76c;}),_0x4e882a['forEach']((_0x48cd08,_0x44a87b)=>{var _0xbf4cf8=_0x3a8391;_0x19c937[_0x44a87b][_0xbf4cf8(0x1d5)]=_0x48cd08;}),_0x140e64[_0x3a8391(0x20b)]((_0x13109a,_0x30d4eb)=>{var _0x3fb7fe=_0x3a8391;_0x19c937[_0x30d4eb][_0x3fb7fe(0x209)]=_0x13109a;}),_0x397a6f['forEach']((_0xc0bfc8,_0x123a4a)=>{var _0xfa030f=_0x3a8391;_0x19c937[_0x123a4a][_0xfa030f(0x1f2)]=_0xc0bfc8;}),_0x36fe29['forEach']((_0x3bf22c,_0x143933)=>{var _0x2cf7fa=_0x3a8391;_0x19c937[_0x143933][_0x2cf7fa(0x205)]=_0x3bf22c;}),_0x2a458c[_0x3a8391(0x20b)]((_0x157e5d,_0x335a5f)=>{var _0x45e1bc=_0x3a8391;_0x19c937[_0x335a5f][_0x45e1bc(0x1e3)]=_0x157e5d;}),_0x42bf6f['forEach']((_0x51b984,_0x1569a4)=>{var _0x53baab=_0x3a8391;_0x19c937[_0x1569a4][_0x53baab(0x1a3)]=_0x51b984;});const _0x282423=_0x19c937[_0x3a8391(0x1f1)](_0x4809dc=>_0x4809dc[_0x3a8391(0x1c6)]!=='0'&&_0x4809dc[_0x3a8391(0x1c6)]!=='');var _0x5e9643=0x0;_0x282423[_0x3a8391(0x20b)](_0xee53d9=>{var _0x9976cd=_0x3a8391;console[_0x9976cd(0x1fb)](_0x9976cd(0x1e6),_0xee53d9),parseInt(_0xee53d9['adjust_qty'])<=0x0&&_0x5e9643++;});if(_0x5e9643!=0x0)return _0x15f599[_0x3a8391(0x1e4)](_0x3a8391(0x203),_0x3a8391(0x1f3)),_0x5c2f6f[_0x3a8391(0x208)](_0x3a8391(0x1d7));_0x5dbe58[_0x3a8391(0x1a4)]=_0x52eeec,_0x5dbe58[_0x3a8391(0x1ba)]=_0x1a0c5c,_0x5dbe58[_0x3a8391(0x1bf)]=_0x282423,_0x5dbe58['note']=_0x92951a,_0x5dbe58['room']=_0x48f49e,_0x5dbe58[_0x3a8391(0x1a0)]=_0x16fa25,_0x5dbe58['JO_number']=_0x1bbe6e;const _0x18d7d1=await _0x5dbe58[_0x3a8391(0x1c0)](),_0x1b25b0=await warehouse[_0x3a8391(0x1bc)]({'name':_0x52eeec,'room':_0x48f49e});_0x18d7d1[_0x3a8391(0x1bf)][_0x3a8391(0x20b)](_0x51d2e9=>{var _0x53b358=_0x3a8391;const _0x30d4da=_0x1b25b0[_0x53b358(0x1b8)][_0x53b358(0x1b9)](_0xeaceed=>{var _0x1a0416=_0x53b358;_0x51d2e9['types']==_0x1a0416(0x1e7)?_0xeaceed['product_name']==_0x51d2e9[_0x1a0416(0x16b)]&&_0xeaceed[_0x1a0416(0x207)]==_0x51d2e9[_0x1a0416(0x207)]&&(_0xeaceed[_0x1a0416(0x1fa)]=parseInt(_0xeaceed[_0x1a0416(0x1fa)])-parseInt(_0x51d2e9[_0x1a0416(0x1c6)])):_0xeaceed[_0x1a0416(0x16b)]==_0x51d2e9[_0x1a0416(0x16b)]&&_0xeaceed[_0x1a0416(0x207)]==_0x51d2e9[_0x1a0416(0x207)]&&(_0xeaceed[_0x1a0416(0x1fa)]=parseInt(_0xeaceed[_0x1a0416(0x1fa)])+parseInt(_0x51d2e9['adjust_qty']));});}),await _0x1b25b0[_0x3a8391(0x1c0)](),_0x15f599[_0x3a8391(0x1e4)]('success',_0x3a8391(0x19b)),_0x5c2f6f[_0x3a8391(0x208)](_0x3a8391(0x1b3));}catch(_0x29c001){console[_0x3a8391(0x1fb)](_0x29c001);}}),router[a0_0xfa02de(0x15c)](a0_0xfa02de(0x1e0),async(_0x3bf72c,_0x1943f8)=>{var _0x5de07f=a0_0xfa02de;const {primary_code:_0x8e57b4,warehouse_data:_0x294193,rooms_data:_0x5606d3,Roomslist:_0x29df66}=_0x3bf72c[_0x5de07f(0x1aa)],_0x10363e=_0x29df66[_0x5de07f(0x1ee)](','),_0x40a69f=[];async function _0x45bbd5(_0x2517ee){var _0x37f387=_0x5de07f;const _0x56d0c9=await warehouse[_0x37f387(0x1d3)]([{'$match':{'name':_0x294193,'room':_0x2517ee}},{'$unwind':_0x37f387(0x18d)},{'$match':{'product_details.primary_code':_0x8e57b4}},{'$group':{'_id':_0x37f387(0x1ac),'name':{'$first':_0x37f387(0x20c)},'product_stock':{'$first':_0x37f387(0x1fc)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x37f387(0x1cc)},'level':{'$first':_0x37f387(0x188)},'bay':{'$first':'$product_details.bay'},'type':{'$first':_0x37f387(0x196)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x37f387(0x178)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x37f387(0x19e)},'expiry_date':{'$first':_0x37f387(0x1d2)},'production_date':{'$first':_0x37f387(0x1dc)},'batch_code':{'$first':_0x37f387(0x1d6)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x37f387(0x18e)},'roomNamed':{'$first':_0x37f387(0x185)},'invoice':{'$first':_0x37f387(0x15f)}}}]),_0x24ed69=await warehouse[_0x37f387(0x1d3)]([{'$match':{'name':_0x294193,'room':_0x2517ee}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x8e57b4}},{'$group':{'_id':_0x37f387(0x1ac),'name':{'$first':_0x37f387(0x20c)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x37f387(0x171)},'secondary_code':{'$first':_0x37f387(0x1a5)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x37f387(0x188)},'bay':{'$first':_0x37f387(0x16d)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x37f387(0x179)},'unit':{'$first':_0x37f387(0x178)},'secondary_unit':{'$first':_0x37f387(0x1e5)},'storage':{'$first':_0x37f387(0x1c9)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x37f387(0x1d2)},'production_date':{'$first':_0x37f387(0x1dc)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x37f387(0x18e)},'roomNamed':{'$first':_0x37f387(0x185)},'invoice':{'$first':_0x37f387(0x15f)}}}]);if(_0x56d0c9['length']>0x0)_0x40a69f[_0x37f387(0x1a8)](_0x56d0c9);else _0x24ed69['length']>0x0&&_0x40a69f[_0x37f387(0x1a8)](_0x24ed69);}const _0x247d65=_0x10363e[_0x5de07f(0x1b9)](_0x320992=>_0x45bbd5(_0x320992));await Promise[_0x5de07f(0x16f)](_0x247d65),_0x1943f8[_0x5de07f(0x1c2)](_0x40a69f);}),router[a0_0xfa02de(0x15c)]('/CheckingWarehouse',async(_0x305098,_0x20f4b7)=>{var _0x28afa1=a0_0xfa02de;const {productCode:_0x571620,bay:_0x55def3,warehouses:_0xfb8ed4,room:_0x405612}=_0x305098['body'];console[_0x28afa1(0x1fb)](_0x305098['body']);try{const _0xa1f2bc=await warehouse[_0x28afa1(0x1d3)]([{'$match':{'name':_0xfb8ed4,'room':_0x405612}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x55def3)}},{'$group':{'_id':_0x28afa1(0x1ac),'name':{'$first':_0x28afa1(0x20c)},'product_stock':{'$first':_0x28afa1(0x1fc)},'bay':{'$first':_0x28afa1(0x16d)},'maxProducts':{'$first':_0x28afa1(0x1fd)}}}]);_0x20f4b7[_0x28afa1(0x20d)](0xc8)[_0x28afa1(0x1c2)](_0xa1f2bc);}catch(_0x22c6c6){_0x20f4b7[_0x28afa1(0x20d)](0x194)['json']({'message':_0x22c6c6[_0x28afa1(0x201)]});}}),module[a0_0xfa02de(0x1fe)]=router;