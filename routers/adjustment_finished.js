var a0_0x210ec7=a0_0x32e7;(function(_0x43ca5a,_0xc3d15d){var _0x4f1bd2=a0_0x32e7,_0x4621d3=_0x43ca5a();while(!![]){try{var _0x1e209c=-parseInt(_0x4f1bd2(0xd8))/0x1*(parseInt(_0x4f1bd2(0x100))/0x2)+-parseInt(_0x4f1bd2(0xfe))/0x3+-parseInt(_0x4f1bd2(0x77))/0x4*(parseInt(_0x4f1bd2(0x79))/0x5)+parseInt(_0x4f1bd2(0xb9))/0x6*(-parseInt(_0x4f1bd2(0x11d))/0x7)+parseInt(_0x4f1bd2(0x9f))/0x8+-parseInt(_0x4f1bd2(0xab))/0x9+parseInt(_0x4f1bd2(0x102))/0xa;if(_0x1e209c===_0xc3d15d)break;else _0x4621d3['push'](_0x4621d3['shift']());}catch(_0x1ca209){_0x4621d3['push'](_0x4621d3['shift']());}}}(a0_0x1f7e,0xa37ac));const express=require(a0_0x210ec7(0x97)),app=express(),router=express[a0_0x210ec7(0xcc)](),auth=require(a0_0x210ec7(0xd3)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_logs,adjustment_finished,email_settings,supervisor_settings,invoice_for_adjustment}=require(a0_0x210ec7(0xe6)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x210ec7(0x86));router[a0_0x210ec7(0xae)](a0_0x210ec7(0xeb),auth,async(_0x3fe47b,_0xf04fd9)=>{var _0x2e34a4=a0_0x210ec7;try{const {username:_0x4033a7,email:_0x5f1dc3,role:_0x4931be}=_0x3fe47b[_0x2e34a4(0xcd)],_0x44436d=_0x3fe47b[_0x2e34a4(0xcd)],_0x2839ff=await profile[_0x2e34a4(0x8d)]({'email':_0x44436d[_0x2e34a4(0xa4)]}),_0x46b6c5=await master_shop['find']();let _0x1265fa;if(_0x44436d[_0x2e34a4(0x119)]==_0x2e34a4(0xff)){const _0x54b209=await staff[_0x2e34a4(0x8d)]({'email':_0x44436d[_0x2e34a4(0xa4)]});_0x1265fa=await warehouse[_0x2e34a4(0x10b)]({'status':_0x2e34a4(0x85),'name':_0x54b209[_0x2e34a4(0xd7)]});}else _0x1265fa=await warehouse[_0x2e34a4(0x10b)]({'status':_0x2e34a4(0x85)});const _0x243484=await product[_0x2e34a4(0x10b)]();let _0x409d2e;if(_0x44436d[_0x2e34a4(0x119)]==_0x2e34a4(0xff)){const _0x514839=await staff['findOne']({'email':_0x44436d[_0x2e34a4(0xa4)]});_0x409d2e=await adjustment_finished[_0x2e34a4(0x10b)]({'warehouse_name':_0x514839[_0x2e34a4(0xd7)]});}else _0x409d2e=await adjustment_finished['aggregate']([{'$match':{'type_of_transaction':_0x2e34a4(0x96)}},{'$unwind':_0x2e34a4(0x11b)},{'$group':{'_id':_0x2e34a4(0xe2),'invoice':{'$first':_0x2e34a4(0x8b)},'date':{'$first':_0x2e34a4(0xcf)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x46b6c5[0x0]['language']==_0x2e34a4(0xc8)){var _0x3b0651=users[_0x2e34a4(0x93)];console[_0x2e34a4(0x9a)](_0x3b0651);}else{if(_0x46b6c5[0x0]['language']==_0x2e34a4(0xe3))var _0x3b0651=users['Hindi'];else{if(_0x46b6c5[0x0][_0x2e34a4(0xaa)]==_0x2e34a4(0xdc))var _0x3b0651=users['German'];else{if(_0x46b6c5[0x0][_0x2e34a4(0xaa)]=='Spanish')var _0x3b0651=users[_0x2e34a4(0x110)];else{if(_0x46b6c5[0x0][_0x2e34a4(0xaa)]==_0x2e34a4(0x98))var _0x3b0651=users['French'];else{if(_0x46b6c5[0x0]['language']==_0x2e34a4(0x9c))var _0x3b0651=users[_0x2e34a4(0xd5)];else{if(_0x46b6c5[0x0][_0x2e34a4(0xaa)]=='Chinese')var _0x3b0651=users[_0x2e34a4(0x90)];else{if(_0x46b6c5[0x0][_0x2e34a4(0xaa)]==_0x2e34a4(0xdd))var _0x3b0651=users['Arabic'];}}}}}}}_0xf04fd9[_0x2e34a4(0xb8)](_0x2e34a4(0x103),{'success':_0x3fe47b[_0x2e34a4(0xbe)](_0x2e34a4(0x7c)),'errors':_0x3fe47b[_0x2e34a4(0xbe)](_0x2e34a4(0xb1)),'role':_0x44436d,'profile':_0x2839ff,'warehouse':_0x1265fa,'product':_0x243484,'adjustment':_0x409d2e,'master_shop':_0x46b6c5,'language':_0x3b0651});}catch(_0x16c34f){console['log'](_0x16c34f);}}),router[a0_0x210ec7(0xae)](a0_0x210ec7(0xb0),auth,async(_0x310aac,_0x5ca9a8)=>{var _0x1c15bf=a0_0x210ec7;try{const {username:_0xcd7cc3,email:_0xf688e1,role:_0x143b1c}=_0x310aac['user'],_0x188842=_0x310aac[_0x1c15bf(0xcd)],_0x42ebb5=await profile[_0x1c15bf(0x8d)]({'email':_0x188842[_0x1c15bf(0xa4)]}),_0x54bd6b=await master_shop[_0x1c15bf(0x10b)]();let _0x132dea;if(_0x188842[_0x1c15bf(0x119)]==_0x1c15bf(0xff)){const _0x56f391=await staff[_0x1c15bf(0x8d)]({'email':_0x188842['email']});_0x132dea=await warehouse['find']({'status':_0x1c15bf(0x85),'name':_0x56f391['warehouse']});}else _0x132dea=await warehouse[_0x1c15bf(0x10b)]({'status':_0x1c15bf(0x85)});const _0x2b3a3e=await product[_0x1c15bf(0x10b)]();let _0x62e322;if(_0x188842[_0x1c15bf(0x119)]==_0x1c15bf(0xff)){const _0xdd4810=await staff['findOne']({'email':_0x188842[_0x1c15bf(0xa4)]});_0x62e322=await adjustment_finished[_0x1c15bf(0x10b)]({'warehouse_name':_0xdd4810[_0x1c15bf(0xd7)]});}else _0x62e322=await adjustment_finished[_0x1c15bf(0xd4)]([{'$match':{'type_of_transaction':_0x1c15bf(0xc3)}},{'$unwind':_0x1c15bf(0x11b)},{'$group':{'_id':_0x1c15bf(0xe2),'invoice':{'$first':_0x1c15bf(0x8b)},'date':{'$first':_0x1c15bf(0xcf)},'warehouse_name':{'$first':_0x1c15bf(0x112)},'room':{'$addToSet':_0x1c15bf(0x81)},'finalize':{'$first':_0x1c15bf(0xd0)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x54bd6b[0x0][_0x1c15bf(0xaa)]==_0x1c15bf(0xc8))var _0x4406cc=users['English'];else{if(_0x54bd6b[0x0]['language']=='Hindi')var _0x4406cc=users[_0x1c15bf(0xe3)];else{if(_0x54bd6b[0x0][_0x1c15bf(0xaa)]=='German')var _0x4406cc=users[_0x1c15bf(0xdc)];else{if(_0x54bd6b[0x0][_0x1c15bf(0xaa)]==_0x1c15bf(0x110))var _0x4406cc=users[_0x1c15bf(0x110)];else{if(_0x54bd6b[0x0]['language']==_0x1c15bf(0x98))var _0x4406cc=users[_0x1c15bf(0x98)];else{if(_0x54bd6b[0x0][_0x1c15bf(0xaa)]==_0x1c15bf(0x9c))var _0x4406cc=users['Portuguese'];else{if(_0x54bd6b[0x0][_0x1c15bf(0xaa)]==_0x1c15bf(0x90))var _0x4406cc=users[_0x1c15bf(0x90)];else{if(_0x54bd6b[0x0][_0x1c15bf(0xaa)]==_0x1c15bf(0xdd))var _0x4406cc=users[_0x1c15bf(0xd1)];}}}}}}}_0x5ca9a8[_0x1c15bf(0xb8)]('adjustment_finished_logs',{'success':_0x310aac[_0x1c15bf(0xbe)](_0x1c15bf(0x7c)),'errors':_0x310aac[_0x1c15bf(0xbe)](_0x1c15bf(0xb1)),'role':_0x188842,'profile':_0x42ebb5,'warehouse':_0x132dea,'product':_0x2b3a3e,'adjustment':_0x62e322,'master_shop':_0x54bd6b,'language':_0x4406cc});}catch(_0x414e6f){console[_0x1c15bf(0x9a)](_0x414e6f);}});async function getRandom8DigitNumber(){var _0x1cfd5f=a0_0x210ec7;const _0x2258d2=0x989680,_0x232f12=0x5f5e0ff,_0x4ec5c0=Math[_0x1cfd5f(0x8a)](Math['random']()*(_0x232f12-_0x2258d2+0x1))+_0x2258d2;var _0x460ab5;const _0x4211a7=await adjustment_finished[_0x1cfd5f(0x8d)]({'invoice':_0x1cfd5f(0xb2)+_0x4ec5c0});return _0x4211a7&&_0x4211a7[_0x1cfd5f(0xe5)]>0x0?_0x460ab5='ADJF-'+_0x4ec5c0:_0x460ab5='ADJF-'+_0x4ec5c0,_0x460ab5;}router[a0_0x210ec7(0xae)](a0_0x210ec7(0xd9),auth,async(_0x1f0b5f,_0x450004)=>{var _0x37a036=a0_0x210ec7;try{const {username:_0x1f1169,email:_0x205368,role:_0xe6961f}=_0x1f0b5f[_0x37a036(0xcd)],_0x2d9aa0=_0x1f0b5f[_0x37a036(0xcd)],_0x4eb362=await profile[_0x37a036(0x8d)]({'email':_0x2d9aa0[_0x37a036(0xa4)]}),_0x47e773=await master_shop['find']();let _0x324485;if(_0x2d9aa0[_0x37a036(0x119)]==_0x37a036(0xff)){const _0x1962f2=await staff['findOne']({'email':_0x2d9aa0[_0x37a036(0xa4)]});_0x324485=await warehouse['aggregate']([{'$match':{'status':_0x37a036(0x85),'name':_0x1962f2[_0x37a036(0xd7)]}},{'$group':{'_id':_0x37a036(0xa9),'name':{'$first':_0x37a036(0xa9)}}}]);}else _0x324485=await warehouse['aggregate']([{'$match':{'status':_0x37a036(0x85)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x50d22b=await product['find']({}),_0x4c7c73=await adjustment_finished[_0x37a036(0x10b)](),_0x575b3b=_0x4c7c73['length']+0x1,_0x1bf9e3='ADJF-'+_0x575b3b['toString']()['padStart'](0x5,'0');var _0x48ce5b=[_0x37a036(0x105),'Enclosed',_0x37a036(0xdb)];if(_0x47e773[0x0][_0x37a036(0xaa)]==_0x37a036(0xc8))var _0x8d329b=users[_0x37a036(0x93)];else{if(_0x47e773[0x0][_0x37a036(0xaa)]==_0x37a036(0xe3))var _0x8d329b=users[_0x37a036(0xe3)];else{if(_0x47e773[0x0][_0x37a036(0xaa)]==_0x37a036(0xdc))var _0x8d329b=users[_0x37a036(0xdc)];else{if(_0x47e773[0x0][_0x37a036(0xaa)]==_0x37a036(0x110))var _0x8d329b=users['Spanish'];else{if(_0x47e773[0x0]['language']==_0x37a036(0x98))var _0x8d329b=users[_0x37a036(0x98)];else{if(_0x47e773[0x0][_0x37a036(0xaa)]=='Portuguese\x20(BR)')var _0x8d329b=users[_0x37a036(0xd5)];else{if(_0x47e773[0x0]['language']==_0x37a036(0x90))var _0x8d329b=users[_0x37a036(0x90)];else{if(_0x47e773[0x0][_0x37a036(0xaa)]==_0x37a036(0xdd))var _0x8d329b=users[_0x37a036(0xd1)];}}}}}}}const _0x1a61c0=getRandom8DigitNumber();_0x1a61c0[_0x37a036(0xfc)](_0x10dfbc=>{var _0x5121ed=_0x37a036;_0x450004['render'](_0x5121ed(0x11c),{'success':_0x1f0b5f[_0x5121ed(0xbe)](_0x5121ed(0x7c)),'errors':_0x1f0b5f['flash'](_0x5121ed(0xb1)),'role':_0x2d9aa0,'profile':_0x4eb362,'warehouse':_0x324485,'product':_0x50d22b,'master_shop':_0x47e773,'language':_0x8d329b,'rooms_data':_0x48ce5b,'invoice_no':_0x10dfbc});})[_0x37a036(0xa7)](_0x2b3b3f=>{var _0x1051ad=_0x37a036;_0x1f0b5f[_0x1051ad(0xbe)]('errors',_0x1051ad(0xad)),_0x450004[_0x1051ad(0xf9)]('/adjustment/view');});}catch(_0x257e73){console['log'](_0x257e73);}}),router[a0_0x210ec7(0x8c)](a0_0x210ec7(0xd9),auth,async(_0x4a5f35,_0x215f77)=>{var _0x66eea2=a0_0x210ec7;try{const {warehouse_name:_0x4a0355,date:_0x1a9ac5,prod_name:_0x3c42be,level:_0x2c7dc3,isle:_0x3a593f,pallet:_0x561ae0,stock:_0x158ad0,types:_0x5a7c06,adjust_qty:_0x4b644c,new_adjust_qty:_0x252f3d,note:_0x29848d,Room_name:_0x583c61,JO_number:_0x470788,expiry_date:_0x18d3af,PO_number:_0x29edf0,ReqBy:_0x6adfd5,dateofreq:_0x2f4c98,typeservicesData:_0x9e845c,destination:_0x1ab17e,deliverydate:_0x3f2510,driver:_0x168f4c,plate:_0x176051,van:_0x13b181,DRSI:_0x3a2e95,typevehicle:_0xfb6a4c,TSU:_0x6d3350,TFU:_0xdec0e3}=_0x4a5f35['body'];if(typeof _0x3c42be==_0x66eea2(0xbf))var _0x5d5df7=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x7b)]],_0x5bc635=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xc4)]],_0x340234=[_0x4a5f35['body']['stock']],_0x3c4258=[_0x4a5f35[_0x66eea2(0xa5)]['types']],_0x367c36=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x87)]],_0x1df7d7=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xd2)]],_0x34be01=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xc1)]],_0x3a1bbd=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xdf)]],_0x31ae97=[_0x4a5f35['body']['prod_code']],_0x3d1a1a=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x11f)]],_0x166c74=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xb6)]],_0x1d85e6=[_0x4a5f35[_0x66eea2(0xa5)]['product_date']],_0x14bb01=[_0x4a5f35['body']['prod_cat']],_0x35aacf=[_0x4a5f35['body'][_0x66eea2(0xbc)]],_0x458778=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x7f)]],_0x4e9696=[_0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x92)]],_0x4a62c0=[_0x4a5f35['body'][_0x66eea2(0xbb)]];else var _0x5d5df7=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x7b)]],_0x5bc635=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xc4)]],_0x340234=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xfa)]],_0x3c4258=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xf5)]],_0x367c36=[..._0x4a5f35['body'][_0x66eea2(0x87)]],_0x1df7d7=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xd2)]],_0x34be01=[..._0x4a5f35['body'][_0x66eea2(0xc1)]],_0x3a1bbd=[..._0x4a5f35['body']['Secondary_units']],_0x31ae97=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x118)]],_0x3d1a1a=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x11f)]],_0x166c74=[..._0x4a5f35[_0x66eea2(0xa5)]['expiry_date']],_0x1d85e6=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x104)]],_0x14bb01=[..._0x4a5f35[_0x66eea2(0xa5)]['prod_cat']],_0x35aacf=[..._0x4a5f35['body'][_0x66eea2(0xbc)]],_0x458778=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x7f)]],_0x4e9696=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0x92)]],_0x4a62c0=[..._0x4a5f35[_0x66eea2(0xa5)][_0x66eea2(0xbb)]];const _0x1f9304=_0x5d5df7[_0x66eea2(0x82)](_0x38fc37=>{return _0x38fc37={'product_name':_0x38fc37};});_0x5bc635[_0x66eea2(0xf7)]((_0x9a085c,_0x80c1d3)=>{var _0x17529c=_0x66eea2,_0x47fa9d=_0x9a085c[_0x17529c(0x84)](/[A-Za-z]+/)[0x0],_0x17d1bc=parseInt(_0x9a085c[_0x17529c(0x84)](/\d+/)[0x0]);_0x1f9304[_0x80c1d3][_0x17529c(0xc4)]=_0x47fa9d,_0x1f9304[_0x80c1d3][_0x17529c(0x7a)]=_0x17d1bc;}),_0x4a62c0[_0x66eea2(0xf7)]((_0x3c4210,_0xc6fe56)=>{var _0x121a29=_0x66eea2;_0x1f9304[_0xc6fe56][_0x121a29(0x122)]=_0x3c4210;}),_0x340234[_0x66eea2(0xf7)]((_0x1efb7e,_0xe693ed)=>{var _0x197c77=_0x66eea2;_0x1f9304[_0xe693ed][_0x197c77(0xce)]=_0x1efb7e;}),_0x3c4258['forEach']((_0x3be688,_0x2d130a)=>{_0x1f9304[_0x2d130a]['types']=_0x3be688;}),_0x367c36[_0x66eea2(0xf7)]((_0x162e31,_0x4a6aed)=>{var _0x366d90=_0x66eea2;_0x1f9304[_0x4a6aed][_0x366d90(0xf8)]=_0x162e31;}),_0x1df7d7['forEach']((_0x4cbf16,_0x35f61b)=>{_0x1f9304[_0x35f61b]['new_adjust_qty']=_0x4cbf16;}),_0x34be01[_0x66eea2(0xf7)]((_0x2d2fad,_0x1ca0ac)=>{_0x1f9304[_0x1ca0ac]['unit']=_0x2d2fad;}),_0x3a1bbd['forEach']((_0x158d62,_0x657d68)=>{var _0x3f0a3b=_0x66eea2;_0x1f9304[_0x657d68][_0x3f0a3b(0xe9)]=_0x158d62;}),_0x31ae97['forEach']((_0x5efdb5,_0x491907)=>{_0x1f9304[_0x491907]['product_code']=_0x5efdb5;}),_0x3d1a1a[_0x66eea2(0xf7)]((_0x23505f,_0x38eeda)=>{var _0x319e72=_0x66eea2;_0x1f9304[_0x38eeda][_0x319e72(0x11f)]=_0x23505f;}),_0x166c74['forEach']((_0x1c16f6,_0x3ac435)=>{var _0x310900=_0x66eea2;_0x1f9304[_0x3ac435][_0x310900(0xb6)]=_0x1c16f6;}),_0x1d85e6[_0x66eea2(0xf7)]((_0x2b82d7,_0x124928)=>{_0x1f9304[_0x124928]['production_date']=_0x2b82d7;}),_0x14bb01[_0x66eea2(0xf7)]((_0x56f203,_0x206559)=>{var _0xad4f4c=_0x66eea2;_0x1f9304[_0x206559][_0xad4f4c(0x101)]=_0x56f203;}),_0x35aacf[_0x66eea2(0xf7)]((_0x362226,_0x1062b2)=>{_0x1f9304[_0x1062b2]['room_names']=_0x362226;}),_0x458778['forEach']((_0x10fbb5,_0x56c885)=>{_0x1f9304[_0x56c885]['maxPerUnit']=_0x10fbb5;}),_0x4e9696['forEach']((_0xcdebc6,_0x2c489)=>{_0x1f9304[_0x2c489]['invoice']=_0xcdebc6;});const _0x7366dd=_0x1f9304[_0x66eea2(0x120)](_0x380dd6=>_0x380dd6['adjust_qty']!=='0'&&_0x380dd6[_0x66eea2(0xf8)]!=='');var _0x58e75c=0x0;_0x7366dd[_0x66eea2(0xf7)](_0x586b8f=>{var _0x581b81=_0x66eea2;console[_0x581b81(0x9a)](_0x581b81(0x108),_0x586b8f),parseInt(_0x586b8f[_0x581b81(0xf8)])<=0x0&&_0x58e75c++;});if(_0x58e75c!=0x0)return _0x4a5f35[_0x66eea2(0xbe)](_0x66eea2(0xb1),_0x66eea2(0x9d)),_0x215f77[_0x66eea2(0xf9)]('back');const _0x315da1=new invoice_for_adjustment();await _0x315da1[_0x66eea2(0x10a)]();const _0x5b7ecd=new adjustment_finished({'warehouse_name':_0x4a0355,'date':_0x1a9ac5,'product':_0x7366dd,'note':_0x29848d,'room':_0x583c61,'invoice':_0x66eea2(0x76)+_0x315da1[_0x66eea2(0xfb)][_0x66eea2(0xb3)]()[_0x66eea2(0x99)](0x8,'0'),'JO_number':_0x470788,'expiry_date':_0x18d3af,'PO_number':_0x29edf0,'RequestedBy':_0x6adfd5,'DateofRequest':_0x2f4c98,'typeservices':_0x9e845c,'destination':_0x1ab17e,'deliverydate':_0x3f2510,'driver':_0x168f4c,'plate':_0x176051,'van':_0x13b181,'DRSI':_0x3a2e95,'typevehicle':_0xfb6a4c,'TSU':_0x6d3350,'TFU':_0xdec0e3}),_0x10b858=await _0x5b7ecd[_0x66eea2(0x10a)]();_0x4a5f35[_0x66eea2(0xbe)]('success',_0x66eea2(0xf3)),_0x215f77[_0x66eea2(0xf9)]('/adjustment_finished/preview/'+_0x10b858[_0x66eea2(0xa6)]);}catch(_0x25e56f){console[_0x66eea2(0x9a)](_0x25e56f),_0x215f77['status'](0xc8)['json']({'message':_0x25e56f['message']});}}),router['get'](a0_0x210ec7(0xa1),auth,async(_0x14cf1e,_0x1e3373)=>{var _0x4d380a=a0_0x210ec7;try{const {username:_0x17c373,email:_0x5096c5,role:_0x23406d}=_0x14cf1e[_0x4d380a(0xcd)],_0x486751=_0x14cf1e[_0x4d380a(0xcd)],_0xaae892=await profile[_0x4d380a(0x8d)]({'email':_0x486751[_0x4d380a(0xa4)]}),_0x198e67=await master_shop[_0x4d380a(0x10b)]();let _0x2f8157;if(_0x486751[_0x4d380a(0x119)]==_0x4d380a(0xff)){const _0x5b35e3=await staff[_0x4d380a(0x8d)]({'email':_0x486751[_0x4d380a(0xa4)]});_0x2f8157=await warehouse[_0x4d380a(0xd4)]([{'$match':{'status':_0x4d380a(0x85),'name':_0x5b35e3['warehouse']}},{'$group':{'_id':'$name','name':{'$first':_0x4d380a(0xa9)}}}]);}else _0x2f8157=await warehouse[_0x4d380a(0xd4)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x35c30b=await product[_0x4d380a(0x10b)](),_0x529421=await adjustment_finished[_0x4d380a(0x10b)](),_0x56e24a=_0x529421[_0x4d380a(0xe5)]+0x1,_0x4fc567=_0x4d380a(0xb2)+_0x56e24a[_0x4d380a(0xb3)]()[_0x4d380a(0x99)](0x5,'0');var _0x562812=[_0x4d380a(0x105),_0x4d380a(0x83),'Return\x20Rooms'];if(_0x198e67[0x0][_0x4d380a(0xaa)]==_0x4d380a(0xc8))var _0x19edf7=users[_0x4d380a(0x93)];else{if(_0x198e67[0x0][_0x4d380a(0xaa)]==_0x4d380a(0xe3))var _0x19edf7=users['Hindi'];else{if(_0x198e67[0x0][_0x4d380a(0xaa)]==_0x4d380a(0xdc))var _0x19edf7=users[_0x4d380a(0xdc)];else{if(_0x198e67[0x0][_0x4d380a(0xaa)]==_0x4d380a(0x110))var _0x19edf7=users['Spanish'];else{if(_0x198e67[0x0][_0x4d380a(0xaa)]==_0x4d380a(0x98))var _0x19edf7=users['French'];else{if(_0x198e67[0x0][_0x4d380a(0xaa)]==_0x4d380a(0x9c))var _0x19edf7=users[_0x4d380a(0xd5)];else{if(_0x198e67[0x0]['language']==_0x4d380a(0x90))var _0x19edf7=users[_0x4d380a(0x90)];else{if(_0x198e67[0x0][_0x4d380a(0xaa)]==_0x4d380a(0xdd))var _0x19edf7=users['Arabic'];}}}}}}}const _0x32bccb=getRandom8DigitNumber();_0x32bccb[_0x4d380a(0xfc)](_0x2e03d9=>{var _0x1fe8dd=_0x4d380a;_0x1e3373['render'](_0x1fe8dd(0xb4),{'success':_0x14cf1e[_0x1fe8dd(0xbe)]('success'),'errors':_0x14cf1e[_0x1fe8dd(0xbe)](_0x1fe8dd(0xb1)),'role':_0x486751,'profile':_0xaae892,'warehouse':_0x2f8157,'product':_0x35c30b,'master_shop':_0x198e67,'language':_0x19edf7,'rooms_data':_0x562812,'invoice_no':_0x2e03d9});})['catch'](_0x2ff4c3=>{var _0xb61ceb=_0x4d380a;_0x14cf1e[_0xb61ceb(0xbe)]('errors',_0xb61ceb(0xad)),_0x1e3373[_0xb61ceb(0xf9)]('/adjustment/view');});}catch(_0xfbd46b){console[_0x4d380a(0x9a)](_0xfbd46b);}}),router[a0_0x210ec7(0x8c)](a0_0x210ec7(0xa1),auth,async(_0xbeadaa,_0x2c5671)=>{var _0xa995ca=a0_0x210ec7;try{const {warehouse_name:_0x4f2155,date:_0x270169,prod_name:_0x28260d,level:_0x44060e,isle:_0x3af8b7,pallet:_0x55dcd6,stock:_0x8eab67,types:_0x57666e,adjust_qty:_0x4715bc,new_adjust_qty:_0x33e566,note:_0x467b8d,Room_name:_0x10641a,JO_number:_0x45a850,expiry_date:_0x6d42b5,type_of_transaction:_0x442990,PO_number:_0x42297e,ReqBy:_0x33d9cb,dateofreq:_0x20998c,typeservicesData:_0x3236a0,destination:_0x2ab7fc,deliverydate:_0x519838,driver:_0x471dc4,plate:_0x55ace6,van:_0x1f66da,DRSI:_0x292c8a,typevehicle:_0xe42a3b,TSU:_0x1a0f11,TFU:_0x158c17}=_0xbeadaa['body'];if(typeof _0x28260d==_0xa995ca(0xbf))var _0x25a44f=[_0xbeadaa['body'][_0xa995ca(0x7b)]],_0x383b5d=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xc4)]],_0x32a226=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xfa)]],_0x29846e=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xf5)]],_0x2b2b7f=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x87)]],_0x36a3fc=[_0xbeadaa['body']['New_Qty_Converted']],_0xb63acf=[_0xbeadaa['body']['Primary_Units']],_0x43ffec=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xdf)]],_0x288ac2=[_0xbeadaa['body'][_0xa995ca(0x118)]],_0x5b2144=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x11f)]],_0x2b4021=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xb6)]],_0x1a1987=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x104)]],_0x25240e=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x101)]],_0x3c22e2=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xbc)]],_0x57e705=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x7f)]],_0x3fc1f6=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x92)]],_0xfea545=[_0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xbb)]];else var _0x25a44f=[..._0xbeadaa['body']['prod_name']],_0x383b5d=[..._0xbeadaa[_0xa995ca(0xa5)]['level']],_0x32a226=[..._0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xfa)]],_0x29846e=[..._0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xf5)]],_0x2b2b7f=[..._0xbeadaa['body'][_0xa995ca(0x87)]],_0x36a3fc=[..._0xbeadaa[_0xa995ca(0xa5)]['New_Qty_Converted']],_0xb63acf=[..._0xbeadaa['body'][_0xa995ca(0xc1)]],_0x43ffec=[..._0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xdf)]],_0x288ac2=[..._0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x118)]],_0x5b2144=[..._0xbeadaa[_0xa995ca(0xa5)]['batch_code']],_0x2b4021=[..._0xbeadaa['body'][_0xa995ca(0xb6)]],_0x1a1987=[..._0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x104)]],_0x25240e=[..._0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x101)]],_0x3c22e2=[..._0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xbc)]],_0x57e705=[..._0xbeadaa['body'][_0xa995ca(0x7f)]],_0x3fc1f6=[..._0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0x92)]],_0xfea545=[..._0xbeadaa[_0xa995ca(0xa5)][_0xa995ca(0xbb)]];const _0x18c281=_0x25a44f['map'](_0x3be541=>{return _0x3be541={'product_name':_0x3be541};});_0x383b5d['forEach']((_0x1470b5,_0x26e6d8)=>{var _0x41bd60=_0xa995ca,_0x405556=_0x1470b5[_0x41bd60(0x84)](/[A-Za-z]+/)[0x0],_0x213c2f=parseInt(_0x1470b5[_0x41bd60(0x84)](/\d+/)[0x0]);_0x18c281[_0x26e6d8]['level']=_0x405556,_0x18c281[_0x26e6d8][_0x41bd60(0x7a)]=_0x213c2f;}),_0xfea545['forEach']((_0x188d0c,_0x5908d5)=>{var _0x1870f3=_0xa995ca;_0x18c281[_0x5908d5][_0x1870f3(0x122)]=_0x188d0c;}),_0x32a226['forEach']((_0x234a0d,_0x322e15)=>{var _0x57d1ff=_0xa995ca;_0x18c281[_0x322e15][_0x57d1ff(0xce)]=_0x234a0d;}),_0x29846e['forEach']((_0x5e9161,_0x3e9d8f)=>{var _0x492264=_0xa995ca;_0x18c281[_0x3e9d8f][_0x492264(0xf5)]=_0x5e9161;}),_0x2b2b7f[_0xa995ca(0xf7)]((_0x5a32cb,_0x2c961d)=>{var _0x3f0ff0=_0xa995ca;_0x18c281[_0x2c961d][_0x3f0ff0(0xf8)]=_0x5a32cb;}),_0x36a3fc[_0xa995ca(0xf7)]((_0x583568,_0x511a4a)=>{var _0xa8e50a=_0xa995ca;_0x18c281[_0x511a4a][_0xa8e50a(0xa0)]=_0x583568;}),_0xb63acf[_0xa995ca(0xf7)]((_0x130cdb,_0x3d25de)=>{var _0x1f0a7f=_0xa995ca;_0x18c281[_0x3d25de][_0x1f0a7f(0xbd)]=_0x130cdb;}),_0x43ffec['forEach']((_0x5dc94c,_0x1ba1d0)=>{var _0xcb6c6d=_0xa995ca;_0x18c281[_0x1ba1d0][_0xcb6c6d(0xe9)]=_0x5dc94c;}),_0x288ac2[_0xa995ca(0xf7)]((_0x2b5f95,_0x11e3e1)=>{var _0x472731=_0xa995ca;_0x18c281[_0x11e3e1][_0x472731(0xa8)]=_0x2b5f95;}),_0x5b2144[_0xa995ca(0xf7)]((_0x34fa50,_0xba209)=>{_0x18c281[_0xba209]['batch_code']=_0x34fa50;}),_0x2b4021[_0xa995ca(0xf7)]((_0x3878b9,_0x28b144)=>{var _0x1b2421=_0xa995ca;_0x18c281[_0x28b144][_0x1b2421(0xb6)]=_0x3878b9;}),_0x1a1987[_0xa995ca(0xf7)]((_0x7a39eb,_0x60c569)=>{var _0x487de4=_0xa995ca;_0x18c281[_0x60c569][_0x487de4(0x89)]=_0x7a39eb;}),_0x25240e[_0xa995ca(0xf7)]((_0x5bf2b5,_0x23cda0)=>{var _0x1969e5=_0xa995ca;_0x18c281[_0x23cda0][_0x1969e5(0x101)]=_0x5bf2b5;}),_0x3c22e2['forEach']((_0xa7112d,_0x226dfa)=>{var _0x55c648=_0xa995ca;_0x18c281[_0x226dfa][_0x55c648(0xf6)]=_0xa7112d;}),_0x57e705[_0xa995ca(0xf7)]((_0xb96090,_0x4ad6fe)=>{_0x18c281[_0x4ad6fe]['maxPerUnit']=_0xb96090;}),_0x3fc1f6[_0xa995ca(0xf7)]((_0x5cde4e,_0x321d74)=>{var _0x276f5f=_0xa995ca;_0x18c281[_0x321d74][_0x276f5f(0x78)]=_0x5cde4e;});const _0x565899=_0x18c281[_0xa995ca(0x120)](_0x3c6a4a=>_0x3c6a4a[_0xa995ca(0xf8)]!=='0'&&_0x3c6a4a[_0xa995ca(0xf8)]!=='');var _0x587157=0x0;_0x565899['forEach'](_0xf96ec9=>{var _0x978482=_0xa995ca;console[_0x978482(0x9a)](_0x978482(0x108),_0xf96ec9),parseInt(_0xf96ec9[_0x978482(0xf8)])<=0x0&&_0x587157++;});if(_0x587157!=0x0)return _0xbeadaa[_0xa995ca(0xbe)](_0xa995ca(0xb1),_0xa995ca(0x9d)),_0x2c5671['redirect'](_0xa995ca(0xf1));const _0x188413=new adjustment_logs();await _0x188413['save']();const _0x4cfd00=new adjustment_finished({'warehouse_name':_0x4f2155,'date':_0x270169,'product':_0x565899,'note':_0x467b8d,'room':_0x10641a,'invoice':'LOG-ADJ-'+_0x188413['invoice_init']['toString']()[_0xa995ca(0x99)](0x8,'0'),'JO_number':_0x45a850,'expiry_date':_0x6d42b5,'type_of_transaction':_0x442990,'PO_number':_0x42297e,'RequestedBy':_0x33d9cb,'DateofRequest':_0x20998c,'typeservices':_0x3236a0,'destination':_0x2ab7fc,'deliverydate':_0x519838,'driver':_0x471dc4,'plate':_0x55ace6,'van':_0x1f66da,'DRSI':_0x292c8a,'typevehicle':_0xe42a3b,'TSU':_0x1a0f11,'TFU':_0x158c17}),_0x2c350f=await _0x4cfd00[_0xa995ca(0x10a)]();_0xbeadaa['flash'](_0xa995ca(0x7c),'adjustment\x20add\x20successfull'),_0x2c5671[_0xa995ca(0xf9)](_0xa995ca(0x80)+_0x2c350f[_0xa995ca(0xa6)]);}catch(_0x968c40){console[_0xa995ca(0x9a)](_0x968c40),_0x2c5671['status'](0xc8)[_0xa995ca(0x116)]({'message':_0x968c40[_0xa995ca(0x94)]});}}),router[a0_0x210ec7(0xae)]('/preview/:id',auth,async(_0x381cb2,_0x11f7c6)=>{var _0x48cebb=a0_0x210ec7;try{const {username:_0x494a23,email:_0x551aa5,role:_0x816e6e}=_0x381cb2[_0x48cebb(0xcd)],_0x32a91a=_0x381cb2[_0x48cebb(0xcd)],_0x26fd11=await profile['findOne']({'email':_0x32a91a['email']}),_0x1126e6=await master_shop[_0x48cebb(0x10b)](),_0x4a5582=_0x381cb2['params']['id'],_0x8fa860=await adjustment_finished[_0x48cebb(0xda)]({'_id':_0x4a5582}),_0x3b72f6=await purchases[_0x48cebb(0xd4)]([{'$match':{'warehouse_name':_0x8fa860[_0x48cebb(0xe4)]}},{'$unwind':_0x48cebb(0x11b)},{'$group':{'_id':_0x48cebb(0x10d)}}]);console[_0x48cebb(0x9a)](_0x48cebb(0xaf),_0x3b72f6);const _0x9d1486=await product[_0x48cebb(0x10b)]({}),_0xc85902=await warehouse[_0x48cebb(0xd4)]([{'$match':{'name':_0x8fa860[_0x48cebb(0xe4)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x48cebb(0x8e)},'bay':{'$first':_0x48cebb(0xf2)},'bin':{'$first':_0x48cebb(0xc0)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x48cebb(0x114)},'secondary_code':{'$first':_0x48cebb(0xed)},'product_code':{'$first':_0x48cebb(0x8f)},'storage':{'$first':_0x48cebb(0x117)},'rack':{'$first':_0x48cebb(0xa3)},'expiry_date':{'$first':_0x48cebb(0x9b)},'production_date':{'$first':_0x48cebb(0xc5)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x48cebb(0x88)},'room':{'$first':_0x48cebb(0x91)}}}]);if(_0x1126e6[0x0][_0x48cebb(0xaa)]==_0x48cebb(0xc8)){var _0x556b28=users['English'];console[_0x48cebb(0x9a)](_0x556b28);}else{if(_0x1126e6[0x0][_0x48cebb(0xaa)]==_0x48cebb(0xe3))var _0x556b28=users['Hindi'];else{if(_0x1126e6[0x0]['language']==_0x48cebb(0xdc))var _0x556b28=users['German'];else{if(_0x1126e6[0x0][_0x48cebb(0xaa)]==_0x48cebb(0x110))var _0x556b28=users[_0x48cebb(0x110)];else{if(_0x1126e6[0x0][_0x48cebb(0xaa)]==_0x48cebb(0x98))var _0x556b28=users[_0x48cebb(0x98)];else{if(_0x1126e6[0x0]['language']=='Portuguese\x20(BR)')var _0x556b28=users['Portuguese'];else{if(_0x1126e6[0x0][_0x48cebb(0xaa)]==_0x48cebb(0x90))var _0x556b28=users[_0x48cebb(0x90)];else{if(_0x1126e6[0x0][_0x48cebb(0xaa)]==_0x48cebb(0xdd))var _0x556b28=users[_0x48cebb(0xd1)];}}}}}}}_0x11f7c6['render']('edit_adjustment_finished_view',{'success':_0x381cb2[_0x48cebb(0xbe)]('success'),'errors':_0x381cb2[_0x48cebb(0xbe)](_0x48cebb(0xb1)),'role':_0x32a91a,'profile':_0x26fd11,'adjustment':_0x8fa860,'stock':_0xc85902,'master_shop':_0x1126e6,'warehouse_name':_0x3b72f6,'unit':_0x9d1486,'language':_0x556b28});}catch(_0x50931d){console[_0x48cebb(0x9a)](_0x50931d),_0x11f7c6[_0x48cebb(0x9e)](0xc8)[_0x48cebb(0x116)]({'message':_0x50931d[_0x48cebb(0x94)]});}}),router[a0_0x210ec7(0x8c)](a0_0x210ec7(0xe8),auth,async(_0x14705c,_0x46616e)=>{var _0x4d8423=a0_0x210ec7;try{const {invoice:_0x4a3582,warehouse_name:_0x1e4fdb,Room_name:_0x4b601f}=_0x14705c['body'],_0x3cd8c5=_0x14705c[_0x4d8423(0x109)]['id'],_0x211362=await adjustment_finished['findById']({'_id':_0x3cd8c5});var _0x2d9cef;const _0x326526=_0x211362['product']['map'](async _0x2d96b5=>{var _0x569449=_0x4d8423;if(_0x2d96b5['adjust_qty']>0x0){_0x2d9cef=await warehouse[_0x569449(0x8d)]({'name':_0x1e4fdb,'room':_0x2d96b5[_0x569449(0xf6)]});const _0x3304ab=_0x2d9cef[_0x569449(0xd6)][_0x569449(0x82)](_0x146634=>{var _0x582cc7=_0x569449;console[_0x582cc7(0x9a)](_0x2d96b5[_0x582cc7(0xf5)]);if(_0x2d96b5[_0x582cc7(0xf5)]==_0x582cc7(0x10f))_0x146634[_0x582cc7(0xa6)]==_0x2d96b5[_0x582cc7(0x122)]&&(_0x146634[_0x582cc7(0xf4)]=_0x146634['product_stock']-_0x2d96b5[_0x582cc7(0xf8)]);else _0x2d96b5[_0x582cc7(0xf5)]=='add'&&(_0x146634[_0x582cc7(0xa6)]==_0x2d96b5[_0x582cc7(0x122)]&&(_0x146634['product_stock']=_0x146634[_0x582cc7(0xf4)]+_0x2d96b5[_0x582cc7(0xf8)]));});}return _0x2d9cef;});Promise[_0x4d8423(0x123)](_0x326526)[_0x4d8423(0xfc)](async _0x40976c=>{var _0x5be8b3=_0x4d8423;try{for(const _0x31d70d of _0x40976c){await _0x31d70d[_0x5be8b3(0x10a)]();}_0x211362['finalize']=_0x5be8b3(0x113);const _0xe6ef4c=await _0x211362[_0x5be8b3(0x10a)](),_0x43fb62=await master_shop['find'](),_0x825b12=await email_settings[_0x5be8b3(0x8d)](),_0x1824ce=await supervisor_settings[_0x5be8b3(0x10b)]();var _0x3d386d=_0x211362[_0x5be8b3(0xee)],_0x1c2deb='',_0x34827c;for(_0x34827c in _0x3d386d){var _0x2e3649='FG';_0x211362[_0x5be8b3(0xe4)]==_0x5be8b3(0x115)&&(_0x2e3649='DG'),_0x1c2deb+=_0x5be8b3(0x11a)+_0x5be8b3(0x10c)+_0x3d386d[_0x34827c][_0x5be8b3(0x121)]+_0x5be8b3(0x111)+_0x5be8b3(0x10c)+_0x3d386d[_0x34827c][_0x5be8b3(0xa8)]+_0x5be8b3(0x111)+_0x5be8b3(0x10c)+_0x3d386d[_0x34827c][_0x5be8b3(0xf8)]+_0x5be8b3(0x111)+_0x5be8b3(0x10c)+_0x3d386d[_0x34827c][_0x5be8b3(0xbd)]+'</td>'+_0x5be8b3(0x10c)+_0x3d386d[_0x34827c][_0x5be8b3(0xe9)]+_0x5be8b3(0x111)+_0x5be8b3(0x10c)+_0x211362[_0x5be8b3(0xe4)]+_0x5be8b3(0x111)+_0x5be8b3(0x10c)+_0x3d386d[_0x34827c][_0x5be8b3(0xf6)]+_0x5be8b3(0x111)+_0x5be8b3(0x10c)+_0x2e3649+_0x3d386d[_0x34827c][_0x5be8b3(0x7a)]+_0x5be8b3(0x111)+'</tr>';}_0x14705c[_0x5be8b3(0xbe)](_0x5be8b3(0x7c),_0x5be8b3(0xfd)),_0x46616e[_0x5be8b3(0xf9)](_0x5be8b3(0x107)+_0xe6ef4c[_0x5be8b3(0xa6)]);}catch(_0x9518c0){console['error'](_0x9518c0),_0x46616e['status'](0x1f4)[_0x5be8b3(0x116)]({'error':_0x5be8b3(0xef)});}})[_0x4d8423(0xa7)](_0x593d74=>{var _0x58c9db=_0x4d8423;console['error'](_0x593d74),_0x46616e[_0x58c9db(0x9e)](0x1f4)[_0x58c9db(0x116)]({'error':_0x58c9db(0xea)});});}catch(_0x2e2f7d){_0x46616e['json']({'message':_0x2e2f7d[_0x4d8423(0x94)]});}}),router[a0_0x210ec7(0xae)](a0_0x210ec7(0xc7),auth,async(_0x3e1f66,_0x1a9bc9)=>{var _0x5503a5=a0_0x210ec7;try{const {username:_0x5735e,email:_0x1f08f2,role:_0x16a9cb}=_0x3e1f66[_0x5503a5(0xcd)],_0x18c781=_0x3e1f66[_0x5503a5(0xcd)],_0x32fd0a=await profile[_0x5503a5(0x8d)]({'email':_0x18c781[_0x5503a5(0xa4)]}),_0x270b05=await master_shop['find']();console[_0x5503a5(0x9a)](_0x5503a5(0xac),_0x270b05);const _0x4c020=_0x3e1f66[_0x5503a5(0x109)]['id'],_0x17aac4=await adjustment_finished[_0x5503a5(0xda)]({'_id':_0x4c020});let _0x1fd156=new Date(_0x17aac4[_0x5503a5(0xb6)]),_0x365a4d=('0'+_0x1fd156['getDate']())['slice'](-0x2),_0x3e27a0=('0'+(_0x1fd156[_0x5503a5(0xc9)]()+0x1))[_0x5503a5(0xc6)](-0x2),_0x366bda=_0x1fd156[_0x5503a5(0x95)](),_0x499cb5=_0x366bda+'-'+_0x3e27a0+'-'+_0x365a4d;var _0x4ae29f=[_0x5503a5(0x105),'Enclosed',_0x5503a5(0xdb)];const _0x20c692=await purchases[_0x5503a5(0xd4)]([{'$match':{'warehouse_name':_0x17aac4[_0x5503a5(0xe4)]}},{'$unwind':_0x5503a5(0x11b)},{'$group':{'_id':_0x5503a5(0x10d)}}]);console[_0x5503a5(0x9a)](_0x5503a5(0xaf),_0x20c692);const _0x1e06ec=await product['find']({}),_0xd32b7e=await warehouse[_0x5503a5(0xd4)]([{'$match':{'name':_0x17aac4[_0x5503a5(0xe4)],'room':_0x17aac4[_0x5503a5(0xe1)]}},{'$unwind':_0x5503a5(0x11e)},{'$group':{'_id':_0x5503a5(0x106),'name':{'$first':_0x5503a5(0xca)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5503a5(0x10e)},'primary_code':{'$first':_0x5503a5(0x114)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5503a5(0x117)},'rack':{'$first':_0x5503a5(0xa3)}}}]);if(_0x270b05[0x0][_0x5503a5(0xaa)]==_0x5503a5(0xc8)){var _0x535b29=users[_0x5503a5(0x93)];console['log'](_0x535b29);}else{if(_0x270b05[0x0][_0x5503a5(0xaa)]=='Hindi')var _0x535b29=users[_0x5503a5(0xe3)];else{if(_0x270b05[0x0][_0x5503a5(0xaa)]==_0x5503a5(0xdc))var _0x535b29=users['German'];else{if(_0x270b05[0x0]['language']==_0x5503a5(0x110))var _0x535b29=users[_0x5503a5(0x110)];else{if(_0x270b05[0x0]['language']=='French')var _0x535b29=users[_0x5503a5(0x98)];else{if(_0x270b05[0x0][_0x5503a5(0xaa)]==_0x5503a5(0x9c))var _0x535b29=users[_0x5503a5(0xd5)];else{if(_0x270b05[0x0]['language']=='Chinese')var _0x535b29=users[_0x5503a5(0x90)];else{if(_0x270b05[0x0][_0x5503a5(0xaa)]=='Arabic\x20(ae)')var _0x535b29=users[_0x5503a5(0xd1)];}}}}}}}_0x1a9bc9[_0x5503a5(0xb8)](_0x5503a5(0xe7),{'success':_0x3e1f66[_0x5503a5(0xbe)](_0x5503a5(0x7c)),'errors':_0x3e1f66[_0x5503a5(0xbe)](_0x5503a5(0xb1)),'role':_0x18c781,'profile':_0x32fd0a,'adjustment':_0x17aac4,'stock':_0xd32b7e,'master_shop':_0x270b05,'warehouse_name':_0x20c692,'unit':_0x1e06ec,'language':_0x535b29,'rooms_data':_0x4ae29f,'ed_fullDate':_0x499cb5});}catch(_0x2cb17b){console[_0x5503a5(0x9a)](_0x2cb17b),_0x1a9bc9[_0x5503a5(0x9e)](0xc8)['json']({'message':_0x2cb17b[_0x5503a5(0x94)]});}}),router[a0_0x210ec7(0x8c)]('/view/:id',auth,async(_0x3a9e2f,_0x564074)=>{var _0x60f84b=a0_0x210ec7;try{const _0x2aafd8=_0x3a9e2f[_0x60f84b(0x109)]['id'],_0x2c0c7c=await adjustment_finished[_0x60f84b(0xda)]({'_id':_0x2aafd8}),_0x21a51f=await warehouse[_0x60f84b(0x8d)]({'name':_0x2c0c7c[_0x60f84b(0xe4)],'room':_0x2c0c7c[_0x60f84b(0xe1)]}),{warehouse_name:_0x523ba2,date:_0x5b6d2b,prod_name:_0x56eeff,level:_0x48a963,isle:_0x12627f,pallet:_0x1fe649,stock:_0x177357,types:_0x1ed818,adjust_qty:_0x18b79c,new_adjust_qty:_0xc3f62d,note:_0x44d4a0,Room_name:_0x56f95d,invoice:_0x23f370,JO_number:_0x395401}=_0x3a9e2f[_0x60f84b(0xa5)];if(typeof _0x56eeff=='string')var _0x460fd9=[_0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0x7b)]],_0x256a9b=[_0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0xc4)]],_0x105d58=[_0x3a9e2f[_0x60f84b(0xa5)]['stock']],_0xe9be52=[_0x3a9e2f['body'][_0x60f84b(0xf5)]],_0x5760cf=[_0x3a9e2f['body'][_0x60f84b(0xf8)]],_0x1fc9c6=[_0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0xa0)]],_0x87b10a=[_0x3a9e2f['body'][_0x60f84b(0x118)]],_0x5307c9=[_0x3a9e2f['body'][_0x60f84b(0xbd)]],_0x491db2=[_0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0xdf)]],_0x5f51b7=[_0x3a9e2f['body'][_0x60f84b(0x11f)]],_0x2c4063=[_0x3a9e2f[_0x60f84b(0xa5)]['expiry_date']];else var _0x460fd9=[..._0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0x7b)]],_0x256a9b=[..._0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0xc4)]],_0x105d58=[..._0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0xfa)]],_0xe9be52=[..._0x3a9e2f['body']['types']],_0x5760cf=[..._0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0xf8)]],_0x1fc9c6=[..._0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0xa0)]],_0x87b10a=[..._0x3a9e2f[_0x60f84b(0xa5)]['prod_code']],_0x5307c9=[..._0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0xbd)]],_0x491db2=[..._0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0xdf)]],_0x5f51b7=[..._0x3a9e2f[_0x60f84b(0xa5)][_0x60f84b(0x11f)]],_0x2c4063=[..._0x3a9e2f[_0x60f84b(0xa5)]['expiry_date']];const _0x3aa078=_0x460fd9[_0x60f84b(0x82)](_0x4aabbb=>{return _0x4aabbb={'product_name':_0x4aabbb};});_0x256a9b[_0x60f84b(0xf7)]((_0x3aaacc,_0x15f794)=>{var _0x5a0e1a=_0x60f84b;_0x3aa078[_0x15f794][_0x5a0e1a(0x7a)]=_0x3aaacc;}),_0x105d58[_0x60f84b(0xf7)]((_0x3d8ab7,_0x23d078)=>{var _0xdac7ad=_0x60f84b;_0x3aa078[_0x23d078][_0xdac7ad(0xce)]=_0x3d8ab7;}),_0xe9be52[_0x60f84b(0xf7)]((_0x38166b,_0x4b5c46)=>{_0x3aa078[_0x4b5c46]['types']=_0x38166b;}),_0x5760cf[_0x60f84b(0xf7)]((_0x1a7d2a,_0x366b7c)=>{_0x3aa078[_0x366b7c]['adjust_qty']=_0x1a7d2a;}),_0x1fc9c6['forEach']((_0xc93b2,_0x54f4ee)=>{var _0x4e1522=_0x60f84b;_0x3aa078[_0x54f4ee][_0x4e1522(0xa0)]=_0xc93b2;}),_0x5307c9[_0x60f84b(0xf7)]((_0x59949c,_0x5e4400)=>{var _0x1f2d7d=_0x60f84b;_0x3aa078[_0x5e4400][_0x1f2d7d(0xbd)]=_0x59949c;}),_0x491db2[_0x60f84b(0xf7)]((_0x29b1e2,_0x39f0d9)=>{var _0x40c153=_0x60f84b;_0x3aa078[_0x39f0d9][_0x40c153(0xe9)]=_0x29b1e2;}),_0x87b10a[_0x60f84b(0xf7)]((_0x2cda05,_0x382a5b)=>{var _0x2d87d0=_0x60f84b;_0x3aa078[_0x382a5b][_0x2d87d0(0xa8)]=_0x2cda05;}),_0x5f51b7['forEach']((_0x207d9b,_0x253170)=>{var _0x8437ea=_0x60f84b;_0x3aa078[_0x253170][_0x8437ea(0x11f)]=_0x207d9b;}),_0x2c4063['forEach']((_0x561421,_0x92e939)=>{var _0x54c09e=_0x60f84b;_0x3aa078[_0x92e939][_0x54c09e(0xb6)]=_0x561421;});const _0x3fb0a2=_0x3aa078[_0x60f84b(0x120)](_0x5f41c6=>_0x5f41c6['adjust_qty']!=='0'&&_0x5f41c6['adjust_qty']!=='');var _0x1c5f93=0x0;_0x3fb0a2[_0x60f84b(0xf7)](_0x59e64e=>{var _0x437768=_0x60f84b;console['log'](_0x437768(0x108),_0x59e64e),parseInt(_0x59e64e[_0x437768(0xf8)])<=0x0&&_0x1c5f93++;});if(_0x1c5f93!=0x0)return _0x3a9e2f[_0x60f84b(0xbe)](_0x60f84b(0xb1),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x564074['redirect'](_0x60f84b(0xf1));_0x2c0c7c['warehouse_name']=_0x523ba2,_0x2c0c7c['date']=_0x5b6d2b,_0x2c0c7c['product']=_0x3fb0a2,_0x2c0c7c[_0x60f84b(0xb5)]=_0x44d4a0,_0x2c0c7c[_0x60f84b(0xe1)]=_0x56f95d,_0x2c0c7c[_0x60f84b(0x78)]=_0x23f370,_0x2c0c7c[_0x60f84b(0xc2)]=_0x395401;const _0x4c28ac=await _0x2c0c7c[_0x60f84b(0x10a)](),_0x7c1e50=await warehouse['findOne']({'name':_0x523ba2,'room':_0x56f95d});_0x4c28ac[_0x60f84b(0xee)][_0x60f84b(0xf7)](_0x26a96c=>{var _0x3d1f48=_0x60f84b;const _0x1aff70=_0x7c1e50[_0x3d1f48(0xd6)][_0x3d1f48(0x82)](_0x1bd96e=>{var _0x45640b=_0x3d1f48;_0x26a96c[_0x45640b(0xf5)]==_0x45640b(0x10f)?_0x1bd96e['product_name']==_0x26a96c['product_name']&&_0x1bd96e[_0x45640b(0x7a)]==_0x26a96c[_0x45640b(0x7a)]&&(_0x1bd96e[_0x45640b(0xf4)]=parseInt(_0x1bd96e[_0x45640b(0xf4)])-parseInt(_0x26a96c['adjust_qty'])):_0x1bd96e[_0x45640b(0x121)]==_0x26a96c[_0x45640b(0x121)]&&_0x1bd96e['bay']==_0x26a96c['bay']&&(_0x1bd96e[_0x45640b(0xf4)]=parseInt(_0x1bd96e[_0x45640b(0xf4)])+parseInt(_0x26a96c['adjust_qty']));});}),await _0x7c1e50['save'](),_0x3a9e2f[_0x60f84b(0xbe)](_0x60f84b(0x7c),'adjustment\x20data\x20update\x20successfully'),_0x564074[_0x60f84b(0xf9)]('/adjustment_finished/view');}catch(_0x4c0db4){console['log'](_0x4c0db4);}}),router['post']('/barcode_scanner',async(_0x37362d,_0x13cb60)=>{var _0x3ddc60=a0_0x210ec7;const {primary_code:_0x278cc1,warehouse_data:_0x15c838,rooms_data:_0x23181c,Roomslist:_0x27a6bb}=_0x37362d[_0x3ddc60(0xa5)],_0x5cf555=_0x27a6bb[_0x3ddc60(0xb7)](','),_0x9abae3=[];async function _0x1810c2(_0x43b217){var _0x46a601=_0x3ddc60;const _0x3cf84d=await warehouse[_0x46a601(0xd4)]([{'$match':{'name':_0x15c838,'room':_0x43b217}},{'$unwind':_0x46a601(0x11e)},{'$match':{'product_details.primary_code':_0x278cc1}},{'$group':{'_id':_0x46a601(0x106),'name':{'$first':_0x46a601(0xca)},'product_stock':{'$first':_0x46a601(0x8e)},'primary_code':{'$first':_0x46a601(0x114)},'secondary_code':{'$first':_0x46a601(0xed)},'product_code':{'$first':_0x46a601(0x8f)},'level':{'$first':_0x46a601(0xcb)},'bay':{'$first':'$product_details.bay'},'type':{'$first':_0x46a601(0x7d)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x46a601(0xe0)},'storage':{'$first':_0x46a601(0x117)},'rack':{'$first':_0x46a601(0xa3)},'expiry_date':{'$first':_0x46a601(0x9b)},'production_date':{'$first':_0x46a601(0xc5)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x46a601(0x91)},'invoice':{'$first':_0x46a601(0xba)}}}]),_0x354742=await warehouse[_0x46a601(0xd4)]([{'$match':{'name':_0x15c838,'room':_0x43b217}},{'$unwind':_0x46a601(0x11e)},{'$match':{'product_details.secondary_code':_0x278cc1}},{'$group':{'_id':_0x46a601(0x106),'name':{'$first':_0x46a601(0xca)},'product_stock':{'$first':_0x46a601(0x8e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x46a601(0xed)},'product_code':{'$first':_0x46a601(0x8f)},'level':{'$first':_0x46a601(0xcb)},'bay':{'$first':_0x46a601(0xf2)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x46a601(0x10e)},'unit':{'$first':_0x46a601(0xec)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x46a601(0x117)},'rack':{'$first':_0x46a601(0xa3)},'expiry_date':{'$first':_0x46a601(0x9b)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x46a601(0x7e)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x46a601(0x88)},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x46a601(0xba)}}}]);if(_0x3cf84d[_0x46a601(0xe5)]>0x0)_0x9abae3[_0x46a601(0xde)](_0x3cf84d);else _0x354742[_0x46a601(0xe5)]>0x0&&_0x9abae3['push'](_0x354742);}const _0x2be2b4=_0x5cf555[_0x3ddc60(0x82)](_0x4e6fdc=>_0x1810c2(_0x4e6fdc));await Promise[_0x3ddc60(0x123)](_0x2be2b4),_0x13cb60[_0x3ddc60(0x116)](_0x9abae3);}),router[a0_0x210ec7(0x8c)](a0_0x210ec7(0xa2),async(_0x197c76,_0x302818)=>{var _0x47c1fd=a0_0x210ec7;const {productCode:_0x805483,bay:_0x58b136,warehouses:_0x58ba55,room:_0x2ab063}=_0x197c76[_0x47c1fd(0xa5)];console['log'](_0x197c76[_0x47c1fd(0xa5)]);try{const _0x10e3aa=await warehouse[_0x47c1fd(0xd4)]([{'$match':{'name':_0x58ba55,'room':_0x2ab063}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x58b136)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x47c1fd(0xca)},'product_stock':{'$first':_0x47c1fd(0x8e)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x47c1fd(0xf0)}}}]);_0x302818[_0x47c1fd(0x9e)](0xc8)[_0x47c1fd(0x116)](_0x10e3aa);}catch(_0xd36507){_0x302818[_0x47c1fd(0x9e)](0x194)[_0x47c1fd(0x116)]({'message':_0xd36507[_0x47c1fd(0x94)]});}}),module['exports']=router;function a0_0x32e7(_0x4a1cf0,_0x3b5864){var _0x1f7e2c=a0_0x1f7e();return a0_0x32e7=function(_0x32e79a,_0x3712e8){_0x32e79a=_0x32e79a-0x76;var _0xa3295c=_0x1f7e2c[_0x32e79a];return _0xa3295c;},a0_0x32e7(_0x4a1cf0,_0x3b5864);}function a0_0x1f7e(){var _0x217be8=['Primary_Units','JO_number','logs','level','$product_details.production_date','slice','/view/:id','English\x20(US)','getMonth','$product_details.product_name','$product_details.level','Router','user','stockBefore','$date','$finalize','Arabic','New_Qty_Converted','../middleware/auth','aggregate','Portuguese','product_details','warehouse','756014lttkAA','/view/add_adjustment','findById','Return\x20Rooms','German','Arabic\x20(ae)','push','Secondary_units','$product_details.secondary_unit','room','$_id','Hindi','warehouse_name','length','../models/all_models','edit_adjustment_finished','/preview/:id','secondary_unit','An\x20error\x20occurred.','/view','$product_details.unit','$product_details.secondary_code','product','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.maxProducts','back','$product_details.bay','adjustment\x20add\x20successfull','product_stock','types','room_names','forEach','adjust_qty','redirect','stock','invoice_init','then','Adjustment\x20Finalize\x20Successfully','2947818brSgpz','staff','2dohgnu','prod_cat','29963440HkBVQD','adjustment_finished','product_date','Ambient','$product_details._id','/picking_list/PDF_adjustmentFinal/','foreach\x20newproduct','params','save','find','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product.product_name','$product_details.floorlevel','minus','Spanish','</td>','$warehouse_name','True','$product_details.primary_code','DRY\x20GOODS','json','$product_details.storage','prod_code','role','<tr>','$product','add_adjustment_finished','61656sHRkCs','$product_details','batch_code','filter','product_name','id_transaction','all','ADJ-','8qqlcTM','invoice','2970245SGcdKC','bay','prod_name','success','$product_details.type','$product_details.batch_code','maxPerUnit','/adjustment_finished/preview/','$product.room_names','map','Enclosed','match','Enabled','nodemailer','New_Qty_Converted_adj','$product_details.maxPerUnit','production_date','floor','$invoice','post','findOne','$product_details.product_stock','$product_details.product_code','Chinese','$room','prod_invoice','English','message','getFullYear','own','express','French','padStart','log','$product_details.expiry_date','Portuguese\x20(BR)','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','status','8484400iKfxAg','new_adjust_qty','/view/add_adjustment_logs','/CheckingWarehouse','$product_details.rack','email','body','_id','catch','product_code','$name','language','3748716ICwrUd','master','There\x27s\x20a\x20error\x20in\x20this\x20transaction','get','purchases_data','/view_logs','errors','ADJF-','toString','add_adjustment_finished_logs','note','expiry_date','split','render','30YoaWqz','$product_details.invoice','id_transaction_from','Rooms','unit','flash','string','$product_details.bin'];a0_0x1f7e=function(){return _0x217be8;};return a0_0x1f7e();}