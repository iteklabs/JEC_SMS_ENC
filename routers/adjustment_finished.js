var a0_0x260ef2=a0_0x3564;function a0_0x3564(_0x3b2537,_0x4c9e46){var _0x3085fe=a0_0x3085();return a0_0x3564=function(_0x3564fc,_0x217f98){_0x3564fc=_0x3564fc-0x139;var _0x35fef7=_0x3085fe[_0x3564fc];return _0x35fef7;},a0_0x3564(_0x3b2537,_0x4c9e46);}(function(_0x15b9b8,_0x5501ae){var _0x6512a3=a0_0x3564,_0x358631=_0x15b9b8();while(!![]){try{var _0x267ff4=-parseInt(_0x6512a3(0x173))/0x1*(-parseInt(_0x6512a3(0x177))/0x2)+parseInt(_0x6512a3(0x14f))/0x3+parseInt(_0x6512a3(0x141))/0x4*(-parseInt(_0x6512a3(0x1cc))/0x5)+-parseInt(_0x6512a3(0x1d8))/0x6+parseInt(_0x6512a3(0x13f))/0x7*(parseInt(_0x6512a3(0x170))/0x8)+parseInt(_0x6512a3(0x1af))/0x9*(parseInt(_0x6512a3(0x1a8))/0xa)+parseInt(_0x6512a3(0x19c))/0xb*(parseInt(_0x6512a3(0x18f))/0xc);if(_0x267ff4===_0x5501ae)break;else _0x358631['push'](_0x358631['shift']());}catch(_0x4b5aff){_0x358631['push'](_0x358631['shift']());}}}(a0_0x3085,0xaa0a3));function a0_0x3085(){var _0x5dba88=['Portuguese','exports','New_Qty_Converted','getDate','/adjustment_finished/preview/','$product_details.primary_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','json','Return\x20Rooms','Chinese','$product_details._id','warehouse','../middleware/auth','getFullYear','add_adjustment_finished','Adjustment\x20Finalize\x20Successfully','logs','prod_cat','_id','string','user','$product_details.bay','French','45ootIgg','$date','/view','purchases_data','body','toString','ADJF-','new_adjust_qty','secondary_unit','production_date','$product_details.rack','$product_details.product_stock','4000926bUzskW','add','back','flash','$product_details.type','/view/add_adjustment_logs','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','expiry_date','$product_details.production_date','redirect','params','New_Qty_Converted_adj','padStart','/adjustment/view','$room','adjustment\x20add\x20successfull','Enclosed','</td>','$product','get','$product_details.bin','Arabic\x20(ae)','2812033iErVwC','id_transaction','489564tylrPk','../models/all_models','own','error','$invoice','product_name','role','product','Secondary_units','all','prod_name','Router','Hindi','edit_adjustment_finished','1399323SOXntc','filter','True','errors','Portuguese\x20(BR)','/view/:id','$_id','findById','/preview/:id','$warehouse_name','$product_details.maxProducts','language','$name','An\x20error\x20occurred.','$product_details.floorlevel','product_stock','Arabic','findOne','$product.room_names','$product_details.unit','/view/add_adjustment','product_code','Rooms','find','English','aggregate','finalize','batch_code','length','id_transaction_from','prod_invoice','maxPerUnit','types','8FIAkQx','English\x20(US)','$product.product_name','4771KJdrrR','unit','German','$product_details.product_code','356yyUThm','$product_details.level','$product_details','$product_details.expiry_date','add_adjustment_finished_logs','</tr>','$product_details.product_name','edit_adjustment_finished_view','prod_code','status','$product_details.batch_code','room','warehouse_name','then','product_date','email','push','$finalize','minus','floor','An\x20error\x20occurred\x20while\x20saving\x20data.','split','stock','log','7128ZigSlo','$product_details.storage','match','$product_details.maxPerUnit','foreach\x20newproduct','invoice_init','success','render','forEach','slice','Primary_Units','staff','catch','12793ZSsIED','stockBefore','$product_details.secondary_unit','Spanish','post','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/barcode_scanner','adjust_qty','room_names','map','$product_details.secondary_code','date','24610MxfSqg','nodemailer','Ambient','level','message','bay','adjustment\x20data\x20update\x20successfully','207EMvoPH','save','$product_details.invoice','invoice','/picking_list/PDF_adjustmentFinal/','Enabled'];a0_0x3085=function(){return _0x5dba88;};return a0_0x3085();}const express=require('express'),app=express(),router=express[a0_0x260ef2(0x14c)](),auth=require(a0_0x260ef2(0x1c1)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_logs,adjustment_finished,email_settings,supervisor_settings,invoice_for_adjustment}=require(a0_0x260ef2(0x142)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x260ef2(0x1a9));router['get'](a0_0x260ef2(0x1ce),auth,async(_0x56fd03,_0x18ce05)=>{var _0x4858d8=a0_0x260ef2;try{const {username:_0x4958c2,email:_0xf66824,role:_0x2ade8c}=_0x56fd03[_0x4858d8(0x1c9)],_0xae1092=_0x56fd03['user'],_0x3636bf=await profile[_0x4858d8(0x160)]({'email':_0xae1092[_0x4858d8(0x186)]}),_0xd51019=await master_shop[_0x4858d8(0x166)]();let _0x5d58d7;if(_0xae1092[_0x4858d8(0x147)]==_0x4858d8(0x19a)){const _0x1d41a2=await staff[_0x4858d8(0x160)]({'email':_0xae1092[_0x4858d8(0x186)]});_0x5d58d7=await warehouse[_0x4858d8(0x166)]({'status':'Enabled','name':_0x1d41a2[_0x4858d8(0x1c0)]});}else _0x5d58d7=await warehouse[_0x4858d8(0x166)]({'status':_0x4858d8(0x1b4)});const _0xed57af=await product[_0x4858d8(0x166)]();let _0x14bc8c;if(_0xae1092[_0x4858d8(0x147)]==_0x4858d8(0x19a)){const _0x231f4a=await staff[_0x4858d8(0x160)]({'email':_0xae1092[_0x4858d8(0x186)]});_0x14bc8c=await adjustment_finished[_0x4858d8(0x166)]({'warehouse_name':_0x231f4a[_0x4858d8(0x1c0)]});}else _0x14bc8c=await adjustment_finished['aggregate']([{'$match':{'type_of_transaction':_0x4858d8(0x143)}},{'$unwind':_0x4858d8(0x13b)},{'$group':{'_id':_0x4858d8(0x155),'invoice':{'$first':'$invoice'},'date':{'$first':_0x4858d8(0x1cd)},'warehouse_name':{'$first':_0x4858d8(0x158)},'room':{'$addToSet':_0x4858d8(0x161)},'finalize':{'$first':_0x4858d8(0x188)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0xd51019[0x0][_0x4858d8(0x15a)]==_0x4858d8(0x171)){var _0x31cd8c=users[_0x4858d8(0x167)];console['log'](_0x31cd8c);}else{if(_0xd51019[0x0][_0x4858d8(0x15a)]==_0x4858d8(0x14d))var _0x31cd8c=users[_0x4858d8(0x14d)];else{if(_0xd51019[0x0][_0x4858d8(0x15a)]==_0x4858d8(0x175))var _0x31cd8c=users[_0x4858d8(0x175)];else{if(_0xd51019[0x0][_0x4858d8(0x15a)]==_0x4858d8(0x19f))var _0x31cd8c=users[_0x4858d8(0x19f)];else{if(_0xd51019[0x0][_0x4858d8(0x15a)]==_0x4858d8(0x1cb))var _0x31cd8c=users['French'];else{if(_0xd51019[0x0][_0x4858d8(0x15a)]==_0x4858d8(0x153))var _0x31cd8c=users[_0x4858d8(0x1b5)];else{if(_0xd51019[0x0][_0x4858d8(0x15a)]==_0x4858d8(0x1be))var _0x31cd8c=users['Chinese'];else{if(_0xd51019[0x0]['language']=='Arabic\x20(ae)')var _0x31cd8c=users[_0x4858d8(0x15f)];}}}}}}}_0x18ce05[_0x4858d8(0x196)]('adjustment_finished',{'success':_0x56fd03['flash']('success'),'errors':_0x56fd03['flash'](_0x4858d8(0x152)),'role':_0xae1092,'profile':_0x3636bf,'warehouse':_0x5d58d7,'product':_0xed57af,'adjustment':_0x14bc8c,'master_shop':_0xd51019,'language':_0x31cd8c});}catch(_0x396d34){console[_0x4858d8(0x18e)](_0x396d34);}}),router[a0_0x260ef2(0x13c)]('/view_logs',auth,async(_0x46c9ed,_0x103c90)=>{var _0x5c261c=a0_0x260ef2;try{const {username:_0x52a807,email:_0x5a95ed,role:_0x23a3a2}=_0x46c9ed[_0x5c261c(0x1c9)],_0x1ac982=_0x46c9ed[_0x5c261c(0x1c9)],_0x41336d=await profile[_0x5c261c(0x160)]({'email':_0x1ac982[_0x5c261c(0x186)]}),_0x27b8a6=await master_shop[_0x5c261c(0x166)]();let _0xa99c0f;if(_0x1ac982['role']=='staff'){const _0x355089=await staff['findOne']({'email':_0x1ac982[_0x5c261c(0x186)]});_0xa99c0f=await warehouse['find']({'status':_0x5c261c(0x1b4),'name':_0x355089[_0x5c261c(0x1c0)]});}else _0xa99c0f=await warehouse['find']({'status':_0x5c261c(0x1b4)});const _0x3cc18f=await product['find']();let _0x1c4ba5;if(_0x1ac982['role']=='staff'){const _0x57579f=await staff[_0x5c261c(0x160)]({'email':_0x1ac982[_0x5c261c(0x186)]});_0x1c4ba5=await adjustment_finished[_0x5c261c(0x166)]({'warehouse_name':_0x57579f[_0x5c261c(0x1c0)]});}else _0x1c4ba5=await adjustment_finished[_0x5c261c(0x168)]([{'$match':{'type_of_transaction':_0x5c261c(0x1c5)}},{'$unwind':_0x5c261c(0x13b)},{'$group':{'_id':_0x5c261c(0x155),'invoice':{'$first':_0x5c261c(0x145)},'date':{'$first':_0x5c261c(0x1cd)},'warehouse_name':{'$first':_0x5c261c(0x158)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x5c261c(0x188)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x27b8a6[0x0]['language']==_0x5c261c(0x171))var _0x50799a=users[_0x5c261c(0x167)];else{if(_0x27b8a6[0x0][_0x5c261c(0x15a)]==_0x5c261c(0x14d))var _0x50799a=users['Hindi'];else{if(_0x27b8a6[0x0][_0x5c261c(0x15a)]==_0x5c261c(0x175))var _0x50799a=users[_0x5c261c(0x175)];else{if(_0x27b8a6[0x0][_0x5c261c(0x15a)]==_0x5c261c(0x19f))var _0x50799a=users['Spanish'];else{if(_0x27b8a6[0x0]['language']==_0x5c261c(0x1cb))var _0x50799a=users[_0x5c261c(0x1cb)];else{if(_0x27b8a6[0x0][_0x5c261c(0x15a)]==_0x5c261c(0x153))var _0x50799a=users[_0x5c261c(0x1b5)];else{if(_0x27b8a6[0x0]['language']==_0x5c261c(0x1be))var _0x50799a=users[_0x5c261c(0x1be)];else{if(_0x27b8a6[0x0]['language']==_0x5c261c(0x13e))var _0x50799a=users['Arabic'];}}}}}}}_0x103c90[_0x5c261c(0x196)]('adjustment_finished_logs',{'success':_0x46c9ed[_0x5c261c(0x1db)]('success'),'errors':_0x46c9ed['flash'](_0x5c261c(0x152)),'role':_0x1ac982,'profile':_0x41336d,'warehouse':_0xa99c0f,'product':_0x3cc18f,'adjustment':_0x1c4ba5,'master_shop':_0x27b8a6,'language':_0x50799a});}catch(_0x267356){console['log'](_0x267356);}});async function getRandom8DigitNumber(){var _0x2073f7=a0_0x260ef2;const _0x3d7700=0x989680,_0x47a73b=0x5f5e0ff,_0x478fa0=Math[_0x2073f7(0x18a)](Math['random']()*(_0x47a73b-_0x3d7700+0x1))+_0x3d7700;var _0x3d0c1f;const _0x1b1542=await adjustment_finished[_0x2073f7(0x160)]({'invoice':_0x2073f7(0x1d2)+_0x478fa0});return _0x1b1542&&_0x1b1542[_0x2073f7(0x16b)]>0x0?_0x3d0c1f=_0x2073f7(0x1d2)+_0x478fa0:_0x3d0c1f=_0x2073f7(0x1d2)+_0x478fa0,_0x3d0c1f;}router[a0_0x260ef2(0x13c)]('/view/add_adjustment',auth,async(_0x48f4a0,_0x124537)=>{var _0x20df8a=a0_0x260ef2;try{const {username:_0x1ad4e9,email:_0x348994,role:_0x1f8893}=_0x48f4a0[_0x20df8a(0x1c9)],_0x44579d=_0x48f4a0['user'],_0x28edb6=await profile['findOne']({'email':_0x44579d[_0x20df8a(0x186)]}),_0x3ee7d6=await master_shop[_0x20df8a(0x166)]();let _0x5447c6;if(_0x44579d[_0x20df8a(0x147)]==_0x20df8a(0x19a)){const _0x557e36=await staff[_0x20df8a(0x160)]({'email':_0x44579d[_0x20df8a(0x186)]});_0x5447c6=await warehouse['aggregate']([{'$match':{'status':_0x20df8a(0x1b4),'name':_0x557e36['warehouse']}},{'$group':{'_id':'$name','name':{'$first':_0x20df8a(0x15b)}}}]);}else _0x5447c6=await warehouse[_0x20df8a(0x168)]([{'$match':{'status':_0x20df8a(0x1b4)}},{'$group':{'_id':_0x20df8a(0x15b),'name':{'$first':_0x20df8a(0x15b)}}}]);const _0x55b364=await product[_0x20df8a(0x166)]({}),_0x190772=await adjustment_finished[_0x20df8a(0x166)](),_0x4485c9=_0x190772['length']+0x1,_0x53a833='ADJF-'+_0x4485c9[_0x20df8a(0x1d1)]()[_0x20df8a(0x1e4)](0x5,'0');var _0x187dce=['Ambient',_0x20df8a(0x139),_0x20df8a(0x1bd)];if(_0x3ee7d6[0x0][_0x20df8a(0x15a)]==_0x20df8a(0x171))var _0x163b73=users[_0x20df8a(0x167)];else{if(_0x3ee7d6[0x0][_0x20df8a(0x15a)]==_0x20df8a(0x14d))var _0x163b73=users[_0x20df8a(0x14d)];else{if(_0x3ee7d6[0x0][_0x20df8a(0x15a)]==_0x20df8a(0x175))var _0x163b73=users[_0x20df8a(0x175)];else{if(_0x3ee7d6[0x0][_0x20df8a(0x15a)]==_0x20df8a(0x19f))var _0x163b73=users[_0x20df8a(0x19f)];else{if(_0x3ee7d6[0x0][_0x20df8a(0x15a)]==_0x20df8a(0x1cb))var _0x163b73=users[_0x20df8a(0x1cb)];else{if(_0x3ee7d6[0x0][_0x20df8a(0x15a)]==_0x20df8a(0x153))var _0x163b73=users[_0x20df8a(0x1b5)];else{if(_0x3ee7d6[0x0][_0x20df8a(0x15a)]==_0x20df8a(0x1be))var _0x163b73=users[_0x20df8a(0x1be)];else{if(_0x3ee7d6[0x0][_0x20df8a(0x15a)]==_0x20df8a(0x13e))var _0x163b73=users[_0x20df8a(0x15f)];}}}}}}}const _0x4bee37=getRandom8DigitNumber();_0x4bee37[_0x20df8a(0x184)](_0x4a9bf7=>{var _0x3db73c=_0x20df8a;_0x124537[_0x3db73c(0x196)](_0x3db73c(0x1c3),{'success':_0x48f4a0[_0x3db73c(0x1db)](_0x3db73c(0x195)),'errors':_0x48f4a0['flash'](_0x3db73c(0x152)),'role':_0x44579d,'profile':_0x28edb6,'warehouse':_0x5447c6,'product':_0x55b364,'master_shop':_0x3ee7d6,'language':_0x163b73,'rooms_data':_0x187dce,'invoice_no':_0x4a9bf7});})[_0x20df8a(0x19b)](_0x1ce742=>{var _0xe49056=_0x20df8a;_0x48f4a0[_0xe49056(0x1db)](_0xe49056(0x152),_0xe49056(0x1a1)),_0x124537[_0xe49056(0x1e1)](_0xe49056(0x1e5));});}catch(_0x2a6ab8){console['log'](_0x2a6ab8);}}),router[a0_0x260ef2(0x1a0)](a0_0x260ef2(0x163),auth,async(_0x3ada7c,_0x668805)=>{var _0x4230a3=a0_0x260ef2;try{const {warehouse_name:_0x506b44,date:_0x5eb6f4,prod_name:_0x3e851f,level:_0x4397d0,isle:_0x6a5866,pallet:_0x528a16,stock:_0x51534a,types:_0x15c82e,adjust_qty:_0x3e7d80,new_adjust_qty:_0x10a1b5,note:_0x3e191b,Room_name:_0x37071e,JO_number:_0x241153,expiry_date:_0x271b95,PO_number:_0x287499,ReqBy:_0x1f0cf7,dateofreq:_0x7b625b,typeservicesData:_0x29cded,destination:_0x1d02d5,deliverydate:_0x490a17,driver:_0x420bb9,plate:_0x1ebb50,van:_0xa07e9e,DRSI:_0x10c71c,typevehicle:_0x3127b6,TSU:_0x2fe8ac,TFU:_0x767e1b}=_0x3ada7c[_0x4230a3(0x1d0)];if(typeof _0x3e851f==_0x4230a3(0x1c8))var _0x341428=[_0x3ada7c['body'][_0x4230a3(0x14b)]],_0x5a3e89=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x1ab)]],_0x59aa93=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x18d)]],_0x415f96=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x16f)]],_0x42232c=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x1e3)]],_0x4649b=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x1b7)]],_0x10393c=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x199)]],_0x5eecf4=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x149)]],_0x2ab781=[_0x3ada7c['body'][_0x4230a3(0x17f)]],_0xf35886=[_0x3ada7c['body'][_0x4230a3(0x16a)]],_0x3c2eae=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x1df)]],_0x349668=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x185)]],_0x4b3c83=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x1c6)]],_0x1fde92=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x165)]],_0x538bf8=[_0x3ada7c[_0x4230a3(0x1d0)]['maxPerUnit']],_0x4acc99=[_0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x16d)]],_0xadac5b=[_0x3ada7c[_0x4230a3(0x1d0)]['id_transaction_from']];else var _0x341428=[..._0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x14b)]],_0x5a3e89=[..._0x3ada7c['body'][_0x4230a3(0x1ab)]],_0x59aa93=[..._0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x18d)]],_0x415f96=[..._0x3ada7c['body'][_0x4230a3(0x16f)]],_0x42232c=[..._0x3ada7c['body'][_0x4230a3(0x1e3)]],_0x4649b=[..._0x3ada7c[_0x4230a3(0x1d0)]['New_Qty_Converted']],_0x10393c=[..._0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x199)]],_0x5eecf4=[..._0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x149)]],_0x2ab781=[..._0x3ada7c['body'][_0x4230a3(0x17f)]],_0xf35886=[..._0x3ada7c[_0x4230a3(0x1d0)]['batch_code']],_0x3c2eae=[..._0x3ada7c[_0x4230a3(0x1d0)]['expiry_date']],_0x349668=[..._0x3ada7c[_0x4230a3(0x1d0)]['product_date']],_0x4b3c83=[..._0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x1c6)]],_0x1fde92=[..._0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x165)]],_0x538bf8=[..._0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x16e)]],_0x4acc99=[..._0x3ada7c[_0x4230a3(0x1d0)][_0x4230a3(0x16d)]],_0xadac5b=[..._0x3ada7c[_0x4230a3(0x1d0)]['id_transaction_from']];const _0x3c8653=_0x341428['map'](_0x2ed69c=>{return _0x2ed69c={'product_name':_0x2ed69c};});_0x5a3e89[_0x4230a3(0x197)]((_0x448231,_0x27a842)=>{var _0x457ef7=_0x4230a3,_0x1302c7=_0x448231[_0x457ef7(0x191)](/[A-Za-z]+/)[0x0],_0x5584d2=parseInt(_0x448231[_0x457ef7(0x191)](/\d+/)[0x0]);_0x3c8653[_0x27a842]['level']=_0x1302c7,_0x3c8653[_0x27a842][_0x457ef7(0x1ad)]=_0x5584d2;}),_0xadac5b[_0x4230a3(0x197)]((_0x1d44d6,_0xfe5b87)=>{_0x3c8653[_0xfe5b87]['id_transaction']=_0x1d44d6;}),_0x59aa93[_0x4230a3(0x197)]((_0x12a3d2,_0x4db9ca)=>{_0x3c8653[_0x4db9ca]['stockBefore']=_0x12a3d2;}),_0x415f96[_0x4230a3(0x197)]((_0x46dd5b,_0x3a5aed)=>{var _0x50cf55=_0x4230a3;_0x3c8653[_0x3a5aed][_0x50cf55(0x16f)]=_0x46dd5b;}),_0x42232c['forEach']((_0x9b7376,_0x3f43c4)=>{var _0x39fd5f=_0x4230a3;_0x3c8653[_0x3f43c4][_0x39fd5f(0x1a3)]=_0x9b7376;}),_0x4649b['forEach']((_0x57f31b,_0xe4b7d9)=>{var _0x12ba75=_0x4230a3;_0x3c8653[_0xe4b7d9][_0x12ba75(0x1d3)]=_0x57f31b;}),_0x10393c['forEach']((_0x3eac86,_0x4af702)=>{var _0x67a3da=_0x4230a3;_0x3c8653[_0x4af702][_0x67a3da(0x174)]=_0x3eac86;}),_0x5eecf4[_0x4230a3(0x197)]((_0x4fe3d0,_0x13b95c)=>{_0x3c8653[_0x13b95c]['secondary_unit']=_0x4fe3d0;}),_0x2ab781[_0x4230a3(0x197)]((_0x382b46,_0x75756f)=>{_0x3c8653[_0x75756f]['product_code']=_0x382b46;}),_0xf35886[_0x4230a3(0x197)]((_0x5615d0,_0x3c5920)=>{var _0x12364a=_0x4230a3;_0x3c8653[_0x3c5920][_0x12364a(0x16a)]=_0x5615d0;}),_0x3c2eae[_0x4230a3(0x197)]((_0x58277c,_0x359210)=>{var _0x49cb6a=_0x4230a3;_0x3c8653[_0x359210][_0x49cb6a(0x1df)]=_0x58277c;}),_0x349668[_0x4230a3(0x197)]((_0x3c22ba,_0x2ec6bd)=>{var _0x2189a2=_0x4230a3;_0x3c8653[_0x2ec6bd][_0x2189a2(0x1d5)]=_0x3c22ba;}),_0x4b3c83['forEach']((_0x76e952,_0x40e0d9)=>{var _0x33d751=_0x4230a3;_0x3c8653[_0x40e0d9][_0x33d751(0x1c6)]=_0x76e952;}),_0x1fde92['forEach']((_0x4822c6,_0x3a653f)=>{_0x3c8653[_0x3a653f]['room_names']=_0x4822c6;}),_0x538bf8[_0x4230a3(0x197)]((_0x263634,_0x3acda9)=>{var _0x49e876=_0x4230a3;_0x3c8653[_0x3acda9][_0x49e876(0x16e)]=_0x263634;}),_0x4acc99[_0x4230a3(0x197)]((_0x3872db,_0x3b87a5)=>{_0x3c8653[_0x3b87a5]['invoice']=_0x3872db;});const _0x3f8ff9=_0x3c8653[_0x4230a3(0x150)](_0xf34ab7=>_0xf34ab7['adjust_qty']!=='0'&&_0xf34ab7[_0x4230a3(0x1a3)]!=='');var _0x460461=0x0;_0x3f8ff9['forEach'](_0x5d6221=>{var _0x15946a=_0x4230a3;console['log'](_0x15946a(0x193),_0x5d6221),parseInt(_0x5d6221[_0x15946a(0x1a3)])<=0x0&&_0x460461++;});if(_0x460461!=0x0)return _0x3ada7c[_0x4230a3(0x1db)](_0x4230a3(0x152),_0x4230a3(0x1de)),_0x668805[_0x4230a3(0x1e1)](_0x4230a3(0x1da));const _0x3ad5e9=new invoice_for_adjustment();await _0x3ad5e9[_0x4230a3(0x1b0)]();const _0x2f9c68=new adjustment_finished({'warehouse_name':_0x506b44,'date':_0x5eb6f4,'product':_0x3f8ff9,'note':_0x3e191b,'room':_0x37071e,'invoice':'ADJ-'+_0x3ad5e9[_0x4230a3(0x194)][_0x4230a3(0x1d1)]()['padStart'](0x8,'0'),'JO_number':_0x241153,'expiry_date':_0x271b95,'PO_number':_0x287499,'RequestedBy':_0x1f0cf7,'DateofRequest':_0x7b625b,'typeservices':_0x29cded,'destination':_0x1d02d5,'deliverydate':_0x490a17,'driver':_0x420bb9,'plate':_0x1ebb50,'van':_0xa07e9e,'DRSI':_0x10c71c,'typevehicle':_0x3127b6,'TSU':_0x2fe8ac,'TFU':_0x767e1b}),_0x1c11c2=await _0x2f9c68[_0x4230a3(0x1b0)]();_0x3ada7c[_0x4230a3(0x1db)](_0x4230a3(0x195),_0x4230a3(0x1e7)),_0x668805[_0x4230a3(0x1e1)](_0x4230a3(0x1b9)+_0x1c11c2[_0x4230a3(0x1c7)]);}catch(_0x374904){console[_0x4230a3(0x18e)](_0x374904),_0x668805[_0x4230a3(0x180)](0xc8)[_0x4230a3(0x1bc)]({'message':_0x374904[_0x4230a3(0x1ac)]});}}),router[a0_0x260ef2(0x13c)](a0_0x260ef2(0x1dd),auth,async(_0x61c724,_0x3b3cc9)=>{var _0x29a695=a0_0x260ef2;try{const {username:_0x59039c,email:_0x33ba2b,role:_0x3bed7d}=_0x61c724['user'],_0x14fa20=_0x61c724[_0x29a695(0x1c9)],_0x4ac094=await profile[_0x29a695(0x160)]({'email':_0x14fa20['email']}),_0x53f3f5=await master_shop['find']();let _0x5c9033;if(_0x14fa20[_0x29a695(0x147)]=='staff'){const _0x2d6fe4=await staff[_0x29a695(0x160)]({'email':_0x14fa20[_0x29a695(0x186)]});_0x5c9033=await warehouse[_0x29a695(0x168)]([{'$match':{'status':'Enabled','name':_0x2d6fe4[_0x29a695(0x1c0)]}},{'$group':{'_id':_0x29a695(0x15b),'name':{'$first':_0x29a695(0x15b)}}}]);}else _0x5c9033=await warehouse[_0x29a695(0x168)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x29a695(0x15b),'name':{'$first':_0x29a695(0x15b)}}}]);const _0x402a54=await product[_0x29a695(0x166)](),_0x3dedbd=await adjustment_finished[_0x29a695(0x166)](),_0x28bae=_0x3dedbd[_0x29a695(0x16b)]+0x1,_0x20569f=_0x29a695(0x1d2)+_0x28bae['toString']()['padStart'](0x5,'0');var _0xd9fcf3=['Ambient',_0x29a695(0x139),_0x29a695(0x1bd)];if(_0x53f3f5[0x0][_0x29a695(0x15a)]==_0x29a695(0x171))var _0x47708d=users[_0x29a695(0x167)];else{if(_0x53f3f5[0x0]['language']=='Hindi')var _0x47708d=users[_0x29a695(0x14d)];else{if(_0x53f3f5[0x0][_0x29a695(0x15a)]==_0x29a695(0x175))var _0x47708d=users[_0x29a695(0x175)];else{if(_0x53f3f5[0x0][_0x29a695(0x15a)]=='Spanish')var _0x47708d=users[_0x29a695(0x19f)];else{if(_0x53f3f5[0x0][_0x29a695(0x15a)]==_0x29a695(0x1cb))var _0x47708d=users['French'];else{if(_0x53f3f5[0x0][_0x29a695(0x15a)]==_0x29a695(0x153))var _0x47708d=users[_0x29a695(0x1b5)];else{if(_0x53f3f5[0x0][_0x29a695(0x15a)]==_0x29a695(0x1be))var _0x47708d=users[_0x29a695(0x1be)];else{if(_0x53f3f5[0x0][_0x29a695(0x15a)]==_0x29a695(0x13e))var _0x47708d=users['Arabic'];}}}}}}}const _0x1d2f64=getRandom8DigitNumber();_0x1d2f64[_0x29a695(0x184)](_0x338b32=>{var _0x405db5=_0x29a695;_0x3b3cc9[_0x405db5(0x196)](_0x405db5(0x17b),{'success':_0x61c724['flash'](_0x405db5(0x195)),'errors':_0x61c724['flash']('errors'),'role':_0x14fa20,'profile':_0x4ac094,'warehouse':_0x5c9033,'product':_0x402a54,'master_shop':_0x53f3f5,'language':_0x47708d,'rooms_data':_0xd9fcf3,'invoice_no':_0x338b32});})[_0x29a695(0x19b)](_0x376a6c=>{var _0x3d9bac=_0x29a695;_0x61c724[_0x3d9bac(0x1db)](_0x3d9bac(0x152),_0x3d9bac(0x1a1)),_0x3b3cc9[_0x3d9bac(0x1e1)](_0x3d9bac(0x1e5));});}catch(_0x5f241e){console['log'](_0x5f241e);}}),router[a0_0x260ef2(0x1a0)](a0_0x260ef2(0x1dd),auth,async(_0x1e5697,_0x8827e)=>{var _0x529a53=a0_0x260ef2;try{const {warehouse_name:_0x576797,date:_0x566c35,prod_name:_0x437172,level:_0x561601,isle:_0x29df74,pallet:_0x467b84,stock:_0x562d70,types:_0x58adfd,adjust_qty:_0xfcca16,new_adjust_qty:_0x4633df,note:_0xde04db,Room_name:_0x17deec,JO_number:_0x3b0fd9,expiry_date:_0x2e5f9b,type_of_transaction:_0x1f299f,PO_number:_0x13b4da,ReqBy:_0x2bb324,dateofreq:_0x1d9b46,typeservicesData:_0x3cd246,destination:_0x4cad6f,deliverydate:_0x77f6a5,driver:_0x1d6e2d,plate:_0x3efb45,van:_0x5a96d0,DRSI:_0x3f34c3,typevehicle:_0x176747,TSU:_0x3bae74,TFU:_0x11d7a8}=_0x1e5697[_0x529a53(0x1d0)];if(typeof _0x437172==_0x529a53(0x1c8))var _0x85345d=[_0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x14b)]],_0x3d8b56=[_0x1e5697['body'][_0x529a53(0x1ab)]],_0x5a88b6=[_0x1e5697[_0x529a53(0x1d0)]['stock']],_0xc3357e=[_0x1e5697[_0x529a53(0x1d0)]['types']],_0x8264b8=[_0x1e5697[_0x529a53(0x1d0)]['New_Qty_Converted_adj']],_0x4e85c6=[_0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x1b7)]],_0x4b8ca3=[_0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x199)]],_0x3ac2a3=[_0x1e5697['body'][_0x529a53(0x149)]],_0x262b2b=[_0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x17f)]],_0x45f69a=[_0x1e5697['body'][_0x529a53(0x16a)]],_0x5156b9=[_0x1e5697['body']['expiry_date']],_0x1a321b=[_0x1e5697['body'][_0x529a53(0x185)]],_0x8412bc=[_0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x1c6)]],_0x3de40f=[_0x1e5697['body'][_0x529a53(0x165)]],_0x4df4c2=[_0x1e5697['body'][_0x529a53(0x16e)]],_0x251728=[_0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x16d)]],_0x9957ac=[_0x1e5697['body']['id_transaction_from']];else var _0x85345d=[..._0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x14b)]],_0x3d8b56=[..._0x1e5697['body'][_0x529a53(0x1ab)]],_0x5a88b6=[..._0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x18d)]],_0xc3357e=[..._0x1e5697['body'][_0x529a53(0x16f)]],_0x8264b8=[..._0x1e5697[_0x529a53(0x1d0)]['New_Qty_Converted_adj']],_0x4e85c6=[..._0x1e5697['body'][_0x529a53(0x1b7)]],_0x4b8ca3=[..._0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x199)]],_0x3ac2a3=[..._0x1e5697[_0x529a53(0x1d0)]['Secondary_units']],_0x262b2b=[..._0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x17f)]],_0x45f69a=[..._0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x16a)]],_0x5156b9=[..._0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x1df)]],_0x1a321b=[..._0x1e5697[_0x529a53(0x1d0)]['product_date']],_0x8412bc=[..._0x1e5697['body']['prod_cat']],_0x3de40f=[..._0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x165)]],_0x4df4c2=[..._0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x16e)]],_0x251728=[..._0x1e5697['body'][_0x529a53(0x16d)]],_0x9957ac=[..._0x1e5697[_0x529a53(0x1d0)][_0x529a53(0x16c)]];const _0x51067a=_0x85345d['map'](_0x3d0d3f=>{return _0x3d0d3f={'product_name':_0x3d0d3f};});_0x3d8b56[_0x529a53(0x197)]((_0x1141f4,_0x3a95cd)=>{var _0x36f9c2=_0x529a53,_0xbc4200=_0x1141f4[_0x36f9c2(0x191)](/[A-Za-z]+/)[0x0],_0x2f3321=parseInt(_0x1141f4[_0x36f9c2(0x191)](/\d+/)[0x0]);_0x51067a[_0x3a95cd][_0x36f9c2(0x1ab)]=_0xbc4200,_0x51067a[_0x3a95cd][_0x36f9c2(0x1ad)]=_0x2f3321;}),_0x9957ac['forEach']((_0x361c48,_0x210af1)=>{_0x51067a[_0x210af1]['id_transaction']=_0x361c48;}),_0x5a88b6['forEach']((_0x15446a,_0xb84758)=>{_0x51067a[_0xb84758]['stockBefore']=_0x15446a;}),_0xc3357e[_0x529a53(0x197)]((_0x5ec017,_0x3c00e6)=>{var _0xfed971=_0x529a53;_0x51067a[_0x3c00e6][_0xfed971(0x16f)]=_0x5ec017;}),_0x8264b8[_0x529a53(0x197)]((_0x163788,_0x25c0ab)=>{_0x51067a[_0x25c0ab]['adjust_qty']=_0x163788;}),_0x4e85c6[_0x529a53(0x197)]((_0x4bcee8,_0x3451d9)=>{var _0xf77c78=_0x529a53;_0x51067a[_0x3451d9][_0xf77c78(0x1d3)]=_0x4bcee8;}),_0x4b8ca3[_0x529a53(0x197)]((_0x13a8fa,_0x14ba5c)=>{_0x51067a[_0x14ba5c]['unit']=_0x13a8fa;}),_0x3ac2a3[_0x529a53(0x197)]((_0x351a73,_0x348bb9)=>{var _0x38b4ed=_0x529a53;_0x51067a[_0x348bb9][_0x38b4ed(0x1d4)]=_0x351a73;}),_0x262b2b['forEach']((_0x476a88,_0x37b962)=>{_0x51067a[_0x37b962]['product_code']=_0x476a88;}),_0x45f69a[_0x529a53(0x197)]((_0x48b81d,_0x3d458a)=>{_0x51067a[_0x3d458a]['batch_code']=_0x48b81d;}),_0x5156b9['forEach']((_0x3940e3,_0x3955c5)=>{var _0x594c8c=_0x529a53;_0x51067a[_0x3955c5][_0x594c8c(0x1df)]=_0x3940e3;}),_0x1a321b['forEach']((_0x2898ff,_0x57ea94)=>{var _0x55a010=_0x529a53;_0x51067a[_0x57ea94][_0x55a010(0x1d5)]=_0x2898ff;}),_0x8412bc[_0x529a53(0x197)]((_0x3e4b54,_0x459872)=>{var _0x893b33=_0x529a53;_0x51067a[_0x459872][_0x893b33(0x1c6)]=_0x3e4b54;}),_0x3de40f[_0x529a53(0x197)]((_0xc0e7df,_0x2e80cc)=>{var _0x12eae3=_0x529a53;_0x51067a[_0x2e80cc][_0x12eae3(0x1a4)]=_0xc0e7df;}),_0x4df4c2[_0x529a53(0x197)]((_0xec5702,_0x1fd046)=>{var _0x3c6320=_0x529a53;_0x51067a[_0x1fd046][_0x3c6320(0x16e)]=_0xec5702;}),_0x251728[_0x529a53(0x197)]((_0x3ef3c9,_0x294de)=>{var _0x1fad63=_0x529a53;_0x51067a[_0x294de][_0x1fad63(0x1b2)]=_0x3ef3c9;});const _0x325e8d=_0x51067a[_0x529a53(0x150)](_0x4e4ddd=>_0x4e4ddd['adjust_qty']!=='0'&&_0x4e4ddd['adjust_qty']!=='');var _0xe116ef=0x0;_0x325e8d[_0x529a53(0x197)](_0x268f4e=>{var _0x4f7956=_0x529a53;console[_0x4f7956(0x18e)](_0x4f7956(0x193),_0x268f4e),parseInt(_0x268f4e[_0x4f7956(0x1a3)])<=0x0&&_0xe116ef++;});if(_0xe116ef!=0x0)return _0x1e5697[_0x529a53(0x1db)](_0x529a53(0x152),_0x529a53(0x1de)),_0x8827e[_0x529a53(0x1e1)](_0x529a53(0x1da));const _0x23b643=new adjustment_logs();await _0x23b643[_0x529a53(0x1b0)]();const _0x3183cc=new adjustment_finished({'warehouse_name':_0x576797,'date':_0x566c35,'product':_0x325e8d,'note':_0xde04db,'room':_0x17deec,'invoice':'LOG-ADJ-'+_0x23b643[_0x529a53(0x194)][_0x529a53(0x1d1)]()[_0x529a53(0x1e4)](0x8,'0'),'JO_number':_0x3b0fd9,'expiry_date':_0x2e5f9b,'type_of_transaction':_0x1f299f,'PO_number':_0x13b4da,'RequestedBy':_0x2bb324,'DateofRequest':_0x1d9b46,'typeservices':_0x3cd246,'destination':_0x4cad6f,'deliverydate':_0x77f6a5,'driver':_0x1d6e2d,'plate':_0x3efb45,'van':_0x5a96d0,'DRSI':_0x3f34c3,'typevehicle':_0x176747,'TSU':_0x3bae74,'TFU':_0x11d7a8}),_0x57a62d=await _0x3183cc[_0x529a53(0x1b0)]();_0x1e5697[_0x529a53(0x1db)]('success',_0x529a53(0x1e7)),_0x8827e[_0x529a53(0x1e1)](_0x529a53(0x1b9)+_0x57a62d[_0x529a53(0x1c7)]);}catch(_0x501bd1){console[_0x529a53(0x18e)](_0x501bd1),_0x8827e[_0x529a53(0x180)](0xc8)[_0x529a53(0x1bc)]({'message':_0x501bd1[_0x529a53(0x1ac)]});}}),router[a0_0x260ef2(0x13c)]('/preview/:id',auth,async(_0x55b90a,_0x4ec762)=>{var _0xb7fa=a0_0x260ef2;try{const {username:_0x1b97e6,email:_0x5a10e6,role:_0x1dba19}=_0x55b90a['user'],_0x5f4886=_0x55b90a[_0xb7fa(0x1c9)],_0x4a1455=await profile[_0xb7fa(0x160)]({'email':_0x5f4886['email']}),_0x4f776a=await master_shop[_0xb7fa(0x166)](),_0x45da8e=_0x55b90a[_0xb7fa(0x1e2)]['id'],_0x2334ea=await adjustment_finished[_0xb7fa(0x156)]({'_id':_0x45da8e}),_0x23ab8e=await purchases[_0xb7fa(0x168)]([{'$match':{'warehouse_name':_0x2334ea['warehouse_name']}},{'$unwind':_0xb7fa(0x13b)},{'$group':{'_id':_0xb7fa(0x172)}}]);console['log']('purchases_data',_0x23ab8e);const _0x1e57cb=await product[_0xb7fa(0x166)]({}),_0x49bfd9=await warehouse[_0xb7fa(0x168)]([{'$match':{'name':_0x2334ea[_0xb7fa(0x183)]}},{'$unwind':_0xb7fa(0x179)},{'$group':{'_id':_0xb7fa(0x1bf),'name':{'$first':_0xb7fa(0x17d)},'product_stock':{'$first':_0xb7fa(0x1d7)},'bay':{'$first':_0xb7fa(0x1ca)},'bin':{'$first':_0xb7fa(0x13d)},'type':{'$first':_0xb7fa(0x1dc)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xb7fa(0x1ba)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xb7fa(0x176)},'storage':{'$first':_0xb7fa(0x190)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xb7fa(0x17a)},'production_date':{'$first':_0xb7fa(0x1e0)},'batch_code':{'$first':_0xb7fa(0x181)},'maxPerUnit':{'$first':_0xb7fa(0x192)},'room':{'$first':'$room'}}}]);if(_0x4f776a[0x0][_0xb7fa(0x15a)]==_0xb7fa(0x171)){var _0x532d0b=users['English'];console[_0xb7fa(0x18e)](_0x532d0b);}else{if(_0x4f776a[0x0][_0xb7fa(0x15a)]=='Hindi')var _0x532d0b=users[_0xb7fa(0x14d)];else{if(_0x4f776a[0x0][_0xb7fa(0x15a)]==_0xb7fa(0x175))var _0x532d0b=users['German'];else{if(_0x4f776a[0x0][_0xb7fa(0x15a)]==_0xb7fa(0x19f))var _0x532d0b=users['Spanish'];else{if(_0x4f776a[0x0][_0xb7fa(0x15a)]==_0xb7fa(0x1cb))var _0x532d0b=users[_0xb7fa(0x1cb)];else{if(_0x4f776a[0x0][_0xb7fa(0x15a)]==_0xb7fa(0x153))var _0x532d0b=users[_0xb7fa(0x1b5)];else{if(_0x4f776a[0x0]['language']=='Chinese')var _0x532d0b=users[_0xb7fa(0x1be)];else{if(_0x4f776a[0x0][_0xb7fa(0x15a)]==_0xb7fa(0x13e))var _0x532d0b=users[_0xb7fa(0x15f)];}}}}}}}_0x4ec762[_0xb7fa(0x196)](_0xb7fa(0x17e),{'success':_0x55b90a['flash']('success'),'errors':_0x55b90a[_0xb7fa(0x1db)](_0xb7fa(0x152)),'role':_0x5f4886,'profile':_0x4a1455,'adjustment':_0x2334ea,'stock':_0x49bfd9,'master_shop':_0x4f776a,'warehouse_name':_0x23ab8e,'unit':_0x1e57cb,'language':_0x532d0b});}catch(_0x973676){console[_0xb7fa(0x18e)](_0x973676),_0x4ec762[_0xb7fa(0x180)](0xc8)[_0xb7fa(0x1bc)]({'message':_0x973676[_0xb7fa(0x1ac)]});}}),router[a0_0x260ef2(0x1a0)](a0_0x260ef2(0x157),auth,async(_0x41e46a,_0x542cf0)=>{var _0x449e0b=a0_0x260ef2;try{const {invoice:_0x386067,warehouse_name:_0x9e6886,Room_name:_0x43f5d6}=_0x41e46a[_0x449e0b(0x1d0)],_0x32238c=_0x41e46a[_0x449e0b(0x1e2)]['id'],_0x32257a=await adjustment_finished[_0x449e0b(0x156)]({'_id':_0x32238c});var _0x523c15;const _0x49e5e0=_0x32257a[_0x449e0b(0x148)][_0x449e0b(0x1a5)](async _0x347b82=>{var _0x477336=_0x449e0b;if(_0x347b82[_0x477336(0x1a3)]>0x0){_0x523c15=await warehouse[_0x477336(0x160)]({'name':_0x9e6886,'room':_0x347b82['room_names']});const _0xbb578=_0x523c15['product_details']['map'](_0x21cc6a=>{var _0x426076=_0x477336;console[_0x426076(0x18e)](_0x347b82[_0x426076(0x16f)]);if(_0x347b82['types']=='minus')_0x21cc6a['_id']==_0x347b82[_0x426076(0x140)]&&(_0x21cc6a[_0x426076(0x15e)]=_0x21cc6a[_0x426076(0x15e)]-_0x347b82['adjust_qty']);else _0x347b82[_0x426076(0x16f)]==_0x426076(0x1d9)&&(_0x21cc6a[_0x426076(0x1c7)]==_0x347b82[_0x426076(0x140)]&&(_0x21cc6a[_0x426076(0x15e)]=_0x21cc6a['product_stock']+_0x347b82[_0x426076(0x1a3)]));});}return _0x523c15;});Promise[_0x449e0b(0x14a)](_0x49e5e0)[_0x449e0b(0x184)](async _0x5a14fd=>{var _0x260a7e=_0x449e0b;try{for(const _0x3c84f6 of _0x5a14fd){await _0x3c84f6['save']();}_0x32257a[_0x260a7e(0x169)]=_0x260a7e(0x151);const _0x2aa846=await _0x32257a[_0x260a7e(0x1b0)](),_0x3fd4b9=await master_shop['find'](),_0x3100f9=await email_settings['findOne'](),_0x34bd10=await supervisor_settings['find']();var _0x1f67ff=_0x32257a[_0x260a7e(0x148)],_0x4d3dee='',_0x52db24;for(_0x52db24 in _0x1f67ff){var _0x1aa865='FG';_0x32257a[_0x260a7e(0x183)]=='DRY\x20GOODS'&&(_0x1aa865='DG'),_0x4d3dee+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1f67ff[_0x52db24]['product_name']+'</td>'+_0x260a7e(0x1bb)+_0x1f67ff[_0x52db24][_0x260a7e(0x164)]+_0x260a7e(0x13a)+_0x260a7e(0x1bb)+_0x1f67ff[_0x52db24][_0x260a7e(0x1a3)]+'</td>'+_0x260a7e(0x1bb)+_0x1f67ff[_0x52db24][_0x260a7e(0x174)]+_0x260a7e(0x13a)+_0x260a7e(0x1bb)+_0x1f67ff[_0x52db24][_0x260a7e(0x1d4)]+_0x260a7e(0x13a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x32257a[_0x260a7e(0x183)]+_0x260a7e(0x13a)+_0x260a7e(0x1bb)+_0x1f67ff[_0x52db24][_0x260a7e(0x1a4)]+_0x260a7e(0x13a)+_0x260a7e(0x1bb)+_0x1aa865+_0x1f67ff[_0x52db24][_0x260a7e(0x1ad)]+_0x260a7e(0x13a)+_0x260a7e(0x17c);}_0x41e46a[_0x260a7e(0x1db)](_0x260a7e(0x195),_0x260a7e(0x1c4)),_0x542cf0[_0x260a7e(0x1e1)](_0x260a7e(0x1b3)+_0x2aa846['_id']);}catch(_0x3e07ac){console[_0x260a7e(0x144)](_0x3e07ac),_0x542cf0[_0x260a7e(0x180)](0x1f4)[_0x260a7e(0x1bc)]({'error':_0x260a7e(0x18b)});}})[_0x449e0b(0x19b)](_0x31d5a0=>{var _0x1eef9e=_0x449e0b;console['error'](_0x31d5a0),_0x542cf0['status'](0x1f4)[_0x1eef9e(0x1bc)]({'error':_0x1eef9e(0x15c)});});}catch(_0x3a33dd){_0x542cf0[_0x449e0b(0x1bc)]({'message':_0x3a33dd['message']});}}),router['get'](a0_0x260ef2(0x154),auth,async(_0x5d69f0,_0x21b688)=>{var _0x37ce50=a0_0x260ef2;try{const {username:_0x150009,email:_0x44c0e9,role:_0x2dbd85}=_0x5d69f0[_0x37ce50(0x1c9)],_0x1eaeb8=_0x5d69f0['user'],_0x556a3e=await profile[_0x37ce50(0x160)]({'email':_0x1eaeb8[_0x37ce50(0x186)]}),_0x544202=await master_shop[_0x37ce50(0x166)]();console[_0x37ce50(0x18e)]('master',_0x544202);const _0x2c3641=_0x5d69f0[_0x37ce50(0x1e2)]['id'],_0x31296b=await adjustment_finished[_0x37ce50(0x156)]({'_id':_0x2c3641});let _0x471ef7=new Date(_0x31296b[_0x37ce50(0x1df)]),_0x50cac9=('0'+_0x471ef7[_0x37ce50(0x1b8)]())['slice'](-0x2),_0x770b0=('0'+(_0x471ef7['getMonth']()+0x1))[_0x37ce50(0x198)](-0x2),_0x6b6ddd=_0x471ef7[_0x37ce50(0x1c2)](),_0x2fc842=_0x6b6ddd+'-'+_0x770b0+'-'+_0x50cac9;var _0x1820c7=[_0x37ce50(0x1aa),_0x37ce50(0x139),_0x37ce50(0x1bd)];const _0x2b86ed=await purchases[_0x37ce50(0x168)]([{'$match':{'warehouse_name':_0x31296b[_0x37ce50(0x183)]}},{'$unwind':_0x37ce50(0x13b)},{'$group':{'_id':'$product.product_name'}}]);console['log'](_0x37ce50(0x1cf),_0x2b86ed);const _0x209303=await product[_0x37ce50(0x166)]({}),_0x128ccc=await warehouse['aggregate']([{'$match':{'name':_0x31296b[_0x37ce50(0x183)],'room':_0x31296b[_0x37ce50(0x182)]}},{'$unwind':_0x37ce50(0x179)},{'$group':{'_id':_0x37ce50(0x1bf),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x37ce50(0x13d)},'type':{'$first':_0x37ce50(0x1dc)},'floorlevel':{'$first':_0x37ce50(0x15d)},'primary_code':{'$first':_0x37ce50(0x1ba)},'secondary_code':{'$first':_0x37ce50(0x1a6)},'product_code':{'$first':_0x37ce50(0x176)},'storage':{'$first':_0x37ce50(0x190)},'rack':{'$first':_0x37ce50(0x1d6)}}}]);if(_0x544202[0x0][_0x37ce50(0x15a)]==_0x37ce50(0x171)){var _0xdaa8d5=users[_0x37ce50(0x167)];console[_0x37ce50(0x18e)](_0xdaa8d5);}else{if(_0x544202[0x0][_0x37ce50(0x15a)]==_0x37ce50(0x14d))var _0xdaa8d5=users[_0x37ce50(0x14d)];else{if(_0x544202[0x0][_0x37ce50(0x15a)]==_0x37ce50(0x175))var _0xdaa8d5=users['German'];else{if(_0x544202[0x0][_0x37ce50(0x15a)]==_0x37ce50(0x19f))var _0xdaa8d5=users[_0x37ce50(0x19f)];else{if(_0x544202[0x0][_0x37ce50(0x15a)]==_0x37ce50(0x1cb))var _0xdaa8d5=users['French'];else{if(_0x544202[0x0][_0x37ce50(0x15a)]==_0x37ce50(0x153))var _0xdaa8d5=users[_0x37ce50(0x1b5)];else{if(_0x544202[0x0][_0x37ce50(0x15a)]==_0x37ce50(0x1be))var _0xdaa8d5=users['Chinese'];else{if(_0x544202[0x0][_0x37ce50(0x15a)]==_0x37ce50(0x13e))var _0xdaa8d5=users[_0x37ce50(0x15f)];}}}}}}}_0x21b688[_0x37ce50(0x196)](_0x37ce50(0x14e),{'success':_0x5d69f0['flash'](_0x37ce50(0x195)),'errors':_0x5d69f0[_0x37ce50(0x1db)](_0x37ce50(0x152)),'role':_0x1eaeb8,'profile':_0x556a3e,'adjustment':_0x31296b,'stock':_0x128ccc,'master_shop':_0x544202,'warehouse_name':_0x2b86ed,'unit':_0x209303,'language':_0xdaa8d5,'rooms_data':_0x1820c7,'ed_fullDate':_0x2fc842});}catch(_0x2ed121){console[_0x37ce50(0x18e)](_0x2ed121),_0x21b688[_0x37ce50(0x180)](0xc8)[_0x37ce50(0x1bc)]({'message':_0x2ed121['message']});}}),router[a0_0x260ef2(0x1a0)](a0_0x260ef2(0x154),auth,async(_0x17b749,_0x3f1f64)=>{var _0x5d86b4=a0_0x260ef2;try{const _0x29701b=_0x17b749[_0x5d86b4(0x1e2)]['id'],_0x35c725=await adjustment_finished[_0x5d86b4(0x156)]({'_id':_0x29701b}),_0x115f99=await warehouse[_0x5d86b4(0x160)]({'name':_0x35c725[_0x5d86b4(0x183)],'room':_0x35c725['room']}),{warehouse_name:_0x1d195a,date:_0x177f39,prod_name:_0x438897,level:_0x553436,isle:_0x31c101,pallet:_0x10d565,stock:_0x112c55,types:_0x14e138,adjust_qty:_0x1b8521,new_adjust_qty:_0x7c092d,note:_0x18b535,Room_name:_0x2581c7,invoice:_0x324fbe,JO_number:_0x48eece}=_0x17b749[_0x5d86b4(0x1d0)];if(typeof _0x438897==_0x5d86b4(0x1c8))var _0x968c0d=[_0x17b749['body'][_0x5d86b4(0x14b)]],_0x4e9b32=[_0x17b749['body'][_0x5d86b4(0x1ab)]],_0xa1345c=[_0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x18d)]],_0x30bcdb=[_0x17b749[_0x5d86b4(0x1d0)]['types']],_0x35a354=[_0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x1a3)]],_0x501aad=[_0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x1d3)]],_0x536916=[_0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x17f)]],_0x1ff8cc=[_0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x174)]],_0x9e56b2=[_0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x149)]],_0x1b324b=[_0x17b749[_0x5d86b4(0x1d0)]['batch_code']],_0x58475f=[_0x17b749['body'][_0x5d86b4(0x1df)]];else var _0x968c0d=[..._0x17b749['body']['prod_name']],_0x4e9b32=[..._0x17b749['body'][_0x5d86b4(0x1ab)]],_0xa1345c=[..._0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x18d)]],_0x30bcdb=[..._0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x16f)]],_0x35a354=[..._0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x1a3)]],_0x501aad=[..._0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x1d3)]],_0x536916=[..._0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x17f)]],_0x1ff8cc=[..._0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x174)]],_0x9e56b2=[..._0x17b749[_0x5d86b4(0x1d0)]['Secondary_units']],_0x1b324b=[..._0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x16a)]],_0x58475f=[..._0x17b749[_0x5d86b4(0x1d0)][_0x5d86b4(0x1df)]];const _0x3b7905=_0x968c0d[_0x5d86b4(0x1a5)](_0x1d055e=>{return _0x1d055e={'product_name':_0x1d055e};});_0x4e9b32[_0x5d86b4(0x197)]((_0x1b4c65,_0x38419e)=>{var _0x3da4ed=_0x5d86b4;_0x3b7905[_0x38419e][_0x3da4ed(0x1ad)]=_0x1b4c65;}),_0xa1345c[_0x5d86b4(0x197)]((_0x2c1ece,_0x2870a0)=>{var _0x4a0480=_0x5d86b4;_0x3b7905[_0x2870a0][_0x4a0480(0x19d)]=_0x2c1ece;}),_0x30bcdb['forEach']((_0x100a25,_0x32882f)=>{var _0x4db9d4=_0x5d86b4;_0x3b7905[_0x32882f][_0x4db9d4(0x16f)]=_0x100a25;}),_0x35a354[_0x5d86b4(0x197)]((_0x534d9b,_0x441f7b)=>{_0x3b7905[_0x441f7b]['adjust_qty']=_0x534d9b;}),_0x501aad[_0x5d86b4(0x197)]((_0x2f94c3,_0x1e1cf2)=>{_0x3b7905[_0x1e1cf2]['new_adjust_qty']=_0x2f94c3;}),_0x1ff8cc['forEach']((_0x405dc1,_0x200db2)=>{var _0x51f247=_0x5d86b4;_0x3b7905[_0x200db2][_0x51f247(0x174)]=_0x405dc1;}),_0x9e56b2['forEach']((_0x37ad82,_0x20ec80)=>{var _0xc87354=_0x5d86b4;_0x3b7905[_0x20ec80][_0xc87354(0x1d4)]=_0x37ad82;}),_0x536916['forEach']((_0x3ad058,_0x50d8c8)=>{var _0x31fd0e=_0x5d86b4;_0x3b7905[_0x50d8c8][_0x31fd0e(0x164)]=_0x3ad058;}),_0x1b324b[_0x5d86b4(0x197)]((_0x2191cb,_0x446a0d)=>{var _0x1af33d=_0x5d86b4;_0x3b7905[_0x446a0d][_0x1af33d(0x16a)]=_0x2191cb;}),_0x58475f[_0x5d86b4(0x197)]((_0x5ec385,_0x549b29)=>{_0x3b7905[_0x549b29]['expiry_date']=_0x5ec385;});const _0x36b1dc=_0x3b7905['filter'](_0x5bcb1b=>_0x5bcb1b[_0x5d86b4(0x1a3)]!=='0'&&_0x5bcb1b['adjust_qty']!=='');var _0x44f986=0x0;_0x36b1dc[_0x5d86b4(0x197)](_0x233b74=>{var _0x2e3650=_0x5d86b4;console[_0x2e3650(0x18e)](_0x2e3650(0x193),_0x233b74),parseInt(_0x233b74['adjust_qty'])<=0x0&&_0x44f986++;});if(_0x44f986!=0x0)return _0x17b749[_0x5d86b4(0x1db)](_0x5d86b4(0x152),_0x5d86b4(0x1de)),_0x3f1f64[_0x5d86b4(0x1e1)](_0x5d86b4(0x1da));_0x35c725[_0x5d86b4(0x183)]=_0x1d195a,_0x35c725[_0x5d86b4(0x1a7)]=_0x177f39,_0x35c725['product']=_0x36b1dc,_0x35c725['note']=_0x18b535,_0x35c725['room']=_0x2581c7,_0x35c725['invoice']=_0x324fbe,_0x35c725['JO_number']=_0x48eece;const _0x471d02=await _0x35c725[_0x5d86b4(0x1b0)](),_0x386120=await warehouse['findOne']({'name':_0x1d195a,'room':_0x2581c7});_0x471d02['product'][_0x5d86b4(0x197)](_0x3b0634=>{const _0x173f5a=_0x386120['product_details']['map'](_0xee8254=>{var _0x2170a5=a0_0x3564;_0x3b0634[_0x2170a5(0x16f)]==_0x2170a5(0x189)?_0xee8254[_0x2170a5(0x146)]==_0x3b0634[_0x2170a5(0x146)]&&_0xee8254['bay']==_0x3b0634[_0x2170a5(0x1ad)]&&(_0xee8254[_0x2170a5(0x15e)]=parseInt(_0xee8254[_0x2170a5(0x15e)])-parseInt(_0x3b0634[_0x2170a5(0x1a3)])):_0xee8254['product_name']==_0x3b0634[_0x2170a5(0x146)]&&_0xee8254[_0x2170a5(0x1ad)]==_0x3b0634['bay']&&(_0xee8254[_0x2170a5(0x15e)]=parseInt(_0xee8254[_0x2170a5(0x15e)])+parseInt(_0x3b0634['adjust_qty']));});}),await _0x386120[_0x5d86b4(0x1b0)](),_0x17b749[_0x5d86b4(0x1db)](_0x5d86b4(0x195),_0x5d86b4(0x1ae)),_0x3f1f64['redirect']('/adjustment_finished/view');}catch(_0x2135b6){console[_0x5d86b4(0x18e)](_0x2135b6);}}),router[a0_0x260ef2(0x1a0)](a0_0x260ef2(0x1a2),async(_0x58e8a8,_0x5a9efa)=>{var _0x354446=a0_0x260ef2;const {primary_code:_0x3e6265,warehouse_data:_0x3df7c0,rooms_data:_0x52a887,Roomslist:_0x5af995}=_0x58e8a8['body'],_0x3632e1=_0x5af995[_0x354446(0x18c)](','),_0x495830=[];async function _0x459dde(_0x25fbb9){var _0x1ba3bc=_0x354446;const _0x374c5=await warehouse[_0x1ba3bc(0x168)]([{'$match':{'name':_0x3df7c0,'room':_0x25fbb9}},{'$unwind':_0x1ba3bc(0x179)},{'$match':{'product_details.primary_code':_0x3e6265}},{'$group':{'_id':_0x1ba3bc(0x1bf),'name':{'$first':_0x1ba3bc(0x17d)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x1ba3bc(0x178)},'bay':{'$first':_0x1ba3bc(0x1ca)},'type':{'$first':_0x1ba3bc(0x1dc)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1ba3bc(0x162)},'secondary_unit':{'$first':_0x1ba3bc(0x19e)},'storage':{'$first':_0x1ba3bc(0x190)},'rack':{'$first':_0x1ba3bc(0x1d6)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1ba3bc(0x1e0)},'batch_code':{'$first':_0x1ba3bc(0x181)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x1ba3bc(0x192)},'roomNamed':{'$first':'$room'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x542cdc=await warehouse[_0x1ba3bc(0x168)]([{'$match':{'name':_0x3df7c0,'room':_0x25fbb9}},{'$unwind':_0x1ba3bc(0x179)},{'$match':{'product_details.secondary_code':_0x3e6265}},{'$group':{'_id':_0x1ba3bc(0x1bf),'name':{'$first':_0x1ba3bc(0x17d)},'product_stock':{'$first':_0x1ba3bc(0x1d7)},'primary_code':{'$first':_0x1ba3bc(0x1ba)},'secondary_code':{'$first':_0x1ba3bc(0x1a6)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x1ba3bc(0x178)},'bay':{'$first':_0x1ba3bc(0x1ca)},'type':{'$first':_0x1ba3bc(0x1dc)},'pallet':{'$first':_0x1ba3bc(0x15d)},'unit':{'$first':_0x1ba3bc(0x162)},'secondary_unit':{'$first':_0x1ba3bc(0x19e)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1ba3bc(0x1d6)},'expiry_date':{'$first':_0x1ba3bc(0x17a)},'production_date':{'$first':_0x1ba3bc(0x1e0)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x1ba3bc(0x192)},'roomNamed':{'$first':_0x1ba3bc(0x1e6)},'invoice':{'$first':_0x1ba3bc(0x1b1)}}}]);if(_0x374c5[_0x1ba3bc(0x16b)]>0x0)_0x495830[_0x1ba3bc(0x187)](_0x374c5);else _0x542cdc[_0x1ba3bc(0x16b)]>0x0&&_0x495830[_0x1ba3bc(0x187)](_0x542cdc);}const _0x3e4701=_0x3632e1[_0x354446(0x1a5)](_0x59cf4c=>_0x459dde(_0x59cf4c));await Promise['all'](_0x3e4701),_0x5a9efa['json'](_0x495830);}),router[a0_0x260ef2(0x1a0)]('/CheckingWarehouse',async(_0x3a8be3,_0x4192eb)=>{var _0x3dc3f5=a0_0x260ef2;const {productCode:_0x54813d,bay:_0x18aca3,warehouses:_0x1fb395,room:_0x1ac90a}=_0x3a8be3[_0x3dc3f5(0x1d0)];console[_0x3dc3f5(0x18e)](_0x3a8be3['body']);try{const _0x54b3c3=await warehouse[_0x3dc3f5(0x168)]([{'$match':{'name':_0x1fb395,'room':_0x1ac90a}},{'$unwind':_0x3dc3f5(0x179)},{'$match':{'product_details.bay':parseInt(_0x18aca3)}},{'$group':{'_id':_0x3dc3f5(0x1bf),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3dc3f5(0x1d7)},'bay':{'$first':_0x3dc3f5(0x1ca)},'maxProducts':{'$first':_0x3dc3f5(0x159)}}}]);_0x4192eb[_0x3dc3f5(0x180)](0xc8)[_0x3dc3f5(0x1bc)](_0x54b3c3);}catch(_0x41b33e){_0x4192eb[_0x3dc3f5(0x180)](0x194)[_0x3dc3f5(0x1bc)]({'message':_0x41b33e[_0x3dc3f5(0x1ac)]});}}),module[a0_0x260ef2(0x1b6)]=router;