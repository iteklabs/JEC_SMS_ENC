const a0_0x2c2c7e=a0_0x5ee2;(function(_0x2955ff,_0x4ea13e){const _0xc8656=a0_0x5ee2,_0x641b05=_0x2955ff();while(!![]){try{const _0x303b99=-parseInt(_0xc8656(0x20d))/0x1*(-parseInt(_0xc8656(0x1f8))/0x2)+parseInt(_0xc8656(0x211))/0x3+-parseInt(_0xc8656(0x1d5))/0x4+-parseInt(_0xc8656(0x21b))/0x5*(-parseInt(_0xc8656(0x1f2))/0x6)+-parseInt(_0xc8656(0x1fb))/0x7*(-parseInt(_0xc8656(0x203))/0x8)+parseInt(_0xc8656(0x1ea))/0x9*(-parseInt(_0xc8656(0x204))/0xa)+parseInt(_0xc8656(0x1d0))/0xb;if(_0x303b99===_0x4ea13e)break;else _0x641b05['push'](_0x641b05['shift']());}catch(_0x30ecfc){_0x641b05['push'](_0x641b05['shift']());}}}(a0_0x55ec,0x6184b));const express=require(a0_0x2c2c7e(0x216)),app=express(),router=express[a0_0x2c2c7e(0x1fa)](),multer=require('multer'),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x2c2c7e(0x1fc)),auth=require(a0_0x2c2c7e(0x1d6));function a0_0x55ec(){const _0x2b2527=['email','post','$room','Chinese','/staff_sales_id','Portuguese','/MapData','warehouse','aggregate','DRY\x20STORAGE','exports','/Rooms_data3','Enabled','18720YwDfwc','$$product.product_quantity','/MapData2','$product_details.type','body','message','$name','Arabic','1380qYRjnO','$product_details.level','$_id.level','$product_details.bin','findOne','All','191036dANnkk','Raw\x20Materials','Router','250803hcJTbS','../models/all_models','product','$product_details','staff','$products','$product_details.product_code','$expiry_date','24FCUCPP','1510yxJJFb','$_id.bin','/Rooms_data','English','$_id.bay','$count','Portuguese\x20(BR)','$product_details.production_date','$batch_code','2LHNKiZ','Return\x20Goods','$product_details.bay','language','448668EbTGkh','$product_details.expiry_date','find','flash','$product_details.product_name','express','German','../public/language/languages.json','$product_details.product_stock','log','8390tvlfuE','user','get','render','$_id','Spanish','$_id.floorlevel','$production_date','$product_details.floorlevel','status','French','162162YuKpdX','$product_code','json','$_id.type','Hindi','540984ATQLBz','../middleware/auth','/view','Arabic\x20(ae)','errors','Finished\x20Goods','toLocaleString','en-US'];a0_0x55ec=function(){return _0x2b2527;};return a0_0x55ec();}var timezones=require('timezones-list');const users=require(a0_0x2c2c7e(0x218));function a0_0x5ee2(_0x58d179,_0x491706){const _0x55ecf7=a0_0x55ec();return a0_0x5ee2=function(_0x5ee2b3,_0x2e2cf6){_0x5ee2b3=_0x5ee2b3-0x1cb;let _0x3451bd=_0x55ecf7[_0x5ee2b3];return _0x3451bd;},a0_0x5ee2(_0x58d179,_0x491706);}router[a0_0x2c2c7e(0x21d)](a0_0x2c2c7e(0x1d7),auth,async(_0x28a1ac,_0x429698)=>{const _0x8890b1=a0_0x2c2c7e;try{const {username:_0x29587a,email:_0x5cefc1,role:_0x3740ea}=_0x28a1ac[_0x8890b1(0x21c)],_0x319507=_0x28a1ac[_0x8890b1(0x21c)],_0x3f6800=await profile['findOne']({'email':_0x319507[_0x8890b1(0x1dd)]}),_0x454a1d=await master_shop[_0x8890b1(0x213)]();let _0x368884;if(_0x319507['role']==_0x8890b1(0x1ff)){const _0x3d8706=await staff[_0x8890b1(0x1f6)]({'email':_0x319507[_0x8890b1(0x1dd)]});_0x368884=await warehouse[_0x8890b1(0x1e5)]([{'$match':{'status':_0x8890b1(0x1e9),'name':_0x3d8706[_0x8890b1(0x1e4)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);}else _0x368884=await warehouse[_0x8890b1(0x1e5)]([{'$match':{'status':_0x8890b1(0x1e9)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);const _0x136f11=new Date()[_0x8890b1(0x1db)](_0x8890b1(0x1dc),{'timeZone':_0x454a1d[0x0]['timezone']});if(_0x454a1d[0x0][_0x8890b1(0x210)]=='English\x20(US)')var _0x2daccf=users[_0x8890b1(0x207)];else{if(_0x454a1d[0x0][_0x8890b1(0x210)]==_0x8890b1(0x1d4))var _0x2daccf=users['Hindi'];else{if(_0x454a1d[0x0]['language']==_0x8890b1(0x217))var _0x2daccf=users['German'];else{if(_0x454a1d[0x0][_0x8890b1(0x210)]=='Spanish')var _0x2daccf=users[_0x8890b1(0x220)];else{if(_0x454a1d[0x0]['language']==_0x8890b1(0x1cf))var _0x2daccf=users['French'];else{if(_0x454a1d[0x0][_0x8890b1(0x210)]==_0x8890b1(0x20a))var _0x2daccf=users[_0x8890b1(0x1e2)];else{if(_0x454a1d[0x0][_0x8890b1(0x210)]==_0x8890b1(0x1e0))var _0x2daccf=users[_0x8890b1(0x1e0)];else{if(_0x454a1d[0x0][_0x8890b1(0x210)]==_0x8890b1(0x1d8))var _0x2daccf=users[_0x8890b1(0x1f1)];}}}}}}}_0x429698[_0x8890b1(0x21e)]('warehousemap_incoming',{'success':_0x28a1ac[_0x8890b1(0x214)]('success'),'errors':_0x28a1ac['flash'](_0x8890b1(0x1d9)),'role':_0x319507,'profile':_0x3f6800,'master_shop':_0x454a1d,'timezones':timezones,'language':_0x2daccf,'warehouse':_0x368884});}catch(_0x3c753b){console[_0x8890b1(0x21a)](_0x3c753b),_0x429698[_0x8890b1(0x1ce)](0xc8)[_0x8890b1(0x1d2)]({'message':_0x3c753b['message']});}}),router[a0_0x2c2c7e(0x1de)](a0_0x2c2c7e(0x1e3),async(_0x111a1a,_0x58d321)=>{const _0x4a4e76=a0_0x2c2c7e,{warehouseNew:_0x581d0c,rooms:_0x541259,Type:_0x53cf32}=_0x111a1a[_0x4a4e76(0x1ee)],_0x13c64f=await warehouse['aggregate']([{'$unwind':_0x4a4e76(0x1fe)},{'$match':{'name':_0x581d0c,'room':_0x541259,'product_details.type':_0x53cf32}},{'$group':{'_id':{'bay':_0x4a4e76(0x20f),'bin':_0x4a4e76(0x1f5),'type':_0x4a4e76(0x1ed),'floorlevel':_0x4a4e76(0x1cd)},'products':{'$push':{'product_name':_0x4a4e76(0x215),'product_quantity':'$product_details.product_stock','product_code':_0x4a4e76(0x201)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':_0x4a4e76(0x219),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x4a4e76(0x208),'bin':_0x4a4e76(0x205),'type':_0x4a4e76(0x1d3),'floorlevel':_0x4a4e76(0x1cb),'products':{'$filter':{'input':_0x4a4e76(0x200),'as':_0x4a4e76(0x1fd),'cond':{'$gt':[_0x4a4e76(0x1eb),0x0]}}},'totalQuantity':0x1}}]);_0x58d321[_0x4a4e76(0x1d2)](_0x13c64f);}),router[a0_0x2c2c7e(0x1de)](a0_0x2c2c7e(0x1ec),async(_0x3e7478,_0x2514fe)=>{const _0x16105e=a0_0x2c2c7e,{warehouseNew:_0x236922,rooms:_0x3c619b,room_cat:_0x4ce0ad}=_0x3e7478[_0x16105e(0x1ee)];let _0x2526ae;if(_0x4ce0ad==_0x16105e(0x1f7))_0x2526ae=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'name':_0x236922}},{'$group':{'_id':{'bay':_0x16105e(0x20f),'product':_0x16105e(0x215),'expiry':_0x16105e(0x212)},'count':{'$sum':_0x16105e(0x219)},'production_date':{'$first':_0x16105e(0x20b)},'expiry_date':{'$first':'$product_details.expiry_date'},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x16105e(0x201)}}},{'$group':{'_id':_0x16105e(0x208),'products':{'$push':{'product':'$_id.product','quantity':_0x16105e(0x209),'production_date':_0x16105e(0x1cc),'expiry_date':_0x16105e(0x202),'batch_code':_0x16105e(0x20c),'product_code':_0x16105e(0x1d1)}},'totalQuantity':{'$sum':'$count'}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x16105e(0x21f),'products':0x1,'totalQuantity':0x1}}]),console[_0x16105e(0x21a)](_0x4ce0ad);else{}_0x2514fe[_0x16105e(0x1d2)](_0x2526ae);}),router['post'](a0_0x2c2c7e(0x206),async(_0x44ad22,_0x2245ed)=>{const _0xbb7e79=a0_0x2c2c7e;try{const {warehouse_name:_0x9852a7}=_0x44ad22[_0xbb7e79(0x1ee)];var _0x278d13='';_0x278d13=[{'$match':{'name':_0x9852a7,'status':_0xbb7e79(0x1e9)}},{'$group':{'_id':_0xbb7e79(0x21f),'room_name':{'$first':_0xbb7e79(0x1df)}}},{'$sort':{'room_name':0x1}}];const _0x24074c=await warehouse[_0xbb7e79(0x1e5)](_0x278d13);_0x2245ed[_0xbb7e79(0x1ce)](0xc8)['json'](_0x24074c);}catch(_0x2ff1ae){_0x2245ed[_0xbb7e79(0x1ce)](0x190)[_0xbb7e79(0x1d2)]({'errorMessage':_0x2ff1ae[_0xbb7e79(0x1ef)]});}}),router[a0_0x2c2c7e(0x1de)]('/Rooms_data2',async(_0x8e70d7,_0x1c748c)=>{const _0x22dd07=a0_0x2c2c7e;try{const {warehouse_name:_0x3fdf2e,cat:_0x22f111,valNew:_0x2412ab}=_0x8e70d7['body'];var _0x12ba83='',_0x174d8a='';if(_0x22f111==_0x22dd07(0x1f9))_0x12ba83=_0x22dd07(0x20e),_0x2412ab=='pack'?_0x174d8a=[{'$match':{'status':_0x22dd07(0x1e9),'warehouse_category':_0x22f111,'name':{'$ne':_0x12ba83},'name':_0x22dd07(0x1e6)}},{'$group':{'_id':_0x22dd07(0x1f0),'room_name':{'$first':_0x22dd07(0x1f0)}}},{'$sort':{'room_name':0x1}}]:_0x174d8a=[{'$match':{'status':'Enabled','warehouse_category':_0x22f111,'name':{'$ne':_0x12ba83}}},{'$group':{'_id':'$name','room_name':{'$first':_0x22dd07(0x1f0)}}},{'$sort':{'room_name':0x1}}];else _0x22f111==_0x22dd07(0x1da)?(_0x12ba83='QA\x20Warehouse',_0x174d8a=[{'$match':{'status':_0x22dd07(0x1e9),'warehouse_category':_0x22f111,'name':{'$ne':_0x12ba83}}},{'$group':{'_id':_0x22dd07(0x1f0),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]):_0x174d8a=[{'$match':{'status':_0x22dd07(0x1e9)}},{'$group':{'_id':_0x22dd07(0x1f0),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];const _0x47fd1b=await warehouse['aggregate'](_0x174d8a);_0x1c748c[_0x22dd07(0x1ce)](0xc8)[_0x22dd07(0x1d2)](_0x47fd1b);}catch(_0x3bd88d){_0x1c748c[_0x22dd07(0x1ce)](0x190)['json']({'errorMessage':_0x3bd88d[_0x22dd07(0x1ef)]}),console[_0x22dd07(0x21a)](_0x3bd88d);}}),router[a0_0x2c2c7e(0x1de)](a0_0x2c2c7e(0x1e8),async(_0x94adc5,_0x2e9342)=>{const _0x4ec557=a0_0x2c2c7e;try{const {warehouse_name:_0x411566,cat:_0x43db7f}=_0x94adc5[_0x4ec557(0x1ee)],_0x5a7f15=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x43db7f,'name':_0x411566}},{'$group':{'_id':'$room','room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]);_0x2e9342[_0x4ec557(0x1ce)](0xc8)[_0x4ec557(0x1d2)](_0x5a7f15);}catch(_0x163b31){_0x2e9342[_0x4ec557(0x1ce)](0x190)[_0x4ec557(0x1d2)]({'errorMessage':_0x163b31['message']});}}),router[a0_0x2c2c7e(0x1de)]('/staff_sales',async(_0x31e818,_0x1412a3)=>{const _0x413ad2=a0_0x2c2c7e;try{const {typeofsales:_0xf97002}=_0x31e818[_0x413ad2(0x1ee)];var _0x50dcdb;_0xf97002=='1'&&(_0x50dcdb=await staff[_0x413ad2(0x213)]({'account_category':'sa','type_of_acc_cat':_0xf97002})),_0x1412a3['status'](0xc8)[_0x413ad2(0x1d2)](_0x50dcdb);}catch(_0xced70e){_0x1412a3[_0x413ad2(0x1ce)](0x190)['json']({'errorMessage':_0xced70e[_0x413ad2(0x1ef)]});}}),router[a0_0x2c2c7e(0x1de)](a0_0x2c2c7e(0x1e1),async(_0x57344d,_0x105fcb)=>{const _0x408e79=a0_0x2c2c7e;try{const {id:_0x44283a}=_0x57344d[_0x408e79(0x1ee)],_0x3c3cad=await staff[_0x408e79(0x213)]({'_id':_0x44283a});_0x105fcb['status'](0xc8)[_0x408e79(0x1d2)](_0x3c3cad);}catch(_0x218bd1){_0x105fcb[_0x408e79(0x1ce)](0x190)[_0x408e79(0x1d2)]({'errorMessage':_0x218bd1['message']});}}),router['post']('/map_value',async(_0xe265f1,_0x442d95)=>{const _0x115bbc=a0_0x2c2c7e;try{const {warehouse_name:_0x4d26b3,room_value:_0x1abcb0}=_0xe265f1[_0x115bbc(0x1ee)];let _0x3823ca;_0x1abcb0=='all'?_0x3823ca=await warehouse[_0x115bbc(0x1e5)]([{'$unwind':'$product_details'},{'$match':{'name':_0x4d26b3}},{'$group':{'_id':{'bay':_0x115bbc(0x20f),'level':_0x115bbc(0x1f3),'type':'$product_details.type','floorlevel':_0x115bbc(0x1cd)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':'$product_details.product_stock','product_code':_0x115bbc(0x201)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x115bbc(0x219),0x0]},'then':_0x115bbc(0x219),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x115bbc(0x208),'level':_0x115bbc(0x1f4),'type':_0x115bbc(0x1d3),'floorlevel':_0x115bbc(0x1cb),'products':{'$filter':{'input':'$products','as':_0x115bbc(0x1fd),'cond':{'$gt':[_0x115bbc(0x1eb),0x0]}}},'totalQuantity':0x1}}]):_0x3823ca=await warehouse[_0x115bbc(0x1e5)]([{'$unwind':_0x115bbc(0x1fe)},{'$match':{'name':_0x4d26b3,'room':_0x1abcb0}},{'$group':{'_id':{'bay':_0x115bbc(0x20f),'level':'$product_details.level','type':'$product_details.type','floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x115bbc(0x215),'product_quantity':_0x115bbc(0x219),'product_code':_0x115bbc(0x201)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x115bbc(0x219),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x115bbc(0x208),'level':_0x115bbc(0x1f4),'type':_0x115bbc(0x1d3),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x115bbc(0x200),'as':_0x115bbc(0x1fd),'cond':{'$gt':[_0x115bbc(0x1eb),0x0]}}},'totalQuantity':0x1}}]),_0x442d95[_0x115bbc(0x1ce)](0xc8)[_0x115bbc(0x1d2)](_0x3823ca);}catch(_0x491d32){_0x442d95[_0x115bbc(0x1ce)](0x190)['json']({'errorMessage':_0x491d32[_0x115bbc(0x1ef)]});}}),module[a0_0x2c2c7e(0x1e7)]=router;