const a0_0xb25d93=a0_0x5319;function a0_0x4203(){const _0x62c842=['errors','$product_code','528590MvJctR','flash','$_id.type','language','$_id.bay','English','/staff_sales','../middleware/auth','3619720kgAXDt','toLocaleString','$products','body','Enabled','pack','$$product.product_quantity','Router','$_id.floorlevel','$room','$count','warehouse','DRY\x20STORAGE','/MapData','/map_value','$product_details','Finished\x20Goods','status','all','/staff_sales_id','$product_details.type','Raw\x20Materials','/Rooms_data3','Arabic\x20(ae)','timezone','findOne','/MapData2','907441DAyFSC','$product_details.product_stock','$name','warehousemap_incoming','$product_details.level','5628305NJmWCe','aggregate','Return\x20Goods','$expiry_date','Hindi','$_id','All','English\x20(US)','$batch_code','/Rooms_data2','log','752094SkzHWb','$product_details.bin','timezones-list','product','QA\x20Warehouse','success','Chinese','Portuguese\x20(BR)','German','$production_date','Spanish','email','$product_details.expiry_date','$product_details.product_code','$product_details.product_name','$product_details.batch_code','French','../models/all_models','message','json','../public/language/languages.json','express','$_id.level','find','$product_details.floorlevel','1501590nhSNZi','/Rooms_data','post','$product_details.production_date','4939207phtjWI','get','$_id.product','exports','$product_details.bay','Portuguese'];a0_0x4203=function(){return _0x62c842;};return a0_0x4203();}(function(_0xcc29b4,_0x26a9bb){const _0x4417bf=a0_0x5319,_0x253361=_0xcc29b4();while(!![]){try{const _0x4c4f23=parseInt(_0x4417bf(0xcd))/0x1+parseInt(_0x4417bf(0x102))/0x2+parseInt(_0x4417bf(0xdd))/0x3+parseInt(_0x4417bf(0xb2))/0x4+-parseInt(_0x4417bf(0xd2))/0x5+parseInt(_0x4417bf(0xf6))/0x6+-parseInt(_0x4417bf(0xfa))/0x7;if(_0x4c4f23===_0x26a9bb)break;else _0x253361['push'](_0x253361['shift']());}catch(_0x5c00cb){_0x253361['push'](_0x253361['shift']());}}}(a0_0x4203,0xb637f));const express=require(a0_0xb25d93(0xf2)),app=express(),router=express[a0_0xb25d93(0xb9)](),multer=require('multer'),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0xb25d93(0xee)),auth=require(a0_0xb25d93(0xb1));var timezones=require(a0_0xb25d93(0xdf));function a0_0x5319(_0x1d08e1,_0x3038f3){const _0x420307=a0_0x4203();return a0_0x5319=function(_0x531941,_0x4de539){_0x531941=_0x531941-0xac;let _0x90d0ba=_0x420307[_0x531941];return _0x90d0ba;},a0_0x5319(_0x1d08e1,_0x3038f3);}const users=require(a0_0xb25d93(0xf1));router[a0_0xb25d93(0xfb)]('/view',auth,async(_0xb3b608,_0xe390c5)=>{const _0x36e307=a0_0xb25d93;try{const {username:_0x535ddd,email:_0xe3a850,role:_0x545384}=_0xb3b608['user'],_0x11120d=_0xb3b608['user'],_0x59b3e6=await profile['findOne']({'email':_0x11120d[_0x36e307(0xe8)]}),_0x3a306d=await master_shop[_0x36e307(0xf4)]();let _0x197956;if(_0x11120d['role']=='staff'){const _0x366c82=await staff[_0x36e307(0xcb)]({'email':_0x11120d['email']});_0x197956=await warehouse[_0x36e307(0xd3)]([{'$match':{'status':_0x36e307(0xb6),'name':_0x366c82[_0x36e307(0xbd)]}},{'$group':{'_id':_0x36e307(0xcf),'name':{'$first':_0x36e307(0xcf)}}},{'$sort':{'name':-0x1}}]);}else _0x197956=await warehouse[_0x36e307(0xd3)]([{'$match':{'status':_0x36e307(0xb6)}},{'$group':{'_id':_0x36e307(0xcf),'name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);const _0x5a05ce=new Date()[_0x36e307(0xb3)]('en-US',{'timeZone':_0x3a306d[0x0][_0x36e307(0xca)]});if(_0x3a306d[0x0][_0x36e307(0xad)]==_0x36e307(0xd9))var _0x3b202d=users[_0x36e307(0xaf)];else{if(_0x3a306d[0x0][_0x36e307(0xad)]==_0x36e307(0xd6))var _0x3b202d=users[_0x36e307(0xd6)];else{if(_0x3a306d[0x0][_0x36e307(0xad)]==_0x36e307(0xe5))var _0x3b202d=users[_0x36e307(0xe5)];else{if(_0x3a306d[0x0][_0x36e307(0xad)]==_0x36e307(0xe7))var _0x3b202d=users[_0x36e307(0xe7)];else{if(_0x3a306d[0x0]['language']==_0x36e307(0xed))var _0x3b202d=users[_0x36e307(0xed)];else{if(_0x3a306d[0x0]['language']==_0x36e307(0xe4))var _0x3b202d=users[_0x36e307(0xff)];else{if(_0x3a306d[0x0][_0x36e307(0xad)]==_0x36e307(0xe3))var _0x3b202d=users[_0x36e307(0xe3)];else{if(_0x3a306d[0x0][_0x36e307(0xad)]==_0x36e307(0xc9))var _0x3b202d=users['Arabic'];}}}}}}}_0xe390c5['render'](_0x36e307(0xd0),{'success':_0xb3b608[_0x36e307(0x103)](_0x36e307(0xe2)),'errors':_0xb3b608[_0x36e307(0x103)](_0x36e307(0x100)),'role':_0x11120d,'profile':_0x59b3e6,'master_shop':_0x3a306d,'timezones':timezones,'language':_0x3b202d,'warehouse':_0x197956});}catch(_0x27a6e3){console[_0x36e307(0xdc)](_0x27a6e3),_0xe390c5[_0x36e307(0xc3)](0xc8)['json']({'message':_0x27a6e3[_0x36e307(0xef)]});}}),router[a0_0xb25d93(0xf8)](a0_0xb25d93(0xbf),async(_0x43a7b6,_0x2df636)=>{const _0x23827c=a0_0xb25d93,{warehouseNew:_0x59f9b4,rooms:_0x2af79f,Type:_0xcf485}=_0x43a7b6[_0x23827c(0xb5)],_0x45c8da=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'name':_0x59f9b4,'room':_0x2af79f,'product_details.type':_0xcf485}},{'$group':{'_id':{'bay':'$product_details.bay','bin':_0x23827c(0xde),'type':_0x23827c(0xc6),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x23827c(0xce),'product_code':_0x23827c(0xea)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x23827c(0xce),0x0]},'then':_0x23827c(0xce),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','bin':'$_id.bin','type':_0x23827c(0xac),'floorlevel':_0x23827c(0xba),'products':{'$filter':{'input':_0x23827c(0xb4),'as':_0x23827c(0xe0),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x2df636['json'](_0x45c8da);}),router[a0_0xb25d93(0xf8)](a0_0xb25d93(0xcc),async(_0x1aa0a9,_0x109543)=>{const _0xdaddfe=a0_0xb25d93,{warehouseNew:_0x2f7589,rooms:_0x6d4ae1,room_cat:_0x1fa45}=_0x1aa0a9['body'];let _0x393f31;if(_0x1fa45==_0xdaddfe(0xd8))_0x393f31=await warehouse[_0xdaddfe(0xd3)]([{'$unwind':'$product_details'},{'$match':{'name':_0x2f7589}},{'$group':{'_id':{'bay':'$product_details.bay','product':_0xdaddfe(0xeb),'expiry':_0xdaddfe(0xe9)},'count':{'$sum':'$product_details.product_stock'},'production_date':{'$first':_0xdaddfe(0xf9)},'expiry_date':{'$first':_0xdaddfe(0xe9)},'batch_code':{'$first':_0xdaddfe(0xec)},'product_code':{'$first':_0xdaddfe(0xea)}}},{'$group':{'_id':_0xdaddfe(0xae),'products':{'$push':{'product':_0xdaddfe(0xfc),'quantity':_0xdaddfe(0xbc),'production_date':_0xdaddfe(0xe6),'expiry_date':_0xdaddfe(0xd5),'batch_code':_0xdaddfe(0xda),'product_code':_0xdaddfe(0x101)}},'totalQuantity':{'$sum':'$count'}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0xdaddfe(0xd7),'products':0x1,'totalQuantity':0x1}}]),console[_0xdaddfe(0xdc)](_0x1fa45);else{}_0x109543[_0xdaddfe(0xf0)](_0x393f31);}),router[a0_0xb25d93(0xf8)](a0_0xb25d93(0xf7),async(_0x164371,_0x28a87f)=>{const _0x481dfc=a0_0xb25d93;try{const {warehouse_name:_0x485557}=_0x164371[_0x481dfc(0xb5)];var _0x21896f='';_0x21896f=[{'$match':{'name':_0x485557,'status':_0x481dfc(0xb6)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x481dfc(0xbb)}}},{'$sort':{'room_name':0x1}}];const _0x4319fb=await warehouse['aggregate'](_0x21896f);_0x28a87f[_0x481dfc(0xc3)](0xc8)[_0x481dfc(0xf0)](_0x4319fb);}catch(_0xcba94a){_0x28a87f['status'](0x190)[_0x481dfc(0xf0)]({'errorMessage':_0xcba94a[_0x481dfc(0xef)]});}}),router[a0_0xb25d93(0xf8)](a0_0xb25d93(0xdb),async(_0x32b56f,_0xbae0f4)=>{const _0x24a527=a0_0xb25d93;try{const {warehouse_name:_0x178947,cat:_0x21a796,valNew:_0x2a0f3e}=_0x32b56f[_0x24a527(0xb5)];var _0x3ff2df='',_0x57a193='';if(_0x21a796==_0x24a527(0xc7))_0x3ff2df=_0x24a527(0xd4),_0x2a0f3e==_0x24a527(0xb7)?_0x57a193=[{'$match':{'status':_0x24a527(0xb6),'warehouse_category':_0x21a796,'name':{'$ne':_0x3ff2df},'name':_0x24a527(0xbe)}},{'$group':{'_id':_0x24a527(0xcf),'room_name':{'$first':_0x24a527(0xcf)}}},{'$sort':{'room_name':0x1}}]:_0x57a193=[{'$match':{'status':'Enabled','warehouse_category':_0x21a796,'name':{'$ne':_0x3ff2df}}},{'$group':{'_id':_0x24a527(0xcf),'room_name':{'$first':_0x24a527(0xcf)}}},{'$sort':{'room_name':0x1}}];else _0x21a796==_0x24a527(0xc2)?(_0x3ff2df=_0x24a527(0xe1),_0x57a193=[{'$match':{'status':_0x24a527(0xb6),'warehouse_category':_0x21a796,'name':{'$ne':_0x3ff2df}}},{'$group':{'_id':_0x24a527(0xcf),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]):_0x57a193=[{'$match':{'status':_0x24a527(0xb6)}},{'$group':{'_id':'$name','room_name':{'$first':_0x24a527(0xcf)}}},{'$sort':{'room_name':0x1}}];const _0x4db9f6=await warehouse[_0x24a527(0xd3)](_0x57a193);_0xbae0f4[_0x24a527(0xc3)](0xc8)[_0x24a527(0xf0)](_0x4db9f6);}catch(_0x38af2b){_0xbae0f4[_0x24a527(0xc3)](0x190)[_0x24a527(0xf0)]({'errorMessage':_0x38af2b[_0x24a527(0xef)]}),console[_0x24a527(0xdc)](_0x38af2b);}}),router[a0_0xb25d93(0xf8)](a0_0xb25d93(0xc8),async(_0x289eb9,_0x770e4e)=>{const _0x13bcdf=a0_0xb25d93;try{const {warehouse_name:_0x418fb7,cat:_0x4a56ac}=_0x289eb9['body'],_0x3225b3=await warehouse[_0x13bcdf(0xd3)]([{'$match':{'status':_0x13bcdf(0xb6),'warehouse_category':_0x4a56ac,'name':_0x418fb7}},{'$group':{'_id':_0x13bcdf(0xbb),'room_name':{'$first':_0x13bcdf(0xbb)}}},{'$sort':{'room_name':0x1}}]);_0x770e4e[_0x13bcdf(0xc3)](0xc8)[_0x13bcdf(0xf0)](_0x3225b3);}catch(_0xc4edea){_0x770e4e[_0x13bcdf(0xc3)](0x190)[_0x13bcdf(0xf0)]({'errorMessage':_0xc4edea[_0x13bcdf(0xef)]});}}),router[a0_0xb25d93(0xf8)](a0_0xb25d93(0xb0),async(_0x1c60e3,_0x543d26)=>{const _0x14e36e=a0_0xb25d93;try{const {typeofsales:_0x3e4def}=_0x1c60e3[_0x14e36e(0xb5)];var _0x5c3b1c;_0x3e4def=='1'&&(_0x5c3b1c=await staff[_0x14e36e(0xf4)]({'account_category':'sa','type_of_acc_cat':_0x3e4def})),_0x543d26['status'](0xc8)[_0x14e36e(0xf0)](_0x5c3b1c);}catch(_0x484240){_0x543d26[_0x14e36e(0xc3)](0x190)[_0x14e36e(0xf0)]({'errorMessage':_0x484240[_0x14e36e(0xef)]});}}),router['post'](a0_0xb25d93(0xc5),async(_0x58bc61,_0x51aadb)=>{const _0x447cb0=a0_0xb25d93;try{const {id:_0x5b0ca6}=_0x58bc61[_0x447cb0(0xb5)],_0x2edf5e=await staff[_0x447cb0(0xf4)]({'_id':_0x5b0ca6});_0x51aadb[_0x447cb0(0xc3)](0xc8)[_0x447cb0(0xf0)](_0x2edf5e);}catch(_0x567ef9){_0x51aadb['status'](0x190)[_0x447cb0(0xf0)]({'errorMessage':_0x567ef9[_0x447cb0(0xef)]});}}),router[a0_0xb25d93(0xf8)](a0_0xb25d93(0xc0),async(_0x2d2149,_0x37410d)=>{const _0x3543f7=a0_0xb25d93;try{const {warehouse_name:_0x48a4b3,room_value:_0x32f1de}=_0x2d2149[_0x3543f7(0xb5)];let _0x55582a;_0x32f1de==_0x3543f7(0xc4)?_0x55582a=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'name':_0x48a4b3}},{'$group':{'_id':{'bay':_0x3543f7(0xfe),'level':_0x3543f7(0xd1),'type':_0x3543f7(0xc6),'floorlevel':_0x3543f7(0xf5)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':'$product_details.product_stock','product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x3543f7(0xce),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x3543f7(0xae),'level':_0x3543f7(0xf3),'type':_0x3543f7(0xac),'floorlevel':_0x3543f7(0xba),'products':{'$filter':{'input':_0x3543f7(0xb4),'as':'product','cond':{'$gt':[_0x3543f7(0xb8),0x0]}}},'totalQuantity':0x1}}]):_0x55582a=await warehouse[_0x3543f7(0xd3)]([{'$unwind':_0x3543f7(0xc1)},{'$match':{'name':_0x48a4b3,'room':_0x32f1de}},{'$group':{'_id':{'bay':'$product_details.bay','level':_0x3543f7(0xd1),'type':_0x3543f7(0xc6),'floorlevel':_0x3543f7(0xf5)},'products':{'$push':{'product_name':_0x3543f7(0xeb),'product_quantity':_0x3543f7(0xce),'product_code':_0x3543f7(0xea)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x3543f7(0xce),0x0]},'then':_0x3543f7(0xce),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x3543f7(0xae),'level':'$_id.level','type':'$_id.type','floorlevel':_0x3543f7(0xba),'products':{'$filter':{'input':_0x3543f7(0xb4),'as':'product','cond':{'$gt':[_0x3543f7(0xb8),0x0]}}},'totalQuantity':0x1}}]),_0x37410d[_0x3543f7(0xc3)](0xc8)[_0x3543f7(0xf0)](_0x55582a);}catch(_0xf12f0a){_0x37410d[_0x3543f7(0xc3)](0x190)[_0x3543f7(0xf0)]({'errorMessage':_0xf12f0a['message']});}}),module[a0_0xb25d93(0xfd)]=router;