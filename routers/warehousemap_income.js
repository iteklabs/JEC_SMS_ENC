const a0_0x476767=a0_0x2e03;function a0_0x2e03(_0x5f4e20,_0x538d0c){const _0x11223b=a0_0x1122();return a0_0x2e03=function(_0x2e0343,_0x3d735f){_0x2e0343=_0x2e0343-0x134;let _0x41defd=_0x11223b[_0x2e0343];return _0x41defd;},a0_0x2e03(_0x5f4e20,_0x538d0c);}(function(_0x1e5c26,_0x5dc983){const _0x1449ef=a0_0x2e03,_0x247c87=_0x1e5c26();while(!![]){try{const _0x31950a=-parseInt(_0x1449ef(0x171))/0x1*(-parseInt(_0x1449ef(0x13e))/0x2)+parseInt(_0x1449ef(0x17d))/0x3*(-parseInt(_0x1449ef(0x18d))/0x4)+-parseInt(_0x1449ef(0x15c))/0x5+parseInt(_0x1449ef(0x186))/0x6+parseInt(_0x1449ef(0x136))/0x7*(parseInt(_0x1449ef(0x187))/0x8)+-parseInt(_0x1449ef(0x154))/0x9*(-parseInt(_0x1449ef(0x140))/0xa)+parseInt(_0x1449ef(0x16c))/0xb*(parseInt(_0x1449ef(0x177))/0xc);if(_0x31950a===_0x5dc983)break;else _0x247c87['push'](_0x247c87['shift']());}catch(_0x4a4d5e){_0x247c87['push'](_0x247c87['shift']());}}}(a0_0x1122,0x2918c));const express=require(a0_0x476767(0x17f)),app=express(),router=express[a0_0x476767(0x16f)](),multer=require(a0_0x476767(0x18c)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x476767(0x14c)),auth=require(a0_0x476767(0x175));var timezones=require(a0_0x476767(0x13b));function a0_0x1122(){const _0x58aac0=['258490FkKAlm','role','$_id.bay','$product_details.bay','message','$_id.type','../public/language/languages.json','$product_details.floorlevel','status','product','findOne','German','../models/all_models','/map_value','warehousemap_incoming','/staff_sales_id','$_id','$production_date','/Rooms_data3','Spanish','9fORyvs','find','$expiry_date','Raw\x20Materials','$product_details.level','log','English','Hindi','1090180lSoFkB','success','render','$name','QA\x20Warehouse','$products','All','$product_details.product_name','language','DRY\x20STORAGE','French','$count','Portuguese\x20(BR)','$_id.level','flash','user','44NVZfTN','$room','Return\x20Goods','Router','Enabled','609uBuXYU','timezone','$product_details.bin','/Rooms_data2','../middleware/auth','body','685740anzXxD','Arabic','$product_details.product_stock','$product_details.product_code','Portuguese','Arabic\x20(ae)','995637ZWRbok','$product_details.type','express','warehouse','/MapData2','json','en-US','errors','aggregate','978378tVutvv','31472mTxUVy','/staff_sales','Finished\x20Goods','$product_code','email','multer','4MOTTKb','$product_details.expiry_date','Chinese','287tnHjyJ','/Rooms_data','post','exports','English\x20(US)','timezones-list','$product_details','$_id.floorlevel','458aFfwEe','$$product.product_quantity'];a0_0x1122=function(){return _0x58aac0;};return a0_0x1122();}const users=require(a0_0x476767(0x146));router['get']('/view',auth,async(_0x2c0f78,_0x1827b4)=>{const _0x15e997=a0_0x476767;try{const {username:_0x2c25e1,email:_0x25e5e2,role:_0xacdf3e}=_0x2c0f78[_0x15e997(0x16b)],_0x2ff57e=_0x2c0f78['user'],_0x4b2bc0=await profile[_0x15e997(0x14a)]({'email':_0x2ff57e[_0x15e997(0x18b)]}),_0x395644=await master_shop[_0x15e997(0x155)]();let _0xe1a34d;if(_0x2ff57e[_0x15e997(0x141)]=='staff'){const _0x56a1ce=await staff[_0x15e997(0x14a)]({'email':_0x2ff57e[_0x15e997(0x18b)]});_0xe1a34d=await warehouse[_0x15e997(0x185)]([{'$match':{'status':_0x15e997(0x170),'name':_0x56a1ce[_0x15e997(0x180)]}},{'$group':{'_id':_0x15e997(0x15f),'name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);}else _0xe1a34d=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x15e997(0x15f),'name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);const _0x2db964=new Date()['toLocaleString'](_0x15e997(0x183),{'timeZone':_0x395644[0x0][_0x15e997(0x172)]});if(_0x395644[0x0][_0x15e997(0x164)]==_0x15e997(0x13a))var _0x35344d=users[_0x15e997(0x15a)];else{if(_0x395644[0x0][_0x15e997(0x164)]==_0x15e997(0x15b))var _0x35344d=users['Hindi'];else{if(_0x395644[0x0][_0x15e997(0x164)]==_0x15e997(0x14b))var _0x35344d=users[_0x15e997(0x14b)];else{if(_0x395644[0x0][_0x15e997(0x164)]==_0x15e997(0x153))var _0x35344d=users[_0x15e997(0x153)];else{if(_0x395644[0x0][_0x15e997(0x164)]=='French')var _0x35344d=users[_0x15e997(0x166)];else{if(_0x395644[0x0][_0x15e997(0x164)]==_0x15e997(0x168))var _0x35344d=users[_0x15e997(0x17b)];else{if(_0x395644[0x0]['language']==_0x15e997(0x135))var _0x35344d=users['Chinese'];else{if(_0x395644[0x0][_0x15e997(0x164)]==_0x15e997(0x17c))var _0x35344d=users[_0x15e997(0x178)];}}}}}}}_0x1827b4[_0x15e997(0x15e)](_0x15e997(0x14e),{'success':_0x2c0f78[_0x15e997(0x16a)](_0x15e997(0x15d)),'errors':_0x2c0f78[_0x15e997(0x16a)](_0x15e997(0x184)),'role':_0x2ff57e,'profile':_0x4b2bc0,'master_shop':_0x395644,'timezones':timezones,'language':_0x35344d,'warehouse':_0xe1a34d});}catch(_0x704c24){console[_0x15e997(0x159)](_0x704c24),_0x1827b4[_0x15e997(0x148)](0xc8)['json']({'message':_0x704c24[_0x15e997(0x144)]});}}),router[a0_0x476767(0x138)]('/MapData',async(_0x577744,_0x47e042)=>{const _0x328384=a0_0x476767,{warehouseNew:_0x18d0ab,rooms:_0x54340f,Type:_0xbfb93d}=_0x577744[_0x328384(0x176)],_0x5bf12d=await warehouse[_0x328384(0x185)]([{'$unwind':'$product_details'},{'$match':{'name':_0x18d0ab,'room':_0x54340f,'product_details.type':_0xbfb93d}},{'$group':{'_id':{'bay':_0x328384(0x143),'bin':_0x328384(0x173),'type':_0x328384(0x17e),'floorlevel':_0x328384(0x147)},'products':{'$push':{'product_name':_0x328384(0x163),'product_quantity':_0x328384(0x179),'product_code':_0x328384(0x17a)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x328384(0x179),0x0]},'then':_0x328384(0x179),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','bin':'$_id.bin','type':'$_id.type','floorlevel':_0x328384(0x13d),'products':{'$filter':{'input':_0x328384(0x161),'as':_0x328384(0x149),'cond':{'$gt':[_0x328384(0x13f),0x0]}}},'totalQuantity':0x1}}]);_0x47e042[_0x328384(0x182)](_0x5bf12d);}),router[a0_0x476767(0x138)](a0_0x476767(0x181),async(_0x501d66,_0x348e5b)=>{const _0x941df2=a0_0x476767,{warehouseNew:_0x12274,rooms:_0x1f436b,room_cat:_0x19f5f9}=_0x501d66[_0x941df2(0x176)];let _0x2b99ce;if(_0x19f5f9==_0x941df2(0x162))_0x2b99ce=await warehouse[_0x941df2(0x185)]([{'$unwind':_0x941df2(0x13c)},{'$match':{'name':_0x12274}},{'$group':{'_id':{'bay':_0x941df2(0x143),'product':_0x941df2(0x163),'expiry':_0x941df2(0x134)},'count':{'$sum':_0x941df2(0x179)},'production_date':{'$first':'$product_details.production_date'},'expiry_date':{'$first':_0x941df2(0x134)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x941df2(0x17a)}}},{'$group':{'_id':_0x941df2(0x142),'products':{'$push':{'product':'$_id.product','quantity':_0x941df2(0x167),'production_date':_0x941df2(0x151),'expiry_date':_0x941df2(0x156),'batch_code':'$batch_code','product_code':_0x941df2(0x18a)}},'totalQuantity':{'$sum':_0x941df2(0x167)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x941df2(0x150),'products':0x1,'totalQuantity':0x1}}]),console['log'](_0x19f5f9);else{}_0x348e5b[_0x941df2(0x182)](_0x2b99ce);}),router['post'](a0_0x476767(0x137),async(_0x22b4f4,_0x44e1b4)=>{const _0x1faf1a=a0_0x476767;try{const {warehouse_name:_0x9ef3be}=_0x22b4f4['body'];var _0x1649c7='';_0x1649c7=[{'$match':{'name':_0x9ef3be,'status':'Enabled'}},{'$group':{'_id':_0x1faf1a(0x150),'room_name':{'$first':_0x1faf1a(0x16d)}}},{'$sort':{'room_name':0x1}}];const _0x134cb5=await warehouse[_0x1faf1a(0x185)](_0x1649c7);_0x44e1b4['status'](0xc8)[_0x1faf1a(0x182)](_0x134cb5);}catch(_0x133636){_0x44e1b4[_0x1faf1a(0x148)](0x190)[_0x1faf1a(0x182)]({'errorMessage':_0x133636[_0x1faf1a(0x144)]});}}),router[a0_0x476767(0x138)](a0_0x476767(0x174),async(_0x11fdda,_0x2fd7f9)=>{const _0x5b880f=a0_0x476767;try{const {warehouse_name:_0x1af12f,cat:_0xb4294b,valNew:_0x246994}=_0x11fdda[_0x5b880f(0x176)];var _0x3d06f2='',_0x41dcc9='';if(_0xb4294b==_0x5b880f(0x157))_0x3d06f2=_0x5b880f(0x16e),_0x246994=='pack'?_0x41dcc9=[{'$match':{'status':_0x5b880f(0x170),'warehouse_category':_0xb4294b,'name':{'$ne':_0x3d06f2},'name':_0x5b880f(0x165)}},{'$group':{'_id':'$name','room_name':{'$first':_0x5b880f(0x15f)}}},{'$sort':{'room_name':0x1}}]:_0x41dcc9=[{'$match':{'status':_0x5b880f(0x170),'warehouse_category':_0xb4294b,'name':{'$ne':_0x3d06f2}}},{'$group':{'_id':_0x5b880f(0x15f),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];else _0xb4294b==_0x5b880f(0x189)?(_0x3d06f2=_0x5b880f(0x160),_0x41dcc9=[{'$match':{'status':_0x5b880f(0x170),'warehouse_category':_0xb4294b,'name':{'$ne':_0x3d06f2}}},{'$group':{'_id':_0x5b880f(0x15f),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]):_0x41dcc9=[{'$match':{'status':_0x5b880f(0x170)}},{'$group':{'_id':_0x5b880f(0x15f),'room_name':{'$first':_0x5b880f(0x15f)}}},{'$sort':{'room_name':0x1}}];const _0x322680=await warehouse['aggregate'](_0x41dcc9);_0x2fd7f9[_0x5b880f(0x148)](0xc8)[_0x5b880f(0x182)](_0x322680);}catch(_0xbe3af0){_0x2fd7f9[_0x5b880f(0x148)](0x190)[_0x5b880f(0x182)]({'errorMessage':_0xbe3af0['message']}),console[_0x5b880f(0x159)](_0xbe3af0);}}),router[a0_0x476767(0x138)](a0_0x476767(0x152),async(_0xabd66a,_0x39bbce)=>{const _0x41a21a=a0_0x476767;try{const {warehouse_name:_0x4fee9e,cat:_0x53becf}=_0xabd66a[_0x41a21a(0x176)],_0x5af72b=await warehouse[_0x41a21a(0x185)]([{'$match':{'status':_0x41a21a(0x170),'warehouse_category':_0x53becf,'name':_0x4fee9e}},{'$group':{'_id':'$room','room_name':{'$first':_0x41a21a(0x16d)}}},{'$sort':{'room_name':0x1}}]);_0x39bbce['status'](0xc8)[_0x41a21a(0x182)](_0x5af72b);}catch(_0x245cf5){_0x39bbce[_0x41a21a(0x148)](0x190)[_0x41a21a(0x182)]({'errorMessage':_0x245cf5[_0x41a21a(0x144)]});}}),router['post'](a0_0x476767(0x188),async(_0x16b148,_0x20c580)=>{const _0x3f1cb9=a0_0x476767;try{const {typeofsales:_0x485d11}=_0x16b148[_0x3f1cb9(0x176)];var _0x3c7256;_0x485d11=='1'&&(_0x3c7256=await staff['find']({'account_category':'sa','type_of_acc_cat':_0x485d11})),_0x20c580[_0x3f1cb9(0x148)](0xc8)[_0x3f1cb9(0x182)](_0x3c7256);}catch(_0x157b34){_0x20c580['status'](0x190)[_0x3f1cb9(0x182)]({'errorMessage':_0x157b34[_0x3f1cb9(0x144)]});}}),router['post'](a0_0x476767(0x14f),async(_0x1e5eb7,_0x3187cd)=>{const _0x3e45ae=a0_0x476767;try{const {id:_0x20a34f}=_0x1e5eb7['body'],_0x47aead=await staff[_0x3e45ae(0x155)]({'_id':_0x20a34f});_0x3187cd[_0x3e45ae(0x148)](0xc8)['json'](_0x47aead);}catch(_0x1fe6a4){_0x3187cd[_0x3e45ae(0x148)](0x190)[_0x3e45ae(0x182)]({'errorMessage':_0x1fe6a4[_0x3e45ae(0x144)]});}}),router[a0_0x476767(0x138)](a0_0x476767(0x14d),async(_0x4b389d,_0x152319)=>{const _0x43c800=a0_0x476767;try{const {warehouse_name:_0xb710bc,room_value:_0x352532}=_0x4b389d['body'];let _0x1f9091;_0x352532=='all'?_0x1f9091=await warehouse['aggregate']([{'$unwind':_0x43c800(0x13c)},{'$match':{'name':_0xb710bc}},{'$group':{'_id':{'bay':'$product_details.bay','level':_0x43c800(0x158),'type':_0x43c800(0x17e),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x43c800(0x179),'product_code':_0x43c800(0x17a)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x43c800(0x179),0x0]},'then':_0x43c800(0x179),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x43c800(0x142),'level':_0x43c800(0x169),'type':_0x43c800(0x145),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x43c800(0x161),'as':_0x43c800(0x149),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]):_0x1f9091=await warehouse[_0x43c800(0x185)]([{'$unwind':_0x43c800(0x13c)},{'$match':{'name':_0xb710bc,'room':_0x352532}},{'$group':{'_id':{'bay':_0x43c800(0x143),'level':_0x43c800(0x158),'type':'$product_details.type','floorlevel':_0x43c800(0x147)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':'$product_details.product_stock','product_code':_0x43c800(0x17a)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':_0x43c800(0x179),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x43c800(0x142),'level':_0x43c800(0x169),'type':_0x43c800(0x145),'floorlevel':_0x43c800(0x13d),'products':{'$filter':{'input':_0x43c800(0x161),'as':_0x43c800(0x149),'cond':{'$gt':[_0x43c800(0x13f),0x0]}}},'totalQuantity':0x1}}]),_0x152319[_0x43c800(0x148)](0xc8)[_0x43c800(0x182)](_0x1f9091);}catch(_0x175b6f){_0x152319[_0x43c800(0x148)](0x190)[_0x43c800(0x182)]({'errorMessage':_0x175b6f[_0x43c800(0x144)]});}}),module[a0_0x476767(0x139)]=router;