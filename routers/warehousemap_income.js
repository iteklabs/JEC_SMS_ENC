const a0_0x141d8a=a0_0x3906;(function(_0xc83b7c,_0x191b1c){const _0x12972c=a0_0x3906,_0x302454=_0xc83b7c();while(!![]){try{const _0x55f799=parseInt(_0x12972c(0x1fe))/0x1*(-parseInt(_0x12972c(0x1ba))/0x2)+-parseInt(_0x12972c(0x200))/0x3*(-parseInt(_0x12972c(0x1bb))/0x4)+-parseInt(_0x12972c(0x1ed))/0x5+parseInt(_0x12972c(0x1e4))/0x6+-parseInt(_0x12972c(0x1e3))/0x7*(-parseInt(_0x12972c(0x1d0))/0x8)+-parseInt(_0x12972c(0x1e7))/0x9*(parseInt(_0x12972c(0x1d8))/0xa)+parseInt(_0x12972c(0x1ff))/0xb;if(_0x55f799===_0x191b1c)break;else _0x302454['push'](_0x302454['shift']());}catch(_0x355b06){_0x302454['push'](_0x302454['shift']());}}}(a0_0x2ec7,0x63f15));const express=require(a0_0x141d8a(0x1be)),app=express(),router=express[a0_0x141d8a(0x1fb)](),multer=require('multer'),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x141d8a(0x1cc)),auth=require(a0_0x141d8a(0x1c1));var timezones=require('timezones-list');const users=require(a0_0x141d8a(0x1ef));function a0_0x3906(_0x2d4f13,_0x5997b9){const _0x2ec7cd=a0_0x2ec7();return a0_0x3906=function(_0x390655,_0xf2e1b4){_0x390655=_0x390655-0x1af;let _0x14ced7=_0x2ec7cd[_0x390655];return _0x14ced7;},a0_0x3906(_0x2d4f13,_0x5997b9);}function a0_0x2ec7(){const _0x556aa2=['$_id.type','flash','7LMDhfH','2923560BoOLbx','/MapData2','$product_details.type','2024712aDVlZT','/Rooms_data3','errors','get','$_id.floorlevel','Enabled','223540BaTxfE','role','../public/language/languages.json','$_id','/Rooms_data2','body','$product_details.product_code','$product_details.floorlevel','German','render','Arabic','$_id.bay','English','$$product.product_quantity','Router','product','aggregate','1tAktev','5081978eLLNuJ','3NDierl','Spanish','DRY\x20STORAGE','findOne','$product_details.product_name','$product_details.expiry_date','$product_details.level','Return\x20Goods','log','message','user','/staff_sales_id','French','$product_details.product_stock','426450mfyJvc','1107824vkwAUx','exports','Hindi','express','/MapData','$name','../middleware/auth','Chinese','$_id.bin','en-US','pack','$product_code','json','email','$_id.level','Portuguese\x20(BR)','staff','../models/all_models','Portuguese','$product_details.production_date','All','927904hUnikt','$products','warehousemap_incoming','status','language','/Rooms_data','timezone','toLocaleString','30pauYxy','$product_details','post','$count','$expiry_date','$_id.product','all','$product_details.bay','/staff_sales'];a0_0x2ec7=function(){return _0x556aa2;};return a0_0x2ec7();}router[a0_0x141d8a(0x1ea)]('/view',auth,async(_0x55587e,_0x13d315)=>{const _0x3f80f4=a0_0x141d8a;try{const {username:_0x52e719,email:_0x3a0999,role:_0x4ff7aa}=_0x55587e[_0x3f80f4(0x1b6)],_0x123fbc=_0x55587e[_0x3f80f4(0x1b6)],_0x816d4=await profile[_0x3f80f4(0x1af)]({'email':_0x123fbc[_0x3f80f4(0x1c8)]}),_0x5b14ef=await master_shop['find']();let _0x2e764c;if(_0x123fbc[_0x3f80f4(0x1ee)]==_0x3f80f4(0x1cb)){const _0x317883=await staff[_0x3f80f4(0x1af)]({'email':_0x123fbc[_0x3f80f4(0x1c8)]});_0x2e764c=await warehouse[_0x3f80f4(0x1fd)]([{'$match':{'status':'Enabled','name':_0x317883['warehouse']}},{'$group':{'_id':_0x3f80f4(0x1c0),'name':{'$first':_0x3f80f4(0x1c0)}}},{'$sort':{'name':-0x1}}]);}else _0x2e764c=await warehouse[_0x3f80f4(0x1fd)]([{'$match':{'status':_0x3f80f4(0x1ec)}},{'$group':{'_id':_0x3f80f4(0x1c0),'name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);const _0x383229=new Date()[_0x3f80f4(0x1d7)](_0x3f80f4(0x1c4),{'timeZone':_0x5b14ef[0x0][_0x3f80f4(0x1d6)]});if(_0x5b14ef[0x0][_0x3f80f4(0x1d4)]=='English\x20(US)')var _0x49f2d8=users[_0x3f80f4(0x1f9)];else{if(_0x5b14ef[0x0][_0x3f80f4(0x1d4)]==_0x3f80f4(0x1bd))var _0x49f2d8=users[_0x3f80f4(0x1bd)];else{if(_0x5b14ef[0x0][_0x3f80f4(0x1d4)]==_0x3f80f4(0x1f5))var _0x49f2d8=users[_0x3f80f4(0x1f5)];else{if(_0x5b14ef[0x0]['language']==_0x3f80f4(0x201))var _0x49f2d8=users[_0x3f80f4(0x201)];else{if(_0x5b14ef[0x0][_0x3f80f4(0x1d4)]==_0x3f80f4(0x1b8))var _0x49f2d8=users[_0x3f80f4(0x1b8)];else{if(_0x5b14ef[0x0][_0x3f80f4(0x1d4)]==_0x3f80f4(0x1ca))var _0x49f2d8=users[_0x3f80f4(0x1cd)];else{if(_0x5b14ef[0x0][_0x3f80f4(0x1d4)]=='Chinese')var _0x49f2d8=users[_0x3f80f4(0x1c2)];else{if(_0x5b14ef[0x0][_0x3f80f4(0x1d4)]=='Arabic\x20(ae)')var _0x49f2d8=users[_0x3f80f4(0x1f7)];}}}}}}}_0x13d315[_0x3f80f4(0x1f6)](_0x3f80f4(0x1d2),{'success':_0x55587e['flash']('success'),'errors':_0x55587e[_0x3f80f4(0x1e2)](_0x3f80f4(0x1e9)),'role':_0x123fbc,'profile':_0x816d4,'master_shop':_0x5b14ef,'timezones':timezones,'language':_0x49f2d8,'warehouse':_0x2e764c});}catch(_0x1e3425){console['log'](_0x1e3425),_0x13d315['status'](0xc8)[_0x3f80f4(0x1c7)]({'message':_0x1e3425['message']});}}),router[a0_0x141d8a(0x1da)](a0_0x141d8a(0x1bf),async(_0x741c2e,_0x28ea31)=>{const _0x4ef2e8=a0_0x141d8a,{warehouseNew:_0x34ae34,rooms:_0xafc29a,Type:_0x114451}=_0x741c2e[_0x4ef2e8(0x1f2)],_0x327dcc=await warehouse[_0x4ef2e8(0x1fd)]([{'$unwind':_0x4ef2e8(0x1d9)},{'$match':{'name':_0x34ae34,'room':_0xafc29a,'product_details.type':_0x114451}},{'$group':{'_id':{'bay':_0x4ef2e8(0x1df),'bin':'$product_details.bin','type':_0x4ef2e8(0x1e6),'floorlevel':_0x4ef2e8(0x1f4)},'products':{'$push':{'product_name':_0x4ef2e8(0x1b0),'product_quantity':'$product_details.product_stock','product_code':_0x4ef2e8(0x1f3)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x4ef2e8(0x1b9),0x0]},'then':_0x4ef2e8(0x1b9),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x4ef2e8(0x1f8),'bin':_0x4ef2e8(0x1c3),'type':_0x4ef2e8(0x1e1),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':'$products','as':'product','cond':{'$gt':[_0x4ef2e8(0x1fa),0x0]}}},'totalQuantity':0x1}}]);_0x28ea31[_0x4ef2e8(0x1c7)](_0x327dcc);}),router[a0_0x141d8a(0x1da)](a0_0x141d8a(0x1e5),async(_0x18f157,_0x3026ea)=>{const _0xef754c=a0_0x141d8a,{warehouseNew:_0x46d0d5,rooms:_0x5ae643,room_cat:_0x3b9f94}=_0x18f157[_0xef754c(0x1f2)];let _0x44fa87;if(_0x3b9f94==_0xef754c(0x1cf))_0x44fa87=await warehouse[_0xef754c(0x1fd)]([{'$unwind':'$product_details'},{'$match':{'name':_0x46d0d5}},{'$group':{'_id':{'bay':_0xef754c(0x1df),'product':_0xef754c(0x1b0),'expiry':_0xef754c(0x1b1)},'count':{'$sum':_0xef754c(0x1b9)},'production_date':{'$first':_0xef754c(0x1ce)},'expiry_date':{'$first':_0xef754c(0x1b1)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0xef754c(0x1f3)}}},{'$group':{'_id':_0xef754c(0x1f8),'products':{'$push':{'product':_0xef754c(0x1dd),'quantity':_0xef754c(0x1db),'production_date':'$production_date','expiry_date':_0xef754c(0x1dc),'batch_code':'$batch_code','product_code':_0xef754c(0x1c6)}},'totalQuantity':{'$sum':_0xef754c(0x1db)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0xef754c(0x1b4)](_0x3b9f94);else{}_0x3026ea['json'](_0x44fa87);}),router[a0_0x141d8a(0x1da)](a0_0x141d8a(0x1d5),async(_0x335f4c,_0x157954)=>{const _0x22c011=a0_0x141d8a;try{const {warehouse_name:_0x2c2e02}=_0x335f4c[_0x22c011(0x1f2)];var _0x59258d='';_0x59258d=[{'$match':{'name':_0x2c2e02,'status':_0x22c011(0x1ec)}},{'$group':{'_id':_0x22c011(0x1f0),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}];const _0x4c7fb9=await warehouse['aggregate'](_0x59258d);_0x157954['status'](0xc8)['json'](_0x4c7fb9);}catch(_0x41f2d2){_0x157954[_0x22c011(0x1d3)](0x190)[_0x22c011(0x1c7)]({'errorMessage':_0x41f2d2['message']});}}),router[a0_0x141d8a(0x1da)](a0_0x141d8a(0x1f1),async(_0x39f82e,_0x4fd095)=>{const _0x2086aa=a0_0x141d8a;try{const {warehouse_name:_0x106975,cat:_0x423225,valNew:_0xdacfc3}=_0x39f82e[_0x2086aa(0x1f2)];var _0x1b2e4c='',_0xc5660d='';if(_0x423225=='Raw\x20Materials')_0x1b2e4c=_0x2086aa(0x1b3),_0xdacfc3==_0x2086aa(0x1c5)?_0xc5660d=[{'$match':{'status':_0x2086aa(0x1ec),'warehouse_category':_0x423225,'name':{'$ne':_0x1b2e4c},'name':_0x2086aa(0x202)}},{'$group':{'_id':'$name','room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]:_0xc5660d=[{'$match':{'status':_0x2086aa(0x1ec),'warehouse_category':_0x423225,'name':{'$ne':_0x1b2e4c}}},{'$group':{'_id':'$name','room_name':{'$first':_0x2086aa(0x1c0)}}},{'$sort':{'room_name':0x1}}];else _0x423225=='Finished\x20Goods'?(_0x1b2e4c='QA\x20Warehouse',_0xc5660d=[{'$match':{'status':_0x2086aa(0x1ec),'warehouse_category':_0x423225,'name':{'$ne':_0x1b2e4c}}},{'$group':{'_id':_0x2086aa(0x1c0),'room_name':{'$first':_0x2086aa(0x1c0)}}},{'$sort':{'room_name':0x1}}]):_0xc5660d=[{'$match':{'status':_0x2086aa(0x1ec)}},{'$group':{'_id':_0x2086aa(0x1c0),'room_name':{'$first':_0x2086aa(0x1c0)}}},{'$sort':{'room_name':0x1}}];const _0x5c4890=await warehouse[_0x2086aa(0x1fd)](_0xc5660d);_0x4fd095['status'](0xc8)['json'](_0x5c4890);}catch(_0x1643a7){_0x4fd095[_0x2086aa(0x1d3)](0x190)['json']({'errorMessage':_0x1643a7['message']}),console[_0x2086aa(0x1b4)](_0x1643a7);}}),router[a0_0x141d8a(0x1da)](a0_0x141d8a(0x1e8),async(_0x1f3bab,_0x51edf6)=>{const _0x14ccc7=a0_0x141d8a;try{const {warehouse_name:_0xf93159,cat:_0x28566c}=_0x1f3bab[_0x14ccc7(0x1f2)],_0x412ee5=await warehouse[_0x14ccc7(0x1fd)]([{'$match':{'status':_0x14ccc7(0x1ec),'warehouse_category':_0x28566c,'name':_0xf93159}},{'$group':{'_id':'$room','room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]);_0x51edf6['status'](0xc8)[_0x14ccc7(0x1c7)](_0x412ee5);}catch(_0x200bc4){_0x51edf6['status'](0x190)['json']({'errorMessage':_0x200bc4[_0x14ccc7(0x1b5)]});}}),router[a0_0x141d8a(0x1da)](a0_0x141d8a(0x1e0),async(_0x5b32ea,_0x34077c)=>{const _0x2ffb53=a0_0x141d8a;try{const {typeofsales:_0x15df5d}=_0x5b32ea[_0x2ffb53(0x1f2)],_0x486c00=await staff['find']({'account_category':'sa','type_of_acc_cat':_0x15df5d});_0x34077c['status'](0xc8)['json'](_0x486c00);}catch(_0x5c29a0){_0x34077c[_0x2ffb53(0x1d3)](0x190)[_0x2ffb53(0x1c7)]({'errorMessage':_0x5c29a0[_0x2ffb53(0x1b5)]});}}),router[a0_0x141d8a(0x1da)](a0_0x141d8a(0x1b7),async(_0x41caff,_0x3b83c9)=>{const _0x723b81=a0_0x141d8a;try{const {id:_0x2a167d}=_0x41caff[_0x723b81(0x1f2)],_0x58ca51=await staff['find']({'_id':_0x2a167d});_0x3b83c9[_0x723b81(0x1d3)](0xc8)[_0x723b81(0x1c7)](_0x58ca51);}catch(_0x2fa3f8){_0x3b83c9[_0x723b81(0x1d3)](0x190)['json']({'errorMessage':_0x2fa3f8[_0x723b81(0x1b5)]});}}),router[a0_0x141d8a(0x1da)]('/map_value',async(_0x1ef9a3,_0x2f8c08)=>{const _0x2219c9=a0_0x141d8a;try{const {warehouse_name:_0x181fb5,room_value:_0x1170c8}=_0x1ef9a3[_0x2219c9(0x1f2)];let _0x1879c3;_0x1170c8==_0x2219c9(0x1de)?_0x1879c3=await warehouse[_0x2219c9(0x1fd)]([{'$unwind':'$product_details'},{'$match':{'name':_0x181fb5}},{'$group':{'_id':{'bay':'$product_details.bay','level':_0x2219c9(0x1b2),'type':_0x2219c9(0x1e6),'floorlevel':_0x2219c9(0x1f4)},'products':{'$push':{'product_name':_0x2219c9(0x1b0),'product_quantity':_0x2219c9(0x1b9),'product_code':_0x2219c9(0x1f3)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x2219c9(0x1b9),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','level':_0x2219c9(0x1c9),'type':'$_id.type','floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x2219c9(0x1d1),'as':'product','cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]):_0x1879c3=await warehouse[_0x2219c9(0x1fd)]([{'$unwind':_0x2219c9(0x1d9)},{'$match':{'name':_0x181fb5,'room':_0x1170c8}},{'$group':{'_id':{'bay':_0x2219c9(0x1df),'level':_0x2219c9(0x1b2),'type':_0x2219c9(0x1e6),'floorlevel':_0x2219c9(0x1f4)},'products':{'$push':{'product_name':_0x2219c9(0x1b0),'product_quantity':'$product_details.product_stock','product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x2219c9(0x1b9),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x2219c9(0x1f8),'level':'$_id.level','type':'$_id.type','floorlevel':_0x2219c9(0x1eb),'products':{'$filter':{'input':_0x2219c9(0x1d1),'as':_0x2219c9(0x1fc),'cond':{'$gt':[_0x2219c9(0x1fa),0x0]}}},'totalQuantity':0x1}}]),_0x2f8c08[_0x2219c9(0x1d3)](0xc8)[_0x2219c9(0x1c7)](_0x1879c3);}catch(_0x75e8fc){_0x2f8c08[_0x2219c9(0x1d3)](0x190)[_0x2219c9(0x1c7)]({'errorMessage':_0x75e8fc[_0x2219c9(0x1b5)]});}}),module[a0_0x141d8a(0x1bc)]=router;