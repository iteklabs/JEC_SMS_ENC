const a0_0x208501=a0_0x1abf;function a0_0x34e5(){const _0x2d0fab=['Arabic\x20(ae)','$product_details.production_date','$_id.type','5860632zTtQQd','$product_details.level','$product_details.floorlevel','7bKxCrm','454416TogHFU','$product_details.bin','2040945VOGoIT','/Rooms_data','Portuguese\x20(BR)','$name','/Rooms_data3','warehouse','timezones-list','772ivFRoW','express','$product_details.product_name','653wxaLUv','$products','errors','German','/view','/MapData','French','message','json','aggregate','$product_details.type','29934531GUKNRg','/map_value','flash','$product_details.product_stock','$_id','/staff_sales_id','staff','$product_details.expiry_date','Finished\x20Goods','email','../middleware/auth','log','user','body','post','40QidopT','Portuguese','8184568NTOBNE','find','/Rooms_data2','multer','render','/staff_sales','Raw\x20Materials','Enabled','Return\x20Goods','status','$expiry_date','$product_details.bay','language','exports','Chinese','../public/language/languages.json','$_id.bay','$production_date','Hindi','findOne','$$product.product_quantity','$product_code','$_id.product','../models/all_models','Arabic','toLocaleString','$_id.floorlevel','Spanish','all','success','4GZoWyN','DRY\x20STORAGE','$room','Router','$count','$product_details.product_code','en-US','$product_details','product','1570689BXmiqW'];a0_0x34e5=function(){return _0x2d0fab;};return a0_0x34e5();}(function(_0x4a937c,_0x20bf47){const _0x2abe13=a0_0x1abf,_0x68f9ed=_0x4a937c();while(!![]){try{const _0x1d9f04=-parseInt(_0x2abe13(0xbd))/0x1*(-parseInt(_0x2abe13(0xba))/0x2)+-parseInt(_0x2abe13(0xb1))/0x3*(-parseInt(_0x2abe13(0xa0))/0x4)+parseInt(_0x2abe13(0xb3))/0x5+parseInt(_0x2abe13(0xad))/0x6+-parseInt(_0x2abe13(0xb0))/0x7*(-parseInt(_0x2abe13(0xd9))/0x8)+parseInt(_0x2abe13(0xa9))/0x9*(parseInt(_0x2abe13(0xd7))/0xa)+-parseInt(_0x2abe13(0xc8))/0xb;if(_0x1d9f04===_0x20bf47)break;else _0x68f9ed['push'](_0x68f9ed['shift']());}catch(_0x1974dc){_0x68f9ed['push'](_0x68f9ed['shift']());}}}(a0_0x34e5,0xc0765));const express=require(a0_0x208501(0xbb)),app=express(),router=express[a0_0x208501(0xa3)](),multer=require(a0_0x208501(0xdc)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x208501(0x99)),auth=require(a0_0x208501(0xd2));var timezones=require(a0_0x208501(0xb9));const users=require(a0_0x208501(0x91));function a0_0x1abf(_0x25c461,_0x3a8766){const _0x34e528=a0_0x34e5();return a0_0x1abf=function(_0x1abfc6,_0x4f878b){_0x1abfc6=_0x1abfc6-0x8e;let _0x51199f=_0x34e528[_0x1abfc6];return _0x51199f;},a0_0x1abf(_0x25c461,_0x3a8766);}router['get'](a0_0x208501(0xc1),auth,async(_0x2f866e,_0x3b7f5a)=>{const _0x50c05f=a0_0x208501;try{const {username:_0x414d40,email:_0x1818e7,role:_0x295b33}=_0x2f866e[_0x50c05f(0xd4)],_0x4415e7=_0x2f866e['user'],_0x26b6a6=await profile[_0x50c05f(0x95)]({'email':_0x4415e7['email']}),_0x522ce6=await master_shop[_0x50c05f(0xda)]();let _0xb918fc;if(_0x4415e7['role']==_0x50c05f(0xce)){const _0x53c236=await staff[_0x50c05f(0x95)]({'email':_0x4415e7[_0x50c05f(0xd1)]});_0xb918fc=await warehouse['aggregate']([{'$match':{'status':_0x50c05f(0xe0),'name':_0x53c236[_0x50c05f(0xb8)]}},{'$group':{'_id':'$name','name':{'$first':_0x50c05f(0xb6)}}},{'$sort':{'name':-0x1}}]);}else _0xb918fc=await warehouse[_0x50c05f(0xc6)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x50c05f(0xb6),'name':{'$first':_0x50c05f(0xb6)}}},{'$sort':{'name':-0x1}}]);const _0x18d04f=new Date()[_0x50c05f(0x9b)](_0x50c05f(0xa6),{'timeZone':_0x522ce6[0x0]['timezone']});if(_0x522ce6[0x0][_0x50c05f(0x8e)]=='English\x20(US)')var _0x282ed0=users['English'];else{if(_0x522ce6[0x0][_0x50c05f(0x8e)]==_0x50c05f(0x94))var _0x282ed0=users[_0x50c05f(0x94)];else{if(_0x522ce6[0x0][_0x50c05f(0x8e)]==_0x50c05f(0xc0))var _0x282ed0=users[_0x50c05f(0xc0)];else{if(_0x522ce6[0x0][_0x50c05f(0x8e)]==_0x50c05f(0x9d))var _0x282ed0=users[_0x50c05f(0x9d)];else{if(_0x522ce6[0x0][_0x50c05f(0x8e)]==_0x50c05f(0xc3))var _0x282ed0=users[_0x50c05f(0xc3)];else{if(_0x522ce6[0x0][_0x50c05f(0x8e)]==_0x50c05f(0xb5))var _0x282ed0=users[_0x50c05f(0xd8)];else{if(_0x522ce6[0x0][_0x50c05f(0x8e)]==_0x50c05f(0x90))var _0x282ed0=users['Chinese'];else{if(_0x522ce6[0x0][_0x50c05f(0x8e)]==_0x50c05f(0xaa))var _0x282ed0=users[_0x50c05f(0x9a)];}}}}}}}_0x3b7f5a[_0x50c05f(0xdd)]('warehousemap_incoming',{'success':_0x2f866e[_0x50c05f(0xca)](_0x50c05f(0x9f)),'errors':_0x2f866e[_0x50c05f(0xca)](_0x50c05f(0xbf)),'role':_0x4415e7,'profile':_0x26b6a6,'master_shop':_0x522ce6,'timezones':timezones,'language':_0x282ed0,'warehouse':_0xb918fc});}catch(_0x202aeb){console[_0x50c05f(0xd3)](_0x202aeb),_0x3b7f5a['status'](0xc8)['json']({'message':_0x202aeb['message']});}}),router['post'](a0_0x208501(0xc2),async(_0x1b99a8,_0x5c30b6)=>{const _0x498dc3=a0_0x208501,{warehouseNew:_0x1a01f5,rooms:_0x369a8d,Type:_0x4acaed}=_0x1b99a8[_0x498dc3(0xd5)],_0x258f93=await warehouse[_0x498dc3(0xc6)]([{'$unwind':_0x498dc3(0xa7)},{'$match':{'name':_0x1a01f5,'room':_0x369a8d,'product_details.type':_0x4acaed}},{'$group':{'_id':{'bay':'$product_details.bay','bin':_0x498dc3(0xb2),'type':_0x498dc3(0xc7),'floorlevel':_0x498dc3(0xaf)},'products':{'$push':{'product_name':_0x498dc3(0xbc),'product_quantity':_0x498dc3(0xcb),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':_0x498dc3(0xcb),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x498dc3(0x92),'bin':'$_id.bin','type':_0x498dc3(0xac),'floorlevel':_0x498dc3(0x9c),'products':{'$filter':{'input':_0x498dc3(0xbe),'as':'product','cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x5c30b6[_0x498dc3(0xc5)](_0x258f93);}),router[a0_0x208501(0xd6)]('/MapData2',async(_0x1bc255,_0x4734db)=>{const _0x4008c1=a0_0x208501,{warehouseNew:_0x4595bd,rooms:_0x57e2bc,room_cat:_0x1c92b9}=_0x1bc255[_0x4008c1(0xd5)];let _0x21b6ee;if(_0x1c92b9=='All')_0x21b6ee=await warehouse[_0x4008c1(0xc6)]([{'$unwind':_0x4008c1(0xa7)},{'$match':{'name':_0x4595bd}},{'$group':{'_id':{'bay':_0x4008c1(0xe4),'product':_0x4008c1(0xbc),'expiry':_0x4008c1(0xcf)},'count':{'$sum':_0x4008c1(0xcb)},'production_date':{'$first':_0x4008c1(0xab)},'expiry_date':{'$first':_0x4008c1(0xcf)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x4008c1(0xa5)}}},{'$group':{'_id':_0x4008c1(0x92),'products':{'$push':{'product':_0x4008c1(0x98),'quantity':_0x4008c1(0xa4),'production_date':_0x4008c1(0x93),'expiry_date':_0x4008c1(0xe3),'batch_code':'$batch_code','product_code':_0x4008c1(0x97)}},'totalQuantity':{'$sum':_0x4008c1(0xa4)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x4008c1(0xcc),'products':0x1,'totalQuantity':0x1}}]),console[_0x4008c1(0xd3)](_0x1c92b9);else{}_0x4734db[_0x4008c1(0xc5)](_0x21b6ee);}),router['post'](a0_0x208501(0xb4),async(_0xa000ff,_0x34906d)=>{const _0x802733=a0_0x208501;try{const {warehouse_name:_0x4617f4}=_0xa000ff[_0x802733(0xd5)];var _0x24dd0f='';_0x24dd0f=[{'$match':{'name':_0x4617f4,'status':_0x802733(0xe0)}},{'$group':{'_id':_0x802733(0xcc),'room_name':{'$first':_0x802733(0xa2)}}},{'$sort':{'room_name':0x1}}];const _0x5696a8=await warehouse[_0x802733(0xc6)](_0x24dd0f);_0x34906d[_0x802733(0xe2)](0xc8)[_0x802733(0xc5)](_0x5696a8);}catch(_0x1d2f93){_0x34906d[_0x802733(0xe2)](0x190)[_0x802733(0xc5)]({'errorMessage':_0x1d2f93['message']});}}),router[a0_0x208501(0xd6)](a0_0x208501(0xdb),async(_0x51ee56,_0x25a1d3)=>{const _0x3402be=a0_0x208501;try{const {warehouse_name:_0x41d2af,cat:_0x162041,valNew:_0x514b64}=_0x51ee56[_0x3402be(0xd5)];var _0x176eae='',_0x581db6='';if(_0x162041==_0x3402be(0xdf))_0x176eae=_0x3402be(0xe1),_0x514b64=='pack'?_0x581db6=[{'$match':{'status':'Enabled','warehouse_category':_0x162041,'name':{'$ne':_0x176eae},'name':_0x3402be(0xa1)}},{'$group':{'_id':_0x3402be(0xb6),'room_name':{'$first':_0x3402be(0xb6)}}},{'$sort':{'room_name':0x1}}]:_0x581db6=[{'$match':{'status':_0x3402be(0xe0),'warehouse_category':_0x162041,'name':{'$ne':_0x176eae}}},{'$group':{'_id':_0x3402be(0xb6),'room_name':{'$first':_0x3402be(0xb6)}}},{'$sort':{'room_name':0x1}}];else _0x162041==_0x3402be(0xd0)?(_0x176eae='QA\x20Warehouse',_0x581db6=[{'$match':{'status':_0x3402be(0xe0),'warehouse_category':_0x162041,'name':{'$ne':_0x176eae}}},{'$group':{'_id':_0x3402be(0xb6),'room_name':{'$first':_0x3402be(0xb6)}}},{'$sort':{'room_name':0x1}}]):_0x581db6=[{'$match':{'status':_0x3402be(0xe0)}},{'$group':{'_id':'$name','room_name':{'$first':_0x3402be(0xb6)}}},{'$sort':{'room_name':0x1}}];const _0x1141be=await warehouse[_0x3402be(0xc6)](_0x581db6);_0x25a1d3[_0x3402be(0xe2)](0xc8)['json'](_0x1141be);}catch(_0xca75d2){_0x25a1d3[_0x3402be(0xe2)](0x190)[_0x3402be(0xc5)]({'errorMessage':_0xca75d2[_0x3402be(0xc4)]}),console[_0x3402be(0xd3)](_0xca75d2);}}),router[a0_0x208501(0xd6)](a0_0x208501(0xb7),async(_0x6a6f57,_0x932492)=>{const _0x4d26d6=a0_0x208501;try{const {warehouse_name:_0x5a173a,cat:_0xc41900}=_0x6a6f57[_0x4d26d6(0xd5)],_0xe3cda4=await warehouse['aggregate']([{'$match':{'status':_0x4d26d6(0xe0),'warehouse_category':_0xc41900,'name':_0x5a173a}},{'$group':{'_id':_0x4d26d6(0xa2),'room_name':{'$first':_0x4d26d6(0xa2)}}},{'$sort':{'room_name':0x1}}]);_0x932492[_0x4d26d6(0xe2)](0xc8)[_0x4d26d6(0xc5)](_0xe3cda4);}catch(_0x3ecb95){_0x932492[_0x4d26d6(0xe2)](0x190)[_0x4d26d6(0xc5)]({'errorMessage':_0x3ecb95['message']});}}),router[a0_0x208501(0xd6)](a0_0x208501(0xde),async(_0x4e279b,_0x30eb1b)=>{const _0x498d50=a0_0x208501;try{const {typeofsales:_0x1c5c85}=_0x4e279b['body'],_0x3a6219=await staff[_0x498d50(0xda)]({'account_category':'sa','type_of_acc_cat':_0x1c5c85});_0x30eb1b['status'](0xc8)[_0x498d50(0xc5)](_0x3a6219);}catch(_0x5902e6){_0x30eb1b[_0x498d50(0xe2)](0x190)[_0x498d50(0xc5)]({'errorMessage':_0x5902e6['message']});}}),router[a0_0x208501(0xd6)](a0_0x208501(0xcd),async(_0x3515a7,_0x107d5d)=>{const _0x61ec07=a0_0x208501;try{const {id:_0x26ce2a}=_0x3515a7['body'],_0x250202=await staff[_0x61ec07(0xda)]({'_id':_0x26ce2a});_0x107d5d[_0x61ec07(0xe2)](0xc8)[_0x61ec07(0xc5)](_0x250202);}catch(_0x3db430){_0x107d5d[_0x61ec07(0xe2)](0x190)[_0x61ec07(0xc5)]({'errorMessage':_0x3db430[_0x61ec07(0xc4)]});}}),router[a0_0x208501(0xd6)](a0_0x208501(0xc9),async(_0x124e0c,_0x2632bb)=>{const _0x11ae89=a0_0x208501;try{const {warehouse_name:_0x32ba2f,room_value:_0x50c365}=_0x124e0c[_0x11ae89(0xd5)];let _0x15f15c;_0x50c365==_0x11ae89(0x9e)?_0x15f15c=await warehouse[_0x11ae89(0xc6)]([{'$unwind':_0x11ae89(0xa7)},{'$match':{'name':_0x32ba2f}},{'$group':{'_id':{'bay':'$product_details.bay','level':_0x11ae89(0xae),'type':'$product_details.type','floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x11ae89(0xbc),'product_quantity':'$product_details.product_stock','product_code':_0x11ae89(0xa5)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x11ae89(0x92),'level':'$_id.level','type':_0x11ae89(0xac),'floorlevel':_0x11ae89(0x9c),'products':{'$filter':{'input':_0x11ae89(0xbe),'as':_0x11ae89(0xa8),'cond':{'$gt':[_0x11ae89(0x96),0x0]}}},'totalQuantity':0x1}}]):_0x15f15c=await warehouse[_0x11ae89(0xc6)]([{'$unwind':_0x11ae89(0xa7)},{'$match':{'name':_0x32ba2f,'room':_0x50c365}},{'$group':{'_id':{'bay':_0x11ae89(0xe4),'level':_0x11ae89(0xae),'type':_0x11ae89(0xc7),'floorlevel':_0x11ae89(0xaf)},'products':{'$push':{'product_name':_0x11ae89(0xbc),'product_quantity':_0x11ae89(0xcb),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x11ae89(0xcb),0x0]},'then':_0x11ae89(0xcb),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x11ae89(0x92),'level':'$_id.level','type':_0x11ae89(0xac),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x11ae89(0xbe),'as':_0x11ae89(0xa8),'cond':{'$gt':[_0x11ae89(0x96),0x0]}}},'totalQuantity':0x1}}]),_0x2632bb[_0x11ae89(0xe2)](0xc8)['json'](_0x15f15c);}catch(_0x18a4d8){_0x2632bb[_0x11ae89(0xe2)](0x190)[_0x11ae89(0xc5)]({'errorMessage':_0x18a4d8[_0x11ae89(0xc4)]});}}),module[a0_0x208501(0x8f)]=router;