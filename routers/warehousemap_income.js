const a0_0x274cd7=a0_0xf349;function a0_0x32e1(){const _0x261b0f=['log','post','/Rooms_data','product','$_id.bay','$product_details.product_name','find','$product_details.bin','flash','47691uqBkBu','$products','$_id.bin','$product_details.product_code','$count','441685oJhmxP','English','aggregate','DRY\x20STORAGE','Portuguese\x20(BR)','4Qofegb','80NnpEWD','success','message','298733CihLCy','$product_details.expiry_date','$product_details.bay','$expiry_date','render','Spanish','email','all','QA\x20Warehouse','2905581AEMoFb','/MapData2','/staff_sales_id','json','Raw\x20Materials','get','$product_code','exports','1081674wpHppV','warehousemap_incoming','Chinese','/map_value','user','../public/language/languages.json','../middleware/auth','/Rooms_data3','$$product.product_quantity','$_id.level','German','$room','/staff_sales','Return\x20Goods','pack','Arabic','timezone','French','language','English\x20(US)','$product_details.level','timezones-list','$product_details.product_stock','$product_details','$_id','$name','status','$_id.product','multer','en-US','6DAdSIK','$_id.type','body','Hindi','errors','Enabled','$batch_code','warehouse','3445800FkfNpn','/MapData','express','$product_details.floorlevel','All','findOne','924984kOSOde','$_id.floorlevel','$product_details.type'];a0_0x32e1=function(){return _0x261b0f;};return a0_0x32e1();}(function(_0x3c96b5,_0xb3ca5c){const _0x1ca50b=a0_0xf349,_0x5bd86f=_0x3c96b5();while(!![]){try{const _0x388fa1=parseInt(_0x1ca50b(0x196))/0x1+parseInt(_0x1ca50b(0x1d3))/0x2+-parseInt(_0x1ca50b(0x1a7))/0x3+parseInt(_0x1ca50b(0x192))/0x4*(-parseInt(_0x1ca50b(0x18d))/0x5)+-parseInt(_0x1ca50b(0x1c5))/0x6*(parseInt(_0x1ca50b(0x19f))/0x7)+parseInt(_0x1ca50b(0x1cd))/0x8+-parseInt(_0x1ca50b(0x188))/0x9*(-parseInt(_0x1ca50b(0x193))/0xa);if(_0x388fa1===_0xb3ca5c)break;else _0x5bd86f['push'](_0x5bd86f['shift']());}catch(_0x1f4efa){_0x5bd86f['push'](_0x5bd86f['shift']());}}}(a0_0x32e1,0x5a6bc));function a0_0xf349(_0x5bd766,_0x13a2d1){const _0x32e14c=a0_0x32e1();return a0_0xf349=function(_0xf349cf,_0x4a2749){_0xf349cf=_0xf349cf-0x187;let _0x2664a8=_0x32e14c[_0xf349cf];return _0x2664a8;},a0_0xf349(_0x5bd766,_0x13a2d1);}const express=require(a0_0x274cd7(0x1cf)),app=express(),router=express['Router'](),multer=require(a0_0x274cd7(0x1c3)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require(a0_0x274cd7(0x1ad));var timezones=require(a0_0x274cd7(0x1bc));const users=require(a0_0x274cd7(0x1ac));router[a0_0x274cd7(0x1a4)]('/view',auth,async(_0x1ee932,_0x423f86)=>{const _0x4a1088=a0_0x274cd7;try{const {username:_0x25753e,email:_0x6782f1,role:_0x5e966d}=_0x1ee932[_0x4a1088(0x1ab)],_0x458785=_0x1ee932['user'],_0x2d5bfb=await profile[_0x4a1088(0x1d2)]({'email':_0x458785[_0x4a1088(0x19c)]}),_0x2f62d1=await master_shop[_0x4a1088(0x1dc)]();let _0x3aaf9d;if(_0x458785['role']=='staff'){const _0x384030=await staff[_0x4a1088(0x1d2)]({'email':_0x458785[_0x4a1088(0x19c)]});_0x3aaf9d=await warehouse['aggregate']([{'$match':{'status':_0x4a1088(0x1ca),'name':_0x384030[_0x4a1088(0x1cc)]}},{'$group':{'_id':_0x4a1088(0x1c0),'name':{'$first':_0x4a1088(0x1c0)}}},{'$sort':{'name':-0x1}}]);}else _0x3aaf9d=await warehouse[_0x4a1088(0x18f)]([{'$match':{'status':_0x4a1088(0x1ca)}},{'$group':{'_id':'$name','name':{'$first':_0x4a1088(0x1c0)}}},{'$sort':{'name':-0x1}}]);const _0x4c3018=new Date()['toLocaleString'](_0x4a1088(0x1c4),{'timeZone':_0x2f62d1[0x0][_0x4a1088(0x1b7)]});if(_0x2f62d1[0x0]['language']==_0x4a1088(0x1ba))var _0xf0fcef=users[_0x4a1088(0x18e)];else{if(_0x2f62d1[0x0][_0x4a1088(0x1b9)]==_0x4a1088(0x1c8))var _0xf0fcef=users[_0x4a1088(0x1c8)];else{if(_0x2f62d1[0x0][_0x4a1088(0x1b9)]==_0x4a1088(0x1b1))var _0xf0fcef=users[_0x4a1088(0x1b1)];else{if(_0x2f62d1[0x0]['language']==_0x4a1088(0x19b))var _0xf0fcef=users[_0x4a1088(0x19b)];else{if(_0x2f62d1[0x0][_0x4a1088(0x1b9)]==_0x4a1088(0x1b8))var _0xf0fcef=users[_0x4a1088(0x1b8)];else{if(_0x2f62d1[0x0][_0x4a1088(0x1b9)]==_0x4a1088(0x191))var _0xf0fcef=users['Portuguese'];else{if(_0x2f62d1[0x0][_0x4a1088(0x1b9)]==_0x4a1088(0x1a9))var _0xf0fcef=users[_0x4a1088(0x1a9)];else{if(_0x2f62d1[0x0][_0x4a1088(0x1b9)]=='Arabic\x20(ae)')var _0xf0fcef=users[_0x4a1088(0x1b6)];}}}}}}}_0x423f86[_0x4a1088(0x19a)](_0x4a1088(0x1a8),{'success':_0x1ee932[_0x4a1088(0x187)](_0x4a1088(0x194)),'errors':_0x1ee932['flash'](_0x4a1088(0x1c9)),'role':_0x458785,'profile':_0x2d5bfb,'master_shop':_0x2f62d1,'timezones':timezones,'language':_0xf0fcef,'warehouse':_0x3aaf9d});}catch(_0x2c1e7d){console[_0x4a1088(0x1d6)](_0x2c1e7d),_0x423f86[_0x4a1088(0x1c1)](0xc8)[_0x4a1088(0x1a2)]({'message':_0x2c1e7d['message']});}}),router[a0_0x274cd7(0x1d7)](a0_0x274cd7(0x1ce),async(_0x5b0a37,_0x5d6c76)=>{const _0x2f33f0=a0_0x274cd7,{warehouseNew:_0x100958,rooms:_0x5c8153,Type:_0x41a3d7}=_0x5b0a37[_0x2f33f0(0x1c7)],_0x4cbcc1=await warehouse[_0x2f33f0(0x18f)]([{'$unwind':_0x2f33f0(0x1be)},{'$match':{'name':_0x100958,'room':_0x5c8153,'product_details.type':_0x41a3d7}},{'$group':{'_id':{'bay':'$product_details.bay','bin':_0x2f33f0(0x1dd),'type':_0x2f33f0(0x1d5),'floorlevel':_0x2f33f0(0x1d0)},'products':{'$push':{'product_name':_0x2f33f0(0x1db),'product_quantity':_0x2f33f0(0x1bd),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x2f33f0(0x1bd),0x0]},'then':_0x2f33f0(0x1bd),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x2f33f0(0x1da),'bin':_0x2f33f0(0x18a),'type':_0x2f33f0(0x1c6),'floorlevel':_0x2f33f0(0x1d4),'products':{'$filter':{'input':_0x2f33f0(0x189),'as':_0x2f33f0(0x1d9),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x5d6c76[_0x2f33f0(0x1a2)](_0x4cbcc1);}),router[a0_0x274cd7(0x1d7)](a0_0x274cd7(0x1a0),async(_0x23f208,_0x592ff1)=>{const _0x2b8e8b=a0_0x274cd7,{warehouseNew:_0x53e377,rooms:_0x54515d,room_cat:_0x28282e}=_0x23f208[_0x2b8e8b(0x1c7)];let _0x19371;if(_0x28282e==_0x2b8e8b(0x1d1))_0x19371=await warehouse[_0x2b8e8b(0x18f)]([{'$unwind':'$product_details'},{'$match':{'name':_0x53e377}},{'$group':{'_id':{'bay':_0x2b8e8b(0x198),'product':'$product_details.product_name','expiry':_0x2b8e8b(0x197)},'count':{'$sum':'$product_details.product_stock'},'production_date':{'$first':'$product_details.production_date'},'expiry_date':{'$first':_0x2b8e8b(0x197)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x2b8e8b(0x18b)}}},{'$group':{'_id':_0x2b8e8b(0x1da),'products':{'$push':{'product':_0x2b8e8b(0x1c2),'quantity':_0x2b8e8b(0x18c),'production_date':'$production_date','expiry_date':_0x2b8e8b(0x199),'batch_code':_0x2b8e8b(0x1cb),'product_code':_0x2b8e8b(0x1a5)}},'totalQuantity':{'$sum':'$count'}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x2b8e8b(0x1bf),'products':0x1,'totalQuantity':0x1}}]),console[_0x2b8e8b(0x1d6)](_0x28282e);else{}_0x592ff1[_0x2b8e8b(0x1a2)](_0x19371);}),router[a0_0x274cd7(0x1d7)](a0_0x274cd7(0x1d8),async(_0x4e9b29,_0x4209fa)=>{const _0x1c3fa8=a0_0x274cd7;try{const {warehouse_name:_0x5ee3d3}=_0x4e9b29['body'];var _0x5d55c3='';_0x5d55c3=[{'$match':{'name':_0x5ee3d3,'status':_0x1c3fa8(0x1ca)}},{'$group':{'_id':_0x1c3fa8(0x1bf),'room_name':{'$first':_0x1c3fa8(0x1b2)}}},{'$sort':{'room_name':0x1}}];const _0x1c5942=await warehouse[_0x1c3fa8(0x18f)](_0x5d55c3);_0x4209fa[_0x1c3fa8(0x1c1)](0xc8)[_0x1c3fa8(0x1a2)](_0x1c5942);}catch(_0xbd6606){_0x4209fa[_0x1c3fa8(0x1c1)](0x190)[_0x1c3fa8(0x1a2)]({'errorMessage':_0xbd6606[_0x1c3fa8(0x195)]});}}),router[a0_0x274cd7(0x1d7)]('/Rooms_data2',async(_0x24d7b0,_0x4b2a0e)=>{const _0xf97ead=a0_0x274cd7;try{const {warehouse_name:_0x300bea,cat:_0x49bb56,valNew:_0x3b0990}=_0x24d7b0[_0xf97ead(0x1c7)];var _0x27b081='',_0x51b3ba='';if(_0x49bb56==_0xf97ead(0x1a3))_0x27b081=_0xf97ead(0x1b4),_0x3b0990==_0xf97ead(0x1b5)?_0x51b3ba=[{'$match':{'status':_0xf97ead(0x1ca),'warehouse_category':_0x49bb56,'name':{'$ne':_0x27b081},'name':_0xf97ead(0x190)}},{'$group':{'_id':'$name','room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]:_0x51b3ba=[{'$match':{'status':'Enabled','warehouse_category':_0x49bb56,'name':{'$ne':_0x27b081}}},{'$group':{'_id':_0xf97ead(0x1c0),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];else _0x49bb56=='Finished\x20Goods'?(_0x27b081=_0xf97ead(0x19e),_0x51b3ba=[{'$match':{'status':'Enabled','warehouse_category':_0x49bb56,'name':{'$ne':_0x27b081}}},{'$group':{'_id':_0xf97ead(0x1c0),'room_name':{'$first':_0xf97ead(0x1c0)}}},{'$sort':{'room_name':0x1}}]):_0x51b3ba=[{'$match':{'status':_0xf97ead(0x1ca)}},{'$group':{'_id':_0xf97ead(0x1c0),'room_name':{'$first':_0xf97ead(0x1c0)}}},{'$sort':{'room_name':0x1}}];const _0x3f3df0=await warehouse[_0xf97ead(0x18f)](_0x51b3ba);_0x4b2a0e[_0xf97ead(0x1c1)](0xc8)['json'](_0x3f3df0);}catch(_0x2bf149){_0x4b2a0e[_0xf97ead(0x1c1)](0x190)[_0xf97ead(0x1a2)]({'errorMessage':_0x2bf149['message']}),console[_0xf97ead(0x1d6)](_0x2bf149);}}),router['post'](a0_0x274cd7(0x1ae),async(_0x105478,_0x149746)=>{const _0xf6d8b2=a0_0x274cd7;try{const {warehouse_name:_0x4454ba,cat:_0x5ce63e}=_0x105478[_0xf6d8b2(0x1c7)],_0x44a03f=await warehouse[_0xf6d8b2(0x18f)]([{'$match':{'status':'Enabled','warehouse_category':_0x5ce63e,'name':_0x4454ba}},{'$group':{'_id':'$room','room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]);_0x149746[_0xf6d8b2(0x1c1)](0xc8)[_0xf6d8b2(0x1a2)](_0x44a03f);}catch(_0x129e41){_0x149746[_0xf6d8b2(0x1c1)](0x190)[_0xf6d8b2(0x1a2)]({'errorMessage':_0x129e41[_0xf6d8b2(0x195)]});}}),router['post'](a0_0x274cd7(0x1b3),async(_0x52c75d,_0x35b9ff)=>{const _0x40d636=a0_0x274cd7;try{const {typeofsales:_0x4a38a1}=_0x52c75d[_0x40d636(0x1c7)],_0x3b6c45=await staff[_0x40d636(0x1dc)]({'account_category':'sa','type_of_acc_cat':_0x4a38a1});_0x35b9ff['status'](0xc8)[_0x40d636(0x1a2)](_0x3b6c45);}catch(_0x58ed32){_0x35b9ff[_0x40d636(0x1c1)](0x190)[_0x40d636(0x1a2)]({'errorMessage':_0x58ed32[_0x40d636(0x195)]});}}),router['post'](a0_0x274cd7(0x1a1),async(_0x220714,_0x56f86d)=>{const _0x4c7630=a0_0x274cd7;try{const {id:_0x266865}=_0x220714['body'],_0x2c9982=await staff[_0x4c7630(0x1dc)]({'_id':_0x266865});_0x56f86d['status'](0xc8)[_0x4c7630(0x1a2)](_0x2c9982);}catch(_0x519cea){_0x56f86d['status'](0x190)[_0x4c7630(0x1a2)]({'errorMessage':_0x519cea[_0x4c7630(0x195)]});}}),router[a0_0x274cd7(0x1d7)](a0_0x274cd7(0x1aa),async(_0x6a8923,_0x2cf191)=>{const _0x1ae3c8=a0_0x274cd7;try{const {warehouse_name:_0xa141e6,room_value:_0x3a0b11}=_0x6a8923[_0x1ae3c8(0x1c7)];let _0x564a8f;_0x3a0b11==_0x1ae3c8(0x19d)?_0x564a8f=await warehouse[_0x1ae3c8(0x18f)]([{'$unwind':_0x1ae3c8(0x1be)},{'$match':{'name':_0xa141e6}},{'$group':{'_id':{'bay':_0x1ae3c8(0x198),'level':_0x1ae3c8(0x1bb),'type':_0x1ae3c8(0x1d5),'floorlevel':_0x1ae3c8(0x1d0)},'products':{'$push':{'product_name':_0x1ae3c8(0x1db),'product_quantity':_0x1ae3c8(0x1bd),'product_code':_0x1ae3c8(0x18b)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x1ae3c8(0x1bd),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x1ae3c8(0x1da),'level':_0x1ae3c8(0x1b0),'type':_0x1ae3c8(0x1c6),'floorlevel':_0x1ae3c8(0x1d4),'products':{'$filter':{'input':_0x1ae3c8(0x189),'as':_0x1ae3c8(0x1d9),'cond':{'$gt':[_0x1ae3c8(0x1af),0x0]}}},'totalQuantity':0x1}}]):_0x564a8f=await warehouse[_0x1ae3c8(0x18f)]([{'$unwind':_0x1ae3c8(0x1be)},{'$match':{'name':_0xa141e6,'room':_0x3a0b11}},{'$group':{'_id':{'bay':_0x1ae3c8(0x198),'level':_0x1ae3c8(0x1bb),'type':_0x1ae3c8(0x1d5),'floorlevel':_0x1ae3c8(0x1d0)},'products':{'$push':{'product_name':_0x1ae3c8(0x1db),'product_quantity':'$product_details.product_stock','product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x1ae3c8(0x1bd),0x0]},'then':_0x1ae3c8(0x1bd),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x1ae3c8(0x1da),'level':_0x1ae3c8(0x1b0),'type':_0x1ae3c8(0x1c6),'floorlevel':_0x1ae3c8(0x1d4),'products':{'$filter':{'input':'$products','as':_0x1ae3c8(0x1d9),'cond':{'$gt':[_0x1ae3c8(0x1af),0x0]}}},'totalQuantity':0x1}}]),_0x2cf191[_0x1ae3c8(0x1c1)](0xc8)[_0x1ae3c8(0x1a2)](_0x564a8f);}catch(_0x2926b1){_0x2cf191[_0x1ae3c8(0x1c1)](0x190)[_0x1ae3c8(0x1a2)]({'errorMessage':_0x2926b1[_0x1ae3c8(0x195)]});}}),module[a0_0x274cd7(0x1a6)]=router;