const a0_0x337a4c=a0_0x4fe3;(function(_0x107194,_0xdfc069){const _0x53afbb=a0_0x4fe3,_0x12beb2=_0x107194();while(!![]){try{const _0x120531=parseInt(_0x53afbb(0xef))/0x1+-parseInt(_0x53afbb(0xde))/0x2*(parseInt(_0x53afbb(0x111))/0x3)+-parseInt(_0x53afbb(0xe2))/0x4+parseInt(_0x53afbb(0xe1))/0x5+parseInt(_0x53afbb(0x106))/0x6*(-parseInt(_0x53afbb(0xd4))/0x7)+-parseInt(_0x53afbb(0xcf))/0x8+-parseInt(_0x53afbb(0xcb))/0x9*(-parseInt(_0x53afbb(0x118))/0xa);if(_0x120531===_0xdfc069)break;else _0x12beb2['push'](_0x12beb2['shift']());}catch(_0x4012cc){_0x12beb2['push'](_0x12beb2['shift']());}}}(a0_0x43ac,0x9e2b0));const express=require(a0_0x337a4c(0x11b)),app=express(),router=express[a0_0x337a4c(0xda)](),multer=require(a0_0x337a4c(0xf0)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require('../middleware/auth');var timezones=require(a0_0x337a4c(0x108));const users=require(a0_0x337a4c(0xe5));function a0_0x4fe3(_0x33a0e2,_0xdf3d07){const _0x43ac09=a0_0x43ac();return a0_0x4fe3=function(_0x4fe358,_0x4b00cc){_0x4fe358=_0x4fe358-0xc4;let _0x483dda=_0x43ac09[_0x4fe358];return _0x483dda;},a0_0x4fe3(_0x33a0e2,_0xdf3d07);}router[a0_0x337a4c(0xfa)](a0_0x337a4c(0x10a),auth,async(_0x469fb1,_0x13d7e5)=>{const _0x121c73=a0_0x337a4c;try{const {username:_0x14b347,email:_0x20f2ce,role:_0x477c81}=_0x469fb1[_0x121c73(0x113)],_0x32d228=_0x469fb1[_0x121c73(0x113)],_0xaebcf2=await profile[_0x121c73(0x101)]({'email':_0x32d228[_0x121c73(0xd1)]}),_0x7a692d=await master_shop['find']();let _0x56b545;if(_0x32d228[_0x121c73(0xdc)]==_0x121c73(0xd2)){const _0x53771f=await staff[_0x121c73(0x101)]({'email':_0x32d228[_0x121c73(0xd1)]});_0x56b545=await warehouse[_0x121c73(0xf1)]([{'$match':{'status':_0x121c73(0x103),'name':_0x53771f[_0x121c73(0xc9)]}},{'$group':{'_id':_0x121c73(0xee),'name':{'$first':_0x121c73(0xee)}}},{'$sort':{'name':-0x1}}]);}else _0x56b545=await warehouse['aggregate']([{'$match':{'status':_0x121c73(0x103)}},{'$group':{'_id':_0x121c73(0xee),'name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);const _0x352c05=new Date()[_0x121c73(0xc5)]('en-US',{'timeZone':_0x7a692d[0x0][_0x121c73(0xe8)]});if(_0x7a692d[0x0]['language']==_0x121c73(0xd5))var _0x4bab52=users['English'];else{if(_0x7a692d[0x0][_0x121c73(0x107)]==_0x121c73(0xed))var _0x4bab52=users['Hindi'];else{if(_0x7a692d[0x0][_0x121c73(0x107)]==_0x121c73(0xe0))var _0x4bab52=users['German'];else{if(_0x7a692d[0x0][_0x121c73(0x107)]=='Spanish')var _0x4bab52=users[_0x121c73(0xf9)];else{if(_0x7a692d[0x0][_0x121c73(0x107)]==_0x121c73(0xf3))var _0x4bab52=users[_0x121c73(0xf3)];else{if(_0x7a692d[0x0][_0x121c73(0x107)]==_0x121c73(0xd7))var _0x4bab52=users[_0x121c73(0xc7)];else{if(_0x7a692d[0x0][_0x121c73(0x107)]==_0x121c73(0x115))var _0x4bab52=users[_0x121c73(0x115)];else{if(_0x7a692d[0x0][_0x121c73(0x107)]==_0x121c73(0x112))var _0x4bab52=users[_0x121c73(0x116)];}}}}}}}_0x13d7e5[_0x121c73(0xff)](_0x121c73(0xd9),{'success':_0x469fb1[_0x121c73(0xcd)](_0x121c73(0x10f)),'errors':_0x469fb1[_0x121c73(0xcd)](_0x121c73(0xfe)),'role':_0x32d228,'profile':_0xaebcf2,'master_shop':_0x7a692d,'timezones':timezones,'language':_0x4bab52,'warehouse':_0x56b545});}catch(_0x3fb9ff){console[_0x121c73(0xdb)](_0x3fb9ff),_0x13d7e5[_0x121c73(0x117)](0xc8)[_0x121c73(0xe6)]({'message':_0x3fb9ff[_0x121c73(0xfd)]});}}),router[a0_0x337a4c(0xd6)]('/MapData',async(_0x46c22b,_0x2b193e)=>{const _0x15ecc7=a0_0x337a4c,{warehouseNew:_0x27a573,rooms:_0x516fec,Type:_0x470013}=_0x46c22b[_0x15ecc7(0xd3)],_0x5eee2b=await warehouse[_0x15ecc7(0xf1)]([{'$unwind':_0x15ecc7(0x114)},{'$match':{'name':_0x27a573,'room':_0x516fec,'product_details.type':_0x470013}},{'$group':{'_id':{'bay':_0x15ecc7(0xea),'bin':_0x15ecc7(0x10b),'type':_0x15ecc7(0xdf),'floorlevel':_0x15ecc7(0xf8)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x15ecc7(0xe9),'product_code':_0x15ecc7(0xf4)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x15ecc7(0xe9),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x15ecc7(0xf5),'bin':_0x15ecc7(0xf2),'type':'$_id.type','floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x15ecc7(0x110),'as':'product','cond':{'$gt':[_0x15ecc7(0x105),0x0]}}},'totalQuantity':0x1}}]);_0x2b193e['json'](_0x5eee2b);}),router[a0_0x337a4c(0xd6)]('/MapData2',async(_0x4a31b4,_0x4edd22)=>{const _0x1a2df8=a0_0x337a4c,{warehouseNew:_0x2c5f7b,rooms:_0x38e637,room_cat:_0xbce0d0}=_0x4a31b4['body'];let _0xccf4ed;if(_0xbce0d0==_0x1a2df8(0xe3))_0xccf4ed=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'name':_0x2c5f7b}},{'$group':{'_id':{'bay':_0x1a2df8(0xea),'product':_0x1a2df8(0x10d),'expiry':'$product_details.expiry_date'},'count':{'$sum':_0x1a2df8(0xe9)},'production_date':{'$first':_0x1a2df8(0xcc)},'expiry_date':{'$first':_0x1a2df8(0x102)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x1a2df8(0xf4)}}},{'$group':{'_id':_0x1a2df8(0xf5),'products':{'$push':{'product':_0x1a2df8(0xc4),'quantity':_0x1a2df8(0xf6),'production_date':'$production_date','expiry_date':_0x1a2df8(0xe7),'batch_code':_0x1a2df8(0xeb),'product_code':_0x1a2df8(0xe4)}},'totalQuantity':{'$sum':_0x1a2df8(0xf6)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0x1a2df8(0xdb)](_0xbce0d0);else{}_0x4edd22[_0x1a2df8(0xe6)](_0xccf4ed);}),router['post'](a0_0x337a4c(0xc8),async(_0x76207e,_0x33bd42)=>{const _0x3afc9c=a0_0x337a4c;try{const {warehouse_name:_0x1d4480}=_0x76207e[_0x3afc9c(0xd3)];var _0x271eb8='';_0x271eb8=[{'$match':{'name':_0x1d4480,'status':_0x3afc9c(0x103)}},{'$group':{'_id':_0x3afc9c(0xdd),'room_name':{'$first':_0x3afc9c(0x100)}}},{'$sort':{'room_name':0x1}}];const _0x19b37f=await warehouse[_0x3afc9c(0xf1)](_0x271eb8);_0x33bd42[_0x3afc9c(0x117)](0xc8)[_0x3afc9c(0xe6)](_0x19b37f);}catch(_0x24c68f){_0x33bd42['status'](0x190)[_0x3afc9c(0xe6)]({'errorMessage':_0x24c68f[_0x3afc9c(0xfd)]});}}),router[a0_0x337a4c(0xd6)](a0_0x337a4c(0xf7),async(_0x37dadd,_0x565e5e)=>{const _0xafc4b7=a0_0x337a4c;try{const {warehouse_name:_0x440aa0,cat:_0x5090d7,valNew:_0x387e3c}=_0x37dadd[_0xafc4b7(0xd3)];var _0x3869c3='',_0x27f8c8='';if(_0x5090d7==_0xafc4b7(0x11a))_0x3869c3=_0xafc4b7(0xfc),_0x387e3c=='pack'?_0x27f8c8=[{'$match':{'status':_0xafc4b7(0x103),'warehouse_category':_0x5090d7,'name':{'$ne':_0x3869c3},'name':'DRY\x20STORAGE'}},{'$group':{'_id':'$name','room_name':{'$first':_0xafc4b7(0xee)}}},{'$sort':{'room_name':0x1}}]:_0x27f8c8=[{'$match':{'status':_0xafc4b7(0x103),'warehouse_category':_0x5090d7,'name':{'$ne':_0x3869c3}}},{'$group':{'_id':_0xafc4b7(0xee),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];else _0x5090d7==_0xafc4b7(0x109)?(_0x3869c3=_0xafc4b7(0xce),_0x27f8c8=[{'$match':{'status':_0xafc4b7(0x103),'warehouse_category':_0x5090d7,'name':{'$ne':_0x3869c3}}},{'$group':{'_id':_0xafc4b7(0xee),'room_name':{'$first':_0xafc4b7(0xee)}}},{'$sort':{'room_name':0x1}}]):_0x27f8c8=[{'$match':{'status':_0xafc4b7(0x103)}},{'$group':{'_id':_0xafc4b7(0xee),'room_name':{'$first':_0xafc4b7(0xee)}}},{'$sort':{'room_name':0x1}}];const _0x5ae2c0=await warehouse[_0xafc4b7(0xf1)](_0x27f8c8);_0x565e5e['status'](0xc8)['json'](_0x5ae2c0);}catch(_0x370d17){_0x565e5e['status'](0x190)[_0xafc4b7(0xe6)]({'errorMessage':_0x370d17[_0xafc4b7(0xfd)]}),console[_0xafc4b7(0xdb)](_0x370d17);}}),router[a0_0x337a4c(0xd6)]('/Rooms_data3',async(_0x21ce1a,_0x3749ea)=>{const _0x401e8b=a0_0x337a4c;try{const {warehouse_name:_0x5b7d1f,cat:_0x4f69bf}=_0x21ce1a['body'],_0x88efbc=await warehouse[_0x401e8b(0xf1)]([{'$match':{'status':_0x401e8b(0x103),'warehouse_category':_0x4f69bf,'name':_0x5b7d1f}},{'$group':{'_id':_0x401e8b(0x100),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]);_0x3749ea[_0x401e8b(0x117)](0xc8)[_0x401e8b(0xe6)](_0x88efbc);}catch(_0x3e4285){_0x3749ea['status'](0x190)[_0x401e8b(0xe6)]({'errorMessage':_0x3e4285[_0x401e8b(0xfd)]});}}),router[a0_0x337a4c(0xd6)](a0_0x337a4c(0xd8),async(_0x1c14e6,_0x1b6001)=>{const _0x3317ff=a0_0x337a4c;try{const {typeofsales:_0x12dfe5}=_0x1c14e6['body'];var _0x1564ed;_0x12dfe5=='1'&&(_0x1564ed=await staff[_0x3317ff(0xca)]({'account_category':'sa','type_of_acc_cat':_0x12dfe5})),_0x1b6001[_0x3317ff(0x117)](0xc8)[_0x3317ff(0xe6)](_0x1564ed);}catch(_0x10a446){_0x1b6001['status'](0x190)['json']({'errorMessage':_0x10a446['message']});}}),router['post'](a0_0x337a4c(0xc6),async(_0x941a45,_0x1d8aa2)=>{const _0x571a3a=a0_0x337a4c;try{const {id:_0x22ed79}=_0x941a45['body'],_0x25038f=await staff[_0x571a3a(0xca)]({'_id':_0x22ed79});_0x1d8aa2[_0x571a3a(0x117)](0xc8)['json'](_0x25038f);}catch(_0x486b34){_0x1d8aa2[_0x571a3a(0x117)](0x190)[_0x571a3a(0xe6)]({'errorMessage':_0x486b34[_0x571a3a(0xfd)]});}}),router[a0_0x337a4c(0xd6)](a0_0x337a4c(0x104),async(_0x213885,_0x11969e)=>{const _0x1b1511=a0_0x337a4c;try{const {warehouse_name:_0x5c55a6,room_value:_0x54b79d}=_0x213885['body'];let _0x4333a2;_0x54b79d==_0x1b1511(0xfb)?_0x4333a2=await warehouse[_0x1b1511(0xf1)]([{'$unwind':_0x1b1511(0x114)},{'$match':{'name':_0x5c55a6}},{'$group':{'_id':{'bay':'$product_details.bay','level':'$product_details.level','type':_0x1b1511(0xdf),'floorlevel':_0x1b1511(0xf8)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x1b1511(0xe9),'product_code':_0x1b1511(0xf4)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x1b1511(0xe9),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','level':_0x1b1511(0x10c),'type':_0x1b1511(0xec),'floorlevel':_0x1b1511(0x10e),'products':{'$filter':{'input':_0x1b1511(0x110),'as':_0x1b1511(0x119),'cond':{'$gt':[_0x1b1511(0x105),0x0]}}},'totalQuantity':0x1}}]):_0x4333a2=await warehouse[_0x1b1511(0xf1)]([{'$unwind':_0x1b1511(0x114)},{'$match':{'name':_0x5c55a6,'room':_0x54b79d}},{'$group':{'_id':{'bay':_0x1b1511(0xea),'level':'$product_details.level','type':_0x1b1511(0xdf),'floorlevel':_0x1b1511(0xf8)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x1b1511(0xe9),'product_code':_0x1b1511(0xf4)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x1b1511(0xf5),'level':'$_id.level','type':'$_id.type','floorlevel':_0x1b1511(0x10e),'products':{'$filter':{'input':_0x1b1511(0x110),'as':'product','cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]),_0x11969e['status'](0xc8)[_0x1b1511(0xe6)](_0x4333a2);}catch(_0x49833b){_0x11969e[_0x1b1511(0x117)](0x190)[_0x1b1511(0xe6)]({'errorMessage':_0x49833b[_0x1b1511(0xfd)]});}}),module[a0_0x337a4c(0xd0)]=router;function a0_0x43ac(){const _0x2bf956=['warehouse','find','9fScLzS','$product_details.production_date','flash','QA\x20Warehouse','8907552WTZnNR','exports','email','staff','body','7zmFQKg','English\x20(US)','post','Portuguese\x20(BR)','/staff_sales','warehousemap_incoming','Router','log','role','$_id','2DGgUru','$product_details.type','German','6298925mwrdhB','4735028iprzfr','All','$product_code','../public/language/languages.json','json','$expiry_date','timezone','$product_details.product_stock','$product_details.bay','$batch_code','$_id.type','Hindi','$name','371376tZbKWA','multer','aggregate','$_id.bin','French','$product_details.product_code','$_id.bay','$count','/Rooms_data2','$product_details.floorlevel','Spanish','get','all','Return\x20Goods','message','errors','render','$room','findOne','$product_details.expiry_date','Enabled','/map_value','$$product.product_quantity','1820640DfGtju','language','timezones-list','Finished\x20Goods','/view','$product_details.bin','$_id.level','$product_details.product_name','$_id.floorlevel','success','$products','3503553CviqnL','Arabic\x20(ae)','user','$product_details','Chinese','Arabic','status','27851870FzBjPU','product','Raw\x20Materials','express','$_id.product','toLocaleString','/staff_sales_id','Portuguese','/Rooms_data'];a0_0x43ac=function(){return _0x2bf956;};return a0_0x43ac();}