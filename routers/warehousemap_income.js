const a0_0x1757f4=a0_0x160b;(function(_0x3cd969,_0x2e71ee){const _0x55a717=a0_0x160b,_0x2c8ef3=_0x3cd969();while(!![]){try{const _0x2028a2=parseInt(_0x55a717(0x179))/0x1*(parseInt(_0x55a717(0x178))/0x2)+-parseInt(_0x55a717(0x168))/0x3*(-parseInt(_0x55a717(0x151))/0x4)+-parseInt(_0x55a717(0x156))/0x5+-parseInt(_0x55a717(0x167))/0x6*(-parseInt(_0x55a717(0x161))/0x7)+parseInt(_0x55a717(0x15c))/0x8+-parseInt(_0x55a717(0x14a))/0x9+parseInt(_0x55a717(0x174))/0xa*(-parseInt(_0x55a717(0x149))/0xb);if(_0x2028a2===_0x2e71ee)break;else _0x2c8ef3['push'](_0x2c8ef3['shift']());}catch(_0x448ed1){_0x2c8ef3['push'](_0x2c8ef3['shift']());}}}(a0_0x1ae5,0x84a2c));const express=require(a0_0x1757f4(0x170)),app=express(),router=express[a0_0x1757f4(0x19f)](),multer=require(a0_0x1757f4(0x18d)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require(a0_0x1757f4(0x148));var timezones=require('timezones-list');function a0_0x160b(_0x42bdda,_0x48af37){const _0x1ae562=a0_0x1ae5();return a0_0x160b=function(_0x160b80,_0x23ac81){_0x160b80=_0x160b80-0x148;let _0x44ef15=_0x1ae562[_0x160b80];return _0x44ef15;},a0_0x160b(_0x42bdda,_0x48af37);}function a0_0x1ae5(){const _0x333d6d=['flash','1116345RxXJxZ','$_id.floorlevel','$product_details.expiry_date','product','email','/Rooms_data','6493744pjanjm','log','$products','$$product.product_quantity','/Rooms_data2','997255IHiTef','$product_details.batch_code','$product_details.product_name','Arabic','Hindi','/staff_sales','18AQssQh','12ojOXKC','$product_details','DRY\x20STORAGE','$product_details.bay','$batch_code','$product_code','/staff_sales_id','Enabled','express','/MapData2','$_id.level','../public/language/languages.json','1790BRZihK','user','$count','$product_details.level','1270162bOSuHU','1MzNoHC','$_id','Return\x20Goods','$production_date','language','$_id.bay','Finished\x20Goods','$product_details.floorlevel','Spanish','all','$product_details.bin','English\x20(US)','$name','English','errors','/MapData','get','$product_details.product_code','json','status','multer','message','warehousemap_incoming','warehouse','aggregate','exports','Raw\x20Materials','body','$_id.type','staff','$product_details.product_stock','pack','$expiry_date','$room','$_id.product','/view','German','$product_details.production_date','Router','toLocaleString','timezone','../middleware/auth','109131qVYqRV','1091502IsTKNN','find','/map_value','post','role','Chinese','Arabic\x20(ae)','789488eJLVAh','$product_details.type','Portuguese','findOne'];a0_0x1ae5=function(){return _0x333d6d;};return a0_0x1ae5();}const users=require(a0_0x1757f4(0x173));router[a0_0x1757f4(0x189)](a0_0x1757f4(0x19c),auth,async(_0x38300b,_0x2c7ff)=>{const _0x267e7c=a0_0x1757f4;try{const {username:_0x12bf6b,email:_0x168d0e,role:_0x595834}=_0x38300b[_0x267e7c(0x175)],_0x466bd2=_0x38300b[_0x267e7c(0x175)],_0x2f5a6b=await profile[_0x267e7c(0x154)]({'email':_0x466bd2[_0x267e7c(0x15a)]}),_0x473cdf=await master_shop[_0x267e7c(0x14b)]();let _0x290bd7;if(_0x466bd2[_0x267e7c(0x14e)]==_0x267e7c(0x196)){const _0x167d2b=await staff['findOne']({'email':_0x466bd2[_0x267e7c(0x15a)]});_0x290bd7=await warehouse[_0x267e7c(0x191)]([{'$match':{'status':'Enabled','name':_0x167d2b[_0x267e7c(0x190)]}},{'$group':{'_id':_0x267e7c(0x185),'name':{'$first':_0x267e7c(0x185)}}},{'$sort':{'name':-0x1}}]);}else _0x290bd7=await warehouse[_0x267e7c(0x191)]([{'$match':{'status':_0x267e7c(0x16f)}},{'$group':{'_id':_0x267e7c(0x185),'name':{'$first':_0x267e7c(0x185)}}},{'$sort':{'name':-0x1}}]);const _0x4ad0b9=new Date()[_0x267e7c(0x1a0)]('en-US',{'timeZone':_0x473cdf[0x0][_0x267e7c(0x1a1)]});if(_0x473cdf[0x0][_0x267e7c(0x17d)]==_0x267e7c(0x184))var _0x26bb16=users[_0x267e7c(0x186)];else{if(_0x473cdf[0x0][_0x267e7c(0x17d)]==_0x267e7c(0x165))var _0x26bb16=users[_0x267e7c(0x165)];else{if(_0x473cdf[0x0]['language']==_0x267e7c(0x19d))var _0x26bb16=users[_0x267e7c(0x19d)];else{if(_0x473cdf[0x0]['language']==_0x267e7c(0x181))var _0x26bb16=users[_0x267e7c(0x181)];else{if(_0x473cdf[0x0][_0x267e7c(0x17d)]=='French')var _0x26bb16=users['French'];else{if(_0x473cdf[0x0][_0x267e7c(0x17d)]=='Portuguese\x20(BR)')var _0x26bb16=users[_0x267e7c(0x153)];else{if(_0x473cdf[0x0][_0x267e7c(0x17d)]==_0x267e7c(0x14f))var _0x26bb16=users['Chinese'];else{if(_0x473cdf[0x0]['language']==_0x267e7c(0x150))var _0x26bb16=users[_0x267e7c(0x164)];}}}}}}}_0x2c7ff['render'](_0x267e7c(0x18f),{'success':_0x38300b[_0x267e7c(0x155)]('success'),'errors':_0x38300b[_0x267e7c(0x155)](_0x267e7c(0x187)),'role':_0x466bd2,'profile':_0x2f5a6b,'master_shop':_0x473cdf,'timezones':timezones,'language':_0x26bb16,'warehouse':_0x290bd7});}catch(_0x5aa6b6){console[_0x267e7c(0x15d)](_0x5aa6b6),_0x2c7ff['status'](0xc8)['json']({'message':_0x5aa6b6[_0x267e7c(0x18e)]});}}),router['post'](a0_0x1757f4(0x188),async(_0x412315,_0x8b22e3)=>{const _0x4a63f8=a0_0x1757f4,{warehouseNew:_0x1b269f,rooms:_0x41dd1a,Type:_0x43c6ab}=_0x412315[_0x4a63f8(0x194)],_0x2d10c5=await warehouse[_0x4a63f8(0x191)]([{'$unwind':_0x4a63f8(0x169)},{'$match':{'name':_0x1b269f,'room':_0x41dd1a,'product_details.type':_0x43c6ab}},{'$group':{'_id':{'bay':_0x4a63f8(0x16b),'bin':_0x4a63f8(0x183),'type':_0x4a63f8(0x152),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x4a63f8(0x163),'product_quantity':_0x4a63f8(0x197),'product_code':_0x4a63f8(0x18a)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x4a63f8(0x197),0x0]},'then':_0x4a63f8(0x197),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','bin':'$_id.bin','type':'$_id.type','floorlevel':_0x4a63f8(0x157),'products':{'$filter':{'input':_0x4a63f8(0x15e),'as':_0x4a63f8(0x159),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x8b22e3['json'](_0x2d10c5);}),router[a0_0x1757f4(0x14d)](a0_0x1757f4(0x171),async(_0x298853,_0x5b8913)=>{const _0x1834cd=a0_0x1757f4,{warehouseNew:_0x20cc91,rooms:_0x29e538,room_cat:_0x2f1113}=_0x298853[_0x1834cd(0x194)];let _0x75756c;if(_0x2f1113=='All')_0x75756c=await warehouse[_0x1834cd(0x191)]([{'$unwind':_0x1834cd(0x169)},{'$match':{'name':_0x20cc91}},{'$group':{'_id':{'bay':_0x1834cd(0x16b),'product':_0x1834cd(0x163),'expiry':_0x1834cd(0x158)},'count':{'$sum':_0x1834cd(0x197)},'production_date':{'$first':_0x1834cd(0x19e)},'expiry_date':{'$first':_0x1834cd(0x158)},'batch_code':{'$first':_0x1834cd(0x162)},'product_code':{'$first':_0x1834cd(0x18a)}}},{'$group':{'_id':_0x1834cd(0x17e),'products':{'$push':{'product':_0x1834cd(0x19b),'quantity':_0x1834cd(0x176),'production_date':_0x1834cd(0x17c),'expiry_date':_0x1834cd(0x199),'batch_code':_0x1834cd(0x16c),'product_code':_0x1834cd(0x16d)}},'totalQuantity':{'$sum':_0x1834cd(0x176)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0x1834cd(0x15d)](_0x2f1113);else{}_0x5b8913['json'](_0x75756c);}),router[a0_0x1757f4(0x14d)](a0_0x1757f4(0x15b),async(_0x425d0e,_0x5985a3)=>{const _0x10d658=a0_0x1757f4;try{const {warehouse_name:_0x1fa185}=_0x425d0e[_0x10d658(0x194)];var _0x5d6997='';_0x5d6997=[{'$match':{'name':_0x1fa185,'status':'Enabled'}},{'$group':{'_id':_0x10d658(0x17a),'room_name':{'$first':_0x10d658(0x19a)}}},{'$sort':{'room_name':0x1}}];const _0x2fdf4d=await warehouse[_0x10d658(0x191)](_0x5d6997);_0x5985a3[_0x10d658(0x18c)](0xc8)[_0x10d658(0x18b)](_0x2fdf4d);}catch(_0x26cead){_0x5985a3[_0x10d658(0x18c)](0x190)[_0x10d658(0x18b)]({'errorMessage':_0x26cead[_0x10d658(0x18e)]});}}),router['post'](a0_0x1757f4(0x160),async(_0x590192,_0x45cf18)=>{const _0x5591a=a0_0x1757f4;try{const {warehouse_name:_0x584457,cat:_0x407325,valNew:_0x8ab495}=_0x590192[_0x5591a(0x194)];var _0x158917='',_0x5dfce4='';if(_0x407325==_0x5591a(0x193))_0x158917=_0x5591a(0x17b),_0x8ab495==_0x5591a(0x198)?_0x5dfce4=[{'$match':{'status':_0x5591a(0x16f),'warehouse_category':_0x407325,'name':{'$ne':_0x158917},'name':_0x5591a(0x16a)}},{'$group':{'_id':'$name','room_name':{'$first':_0x5591a(0x185)}}},{'$sort':{'room_name':0x1}}]:_0x5dfce4=[{'$match':{'status':_0x5591a(0x16f),'warehouse_category':_0x407325,'name':{'$ne':_0x158917}}},{'$group':{'_id':_0x5591a(0x185),'room_name':{'$first':_0x5591a(0x185)}}},{'$sort':{'room_name':0x1}}];else _0x407325==_0x5591a(0x17f)?(_0x158917='QA\x20Warehouse',_0x5dfce4=[{'$match':{'status':'Enabled','warehouse_category':_0x407325,'name':{'$ne':_0x158917}}},{'$group':{'_id':_0x5591a(0x185),'room_name':{'$first':_0x5591a(0x185)}}},{'$sort':{'room_name':0x1}}]):_0x5dfce4=[{'$match':{'status':_0x5591a(0x16f)}},{'$group':{'_id':_0x5591a(0x185),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];const _0x119c8b=await warehouse[_0x5591a(0x191)](_0x5dfce4);_0x45cf18[_0x5591a(0x18c)](0xc8)[_0x5591a(0x18b)](_0x119c8b);}catch(_0x4d8cfc){_0x45cf18[_0x5591a(0x18c)](0x190)['json']({'errorMessage':_0x4d8cfc['message']}),console[_0x5591a(0x15d)](_0x4d8cfc);}}),router[a0_0x1757f4(0x14d)]('/Rooms_data3',async(_0x363b35,_0x479f77)=>{const _0x2a2638=a0_0x1757f4;try{const {warehouse_name:_0x2f729c,cat:_0x13191b}=_0x363b35['body'],_0x2fb48c=await warehouse[_0x2a2638(0x191)]([{'$match':{'status':_0x2a2638(0x16f),'warehouse_category':_0x13191b,'name':_0x2f729c}},{'$group':{'_id':'$room','room_name':{'$first':_0x2a2638(0x19a)}}},{'$sort':{'room_name':0x1}}]);_0x479f77[_0x2a2638(0x18c)](0xc8)[_0x2a2638(0x18b)](_0x2fb48c);}catch(_0x166a1a){_0x479f77['status'](0x190)[_0x2a2638(0x18b)]({'errorMessage':_0x166a1a[_0x2a2638(0x18e)]});}}),router['post'](a0_0x1757f4(0x166),async(_0x2d2acb,_0x3a4d30)=>{const _0x4fdc65=a0_0x1757f4;try{const {typeofsales:_0x3930eb}=_0x2d2acb[_0x4fdc65(0x194)];var _0x25e148;_0x3930eb=='1'&&(_0x25e148=await staff[_0x4fdc65(0x14b)]({'account_category':'sa','type_of_acc_cat':_0x3930eb})),_0x3a4d30[_0x4fdc65(0x18c)](0xc8)[_0x4fdc65(0x18b)](_0x25e148);}catch(_0x18a728){_0x3a4d30['status'](0x190)['json']({'errorMessage':_0x18a728[_0x4fdc65(0x18e)]});}}),router[a0_0x1757f4(0x14d)](a0_0x1757f4(0x16e),async(_0x1b149a,_0x524992)=>{const _0x36965f=a0_0x1757f4;try{const {id:_0x377409}=_0x1b149a[_0x36965f(0x194)],_0xf440f6=await staff[_0x36965f(0x14b)]({'_id':_0x377409});_0x524992[_0x36965f(0x18c)](0xc8)[_0x36965f(0x18b)](_0xf440f6);}catch(_0x438d5f){_0x524992[_0x36965f(0x18c)](0x190)[_0x36965f(0x18b)]({'errorMessage':_0x438d5f[_0x36965f(0x18e)]});}}),router[a0_0x1757f4(0x14d)](a0_0x1757f4(0x14c),async(_0x4b34a6,_0x3b1a7c)=>{const _0x7956a0=a0_0x1757f4;try{const {warehouse_name:_0x39d891,room_value:_0xf4046a}=_0x4b34a6['body'];let _0x2c7d57;_0xf4046a==_0x7956a0(0x182)?_0x2c7d57=await warehouse[_0x7956a0(0x191)]([{'$unwind':_0x7956a0(0x169)},{'$match':{'name':_0x39d891}},{'$group':{'_id':{'bay':_0x7956a0(0x16b),'level':_0x7956a0(0x177),'type':_0x7956a0(0x152),'floorlevel':_0x7956a0(0x180)},'products':{'$push':{'product_name':_0x7956a0(0x163),'product_quantity':'$product_details.product_stock','product_code':_0x7956a0(0x18a)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x7956a0(0x197),0x0]},'then':_0x7956a0(0x197),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x7956a0(0x17e),'level':_0x7956a0(0x172),'type':_0x7956a0(0x195),'floorlevel':_0x7956a0(0x157),'products':{'$filter':{'input':_0x7956a0(0x15e),'as':_0x7956a0(0x159),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]):_0x2c7d57=await warehouse[_0x7956a0(0x191)]([{'$unwind':_0x7956a0(0x169)},{'$match':{'name':_0x39d891,'room':_0xf4046a}},{'$group':{'_id':{'bay':_0x7956a0(0x16b),'level':_0x7956a0(0x177),'type':'$product_details.type','floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x7956a0(0x163),'product_quantity':_0x7956a0(0x197),'product_code':_0x7956a0(0x18a)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x7956a0(0x197),0x0]},'then':_0x7956a0(0x197),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','level':_0x7956a0(0x172),'type':_0x7956a0(0x195),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':'$products','as':_0x7956a0(0x159),'cond':{'$gt':[_0x7956a0(0x15f),0x0]}}},'totalQuantity':0x1}}]),_0x3b1a7c[_0x7956a0(0x18c)](0xc8)['json'](_0x2c7d57);}catch(_0x273c27){_0x3b1a7c[_0x7956a0(0x18c)](0x190)[_0x7956a0(0x18b)]({'errorMessage':_0x273c27[_0x7956a0(0x18e)]});}}),module[a0_0x1757f4(0x192)]=router;