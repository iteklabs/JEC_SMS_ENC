const a0_0x4f2dbb=a0_0x2d77;(function(_0x9c862f,_0x420850){const _0x13744d=a0_0x2d77,_0x307956=_0x9c862f();while(!![]){try{const _0x32d055=parseInt(_0x13744d(0x1b5))/0x1*(parseInt(_0x13744d(0x1bc))/0x2)+-parseInt(_0x13744d(0x1da))/0x3*(parseInt(_0x13744d(0x1fd))/0x4)+parseInt(_0x13744d(0x1de))/0x5*(parseInt(_0x13744d(0x1ad))/0x6)+parseInt(_0x13744d(0x1e1))/0x7+-parseInt(_0x13744d(0x1e3))/0x8+-parseInt(_0x13744d(0x1b8))/0x9*(parseInt(_0x13744d(0x1dc))/0xa)+parseInt(_0x13744d(0x1b9))/0xb;if(_0x32d055===_0x420850)break;else _0x307956['push'](_0x307956['shift']());}catch(_0x583cdf){_0x307956['push'](_0x307956['shift']());}}}(a0_0x506c,0xb02fd));const express=require(a0_0x4f2dbb(0x1cd)),app=express(),router=express[a0_0x4f2dbb(0x1ec)](),multer=require(a0_0x4f2dbb(0x1d3)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x4f2dbb(0x1c9)),auth=require(a0_0x4f2dbb(0x1f9));var timezones=require('timezones-list');function a0_0x506c(){const _0x45731a=['/MapData2','toLocaleString','../models/all_models','aggregate','Finished\x20Goods','find','express','$room','log','$_id.floorlevel','/Rooms_data3','Hindi','multer','warehouse','English','$product_details.production_date','All','post','status','3lgbEFw','Portuguese\x20(BR)','10AkWQVX','$_id.product','70VQdVSU','findOne','$batch_code','7615258jPyhEG','role','697280eTTlAC','json','$$product.product_quantity','body','$name','$product_details','success','Enabled','timezone','Router','Arabic','$product_details.product_stock','/staff_sales_id','Chinese','$_id','user','en-US','$product_details.bin','$_id.bin','$_id.bay','errors','Spanish','../middleware/auth','$product_code','$product_details.product_name','language','645104xlJKhv','exports','Raw\x20Materials','$product_details.bay','Portuguese','flash','message','95394GRBrRu','$products','../public/language/languages.json','$_id.type','staff','German','DRY\x20STORAGE','warehousemap_incoming','58130KkIIvv','$product_details.level','email','10365795weqFBu','7006802uZqLRN','$product_details.product_code','/Rooms_data2','6hVHdQQ','/map_value','/view','$production_date','$count','$product_details.type','French','product','$product_details.floorlevel','$product_details.expiry_date','English\x20(US)'];a0_0x506c=function(){return _0x45731a;};return a0_0x506c();}function a0_0x2d77(_0x29850,_0x18a8e4){const _0x506cbe=a0_0x506c();return a0_0x2d77=function(_0x2d77fe,_0x1f93f6){_0x2d77fe=_0x2d77fe-0x1a8;let _0x6df418=_0x506cbe[_0x2d77fe];return _0x6df418;},a0_0x2d77(_0x29850,_0x18a8e4);}const users=require(a0_0x4f2dbb(0x1af));router['get'](a0_0x4f2dbb(0x1be),auth,async(_0x384dfd,_0x4d719a)=>{const _0x548633=a0_0x4f2dbb;try{const {username:_0x4380e0,email:_0x1d7fb7,role:_0x638293}=_0x384dfd[_0x548633(0x1f2)],_0x290b1c=_0x384dfd[_0x548633(0x1f2)],_0xd8760b=await profile[_0x548633(0x1df)]({'email':_0x290b1c['email']}),_0x623274=await master_shop[_0x548633(0x1cc)]();let _0x2e9608;if(_0x290b1c[_0x548633(0x1e2)]==_0x548633(0x1b1)){const _0x12ede5=await staff['findOne']({'email':_0x290b1c[_0x548633(0x1b7)]});_0x2e9608=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x12ede5[_0x548633(0x1d4)]}},{'$group':{'_id':'$name','name':{'$first':_0x548633(0x1e7)}}},{'$sort':{'name':-0x1}}]);}else _0x2e9608=await warehouse[_0x548633(0x1ca)]([{'$match':{'status':_0x548633(0x1ea)}},{'$group':{'_id':_0x548633(0x1e7),'name':{'$first':_0x548633(0x1e7)}}},{'$sort':{'name':-0x1}}]);const _0x43a074=new Date()[_0x548633(0x1c8)](_0x548633(0x1f3),{'timeZone':_0x623274[0x0][_0x548633(0x1eb)]});if(_0x623274[0x0][_0x548633(0x1fc)]==_0x548633(0x1c6))var _0x1fe918=users[_0x548633(0x1d5)];else{if(_0x623274[0x0]['language']==_0x548633(0x1d2))var _0x1fe918=users[_0x548633(0x1d2)];else{if(_0x623274[0x0][_0x548633(0x1fc)]==_0x548633(0x1b2))var _0x1fe918=users[_0x548633(0x1b2)];else{if(_0x623274[0x0][_0x548633(0x1fc)]==_0x548633(0x1f8))var _0x1fe918=users['Spanish'];else{if(_0x623274[0x0][_0x548633(0x1fc)]==_0x548633(0x1c2))var _0x1fe918=users['French'];else{if(_0x623274[0x0][_0x548633(0x1fc)]==_0x548633(0x1db))var _0x1fe918=users[_0x548633(0x1aa)];else{if(_0x623274[0x0][_0x548633(0x1fc)]==_0x548633(0x1f0))var _0x1fe918=users[_0x548633(0x1f0)];else{if(_0x623274[0x0][_0x548633(0x1fc)]=='Arabic\x20(ae)')var _0x1fe918=users[_0x548633(0x1ed)];}}}}}}}_0x4d719a['render'](_0x548633(0x1b4),{'success':_0x384dfd[_0x548633(0x1ab)](_0x548633(0x1e9)),'errors':_0x384dfd[_0x548633(0x1ab)](_0x548633(0x1f7)),'role':_0x290b1c,'profile':_0xd8760b,'master_shop':_0x623274,'timezones':timezones,'language':_0x1fe918,'warehouse':_0x2e9608});}catch(_0x71bf64){console[_0x548633(0x1cf)](_0x71bf64),_0x4d719a[_0x548633(0x1d9)](0xc8)[_0x548633(0x1e4)]({'message':_0x71bf64[_0x548633(0x1ac)]});}}),router[a0_0x4f2dbb(0x1d8)]('/MapData',async(_0x1cc7c5,_0x30edf8)=>{const _0x25db0a=a0_0x4f2dbb,{warehouseNew:_0x15b4a4,rooms:_0x31fdc8,Type:_0x438db7}=_0x1cc7c5[_0x25db0a(0x1e6)],_0x568f2e=await warehouse[_0x25db0a(0x1ca)]([{'$unwind':'$product_details'},{'$match':{'name':_0x15b4a4,'room':_0x31fdc8,'product_details.type':_0x438db7}},{'$group':{'_id':{'bay':'$product_details.bay','bin':_0x25db0a(0x1f4),'type':'$product_details.type','floorlevel':_0x25db0a(0x1c4)},'products':{'$push':{'product_name':_0x25db0a(0x1fb),'product_quantity':_0x25db0a(0x1ee),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x25db0a(0x1f6),'bin':_0x25db0a(0x1f5),'type':_0x25db0a(0x1b0),'floorlevel':_0x25db0a(0x1d0),'products':{'$filter':{'input':_0x25db0a(0x1ae),'as':_0x25db0a(0x1c3),'cond':{'$gt':[_0x25db0a(0x1e5),0x0]}}},'totalQuantity':0x1}}]);_0x30edf8[_0x25db0a(0x1e4)](_0x568f2e);}),router[a0_0x4f2dbb(0x1d8)](a0_0x4f2dbb(0x1c7),async(_0x88b496,_0x1883c5)=>{const _0x19240a=a0_0x4f2dbb,{warehouseNew:_0x1258b4,rooms:_0x4bf21a,room_cat:_0x51f25d}=_0x88b496['body'];let _0x1b3d69;if(_0x51f25d==_0x19240a(0x1d7))_0x1b3d69=await warehouse['aggregate']([{'$unwind':_0x19240a(0x1e8)},{'$match':{'name':_0x1258b4}},{'$group':{'_id':{'bay':_0x19240a(0x1a9),'product':'$product_details.product_name','expiry':_0x19240a(0x1c5)},'count':{'$sum':_0x19240a(0x1ee)},'production_date':{'$first':_0x19240a(0x1d6)},'expiry_date':{'$first':_0x19240a(0x1c5)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x19240a(0x1ba)}}},{'$group':{'_id':_0x19240a(0x1f6),'products':{'$push':{'product':_0x19240a(0x1dd),'quantity':_0x19240a(0x1c0),'production_date':_0x19240a(0x1bf),'expiry_date':'$expiry_date','batch_code':_0x19240a(0x1e0),'product_code':_0x19240a(0x1fa)}},'totalQuantity':{'$sum':_0x19240a(0x1c0)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x19240a(0x1f1),'products':0x1,'totalQuantity':0x1}}]),console[_0x19240a(0x1cf)](_0x51f25d);else{}_0x1883c5[_0x19240a(0x1e4)](_0x1b3d69);}),router['post']('/Rooms_data',async(_0x3cc882,_0x10e292)=>{const _0x1fe350=a0_0x4f2dbb;try{const {warehouse_name:_0x2fec2d}=_0x3cc882[_0x1fe350(0x1e6)];var _0xa389de='';_0xa389de=[{'$match':{'name':_0x2fec2d,'status':_0x1fe350(0x1ea)}},{'$group':{'_id':_0x1fe350(0x1f1),'room_name':{'$first':_0x1fe350(0x1ce)}}},{'$sort':{'room_name':0x1}}];const _0x936b99=await warehouse['aggregate'](_0xa389de);_0x10e292[_0x1fe350(0x1d9)](0xc8)['json'](_0x936b99);}catch(_0x2f7d9e){_0x10e292[_0x1fe350(0x1d9)](0x190)['json']({'errorMessage':_0x2f7d9e[_0x1fe350(0x1ac)]});}}),router['post'](a0_0x4f2dbb(0x1bb),async(_0x45cfe9,_0x8b3c66)=>{const _0x3fcd20=a0_0x4f2dbb;try{const {warehouse_name:_0x239ba3,cat:_0xf35aea,valNew:_0x2e7007}=_0x45cfe9[_0x3fcd20(0x1e6)];var _0x535ff3='',_0x17b00c='';if(_0xf35aea==_0x3fcd20(0x1a8))_0x535ff3='Return\x20Goods',_0x2e7007=='pack'?_0x17b00c=[{'$match':{'status':_0x3fcd20(0x1ea),'warehouse_category':_0xf35aea,'name':{'$ne':_0x535ff3},'name':_0x3fcd20(0x1b3)}},{'$group':{'_id':'$name','room_name':{'$first':_0x3fcd20(0x1e7)}}},{'$sort':{'room_name':0x1}}]:_0x17b00c=[{'$match':{'status':_0x3fcd20(0x1ea),'warehouse_category':_0xf35aea,'name':{'$ne':_0x535ff3}}},{'$group':{'_id':_0x3fcd20(0x1e7),'room_name':{'$first':_0x3fcd20(0x1e7)}}},{'$sort':{'room_name':0x1}}];else _0xf35aea==_0x3fcd20(0x1cb)?(_0x535ff3='QA\x20Warehouse',_0x17b00c=[{'$match':{'status':_0x3fcd20(0x1ea),'warehouse_category':_0xf35aea,'name':{'$ne':_0x535ff3}}},{'$group':{'_id':_0x3fcd20(0x1e7),'room_name':{'$first':_0x3fcd20(0x1e7)}}},{'$sort':{'room_name':0x1}}]):_0x17b00c=[{'$match':{'status':_0x3fcd20(0x1ea)}},{'$group':{'_id':_0x3fcd20(0x1e7),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];const _0x518de2=await warehouse['aggregate'](_0x17b00c);_0x8b3c66['status'](0xc8)[_0x3fcd20(0x1e4)](_0x518de2);}catch(_0x260739){_0x8b3c66['status'](0x190)['json']({'errorMessage':_0x260739['message']}),console[_0x3fcd20(0x1cf)](_0x260739);}}),router[a0_0x4f2dbb(0x1d8)](a0_0x4f2dbb(0x1d1),async(_0x5407d7,_0x505c17)=>{const _0x14d5f4=a0_0x4f2dbb;try{const {warehouse_name:_0x327459,cat:_0x34d51d}=_0x5407d7[_0x14d5f4(0x1e6)],_0x36f275=await warehouse[_0x14d5f4(0x1ca)]([{'$match':{'status':_0x14d5f4(0x1ea),'warehouse_category':_0x34d51d,'name':_0x327459}},{'$group':{'_id':_0x14d5f4(0x1ce),'room_name':{'$first':_0x14d5f4(0x1ce)}}},{'$sort':{'room_name':0x1}}]);_0x505c17['status'](0xc8)[_0x14d5f4(0x1e4)](_0x36f275);}catch(_0x3b4966){_0x505c17[_0x14d5f4(0x1d9)](0x190)[_0x14d5f4(0x1e4)]({'errorMessage':_0x3b4966[_0x14d5f4(0x1ac)]});}}),router['post']('/staff_sales',async(_0x3e1f65,_0x5db61b)=>{const _0x48ae5d=a0_0x4f2dbb;try{const {typeofsales:_0x854bc0}=_0x3e1f65[_0x48ae5d(0x1e6)],_0x876130=await staff['find']({'account_category':'sa','type_of_acc_cat':_0x854bc0});_0x5db61b[_0x48ae5d(0x1d9)](0xc8)[_0x48ae5d(0x1e4)](_0x876130);}catch(_0x456499){_0x5db61b[_0x48ae5d(0x1d9)](0x190)[_0x48ae5d(0x1e4)]({'errorMessage':_0x456499[_0x48ae5d(0x1ac)]});}}),router['post'](a0_0x4f2dbb(0x1ef),async(_0x7b665d,_0x5e8b60)=>{const _0x4ae47d=a0_0x4f2dbb;try{const {id:_0x4130a3}=_0x7b665d[_0x4ae47d(0x1e6)],_0x532b3a=await staff[_0x4ae47d(0x1cc)]({'_id':_0x4130a3});_0x5e8b60['status'](0xc8)[_0x4ae47d(0x1e4)](_0x532b3a);}catch(_0xac445f){_0x5e8b60[_0x4ae47d(0x1d9)](0x190)[_0x4ae47d(0x1e4)]({'errorMessage':_0xac445f[_0x4ae47d(0x1ac)]});}}),router[a0_0x4f2dbb(0x1d8)](a0_0x4f2dbb(0x1bd),async(_0x32db75,_0x3ba0ff)=>{const _0x43cafc=a0_0x4f2dbb;try{const {warehouse_name:_0x37dcc3,room_value:_0x3d1a1d}=_0x32db75['body'];let _0x337d1b;_0x3d1a1d=='all'?_0x337d1b=await warehouse[_0x43cafc(0x1ca)]([{'$unwind':_0x43cafc(0x1e8)},{'$match':{'name':_0x37dcc3}},{'$group':{'_id':{'bay':_0x43cafc(0x1a9),'level':_0x43cafc(0x1b6),'type':_0x43cafc(0x1c1),'floorlevel':_0x43cafc(0x1c4)},'products':{'$push':{'product_name':_0x43cafc(0x1fb),'product_quantity':_0x43cafc(0x1ee),'product_code':_0x43cafc(0x1ba)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x43cafc(0x1ee),0x0]},'then':_0x43cafc(0x1ee),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','level':'$_id.level','type':_0x43cafc(0x1b0),'floorlevel':_0x43cafc(0x1d0),'products':{'$filter':{'input':_0x43cafc(0x1ae),'as':_0x43cafc(0x1c3),'cond':{'$gt':[_0x43cafc(0x1e5),0x0]}}},'totalQuantity':0x1}}]):_0x337d1b=await warehouse[_0x43cafc(0x1ca)]([{'$unwind':_0x43cafc(0x1e8)},{'$match':{'name':_0x37dcc3,'room':_0x3d1a1d}},{'$group':{'_id':{'bay':_0x43cafc(0x1a9),'level':_0x43cafc(0x1b6),'type':_0x43cafc(0x1c1),'floorlevel':_0x43cafc(0x1c4)},'products':{'$push':{'product_name':_0x43cafc(0x1fb),'product_quantity':'$product_details.product_stock','product_code':_0x43cafc(0x1ba)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x43cafc(0x1ee),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x43cafc(0x1f6),'level':'$_id.level','type':_0x43cafc(0x1b0),'floorlevel':_0x43cafc(0x1d0),'products':{'$filter':{'input':'$products','as':'product','cond':{'$gt':[_0x43cafc(0x1e5),0x0]}}},'totalQuantity':0x1}}]),_0x3ba0ff[_0x43cafc(0x1d9)](0xc8)[_0x43cafc(0x1e4)](_0x337d1b);}catch(_0x44a20a){_0x3ba0ff[_0x43cafc(0x1d9)](0x190)[_0x43cafc(0x1e4)]({'errorMessage':_0x44a20a[_0x43cafc(0x1ac)]});}}),module[a0_0x4f2dbb(0x1fe)]=router;