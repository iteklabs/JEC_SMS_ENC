const a0_0x835d4f=a0_0x2604;(function(_0x3367bb,_0x3bf310){const _0x4f0304=a0_0x2604,_0x1a9fc9=_0x3367bb();while(!![]){try{const _0x160caa=-parseInt(_0x4f0304(0x1f1))/0x1+-parseInt(_0x4f0304(0x1d1))/0x2*(parseInt(_0x4f0304(0x1ea))/0x3)+parseInt(_0x4f0304(0x1f6))/0x4*(-parseInt(_0x4f0304(0x1d9))/0x5)+-parseInt(_0x4f0304(0x1b0))/0x6*(parseInt(_0x4f0304(0x1e1))/0x7)+parseInt(_0x4f0304(0x1f3))/0x8+-parseInt(_0x4f0304(0x1d7))/0x9+parseInt(_0x4f0304(0x1de))/0xa*(parseInt(_0x4f0304(0x1d4))/0xb);if(_0x160caa===_0x3bf310)break;else _0x1a9fc9['push'](_0x1a9fc9['shift']());}catch(_0x54d304){_0x1a9fc9['push'](_0x1a9fc9['shift']());}}}(a0_0x5e23,0xdcb48));const express=require(a0_0x835d4f(0x1da)),app=express(),router=express['Router'](),multer=require(a0_0x835d4f(0x1b8)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x835d4f(0x1f7)),auth=require(a0_0x835d4f(0x1a5));function a0_0x2604(_0x4e5e41,_0x2fcfab){const _0x5e232e=a0_0x5e23();return a0_0x2604=function(_0x2604d3,_0x358f6b){_0x2604d3=_0x2604d3-0x1a4;let _0x36a7c7=_0x5e232e[_0x2604d3];return _0x36a7c7;},a0_0x2604(_0x4e5e41,_0x2fcfab);}var timezones=require(a0_0x835d4f(0x1ac));const users=require(a0_0x835d4f(0x1aa));router[a0_0x835d4f(0x1f4)](a0_0x835d4f(0x1d0),auth,async(_0x204d5c,_0x23a2d4)=>{const _0x524d97=a0_0x835d4f;try{const {username:_0x922f14,email:_0x3192c9,role:_0x525663}=_0x204d5c['user'],_0x477cc1=_0x204d5c['user'],_0x49c229=await profile[_0x524d97(0x1cb)]({'email':_0x477cc1[_0x524d97(0x1ae)]}),_0x32d5f2=await master_shop[_0x524d97(0x1c0)]();let _0x313cad;if(_0x477cc1[_0x524d97(0x1b4)]=='staff'){const _0x4e2b9e=await staff[_0x524d97(0x1cb)]({'email':_0x477cc1[_0x524d97(0x1ae)]});_0x313cad=await warehouse['aggregate']([{'$match':{'status':_0x524d97(0x1ba),'name':_0x4e2b9e[_0x524d97(0x1ce)]}},{'$group':{'_id':_0x524d97(0x1c1),'name':{'$first':_0x524d97(0x1c1)}}},{'$sort':{'name':-0x1}}]);}else _0x313cad=await warehouse[_0x524d97(0x1d3)]([{'$match':{'status':_0x524d97(0x1ba)}},{'$group':{'_id':_0x524d97(0x1c1),'name':{'$first':_0x524d97(0x1c1)}}},{'$sort':{'name':-0x1}}]);const _0x29ef68=new Date()[_0x524d97(0x1c5)](_0x524d97(0x1db),{'timeZone':_0x32d5f2[0x0][_0x524d97(0x1e7)]});if(_0x32d5f2[0x0]['language']==_0x524d97(0x1c4))var _0x54fd8a=users[_0x524d97(0x1b5)];else{if(_0x32d5f2[0x0][_0x524d97(0x1c6)]==_0x524d97(0x1a7))var _0x54fd8a=users['Hindi'];else{if(_0x32d5f2[0x0][_0x524d97(0x1c6)]==_0x524d97(0x1c7))var _0x54fd8a=users[_0x524d97(0x1c7)];else{if(_0x32d5f2[0x0]['language']=='Spanish')var _0x54fd8a=users[_0x524d97(0x1c3)];else{if(_0x32d5f2[0x0]['language']==_0x524d97(0x1f8))var _0x54fd8a=users[_0x524d97(0x1f8)];else{if(_0x32d5f2[0x0][_0x524d97(0x1c6)]==_0x524d97(0x1af))var _0x54fd8a=users['Portuguese'];else{if(_0x32d5f2[0x0][_0x524d97(0x1c6)]=='Chinese')var _0x54fd8a=users[_0x524d97(0x1ec)];else{if(_0x32d5f2[0x0][_0x524d97(0x1c6)]==_0x524d97(0x1fb))var _0x54fd8a=users[_0x524d97(0x1c8)];}}}}}}}_0x23a2d4['render']('warehousemap_incoming',{'success':_0x204d5c[_0x524d97(0x1e3)](_0x524d97(0x1fa)),'errors':_0x204d5c[_0x524d97(0x1e3)](_0x524d97(0x1e2)),'role':_0x477cc1,'profile':_0x49c229,'master_shop':_0x32d5f2,'timezones':timezones,'language':_0x54fd8a,'warehouse':_0x313cad});}catch(_0x139555){console[_0x524d97(0x1bc)](_0x139555),_0x23a2d4[_0x524d97(0x1cf)](0xc8)['json']({'message':_0x139555['message']});}}),router[a0_0x835d4f(0x1d5)](a0_0x835d4f(0x1f5),async(_0x4a5cfe,_0x397d0e)=>{const _0x2404a3=a0_0x835d4f,{warehouseNew:_0x54dbdf,rooms:_0xe8af89,Type:_0x39e052}=_0x4a5cfe[_0x2404a3(0x1b6)],_0x19ee0b=await warehouse[_0x2404a3(0x1d3)]([{'$unwind':_0x2404a3(0x1a6)},{'$match':{'name':_0x54dbdf,'room':_0xe8af89,'product_details.type':_0x39e052}},{'$group':{'_id':{'bay':_0x2404a3(0x1cc),'bin':_0x2404a3(0x1e8),'type':'$product_details.type','floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x2404a3(0x1f2),'product_quantity':'$product_details.product_stock','product_code':_0x2404a3(0x1ca)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x2404a3(0x1f0),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x2404a3(0x1dd),'bin':_0x2404a3(0x1ed),'type':_0x2404a3(0x1ab),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x2404a3(0x1d2),'as':'product','cond':{'$gt':[_0x2404a3(0x1ad),0x0]}}},'totalQuantity':0x1}}]);_0x397d0e[_0x2404a3(0x1e0)](_0x19ee0b);}),router[a0_0x835d4f(0x1d5)](a0_0x835d4f(0x1df),async(_0x500c3b,_0x57c5bb)=>{const _0x4d2df5=a0_0x835d4f,{warehouseNew:_0x32d03b,rooms:_0x387235,room_cat:_0xce3933}=_0x500c3b[_0x4d2df5(0x1b6)];let _0x544b1f;if(_0xce3933==_0x4d2df5(0x1cd))_0x544b1f=await warehouse[_0x4d2df5(0x1d3)]([{'$unwind':_0x4d2df5(0x1a6)},{'$match':{'name':_0x32d03b}},{'$group':{'_id':{'bay':_0x4d2df5(0x1cc),'product':_0x4d2df5(0x1f2),'expiry':_0x4d2df5(0x1d8)},'count':{'$sum':_0x4d2df5(0x1f0)},'production_date':{'$first':_0x4d2df5(0x1c2)},'expiry_date':{'$first':_0x4d2df5(0x1d8)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':'$product_details.product_code'}}},{'$group':{'_id':_0x4d2df5(0x1dd),'products':{'$push':{'product':_0x4d2df5(0x1b9),'quantity':_0x4d2df5(0x1e5),'production_date':_0x4d2df5(0x1f9),'expiry_date':_0x4d2df5(0x1dc),'batch_code':_0x4d2df5(0x1e6),'product_code':_0x4d2df5(0x1a8)}},'totalQuantity':{'$sum':'$count'}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x4d2df5(0x1bb),'products':0x1,'totalQuantity':0x1}}]),console[_0x4d2df5(0x1bc)](_0xce3933);else{}_0x57c5bb[_0x4d2df5(0x1e0)](_0x544b1f);}),router[a0_0x835d4f(0x1d5)](a0_0x835d4f(0x1a9),async(_0x14a1a1,_0x293790)=>{const _0x57dab3=a0_0x835d4f;try{const {warehouse_name:_0x1740da}=_0x14a1a1[_0x57dab3(0x1b6)];var _0x50a7cc='';_0x50a7cc=[{'$match':{'name':_0x1740da,'status':_0x57dab3(0x1ba)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x57dab3(0x1b7)}}},{'$sort':{'room_name':0x1}}];const _0x49b795=await warehouse[_0x57dab3(0x1d3)](_0x50a7cc);_0x293790[_0x57dab3(0x1cf)](0xc8)[_0x57dab3(0x1e0)](_0x49b795);}catch(_0x556c3b){_0x293790['status'](0x190)[_0x57dab3(0x1e0)]({'errorMessage':_0x556c3b[_0x57dab3(0x1bf)]});}}),router['post'](a0_0x835d4f(0x1d6),async(_0x324428,_0x72446)=>{const _0x4d1268=a0_0x835d4f;try{const {warehouse_name:_0x449acc,cat:_0x271ffb,valNew:_0x376bf6}=_0x324428[_0x4d1268(0x1b6)];var _0x350c25='',_0x46c59a='';if(_0x271ffb==_0x4d1268(0x1e4))_0x350c25='Return\x20Goods',_0x376bf6==_0x4d1268(0x1ee)?_0x46c59a=[{'$match':{'status':_0x4d1268(0x1ba),'warehouse_category':_0x271ffb,'name':{'$ne':_0x350c25},'name':_0x4d1268(0x1b1)}},{'$group':{'_id':_0x4d1268(0x1c1),'room_name':{'$first':_0x4d1268(0x1c1)}}},{'$sort':{'room_name':0x1}}]:_0x46c59a=[{'$match':{'status':_0x4d1268(0x1ba),'warehouse_category':_0x271ffb,'name':{'$ne':_0x350c25}}},{'$group':{'_id':_0x4d1268(0x1c1),'room_name':{'$first':_0x4d1268(0x1c1)}}},{'$sort':{'room_name':0x1}}];else _0x271ffb==_0x4d1268(0x1be)?(_0x350c25=_0x4d1268(0x1ef),_0x46c59a=[{'$match':{'status':_0x4d1268(0x1ba),'warehouse_category':_0x271ffb,'name':{'$ne':_0x350c25}}},{'$group':{'_id':_0x4d1268(0x1c1),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]):_0x46c59a=[{'$match':{'status':_0x4d1268(0x1ba)}},{'$group':{'_id':_0x4d1268(0x1c1),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];const _0x2cf08c=await warehouse['aggregate'](_0x46c59a);_0x72446[_0x4d1268(0x1cf)](0xc8)[_0x4d1268(0x1e0)](_0x2cf08c);}catch(_0x184147){_0x72446[_0x4d1268(0x1cf)](0x190)[_0x4d1268(0x1e0)]({'errorMessage':_0x184147['message']}),console['log'](_0x184147);}}),router[a0_0x835d4f(0x1d5)]('/Rooms_data3',async(_0x2ffe73,_0x2e8e05)=>{const _0x274bf9=a0_0x835d4f;try{const {warehouse_name:_0x13a7e7,cat:_0x289d4b}=_0x2ffe73['body'],_0x4dbc35=await warehouse[_0x274bf9(0x1d3)]([{'$match':{'status':_0x274bf9(0x1ba),'warehouse_category':_0x289d4b,'name':_0x13a7e7}},{'$group':{'_id':_0x274bf9(0x1b7),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]);_0x2e8e05[_0x274bf9(0x1cf)](0xc8)['json'](_0x4dbc35);}catch(_0x137ba3){_0x2e8e05['status'](0x190)[_0x274bf9(0x1e0)]({'errorMessage':_0x137ba3[_0x274bf9(0x1bf)]});}}),router[a0_0x835d4f(0x1d5)]('/staff_sales',async(_0x61e09c,_0x4f0fef)=>{const _0x54df43=a0_0x835d4f;try{const {typeofsales:_0x40c22e}=_0x61e09c[_0x54df43(0x1b6)],_0x3928a0=await staff[_0x54df43(0x1c0)]({'account_category':'sa','type_of_acc_cat':_0x40c22e});_0x4f0fef[_0x54df43(0x1cf)](0xc8)[_0x54df43(0x1e0)](_0x3928a0);}catch(_0x247614){_0x4f0fef[_0x54df43(0x1cf)](0x190)[_0x54df43(0x1e0)]({'errorMessage':_0x247614[_0x54df43(0x1bf)]});}}),router['post'](a0_0x835d4f(0x1b2),async(_0x59ec6d,_0x520a8e)=>{const _0x2b8527=a0_0x835d4f;try{const {id:_0x25d211}=_0x59ec6d[_0x2b8527(0x1b6)],_0x500edd=await staff[_0x2b8527(0x1c0)]({'_id':_0x25d211});_0x520a8e[_0x2b8527(0x1cf)](0xc8)['json'](_0x500edd);}catch(_0x454733){_0x520a8e[_0x2b8527(0x1cf)](0x190)[_0x2b8527(0x1e0)]({'errorMessage':_0x454733[_0x2b8527(0x1bf)]});}}),router[a0_0x835d4f(0x1d5)]('/map_value',async(_0x14a143,_0x5be07a)=>{const _0x4e29ea=a0_0x835d4f;try{const {warehouse_name:_0x4344e5,room_value:_0x474d0b}=_0x14a143[_0x4e29ea(0x1b6)];let _0x2d1c92;_0x474d0b==_0x4e29ea(0x1e9)?_0x2d1c92=await warehouse['aggregate']([{'$unwind':_0x4e29ea(0x1a6)},{'$match':{'name':_0x4344e5}},{'$group':{'_id':{'bay':'$product_details.bay','level':'$product_details.level','type':_0x4e29ea(0x1b3),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x4e29ea(0x1f2),'product_quantity':_0x4e29ea(0x1f0),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x4e29ea(0x1f0),0x0]},'then':_0x4e29ea(0x1f0),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x4e29ea(0x1dd),'level':'$_id.level','type':_0x4e29ea(0x1ab),'floorlevel':_0x4e29ea(0x1bd),'products':{'$filter':{'input':_0x4e29ea(0x1d2),'as':_0x4e29ea(0x1a4),'cond':{'$gt':[_0x4e29ea(0x1ad),0x0]}}},'totalQuantity':0x1}}]):_0x2d1c92=await warehouse[_0x4e29ea(0x1d3)]([{'$unwind':_0x4e29ea(0x1a6)},{'$match':{'name':_0x4344e5,'room':_0x474d0b}},{'$group':{'_id':{'bay':_0x4e29ea(0x1cc),'level':'$product_details.level','type':_0x4e29ea(0x1b3),'floorlevel':_0x4e29ea(0x1eb)},'products':{'$push':{'product_name':_0x4e29ea(0x1f2),'product_quantity':_0x4e29ea(0x1f0),'product_code':_0x4e29ea(0x1ca)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x4e29ea(0x1f0),0x0]},'then':_0x4e29ea(0x1f0),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x4e29ea(0x1dd),'level':'$_id.level','type':'$_id.type','floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x4e29ea(0x1d2),'as':_0x4e29ea(0x1a4),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]),_0x5be07a[_0x4e29ea(0x1cf)](0xc8)[_0x4e29ea(0x1e0)](_0x2d1c92);}catch(_0x462f04){_0x5be07a['status'](0x190)[_0x4e29ea(0x1e0)]({'errorMessage':_0x462f04['message']});}}),module[a0_0x835d4f(0x1c9)]=router;function a0_0x5e23(){const _0x4b2158=['1695054YpyuiG','$product_details.product_name','12513656pzMoqG','get','/MapData','4NzXigN','../models/all_models','French','$production_date','success','Arabic\x20(ae)','product','../middleware/auth','$product_details','Hindi','$product_code','/Rooms_data','../public/language/languages.json','$_id.type','timezones-list','$$product.product_quantity','email','Portuguese\x20(BR)','5447040jFBEbs','DRY\x20STORAGE','/staff_sales_id','$product_details.type','role','English','body','$room','multer','$_id.product','Enabled','$_id','log','$_id.floorlevel','Finished\x20Goods','message','find','$name','$product_details.production_date','Spanish','English\x20(US)','toLocaleString','language','German','Arabic','exports','$product_details.product_code','findOne','$product_details.bay','All','warehouse','status','/view','86034MPfbmy','$products','aggregate','11ttRHfM','post','/Rooms_data2','10670913qiBvUF','$product_details.expiry_date','184490pgtYfY','express','en-US','$expiry_date','$_id.bay','46708450wwUyJV','/MapData2','json','7BwGFWL','errors','flash','Raw\x20Materials','$count','$batch_code','timezone','$product_details.bin','all','105LGPEVD','$product_details.floorlevel','Chinese','$_id.bin','pack','QA\x20Warehouse','$product_details.product_stock'];a0_0x5e23=function(){return _0x4b2158;};return a0_0x5e23();}