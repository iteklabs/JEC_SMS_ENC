const a0_0x42621e=a0_0x522d;(function(_0x1fcc8b,_0x3c5f08){const _0x30780b=a0_0x522d,_0x48b91a=_0x1fcc8b();while(!![]){try{const _0x24ad30=-parseInt(_0x30780b(0x101))/0x1*(parseInt(_0x30780b(0xf1))/0x2)+-parseInt(_0x30780b(0x123))/0x3+parseInt(_0x30780b(0xeb))/0x4*(-parseInt(_0x30780b(0x110))/0x5)+parseInt(_0x30780b(0x11d))/0x6+-parseInt(_0x30780b(0xff))/0x7+-parseInt(_0x30780b(0x103))/0x8+parseInt(_0x30780b(0x119))/0x9;if(_0x24ad30===_0x3c5f08)break;else _0x48b91a['push'](_0x48b91a['shift']());}catch(_0x477c28){_0x48b91a['push'](_0x48b91a['shift']());}}}(a0_0x51aa,0xa234c));const express=require(a0_0x42621e(0x106)),app=express(),router=express['Router'](),multer=require('multer'),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x42621e(0xf9)),auth=require(a0_0x42621e(0x114));function a0_0x522d(_0x4255c5,_0x1b41cd){const _0x51aa02=a0_0x51aa();return a0_0x522d=function(_0x522d9f,_0x337ecf){_0x522d9f=_0x522d9f-0xdf;let _0x57064d=_0x51aa02[_0x522d9f];return _0x57064d;},a0_0x522d(_0x4255c5,_0x1b41cd);}var timezones=require(a0_0x42621e(0x12d));const users=require('../public/language/languages.json');function a0_0x51aa(){const _0x5d4e68=['$_id.bin','$_id.product','log','$product_details.level','2403261LJbxeh','en-US','1kLvbot','$room','2308944HKVift','$_id.bay','/map_value','express','Portuguese\x20(BR)','$count','Enabled','Finished\x20Goods','message','$product_details','$_id.level','/MapData2','$production_date','4274890edbGKd','find','/MapData','product','../middleware/auth','Portuguese','render','/staff_sales_id','English\x20(US)','20114424iizKGq','all','German','$product_details.product_stock','5765652RXPKIp','warehousemap_incoming','$products','$product_code','toLocaleString','Arabic','1454742khLTtc','timezone','English','$product_details.product_code','All','$batch_code','$$product.product_quantity','Chinese','email','pack','timezones-list','user','DRY\x20STORAGE','post','Raw\x20Materials','Arabic\x20(ae)','French','/staff_sales','body','staff','errors','$product_details.expiry_date','$expiry_date','success','exports','$product_details.product_name','$_id','$_id.floorlevel','$product_details.floorlevel','$product_details.bay','role','4JuYxkR','findOne','$_id.type','Spanish','Hindi','aggregate','1119298nowshD','QA\x20Warehouse','$name','status','language','$product_details.type','flash','$product_details.bin','../models/all_models','json'];a0_0x51aa=function(){return _0x5d4e68;};return a0_0x51aa();}router['get']('/view',auth,async(_0x4e0808,_0x199001)=>{const _0x50c1c1=a0_0x42621e;try{const {username:_0x37abca,email:_0x177ee4,role:_0x187ad9}=_0x4e0808[_0x50c1c1(0x12e)],_0x5d48c6=_0x4e0808[_0x50c1c1(0x12e)],_0x3ef5e2=await profile[_0x50c1c1(0xec)]({'email':_0x5d48c6[_0x50c1c1(0x12b)]}),_0x54df53=await master_shop[_0x50c1c1(0x111)]();let _0x5f3c93;if(_0x5d48c6[_0x50c1c1(0xea)]==_0x50c1c1(0xdf)){const _0x50cc7b=await staff['findOne']({'email':_0x5d48c6[_0x50c1c1(0x12b)]});_0x5f3c93=await warehouse[_0x50c1c1(0xf0)]([{'$match':{'status':'Enabled','name':_0x50cc7b['warehouse']}},{'$group':{'_id':_0x50c1c1(0xf3),'name':{'$first':_0x50c1c1(0xf3)}}},{'$sort':{'name':-0x1}}]);}else _0x5f3c93=await warehouse[_0x50c1c1(0xf0)]([{'$match':{'status':_0x50c1c1(0x109)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);const _0x289dbd=new Date()[_0x50c1c1(0x121)](_0x50c1c1(0x100),{'timeZone':_0x54df53[0x0][_0x50c1c1(0x124)]});if(_0x54df53[0x0][_0x50c1c1(0xf5)]==_0x50c1c1(0x118))var _0x3542c2=users[_0x50c1c1(0x125)];else{if(_0x54df53[0x0][_0x50c1c1(0xf5)]=='Hindi')var _0x3542c2=users[_0x50c1c1(0xef)];else{if(_0x54df53[0x0]['language']=='German')var _0x3542c2=users[_0x50c1c1(0x11b)];else{if(_0x54df53[0x0][_0x50c1c1(0xf5)]==_0x50c1c1(0xee))var _0x3542c2=users[_0x50c1c1(0xee)];else{if(_0x54df53[0x0][_0x50c1c1(0xf5)]==_0x50c1c1(0x133))var _0x3542c2=users[_0x50c1c1(0x133)];else{if(_0x54df53[0x0]['language']==_0x50c1c1(0x107))var _0x3542c2=users[_0x50c1c1(0x115)];else{if(_0x54df53[0x0][_0x50c1c1(0xf5)]==_0x50c1c1(0x12a))var _0x3542c2=users[_0x50c1c1(0x12a)];else{if(_0x54df53[0x0][_0x50c1c1(0xf5)]==_0x50c1c1(0x132))var _0x3542c2=users[_0x50c1c1(0x122)];}}}}}}}_0x199001[_0x50c1c1(0x116)](_0x50c1c1(0x11e),{'success':_0x4e0808[_0x50c1c1(0xf7)](_0x50c1c1(0xe3)),'errors':_0x4e0808[_0x50c1c1(0xf7)](_0x50c1c1(0xe0)),'role':_0x5d48c6,'profile':_0x3ef5e2,'master_shop':_0x54df53,'timezones':timezones,'language':_0x3542c2,'warehouse':_0x5f3c93});}catch(_0x5c8082){console[_0x50c1c1(0xfd)](_0x5c8082),_0x199001['status'](0xc8)[_0x50c1c1(0xfa)]({'message':_0x5c8082[_0x50c1c1(0x10b)]});}}),router[a0_0x42621e(0x130)](a0_0x42621e(0x112),async(_0x34531e,_0x42157f)=>{const _0x56d3eb=a0_0x42621e,{warehouseNew:_0x9fb3ca,rooms:_0x3b96c0,Type:_0x229795}=_0x34531e[_0x56d3eb(0x135)],_0x4eec3d=await warehouse[_0x56d3eb(0xf0)]([{'$unwind':_0x56d3eb(0x10c)},{'$match':{'name':_0x9fb3ca,'room':_0x3b96c0,'product_details.type':_0x229795}},{'$group':{'_id':{'bay':_0x56d3eb(0xe9),'bin':_0x56d3eb(0xf8),'type':_0x56d3eb(0xf6),'floorlevel':_0x56d3eb(0xe8)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':'$product_details.product_stock','product_code':_0x56d3eb(0x126)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':_0x56d3eb(0x11c),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x56d3eb(0x104),'bin':_0x56d3eb(0xfb),'type':_0x56d3eb(0xed),'floorlevel':_0x56d3eb(0xe7),'products':{'$filter':{'input':_0x56d3eb(0x11f),'as':'product','cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x42157f[_0x56d3eb(0xfa)](_0x4eec3d);}),router[a0_0x42621e(0x130)](a0_0x42621e(0x10e),async(_0x4aa5cb,_0x2a3cc6)=>{const _0x40a775=a0_0x42621e,{warehouseNew:_0x1e6576,rooms:_0x3dfc4e,room_cat:_0x4d0560}=_0x4aa5cb[_0x40a775(0x135)];let _0x590762;if(_0x4d0560==_0x40a775(0x127))_0x590762=await warehouse[_0x40a775(0xf0)]([{'$unwind':_0x40a775(0x10c)},{'$match':{'name':_0x1e6576}},{'$group':{'_id':{'bay':_0x40a775(0xe9),'product':_0x40a775(0xe5),'expiry':_0x40a775(0xe1)},'count':{'$sum':_0x40a775(0x11c)},'production_date':{'$first':'$product_details.production_date'},'expiry_date':{'$first':'$product_details.expiry_date'},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x40a775(0x126)}}},{'$group':{'_id':_0x40a775(0x104),'products':{'$push':{'product':_0x40a775(0xfc),'quantity':_0x40a775(0x108),'production_date':_0x40a775(0x10f),'expiry_date':_0x40a775(0xe2),'batch_code':_0x40a775(0x128),'product_code':_0x40a775(0x120)}},'totalQuantity':{'$sum':'$count'}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x40a775(0xe6),'products':0x1,'totalQuantity':0x1}}]),console[_0x40a775(0xfd)](_0x4d0560);else{}_0x2a3cc6[_0x40a775(0xfa)](_0x590762);}),router[a0_0x42621e(0x130)]('/Rooms_data',async(_0x5d61d1,_0x542386)=>{const _0x1b0ce5=a0_0x42621e;try{const {warehouse_name:_0x227644}=_0x5d61d1[_0x1b0ce5(0x135)];var _0x21a404='';_0x21a404=[{'$match':{'name':_0x227644,'status':_0x1b0ce5(0x109)}},{'$group':{'_id':_0x1b0ce5(0xe6),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}];const _0x5e4852=await warehouse[_0x1b0ce5(0xf0)](_0x21a404);_0x542386[_0x1b0ce5(0xf4)](0xc8)[_0x1b0ce5(0xfa)](_0x5e4852);}catch(_0x33c2e7){_0x542386[_0x1b0ce5(0xf4)](0x190)[_0x1b0ce5(0xfa)]({'errorMessage':_0x33c2e7[_0x1b0ce5(0x10b)]});}}),router['post']('/Rooms_data2',async(_0x1be7bc,_0x47ad90)=>{const _0x35f4c9=a0_0x42621e;try{const {warehouse_name:_0x11eaa8,cat:_0x581ebf,valNew:_0x56a8e8}=_0x1be7bc[_0x35f4c9(0x135)];var _0x24c641='',_0x210344='';if(_0x581ebf==_0x35f4c9(0x131))_0x24c641='Return\x20Goods',_0x56a8e8==_0x35f4c9(0x12c)?_0x210344=[{'$match':{'status':_0x35f4c9(0x109),'warehouse_category':_0x581ebf,'name':{'$ne':_0x24c641},'name':_0x35f4c9(0x12f)}},{'$group':{'_id':_0x35f4c9(0xf3),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]:_0x210344=[{'$match':{'status':_0x35f4c9(0x109),'warehouse_category':_0x581ebf,'name':{'$ne':_0x24c641}}},{'$group':{'_id':_0x35f4c9(0xf3),'room_name':{'$first':_0x35f4c9(0xf3)}}},{'$sort':{'room_name':0x1}}];else _0x581ebf==_0x35f4c9(0x10a)?(_0x24c641=_0x35f4c9(0xf2),_0x210344=[{'$match':{'status':_0x35f4c9(0x109),'warehouse_category':_0x581ebf,'name':{'$ne':_0x24c641}}},{'$group':{'_id':_0x35f4c9(0xf3),'room_name':{'$first':_0x35f4c9(0xf3)}}},{'$sort':{'room_name':0x1}}]):_0x210344=[{'$match':{'status':_0x35f4c9(0x109)}},{'$group':{'_id':_0x35f4c9(0xf3),'room_name':{'$first':_0x35f4c9(0xf3)}}},{'$sort':{'room_name':0x1}}];const _0xa7227e=await warehouse[_0x35f4c9(0xf0)](_0x210344);_0x47ad90[_0x35f4c9(0xf4)](0xc8)[_0x35f4c9(0xfa)](_0xa7227e);}catch(_0x4c515a){_0x47ad90[_0x35f4c9(0xf4)](0x190)[_0x35f4c9(0xfa)]({'errorMessage':_0x4c515a[_0x35f4c9(0x10b)]}),console[_0x35f4c9(0xfd)](_0x4c515a);}}),router[a0_0x42621e(0x130)]('/Rooms_data3',async(_0x31864c,_0x5b39e4)=>{const _0x5225bf=a0_0x42621e;try{const {warehouse_name:_0x323675,cat:_0x3d1da0}=_0x31864c[_0x5225bf(0x135)],_0x52aa06=await warehouse[_0x5225bf(0xf0)]([{'$match':{'status':_0x5225bf(0x109),'warehouse_category':_0x3d1da0,'name':_0x323675}},{'$group':{'_id':_0x5225bf(0x102),'room_name':{'$first':_0x5225bf(0x102)}}},{'$sort':{'room_name':0x1}}]);_0x5b39e4[_0x5225bf(0xf4)](0xc8)[_0x5225bf(0xfa)](_0x52aa06);}catch(_0x208dc8){_0x5b39e4[_0x5225bf(0xf4)](0x190)[_0x5225bf(0xfa)]({'errorMessage':_0x208dc8[_0x5225bf(0x10b)]});}}),router[a0_0x42621e(0x130)](a0_0x42621e(0x134),async(_0x3a7080,_0xdf0933)=>{const _0x2e7132=a0_0x42621e;try{const {typeofsales:_0xe5ea8}=_0x3a7080[_0x2e7132(0x135)],_0x461d85=await staff[_0x2e7132(0x111)]({'account_category':'sa','type_of_acc_cat':_0xe5ea8});_0xdf0933['status'](0xc8)[_0x2e7132(0xfa)](_0x461d85);}catch(_0x594639){_0xdf0933[_0x2e7132(0xf4)](0x190)[_0x2e7132(0xfa)]({'errorMessage':_0x594639[_0x2e7132(0x10b)]});}}),router[a0_0x42621e(0x130)](a0_0x42621e(0x117),async(_0x2bdb8c,_0x13034f)=>{const _0x19c574=a0_0x42621e;try{const {id:_0x20e7b8}=_0x2bdb8c[_0x19c574(0x135)],_0x112d6c=await staff[_0x19c574(0x111)]({'_id':_0x20e7b8});_0x13034f['status'](0xc8)['json'](_0x112d6c);}catch(_0x5402d2){_0x13034f[_0x19c574(0xf4)](0x190)[_0x19c574(0xfa)]({'errorMessage':_0x5402d2[_0x19c574(0x10b)]});}}),router[a0_0x42621e(0x130)](a0_0x42621e(0x105),async(_0x4676b5,_0x4af0cf)=>{const _0xfd4ee3=a0_0x42621e;try{const {warehouse_name:_0x5c2422,room_value:_0x1020b6}=_0x4676b5['body'];let _0x561cca;_0x1020b6==_0xfd4ee3(0x11a)?_0x561cca=await warehouse['aggregate']([{'$unwind':_0xfd4ee3(0x10c)},{'$match':{'name':_0x5c2422}},{'$group':{'_id':{'bay':_0xfd4ee3(0xe9),'level':_0xfd4ee3(0xfe),'type':_0xfd4ee3(0xf6),'floorlevel':_0xfd4ee3(0xe8)},'products':{'$push':{'product_name':_0xfd4ee3(0xe5),'product_quantity':_0xfd4ee3(0x11c),'product_code':_0xfd4ee3(0x126)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0xfd4ee3(0x11c),0x0]},'then':_0xfd4ee3(0x11c),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0xfd4ee3(0x104),'level':_0xfd4ee3(0x10d),'type':'$_id.type','floorlevel':_0xfd4ee3(0xe7),'products':{'$filter':{'input':_0xfd4ee3(0x11f),'as':'product','cond':{'$gt':[_0xfd4ee3(0x129),0x0]}}},'totalQuantity':0x1}}]):_0x561cca=await warehouse[_0xfd4ee3(0xf0)]([{'$unwind':'$product_details'},{'$match':{'name':_0x5c2422,'room':_0x1020b6}},{'$group':{'_id':{'bay':_0xfd4ee3(0xe9),'level':_0xfd4ee3(0xfe),'type':_0xfd4ee3(0xf6),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0xfd4ee3(0xe5),'product_quantity':_0xfd4ee3(0x11c),'product_code':_0xfd4ee3(0x126)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0xfd4ee3(0x11c),0x0]},'then':_0xfd4ee3(0x11c),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0xfd4ee3(0x104),'level':_0xfd4ee3(0x10d),'type':_0xfd4ee3(0xed),'floorlevel':_0xfd4ee3(0xe7),'products':{'$filter':{'input':'$products','as':_0xfd4ee3(0x113),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]),_0x4af0cf[_0xfd4ee3(0xf4)](0xc8)[_0xfd4ee3(0xfa)](_0x561cca);}catch(_0x2b8401){_0x4af0cf[_0xfd4ee3(0xf4)](0x190)['json']({'errorMessage':_0x2b8401[_0xfd4ee3(0x10b)]});}}),module[a0_0x42621e(0xe4)]=router;