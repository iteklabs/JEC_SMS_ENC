const a0_0x4c2fb4=a0_0x5491;(function(_0x1aae1c,_0x2946d6){const _0x1f3ee2=a0_0x5491,_0x5673cb=_0x1aae1c();while(!![]){try{const _0x39102a=-parseInt(_0x1f3ee2(0xe0))/0x1+-parseInt(_0x1f3ee2(0xd6))/0x2*(-parseInt(_0x1f3ee2(0xf8))/0x3)+-parseInt(_0x1f3ee2(0xec))/0x4+-parseInt(_0x1f3ee2(0x105))/0x5*(-parseInt(_0x1f3ee2(0xd8))/0x6)+-parseInt(_0x1f3ee2(0xcf))/0x7*(parseInt(_0x1f3ee2(0x10a))/0x8)+parseInt(_0x1f3ee2(0xff))/0x9*(parseInt(_0x1f3ee2(0xc8))/0xa)+-parseInt(_0x1f3ee2(0x117))/0xb;if(_0x39102a===_0x2946d6)break;else _0x5673cb['push'](_0x5673cb['shift']());}catch(_0x29c3aa){_0x5673cb['push'](_0x5673cb['shift']());}}}(a0_0x1766,0x68b2a));const express=require(a0_0x4c2fb4(0xd1)),app=express(),router=express[a0_0x4c2fb4(0x10d)](),multer=require('multer'),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x4c2fb4(0xeb)),auth=require(a0_0x4c2fb4(0x10b));var timezones=require(a0_0x4c2fb4(0xc9));const users=require('../public/language/languages.json');router[a0_0x4c2fb4(0xed)](a0_0x4c2fb4(0x10c),auth,async(_0x48f7f8,_0x26a680)=>{const _0x2234bb=a0_0x4c2fb4;try{const {username:_0x38475b,email:_0x4fa9b6,role:_0x2a5707}=_0x48f7f8[_0x2234bb(0xce)],_0x1ed7ac=_0x48f7f8[_0x2234bb(0xce)],_0x9affec=await profile[_0x2234bb(0x10f)]({'email':_0x1ed7ac[_0x2234bb(0xda)]}),_0x43b9af=await master_shop[_0x2234bb(0xd0)]();let _0x4fa618;if(_0x1ed7ac['role']==_0x2234bb(0xf5)){const _0x2af5f3=await staff[_0x2234bb(0x10f)]({'email':_0x1ed7ac[_0x2234bb(0xda)]});_0x4fa618=await warehouse[_0x2234bb(0x102)]([{'$match':{'status':_0x2234bb(0xe5),'name':_0x2af5f3['warehouse']}},{'$group':{'_id':_0x2234bb(0xfa),'name':{'$first':_0x2234bb(0xfa)}}},{'$sort':{'name':-0x1}}]);}else _0x4fa618=await warehouse[_0x2234bb(0x102)]([{'$match':{'status':_0x2234bb(0xe5)}},{'$group':{'_id':_0x2234bb(0xfa),'name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);const _0x4305e4=new Date()[_0x2234bb(0x103)](_0x2234bb(0xcd),{'timeZone':_0x43b9af[0x0]['timezone']});if(_0x43b9af[0x0][_0x2234bb(0x113)]==_0x2234bb(0xc7))var _0x59952c=users[_0x2234bb(0xe8)];else{if(_0x43b9af[0x0][_0x2234bb(0x113)]=='Hindi')var _0x59952c=users[_0x2234bb(0xcb)];else{if(_0x43b9af[0x0][_0x2234bb(0x113)]=='German')var _0x59952c=users[_0x2234bb(0xdb)];else{if(_0x43b9af[0x0]['language']==_0x2234bb(0xf1))var _0x59952c=users[_0x2234bb(0xf1)];else{if(_0x43b9af[0x0][_0x2234bb(0x113)]==_0x2234bb(0xe7))var _0x59952c=users[_0x2234bb(0xe7)];else{if(_0x43b9af[0x0][_0x2234bb(0x113)]==_0x2234bb(0xd4))var _0x59952c=users[_0x2234bb(0xfe)];else{if(_0x43b9af[0x0]['language']==_0x2234bb(0x114))var _0x59952c=users[_0x2234bb(0x114)];else{if(_0x43b9af[0x0][_0x2234bb(0x113)]==_0x2234bb(0x11a))var _0x59952c=users[_0x2234bb(0xd2)];}}}}}}}_0x26a680['render'](_0x2234bb(0xe4),{'success':_0x48f7f8[_0x2234bb(0xf2)](_0x2234bb(0x100)),'errors':_0x48f7f8[_0x2234bb(0xf2)](_0x2234bb(0xe9)),'role':_0x1ed7ac,'profile':_0x9affec,'master_shop':_0x43b9af,'timezones':timezones,'language':_0x59952c,'warehouse':_0x4fa618});}catch(_0x20913e){console[_0x2234bb(0x11d)](_0x20913e),_0x26a680[_0x2234bb(0xd9)](0xc8)[_0x2234bb(0x106)]({'message':_0x20913e[_0x2234bb(0xf3)]});}}),router[a0_0x4c2fb4(0x104)](a0_0x4c2fb4(0xe2),async(_0x2e4802,_0x1a0760)=>{const _0x3f63da=a0_0x4c2fb4,{warehouseNew:_0x23a122,rooms:_0x40cb06,Type:_0x1bb6b8}=_0x2e4802['body'],_0x263469=await warehouse[_0x3f63da(0x102)]([{'$unwind':_0x3f63da(0x109)},{'$match':{'name':_0x23a122,'room':_0x40cb06,'product_details.type':_0x1bb6b8}},{'$group':{'_id':{'bay':_0x3f63da(0xf0),'bin':_0x3f63da(0x118),'type':_0x3f63da(0x112),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x3f63da(0xd3),'product_quantity':_0x3f63da(0xf9),'product_code':_0x3f63da(0x119)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x3f63da(0xf9),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x3f63da(0xe6),'bin':'$_id.bin','type':_0x3f63da(0xfc),'floorlevel':_0x3f63da(0xde),'products':{'$filter':{'input':_0x3f63da(0xef),'as':_0x3f63da(0xdd),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x1a0760[_0x3f63da(0x106)](_0x263469);}),router[a0_0x4c2fb4(0x104)](a0_0x4c2fb4(0xc6),async(_0x34a180,_0x40ec4b)=>{const _0x1a8272=a0_0x4c2fb4,{warehouseNew:_0x2f1b74,rooms:_0x3283f4,room_cat:_0x1f4bc7}=_0x34a180[_0x1a8272(0xfd)];let _0x538174;if(_0x1f4bc7==_0x1a8272(0xf4))_0x538174=await warehouse['aggregate']([{'$unwind':_0x1a8272(0x109)},{'$match':{'name':_0x2f1b74}},{'$group':{'_id':{'bay':_0x1a8272(0xf0),'product':_0x1a8272(0xd3),'expiry':'$product_details.expiry_date'},'count':{'$sum':_0x1a8272(0xf9)},'production_date':{'$first':_0x1a8272(0xee)},'expiry_date':{'$first':_0x1a8272(0xdf)},'batch_code':{'$first':_0x1a8272(0x115)},'product_code':{'$first':_0x1a8272(0x119)}}},{'$group':{'_id':'$_id.bay','products':{'$push':{'product':_0x1a8272(0x110),'quantity':_0x1a8272(0x101),'production_date':_0x1a8272(0x108),'expiry_date':_0x1a8272(0xca),'batch_code':_0x1a8272(0x116),'product_code':_0x1a8272(0xf6)}},'totalQuantity':{'$sum':_0x1a8272(0x101)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x1a8272(0xf7),'products':0x1,'totalQuantity':0x1}}]),console[_0x1a8272(0x11d)](_0x1f4bc7);else{}_0x40ec4b[_0x1a8272(0x106)](_0x538174);}),router[a0_0x4c2fb4(0x104)](a0_0x4c2fb4(0xfb),async(_0x2bfc16,_0x5bd68a)=>{const _0x47c153=a0_0x4c2fb4;try{const {warehouse_name:_0x2819bc}=_0x2bfc16[_0x47c153(0xfd)];var _0x230e80='';_0x230e80=[{'$match':{'name':_0x2819bc,'status':_0x47c153(0xe5)}},{'$group':{'_id':_0x47c153(0xf7),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}];const _0x10b1fa=await warehouse[_0x47c153(0x102)](_0x230e80);_0x5bd68a[_0x47c153(0xd9)](0xc8)['json'](_0x10b1fa);}catch(_0x5ed1bc){_0x5bd68a['status'](0x190)[_0x47c153(0x106)]({'errorMessage':_0x5ed1bc[_0x47c153(0xf3)]});}}),router['post'](a0_0x4c2fb4(0xe3),async(_0x47fac2,_0x1beaee)=>{const _0x2e8f54=a0_0x4c2fb4;try{const {warehouse_name:_0x467e58,cat:_0x3ad6c8,valNew:_0x584b93}=_0x47fac2[_0x2e8f54(0xfd)];var _0x2917b9='',_0x20e302='';if(_0x3ad6c8==_0x2e8f54(0x11c))_0x2917b9=_0x2e8f54(0xcc),_0x584b93==_0x2e8f54(0x107)?_0x20e302=[{'$match':{'status':_0x2e8f54(0xe5),'warehouse_category':_0x3ad6c8,'name':{'$ne':_0x2917b9},'name':'DRY\x20STORAGE'}},{'$group':{'_id':_0x2e8f54(0xfa),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]:_0x20e302=[{'$match':{'status':_0x2e8f54(0xe5),'warehouse_category':_0x3ad6c8,'name':{'$ne':_0x2917b9}}},{'$group':{'_id':_0x2e8f54(0xfa),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];else _0x3ad6c8==_0x2e8f54(0x11b)?(_0x2917b9=_0x2e8f54(0xc5),_0x20e302=[{'$match':{'status':_0x2e8f54(0xe5),'warehouse_category':_0x3ad6c8,'name':{'$ne':_0x2917b9}}},{'$group':{'_id':_0x2e8f54(0xfa),'room_name':{'$first':_0x2e8f54(0xfa)}}},{'$sort':{'room_name':0x1}}]):_0x20e302=[{'$match':{'status':_0x2e8f54(0xe5)}},{'$group':{'_id':_0x2e8f54(0xfa),'room_name':{'$first':_0x2e8f54(0xfa)}}},{'$sort':{'room_name':0x1}}];const _0x4bf751=await warehouse[_0x2e8f54(0x102)](_0x20e302);_0x1beaee[_0x2e8f54(0xd9)](0xc8)['json'](_0x4bf751);}catch(_0x1501c1){_0x1beaee[_0x2e8f54(0xd9)](0x190)['json']({'errorMessage':_0x1501c1[_0x2e8f54(0xf3)]}),console[_0x2e8f54(0x11d)](_0x1501c1);}}),router[a0_0x4c2fb4(0x104)]('/Rooms_data3',async(_0x46aad3,_0x46af0c)=>{const _0x36c814=a0_0x4c2fb4;try{const {warehouse_name:_0x504925,cat:_0x1eb471}=_0x46aad3['body'],_0x382f3f=await warehouse[_0x36c814(0x102)]([{'$match':{'status':_0x36c814(0xe5),'warehouse_category':_0x1eb471,'name':_0x504925}},{'$group':{'_id':_0x36c814(0xea),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]);_0x46af0c['status'](0xc8)['json'](_0x382f3f);}catch(_0x10781e){_0x46af0c[_0x36c814(0xd9)](0x190)[_0x36c814(0x106)]({'errorMessage':_0x10781e['message']});}}),router['post']('/staff_sales',async(_0x2fc883,_0x35d3ee)=>{const _0x1c8fd1=a0_0x4c2fb4;try{const {typeofsales:_0x50e658}=_0x2fc883[_0x1c8fd1(0xfd)],_0x255165=await staff[_0x1c8fd1(0xd0)]({'account_category':'sa','type_of_acc_cat':_0x50e658});_0x35d3ee[_0x1c8fd1(0xd9)](0xc8)[_0x1c8fd1(0x106)](_0x255165);}catch(_0x294914){_0x35d3ee['status'](0x190)[_0x1c8fd1(0x106)]({'errorMessage':_0x294914[_0x1c8fd1(0xf3)]});}}),router[a0_0x4c2fb4(0x104)](a0_0x4c2fb4(0xd7),async(_0x25baef,_0x2fc6cd)=>{const _0x1109bf=a0_0x4c2fb4;try{const {id:_0x49c7c1}=_0x25baef['body'],_0x5e33a2=await staff[_0x1109bf(0xd0)]({'_id':_0x49c7c1});_0x2fc6cd['status'](0xc8)[_0x1109bf(0x106)](_0x5e33a2);}catch(_0x7cb235){_0x2fc6cd[_0x1109bf(0xd9)](0x190)[_0x1109bf(0x106)]({'errorMessage':_0x7cb235['message']});}}),router[a0_0x4c2fb4(0x104)](a0_0x4c2fb4(0xe1),async(_0x4e8ac8,_0x5bb0da)=>{const _0x497a00=a0_0x4c2fb4;try{const {warehouse_name:_0x99292,room_value:_0x26a6ea}=_0x4e8ac8['body'];let _0x46de63;_0x26a6ea==_0x497a00(0xdc)?_0x46de63=await warehouse[_0x497a00(0x102)]([{'$unwind':_0x497a00(0x109)},{'$match':{'name':_0x99292}},{'$group':{'_id':{'bay':_0x497a00(0xf0),'level':_0x497a00(0xd5),'type':'$product_details.type','floorlevel':_0x497a00(0x111)},'products':{'$push':{'product_name':_0x497a00(0xd3),'product_quantity':_0x497a00(0xf9),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x497a00(0xf9),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x497a00(0xe6),'level':'$_id.level','type':_0x497a00(0xfc),'floorlevel':_0x497a00(0xde),'products':{'$filter':{'input':_0x497a00(0xef),'as':_0x497a00(0xdd),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]):_0x46de63=await warehouse[_0x497a00(0x102)]([{'$unwind':_0x497a00(0x109)},{'$match':{'name':_0x99292,'room':_0x26a6ea}},{'$group':{'_id':{'bay':_0x497a00(0xf0),'level':_0x497a00(0xd5),'type':_0x497a00(0x112),'floorlevel':_0x497a00(0x111)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':'$product_details.product_stock','product_code':_0x497a00(0x119)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x497a00(0xf9),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x497a00(0xe6),'level':_0x497a00(0x10e),'type':_0x497a00(0xfc),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':'$products','as':'product','cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]),_0x5bb0da[_0x497a00(0xd9)](0xc8)[_0x497a00(0x106)](_0x46de63);}catch(_0x36a0da){_0x5bb0da['status'](0x190)[_0x497a00(0x106)]({'errorMessage':_0x36a0da[_0x497a00(0xf3)]});}}),module['exports']=router;function a0_0x5491(_0x4a7d5d,_0x348fa6){const _0x176602=a0_0x1766();return a0_0x5491=function(_0x549127,_0x14fe6c){_0x549127=_0x549127-0xc5;let _0x46910=_0x176602[_0x549127];return _0x46910;},a0_0x5491(_0x4a7d5d,_0x348fa6);}function a0_0x1766(){const _0x3bd67e=['warehousemap_incoming','Enabled','$_id.bay','French','English','errors','$room','../models/all_models','1812916kYAjPK','get','$product_details.production_date','$products','$product_details.bay','Spanish','flash','message','All','staff','$product_code','$_id','141849MOQjXo','$product_details.product_stock','$name','/Rooms_data','$_id.type','body','Portuguese','1791piAlPm','success','$count','aggregate','toLocaleString','post','258895xptanB','json','pack','$production_date','$product_details','257720uKoawO','../middleware/auth','/view','Router','$_id.level','findOne','$_id.product','$product_details.floorlevel','$product_details.type','language','Chinese','$product_details.batch_code','$batch_code','2462361hUIFTa','$product_details.bin','$product_details.product_code','Arabic\x20(ae)','Finished\x20Goods','Raw\x20Materials','log','QA\x20Warehouse','/MapData2','English\x20(US)','7550peQKWd','timezones-list','$expiry_date','Hindi','Return\x20Goods','en-US','user','77tnJbhc','find','express','Arabic','$product_details.product_name','Portuguese\x20(BR)','$product_details.level','26lenlEu','/staff_sales_id','90ddnABx','status','email','German','all','product','$_id.floorlevel','$product_details.expiry_date','81322eBYuDJ','/map_value','/MapData','/Rooms_data2'];a0_0x1766=function(){return _0x3bd67e;};return a0_0x1766();}