const a0_0x40ceb4=a0_0x4f1a;(function(_0x3fdeb2,_0x84ac99){const _0x1d027c=a0_0x4f1a,_0x5cded8=_0x3fdeb2();while(!![]){try{const _0x56dc78=parseInt(_0x1d027c(0x158))/0x1+parseInt(_0x1d027c(0x169))/0x2*(parseInt(_0x1d027c(0x16c))/0x3)+parseInt(_0x1d027c(0x153))/0x4+-parseInt(_0x1d027c(0x15b))/0x5*(parseInt(_0x1d027c(0x148))/0x6)+-parseInt(_0x1d027c(0x180))/0x7*(parseInt(_0x1d027c(0x152))/0x8)+-parseInt(_0x1d027c(0x182))/0x9*(-parseInt(_0x1d027c(0x188))/0xa)+-parseInt(_0x1d027c(0x16a))/0xb*(-parseInt(_0x1d027c(0x162))/0xc);if(_0x56dc78===_0x84ac99)break;else _0x5cded8['push'](_0x5cded8['shift']());}catch(_0x50bade){_0x5cded8['push'](_0x5cded8['shift']());}}}(a0_0x53ef,0x544fd));function a0_0x53ef(){const _0x13a780=['$product_details.bin','$_id.level','findOne','All','errors','all','express','status','$product_details.product_name','$_id','language','14pxHTHs','/staff_sales','3753Oaujke','$product_details.type','flash','Arabic\x20(ae)','../models/all_models','message','13750iaKton','$product_details.bay','email','German','Finished\x20Goods','Spanish','Return\x20Goods','exports','aggregate','$product_details','/Rooms_data3','Chinese','$room','success','log','user','role','json','body','/map_value','Portuguese','timezone','pack','6Njimkg','multer','/MapData','$product_details.level','$product_details.batch_code','$product_details.product_code','QA\x20Warehouse','warehousemap_incoming','find','Arabic','1960264pCvoBj','929012khcqPf','$product_details.expiry_date','toLocaleString','post','$products','153386HQHrhW','/Rooms_data2','$_id.product','3199330YXeBCk','Enabled','$_id.type','Hindi','$product_details.product_stock','French','English','60780aMyDEZ','product','$count','$name','$product_code','timezones-list','en-US','161338OIPpSj','946hBWTPh','/MapData2','3bLtsUr','$production_date','render','/view','$_id.floorlevel','/staff_sales_id','$$product.product_quantity','$_id.bay','$product_details.floorlevel'];a0_0x53ef=function(){return _0x13a780;};return a0_0x53ef();}function a0_0x4f1a(_0x263839,_0x5a5fa6){const _0x53efc9=a0_0x53ef();return a0_0x4f1a=function(_0x4f1a53,_0x583c79){_0x4f1a53=_0x4f1a53-0x148;let _0x2e4289=_0x53efc9[_0x4f1a53];return _0x2e4289;},a0_0x4f1a(_0x263839,_0x5a5fa6);}const express=require(a0_0x40ceb4(0x17b)),app=express(),router=express['Router'](),multer=require(a0_0x40ceb4(0x149)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x40ceb4(0x186)),auth=require('../middleware/auth');var timezones=require(a0_0x40ceb4(0x167));const users=require('../public/language/languages.json');router['get'](a0_0x40ceb4(0x16f),auth,async(_0x50cb3c,_0x4bad52)=>{const _0x38b261=a0_0x40ceb4;try{const {username:_0x2def8a,email:_0x5245b6,role:_0x3af348}=_0x50cb3c[_0x38b261(0x197)],_0x5214ed=_0x50cb3c[_0x38b261(0x197)],_0x4fa183=await profile[_0x38b261(0x177)]({'email':_0x5214ed[_0x38b261(0x18a)]}),_0x284ed8=await master_shop['find']();let _0x440d64;if(_0x5214ed[_0x38b261(0x198)]=='staff'){const _0x4d1937=await staff['findOne']({'email':_0x5214ed[_0x38b261(0x18a)]});_0x440d64=await warehouse[_0x38b261(0x190)]([{'$match':{'status':_0x38b261(0x15c),'name':_0x4d1937['warehouse']}},{'$group':{'_id':'$name','name':{'$first':_0x38b261(0x165)}}},{'$sort':{'name':-0x1}}]);}else _0x440d64=await warehouse[_0x38b261(0x190)]([{'$match':{'status':_0x38b261(0x15c)}},{'$group':{'_id':_0x38b261(0x165),'name':{'$first':_0x38b261(0x165)}}},{'$sort':{'name':-0x1}}]);const _0x29f13c=new Date()[_0x38b261(0x155)](_0x38b261(0x168),{'timeZone':_0x284ed8[0x0][_0x38b261(0x19d)]});if(_0x284ed8[0x0][_0x38b261(0x17f)]=='English\x20(US)')var _0x202c3b=users[_0x38b261(0x161)];else{if(_0x284ed8[0x0]['language']=='Hindi')var _0x202c3b=users[_0x38b261(0x15e)];else{if(_0x284ed8[0x0]['language']=='German')var _0x202c3b=users[_0x38b261(0x18b)];else{if(_0x284ed8[0x0][_0x38b261(0x17f)]==_0x38b261(0x18d))var _0x202c3b=users[_0x38b261(0x18d)];else{if(_0x284ed8[0x0]['language']=='French')var _0x202c3b=users[_0x38b261(0x160)];else{if(_0x284ed8[0x0][_0x38b261(0x17f)]=='Portuguese\x20(BR)')var _0x202c3b=users[_0x38b261(0x19c)];else{if(_0x284ed8[0x0][_0x38b261(0x17f)]=='Chinese')var _0x202c3b=users[_0x38b261(0x193)];else{if(_0x284ed8[0x0][_0x38b261(0x17f)]==_0x38b261(0x185))var _0x202c3b=users[_0x38b261(0x151)];}}}}}}}_0x4bad52[_0x38b261(0x16e)](_0x38b261(0x14f),{'success':_0x50cb3c[_0x38b261(0x184)](_0x38b261(0x195)),'errors':_0x50cb3c[_0x38b261(0x184)](_0x38b261(0x179)),'role':_0x5214ed,'profile':_0x4fa183,'master_shop':_0x284ed8,'timezones':timezones,'language':_0x202c3b,'warehouse':_0x440d64});}catch(_0x3e02cb){console[_0x38b261(0x196)](_0x3e02cb),_0x4bad52[_0x38b261(0x17c)](0xc8)[_0x38b261(0x199)]({'message':_0x3e02cb[_0x38b261(0x187)]});}}),router['post'](a0_0x40ceb4(0x14a),async(_0x3b738a,_0x46a248)=>{const _0x5dc456=a0_0x40ceb4,{warehouseNew:_0x209d27,rooms:_0x427e78,Type:_0x30c029}=_0x3b738a['body'],_0x1b36f0=await warehouse[_0x5dc456(0x190)]([{'$unwind':_0x5dc456(0x191)},{'$match':{'name':_0x209d27,'room':_0x427e78,'product_details.type':_0x30c029}},{'$group':{'_id':{'bay':_0x5dc456(0x189),'bin':_0x5dc456(0x175),'type':_0x5dc456(0x183),'floorlevel':_0x5dc456(0x174)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x5dc456(0x15f),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x5dc456(0x15f),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','bin':'$_id.bin','type':'$_id.type','floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x5dc456(0x157),'as':'product','cond':{'$gt':[_0x5dc456(0x172),0x0]}}},'totalQuantity':0x1}}]);_0x46a248[_0x5dc456(0x199)](_0x1b36f0);}),router[a0_0x40ceb4(0x156)](a0_0x40ceb4(0x16b),async(_0xd1d75c,_0x2f3a6b)=>{const _0x96a5a8=a0_0x40ceb4,{warehouseNew:_0x3f8333,rooms:_0x367320,room_cat:_0x12b3ee}=_0xd1d75c['body'];let _0xc315a6;if(_0x12b3ee==_0x96a5a8(0x178))_0xc315a6=await warehouse[_0x96a5a8(0x190)]([{'$unwind':_0x96a5a8(0x191)},{'$match':{'name':_0x3f8333}},{'$group':{'_id':{'bay':_0x96a5a8(0x189),'product':'$product_details.product_name','expiry':_0x96a5a8(0x154)},'count':{'$sum':'$product_details.product_stock'},'production_date':{'$first':'$product_details.production_date'},'expiry_date':{'$first':_0x96a5a8(0x154)},'batch_code':{'$first':_0x96a5a8(0x14c)},'product_code':{'$first':_0x96a5a8(0x14d)}}},{'$group':{'_id':'$_id.bay','products':{'$push':{'product':_0x96a5a8(0x15a),'quantity':_0x96a5a8(0x164),'production_date':_0x96a5a8(0x16d),'expiry_date':'$expiry_date','batch_code':'$batch_code','product_code':_0x96a5a8(0x166)}},'totalQuantity':{'$sum':_0x96a5a8(0x164)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x96a5a8(0x17e),'products':0x1,'totalQuantity':0x1}}]),console[_0x96a5a8(0x196)](_0x12b3ee);else{}_0x2f3a6b[_0x96a5a8(0x199)](_0xc315a6);}),router[a0_0x40ceb4(0x156)]('/Rooms_data',async(_0x22ecfd,_0x5e0a9c)=>{const _0x445b5a=a0_0x40ceb4;try{const {warehouse_name:_0x8bf0c4}=_0x22ecfd[_0x445b5a(0x19a)];var _0x1e0272='';_0x1e0272=[{'$match':{'name':_0x8bf0c4,'status':_0x445b5a(0x15c)}},{'$group':{'_id':_0x445b5a(0x17e),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}];const _0x47657d=await warehouse['aggregate'](_0x1e0272);_0x5e0a9c[_0x445b5a(0x17c)](0xc8)[_0x445b5a(0x199)](_0x47657d);}catch(_0x1421e2){_0x5e0a9c[_0x445b5a(0x17c)](0x190)[_0x445b5a(0x199)]({'errorMessage':_0x1421e2[_0x445b5a(0x187)]});}}),router[a0_0x40ceb4(0x156)](a0_0x40ceb4(0x159),async(_0x3cce4b,_0x26a6aa)=>{const _0xda7e9c=a0_0x40ceb4;try{const {warehouse_name:_0x4514cf,cat:_0x402c01,valNew:_0x42c0f9}=_0x3cce4b[_0xda7e9c(0x19a)];var _0x940c35='',_0x21d59f='';if(_0x402c01=='Raw\x20Materials')_0x940c35=_0xda7e9c(0x18e),_0x42c0f9==_0xda7e9c(0x19e)?_0x21d59f=[{'$match':{'status':'Enabled','warehouse_category':_0x402c01,'name':{'$ne':_0x940c35},'name':'DRY\x20STORAGE'}},{'$group':{'_id':_0xda7e9c(0x165),'room_name':{'$first':_0xda7e9c(0x165)}}},{'$sort':{'room_name':0x1}}]:_0x21d59f=[{'$match':{'status':_0xda7e9c(0x15c),'warehouse_category':_0x402c01,'name':{'$ne':_0x940c35}}},{'$group':{'_id':_0xda7e9c(0x165),'room_name':{'$first':_0xda7e9c(0x165)}}},{'$sort':{'room_name':0x1}}];else _0x402c01==_0xda7e9c(0x18c)?(_0x940c35=_0xda7e9c(0x14e),_0x21d59f=[{'$match':{'status':_0xda7e9c(0x15c),'warehouse_category':_0x402c01,'name':{'$ne':_0x940c35}}},{'$group':{'_id':'$name','room_name':{'$first':_0xda7e9c(0x165)}}},{'$sort':{'room_name':0x1}}]):_0x21d59f=[{'$match':{'status':_0xda7e9c(0x15c)}},{'$group':{'_id':_0xda7e9c(0x165),'room_name':{'$first':_0xda7e9c(0x165)}}},{'$sort':{'room_name':0x1}}];const _0xc35980=await warehouse[_0xda7e9c(0x190)](_0x21d59f);_0x26a6aa['status'](0xc8)[_0xda7e9c(0x199)](_0xc35980);}catch(_0x588ec8){_0x26a6aa[_0xda7e9c(0x17c)](0x190)[_0xda7e9c(0x199)]({'errorMessage':_0x588ec8[_0xda7e9c(0x187)]}),console[_0xda7e9c(0x196)](_0x588ec8);}}),router[a0_0x40ceb4(0x156)](a0_0x40ceb4(0x192),async(_0x2c13f9,_0x404c74)=>{const _0x2b7187=a0_0x40ceb4;try{const {warehouse_name:_0x22595b,cat:_0x421e17}=_0x2c13f9['body'],_0x13105d=await warehouse[_0x2b7187(0x190)]([{'$match':{'status':_0x2b7187(0x15c),'warehouse_category':_0x421e17,'name':_0x22595b}},{'$group':{'_id':_0x2b7187(0x194),'room_name':{'$first':_0x2b7187(0x194)}}},{'$sort':{'room_name':0x1}}]);_0x404c74[_0x2b7187(0x17c)](0xc8)[_0x2b7187(0x199)](_0x13105d);}catch(_0x1f1188){_0x404c74[_0x2b7187(0x17c)](0x190)[_0x2b7187(0x199)]({'errorMessage':_0x1f1188[_0x2b7187(0x187)]});}}),router['post'](a0_0x40ceb4(0x181),async(_0x293ad5,_0x5a60e8)=>{const _0x268d63=a0_0x40ceb4;try{const {typeofsales:_0xeecb10}=_0x293ad5[_0x268d63(0x19a)],_0x5383b3=await staff['find']({'account_category':'sa','type_of_acc_cat':_0xeecb10});_0x5a60e8['status'](0xc8)[_0x268d63(0x199)](_0x5383b3);}catch(_0x27df17){_0x5a60e8[_0x268d63(0x17c)](0x190)[_0x268d63(0x199)]({'errorMessage':_0x27df17[_0x268d63(0x187)]});}}),router['post'](a0_0x40ceb4(0x171),async(_0xf49f6b,_0x1e04a7)=>{const _0x351f81=a0_0x40ceb4;try{const {id:_0x11531c}=_0xf49f6b['body'],_0x1a44d8=await staff[_0x351f81(0x150)]({'_id':_0x11531c});_0x1e04a7['status'](0xc8)['json'](_0x1a44d8);}catch(_0x228c24){_0x1e04a7[_0x351f81(0x17c)](0x190)[_0x351f81(0x199)]({'errorMessage':_0x228c24[_0x351f81(0x187)]});}}),router[a0_0x40ceb4(0x156)](a0_0x40ceb4(0x19b),async(_0x425549,_0x43627b)=>{const _0x49115c=a0_0x40ceb4;try{const {warehouse_name:_0x140597,room_value:_0x39acf5}=_0x425549[_0x49115c(0x19a)];let _0x313a91;_0x39acf5==_0x49115c(0x17a)?_0x313a91=await warehouse[_0x49115c(0x190)]([{'$unwind':'$product_details'},{'$match':{'name':_0x140597}},{'$group':{'_id':{'bay':_0x49115c(0x189),'level':_0x49115c(0x14b),'type':'$product_details.type','floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x49115c(0x17d),'product_quantity':_0x49115c(0x15f),'product_code':_0x49115c(0x14d)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x49115c(0x15f),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x49115c(0x173),'level':_0x49115c(0x176),'type':_0x49115c(0x15d),'floorlevel':_0x49115c(0x170),'products':{'$filter':{'input':'$products','as':_0x49115c(0x163),'cond':{'$gt':[_0x49115c(0x172),0x0]}}},'totalQuantity':0x1}}]):_0x313a91=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'name':_0x140597,'room':_0x39acf5}},{'$group':{'_id':{'bay':'$product_details.bay','level':_0x49115c(0x14b),'type':_0x49115c(0x183),'floorlevel':_0x49115c(0x174)},'products':{'$push':{'product_name':_0x49115c(0x17d),'product_quantity':_0x49115c(0x15f),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x49115c(0x15f),0x0]},'then':_0x49115c(0x15f),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x49115c(0x173),'level':'$_id.level','type':_0x49115c(0x15d),'floorlevel':_0x49115c(0x170),'products':{'$filter':{'input':_0x49115c(0x157),'as':'product','cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]),_0x43627b[_0x49115c(0x17c)](0xc8)[_0x49115c(0x199)](_0x313a91);}catch(_0x103a05){_0x43627b[_0x49115c(0x17c)](0x190)[_0x49115c(0x199)]({'errorMessage':_0x103a05[_0x49115c(0x187)]});}}),module[a0_0x40ceb4(0x18f)]=router;