const a0_0x29fe94=a0_0x5418;function a0_0x5418(_0x12d796,_0x1a77de){const _0x5e2b81=a0_0x5e2b();return a0_0x5418=function(_0x541814,_0x2ffbeb){_0x541814=_0x541814-0x19a;let _0x5ae898=_0x5e2b81[_0x541814];return _0x5ae898;},a0_0x5418(_0x12d796,_0x1a77de);}(function(_0x39f3f5,_0x1b4559){const _0x4a632e=a0_0x5418,_0x16e05b=_0x39f3f5();while(!![]){try{const _0x13df39=-parseInt(_0x4a632e(0x1a4))/0x1*(-parseInt(_0x4a632e(0x19e))/0x2)+parseInt(_0x4a632e(0x1aa))/0x3*(-parseInt(_0x4a632e(0x1e8))/0x4)+parseInt(_0x4a632e(0x1b8))/0x5*(parseInt(_0x4a632e(0x1bc))/0x6)+parseInt(_0x4a632e(0x1ab))/0x7+parseInt(_0x4a632e(0x1c5))/0x8*(-parseInt(_0x4a632e(0x1bb))/0x9)+-parseInt(_0x4a632e(0x1be))/0xa*(parseInt(_0x4a632e(0x1a2))/0xb)+-parseInt(_0x4a632e(0x1b1))/0xc*(-parseInt(_0x4a632e(0x1c2))/0xd);if(_0x13df39===_0x1b4559)break;else _0x16e05b['push'](_0x16e05b['shift']());}catch(_0x58796f){_0x16e05b['push'](_0x16e05b['shift']());}}}(a0_0x5e2b,0xa0f35));const express=require(a0_0x29fe94(0x1eb)),app=express(),router=express['Router'](),multer=require(a0_0x29fe94(0x1ba)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require(a0_0x29fe94(0x1a6));var timezones=require(a0_0x29fe94(0x1b5));const users=require('../public/language/languages.json');router[a0_0x29fe94(0x19b)](a0_0x29fe94(0x1b9),auth,async(_0x93071f,_0x1b895b)=>{const _0x5522e8=a0_0x29fe94;try{const {username:_0x87a735,email:_0x11abb0,role:_0x3b689}=_0x93071f[_0x5522e8(0x1c0)],_0x27bfb=_0x93071f[_0x5522e8(0x1c0)],_0x5ef124=await profile['findOne']({'email':_0x27bfb[_0x5522e8(0x1a1)]}),_0x5db79e=await master_shop[_0x5522e8(0x19a)]();let _0xbc0d34;if(_0x27bfb['role']==_0x5522e8(0x1e2)){const _0x5eb652=await staff[_0x5522e8(0x1e4)]({'email':_0x27bfb[_0x5522e8(0x1a1)]});_0xbc0d34=await warehouse[_0x5522e8(0x1ad)]([{'$match':{'status':_0x5522e8(0x1e6),'name':_0x5eb652[_0x5522e8(0x1dc)]}},{'$group':{'_id':_0x5522e8(0x1e7),'name':{'$first':_0x5522e8(0x1e7)}}},{'$sort':{'name':-0x1}}]);}else _0xbc0d34=await warehouse[_0x5522e8(0x1ad)]([{'$match':{'status':_0x5522e8(0x1e6)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':-0x1}}]);const _0x103482=new Date()[_0x5522e8(0x1d3)](_0x5522e8(0x1d4),{'timeZone':_0x5db79e[0x0][_0x5522e8(0x1e5)]});if(_0x5db79e[0x0][_0x5522e8(0x1ca)]=='English\x20(US)')var _0x1c87a6=users[_0x5522e8(0x1a3)];else{if(_0x5db79e[0x0][_0x5522e8(0x1ca)]=='Hindi')var _0x1c87a6=users['Hindi'];else{if(_0x5db79e[0x0][_0x5522e8(0x1ca)]=='German')var _0x1c87a6=users[_0x5522e8(0x1d1)];else{if(_0x5db79e[0x0][_0x5522e8(0x1ca)]==_0x5522e8(0x1d7))var _0x1c87a6=users[_0x5522e8(0x1d7)];else{if(_0x5db79e[0x0][_0x5522e8(0x1ca)]==_0x5522e8(0x1ac))var _0x1c87a6=users[_0x5522e8(0x1ac)];else{if(_0x5db79e[0x0][_0x5522e8(0x1ca)]=='Portuguese\x20(BR)')var _0x1c87a6=users[_0x5522e8(0x1d2)];else{if(_0x5db79e[0x0][_0x5522e8(0x1ca)]==_0x5522e8(0x19c))var _0x1c87a6=users['Chinese'];else{if(_0x5db79e[0x0][_0x5522e8(0x1ca)]==_0x5522e8(0x1a9))var _0x1c87a6=users[_0x5522e8(0x1a8)];}}}}}}}_0x1b895b[_0x5522e8(0x1f1)](_0x5522e8(0x1b4),{'success':_0x93071f[_0x5522e8(0x1ef)](_0x5522e8(0x1cd)),'errors':_0x93071f[_0x5522e8(0x1ef)](_0x5522e8(0x19f)),'role':_0x27bfb,'profile':_0x5ef124,'master_shop':_0x5db79e,'timezones':timezones,'language':_0x1c87a6,'warehouse':_0xbc0d34});}catch(_0x49b0eb){console[_0x5522e8(0x1c3)](_0x49b0eb),_0x1b895b[_0x5522e8(0x1de)](0xc8)[_0x5522e8(0x1c8)]({'message':_0x49b0eb['message']});}}),router['post'](a0_0x29fe94(0x1b3),async(_0x3bef25,_0x301cd3)=>{const _0x2baff8=a0_0x29fe94,{warehouseNew:_0xfb5870,rooms:_0xd14451,Type:_0x3573d1}=_0x3bef25['body'],_0x13097f=await warehouse[_0x2baff8(0x1ad)]([{'$unwind':'$product_details'},{'$match':{'name':_0xfb5870,'room':_0xd14451,'product_details.type':_0x3573d1}},{'$group':{'_id':{'bay':'$product_details.bay','bin':'$product_details.bin','type':_0x2baff8(0x1d9),'floorlevel':_0x2baff8(0x1db)},'products':{'$push':{'product_name':_0x2baff8(0x1e9),'product_quantity':_0x2baff8(0x1ce),'product_code':_0x2baff8(0x1b7)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':_0x2baff8(0x1ce),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x2baff8(0x1e1),'bin':_0x2baff8(0x1d5),'type':_0x2baff8(0x1bd),'floorlevel':_0x2baff8(0x1ea),'products':{'$filter':{'input':_0x2baff8(0x19d),'as':'product','cond':{'$gt':[_0x2baff8(0x1cb),0x0]}}},'totalQuantity':0x1}}]);_0x301cd3[_0x2baff8(0x1c8)](_0x13097f);}),router['post']('/MapData2',async(_0x3cf4c9,_0x1fd91f)=>{const _0x56e2dd=a0_0x29fe94,{warehouseNew:_0x521570,rooms:_0x21395c,room_cat:_0x299cb4}=_0x3cf4c9['body'];let _0x32b783;if(_0x299cb4=='All')_0x32b783=await warehouse[_0x56e2dd(0x1ad)]([{'$unwind':_0x56e2dd(0x1e0)},{'$match':{'name':_0x521570}},{'$group':{'_id':{'bay':_0x56e2dd(0x1b6),'product':'$product_details.product_name','expiry':_0x56e2dd(0x1bf)},'count':{'$sum':_0x56e2dd(0x1ce)},'production_date':{'$first':_0x56e2dd(0x1cc)},'expiry_date':{'$first':_0x56e2dd(0x1bf)},'batch_code':{'$first':_0x56e2dd(0x1dd)},'product_code':{'$first':_0x56e2dd(0x1b7)}}},{'$group':{'_id':'$_id.bay','products':{'$push':{'product':_0x56e2dd(0x1ec),'quantity':_0x56e2dd(0x1da),'production_date':_0x56e2dd(0x1b0),'expiry_date':_0x56e2dd(0x1c7),'batch_code':_0x56e2dd(0x1ae),'product_code':'$product_code'}},'totalQuantity':{'$sum':_0x56e2dd(0x1da)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console['log'](_0x299cb4);else{}_0x1fd91f[_0x56e2dd(0x1c8)](_0x32b783);}),router['post'](a0_0x29fe94(0x1e3),async(_0x100fdd,_0x119e55)=>{const _0x45ed24=a0_0x29fe94;try{const {warehouse_name:_0x3ddd44}=_0x100fdd['body'];var _0x40d809='';_0x40d809=[{'$match':{'name':_0x3ddd44,'status':'Enabled'}},{'$group':{'_id':'$_id','room_name':{'$first':_0x45ed24(0x1c9)}}},{'$sort':{'room_name':0x1}}];const _0x19d06c=await warehouse[_0x45ed24(0x1ad)](_0x40d809);_0x119e55[_0x45ed24(0x1de)](0xc8)[_0x45ed24(0x1c8)](_0x19d06c);}catch(_0x1ddac0){_0x119e55[_0x45ed24(0x1de)](0x190)[_0x45ed24(0x1c8)]({'errorMessage':_0x1ddac0['message']});}}),router[a0_0x29fe94(0x1a7)]('/Rooms_data2',async(_0x223488,_0x5e98bf)=>{const _0xc893ef=a0_0x29fe94;try{const {warehouse_name:_0x3d1146,cat:_0x3024b9,valNew:_0x58c94b}=_0x223488[_0xc893ef(0x1d6)];var _0x569ad6='',_0x38525c='';if(_0x3024b9=='Raw\x20Materials')_0x569ad6=_0xc893ef(0x1ed),_0x58c94b=='pack'?_0x38525c=[{'$match':{'status':'Enabled','warehouse_category':_0x3024b9,'name':{'$ne':_0x569ad6},'name':_0xc893ef(0x1c1)}},{'$group':{'_id':_0xc893ef(0x1e7),'room_name':{'$first':_0xc893ef(0x1e7)}}},{'$sort':{'room_name':0x1}}]:_0x38525c=[{'$match':{'status':_0xc893ef(0x1e6),'warehouse_category':_0x3024b9,'name':{'$ne':_0x569ad6}}},{'$group':{'_id':_0xc893ef(0x1e7),'room_name':{'$first':_0xc893ef(0x1e7)}}},{'$sort':{'room_name':0x1}}];else _0x3024b9==_0xc893ef(0x1a5)?(_0x569ad6=_0xc893ef(0x1b2),_0x38525c=[{'$match':{'status':_0xc893ef(0x1e6),'warehouse_category':_0x3024b9,'name':{'$ne':_0x569ad6}}},{'$group':{'_id':_0xc893ef(0x1e7),'room_name':{'$first':_0xc893ef(0x1e7)}}},{'$sort':{'room_name':0x1}}]):_0x38525c=[{'$match':{'status':_0xc893ef(0x1e6)}},{'$group':{'_id':_0xc893ef(0x1e7),'room_name':{'$first':_0xc893ef(0x1e7)}}},{'$sort':{'room_name':0x1}}];const _0xaa0eb5=await warehouse[_0xc893ef(0x1ad)](_0x38525c);_0x5e98bf[_0xc893ef(0x1de)](0xc8)[_0xc893ef(0x1c8)](_0xaa0eb5);}catch(_0x3160d4){_0x5e98bf['status'](0x190)[_0xc893ef(0x1c8)]({'errorMessage':_0x3160d4['message']}),console[_0xc893ef(0x1c3)](_0x3160d4);}}),router[a0_0x29fe94(0x1a7)](a0_0x29fe94(0x1c4),async(_0x383988,_0x1ebfe5)=>{const _0x3ad36a=a0_0x29fe94;try{const {warehouse_name:_0x14f8a6,cat:_0x61f90e}=_0x383988[_0x3ad36a(0x1d6)],_0x27dfd2=await warehouse['aggregate']([{'$match':{'status':_0x3ad36a(0x1e6),'warehouse_category':_0x61f90e,'name':_0x14f8a6}},{'$group':{'_id':_0x3ad36a(0x1c9),'room_name':{'$first':_0x3ad36a(0x1c9)}}},{'$sort':{'room_name':0x1}}]);_0x1ebfe5[_0x3ad36a(0x1de)](0xc8)[_0x3ad36a(0x1c8)](_0x27dfd2);}catch(_0xe26ea1){_0x1ebfe5[_0x3ad36a(0x1de)](0x190)['json']({'errorMessage':_0xe26ea1[_0x3ad36a(0x1d8)]});}}),router[a0_0x29fe94(0x1a7)](a0_0x29fe94(0x1af),async(_0x1ee1a8,_0x2883e9)=>{const _0x636a5a=a0_0x29fe94;try{const {typeofsales:_0x26e1d0}=_0x1ee1a8[_0x636a5a(0x1d6)],_0x21880f=await staff['find']({'account_category':'sa','type_of_acc_cat':_0x26e1d0});_0x2883e9['status'](0xc8)['json'](_0x21880f);}catch(_0x5354fb){_0x2883e9[_0x636a5a(0x1de)](0x190)[_0x636a5a(0x1c8)]({'errorMessage':_0x5354fb['message']});}}),router['post'](a0_0x29fe94(0x1cf),async(_0x315967,_0x4c8101)=>{const _0x28e31d=a0_0x29fe94;try{const {id:_0x39d8a2}=_0x315967[_0x28e31d(0x1d6)],_0x1bccbd=await staff[_0x28e31d(0x19a)]({'_id':_0x39d8a2});_0x4c8101[_0x28e31d(0x1de)](0xc8)[_0x28e31d(0x1c8)](_0x1bccbd);}catch(_0x4828b3){_0x4c8101[_0x28e31d(0x1de)](0x190)[_0x28e31d(0x1c8)]({'errorMessage':_0x4828b3[_0x28e31d(0x1d8)]});}}),router[a0_0x29fe94(0x1a7)](a0_0x29fe94(0x1a0),async(_0x439b51,_0x51e2e5)=>{const _0x480904=a0_0x29fe94;try{const {warehouse_name:_0x4104fa,room_value:_0x1dba0d}=_0x439b51[_0x480904(0x1d6)];let _0x1248a8;_0x1dba0d==_0x480904(0x1c6)?_0x1248a8=await warehouse[_0x480904(0x1ad)]([{'$unwind':_0x480904(0x1e0)},{'$match':{'name':_0x4104fa}},{'$group':{'_id':{'bay':_0x480904(0x1b6),'level':'$product_details.level','type':_0x480904(0x1d9),'floorlevel':_0x480904(0x1db)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x480904(0x1ce),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x480904(0x1ce),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x480904(0x1e1),'level':'$_id.level','type':_0x480904(0x1bd),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x480904(0x19d),'as':'product','cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]):_0x1248a8=await warehouse[_0x480904(0x1ad)]([{'$unwind':_0x480904(0x1e0)},{'$match':{'name':_0x4104fa,'room':_0x1dba0d}},{'$group':{'_id':{'bay':_0x480904(0x1b6),'level':_0x480904(0x1f0),'type':_0x480904(0x1d9),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x480904(0x1e9),'product_quantity':_0x480904(0x1ce),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x480904(0x1ce),0x0]},'then':_0x480904(0x1ce),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x480904(0x1e1),'level':_0x480904(0x1ee),'type':'$_id.type','floorlevel':_0x480904(0x1ea),'products':{'$filter':{'input':_0x480904(0x19d),'as':_0x480904(0x1d0),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]),_0x51e2e5[_0x480904(0x1de)](0xc8)[_0x480904(0x1c8)](_0x1248a8);}catch(_0x2b7311){_0x51e2e5[_0x480904(0x1de)](0x190)[_0x480904(0x1c8)]({'errorMessage':_0x2b7311[_0x480904(0x1d8)]});}}),module[a0_0x29fe94(0x1df)]=router;function a0_0x5e2b(){const _0x3054de=['/Rooms_data3','8CSNGVH','all','$expiry_date','json','$room','language','$$product.product_quantity','$product_details.production_date','success','$product_details.product_stock','/staff_sales_id','product','German','Portuguese','toLocaleString','en-US','$_id.bin','body','Spanish','message','$product_details.type','$count','$product_details.floorlevel','warehouse','$product_details.batch_code','status','exports','$product_details','$_id.bay','staff','/Rooms_data','findOne','timezone','Enabled','$name','55512DCZypz','$product_details.product_name','$_id.floorlevel','express','$_id.product','Return\x20Goods','$_id.level','flash','$product_details.level','render','find','get','Chinese','$products','47782zppGjn','errors','/map_value','email','1331hqouxz','English','43AlHMiX','Finished\x20Goods','../middleware/auth','post','Arabic','Arabic\x20(ae)','222YCQxBf','1265201iCDnVD','French','aggregate','$batch_code','/staff_sales','$production_date','1284ejyrgh','QA\x20Warehouse','/MapData','warehousemap_incoming','timezones-list','$product_details.bay','$product_details.product_code','16180pnqsSQ','/view','multer','11601261QsWtfr','1614HcUJPS','$_id.type','46430mSdAMx','$product_details.expiry_date','user','DRY\x20STORAGE','177203QcHjiQ','log'];a0_0x5e2b=function(){return _0x3054de;};return a0_0x5e2b();}