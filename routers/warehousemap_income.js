const a0_0x4c92d7=a0_0x2de7;function a0_0x115d(){const _0x19917c=['Raw\x20Materials','$_id.bin','/MapData2','Return\x20Goods','status','German','$count','French','/Rooms_data3','DRY\x20STORAGE','staff','express','$products','/staff_sales_id','1498383iKqspQ','/map_value','findOne','$product_details.product_stock','flash','../middleware/auth','errors','$_id','render','post','$_id.floorlevel','2746prnPLP','Arabic','$product_code','Router','All','8oLubOZ','English\x20(US)','timezone','$production_date','Spanish','aggregate','log','$product_details.bay','Chinese','$product_details','90MnUoWt','user','$product_details.product_code','213WoLqCi','$product_details.production_date','product','body','../public/language/languages.json','toLocaleString','../models/all_models','/view','652113ruSOQt','$_id.type','en-US','Hindi','language','$_id.level','$product_details.expiry_date','$_id.bay','get','$product_details.type','pack','$batch_code','all','timezones-list','json','Finished\x20Goods','Enabled','/Rooms_data','$product_details.bin','$product_details.batch_code','$room','/Rooms_data2','$expiry_date','482286LyiZKw','warehousemap_incoming','QA\x20Warehouse','Arabic\x20(ae)','100472sKjOhR','20lLqfvq','$$product.product_quantity','message','$product_details.product_name','find','warehouse','$product_details.floorlevel','$name','2293683TbMihu','$_id.product','/MapData','email','305408XWBfAb'];a0_0x115d=function(){return _0x19917c;};return a0_0x115d();}function a0_0x2de7(_0x1c7756,_0x47d6f2){const _0x115d80=a0_0x115d();return a0_0x2de7=function(_0x2de7db,_0x134d37){_0x2de7db=_0x2de7db-0x110;let _0x54c12e=_0x115d80[_0x2de7db];return _0x54c12e;},a0_0x2de7(_0x1c7756,_0x47d6f2);}(function(_0x1413da,_0x42a7a6){const _0x52f61d=a0_0x2de7,_0x31401d=_0x1413da();while(!![]){try{const _0x2e1379=parseInt(_0x52f61d(0x15e))/0x1+-parseInt(_0x52f61d(0x11c))/0x2*(parseInt(_0x52f61d(0x12e))/0x3)+parseInt(_0x52f61d(0x151))/0x4+-parseInt(_0x52f61d(0x152))/0x5*(-parseInt(_0x52f61d(0x14d))/0x6)+parseInt(_0x52f61d(0x15a))/0x7+-parseInt(_0x52f61d(0x121))/0x8*(parseInt(_0x52f61d(0x111))/0x9)+-parseInt(_0x52f61d(0x12b))/0xa*(parseInt(_0x52f61d(0x136))/0xb);if(_0x2e1379===_0x42a7a6)break;else _0x31401d['push'](_0x31401d['shift']());}catch(_0xfb5a9c){_0x31401d['push'](_0x31401d['shift']());}}}(a0_0x115d,0x2c7ba));const express=require(a0_0x4c92d7(0x16a)),app=express(),router=express[a0_0x4c92d7(0x11f)](),multer=require('multer'),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x4c92d7(0x134)),auth=require(a0_0x4c92d7(0x116));var timezones=require(a0_0x4c92d7(0x143));const users=require(a0_0x4c92d7(0x132));router[a0_0x4c92d7(0x13e)](a0_0x4c92d7(0x135),auth,async(_0xb577f2,_0x1936bd)=>{const _0x5443a5=a0_0x4c92d7;try{const {username:_0x5278f7,email:_0x318c66,role:_0x1d0a67}=_0xb577f2[_0x5443a5(0x12c)],_0x33672a=_0xb577f2[_0x5443a5(0x12c)],_0x39cd4d=await profile['findOne']({'email':_0x33672a[_0x5443a5(0x15d)]}),_0x551708=await master_shop['find']();let _0x30b841;if(_0x33672a['role']==_0x5443a5(0x169)){const _0x22c121=await staff[_0x5443a5(0x113)]({'email':_0x33672a[_0x5443a5(0x15d)]});_0x30b841=await warehouse[_0x5443a5(0x126)]([{'$match':{'status':'Enabled','name':_0x22c121[_0x5443a5(0x157)]}},{'$group':{'_id':_0x5443a5(0x159),'name':{'$first':_0x5443a5(0x159)}}},{'$sort':{'name':-0x1}}]);}else _0x30b841=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x5443a5(0x159),'name':{'$first':_0x5443a5(0x159)}}},{'$sort':{'name':-0x1}}]);const _0x4df85a=new Date()[_0x5443a5(0x133)](_0x5443a5(0x138),{'timeZone':_0x551708[0x0][_0x5443a5(0x123)]});if(_0x551708[0x0]['language']==_0x5443a5(0x122))var _0x2f2031=users['English'];else{if(_0x551708[0x0][_0x5443a5(0x13a)]=='Hindi')var _0x2f2031=users[_0x5443a5(0x139)];else{if(_0x551708[0x0][_0x5443a5(0x13a)]=='German')var _0x2f2031=users[_0x5443a5(0x164)];else{if(_0x551708[0x0]['language']==_0x5443a5(0x125))var _0x2f2031=users[_0x5443a5(0x125)];else{if(_0x551708[0x0][_0x5443a5(0x13a)]==_0x5443a5(0x166))var _0x2f2031=users[_0x5443a5(0x166)];else{if(_0x551708[0x0][_0x5443a5(0x13a)]=='Portuguese\x20(BR)')var _0x2f2031=users['Portuguese'];else{if(_0x551708[0x0]['language']==_0x5443a5(0x129))var _0x2f2031=users[_0x5443a5(0x129)];else{if(_0x551708[0x0][_0x5443a5(0x13a)]==_0x5443a5(0x150))var _0x2f2031=users[_0x5443a5(0x11d)];}}}}}}}_0x1936bd[_0x5443a5(0x119)](_0x5443a5(0x14e),{'success':_0xb577f2['flash']('success'),'errors':_0xb577f2[_0x5443a5(0x115)](_0x5443a5(0x117)),'role':_0x33672a,'profile':_0x39cd4d,'master_shop':_0x551708,'timezones':timezones,'language':_0x2f2031,'warehouse':_0x30b841});}catch(_0x1a787d){console[_0x5443a5(0x127)](_0x1a787d),_0x1936bd['status'](0xc8)[_0x5443a5(0x144)]({'message':_0x1a787d[_0x5443a5(0x154)]});}}),router['post'](a0_0x4c92d7(0x15c),async(_0x494ce8,_0x366fe8)=>{const _0x1938c1=a0_0x4c92d7,{warehouseNew:_0x10efdb,rooms:_0x532fcd,Type:_0xdba1ce}=_0x494ce8[_0x1938c1(0x131)],_0x23e1aa=await warehouse[_0x1938c1(0x126)]([{'$unwind':_0x1938c1(0x12a)},{'$match':{'name':_0x10efdb,'room':_0x532fcd,'product_details.type':_0xdba1ce}},{'$group':{'_id':{'bay':_0x1938c1(0x128),'bin':_0x1938c1(0x148),'type':_0x1938c1(0x13f),'floorlevel':_0x1938c1(0x158)},'products':{'$push':{'product_name':_0x1938c1(0x155),'product_quantity':'$product_details.product_stock','product_code':_0x1938c1(0x12d)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':_0x1938c1(0x114),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x1938c1(0x13d),'bin':_0x1938c1(0x160),'type':_0x1938c1(0x137),'floorlevel':_0x1938c1(0x11b),'products':{'$filter':{'input':_0x1938c1(0x16b),'as':_0x1938c1(0x130),'cond':{'$gt':[_0x1938c1(0x153),0x0]}}},'totalQuantity':0x1}}]);_0x366fe8[_0x1938c1(0x144)](_0x23e1aa);}),router['post'](a0_0x4c92d7(0x161),async(_0x4a3170,_0x444164)=>{const _0xf9996c=a0_0x4c92d7,{warehouseNew:_0xf44dcd,rooms:_0x1531f5,room_cat:_0x446a29}=_0x4a3170['body'];let _0x1dbe5e;if(_0x446a29==_0xf9996c(0x120))_0x1dbe5e=await warehouse[_0xf9996c(0x126)]([{'$unwind':_0xf9996c(0x12a)},{'$match':{'name':_0xf44dcd}},{'$group':{'_id':{'bay':_0xf9996c(0x128),'product':_0xf9996c(0x155),'expiry':'$product_details.expiry_date'},'count':{'$sum':_0xf9996c(0x114)},'production_date':{'$first':_0xf9996c(0x12f)},'expiry_date':{'$first':_0xf9996c(0x13c)},'batch_code':{'$first':_0xf9996c(0x149)},'product_code':{'$first':_0xf9996c(0x12d)}}},{'$group':{'_id':_0xf9996c(0x13d),'products':{'$push':{'product':_0xf9996c(0x15b),'quantity':_0xf9996c(0x165),'production_date':_0xf9996c(0x124),'expiry_date':_0xf9996c(0x14c),'batch_code':_0xf9996c(0x141),'product_code':_0xf9996c(0x11e)}},'totalQuantity':{'$sum':_0xf9996c(0x165)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0xf9996c(0x127)](_0x446a29);else{}_0x444164[_0xf9996c(0x144)](_0x1dbe5e);}),router['post'](a0_0x4c92d7(0x147),async(_0x4ae133,_0x20e94d)=>{const _0x2a0da9=a0_0x4c92d7;try{const {warehouse_name:_0x2d78d0}=_0x4ae133[_0x2a0da9(0x131)];var _0xb2620e='';_0xb2620e=[{'$match':{'name':_0x2d78d0,'status':_0x2a0da9(0x146)}},{'$group':{'_id':_0x2a0da9(0x118),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}];const _0x484500=await warehouse['aggregate'](_0xb2620e);_0x20e94d[_0x2a0da9(0x163)](0xc8)[_0x2a0da9(0x144)](_0x484500);}catch(_0x7e205){_0x20e94d[_0x2a0da9(0x163)](0x190)[_0x2a0da9(0x144)]({'errorMessage':_0x7e205[_0x2a0da9(0x154)]});}}),router['post'](a0_0x4c92d7(0x14b),async(_0x5f032c,_0x478ec4)=>{const _0xcc26f8=a0_0x4c92d7;try{const {warehouse_name:_0x41a3b3,cat:_0x3eb96a,valNew:_0x21d32a}=_0x5f032c[_0xcc26f8(0x131)];var _0x31e14d='',_0x2484f3='';if(_0x3eb96a==_0xcc26f8(0x15f))_0x31e14d=_0xcc26f8(0x162),_0x21d32a==_0xcc26f8(0x140)?_0x2484f3=[{'$match':{'status':_0xcc26f8(0x146),'warehouse_category':_0x3eb96a,'name':{'$ne':_0x31e14d},'name':_0xcc26f8(0x168)}},{'$group':{'_id':_0xcc26f8(0x159),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]:_0x2484f3=[{'$match':{'status':_0xcc26f8(0x146),'warehouse_category':_0x3eb96a,'name':{'$ne':_0x31e14d}}},{'$group':{'_id':_0xcc26f8(0x159),'room_name':{'$first':_0xcc26f8(0x159)}}},{'$sort':{'room_name':0x1}}];else _0x3eb96a==_0xcc26f8(0x145)?(_0x31e14d=_0xcc26f8(0x14f),_0x2484f3=[{'$match':{'status':'Enabled','warehouse_category':_0x3eb96a,'name':{'$ne':_0x31e14d}}},{'$group':{'_id':_0xcc26f8(0x159),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]):_0x2484f3=[{'$match':{'status':_0xcc26f8(0x146)}},{'$group':{'_id':_0xcc26f8(0x159),'room_name':{'$first':_0xcc26f8(0x159)}}},{'$sort':{'room_name':0x1}}];const _0x108de2=await warehouse['aggregate'](_0x2484f3);_0x478ec4[_0xcc26f8(0x163)](0xc8)[_0xcc26f8(0x144)](_0x108de2);}catch(_0x4fb203){_0x478ec4[_0xcc26f8(0x163)](0x190)[_0xcc26f8(0x144)]({'errorMessage':_0x4fb203[_0xcc26f8(0x154)]}),console[_0xcc26f8(0x127)](_0x4fb203);}}),router[a0_0x4c92d7(0x11a)](a0_0x4c92d7(0x167),async(_0x1a858f,_0x3e29fa)=>{const _0x5ad4e6=a0_0x4c92d7;try{const {warehouse_name:_0x3919c9,cat:_0x5b5022}=_0x1a858f[_0x5ad4e6(0x131)],_0xda3ed6=await warehouse[_0x5ad4e6(0x126)]([{'$match':{'status':_0x5ad4e6(0x146),'warehouse_category':_0x5b5022,'name':_0x3919c9}},{'$group':{'_id':_0x5ad4e6(0x14a),'room_name':{'$first':_0x5ad4e6(0x14a)}}},{'$sort':{'room_name':0x1}}]);_0x3e29fa[_0x5ad4e6(0x163)](0xc8)[_0x5ad4e6(0x144)](_0xda3ed6);}catch(_0x20ffad){_0x3e29fa['status'](0x190)[_0x5ad4e6(0x144)]({'errorMessage':_0x20ffad[_0x5ad4e6(0x154)]});}}),router[a0_0x4c92d7(0x11a)]('/staff_sales',async(_0x10758d,_0x31da1e)=>{const _0x27ecc3=a0_0x4c92d7;try{const {typeofsales:_0x5d08cb}=_0x10758d[_0x27ecc3(0x131)],_0x348ab5=await staff['find']({'account_category':'sa','type_of_acc_cat':_0x5d08cb});_0x31da1e[_0x27ecc3(0x163)](0xc8)[_0x27ecc3(0x144)](_0x348ab5);}catch(_0x2cb18b){_0x31da1e[_0x27ecc3(0x163)](0x190)[_0x27ecc3(0x144)]({'errorMessage':_0x2cb18b[_0x27ecc3(0x154)]});}}),router[a0_0x4c92d7(0x11a)](a0_0x4c92d7(0x110),async(_0x3a9434,_0x3bbf28)=>{const _0x2cb78a=a0_0x4c92d7;try{const {id:_0x1b1c11}=_0x3a9434[_0x2cb78a(0x131)],_0x3c421f=await staff[_0x2cb78a(0x156)]({'_id':_0x1b1c11});_0x3bbf28[_0x2cb78a(0x163)](0xc8)[_0x2cb78a(0x144)](_0x3c421f);}catch(_0x49a480){_0x3bbf28[_0x2cb78a(0x163)](0x190)[_0x2cb78a(0x144)]({'errorMessage':_0x49a480[_0x2cb78a(0x154)]});}}),router['post'](a0_0x4c92d7(0x112),async(_0x4e726c,_0x454902)=>{const _0x50e3cf=a0_0x4c92d7;try{const {warehouse_name:_0x124a10,room_value:_0xac705f}=_0x4e726c[_0x50e3cf(0x131)];let _0x2e3a80;_0xac705f==_0x50e3cf(0x142)?_0x2e3a80=await warehouse[_0x50e3cf(0x126)]([{'$unwind':'$product_details'},{'$match':{'name':_0x124a10}},{'$group':{'_id':{'bay':_0x50e3cf(0x128),'level':'$product_details.level','type':_0x50e3cf(0x13f),'floorlevel':_0x50e3cf(0x158)},'products':{'$push':{'product_name':_0x50e3cf(0x155),'product_quantity':_0x50e3cf(0x114),'product_code':_0x50e3cf(0x12d)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x50e3cf(0x114),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','level':_0x50e3cf(0x13b),'type':_0x50e3cf(0x137),'floorlevel':_0x50e3cf(0x11b),'products':{'$filter':{'input':_0x50e3cf(0x16b),'as':_0x50e3cf(0x130),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]):_0x2e3a80=await warehouse[_0x50e3cf(0x126)]([{'$unwind':_0x50e3cf(0x12a)},{'$match':{'name':_0x124a10,'room':_0xac705f}},{'$group':{'_id':{'bay':_0x50e3cf(0x128),'level':'$product_details.level','type':'$product_details.type','floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x50e3cf(0x155),'product_quantity':_0x50e3cf(0x114),'product_code':_0x50e3cf(0x12d)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x50e3cf(0x114),0x0]},'then':_0x50e3cf(0x114),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','level':_0x50e3cf(0x13b),'type':_0x50e3cf(0x137),'floorlevel':_0x50e3cf(0x11b),'products':{'$filter':{'input':'$products','as':_0x50e3cf(0x130),'cond':{'$gt':[_0x50e3cf(0x153),0x0]}}},'totalQuantity':0x1}}]),_0x454902['status'](0xc8)['json'](_0x2e3a80);}catch(_0x57b861){_0x454902[_0x50e3cf(0x163)](0x190)[_0x50e3cf(0x144)]({'errorMessage':_0x57b861[_0x50e3cf(0x154)]});}}),module['exports']=router;