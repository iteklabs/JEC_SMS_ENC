var a0_0x146a3a=a0_0x18cf;(function(_0x5dd492,_0x4394c2){var _0x2b593f=a0_0x18cf,_0x2c75b8=_0x5dd492();while(!![]){try{var _0x41d775=parseInt(_0x2b593f(0x173))/0x1+-parseInt(_0x2b593f(0x124))/0x2+parseInt(_0x2b593f(0x11e))/0x3*(-parseInt(_0x2b593f(0x14c))/0x4)+parseInt(_0x2b593f(0x17d))/0x5*(parseInt(_0x2b593f(0x16a))/0x6)+-parseInt(_0x2b593f(0x10e))/0x7*(parseInt(_0x2b593f(0x166))/0x8)+parseInt(_0x2b593f(0x16b))/0x9+-parseInt(_0x2b593f(0x174))/0xa*(-parseInt(_0x2b593f(0x171))/0xb);if(_0x41d775===_0x4394c2)break;else _0x2c75b8['push'](_0x2c75b8['shift']());}catch(_0x49eab2){_0x2c75b8['push'](_0x2c75b8['shift']());}}}(a0_0x25c3,0xbf273));function a0_0x18cf(_0x306503,_0x568a3e){var _0x25c34f=a0_0x25c3();return a0_0x18cf=function(_0x18cfe5,_0x1e4017){_0x18cfe5=_0x18cfe5-0x105;var _0x5f432e=_0x25c34f[_0x18cfe5];return _0x5f432e;},a0_0x18cf(_0x306503,_0x568a3e);}const express=require(a0_0x146a3a(0x160)),app=express(),router=express[a0_0x146a3a(0x140)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x146a3a(0x114)),auth=require(a0_0x146a3a(0x178)),users=require(a0_0x146a3a(0x133));function a0_0x25c3(){var _0x34e6eb=['/give_payment/:id','$product_details.rack','../models/all_models','data','product_stock','new\x20new_data','findById','log','/sales_return_finished/view','$product_details.bay','getDate','purchase\x20return\x20successfully','53796GOCija','email','params','/view','stocks_QA','customers','2640996XOKGUY','$name','types','secondary_code_QA','old_data','body','json','secondary_code','primary_code','Enabled','German','customer','Arabic\x20(ae)','$product_details.type','product_name','../public/language/languages.json','find','product_details','product_name_QA','redirect','payment\x20successfull','Return\x20Rooms','forEach','Hindi','English\x20(US)','$product_details.product_name','floorlevel','$product_details.storage','Router','QA\x20Warehouse','English','$product_details.primary_code','return_qty','old_warehouse_data','French','for_categorize','back','sales_quantity','bay','getMonth','328dAzaqA','bin','post','Chinese','/sales_return/view','$product_details','Portuguese','flash','language','invoice','$product_details._id','product_code','product_code_QA','sales_return_finished','return_sale_edit_finished','subtract','/invoice/:id','due_amount','save','name','express','suppliers','$product_details.product_code','Portuguese\x20(BR)','errors','ToRoom','56VmDBUp','warehouse_name','date','Spanish','42jhDxxr','13136058jwBJia','slice','Arabic','return_sale','stocks','render','4102681fvrMHS','$product_details.bin','1230415nYOOqG','10lxNbki','customer_docs','sales_quantity_QA','aggregate','../middleware/auth','get','note','exports','type','1016485oqcZFN','ToWarehouse','user','success','$product_details.secondary_code','$customer_docs','/view/:id','findOne','sale_qty','return_sale_QA','map','return_qty_QA','stock','912142OSkXno','$product_details.floorlevel','status','master'];a0_0x25c3=function(){return _0x34e6eb;};return a0_0x25c3();}router[a0_0x146a3a(0x179)](a0_0x146a3a(0x121),auth,async(_0x27942e,_0x3fe62c)=>{var _0x3f53b8=a0_0x146a3a;try{const {username:_0xc8a913,email:_0x5d4b3d,role:_0x5cf1d8}=_0x27942e['user'],_0x56c030=_0x27942e[_0x3f53b8(0x17f)],_0x5a542d=await profile[_0x3f53b8(0x108)]({'email':_0x56c030['email']}),_0x285740=await master_shop[_0x3f53b8(0x134)](),_0x3d6c57=await sales_return_finished[_0x3f53b8(0x177)]([{'$lookup':{'from':_0x3f53b8(0x123),'localField':_0x3f53b8(0x12f),'foreignField':_0x3f53b8(0x15f),'as':_0x3f53b8(0x175)}},{'$unwind':_0x3f53b8(0x106)}]);if(_0x285740[0x0][_0x3f53b8(0x154)]==_0x3f53b8(0x13c)){var _0x40105c=users[_0x3f53b8(0x142)];console[_0x3f53b8(0x119)](_0x40105c);}else{if(_0x285740[0x0][_0x3f53b8(0x154)]==_0x3f53b8(0x13b))var _0x40105c=users['Hindi'];else{if(_0x285740[0x0][_0x3f53b8(0x154)]=='German')var _0x40105c=users[_0x3f53b8(0x12e)];else{if(_0x285740[0x0][_0x3f53b8(0x154)]==_0x3f53b8(0x169))var _0x40105c=users[_0x3f53b8(0x169)];else{if(_0x285740[0x0]['language']==_0x3f53b8(0x146))var _0x40105c=users[_0x3f53b8(0x146)];else{if(_0x285740[0x0][_0x3f53b8(0x154)]==_0x3f53b8(0x163))var _0x40105c=users[_0x3f53b8(0x152)];else{if(_0x285740[0x0][_0x3f53b8(0x154)]=='Chinese')var _0x40105c=users['Chinese'];else{if(_0x285740[0x0]['language']==_0x3f53b8(0x130))var _0x40105c=users[_0x3f53b8(0x16d)];}}}}}}}_0x3fe62c['render'](_0x3f53b8(0x159),{'success':_0x27942e['flash']('success'),'errors':_0x27942e[_0x3f53b8(0x153)]('errors'),'role':_0x56c030,'profile':_0x5a542d,'master_shop':_0x285740,'user':_0x3d6c57,'language':_0x40105c});}catch(_0x29562b){console[_0x3f53b8(0x119)](_0x29562b);}}),router[a0_0x146a3a(0x179)](a0_0x146a3a(0x107),auth,async(_0x82dabe,_0x1a4dde)=>{var _0x5b06da=a0_0x146a3a;try{const {username:_0x46706a,email:_0x53a99b,role:_0x53cfdc}=_0x82dabe[_0x5b06da(0x17f)],_0x13dea7=_0x82dabe[_0x5b06da(0x17f)],_0x37a85b=await profile['findOne']({'email':_0x13dea7[_0x5b06da(0x11f)]}),_0x5f422d=await master_shop['find']();console['log'](_0x5b06da(0x111),_0x5f422d);const _0x41f083=_0x82dabe['params']['id'];console['log'](_0x41f083);var _0x4ef58f=[_0x5b06da(0x139)];const _0x7671bb=await sales_return_finished[_0x5b06da(0x118)](_0x41f083),_0x324924=await warehouse[_0x5b06da(0x177)]([{'$match':{'name':_0x7671bb['ToWarehouse'],'room':_0x7671bb[_0x5b06da(0x165)]}},{'$unwind':_0x5b06da(0x151)},{'$group':{'_id':_0x5b06da(0x156),'name':{'$first':_0x5b06da(0x13d)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5b06da(0x11b)},'bin':{'$first':_0x5b06da(0x172)},'type':{'$first':_0x5b06da(0x131)},'floorlevel':{'$first':_0x5b06da(0x10f)},'primary_code':{'$first':_0x5b06da(0x143)},'secondary_code':{'$first':_0x5b06da(0x105)},'product_code':{'$first':_0x5b06da(0x162)},'storage':{'$first':_0x5b06da(0x13f)},'rack':{'$first':_0x5b06da(0x113)}}}]);console['log'](_0x324924);const _0x4f2184=await warehouse[_0x5b06da(0x177)]([{'$match':{'status':_0x5b06da(0x12d),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x5b06da(0x125),'name':{'$first':_0x5b06da(0x125)}}},{'$sort':{'name':0x1}}]),_0x27e8d4=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x5b06da(0x141)}},{'$group':{'_id':'$name','name':{'$first':_0x5b06da(0x125)}}},{'$sort':{'name':0x1}}]),_0x17e8e8=await product[_0x5b06da(0x134)]({});if(_0x5f422d[0x0][_0x5b06da(0x154)]==_0x5b06da(0x13c)){var _0x6e9818=users[_0x5b06da(0x142)];console[_0x5b06da(0x119)](_0x6e9818);}else{if(_0x5f422d[0x0]['language']==_0x5b06da(0x13b))var _0x6e9818=users['Hindi'];else{if(_0x5f422d[0x0][_0x5b06da(0x154)]=='German')var _0x6e9818=users['German'];else{if(_0x5f422d[0x0][_0x5b06da(0x154)]==_0x5b06da(0x169))var _0x6e9818=users[_0x5b06da(0x169)];else{if(_0x5f422d[0x0][_0x5b06da(0x154)]==_0x5b06da(0x146))var _0x6e9818=users[_0x5b06da(0x146)];else{if(_0x5f422d[0x0][_0x5b06da(0x154)]=='Portuguese\x20(BR)')var _0x6e9818=users[_0x5b06da(0x152)];else{if(_0x5f422d[0x0][_0x5b06da(0x154)]=='Chinese')var _0x6e9818=users[_0x5b06da(0x14f)];else{if(_0x5f422d[0x0][_0x5b06da(0x154)]==_0x5b06da(0x130))var _0x6e9818=users['Arabic'];}}}}}}}_0x1a4dde[_0x5b06da(0x170)](_0x5b06da(0x15a),{'success':_0x82dabe[_0x5b06da(0x153)](_0x5b06da(0x180)),'errors':_0x82dabe[_0x5b06da(0x153)](_0x5b06da(0x164)),'role':_0x13dea7,'profile':_0x37a85b,'master_shop':_0x5f422d,'user':_0x7671bb,'stock':_0x324924,'unit':_0x17e8e8,'language':_0x6e9818,'warehouses':_0x4f2184,'rooms':_0x4ef58f,'warehouse_QA':_0x27e8d4});}catch(_0xb43022){console[_0x5b06da(0x119)](_0xb43022);}}),router[a0_0x146a3a(0x14e)]('/view/:id',auth,async(_0x271fdf,_0x2fbc3a)=>{var _0x419c9c=a0_0x146a3a;if(_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x147)]=='QA')try{const _0x12a100=_0x271fdf[_0x419c9c(0x120)]['id'],_0x1ed1e5=await sales_return[_0x419c9c(0x108)]({'invoice':_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x155)]}),_0x5dafcf=await warehouse['findOne']({'name':_0x1ed1e5[_0x419c9c(0x17e)],'room':_0x1ed1e5[_0x419c9c(0x165)]}),{invoice:_0x14fe94,customer:_0x1c2296,date:_0x17a67,warehouse_name:_0x5a408,product_name:_0x3523bd,primary_code:_0x3a0c90,secondary_code:_0x1ac90e,product_code:_0x111cac,sales_quantity:_0x87798e,stocks:_0xd8f1c6,return_qty:_0x54d82d,note:_0x351829,to_warehouse_name_QA:_0x48b053,to_Room_name_QA:_0x4d762d}=_0x271fdf[_0x419c9c(0x129)];if(typeof product_name_QA=='string')var _0xc936a=[_0x271fdf[_0x419c9c(0x129)]['product_name_QA']],_0x12a6c9=[_0x271fdf[_0x419c9c(0x129)]['primary_code_QA']],_0x19f732=[_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x127)]],_0x122c9d=[_0x271fdf[_0x419c9c(0x129)]['product_code_QA']],_0x215951=[_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x176)]],_0x9d97d9=[_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x122)]],_0x4631df=[_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x10c)]];else var _0xc936a=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x136)]],_0x12a6c9=[..._0x271fdf[_0x419c9c(0x129)]['primary_code_QA']],_0x19f732=[..._0x271fdf['body'][_0x419c9c(0x127)]],_0x122c9d=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x158)]],_0x215951=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x176)]],_0x9d97d9=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x122)]],_0x4631df=[..._0x271fdf[_0x419c9c(0x129)]['return_qty_QA']];const _0x521a2d=_0xc936a[_0x419c9c(0x10b)](_0x477000=>{return _0x477000={'product_name':_0x477000};});_0x12a6c9[_0x419c9c(0x13a)]((_0x563ddc,_0x3a57e6)=>{var _0x58399e=_0x419c9c;_0x521a2d[_0x3a57e6][_0x58399e(0x12c)]=_0x563ddc;}),_0x19f732[_0x419c9c(0x13a)]((_0x3dedf2,_0x16adf1)=>{var _0x45ade3=_0x419c9c;_0x521a2d[_0x16adf1][_0x45ade3(0x12b)]=_0x3dedf2;}),_0x122c9d[_0x419c9c(0x13a)]((_0x124220,_0x4e7b4f)=>{var _0x3dbcdb=_0x419c9c;_0x521a2d[_0x4e7b4f][_0x3dbcdb(0x157)]=_0x124220;}),_0x215951[_0x419c9c(0x13a)]((_0x43f9de,_0x1c29a9)=>{var _0x89556e=_0x419c9c;_0x521a2d[_0x1c29a9][_0x89556e(0x109)]=_0x43f9de;}),_0x9d97d9[_0x419c9c(0x13a)]((_0xf685ab,_0x6432a7)=>{var _0x507983=_0x419c9c;_0x521a2d[_0x6432a7][_0x507983(0x10d)]=_0xf685ab;}),_0x4631df['forEach']((_0x3980b4,_0x1ab3c4)=>{var _0x1d14f7=_0x419c9c;_0x521a2d[_0x1ab3c4][_0x1d14f7(0x144)]=_0x3980b4;}),_0x1ed1e5[_0x419c9c(0x10a)][_0x419c9c(0x13a)](_0x49323c=>{var _0x54aee9=_0x419c9c;const _0x12d9bc=_0x5dafcf[_0x54aee9(0x135)][_0x54aee9(0x10b)](_0x4c4a4a=>{var _0x2af0f8=_0x54aee9;_0x4c4a4a[_0x2af0f8(0x132)]==_0x49323c[_0x2af0f8(0x132)]&&(_0x4c4a4a[_0x2af0f8(0x116)]=parseInt(_0x4c4a4a[_0x2af0f8(0x116)])+parseInt(_0x49323c[_0x2af0f8(0x144)]));});}),await _0x5dafcf[_0x419c9c(0x15e)](),_0x1ed1e5[_0x419c9c(0x155)]=_0x14fe94,_0x1ed1e5[_0x419c9c(0x12f)]=_0x1c2296,_0x1ed1e5[_0x419c9c(0x168)]=_0x17a67,_0x1ed1e5[_0x419c9c(0x167)]=_0x5a408,_0x1ed1e5[_0x419c9c(0x10a)]=_0x521a2d,_0x1ed1e5[_0x419c9c(0x17a)]=_0x351829,_0x1ed1e5[_0x419c9c(0x17e)]=_0x48b053,_0x1ed1e5[_0x419c9c(0x165)]=_0x4d762d;const _0x4d15c5=await _0x1ed1e5[_0x419c9c(0x15e)](),_0x5612a8=await c_payment_data[_0x419c9c(0x108)]({'invoice':_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x155)],'reason':'Sale\x20Return'});_0x5612a8[_0x419c9c(0x161)]=_0x271fdf['body'][_0x419c9c(0x161)],_0x5612a8[_0x419c9c(0x168)]=_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x168)],await _0x5612a8['save'](),_0x271fdf[_0x419c9c(0x153)](_0x419c9c(0x180),_0x419c9c(0x11d)),_0x2fbc3a[_0x419c9c(0x137)](_0x419c9c(0x11a));}catch(_0x9d827){console[_0x419c9c(0x119)](_0x9d827),_0x2fbc3a[_0x419c9c(0x110)](0xc8)[_0x419c9c(0x12a)]({'message':_0x9d827['message']});}else try{const _0x46247d=_0x271fdf[_0x419c9c(0x120)]['id'];console[_0x419c9c(0x119)](_0x46247d);const _0x2670df=await sales_return[_0x419c9c(0x108)]({'invoice':_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x155)]});console[_0x419c9c(0x119)](_0x419c9c(0x128),_0x2670df);const _0x596a8f=await warehouse[_0x419c9c(0x108)]({'name':_0x2670df['ToWarehouse'],'room':_0x2670df['ToRoom']});console[_0x419c9c(0x119)](_0x419c9c(0x145),_0x596a8f);const {invoice:_0x2b441b,customer:_0x250041,date:_0x4b6eba,warehouse_name:_0x33e519,product_name:_0x377436,primary_code:_0x41ac59,secondary_code:_0x213c45,product_code:_0x392d0e,sales_quantity:_0x2c047a,stocks:_0x383af2,return_qty:_0x1d5cb5,note:_0x46e911,to_warehouse_name:_0x11873c,to_Room_name:_0x914c54}=_0x271fdf[_0x419c9c(0x129)];console[_0x419c9c(0x119)](_0x271fdf[_0x419c9c(0x129)]);if(typeof _0x377436=='string')var _0xc936a=[_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x132)]],_0x12a6c9=[_0x271fdf[_0x419c9c(0x129)]['primary_code']],_0x19f732=[_0x271fdf['body'][_0x419c9c(0x12b)]],_0x122c9d=[_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x157)]],_0x215951=[_0x271fdf[_0x419c9c(0x129)]['sales_quantity']],_0x9d97d9=[_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x16f)]],_0x4631df=[_0x271fdf['body'][_0x419c9c(0x144)]],_0x5b4f6f=[_0x271fdf[_0x419c9c(0x129)]['bay']],_0x2b9fa9=[_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x14d)]],_0x520425=[_0x271fdf[_0x419c9c(0x129)]['types']],_0x51bdf4=[_0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x13e)]];else var _0xc936a=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x132)]],_0x12a6c9=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x12c)]],_0x19f732=[..._0x271fdf[_0x419c9c(0x129)]['secondary_code']],_0x122c9d=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x157)]],_0x215951=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x149)]],_0x9d97d9=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x16f)]],_0x4631df=[..._0x271fdf['body'][_0x419c9c(0x144)]],_0x5b4f6f=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x14a)]],_0x2b9fa9=[..._0x271fdf['body'][_0x419c9c(0x14d)]],_0x520425=[..._0x271fdf[_0x419c9c(0x129)][_0x419c9c(0x126)]],_0x51bdf4=[..._0x271fdf[_0x419c9c(0x129)]['floorlevel']];const _0x54959f=_0xc936a['map'](_0x1d93e9=>{return _0x1d93e9={'product_name':_0x1d93e9};});_0x12a6c9['forEach']((_0x20f1aa,_0x5ee481)=>{var _0x5439ef=_0x419c9c;_0x54959f[_0x5ee481][_0x5439ef(0x12c)]=_0x20f1aa;}),_0x19f732[_0x419c9c(0x13a)]((_0x134251,_0x4d47ef)=>{var _0x4ad6f2=_0x419c9c;_0x54959f[_0x4d47ef][_0x4ad6f2(0x12b)]=_0x134251;}),_0x122c9d[_0x419c9c(0x13a)]((_0x5b357d,_0x234d82)=>{_0x54959f[_0x234d82]['product_code']=_0x5b357d;}),_0x215951[_0x419c9c(0x13a)]((_0x5e9a4b,_0x4ebd84)=>{var _0x32fc28=_0x419c9c;_0x54959f[_0x4ebd84][_0x32fc28(0x109)]=_0x5e9a4b;}),_0x9d97d9['forEach']((_0x16de86,_0x293de0)=>{var _0xb6fbda=_0x419c9c;_0x54959f[_0x293de0][_0xb6fbda(0x10d)]=_0x16de86;}),_0x4631df['forEach']((_0x378119,_0x47a088)=>{var _0x1f322b=_0x419c9c;_0x54959f[_0x47a088][_0x1f322b(0x144)]=_0x378119;}),_0x5b4f6f[_0x419c9c(0x13a)]((_0x59c595,_0x1d0930)=>{_0x54959f[_0x1d0930]['bay']=_0x59c595;}),_0x2b9fa9[_0x419c9c(0x13a)]((_0x4780ba,_0x19b975)=>{var _0x31821f=_0x419c9c;_0x54959f[_0x19b975][_0x31821f(0x14d)]=_0x4780ba;}),_0x520425[_0x419c9c(0x13a)]((_0x2d1208,_0x2ca2fa)=>{var _0x339f19=_0x419c9c;_0x54959f[_0x2ca2fa][_0x339f19(0x17c)]=_0x2d1208;}),_0x51bdf4[_0x419c9c(0x13a)]((_0x1c1712,_0x539415)=>{var _0x15408c=_0x419c9c;_0x54959f[_0x539415][_0x15408c(0x13e)]=_0x1c1712;});var _0x55e153=0x0;_0x54959f['forEach'](_0x3d62cb=>{var _0x17e9ea=_0x419c9c;console[_0x17e9ea(0x119)]('foreach\x20newproduct',_0x3d62cb),(parseInt(_0x3d62cb[_0x17e9ea(0x109)])<parseInt(_0x3d62cb['return_qty'])||parseInt(_0x3d62cb['stock'])<parseInt(_0x3d62cb[_0x17e9ea(0x144)])&&parseInt(_0x3d62cb[_0x17e9ea(0x109)])>parseInt(_0x3d62cb['return_qty'])||parseInt(_0x3d62cb[_0x17e9ea(0x144)])==0x0)&&_0x55e153++;});if(_0x55e153!=0x0)return _0x271fdf[_0x419c9c(0x153)](_0x419c9c(0x164),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x2fbc3a['redirect'](_0x419c9c(0x148));_0x2670df[_0x419c9c(0x16e)][_0x419c9c(0x13a)](_0x30cd05=>{var _0x30056b=_0x419c9c;const _0x2510e8=_0x596a8f[_0x30056b(0x135)][_0x30056b(0x10b)](_0x4809d3=>{var _0x22c786=_0x30056b;_0x4809d3['product_name']==_0x30cd05[_0x22c786(0x132)]&&_0x4809d3[_0x22c786(0x13e)]==_0x30cd05[_0x22c786(0x13e)]&&_0x4809d3[_0x22c786(0x17c)]==_0x30cd05[_0x22c786(0x17c)]&&_0x4809d3['bin']==_0x30cd05[_0x22c786(0x14d)]&&_0x4809d3['bay']==_0x30cd05[_0x22c786(0x14a)]&&(_0x4809d3[_0x22c786(0x116)]=parseInt(_0x4809d3[_0x22c786(0x116)])+parseInt(_0x30cd05[_0x22c786(0x144)]));});}),console['log'](_0x419c9c(0x145),_0x596a8f),await _0x596a8f['save'](),_0x2670df['invoice']=_0x2b441b,_0x2670df['customer']=_0x250041,_0x2670df[_0x419c9c(0x168)]=_0x4b6eba,_0x2670df['warehouse_name']=_0x33e519,_0x2670df['return_sale']=_0x54959f,_0x2670df['note']=_0x46e911,_0x2670df[_0x419c9c(0x17e)]=_0x11873c,_0x2670df[_0x419c9c(0x165)]=_0x914c54;const _0x41530e=await _0x2670df[_0x419c9c(0x15e)]();console['log'](_0x419c9c(0x117),_0x41530e);const _0x322062=await c_payment_data['findOne']({'invoice':_0x271fdf[_0x419c9c(0x129)]['invoice'],'reason':'Sale\x20Return'});_0x322062['suppliers']=_0x271fdf['body']['suppliers'],_0x322062[_0x419c9c(0x168)]=_0x271fdf[_0x419c9c(0x129)]['date'],await _0x322062['save'](),_0x271fdf[_0x419c9c(0x153)](_0x419c9c(0x180),_0x419c9c(0x11d)),_0x2fbc3a[_0x419c9c(0x137)](_0x419c9c(0x150));}catch(_0x5bdb77){console[_0x419c9c(0x119)](_0x5bdb77),_0x2fbc3a['status'](0xc8)[_0x419c9c(0x12a)]({'message':_0x5bdb77['message']});}}),router['post'](a0_0x146a3a(0x112),auth,async(_0x47a184,_0x1a1124)=>{var _0x278738=a0_0x146a3a;try{const _0x4aa655=_0x47a184['params']['id'],{invoice:_0xb8dfd6,customer:_0x1987c7,payable_to_customer:_0x5f03b5,paid_amount:_0x3ebbba}=_0x47a184[_0x278738(0x129)],_0x29aa1d=await sales_return[_0x278738(0x118)](_0x4aa655);console[_0x278738(0x119)](_0x278738(0x115),_0x29aa1d),console[_0x278738(0x119)](_0x5f03b5),console[_0x278738(0x119)](_0x3ebbba);var _0x4ca9ba=_0x5f03b5-_0x3ebbba;console[_0x278738(0x119)](_0x278738(0x15b),_0x4ca9ba),_0x29aa1d['paid_amount']=parseFloat(_0x3ebbba)+parseFloat(_0x29aa1d['paid_amount']),_0x29aa1d[_0x278738(0x15d)]=_0x4ca9ba,console[_0x278738(0x119)](_0x29aa1d);const _0x28f31a=await _0x29aa1d['save']();console[_0x278738(0x119)](0x1b207);const _0x14f8e3=await c_payment_data[_0x278738(0x108)]({'invoice':_0x47a184['body'][_0x278738(0x155)],'reason':'Sale\x20Return'});console[_0x278738(0x119)]('c_payment',_0x14f8e3),_0x14f8e3['amount']=_0x4ca9ba,await _0x14f8e3[_0x278738(0x15e)]();let _0x11e1da=new Date(),_0x3d394b=('0'+_0x11e1da[_0x278738(0x11c)]())[_0x278738(0x16c)](-0x2),_0x4b2cd4=('0'+(_0x11e1da[_0x278738(0x14b)]()+0x1))[_0x278738(0x16c)](-0x2),_0x5c47f5=_0x11e1da['getFullYear'](),_0x19f6c7=_0x5c47f5+'-'+_0x4b2cd4+'-'+_0x3d394b;const _0x40282e=new customer_payment({'invoice':_0xb8dfd6,'date':_0x5c47f5+'-'+_0x4b2cd4+'-'+_0x3d394b,'customer':_0x1987c7,'reason':'Returned\x20Payment\x20For\x20Sale\x20Return','amount':_0x3ebbba}),_0x4d3402=await _0x40282e[_0x278738(0x15e)]();_0x47a184['flash']('success',_0x278738(0x138)),_0x1a1124[_0x278738(0x137)]('/sales_return/view');}catch(_0x68b825){console[_0x278738(0x119)](_0x68b825);}}),router[a0_0x146a3a(0x179)](a0_0x146a3a(0x15c),auth,async(_0x7f458f,_0x314ffc)=>{var _0x190530=a0_0x146a3a;try{const {username:_0x5bdde0,email:_0x30bafc,role:_0x57283d}=_0x7f458f['user'],_0x268e8d=_0x7f458f[_0x190530(0x17f)],_0x43f93d=await profile[_0x190530(0x108)]({'email':_0x268e8d[_0x190530(0x11f)]}),_0x2cd7a1=await master_shop[_0x190530(0x134)]();console[_0x190530(0x119)]('master',_0x2cd7a1);const _0x5ac9b3=_0x7f458f[_0x190530(0x120)]['id'],_0x16794a=await sales_return[_0x190530(0x118)](_0x5ac9b3);console['log'](_0x16794a);const _0x5d6f89=await customer[_0x190530(0x108)]({'name':_0x16794a[_0x190530(0x12f)]});console[_0x190530(0x119)](_0x5d6f89);if(_0x2cd7a1[0x0][_0x190530(0x154)]==_0x190530(0x13c)){var _0x5ef20b=users[_0x190530(0x142)];console[_0x190530(0x119)](_0x5ef20b);}else{if(_0x2cd7a1[0x0][_0x190530(0x154)]==_0x190530(0x13b))var _0x5ef20b=users['Hindi'];else{if(_0x2cd7a1[0x0][_0x190530(0x154)]=='German')var _0x5ef20b=users[_0x190530(0x12e)];else{if(_0x2cd7a1[0x0][_0x190530(0x154)]=='Spanish')var _0x5ef20b=users['Spanish'];else{if(_0x2cd7a1[0x0][_0x190530(0x154)]==_0x190530(0x146))var _0x5ef20b=users[_0x190530(0x146)];else{if(_0x2cd7a1[0x0][_0x190530(0x154)]==_0x190530(0x163))var _0x5ef20b=users['Portuguese'];else{if(_0x2cd7a1[0x0][_0x190530(0x154)]=='Chinese')var _0x5ef20b=users[_0x190530(0x14f)];else{if(_0x2cd7a1[0x0]['language']==_0x190530(0x130))var _0x5ef20b=users[_0x190530(0x16d)];}}}}}}}_0x314ffc[_0x190530(0x170)]('sales_return_invoice',{'success':_0x7f458f['flash'](_0x190530(0x180)),'errors':_0x7f458f[_0x190530(0x153)]('errors'),'role':_0x268e8d,'profile':_0x43f93d,'master_shop':_0x2cd7a1,'customers':_0x5d6f89,'sales':_0x16794a,'language':_0x5ef20b});}catch(_0x5643b0){console['log'](_0x5643b0);}}),module[a0_0x146a3a(0x17b)]=router;