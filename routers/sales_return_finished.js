var a0_0x17d48d=a0_0x4ed5;(function(_0xf5e9f7,_0x309829){var _0x54a96a=a0_0x4ed5,_0x296086=_0xf5e9f7();while(!![]){try{var _0x23460d=parseInt(_0x54a96a(0x156))/0x1*(-parseInt(_0x54a96a(0x17c))/0x2)+-parseInt(_0x54a96a(0x185))/0x3*(parseInt(_0x54a96a(0x149))/0x4)+-parseInt(_0x54a96a(0x134))/0x5*(parseInt(_0x54a96a(0x133))/0x6)+parseInt(_0x54a96a(0x18d))/0x7+parseInt(_0x54a96a(0x15a))/0x8+-parseInt(_0x54a96a(0x17e))/0x9*(-parseInt(_0x54a96a(0x12e))/0xa)+-parseInt(_0x54a96a(0x191))/0xb*(parseInt(_0x54a96a(0x175))/0xc);if(_0x23460d===_0x309829)break;else _0x296086['push'](_0x296086['shift']());}catch(_0x3ec69d){_0x296086['push'](_0x296086['shift']());}}}(a0_0x4db9,0x598c4));const express=require(a0_0x17d48d(0x152)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x17d48d(0x17a)),auth=require(a0_0x17d48d(0x180)),users=require(a0_0x17d48d(0x172));router[a0_0x17d48d(0x18c)]('/view',auth,async(_0x1f1d26,_0x2f889f)=>{var _0x5938cb=a0_0x17d48d;try{const {username:_0x3989c1,email:_0x4cd4ee,role:_0x3d14af}=_0x1f1d26[_0x5938cb(0x190)],_0x58d2f0=_0x1f1d26[_0x5938cb(0x190)],_0x282c3a=await profile[_0x5938cb(0x15f)]({'email':_0x58d2f0['email']}),_0x3a7583=await master_shop[_0x5938cb(0x161)](),_0x4ab136=await sales_return_finished[_0x5938cb(0x151)]([{'$lookup':{'from':'customers','localField':_0x5938cb(0x13d),'foreignField':'name','as':_0x5938cb(0x188)}},{'$unwind':_0x5938cb(0x1a0)}]);if(_0x3a7583[0x0][_0x5938cb(0x16c)]=='English\x20(US)'){var _0x45a260=users[_0x5938cb(0x193)];console[_0x5938cb(0x167)](_0x45a260);}else{if(_0x3a7583[0x0][_0x5938cb(0x16c)]==_0x5938cb(0x13c))var _0x45a260=users[_0x5938cb(0x13c)];else{if(_0x3a7583[0x0][_0x5938cb(0x16c)]==_0x5938cb(0x18a))var _0x45a260=users[_0x5938cb(0x18a)];else{if(_0x3a7583[0x0][_0x5938cb(0x16c)]=='Spanish')var _0x45a260=users[_0x5938cb(0x14e)];else{if(_0x3a7583[0x0][_0x5938cb(0x16c)]==_0x5938cb(0x12c))var _0x45a260=users[_0x5938cb(0x12c)];else{if(_0x3a7583[0x0][_0x5938cb(0x16c)]==_0x5938cb(0x145))var _0x45a260=users[_0x5938cb(0x131)];else{if(_0x3a7583[0x0]['language']==_0x5938cb(0x18b))var _0x45a260=users[_0x5938cb(0x18b)];else{if(_0x3a7583[0x0][_0x5938cb(0x16c)]==_0x5938cb(0x1a1))var _0x45a260=users['Arabic'];}}}}}}}_0x2f889f[_0x5938cb(0x13e)]('sales_return_finished',{'success':_0x1f1d26[_0x5938cb(0x163)](_0x5938cb(0x164)),'errors':_0x1f1d26[_0x5938cb(0x163)](_0x5938cb(0x143)),'role':_0x58d2f0,'profile':_0x282c3a,'master_shop':_0x3a7583,'user':_0x4ab136,'language':_0x45a260});}catch(_0x346e8c){console['log'](_0x346e8c);}}),router[a0_0x17d48d(0x18c)]('/view/:id',auth,async(_0x683f08,_0x576251)=>{var _0x5d59f6=a0_0x17d48d;try{const {username:_0x10e458,email:_0x414c4d,role:_0x2a4457}=_0x683f08['user'],_0x2a6b14=_0x683f08[_0x5d59f6(0x190)],_0x4c12f1=await profile[_0x5d59f6(0x15f)]({'email':_0x2a6b14['email']}),_0x2eca2a=await master_shop[_0x5d59f6(0x161)]();console[_0x5d59f6(0x167)]('master',_0x2eca2a);const _0x39ffb5=_0x683f08[_0x5d59f6(0x197)]['id'];console[_0x5d59f6(0x167)](_0x39ffb5);var _0x5ec581=[_0x5d59f6(0x142)];const _0x49afb5=await sales_return_finished[_0x5d59f6(0x14d)](_0x39ffb5),_0x33892a=await warehouse[_0x5d59f6(0x151)]([{'$match':{'name':_0x49afb5['ToWarehouse'],'room':_0x49afb5[_0x5d59f6(0x176)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5d59f6(0x1a2),'name':{'$first':_0x5d59f6(0x14b)},'product_stock':{'$first':_0x5d59f6(0x179)},'bay':{'$first':_0x5d59f6(0x14c)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5d59f6(0x155)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x5d59f6(0x165)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5d59f6(0x169)},'storage':{'$first':_0x5d59f6(0x17b)},'rack':{'$first':_0x5d59f6(0x146)}}}]);console['log'](_0x33892a);const _0x48a800=await warehouse[_0x5d59f6(0x151)]([{'$match':{'status':_0x5d59f6(0x17f),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x5d59f6(0x159),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x3eb254=await warehouse['aggregate']([{'$match':{'status':_0x5d59f6(0x17f),'name':_0x5d59f6(0x19a)}},{'$group':{'_id':_0x5d59f6(0x159),'name':{'$first':_0x5d59f6(0x159)}}},{'$sort':{'name':0x1}}]),_0x44ec4f=await product[_0x5d59f6(0x161)]({});if(_0x2eca2a[0x0][_0x5d59f6(0x16c)]==_0x5d59f6(0x189)){var _0x271b62=users[_0x5d59f6(0x193)];console[_0x5d59f6(0x167)](_0x271b62);}else{if(_0x2eca2a[0x0][_0x5d59f6(0x16c)]==_0x5d59f6(0x13c))var _0x271b62=users['Hindi'];else{if(_0x2eca2a[0x0]['language']==_0x5d59f6(0x18a))var _0x271b62=users[_0x5d59f6(0x18a)];else{if(_0x2eca2a[0x0][_0x5d59f6(0x16c)]==_0x5d59f6(0x14e))var _0x271b62=users[_0x5d59f6(0x14e)];else{if(_0x2eca2a[0x0]['language']=='French')var _0x271b62=users[_0x5d59f6(0x12c)];else{if(_0x2eca2a[0x0][_0x5d59f6(0x16c)]=='Portuguese\x20(BR)')var _0x271b62=users['Portuguese'];else{if(_0x2eca2a[0x0][_0x5d59f6(0x16c)]=='Chinese')var _0x271b62=users['Chinese'];else{if(_0x2eca2a[0x0][_0x5d59f6(0x16c)]==_0x5d59f6(0x1a1))var _0x271b62=users[_0x5d59f6(0x139)];}}}}}}}_0x576251[_0x5d59f6(0x13e)](_0x5d59f6(0x130),{'success':_0x683f08[_0x5d59f6(0x163)]('success'),'errors':_0x683f08[_0x5d59f6(0x163)](_0x5d59f6(0x143)),'role':_0x2a6b14,'profile':_0x4c12f1,'master_shop':_0x2eca2a,'user':_0x49afb5,'stock':_0x33892a,'unit':_0x44ec4f,'language':_0x271b62,'warehouses':_0x48a800,'rooms':_0x5ec581,'warehouse_QA':_0x3eb254});}catch(_0x6f4b7){console['log'](_0x6f4b7);}}),router[a0_0x17d48d(0x170)](a0_0x17d48d(0x19f),auth,async(_0x1bd516,_0x4946d7)=>{var _0x51aff8=a0_0x17d48d;if(_0x1bd516[_0x51aff8(0x12f)]['for_categorize']=='QA')try{const _0x113ea7=_0x1bd516[_0x51aff8(0x197)]['id'],_0x339368=await sales_return[_0x51aff8(0x15f)]({'invoice':_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x135)]}),_0x20d543=await warehouse[_0x51aff8(0x15f)]({'name':_0x339368[_0x51aff8(0x162)],'room':_0x339368[_0x51aff8(0x176)]}),{invoice:_0x4b02c4,customer:_0x4c733b,date:_0x31e5a2,warehouse_name:_0x4e2ec9,product_name:_0x205127,primary_code:_0x357637,secondary_code:_0x2c63ce,product_code:_0x277ba5,sales_quantity:_0x4b56e9,stocks:_0x248807,return_qty:_0x18aae4,note:_0x4d200b,to_warehouse_name_QA:_0x204f91,to_Room_name_QA:_0x3977ba}=_0x1bd516['body'];if(typeof product_name_QA=='string')var _0xee2c7=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x166)]],_0xc4b78c=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x192)]],_0x20f042=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x174)]],_0x4f20fc=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x178)]],_0x8629ed=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x195)]],_0xa0bc2b=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x173)]],_0x3c412e=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x140)]];else var _0xee2c7=[..._0x1bd516[_0x51aff8(0x12f)]['product_name_QA']],_0xc4b78c=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x192)]],_0x20f042=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x174)]],_0x4f20fc=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x178)]],_0x8629ed=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x195)]],_0xa0bc2b=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x173)]],_0x3c412e=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x140)]];const _0x14d45f=_0xee2c7[_0x51aff8(0x13a)](_0x9076c6=>{return _0x9076c6={'product_name':_0x9076c6};});_0xc4b78c[_0x51aff8(0x144)]((_0x22cc5c,_0x2523f5)=>{var _0xa9c81b=_0x51aff8;_0x14d45f[_0x2523f5][_0xa9c81b(0x16b)]=_0x22cc5c;}),_0x20f042['forEach']((_0x3f1977,_0x51f4a5)=>{_0x14d45f[_0x51f4a5]['secondary_code']=_0x3f1977;}),_0x4f20fc[_0x51aff8(0x144)]((_0x20f5f0,_0x36615a)=>{var _0x367f21=_0x51aff8;_0x14d45f[_0x36615a][_0x367f21(0x141)]=_0x20f5f0;}),_0x8629ed[_0x51aff8(0x144)]((_0x38e6e2,_0x29fa5e)=>{var _0x2f1616=_0x51aff8;_0x14d45f[_0x29fa5e][_0x2f1616(0x198)]=_0x38e6e2;}),_0xa0bc2b['forEach']((_0x5e332c,_0x479774)=>{_0x14d45f[_0x479774]['stock']=_0x5e332c;}),_0x3c412e[_0x51aff8(0x144)]((_0x27a17c,_0x2f0217)=>{var _0xa7f361=_0x51aff8;_0x14d45f[_0x2f0217][_0xa7f361(0x132)]=_0x27a17c;}),_0x339368[_0x51aff8(0x137)]['forEach'](_0x20e5e5=>{var _0x363177=_0x51aff8;const _0x57b85f=_0x20d543[_0x363177(0x154)][_0x363177(0x13a)](_0x2bfa96=>{var _0x2e2473=_0x363177;_0x2bfa96[_0x2e2473(0x196)]==_0x20e5e5[_0x2e2473(0x196)]&&(_0x2bfa96[_0x2e2473(0x12a)]=parseInt(_0x2bfa96[_0x2e2473(0x12a)])+parseInt(_0x20e5e5[_0x2e2473(0x132)]));});}),await _0x20d543['save'](),_0x339368[_0x51aff8(0x135)]=_0x4b02c4,_0x339368[_0x51aff8(0x13d)]=_0x4c733b,_0x339368[_0x51aff8(0x153)]=_0x31e5a2,_0x339368['warehouse_name']=_0x4e2ec9,_0x339368[_0x51aff8(0x137)]=_0x14d45f,_0x339368[_0x51aff8(0x177)]=_0x4d200b,_0x339368[_0x51aff8(0x162)]=_0x204f91,_0x339368[_0x51aff8(0x176)]=_0x3977ba;const _0x41fb6f=await _0x339368[_0x51aff8(0x18f)](),_0xa1d709=await c_payment_data[_0x51aff8(0x15f)]({'invoice':_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x135)],'reason':_0x51aff8(0x13b)});_0xa1d709[_0x51aff8(0x14a)]=_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x14a)],_0xa1d709[_0x51aff8(0x153)]=_0x1bd516['body']['date'],await _0xa1d709[_0x51aff8(0x18f)](),_0x1bd516[_0x51aff8(0x163)](_0x51aff8(0x164),'purchase\x20return\x20successfully'),_0x4946d7[_0x51aff8(0x158)]('/sales_return_finished/view');}catch(_0x5be8b8){console[_0x51aff8(0x167)](_0x5be8b8),_0x4946d7[_0x51aff8(0x19e)](0xc8)['json']({'message':_0x5be8b8[_0x51aff8(0x199)]});}else try{const _0x18df04=_0x1bd516[_0x51aff8(0x197)]['id'];console[_0x51aff8(0x167)](_0x18df04);const _0x4fa9e1=await sales_return[_0x51aff8(0x15f)]({'invoice':_0x1bd516['body'][_0x51aff8(0x135)]});console[_0x51aff8(0x167)](_0x51aff8(0x16a),_0x4fa9e1);const _0x4189a6=await warehouse[_0x51aff8(0x15f)]({'name':_0x4fa9e1[_0x51aff8(0x162)],'room':_0x4fa9e1[_0x51aff8(0x176)]});console[_0x51aff8(0x167)](_0x51aff8(0x160),_0x4189a6);const {invoice:_0x1a48b7,customer:_0x22b913,date:_0x108a8c,warehouse_name:_0x5c63e4,product_name:_0x190030,primary_code:_0x2064b3,secondary_code:_0x3accbc,product_code:_0x27404d,sales_quantity:_0x190264,stocks:_0x3b94e7,return_qty:_0x4ca34c,note:_0x4d83af,to_warehouse_name:_0x3f619e,to_Room_name:_0x1d2e71}=_0x1bd516[_0x51aff8(0x12f)];console[_0x51aff8(0x167)](_0x1bd516[_0x51aff8(0x12f)]);if(typeof _0x190030==_0x51aff8(0x187))var _0xee2c7=[_0x1bd516['body']['product_name']],_0xc4b78c=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x16b)]],_0x20f042=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x17d)]],_0x4f20fc=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x141)]],_0x8629ed=[_0x1bd516[_0x51aff8(0x12f)]['sales_quantity']],_0xa0bc2b=[_0x1bd516[_0x51aff8(0x12f)]['stocks']],_0x3c412e=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x132)]],_0x5ee162=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x136)]],_0x1413da=[_0x1bd516['body']['bin']],_0x220ffe=[_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x12d)]],_0xe1abb0=[_0x1bd516[_0x51aff8(0x12f)]['floorlevel']];else var _0xee2c7=[..._0x1bd516[_0x51aff8(0x12f)]['product_name']],_0xc4b78c=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x16b)]],_0x20f042=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x17d)]],_0x4f20fc=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x141)]],_0x8629ed=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x13f)]],_0xa0bc2b=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x16d)]],_0x3c412e=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x132)]],_0x5ee162=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x136)]],_0x1413da=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x138)]],_0x220ffe=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x12d)]],_0xe1abb0=[..._0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x184)]];const _0x20cad4=_0xee2c7[_0x51aff8(0x13a)](_0x1dbb67=>{return _0x1dbb67={'product_name':_0x1dbb67};});_0xc4b78c[_0x51aff8(0x144)]((_0x783ae4,_0x42fbe8)=>{var _0x3f0b09=_0x51aff8;_0x20cad4[_0x42fbe8][_0x3f0b09(0x16b)]=_0x783ae4;}),_0x20f042[_0x51aff8(0x144)]((_0x5eabd7,_0x1471f3)=>{var _0x4a174d=_0x51aff8;_0x20cad4[_0x1471f3][_0x4a174d(0x17d)]=_0x5eabd7;}),_0x4f20fc[_0x51aff8(0x144)]((_0x5ad622,_0x195d26)=>{_0x20cad4[_0x195d26]['product_code']=_0x5ad622;}),_0x8629ed[_0x51aff8(0x144)]((_0x5de998,_0x51b935)=>{var _0x529552=_0x51aff8;_0x20cad4[_0x51b935][_0x529552(0x198)]=_0x5de998;}),_0xa0bc2b['forEach']((_0x1ac250,_0x169dea)=>{var _0x42bd39=_0x51aff8;_0x20cad4[_0x169dea][_0x42bd39(0x194)]=_0x1ac250;}),_0x3c412e['forEach']((_0x37f87f,_0x5ebd75)=>{var _0x545be7=_0x51aff8;_0x20cad4[_0x5ebd75][_0x545be7(0x132)]=_0x37f87f;}),_0x5ee162[_0x51aff8(0x144)]((_0x916597,_0x190da7)=>{var _0x438010=_0x51aff8;_0x20cad4[_0x190da7][_0x438010(0x136)]=_0x916597;}),_0x1413da['forEach']((_0x4440c6,_0x3c4ad6)=>{_0x20cad4[_0x3c4ad6]['bin']=_0x4440c6;}),_0x220ffe[_0x51aff8(0x144)]((_0x14c2cd,_0x2499a7)=>{_0x20cad4[_0x2499a7]['type']=_0x14c2cd;}),_0xe1abb0['forEach']((_0x1612f9,_0x567137)=>{_0x20cad4[_0x567137]['floorlevel']=_0x1612f9;});var _0x294eab=0x0;_0x20cad4[_0x51aff8(0x144)](_0x5016a0=>{var _0x52ac53=_0x51aff8;console[_0x52ac53(0x167)](_0x52ac53(0x171),_0x5016a0),(parseInt(_0x5016a0[_0x52ac53(0x198)])<parseInt(_0x5016a0[_0x52ac53(0x132)])||parseInt(_0x5016a0[_0x52ac53(0x194)])<parseInt(_0x5016a0[_0x52ac53(0x132)])&&parseInt(_0x5016a0[_0x52ac53(0x198)])>parseInt(_0x5016a0['return_qty'])||parseInt(_0x5016a0[_0x52ac53(0x132)])==0x0)&&_0x294eab++;});if(_0x294eab!=0x0)return _0x1bd516[_0x51aff8(0x163)](_0x51aff8(0x143),_0x51aff8(0x18e)),_0x4946d7['redirect'](_0x51aff8(0x1a4));_0x4fa9e1[_0x51aff8(0x14f)][_0x51aff8(0x144)](_0x450452=>{var _0x27eeaf=_0x51aff8;const _0x493c43=_0x4189a6[_0x27eeaf(0x154)][_0x27eeaf(0x13a)](_0x4ff924=>{var _0x14be23=_0x27eeaf;_0x4ff924[_0x14be23(0x196)]==_0x450452[_0x14be23(0x196)]&&_0x4ff924[_0x14be23(0x184)]==_0x450452['floorlevel']&&_0x4ff924['type']==_0x450452[_0x14be23(0x12b)]&&_0x4ff924[_0x14be23(0x138)]==_0x450452[_0x14be23(0x138)]&&_0x4ff924['bay']==_0x450452[_0x14be23(0x136)]&&(_0x4ff924[_0x14be23(0x12a)]=parseInt(_0x4ff924[_0x14be23(0x12a)])+parseInt(_0x450452[_0x14be23(0x132)]));});}),console[_0x51aff8(0x167)](_0x51aff8(0x160),_0x4189a6),await _0x4189a6[_0x51aff8(0x18f)](),_0x4fa9e1['invoice']=_0x1a48b7,_0x4fa9e1[_0x51aff8(0x13d)]=_0x22b913,_0x4fa9e1[_0x51aff8(0x153)]=_0x108a8c,_0x4fa9e1['warehouse_name']=_0x5c63e4,_0x4fa9e1[_0x51aff8(0x14f)]=_0x20cad4,_0x4fa9e1[_0x51aff8(0x177)]=_0x4d83af,_0x4fa9e1[_0x51aff8(0x162)]=_0x3f619e,_0x4fa9e1[_0x51aff8(0x176)]=_0x1d2e71;const _0x46d194=await _0x4fa9e1[_0x51aff8(0x18f)]();console[_0x51aff8(0x167)]('new\x20new_data',_0x46d194);const _0x3aa6a4=await c_payment_data['findOne']({'invoice':_0x1bd516['body']['invoice'],'reason':_0x51aff8(0x13b)});_0x3aa6a4[_0x51aff8(0x14a)]=_0x1bd516[_0x51aff8(0x12f)][_0x51aff8(0x14a)],_0x3aa6a4['date']=_0x1bd516['body'][_0x51aff8(0x153)],await _0x3aa6a4[_0x51aff8(0x18f)](),_0x1bd516['flash'](_0x51aff8(0x164),_0x51aff8(0x148)),_0x4946d7[_0x51aff8(0x158)](_0x51aff8(0x150));}catch(_0x35bc2){console[_0x51aff8(0x167)](_0x35bc2),_0x4946d7[_0x51aff8(0x19e)](0xc8)[_0x51aff8(0x157)]({'message':_0x35bc2['message']});}}),router['post']('/give_payment/:id',auth,async(_0x2f0d45,_0x494906)=>{var _0x348d18=a0_0x17d48d;try{const _0x59db48=_0x2f0d45[_0x348d18(0x197)]['id'],{invoice:_0x1f38c3,customer:_0x43c819,payable_to_customer:_0x6a379d,paid_amount:_0x2a0a4a}=_0x2f0d45[_0x348d18(0x12f)],_0x5af6bb=await sales_return['findById'](_0x59db48);console['log'](_0x348d18(0x15e),_0x5af6bb),console[_0x348d18(0x167)](_0x6a379d),console[_0x348d18(0x167)](_0x2a0a4a);var _0x1ded15=_0x6a379d-_0x2a0a4a;console[_0x348d18(0x167)](_0x348d18(0x183),_0x1ded15),_0x5af6bb[_0x348d18(0x19c)]=parseFloat(_0x2a0a4a)+parseFloat(_0x5af6bb['paid_amount']),_0x5af6bb[_0x348d18(0x186)]=_0x1ded15,console[_0x348d18(0x167)](_0x5af6bb);const _0x301329=await _0x5af6bb[_0x348d18(0x18f)]();console[_0x348d18(0x167)](0x1b207);const _0xa84941=await c_payment_data[_0x348d18(0x15f)]({'invoice':_0x2f0d45[_0x348d18(0x12f)][_0x348d18(0x135)],'reason':_0x348d18(0x13b)});console[_0x348d18(0x167)](_0x348d18(0x16e),_0xa84941),_0xa84941[_0x348d18(0x19b)]=_0x1ded15,await _0xa84941[_0x348d18(0x18f)]();let _0x5de311=new Date(),_0x2054c5=('0'+_0x5de311[_0x348d18(0x147)]())[_0x348d18(0x15d)](-0x2),_0x2912b1=('0'+(_0x5de311[_0x348d18(0x15c)]()+0x1))[_0x348d18(0x15d)](-0x2),_0x577c07=_0x5de311[_0x348d18(0x181)](),_0x3f3cab=_0x577c07+'-'+_0x2912b1+'-'+_0x2054c5;const _0x1f6224=new customer_payment({'invoice':_0x1f38c3,'date':_0x577c07+'-'+_0x2912b1+'-'+_0x2054c5,'customer':_0x43c819,'reason':_0x348d18(0x1a3),'amount':_0x2a0a4a}),_0xa33eae=await _0x1f6224[_0x348d18(0x18f)]();_0x2f0d45[_0x348d18(0x163)](_0x348d18(0x164),_0x348d18(0x19d)),_0x494906[_0x348d18(0x158)]('/sales_return/view');}catch(_0x122626){console[_0x348d18(0x167)](_0x122626);}}),router[a0_0x17d48d(0x18c)]('/invoice/:id',auth,async(_0x49ecd9,_0x5daf96)=>{var _0xc89542=a0_0x17d48d;try{const {username:_0x341964,email:_0xaa4913,role:_0x34a27c}=_0x49ecd9[_0xc89542(0x190)],_0x206968=_0x49ecd9[_0xc89542(0x190)],_0x12972f=await profile['findOne']({'email':_0x206968[_0xc89542(0x16f)]}),_0x1aa9ee=await master_shop[_0xc89542(0x161)]();console[_0xc89542(0x167)](_0xc89542(0x15b),_0x1aa9ee);const _0x3feb5b=_0x49ecd9['params']['id'],_0x48f490=await sales_return[_0xc89542(0x14d)](_0x3feb5b);console['log'](_0x48f490);const _0x56bc52=await customer[_0xc89542(0x15f)]({'name':_0x48f490[_0xc89542(0x13d)]});console[_0xc89542(0x167)](_0x56bc52);if(_0x1aa9ee[0x0][_0xc89542(0x16c)]==_0xc89542(0x189)){var _0x41e040=users[_0xc89542(0x193)];console[_0xc89542(0x167)](_0x41e040);}else{if(_0x1aa9ee[0x0]['language']==_0xc89542(0x13c))var _0x41e040=users[_0xc89542(0x13c)];else{if(_0x1aa9ee[0x0][_0xc89542(0x16c)]==_0xc89542(0x18a))var _0x41e040=users[_0xc89542(0x18a)];else{if(_0x1aa9ee[0x0][_0xc89542(0x16c)]==_0xc89542(0x14e))var _0x41e040=users[_0xc89542(0x14e)];else{if(_0x1aa9ee[0x0]['language']==_0xc89542(0x12c))var _0x41e040=users[_0xc89542(0x12c)];else{if(_0x1aa9ee[0x0][_0xc89542(0x16c)]==_0xc89542(0x145))var _0x41e040=users[_0xc89542(0x131)];else{if(_0x1aa9ee[0x0][_0xc89542(0x16c)]==_0xc89542(0x18b))var _0x41e040=users[_0xc89542(0x18b)];else{if(_0x1aa9ee[0x0]['language']=='Arabic\x20(ae)')var _0x41e040=users[_0xc89542(0x139)];}}}}}}}_0x5daf96[_0xc89542(0x13e)](_0xc89542(0x168),{'success':_0x49ecd9[_0xc89542(0x163)]('success'),'errors':_0x49ecd9[_0xc89542(0x163)](_0xc89542(0x143)),'role':_0x206968,'profile':_0x12972f,'master_shop':_0x1aa9ee,'customers':_0x56bc52,'sales':_0x48f490,'language':_0x41e040});}catch(_0x3b1992){console[_0xc89542(0x167)](_0x3b1992);}}),module[a0_0x17d48d(0x182)]=router;function a0_0x4ed5(_0xf42702,_0x452eec){var _0x4db9e6=a0_0x4db9();return a0_0x4ed5=function(_0x4ed52c,_0x13033a){_0x4ed52c=_0x4ed52c-0x12a;var _0x1552cc=_0x4db9e6[_0x4ed52c];return _0x1552cc;},a0_0x4ed5(_0xf42702,_0x452eec);}function a0_0x4db9(){var _0x5155b6=['2291016WAJRWh','master','getMonth','slice','data','findOne','old_warehouse_data','find','ToWarehouse','flash','success','$product_details.primary_code','product_name_QA','log','sales_return_invoice','$product_details.product_code','old_data','primary_code','language','stocks','c_payment','email','post','foreach\x20newproduct','../public/language/languages.json','stocks_QA','secondary_code_QA','12WjDQXV','ToRoom','note','product_code_QA','$product_details.product_stock','../models/all_models','$product_details.storage','61174Ltgtex','secondary_code','1296387FTsjyx','Enabled','../middleware/auth','getFullYear','exports','subtract','floorlevel','194037LsKwZr','due_amount','string','customer_docs','English\x20(US)','German','Chinese','get','3986360VzbaOD','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','save','user','6559531MDdZAy','primary_code_QA','English','stock','sales_quantity_QA','product_name','params','sale_qty','message','QA\x20Warehouse','amount','paid_amount','payment\x20successfull','status','/view/:id','$customer_docs','Arabic\x20(ae)','$product_details._id','Returned\x20Payment\x20For\x20Sale\x20Return','back','product_stock','type','French','types','40FGUxwe','body','return_sale_edit_finished','Portuguese','return_qty','1212BwmfQO','2845ieFztN','invoice','bay','return_sale_QA','bin','Arabic','map','Sale\x20Return','Hindi','customer','render','sales_quantity','return_qty_QA','product_code','Return\x20Rooms','errors','forEach','Portuguese\x20(BR)','$product_details.rack','getDate','purchase\x20return\x20successfully','20rrrqLQ','suppliers','$product_details.product_name','$product_details.bay','findById','Spanish','return_sale','/sales_return/view','aggregate','express','date','product_details','$product_details.type','1YQjstd','json','redirect','$name'];a0_0x4db9=function(){return _0x5155b6;};return a0_0x4db9();}