var a0_0x28d04a=a0_0x5c8c;function a0_0x5c8c(_0x3842ec,_0x59aad7){var _0x2f5121=a0_0x2f51();return a0_0x5c8c=function(_0x5c8c11,_0x4ac266){_0x5c8c11=_0x5c8c11-0x141;var _0xdeb057=_0x2f5121[_0x5c8c11];return _0xdeb057;},a0_0x5c8c(_0x3842ec,_0x59aad7);}function a0_0x2f51(){var _0x42f1de=['product_stock','back','stocks_QA','/sales_return_finished/view','json','data','express','Hindi','$product_details.bay','render','Arabic','map','c_payment','French','type','English','/give_payment/:id','return_sale_edit_finished','sales_return_finished','getDate','old_warehouse_data','language','16tBPzkD','1006346gCClIb','../middleware/auth','Enabled','getFullYear','$product_details.floorlevel','floorlevel','primary_code','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','warehouse_name','new\x20new_data','types','status','product_code','aggregate','Return\x20Rooms','params','secondary_code','return_qty_QA','body','primary_code_QA','bin','product_details','invoice','success','667473hEKqwQ','German','flash','find','findOne','getMonth','errors','master','redirect','$product_details.primary_code','QA\x20Warehouse','sales_return_invoice','/view','slice','forEach','sales_quantity_QA','return_sale','return_qty','$product_details.product_stock','Arabic\x20(ae)','product_code_QA','$customer_docs','payment\x20successfull','855970tfYMXK','286kTAEtv','$product_details.product_code','Chinese','../models/all_models','$product_details.product_name','Sale\x20Return','product_name','post','Returned\x20Payment\x20For\x20Sale\x20Return','user','stock','ToRoom','sales_quantity','$product_details.bin','647BtsZqV','return_sale_QA','$product_details.type','product_name_QA','customer','English\x20(US)','Spanish','stocks','/invoice/:id','paid_amount','purchase\x20return\x20successfully','findById','6fyOUbO','210770bBZsda','log','subtract','18RjBANu','date','save','customers','953939eDHTtk','suppliers','ToWarehouse','message','foreach\x20newproduct','1656736KDRlDr','amount','Portuguese\x20(BR)','sale_qty','bay','email','$product_details._id','string','get','Router','/view/:id','customer_docs','$name'];a0_0x2f51=function(){return _0x42f1de;};return a0_0x2f51();}(function(_0xeafa44,_0x188885){var _0x2f3e76=a0_0x5c8c,_0x2c6f94=_0xeafa44();while(!![]){try{var _0x4703e3=-parseInt(_0x2f3e76(0x197))/0x1*(parseInt(_0x2f3e76(0x189))/0x2)+-parseInt(_0x2f3e76(0x171))/0x3+parseInt(_0x2f3e76(0x158))/0x4*(-parseInt(_0x2f3e76(0x1a4))/0x5)+-parseInt(_0x2f3e76(0x1a3))/0x6*(-parseInt(_0x2f3e76(0x1ab))/0x7)+parseInt(_0x2f3e76(0x1b0))/0x8+parseInt(_0x2f3e76(0x1a7))/0x9*(parseInt(_0x2f3e76(0x188))/0xa)+parseInt(_0x2f3e76(0x159))/0xb;if(_0x4703e3===_0x188885)break;else _0x2c6f94['push'](_0x2c6f94['shift']());}catch(_0x3c43f1){_0x2c6f94['push'](_0x2c6f94['shift']());}}}(a0_0x2f51,0x1de35));const express=require(a0_0x28d04a(0x148)),app=express(),router=express[a0_0x28d04a(0x1b9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x28d04a(0x18c)),auth=require(a0_0x28d04a(0x15a)),users=require('../public/language/languages.json');router[a0_0x28d04a(0x1b8)](a0_0x28d04a(0x17d),auth,async(_0x2eee54,_0x237e46)=>{var _0x18dca2=a0_0x28d04a;try{const {username:_0x42879c,email:_0x21eeab,role:_0x4cc97f}=_0x2eee54[_0x18dca2(0x192)],_0x46257c=_0x2eee54['user'],_0x294cc5=await profile[_0x18dca2(0x175)]({'email':_0x46257c[_0x18dca2(0x1b5)]}),_0x49bf6b=await master_shop[_0x18dca2(0x174)](),_0x1f860d=await sales_return_finished['aggregate']([{'$lookup':{'from':_0x18dca2(0x1aa),'localField':_0x18dca2(0x19b),'foreignField':'name','as':_0x18dca2(0x1bb)}},{'$unwind':_0x18dca2(0x186)}]);if(_0x49bf6b[0x0][_0x18dca2(0x157)]==_0x18dca2(0x19c)){var _0x37b7ac=users[_0x18dca2(0x151)];console['log'](_0x37b7ac);}else{if(_0x49bf6b[0x0][_0x18dca2(0x157)]=='Hindi')var _0x37b7ac=users['Hindi'];else{if(_0x49bf6b[0x0]['language']==_0x18dca2(0x172))var _0x37b7ac=users[_0x18dca2(0x172)];else{if(_0x49bf6b[0x0]['language']=='Spanish')var _0x37b7ac=users[_0x18dca2(0x19d)];else{if(_0x49bf6b[0x0][_0x18dca2(0x157)]==_0x18dca2(0x14f))var _0x37b7ac=users['French'];else{if(_0x49bf6b[0x0]['language']==_0x18dca2(0x1b2))var _0x37b7ac=users['Portuguese'];else{if(_0x49bf6b[0x0][_0x18dca2(0x157)]=='Chinese')var _0x37b7ac=users['Chinese'];else{if(_0x49bf6b[0x0][_0x18dca2(0x157)]==_0x18dca2(0x184))var _0x37b7ac=users[_0x18dca2(0x14c)];}}}}}}}_0x237e46[_0x18dca2(0x14b)](_0x18dca2(0x154),{'success':_0x2eee54[_0x18dca2(0x173)](_0x18dca2(0x170)),'errors':_0x2eee54[_0x18dca2(0x173)](_0x18dca2(0x177)),'role':_0x46257c,'profile':_0x294cc5,'master_shop':_0x49bf6b,'user':_0x1f860d,'language':_0x37b7ac});}catch(_0x28f234){console[_0x18dca2(0x1a5)](_0x28f234);}}),router['get'](a0_0x28d04a(0x1ba),auth,async(_0x68ab5e,_0x512091)=>{var _0x53d6ae=a0_0x28d04a;try{const {username:_0x30818f,email:_0x2a3af1,role:_0x5b9141}=_0x68ab5e['user'],_0x2e7664=_0x68ab5e[_0x53d6ae(0x192)],_0x37528f=await profile['findOne']({'email':_0x2e7664[_0x53d6ae(0x1b5)]}),_0x4518ec=await master_shop['find']();console[_0x53d6ae(0x1a5)](_0x53d6ae(0x178),_0x4518ec);const _0x22e46a=_0x68ab5e[_0x53d6ae(0x168)]['id'];console['log'](_0x22e46a);var _0x442636=[_0x53d6ae(0x167)];const _0x43d4ef=await sales_return_finished['findById'](_0x22e46a),_0xf5bf7d=await warehouse['aggregate']([{'$match':{'name':_0x43d4ef[_0x53d6ae(0x1ad)],'room':_0x43d4ef[_0x53d6ae(0x194)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x53d6ae(0x1b6),'name':{'$first':_0x53d6ae(0x18d)},'product_stock':{'$first':_0x53d6ae(0x183)},'bay':{'$first':_0x53d6ae(0x14a)},'bin':{'$first':_0x53d6ae(0x196)},'type':{'$first':_0x53d6ae(0x199)},'floorlevel':{'$first':_0x53d6ae(0x15d)},'primary_code':{'$first':_0x53d6ae(0x17a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x53d6ae(0x18a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]);console[_0x53d6ae(0x1a5)](_0xf5bf7d);const _0x248f26=await warehouse[_0x53d6ae(0x166)]([{'$match':{'status':_0x53d6ae(0x15b),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':'$name','name':{'$first':_0x53d6ae(0x141)}}},{'$sort':{'name':0x1}}]),_0x3b5329=await warehouse[_0x53d6ae(0x166)]([{'$match':{'status':_0x53d6ae(0x15b),'name':_0x53d6ae(0x17b)}},{'$group':{'_id':_0x53d6ae(0x141),'name':{'$first':_0x53d6ae(0x141)}}},{'$sort':{'name':0x1}}]),_0x4c2705=await product[_0x53d6ae(0x174)]({});if(_0x4518ec[0x0][_0x53d6ae(0x157)]=='English\x20(US)'){var _0x2a8a5c=users[_0x53d6ae(0x151)];console[_0x53d6ae(0x1a5)](_0x2a8a5c);}else{if(_0x4518ec[0x0][_0x53d6ae(0x157)]==_0x53d6ae(0x149))var _0x2a8a5c=users['Hindi'];else{if(_0x4518ec[0x0][_0x53d6ae(0x157)]==_0x53d6ae(0x172))var _0x2a8a5c=users[_0x53d6ae(0x172)];else{if(_0x4518ec[0x0][_0x53d6ae(0x157)]==_0x53d6ae(0x19d))var _0x2a8a5c=users[_0x53d6ae(0x19d)];else{if(_0x4518ec[0x0]['language']=='French')var _0x2a8a5c=users[_0x53d6ae(0x14f)];else{if(_0x4518ec[0x0][_0x53d6ae(0x157)]==_0x53d6ae(0x1b2))var _0x2a8a5c=users['Portuguese'];else{if(_0x4518ec[0x0][_0x53d6ae(0x157)]==_0x53d6ae(0x18b))var _0x2a8a5c=users['Chinese'];else{if(_0x4518ec[0x0][_0x53d6ae(0x157)]==_0x53d6ae(0x184))var _0x2a8a5c=users['Arabic'];}}}}}}}_0x512091['render'](_0x53d6ae(0x153),{'success':_0x68ab5e['flash']('success'),'errors':_0x68ab5e[_0x53d6ae(0x173)]('errors'),'role':_0x2e7664,'profile':_0x37528f,'master_shop':_0x4518ec,'user':_0x43d4ef,'stock':_0xf5bf7d,'unit':_0x4c2705,'language':_0x2a8a5c,'warehouses':_0x248f26,'rooms':_0x442636,'warehouse_QA':_0x3b5329});}catch(_0x1bba08){console['log'](_0x1bba08);}}),router[a0_0x28d04a(0x190)]('/view/:id',auth,async(_0x4f752d,_0x55d824)=>{var _0x281cbc=a0_0x28d04a;if(_0x4f752d['body']['for_categorize']=='QA')try{const _0x53538d=_0x4f752d[_0x281cbc(0x168)]['id'],_0x4b7f26=await sales_return[_0x281cbc(0x175)]({'invoice':_0x4f752d['body'][_0x281cbc(0x16f)]}),_0xc0db8f=await warehouse['findOne']({'name':_0x4b7f26['ToWarehouse'],'room':_0x4b7f26[_0x281cbc(0x194)]}),{invoice:_0x1227f7,customer:_0x5c783e,date:_0x4de805,warehouse_name:_0x43be39,product_name:_0x4c3fef,primary_code:_0x219bdf,secondary_code:_0x3d50da,product_code:_0x21ee48,sales_quantity:_0x235563,stocks:_0x659bdd,return_qty:_0x2559e0,note:_0x5ead07,to_warehouse_name_QA:_0x3c4009,to_Room_name_QA:_0x5e4a8c}=_0x4f752d[_0x281cbc(0x16b)];if(typeof product_name_QA==_0x281cbc(0x1b7))var _0x26f44a=[_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x19a)]],_0x3c63c4=[_0x4f752d[_0x281cbc(0x16b)]['primary_code_QA']],_0x517eed=[_0x4f752d[_0x281cbc(0x16b)]['secondary_code_QA']],_0x5b1f50=[_0x4f752d['body'][_0x281cbc(0x185)]],_0x123403=[_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x180)]],_0x298f14=[_0x4f752d[_0x281cbc(0x16b)]['stocks_QA']],_0x2ba8d4=[_0x4f752d['body'][_0x281cbc(0x16a)]];else var _0x26f44a=[..._0x4f752d[_0x281cbc(0x16b)]['product_name_QA']],_0x3c63c4=[..._0x4f752d['body'][_0x281cbc(0x16c)]],_0x517eed=[..._0x4f752d['body']['secondary_code_QA']],_0x5b1f50=[..._0x4f752d['body'][_0x281cbc(0x185)]],_0x123403=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x180)]],_0x298f14=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x144)]],_0x2ba8d4=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x16a)]];const _0x368624=_0x26f44a[_0x281cbc(0x14d)](_0x1f22ce=>{return _0x1f22ce={'product_name':_0x1f22ce};});_0x3c63c4['forEach']((_0x4fd417,_0x1ac5ff)=>{var _0x163b20=_0x281cbc;_0x368624[_0x1ac5ff][_0x163b20(0x15f)]=_0x4fd417;}),_0x517eed[_0x281cbc(0x17f)]((_0x280de9,_0x3ea8bc)=>{var _0x3b5d5d=_0x281cbc;_0x368624[_0x3ea8bc][_0x3b5d5d(0x169)]=_0x280de9;}),_0x5b1f50[_0x281cbc(0x17f)]((_0x47fc82,_0x47ef43)=>{var _0x3cc752=_0x281cbc;_0x368624[_0x47ef43][_0x3cc752(0x165)]=_0x47fc82;}),_0x123403['forEach']((_0xbd5790,_0x28296e)=>{var _0xea431e=_0x281cbc;_0x368624[_0x28296e][_0xea431e(0x1b3)]=_0xbd5790;}),_0x298f14['forEach']((_0xb52f7,_0x19f706)=>{var _0x633a5d=_0x281cbc;_0x368624[_0x19f706][_0x633a5d(0x193)]=_0xb52f7;}),_0x2ba8d4[_0x281cbc(0x17f)]((_0x2adc88,_0x3b9e9e)=>{_0x368624[_0x3b9e9e]['return_qty']=_0x2adc88;}),_0x4b7f26['return_sale_QA']['forEach'](_0x2d65e6=>{var _0x578977=_0x281cbc;const _0x476584=_0xc0db8f[_0x578977(0x16e)][_0x578977(0x14d)](_0x962452=>{var _0x101781=_0x578977;_0x962452[_0x101781(0x18f)]==_0x2d65e6[_0x101781(0x18f)]&&(_0x962452[_0x101781(0x142)]=parseInt(_0x962452[_0x101781(0x142)])+parseInt(_0x2d65e6['return_qty']));});}),await _0xc0db8f[_0x281cbc(0x1a9)](),_0x4b7f26[_0x281cbc(0x16f)]=_0x1227f7,_0x4b7f26['customer']=_0x5c783e,_0x4b7f26['date']=_0x4de805,_0x4b7f26[_0x281cbc(0x161)]=_0x43be39,_0x4b7f26[_0x281cbc(0x198)]=_0x368624,_0x4b7f26['note']=_0x5ead07,_0x4b7f26['ToWarehouse']=_0x3c4009,_0x4b7f26[_0x281cbc(0x194)]=_0x5e4a8c;const _0x513dd0=await _0x4b7f26[_0x281cbc(0x1a9)](),_0x5ac19b=await c_payment_data[_0x281cbc(0x175)]({'invoice':_0x4f752d['body'][_0x281cbc(0x16f)],'reason':_0x281cbc(0x18e)});_0x5ac19b[_0x281cbc(0x1ac)]=_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x1ac)],_0x5ac19b[_0x281cbc(0x1a8)]=_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x1a8)],await _0x5ac19b['save'](),_0x4f752d[_0x281cbc(0x173)](_0x281cbc(0x170),'purchase\x20return\x20successfully'),_0x55d824[_0x281cbc(0x179)](_0x281cbc(0x145));}catch(_0x402fca){console[_0x281cbc(0x1a5)](_0x402fca),_0x55d824['status'](0xc8)[_0x281cbc(0x146)]({'message':_0x402fca[_0x281cbc(0x1ae)]});}else try{const _0x52519c=_0x4f752d[_0x281cbc(0x168)]['id'];console[_0x281cbc(0x1a5)](_0x52519c);const _0x11194d=await sales_return[_0x281cbc(0x175)]({'invoice':_0x4f752d['body'][_0x281cbc(0x16f)]});console[_0x281cbc(0x1a5)]('old_data',_0x11194d);const _0x30a202=await warehouse[_0x281cbc(0x175)]({'name':_0x11194d[_0x281cbc(0x1ad)],'room':_0x11194d[_0x281cbc(0x194)]});console[_0x281cbc(0x1a5)](_0x281cbc(0x156),_0x30a202);const {invoice:_0xfe1f7b,customer:_0x2205f7,date:_0x25ec28,warehouse_name:_0x2ffbbd,product_name:_0x4af0c0,primary_code:_0xf21189,secondary_code:_0x2fa211,product_code:_0x4786bb,sales_quantity:_0x2e60ec,stocks:_0x553e9a,return_qty:_0x52a7e8,note:_0x2d4c35,to_warehouse_name:_0x7310f7,to_Room_name:_0x58e2b4}=_0x4f752d['body'];console[_0x281cbc(0x1a5)](_0x4f752d[_0x281cbc(0x16b)]);if(typeof _0x4af0c0=='string')var _0x26f44a=[_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x18f)]],_0x3c63c4=[_0x4f752d['body'][_0x281cbc(0x15f)]],_0x517eed=[_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x169)]],_0x5b1f50=[_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x165)]],_0x123403=[_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x195)]],_0x298f14=[_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x19e)]],_0x2ba8d4=[_0x4f752d['body'][_0x281cbc(0x182)]],_0x222b8a=[_0x4f752d['body'][_0x281cbc(0x1b4)]],_0x1e8555=[_0x4f752d['body'][_0x281cbc(0x16d)]],_0x2c5ab2=[_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x163)]],_0x3b3e3c=[_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x15e)]];else var _0x26f44a=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x18f)]],_0x3c63c4=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x15f)]],_0x517eed=[..._0x4f752d['body']['secondary_code']],_0x5b1f50=[..._0x4f752d['body'][_0x281cbc(0x165)]],_0x123403=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x195)]],_0x298f14=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x19e)]],_0x2ba8d4=[..._0x4f752d[_0x281cbc(0x16b)]['return_qty']],_0x222b8a=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x1b4)]],_0x1e8555=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x16d)]],_0x2c5ab2=[..._0x4f752d['body']['types']],_0x3b3e3c=[..._0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x15e)]];const _0xe3f526=_0x26f44a[_0x281cbc(0x14d)](_0x5d05a6=>{return _0x5d05a6={'product_name':_0x5d05a6};});_0x3c63c4['forEach']((_0x49857c,_0x537cab)=>{var _0x57e605=_0x281cbc;_0xe3f526[_0x537cab][_0x57e605(0x15f)]=_0x49857c;}),_0x517eed[_0x281cbc(0x17f)]((_0x1bc37d,_0x2ae844)=>{var _0x2c780f=_0x281cbc;_0xe3f526[_0x2ae844][_0x2c780f(0x169)]=_0x1bc37d;}),_0x5b1f50[_0x281cbc(0x17f)]((_0x1e38a1,_0x1d7400)=>{var _0x3a0364=_0x281cbc;_0xe3f526[_0x1d7400][_0x3a0364(0x165)]=_0x1e38a1;}),_0x123403[_0x281cbc(0x17f)]((_0x57cfc1,_0x52eb3c)=>{var _0x4c6d8b=_0x281cbc;_0xe3f526[_0x52eb3c][_0x4c6d8b(0x1b3)]=_0x57cfc1;}),_0x298f14[_0x281cbc(0x17f)]((_0x5e8740,_0x280e84)=>{var _0x18edd4=_0x281cbc;_0xe3f526[_0x280e84][_0x18edd4(0x193)]=_0x5e8740;}),_0x2ba8d4[_0x281cbc(0x17f)]((_0x1ac60e,_0x11e0a9)=>{_0xe3f526[_0x11e0a9]['return_qty']=_0x1ac60e;}),_0x222b8a[_0x281cbc(0x17f)]((_0x12d9ec,_0x506295)=>{var _0x591c89=_0x281cbc;_0xe3f526[_0x506295][_0x591c89(0x1b4)]=_0x12d9ec;}),_0x1e8555[_0x281cbc(0x17f)]((_0x17b812,_0x4954d1)=>{var _0x6fa96=_0x281cbc;_0xe3f526[_0x4954d1][_0x6fa96(0x16d)]=_0x17b812;}),_0x2c5ab2[_0x281cbc(0x17f)]((_0x296115,_0x2f0855)=>{var _0x56e497=_0x281cbc;_0xe3f526[_0x2f0855][_0x56e497(0x150)]=_0x296115;}),_0x3b3e3c[_0x281cbc(0x17f)]((_0x5526d3,_0x346491)=>{var _0x428fe6=_0x281cbc;_0xe3f526[_0x346491][_0x428fe6(0x15e)]=_0x5526d3;});var _0x4e5b08=0x0;_0xe3f526[_0x281cbc(0x17f)](_0x1cbdbf=>{var _0x25c098=_0x281cbc;console[_0x25c098(0x1a5)](_0x25c098(0x1af),_0x1cbdbf),(parseInt(_0x1cbdbf[_0x25c098(0x1b3)])<parseInt(_0x1cbdbf[_0x25c098(0x182)])||parseInt(_0x1cbdbf[_0x25c098(0x193)])<parseInt(_0x1cbdbf[_0x25c098(0x182)])&&parseInt(_0x1cbdbf[_0x25c098(0x1b3)])>parseInt(_0x1cbdbf[_0x25c098(0x182)])||parseInt(_0x1cbdbf[_0x25c098(0x182)])==0x0)&&_0x4e5b08++;});if(_0x4e5b08!=0x0)return _0x4f752d[_0x281cbc(0x173)](_0x281cbc(0x177),_0x281cbc(0x160)),_0x55d824['redirect'](_0x281cbc(0x143));_0x11194d[_0x281cbc(0x181)]['forEach'](_0x2b4686=>{var _0x510f2b=_0x281cbc;const _0x4af3a0=_0x30a202[_0x510f2b(0x16e)][_0x510f2b(0x14d)](_0x4bfe69=>{var _0x1fbbca=_0x510f2b;_0x4bfe69[_0x1fbbca(0x18f)]==_0x2b4686['product_name']&&_0x4bfe69[_0x1fbbca(0x15e)]==_0x2b4686[_0x1fbbca(0x15e)]&&_0x4bfe69[_0x1fbbca(0x150)]==_0x2b4686[_0x1fbbca(0x150)]&&_0x4bfe69['bin']==_0x2b4686[_0x1fbbca(0x16d)]&&_0x4bfe69[_0x1fbbca(0x1b4)]==_0x2b4686[_0x1fbbca(0x1b4)]&&(_0x4bfe69[_0x1fbbca(0x142)]=parseInt(_0x4bfe69[_0x1fbbca(0x142)])+parseInt(_0x2b4686['return_qty']));});}),console[_0x281cbc(0x1a5)]('old_warehouse_data',_0x30a202),await _0x30a202['save'](),_0x11194d[_0x281cbc(0x16f)]=_0xfe1f7b,_0x11194d['customer']=_0x2205f7,_0x11194d[_0x281cbc(0x1a8)]=_0x25ec28,_0x11194d[_0x281cbc(0x161)]=_0x2ffbbd,_0x11194d['return_sale']=_0xe3f526,_0x11194d['note']=_0x2d4c35,_0x11194d[_0x281cbc(0x1ad)]=_0x7310f7,_0x11194d[_0x281cbc(0x194)]=_0x58e2b4;const _0x434091=await _0x11194d[_0x281cbc(0x1a9)]();console['log'](_0x281cbc(0x162),_0x434091);const _0x3947e0=await c_payment_data[_0x281cbc(0x175)]({'invoice':_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x16f)],'reason':_0x281cbc(0x18e)});_0x3947e0['suppliers']=_0x4f752d[_0x281cbc(0x16b)][_0x281cbc(0x1ac)],_0x3947e0[_0x281cbc(0x1a8)]=_0x4f752d['body'][_0x281cbc(0x1a8)],await _0x3947e0[_0x281cbc(0x1a9)](),_0x4f752d[_0x281cbc(0x173)](_0x281cbc(0x170),_0x281cbc(0x1a1)),_0x55d824[_0x281cbc(0x179)]('/sales_return/view');}catch(_0x33385b){console[_0x281cbc(0x1a5)](_0x33385b),_0x55d824[_0x281cbc(0x164)](0xc8)[_0x281cbc(0x146)]({'message':_0x33385b['message']});}}),router[a0_0x28d04a(0x190)](a0_0x28d04a(0x152),auth,async(_0x5af73c,_0x3fef03)=>{var _0xd5398=a0_0x28d04a;try{const _0xd436b4=_0x5af73c[_0xd5398(0x168)]['id'],{invoice:_0x1472d7,customer:_0x2a5475,payable_to_customer:_0x2a267d,paid_amount:_0xae97b3}=_0x5af73c[_0xd5398(0x16b)],_0x33f974=await sales_return[_0xd5398(0x1a2)](_0xd436b4);console['log'](_0xd5398(0x147),_0x33f974),console[_0xd5398(0x1a5)](_0x2a267d),console[_0xd5398(0x1a5)](_0xae97b3);var _0x48b250=_0x2a267d-_0xae97b3;console[_0xd5398(0x1a5)](_0xd5398(0x1a6),_0x48b250),_0x33f974[_0xd5398(0x1a0)]=parseFloat(_0xae97b3)+parseFloat(_0x33f974[_0xd5398(0x1a0)]),_0x33f974['due_amount']=_0x48b250,console[_0xd5398(0x1a5)](_0x33f974);const _0x5b2772=await _0x33f974[_0xd5398(0x1a9)]();console[_0xd5398(0x1a5)](0x1b207);const _0x281919=await c_payment_data['findOne']({'invoice':_0x5af73c['body'][_0xd5398(0x16f)],'reason':'Sale\x20Return'});console[_0xd5398(0x1a5)](_0xd5398(0x14e),_0x281919),_0x281919[_0xd5398(0x1b1)]=_0x48b250,await _0x281919['save']();let _0x599a29=new Date(),_0x1cdb72=('0'+_0x599a29[_0xd5398(0x155)]())[_0xd5398(0x17e)](-0x2),_0x5e3398=('0'+(_0x599a29[_0xd5398(0x176)]()+0x1))[_0xd5398(0x17e)](-0x2),_0x1086dd=_0x599a29[_0xd5398(0x15c)](),_0x568b13=_0x1086dd+'-'+_0x5e3398+'-'+_0x1cdb72;const _0x42c404=new customer_payment({'invoice':_0x1472d7,'date':_0x1086dd+'-'+_0x5e3398+'-'+_0x1cdb72,'customer':_0x2a5475,'reason':_0xd5398(0x191),'amount':_0xae97b3}),_0x4afef0=await _0x42c404[_0xd5398(0x1a9)]();_0x5af73c[_0xd5398(0x173)](_0xd5398(0x170),_0xd5398(0x187)),_0x3fef03['redirect']('/sales_return/view');}catch(_0x106113){console[_0xd5398(0x1a5)](_0x106113);}}),router[a0_0x28d04a(0x1b8)](a0_0x28d04a(0x19f),auth,async(_0x137fab,_0x1aae32)=>{var _0x2561d5=a0_0x28d04a;try{const {username:_0x246717,email:_0x59aa2f,role:_0x21701c}=_0x137fab[_0x2561d5(0x192)],_0x398a53=_0x137fab[_0x2561d5(0x192)],_0x2d7ff2=await profile[_0x2561d5(0x175)]({'email':_0x398a53[_0x2561d5(0x1b5)]}),_0x20d972=await master_shop[_0x2561d5(0x174)]();console['log']('master',_0x20d972);const _0x33a82c=_0x137fab['params']['id'],_0x35fe73=await sales_return['findById'](_0x33a82c);console[_0x2561d5(0x1a5)](_0x35fe73);const _0x1fccf5=await customer['findOne']({'name':_0x35fe73[_0x2561d5(0x19b)]});console['log'](_0x1fccf5);if(_0x20d972[0x0][_0x2561d5(0x157)]==_0x2561d5(0x19c)){var _0x4c922d=users[_0x2561d5(0x151)];console[_0x2561d5(0x1a5)](_0x4c922d);}else{if(_0x20d972[0x0]['language']==_0x2561d5(0x149))var _0x4c922d=users[_0x2561d5(0x149)];else{if(_0x20d972[0x0][_0x2561d5(0x157)]==_0x2561d5(0x172))var _0x4c922d=users[_0x2561d5(0x172)];else{if(_0x20d972[0x0]['language']==_0x2561d5(0x19d))var _0x4c922d=users[_0x2561d5(0x19d)];else{if(_0x20d972[0x0][_0x2561d5(0x157)]=='French')var _0x4c922d=users[_0x2561d5(0x14f)];else{if(_0x20d972[0x0][_0x2561d5(0x157)]==_0x2561d5(0x1b2))var _0x4c922d=users['Portuguese'];else{if(_0x20d972[0x0]['language']=='Chinese')var _0x4c922d=users[_0x2561d5(0x18b)];else{if(_0x20d972[0x0][_0x2561d5(0x157)]=='Arabic\x20(ae)')var _0x4c922d=users['Arabic'];}}}}}}}_0x1aae32['render'](_0x2561d5(0x17c),{'success':_0x137fab[_0x2561d5(0x173)](_0x2561d5(0x170)),'errors':_0x137fab[_0x2561d5(0x173)](_0x2561d5(0x177)),'role':_0x398a53,'profile':_0x2d7ff2,'master_shop':_0x20d972,'customers':_0x1fccf5,'sales':_0x35fe73,'language':_0x4c922d});}catch(_0x5e76d3){console['log'](_0x5e76d3);}}),module['exports']=router;