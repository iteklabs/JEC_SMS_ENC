var a0_0x1f6467=a0_0x1f2e;(function(_0x57c9d2,_0x2ed979){var _0x168d70=a0_0x1f2e,_0x372a84=_0x57c9d2();while(!![]){try{var _0x5ae84d=-parseInt(_0x168d70(0x101))/0x1*(-parseInt(_0x168d70(0x108))/0x2)+-parseInt(_0x168d70(0x127))/0x3*(parseInt(_0x168d70(0x124))/0x4)+-parseInt(_0x168d70(0xf6))/0x5*(parseInt(_0x168d70(0xfd))/0x6)+-parseInt(_0x168d70(0x10b))/0x7+parseInt(_0x168d70(0xd4))/0x8*(parseInt(_0x168d70(0x11a))/0x9)+-parseInt(_0x168d70(0x105))/0xa*(-parseInt(_0x168d70(0x103))/0xb)+-parseInt(_0x168d70(0x146))/0xc*(parseInt(_0x168d70(0x140))/0xd);if(_0x5ae84d===_0x2ed979)break;else _0x372a84['push'](_0x372a84['shift']());}catch(_0x315f07){_0x372a84['push'](_0x372a84['shift']());}}}(a0_0x2924,0xc5d29));function a0_0x2924(){var _0x297421=['product_details','$product_details.product_code','c_payment','4721ckfZxR','product_code_QA','18953vvXBmd','due_amount','9370hNpvtE','master','note','482XDpwOu','json','sale_qty','8994706yklAod','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','getMonth','Chinese','post','types','product_name_QA','message','Enabled','find','../models/all_models','sales_return_finished','stocks','suppliers','customer','4305249FmcPAs','stocks_QA','findById','flash','$name','$product_details.product_stock','../public/language/languages.json','get','Arabic\x20(ae)','new\x20new_data','92OEDonH','save','for_categorize','143517vDfnSK','Spanish','map','stock','bay','Sale\x20Return','user','date','product_code','English\x20(US)','$product_details','type','primary_code','success','Hindi','invoice','/view/:id','ToRoom','forEach','$customer_docs','Router','Returned\x20Payment\x20For\x20Sale\x20Return','data','findOne','bin','217139JDEFWD','back','log','/give_payment/:id','$product_details.type','express','456EiAmMl','name','string','exports','French','Portuguese\x20(BR)','$product_details.secondary_code','sales_quantity_QA','floorlevel','Portuguese','return_qty','24GwIOjs','ToWarehouse','QA\x20Warehouse','params','payment\x20successfull','product_stock','English','getDate','$product_details.rack','errors','product_name','aggregate','return_sale_edit_finished','German','purchase\x20return\x20successfully','sales_quantity','email','redirect','/sales_return/view','$product_details.storage','return_sale','status','language','paid_amount','Arabic','$product_details.product_name','getFullYear','secondary_code','slice','body','foreach\x20newproduct','../middleware/auth','/sales_return_finished/view','$product_details.bay','15SmBdVK','old_data','primary_code_QA','Return\x20Rooms','secondary_code_QA','$product_details.floorlevel','render','714090PaLlsh'];a0_0x2924=function(){return _0x297421;};return a0_0x2924();}const express=require(a0_0x1f6467(0x145)),app=express(),router=express[a0_0x1f6467(0x13b)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x1f6467(0x115)),auth=require(a0_0x1f6467(0xf3)),users=require(a0_0x1f6467(0x120));function a0_0x1f2e(_0x458972,_0xb00043){var _0x292446=a0_0x2924();return a0_0x1f2e=function(_0x1f2eee,_0x549d84){_0x1f2eee=_0x1f2eee-0xcf;var _0x10d24c=_0x292446[_0x1f2eee];return _0x10d24c;},a0_0x1f2e(_0x458972,_0xb00043);}router[a0_0x1f6467(0x121)]('/view',auth,async(_0x1e60ad,_0x3fb4bc)=>{var _0x39b2b6=a0_0x1f6467;try{const {username:_0xdc165d,email:_0x3043ca,role:_0x5ac1f7}=_0x1e60ad[_0x39b2b6(0x12d)],_0x3b09be=_0x1e60ad['user'],_0x256364=await profile[_0x39b2b6(0x13e)]({'email':_0x3b09be[_0x39b2b6(0xe4)]}),_0x33d427=await master_shop[_0x39b2b6(0x114)](),_0x328cbd=await sales_return_finished[_0x39b2b6(0xdf)]([{'$lookup':{'from':'customers','localField':_0x39b2b6(0x119),'foreignField':_0x39b2b6(0x147),'as':'customer_docs'}},{'$unwind':_0x39b2b6(0x13a)}]);if(_0x33d427[0x0]['language']==_0x39b2b6(0x130)){var _0xfb335c=users[_0x39b2b6(0xda)];console[_0x39b2b6(0x142)](_0xfb335c);}else{if(_0x33d427[0x0][_0x39b2b6(0xea)]=='Hindi')var _0xfb335c=users[_0x39b2b6(0x135)];else{if(_0x33d427[0x0]['language']=='German')var _0xfb335c=users[_0x39b2b6(0xe1)];else{if(_0x33d427[0x0]['language']==_0x39b2b6(0x128))var _0xfb335c=users[_0x39b2b6(0x128)];else{if(_0x33d427[0x0][_0x39b2b6(0xea)]==_0x39b2b6(0x14a))var _0xfb335c=users['French'];else{if(_0x33d427[0x0]['language']==_0x39b2b6(0x14b))var _0xfb335c=users[_0x39b2b6(0xd2)];else{if(_0x33d427[0x0]['language']=='Chinese')var _0xfb335c=users[_0x39b2b6(0x10e)];else{if(_0x33d427[0x0][_0x39b2b6(0xea)]==_0x39b2b6(0x122))var _0xfb335c=users[_0x39b2b6(0xec)];}}}}}}}_0x3fb4bc['render'](_0x39b2b6(0x116),{'success':_0x1e60ad[_0x39b2b6(0x11d)](_0x39b2b6(0x134)),'errors':_0x1e60ad[_0x39b2b6(0x11d)](_0x39b2b6(0xdd)),'role':_0x3b09be,'profile':_0x256364,'master_shop':_0x33d427,'user':_0x328cbd,'language':_0xfb335c});}catch(_0x5556b3){console[_0x39b2b6(0x142)](_0x5556b3);}}),router['get'](a0_0x1f6467(0x137),auth,async(_0x45f614,_0x3b6ed3)=>{var _0x481f4=a0_0x1f6467;try{const {username:_0x245f8,email:_0x1c4cc4,role:_0x4ccd85}=_0x45f614[_0x481f4(0x12d)],_0x51789e=_0x45f614[_0x481f4(0x12d)],_0x248043=await profile[_0x481f4(0x13e)]({'email':_0x51789e[_0x481f4(0xe4)]}),_0x54d087=await master_shop[_0x481f4(0x114)]();console[_0x481f4(0x142)](_0x481f4(0x106),_0x54d087);const _0x3d15a3=_0x45f614[_0x481f4(0xd7)]['id'];console['log'](_0x3d15a3);var _0x4d9e12=[_0x481f4(0xf9)];const _0x5c9899=await sales_return_finished['findById'](_0x3d15a3),_0x5bd645=await warehouse['aggregate']([{'$match':{'name':_0x5c9899[_0x481f4(0xd5)],'room':_0x5c9899['ToRoom']}},{'$unwind':_0x481f4(0x131)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x481f4(0xed)},'product_stock':{'$first':_0x481f4(0x11f)},'bay':{'$first':_0x481f4(0xf5)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x481f4(0x144)},'floorlevel':{'$first':_0x481f4(0xfb)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x481f4(0xcf)},'product_code':{'$first':_0x481f4(0xff)},'storage':{'$first':_0x481f4(0xe7)},'rack':{'$first':_0x481f4(0xdc)}}}]);console[_0x481f4(0x142)](_0x5bd645);const _0x595f1e=await warehouse['aggregate']([{'$match':{'status':_0x481f4(0x113),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':'$name','name':{'$first':_0x481f4(0x11e)}}},{'$sort':{'name':0x1}}]),_0x505d77=await warehouse[_0x481f4(0xdf)]([{'$match':{'status':_0x481f4(0x113),'name':_0x481f4(0xd6)}},{'$group':{'_id':_0x481f4(0x11e),'name':{'$first':_0x481f4(0x11e)}}},{'$sort':{'name':0x1}}]),_0x291dcf=await product[_0x481f4(0x114)]({});if(_0x54d087[0x0][_0x481f4(0xea)]==_0x481f4(0x130)){var _0x3916d3=users[_0x481f4(0xda)];console[_0x481f4(0x142)](_0x3916d3);}else{if(_0x54d087[0x0]['language']==_0x481f4(0x135))var _0x3916d3=users[_0x481f4(0x135)];else{if(_0x54d087[0x0][_0x481f4(0xea)]==_0x481f4(0xe1))var _0x3916d3=users[_0x481f4(0xe1)];else{if(_0x54d087[0x0][_0x481f4(0xea)]=='Spanish')var _0x3916d3=users['Spanish'];else{if(_0x54d087[0x0][_0x481f4(0xea)]==_0x481f4(0x14a))var _0x3916d3=users[_0x481f4(0x14a)];else{if(_0x54d087[0x0][_0x481f4(0xea)]==_0x481f4(0x14b))var _0x3916d3=users['Portuguese'];else{if(_0x54d087[0x0][_0x481f4(0xea)]==_0x481f4(0x10e))var _0x3916d3=users[_0x481f4(0x10e)];else{if(_0x54d087[0x0]['language']=='Arabic\x20(ae)')var _0x3916d3=users[_0x481f4(0xec)];}}}}}}}_0x3b6ed3[_0x481f4(0xfc)](_0x481f4(0xe0),{'success':_0x45f614[_0x481f4(0x11d)](_0x481f4(0x134)),'errors':_0x45f614['flash']('errors'),'role':_0x51789e,'profile':_0x248043,'master_shop':_0x54d087,'user':_0x5c9899,'stock':_0x5bd645,'unit':_0x291dcf,'language':_0x3916d3,'warehouses':_0x595f1e,'rooms':_0x4d9e12,'warehouse_QA':_0x505d77});}catch(_0x3238b4){console[_0x481f4(0x142)](_0x3238b4);}}),router[a0_0x1f6467(0x10f)]('/view/:id',auth,async(_0x2dbbfb,_0x404384)=>{var _0x4d5509=a0_0x1f6467;if(_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x126)]=='QA')try{const _0x518ba3=_0x2dbbfb[_0x4d5509(0xd7)]['id'],_0x47f0c7=await sales_return['findOne']({'invoice':_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x136)]}),_0x1e8bb7=await warehouse['findOne']({'name':_0x47f0c7[_0x4d5509(0xd5)],'room':_0x47f0c7['ToRoom']}),{invoice:_0x118492,customer:_0x3e7509,date:_0x39b1e1,warehouse_name:_0x375b09,product_name:_0x250bd4,primary_code:_0x1bf723,secondary_code:_0x397da2,product_code:_0x14a57a,sales_quantity:_0x7dc92d,stocks:_0x31c4b4,return_qty:_0x37ad35,note:_0xb0db23,to_warehouse_name_QA:_0x33b6bb,to_Room_name_QA:_0x15962d}=_0x2dbbfb['body'];if(typeof product_name_QA==_0x4d5509(0x148))var _0x1c15eb=[_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x111)]],_0x22221a=[_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xf8)]],_0x1ab80d=[_0x2dbbfb['body'][_0x4d5509(0xfa)]],_0x4fb3a2=[_0x2dbbfb['body'][_0x4d5509(0x102)]],_0x1e6382=[_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xd0)]],_0xdf0618=[_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x11b)]],_0x18b9ed=[_0x2dbbfb[_0x4d5509(0xf1)]['return_qty_QA']];else var _0x1c15eb=[..._0x2dbbfb['body'][_0x4d5509(0x111)]],_0x22221a=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xf8)]],_0x1ab80d=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xfa)]],_0x4fb3a2=[..._0x2dbbfb['body'][_0x4d5509(0x102)]],_0x1e6382=[..._0x2dbbfb['body'][_0x4d5509(0xd0)]],_0xdf0618=[..._0x2dbbfb[_0x4d5509(0xf1)]['stocks_QA']],_0x18b9ed=[..._0x2dbbfb[_0x4d5509(0xf1)]['return_qty_QA']];const _0x1a0304=_0x1c15eb[_0x4d5509(0x129)](_0x5dadbb=>{return _0x5dadbb={'product_name':_0x5dadbb};});_0x22221a[_0x4d5509(0x139)]((_0x565d1d,_0x224218)=>{var _0x49b2bc=_0x4d5509;_0x1a0304[_0x224218][_0x49b2bc(0x133)]=_0x565d1d;}),_0x1ab80d[_0x4d5509(0x139)]((_0x1962ee,_0x1022b4)=>{var _0x33b07f=_0x4d5509;_0x1a0304[_0x1022b4][_0x33b07f(0xef)]=_0x1962ee;}),_0x4fb3a2[_0x4d5509(0x139)]((_0x590716,_0x366630)=>{var _0x545e06=_0x4d5509;_0x1a0304[_0x366630][_0x545e06(0x12f)]=_0x590716;}),_0x1e6382[_0x4d5509(0x139)]((_0x3ced74,_0x1d373b)=>{var _0x20976f=_0x4d5509;_0x1a0304[_0x1d373b][_0x20976f(0x10a)]=_0x3ced74;}),_0xdf0618[_0x4d5509(0x139)]((_0x180647,_0x1eae8d)=>{_0x1a0304[_0x1eae8d]['stock']=_0x180647;}),_0x18b9ed['forEach']((_0xc782ea,_0x1ca0cb)=>{var _0x438f36=_0x4d5509;_0x1a0304[_0x1ca0cb][_0x438f36(0xd3)]=_0xc782ea;}),_0x47f0c7['return_sale_QA'][_0x4d5509(0x139)](_0x1eb7fc=>{var _0x36d1fc=_0x4d5509;const _0x2ee515=_0x1e8bb7[_0x36d1fc(0xfe)][_0x36d1fc(0x129)](_0x58b0e4=>{var _0x115998=_0x36d1fc;_0x58b0e4[_0x115998(0xde)]==_0x1eb7fc[_0x115998(0xde)]&&(_0x58b0e4['product_stock']=parseInt(_0x58b0e4[_0x115998(0xd9)])+parseInt(_0x1eb7fc[_0x115998(0xd3)]));});}),await _0x1e8bb7['save'](),_0x47f0c7['invoice']=_0x118492,_0x47f0c7[_0x4d5509(0x119)]=_0x3e7509,_0x47f0c7[_0x4d5509(0x12e)]=_0x39b1e1,_0x47f0c7['warehouse_name']=_0x375b09,_0x47f0c7['return_sale_QA']=_0x1a0304,_0x47f0c7[_0x4d5509(0x107)]=_0xb0db23,_0x47f0c7[_0x4d5509(0xd5)]=_0x33b6bb,_0x47f0c7[_0x4d5509(0x138)]=_0x15962d;const _0x3dc20f=await _0x47f0c7[_0x4d5509(0x125)](),_0xe9f245=await c_payment_data[_0x4d5509(0x13e)]({'invoice':_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x136)],'reason':_0x4d5509(0x12c)});_0xe9f245[_0x4d5509(0x118)]=_0x2dbbfb['body'][_0x4d5509(0x118)],_0xe9f245[_0x4d5509(0x12e)]=_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x12e)],await _0xe9f245[_0x4d5509(0x125)](),_0x2dbbfb[_0x4d5509(0x11d)](_0x4d5509(0x134),_0x4d5509(0xe2)),_0x404384[_0x4d5509(0xe5)](_0x4d5509(0xf4));}catch(_0x2266d1){console[_0x4d5509(0x142)](_0x2266d1),_0x404384[_0x4d5509(0xe9)](0xc8)['json']({'message':_0x2266d1[_0x4d5509(0x112)]});}else try{const _0x4757e1=_0x2dbbfb[_0x4d5509(0xd7)]['id'];console[_0x4d5509(0x142)](_0x4757e1);const _0x2c1a50=await sales_return[_0x4d5509(0x13e)]({'invoice':_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x136)]});console[_0x4d5509(0x142)](_0x4d5509(0xf7),_0x2c1a50);const _0x39fa9d=await warehouse[_0x4d5509(0x13e)]({'name':_0x2c1a50[_0x4d5509(0xd5)],'room':_0x2c1a50['ToRoom']});console[_0x4d5509(0x142)]('old_warehouse_data',_0x39fa9d);const {invoice:_0x6fa101,customer:_0x549606,date:_0xd19ed0,warehouse_name:_0x1a54d0,product_name:_0x4eff26,primary_code:_0x4dbc74,secondary_code:_0x2cc274,product_code:_0x2cf963,sales_quantity:_0x38f803,stocks:_0x486efd,return_qty:_0x59af2b,note:_0x362ecb,to_warehouse_name:_0x24e6e0,to_Room_name:_0x473720}=_0x2dbbfb['body'];console[_0x4d5509(0x142)](_0x2dbbfb[_0x4d5509(0xf1)]);if(typeof _0x4eff26=='string')var _0x1c15eb=[_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xde)]],_0x22221a=[_0x2dbbfb[_0x4d5509(0xf1)]['primary_code']],_0x1ab80d=[_0x2dbbfb['body']['secondary_code']],_0x4fb3a2=[_0x2dbbfb[_0x4d5509(0xf1)]['product_code']],_0x1e6382=[_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xe3)]],_0xdf0618=[_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x117)]],_0x18b9ed=[_0x2dbbfb['body'][_0x4d5509(0xd3)]],_0x83e0c3=[_0x2dbbfb[_0x4d5509(0xf1)]['bay']],_0x3086cd=[_0x2dbbfb['body'][_0x4d5509(0x13f)]],_0x394508=[_0x2dbbfb[_0x4d5509(0xf1)]['types']],_0x198bc1=[_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xd1)]];else var _0x1c15eb=[..._0x2dbbfb[_0x4d5509(0xf1)]['product_name']],_0x22221a=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x133)]],_0x1ab80d=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xef)]],_0x4fb3a2=[..._0x2dbbfb['body'][_0x4d5509(0x12f)]],_0x1e6382=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xe3)]],_0xdf0618=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x117)]],_0x18b9ed=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xd3)]],_0x83e0c3=[..._0x2dbbfb['body'][_0x4d5509(0x12b)]],_0x3086cd=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x13f)]],_0x394508=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x110)]],_0x198bc1=[..._0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0xd1)]];const _0x5c1465=_0x1c15eb[_0x4d5509(0x129)](_0x1a34f4=>{return _0x1a34f4={'product_name':_0x1a34f4};});_0x22221a[_0x4d5509(0x139)]((_0x1bfb99,_0x105d6c)=>{var _0x6dc5b9=_0x4d5509;_0x5c1465[_0x105d6c][_0x6dc5b9(0x133)]=_0x1bfb99;}),_0x1ab80d['forEach']((_0x582f94,_0x97b39c)=>{var _0x47833f=_0x4d5509;_0x5c1465[_0x97b39c][_0x47833f(0xef)]=_0x582f94;}),_0x4fb3a2[_0x4d5509(0x139)]((_0x1acb5f,_0x484d21)=>{var _0x325fbc=_0x4d5509;_0x5c1465[_0x484d21][_0x325fbc(0x12f)]=_0x1acb5f;}),_0x1e6382['forEach']((_0x4c1efb,_0x319e62)=>{var _0x478341=_0x4d5509;_0x5c1465[_0x319e62][_0x478341(0x10a)]=_0x4c1efb;}),_0xdf0618[_0x4d5509(0x139)]((_0x22ae83,_0x4e66fb)=>{var _0x558197=_0x4d5509;_0x5c1465[_0x4e66fb][_0x558197(0x12a)]=_0x22ae83;}),_0x18b9ed[_0x4d5509(0x139)]((_0x2e4d99,_0x4ac6e2)=>{var _0x372d7f=_0x4d5509;_0x5c1465[_0x4ac6e2][_0x372d7f(0xd3)]=_0x2e4d99;}),_0x83e0c3['forEach']((_0x4da193,_0x4a90a7)=>{var _0x3bb1c1=_0x4d5509;_0x5c1465[_0x4a90a7][_0x3bb1c1(0x12b)]=_0x4da193;}),_0x3086cd[_0x4d5509(0x139)]((_0x488c79,_0x4da14b)=>{var _0x374a10=_0x4d5509;_0x5c1465[_0x4da14b][_0x374a10(0x13f)]=_0x488c79;}),_0x394508[_0x4d5509(0x139)]((_0x229b2b,_0x5647f0)=>{_0x5c1465[_0x5647f0]['type']=_0x229b2b;}),_0x198bc1[_0x4d5509(0x139)]((_0x51147e,_0x3eb50a)=>{var _0x4d15da=_0x4d5509;_0x5c1465[_0x3eb50a][_0x4d15da(0xd1)]=_0x51147e;});var _0x4dfe57=0x0;_0x5c1465['forEach'](_0x3b0192=>{var _0x3774c1=_0x4d5509;console['log'](_0x3774c1(0xf2),_0x3b0192),(parseInt(_0x3b0192[_0x3774c1(0x10a)])<parseInt(_0x3b0192['return_qty'])||parseInt(_0x3b0192[_0x3774c1(0x12a)])<parseInt(_0x3b0192[_0x3774c1(0xd3)])&&parseInt(_0x3b0192[_0x3774c1(0x10a)])>parseInt(_0x3b0192['return_qty'])||parseInt(_0x3b0192['return_qty'])==0x0)&&_0x4dfe57++;});if(_0x4dfe57!=0x0)return _0x2dbbfb['flash'](_0x4d5509(0xdd),_0x4d5509(0x10c)),_0x404384[_0x4d5509(0xe5)](_0x4d5509(0x141));_0x2c1a50[_0x4d5509(0xe8)][_0x4d5509(0x139)](_0x5dd978=>{var _0x162ada=_0x4d5509;const _0x2aea2c=_0x39fa9d[_0x162ada(0xfe)][_0x162ada(0x129)](_0x4f2f95=>{var _0x2ce781=_0x162ada;_0x4f2f95[_0x2ce781(0xde)]==_0x5dd978[_0x2ce781(0xde)]&&_0x4f2f95[_0x2ce781(0xd1)]==_0x5dd978[_0x2ce781(0xd1)]&&_0x4f2f95[_0x2ce781(0x132)]==_0x5dd978['type']&&_0x4f2f95[_0x2ce781(0x13f)]==_0x5dd978['bin']&&_0x4f2f95[_0x2ce781(0x12b)]==_0x5dd978[_0x2ce781(0x12b)]&&(_0x4f2f95[_0x2ce781(0xd9)]=parseInt(_0x4f2f95[_0x2ce781(0xd9)])+parseInt(_0x5dd978[_0x2ce781(0xd3)]));});}),console[_0x4d5509(0x142)]('old_warehouse_data',_0x39fa9d),await _0x39fa9d[_0x4d5509(0x125)](),_0x2c1a50[_0x4d5509(0x136)]=_0x6fa101,_0x2c1a50['customer']=_0x549606,_0x2c1a50[_0x4d5509(0x12e)]=_0xd19ed0,_0x2c1a50['warehouse_name']=_0x1a54d0,_0x2c1a50['return_sale']=_0x5c1465,_0x2c1a50[_0x4d5509(0x107)]=_0x362ecb,_0x2c1a50[_0x4d5509(0xd5)]=_0x24e6e0,_0x2c1a50[_0x4d5509(0x138)]=_0x473720;const _0x1715f6=await _0x2c1a50['save']();console[_0x4d5509(0x142)](_0x4d5509(0x123),_0x1715f6);const _0x2d0e71=await c_payment_data[_0x4d5509(0x13e)]({'invoice':_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x136)],'reason':'Sale\x20Return'});_0x2d0e71[_0x4d5509(0x118)]=_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x118)],_0x2d0e71[_0x4d5509(0x12e)]=_0x2dbbfb[_0x4d5509(0xf1)][_0x4d5509(0x12e)],await _0x2d0e71[_0x4d5509(0x125)](),_0x2dbbfb[_0x4d5509(0x11d)](_0x4d5509(0x134),'purchase\x20return\x20successfully'),_0x404384[_0x4d5509(0xe5)](_0x4d5509(0xe6));}catch(_0x180535){console[_0x4d5509(0x142)](_0x180535),_0x404384[_0x4d5509(0xe9)](0xc8)[_0x4d5509(0x109)]({'message':_0x180535[_0x4d5509(0x112)]});}}),router[a0_0x1f6467(0x10f)](a0_0x1f6467(0x143),auth,async(_0x15c7e4,_0x4d8c32)=>{var _0x4c5477=a0_0x1f6467;try{const _0x81af9e=_0x15c7e4['params']['id'],{invoice:_0x21beda,customer:_0x4e3c53,payable_to_customer:_0x4877ba,paid_amount:_0x3a10a7}=_0x15c7e4[_0x4c5477(0xf1)],_0x4ee024=await sales_return['findById'](_0x81af9e);console[_0x4c5477(0x142)](_0x4c5477(0x13d),_0x4ee024),console[_0x4c5477(0x142)](_0x4877ba),console[_0x4c5477(0x142)](_0x3a10a7);var _0x3398ed=_0x4877ba-_0x3a10a7;console[_0x4c5477(0x142)]('subtract',_0x3398ed),_0x4ee024[_0x4c5477(0xeb)]=parseFloat(_0x3a10a7)+parseFloat(_0x4ee024[_0x4c5477(0xeb)]),_0x4ee024[_0x4c5477(0x104)]=_0x3398ed,console['log'](_0x4ee024);const _0x5ae9d2=await _0x4ee024['save']();console['log'](0x1b207);const _0x413643=await c_payment_data[_0x4c5477(0x13e)]({'invoice':_0x15c7e4[_0x4c5477(0xf1)][_0x4c5477(0x136)],'reason':_0x4c5477(0x12c)});console[_0x4c5477(0x142)](_0x4c5477(0x100),_0x413643),_0x413643['amount']=_0x3398ed,await _0x413643[_0x4c5477(0x125)]();let _0x346cda=new Date(),_0x4b3239=('0'+_0x346cda[_0x4c5477(0xdb)]())[_0x4c5477(0xf0)](-0x2),_0x22498c=('0'+(_0x346cda[_0x4c5477(0x10d)]()+0x1))['slice'](-0x2),_0x152cbf=_0x346cda[_0x4c5477(0xee)](),_0x2cb571=_0x152cbf+'-'+_0x22498c+'-'+_0x4b3239;const _0x48a2d7=new customer_payment({'invoice':_0x21beda,'date':_0x152cbf+'-'+_0x22498c+'-'+_0x4b3239,'customer':_0x4e3c53,'reason':_0x4c5477(0x13c),'amount':_0x3a10a7}),_0xbf90df=await _0x48a2d7[_0x4c5477(0x125)]();_0x15c7e4[_0x4c5477(0x11d)]('success',_0x4c5477(0xd8)),_0x4d8c32[_0x4c5477(0xe5)]('/sales_return/view');}catch(_0x74b33a){console[_0x4c5477(0x142)](_0x74b33a);}}),router[a0_0x1f6467(0x121)]('/invoice/:id',auth,async(_0x5dbc14,_0x5de0a2)=>{var _0x26b43b=a0_0x1f6467;try{const {username:_0x38334a,email:_0x48b9f8,role:_0x7fe757}=_0x5dbc14[_0x26b43b(0x12d)],_0x154c19=_0x5dbc14['user'],_0x4f4a2d=await profile['findOne']({'email':_0x154c19[_0x26b43b(0xe4)]}),_0x1c69a9=await master_shop['find']();console[_0x26b43b(0x142)](_0x26b43b(0x106),_0x1c69a9);const _0x33292a=_0x5dbc14[_0x26b43b(0xd7)]['id'],_0xe6adf5=await sales_return[_0x26b43b(0x11c)](_0x33292a);console[_0x26b43b(0x142)](_0xe6adf5);const _0x58a0c5=await customer[_0x26b43b(0x13e)]({'name':_0xe6adf5[_0x26b43b(0x119)]});console['log'](_0x58a0c5);if(_0x1c69a9[0x0][_0x26b43b(0xea)]==_0x26b43b(0x130)){var _0x4fd4cd=users[_0x26b43b(0xda)];console[_0x26b43b(0x142)](_0x4fd4cd);}else{if(_0x1c69a9[0x0][_0x26b43b(0xea)]=='Hindi')var _0x4fd4cd=users[_0x26b43b(0x135)];else{if(_0x1c69a9[0x0]['language']==_0x26b43b(0xe1))var _0x4fd4cd=users[_0x26b43b(0xe1)];else{if(_0x1c69a9[0x0][_0x26b43b(0xea)]==_0x26b43b(0x128))var _0x4fd4cd=users[_0x26b43b(0x128)];else{if(_0x1c69a9[0x0][_0x26b43b(0xea)]==_0x26b43b(0x14a))var _0x4fd4cd=users[_0x26b43b(0x14a)];else{if(_0x1c69a9[0x0][_0x26b43b(0xea)]==_0x26b43b(0x14b))var _0x4fd4cd=users[_0x26b43b(0xd2)];else{if(_0x1c69a9[0x0][_0x26b43b(0xea)]=='Chinese')var _0x4fd4cd=users['Chinese'];else{if(_0x1c69a9[0x0][_0x26b43b(0xea)]=='Arabic\x20(ae)')var _0x4fd4cd=users[_0x26b43b(0xec)];}}}}}}}_0x5de0a2[_0x26b43b(0xfc)]('sales_return_invoice',{'success':_0x5dbc14[_0x26b43b(0x11d)](_0x26b43b(0x134)),'errors':_0x5dbc14['flash']('errors'),'role':_0x154c19,'profile':_0x4f4a2d,'master_shop':_0x1c69a9,'customers':_0x58a0c5,'sales':_0xe6adf5,'language':_0x4fd4cd});}catch(_0x2a994b){console[_0x26b43b(0x142)](_0x2a994b);}}),module[a0_0x1f6467(0x149)]=router;