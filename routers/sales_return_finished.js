function a0_0x56a3(){var _0x5e4d50=['body','return_qty_QA','German','redirect','bay','../public/language/languages.json','Chinese','save','purchase\x20return\x20successfully','render','findById','$product_details.product_name','2619456BWZMCM','Arabic\x20(ae)','Spanish','language','findOne','forEach','subtract','$name','status','name','invoice','return_sale','2083002HgPyYT','/sales_return/view','$product_details.floorlevel','types','../middleware/auth','get','product_name','params','Portuguese\x20(BR)','$product_details.storage','secondary_code_QA','/view/:id','$product_details.bin','log','20795HwKHte','7zoYITU','ToRoom','stock','exports','new\x20new_data','note','type','amount','success','sales_quantity','c_payment','French','Finished\x20Goods','Enabled','customer','old_warehouse_data','customers','json','1324JHkBaB','product_code_QA','2609544Beaqsz','product_name_QA','$product_details.type','back','return_sale_QA','11033630USfzpK','payment\x20successfull','primary_code','product_stock','Returned\x20Payment\x20For\x20Sale\x20Return','ToWarehouse','email','secondary_code','stocks','date','express','warehouse_name','$product_details.bay','Arabic','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','../models/all_models','2189474iYyCMw','843154RHkXBV','/invoice/:id','English\x20(US)','data','getFullYear','27cetYKu','user','Sale\x20Return','Hindi','string','return_qty','$product_details.secondary_code','errors','suppliers','for_categorize','$product_details.product_stock','return_sale_edit_finished','stocks_QA','message','customer_docs','$product_details._id','Return\x20Rooms','sales_return_finished','aggregate','paid_amount','floorlevel','QA\x20Warehouse','product_code','English','foreach\x20newproduct','sales_return_invoice','flash','getMonth','map','sales_quantity_QA','post','sale_qty','primary_code_QA','product_details','find','bin','master','Router','Portuguese'];a0_0x56a3=function(){return _0x5e4d50;};return a0_0x56a3();}var a0_0x23d6e6=a0_0x4734;(function(_0x135472,_0x1fe7f1){var _0x4d2bb0=a0_0x4734,_0x3d5eef=_0x135472();while(!![]){try{var _0x36d482=-parseInt(_0x4d2bb0(0x1f9))/0x1+parseInt(_0x4d2bb0(0x1f8))/0x2+parseInt(_0x4d2bb0(0x1b4))/0x3+parseInt(_0x4d2bb0(0x1e1))/0x4*(parseInt(_0x4d2bb0(0x1ce))/0x5)+parseInt(_0x4d2bb0(0x1c0))/0x6*(parseInt(_0x4d2bb0(0x1cf))/0x7)+parseInt(_0x4d2bb0(0x1e3))/0x8*(-parseInt(_0x4d2bb0(0x1fe))/0x9)+-parseInt(_0x4d2bb0(0x1e8))/0xa;if(_0x36d482===_0x1fe7f1)break;else _0x3d5eef['push'](_0x3d5eef['shift']());}catch(_0x1ce0b1){_0x3d5eef['push'](_0x3d5eef['shift']());}}}(a0_0x56a3,0xbb27d));function a0_0x4734(_0x44437b,_0x338b65){var _0x56a34c=a0_0x56a3();return a0_0x4734=function(_0x4734d7,_0x40519f){_0x4734d7=_0x4734d7-0x18c;var _0x5c91e6=_0x56a34c[_0x4734d7];return _0x5c91e6;},a0_0x4734(_0x44437b,_0x338b65);}const express=require(a0_0x23d6e6(0x1f2)),app=express(),router=express[a0_0x23d6e6(0x1a6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x23d6e6(0x1f7)),auth=require(a0_0x23d6e6(0x1c4)),users=require(a0_0x23d6e6(0x1ad));router[a0_0x23d6e6(0x1c5)]('/view',auth,async(_0x3adc0c,_0xb45ea0)=>{var _0x3d939b=a0_0x23d6e6;try{const {username:_0x2c26da,email:_0x1799f2,role:_0x6723c0}=_0x3adc0c[_0x3d939b(0x1ff)],_0x4ef6b5=_0x3adc0c['user'],_0x40ae7a=await profile['findOne']({'email':_0x4ef6b5['email']}),_0x1c8aed=await master_shop['find'](),_0x1c74f3=await sales_return_finished[_0x3d939b(0x193)]([{'$lookup':{'from':_0x3d939b(0x1df),'localField':_0x3d939b(0x1dd),'foreignField':_0x3d939b(0x1bd),'as':_0x3d939b(0x18f)}},{'$unwind':'$customer_docs'}]);if(_0x1c8aed[0x0]['language']==_0x3d939b(0x1fb)){var _0x79939c=users[_0x3d939b(0x198)];console[_0x3d939b(0x1cd)](_0x79939c);}else{if(_0x1c8aed[0x0]['language']==_0x3d939b(0x201))var _0x79939c=users[_0x3d939b(0x201)];else{if(_0x1c8aed[0x0]['language']==_0x3d939b(0x1aa))var _0x79939c=users['German'];else{if(_0x1c8aed[0x0][_0x3d939b(0x1b7)]=='Spanish')var _0x79939c=users[_0x3d939b(0x1b6)];else{if(_0x1c8aed[0x0][_0x3d939b(0x1b7)]==_0x3d939b(0x1da))var _0x79939c=users[_0x3d939b(0x1da)];else{if(_0x1c8aed[0x0][_0x3d939b(0x1b7)]==_0x3d939b(0x1c8))var _0x79939c=users[_0x3d939b(0x1a7)];else{if(_0x1c8aed[0x0][_0x3d939b(0x1b7)]==_0x3d939b(0x1ae))var _0x79939c=users['Chinese'];else{if(_0x1c8aed[0x0][_0x3d939b(0x1b7)]=='Arabic\x20(ae)')var _0x79939c=users[_0x3d939b(0x1f5)];}}}}}}}_0xb45ea0[_0x3d939b(0x1b1)](_0x3d939b(0x192),{'success':_0x3adc0c[_0x3d939b(0x19b)](_0x3d939b(0x1d7)),'errors':_0x3adc0c[_0x3d939b(0x19b)](_0x3d939b(0x205)),'role':_0x4ef6b5,'profile':_0x40ae7a,'master_shop':_0x1c8aed,'user':_0x1c74f3,'language':_0x79939c});}catch(_0x3b9d17){console['log'](_0x3b9d17);}}),router[a0_0x23d6e6(0x1c5)](a0_0x23d6e6(0x1cb),auth,async(_0x46ec75,_0xdf231b)=>{var _0x12291d=a0_0x23d6e6;try{const {username:_0x54dc11,email:_0xb607c8,role:_0x1e0e76}=_0x46ec75[_0x12291d(0x1ff)],_0x2a7724=_0x46ec75[_0x12291d(0x1ff)],_0x4379cd=await profile[_0x12291d(0x1b8)]({'email':_0x2a7724['email']}),_0x303ed6=await master_shop[_0x12291d(0x1a3)]();console[_0x12291d(0x1cd)](_0x12291d(0x1a5),_0x303ed6);const _0x403bae=_0x46ec75[_0x12291d(0x1c7)]['id'];console[_0x12291d(0x1cd)](_0x403bae);var _0x4412ac=[_0x12291d(0x191)];const _0x56c33d=await sales_return_finished['findById'](_0x403bae),_0x5ee4a6=await warehouse['aggregate']([{'$match':{'name':_0x56c33d[_0x12291d(0x1ed)],'room':_0x56c33d['ToRoom']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x12291d(0x190),'name':{'$first':_0x12291d(0x1b3)},'product_stock':{'$first':_0x12291d(0x208)},'bay':{'$first':_0x12291d(0x1f4)},'bin':{'$first':_0x12291d(0x1cc)},'type':{'$first':_0x12291d(0x1e5)},'floorlevel':{'$first':_0x12291d(0x1c2)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x12291d(0x204)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x12291d(0x1c9)},'rack':{'$first':'$product_details.rack'}}}]);console[_0x12291d(0x1cd)](_0x5ee4a6);const _0xd6cf55=await warehouse['aggregate']([{'$match':{'status':_0x12291d(0x1dc),'warehouse_category':_0x12291d(0x1db)}},{'$group':{'_id':'$name','name':{'$first':_0x12291d(0x1bb)}}},{'$sort':{'name':0x1}}]),_0x3f08a6=await warehouse[_0x12291d(0x193)]([{'$match':{'status':_0x12291d(0x1dc),'name':_0x12291d(0x196)}},{'$group':{'_id':'$name','name':{'$first':_0x12291d(0x1bb)}}},{'$sort':{'name':0x1}}]),_0x349fce=await product['find']({});if(_0x303ed6[0x0][_0x12291d(0x1b7)]==_0x12291d(0x1fb)){var _0x4e21ac=users[_0x12291d(0x198)];console[_0x12291d(0x1cd)](_0x4e21ac);}else{if(_0x303ed6[0x0]['language']==_0x12291d(0x201))var _0x4e21ac=users[_0x12291d(0x201)];else{if(_0x303ed6[0x0][_0x12291d(0x1b7)]==_0x12291d(0x1aa))var _0x4e21ac=users[_0x12291d(0x1aa)];else{if(_0x303ed6[0x0]['language']=='Spanish')var _0x4e21ac=users[_0x12291d(0x1b6)];else{if(_0x303ed6[0x0][_0x12291d(0x1b7)]==_0x12291d(0x1da))var _0x4e21ac=users[_0x12291d(0x1da)];else{if(_0x303ed6[0x0][_0x12291d(0x1b7)]==_0x12291d(0x1c8))var _0x4e21ac=users[_0x12291d(0x1a7)];else{if(_0x303ed6[0x0][_0x12291d(0x1b7)]==_0x12291d(0x1ae))var _0x4e21ac=users[_0x12291d(0x1ae)];else{if(_0x303ed6[0x0][_0x12291d(0x1b7)]==_0x12291d(0x1b5))var _0x4e21ac=users[_0x12291d(0x1f5)];}}}}}}}_0xdf231b[_0x12291d(0x1b1)](_0x12291d(0x18c),{'success':_0x46ec75[_0x12291d(0x19b)](_0x12291d(0x1d7)),'errors':_0x46ec75[_0x12291d(0x19b)](_0x12291d(0x205)),'role':_0x2a7724,'profile':_0x4379cd,'master_shop':_0x303ed6,'user':_0x56c33d,'stock':_0x5ee4a6,'unit':_0x349fce,'language':_0x4e21ac,'warehouses':_0xd6cf55,'rooms':_0x4412ac,'warehouse_QA':_0x3f08a6});}catch(_0x4ff85a){console[_0x12291d(0x1cd)](_0x4ff85a);}}),router[a0_0x23d6e6(0x19f)]('/view/:id',auth,async(_0x5e0e97,_0x52c134)=>{var _0x4dcc52=a0_0x23d6e6;if(_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x207)]=='QA')try{const _0x56ca80=_0x5e0e97['params']['id'],_0x211091=await sales_return[_0x4dcc52(0x1b8)]({'invoice':_0x5e0e97[_0x4dcc52(0x1a8)]['invoice']}),_0x5b80ec=await warehouse['findOne']({'name':_0x211091['ToWarehouse'],'room':_0x211091[_0x4dcc52(0x1d0)]}),{invoice:_0x1ca122,customer:_0x43ea3a,date:_0x3ce736,warehouse_name:_0x8d612c,product_name:_0x2c88c6,primary_code:_0x113116,secondary_code:_0x4e56ca,product_code:_0x1a9006,sales_quantity:_0x29d3ab,stocks:_0x548885,return_qty:_0x5ee71a,note:_0x4d18a4,to_warehouse_name_QA:_0x4cd9ee,to_Room_name_QA:_0x3b23be}=_0x5e0e97[_0x4dcc52(0x1a8)];if(typeof product_name_QA==_0x4dcc52(0x202))var _0x5f391e=[_0x5e0e97[_0x4dcc52(0x1a8)]['product_name_QA']],_0xa7023b=[_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1a1)]],_0xbc8db7=[_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1ca)]],_0x53801f=[_0x5e0e97[_0x4dcc52(0x1a8)]['product_code_QA']],_0x459ce9=[_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x19e)]],_0xa072b4=[_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x18d)]],_0x282be4=[_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1a9)]];else var _0x5f391e=[..._0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1e4)]],_0xa7023b=[..._0x5e0e97['body'][_0x4dcc52(0x1a1)]],_0xbc8db7=[..._0x5e0e97[_0x4dcc52(0x1a8)]['secondary_code_QA']],_0x53801f=[..._0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1e2)]],_0x459ce9=[..._0x5e0e97['body']['sales_quantity_QA']],_0xa072b4=[..._0x5e0e97['body'][_0x4dcc52(0x18d)]],_0x282be4=[..._0x5e0e97['body'][_0x4dcc52(0x1a9)]];const _0x345034=_0x5f391e[_0x4dcc52(0x19d)](_0x3a0b6b=>{return _0x3a0b6b={'product_name':_0x3a0b6b};});_0xa7023b[_0x4dcc52(0x1b9)]((_0xece5ec,_0x438779)=>{_0x345034[_0x438779]['primary_code']=_0xece5ec;}),_0xbc8db7[_0x4dcc52(0x1b9)]((_0x2f879e,_0x4b942e)=>{_0x345034[_0x4b942e]['secondary_code']=_0x2f879e;}),_0x53801f[_0x4dcc52(0x1b9)]((_0x2262d7,_0x1f5ba1)=>{var _0x479eda=_0x4dcc52;_0x345034[_0x1f5ba1][_0x479eda(0x197)]=_0x2262d7;}),_0x459ce9[_0x4dcc52(0x1b9)]((_0x131728,_0x5dfa80)=>{var _0x54e0ae=_0x4dcc52;_0x345034[_0x5dfa80][_0x54e0ae(0x1a0)]=_0x131728;}),_0xa072b4[_0x4dcc52(0x1b9)]((_0x48a29c,_0x84e4c)=>{var _0x4dab76=_0x4dcc52;_0x345034[_0x84e4c][_0x4dab76(0x1d1)]=_0x48a29c;}),_0x282be4[_0x4dcc52(0x1b9)]((_0x231a2d,_0x442c90)=>{var _0x69bbee=_0x4dcc52;_0x345034[_0x442c90][_0x69bbee(0x203)]=_0x231a2d;}),_0x211091[_0x4dcc52(0x1e7)]['forEach'](_0x4f773c=>{var _0x1a4b2c=_0x4dcc52;const _0xc4ebdc=_0x5b80ec[_0x1a4b2c(0x1a2)][_0x1a4b2c(0x19d)](_0xe3995c=>{var _0x3457a5=_0x1a4b2c;_0xe3995c[_0x3457a5(0x1c6)]==_0x4f773c[_0x3457a5(0x1c6)]&&(_0xe3995c[_0x3457a5(0x1eb)]=parseInt(_0xe3995c[_0x3457a5(0x1eb)])+parseInt(_0x4f773c[_0x3457a5(0x203)]));});}),await _0x5b80ec['save'](),_0x211091[_0x4dcc52(0x1be)]=_0x1ca122,_0x211091[_0x4dcc52(0x1dd)]=_0x43ea3a,_0x211091[_0x4dcc52(0x1f1)]=_0x3ce736,_0x211091[_0x4dcc52(0x1f3)]=_0x8d612c,_0x211091[_0x4dcc52(0x1e7)]=_0x345034,_0x211091[_0x4dcc52(0x1d4)]=_0x4d18a4,_0x211091[_0x4dcc52(0x1ed)]=_0x4cd9ee,_0x211091['ToRoom']=_0x3b23be;const _0x5c05c3=await _0x211091[_0x4dcc52(0x1af)](),_0x5702ef=await c_payment_data[_0x4dcc52(0x1b8)]({'invoice':_0x5e0e97[_0x4dcc52(0x1a8)]['invoice'],'reason':_0x4dcc52(0x200)});_0x5702ef[_0x4dcc52(0x206)]=_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x206)],_0x5702ef[_0x4dcc52(0x1f1)]=_0x5e0e97[_0x4dcc52(0x1a8)]['date'],await _0x5702ef[_0x4dcc52(0x1af)](),_0x5e0e97[_0x4dcc52(0x19b)](_0x4dcc52(0x1d7),_0x4dcc52(0x1b0)),_0x52c134[_0x4dcc52(0x1ab)]('/sales_return_finished/view');}catch(_0x348c5b){console['log'](_0x348c5b),_0x52c134[_0x4dcc52(0x1bc)](0xc8)[_0x4dcc52(0x1e0)]({'message':_0x348c5b[_0x4dcc52(0x18e)]});}else try{const _0x5a74aa=_0x5e0e97[_0x4dcc52(0x1c7)]['id'];console[_0x4dcc52(0x1cd)](_0x5a74aa);const _0x48f19b=await sales_return[_0x4dcc52(0x1b8)]({'invoice':_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1be)]});console['log']('old_data',_0x48f19b);const _0x4fc9fa=await warehouse[_0x4dcc52(0x1b8)]({'name':_0x48f19b['ToWarehouse'],'room':_0x48f19b[_0x4dcc52(0x1d0)]});console[_0x4dcc52(0x1cd)](_0x4dcc52(0x1de),_0x4fc9fa);const {invoice:_0x5c5c96,customer:_0x2b0f30,date:_0x446f45,warehouse_name:_0x511894,product_name:_0x5d3a06,primary_code:_0x4c7b08,secondary_code:_0x2f6012,product_code:_0x507259,sales_quantity:_0x3685b3,stocks:_0x2b148f,return_qty:_0x37ce7d,note:_0x595eb7,to_warehouse_name:_0x4cd892,to_Room_name:_0x18ac28}=_0x5e0e97[_0x4dcc52(0x1a8)];console[_0x4dcc52(0x1cd)](_0x5e0e97[_0x4dcc52(0x1a8)]);if(typeof _0x5d3a06==_0x4dcc52(0x202))var _0x5f391e=[_0x5e0e97['body'][_0x4dcc52(0x1c6)]],_0xa7023b=[_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1ea)]],_0xbc8db7=[_0x5e0e97[_0x4dcc52(0x1a8)]['secondary_code']],_0x53801f=[_0x5e0e97[_0x4dcc52(0x1a8)]['product_code']],_0x459ce9=[_0x5e0e97['body']['sales_quantity']],_0xa072b4=[_0x5e0e97['body']['stocks']],_0x282be4=[_0x5e0e97['body']['return_qty']],_0x2319f2=[_0x5e0e97['body']['bay']],_0x374950=[_0x5e0e97['body'][_0x4dcc52(0x1a4)]],_0x97b127=[_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1c3)]],_0xc6cc68=[_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x195)]];else var _0x5f391e=[..._0x5e0e97['body'][_0x4dcc52(0x1c6)]],_0xa7023b=[..._0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1ea)]],_0xbc8db7=[..._0x5e0e97['body'][_0x4dcc52(0x1ef)]],_0x53801f=[..._0x5e0e97['body'][_0x4dcc52(0x197)]],_0x459ce9=[..._0x5e0e97['body'][_0x4dcc52(0x1d8)]],_0xa072b4=[..._0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1f0)]],_0x282be4=[..._0x5e0e97[_0x4dcc52(0x1a8)]['return_qty']],_0x2319f2=[..._0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1ac)]],_0x374950=[..._0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1a4)]],_0x97b127=[..._0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1c3)]],_0xc6cc68=[..._0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x195)]];const _0x274e5f=_0x5f391e[_0x4dcc52(0x19d)](_0x16879f=>{return _0x16879f={'product_name':_0x16879f};});_0xa7023b['forEach']((_0x514b48,_0x329d09)=>{var _0x106aee=_0x4dcc52;_0x274e5f[_0x329d09][_0x106aee(0x1ea)]=_0x514b48;}),_0xbc8db7['forEach']((_0xff51e4,_0xf70749)=>{var _0x3015f0=_0x4dcc52;_0x274e5f[_0xf70749][_0x3015f0(0x1ef)]=_0xff51e4;}),_0x53801f[_0x4dcc52(0x1b9)]((_0x30ffaa,_0x5e0840)=>{_0x274e5f[_0x5e0840]['product_code']=_0x30ffaa;}),_0x459ce9[_0x4dcc52(0x1b9)]((_0x31592c,_0x169be8)=>{var _0x1a0fc4=_0x4dcc52;_0x274e5f[_0x169be8][_0x1a0fc4(0x1a0)]=_0x31592c;}),_0xa072b4[_0x4dcc52(0x1b9)]((_0x3f8a87,_0x1b352e)=>{var _0x2260b2=_0x4dcc52;_0x274e5f[_0x1b352e][_0x2260b2(0x1d1)]=_0x3f8a87;}),_0x282be4[_0x4dcc52(0x1b9)]((_0x27f2eb,_0x7268bd)=>{var _0x507477=_0x4dcc52;_0x274e5f[_0x7268bd][_0x507477(0x203)]=_0x27f2eb;}),_0x2319f2[_0x4dcc52(0x1b9)]((_0x3cd563,_0x478461)=>{var _0x482e47=_0x4dcc52;_0x274e5f[_0x478461][_0x482e47(0x1ac)]=_0x3cd563;}),_0x374950['forEach']((_0x804c7d,_0x5d4b4f)=>{var _0x269ba2=_0x4dcc52;_0x274e5f[_0x5d4b4f][_0x269ba2(0x1a4)]=_0x804c7d;}),_0x97b127[_0x4dcc52(0x1b9)]((_0x432a3a,_0x2c3151)=>{var _0x14be6f=_0x4dcc52;_0x274e5f[_0x2c3151][_0x14be6f(0x1d5)]=_0x432a3a;}),_0xc6cc68[_0x4dcc52(0x1b9)]((_0x4c44e1,_0x43d8ee)=>{_0x274e5f[_0x43d8ee]['floorlevel']=_0x4c44e1;});var _0x532116=0x0;_0x274e5f[_0x4dcc52(0x1b9)](_0x7e4be3=>{var _0x55dddd=_0x4dcc52;console[_0x55dddd(0x1cd)](_0x55dddd(0x199),_0x7e4be3),(parseInt(_0x7e4be3['sale_qty'])<parseInt(_0x7e4be3[_0x55dddd(0x203)])||parseInt(_0x7e4be3['stock'])<parseInt(_0x7e4be3['return_qty'])&&parseInt(_0x7e4be3['sale_qty'])>parseInt(_0x7e4be3[_0x55dddd(0x203)])||parseInt(_0x7e4be3['return_qty'])==0x0)&&_0x532116++;});if(_0x532116!=0x0)return _0x5e0e97[_0x4dcc52(0x19b)](_0x4dcc52(0x205),_0x4dcc52(0x1f6)),_0x52c134['redirect'](_0x4dcc52(0x1e6));_0x48f19b[_0x4dcc52(0x1bf)]['forEach'](_0x8a7a31=>{var _0x2cc216=_0x4dcc52;const _0x1fd85c=_0x4fc9fa[_0x2cc216(0x1a2)][_0x2cc216(0x19d)](_0x16cdea=>{var _0x223f6c=_0x2cc216;_0x16cdea['product_name']==_0x8a7a31[_0x223f6c(0x1c6)]&&_0x16cdea[_0x223f6c(0x195)]==_0x8a7a31['floorlevel']&&_0x16cdea[_0x223f6c(0x1d5)]==_0x8a7a31[_0x223f6c(0x1d5)]&&_0x16cdea[_0x223f6c(0x1a4)]==_0x8a7a31[_0x223f6c(0x1a4)]&&_0x16cdea[_0x223f6c(0x1ac)]==_0x8a7a31[_0x223f6c(0x1ac)]&&(_0x16cdea[_0x223f6c(0x1eb)]=parseInt(_0x16cdea[_0x223f6c(0x1eb)])+parseInt(_0x8a7a31['return_qty']));});}),console[_0x4dcc52(0x1cd)](_0x4dcc52(0x1de),_0x4fc9fa),await _0x4fc9fa[_0x4dcc52(0x1af)](),_0x48f19b['invoice']=_0x5c5c96,_0x48f19b[_0x4dcc52(0x1dd)]=_0x2b0f30,_0x48f19b[_0x4dcc52(0x1f1)]=_0x446f45,_0x48f19b[_0x4dcc52(0x1f3)]=_0x511894,_0x48f19b[_0x4dcc52(0x1bf)]=_0x274e5f,_0x48f19b[_0x4dcc52(0x1d4)]=_0x595eb7,_0x48f19b[_0x4dcc52(0x1ed)]=_0x4cd892,_0x48f19b[_0x4dcc52(0x1d0)]=_0x18ac28;const _0x477217=await _0x48f19b[_0x4dcc52(0x1af)]();console[_0x4dcc52(0x1cd)](_0x4dcc52(0x1d3),_0x477217);const _0x542dea=await c_payment_data[_0x4dcc52(0x1b8)]({'invoice':_0x5e0e97[_0x4dcc52(0x1a8)][_0x4dcc52(0x1be)],'reason':_0x4dcc52(0x200)});_0x542dea['suppliers']=_0x5e0e97['body'][_0x4dcc52(0x206)],_0x542dea[_0x4dcc52(0x1f1)]=_0x5e0e97[_0x4dcc52(0x1a8)]['date'],await _0x542dea[_0x4dcc52(0x1af)](),_0x5e0e97['flash'](_0x4dcc52(0x1d7),_0x4dcc52(0x1b0)),_0x52c134[_0x4dcc52(0x1ab)](_0x4dcc52(0x1c1));}catch(_0x7a32a8){console['log'](_0x7a32a8),_0x52c134[_0x4dcc52(0x1bc)](0xc8)[_0x4dcc52(0x1e0)]({'message':_0x7a32a8[_0x4dcc52(0x18e)]});}}),router[a0_0x23d6e6(0x19f)]('/give_payment/:id',auth,async(_0x351585,_0x54daa7)=>{var _0x29bfde=a0_0x23d6e6;try{const _0x317f56=_0x351585['params']['id'],{invoice:_0x2091d4,customer:_0x2ab0d1,payable_to_customer:_0x243c0b,paid_amount:_0x1b35f2}=_0x351585['body'],_0x102dfd=await sales_return[_0x29bfde(0x1b2)](_0x317f56);console['log'](_0x29bfde(0x1fc),_0x102dfd),console['log'](_0x243c0b),console[_0x29bfde(0x1cd)](_0x1b35f2);var _0x1732e5=_0x243c0b-_0x1b35f2;console[_0x29bfde(0x1cd)](_0x29bfde(0x1ba),_0x1732e5),_0x102dfd[_0x29bfde(0x194)]=parseFloat(_0x1b35f2)+parseFloat(_0x102dfd[_0x29bfde(0x194)]),_0x102dfd['due_amount']=_0x1732e5,console[_0x29bfde(0x1cd)](_0x102dfd);const _0x4d1311=await _0x102dfd['save']();console[_0x29bfde(0x1cd)](0x1b207);const _0x573326=await c_payment_data['findOne']({'invoice':_0x351585[_0x29bfde(0x1a8)][_0x29bfde(0x1be)],'reason':'Sale\x20Return'});console[_0x29bfde(0x1cd)](_0x29bfde(0x1d9),_0x573326),_0x573326[_0x29bfde(0x1d6)]=_0x1732e5,await _0x573326[_0x29bfde(0x1af)]();let _0x4fb82f=new Date(),_0x4b2f48=('0'+_0x4fb82f['getDate']())['slice'](-0x2),_0xe42a0=('0'+(_0x4fb82f[_0x29bfde(0x19c)]()+0x1))['slice'](-0x2),_0x36467b=_0x4fb82f[_0x29bfde(0x1fd)](),_0x7637af=_0x36467b+'-'+_0xe42a0+'-'+_0x4b2f48;const _0x4e59f5=new customer_payment({'invoice':_0x2091d4,'date':_0x36467b+'-'+_0xe42a0+'-'+_0x4b2f48,'customer':_0x2ab0d1,'reason':_0x29bfde(0x1ec),'amount':_0x1b35f2}),_0x3a534c=await _0x4e59f5[_0x29bfde(0x1af)]();_0x351585[_0x29bfde(0x19b)]('success',_0x29bfde(0x1e9)),_0x54daa7[_0x29bfde(0x1ab)](_0x29bfde(0x1c1));}catch(_0x1d4557){console[_0x29bfde(0x1cd)](_0x1d4557);}}),router[a0_0x23d6e6(0x1c5)](a0_0x23d6e6(0x1fa),auth,async(_0x8b63c3,_0x26a9fb)=>{var _0x2ed668=a0_0x23d6e6;try{const {username:_0x494e80,email:_0x5d23df,role:_0x3adb70}=_0x8b63c3[_0x2ed668(0x1ff)],_0x5bf3e5=_0x8b63c3[_0x2ed668(0x1ff)],_0xab2fd0=await profile[_0x2ed668(0x1b8)]({'email':_0x5bf3e5[_0x2ed668(0x1ee)]}),_0x198a03=await master_shop[_0x2ed668(0x1a3)]();console[_0x2ed668(0x1cd)](_0x2ed668(0x1a5),_0x198a03);const _0xabebc0=_0x8b63c3[_0x2ed668(0x1c7)]['id'],_0x420d96=await sales_return[_0x2ed668(0x1b2)](_0xabebc0);console[_0x2ed668(0x1cd)](_0x420d96);const _0x3d4a06=await customer[_0x2ed668(0x1b8)]({'name':_0x420d96[_0x2ed668(0x1dd)]});console[_0x2ed668(0x1cd)](_0x3d4a06);if(_0x198a03[0x0][_0x2ed668(0x1b7)]==_0x2ed668(0x1fb)){var _0x309e9b=users['English'];console[_0x2ed668(0x1cd)](_0x309e9b);}else{if(_0x198a03[0x0]['language']==_0x2ed668(0x201))var _0x309e9b=users[_0x2ed668(0x201)];else{if(_0x198a03[0x0][_0x2ed668(0x1b7)]==_0x2ed668(0x1aa))var _0x309e9b=users[_0x2ed668(0x1aa)];else{if(_0x198a03[0x0][_0x2ed668(0x1b7)]==_0x2ed668(0x1b6))var _0x309e9b=users[_0x2ed668(0x1b6)];else{if(_0x198a03[0x0]['language']==_0x2ed668(0x1da))var _0x309e9b=users[_0x2ed668(0x1da)];else{if(_0x198a03[0x0][_0x2ed668(0x1b7)]==_0x2ed668(0x1c8))var _0x309e9b=users[_0x2ed668(0x1a7)];else{if(_0x198a03[0x0]['language']==_0x2ed668(0x1ae))var _0x309e9b=users['Chinese'];else{if(_0x198a03[0x0][_0x2ed668(0x1b7)]==_0x2ed668(0x1b5))var _0x309e9b=users[_0x2ed668(0x1f5)];}}}}}}}_0x26a9fb[_0x2ed668(0x1b1)](_0x2ed668(0x19a),{'success':_0x8b63c3[_0x2ed668(0x19b)](_0x2ed668(0x1d7)),'errors':_0x8b63c3[_0x2ed668(0x19b)](_0x2ed668(0x205)),'role':_0x5bf3e5,'profile':_0xab2fd0,'master_shop':_0x198a03,'customers':_0x3d4a06,'sales':_0x420d96,'language':_0x309e9b});}catch(_0x46c09d){console[_0x2ed668(0x1cd)](_0x46c09d);}}),module[a0_0x23d6e6(0x1d2)]=router;