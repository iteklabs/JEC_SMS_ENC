function a0_0xbcaa(){var _0x3988d5=['types','redirect','findById','/sales_return/view','Sale\x20Return','Arabic','paid_amount','new\x20new_data','status','primary_code','$product_details.bin','product_code','json','slice','/invoice/:id','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','find','ToWarehouse','stock','string','sales_return_finished','errors','English','exports','return_sale','$product_details.product_stock','/sales_return_finished/view','$product_details.product_code','user','Return\x20Rooms','Router','customer','Arabic\x20(ae)','657909PfSdea','getDate','275760tORNRF','1326810sxUjJL','$product_details.storage','stocks_QA','Spanish','../middleware/auth','QA\x20Warehouse','Enabled','getMonth','language','date','/view/:id','German','product_name','message','type','secondary_code_QA','Portuguese\x20(BR)','log','note','body','forEach','French','amount','166224bVqwZT','../models/all_models','customers','$name','render','email','$product_details.secondary_code','Returned\x20Payment\x20For\x20Sale\x20Return','bin','Chinese','$product_details.bay','params','flash','suppliers','foreach\x20newproduct','sales_quantity_QA','Hindi','13821CpvXdf','product_details','product_stock','success','aggregate','return_sale_edit_finished','$product_details.floorlevel','../public/language/languages.json','return_qty_QA','getFullYear','primary_code_QA','5cAHyJU','$product_details._id','old_warehouse_data','invoice','sales_return_invoice','product_code_QA','Portuguese','due_amount','$customer_docs','master','get','customer_docs','floorlevel','warehouse_name','/view','/give_payment/:id','English\x20(US)','for_categorize','190203SDcMOT','411312FedNnX','product_name_QA','return_qty','sale_qty','secondary_code','post','ToRoom','save','118nASkfu','$product_details.product_name','findOne','bay','map','sales_quantity','name','purchase\x20return\x20successfully','return_sale_QA','stocks','$product_details.type','c_payment'];a0_0xbcaa=function(){return _0x3988d5;};return a0_0xbcaa();}var a0_0x1784f6=a0_0x5c7d;(function(_0x519059,_0x29a925){var _0x1d1623=a0_0x5c7d,_0x16aa55=_0x519059();while(!![]){try{var _0x5d067f=parseInt(_0x1d1623(0x21d))/0x1+-parseInt(_0x1d1623(0x226))/0x2*(parseInt(_0x1d1623(0x200))/0x3)+parseInt(_0x1d1623(0x1ef))/0x4*(-parseInt(_0x1d1623(0x20b))/0x5)+parseInt(_0x1d1623(0x1d8))/0x6+parseInt(_0x1d1623(0x1d5))/0x7+parseInt(_0x1d1623(0x21e))/0x8+-parseInt(_0x1d1623(0x1d7))/0x9;if(_0x5d067f===_0x29a925)break;else _0x16aa55['push'](_0x16aa55['shift']());}catch(_0x3d7a41){_0x16aa55['push'](_0x16aa55['shift']());}}}(a0_0xbcaa,0x33efa));function a0_0x5c7d(_0x507201,_0x3db2b4){var _0xbcaa7=a0_0xbcaa();return a0_0x5c7d=function(_0x5c7dc6,_0x21cd85){_0x5c7dc6=_0x5c7dc6-0x1d4;var _0x3d6b3a=_0xbcaa7[_0x5c7dc6];return _0x3d6b3a;},a0_0x5c7d(_0x507201,_0x3db2b4);}const express=require('express'),app=express(),router=express[a0_0x1784f6(0x250)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x1784f6(0x1f0)),auth=require(a0_0x1784f6(0x1dc)),users=require(a0_0x1784f6(0x207));router[a0_0x1784f6(0x215)](a0_0x1784f6(0x219),auth,async(_0x154d57,_0x518d1e)=>{var _0xbca91e=a0_0x1784f6;try{const {username:_0x57551c,email:_0xbf171a,role:_0x243995}=_0x154d57[_0xbca91e(0x24e)],_0x22d86f=_0x154d57['user'],_0x538de8=await profile[_0xbca91e(0x228)]({'email':_0x22d86f[_0xbca91e(0x1f4)]}),_0x39d575=await master_shop[_0xbca91e(0x242)](),_0x3d4d0e=await sales_return_finished['aggregate']([{'$lookup':{'from':_0xbca91e(0x1f1),'localField':_0xbca91e(0x251),'foreignField':_0xbca91e(0x22c),'as':_0xbca91e(0x216)}},{'$unwind':_0xbca91e(0x213)}]);if(_0x39d575[0x0]['language']=='English\x20(US)'){var _0x2b617e=users[_0xbca91e(0x248)];console['log'](_0x2b617e);}else{if(_0x39d575[0x0][_0xbca91e(0x1e0)]=='Hindi')var _0x2b617e=users[_0xbca91e(0x1ff)];else{if(_0x39d575[0x0]['language']==_0xbca91e(0x1e3))var _0x2b617e=users['German'];else{if(_0x39d575[0x0][_0xbca91e(0x1e0)]=='Spanish')var _0x2b617e=users[_0xbca91e(0x1db)];else{if(_0x39d575[0x0][_0xbca91e(0x1e0)]==_0xbca91e(0x1ed))var _0x2b617e=users[_0xbca91e(0x1ed)];else{if(_0x39d575[0x0]['language']=='Portuguese\x20(BR)')var _0x2b617e=users['Portuguese'];else{if(_0x39d575[0x0][_0xbca91e(0x1e0)]==_0xbca91e(0x1f8))var _0x2b617e=users[_0xbca91e(0x1f8)];else{if(_0x39d575[0x0]['language']=='Arabic\x20(ae)')var _0x2b617e=users[_0xbca91e(0x237)];}}}}}}}_0x518d1e[_0xbca91e(0x1f3)](_0xbca91e(0x246),{'success':_0x154d57[_0xbca91e(0x1fb)]('success'),'errors':_0x154d57['flash'](_0xbca91e(0x247)),'role':_0x22d86f,'profile':_0x538de8,'master_shop':_0x39d575,'user':_0x3d4d0e,'language':_0x2b617e});}catch(_0x36a70e){console[_0xbca91e(0x1e9)](_0x36a70e);}}),router['get'](a0_0x1784f6(0x1e2),auth,async(_0x540870,_0x83ba55)=>{var _0x1ae6b6=a0_0x1784f6;try{const {username:_0xad2a40,email:_0x67d982,role:_0x39f5aa}=_0x540870[_0x1ae6b6(0x24e)],_0x5c7398=_0x540870[_0x1ae6b6(0x24e)],_0x1814a4=await profile['findOne']({'email':_0x5c7398['email']}),_0x30f52a=await master_shop[_0x1ae6b6(0x242)]();console[_0x1ae6b6(0x1e9)]('master',_0x30f52a);const _0x37fb16=_0x540870[_0x1ae6b6(0x1fa)]['id'];console[_0x1ae6b6(0x1e9)](_0x37fb16);var _0xcdc2ca=[_0x1ae6b6(0x24f)];const _0x51f0ba=await sales_return_finished[_0x1ae6b6(0x234)](_0x37fb16),_0x33db2f=await warehouse[_0x1ae6b6(0x204)]([{'$match':{'name':_0x51f0ba[_0x1ae6b6(0x243)],'room':_0x51f0ba[_0x1ae6b6(0x224)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1ae6b6(0x20c),'name':{'$first':_0x1ae6b6(0x227)},'product_stock':{'$first':_0x1ae6b6(0x24b)},'bay':{'$first':_0x1ae6b6(0x1f9)},'bin':{'$first':_0x1ae6b6(0x23c)},'type':{'$first':_0x1ae6b6(0x230)},'floorlevel':{'$first':_0x1ae6b6(0x206)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1ae6b6(0x1f5)},'product_code':{'$first':_0x1ae6b6(0x24d)},'storage':{'$first':_0x1ae6b6(0x1d9)},'rack':{'$first':'$product_details.rack'}}}]);console[_0x1ae6b6(0x1e9)](_0x33db2f);const _0x23fe8c=await warehouse[_0x1ae6b6(0x204)]([{'$match':{'status':_0x1ae6b6(0x1de),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x1ae6b6(0x1f2),'name':{'$first':_0x1ae6b6(0x1f2)}}},{'$sort':{'name':0x1}}]),_0xdeb0a=await warehouse[_0x1ae6b6(0x204)]([{'$match':{'status':_0x1ae6b6(0x1de),'name':_0x1ae6b6(0x1dd)}},{'$group':{'_id':_0x1ae6b6(0x1f2),'name':{'$first':_0x1ae6b6(0x1f2)}}},{'$sort':{'name':0x1}}]),_0x34bce0=await product['find']({});if(_0x30f52a[0x0][_0x1ae6b6(0x1e0)]==_0x1ae6b6(0x21b)){var _0x2dbc81=users['English'];console[_0x1ae6b6(0x1e9)](_0x2dbc81);}else{if(_0x30f52a[0x0]['language']==_0x1ae6b6(0x1ff))var _0x2dbc81=users[_0x1ae6b6(0x1ff)];else{if(_0x30f52a[0x0]['language']==_0x1ae6b6(0x1e3))var _0x2dbc81=users[_0x1ae6b6(0x1e3)];else{if(_0x30f52a[0x0][_0x1ae6b6(0x1e0)]==_0x1ae6b6(0x1db))var _0x2dbc81=users['Spanish'];else{if(_0x30f52a[0x0][_0x1ae6b6(0x1e0)]=='French')var _0x2dbc81=users['French'];else{if(_0x30f52a[0x0]['language']==_0x1ae6b6(0x1e8))var _0x2dbc81=users[_0x1ae6b6(0x211)];else{if(_0x30f52a[0x0]['language']==_0x1ae6b6(0x1f8))var _0x2dbc81=users[_0x1ae6b6(0x1f8)];else{if(_0x30f52a[0x0][_0x1ae6b6(0x1e0)]==_0x1ae6b6(0x1d4))var _0x2dbc81=users[_0x1ae6b6(0x237)];}}}}}}}_0x83ba55[_0x1ae6b6(0x1f3)](_0x1ae6b6(0x205),{'success':_0x540870[_0x1ae6b6(0x1fb)](_0x1ae6b6(0x203)),'errors':_0x540870[_0x1ae6b6(0x1fb)](_0x1ae6b6(0x247)),'role':_0x5c7398,'profile':_0x1814a4,'master_shop':_0x30f52a,'user':_0x51f0ba,'stock':_0x33db2f,'unit':_0x34bce0,'language':_0x2dbc81,'warehouses':_0x23fe8c,'rooms':_0xcdc2ca,'warehouse_QA':_0xdeb0a});}catch(_0x3ba413){console['log'](_0x3ba413);}}),router[a0_0x1784f6(0x223)](a0_0x1784f6(0x1e2),auth,async(_0x306369,_0x7c6da6)=>{var _0x388784=a0_0x1784f6;if(_0x306369[_0x388784(0x1eb)][_0x388784(0x21c)]=='QA')try{const _0x4c35fd=_0x306369['params']['id'],_0x4636a5=await sales_return[_0x388784(0x228)]({'invoice':_0x306369[_0x388784(0x1eb)][_0x388784(0x20e)]}),_0x3ba5d0=await warehouse[_0x388784(0x228)]({'name':_0x4636a5['ToWarehouse'],'room':_0x4636a5[_0x388784(0x224)]}),{invoice:_0x252a4e,customer:_0xae6c53,date:_0x42fdd7,warehouse_name:_0x149d00,product_name:_0x596539,primary_code:_0x2bf91c,secondary_code:_0x44ab3c,product_code:_0xe5b7c1,sales_quantity:_0x2c4635,stocks:_0x49fcf4,return_qty:_0x4c50bd,note:_0x575d84,to_warehouse_name_QA:_0x17b738,to_Room_name_QA:_0x233b9f}=_0x306369[_0x388784(0x1eb)];if(typeof product_name_QA==_0x388784(0x245))var _0x433e99=[_0x306369['body'][_0x388784(0x21f)]],_0x51ef6c=[_0x306369[_0x388784(0x1eb)][_0x388784(0x20a)]],_0x3d27fe=[_0x306369[_0x388784(0x1eb)][_0x388784(0x1e7)]],_0x1ba414=[_0x306369[_0x388784(0x1eb)][_0x388784(0x210)]],_0x1694a8=[_0x306369['body'][_0x388784(0x1fe)]],_0x5830f0=[_0x306369[_0x388784(0x1eb)][_0x388784(0x1da)]],_0x1ee8be=[_0x306369[_0x388784(0x1eb)][_0x388784(0x208)]];else var _0x433e99=[..._0x306369['body'][_0x388784(0x21f)]],_0x51ef6c=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x20a)]],_0x3d27fe=[..._0x306369['body'][_0x388784(0x1e7)]],_0x1ba414=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x210)]],_0x1694a8=[..._0x306369[_0x388784(0x1eb)]['sales_quantity_QA']],_0x5830f0=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x1da)]],_0x1ee8be=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x208)]];const _0x4a0eba=_0x433e99[_0x388784(0x22a)](_0x2cdf86=>{return _0x2cdf86={'product_name':_0x2cdf86};});_0x51ef6c[_0x388784(0x1ec)]((_0x5db1b9,_0x126bf9)=>{var _0x13a595=_0x388784;_0x4a0eba[_0x126bf9][_0x13a595(0x23b)]=_0x5db1b9;}),_0x3d27fe[_0x388784(0x1ec)]((_0x6768f3,_0x4dcc17)=>{var _0x2b4e48=_0x388784;_0x4a0eba[_0x4dcc17][_0x2b4e48(0x222)]=_0x6768f3;}),_0x1ba414[_0x388784(0x1ec)]((_0x52dfe1,_0x5b49aa)=>{var _0x558464=_0x388784;_0x4a0eba[_0x5b49aa][_0x558464(0x23d)]=_0x52dfe1;}),_0x1694a8[_0x388784(0x1ec)]((_0x8c7b32,_0x16560b)=>{var _0x4ffec6=_0x388784;_0x4a0eba[_0x16560b][_0x4ffec6(0x221)]=_0x8c7b32;}),_0x5830f0['forEach']((_0x5695d9,_0x3165f8)=>{var _0x13ff25=_0x388784;_0x4a0eba[_0x3165f8][_0x13ff25(0x244)]=_0x5695d9;}),_0x1ee8be['forEach']((_0x35f958,_0xe770c2)=>{var _0x390ec8=_0x388784;_0x4a0eba[_0xe770c2][_0x390ec8(0x220)]=_0x35f958;}),_0x4636a5['return_sale_QA']['forEach'](_0x4671de=>{var _0x22d12e=_0x388784;const _0x357106=_0x3ba5d0[_0x22d12e(0x201)]['map'](_0x113c96=>{var _0x99946e=_0x22d12e;_0x113c96[_0x99946e(0x1e4)]==_0x4671de[_0x99946e(0x1e4)]&&(_0x113c96['product_stock']=parseInt(_0x113c96['product_stock'])+parseInt(_0x4671de[_0x99946e(0x220)]));});}),await _0x3ba5d0[_0x388784(0x225)](),_0x4636a5[_0x388784(0x20e)]=_0x252a4e,_0x4636a5[_0x388784(0x251)]=_0xae6c53,_0x4636a5[_0x388784(0x1e1)]=_0x42fdd7,_0x4636a5[_0x388784(0x218)]=_0x149d00,_0x4636a5[_0x388784(0x22e)]=_0x4a0eba,_0x4636a5[_0x388784(0x1ea)]=_0x575d84,_0x4636a5[_0x388784(0x243)]=_0x17b738,_0x4636a5['ToRoom']=_0x233b9f;const _0x560f54=await _0x4636a5[_0x388784(0x225)](),_0x520c9b=await c_payment_data[_0x388784(0x228)]({'invoice':_0x306369['body']['invoice'],'reason':'Sale\x20Return'});_0x520c9b[_0x388784(0x1fc)]=_0x306369[_0x388784(0x1eb)][_0x388784(0x1fc)],_0x520c9b[_0x388784(0x1e1)]=_0x306369[_0x388784(0x1eb)][_0x388784(0x1e1)],await _0x520c9b[_0x388784(0x225)](),_0x306369[_0x388784(0x1fb)]('success','purchase\x20return\x20successfully'),_0x7c6da6['redirect'](_0x388784(0x24c));}catch(_0x2d9113){console[_0x388784(0x1e9)](_0x2d9113),_0x7c6da6[_0x388784(0x23a)](0xc8)[_0x388784(0x23e)]({'message':_0x2d9113[_0x388784(0x1e5)]});}else try{const _0x49e70f=_0x306369[_0x388784(0x1fa)]['id'];console[_0x388784(0x1e9)](_0x49e70f);const _0x5f58bb=await sales_return[_0x388784(0x228)]({'invoice':_0x306369[_0x388784(0x1eb)][_0x388784(0x20e)]});console[_0x388784(0x1e9)]('old_data',_0x5f58bb);const _0x352123=await warehouse['findOne']({'name':_0x5f58bb[_0x388784(0x243)],'room':_0x5f58bb[_0x388784(0x224)]});console[_0x388784(0x1e9)](_0x388784(0x20d),_0x352123);const {invoice:_0x2c2db2,customer:_0x3a25bf,date:_0x215fe6,warehouse_name:_0x4eb426,product_name:_0xbd026f,primary_code:_0x323eaa,secondary_code:_0x5b8e65,product_code:_0x77bd27,sales_quantity:_0x31dfa9,stocks:_0x60e84b,return_qty:_0x549c01,note:_0x3c35f9,to_warehouse_name:_0x1cedfb,to_Room_name:_0x511bf1}=_0x306369[_0x388784(0x1eb)];console['log'](_0x306369[_0x388784(0x1eb)]);if(typeof _0xbd026f==_0x388784(0x245))var _0x433e99=[_0x306369[_0x388784(0x1eb)][_0x388784(0x1e4)]],_0x51ef6c=[_0x306369[_0x388784(0x1eb)][_0x388784(0x23b)]],_0x3d27fe=[_0x306369[_0x388784(0x1eb)]['secondary_code']],_0x1ba414=[_0x306369[_0x388784(0x1eb)][_0x388784(0x23d)]],_0x1694a8=[_0x306369[_0x388784(0x1eb)][_0x388784(0x22b)]],_0x5830f0=[_0x306369[_0x388784(0x1eb)][_0x388784(0x22f)]],_0x1ee8be=[_0x306369[_0x388784(0x1eb)]['return_qty']],_0x24cf41=[_0x306369[_0x388784(0x1eb)][_0x388784(0x229)]],_0x18cb88=[_0x306369[_0x388784(0x1eb)]['bin']],_0x2a7a24=[_0x306369[_0x388784(0x1eb)][_0x388784(0x232)]],_0x4a39bf=[_0x306369[_0x388784(0x1eb)][_0x388784(0x217)]];else var _0x433e99=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x1e4)]],_0x51ef6c=[..._0x306369['body'][_0x388784(0x23b)]],_0x3d27fe=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x222)]],_0x1ba414=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x23d)]],_0x1694a8=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x22b)]],_0x5830f0=[..._0x306369['body'][_0x388784(0x22f)]],_0x1ee8be=[..._0x306369[_0x388784(0x1eb)]['return_qty']],_0x24cf41=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x229)]],_0x18cb88=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x1f7)]],_0x2a7a24=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x232)]],_0x4a39bf=[..._0x306369[_0x388784(0x1eb)][_0x388784(0x217)]];const _0xadcc64=_0x433e99['map'](_0x22e96a=>{return _0x22e96a={'product_name':_0x22e96a};});_0x51ef6c[_0x388784(0x1ec)]((_0x46c79b,_0x48082f)=>{_0xadcc64[_0x48082f]['primary_code']=_0x46c79b;}),_0x3d27fe[_0x388784(0x1ec)]((_0x198d15,_0x249456)=>{var _0x2f9b07=_0x388784;_0xadcc64[_0x249456][_0x2f9b07(0x222)]=_0x198d15;}),_0x1ba414[_0x388784(0x1ec)]((_0x4b6a92,_0x40c938)=>{var _0x3997e0=_0x388784;_0xadcc64[_0x40c938][_0x3997e0(0x23d)]=_0x4b6a92;}),_0x1694a8['forEach']((_0x385215,_0x500b48)=>{var _0x2c57a8=_0x388784;_0xadcc64[_0x500b48][_0x2c57a8(0x221)]=_0x385215;}),_0x5830f0[_0x388784(0x1ec)]((_0x905d9d,_0x59643e)=>{var _0x545b34=_0x388784;_0xadcc64[_0x59643e][_0x545b34(0x244)]=_0x905d9d;}),_0x1ee8be[_0x388784(0x1ec)]((_0x2e5293,_0x22ec35)=>{var _0x48e37b=_0x388784;_0xadcc64[_0x22ec35][_0x48e37b(0x220)]=_0x2e5293;}),_0x24cf41[_0x388784(0x1ec)]((_0x4f17c1,_0x4764be)=>{var _0x13051f=_0x388784;_0xadcc64[_0x4764be][_0x13051f(0x229)]=_0x4f17c1;}),_0x18cb88[_0x388784(0x1ec)]((_0x916f6f,_0x2fbef7)=>{var _0x2b2ff9=_0x388784;_0xadcc64[_0x2fbef7][_0x2b2ff9(0x1f7)]=_0x916f6f;}),_0x2a7a24[_0x388784(0x1ec)]((_0x5518a1,_0x574e79)=>{_0xadcc64[_0x574e79]['type']=_0x5518a1;}),_0x4a39bf[_0x388784(0x1ec)]((_0x2f4eaa,_0x3e6d23)=>{var _0x5ca56e=_0x388784;_0xadcc64[_0x3e6d23][_0x5ca56e(0x217)]=_0x2f4eaa;});var _0x3dae56=0x0;_0xadcc64[_0x388784(0x1ec)](_0x402411=>{var _0xd42124=_0x388784;console['log'](_0xd42124(0x1fd),_0x402411),(parseInt(_0x402411[_0xd42124(0x221)])<parseInt(_0x402411['return_qty'])||parseInt(_0x402411[_0xd42124(0x244)])<parseInt(_0x402411[_0xd42124(0x220)])&&parseInt(_0x402411['sale_qty'])>parseInt(_0x402411['return_qty'])||parseInt(_0x402411[_0xd42124(0x220)])==0x0)&&_0x3dae56++;});if(_0x3dae56!=0x0)return _0x306369[_0x388784(0x1fb)]('errors',_0x388784(0x241)),_0x7c6da6[_0x388784(0x233)]('back');_0x5f58bb[_0x388784(0x24a)]['forEach'](_0x388d80=>{var _0x3d5d92=_0x388784;const _0x149cc7=_0x352123[_0x3d5d92(0x201)][_0x3d5d92(0x22a)](_0x57996e=>{var _0x1dd311=_0x3d5d92;_0x57996e[_0x1dd311(0x1e4)]==_0x388d80[_0x1dd311(0x1e4)]&&_0x57996e[_0x1dd311(0x217)]==_0x388d80[_0x1dd311(0x217)]&&_0x57996e['type']==_0x388d80[_0x1dd311(0x1e6)]&&_0x57996e['bin']==_0x388d80['bin']&&_0x57996e[_0x1dd311(0x229)]==_0x388d80[_0x1dd311(0x229)]&&(_0x57996e['product_stock']=parseInt(_0x57996e[_0x1dd311(0x202)])+parseInt(_0x388d80[_0x1dd311(0x220)]));});}),console[_0x388784(0x1e9)](_0x388784(0x20d),_0x352123),await _0x352123[_0x388784(0x225)](),_0x5f58bb[_0x388784(0x20e)]=_0x2c2db2,_0x5f58bb['customer']=_0x3a25bf,_0x5f58bb['date']=_0x215fe6,_0x5f58bb[_0x388784(0x218)]=_0x4eb426,_0x5f58bb[_0x388784(0x24a)]=_0xadcc64,_0x5f58bb[_0x388784(0x1ea)]=_0x3c35f9,_0x5f58bb[_0x388784(0x243)]=_0x1cedfb,_0x5f58bb[_0x388784(0x224)]=_0x511bf1;const _0x16f438=await _0x5f58bb[_0x388784(0x225)]();console[_0x388784(0x1e9)](_0x388784(0x239),_0x16f438);const _0x1f0c8a=await c_payment_data['findOne']({'invoice':_0x306369[_0x388784(0x1eb)][_0x388784(0x20e)],'reason':_0x388784(0x236)});_0x1f0c8a[_0x388784(0x1fc)]=_0x306369['body']['suppliers'],_0x1f0c8a[_0x388784(0x1e1)]=_0x306369[_0x388784(0x1eb)][_0x388784(0x1e1)],await _0x1f0c8a[_0x388784(0x225)](),_0x306369[_0x388784(0x1fb)](_0x388784(0x203),_0x388784(0x22d)),_0x7c6da6['redirect'](_0x388784(0x235));}catch(_0x52d106){console[_0x388784(0x1e9)](_0x52d106),_0x7c6da6['status'](0xc8)[_0x388784(0x23e)]({'message':_0x52d106[_0x388784(0x1e5)]});}}),router[a0_0x1784f6(0x223)](a0_0x1784f6(0x21a),auth,async(_0xd48a00,_0x50e6f0)=>{var _0x7b49f6=a0_0x1784f6;try{const _0x4927ad=_0xd48a00[_0x7b49f6(0x1fa)]['id'],{invoice:_0x715b57,customer:_0x3f16e8,payable_to_customer:_0x352ed3,paid_amount:_0x492eee}=_0xd48a00[_0x7b49f6(0x1eb)],_0x5caf70=await sales_return[_0x7b49f6(0x234)](_0x4927ad);console[_0x7b49f6(0x1e9)]('data',_0x5caf70),console['log'](_0x352ed3),console[_0x7b49f6(0x1e9)](_0x492eee);var _0x4d8358=_0x352ed3-_0x492eee;console[_0x7b49f6(0x1e9)]('subtract',_0x4d8358),_0x5caf70[_0x7b49f6(0x238)]=parseFloat(_0x492eee)+parseFloat(_0x5caf70[_0x7b49f6(0x238)]),_0x5caf70[_0x7b49f6(0x212)]=_0x4d8358,console['log'](_0x5caf70);const _0x3f28f2=await _0x5caf70[_0x7b49f6(0x225)]();console[_0x7b49f6(0x1e9)](0x1b207);const _0x2e0ca0=await c_payment_data[_0x7b49f6(0x228)]({'invoice':_0xd48a00['body'][_0x7b49f6(0x20e)],'reason':_0x7b49f6(0x236)});console[_0x7b49f6(0x1e9)](_0x7b49f6(0x231),_0x2e0ca0),_0x2e0ca0[_0x7b49f6(0x1ee)]=_0x4d8358,await _0x2e0ca0[_0x7b49f6(0x225)]();let _0x44c806=new Date(),_0x42d5fb=('0'+_0x44c806[_0x7b49f6(0x1d6)]())[_0x7b49f6(0x23f)](-0x2),_0x518f2b=('0'+(_0x44c806[_0x7b49f6(0x1df)]()+0x1))[_0x7b49f6(0x23f)](-0x2),_0x22f973=_0x44c806[_0x7b49f6(0x209)](),_0x29677e=_0x22f973+'-'+_0x518f2b+'-'+_0x42d5fb;const _0x1fe085=new customer_payment({'invoice':_0x715b57,'date':_0x22f973+'-'+_0x518f2b+'-'+_0x42d5fb,'customer':_0x3f16e8,'reason':_0x7b49f6(0x1f6),'amount':_0x492eee}),_0x3d9d39=await _0x1fe085[_0x7b49f6(0x225)]();_0xd48a00['flash'](_0x7b49f6(0x203),'payment\x20successfull'),_0x50e6f0[_0x7b49f6(0x233)](_0x7b49f6(0x235));}catch(_0x3c1bc1){console[_0x7b49f6(0x1e9)](_0x3c1bc1);}}),router[a0_0x1784f6(0x215)](a0_0x1784f6(0x240),auth,async(_0x57fb01,_0x18bd2b)=>{var _0x5ec2fc=a0_0x1784f6;try{const {username:_0x250a45,email:_0x388480,role:_0x21d60a}=_0x57fb01[_0x5ec2fc(0x24e)],_0x3af63e=_0x57fb01[_0x5ec2fc(0x24e)],_0x38cb28=await profile['findOne']({'email':_0x3af63e[_0x5ec2fc(0x1f4)]}),_0x548cdd=await master_shop[_0x5ec2fc(0x242)]();console[_0x5ec2fc(0x1e9)](_0x5ec2fc(0x214),_0x548cdd);const _0x437880=_0x57fb01['params']['id'],_0xd910a7=await sales_return['findById'](_0x437880);console[_0x5ec2fc(0x1e9)](_0xd910a7);const _0x23f862=await customer['findOne']({'name':_0xd910a7[_0x5ec2fc(0x251)]});console[_0x5ec2fc(0x1e9)](_0x23f862);if(_0x548cdd[0x0][_0x5ec2fc(0x1e0)]==_0x5ec2fc(0x21b)){var _0x217cc2=users[_0x5ec2fc(0x248)];console[_0x5ec2fc(0x1e9)](_0x217cc2);}else{if(_0x548cdd[0x0]['language']==_0x5ec2fc(0x1ff))var _0x217cc2=users[_0x5ec2fc(0x1ff)];else{if(_0x548cdd[0x0][_0x5ec2fc(0x1e0)]==_0x5ec2fc(0x1e3))var _0x217cc2=users[_0x5ec2fc(0x1e3)];else{if(_0x548cdd[0x0][_0x5ec2fc(0x1e0)]==_0x5ec2fc(0x1db))var _0x217cc2=users[_0x5ec2fc(0x1db)];else{if(_0x548cdd[0x0]['language']==_0x5ec2fc(0x1ed))var _0x217cc2=users[_0x5ec2fc(0x1ed)];else{if(_0x548cdd[0x0][_0x5ec2fc(0x1e0)]==_0x5ec2fc(0x1e8))var _0x217cc2=users[_0x5ec2fc(0x211)];else{if(_0x548cdd[0x0][_0x5ec2fc(0x1e0)]==_0x5ec2fc(0x1f8))var _0x217cc2=users[_0x5ec2fc(0x1f8)];else{if(_0x548cdd[0x0][_0x5ec2fc(0x1e0)]==_0x5ec2fc(0x1d4))var _0x217cc2=users[_0x5ec2fc(0x237)];}}}}}}}_0x18bd2b['render'](_0x5ec2fc(0x20f),{'success':_0x57fb01[_0x5ec2fc(0x1fb)](_0x5ec2fc(0x203)),'errors':_0x57fb01['flash'](_0x5ec2fc(0x247)),'role':_0x3af63e,'profile':_0x38cb28,'master_shop':_0x548cdd,'customers':_0x23f862,'sales':_0xd910a7,'language':_0x217cc2});}catch(_0x2d7943){console[_0x5ec2fc(0x1e9)](_0x2d7943);}}),module[a0_0x1784f6(0x249)]=router;