var a0_0x1b6764=a0_0x13dc;function a0_0x25bc(){var _0x51f2a7=['142378mBoXzA','customer','exports','$product_details.product_stock','findOne','customers','16wlVNCl','purchase\x20return\x20successfully','Router','getMonth','/view/:id','save','success','bin','flash','sales_return_invoice','QA\x20Warehouse','status','secondary_code_QA','German','params','French','$name','user','Finished\x20Goods','type','get','for_categorize','email','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','ToRoom','warehouse_name','$product_details.storage','date','express','Arabic\x20(ae)','Chinese','back','note','findById','sale_qty','find','/view','getFullYear','string','render','8499843Mlqlqf','log','../middleware/auth','old_data','611007qyDtNM','slice','language','$product_details.product_name','Portuguese','3471550mGEXTj','ToWarehouse','message','product_code_QA','aggregate','stocks','errors','$product_details._id','663996xWByYN','13ZKAOHj','types','Portuguese\x20(BR)','$customer_docs','return_sale','old_warehouse_data','Enabled','subtract','sales_return_finished','json','product_details','2BWKrwe','sales_quantity','product_name','due_amount','body','$product_details.bin','bay','primary_code','Hindi','secondary_code','12832212prQvbN','primary_code_QA','product_name_QA','$product_details','product_stock','amount','new\x20new_data','sales_quantity_QA','map','/give_payment/:id','/sales_return/view','return_qty_QA','data','suppliers','return_qty','English\x20(US)','Sale\x20Return','master','22vQfXNQ','Arabic','stock','forEach','7avyTdQ','/invoice/:id','$product_details.product_code','$product_details.bay','invoice','stocks_QA','Returned\x20Payment\x20For\x20Sale\x20Return','floorlevel','redirect','product_code','return_sale_QA','../models/all_models','$product_details.floorlevel','$product_details.secondary_code','7494096BiRNZZ','$product_details.primary_code','English','15IVijof','Spanish'];a0_0x25bc=function(){return _0x51f2a7;};return a0_0x25bc();}(function(_0x4ef07c,_0x2eab2a){var _0x45dec5=a0_0x13dc,_0x469b02=_0x4ef07c();while(!![]){try{var _0x52a839=-parseInt(_0x45dec5(0x95))/0x1*(parseInt(_0x45dec5(0xc8))/0x2)+parseInt(_0x45dec5(0x7c))/0x3*(-parseInt(_0x45dec5(0xce))/0x4)+parseInt(_0x45dec5(0xc6))/0x5*(-parseInt(_0x45dec5(0x89))/0x6)+parseInt(_0x45dec5(0xb5))/0x7*(-parseInt(_0x45dec5(0xc3))/0x8)+parseInt(_0x45dec5(0x78))/0x9+-parseInt(_0x45dec5(0x81))/0xa*(-parseInt(_0x45dec5(0xb1))/0xb)+parseInt(_0x45dec5(0x9f))/0xc*(parseInt(_0x45dec5(0x8a))/0xd);if(_0x52a839===_0x2eab2a)break;else _0x469b02['push'](_0x469b02['shift']());}catch(_0x36bb94){_0x469b02['push'](_0x469b02['shift']());}}}(a0_0x25bc,0x75be2));const express=require(a0_0x1b6764(0x6c)),app=express(),router=express[a0_0x1b6764(0xd0)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require(a0_0x1b6764(0xc0)),auth=require(a0_0x1b6764(0x7a)),users=require('../public/language/languages.json');function a0_0x13dc(_0x436208,_0x4ec5bf){var _0x25bc7d=a0_0x25bc();return a0_0x13dc=function(_0x13dc5e,_0x3a0aa9){_0x13dc5e=_0x13dc5e-0x64;var _0x2d5fb0=_0x25bc7d[_0x13dc5e];return _0x2d5fb0;},a0_0x13dc(_0x436208,_0x4ec5bf);}router['get'](a0_0x1b6764(0x74),auth,async(_0x2b6a7e,_0x1fb88b)=>{var _0x5c0cc1=a0_0x1b6764;try{const {username:_0x2a92a6,email:_0x46c6eb,role:_0x4882ca}=_0x2b6a7e[_0x5c0cc1(0xdf)],_0x11ce0b=_0x2b6a7e[_0x5c0cc1(0xdf)],_0x5b1828=await profile[_0x5c0cc1(0xcc)]({'email':_0x11ce0b['email']}),_0x53f47b=await master_shop[_0x5c0cc1(0x73)](),_0x180f18=await sales_return_finished[_0x5c0cc1(0x85)]([{'$lookup':{'from':_0x5c0cc1(0xcd),'localField':_0x5c0cc1(0xc9),'foreignField':'name','as':'customer_docs'}},{'$unwind':_0x5c0cc1(0x8d)}]);if(_0x53f47b[0x0][_0x5c0cc1(0x7e)]==_0x5c0cc1(0xae)){var _0x339c89=users[_0x5c0cc1(0xc5)];console['log'](_0x339c89);}else{if(_0x53f47b[0x0][_0x5c0cc1(0x7e)]==_0x5c0cc1(0x9d))var _0x339c89=users['Hindi'];else{if(_0x53f47b[0x0]['language']==_0x5c0cc1(0xdb))var _0x339c89=users[_0x5c0cc1(0xdb)];else{if(_0x53f47b[0x0][_0x5c0cc1(0x7e)]==_0x5c0cc1(0xc7))var _0x339c89=users[_0x5c0cc1(0xc7)];else{if(_0x53f47b[0x0]['language']==_0x5c0cc1(0xdd))var _0x339c89=users[_0x5c0cc1(0xdd)];else{if(_0x53f47b[0x0][_0x5c0cc1(0x7e)]==_0x5c0cc1(0x8c))var _0x339c89=users['Portuguese'];else{if(_0x53f47b[0x0][_0x5c0cc1(0x7e)]==_0x5c0cc1(0x6e))var _0x339c89=users[_0x5c0cc1(0x6e)];else{if(_0x53f47b[0x0][_0x5c0cc1(0x7e)]==_0x5c0cc1(0x6d))var _0x339c89=users[_0x5c0cc1(0xb2)];}}}}}}}_0x1fb88b['render'](_0x5c0cc1(0x92),{'success':_0x2b6a7e[_0x5c0cc1(0xd6)](_0x5c0cc1(0xd4)),'errors':_0x2b6a7e['flash']('errors'),'role':_0x11ce0b,'profile':_0x5b1828,'master_shop':_0x53f47b,'user':_0x180f18,'language':_0x339c89});}catch(_0x7bd22a){console['log'](_0x7bd22a);}}),router[a0_0x1b6764(0x64)]('/view/:id',auth,async(_0x4fd004,_0x471186)=>{var _0x2cacc4=a0_0x1b6764;try{const {username:_0x560c69,email:_0xad617,role:_0x2f9cf7}=_0x4fd004[_0x2cacc4(0xdf)],_0x7c7906=_0x4fd004[_0x2cacc4(0xdf)],_0x57625a=await profile[_0x2cacc4(0xcc)]({'email':_0x7c7906['email']}),_0x2e3998=await master_shop[_0x2cacc4(0x73)]();console[_0x2cacc4(0x79)]('master',_0x2e3998);const _0x52dec9=_0x4fd004[_0x2cacc4(0xdc)]['id'];console[_0x2cacc4(0x79)](_0x52dec9);var _0xf989fd=['Return\x20Rooms'];const _0x3c2d11=await sales_return_finished[_0x2cacc4(0x71)](_0x52dec9),_0x232ec0=await warehouse[_0x2cacc4(0x85)]([{'$match':{'name':_0x3c2d11[_0x2cacc4(0x82)],'room':_0x3c2d11['ToRoom']}},{'$unwind':_0x2cacc4(0xa2)},{'$group':{'_id':_0x2cacc4(0x88),'name':{'$first':_0x2cacc4(0x7f)},'product_stock':{'$first':_0x2cacc4(0xcb)},'bay':{'$first':_0x2cacc4(0xb8)},'bin':{'$first':_0x2cacc4(0x9a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x2cacc4(0xc1)},'primary_code':{'$first':_0x2cacc4(0xc4)},'secondary_code':{'$first':_0x2cacc4(0xc2)},'product_code':{'$first':_0x2cacc4(0xb7)},'storage':{'$first':_0x2cacc4(0x6a)},'rack':{'$first':'$product_details.rack'}}}]);console['log'](_0x232ec0);const _0x4535c1=await warehouse[_0x2cacc4(0x85)]([{'$match':{'status':_0x2cacc4(0x90),'warehouse_category':_0x2cacc4(0xe0)}},{'$group':{'_id':_0x2cacc4(0xde),'name':{'$first':_0x2cacc4(0xde)}}},{'$sort':{'name':0x1}}]),_0x284965=await warehouse['aggregate']([{'$match':{'status':_0x2cacc4(0x90),'name':_0x2cacc4(0xd8)}},{'$group':{'_id':'$name','name':{'$first':_0x2cacc4(0xde)}}},{'$sort':{'name':0x1}}]),_0x40cebe=await product[_0x2cacc4(0x73)]({});if(_0x2e3998[0x0][_0x2cacc4(0x7e)]==_0x2cacc4(0xae)){var _0xb7a3aa=users['English'];console[_0x2cacc4(0x79)](_0xb7a3aa);}else{if(_0x2e3998[0x0][_0x2cacc4(0x7e)]==_0x2cacc4(0x9d))var _0xb7a3aa=users[_0x2cacc4(0x9d)];else{if(_0x2e3998[0x0][_0x2cacc4(0x7e)]=='German')var _0xb7a3aa=users[_0x2cacc4(0xdb)];else{if(_0x2e3998[0x0][_0x2cacc4(0x7e)]==_0x2cacc4(0xc7))var _0xb7a3aa=users[_0x2cacc4(0xc7)];else{if(_0x2e3998[0x0][_0x2cacc4(0x7e)]==_0x2cacc4(0xdd))var _0xb7a3aa=users[_0x2cacc4(0xdd)];else{if(_0x2e3998[0x0]['language']==_0x2cacc4(0x8c))var _0xb7a3aa=users[_0x2cacc4(0x80)];else{if(_0x2e3998[0x0]['language']=='Chinese')var _0xb7a3aa=users[_0x2cacc4(0x6e)];else{if(_0x2e3998[0x0]['language']==_0x2cacc4(0x6d))var _0xb7a3aa=users[_0x2cacc4(0xb2)];}}}}}}}_0x471186[_0x2cacc4(0x77)]('return_sale_edit_finished',{'success':_0x4fd004[_0x2cacc4(0xd6)](_0x2cacc4(0xd4)),'errors':_0x4fd004[_0x2cacc4(0xd6)](_0x2cacc4(0x87)),'role':_0x7c7906,'profile':_0x57625a,'master_shop':_0x2e3998,'user':_0x3c2d11,'stock':_0x232ec0,'unit':_0x40cebe,'language':_0xb7a3aa,'warehouses':_0x4535c1,'rooms':_0xf989fd,'warehouse_QA':_0x284965});}catch(_0x30f5a5){console[_0x2cacc4(0x79)](_0x30f5a5);}}),router['post'](a0_0x1b6764(0xd2),auth,async(_0xda87e7,_0x58ffb4)=>{var _0x303812=a0_0x1b6764;if(_0xda87e7['body'][_0x303812(0x65)]=='QA')try{const _0x3f0ac0=_0xda87e7[_0x303812(0xdc)]['id'],_0x5e6c1e=await sales_return[_0x303812(0xcc)]({'invoice':_0xda87e7[_0x303812(0x99)][_0x303812(0xb9)]}),_0x531077=await warehouse['findOne']({'name':_0x5e6c1e[_0x303812(0x82)],'room':_0x5e6c1e[_0x303812(0x68)]}),{invoice:_0x2dfee9,customer:_0x317a18,date:_0x23a957,warehouse_name:_0x1f9fc7,product_name:_0x5d2263,primary_code:_0x29af4c,secondary_code:_0x1cf6e0,product_code:_0x3b9344,sales_quantity:_0x1bf7b6,stocks:_0x19951d,return_qty:_0x31ce86,note:_0x1ebc33,to_warehouse_name_QA:_0x47e623,to_Room_name_QA:_0x440202}=_0xda87e7[_0x303812(0x99)];if(typeof product_name_QA==_0x303812(0x76))var _0x17947f=[_0xda87e7[_0x303812(0x99)][_0x303812(0xa1)]],_0x5858ff=[_0xda87e7[_0x303812(0x99)][_0x303812(0xa0)]],_0x5c5b8d=[_0xda87e7['body'][_0x303812(0xda)]],_0x5b9435=[_0xda87e7[_0x303812(0x99)][_0x303812(0x84)]],_0x39ec0e=[_0xda87e7['body'][_0x303812(0xa6)]],_0x21de5d=[_0xda87e7[_0x303812(0x99)][_0x303812(0xba)]],_0x2ff645=[_0xda87e7[_0x303812(0x99)][_0x303812(0xaa)]];else var _0x17947f=[..._0xda87e7[_0x303812(0x99)][_0x303812(0xa1)]],_0x5858ff=[..._0xda87e7[_0x303812(0x99)][_0x303812(0xa0)]],_0x5c5b8d=[..._0xda87e7[_0x303812(0x99)]['secondary_code_QA']],_0x5b9435=[..._0xda87e7[_0x303812(0x99)][_0x303812(0x84)]],_0x39ec0e=[..._0xda87e7['body'][_0x303812(0xa6)]],_0x21de5d=[..._0xda87e7[_0x303812(0x99)][_0x303812(0xba)]],_0x2ff645=[..._0xda87e7[_0x303812(0x99)][_0x303812(0xaa)]];const _0x2aac6b=_0x17947f[_0x303812(0xa7)](_0x585aab=>{return _0x585aab={'product_name':_0x585aab};});_0x5858ff[_0x303812(0xb4)]((_0x33f2a7,_0x2ab3d7)=>{var _0x11d647=_0x303812;_0x2aac6b[_0x2ab3d7][_0x11d647(0x9c)]=_0x33f2a7;}),_0x5c5b8d['forEach']((_0x18529c,_0x459996)=>{var _0x12a75e=_0x303812;_0x2aac6b[_0x459996][_0x12a75e(0x9e)]=_0x18529c;}),_0x5b9435[_0x303812(0xb4)]((_0x180790,_0x3fcf44)=>{var _0x8c1916=_0x303812;_0x2aac6b[_0x3fcf44][_0x8c1916(0xbe)]=_0x180790;}),_0x39ec0e[_0x303812(0xb4)]((_0xdf4bb0,_0x51111a)=>{var _0x1fde39=_0x303812;_0x2aac6b[_0x51111a][_0x1fde39(0x72)]=_0xdf4bb0;}),_0x21de5d['forEach']((_0x44ac2a,_0x144766)=>{_0x2aac6b[_0x144766]['stock']=_0x44ac2a;}),_0x2ff645[_0x303812(0xb4)]((_0x5bdfc1,_0x466870)=>{var _0x2f0dc2=_0x303812;_0x2aac6b[_0x466870][_0x2f0dc2(0xad)]=_0x5bdfc1;}),_0x5e6c1e['return_sale_QA'][_0x303812(0xb4)](_0x223607=>{var _0x4cc56c=_0x303812;const _0x507d56=_0x531077['product_details'][_0x4cc56c(0xa7)](_0x28f9fe=>{var _0x3c9535=_0x4cc56c;_0x28f9fe[_0x3c9535(0x97)]==_0x223607[_0x3c9535(0x97)]&&(_0x28f9fe['product_stock']=parseInt(_0x28f9fe[_0x3c9535(0xa3)])+parseInt(_0x223607[_0x3c9535(0xad)]));});}),await _0x531077[_0x303812(0xd3)](),_0x5e6c1e[_0x303812(0xb9)]=_0x2dfee9,_0x5e6c1e[_0x303812(0xc9)]=_0x317a18,_0x5e6c1e[_0x303812(0x6b)]=_0x23a957,_0x5e6c1e[_0x303812(0x69)]=_0x1f9fc7,_0x5e6c1e[_0x303812(0xbf)]=_0x2aac6b,_0x5e6c1e[_0x303812(0x70)]=_0x1ebc33,_0x5e6c1e[_0x303812(0x82)]=_0x47e623,_0x5e6c1e['ToRoom']=_0x440202;const _0x597387=await _0x5e6c1e['save'](),_0x4d4b09=await c_payment_data[_0x303812(0xcc)]({'invoice':_0xda87e7[_0x303812(0x99)][_0x303812(0xb9)],'reason':'Sale\x20Return'});_0x4d4b09['suppliers']=_0xda87e7[_0x303812(0x99)]['suppliers'],_0x4d4b09[_0x303812(0x6b)]=_0xda87e7[_0x303812(0x99)][_0x303812(0x6b)],await _0x4d4b09[_0x303812(0xd3)](),_0xda87e7[_0x303812(0xd6)]('success',_0x303812(0xcf)),_0x58ffb4['redirect']('/sales_return_finished/view');}catch(_0x1fa22c){console[_0x303812(0x79)](_0x1fa22c),_0x58ffb4[_0x303812(0xd9)](0xc8)[_0x303812(0x93)]({'message':_0x1fa22c[_0x303812(0x83)]});}else try{const _0x42f56d=_0xda87e7[_0x303812(0xdc)]['id'];console[_0x303812(0x79)](_0x42f56d);const _0x24e118=await sales_return['findOne']({'invoice':_0xda87e7[_0x303812(0x99)]['invoice']});console[_0x303812(0x79)](_0x303812(0x7b),_0x24e118);const _0x5526e3=await warehouse[_0x303812(0xcc)]({'name':_0x24e118[_0x303812(0x82)],'room':_0x24e118['ToRoom']});console['log']('old_warehouse_data',_0x5526e3);const {invoice:_0x3643e0,customer:_0x10dfd4,date:_0x1abfe9,warehouse_name:_0x29bc3c,product_name:_0x4c4693,primary_code:_0x60915d,secondary_code:_0x102bf9,product_code:_0x2de58e,sales_quantity:_0x4a5e41,stocks:_0x609d3c,return_qty:_0x2eac96,note:_0x12b905,to_warehouse_name:_0x2995ca,to_Room_name:_0x409ab0}=_0xda87e7[_0x303812(0x99)];console['log'](_0xda87e7[_0x303812(0x99)]);if(typeof _0x4c4693==_0x303812(0x76))var _0x17947f=[_0xda87e7[_0x303812(0x99)][_0x303812(0x97)]],_0x5858ff=[_0xda87e7[_0x303812(0x99)]['primary_code']],_0x5c5b8d=[_0xda87e7[_0x303812(0x99)][_0x303812(0x9e)]],_0x5b9435=[_0xda87e7['body']['product_code']],_0x39ec0e=[_0xda87e7[_0x303812(0x99)]['sales_quantity']],_0x21de5d=[_0xda87e7[_0x303812(0x99)]['stocks']],_0x2ff645=[_0xda87e7[_0x303812(0x99)][_0x303812(0xad)]],_0x1dd698=[_0xda87e7[_0x303812(0x99)][_0x303812(0x9b)]],_0x1ca8ec=[_0xda87e7[_0x303812(0x99)][_0x303812(0xd5)]],_0x19e8de=[_0xda87e7['body'][_0x303812(0x8b)]],_0x2d8f5e=[_0xda87e7[_0x303812(0x99)][_0x303812(0xbc)]];else var _0x17947f=[..._0xda87e7['body'][_0x303812(0x97)]],_0x5858ff=[..._0xda87e7[_0x303812(0x99)][_0x303812(0x9c)]],_0x5c5b8d=[..._0xda87e7[_0x303812(0x99)]['secondary_code']],_0x5b9435=[..._0xda87e7[_0x303812(0x99)][_0x303812(0xbe)]],_0x39ec0e=[..._0xda87e7[_0x303812(0x99)][_0x303812(0x96)]],_0x21de5d=[..._0xda87e7['body'][_0x303812(0x86)]],_0x2ff645=[..._0xda87e7[_0x303812(0x99)][_0x303812(0xad)]],_0x1dd698=[..._0xda87e7['body'][_0x303812(0x9b)]],_0x1ca8ec=[..._0xda87e7[_0x303812(0x99)][_0x303812(0xd5)]],_0x19e8de=[..._0xda87e7[_0x303812(0x99)][_0x303812(0x8b)]],_0x2d8f5e=[..._0xda87e7[_0x303812(0x99)][_0x303812(0xbc)]];const _0xd243b4=_0x17947f[_0x303812(0xa7)](_0x1f72d3=>{return _0x1f72d3={'product_name':_0x1f72d3};});_0x5858ff[_0x303812(0xb4)]((_0x2260f9,_0xeccd8)=>{var _0x1b88e8=_0x303812;_0xd243b4[_0xeccd8][_0x1b88e8(0x9c)]=_0x2260f9;}),_0x5c5b8d[_0x303812(0xb4)]((_0x852463,_0x2efa19)=>{var _0x36f763=_0x303812;_0xd243b4[_0x2efa19][_0x36f763(0x9e)]=_0x852463;}),_0x5b9435[_0x303812(0xb4)]((_0x430d48,_0x23ebff)=>{var _0x3dfa05=_0x303812;_0xd243b4[_0x23ebff][_0x3dfa05(0xbe)]=_0x430d48;}),_0x39ec0e[_0x303812(0xb4)]((_0x1dd3dc,_0x46e446)=>{_0xd243b4[_0x46e446]['sale_qty']=_0x1dd3dc;}),_0x21de5d['forEach']((_0x3db6b8,_0x442114)=>{var _0x3f243a=_0x303812;_0xd243b4[_0x442114][_0x3f243a(0xb3)]=_0x3db6b8;}),_0x2ff645[_0x303812(0xb4)]((_0x5cafab,_0x337cfe)=>{var _0x346b00=_0x303812;_0xd243b4[_0x337cfe][_0x346b00(0xad)]=_0x5cafab;}),_0x1dd698['forEach']((_0x2f79b3,_0x3f874c)=>{_0xd243b4[_0x3f874c]['bay']=_0x2f79b3;}),_0x1ca8ec['forEach']((_0x3279cb,_0x29ee66)=>{var _0x54f888=_0x303812;_0xd243b4[_0x29ee66][_0x54f888(0xd5)]=_0x3279cb;}),_0x19e8de['forEach']((_0x476e8a,_0x4a63b8)=>{var _0x51b0cf=_0x303812;_0xd243b4[_0x4a63b8][_0x51b0cf(0xe1)]=_0x476e8a;}),_0x2d8f5e[_0x303812(0xb4)]((_0x31c5f4,_0x400f74)=>{_0xd243b4[_0x400f74]['floorlevel']=_0x31c5f4;});var _0x43887c=0x0;_0xd243b4[_0x303812(0xb4)](_0x4ee433=>{var _0xe1f453=_0x303812;console[_0xe1f453(0x79)]('foreach\x20newproduct',_0x4ee433),(parseInt(_0x4ee433[_0xe1f453(0x72)])<parseInt(_0x4ee433[_0xe1f453(0xad)])||parseInt(_0x4ee433['stock'])<parseInt(_0x4ee433['return_qty'])&&parseInt(_0x4ee433[_0xe1f453(0x72)])>parseInt(_0x4ee433['return_qty'])||parseInt(_0x4ee433[_0xe1f453(0xad)])==0x0)&&_0x43887c++;});if(_0x43887c!=0x0)return _0xda87e7[_0x303812(0xd6)](_0x303812(0x87),_0x303812(0x67)),_0x58ffb4[_0x303812(0xbd)](_0x303812(0x6f));_0x24e118['return_sale'][_0x303812(0xb4)](_0x939306=>{var _0x2574b5=_0x303812;const _0x38bf55=_0x5526e3[_0x2574b5(0x94)][_0x2574b5(0xa7)](_0x286140=>{var _0x228d9e=_0x2574b5;_0x286140['product_name']==_0x939306[_0x228d9e(0x97)]&&_0x286140[_0x228d9e(0xbc)]==_0x939306['floorlevel']&&_0x286140['type']==_0x939306[_0x228d9e(0xe1)]&&_0x286140['bin']==_0x939306[_0x228d9e(0xd5)]&&_0x286140['bay']==_0x939306[_0x228d9e(0x9b)]&&(_0x286140[_0x228d9e(0xa3)]=parseInt(_0x286140[_0x228d9e(0xa3)])+parseInt(_0x939306[_0x228d9e(0xad)]));});}),console[_0x303812(0x79)](_0x303812(0x8f),_0x5526e3),await _0x5526e3[_0x303812(0xd3)](),_0x24e118[_0x303812(0xb9)]=_0x3643e0,_0x24e118[_0x303812(0xc9)]=_0x10dfd4,_0x24e118[_0x303812(0x6b)]=_0x1abfe9,_0x24e118[_0x303812(0x69)]=_0x29bc3c,_0x24e118[_0x303812(0x8e)]=_0xd243b4,_0x24e118[_0x303812(0x70)]=_0x12b905,_0x24e118[_0x303812(0x82)]=_0x2995ca,_0x24e118[_0x303812(0x68)]=_0x409ab0;const _0x41f149=await _0x24e118[_0x303812(0xd3)]();console['log'](_0x303812(0xa5),_0x41f149);const _0x43a764=await c_payment_data['findOne']({'invoice':_0xda87e7[_0x303812(0x99)][_0x303812(0xb9)],'reason':_0x303812(0xaf)});_0x43a764[_0x303812(0xac)]=_0xda87e7[_0x303812(0x99)][_0x303812(0xac)],_0x43a764['date']=_0xda87e7[_0x303812(0x99)]['date'],await _0x43a764[_0x303812(0xd3)](),_0xda87e7[_0x303812(0xd6)]('success',_0x303812(0xcf)),_0x58ffb4[_0x303812(0xbd)](_0x303812(0xa9));}catch(_0xe31864){console[_0x303812(0x79)](_0xe31864),_0x58ffb4[_0x303812(0xd9)](0xc8)['json']({'message':_0xe31864[_0x303812(0x83)]});}}),router['post'](a0_0x1b6764(0xa8),auth,async(_0x1f9c57,_0x2da7e8)=>{var _0x30d71b=a0_0x1b6764;try{const _0x4e3533=_0x1f9c57['params']['id'],{invoice:_0x30c2be,customer:_0x38648c,payable_to_customer:_0x2b5421,paid_amount:_0x339b92}=_0x1f9c57[_0x30d71b(0x99)],_0x246d42=await sales_return[_0x30d71b(0x71)](_0x4e3533);console['log'](_0x30d71b(0xab),_0x246d42),console[_0x30d71b(0x79)](_0x2b5421),console[_0x30d71b(0x79)](_0x339b92);var _0x3a4ca5=_0x2b5421-_0x339b92;console[_0x30d71b(0x79)](_0x30d71b(0x91),_0x3a4ca5),_0x246d42['paid_amount']=parseFloat(_0x339b92)+parseFloat(_0x246d42['paid_amount']),_0x246d42[_0x30d71b(0x98)]=_0x3a4ca5,console[_0x30d71b(0x79)](_0x246d42);const _0x59a190=await _0x246d42['save']();console[_0x30d71b(0x79)](0x1b207);const _0x5c01b3=await c_payment_data[_0x30d71b(0xcc)]({'invoice':_0x1f9c57['body'][_0x30d71b(0xb9)],'reason':_0x30d71b(0xaf)});console[_0x30d71b(0x79)]('c_payment',_0x5c01b3),_0x5c01b3[_0x30d71b(0xa4)]=_0x3a4ca5,await _0x5c01b3['save']();let _0x1a05cb=new Date(),_0x323c52=('0'+_0x1a05cb['getDate']())[_0x30d71b(0x7d)](-0x2),_0x2b714b=('0'+(_0x1a05cb[_0x30d71b(0xd1)]()+0x1))['slice'](-0x2),_0x32c8ac=_0x1a05cb[_0x30d71b(0x75)](),_0x2268a1=_0x32c8ac+'-'+_0x2b714b+'-'+_0x323c52;const _0x15a3ce=new customer_payment({'invoice':_0x30c2be,'date':_0x32c8ac+'-'+_0x2b714b+'-'+_0x323c52,'customer':_0x38648c,'reason':_0x30d71b(0xbb),'amount':_0x339b92}),_0x641af7=await _0x15a3ce[_0x30d71b(0xd3)]();_0x1f9c57[_0x30d71b(0xd6)](_0x30d71b(0xd4),'payment\x20successfull'),_0x2da7e8[_0x30d71b(0xbd)]('/sales_return/view');}catch(_0x249681){console[_0x30d71b(0x79)](_0x249681);}}),router[a0_0x1b6764(0x64)](a0_0x1b6764(0xb6),auth,async(_0x243f55,_0x32c268)=>{var _0x3ea489=a0_0x1b6764;try{const {username:_0x17887e,email:_0xacc00d,role:_0x3a7999}=_0x243f55['user'],_0x5374f2=_0x243f55['user'],_0x2e489d=await profile[_0x3ea489(0xcc)]({'email':_0x5374f2[_0x3ea489(0x66)]}),_0x2585bf=await master_shop[_0x3ea489(0x73)]();console['log'](_0x3ea489(0xb0),_0x2585bf);const _0x95466e=_0x243f55[_0x3ea489(0xdc)]['id'],_0x555b0b=await sales_return[_0x3ea489(0x71)](_0x95466e);console['log'](_0x555b0b);const _0x9a892b=await customer[_0x3ea489(0xcc)]({'name':_0x555b0b['customer']});console['log'](_0x9a892b);if(_0x2585bf[0x0][_0x3ea489(0x7e)]==_0x3ea489(0xae)){var _0x4b8607=users[_0x3ea489(0xc5)];console[_0x3ea489(0x79)](_0x4b8607);}else{if(_0x2585bf[0x0][_0x3ea489(0x7e)]==_0x3ea489(0x9d))var _0x4b8607=users['Hindi'];else{if(_0x2585bf[0x0]['language']==_0x3ea489(0xdb))var _0x4b8607=users['German'];else{if(_0x2585bf[0x0][_0x3ea489(0x7e)]=='Spanish')var _0x4b8607=users[_0x3ea489(0xc7)];else{if(_0x2585bf[0x0][_0x3ea489(0x7e)]==_0x3ea489(0xdd))var _0x4b8607=users[_0x3ea489(0xdd)];else{if(_0x2585bf[0x0][_0x3ea489(0x7e)]=='Portuguese\x20(BR)')var _0x4b8607=users['Portuguese'];else{if(_0x2585bf[0x0]['language']==_0x3ea489(0x6e))var _0x4b8607=users[_0x3ea489(0x6e)];else{if(_0x2585bf[0x0][_0x3ea489(0x7e)]==_0x3ea489(0x6d))var _0x4b8607=users['Arabic'];}}}}}}}_0x32c268[_0x3ea489(0x77)](_0x3ea489(0xd7),{'success':_0x243f55[_0x3ea489(0xd6)](_0x3ea489(0xd4)),'errors':_0x243f55[_0x3ea489(0xd6)](_0x3ea489(0x87)),'role':_0x5374f2,'profile':_0x2e489d,'master_shop':_0x2585bf,'customers':_0x9a892b,'sales':_0x555b0b,'language':_0x4b8607});}catch(_0x1e8321){console['log'](_0x1e8321);}}),module[a0_0x1b6764(0xca)]=router;