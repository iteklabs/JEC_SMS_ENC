var a0_0x6d69fe=a0_0x70e3;(function(_0x245cb1,_0x2d5ad4){var _0x8c930=a0_0x70e3,_0x2a005b=_0x245cb1();while(!![]){try{var _0x32eda2=-parseInt(_0x8c930(0x182))/0x1*(parseInt(_0x8c930(0x19a))/0x2)+parseInt(_0x8c930(0x191))/0x3*(parseInt(_0x8c930(0x1d8))/0x4)+parseInt(_0x8c930(0x183))/0x5*(-parseInt(_0x8c930(0x171))/0x6)+-parseInt(_0x8c930(0x1b9))/0x7*(-parseInt(_0x8c930(0x1c3))/0x8)+parseInt(_0x8c930(0x197))/0x9*(-parseInt(_0x8c930(0x189))/0xa)+parseInt(_0x8c930(0x1ad))/0xb+-parseInt(_0x8c930(0x1e1))/0xc*(-parseInt(_0x8c930(0x1c2))/0xd);if(_0x32eda2===_0x2d5ad4)break;else _0x2a005b['push'](_0x2a005b['shift']());}catch(_0x1e06e2){_0x2a005b['push'](_0x2a005b['shift']());}}}(a0_0x2407,0xc0643));function a0_0x70e3(_0x34124b,_0xd1348b){var _0x240790=a0_0x2407();return a0_0x70e3=function(_0x70e3e5,_0x4bafff){_0x70e3e5=_0x70e3e5-0x16c;var _0x3fa7c4=_0x240790[_0x70e3e5];return _0x3fa7c4;},a0_0x70e3(_0x34124b,_0xd1348b);}const express=require(a0_0x6d69fe(0x1ae)),app=express(),router=express[a0_0x6d69fe(0x1e9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require(a0_0x6d69fe(0x198)),users=require(a0_0x6d69fe(0x18f));router['get'](a0_0x6d69fe(0x1a7),auth,async(_0x2c2299,_0x114c5e)=>{var _0x2fc42d=a0_0x6d69fe;try{const {username:_0x1f5d98,email:_0x1ef65d,role:_0x20afd6}=_0x2c2299[_0x2fc42d(0x1d6)],_0x356127=_0x2c2299[_0x2fc42d(0x1d6)],_0x21f8af=await profile[_0x2fc42d(0x19e)]({'email':_0x356127[_0x2fc42d(0x177)]}),_0x258bed=await master_shop[_0x2fc42d(0x1c0)](),_0xd66878=await sales_return_finished[_0x2fc42d(0x1a5)]([{'$lookup':{'from':_0x2fc42d(0x193),'localField':_0x2fc42d(0x1b6),'foreignField':_0x2fc42d(0x1a2),'as':_0x2fc42d(0x1ce)}},{'$unwind':'$customer_docs'}]);if(_0x258bed[0x0][_0x2fc42d(0x192)]=='English\x20(US)'){var _0x2ba38a=users[_0x2fc42d(0x175)];console['log'](_0x2ba38a);}else{if(_0x258bed[0x0]['language']==_0x2fc42d(0x185))var _0x2ba38a=users['Hindi'];else{if(_0x258bed[0x0][_0x2fc42d(0x192)]==_0x2fc42d(0x186))var _0x2ba38a=users['German'];else{if(_0x258bed[0x0][_0x2fc42d(0x192)]=='Spanish')var _0x2ba38a=users[_0x2fc42d(0x1aa)];else{if(_0x258bed[0x0]['language']=='French')var _0x2ba38a=users[_0x2fc42d(0x188)];else{if(_0x258bed[0x0][_0x2fc42d(0x192)]==_0x2fc42d(0x1af))var _0x2ba38a=users[_0x2fc42d(0x17b)];else{if(_0x258bed[0x0][_0x2fc42d(0x192)]==_0x2fc42d(0x1ba))var _0x2ba38a=users[_0x2fc42d(0x1ba)];else{if(_0x258bed[0x0][_0x2fc42d(0x192)]==_0x2fc42d(0x1b0))var _0x2ba38a=users[_0x2fc42d(0x195)];}}}}}}}_0x114c5e[_0x2fc42d(0x18c)](_0x2fc42d(0x1e7),{'success':_0x2c2299[_0x2fc42d(0x1a0)]('success'),'errors':_0x2c2299['flash'](_0x2fc42d(0x1cc)),'role':_0x356127,'profile':_0x21f8af,'master_shop':_0x258bed,'user':_0xd66878,'language':_0x2ba38a});}catch(_0x59578a){console[_0x2fc42d(0x1b8)](_0x59578a);}}),router[a0_0x6d69fe(0x16f)](a0_0x6d69fe(0x1da),auth,async(_0x1f835b,_0x2ba117)=>{var _0x1cd4c8=a0_0x6d69fe;try{const {username:_0x2946d5,email:_0x2aa8bb,role:_0x192a01}=_0x1f835b[_0x1cd4c8(0x1d6)],_0x4e9f19=_0x1f835b[_0x1cd4c8(0x1d6)],_0x45be89=await profile[_0x1cd4c8(0x19e)]({'email':_0x4e9f19[_0x1cd4c8(0x177)]}),_0x5a9db9=await master_shop['find']();console[_0x1cd4c8(0x1b8)](_0x1cd4c8(0x194),_0x5a9db9);const _0x3a03d9=_0x1f835b['params']['id'];console[_0x1cd4c8(0x1b8)](_0x3a03d9);var _0x5c3466=['Return\x20Rooms'];const _0x47261d=await sales_return_finished['findById'](_0x3a03d9),_0x17ee0d=await warehouse[_0x1cd4c8(0x1a5)]([{'$match':{'name':_0x47261d['ToWarehouse'],'room':_0x47261d[_0x1cd4c8(0x1ab)]}},{'$unwind':_0x1cd4c8(0x18e)},{'$group':{'_id':_0x1cd4c8(0x1d5),'name':{'$first':_0x1cd4c8(0x1a3)},'product_stock':{'$first':_0x1cd4c8(0x1a1)},'bay':{'$first':_0x1cd4c8(0x1b4)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x1cd4c8(0x17a)},'floorlevel':{'$first':_0x1cd4c8(0x1e6)},'primary_code':{'$first':_0x1cd4c8(0x199)},'secondary_code':{'$first':_0x1cd4c8(0x1d7)},'product_code':{'$first':_0x1cd4c8(0x17c)},'storage':{'$first':_0x1cd4c8(0x1ca)},'rack':{'$first':_0x1cd4c8(0x179)}}}]);console['log'](_0x17ee0d);const _0x461a99=await warehouse[_0x1cd4c8(0x1a5)]([{'$match':{'status':'Enabled','warehouse_category':_0x1cd4c8(0x184)}},{'$group':{'_id':'$name','name':{'$first':_0x1cd4c8(0x1c5)}}},{'$sort':{'name':0x1}}]),_0x449988=await warehouse[_0x1cd4c8(0x1a5)]([{'$match':{'status':'Enabled','name':_0x1cd4c8(0x1c7)}},{'$group':{'_id':_0x1cd4c8(0x1c5),'name':{'$first':_0x1cd4c8(0x1c5)}}},{'$sort':{'name':0x1}}]),_0x536db9=await product[_0x1cd4c8(0x1c0)]({});if(_0x5a9db9[0x0][_0x1cd4c8(0x192)]==_0x1cd4c8(0x1e2)){var _0x1448f3=users[_0x1cd4c8(0x175)];console[_0x1cd4c8(0x1b8)](_0x1448f3);}else{if(_0x5a9db9[0x0][_0x1cd4c8(0x192)]==_0x1cd4c8(0x185))var _0x1448f3=users[_0x1cd4c8(0x185)];else{if(_0x5a9db9[0x0][_0x1cd4c8(0x192)]=='German')var _0x1448f3=users['German'];else{if(_0x5a9db9[0x0][_0x1cd4c8(0x192)]==_0x1cd4c8(0x1aa))var _0x1448f3=users[_0x1cd4c8(0x1aa)];else{if(_0x5a9db9[0x0][_0x1cd4c8(0x192)]==_0x1cd4c8(0x188))var _0x1448f3=users['French'];else{if(_0x5a9db9[0x0][_0x1cd4c8(0x192)]=='Portuguese\x20(BR)')var _0x1448f3=users['Portuguese'];else{if(_0x5a9db9[0x0]['language']=='Chinese')var _0x1448f3=users['Chinese'];else{if(_0x5a9db9[0x0][_0x1cd4c8(0x192)]==_0x1cd4c8(0x1b0))var _0x1448f3=users[_0x1cd4c8(0x195)];}}}}}}}_0x2ba117[_0x1cd4c8(0x18c)]('return_sale_edit_finished',{'success':_0x1f835b[_0x1cd4c8(0x1a0)](_0x1cd4c8(0x178)),'errors':_0x1f835b[_0x1cd4c8(0x1a0)]('errors'),'role':_0x4e9f19,'profile':_0x45be89,'master_shop':_0x5a9db9,'user':_0x47261d,'stock':_0x17ee0d,'unit':_0x536db9,'language':_0x1448f3,'warehouses':_0x461a99,'rooms':_0x5c3466,'warehouse_QA':_0x449988});}catch(_0x5e373e){console[_0x1cd4c8(0x1b8)](_0x5e373e);}}),router[a0_0x6d69fe(0x1b2)](a0_0x6d69fe(0x1da),auth,async(_0x44a5d2,_0xfd5c52)=>{var _0x30889e=a0_0x6d69fe;if(_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x19d)]=='QA')try{const _0x15bd1d=_0x44a5d2[_0x30889e(0x1dd)]['id'],_0x31c116=await sales_return[_0x30889e(0x19e)]({'invoice':_0x44a5d2['body']['invoice']}),_0x2ba2f9=await warehouse[_0x30889e(0x19e)]({'name':_0x31c116['ToWarehouse'],'room':_0x31c116['ToRoom']}),{invoice:_0x46f0b0,customer:_0x10744c,date:_0xa5f969,warehouse_name:_0x369e4b,product_name:_0x453c6a,primary_code:_0x333f79,secondary_code:_0x16ec28,product_code:_0x4cc018,sales_quantity:_0x396bbc,stocks:_0x494ed2,return_qty:_0x3ccbc3,note:_0x34c76e,to_warehouse_name_QA:_0x7296b2,to_Room_name_QA:_0x4cde5c}=_0x44a5d2[_0x30889e(0x1c9)];if(typeof product_name_QA=='string')var _0x373daa=[_0x44a5d2[_0x30889e(0x1c9)]['product_name_QA']],_0x2146dc=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1be)]],_0x5c426f=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1b3)]],_0x47ab49=[_0x44a5d2[_0x30889e(0x1c9)]['product_code_QA']],_0x2a102c=[_0x44a5d2[_0x30889e(0x1c9)]['sales_quantity_QA']],_0x4851f9=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1cd)]],_0x263919=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x180)]];else var _0x373daa=[..._0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x172)]],_0x2146dc=[..._0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1be)]],_0x5c426f=[..._0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1b3)]],_0x47ab49=[..._0x44a5d2[_0x30889e(0x1c9)]['product_code_QA']],_0x2a102c=[..._0x44a5d2['body'][_0x30889e(0x1a4)]],_0x4851f9=[..._0x44a5d2['body']['stocks_QA']],_0x263919=[..._0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x180)]];const _0x37f131=_0x373daa['map'](_0x1c0e62=>{return _0x1c0e62={'product_name':_0x1c0e62};});_0x2146dc[_0x30889e(0x1c4)]((_0x7255e,_0x1da34b)=>{var _0x402841=_0x30889e;_0x37f131[_0x1da34b][_0x402841(0x181)]=_0x7255e;}),_0x5c426f[_0x30889e(0x1c4)]((_0x5981dc,_0x20c361)=>{_0x37f131[_0x20c361]['secondary_code']=_0x5981dc;}),_0x47ab49['forEach']((_0x3532d4,_0x336dd9)=>{var _0x658001=_0x30889e;_0x37f131[_0x336dd9][_0x658001(0x1b5)]=_0x3532d4;}),_0x2a102c[_0x30889e(0x1c4)]((_0x4934a1,_0x1c1ec9)=>{_0x37f131[_0x1c1ec9]['sale_qty']=_0x4934a1;}),_0x4851f9['forEach']((_0x22f9e3,_0x25ae07)=>{var _0x563f2d=_0x30889e;_0x37f131[_0x25ae07][_0x563f2d(0x1db)]=_0x22f9e3;}),_0x263919[_0x30889e(0x1c4)]((_0x4061cc,_0x31ca4d)=>{_0x37f131[_0x31ca4d]['return_qty']=_0x4061cc;}),_0x31c116[_0x30889e(0x176)][_0x30889e(0x1c4)](_0x5decae=>{var _0xbff253=_0x30889e;const _0x2e9cca=_0x2ba2f9['product_details'][_0xbff253(0x174)](_0x28776a=>{var _0x10e8b5=_0xbff253;_0x28776a[_0x10e8b5(0x1e3)]==_0x5decae[_0x10e8b5(0x1e3)]&&(_0x28776a[_0x10e8b5(0x1bd)]=parseInt(_0x28776a[_0x10e8b5(0x1bd)])+parseInt(_0x5decae[_0x10e8b5(0x19c)]));});}),await _0x2ba2f9[_0x30889e(0x1ac)](),_0x31c116[_0x30889e(0x1bf)]=_0x46f0b0,_0x31c116['customer']=_0x10744c,_0x31c116['date']=_0xa5f969,_0x31c116[_0x30889e(0x19f)]=_0x369e4b,_0x31c116[_0x30889e(0x176)]=_0x37f131,_0x31c116[_0x30889e(0x1bc)]=_0x34c76e,_0x31c116[_0x30889e(0x1d0)]=_0x7296b2,_0x31c116[_0x30889e(0x1ab)]=_0x4cde5c;const _0x26852d=await _0x31c116[_0x30889e(0x1ac)](),_0xf2c4f7=await c_payment_data[_0x30889e(0x19e)]({'invoice':_0x44a5d2[_0x30889e(0x1c9)]['invoice'],'reason':_0x30889e(0x18b)});_0xf2c4f7[_0x30889e(0x1dc)]=_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1dc)],_0xf2c4f7[_0x30889e(0x1d1)]=_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1d1)],await _0xf2c4f7[_0x30889e(0x1ac)](),_0x44a5d2[_0x30889e(0x1a0)]('success',_0x30889e(0x16d)),_0xfd5c52[_0x30889e(0x1c8)](_0x30889e(0x1bb));}catch(_0x48c94d){console[_0x30889e(0x1b8)](_0x48c94d),_0xfd5c52[_0x30889e(0x1e0)](0xc8)['json']({'message':_0x48c94d[_0x30889e(0x196)]});}else try{const _0x1d6ff2=_0x44a5d2[_0x30889e(0x1dd)]['id'];console[_0x30889e(0x1b8)](_0x1d6ff2);const _0x37119e=await sales_return[_0x30889e(0x19e)]({'invoice':_0x44a5d2['body'][_0x30889e(0x1bf)]});console[_0x30889e(0x1b8)](_0x30889e(0x1a9),_0x37119e);const _0x21d066=await warehouse[_0x30889e(0x19e)]({'name':_0x37119e[_0x30889e(0x1d0)],'room':_0x37119e[_0x30889e(0x1ab)]});console[_0x30889e(0x1b8)]('old_warehouse_data',_0x21d066);const {invoice:_0x46dc74,customer:_0x2f8a64,date:_0x454a5b,warehouse_name:_0x132330,product_name:_0x47e0cc,primary_code:_0x5f5a58,secondary_code:_0x54bd2a,product_code:_0x59610c,sales_quantity:_0x24bbcb,stocks:_0x3d13e3,return_qty:_0x6790a2,note:_0x53c59a,to_warehouse_name:_0x16a7b6,to_Room_name:_0x167379}=_0x44a5d2[_0x30889e(0x1c9)];console[_0x30889e(0x1b8)](_0x44a5d2[_0x30889e(0x1c9)]);if(typeof _0x47e0cc=='string')var _0x373daa=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1e3)]],_0x2146dc=[_0x44a5d2[_0x30889e(0x1c9)]['primary_code']],_0x5c426f=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1a6)]],_0x47ab49=[_0x44a5d2[_0x30889e(0x1c9)]['product_code']],_0x2a102c=[_0x44a5d2[_0x30889e(0x1c9)]['sales_quantity']],_0x4851f9=[_0x44a5d2[_0x30889e(0x1c9)]['stocks']],_0x263919=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x19c)]],_0x1dcbd5=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x16e)]],_0x12c209=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1e8)]],_0x57466c=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1d9)]],_0xa608a6=[_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x190)]];else var _0x373daa=[..._0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1e3)]],_0x2146dc=[..._0x44a5d2[_0x30889e(0x1c9)]['primary_code']],_0x5c426f=[..._0x44a5d2['body'][_0x30889e(0x1a6)]],_0x47ab49=[..._0x44a5d2[_0x30889e(0x1c9)]['product_code']],_0x2a102c=[..._0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x187)]],_0x4851f9=[..._0x44a5d2['body']['stocks']],_0x263919=[..._0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x19c)]],_0x1dcbd5=[..._0x44a5d2['body'][_0x30889e(0x16e)]],_0x12c209=[..._0x44a5d2['body'][_0x30889e(0x1e8)]],_0x57466c=[..._0x44a5d2[_0x30889e(0x1c9)]['types']],_0xa608a6=[..._0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x190)]];const _0x19618e=_0x373daa['map'](_0x3f2b07=>{return _0x3f2b07={'product_name':_0x3f2b07};});_0x2146dc[_0x30889e(0x1c4)]((_0x18d933,_0x53d157)=>{_0x19618e[_0x53d157]['primary_code']=_0x18d933;}),_0x5c426f['forEach']((_0x1df434,_0x20f102)=>{var _0x4d2dc3=_0x30889e;_0x19618e[_0x20f102][_0x4d2dc3(0x1a6)]=_0x1df434;}),_0x47ab49[_0x30889e(0x1c4)]((_0x5a50f3,_0x12165e)=>{var _0x262538=_0x30889e;_0x19618e[_0x12165e][_0x262538(0x1b5)]=_0x5a50f3;}),_0x2a102c['forEach']((_0x52772d,_0x789808)=>{var _0x4f0dd7=_0x30889e;_0x19618e[_0x789808][_0x4f0dd7(0x1b1)]=_0x52772d;}),_0x4851f9['forEach']((_0x4f16d1,_0x6b30bc)=>{var _0x4e8bde=_0x30889e;_0x19618e[_0x6b30bc][_0x4e8bde(0x1db)]=_0x4f16d1;}),_0x263919['forEach']((_0x3395c4,_0x1db7e2)=>{_0x19618e[_0x1db7e2]['return_qty']=_0x3395c4;}),_0x1dcbd5[_0x30889e(0x1c4)]((_0x34350b,_0x8763da)=>{var _0x5a22eb=_0x30889e;_0x19618e[_0x8763da][_0x5a22eb(0x16e)]=_0x34350b;}),_0x12c209[_0x30889e(0x1c4)]((_0x224e07,_0x38f8a7)=>{var _0x2f97dd=_0x30889e;_0x19618e[_0x38f8a7][_0x2f97dd(0x1e8)]=_0x224e07;}),_0x57466c[_0x30889e(0x1c4)]((_0x39bebb,_0x23d85c)=>{var _0xd0350a=_0x30889e;_0x19618e[_0x23d85c][_0xd0350a(0x17f)]=_0x39bebb;}),_0xa608a6[_0x30889e(0x1c4)]((_0x4d5e00,_0x24064e)=>{_0x19618e[_0x24064e]['floorlevel']=_0x4d5e00;});var _0x49d742=0x0;_0x19618e[_0x30889e(0x1c4)](_0x2bd089=>{var _0x5f2a9e=_0x30889e;console[_0x5f2a9e(0x1b8)](_0x5f2a9e(0x1d4),_0x2bd089),(parseInt(_0x2bd089[_0x5f2a9e(0x1b1)])<parseInt(_0x2bd089[_0x5f2a9e(0x19c)])||parseInt(_0x2bd089[_0x5f2a9e(0x1db)])<parseInt(_0x2bd089[_0x5f2a9e(0x19c)])&&parseInt(_0x2bd089[_0x5f2a9e(0x1b1)])>parseInt(_0x2bd089[_0x5f2a9e(0x19c)])||parseInt(_0x2bd089[_0x5f2a9e(0x19c)])==0x0)&&_0x49d742++;});if(_0x49d742!=0x0)return _0x44a5d2[_0x30889e(0x1a0)]('errors',_0x30889e(0x1a8)),_0xfd5c52['redirect'](_0x30889e(0x17e));_0x37119e[_0x30889e(0x1e4)][_0x30889e(0x1c4)](_0x36168d=>{var _0x4e7c9a=_0x30889e;const _0x155a92=_0x21d066[_0x4e7c9a(0x18d)][_0x4e7c9a(0x174)](_0x266734=>{var _0x12cd0f=_0x4e7c9a;_0x266734[_0x12cd0f(0x1e3)]==_0x36168d[_0x12cd0f(0x1e3)]&&_0x266734[_0x12cd0f(0x190)]==_0x36168d[_0x12cd0f(0x190)]&&_0x266734['type']==_0x36168d[_0x12cd0f(0x17f)]&&_0x266734[_0x12cd0f(0x1e8)]==_0x36168d[_0x12cd0f(0x1e8)]&&_0x266734['bay']==_0x36168d[_0x12cd0f(0x16e)]&&(_0x266734[_0x12cd0f(0x1bd)]=parseInt(_0x266734[_0x12cd0f(0x1bd)])+parseInt(_0x36168d[_0x12cd0f(0x19c)]));});}),console[_0x30889e(0x1b8)]('old_warehouse_data',_0x21d066),await _0x21d066[_0x30889e(0x1ac)](),_0x37119e[_0x30889e(0x1bf)]=_0x46dc74,_0x37119e[_0x30889e(0x1b6)]=_0x2f8a64,_0x37119e[_0x30889e(0x1d1)]=_0x454a5b,_0x37119e[_0x30889e(0x19f)]=_0x132330,_0x37119e['return_sale']=_0x19618e,_0x37119e[_0x30889e(0x1bc)]=_0x53c59a,_0x37119e['ToWarehouse']=_0x16a7b6,_0x37119e[_0x30889e(0x1ab)]=_0x167379;const _0x1a3f2d=await _0x37119e[_0x30889e(0x1ac)]();console[_0x30889e(0x1b8)](_0x30889e(0x18a),_0x1a3f2d);const _0x174338=await c_payment_data[_0x30889e(0x19e)]({'invoice':_0x44a5d2[_0x30889e(0x1c9)]['invoice'],'reason':_0x30889e(0x18b)});_0x174338[_0x30889e(0x1dc)]=_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1dc)],_0x174338[_0x30889e(0x1d1)]=_0x44a5d2[_0x30889e(0x1c9)][_0x30889e(0x1d1)],await _0x174338[_0x30889e(0x1ac)](),_0x44a5d2[_0x30889e(0x1a0)](_0x30889e(0x178),'purchase\x20return\x20successfully'),_0xfd5c52[_0x30889e(0x1c8)](_0x30889e(0x17d));}catch(_0x45382e){console[_0x30889e(0x1b8)](_0x45382e),_0xfd5c52[_0x30889e(0x1e0)](0xc8)[_0x30889e(0x16c)]({'message':_0x45382e[_0x30889e(0x196)]});}}),router[a0_0x6d69fe(0x1b2)](a0_0x6d69fe(0x1df),auth,async(_0x44faaf,_0x43becb)=>{var _0x480695=a0_0x6d69fe;try{const _0x280c83=_0x44faaf[_0x480695(0x1dd)]['id'],{invoice:_0x169f02,customer:_0xd4f191,payable_to_customer:_0x591c16,paid_amount:_0x13b9ea}=_0x44faaf[_0x480695(0x1c9)],_0x25b150=await sales_return['findById'](_0x280c83);console[_0x480695(0x1b8)](_0x480695(0x1c1),_0x25b150),console['log'](_0x591c16),console[_0x480695(0x1b8)](_0x13b9ea);var _0x3db8da=_0x591c16-_0x13b9ea;console['log'](_0x480695(0x19b),_0x3db8da),_0x25b150[_0x480695(0x170)]=parseFloat(_0x13b9ea)+parseFloat(_0x25b150[_0x480695(0x170)]),_0x25b150[_0x480695(0x1c6)]=_0x3db8da,console[_0x480695(0x1b8)](_0x25b150);const _0xe733b9=await _0x25b150[_0x480695(0x1ac)]();console[_0x480695(0x1b8)](0x1b207);const _0x54d876=await c_payment_data[_0x480695(0x19e)]({'invoice':_0x44faaf[_0x480695(0x1c9)]['invoice'],'reason':_0x480695(0x18b)});console[_0x480695(0x1b8)]('c_payment',_0x54d876),_0x54d876['amount']=_0x3db8da,await _0x54d876[_0x480695(0x1ac)]();let _0x1ac400=new Date(),_0x5a55cc=('0'+_0x1ac400[_0x480695(0x1cf)]())[_0x480695(0x1b7)](-0x2),_0x306642=('0'+(_0x1ac400[_0x480695(0x1d2)]()+0x1))[_0x480695(0x1b7)](-0x2),_0x8570c6=_0x1ac400['getFullYear'](),_0x16eff7=_0x8570c6+'-'+_0x306642+'-'+_0x5a55cc;const _0x342f09=new customer_payment({'invoice':_0x169f02,'date':_0x8570c6+'-'+_0x306642+'-'+_0x5a55cc,'customer':_0xd4f191,'reason':_0x480695(0x1cb),'amount':_0x13b9ea}),_0x549f71=await _0x342f09['save']();_0x44faaf[_0x480695(0x1a0)](_0x480695(0x178),_0x480695(0x1e5)),_0x43becb[_0x480695(0x1c8)](_0x480695(0x17d));}catch(_0x37ef64){console[_0x480695(0x1b8)](_0x37ef64);}}),router[a0_0x6d69fe(0x16f)](a0_0x6d69fe(0x1de),auth,async(_0x3fba17,_0x26ea64)=>{var _0x5cb1a4=a0_0x6d69fe;try{const {username:_0x185f4e,email:_0x5a4b31,role:_0x1f5ad9}=_0x3fba17[_0x5cb1a4(0x1d6)],_0x991ae8=_0x3fba17[_0x5cb1a4(0x1d6)],_0x1a0ceb=await profile['findOne']({'email':_0x991ae8[_0x5cb1a4(0x177)]}),_0x847636=await master_shop[_0x5cb1a4(0x1c0)]();console['log']('master',_0x847636);const _0x718f66=_0x3fba17[_0x5cb1a4(0x1dd)]['id'],_0x31b7c=await sales_return[_0x5cb1a4(0x1d3)](_0x718f66);console[_0x5cb1a4(0x1b8)](_0x31b7c);const _0x227c81=await customer[_0x5cb1a4(0x19e)]({'name':_0x31b7c[_0x5cb1a4(0x1b6)]});console[_0x5cb1a4(0x1b8)](_0x227c81);if(_0x847636[0x0][_0x5cb1a4(0x192)]==_0x5cb1a4(0x1e2)){var _0x5b5204=users[_0x5cb1a4(0x175)];console[_0x5cb1a4(0x1b8)](_0x5b5204);}else{if(_0x847636[0x0][_0x5cb1a4(0x192)]==_0x5cb1a4(0x185))var _0x5b5204=users[_0x5cb1a4(0x185)];else{if(_0x847636[0x0][_0x5cb1a4(0x192)]=='German')var _0x5b5204=users[_0x5cb1a4(0x186)];else{if(_0x847636[0x0]['language']==_0x5cb1a4(0x1aa))var _0x5b5204=users['Spanish'];else{if(_0x847636[0x0][_0x5cb1a4(0x192)]==_0x5cb1a4(0x188))var _0x5b5204=users[_0x5cb1a4(0x188)];else{if(_0x847636[0x0][_0x5cb1a4(0x192)]==_0x5cb1a4(0x1af))var _0x5b5204=users[_0x5cb1a4(0x17b)];else{if(_0x847636[0x0][_0x5cb1a4(0x192)]==_0x5cb1a4(0x1ba))var _0x5b5204=users[_0x5cb1a4(0x1ba)];else{if(_0x847636[0x0][_0x5cb1a4(0x192)]==_0x5cb1a4(0x1b0))var _0x5b5204=users[_0x5cb1a4(0x195)];}}}}}}}_0x26ea64[_0x5cb1a4(0x18c)]('sales_return_invoice',{'success':_0x3fba17[_0x5cb1a4(0x1a0)](_0x5cb1a4(0x178)),'errors':_0x3fba17[_0x5cb1a4(0x1a0)]('errors'),'role':_0x991ae8,'profile':_0x1a0ceb,'master_shop':_0x847636,'customers':_0x227c81,'sales':_0x31b7c,'language':_0x5b5204});}catch(_0x9a157b){console[_0x5cb1a4(0x1b8)](_0x9a157b);}}),module[a0_0x6d69fe(0x173)]=router;function a0_0x2407(){var _0x46d397=['$product_details.rack','$product_details.type','Portuguese','$product_details.product_code','/sales_return/view','back','type','return_qty_QA','primary_code','141KsEfyw','32075uQgbrg','Finished\x20Goods','Hindi','German','sales_quantity','French','1576040WSHQbA','new\x20new_data','Sale\x20Return','render','product_details','$product_details','../public/language/languages.json','floorlevel','2256AMYTeW','language','customers','master','Arabic','message','90dMbsFF','../middleware/auth','$product_details.primary_code','8104SCUluf','subtract','return_qty','for_categorize','findOne','warehouse_name','flash','$product_details.product_stock','name','$product_details.product_name','sales_quantity_QA','aggregate','secondary_code','/view','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','old_data','Spanish','ToRoom','save','6734464HKSxnw','express','Portuguese\x20(BR)','Arabic\x20(ae)','sale_qty','post','secondary_code_QA','$product_details.bay','product_code','customer','slice','log','7ThFYYz','Chinese','/sales_return_finished/view','note','product_stock','primary_code_QA','invoice','find','data','33449kgqILJ','9612184rsSxjG','forEach','$name','due_amount','QA\x20Warehouse','redirect','body','$product_details.storage','Returned\x20Payment\x20For\x20Sale\x20Return','errors','stocks_QA','customer_docs','getDate','ToWarehouse','date','getMonth','findById','foreach\x20newproduct','$product_details._id','user','$product_details.secondary_code','2824vFUDJa','types','/view/:id','stock','suppliers','params','/invoice/:id','/give_payment/:id','status','7572hrezOg','English\x20(US)','product_name','return_sale','payment\x20successfull','$product_details.floorlevel','sales_return_finished','bin','Router','json','purchase\x20return\x20successfully','bay','get','paid_amount','966CNUUCn','product_name_QA','exports','map','English','return_sale_QA','email','success'];a0_0x2407=function(){return _0x46d397;};return a0_0x2407();}