var a0_0x57a9e2=a0_0xbc25;(function(_0x77c752,_0x6138b6){var _0x4d3579=a0_0xbc25,_0x3dd44d=_0x77c752();while(!![]){try{var _0xc09a33=-parseInt(_0x4d3579(0x1e1))/0x1+parseInt(_0x4d3579(0x1bd))/0x2*(-parseInt(_0x4d3579(0x1cf))/0x3)+-parseInt(_0x4d3579(0x1ba))/0x4*(parseInt(_0x4d3579(0x124))/0x5)+parseInt(_0x4d3579(0x187))/0x6+parseInt(_0x4d3579(0x111))/0x7+-parseInt(_0x4d3579(0x171))/0x8*(-parseInt(_0x4d3579(0x174))/0x9)+parseInt(_0x4d3579(0x172))/0xa*(parseInt(_0x4d3579(0x15d))/0xb);if(_0xc09a33===_0x6138b6)break;else _0x3dd44d['push'](_0x3dd44d['shift']());}catch(_0x268b24){_0x3dd44d['push'](_0x3dd44d['shift']());}}}(a0_0xc509,0xa3f65));const express=require(a0_0x57a9e2(0x190)),app=express(),router=express[a0_0x57a9e2(0x19a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x57a9e2(0x175)),auth=require(a0_0x57a9e2(0x1b1)),users=require(a0_0x57a9e2(0x150)),nodemailer=require(a0_0x57a9e2(0x1ae));router[a0_0x57a9e2(0x142)](a0_0x57a9e2(0x191),auth,async(_0x365145,_0x387158)=>{var _0xd41c10=a0_0x57a9e2;try{const {username:_0x4daa86,email:_0x20bbff,role:_0x29950b}=_0x365145['user'],_0x5198ab=_0x365145[_0xd41c10(0x1dc)],_0x514909=await profile['findOne']({'email':_0x5198ab[_0xd41c10(0x1a1)]}),_0x464ed2=await master_shop['find']();console[_0xd41c10(0x11a)](_0xd41c10(0x17c),_0x464ed2);let _0x59b748;if(_0x5198ab[_0xd41c10(0x1f2)]==_0xd41c10(0x101)){const _0x50811c=await staff[_0xd41c10(0x14c)]({'email':_0x5198ab[_0xd41c10(0x1a1)]});_0x59b748=await transfers[_0xd41c10(0x1c1)]({'from_warehouse':_0x50811c[_0xd41c10(0x156)]});}else _0x59b748=await transfers['aggregate']([{'$unwind':_0xd41c10(0x10f)},{'$group':{'_id':_0xd41c10(0x158),'invoice':{'$first':_0xd41c10(0x104)},'date':{'$first':_0xd41c10(0x139)},'from_warehouse':{'$first':_0xd41c10(0x19e)},'to_warehouse':{'$first':_0xd41c10(0x132)},'from_room_name':{'$addToSet':_0xd41c10(0x166)},'to_room_name':{'$addToSet':_0xd41c10(0x10a)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0xd41c10(0x13e)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x464ed2[0x0][_0xd41c10(0x148)]==_0xd41c10(0x14d)){var _0x8c93e8=users['English'];console[_0xd41c10(0x11a)](_0x8c93e8);}else{if(_0x464ed2[0x0][_0xd41c10(0x148)]==_0xd41c10(0x170))var _0x8c93e8=users['Hindi'];else{if(_0x464ed2[0x0][_0xd41c10(0x148)]==_0xd41c10(0x1ca))var _0x8c93e8=users['German'];else{if(_0x464ed2[0x0][_0xd41c10(0x148)]==_0xd41c10(0x12b))var _0x8c93e8=users['Spanish'];else{if(_0x464ed2[0x0][_0xd41c10(0x148)]==_0xd41c10(0x1b8))var _0x8c93e8=users[_0xd41c10(0x1b8)];else{if(_0x464ed2[0x0]['language']==_0xd41c10(0x169))var _0x8c93e8=users[_0xd41c10(0x115)];else{if(_0x464ed2[0x0][_0xd41c10(0x148)]==_0xd41c10(0x109))var _0x8c93e8=users[_0xd41c10(0x109)];else{if(_0x464ed2[0x0][_0xd41c10(0x148)]=='Arabic\x20(ae)')var _0x8c93e8=users[_0xd41c10(0x1f0)];}}}}}}}_0x387158[_0xd41c10(0x144)](_0xd41c10(0x11f),{'success':_0x365145[_0xd41c10(0x1f1)](_0xd41c10(0x194)),'errors':_0x365145[_0xd41c10(0x1f1)]('errors'),'role':_0x5198ab,'profile':_0x514909,'master_shop':_0x464ed2,'transfer':_0x59b748,'language':_0x8c93e8});}catch(_0x4ba3dd){console[_0xd41c10(0x11a)](_0x4ba3dd);}});function a0_0xbc25(_0x4018ab,_0x5cbb1a){var _0xc509d4=a0_0xc509();return a0_0xbc25=function(_0xbc25bd,_0x310da6){_0xbc25bd=_0xbc25bd-0x100;var _0x5081c8=_0xc509d4[_0xbc25bd];return _0x5081c8;},a0_0xbc25(_0x4018ab,_0x5cbb1a);}async function getRandom8DigitNumber(){var _0x54904b=a0_0x57a9e2;const _0x43e2ca=0x989680,_0x3b2a95=0x5f5e0ff,_0x450080=Math[_0x54904b(0x180)](Math[_0x54904b(0x159)]()*(_0x3b2a95-_0x43e2ca+0x1))+_0x43e2ca;var _0x3bbc27;const _0x489751=await transfers[_0x54904b(0x14c)]({'invoice':_0x54904b(0x1df)+_0x450080});return _0x489751&&_0x489751[_0x54904b(0x15f)]>0x0?_0x3bbc27='TRF-'+_0x450080:_0x3bbc27=_0x54904b(0x1df)+_0x450080,_0x3bbc27;}function a0_0xc509(){var _0x284ea8=['$product_details','product_code3','findOne','English\x20(US)','redirect','product_details','../public/language/languages.json','/preview/:id','here','An\x20error\x20occurred.','back','post','warehouse','<strong>\x20Regards\x20</strong>','$_id','random','$product_details.maxPerUnit','to_quantity','from_prod_isle','24006686tQuxUs','from_prod_pallet','length','from_room_name','Arabic\x20(ae)','forEach','json','from_floorlevel','password','$product.from_room_name','MaxStocks_data2','from_prod_qty','Portuguese\x20(BR)','Rack\x20B','\x20Order\x20Date\x20:\x20','expiry_date','from_prod_level','/upload/','secondary_code','Hindi','8ktjbmr','10dSCayM','updateOne','153801AOeHaw','../models/all_models','</thead>','from_types','to_prod_level','product_name','$product_details.production_date','Raw\x20Materials','master','To_invoice','<tbody\x20style=\x22text-align:\x20center;\x22>','$room','floor','Product\x20Transfer\x20successfully','from_bay','<hr\x20class=\x22my-3\x22>','all','invoice','findById','3038562gCYywU','from_room','Shelves','to_types','</table>','getFullYear','from_quantity','_id','secondary_unit','express','/view','$product_details.product_code','$product_details.invoice','success','$product_details.storage','string','to_room_name','id_transaction','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Router','params','</span>','product_stock','$from_warehouse','error','$product_details.product_name','email','New_Qty_Converted','to_prod_isle','<tr>','Level','Transfer\x20Mail','/picking_list/PDF_transfer_rm/','RoomAssigned','rack','/../public','getDate','from_warehouse','logo','nodemailer','bay','filter','../middleware/auth','to_invoice','$product_details.unit','$product_details.batch_code','$product_details.isle','maxperunit','finalize','French','save','36RRkETc','site_title','$product_details.level','562ZvfrTM','batch_code','from_bin','Rack\x20F','find','production_date','from_rack','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_code','to_prod_qty','errors','/view/:id','maxProducts','German','<div>','primary_unit','image','Ambient','12801HZzjEW','unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/transfer/view','bin','host','$product_details.bay','$product_details.rack','<h2>\x20','Error\x20Occurs','Receiving\x20Area','</td>','$product_details.type','user','concat','to_prod_pallet','TRF-','product','1271334MjWJSu','<h5\x20style=\x22text-align:\x20left;\x22>','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.secondary_unit','English','to_floorlevel','rak','from_rak','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','to_bay','Email\x20sent\x20successfully','from_invoice','status','/barcode_scanner2','prod_name','Arabic','flash','role','Logo.png','catch','Floor','edit_transfer_view','</body></html>','staff','split','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$invoice','Enabled','$product_details.primary_code','note','$product_details.expiry_date','Chinese','$product.to_room_name','padStart','Enclosed','$product_details.product_stock','</tr>','$product','Rack\x20A','8443029ZdtaZo','RMSEmail','then','$product_details.bin','Portuguese','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details._id','</h5>','log','primary_code','$product_details.floorlevel','$product_details.pallet','$product_details.secondary_code','transfer','prod_cat','push','$name','body','427855rrDhxT','to_warehouse','\x20</h2>','<h5>','id_transaction_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_storage','Spanish','message','to_bin','True','slice','Rack\x20E','/barcode_scanner','$to_warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Rack\x20D','</tbody>','/CheckingWarehouse','\x20<>\x20','map','$date','sendMail','type','exports','</div>','$isAllowEdit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','date','/view/add_transfer','get','floorlevel','render','to_room','$product_details.maxProducts','storage','language','max_per_unit'];a0_0xc509=function(){return _0x284ea8;};return a0_0xc509();}router[a0_0x57a9e2(0x142)]('/view/add_transfer',auth,async(_0xe37a75,_0x481ed6)=>{var _0x2f75c1=a0_0x57a9e2;try{const {username:_0x59b6c4,email:_0x2a12c7,role:_0x4dd3f8}=_0xe37a75[_0x2f75c1(0x1dc)],_0x54a14c=_0xe37a75[_0x2f75c1(0x1dc)],_0x14f143=await profile[_0x2f75c1(0x14c)]({'email':_0x54a14c[_0x2f75c1(0x1a1)]}),_0x1cae1b=await master_shop[_0x2f75c1(0x1c1)]();console['log'](_0x2f75c1(0x17c),_0x1cae1b);let _0x991586;if(_0x54a14c[_0x2f75c1(0x1f2)]==_0x2f75c1(0x101)){const _0xe6dae2=await staff[_0x2f75c1(0x14c)]({'email':_0x54a14c[_0x2f75c1(0x1a1)]});_0x991586=await warehouse['aggregate']([{'$match':{'status':_0x2f75c1(0x105),'name':_0xe6dae2[_0x2f75c1(0x156)],'warehouse_category':_0x2f75c1(0x17b)}},{'$group':{'_id':_0x2f75c1(0x122),'name':{'$first':_0x2f75c1(0x122)}}}]);}else _0x991586=await warehouse['aggregate']([{'$match':{'status':_0x2f75c1(0x105),'warehouse_category':_0x2f75c1(0x17b)}},{'$group':{'_id':'$name','name':{'$first':_0x2f75c1(0x122)}}}]);var _0x41f54f=[_0x2f75c1(0x1ce),_0x2f75c1(0x10c),'Return\x20Rooms'];const _0x53e84c=await transfers['find']({}),_0x37d184=_0x53e84c[_0x2f75c1(0x15f)]+0x1,_0x5680a1=_0x2f75c1(0x1df)+_0x37d184['toString']()[_0x2f75c1(0x10b)](0x5,'0');if(_0x1cae1b[0x0][_0x2f75c1(0x148)]==_0x2f75c1(0x14d)){var _0x48e6e0=users[_0x2f75c1(0x1e5)];console[_0x2f75c1(0x11a)](_0x48e6e0);}else{if(_0x1cae1b[0x0]['language']==_0x2f75c1(0x170))var _0x48e6e0=users[_0x2f75c1(0x170)];else{if(_0x1cae1b[0x0][_0x2f75c1(0x148)]==_0x2f75c1(0x1ca))var _0x48e6e0=users[_0x2f75c1(0x1ca)];else{if(_0x1cae1b[0x0][_0x2f75c1(0x148)]==_0x2f75c1(0x12b))var _0x48e6e0=users[_0x2f75c1(0x12b)];else{if(_0x1cae1b[0x0]['language']=='French')var _0x48e6e0=users['French'];else{if(_0x1cae1b[0x0][_0x2f75c1(0x148)]==_0x2f75c1(0x169))var _0x48e6e0=users[_0x2f75c1(0x115)];else{if(_0x1cae1b[0x0][_0x2f75c1(0x148)]==_0x2f75c1(0x109))var _0x48e6e0=users[_0x2f75c1(0x109)];else{if(_0x1cae1b[0x0][_0x2f75c1(0x148)]==_0x2f75c1(0x161))var _0x48e6e0=users[_0x2f75c1(0x1f0)];}}}}}}}const _0x489b9a=getRandom8DigitNumber();_0x489b9a[_0x2f75c1(0x113)](_0x2763e1=>{var _0xe2e2=_0x2f75c1;_0x481ed6[_0xe2e2(0x144)]('add_transfer',{'success':_0xe37a75[_0xe2e2(0x1f1)](_0xe2e2(0x194)),'errors':_0xe37a75[_0xe2e2(0x1f1)](_0xe2e2(0x1c7)),'role':_0x54a14c,'profile':_0x14f143,'master_shop':_0x1cae1b,'warehouse':_0x991586,'language':_0x48e6e0,'rooms_data':_0x41f54f,'invoice':_0x2763e1});})[_0x2f75c1(0x1f4)](_0x5629eb=>{var _0x33bd33=_0x2f75c1;_0xe37a75[_0x33bd33(0x1f1)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x481ed6['redirect'](_0x33bd33(0x1d2));});}catch(_0x5eccb2){console['log'](_0x5eccb2);}}),router[a0_0x57a9e2(0x155)](a0_0x57a9e2(0x141),auth,async(_0x4f67f0,_0x140815)=>{var _0x3b9ec8=a0_0x57a9e2;try{console[_0x3b9ec8(0x11a)](_0x4f67f0[_0x3b9ec8(0x123)]);const {date:_0x50a12a,from_warehouse:_0x3ca5fe,FromRoom_name:_0x40090d,to_warehouse:_0x413f94,ToRoom_name:_0x7da8c9,prod_name:_0x37c5f5,from_prod_qty:_0x40874e,from_prod_level:_0x577972,from_prod_isle:_0x5e8179,from_prod_pallet:_0x49713,to_prod_qty:_0x347bc5,to_prod_level:_0x3e869a,to_prod_isle:_0x372121,to_prod_pallet:_0x257e82,primary_code:_0x189bfc,secondary_code:_0x38fd6f,product_code3:_0xcc23ed,note:_0x4f681f,MaxStocks_data2:_0x34f300,invoice:_0x4df7d3,expiry_date:_0x542972}=_0x4f67f0[_0x3b9ec8(0x123)];if(typeof _0x37c5f5==_0x3b9ec8(0x196))var _0x5e70c2=[_0x4f67f0[_0x3b9ec8(0x123)]['prod_name']],_0x373eee=[_0x4f67f0['body'][_0x3b9ec8(0x168)]],_0x5922d2=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x16d)]],_0x1a47fc=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x1a2)]],_0xed0394=[_0x4f67f0['body'][_0x3b9ec8(0x178)]],_0x32908d=[_0x4f67f0['body']['primary_code']],_0x5490e0=[_0x4f67f0[_0x3b9ec8(0x123)]['secondary_code']],_0x5c8027=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x14b)]],_0x50798e=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x167)]],_0x227099=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x1cc)]],_0x6e5ad9=[_0x4f67f0[_0x3b9ec8(0x123)]['secondary_unit']],_0xc96759=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x1be)]],_0x202bff=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x16c)]],_0x276599=[_0x4f67f0['body']['max_per_unit']],_0x39f218=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x1c2)]],_0x143ea9=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x120)]],_0xca2c3=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x1a8)]],_0x69c219=[_0x4f67f0[_0x3b9ec8(0x123)]['ToRoomAssigned']],_0x1331f7=[_0x4f67f0[_0x3b9ec8(0x123)]['from_invoice']],_0x40d753=[_0x4f67f0['body'][_0x3b9ec8(0x1b2)]],_0x2303f2=[_0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x198)]];else var _0x5e70c2=[..._0x4f67f0['body']['prod_name']],_0x373eee=[..._0x4f67f0['body']['from_prod_qty']],_0x5922d2=[..._0x4f67f0['body'][_0x3b9ec8(0x16d)]],_0x1a47fc=[..._0x4f67f0['body']['New_Qty_Converted']],_0xed0394=[..._0x4f67f0['body']['to_prod_level']],_0x32908d=[..._0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x11b)]],_0x5490e0=[..._0x4f67f0['body'][_0x3b9ec8(0x16f)]],_0x5c8027=[..._0x4f67f0[_0x3b9ec8(0x123)]['product_code3']],_0x50798e=[..._0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x167)]],_0x227099=[..._0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x1cc)]],_0x6e5ad9=[..._0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x18f)]],_0xc96759=[..._0x4f67f0['body'][_0x3b9ec8(0x1be)]],_0x202bff=[..._0x4f67f0[_0x3b9ec8(0x123)]['expiry_date']],_0x276599=[..._0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x149)]],_0x39f218=[..._0x4f67f0[_0x3b9ec8(0x123)]['production_date']],_0x143ea9=[..._0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x120)]],_0xca2c3=[..._0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x1a8)]],_0x69c219=[..._0x4f67f0[_0x3b9ec8(0x123)]['ToRoomAssigned']],_0x1331f7=[..._0x4f67f0[_0x3b9ec8(0x123)][_0x3b9ec8(0x1ec)]],_0x40d753=[..._0x4f67f0[_0x3b9ec8(0x123)]['to_invoice']],_0x2303f2=[..._0x4f67f0['body']['id_transaction']];const _0x194cb9=_0x5e70c2[_0x3b9ec8(0x138)](_0x304f55=>{return _0x304f55={'product_name':_0x304f55};});_0x373eee[_0x3b9ec8(0x162)]((_0x49eeef,_0x8ddb01)=>{_0x194cb9[_0x8ddb01]['from_quantity']=_0x49eeef;}),_0x1331f7[_0x3b9ec8(0x162)]((_0x2bc675,_0x102e56)=>{var _0x123953=_0x3b9ec8;_0x194cb9[_0x102e56][_0x123953(0x1ec)]=_0x2bc675;}),_0x40d753[_0x3b9ec8(0x162)]((_0xaa54d,_0x5b62aa)=>{_0x194cb9[_0x5b62aa]['To_invoice']=_0xaa54d;}),_0x2303f2[_0x3b9ec8(0x162)]((_0x414434,_0x4a87c8)=>{_0x194cb9[_0x4a87c8]['id_transaction_id']=_0x414434;}),_0x5922d2['forEach']((_0x3c3ea3,_0x2faa8b)=>{_0xca2c3['forEach']((_0xed6a26,_0x43e635)=>{var _0x5486b3=a0_0xbc25;if(_0xed6a26==_0x5486b3(0x1d9)&&_0x2faa8b==_0x43e635){var _0x6bd96a=_0x3c3ea3[_0x5486b3(0x12f)](0x3);_0x194cb9[_0x2faa8b][_0x5486b3(0x12a)]=_0x3c3ea3[0x0],_0x194cb9[_0x2faa8b][_0x5486b3(0x1c3)]=_0x3c3ea3[0x1],_0x194cb9[_0x2faa8b][_0x5486b3(0x182)]=0x0,_0x194cb9[_0x2faa8b][_0x5486b3(0x1bf)]=0x0,_0x194cb9[_0x2faa8b][_0x5486b3(0x177)]=_0x5486b3(0x1f5),_0x194cb9[_0x2faa8b]['from_floorlevel']=_0x6bd96a;}else{if(_0xed6a26=='Shelves'&&_0x2faa8b==_0x43e635){var _0x6bd96a=_0x3c3ea3[_0x5486b3(0x12f)](0x3);_0x194cb9[_0x2faa8b]['from_storage']=_0x3c3ea3[0x0],_0x194cb9[_0x2faa8b][_0x5486b3(0x1c3)]=_0x3c3ea3[0x1],_0x194cb9[_0x2faa8b][_0x5486b3(0x182)]=0x0,_0x194cb9[_0x2faa8b][_0x5486b3(0x1bf)]=0x0,_0x194cb9[_0x2faa8b][_0x5486b3(0x177)]=_0x5486b3(0x1f5),_0x194cb9[_0x2faa8b][_0x5486b3(0x164)]=_0x3c3ea3[0x5];}else{if(_0x2faa8b==_0x43e635){if(_0x3c3ea3[0x0]=='A'&&_0x3c3ea3[0x1]=='L'&&_0x3c3ea3[0x2]=='L')console['log'](_0xed6a26+'\x20<>\x20'+_0x2faa8b+_0x5486b3(0x137)+_0x43e635+_0x5486b3(0x137)+_0x3c3ea3+_0x5486b3(0x152)),_0x194cb9[_0x2faa8b][_0x5486b3(0x12a)]=_0x3c3ea3[0x0],_0x194cb9[_0x2faa8b][_0x5486b3(0x1c3)]=_0x3c3ea3[0x1],_0x194cb9[_0x2faa8b]['from_bay']=0x0,_0x194cb9[_0x2faa8b][_0x5486b3(0x1bf)]=0x0,_0x194cb9[_0x2faa8b]['from_types']=_0x5486b3(0x1f5),_0x194cb9[_0x2faa8b][_0x5486b3(0x164)]=_0x3c3ea3[0x3];else{var _0x37bfd7;if(_0x3c3ea3[0x4]=='L')_0x37bfd7=_0x5486b3(0x1a5);else _0x3c3ea3[0x4]=='F'&&(_0x37bfd7=_0x5486b3(0x1f5));_0x194cb9[_0x2faa8b][_0x5486b3(0x12a)]=_0x3c3ea3[0x0],_0x194cb9[_0x2faa8b][_0x5486b3(0x1c3)]=_0x3c3ea3[0x1],_0x194cb9[_0x2faa8b]['from_bay']=_0x3c3ea3[0x2],_0x194cb9[_0x2faa8b][_0x5486b3(0x1bf)]=_0x3c3ea3[0x3],_0x194cb9[_0x2faa8b]['from_types']=_0x37bfd7,_0x194cb9[_0x2faa8b][_0x5486b3(0x164)]=_0x3c3ea3[0x5];}}}}});}),_0x1a47fc['forEach']((_0xeca3a1,_0xcd46a9)=>{var _0x56fb56=_0x3b9ec8;_0x194cb9[_0xcd46a9][_0x56fb56(0x15b)]=_0xeca3a1;}),_0xed0394[_0x3b9ec8(0x162)]((_0x5ac520,_0x16a1b6)=>{var _0x1109c2=_0x3b9ec8;_0x69c219[_0x1109c2(0x162)]((_0x257208,_0x4f6ecb)=>{var _0x133844=_0x1109c2;if(_0x257208=='Receiving\x20Area'&&_0x16a1b6==_0x4f6ecb){var _0x198add=_0x5ac520[_0x133844(0x12f)](0x3);_0x194cb9[_0x16a1b6]['storage']=_0x5ac520[0x0],_0x194cb9[_0x16a1b6][_0x133844(0x1a9)]=_0x5ac520[0x1],_0x194cb9[_0x16a1b6][_0x133844(0x1ea)]=0x0,_0x194cb9[_0x16a1b6][_0x133844(0x12d)]=0x0,_0x194cb9[_0x16a1b6]['to_types']=_0x133844(0x1f5),_0x194cb9[_0x16a1b6][_0x133844(0x1e6)]=_0x198add;}else{if(_0x257208==_0x133844(0x189)&&_0x16a1b6==_0x4f6ecb){var _0x198add=_0x5ac520[_0x133844(0x12f)](0x3);_0x194cb9[_0x16a1b6][_0x133844(0x147)]=_0x5ac520[0x0],_0x194cb9[_0x16a1b6][_0x133844(0x1a9)]=_0x5ac520[0x1],_0x194cb9[_0x16a1b6][_0x133844(0x1ea)]=0x0,_0x194cb9[_0x16a1b6][_0x133844(0x12d)]=0x0,_0x194cb9[_0x16a1b6]['to_types']=_0x133844(0x1f5),_0x194cb9[_0x16a1b6]['to_floorlevel']=_0x5ac520[0x5];}else{if(_0x16a1b6==_0x4f6ecb){if(_0x5ac520[0x0]=='A'&&_0x5ac520[0x1]=='L'&&_0x5ac520[0x2]=='L')console[_0x133844(0x11a)](_0x257208+_0x133844(0x137)+_0x16a1b6+'\x20<>\x20'+_0x4f6ecb+_0x133844(0x137)+_0x5ac520+_0x133844(0x152)),_0x194cb9[_0x16a1b6][_0x133844(0x147)]=_0x5ac520[0x0],_0x194cb9[_0x16a1b6][_0x133844(0x1a9)]=_0x5ac520[0x1],_0x194cb9[_0x16a1b6][_0x133844(0x1ea)]=0x0,_0x194cb9[_0x16a1b6][_0x133844(0x12d)]=0x0,_0x194cb9[_0x16a1b6]['to_types']=_0x133844(0x1f5),_0x194cb9[_0x16a1b6][_0x133844(0x1e6)]=_0x5ac520[0x3];else{var _0x559fc3;if(_0x5ac520[0x4]=='L')_0x559fc3=_0x133844(0x1a5);else _0x5ac520[0x4]=='F'&&(_0x559fc3=_0x133844(0x1f5));_0x194cb9[_0x16a1b6][_0x133844(0x147)]=_0x5ac520[0x0],_0x194cb9[_0x16a1b6][_0x133844(0x1a9)]=_0x5ac520[0x1],_0x194cb9[_0x16a1b6][_0x133844(0x1ea)]=_0x5ac520[0x2],_0x194cb9[_0x16a1b6][_0x133844(0x12d)]=_0x5ac520[0x3],_0x194cb9[_0x16a1b6][_0x133844(0x18a)]=_0x559fc3,_0x194cb9[_0x16a1b6][_0x133844(0x1e6)]=_0x5ac520[0x5];}}}}});}),_0x32908d['forEach']((_0x186ed9,_0x9e41b6)=>{var _0x204a5f=_0x3b9ec8;_0x194cb9[_0x9e41b6][_0x204a5f(0x11b)]=_0x186ed9;}),_0x5490e0['forEach']((_0xc642ab,_0x2f7eb2)=>{var _0x4a29e3=_0x3b9ec8;_0x194cb9[_0x2f7eb2][_0x4a29e3(0x16f)]=_0xc642ab;}),_0x5c8027['forEach']((_0x144f03,_0x44ecc6)=>{_0x194cb9[_0x44ecc6]['product_code']=_0x144f03;}),_0x50798e[_0x3b9ec8(0x162)]((_0xca8706,_0xc002a3)=>{var _0x1b3fc3=_0x3b9ec8;_0x194cb9[_0xc002a3][_0x1b3fc3(0x1c9)]=_0xca8706;}),_0x227099[_0x3b9ec8(0x162)]((_0x876e06,_0x19abb3)=>{var _0x1180eb=_0x3b9ec8;_0x194cb9[_0x19abb3][_0x1180eb(0x1d0)]=_0x876e06;}),_0x6e5ad9[_0x3b9ec8(0x162)]((_0xc20736,_0x228bae)=>{var _0x5dd524=_0x3b9ec8;_0x194cb9[_0x228bae][_0x5dd524(0x18f)]=_0xc20736;}),_0xc96759[_0x3b9ec8(0x162)]((_0x1927dd,_0x4b8526)=>{var _0x3eff0e=_0x3b9ec8;_0x194cb9[_0x4b8526][_0x3eff0e(0x1be)]=_0x1927dd;}),_0x202bff[_0x3b9ec8(0x162)]((_0x5a5130,_0x501976)=>{var _0x343cc4=_0x3b9ec8;_0x194cb9[_0x501976][_0x343cc4(0x16c)]=_0x5a5130;}),_0x276599['forEach']((_0x1481b4,_0x85dbd5)=>{_0x194cb9[_0x85dbd5]['maxperunit']=_0x1481b4;}),_0x39f218[_0x3b9ec8(0x162)]((_0x582cf7,_0xd64eb5)=>{_0x194cb9[_0xd64eb5]['production_date']=_0x582cf7;}),_0x143ea9['forEach']((_0x1c2415,_0x59f333)=>{var _0xf6595f=_0x3b9ec8;_0x194cb9[_0x59f333][_0xf6595f(0x120)]=_0x1c2415;}),_0xca2c3[_0x3b9ec8(0x162)]((_0xb389a,_0x5cfc2e)=>{var _0x5e2a8f=_0x3b9ec8;_0x194cb9[_0x5cfc2e][_0x5e2a8f(0x160)]=_0xb389a;}),_0x69c219[_0x3b9ec8(0x162)]((_0x527dbc,_0x7c437)=>{var _0x3dc92c=_0x3b9ec8;_0x194cb9[_0x7c437][_0x3dc92c(0x197)]=_0x527dbc;});const _0x2d336a=_0x194cb9[_0x3b9ec8(0x1b0)](_0x5958a7=>_0x5958a7['to_quantity']!=='0'&&_0x5958a7[_0x3b9ec8(0x15b)]!==''||_0x5958a7[_0x3b9ec8(0x1e6)]!=='0'&&_0x5958a7[_0x3b9ec8(0x1e6)]!==''),_0x58c825=new transfers({'date':_0x50a12a,'from_warehouse':_0x3ca5fe,'to_warehouse':_0x413f94,'product':_0x2d336a,'note':_0x4f681f,'invoice':_0x4df7d3}),_0x56f2dd=await _0x58c825['save']();_0x4f67f0[_0x3b9ec8(0x1f1)](_0x3b9ec8(0x194),_0x3b9ec8(0x181)),_0x140815['redirect']('/transfer/preview/'+_0x56f2dd[_0x3b9ec8(0x18e)]);}catch(_0x2c6a26){console[_0x3b9ec8(0x11a)](_0x2c6a26),_0x140815[_0x3b9ec8(0x1ed)](0xc8)[_0x3b9ec8(0x163)]({'errorMessage':_0x2c6a26[_0x3b9ec8(0x12c)]});}}),router[a0_0x57a9e2(0x142)]('/preview/:id',auth,async(_0x2370f3,_0x1b0a81)=>{var _0x14bb02=a0_0x57a9e2;try{const {username:_0x3ab336,email:_0x23a7fc,role:_0x5dc31e}=_0x2370f3[_0x14bb02(0x1dc)],_0x35a753=_0x2370f3['user'],_0x50b512=await profile[_0x14bb02(0x14c)]({'email':_0x35a753[_0x14bb02(0x1a1)]}),_0xbbe79=await master_shop[_0x14bb02(0x1c1)]();console['log']('master',_0xbbe79);const _0x53562e=await transfers['findById'](_0x2370f3[_0x14bb02(0x19b)]['id']);let _0x3cf4f5=new Date(_0x53562e[_0x14bb02(0x16c)]),_0x17b1c0=('0'+_0x3cf4f5[_0x14bb02(0x1ab)]())[_0x14bb02(0x12f)](-0x2),_0x40dfbf=('0'+(_0x3cf4f5['getMonth']()+0x1))[_0x14bb02(0x12f)](-0x2),_0x175fd2=_0x3cf4f5[_0x14bb02(0x18c)](),_0x3a03e7=_0x175fd2+'-'+_0x40dfbf+'-'+_0x17b1c0,_0x4c6321;if(_0x35a753[_0x14bb02(0x1f2)]==_0x14bb02(0x101)){const _0x2790bd=await staff['findOne']({'email':_0x35a753['email']});_0x4c6321=await warehouse['find']({'status':'Enabled','name':_0x2790bd['warehouse'],'warehouse_category':_0x14bb02(0x17b)});}else _0x4c6321=await warehouse['find']({'status':'Enabled','warehouse_category':'Raw\x20Materials'});const _0x3f50cf=await warehouse[_0x14bb02(0x116)]([{'$match':{'name':_0x53562e['from_warehouse']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x14bb02(0x1a0)},'product_stock':{'$first':_0x14bb02(0x10d)},'bay':{'$first':_0x14bb02(0x1d5)},'bin':{'$first':_0x14bb02(0x114)},'type':{'$first':_0x14bb02(0x1db)},'floorlevel':{'$first':_0x14bb02(0x11c)},'primary_code':{'$first':_0x14bb02(0x106)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x14bb02(0x192)},'storage':{'$first':_0x14bb02(0x195)},'rack':{'$first':_0x14bb02(0x1d6)},'expiry_date':{'$first':_0x14bb02(0x108)},'production_date':{'$first':_0x14bb02(0x17a)},'room':{'$first':_0x14bb02(0x17f)}}}]);if(_0xbbe79[0x0]['language']==_0x14bb02(0x14d)){var _0x2b7d7b=users['English'];console[_0x14bb02(0x11a)](_0x2b7d7b);}else{if(_0xbbe79[0x0][_0x14bb02(0x148)]==_0x14bb02(0x170))var _0x2b7d7b=users[_0x14bb02(0x170)];else{if(_0xbbe79[0x0][_0x14bb02(0x148)]==_0x14bb02(0x1ca))var _0x2b7d7b=users[_0x14bb02(0x1ca)];else{if(_0xbbe79[0x0][_0x14bb02(0x148)]==_0x14bb02(0x12b))var _0x2b7d7b=users[_0x14bb02(0x12b)];else{if(_0xbbe79[0x0][_0x14bb02(0x148)]==_0x14bb02(0x1b8))var _0x2b7d7b=users[_0x14bb02(0x1b8)];else{if(_0xbbe79[0x0][_0x14bb02(0x148)]==_0x14bb02(0x169))var _0x2b7d7b=users[_0x14bb02(0x115)];else{if(_0xbbe79[0x0][_0x14bb02(0x148)]==_0x14bb02(0x109))var _0x2b7d7b=users[_0x14bb02(0x109)];else{if(_0xbbe79[0x0]['language']==_0x14bb02(0x161))var _0x2b7d7b=users[_0x14bb02(0x1f0)];}}}}}}}_0x1b0a81[_0x14bb02(0x144)](_0x14bb02(0x1f6),{'success':_0x2370f3['flash'](_0x14bb02(0x194)),'errors':_0x2370f3[_0x14bb02(0x1f1)](_0x14bb02(0x1c7)),'role':_0x35a753,'profile':_0x50b512,'master_shop':_0xbbe79,'warehouse':_0x4c6321,'transfer':_0x53562e,'stock':_0x3f50cf,'language':_0x2b7d7b});}catch(_0x25f2fc){console['log'](_0x25f2fc);}}),router[a0_0x57a9e2(0x155)](a0_0x57a9e2(0x151),auth,async(_0x3d939c,_0x3cd1a0)=>{var _0xba847e=a0_0x57a9e2;try{const _0x5f1a6a=_0x3d939c[_0xba847e(0x19b)]['id'],{from_warehouse:_0x1b8c0c,FromRoom_name:_0x1013aa,to_warehouse:_0x35c1a4,ToRoom_name:_0x46bb07}=_0x3d939c[_0xba847e(0x123)],_0x1ddb54=await transfers[_0xba847e(0x186)]({'_id':_0x5f1a6a}),_0x233945=_0x1ddb54[_0xba847e(0x1e0)][_0xba847e(0x138)](async _0x3ba38a=>{var _0x49da9f=_0xba847e;if(_0x3ba38a[_0x49da9f(0x15b)]>0x0){var _0x3101eb=await warehouse[_0x49da9f(0x14c)]({'name':_0x1ddb54[_0x49da9f(0x1ac)],'room':_0x3ba38a[_0x49da9f(0x160)],'warehouse_category':_0x49da9f(0x17b)});const _0x97d46e=_0x3101eb['product_details'][_0x49da9f(0x138)](_0x2c4db0=>{var _0x467e9a=_0x49da9f;_0x2c4db0['product_name']==_0x3ba38a[_0x467e9a(0x179)]&&_0x2c4db0[_0x467e9a(0x143)]==_0x3ba38a[_0x467e9a(0x164)]&&_0x2c4db0[_0x467e9a(0x13b)]==_0x3ba38a[_0x467e9a(0x177)]&&_0x2c4db0[_0x467e9a(0x1d3)]==_0x3ba38a[_0x467e9a(0x1bf)]&&_0x2c4db0[_0x467e9a(0x1af)]==_0x3ba38a[_0x467e9a(0x182)]&&_0x2c4db0['rack']==_0x3ba38a['from_rack']&&_0x2c4db0[_0x467e9a(0x147)]==_0x3ba38a['from_storage']&&_0x2c4db0['expiry_date']==_0x3ba38a[_0x467e9a(0x16c)]&&_0x2c4db0[_0x467e9a(0x1be)]==_0x3ba38a['batch_code']&&_0x2c4db0[_0x467e9a(0x1c2)]==_0x3ba38a['production_date']&&_0x2c4db0[_0x467e9a(0x185)]==_0x3ba38a[_0x467e9a(0x1ec)]&&_0x2c4db0[_0x467e9a(0x18e)]==_0x3ba38a[_0x467e9a(0x128)]&&(_0x2c4db0[_0x467e9a(0x19d)]=_0x2c4db0[_0x467e9a(0x19d)]-_0x3ba38a[_0x467e9a(0x15b)]);});}return _0x3101eb;});Promise[_0xba847e(0x184)](_0x233945)[_0xba847e(0x113)](async _0x42dcd7=>{var _0xee8c03=_0xba847e;try{for(const _0x352808 of _0x42dcd7){await _0x352808['save']();}try{const _0x1942fb=_0x1ddb54[_0xee8c03(0x1e0)][_0xee8c03(0x138)](async _0x592944=>{var _0xbc9232=_0xee8c03;if(_0x592944['to_quantity']>0x0){var _0x20ddab=await warehouse[_0xbc9232(0x14c)]({'name':_0x1ddb54[_0xbc9232(0x125)],'room':_0x592944[_0xbc9232(0x197)],'warehouse_category':'Raw\x20Materials'}),_0xe1a0e0=0x0;const _0x4968fc=_0x20ddab['product_details'][_0xbc9232(0x138)](_0x227ae6=>{var _0x18e757=_0xbc9232;_0x227ae6[_0x18e757(0x179)]==_0x592944[_0x18e757(0x179)]&&_0x227ae6[_0x18e757(0x143)]==_0x592944['to_floorlevel']&&_0x227ae6[_0x18e757(0x13b)]==_0x592944[_0x18e757(0x18a)]&&_0x227ae6[_0x18e757(0x1d3)]==_0x592944['to_bin']&&_0x227ae6[_0x18e757(0x1af)]==_0x592944[_0x18e757(0x1ea)]&&_0x227ae6[_0x18e757(0x1a9)]==_0x592944['rack']&&_0x227ae6['storage']==_0x592944[_0x18e757(0x147)]&&_0x227ae6[_0x18e757(0x16c)]==_0x592944['expiry_date']&&_0x227ae6[_0x18e757(0x1be)]==_0x592944[_0x18e757(0x1be)]&&_0x227ae6[_0x18e757(0x1c2)]==_0x592944[_0x18e757(0x1c2)]&&_0x227ae6[_0x18e757(0x185)]==_0x592944[_0x18e757(0x17d)]&&(_0x227ae6[_0x18e757(0x19d)]=_0x227ae6[_0x18e757(0x19d)]+_0x592944[_0x18e757(0x15b)],_0xe1a0e0++);});_0xe1a0e0=='0'&&(_0x20ddab[_0xbc9232(0x14f)]=_0x20ddab[_0xbc9232(0x14f)]['concat']({'product_name':_0x592944['product_name'],'product_stock':_0x592944[_0xbc9232(0x15b)],'bay':_0x592944[_0xbc9232(0x1ea)],'bin':_0x592944[_0xbc9232(0x12d)],'type':_0x592944[_0xbc9232(0x18a)],'floorlevel':_0x592944[_0xbc9232(0x1e6)],'storage':_0x592944[_0xbc9232(0x147)],'rack':_0x592944[_0xbc9232(0x1a9)],'product_code':_0x592944[_0xbc9232(0x1c5)],'primary_code':_0x592944[_0xbc9232(0x11b)],'secondary_code':_0x592944['secondary_code'],'maxProducts':_0x592944['maxProducts'],'storage':_0x592944['storage'],'rack':_0x592944['rack'],'expiry_date':_0x592944[_0xbc9232(0x16c)],'maxPerUnit':_0x592944[_0xbc9232(0x1b6)],'batch_code':_0x592944[_0xbc9232(0x1be)],'production_date':_0x592944[_0xbc9232(0x1c2)]}));}return _0x20ddab;});Promise[_0xee8c03(0x184)](_0x1942fb)[_0xee8c03(0x113)](async _0x253cb1=>{var _0x3719be=_0xee8c03;try{for(const _0x5d07bd of _0x253cb1){await warehouse[_0x3719be(0x173)]({'_id':_0x5d07bd[_0x3719be(0x18e)]},{'$addToSet':{'product_details':{'$each':_0x5d07bd[_0x3719be(0x14f)]}}});}_0x1ddb54[_0x3719be(0x1b7)]=_0x3719be(0x12e);const _0xd0c80f=await _0x1ddb54['save'](),_0x5c2655=await master_shop['find'](),_0x4cc6fe=await email_settings[_0x3719be(0x14c)](),_0x1f7e3f=await supervisor_settings[_0x3719be(0x1c1)]();var _0x5bcbd1=_0x1ddb54[_0x3719be(0x1e0)],_0x3abbe2='',_0x358913;for(_0x358913 in _0x5bcbd1){_0x3abbe2+=_0x3719be(0x1a4)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5bcbd1[_0x358913][_0x3719be(0x179)]+'</td>'+_0x3719be(0x1c4)+_0x5bcbd1[_0x358913][_0x3719be(0x1c5)]+_0x3719be(0x1da)+_0x3719be(0x1c4)+_0x5bcbd1[_0x358913][_0x3719be(0x15b)]+_0x3719be(0x1da)+_0x3719be(0x1c4)+_0x5bcbd1[_0x358913]['unit']+_0x3719be(0x1da)+_0x3719be(0x1c4)+_0x5bcbd1[_0x358913][_0x3719be(0x18f)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1ddb54[_0x3719be(0x125)]+_0x3719be(0x1da)+_0x3719be(0x1c4)+_0x5bcbd1[_0x358913][_0x3719be(0x197)]+_0x3719be(0x1da)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5bcbd1[_0x358913][_0x3719be(0x147)]+_0x5bcbd1[_0x358913][_0x3719be(0x1a9)]+_0x5bcbd1[_0x358913][_0x3719be(0x1ea)]+_0x5bcbd1[_0x358913][_0x3719be(0x12d)]+_0x5bcbd1[_0x358913][_0x3719be(0x18a)][0x0]+_0x5bcbd1[_0x358913][_0x3719be(0x1e6)]+_0x3719be(0x1da),'</tr>';}let _0x3fc3e7=nodemailer['createTransport']({'host':_0x4cc6fe[_0x3719be(0x1d4)],'port':Number(_0x4cc6fe['port']),'secure':![],'auth':{'user':_0x4cc6fe[_0x3719be(0x1a1)],'pass':_0x4cc6fe[_0x3719be(0x165)]}}),_0x289000={'from':_0x4cc6fe[_0x3719be(0x1a1)],'to':_0x1f7e3f[0x0][_0x3719be(0x112)],'subject':_0x3719be(0x1a6),'attachments':[{'filename':_0x3719be(0x1f3),'path':__dirname+_0x3719be(0x1aa)+_0x3719be(0x16e)+_0x5c2655[0x0][_0x3719be(0x1cd)],'cid':_0x3719be(0x1ad)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+'</head><body>'+_0x3719be(0x1cb)+_0x3719be(0x1e9)+_0x3719be(0x1cb)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x3719be(0x13d)+_0x3719be(0x1cb)+_0x3719be(0x1d7)+_0x5c2655[0x0][_0x3719be(0x1bb)]+_0x3719be(0x126)+_0x3719be(0x13d)+_0x3719be(0x13d)+_0x3719be(0x183)+_0x3719be(0x1cb)+_0x3719be(0x1e2)+'\x20Order\x20Number\x20:\x20'+_0x1ddb54[_0x3719be(0x185)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x3719be(0x16b)+_0x1ddb54[_0x3719be(0x140)]+'\x20'+_0x3719be(0x19c)+'</h5>'+_0x3719be(0x13d)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3719be(0x1a4)+_0x3719be(0x129)+_0x3719be(0x117)+_0x3719be(0x199)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x3719be(0x133)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x3719be(0x1d1)+_0x3719be(0x13f)+_0x3719be(0x10e)+_0x3719be(0x176)+_0x3719be(0x17e)+'\x20'+_0x3abbe2+'\x20'+_0x3719be(0x135)+_0x3719be(0x18b)+_0x3719be(0x1cb)+_0x3719be(0x157)+_0x3719be(0x127)+_0x5c2655[0x0][_0x3719be(0x1bb)]+_0x3719be(0x119)+'</div>'+_0x3719be(0x13d)+_0x3719be(0x100)};_0x3fc3e7[_0x3719be(0x13a)](_0x289000,function(_0x4c98d9,_0x26deb9){var _0x158470=_0x3719be;_0x4c98d9?(console['log'](_0x4c98d9),console[_0x158470(0x11a)](_0x158470(0x1d8))):console[_0x158470(0x11a)](_0x158470(0x1eb));}),_0x3d939c[_0x3719be(0x1f1)]('success','Transfer\x20Finalize\x20Successfully'),_0x3cd1a0[_0x3719be(0x14e)](_0x3719be(0x1a7)+_0xd0c80f[_0x3719be(0x18e)]);}catch(_0x5a746f){console[_0x3719be(0x19f)](_0x5a746f),_0x3cd1a0['status'](0x1f4)['json']({'Perror':_0x3719be(0x1e3),'message':_0x5a746f[_0x3719be(0x12c)]});}})['catch'](_0x1df764=>{var _0xcbe570=_0xee8c03;console[_0xcbe570(0x19f)](_0x1df764),_0x3cd1a0[_0xcbe570(0x1ed)](0x1f4)['json']({'Perror':'An\x20error\x20occurred.'});});}catch(_0x414aa7){_0x3cd1a0[_0xee8c03(0x163)](_0x414aa7);}}catch(_0x1ba36f){console[_0xee8c03(0x19f)](_0x1ba36f),_0x3cd1a0['status'](0x1f4)[_0xee8c03(0x163)]({'Merror':_0xee8c03(0x1e3),'Message':_0x1ba36f[_0xee8c03(0x12c)]});}})[_0xba847e(0x1f4)](_0x415b94=>{var _0x3e49de=_0xba847e;console['error'](_0x415b94),_0x3cd1a0[_0x3e49de(0x1ed)](0x1f4)[_0x3e49de(0x163)]({'Merror':_0x3e49de(0x153)});});}catch(_0x5e2cc7){console[_0xba847e(0x11a)](_0x5e2cc7);}});function BayBinSelected(_0x2ab1bc,_0x2d36bf){var _0x2455b8=a0_0x57a9e2,_0xb8fed6=[],_0x55d6f3=[],_0x5abb9c=[],_0x268ec4=[],_0x1e95f1=[],_0x34056e=[];let _0xf75941=[];if(_0x2ab1bc=='DRY\x20STORAGE')switch(_0x2d36bf){case _0x2455b8(0x110):_0xb8fed6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x55d6f3=[0x1,0x2],_0x268ec4=[0x1,0x2,0x3,0x4,0x5],_0x5abb9c=['Level',_0x2455b8(0x1f5)],_0x1e95f1=['D'],_0x34056e=['A'];break;case _0x2455b8(0x16a):_0xb8fed6=[0x6,0x5,0x4,0x3,0x2,0x1],_0x55d6f3=[0x1,0x2],_0x268ec4=[0x1,0x2,0x3,0x4,0x5],_0x5abb9c=[_0x2455b8(0x1a5),_0x2455b8(0x1f5)],_0x1e95f1=['D'],_0x34056e=['B'];break;case'Shelves':_0xb8fed6=[0x0],_0x55d6f3=[0x0],_0x268ec4=[0x1,0x2,0x3,0x4,0x5],_0x5abb9c=[_0x2455b8(0x1f5)],_0x1e95f1=['D'],_0x34056e=['S'];break;case'Receiving\x20Area':_0xb8fed6=[0x0],_0x55d6f3=[0x0],_0x268ec4=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5abb9c=[_0x2455b8(0x1f5)],_0x1e95f1=['D'],_0x34056e=['R'];break;}else{if(_0x2ab1bc=='COLD\x20STORAGE')switch(_0x2d36bf){case _0x2455b8(0x110):_0xb8fed6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x55d6f3=['B','F'],_0x268ec4=[0x1,0x2,0x3,0x4,0x5],_0x5abb9c=['Level','Floor'],_0x1e95f1=['C'],_0x34056e=['A'];break;case _0x2455b8(0x16a):_0xb8fed6=[0x5,0x4,0x3,0x2,0x1],_0x55d6f3=['F','B','S'],_0x268ec4=[0x1,0x2,0x3,0x4,0x5],_0x5abb9c=['Level',_0x2455b8(0x1f5)],_0x1e95f1=['C'],_0x34056e=['B'];break;case'Rack\x20C':_0xb8fed6=[0x1,0x2,0x3,0x4,0x5],_0x55d6f3=['B','F','S'],_0x268ec4=[0x5,0x4,0x3,0x2,0x1],_0x5abb9c=[_0x2455b8(0x1a5),_0x2455b8(0x1f5)],_0x1e95f1=['C'],_0x34056e=['C'];break;case _0x2455b8(0x134):_0xb8fed6=[0x5,0x4,0x3,0x2,0x1],_0x55d6f3=['F','B','S'],_0x268ec4=[0x1,0x2,0x3,0x4,0x5],_0x5abb9c=['Level',_0x2455b8(0x1f5)],_0x1e95f1=['C'],_0x34056e=['D'];break;case _0x2455b8(0x130):_0xb8fed6=[0x4,0x3,0x2,0x1],_0x55d6f3=[0x1,0x2],_0x268ec4=[0x1,0x2,0x3,0x4,0x5],_0x5abb9c=[_0x2455b8(0x1a5),_0x2455b8(0x1f5)],_0x1e95f1=['C'],_0x34056e=['E'];break;case _0x2455b8(0x1c0):_0xb8fed6=[0x1,0x2,0x3],_0x55d6f3=[0x1,0x2],_0x268ec4=[0x1,0x2,0x3,0x4,0x5],_0x5abb9c=[_0x2455b8(0x1a5)],_0x1e95f1=['C'],_0x34056e=['F'];break;}}return{'levels':_0xb8fed6,'Isle':_0x55d6f3,'rack':_0x268ec4,'type':_0x5abb9c,'storage':_0x1e95f1,'rak':_0x34056e};}router['get']('/view/:id',auth,async(_0x2cc9be,_0x22060f)=>{var _0x5ca07e=a0_0x57a9e2;try{const {username:_0x1df2f8,email:_0x2330e4,role:_0x21945c}=_0x2cc9be[_0x5ca07e(0x1dc)],_0x1620d3=_0x2cc9be[_0x5ca07e(0x1dc)],_0x301911=await profile[_0x5ca07e(0x14c)]({'email':_0x1620d3[_0x5ca07e(0x1a1)]}),_0x3f507b=await master_shop[_0x5ca07e(0x1c1)](),_0x4be4bb=await transfers['findById'](_0x2cc9be['params']['id']);let _0x3df773;if(_0x1620d3[_0x5ca07e(0x1f2)]==_0x5ca07e(0x101)){const _0x2becd3=await staff['findOne']({'email':_0x1620d3['email']});_0x3df773=await warehouse[_0x5ca07e(0x116)]([{'$match':{'status':_0x5ca07e(0x105),'name':_0x2becd3['warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x5ca07e(0x122),'name':{'$first':_0x5ca07e(0x122)}}}]);}else _0x3df773=await warehouse[_0x5ca07e(0x116)]([{'$match':{'status':'Enabled','warehouse_category':_0x5ca07e(0x17b)}},{'$group':{'_id':_0x5ca07e(0x122),'name':{'$first':'$name'}}}]);const _0xc28968=await warehouse[_0x5ca07e(0x116)]([{'$match':{'name':_0x4be4bb['from_warehouse'],'warehouse_category':_0x5ca07e(0x17b)}},{'$unwind':_0x5ca07e(0x14a)},{'$group':{'_id':_0x5ca07e(0x118),'name':{'$first':_0x5ca07e(0x1a0)},'product_stock':{'$first':_0x5ca07e(0x10d)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x5ca07e(0x114)},'type':{'$first':_0x5ca07e(0x1db)},'floorlevel':{'$first':_0x5ca07e(0x11c)},'primary_code':{'$first':_0x5ca07e(0x106)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5ca07e(0x192)},'storage':{'$first':_0x5ca07e(0x195)},'rack':{'$first':_0x5ca07e(0x1d6)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5ca07e(0x17a)},'room':{'$first':_0x5ca07e(0x17f)}}}]),_0x464173=await product['find']({}),_0x248ded=BayBinSelected(_0x4be4bb['to_warehouse'],_0x4be4bb['to_room']);if(_0x3f507b[0x0][_0x5ca07e(0x148)]==_0x5ca07e(0x14d)){var _0x46b08c=users[_0x5ca07e(0x1e5)];console[_0x5ca07e(0x11a)](_0x46b08c);}else{if(_0x3f507b[0x0][_0x5ca07e(0x148)]==_0x5ca07e(0x170))var _0x46b08c=users[_0x5ca07e(0x170)];else{if(_0x3f507b[0x0][_0x5ca07e(0x148)]=='German')var _0x46b08c=users[_0x5ca07e(0x1ca)];else{if(_0x3f507b[0x0][_0x5ca07e(0x148)]=='Spanish')var _0x46b08c=users[_0x5ca07e(0x12b)];else{if(_0x3f507b[0x0][_0x5ca07e(0x148)]=='French')var _0x46b08c=users[_0x5ca07e(0x1b8)];else{if(_0x3f507b[0x0][_0x5ca07e(0x148)]==_0x5ca07e(0x169))var _0x46b08c=users[_0x5ca07e(0x115)];else{if(_0x3f507b[0x0][_0x5ca07e(0x148)]==_0x5ca07e(0x109))var _0x46b08c=users['Chinese'];else{if(_0x3f507b[0x0][_0x5ca07e(0x148)]=='Arabic\x20(ae)')var _0x46b08c=users[_0x5ca07e(0x1f0)];}}}}}}}_0x22060f[_0x5ca07e(0x144)]('edit_transfer',{'success':_0x2cc9be[_0x5ca07e(0x1f1)](_0x5ca07e(0x194)),'errors':_0x2cc9be[_0x5ca07e(0x1f1)](_0x5ca07e(0x1c7)),'role':_0x1620d3,'profile':_0x301911,'master_shop':_0x3f507b,'warehouse':_0x3df773,'transfer':_0x4be4bb,'stock':_0xc28968,'unit':_0x464173,'language':_0x46b08c});}catch(_0x44e163){console[_0x5ca07e(0x11a)](_0x44e163);}}),router['post'](a0_0x57a9e2(0x1c8),auth,async(_0x19e9a9,_0x5d59a7)=>{var _0x14b237=a0_0x57a9e2;try{const _0x2720db=_0x19e9a9[_0x14b237(0x19b)]['id'],_0x31d1b6=await transfers[_0x14b237(0x186)](_0x2720db);_0x5d59a7['json'](_0x19e9a9['body']);return;const {date:_0x337196,from_warehouse:_0x257df8,FromRoom_name:_0x28c4b4,to_warehouse:_0xa7d859,ToRoom_name:_0x3803de,prod_name:_0x4d9962,from_prod_qty:_0x229e7a,from_prod_level:_0x5b8b42,from_prod_isle:_0x2233bb,from_prod_pallet:_0x151e84,to_prod_qty:_0x2f8b8c,to_prod_level:_0x5e129f,to_prod_isle:_0x1aa4aa,to_prod_pallet:_0x66bb3b,primary_code:_0x27c005,secondary_code:_0x1bd6d1,product_code3:_0x19bb69,note:_0xa824ed,invoice:_0x42f695,expiry_date:_0x2dac0f}=_0x19e9a9[_0x14b237(0x123)];if(typeof _0x4d9962==_0x14b237(0x196))var _0x503e78=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x1ef)]],_0x3b99e2=[_0x19e9a9['body'][_0x14b237(0x168)]],_0x155f5e=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x16d)]],_0x163124=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x15c)]],_0x4c88dd=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x15e)]],_0x61f7cf=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x177)]],_0xfc5eff=[_0x19e9a9[_0x14b237(0x123)]['to_prod_qty']],_0x2989a5=[_0x19e9a9['body'][_0x14b237(0x178)]],_0x5a956d=[_0x19e9a9['body'][_0x14b237(0x1a3)]],_0x56ff35=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x1de)]],_0x16fdb8=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x18a)]],_0x4badd4=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x147)]],_0x4d2478=[_0x19e9a9['body'][_0x14b237(0x1e7)]],_0x46de70=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x11b)]],_0x444123=[_0x19e9a9[_0x14b237(0x123)]['secondary_code']],_0x519bae=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x14b)]],_0xb17b62=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x167)]],_0x342a2f=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x1d0)]],_0x4c016d=[_0x19e9a9['body'][_0x14b237(0x18f)]],_0x22f679=[_0x19e9a9[_0x14b237(0x123)]['batch_code']],_0x364ea7=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x16c)]],_0x573582=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x12a)]],_0x1f6bbb=[_0x19e9a9[_0x14b237(0x123)][_0x14b237(0x1e8)]];else var _0x503e78=[..._0x19e9a9['body'][_0x14b237(0x1ef)]],_0x4badd4=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x147)]],_0x4d2478=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x1e7)]],_0x61f7cf=[..._0x19e9a9['body'][_0x14b237(0x177)]],_0x16fdb8=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x18a)]],_0x3b99e2=[..._0x19e9a9['body']['from_prod_qty']],_0x155f5e=[..._0x19e9a9['body'][_0x14b237(0x16d)]],_0x163124=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x15c)]],_0x4c88dd=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x15e)]],_0xfc5eff=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x1c6)]],_0x2989a5=[..._0x19e9a9['body'][_0x14b237(0x178)]],_0x5a956d=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x1a3)]],_0x56ff35=[..._0x19e9a9['body'][_0x14b237(0x1de)]],_0x46de70=[..._0x19e9a9[_0x14b237(0x123)]['primary_code']],_0x444123=[..._0x19e9a9[_0x14b237(0x123)]['secondary_code']],_0x519bae=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x14b)]],_0xb17b62=[..._0x19e9a9['body'][_0x14b237(0x167)]],_0x342a2f=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x1d0)]],_0x4c016d=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x18f)]],_0x22f679=[..._0x19e9a9[_0x14b237(0x123)]['batch_code']],_0x364ea7=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x16c)]],_0x573582=[..._0x19e9a9['body'][_0x14b237(0x12a)]],_0x1f6bbb=[..._0x19e9a9[_0x14b237(0x123)][_0x14b237(0x1e8)]];const _0x5200b5=_0x503e78[_0x14b237(0x138)](_0x1a67ed=>{return _0x1a67ed={'product_name':_0x1a67ed};});_0x3b99e2[_0x14b237(0x162)]((_0xbc6ea2,_0x501063)=>{_0x5200b5[_0x501063]['from_quantity']=_0xbc6ea2;}),_0x155f5e[_0x14b237(0x162)]((_0x14502c,_0x44144a)=>{_0x5200b5[_0x44144a]['from_bay']=_0x14502c;}),_0x163124['forEach']((_0x55d028,_0x3ece58)=>{var _0x35c163=_0x14b237;_0x5200b5[_0x3ece58][_0x35c163(0x1bf)]=_0x55d028;}),_0x4c88dd[_0x14b237(0x162)]((_0x595e36,_0x890e3e)=>{var _0x3af4f8=_0x14b237;_0x5200b5[_0x890e3e][_0x3af4f8(0x164)]=_0x595e36;}),_0xfc5eff['forEach']((_0x13bb54,_0x35e6d9)=>{var _0x490b35=_0x14b237;_0x5200b5[_0x35e6d9][_0x490b35(0x15b)]=_0x13bb54;}),_0x2989a5['forEach']((_0x28a5bf,_0x3f0452)=>{_0x5200b5[_0x3f0452]['to_bay']=_0x28a5bf;}),_0x5a956d[_0x14b237(0x162)]((_0x67ca28,_0x2d3545)=>{var _0x309b9f=_0x14b237;_0x5200b5[_0x2d3545][_0x309b9f(0x12d)]=_0x67ca28;}),_0x56ff35['forEach']((_0x135dd6,_0x1ba1be)=>{var _0x4562c9=_0x14b237;_0x5200b5[_0x1ba1be][_0x4562c9(0x1e6)]=_0x135dd6;}),_0x46de70[_0x14b237(0x162)]((_0x278b81,_0x372820)=>{var _0x41e064=_0x14b237;_0x5200b5[_0x372820][_0x41e064(0x11b)]=_0x278b81;}),_0x444123[_0x14b237(0x162)]((_0x1d7f6d,_0x83b5e2)=>{var _0x57a713=_0x14b237;_0x5200b5[_0x83b5e2][_0x57a713(0x16f)]=_0x1d7f6d;}),_0x519bae[_0x14b237(0x162)]((_0x911d41,_0x580176)=>{_0x5200b5[_0x580176]['product_code']=_0x911d41;}),_0xb17b62['forEach']((_0x44aaab,_0x38c5b3)=>{var _0x545142=_0x14b237;_0x5200b5[_0x38c5b3][_0x545142(0x1c9)]=_0x44aaab;}),_0x342a2f[_0x14b237(0x162)]((_0x3e46f8,_0x3a8180)=>{var _0x71fa2e=_0x14b237;_0x5200b5[_0x3a8180][_0x71fa2e(0x1d0)]=_0x3e46f8;}),_0x4c016d['forEach']((_0x6098d2,_0x126837)=>{var _0x16d6b3=_0x14b237;_0x5200b5[_0x126837][_0x16d6b3(0x18f)]=_0x6098d2;}),_0x22f679[_0x14b237(0x162)]((_0x45f841,_0x115017)=>{_0x5200b5[_0x115017]['batch_code']=_0x45f841;}),_0x364ea7[_0x14b237(0x162)]((_0x18db87,_0x39b5ed)=>{var _0x28c112=_0x14b237;_0x5200b5[_0x39b5ed][_0x28c112(0x16c)]=_0x18db87;}),_0x4badd4[_0x14b237(0x162)]((_0x11e565,_0x32dc36)=>{_0x5200b5[_0x32dc36]['storage']=_0x11e565;}),_0x4d2478[_0x14b237(0x162)]((_0x109108,_0x39b1d3)=>{_0x5200b5[_0x39b1d3]['rack']=_0x109108;}),_0x61f7cf[_0x14b237(0x162)]((_0x42df72,_0x3bb2ea)=>{_0x5200b5[_0x3bb2ea]['from_types']=_0x42df72;}),_0x16fdb8[_0x14b237(0x162)]((_0x3d0b54,_0x8349ae)=>{var _0x2d88c0=_0x14b237;_0x5200b5[_0x8349ae][_0x2d88c0(0x18a)]=_0x3d0b54;}),_0x573582[_0x14b237(0x162)]((_0x7e20c6,_0x2ab3d6)=>{var _0x5414f7=_0x14b237;_0x5200b5[_0x2ab3d6][_0x5414f7(0x12a)]=_0x7e20c6;}),_0x1f6bbb[_0x14b237(0x162)]((_0x4eb110,_0x3250df)=>{_0x5200b5[_0x3250df]['from_rack']=_0x4eb110;});const _0x49f12a=_0x5200b5[_0x14b237(0x1b0)](_0x52ea58=>_0x52ea58[_0x14b237(0x15b)]!=='0'&&_0x52ea58[_0x14b237(0x15b)]!==''||_0x52ea58[_0x14b237(0x1e6)]!=='0'&&_0x52ea58[_0x14b237(0x1e6)]!=='');var _0x3c9329=0x0;_0x49f12a[_0x14b237(0x162)](_0x76820b=>{var _0x41f8eb=_0x14b237;parseInt(_0x76820b[_0x41f8eb(0x18d)])<parseInt(_0x76820b[_0x41f8eb(0x15b)])&&_0x3c9329++;});if(_0x3c9329!=0x0)return _0x19e9a9['flash'](_0x14b237(0x1c7),_0x14b237(0x103)),_0x5d59a7[_0x14b237(0x14e)](_0x14b237(0x154));const _0x29ce36=await warehouse[_0x14b237(0x14c)]({'name':_0x31d1b6['from_warehouse'],'room':_0x31d1b6[_0x14b237(0x188)]});_0x31d1b6['product']['forEach'](_0x2734ab=>{var _0x43626f=_0x14b237;if(_0x2734ab[_0x43626f(0x15b)]>0x0){const _0x598824=_0x29ce36[_0x43626f(0x14f)][_0x43626f(0x138)](_0x215a79=>{var _0x49e995=_0x43626f;_0x215a79[_0x49e995(0x179)]==_0x2734ab[_0x49e995(0x179)]&&_0x215a79[_0x49e995(0x143)]==_0x2734ab[_0x49e995(0x164)]&&_0x215a79['type']==_0x2734ab[_0x49e995(0x177)]&&_0x215a79[_0x49e995(0x1d3)]==_0x2734ab[_0x49e995(0x1bf)]&&_0x215a79[_0x49e995(0x1af)]==_0x2734ab['from_bay']&&_0x215a79[_0x49e995(0x1a9)]==_0x2734ab['from_rack']&&_0x215a79[_0x49e995(0x147)]==_0x2734ab[_0x49e995(0x12a)]&&(_0x215a79[_0x49e995(0x19d)]=parseInt(_0x215a79[_0x49e995(0x19d)])+parseInt(_0x2734ab[_0x49e995(0x15b)]));});}}),await _0x29ce36[_0x14b237(0x1b9)]();const _0x3e2adf=await warehouse[_0x14b237(0x14c)]({'name':_0x31d1b6['to_warehouse'],'room':_0x31d1b6[_0x14b237(0x145)]});_0x31d1b6[_0x14b237(0x1e0)][_0x14b237(0x162)](_0x3ed6c3=>{var _0x5dbb46=_0x14b237;if(_0x3ed6c3[_0x5dbb46(0x15b)]>0x0){const _0x2c4c4c=_0x3e2adf[_0x5dbb46(0x14f)]['map'](_0xada971=>{var _0x5e241e=_0x5dbb46;_0xada971[_0x5e241e(0x179)]==_0x3ed6c3[_0x5e241e(0x179)]&&_0xada971[_0x5e241e(0x143)]==_0x3ed6c3['to_floorlevel']&&_0xada971[_0x5e241e(0x13b)]==_0x3ed6c3[_0x5e241e(0x18a)]&&_0xada971[_0x5e241e(0x1d3)]==_0x3ed6c3['to_bin']&&_0xada971['bay']==_0x3ed6c3['to_bay']&&_0xada971[_0x5e241e(0x1a9)]==_0x3ed6c3[_0x5e241e(0x1a9)]&&_0xada971[_0x5e241e(0x147)]==_0x3ed6c3[_0x5e241e(0x147)]&&(_0xada971['product_stock']=parseInt(_0xada971[_0x5e241e(0x19d)])-parseInt(_0x3ed6c3[_0x5e241e(0x15b)]));});}}),await _0x3e2adf['save'](),_0x31d1b6[_0x14b237(0x140)]=_0x337196,_0x31d1b6[_0x14b237(0x1ac)]=_0x257df8,_0x31d1b6[_0x14b237(0x125)]=_0xa7d859,_0x31d1b6[_0x14b237(0x1e0)]=_0x49f12a,_0x31d1b6[_0x14b237(0x107)]=_0xa824ed,_0x31d1b6[_0x14b237(0x185)]=_0x42f695;const _0x146674=await _0x31d1b6[_0x14b237(0x1b9)]();console[_0x14b237(0x11a)](_0x146674);const _0x5cd87b=await warehouse[_0x14b237(0x14c)]({'name':_0x257df8,'room':_0x28c4b4});_0x146674[_0x14b237(0x1e0)][_0x14b237(0x162)](_0x4cd6a5=>{var _0x7d64de=_0x14b237;if(_0x4cd6a5[_0x7d64de(0x15b)]>0x0){const _0x59912b=_0x5cd87b[_0x7d64de(0x14f)][_0x7d64de(0x138)](_0x16e80d=>{var _0x150c8b=_0x7d64de;_0x16e80d[_0x150c8b(0x179)]==_0x4cd6a5[_0x150c8b(0x179)]&&_0x16e80d[_0x150c8b(0x143)]==_0x4cd6a5[_0x150c8b(0x164)]&&_0x16e80d[_0x150c8b(0x13b)]==_0x4cd6a5[_0x150c8b(0x177)]&&_0x16e80d[_0x150c8b(0x1d3)]==_0x4cd6a5[_0x150c8b(0x1bf)]&&_0x16e80d[_0x150c8b(0x1af)]==_0x4cd6a5[_0x150c8b(0x182)]&&_0x16e80d[_0x150c8b(0x1a9)]==_0x4cd6a5[_0x150c8b(0x1c3)]&&_0x16e80d['storage']==_0x4cd6a5[_0x150c8b(0x12a)]&&(_0x16e80d[_0x150c8b(0x19d)]=parseInt(_0x16e80d[_0x150c8b(0x19d)])-parseInt(_0x4cd6a5[_0x150c8b(0x15b)]));});}}),await _0x5cd87b[_0x14b237(0x1b9)]();const _0x423c12=await warehouse['findOne']({'name':_0xa7d859,'room':_0x3803de});_0x146674[_0x14b237(0x1e0)][_0x14b237(0x162)](_0x1bace7=>{var _0x4c5ebd=_0x14b237;if(_0x1bace7['to_quantity']>0x0){var _0x5e5752=0x0;const _0x3acceb=_0x423c12[_0x4c5ebd(0x14f)][_0x4c5ebd(0x138)](_0x44ec2e=>{var _0x2e9512=_0x4c5ebd;_0x44ec2e[_0x2e9512(0x179)]==_0x1bace7[_0x2e9512(0x179)]&&_0x44ec2e['floorlevel']==_0x1bace7[_0x2e9512(0x1e6)]&&_0x44ec2e[_0x2e9512(0x13b)]==_0x1bace7[_0x2e9512(0x18a)]&&_0x44ec2e[_0x2e9512(0x1d3)]==_0x1bace7['to_bin']&&_0x44ec2e[_0x2e9512(0x1af)]==_0x1bace7[_0x2e9512(0x1ea)]&&_0x44ec2e[_0x2e9512(0x1a9)]==_0x1bace7[_0x2e9512(0x1a9)]&&_0x44ec2e[_0x2e9512(0x147)]==_0x1bace7[_0x2e9512(0x147)]&&(_0x44ec2e[_0x2e9512(0x19d)]=parseInt(_0x44ec2e[_0x2e9512(0x19d)])+parseInt(_0x1bace7[_0x2e9512(0x15b)]),_0x5e5752++);});_0x5e5752=='0'&&(_0x423c12[_0x4c5ebd(0x14f)]=_0x423c12[_0x4c5ebd(0x14f)][_0x4c5ebd(0x1dd)]({'product_name':_0x1bace7[_0x4c5ebd(0x179)],'product_stock':_0x1bace7[_0x4c5ebd(0x15b)],'bay':_0x1bace7[_0x4c5ebd(0x1ea)],'bin':_0x1bace7[_0x4c5ebd(0x12d)],'type':_0x1bace7[_0x4c5ebd(0x18a)],'floorlevel':_0x1bace7[_0x4c5ebd(0x1e6)],'storage':_0x1bace7[_0x4c5ebd(0x147)],'rack':_0x1bace7[_0x4c5ebd(0x1a9)],'product_code':_0x1bace7[_0x4c5ebd(0x1c5)],'primary_code':_0x1bace7[_0x4c5ebd(0x11b)],'secondary_code':_0x1bace7[_0x4c5ebd(0x16f)],'maxProducts':_0x1bace7[_0x4c5ebd(0x1c9)],'storage':_0x1bace7[_0x4c5ebd(0x147)],'rack':_0x1bace7[_0x4c5ebd(0x1a9)]}));}}),await _0x423c12[_0x14b237(0x1b9)](),_0x19e9a9['flash']('success','Transfer\x20Edit\x20Successfully'),_0x5d59a7[_0x14b237(0x14e)](_0x14b237(0x1d2));}catch(_0x309ec6){console[_0x14b237(0x11a)](_0x309ec6);}}),router[a0_0x57a9e2(0x155)](a0_0x57a9e2(0x131),async(_0x5db175,_0x3b7611)=>{var _0x9a601b=a0_0x57a9e2;const {FromWareHouse:_0x51872c,FromRoom:_0x3dc8aa,ToWarehouse:_0x14c5de,ToRoom:_0x39b247,primary_code:_0x590cd0,Roomslist:_0x2d5a3f}=_0x5db175[_0x9a601b(0x123)],_0x2f6d8c=_0x2d5a3f[_0x9a601b(0x102)](','),_0x1551c0=[];async function _0x41e8b8(_0x3af62a){var _0x2615b8=_0x9a601b;const _0x2584db=await warehouse[_0x2615b8(0x116)]([{'$match':{'name':_0x51872c,'room':_0x3af62a}},{'$unwind':_0x2615b8(0x14a)},{'$match':{'product_details.primary_code':_0x590cd0}},{'$group':{'_id':_0x2615b8(0x118),'name':{'$first':_0x2615b8(0x1a0)},'instock':{'$first':_0x2615b8(0x10d)},'primary_code':{'$first':_0x2615b8(0x106)},'secondary_code':{'$first':_0x2615b8(0x11e)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x2615b8(0x114)},'type':{'$first':_0x2615b8(0x1db)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2615b8(0x1e4)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2615b8(0x108)},'production_date':{'$first':_0x2615b8(0x17a)},'batch_code':{'$first':_0x2615b8(0x1b4)},'maxPerUnit':{'$first':_0x2615b8(0x15a)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x2615b8(0x17f)},'maxProducts':{'$first':_0x2615b8(0x146)},'invoice_product':{'$first':_0x2615b8(0x193)}}}]),_0x314165=await warehouse['aggregate']([{'$match':{'name':_0x51872c,'room':_0x3af62a}},{'$unwind':_0x2615b8(0x14a)},{'$match':{'product_details.secondary_code':_0x590cd0}},{'$group':{'_id':_0x2615b8(0x118),'name':{'$first':_0x2615b8(0x1a0)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x2615b8(0x106)},'secondary_code':{'$first':_0x2615b8(0x11e)},'product_code':{'$first':_0x2615b8(0x192)},'level':{'$first':_0x2615b8(0x1d5)},'isle':{'$first':_0x2615b8(0x114)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2615b8(0x11c)},'unit':{'$first':_0x2615b8(0x1b3)},'secondary_unit':{'$first':_0x2615b8(0x1e4)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2615b8(0x1d6)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x2615b8(0x17f)},'maxProducts':{'$first':_0x2615b8(0x146)},'invoice_product':{'$first':_0x2615b8(0x193)}}}]);if(_0x2584db[_0x2615b8(0x15f)]>0x0)_0x1551c0['push'](_0x2584db);else _0x314165[_0x2615b8(0x15f)]>0x0&&_0x1551c0[_0x2615b8(0x121)](_0x314165);}const _0xac5a62=_0x2f6d8c[_0x9a601b(0x138)](_0x4aa47d=>_0x41e8b8(_0x4aa47d));await Promise['all'](_0xac5a62),_0x3b7611[_0x9a601b(0x163)](_0x1551c0);}),router['post'](a0_0x57a9e2(0x1ee),async(_0x1987f6,_0x2856ad)=>{var _0x1779d9=a0_0x57a9e2;try{const {FromWareHouse:_0x2a6076,FromRoom:_0x16c4bf,ToWarehouse:_0x36bccb,ToRoom:_0x3c019a,secondary_code:_0x465fb4}=_0x1987f6[_0x1779d9(0x123)],_0x27a727=await warehouse['aggregate']([{'$match':{'name':_0x2a6076}},{'$unwind':_0x1779d9(0x14a)},{'$match':{'product_details.secondary_code':_0x465fb4}},{'$group':{'_id':_0x1779d9(0x118),'name':{'$first':_0x1779d9(0x1a0)},'primary_code':{'$first':_0x1779d9(0x106)},'secondary_code':{'$first':_0x1779d9(0x11e)},'product_code':{'$first':_0x1779d9(0x192)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x1779d9(0x122)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x1779d9(0x11d)},'maxProducts':{'$first':_0x1779d9(0x146)},'unit':{'$first':'$product_details.unit'}}}]);_0x2856ad[_0x1779d9(0x1ed)](0xc8)[_0x1779d9(0x163)](_0x27a727);}catch(_0x289e89){_0x2856ad[_0x1779d9(0x1ed)](0x194)[_0x1779d9(0x163)]({'message':_0x289e89[_0x1779d9(0x12c)]});}}),router[a0_0x57a9e2(0x155)]('/barcode_scanner3',async(_0x4fd316,_0x5ea37a)=>{var _0x373b51=a0_0x57a9e2;try{const {FromWareHouse:_0x275ca4,FromRoom:_0x3341dd,ToWarehouse:_0x1abae2,ToRoom:_0x39a1d1,product_code:_0x231183}=_0x4fd316['body'],_0x1c8c5a=await warehouse[_0x373b51(0x116)]([{'$match':{'name':_0x275ca4}},{'$unwind':_0x373b51(0x14a)},{'$match':{'product_details.product_code':_0x231183}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x373b51(0x106)},'secondary_code':{'$first':_0x373b51(0x11e)},'product_code':{'$first':_0x373b51(0x192)},'instock':{'$first':_0x373b51(0x10d)},'warehouse':{'$first':_0x373b51(0x122)},'level':{'$first':_0x373b51(0x1bc)},'isle':{'$first':_0x373b51(0x1b5)},'pallet':{'$first':_0x373b51(0x11d)},'maxProducts':{'$first':_0x373b51(0x146)},'unit':{'$first':_0x373b51(0x1b3)}}}]);_0x5ea37a[_0x373b51(0x1ed)](0xc8)[_0x373b51(0x163)](_0x1c8c5a);}catch(_0x41654c){_0x5ea37a[_0x373b51(0x1ed)](0x194)[_0x373b51(0x163)]({'message':_0x41654c['message']});}}),router['post'](a0_0x57a9e2(0x136),async(_0xd9ee9,_0x4dafcb)=>{var _0x736635=a0_0x57a9e2;const {level:_0x5b267e,isle:_0x1ae697,pallet:_0x141434,warehouses:_0x56e34b,room:_0x3b04b7}=_0xd9ee9[_0x736635(0x123)];try{const _0x5ba44f=await warehouse[_0x736635(0x116)]([{'$match':{'name':_0x56e34b,'room':_0x3b04b7}},{'$unwind':_0x736635(0x14a)},{'$match':{'product_details.level':parseInt(_0x5b267e),'product_details.isle':_0x1ae697,'product_details.pallet':parseInt(_0x141434)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x736635(0x1a0)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x736635(0x1bc)},'isle':{'$first':_0x736635(0x1b5)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x736635(0x146)}}}]);_0x4dafcb[_0x736635(0x1ed)](0xc8)[_0x736635(0x163)](_0x5ba44f);}catch(_0x5e2e57){_0x4dafcb[_0x736635(0x1ed)](0x194)[_0x736635(0x163)]({'message':_0x5e2e57['message']});}}),module[a0_0x57a9e2(0x13c)]=router;