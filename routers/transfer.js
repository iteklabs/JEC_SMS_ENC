var a0_0x24e80b=a0_0x148c;(function(_0x2d4ed8,_0x5c0b58){var _0x52e23b=a0_0x148c,_0x50bce9=_0x2d4ed8();while(!![]){try{var _0xea2e1e=-parseInt(_0x52e23b(0x280))/0x1*(-parseInt(_0x52e23b(0x1be))/0x2)+parseInt(_0x52e23b(0x1c2))/0x3*(parseInt(_0x52e23b(0x1ff))/0x4)+-parseInt(_0x52e23b(0x214))/0x5+-parseInt(_0x52e23b(0x272))/0x6*(parseInt(_0x52e23b(0x1f0))/0x7)+parseInt(_0x52e23b(0x1e4))/0x8*(parseInt(_0x52e23b(0x1f1))/0x9)+parseInt(_0x52e23b(0x229))/0xa+-parseInt(_0x52e23b(0x1c3))/0xb*(parseInt(_0x52e23b(0x1e0))/0xc);if(_0xea2e1e===_0x5c0b58)break;else _0x50bce9['push'](_0x50bce9['shift']());}catch(_0x528b1b){_0x50bce9['push'](_0x50bce9['shift']());}}}(a0_0x5f62,0x50680));const express=require(a0_0x24e80b(0x1c1)),app=express(),router=express[a0_0x24e80b(0x228)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x24e80b(0x247)),auth=require(a0_0x24e80b(0x227)),users=require(a0_0x24e80b(0x1ab)),nodemailer=require(a0_0x24e80b(0x260));router['get'](a0_0x24e80b(0x29e),auth,async(_0x37d400,_0x28080f)=>{var _0xd15492=a0_0x24e80b;try{const {username:_0x5d62e2,email:_0x558a79,role:_0x3192a3}=_0x37d400[_0xd15492(0x217)],_0x588d50=_0x37d400['user'],_0x512b75=await profile['findOne']({'email':_0x588d50['email']}),_0x2d1000=await master_shop[_0xd15492(0x230)]();console[_0xd15492(0x28f)]('master',_0x2d1000);let _0x51c573;if(_0x588d50[_0xd15492(0x238)]==_0xd15492(0x1b8)){const _0x396bb6=await staff[_0xd15492(0x2a0)]({'email':_0x588d50[_0xd15492(0x1ee)]});_0x51c573=await transfers['find']({'from_warehouse':_0x396bb6[_0xd15492(0x1b0)]});}else _0x51c573=await transfers[_0xd15492(0x281)]([{'$unwind':_0xd15492(0x29d)},{'$group':{'_id':_0xd15492(0x258),'invoice':{'$first':_0xd15492(0x250)},'date':{'$first':_0xd15492(0x23f)},'from_warehouse':{'$first':_0xd15492(0x1f6)},'to_warehouse':{'$first':_0xd15492(0x1c7)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2d1000[0x0][_0xd15492(0x21d)]==_0xd15492(0x21e)){var _0x3ca4f1=users[_0xd15492(0x1de)];console[_0xd15492(0x28f)](_0x3ca4f1);}else{if(_0x2d1000[0x0][_0xd15492(0x21d)]==_0xd15492(0x287))var _0x3ca4f1=users[_0xd15492(0x287)];else{if(_0x2d1000[0x0]['language']==_0xd15492(0x1bb))var _0x3ca4f1=users['German'];else{if(_0x2d1000[0x0][_0xd15492(0x21d)]==_0xd15492(0x1b4))var _0x3ca4f1=users[_0xd15492(0x1b4)];else{if(_0x2d1000[0x0][_0xd15492(0x21d)]==_0xd15492(0x291))var _0x3ca4f1=users[_0xd15492(0x291)];else{if(_0x2d1000[0x0][_0xd15492(0x21d)]=='Portuguese\x20(BR)')var _0x3ca4f1=users[_0xd15492(0x295)];else{if(_0x2d1000[0x0][_0xd15492(0x21d)]=='Chinese')var _0x3ca4f1=users[_0xd15492(0x28a)];else{if(_0x2d1000[0x0][_0xd15492(0x21d)]==_0xd15492(0x25c))var _0x3ca4f1=users['Arabic'];}}}}}}}_0x28080f[_0xd15492(0x20d)](_0xd15492(0x223),{'success':_0x37d400[_0xd15492(0x1aa)](_0xd15492(0x218)),'errors':_0x37d400['flash'](_0xd15492(0x213)),'role':_0x588d50,'profile':_0x512b75,'master_shop':_0x2d1000,'transfer':_0x51c573,'language':_0x3ca4f1});}catch(_0x4d4219){console[_0xd15492(0x28f)](_0x4d4219);}});function a0_0x148c(_0xcc6526,_0xcfd2ff){var _0x5f6294=a0_0x5f62();return a0_0x148c=function(_0x148c7b,_0x4fad61){_0x148c7b=_0x148c7b-0x1a9;var _0x2c52b2=_0x5f6294[_0x148c7b];return _0x2c52b2;},a0_0x148c(_0xcc6526,_0xcfd2ff);}async function getRandom8DigitNumber(){var _0x13f182=a0_0x24e80b;const _0x166539=0x989680,_0x159c8f=0x5f5e0ff,_0x6bac1e=Math[_0x13f182(0x1e8)](Math[_0x13f182(0x266)]()*(_0x159c8f-_0x166539+0x1))+_0x166539;var _0x215321;const _0x485c87=await transfers[_0x13f182(0x2a0)]({'invoice':'TRF-'+_0x6bac1e});return _0x485c87&&_0x485c87[_0x13f182(0x254)]>0x0?_0x215321=_0x13f182(0x23b)+_0x6bac1e:_0x215321=_0x13f182(0x23b)+_0x6bac1e,_0x215321;}router['get'](a0_0x24e80b(0x251),auth,async(_0x2b26d4,_0x4e6904)=>{var _0x4377f3=a0_0x24e80b;try{const {username:_0x4a30d3,email:_0x45f5a4,role:_0x4e9e25}=_0x2b26d4['user'],_0x40dedb=_0x2b26d4[_0x4377f3(0x217)],_0x4c1893=await profile['findOne']({'email':_0x40dedb[_0x4377f3(0x1ee)]}),_0x3bac3e=await master_shop[_0x4377f3(0x230)]();console[_0x4377f3(0x28f)](_0x4377f3(0x1fd),_0x3bac3e);let _0x371bb2;if(_0x40dedb[_0x4377f3(0x238)]=='staff'){const _0x131a34=await staff['findOne']({'email':_0x40dedb[_0x4377f3(0x1ee)]});_0x371bb2=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x131a34['warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4377f3(0x220),'name':{'$first':_0x4377f3(0x220)}}}]);}else _0x371bb2=await warehouse['aggregate']([{'$match':{'status':_0x4377f3(0x232),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4377f3(0x220),'name':{'$first':'$name'}}}]);var _0x6fe05f=[_0x4377f3(0x1bd),_0x4377f3(0x263),_0x4377f3(0x290)];const _0x303371=await transfers[_0x4377f3(0x230)]({}),_0x549c75=_0x303371[_0x4377f3(0x254)]+0x1,_0x4e9a5d=_0x4377f3(0x23b)+_0x549c75[_0x4377f3(0x1d6)]()[_0x4377f3(0x292)](0x5,'0');if(_0x3bac3e[0x0][_0x4377f3(0x21d)]=='English\x20(US)'){var _0x15d316=users[_0x4377f3(0x1de)];console[_0x4377f3(0x28f)](_0x15d316);}else{if(_0x3bac3e[0x0][_0x4377f3(0x21d)]==_0x4377f3(0x287))var _0x15d316=users[_0x4377f3(0x287)];else{if(_0x3bac3e[0x0][_0x4377f3(0x21d)]==_0x4377f3(0x1bb))var _0x15d316=users['German'];else{if(_0x3bac3e[0x0][_0x4377f3(0x21d)]==_0x4377f3(0x1b4))var _0x15d316=users[_0x4377f3(0x1b4)];else{if(_0x3bac3e[0x0][_0x4377f3(0x21d)]==_0x4377f3(0x291))var _0x15d316=users[_0x4377f3(0x291)];else{if(_0x3bac3e[0x0][_0x4377f3(0x21d)]=='Portuguese\x20(BR)')var _0x15d316=users[_0x4377f3(0x295)];else{if(_0x3bac3e[0x0][_0x4377f3(0x21d)]=='Chinese')var _0x15d316=users[_0x4377f3(0x28a)];else{if(_0x3bac3e[0x0][_0x4377f3(0x21d)]==_0x4377f3(0x25c))var _0x15d316=users['Arabic'];}}}}}}}const _0x3ad362=getRandom8DigitNumber();_0x3ad362[_0x4377f3(0x1c8)](_0x8f002a=>{var _0x529565=_0x4377f3;_0x4e6904[_0x529565(0x20d)](_0x529565(0x21c),{'success':_0x2b26d4[_0x529565(0x1aa)](_0x529565(0x218)),'errors':_0x2b26d4[_0x529565(0x1aa)](_0x529565(0x213)),'role':_0x40dedb,'profile':_0x4c1893,'master_shop':_0x3bac3e,'warehouse':_0x371bb2,'language':_0x15d316,'rooms_data':_0x6fe05f,'invoice':_0x8f002a});})[_0x4377f3(0x1cb)](_0x366cf9=>{var _0x1d9188=_0x4377f3;_0x2b26d4['flash']('errors',_0x1d9188(0x29f)),_0x4e6904[_0x1d9188(0x225)](_0x1d9188(0x27b));});}catch(_0x27dadb){console[_0x4377f3(0x28f)](_0x27dadb);}}),router['post'](a0_0x24e80b(0x251),auth,async(_0x55eb2b,_0x278d60)=>{var _0x27ca77=a0_0x24e80b;try{console[_0x27ca77(0x28f)](_0x55eb2b['body']);const {date:_0x44ea37,from_warehouse:_0x4cf151,FromRoom_name:_0x24dcde,to_warehouse:_0x2ae95d,ToRoom_name:_0xf71d66,prod_name:_0x322783,from_prod_qty:_0x1f3025,from_prod_level:_0x59d5c0,from_prod_isle:_0x173028,from_prod_pallet:_0x432bf1,to_prod_qty:_0x213adf,to_prod_level:_0x527310,to_prod_isle:_0x2bdea7,to_prod_pallet:_0x46d93d,primary_code:_0x2f3dbc,secondary_code:_0x20e83b,product_code3:_0x3d9d49,note:_0x25a697,MaxStocks_data2:_0x589d64,invoice:_0x3d423b,expiry_date:_0x3a7ae7}=_0x55eb2b[_0x27ca77(0x269)];if(typeof _0x322783==_0x27ca77(0x1ec))var _0x42d6e1=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x243)]],_0x314c46=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x26e)]],_0x218c66=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1f4)]],_0x1a3892=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1d8)]],_0x389cb4=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1db)]],_0x1be466=[_0x55eb2b['body']['primary_code']],_0x30d081=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x27c)]],_0x53a949=[_0x55eb2b[_0x27ca77(0x269)]['product_code3']],_0x127d6e=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x236)]],_0x3eb02a=[_0x55eb2b[_0x27ca77(0x269)]['primary_unit']],_0x430c41=[_0x55eb2b[_0x27ca77(0x269)]['secondary_unit']],_0x522708=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1ac)]],_0x309073=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x26a)]],_0x392bd3=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x22c)]],_0xdba020=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x28b)]],_0x5a49e0=[_0x55eb2b[_0x27ca77(0x269)]['prod_cat']],_0x223d09=[_0x55eb2b['body'][_0x27ca77(0x26d)]],_0x307e24=[_0x55eb2b[_0x27ca77(0x269)]['ToRoomAssigned']],_0x2d76b6=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1af)]],_0x21a26a=[_0x55eb2b['body']['to_invoice']],_0x16c954=[_0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x299)]];else var _0x42d6e1=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x243)]],_0x314c46=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x26e)]],_0x218c66=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1f4)]],_0x1a3892=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1d8)]],_0x389cb4=[..._0x55eb2b['body'][_0x27ca77(0x1db)]],_0x1be466=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x274)]],_0x30d081=[..._0x55eb2b[_0x27ca77(0x269)]['secondary_code']],_0x53a949=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1bf)]],_0x127d6e=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x236)]],_0x3eb02a=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1b3)]],_0x430c41=[..._0x55eb2b[_0x27ca77(0x269)]['secondary_unit']],_0x522708=[..._0x55eb2b['body']['batch_code']],_0x309073=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x26a)]],_0x392bd3=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x22c)]],_0xdba020=[..._0x55eb2b[_0x27ca77(0x269)]['production_date']],_0x5a49e0=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x1c4)]],_0x223d09=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x26d)]],_0x307e24=[..._0x55eb2b[_0x27ca77(0x269)][_0x27ca77(0x26f)]],_0x2d76b6=[..._0x55eb2b[_0x27ca77(0x269)]['from_invoice']],_0x21a26a=[..._0x55eb2b[_0x27ca77(0x269)]['to_invoice']],_0x16c954=[..._0x55eb2b['body']['id_transaction']];const _0x3c8554=_0x42d6e1[_0x27ca77(0x1f5)](_0x193c04=>{return _0x193c04={'product_name':_0x193c04};});_0x314c46[_0x27ca77(0x22d)]((_0x238717,_0x4c2954)=>{var _0x2bc865=_0x27ca77;_0x3c8554[_0x4c2954][_0x2bc865(0x286)]=_0x238717;}),_0x2d76b6[_0x27ca77(0x22d)]((_0x557900,_0x20634b)=>{_0x3c8554[_0x20634b]['from_invoice']=_0x557900;}),_0x21a26a[_0x27ca77(0x22d)]((_0x4626b0,_0x3ae054)=>{var _0x468c16=_0x27ca77;_0x3c8554[_0x3ae054][_0x468c16(0x1e3)]=_0x4626b0;}),_0x16c954[_0x27ca77(0x22d)]((_0x1359a7,_0x45bd06)=>{_0x3c8554[_0x45bd06]['id_transaction_id']=_0x1359a7;}),_0x218c66[_0x27ca77(0x22d)]((_0x23dcdf,_0x4a4c8b)=>{_0x223d09['forEach']((_0x54537b,_0x432f29)=>{var _0x50ebd3=a0_0x148c;if(_0x54537b==_0x50ebd3(0x293)&&_0x4a4c8b==_0x432f29){var _0x137d75=_0x23dcdf[_0x50ebd3(0x28e)](0x3);_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1da)]=_0x23dcdf[0x0],_0x3c8554[_0x4a4c8b][_0x50ebd3(0x20e)]=_0x23dcdf[0x1],_0x3c8554[_0x4a4c8b][_0x50ebd3(0x222)]=0x0,_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1b5)]=0x0,_0x3c8554[_0x4a4c8b]['from_types']=_0x50ebd3(0x282),_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1b2)]=_0x137d75;}else{if(_0x54537b==_0x50ebd3(0x21a)&&_0x4a4c8b==_0x432f29){var _0x137d75=_0x23dcdf[_0x50ebd3(0x28e)](0x3);_0x3c8554[_0x4a4c8b]['from_storage']=_0x23dcdf[0x0],_0x3c8554[_0x4a4c8b]['from_rack']=_0x23dcdf[0x1],_0x3c8554[_0x4a4c8b]['from_bay']=0x0,_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1b5)]=0x0,_0x3c8554[_0x4a4c8b][_0x50ebd3(0x284)]=_0x50ebd3(0x282),_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1b2)]=_0x23dcdf[0x5];}else{if(_0x4a4c8b==_0x432f29){if(_0x23dcdf[0x0]=='A'&&_0x23dcdf[0x1]=='L'&&_0x23dcdf[0x2]=='L')console[_0x50ebd3(0x28f)](_0x54537b+_0x50ebd3(0x204)+_0x4a4c8b+_0x50ebd3(0x204)+_0x432f29+_0x50ebd3(0x204)+_0x23dcdf+_0x50ebd3(0x1f3)),_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1da)]=_0x23dcdf[0x0],_0x3c8554[_0x4a4c8b]['from_rack']=_0x23dcdf[0x1],_0x3c8554[_0x4a4c8b][_0x50ebd3(0x222)]=0x0,_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1b5)]=0x0,_0x3c8554[_0x4a4c8b][_0x50ebd3(0x284)]=_0x50ebd3(0x282),_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1b2)]=_0x23dcdf[0x3];else{var _0x1a0d3b;if(_0x23dcdf[0x4]=='L')_0x1a0d3b=_0x50ebd3(0x27d);else _0x23dcdf[0x4]=='F'&&(_0x1a0d3b=_0x50ebd3(0x282));_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1da)]=_0x23dcdf[0x0],_0x3c8554[_0x4a4c8b][_0x50ebd3(0x20e)]=_0x23dcdf[0x1],_0x3c8554[_0x4a4c8b][_0x50ebd3(0x222)]=_0x23dcdf[0x2],_0x3c8554[_0x4a4c8b]['from_bin']=_0x23dcdf[0x3],_0x3c8554[_0x4a4c8b][_0x50ebd3(0x284)]=_0x1a0d3b,_0x3c8554[_0x4a4c8b][_0x50ebd3(0x1b2)]=_0x23dcdf[0x5];}}}}});}),_0x1a3892[_0x27ca77(0x22d)]((_0x4f324d,_0x3eb3cc)=>{_0x3c8554[_0x3eb3cc]['to_quantity']=_0x4f324d;}),_0x389cb4[_0x27ca77(0x22d)]((_0x36e696,_0x15e9f7)=>{var _0x5d8752=_0x27ca77;_0x307e24[_0x5d8752(0x22d)]((_0x1b43e6,_0x49aa64)=>{var _0x345981=_0x5d8752;if(_0x1b43e6==_0x345981(0x293)&&_0x15e9f7==_0x49aa64){var _0x5708c2=_0x36e696[_0x345981(0x28e)](0x3);_0x3c8554[_0x15e9f7][_0x345981(0x1d9)]=_0x36e696[0x0],_0x3c8554[_0x15e9f7][_0x345981(0x270)]=_0x36e696[0x1],_0x3c8554[_0x15e9f7][_0x345981(0x1ad)]=0x0,_0x3c8554[_0x15e9f7][_0x345981(0x1eb)]=0x0,_0x3c8554[_0x15e9f7][_0x345981(0x273)]=_0x345981(0x282),_0x3c8554[_0x15e9f7][_0x345981(0x203)]=_0x5708c2;}else{if(_0x1b43e6=='Shelves'&&_0x15e9f7==_0x49aa64){var _0x5708c2=_0x36e696['slice'](0x3);_0x3c8554[_0x15e9f7][_0x345981(0x1d9)]=_0x36e696[0x0],_0x3c8554[_0x15e9f7][_0x345981(0x270)]=_0x36e696[0x1],_0x3c8554[_0x15e9f7]['to_bay']=0x0,_0x3c8554[_0x15e9f7]['to_bin']=0x0,_0x3c8554[_0x15e9f7][_0x345981(0x273)]=_0x345981(0x282),_0x3c8554[_0x15e9f7]['to_floorlevel']=_0x36e696[0x5];}else{if(_0x15e9f7==_0x49aa64){if(_0x36e696[0x0]=='A'&&_0x36e696[0x1]=='L'&&_0x36e696[0x2]=='L')console[_0x345981(0x28f)](_0x1b43e6+_0x345981(0x204)+_0x15e9f7+_0x345981(0x204)+_0x49aa64+_0x345981(0x204)+_0x36e696+_0x345981(0x1f3)),_0x3c8554[_0x15e9f7]['storage']=_0x36e696[0x0],_0x3c8554[_0x15e9f7][_0x345981(0x270)]=_0x36e696[0x1],_0x3c8554[_0x15e9f7]['to_bay']=0x0,_0x3c8554[_0x15e9f7][_0x345981(0x1eb)]=0x0,_0x3c8554[_0x15e9f7][_0x345981(0x273)]=_0x345981(0x282),_0x3c8554[_0x15e9f7][_0x345981(0x203)]=_0x36e696[0x3];else{var _0x48c3c9;if(_0x36e696[0x4]=='L')_0x48c3c9=_0x345981(0x27d);else _0x36e696[0x4]=='F'&&(_0x48c3c9=_0x345981(0x282));_0x3c8554[_0x15e9f7][_0x345981(0x1d9)]=_0x36e696[0x0],_0x3c8554[_0x15e9f7]['rack']=_0x36e696[0x1],_0x3c8554[_0x15e9f7]['to_bay']=_0x36e696[0x2],_0x3c8554[_0x15e9f7][_0x345981(0x1eb)]=_0x36e696[0x3],_0x3c8554[_0x15e9f7]['to_types']=_0x48c3c9,_0x3c8554[_0x15e9f7][_0x345981(0x203)]=_0x36e696[0x5];}}}}});}),_0x1be466['forEach']((_0x4a7c60,_0x4508f5)=>{_0x3c8554[_0x4508f5]['primary_code']=_0x4a7c60;}),_0x30d081[_0x27ca77(0x22d)]((_0x23d6a9,_0x11b568)=>{var _0x10a1e8=_0x27ca77;_0x3c8554[_0x11b568][_0x10a1e8(0x27c)]=_0x23d6a9;}),_0x53a949[_0x27ca77(0x22d)]((_0x4be3a0,_0x33fa4c)=>{var _0x4297d3=_0x27ca77;_0x3c8554[_0x33fa4c][_0x4297d3(0x219)]=_0x4be3a0;}),_0x127d6e[_0x27ca77(0x22d)]((_0x310aa7,_0x20f439)=>{var _0x52359b=_0x27ca77;_0x3c8554[_0x20f439][_0x52359b(0x1e5)]=_0x310aa7;}),_0x3eb02a[_0x27ca77(0x22d)]((_0x223deb,_0x5c2ae1)=>{var _0x3ab24f=_0x27ca77;_0x3c8554[_0x5c2ae1][_0x3ab24f(0x271)]=_0x223deb;}),_0x430c41[_0x27ca77(0x22d)]((_0x8624c7,_0x53edb5)=>{var _0x4b9952=_0x27ca77;_0x3c8554[_0x53edb5][_0x4b9952(0x226)]=_0x8624c7;}),_0x522708[_0x27ca77(0x22d)]((_0x17a75c,_0x2fa8a8)=>{var _0x5ef6c5=_0x27ca77;_0x3c8554[_0x2fa8a8][_0x5ef6c5(0x1ac)]=_0x17a75c;}),_0x309073['forEach']((_0x296cca,_0x56c647)=>{var _0x27b97a=_0x27ca77;_0x3c8554[_0x56c647][_0x27b97a(0x26a)]=_0x296cca;}),_0x392bd3[_0x27ca77(0x22d)]((_0x5e3503,_0x52dfc6)=>{_0x3c8554[_0x52dfc6]['maxperunit']=_0x5e3503;}),_0xdba020['forEach']((_0x5e3297,_0x2d6b7f)=>{var _0x24692e=_0x27ca77;_0x3c8554[_0x2d6b7f][_0x24692e(0x28b)]=_0x5e3297;}),_0x5a49e0[_0x27ca77(0x22d)]((_0x26e015,_0x146a1a)=>{var _0x33ef39=_0x27ca77;_0x3c8554[_0x146a1a][_0x33ef39(0x1c4)]=_0x26e015;}),_0x223d09[_0x27ca77(0x22d)]((_0x1af9d9,_0x1c9103)=>{_0x3c8554[_0x1c9103]['from_room_name']=_0x1af9d9;}),_0x307e24['forEach']((_0x139143,_0x410ddf)=>{var _0x339eb8=_0x27ca77;_0x3c8554[_0x410ddf][_0x339eb8(0x24a)]=_0x139143;});const _0xbac5a0=_0x3c8554[_0x27ca77(0x257)](_0x5f1841=>_0x5f1841[_0x27ca77(0x234)]!=='0'&&_0x5f1841['to_quantity']!==''||_0x5f1841['to_floorlevel']!=='0'&&_0x5f1841[_0x27ca77(0x203)]!==''),_0x5992f2=new transfers({'date':_0x44ea37,'from_warehouse':_0x4cf151,'to_warehouse':_0x2ae95d,'product':_0xbac5a0,'note':_0x25a697,'invoice':_0x3d423b}),_0x569c4f=await _0x5992f2[_0x27ca77(0x1dd)]();_0x55eb2b['flash'](_0x27ca77(0x218),_0x27ca77(0x297)),_0x278d60['redirect'](_0x27ca77(0x261)+_0x569c4f[_0x27ca77(0x279)]);}catch(_0x5220a4){console[_0x27ca77(0x28f)](_0x5220a4),_0x278d60[_0x27ca77(0x24c)](0xc8)[_0x27ca77(0x285)]({'errorMessage':_0x5220a4['message']});}}),router[a0_0x24e80b(0x241)](a0_0x24e80b(0x249),auth,async(_0x2b77a4,_0x6abfc9)=>{var _0x5b3c77=a0_0x24e80b;try{const {username:_0x26b4c0,email:_0x4f8832,role:_0x150108}=_0x2b77a4['user'],_0x1fbf93=_0x2b77a4[_0x5b3c77(0x217)],_0x4c5158=await profile[_0x5b3c77(0x2a0)]({'email':_0x1fbf93['email']}),_0x4affc0=await master_shop[_0x5b3c77(0x230)]();console[_0x5b3c77(0x28f)]('master',_0x4affc0);const _0x374b64=await transfers['findById'](_0x2b77a4[_0x5b3c77(0x235)]['id']);let _0x4a4a2c=new Date(_0x374b64[_0x5b3c77(0x26a)]),_0x415659=('0'+_0x4a4a2c[_0x5b3c77(0x25a)]())['slice'](-0x2),_0x362178=('0'+(_0x4a4a2c[_0x5b3c77(0x25d)]()+0x1))[_0x5b3c77(0x28e)](-0x2),_0x2a0f50=_0x4a4a2c[_0x5b3c77(0x1e2)](),_0x954dd5=_0x2a0f50+'-'+_0x362178+'-'+_0x415659,_0x293bca;if(_0x1fbf93[_0x5b3c77(0x238)]=='staff'){const _0x9d841f=await staff[_0x5b3c77(0x2a0)]({'email':_0x1fbf93[_0x5b3c77(0x1ee)]});_0x293bca=await warehouse[_0x5b3c77(0x230)]({'status':_0x5b3c77(0x232),'name':_0x9d841f[_0x5b3c77(0x1b0)],'warehouse_category':_0x5b3c77(0x24d)});}else _0x293bca=await warehouse['find']({'status':_0x5b3c77(0x232),'warehouse_category':_0x5b3c77(0x24d)});const _0x1b1cc2=await warehouse[_0x5b3c77(0x281)]([{'$match':{'name':_0x374b64[_0x5b3c77(0x27e)]}},{'$unwind':_0x5b3c77(0x1c9)},{'$group':{'_id':_0x5b3c77(0x200),'name':{'$first':_0x5b3c77(0x24f)},'product_stock':{'$first':_0x5b3c77(0x1b1)},'bay':{'$first':_0x5b3c77(0x1bc)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5b3c77(0x216)},'floorlevel':{'$first':_0x5b3c77(0x2a1)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5b3c77(0x1fc)},'storage':{'$first':_0x5b3c77(0x1d7)},'rack':{'$first':_0x5b3c77(0x231)},'expiry_date':{'$first':_0x5b3c77(0x259)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]);if(_0x4affc0[0x0][_0x5b3c77(0x21d)]=='English\x20(US)'){var _0x407703=users['English'];console[_0x5b3c77(0x28f)](_0x407703);}else{if(_0x4affc0[0x0]['language']==_0x5b3c77(0x287))var _0x407703=users[_0x5b3c77(0x287)];else{if(_0x4affc0[0x0][_0x5b3c77(0x21d)]==_0x5b3c77(0x1bb))var _0x407703=users[_0x5b3c77(0x1bb)];else{if(_0x4affc0[0x0][_0x5b3c77(0x21d)]==_0x5b3c77(0x1b4))var _0x407703=users['Spanish'];else{if(_0x4affc0[0x0][_0x5b3c77(0x21d)]=='French')var _0x407703=users['French'];else{if(_0x4affc0[0x0]['language']==_0x5b3c77(0x215))var _0x407703=users[_0x5b3c77(0x295)];else{if(_0x4affc0[0x0]['language']==_0x5b3c77(0x28a))var _0x407703=users[_0x5b3c77(0x28a)];else{if(_0x4affc0[0x0][_0x5b3c77(0x21d)]==_0x5b3c77(0x25c))var _0x407703=users[_0x5b3c77(0x276)];}}}}}}}_0x6abfc9[_0x5b3c77(0x20d)]('edit_transfer_view',{'success':_0x2b77a4['flash'](_0x5b3c77(0x218)),'errors':_0x2b77a4[_0x5b3c77(0x1aa)](_0x5b3c77(0x213)),'role':_0x1fbf93,'profile':_0x4c5158,'master_shop':_0x4affc0,'warehouse':_0x293bca,'transfer':_0x374b64,'stock':_0x1b1cc2,'language':_0x407703});}catch(_0x530c8a){console['log'](_0x530c8a);}}),router['post'](a0_0x24e80b(0x249),auth,async(_0x59dc44,_0x430d82)=>{var _0x11a403=a0_0x24e80b;try{const _0x315d6f=_0x59dc44[_0x11a403(0x235)]['id'],{from_warehouse:_0x2e8a77,FromRoom_name:_0x5bca5e,to_warehouse:_0x1828ed,ToRoom_name:_0x175167}=_0x59dc44[_0x11a403(0x269)],_0x15061b=await transfers['findById']({'_id':_0x315d6f}),_0x4874e8=_0x15061b[_0x11a403(0x26c)][_0x11a403(0x1f5)](async _0xdd64c=>{var _0x7169cc=_0x11a403;if(_0xdd64c[_0x7169cc(0x234)]>0x0){var _0xf0bda5=await warehouse[_0x7169cc(0x2a0)]({'name':_0x15061b['from_warehouse'],'room':_0xdd64c[_0x7169cc(0x1fb)],'warehouse_category':'Raw\x20Materials'});const _0xa3c1fa=_0xf0bda5[_0x7169cc(0x244)][_0x7169cc(0x1f5)](_0xac88ce=>{var _0x9f2d14=_0x7169cc;_0xac88ce[_0x9f2d14(0x1ed)]==_0xdd64c['product_name']&&_0xac88ce['floorlevel']==_0xdd64c[_0x9f2d14(0x1b2)]&&_0xac88ce['type']==_0xdd64c['from_types']&&_0xac88ce[_0x9f2d14(0x21f)]==_0xdd64c[_0x9f2d14(0x1b5)]&&_0xac88ce[_0x9f2d14(0x1ca)]==_0xdd64c[_0x9f2d14(0x222)]&&_0xac88ce[_0x9f2d14(0x270)]==_0xdd64c[_0x9f2d14(0x20e)]&&_0xac88ce[_0x9f2d14(0x1d9)]==_0xdd64c['from_storage']&&_0xac88ce[_0x9f2d14(0x26a)]==_0xdd64c['expiry_date']&&_0xac88ce['batch_code']==_0xdd64c[_0x9f2d14(0x1ac)]&&_0xac88ce['production_date']==_0xdd64c[_0x9f2d14(0x28b)]&&_0xac88ce[_0x9f2d14(0x28c)]==_0xdd64c[_0x9f2d14(0x1af)]&&_0xac88ce[_0x9f2d14(0x279)]==_0xdd64c[_0x9f2d14(0x1ce)]&&(_0xac88ce[_0x9f2d14(0x23d)]=_0xac88ce[_0x9f2d14(0x23d)]-_0xdd64c[_0x9f2d14(0x234)]);});}return _0xf0bda5;});Promise[_0x11a403(0x289)](_0x4874e8)[_0x11a403(0x1c8)](async _0x1949ca=>{var _0x45185c=_0x11a403;try{for(const _0x3b9f07 of _0x1949ca){await _0x3b9f07['save']();}try{const _0x1928d6=_0x15061b[_0x45185c(0x26c)]['map'](async _0x27eef3=>{var _0x589e22=_0x45185c;if(_0x27eef3['to_quantity']>0x0){var _0x42868b=await warehouse[_0x589e22(0x2a0)]({'name':_0x15061b['to_warehouse'],'room':_0x27eef3[_0x589e22(0x24a)],'warehouse_category':_0x589e22(0x24d)}),_0xac5600=0x0;const _0x5e39e0=_0x42868b[_0x589e22(0x244)][_0x589e22(0x1f5)](_0x84ee0c=>{var _0x4d9a70=_0x589e22;_0x84ee0c[_0x4d9a70(0x1ed)]==_0x27eef3['product_name']&&_0x84ee0c['floorlevel']==_0x27eef3[_0x4d9a70(0x203)]&&_0x84ee0c['type']==_0x27eef3[_0x4d9a70(0x273)]&&_0x84ee0c['bin']==_0x27eef3[_0x4d9a70(0x1eb)]&&_0x84ee0c['bay']==_0x27eef3['to_bay']&&_0x84ee0c[_0x4d9a70(0x270)]==_0x27eef3['rack']&&_0x84ee0c[_0x4d9a70(0x1d9)]==_0x27eef3[_0x4d9a70(0x1d9)]&&_0x84ee0c[_0x4d9a70(0x26a)]==_0x27eef3['expiry_date']&&_0x84ee0c[_0x4d9a70(0x1ac)]==_0x27eef3['batch_code']&&_0x84ee0c[_0x4d9a70(0x28b)]==_0x27eef3[_0x4d9a70(0x28b)]&&_0x84ee0c['invoice']==_0x27eef3['To_invoice']&&(_0x84ee0c['product_stock']=_0x84ee0c[_0x4d9a70(0x23d)]+_0x27eef3[_0x4d9a70(0x234)],_0xac5600++);});_0xac5600=='0'&&(_0x42868b['product_details']=_0x42868b[_0x589e22(0x244)][_0x589e22(0x1e6)]({'product_name':_0x27eef3['product_name'],'product_stock':_0x27eef3[_0x589e22(0x234)],'bay':_0x27eef3[_0x589e22(0x1ad)],'bin':_0x27eef3[_0x589e22(0x1eb)],'type':_0x27eef3[_0x589e22(0x273)],'floorlevel':_0x27eef3[_0x589e22(0x203)],'storage':_0x27eef3[_0x589e22(0x1d9)],'rack':_0x27eef3[_0x589e22(0x270)],'product_code':_0x27eef3[_0x589e22(0x219)],'primary_code':_0x27eef3[_0x589e22(0x274)],'secondary_code':_0x27eef3[_0x589e22(0x27c)],'maxProducts':_0x27eef3['maxProducts'],'storage':_0x27eef3['storage'],'rack':_0x27eef3[_0x589e22(0x270)],'expiry_date':_0x27eef3[_0x589e22(0x26a)],'maxPerUnit':_0x27eef3[_0x589e22(0x22e)],'batch_code':_0x27eef3[_0x589e22(0x1ac)],'production_date':_0x27eef3[_0x589e22(0x28b)]}));}return _0x42868b;});Promise['all'](_0x1928d6)['then'](async _0x316b09=>{var _0xb43578=_0x45185c;try{for(const _0x5b4d9b of _0x316b09){await warehouse[_0xb43578(0x23c)]({'_id':_0x5b4d9b[_0xb43578(0x279)]},{'$addToSet':{'product_details':{'$each':_0x5b4d9b[_0xb43578(0x244)]}}});}_0x15061b[_0xb43578(0x25b)]=_0xb43578(0x288);const _0x369165=await _0x15061b[_0xb43578(0x1dd)](),_0xdc9c76=await master_shop[_0xb43578(0x230)](),_0x123dbc=await email_settings[_0xb43578(0x2a0)](),_0x29da92=await supervisor_settings[_0xb43578(0x230)]();var _0x54b42d=_0x15061b[_0xb43578(0x26c)],_0xa2ad3d='',_0x106083;for(_0x106083 in _0x54b42d){_0xa2ad3d+=_0xb43578(0x1e9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54b42d[_0x106083]['product_name']+_0xb43578(0x275)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54b42d[_0x106083][_0xb43578(0x219)]+_0xb43578(0x275)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54b42d[_0x106083]['to_quantity']+_0xb43578(0x275)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54b42d[_0x106083][_0xb43578(0x271)]+'</td>'+_0xb43578(0x268)+_0x54b42d[_0x106083][_0xb43578(0x226)]+_0xb43578(0x275)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15061b[_0xb43578(0x1b7)]+_0xb43578(0x275)+_0xb43578(0x268)+_0x54b42d[_0x106083][_0xb43578(0x24a)]+_0xb43578(0x275)+_0xb43578(0x268)+_0x54b42d[_0x106083][_0xb43578(0x1d9)]+_0x54b42d[_0x106083][_0xb43578(0x270)]+_0x54b42d[_0x106083][_0xb43578(0x1ad)]+_0x54b42d[_0x106083][_0xb43578(0x1eb)]+_0x54b42d[_0x106083][_0xb43578(0x273)][0x0]+_0x54b42d[_0x106083][_0xb43578(0x203)]+'</td>',_0xb43578(0x29c);}let _0x5a2f29=nodemailer[_0xb43578(0x1ae)]({'host':_0x123dbc[_0xb43578(0x22f)],'port':Number(_0x123dbc['port']),'secure':![],'auth':{'user':_0x123dbc[_0xb43578(0x1ee)],'pass':_0x123dbc['password']}}),_0x4eba0e={'from':_0x123dbc[_0xb43578(0x1ee)],'to':_0x29da92[0x0]['RMSEmail'],'subject':_0xb43578(0x24e),'attachments':[{'filename':_0xb43578(0x233),'path':__dirname+'/../public'+_0xb43578(0x20b)+_0xdc9c76[0x0]['image'],'cid':_0xb43578(0x206)}],'html':_0xb43578(0x1fe)+'<html><head><title></title>'+_0xb43578(0x277)+_0xb43578(0x23e)+_0xb43578(0x1cc)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0xb43578(0x23e)+'<h2>\x20'+_0xdc9c76[0x0][_0xb43578(0x210)]+_0xb43578(0x1d1)+'</div>'+'</div>'+_0xb43578(0x267)+_0xb43578(0x23e)+_0xb43578(0x22a)+'\x20Order\x20Number\x20:\x20'+_0x15061b[_0xb43578(0x28c)]+'\x20'+_0xb43578(0x1d0)+_0xb43578(0x1a9)+_0x15061b[_0xb43578(0x212)]+'\x20'+_0xb43578(0x255)+_0xb43578(0x1d4)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xb43578(0x1cd)+_0xb43578(0x1e9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0xb43578(0x20a)+_0xb43578(0x1b6)+_0xb43578(0x248)+_0xb43578(0x1f2)+_0xb43578(0x252)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0xb43578(0x25e)+_0xb43578(0x29c)+_0xb43578(0x294)+_0xb43578(0x239)+'\x20'+_0xa2ad3d+'\x20'+_0xb43578(0x27f)+'</table>'+_0xb43578(0x23e)+_0xb43578(0x262)+_0xb43578(0x1d2)+_0xdc9c76[0x0][_0xb43578(0x210)]+'</h5>'+_0xb43578(0x29b)+_0xb43578(0x29b)+'</body></html>'};_0x5a2f29['sendMail'](_0x4eba0e,function(_0x2a44b4,_0x1f6211){var _0x25c064=_0xb43578;_0x2a44b4?(console[_0x25c064(0x28f)](_0x2a44b4),console[_0x25c064(0x28f)](_0x25c064(0x25f))):console[_0x25c064(0x28f)](_0x25c064(0x1ba));}),_0x59dc44[_0xb43578(0x1aa)](_0xb43578(0x218),'Transfer\x20Finalize\x20Successfully'),_0x430d82[_0xb43578(0x225)](_0xb43578(0x20c)+_0x369165[_0xb43578(0x279)]);}catch(_0x2c4247){console['error'](_0x2c4247),_0x430d82[_0xb43578(0x24c)](0x1f4)[_0xb43578(0x285)]({'Perror':_0xb43578(0x245),'message':_0x2c4247[_0xb43578(0x240)]});}})[_0x45185c(0x1cb)](_0x2a8026=>{var _0xb45ff7=_0x45185c;console['error'](_0x2a8026),_0x430d82[_0xb45ff7(0x24c)](0x1f4)[_0xb45ff7(0x285)]({'Perror':_0xb45ff7(0x24b)});});}catch(_0x4c2493){_0x430d82[_0x45185c(0x285)](_0x4c2493);}}catch(_0xa9cda1){console[_0x45185c(0x1e7)](_0xa9cda1),_0x430d82['status'](0x1f4)['json']({'Merror':_0x45185c(0x245),'Message':_0xa9cda1[_0x45185c(0x240)]});}})[_0x11a403(0x1cb)](_0x4978f0=>{var _0x1e1789=_0x11a403;console[_0x1e1789(0x1e7)](_0x4978f0),_0x430d82['status'](0x1f4)[_0x1e1789(0x285)]({'Merror':_0x1e1789(0x24b)});});}catch(_0x23bb72){console[_0x11a403(0x28f)](_0x23bb72);}});function a0_0x5f62(){var _0x43fbe5=['production_date','invoice','$product_details.secondary_code','slice','log','Return\x20Rooms','French','padStart','Receiving\x20Area','</thead>','Portuguese','COLD\x20STORAGE','Product\x20Transfer\x20successfully','$product_details.bin','id_transaction','from_room','</div>','</tr>','$product','/view','There\x27s\x20a\x20error\x20in\x20this\x20transaction','findOne','$product_details.floorlevel','\x20Order\x20Date\x20:\x20','flash','../public/language/languages.json','batch_code','to_bay','createTransport','from_invoice','warehouse','$product_details.product_stock','from_floorlevel','primary_unit','Spanish','from_bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','to_warehouse','staff','$product_details.unit','Email\x20sent\x20successfully','German','$product_details.bay','Ambient','553614zyHpvP','product_code3','$product_details.maxProducts','express','754959PKZpWz','11aKEnbe','prod_cat','Rack\x20F','Transfer\x20Edit\x20Successfully','$to_warehouse','then','$product_details','bay','catch','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','id_transaction_id','Rack\x20E','<span\x20style=\x22float:\x20right;\x22>','\x20</h2>','<h5>','Rack\x20B','</h5>','/barcode_scanner2','toString','$product_details.storage','New_Qty_Converted','storage','from_storage','to_prod_level','$product_details.maxPerUnit','save','English','from_rak','13491792MeEQPb','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','getFullYear','To_invoice','8nNfadH','maxProducts','concat','error','floor','<tr>','to_room','to_bin','string','product_name','email','to_prod_pallet','98czDhGq','5883966LtdBne','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','here','from_prod_level','map','$from_warehouse','edit_transfer','$product_details.invoice','/view/:id','exports','from_room_name','$product_details.product_code','master','<!DOCTYPE\x20html>','8EPnQSd','$product_details._id','push','$product_details.level','to_floorlevel','\x20<>\x20','DRY\x20STORAGE','logo','post','note','Rack\x20C','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','/upload/','/picking_list/PDF_transfer_rm/','render','from_rack','/barcode_scanner3','site_title','from_prod_pallet','date','errors','1247950dqqhHr','Portuguese\x20(BR)','$product_details.type','user','success','product_code','Shelves','type','add_transfer','language','English\x20(US)','bin','$name','$product_details.batch_code','from_bay','transfer','from_prod_isle','redirect','secondary_unit','../middleware/auth','Router','5610820svBSBr','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.pallet','max_per_unit','forEach','maxperunit','host','find','$product_details.rack','Enabled','Logo.png','to_quantity','params','MaxStocks_data2','floorlevel','role','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.production_date','TRF-','updateOne','product_stock','<div>','$date','message','get','findById','prod_name','product_details','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.primary_code','../models/all_models','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/preview/:id','to_room_name','An\x20error\x20occurred.','status','Raw\x20Materials','Transfer\x20Mail','$product_details.product_name','$invoice','/view/add_transfer','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','split','length','</span>','$room','filter','$_id','$product_details.expiry_date','getDate','finalize','Arabic\x20(ae)','getMonth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Error\x20Occurs','nodemailer','/transfer/preview/','<strong>\x20Regards\x20</strong>','Enclosed','to_prod_isle','/barcode_scanner','random','<hr\x20class=\x22my-3\x22>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','body','expiry_date','rak','product','RoomAssigned','from_prod_qty','ToRoomAssigned','rack','unit','243654wbxQdV','to_types','primary_code','</td>','Arabic','</head><body>','$product_details.isle','_id','Rack\x20A','/transfer/view','secondary_code','Level','from_warehouse','</tbody>','2qSnNwU','aggregate','Floor','to_prod_qty','from_types','json','from_quantity','Hindi','True','all','Chinese'];a0_0x5f62=function(){return _0x43fbe5;};return a0_0x5f62();}function BayBinSelected(_0x8b61f,_0x50bb6f){var _0x81cf8f=a0_0x24e80b,_0x290e65=[],_0x597be8=[],_0x198c3c=[],_0x59562e=[],_0x45c71c=[],_0xa986e4=[];let _0x3aa502=[];if(_0x8b61f==_0x81cf8f(0x205))switch(_0x50bb6f){case _0x81cf8f(0x27a):_0x290e65=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x597be8=[0x1,0x2],_0x59562e=[0x1,0x2,0x3,0x4,0x5],_0x198c3c=['Level',_0x81cf8f(0x282)],_0x45c71c=['D'],_0xa986e4=['A'];break;case _0x81cf8f(0x1d3):_0x290e65=[0x6,0x5,0x4,0x3,0x2,0x1],_0x597be8=[0x1,0x2],_0x59562e=[0x1,0x2,0x3,0x4,0x5],_0x198c3c=[_0x81cf8f(0x27d),'Floor'],_0x45c71c=['D'],_0xa986e4=['B'];break;case _0x81cf8f(0x21a):_0x290e65=[0x0],_0x597be8=[0x0],_0x59562e=[0x1,0x2,0x3,0x4,0x5],_0x198c3c=['Floor'],_0x45c71c=['D'],_0xa986e4=['S'];break;case _0x81cf8f(0x293):_0x290e65=[0x0],_0x597be8=[0x0],_0x59562e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x198c3c=[_0x81cf8f(0x282)],_0x45c71c=['D'],_0xa986e4=['R'];break;}else{if(_0x8b61f==_0x81cf8f(0x296))switch(_0x50bb6f){case'Rack\x20A':_0x290e65=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x597be8=['B','F'],_0x59562e=[0x1,0x2,0x3,0x4,0x5],_0x198c3c=['Level',_0x81cf8f(0x282)],_0x45c71c=['C'],_0xa986e4=['A'];break;case'Rack\x20B':_0x290e65=[0x5,0x4,0x3,0x2,0x1],_0x597be8=['F','B','S'],_0x59562e=[0x1,0x2,0x3,0x4,0x5],_0x198c3c=['Level',_0x81cf8f(0x282)],_0x45c71c=['C'],_0xa986e4=['B'];break;case _0x81cf8f(0x209):_0x290e65=[0x1,0x2,0x3,0x4,0x5],_0x597be8=['B','F','S'],_0x59562e=[0x5,0x4,0x3,0x2,0x1],_0x198c3c=[_0x81cf8f(0x27d),_0x81cf8f(0x282)],_0x45c71c=['C'],_0xa986e4=['C'];break;case'Rack\x20D':_0x290e65=[0x5,0x4,0x3,0x2,0x1],_0x597be8=['F','B','S'],_0x59562e=[0x1,0x2,0x3,0x4,0x5],_0x198c3c=[_0x81cf8f(0x27d),_0x81cf8f(0x282)],_0x45c71c=['C'],_0xa986e4=['D'];break;case _0x81cf8f(0x1cf):_0x290e65=[0x4,0x3,0x2,0x1],_0x597be8=[0x1,0x2],_0x59562e=[0x1,0x2,0x3,0x4,0x5],_0x198c3c=[_0x81cf8f(0x27d),_0x81cf8f(0x282)],_0x45c71c=['C'],_0xa986e4=['E'];break;case _0x81cf8f(0x1c5):_0x290e65=[0x1,0x2,0x3],_0x597be8=[0x1,0x2],_0x59562e=[0x1,0x2,0x3,0x4,0x5],_0x198c3c=[_0x81cf8f(0x27d)],_0x45c71c=['C'],_0xa986e4=['F'];break;}}return{'levels':_0x290e65,'Isle':_0x597be8,'rack':_0x59562e,'type':_0x198c3c,'storage':_0x45c71c,'rak':_0xa986e4};}router[a0_0x24e80b(0x241)]('/view/:id',auth,async(_0x5ea0ec,_0x40a526)=>{var _0xe6ac7c=a0_0x24e80b;try{const {username:_0x41928e,email:_0x223524,role:_0x4d9363}=_0x5ea0ec[_0xe6ac7c(0x217)],_0x3e6127=_0x5ea0ec[_0xe6ac7c(0x217)],_0x48a961=await profile[_0xe6ac7c(0x2a0)]({'email':_0x3e6127[_0xe6ac7c(0x1ee)]}),_0x33fdfd=await master_shop[_0xe6ac7c(0x230)](),_0x55c21a=await transfers[_0xe6ac7c(0x242)](_0x5ea0ec['params']['id']);let _0x5b8f53;if(_0x3e6127[_0xe6ac7c(0x238)]==_0xe6ac7c(0x1b8)){const _0x234460=await staff[_0xe6ac7c(0x2a0)]({'email':_0x3e6127[_0xe6ac7c(0x1ee)]});_0x5b8f53=await warehouse[_0xe6ac7c(0x281)]([{'$match':{'status':_0xe6ac7c(0x232),'name':_0x234460[_0xe6ac7c(0x1b0)],'warehouse_category':_0xe6ac7c(0x24d)}},{'$group':{'_id':_0xe6ac7c(0x220),'name':{'$first':_0xe6ac7c(0x220)}}}]);}else _0x5b8f53=await warehouse['aggregate']([{'$match':{'status':_0xe6ac7c(0x232),'warehouse_category':_0xe6ac7c(0x24d)}},{'$group':{'_id':_0xe6ac7c(0x220),'name':{'$first':_0xe6ac7c(0x220)}}}]);const _0x43a216=await warehouse['aggregate']([{'$match':{'name':_0x55c21a[_0xe6ac7c(0x27e)],'warehouse_category':_0xe6ac7c(0x24d)}},{'$unwind':_0xe6ac7c(0x1c9)},{'$group':{'_id':_0xe6ac7c(0x200),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xe6ac7c(0x1b1)},'bay':{'$first':_0xe6ac7c(0x1bc)},'bin':{'$first':_0xe6ac7c(0x298)},'type':{'$first':_0xe6ac7c(0x216)},'floorlevel':{'$first':_0xe6ac7c(0x2a1)},'primary_code':{'$first':_0xe6ac7c(0x246)},'secondary_code':{'$first':_0xe6ac7c(0x28d)},'product_code':{'$first':_0xe6ac7c(0x1fc)},'storage':{'$first':_0xe6ac7c(0x1d7)},'rack':{'$first':_0xe6ac7c(0x231)},'expiry_date':{'$first':_0xe6ac7c(0x259)},'production_date':{'$first':_0xe6ac7c(0x23a)},'room':{'$first':_0xe6ac7c(0x256)}}}]),_0x8d8176=await product['find']({}),_0x25ab4b=BayBinSelected(_0x55c21a[_0xe6ac7c(0x1b7)],_0x55c21a[_0xe6ac7c(0x1ea)]);if(_0x33fdfd[0x0][_0xe6ac7c(0x21d)]==_0xe6ac7c(0x21e)){var _0xcbbce=users['English'];console[_0xe6ac7c(0x28f)](_0xcbbce);}else{if(_0x33fdfd[0x0]['language']=='Hindi')var _0xcbbce=users[_0xe6ac7c(0x287)];else{if(_0x33fdfd[0x0]['language']==_0xe6ac7c(0x1bb))var _0xcbbce=users[_0xe6ac7c(0x1bb)];else{if(_0x33fdfd[0x0][_0xe6ac7c(0x21d)]=='Spanish')var _0xcbbce=users[_0xe6ac7c(0x1b4)];else{if(_0x33fdfd[0x0][_0xe6ac7c(0x21d)]==_0xe6ac7c(0x291))var _0xcbbce=users[_0xe6ac7c(0x291)];else{if(_0x33fdfd[0x0][_0xe6ac7c(0x21d)]==_0xe6ac7c(0x215))var _0xcbbce=users[_0xe6ac7c(0x295)];else{if(_0x33fdfd[0x0]['language']==_0xe6ac7c(0x28a))var _0xcbbce=users[_0xe6ac7c(0x28a)];else{if(_0x33fdfd[0x0]['language']==_0xe6ac7c(0x25c))var _0xcbbce=users[_0xe6ac7c(0x276)];}}}}}}}_0x40a526[_0xe6ac7c(0x20d)](_0xe6ac7c(0x1f7),{'success':_0x5ea0ec[_0xe6ac7c(0x1aa)]('success'),'errors':_0x5ea0ec[_0xe6ac7c(0x1aa)](_0xe6ac7c(0x213)),'role':_0x3e6127,'profile':_0x48a961,'master_shop':_0x33fdfd,'warehouse':_0x5b8f53,'transfer':_0x55c21a,'stock':_0x43a216,'unit':_0x8d8176,'language':_0xcbbce});}catch(_0x4a7abd){console[_0xe6ac7c(0x28f)](_0x4a7abd);}}),router[a0_0x24e80b(0x207)](a0_0x24e80b(0x1f9),auth,async(_0x4beea5,_0x55a251)=>{var _0x29732f=a0_0x24e80b;try{const _0x24f0fd=_0x4beea5[_0x29732f(0x235)]['id'],_0xe33474=await transfers[_0x29732f(0x242)](_0x24f0fd);_0x55a251[_0x29732f(0x285)](_0x4beea5['body']);return;const {date:_0x39f1ee,from_warehouse:_0x3ccfe0,FromRoom_name:_0xf13f9b,to_warehouse:_0x42ead7,ToRoom_name:_0x3af897,prod_name:_0x338fd0,from_prod_qty:_0x41bc8d,from_prod_level:_0x17fa2b,from_prod_isle:_0x1e9159,from_prod_pallet:_0x2112d5,to_prod_qty:_0x24faa2,to_prod_level:_0x409a65,to_prod_isle:_0x31bf11,to_prod_pallet:_0x28375e,primary_code:_0x48a002,secondary_code:_0x590546,product_code3:_0x3a0872,note:_0x5b4008,invoice:_0xde0c75,expiry_date:_0x4d3fe6}=_0x4beea5[_0x29732f(0x269)];if(typeof _0x338fd0==_0x29732f(0x1ec))var _0x8ab25e=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x243)]],_0x123736=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x26e)]],_0x249ad2=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x1f4)]],_0x3ca189=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x224)]],_0x5f4e7b=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x211)]],_0x3c5594=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x284)]],_0x882f6f=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x283)]],_0xfaed7a=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x1db)]],_0x11dcb6=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x264)]],_0xac1bb9=[_0x4beea5[_0x29732f(0x269)]['to_prod_pallet']],_0x373113=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x273)]],_0x22b191=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x1d9)]],_0x4a9b0e=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x26b)]],_0x26a188=[_0x4beea5['body'][_0x29732f(0x274)]],_0x1aaa94=[_0x4beea5[_0x29732f(0x269)]['secondary_code']],_0x15f75c=[_0x4beea5['body'][_0x29732f(0x1bf)]],_0x35bf09=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x236)]],_0x5a8e33=[_0x4beea5['body'][_0x29732f(0x271)]],_0x217281=[_0x4beea5['body'][_0x29732f(0x226)]],_0x109ff8=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x1ac)]],_0x5a7891=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x26a)]],_0x318fc2=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x1da)]],_0x91c21f=[_0x4beea5[_0x29732f(0x269)][_0x29732f(0x1df)]];else var _0x8ab25e=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x243)]],_0x22b191=[..._0x4beea5['body']['storage']],_0x4a9b0e=[..._0x4beea5['body'][_0x29732f(0x26b)]],_0x3c5594=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x284)]],_0x373113=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x273)]],_0x123736=[..._0x4beea5['body'][_0x29732f(0x26e)]],_0x249ad2=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x1f4)]],_0x3ca189=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x224)]],_0x5f4e7b=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x211)]],_0x882f6f=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x283)]],_0xfaed7a=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x1db)]],_0x11dcb6=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x264)]],_0xac1bb9=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x1ef)]],_0x26a188=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x274)]],_0x1aaa94=[..._0x4beea5[_0x29732f(0x269)]['secondary_code']],_0x15f75c=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x1bf)]],_0x35bf09=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x236)]],_0x5a8e33=[..._0x4beea5[_0x29732f(0x269)]['unit']],_0x217281=[..._0x4beea5['body'][_0x29732f(0x226)]],_0x109ff8=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x1ac)]],_0x5a7891=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x26a)]],_0x318fc2=[..._0x4beea5[_0x29732f(0x269)][_0x29732f(0x1da)]],_0x91c21f=[..._0x4beea5['body'][_0x29732f(0x1df)]];const _0xe7a580=_0x8ab25e['map'](_0x4b3d39=>{return _0x4b3d39={'product_name':_0x4b3d39};});_0x123736['forEach']((_0x9c5e23,_0xc2103c)=>{var _0x31e6c8=_0x29732f;_0xe7a580[_0xc2103c][_0x31e6c8(0x286)]=_0x9c5e23;}),_0x249ad2['forEach']((_0xb70e0c,_0xcc937d)=>{_0xe7a580[_0xcc937d]['from_bay']=_0xb70e0c;}),_0x3ca189[_0x29732f(0x22d)]((_0x13504c,_0x6824f8)=>{var _0x34ce68=_0x29732f;_0xe7a580[_0x6824f8][_0x34ce68(0x1b5)]=_0x13504c;}),_0x5f4e7b['forEach']((_0x2ef8ff,_0x170cf6)=>{_0xe7a580[_0x170cf6]['from_floorlevel']=_0x2ef8ff;}),_0x882f6f[_0x29732f(0x22d)]((_0x542f9c,_0x23ed96)=>{var _0x5938f0=_0x29732f;_0xe7a580[_0x23ed96][_0x5938f0(0x234)]=_0x542f9c;}),_0xfaed7a['forEach']((_0x2bda6b,_0x52c766)=>{var _0x5d665c=_0x29732f;_0xe7a580[_0x52c766][_0x5d665c(0x1ad)]=_0x2bda6b;}),_0x11dcb6[_0x29732f(0x22d)]((_0x43253e,_0x232eb4)=>{_0xe7a580[_0x232eb4]['to_bin']=_0x43253e;}),_0xac1bb9[_0x29732f(0x22d)]((_0x180483,_0x544a47)=>{var _0x1fdf18=_0x29732f;_0xe7a580[_0x544a47][_0x1fdf18(0x203)]=_0x180483;}),_0x26a188[_0x29732f(0x22d)]((_0x304d24,_0x5620c5)=>{var _0x1ecb76=_0x29732f;_0xe7a580[_0x5620c5][_0x1ecb76(0x274)]=_0x304d24;}),_0x1aaa94[_0x29732f(0x22d)]((_0x479408,_0x16b45f)=>{var _0x19f281=_0x29732f;_0xe7a580[_0x16b45f][_0x19f281(0x27c)]=_0x479408;}),_0x15f75c[_0x29732f(0x22d)]((_0x1bbf73,_0x24f891)=>{_0xe7a580[_0x24f891]['product_code']=_0x1bbf73;}),_0x35bf09[_0x29732f(0x22d)]((_0x53a819,_0x734f0b)=>{var _0x4081d9=_0x29732f;_0xe7a580[_0x734f0b][_0x4081d9(0x1e5)]=_0x53a819;}),_0x5a8e33[_0x29732f(0x22d)]((_0x2b62c3,_0x223150)=>{var _0x1d8c40=_0x29732f;_0xe7a580[_0x223150][_0x1d8c40(0x271)]=_0x2b62c3;}),_0x217281['forEach']((_0x4c714b,_0x56c7b9)=>{var _0x1f9d24=_0x29732f;_0xe7a580[_0x56c7b9][_0x1f9d24(0x226)]=_0x4c714b;}),_0x109ff8[_0x29732f(0x22d)]((_0x342456,_0x564a87)=>{_0xe7a580[_0x564a87]['batch_code']=_0x342456;}),_0x5a7891[_0x29732f(0x22d)]((_0x1e3d02,_0x191570)=>{var _0x48abc6=_0x29732f;_0xe7a580[_0x191570][_0x48abc6(0x26a)]=_0x1e3d02;}),_0x22b191[_0x29732f(0x22d)]((_0x5690ea,_0x45efdd)=>{var _0x549f16=_0x29732f;_0xe7a580[_0x45efdd][_0x549f16(0x1d9)]=_0x5690ea;}),_0x4a9b0e[_0x29732f(0x22d)]((_0x24b4cb,_0x51cbba)=>{var _0x56b180=_0x29732f;_0xe7a580[_0x51cbba][_0x56b180(0x270)]=_0x24b4cb;}),_0x3c5594[_0x29732f(0x22d)]((_0x1563be,_0x43f201)=>{var _0x20720f=_0x29732f;_0xe7a580[_0x43f201][_0x20720f(0x284)]=_0x1563be;}),_0x373113[_0x29732f(0x22d)]((_0x49e89e,_0x51b8a9)=>{_0xe7a580[_0x51b8a9]['to_types']=_0x49e89e;}),_0x318fc2[_0x29732f(0x22d)]((_0x49ee74,_0x4a4e88)=>{var _0x46ed42=_0x29732f;_0xe7a580[_0x4a4e88][_0x46ed42(0x1da)]=_0x49ee74;}),_0x91c21f[_0x29732f(0x22d)]((_0x3f70c0,_0x5daa16)=>{_0xe7a580[_0x5daa16]['from_rack']=_0x3f70c0;});const _0x4dd9d4=_0xe7a580[_0x29732f(0x257)](_0x261cf8=>_0x261cf8[_0x29732f(0x234)]!=='0'&&_0x261cf8['to_quantity']!==''||_0x261cf8[_0x29732f(0x203)]!=='0'&&_0x261cf8[_0x29732f(0x203)]!=='');var _0x46dd1b=0x0;_0x4dd9d4[_0x29732f(0x22d)](_0xa5df7e=>{var _0x1a9482=_0x29732f;parseInt(_0xa5df7e[_0x1a9482(0x286)])<parseInt(_0xa5df7e['to_quantity'])&&_0x46dd1b++;});if(_0x46dd1b!=0x0)return _0x4beea5['flash'](_0x29732f(0x213),_0x29732f(0x1e1)),_0x55a251[_0x29732f(0x225)]('back');const _0x109aae=await warehouse['findOne']({'name':_0xe33474[_0x29732f(0x27e)],'room':_0xe33474[_0x29732f(0x29a)]});_0xe33474[_0x29732f(0x26c)][_0x29732f(0x22d)](_0x4ae82b=>{var _0x109d08=_0x29732f;if(_0x4ae82b[_0x109d08(0x234)]>0x0){const _0x5624aa=_0x109aae['product_details'][_0x109d08(0x1f5)](_0x32a5a2=>{var _0x21f5f2=_0x109d08;_0x32a5a2[_0x21f5f2(0x1ed)]==_0x4ae82b[_0x21f5f2(0x1ed)]&&_0x32a5a2['floorlevel']==_0x4ae82b[_0x21f5f2(0x1b2)]&&_0x32a5a2[_0x21f5f2(0x21b)]==_0x4ae82b['from_types']&&_0x32a5a2['bin']==_0x4ae82b[_0x21f5f2(0x1b5)]&&_0x32a5a2['bay']==_0x4ae82b[_0x21f5f2(0x222)]&&_0x32a5a2[_0x21f5f2(0x270)]==_0x4ae82b['from_rack']&&_0x32a5a2[_0x21f5f2(0x1d9)]==_0x4ae82b[_0x21f5f2(0x1da)]&&(_0x32a5a2[_0x21f5f2(0x23d)]=parseInt(_0x32a5a2['product_stock'])+parseInt(_0x4ae82b['to_quantity']));});}}),await _0x109aae[_0x29732f(0x1dd)]();const _0x4de3a2=await warehouse['findOne']({'name':_0xe33474[_0x29732f(0x1b7)],'room':_0xe33474[_0x29732f(0x1ea)]});_0xe33474[_0x29732f(0x26c)][_0x29732f(0x22d)](_0x2a83d5=>{var _0x2b7eec=_0x29732f;if(_0x2a83d5[_0x2b7eec(0x234)]>0x0){const _0x5cf4c3=_0x4de3a2['product_details']['map'](_0x537f50=>{var _0x38be73=_0x2b7eec;_0x537f50[_0x38be73(0x1ed)]==_0x2a83d5[_0x38be73(0x1ed)]&&_0x537f50['floorlevel']==_0x2a83d5['to_floorlevel']&&_0x537f50[_0x38be73(0x21b)]==_0x2a83d5['to_types']&&_0x537f50['bin']==_0x2a83d5['to_bin']&&_0x537f50[_0x38be73(0x1ca)]==_0x2a83d5[_0x38be73(0x1ad)]&&_0x537f50[_0x38be73(0x270)]==_0x2a83d5['rack']&&_0x537f50['storage']==_0x2a83d5['storage']&&(_0x537f50[_0x38be73(0x23d)]=parseInt(_0x537f50['product_stock'])-parseInt(_0x2a83d5['to_quantity']));});}}),await _0x4de3a2[_0x29732f(0x1dd)](),_0xe33474[_0x29732f(0x212)]=_0x39f1ee,_0xe33474[_0x29732f(0x27e)]=_0x3ccfe0,_0xe33474['to_warehouse']=_0x42ead7,_0xe33474['product']=_0x4dd9d4,_0xe33474[_0x29732f(0x208)]=_0x5b4008,_0xe33474[_0x29732f(0x28c)]=_0xde0c75;const _0x2e553f=await _0xe33474['save']();console[_0x29732f(0x28f)](_0x2e553f);const _0x3c2366=await warehouse[_0x29732f(0x2a0)]({'name':_0x3ccfe0,'room':_0xf13f9b});_0x2e553f['product'][_0x29732f(0x22d)](_0x442e41=>{var _0x4d2310=_0x29732f;if(_0x442e41[_0x4d2310(0x234)]>0x0){const _0x4c408c=_0x3c2366[_0x4d2310(0x244)][_0x4d2310(0x1f5)](_0x109210=>{var _0x9e1fcf=_0x4d2310;_0x109210[_0x9e1fcf(0x1ed)]==_0x442e41[_0x9e1fcf(0x1ed)]&&_0x109210[_0x9e1fcf(0x237)]==_0x442e41['from_floorlevel']&&_0x109210[_0x9e1fcf(0x21b)]==_0x442e41[_0x9e1fcf(0x284)]&&_0x109210[_0x9e1fcf(0x21f)]==_0x442e41[_0x9e1fcf(0x1b5)]&&_0x109210['bay']==_0x442e41['from_bay']&&_0x109210[_0x9e1fcf(0x270)]==_0x442e41[_0x9e1fcf(0x20e)]&&_0x109210[_0x9e1fcf(0x1d9)]==_0x442e41[_0x9e1fcf(0x1da)]&&(_0x109210[_0x9e1fcf(0x23d)]=parseInt(_0x109210['product_stock'])-parseInt(_0x442e41[_0x9e1fcf(0x234)]));});}}),await _0x3c2366['save']();const _0x320575=await warehouse[_0x29732f(0x2a0)]({'name':_0x42ead7,'room':_0x3af897});_0x2e553f['product'][_0x29732f(0x22d)](_0x56b805=>{var _0x3376e5=_0x29732f;if(_0x56b805[_0x3376e5(0x234)]>0x0){var _0x1d57aa=0x0;const _0x3ba526=_0x320575[_0x3376e5(0x244)][_0x3376e5(0x1f5)](_0x11e917=>{var _0x302bcc=_0x3376e5;_0x11e917[_0x302bcc(0x1ed)]==_0x56b805['product_name']&&_0x11e917[_0x302bcc(0x237)]==_0x56b805['to_floorlevel']&&_0x11e917['type']==_0x56b805[_0x302bcc(0x273)]&&_0x11e917['bin']==_0x56b805[_0x302bcc(0x1eb)]&&_0x11e917[_0x302bcc(0x1ca)]==_0x56b805['to_bay']&&_0x11e917[_0x302bcc(0x270)]==_0x56b805['rack']&&_0x11e917[_0x302bcc(0x1d9)]==_0x56b805[_0x302bcc(0x1d9)]&&(_0x11e917[_0x302bcc(0x23d)]=parseInt(_0x11e917[_0x302bcc(0x23d)])+parseInt(_0x56b805['to_quantity']),_0x1d57aa++);});_0x1d57aa=='0'&&(_0x320575[_0x3376e5(0x244)]=_0x320575[_0x3376e5(0x244)][_0x3376e5(0x1e6)]({'product_name':_0x56b805[_0x3376e5(0x1ed)],'product_stock':_0x56b805[_0x3376e5(0x234)],'bay':_0x56b805['to_bay'],'bin':_0x56b805[_0x3376e5(0x1eb)],'type':_0x56b805[_0x3376e5(0x273)],'floorlevel':_0x56b805['to_floorlevel'],'storage':_0x56b805[_0x3376e5(0x1d9)],'rack':_0x56b805[_0x3376e5(0x270)],'product_code':_0x56b805['product_code'],'primary_code':_0x56b805['primary_code'],'secondary_code':_0x56b805[_0x3376e5(0x27c)],'maxProducts':_0x56b805['maxProducts'],'storage':_0x56b805[_0x3376e5(0x1d9)],'rack':_0x56b805['rack']}));}}),await _0x320575[_0x29732f(0x1dd)](),_0x4beea5['flash']('success',_0x29732f(0x1c6)),_0x55a251[_0x29732f(0x225)](_0x29732f(0x27b));}catch(_0x590d4a){console[_0x29732f(0x28f)](_0x590d4a);}}),router['post'](a0_0x24e80b(0x265),async(_0x4ea372,_0x2268b7)=>{var _0xb7a4ca=a0_0x24e80b;const {FromWareHouse:_0xee4fde,FromRoom:_0x4dc05d,ToWarehouse:_0x1a331a,ToRoom:_0x54845e,primary_code:_0x2b1bc2,Roomslist:_0x414acf}=_0x4ea372['body'],_0x2ea255=_0x414acf[_0xb7a4ca(0x253)](','),_0x1bec29=[];async function _0x132613(_0x319208){var _0x5ae1c5=_0xb7a4ca;const _0xbf5dbe=await warehouse[_0x5ae1c5(0x281)]([{'$match':{'name':_0xee4fde,'room':_0x319208}},{'$unwind':_0x5ae1c5(0x1c9)},{'$match':{'product_details.primary_code':_0x2b1bc2}},{'$group':{'_id':_0x5ae1c5(0x200),'name':{'$first':_0x5ae1c5(0x24f)},'instock':{'$first':_0x5ae1c5(0x1b1)},'primary_code':{'$first':_0x5ae1c5(0x246)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5ae1c5(0x1fc)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x5ae1c5(0x2a1)},'unit':{'$first':_0x5ae1c5(0x1b9)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x5ae1c5(0x1d7)},'rack':{'$first':_0x5ae1c5(0x231)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5ae1c5(0x23a)},'batch_code':{'$first':_0x5ae1c5(0x221)},'maxPerUnit':{'$first':_0x5ae1c5(0x1dc)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x5ae1c5(0x256)},'maxProducts':{'$first':_0x5ae1c5(0x1c0)},'invoice_product':{'$first':_0x5ae1c5(0x1f8)}}}]),_0x50fa47=await warehouse[_0x5ae1c5(0x281)]([{'$match':{'name':_0xee4fde,'room':_0x319208}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2b1bc2}},{'$group':{'_id':_0x5ae1c5(0x200),'name':{'$first':_0x5ae1c5(0x24f)},'instock':{'$first':_0x5ae1c5(0x1b1)},'primary_code':{'$first':_0x5ae1c5(0x246)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5ae1c5(0x1fc)},'level':{'$first':_0x5ae1c5(0x1bc)},'isle':{'$first':_0x5ae1c5(0x298)},'type':{'$first':_0x5ae1c5(0x216)},'pallet':{'$first':_0x5ae1c5(0x2a1)},'unit':{'$first':_0x5ae1c5(0x1b9)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x5ae1c5(0x1d7)},'rack':{'$first':_0x5ae1c5(0x231)},'expiry_date':{'$first':_0x5ae1c5(0x259)},'production_date':{'$first':_0x5ae1c5(0x23a)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x5ae1c5(0x1dc)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x5ae1c5(0x256)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x5ae1c5(0x1f8)}}}]);if(_0xbf5dbe[_0x5ae1c5(0x254)]>0x0)_0x1bec29[_0x5ae1c5(0x201)](_0xbf5dbe);else _0x50fa47['length']>0x0&&_0x1bec29[_0x5ae1c5(0x201)](_0x50fa47);}const _0x49b7b8=_0x2ea255[_0xb7a4ca(0x1f5)](_0x119930=>_0x132613(_0x119930));await Promise['all'](_0x49b7b8),_0x2268b7[_0xb7a4ca(0x285)](_0x1bec29);}),router[a0_0x24e80b(0x207)](a0_0x24e80b(0x1d5),async(_0x13800e,_0x27d2e4)=>{var _0x37b3e8=a0_0x24e80b;try{const {FromWareHouse:_0x24406c,FromRoom:_0x1cf6f9,ToWarehouse:_0x1a26e0,ToRoom:_0x520924,secondary_code:_0x3a7198}=_0x13800e[_0x37b3e8(0x269)],_0x18f26f=await warehouse[_0x37b3e8(0x281)]([{'$match':{'name':_0x24406c}},{'$unwind':_0x37b3e8(0x1c9)},{'$match':{'product_details.secondary_code':_0x3a7198}},{'$group':{'_id':_0x37b3e8(0x200),'name':{'$first':_0x37b3e8(0x24f)},'primary_code':{'$first':_0x37b3e8(0x246)},'secondary_code':{'$first':_0x37b3e8(0x28d)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x37b3e8(0x1b1)},'warehouse':{'$first':_0x37b3e8(0x220)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x37b3e8(0x1c0)},'unit':{'$first':_0x37b3e8(0x1b9)}}}]);_0x27d2e4[_0x37b3e8(0x24c)](0xc8)['json'](_0x18f26f);}catch(_0x5474ec){_0x27d2e4[_0x37b3e8(0x24c)](0x194)[_0x37b3e8(0x285)]({'message':_0x5474ec[_0x37b3e8(0x240)]});}}),router[a0_0x24e80b(0x207)](a0_0x24e80b(0x20f),async(_0x40349d,_0x233682)=>{var _0x185a63=a0_0x24e80b;try{const {FromWareHouse:_0x2e4edf,FromRoom:_0x21ca1c,ToWarehouse:_0x17c85e,ToRoom:_0x316f4a,product_code:_0x49e48c}=_0x40349d['body'],_0x37e969=await warehouse['aggregate']([{'$match':{'name':_0x2e4edf}},{'$unwind':_0x185a63(0x1c9)},{'$match':{'product_details.product_code':_0x49e48c}},{'$group':{'_id':_0x185a63(0x200),'name':{'$first':_0x185a63(0x24f)},'primary_code':{'$first':_0x185a63(0x246)},'secondary_code':{'$first':_0x185a63(0x28d)},'product_code':{'$first':_0x185a63(0x1fc)},'instock':{'$first':_0x185a63(0x1b1)},'warehouse':{'$first':'$name'},'level':{'$first':_0x185a63(0x202)},'isle':{'$first':_0x185a63(0x278)},'pallet':{'$first':_0x185a63(0x22b)},'maxProducts':{'$first':_0x185a63(0x1c0)},'unit':{'$first':'$product_details.unit'}}}]);_0x233682[_0x185a63(0x24c)](0xc8)[_0x185a63(0x285)](_0x37e969);}catch(_0x996d41){_0x233682['status'](0x194)[_0x185a63(0x285)]({'message':_0x996d41['message']});}}),router[a0_0x24e80b(0x207)]('/CheckingWarehouse',async(_0x20f804,_0x32dc06)=>{var _0x5bac1e=a0_0x24e80b;const {level:_0x3c77f3,isle:_0x23817d,pallet:_0x196a8d,warehouses:_0x2ec05e,room:_0x2c74f6}=_0x20f804[_0x5bac1e(0x269)];try{const _0x48a178=await warehouse[_0x5bac1e(0x281)]([{'$match':{'name':_0x2ec05e,'room':_0x2c74f6}},{'$unwind':_0x5bac1e(0x1c9)},{'$match':{'product_details.level':parseInt(_0x3c77f3),'product_details.isle':_0x23817d,'product_details.pallet':parseInt(_0x196a8d)}},{'$group':{'_id':_0x5bac1e(0x200),'name':{'$first':_0x5bac1e(0x24f)},'product_stock':{'$first':_0x5bac1e(0x1b1)},'level':{'$first':_0x5bac1e(0x202)},'isle':{'$first':_0x5bac1e(0x278)},'pallet':{'$first':_0x5bac1e(0x22b)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x32dc06[_0x5bac1e(0x24c)](0xc8)[_0x5bac1e(0x285)](_0x48a178);}catch(_0x5738ed){_0x32dc06[_0x5bac1e(0x24c)](0x194)[_0x5bac1e(0x285)]({'message':_0x5738ed[_0x5bac1e(0x240)]});}}),module[a0_0x24e80b(0x1fa)]=router;