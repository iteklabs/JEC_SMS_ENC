var a0_0x2e9814=a0_0x222d;(function(_0xcfc88c,_0x22acff){var _0x1a01be=a0_0x222d,_0x676018=_0xcfc88c();while(!![]){try{var _0x38bcf4=-parseInt(_0x1a01be(0x1a5))/0x1*(-parseInt(_0x1a01be(0x138))/0x2)+-parseInt(_0x1a01be(0x1cf))/0x3+-parseInt(_0x1a01be(0x131))/0x4+-parseInt(_0x1a01be(0x1d1))/0x5+parseInt(_0x1a01be(0x1d4))/0x6*(-parseInt(_0x1a01be(0x1ca))/0x7)+-parseInt(_0x1a01be(0x116))/0x8*(parseInt(_0x1a01be(0x177))/0x9)+-parseInt(_0x1a01be(0x1ab))/0xa*(-parseInt(_0x1a01be(0x12e))/0xb);if(_0x38bcf4===_0x22acff)break;else _0x676018['push'](_0x676018['shift']());}catch(_0x593efd){_0x676018['push'](_0x676018['shift']());}}}(a0_0x5334,0xf12d8));const express=require(a0_0x2e9814(0x123)),app=express(),router=express[a0_0x2e9814(0x11d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x2e9814(0x1ae)),auth=require(a0_0x2e9814(0x139)),users=require(a0_0x2e9814(0x196)),nodemailer=require('nodemailer');function a0_0x222d(_0x1aef96,_0xa7bb5){var _0x53347e=a0_0x5334();return a0_0x222d=function(_0x222d2a,_0x5b5e72){_0x222d2a=_0x222d2a-0xef;var _0x9eb3c5=_0x53347e[_0x222d2a];return _0x9eb3c5;},a0_0x222d(_0x1aef96,_0xa7bb5);}router[a0_0x2e9814(0x180)]('/view',auth,async(_0x5d2721,_0x3e8e47)=>{var _0x3b6184=a0_0x2e9814;try{const {username:_0x20fd8e,email:_0x550c19,role:_0x233082}=_0x5d2721['user'],_0x486c8a=_0x5d2721['user'],_0x105cf0=await profile[_0x3b6184(0x19a)]({'email':_0x486c8a[_0x3b6184(0x16b)]}),_0x2b0b41=await master_shop[_0x3b6184(0x1dd)]();console['log'](_0x3b6184(0x181),_0x2b0b41);let _0x28e24b;if(_0x486c8a[_0x3b6184(0x12a)]==_0x3b6184(0x161)){const _0x23e7dd=await staff['findOne']({'email':_0x486c8a[_0x3b6184(0x16b)]});_0x28e24b=await transfers[_0x3b6184(0x1dd)]({'from_warehouse':_0x23e7dd[_0x3b6184(0x152)]});}else _0x28e24b=await transfers[_0x3b6184(0x149)]([{'$unwind':_0x3b6184(0x1e1)},{'$group':{'_id':_0x3b6184(0x17b),'invoice':{'$first':'$invoice'},'date':{'$first':_0x3b6184(0x1aa)},'from_warehouse':{'$first':_0x3b6184(0x1b2)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x3b6184(0x16e)},'to_room_name':{'$addToSet':_0x3b6184(0x1cd)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x3b6184(0x128)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2b0b41[0x0][_0x3b6184(0x18e)]=='English\x20(US)'){var _0x5ec4d3=users[_0x3b6184(0x1b6)];console['log'](_0x5ec4d3);}else{if(_0x2b0b41[0x0][_0x3b6184(0x18e)]==_0x3b6184(0x1cb))var _0x5ec4d3=users[_0x3b6184(0x1cb)];else{if(_0x2b0b41[0x0]['language']==_0x3b6184(0x1b8))var _0x5ec4d3=users[_0x3b6184(0x1b8)];else{if(_0x2b0b41[0x0]['language']==_0x3b6184(0x13b))var _0x5ec4d3=users[_0x3b6184(0x13b)];else{if(_0x2b0b41[0x0][_0x3b6184(0x18e)]==_0x3b6184(0x1bf))var _0x5ec4d3=users[_0x3b6184(0x1bf)];else{if(_0x2b0b41[0x0][_0x3b6184(0x18e)]==_0x3b6184(0x11f))var _0x5ec4d3=users['Portuguese'];else{if(_0x2b0b41[0x0][_0x3b6184(0x18e)]==_0x3b6184(0x109))var _0x5ec4d3=users[_0x3b6184(0x109)];else{if(_0x2b0b41[0x0][_0x3b6184(0x18e)]==_0x3b6184(0x1c9))var _0x5ec4d3=users['Arabic'];}}}}}}}_0x3e8e47[_0x3b6184(0x15a)](_0x3b6184(0x13d),{'success':_0x5d2721[_0x3b6184(0x155)](_0x3b6184(0x192)),'errors':_0x5d2721[_0x3b6184(0x155)](_0x3b6184(0x194)),'role':_0x486c8a,'profile':_0x105cf0,'master_shop':_0x2b0b41,'transfer':_0x28e24b,'language':_0x5ec4d3});}catch(_0x2efebc){console[_0x3b6184(0x126)](_0x2efebc);}});async function getRandom8DigitNumber(){var _0x1cc729=a0_0x2e9814;const _0x332fc5=0x989680,_0x482eb0=0x5f5e0ff,_0x422829=Math[_0x1cc729(0xf0)](Math[_0x1cc729(0x124)]()*(_0x482eb0-_0x332fc5+0x1))+_0x332fc5;var _0x5de807;const _0x10fa80=await transfers[_0x1cc729(0x19a)]({'invoice':_0x1cc729(0x1d0)+_0x422829});return _0x10fa80&&_0x10fa80[_0x1cc729(0x10c)]>0x0?_0x5de807=_0x1cc729(0x1d0)+_0x422829:_0x5de807=_0x1cc729(0x1d0)+_0x422829,_0x5de807;}router['get'](a0_0x2e9814(0x1dc),auth,async(_0x34760e,_0x2fbf41)=>{var _0x36128e=a0_0x2e9814;try{const {username:_0x425a5c,email:_0x2db785,role:_0x4a3e61}=_0x34760e['user'],_0x3ff7e6=_0x34760e[_0x36128e(0x11c)],_0x216b01=await profile['findOne']({'email':_0x3ff7e6[_0x36128e(0x16b)]}),_0x425198=await master_shop[_0x36128e(0x1dd)]();console['log']('master',_0x425198);let _0x21a9f7;if(_0x3ff7e6[_0x36128e(0x12a)]==_0x36128e(0x161)){const _0x3dfc6a=await staff[_0x36128e(0x19a)]({'email':_0x3ff7e6[_0x36128e(0x16b)]});_0x21a9f7=await warehouse[_0x36128e(0x149)]([{'$match':{'status':'Enabled','name':_0x3dfc6a[_0x36128e(0x152)],'warehouse_category':_0x36128e(0x17a)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x21a9f7=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x36128e(0x17a)}},{'$group':{'_id':'$name','name':{'$first':_0x36128e(0x13e)}}}]);var _0x347803=[_0x36128e(0x1c6),_0x36128e(0x10d),'Return\x20Rooms'];const _0x22a2ad=await transfers[_0x36128e(0x1dd)]({}),_0x2aad66=_0x22a2ad[_0x36128e(0x10c)]+0x1,_0x3b5552=_0x36128e(0x1d0)+_0x2aad66[_0x36128e(0x12c)]()[_0x36128e(0x198)](0x5,'0');if(_0x425198[0x0][_0x36128e(0x18e)]==_0x36128e(0x1d7)){var _0x3ca123=users[_0x36128e(0x1b6)];console[_0x36128e(0x126)](_0x3ca123);}else{if(_0x425198[0x0][_0x36128e(0x18e)]==_0x36128e(0x1cb))var _0x3ca123=users[_0x36128e(0x1cb)];else{if(_0x425198[0x0]['language']==_0x36128e(0x1b8))var _0x3ca123=users['German'];else{if(_0x425198[0x0][_0x36128e(0x18e)]==_0x36128e(0x13b))var _0x3ca123=users[_0x36128e(0x13b)];else{if(_0x425198[0x0][_0x36128e(0x18e)]==_0x36128e(0x1bf))var _0x3ca123=users[_0x36128e(0x1bf)];else{if(_0x425198[0x0][_0x36128e(0x18e)]==_0x36128e(0x11f))var _0x3ca123=users['Portuguese'];else{if(_0x425198[0x0][_0x36128e(0x18e)]==_0x36128e(0x109))var _0x3ca123=users[_0x36128e(0x109)];else{if(_0x425198[0x0][_0x36128e(0x18e)]=='Arabic\x20(ae)')var _0x3ca123=users[_0x36128e(0x185)];}}}}}}}const _0x480aef=getRandom8DigitNumber();_0x480aef[_0x36128e(0x114)](_0x226666=>{var _0x4abbec=_0x36128e;_0x2fbf41[_0x4abbec(0x15a)](_0x4abbec(0x136),{'success':_0x34760e[_0x4abbec(0x155)](_0x4abbec(0x192)),'errors':_0x34760e[_0x4abbec(0x155)](_0x4abbec(0x194)),'role':_0x3ff7e6,'profile':_0x216b01,'master_shop':_0x425198,'warehouse':_0x21a9f7,'language':_0x3ca123,'rooms_data':_0x347803,'invoice':_0x226666});})[_0x36128e(0x1db)](_0x405887=>{var _0x2b7459=_0x36128e;_0x34760e[_0x2b7459(0x155)]('errors',_0x2b7459(0x163)),_0x2fbf41['redirect']('/transfer/view');});}catch(_0x53a6b8){console[_0x36128e(0x126)](_0x53a6b8);}}),router[a0_0x2e9814(0xef)](a0_0x2e9814(0x1dc),auth,async(_0x13042b,_0x47d08f)=>{var _0x55c661=a0_0x2e9814;try{console[_0x55c661(0x126)](_0x13042b[_0x55c661(0xf5)]);const {date:_0x5ab535,from_warehouse:_0x318f18,FromRoom_name:_0x1f47ce,to_warehouse:_0x41a736,ToRoom_name:_0xc73d7c,prod_name:_0x2410a8,from_prod_qty:_0x244ca8,from_prod_level:_0x1f34d7,from_prod_isle:_0xdf27dc,from_prod_pallet:_0x3076fb,to_prod_qty:_0x3afb53,to_prod_level:_0x54b4ea,to_prod_isle:_0x33c703,to_prod_pallet:_0x4671b5,primary_code:_0x579c6f,secondary_code:_0x4437d6,product_code3:_0x215279,note:_0x582d53,MaxStocks_data2:_0x4ffa55,invoice:_0x7cfed5,expiry_date:_0x395509}=_0x13042b['body'];if(typeof _0x2410a8=='string')var _0x3d598f=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x101)]],_0x5392d2=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x13a)]],_0x5586b1=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x1c1)]],_0x33fc0f=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x118)]],_0x20be21=[_0x13042b['body'][_0x55c661(0x18c)]],_0x46c9b8=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x121)]],_0x481b46=[_0x13042b['body'][_0x55c661(0x199)]],_0x31f306=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0xfb)]],_0x134456=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x130)]],_0x572de2=[_0x13042b[_0x55c661(0xf5)]['primary_unit']],_0x2eb528=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x1bb)]],_0x1542c9=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x179)]],_0xcc1fbb=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x100)]],_0x349e2b=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x178)]],_0x34f32e=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x107)]],_0x378ec5=[_0x13042b['body'][_0x55c661(0x188)]],_0x1ecebc=[_0x13042b[_0x55c661(0xf5)]['RoomAssigned']],_0x88de66=[_0x13042b[_0x55c661(0xf5)]['ToRoomAssigned']],_0xd88dce=[_0x13042b['body'][_0x55c661(0x10b)]],_0x20715e=[_0x13042b['body']['to_invoice']],_0x1ca9ee=[_0x13042b[_0x55c661(0xf5)][_0x55c661(0x13c)]];else var _0x3d598f=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x101)]],_0x5392d2=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x13a)]],_0x5586b1=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x1c1)]],_0x33fc0f=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x118)]],_0x20be21=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x18c)]],_0x46c9b8=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x121)]],_0x481b46=[..._0x13042b[_0x55c661(0xf5)]['secondary_code']],_0x31f306=[..._0x13042b[_0x55c661(0xf5)]['product_code3']],_0x134456=[..._0x13042b['body']['MaxStocks_data2']],_0x572de2=[..._0x13042b['body']['primary_unit']],_0x2eb528=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x1bb)]],_0x1542c9=[..._0x13042b[_0x55c661(0xf5)]['batch_code']],_0xcc1fbb=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x100)]],_0x349e2b=[..._0x13042b[_0x55c661(0xf5)]['max_per_unit']],_0x34f32e=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x107)]],_0x378ec5=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x188)]],_0x1ecebc=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x1b4)]],_0x88de66=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x10e)]],_0xd88dce=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x10b)]],_0x20715e=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x175)]],_0x1ca9ee=[..._0x13042b[_0x55c661(0xf5)][_0x55c661(0x13c)]];const _0x2e3591=_0x3d598f[_0x55c661(0x1a7)](_0x15aa2a=>{return _0x15aa2a={'product_name':_0x15aa2a};});_0x5392d2[_0x55c661(0x18d)]((_0x62a2c4,_0x530029)=>{var _0x434e9d=_0x55c661;_0x2e3591[_0x530029][_0x434e9d(0x14c)]=_0x62a2c4;}),_0xd88dce[_0x55c661(0x18d)]((_0x3f29ff,_0x22557c)=>{var _0x859387=_0x55c661;_0x2e3591[_0x22557c][_0x859387(0x10b)]=_0x3f29ff;}),_0x20715e[_0x55c661(0x18d)]((_0x238065,_0x99575d)=>{var _0x3ebbbc=_0x55c661;_0x2e3591[_0x99575d][_0x3ebbbc(0x162)]=_0x238065;}),_0x1ca9ee[_0x55c661(0x18d)]((_0x36ded9,_0x11cd76)=>{var _0x197b13=_0x55c661;_0x2e3591[_0x11cd76][_0x197b13(0x164)]=_0x36ded9;}),_0x5586b1[_0x55c661(0x18d)]((_0xf5c05e,_0x5dea38)=>{var _0x3a22d7=_0x55c661;_0x1ecebc[_0x3a22d7(0x18d)]((_0x50b004,_0x1ef620)=>{var _0x3e30a8=_0x3a22d7;if(_0x50b004==_0x3e30a8(0x103)&&_0x5dea38==_0x1ef620){var _0xf63b47=_0xf5c05e['slice'](0x3);_0x2e3591[_0x5dea38][_0x3e30a8(0x1d5)]=_0xf5c05e[0x0],_0x2e3591[_0x5dea38]['from_rack']=_0xf5c05e[0x1],_0x2e3591[_0x5dea38][_0x3e30a8(0x15f)]=0x0,_0x2e3591[_0x5dea38][_0x3e30a8(0x140)]=0x0,_0x2e3591[_0x5dea38]['from_types']=_0x3e30a8(0x16a),_0x2e3591[_0x5dea38]['from_floorlevel']=_0xf63b47;}else{if(_0x50b004==_0x3e30a8(0x1a8)&&_0x5dea38==_0x1ef620){var _0xf63b47=_0xf5c05e[_0x3e30a8(0x110)](0x3);_0x2e3591[_0x5dea38][_0x3e30a8(0x1d5)]=_0xf5c05e[0x0],_0x2e3591[_0x5dea38]['from_rack']=_0xf5c05e[0x1],_0x2e3591[_0x5dea38]['from_bay']=0x0,_0x2e3591[_0x5dea38][_0x3e30a8(0x140)]=0x0,_0x2e3591[_0x5dea38][_0x3e30a8(0x1d3)]='Floor',_0x2e3591[_0x5dea38][_0x3e30a8(0x189)]=_0xf5c05e[0x5];}else{if(_0x5dea38==_0x1ef620){if(_0xf5c05e[0x0]=='A'&&_0xf5c05e[0x1]=='L'&&_0xf5c05e[0x2]=='L')console['log'](_0x50b004+'\x20<>\x20'+_0x5dea38+_0x3e30a8(0x176)+_0x1ef620+'\x20<>\x20'+_0xf5c05e+_0x3e30a8(0x151)),_0x2e3591[_0x5dea38]['from_storage']=_0xf5c05e[0x0],_0x2e3591[_0x5dea38]['from_rack']=_0xf5c05e[0x1],_0x2e3591[_0x5dea38][_0x3e30a8(0x15f)]=0x0,_0x2e3591[_0x5dea38][_0x3e30a8(0x140)]=0x0,_0x2e3591[_0x5dea38][_0x3e30a8(0x1d3)]=_0x3e30a8(0x16a),_0x2e3591[_0x5dea38][_0x3e30a8(0x189)]=_0xf5c05e[0x3];else{var _0x20d379;if(_0xf5c05e[0x4]=='L')_0x20d379=_0x3e30a8(0x166);else _0xf5c05e[0x4]=='F'&&(_0x20d379=_0x3e30a8(0x16a));_0x2e3591[_0x5dea38][_0x3e30a8(0x1d5)]=_0xf5c05e[0x0],_0x2e3591[_0x5dea38][_0x3e30a8(0x112)]=_0xf5c05e[0x1],_0x2e3591[_0x5dea38][_0x3e30a8(0x15f)]=_0xf5c05e[0x2],_0x2e3591[_0x5dea38][_0x3e30a8(0x140)]=_0xf5c05e[0x3],_0x2e3591[_0x5dea38][_0x3e30a8(0x1d3)]=_0x20d379,_0x2e3591[_0x5dea38][_0x3e30a8(0x189)]=_0xf5c05e[0x5];}}}}});}),_0x33fc0f[_0x55c661(0x18d)]((_0x4ad2a8,_0x17d96d)=>{var _0x51d026=_0x55c661;_0x2e3591[_0x17d96d][_0x51d026(0x174)]=_0x4ad2a8;}),_0x20be21[_0x55c661(0x18d)]((_0x180101,_0xdf5009)=>{_0x88de66['forEach']((_0x176d40,_0x4e8c69)=>{var _0x3ec1e5=a0_0x222d;if(_0x176d40==_0x3ec1e5(0x103)&&_0xdf5009==_0x4e8c69){var _0x4bfc52=_0x180101[_0x3ec1e5(0x110)](0x3);_0x2e3591[_0xdf5009][_0x3ec1e5(0x10a)]=_0x180101[0x0],_0x2e3591[_0xdf5009][_0x3ec1e5(0x1c2)]=_0x180101[0x1],_0x2e3591[_0xdf5009]['to_bay']=0x0,_0x2e3591[_0xdf5009]['to_bin']=0x0,_0x2e3591[_0xdf5009][_0x3ec1e5(0x11e)]='Floor',_0x2e3591[_0xdf5009][_0x3ec1e5(0x1a9)]=_0x4bfc52;}else{if(_0x176d40==_0x3ec1e5(0x1a8)&&_0xdf5009==_0x4e8c69){var _0x4bfc52=_0x180101[_0x3ec1e5(0x110)](0x3);_0x2e3591[_0xdf5009][_0x3ec1e5(0x10a)]=_0x180101[0x0],_0x2e3591[_0xdf5009][_0x3ec1e5(0x1c2)]=_0x180101[0x1],_0x2e3591[_0xdf5009][_0x3ec1e5(0x133)]=0x0,_0x2e3591[_0xdf5009][_0x3ec1e5(0x150)]=0x0,_0x2e3591[_0xdf5009]['to_types']='Floor',_0x2e3591[_0xdf5009]['to_floorlevel']=_0x180101[0x5];}else{if(_0xdf5009==_0x4e8c69){if(_0x180101[0x0]=='A'&&_0x180101[0x1]=='L'&&_0x180101[0x2]=='L')console[_0x3ec1e5(0x126)](_0x176d40+_0x3ec1e5(0x176)+_0xdf5009+'\x20<>\x20'+_0x4e8c69+'\x20<>\x20'+_0x180101+_0x3ec1e5(0x151)),_0x2e3591[_0xdf5009][_0x3ec1e5(0x10a)]=_0x180101[0x0],_0x2e3591[_0xdf5009]['rack']=_0x180101[0x1],_0x2e3591[_0xdf5009][_0x3ec1e5(0x133)]=0x0,_0x2e3591[_0xdf5009][_0x3ec1e5(0x150)]=0x0,_0x2e3591[_0xdf5009]['to_types']='Floor',_0x2e3591[_0xdf5009]['to_floorlevel']=_0x180101[0x3];else{var _0x353b02;if(_0x180101[0x4]=='L')_0x353b02='Level';else _0x180101[0x4]=='F'&&(_0x353b02='Floor');_0x2e3591[_0xdf5009][_0x3ec1e5(0x10a)]=_0x180101[0x0],_0x2e3591[_0xdf5009][_0x3ec1e5(0x1c2)]=_0x180101[0x1],_0x2e3591[_0xdf5009][_0x3ec1e5(0x133)]=_0x180101[0x2],_0x2e3591[_0xdf5009][_0x3ec1e5(0x150)]=_0x180101[0x3],_0x2e3591[_0xdf5009][_0x3ec1e5(0x11e)]=_0x353b02,_0x2e3591[_0xdf5009][_0x3ec1e5(0x1a9)]=_0x180101[0x5];}}}}});}),_0x46c9b8['forEach']((_0x3265a9,_0x204cbc)=>{_0x2e3591[_0x204cbc]['primary_code']=_0x3265a9;}),_0x481b46[_0x55c661(0x18d)]((_0x918a24,_0x2b4ef6)=>{var _0x4c07d0=_0x55c661;_0x2e3591[_0x2b4ef6][_0x4c07d0(0x199)]=_0x918a24;}),_0x31f306[_0x55c661(0x18d)]((_0x5ad42a,_0x9102ff)=>{var _0x5bb688=_0x55c661;_0x2e3591[_0x9102ff][_0x5bb688(0x1bd)]=_0x5ad42a;}),_0x134456[_0x55c661(0x18d)]((_0x17f610,_0x2c4be9)=>{var _0x399ce1=_0x55c661;_0x2e3591[_0x2c4be9][_0x399ce1(0x183)]=_0x17f610;}),_0x572de2[_0x55c661(0x18d)]((_0x18ffa0,_0x32bd78)=>{var _0x3eebf7=_0x55c661;_0x2e3591[_0x32bd78][_0x3eebf7(0x14e)]=_0x18ffa0;}),_0x2eb528[_0x55c661(0x18d)]((_0x290b92,_0x382276)=>{var _0x535d5b=_0x55c661;_0x2e3591[_0x382276][_0x535d5b(0x1bb)]=_0x290b92;}),_0x1542c9[_0x55c661(0x18d)]((_0x283fbe,_0x4ff230)=>{var _0x3255c1=_0x55c661;_0x2e3591[_0x4ff230][_0x3255c1(0x179)]=_0x283fbe;}),_0xcc1fbb['forEach']((_0x19f437,_0x2c2862)=>{var _0x75d6d2=_0x55c661;_0x2e3591[_0x2c2862][_0x75d6d2(0x100)]=_0x19f437;}),_0x349e2b[_0x55c661(0x18d)]((_0x47554c,_0x24812b)=>{var _0x33d48c=_0x55c661;_0x2e3591[_0x24812b][_0x33d48c(0x1ba)]=_0x47554c;}),_0x34f32e['forEach']((_0x1cc252,_0x369b3b)=>{var _0x39f472=_0x55c661;_0x2e3591[_0x369b3b][_0x39f472(0x107)]=_0x1cc252;}),_0x378ec5[_0x55c661(0x18d)]((_0x132485,_0x166907)=>{var _0x64353d=_0x55c661;_0x2e3591[_0x166907][_0x64353d(0x188)]=_0x132485;}),_0x1ecebc['forEach']((_0x31808b,_0x869f73)=>{var _0x504d82=_0x55c661;_0x2e3591[_0x869f73][_0x504d82(0x12b)]=_0x31808b;}),_0x88de66[_0x55c661(0x18d)]((_0x4f47d1,_0x13b9f5)=>{var _0x355baf=_0x55c661;_0x2e3591[_0x13b9f5][_0x355baf(0x1c3)]=_0x4f47d1;});const _0x23967e=_0x2e3591['filter'](_0x597071=>_0x597071[_0x55c661(0x174)]!=='0'&&_0x597071[_0x55c661(0x174)]!==''||_0x597071['to_floorlevel']!=='0'&&_0x597071[_0x55c661(0x1a9)]!==''),_0x196b91=new transfers({'date':_0x5ab535,'from_warehouse':_0x318f18,'to_warehouse':_0x41a736,'product':_0x23967e,'note':_0x582d53,'invoice':_0x7cfed5}),_0xf48059=await _0x196b91[_0x55c661(0x19c)]();_0x13042b[_0x55c661(0x155)]('success',_0x55c661(0x15c)),_0x47d08f[_0x55c661(0x187)]('/transfer/preview/'+_0xf48059[_0x55c661(0x172)]);}catch(_0x2d418d){console[_0x55c661(0x126)](_0x2d418d),_0x47d08f[_0x55c661(0xf9)](0xc8)[_0x55c661(0x132)]({'errorMessage':_0x2d418d[_0x55c661(0x1b5)]});}}),router[a0_0x2e9814(0x180)](a0_0x2e9814(0x142),auth,async(_0x213172,_0x220a06)=>{var _0x207e59=a0_0x2e9814;try{const {username:_0xf75608,email:_0x40ce3b,role:_0x3b62ec}=_0x213172['user'],_0x20999b=_0x213172[_0x207e59(0x11c)],_0x514265=await profile[_0x207e59(0x19a)]({'email':_0x20999b[_0x207e59(0x16b)]}),_0x28ebb8=await master_shop[_0x207e59(0x1dd)]();console[_0x207e59(0x126)](_0x207e59(0x181),_0x28ebb8);const _0x486153=await transfers['findById'](_0x213172[_0x207e59(0x17f)]['id']);let _0x42bb75=new Date(_0x486153[_0x207e59(0x100)]),_0x386feb=('0'+_0x42bb75[_0x207e59(0xf3)]())[_0x207e59(0x110)](-0x2),_0x260718=('0'+(_0x42bb75['getMonth']()+0x1))[_0x207e59(0x110)](-0x2),_0x380396=_0x42bb75[_0x207e59(0x1a0)](),_0x37baab=_0x380396+'-'+_0x260718+'-'+_0x386feb,_0x2dd8eb;if(_0x20999b[_0x207e59(0x12a)]==_0x207e59(0x161)){const _0x3b6c75=await staff[_0x207e59(0x19a)]({'email':_0x20999b[_0x207e59(0x16b)]});_0x2dd8eb=await warehouse['find']({'status':_0x207e59(0x113),'name':_0x3b6c75[_0x207e59(0x152)],'warehouse_category':_0x207e59(0x17a)});}else _0x2dd8eb=await warehouse[_0x207e59(0x1dd)]({'status':'Enabled','warehouse_category':_0x207e59(0x17a)});const _0xcd6f9=await warehouse[_0x207e59(0x149)]([{'$match':{'name':_0x486153[_0x207e59(0x190)]}},{'$unwind':_0x207e59(0x168)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x207e59(0x156)},'product_stock':{'$first':_0x207e59(0x135)},'bay':{'$first':_0x207e59(0x1e0)},'bin':{'$first':_0x207e59(0xf2)},'type':{'$first':_0x207e59(0x19d)},'floorlevel':{'$first':_0x207e59(0x171)},'primary_code':{'$first':_0x207e59(0x119)},'secondary_code':{'$first':_0x207e59(0x15e)},'product_code':{'$first':_0x207e59(0x1b3)},'storage':{'$first':_0x207e59(0x18a)},'rack':{'$first':_0x207e59(0xfa)},'expiry_date':{'$first':_0x207e59(0x1ce)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x207e59(0x14d)}}}]);if(_0x28ebb8[0x0][_0x207e59(0x18e)]==_0x207e59(0x1d7)){var _0x2d8cf8=users[_0x207e59(0x1b6)];console[_0x207e59(0x126)](_0x2d8cf8);}else{if(_0x28ebb8[0x0]['language']==_0x207e59(0x1cb))var _0x2d8cf8=users[_0x207e59(0x1cb)];else{if(_0x28ebb8[0x0]['language']==_0x207e59(0x1b8))var _0x2d8cf8=users[_0x207e59(0x1b8)];else{if(_0x28ebb8[0x0][_0x207e59(0x18e)]==_0x207e59(0x13b))var _0x2d8cf8=users[_0x207e59(0x13b)];else{if(_0x28ebb8[0x0][_0x207e59(0x18e)]=='French')var _0x2d8cf8=users[_0x207e59(0x1bf)];else{if(_0x28ebb8[0x0][_0x207e59(0x18e)]=='Portuguese\x20(BR)')var _0x2d8cf8=users['Portuguese'];else{if(_0x28ebb8[0x0]['language']==_0x207e59(0x109))var _0x2d8cf8=users[_0x207e59(0x109)];else{if(_0x28ebb8[0x0][_0x207e59(0x18e)]==_0x207e59(0x1c9))var _0x2d8cf8=users[_0x207e59(0x185)];}}}}}}}_0x220a06[_0x207e59(0x15a)](_0x207e59(0x111),{'success':_0x213172['flash']('success'),'errors':_0x213172['flash'](_0x207e59(0x194)),'role':_0x20999b,'profile':_0x514265,'master_shop':_0x28ebb8,'warehouse':_0x2dd8eb,'transfer':_0x486153,'stock':_0xcd6f9,'language':_0x2d8cf8});}catch(_0x534c93){console[_0x207e59(0x126)](_0x534c93);}}),router[a0_0x2e9814(0xef)](a0_0x2e9814(0x142),auth,async(_0x5f31d0,_0x463f73)=>{var _0x19c131=a0_0x2e9814;try{const _0x23ec4d=_0x5f31d0[_0x19c131(0x17f)]['id'],{from_warehouse:_0x3d3f30,FromRoom_name:_0x3e4bc3,to_warehouse:_0x439287,ToRoom_name:_0x145a9e}=_0x5f31d0[_0x19c131(0xf5)],_0x3b001c=await transfers[_0x19c131(0x16f)]({'_id':_0x23ec4d}),_0x5c54a4=_0x3b001c[_0x19c131(0xf6)]['map'](async _0x34cffc=>{var _0xde3b16=_0x19c131;if(_0x34cffc[_0xde3b16(0x174)]>0x0){var _0x39e8c5=await warehouse[_0xde3b16(0x19a)]({'name':_0x3b001c[_0xde3b16(0x190)],'room':_0x34cffc[_0xde3b16(0x12b)],'warehouse_category':_0xde3b16(0x17a)});const _0xd888a=_0x39e8c5[_0xde3b16(0x1a4)]['map'](_0x1bf6f2=>{var _0x5066ed=_0xde3b16;_0x1bf6f2[_0x5066ed(0x134)]==_0x34cffc['product_name']&&_0x1bf6f2[_0x5066ed(0x1d2)]==_0x34cffc['from_floorlevel']&&_0x1bf6f2[_0x5066ed(0x14f)]==_0x34cffc['from_types']&&_0x1bf6f2[_0x5066ed(0x17e)]==_0x34cffc['from_bin']&&_0x1bf6f2[_0x5066ed(0x1de)]==_0x34cffc[_0x5066ed(0x15f)]&&_0x1bf6f2[_0x5066ed(0x1c2)]==_0x34cffc[_0x5066ed(0x112)]&&_0x1bf6f2[_0x5066ed(0x10a)]==_0x34cffc[_0x5066ed(0x1d5)]&&_0x1bf6f2[_0x5066ed(0x100)]==_0x34cffc[_0x5066ed(0x100)]&&_0x1bf6f2['batch_code']==_0x34cffc['batch_code']&&_0x1bf6f2['production_date']==_0x34cffc['production_date']&&_0x1bf6f2[_0x5066ed(0x147)]==_0x34cffc[_0x5066ed(0x10b)]&&_0x1bf6f2[_0x5066ed(0x172)]==_0x34cffc['id_transaction_id']&&(_0x1bf6f2[_0x5066ed(0x186)]=_0x1bf6f2[_0x5066ed(0x186)]-_0x34cffc['to_quantity']);});}return _0x39e8c5;});Promise['all'](_0x5c54a4)[_0x19c131(0x114)](async _0x22f853=>{var _0x4d243e=_0x19c131;try{for(const _0x4c06a2 of _0x22f853){await _0x4c06a2[_0x4d243e(0x19c)]();}try{const _0x2049d2=_0x3b001c['product'][_0x4d243e(0x1a7)](async _0x200791=>{var _0xf46e2c=_0x4d243e;if(_0x200791['to_quantity']>0x0){var _0x55ac23=await warehouse[_0xf46e2c(0x19a)]({'name':_0x3b001c[_0xf46e2c(0x182)],'room':_0x200791[_0xf46e2c(0x1c3)],'warehouse_category':_0xf46e2c(0x17a)}),_0x56ded6=0x0;const _0x27554e=_0x55ac23['product_details'][_0xf46e2c(0x1a7)](_0x29bb62=>{var _0x55e9ce=_0xf46e2c;_0x29bb62[_0x55e9ce(0x134)]==_0x200791['product_name']&&_0x29bb62[_0x55e9ce(0x1d2)]==_0x200791['to_floorlevel']&&_0x29bb62[_0x55e9ce(0x14f)]==_0x200791[_0x55e9ce(0x11e)]&&_0x29bb62[_0x55e9ce(0x17e)]==_0x200791['to_bin']&&_0x29bb62[_0x55e9ce(0x1de)]==_0x200791['to_bay']&&_0x29bb62[_0x55e9ce(0x1c2)]==_0x200791[_0x55e9ce(0x1c2)]&&_0x29bb62[_0x55e9ce(0x10a)]==_0x200791[_0x55e9ce(0x10a)]&&_0x29bb62['expiry_date']==_0x200791[_0x55e9ce(0x100)]&&_0x29bb62['batch_code']==_0x200791[_0x55e9ce(0x179)]&&_0x29bb62[_0x55e9ce(0x107)]==_0x200791['production_date']&&_0x29bb62[_0x55e9ce(0x147)]==_0x200791[_0x55e9ce(0x162)]&&(_0x29bb62[_0x55e9ce(0x186)]=_0x29bb62[_0x55e9ce(0x186)]+_0x200791['to_quantity'],_0x56ded6++);});_0x56ded6=='0'&&(_0x55ac23['product_details']=_0x55ac23['product_details'][_0xf46e2c(0x16c)]({'product_name':_0x200791[_0xf46e2c(0x134)],'product_stock':_0x200791[_0xf46e2c(0x174)],'bay':_0x200791[_0xf46e2c(0x133)],'bin':_0x200791[_0xf46e2c(0x150)],'type':_0x200791[_0xf46e2c(0x11e)],'floorlevel':_0x200791[_0xf46e2c(0x1a9)],'storage':_0x200791[_0xf46e2c(0x10a)],'rack':_0x200791[_0xf46e2c(0x1c2)],'product_code':_0x200791[_0xf46e2c(0x1bd)],'primary_code':_0x200791['primary_code'],'secondary_code':_0x200791[_0xf46e2c(0x199)],'maxProducts':_0x200791[_0xf46e2c(0x183)],'storage':_0x200791[_0xf46e2c(0x10a)],'rack':_0x200791[_0xf46e2c(0x1c2)],'expiry_date':_0x200791['expiry_date'],'maxPerUnit':_0x200791[_0xf46e2c(0x1ba)],'batch_code':_0x200791[_0xf46e2c(0x179)],'production_date':_0x200791['production_date']}));}return _0x55ac23;});Promise[_0x4d243e(0x145)](_0x2049d2)[_0x4d243e(0x114)](async _0x1bdb22=>{var _0x4e1d04=_0x4d243e;try{for(const _0x56bef4 of _0x1bdb22){await warehouse['updateOne']({'_id':_0x56bef4[_0x4e1d04(0x172)]},{'$addToSet':{'product_details':{'$each':_0x56bef4['product_details']}}});}_0x3b001c[_0x4e1d04(0x1a3)]='True';const _0x3a1547=await _0x3b001c[_0x4e1d04(0x19c)](),_0x20c658=await master_shop[_0x4e1d04(0x1dd)](),_0x1344ba=await email_settings[_0x4e1d04(0x19a)](),_0x4560fc=await supervisor_settings[_0x4e1d04(0x1dd)]();var _0x5be3ca=_0x3b001c['product'],_0x5bb8fa='',_0x17e096;for(_0x17e096 in _0x5be3ca){_0x5bb8fa+=_0x4e1d04(0x11a)+_0x4e1d04(0xf1)+_0x5be3ca[_0x17e096]['product_name']+_0x4e1d04(0xfe)+_0x4e1d04(0xf1)+_0x5be3ca[_0x17e096][_0x4e1d04(0x1bd)]+_0x4e1d04(0xfe)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5be3ca[_0x17e096][_0x4e1d04(0x174)]+_0x4e1d04(0xfe)+_0x4e1d04(0xf1)+_0x5be3ca[_0x17e096][_0x4e1d04(0x14e)]+_0x4e1d04(0xfe)+_0x4e1d04(0xf1)+_0x5be3ca[_0x17e096][_0x4e1d04(0x1bb)]+'</td>'+_0x4e1d04(0xf1)+_0x3b001c[_0x4e1d04(0x182)]+_0x4e1d04(0xfe)+_0x4e1d04(0xf1)+_0x5be3ca[_0x17e096]['to_room_name']+_0x4e1d04(0xfe)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5be3ca[_0x17e096][_0x4e1d04(0x10a)]+_0x5be3ca[_0x17e096][_0x4e1d04(0x1c2)]+_0x5be3ca[_0x17e096]['to_bay']+_0x5be3ca[_0x17e096][_0x4e1d04(0x150)]+_0x5be3ca[_0x17e096][_0x4e1d04(0x11e)][0x0]+_0x5be3ca[_0x17e096]['to_floorlevel']+_0x4e1d04(0xfe),_0x4e1d04(0x16d);}let _0xcdc8f2=nodemailer[_0x4e1d04(0x1ac)]({'host':_0x1344ba[_0x4e1d04(0x17d)],'port':Number(_0x1344ba[_0x4e1d04(0x1b1)]),'secure':![],'auth':{'user':_0x1344ba[_0x4e1d04(0x16b)],'pass':_0x1344ba[_0x4e1d04(0x127)]}}),_0x5aada8={'from':_0x1344ba[_0x4e1d04(0x16b)],'to':_0x4560fc[0x0]['RMSEmail'],'subject':_0x4e1d04(0x12d),'attachments':[{'filename':_0x4e1d04(0x19f),'path':__dirname+_0x4e1d04(0x129)+_0x4e1d04(0x1a2)+_0x20c658[0x0][_0x4e1d04(0x13f)],'cid':_0x4e1d04(0x1c5)}],'html':_0x4e1d04(0x1cc)+_0x4e1d04(0x1c0)+'</head><body>'+_0x4e1d04(0x1b0)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x4e1d04(0x1b0)+_0x4e1d04(0xff)+_0x20c658[0x0][_0x4e1d04(0x18f)]+_0x4e1d04(0xfd)+_0x4e1d04(0x1b9)+'</div>'+_0x4e1d04(0x1c7)+_0x4e1d04(0x1b0)+_0x4e1d04(0x148)+_0x4e1d04(0x143)+_0x3b001c[_0x4e1d04(0x147)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x4e1d04(0xfc)+_0x3b001c[_0x4e1d04(0x158)]+'\x20'+_0x4e1d04(0x104)+_0x4e1d04(0x167)+_0x4e1d04(0x1b9)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4e1d04(0x19b)+_0x4e1d04(0x11a)+_0x4e1d04(0x1df)+_0x4e1d04(0x108)+_0x4e1d04(0x1c4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x4e1d04(0x1ad)+_0x4e1d04(0x102)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x4e1d04(0x14b)+_0x4e1d04(0x16d)+_0x4e1d04(0x17c)+_0x4e1d04(0x14a)+'\x20'+_0x5bb8fa+'\x20'+_0x4e1d04(0x173)+_0x4e1d04(0x18b)+'<div>'+_0x4e1d04(0x122)+'<h5>'+_0x20c658[0x0][_0x4e1d04(0x18f)]+_0x4e1d04(0x167)+'</div>'+_0x4e1d04(0x1b9)+_0x4e1d04(0x19e)};_0xcdc8f2[_0x4e1d04(0x105)](_0x5aada8,function(_0x11d545,_0x57d3c9){var _0x4e9414=_0x4e1d04;_0x11d545?(console[_0x4e9414(0x126)](_0x11d545),console[_0x4e9414(0x126)](_0x4e9414(0x144))):console[_0x4e9414(0x126)](_0x4e9414(0x157));}),_0x5f31d0[_0x4e1d04(0x155)](_0x4e1d04(0x192),'Transfer\x20Finalize\x20Successfully'),_0x463f73[_0x4e1d04(0x187)](_0x4e1d04(0x141)+_0x3a1547[_0x4e1d04(0x172)]);}catch(_0x494ee5){console['error'](_0x494ee5),_0x463f73[_0x4e1d04(0xf9)](0x1f4)[_0x4e1d04(0x132)]({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x494ee5['message']});}})[_0x4d243e(0x1db)](_0x4ea19a=>{var _0x15e135=_0x4d243e;console[_0x15e135(0x1c8)](_0x4ea19a),_0x463f73[_0x15e135(0xf9)](0x1f4)['json']({'Perror':_0x15e135(0x184)});});}catch(_0x2a431d){_0x463f73[_0x4d243e(0x132)](_0x2a431d);}}catch(_0x1cc669){console['error'](_0x1cc669),_0x463f73[_0x4d243e(0xf9)](0x1f4)[_0x4d243e(0x132)]({'Merror':_0x4d243e(0x117),'Message':_0x1cc669['message']});}})[_0x19c131(0x1db)](_0x1d0dc8=>{var _0x9d56e8=_0x19c131;console[_0x9d56e8(0x1c8)](_0x1d0dc8),_0x463f73[_0x9d56e8(0xf9)](0x1f4)['json']({'Merror':_0x9d56e8(0x184)});});}catch(_0x30b59f){console['log'](_0x30b59f);}});function BayBinSelected(_0x765827,_0x1546cf){var _0x502952=a0_0x2e9814,_0x43f6d6=[],_0x61721a=[],_0x3bcf63=[],_0x1e66f3=[],_0x171de1=[],_0x27c90e=[];let _0x516584=[];if(_0x765827=='DRY\x20STORAGE')switch(_0x1546cf){case'Rack\x20A':_0x43f6d6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x61721a=[0x1,0x2],_0x1e66f3=[0x1,0x2,0x3,0x4,0x5],_0x3bcf63=['Level',_0x502952(0x16a)],_0x171de1=['D'],_0x27c90e=['A'];break;case _0x502952(0x146):_0x43f6d6=[0x6,0x5,0x4,0x3,0x2,0x1],_0x61721a=[0x1,0x2],_0x1e66f3=[0x1,0x2,0x3,0x4,0x5],_0x3bcf63=[_0x502952(0x166),'Floor'],_0x171de1=['D'],_0x27c90e=['B'];break;case _0x502952(0x1a8):_0x43f6d6=[0x0],_0x61721a=[0x0],_0x1e66f3=[0x1,0x2,0x3,0x4,0x5],_0x3bcf63=['Floor'],_0x171de1=['D'],_0x27c90e=['S'];break;case'Receiving\x20Area':_0x43f6d6=[0x0],_0x61721a=[0x0],_0x1e66f3=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x3bcf63=['Floor'],_0x171de1=['D'],_0x27c90e=['R'];break;}else{if(_0x765827==_0x502952(0x1a1))switch(_0x1546cf){case _0x502952(0x169):_0x43f6d6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x61721a=['B','F'],_0x1e66f3=[0x1,0x2,0x3,0x4,0x5],_0x3bcf63=['Level',_0x502952(0x16a)],_0x171de1=['C'],_0x27c90e=['A'];break;case _0x502952(0x146):_0x43f6d6=[0x5,0x4,0x3,0x2,0x1],_0x61721a=['F','B','S'],_0x1e66f3=[0x1,0x2,0x3,0x4,0x5],_0x3bcf63=[_0x502952(0x166),'Floor'],_0x171de1=['C'],_0x27c90e=['B'];break;case _0x502952(0x195):_0x43f6d6=[0x1,0x2,0x3,0x4,0x5],_0x61721a=['B','F','S'],_0x1e66f3=[0x5,0x4,0x3,0x2,0x1],_0x3bcf63=[_0x502952(0x166),_0x502952(0x16a)],_0x171de1=['C'],_0x27c90e=['C'];break;case'Rack\x20D':_0x43f6d6=[0x5,0x4,0x3,0x2,0x1],_0x61721a=['F','B','S'],_0x1e66f3=[0x1,0x2,0x3,0x4,0x5],_0x3bcf63=['Level','Floor'],_0x171de1=['C'],_0x27c90e=['D'];break;case _0x502952(0x120):_0x43f6d6=[0x4,0x3,0x2,0x1],_0x61721a=[0x1,0x2],_0x1e66f3=[0x1,0x2,0x3,0x4,0x5],_0x3bcf63=[_0x502952(0x166),_0x502952(0x16a)],_0x171de1=['C'],_0x27c90e=['E'];break;case _0x502952(0x1d9):_0x43f6d6=[0x1,0x2,0x3],_0x61721a=[0x1,0x2],_0x1e66f3=[0x1,0x2,0x3,0x4,0x5],_0x3bcf63=[_0x502952(0x166)],_0x171de1=['C'],_0x27c90e=['F'];break;}}return{'levels':_0x43f6d6,'Isle':_0x61721a,'rack':_0x1e66f3,'type':_0x3bcf63,'storage':_0x171de1,'rak':_0x27c90e};}function a0_0x5334(){var _0x23675d=['</tbody>','to_quantity','to_invoice','\x20<>\x20','9hzAxDM','max_per_unit','batch_code','Raw\x20Materials','$_id','</thead>','host','bin','params','get','master','to_warehouse','maxProducts','An\x20error\x20occurred.','Arabic','product_stock','redirect','prod_cat','from_floorlevel','$product_details.storage','</table>','to_prod_level','forEach','language','site_title','from_warehouse','to_prod_isle','success','edit_transfer','errors','Rack\x20C','../public/language/languages.json','to_prod_qty','padStart','secondary_code','findOne','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','save','$product_details.type','</body></html>','Logo.png','getFullYear','COLD\x20STORAGE','/upload/','finalize','product_details','25096sJdYde','/barcode_scanner','map','Shelves','to_floorlevel','$date','5381550qdwQiv','createTransport','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','../models/all_models','$product_details.invoice','<div>','port','$from_warehouse','$product_details.product_code','RoomAssigned','message','English','from_rak','German','</div>','maxperunit','secondary_unit','$product_details.isle','product_code','from_prod_pallet','French','<html><head><title></title>','from_prod_level','rack','to_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','logo','Ambient','<hr\x20class=\x22my-3\x22>','error','Arabic\x20(ae)','707ThOxjW','Hindi','<!DOCTYPE\x20html>','$product.to_room_name','$product_details.expiry_date','82140ZKiYyO','TRF-','2885290iaDeOH','floorlevel','from_types','3918MLQLBS','from_storage','$product_details.production_date','English\x20(US)','/barcode_scanner3','Rack\x20F','exports','catch','/view/add_transfer','find','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.bay','$product','post','floor','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.bin','getDate','$product_details.maxProducts','body','product','$product_details.level','to_room','status','$product_details.rack','product_code3','\x20Order\x20Date\x20:\x20','\x20</h2>','</td>','<h2>\x20','expiry_date','prod_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Receiving\x20Area','</span>','sendMail','$product_details.batch_code','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Chinese','storage','from_invoice','length','Enclosed','ToRoomAssigned','/view/:id','slice','edit_transfer_view','from_rack','Enabled','then','$product_details.secondary_unit','7134536OXDudd','An\x20error\x20occurred\x20while\x20saving\x20data.','New_Qty_Converted','$product_details.primary_code','<tr>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','user','Router','to_types','Portuguese\x20(BR)','Rack\x20E','primary_code','<strong>\x20Regards\x20</strong>','express','random','$product_details.pallet','log','password','$isAllowEdit','/../public','role','from_room_name','toString','Transfer\x20Mail','22LcCtVF','split','MaxStocks_data2','328760HLQyxJ','json','to_bay','product_name','$product_details.product_stock','add_transfer','$product_details.unit','124TOVDSW','../middleware/auth','from_prod_qty','Spanish','id_transaction','transfer','$name','image','from_bin','/picking_list/PDF_transfer_rm/','/preview/:id','\x20Order\x20Number\x20:\x20','Error\x20Occurs','all','Rack\x20B','invoice','<h5\x20style=\x22text-align:\x20left;\x22>','aggregate','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','from_quantity','$room','unit','type','to_bin','here','warehouse','/CheckingWarehouse','$product_details.maxPerUnit','flash','$product_details.product_name','Email\x20sent\x20successfully','date','from_room','render','Transfer\x20Edit\x20Successfully','Product\x20Transfer\x20successfully','to_prod_pallet','$product_details.secondary_code','from_bay','push','staff','To_invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','id_transaction_id','back','Level','</h5>','$product_details','Rack\x20A','Floor','email','concat','</tr>','$product.from_room_name','findById','$product_details._id','$product_details.floorlevel','_id'];a0_0x5334=function(){return _0x23675d;};return a0_0x5334();}router[a0_0x2e9814(0x180)](a0_0x2e9814(0x10f),auth,async(_0x1e85f7,_0x33498d)=>{var _0x465c39=a0_0x2e9814;try{const {username:_0x3217ca,email:_0x5e0c9c,role:_0x3f1d92}=_0x1e85f7[_0x465c39(0x11c)],_0x1cf288=_0x1e85f7[_0x465c39(0x11c)],_0xe3f217=await profile[_0x465c39(0x19a)]({'email':_0x1cf288[_0x465c39(0x16b)]}),_0x248ee4=await master_shop[_0x465c39(0x1dd)](),_0x4000a9=await transfers[_0x465c39(0x16f)](_0x1e85f7[_0x465c39(0x17f)]['id']);let _0x12b3a4;if(_0x1cf288[_0x465c39(0x12a)]==_0x465c39(0x161)){const _0xd720e7=await staff[_0x465c39(0x19a)]({'email':_0x1cf288[_0x465c39(0x16b)]});_0x12b3a4=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0xd720e7[_0x465c39(0x152)],'warehouse_category':_0x465c39(0x17a)}},{'$group':{'_id':_0x465c39(0x13e),'name':{'$first':_0x465c39(0x13e)}}}]);}else _0x12b3a4=await warehouse[_0x465c39(0x149)]([{'$match':{'status':_0x465c39(0x113),'warehouse_category':_0x465c39(0x17a)}},{'$group':{'_id':_0x465c39(0x13e),'name':{'$first':_0x465c39(0x13e)}}}]);const _0x94c255=await warehouse['aggregate']([{'$match':{'name':_0x4000a9['from_warehouse'],'warehouse_category':_0x465c39(0x17a)}},{'$unwind':_0x465c39(0x168)},{'$group':{'_id':_0x465c39(0x170),'name':{'$first':_0x465c39(0x156)},'product_stock':{'$first':_0x465c39(0x135)},'bay':{'$first':_0x465c39(0x1e0)},'bin':{'$first':_0x465c39(0xf2)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x465c39(0x171)},'primary_code':{'$first':_0x465c39(0x119)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x465c39(0x1b3)},'storage':{'$first':_0x465c39(0x18a)},'rack':{'$first':_0x465c39(0xfa)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x465c39(0x1d6)},'room':{'$first':'$room'}}}]),_0x18b688=await product[_0x465c39(0x1dd)]({}),_0x2b4b90=BayBinSelected(_0x4000a9[_0x465c39(0x182)],_0x4000a9[_0x465c39(0xf8)]);if(_0x248ee4[0x0][_0x465c39(0x18e)]=='English\x20(US)'){var _0x40598c=users[_0x465c39(0x1b6)];console[_0x465c39(0x126)](_0x40598c);}else{if(_0x248ee4[0x0][_0x465c39(0x18e)]==_0x465c39(0x1cb))var _0x40598c=users[_0x465c39(0x1cb)];else{if(_0x248ee4[0x0][_0x465c39(0x18e)]==_0x465c39(0x1b8))var _0x40598c=users['German'];else{if(_0x248ee4[0x0][_0x465c39(0x18e)]==_0x465c39(0x13b))var _0x40598c=users[_0x465c39(0x13b)];else{if(_0x248ee4[0x0]['language']==_0x465c39(0x1bf))var _0x40598c=users[_0x465c39(0x1bf)];else{if(_0x248ee4[0x0][_0x465c39(0x18e)]==_0x465c39(0x11f))var _0x40598c=users['Portuguese'];else{if(_0x248ee4[0x0]['language']==_0x465c39(0x109))var _0x40598c=users[_0x465c39(0x109)];else{if(_0x248ee4[0x0][_0x465c39(0x18e)]==_0x465c39(0x1c9))var _0x40598c=users[_0x465c39(0x185)];}}}}}}}_0x33498d[_0x465c39(0x15a)](_0x465c39(0x193),{'success':_0x1e85f7[_0x465c39(0x155)]('success'),'errors':_0x1e85f7[_0x465c39(0x155)](_0x465c39(0x194)),'role':_0x1cf288,'profile':_0xe3f217,'master_shop':_0x248ee4,'warehouse':_0x12b3a4,'transfer':_0x4000a9,'stock':_0x94c255,'unit':_0x18b688,'language':_0x40598c});}catch(_0x1b2a0e){console[_0x465c39(0x126)](_0x1b2a0e);}}),router[a0_0x2e9814(0xef)](a0_0x2e9814(0x10f),auth,async(_0xa6d7e2,_0xe2cbb)=>{var _0x4cb8ab=a0_0x2e9814;try{const _0x5314b7=_0xa6d7e2[_0x4cb8ab(0x17f)]['id'],_0xc0a74f=await transfers[_0x4cb8ab(0x16f)](_0x5314b7);_0xe2cbb['json'](_0xa6d7e2[_0x4cb8ab(0xf5)]);return;const {date:_0x4c81b2,from_warehouse:_0x57c244,FromRoom_name:_0x1b6c06,to_warehouse:_0x2ee242,ToRoom_name:_0x50d85c,prod_name:_0x3082c0,from_prod_qty:_0x7613e7,from_prod_level:_0x244b24,from_prod_isle:_0x429a71,from_prod_pallet:_0x5211c6,to_prod_qty:_0x126031,to_prod_level:_0x1cae82,to_prod_isle:_0x367066,to_prod_pallet:_0x412a90,primary_code:_0x575fdd,secondary_code:_0x30d4ff,product_code3:_0x4dfb6d,note:_0x14f14c,invoice:_0x407aa3,expiry_date:_0x434546}=_0xa6d7e2[_0x4cb8ab(0xf5)];if(typeof _0x3082c0=='string')var _0x13de7a=[_0xa6d7e2['body'][_0x4cb8ab(0x101)]],_0xed2b1f=[_0xa6d7e2['body'][_0x4cb8ab(0x13a)]],_0x2c2672=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x1c1)]],_0x744f72=[_0xa6d7e2['body']['from_prod_isle']],_0x4f1703=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x1be)]],_0x8e6b03=[_0xa6d7e2['body'][_0x4cb8ab(0x1d3)]],_0x4127bf=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x197)]],_0x4706d4=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x18c)]],_0x5b2347=[_0xa6d7e2[_0x4cb8ab(0xf5)]['to_prod_isle']],_0x3d9aec=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x15d)]],_0x4790fe=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x11e)]],_0x48b0e5=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x10a)]],_0xf90283=[_0xa6d7e2['body']['rak']],_0x2f60e7=[_0xa6d7e2['body'][_0x4cb8ab(0x121)]],_0x43e631=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x199)]],_0x15d29b=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0xfb)]],_0x5df278=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x130)]],_0x47bafe=[_0xa6d7e2['body']['unit']],_0x2da60e=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x1bb)]],_0x4d4e7f=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x179)]],_0x14f260=[_0xa6d7e2['body'][_0x4cb8ab(0x100)]],_0x2356ad=[_0xa6d7e2['body']['from_storage']],_0x4f603f=[_0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x1b7)]];else var _0x13de7a=[..._0xa6d7e2['body'][_0x4cb8ab(0x101)]],_0x48b0e5=[..._0xa6d7e2['body'][_0x4cb8ab(0x10a)]],_0xf90283=[..._0xa6d7e2[_0x4cb8ab(0xf5)]['rak']],_0x8e6b03=[..._0xa6d7e2['body'][_0x4cb8ab(0x1d3)]],_0x4790fe=[..._0xa6d7e2[_0x4cb8ab(0xf5)]['to_types']],_0xed2b1f=[..._0xa6d7e2['body'][_0x4cb8ab(0x13a)]],_0x2c2672=[..._0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x1c1)]],_0x744f72=[..._0xa6d7e2[_0x4cb8ab(0xf5)]['from_prod_isle']],_0x4f1703=[..._0xa6d7e2['body'][_0x4cb8ab(0x1be)]],_0x4127bf=[..._0xa6d7e2['body'][_0x4cb8ab(0x197)]],_0x4706d4=[..._0xa6d7e2[_0x4cb8ab(0xf5)]['to_prod_level']],_0x5b2347=[..._0xa6d7e2['body'][_0x4cb8ab(0x191)]],_0x3d9aec=[..._0xa6d7e2['body']['to_prod_pallet']],_0x2f60e7=[..._0xa6d7e2['body'][_0x4cb8ab(0x121)]],_0x43e631=[..._0xa6d7e2['body'][_0x4cb8ab(0x199)]],_0x15d29b=[..._0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0xfb)]],_0x5df278=[..._0xa6d7e2['body'][_0x4cb8ab(0x130)]],_0x47bafe=[..._0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x14e)]],_0x2da60e=[..._0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x1bb)]],_0x4d4e7f=[..._0xa6d7e2[_0x4cb8ab(0xf5)]['batch_code']],_0x14f260=[..._0xa6d7e2[_0x4cb8ab(0xf5)]['expiry_date']],_0x2356ad=[..._0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x1d5)]],_0x4f603f=[..._0xa6d7e2[_0x4cb8ab(0xf5)][_0x4cb8ab(0x1b7)]];const _0xed9d55=_0x13de7a[_0x4cb8ab(0x1a7)](_0x31c0fc=>{return _0x31c0fc={'product_name':_0x31c0fc};});_0xed2b1f[_0x4cb8ab(0x18d)]((_0x1c3340,_0x2d9b36)=>{_0xed9d55[_0x2d9b36]['from_quantity']=_0x1c3340;}),_0x2c2672[_0x4cb8ab(0x18d)]((_0x2775e3,_0x57e10e)=>{var _0x14d7ee=_0x4cb8ab;_0xed9d55[_0x57e10e][_0x14d7ee(0x15f)]=_0x2775e3;}),_0x744f72[_0x4cb8ab(0x18d)]((_0x51d2e3,_0x5a8c1a)=>{_0xed9d55[_0x5a8c1a]['from_bin']=_0x51d2e3;}),_0x4f1703[_0x4cb8ab(0x18d)]((_0x2af969,_0x2fc110)=>{var _0x330126=_0x4cb8ab;_0xed9d55[_0x2fc110][_0x330126(0x189)]=_0x2af969;}),_0x4127bf[_0x4cb8ab(0x18d)]((_0x2cd989,_0x526c5a)=>{var _0x2afe63=_0x4cb8ab;_0xed9d55[_0x526c5a][_0x2afe63(0x174)]=_0x2cd989;}),_0x4706d4[_0x4cb8ab(0x18d)]((_0x5d3ccc,_0x1ff746)=>{var _0x25ada7=_0x4cb8ab;_0xed9d55[_0x1ff746][_0x25ada7(0x133)]=_0x5d3ccc;}),_0x5b2347[_0x4cb8ab(0x18d)]((_0xbcd738,_0x46c318)=>{var _0x47048a=_0x4cb8ab;_0xed9d55[_0x46c318][_0x47048a(0x150)]=_0xbcd738;}),_0x3d9aec[_0x4cb8ab(0x18d)]((_0x5055f1,_0x24bc8c)=>{_0xed9d55[_0x24bc8c]['to_floorlevel']=_0x5055f1;}),_0x2f60e7['forEach']((_0x113819,_0x482041)=>{var _0x5220f8=_0x4cb8ab;_0xed9d55[_0x482041][_0x5220f8(0x121)]=_0x113819;}),_0x43e631[_0x4cb8ab(0x18d)]((_0x32c70,_0x59c6d9)=>{var _0x4b2832=_0x4cb8ab;_0xed9d55[_0x59c6d9][_0x4b2832(0x199)]=_0x32c70;}),_0x15d29b[_0x4cb8ab(0x18d)]((_0x12e6c2,_0x4f94ee)=>{var _0x53456a=_0x4cb8ab;_0xed9d55[_0x4f94ee][_0x53456a(0x1bd)]=_0x12e6c2;}),_0x5df278['forEach']((_0x4c9d50,_0x5b27f2)=>{_0xed9d55[_0x5b27f2]['maxProducts']=_0x4c9d50;}),_0x47bafe[_0x4cb8ab(0x18d)]((_0x577f95,_0x20af6d)=>{var _0x428746=_0x4cb8ab;_0xed9d55[_0x20af6d][_0x428746(0x14e)]=_0x577f95;}),_0x2da60e[_0x4cb8ab(0x18d)]((_0x514929,_0xb393b0)=>{var _0x830967=_0x4cb8ab;_0xed9d55[_0xb393b0][_0x830967(0x1bb)]=_0x514929;}),_0x4d4e7f[_0x4cb8ab(0x18d)]((_0x3aed3d,_0x31d344)=>{var _0x59d738=_0x4cb8ab;_0xed9d55[_0x31d344][_0x59d738(0x179)]=_0x3aed3d;}),_0x14f260[_0x4cb8ab(0x18d)]((_0x229791,_0x41bdc7)=>{var _0x6f376=_0x4cb8ab;_0xed9d55[_0x41bdc7][_0x6f376(0x100)]=_0x229791;}),_0x48b0e5['forEach']((_0x2f0ef1,_0x37e2f8)=>{_0xed9d55[_0x37e2f8]['storage']=_0x2f0ef1;}),_0xf90283[_0x4cb8ab(0x18d)]((_0x5ea29c,_0x4dfe64)=>{var _0x2ba986=_0x4cb8ab;_0xed9d55[_0x4dfe64][_0x2ba986(0x1c2)]=_0x5ea29c;}),_0x8e6b03[_0x4cb8ab(0x18d)]((_0x167283,_0x23b454)=>{var _0xacf4f=_0x4cb8ab;_0xed9d55[_0x23b454][_0xacf4f(0x1d3)]=_0x167283;}),_0x4790fe[_0x4cb8ab(0x18d)]((_0x3790db,_0xc51b52)=>{var _0x36c8a8=_0x4cb8ab;_0xed9d55[_0xc51b52][_0x36c8a8(0x11e)]=_0x3790db;}),_0x2356ad[_0x4cb8ab(0x18d)]((_0x49d2f6,_0x2108a9)=>{_0xed9d55[_0x2108a9]['from_storage']=_0x49d2f6;}),_0x4f603f[_0x4cb8ab(0x18d)]((_0xa28249,_0x2ada9e)=>{var _0x8c4724=_0x4cb8ab;_0xed9d55[_0x2ada9e][_0x8c4724(0x112)]=_0xa28249;});const _0x85563f=_0xed9d55['filter'](_0x5628f2=>_0x5628f2['to_quantity']!=='0'&&_0x5628f2[_0x4cb8ab(0x174)]!==''||_0x5628f2[_0x4cb8ab(0x1a9)]!=='0'&&_0x5628f2[_0x4cb8ab(0x1a9)]!=='');var _0xcaead6=0x0;_0x85563f['forEach'](_0x531996=>{var _0x36b19d=_0x4cb8ab;parseInt(_0x531996['from_quantity'])<parseInt(_0x531996[_0x36b19d(0x174)])&&_0xcaead6++;});if(_0xcaead6!=0x0)return _0xa6d7e2[_0x4cb8ab(0x155)](_0x4cb8ab(0x194),_0x4cb8ab(0x11b)),_0xe2cbb[_0x4cb8ab(0x187)](_0x4cb8ab(0x165));const _0x492986=await warehouse[_0x4cb8ab(0x19a)]({'name':_0xc0a74f[_0x4cb8ab(0x190)],'room':_0xc0a74f[_0x4cb8ab(0x159)]});_0xc0a74f['product']['forEach'](_0x2b256e=>{var _0x1fd27b=_0x4cb8ab;if(_0x2b256e['to_quantity']>0x0){const _0x3d373c=_0x492986[_0x1fd27b(0x1a4)]['map'](_0x1dc3cd=>{var _0x580726=_0x1fd27b;_0x1dc3cd[_0x580726(0x134)]==_0x2b256e[_0x580726(0x134)]&&_0x1dc3cd[_0x580726(0x1d2)]==_0x2b256e[_0x580726(0x189)]&&_0x1dc3cd['type']==_0x2b256e[_0x580726(0x1d3)]&&_0x1dc3cd[_0x580726(0x17e)]==_0x2b256e[_0x580726(0x140)]&&_0x1dc3cd[_0x580726(0x1de)]==_0x2b256e[_0x580726(0x15f)]&&_0x1dc3cd[_0x580726(0x1c2)]==_0x2b256e['from_rack']&&_0x1dc3cd[_0x580726(0x10a)]==_0x2b256e[_0x580726(0x1d5)]&&(_0x1dc3cd['product_stock']=parseInt(_0x1dc3cd['product_stock'])+parseInt(_0x2b256e['to_quantity']));});}}),await _0x492986[_0x4cb8ab(0x19c)]();const _0x1a0767=await warehouse[_0x4cb8ab(0x19a)]({'name':_0xc0a74f['to_warehouse'],'room':_0xc0a74f[_0x4cb8ab(0xf8)]});_0xc0a74f[_0x4cb8ab(0xf6)][_0x4cb8ab(0x18d)](_0x3e84a8=>{var _0x2c8b40=_0x4cb8ab;if(_0x3e84a8[_0x2c8b40(0x174)]>0x0){const _0x1daa10=_0x1a0767[_0x2c8b40(0x1a4)]['map'](_0x3b71e9=>{var _0x47df64=_0x2c8b40;_0x3b71e9['product_name']==_0x3e84a8['product_name']&&_0x3b71e9[_0x47df64(0x1d2)]==_0x3e84a8['to_floorlevel']&&_0x3b71e9[_0x47df64(0x14f)]==_0x3e84a8['to_types']&&_0x3b71e9[_0x47df64(0x17e)]==_0x3e84a8[_0x47df64(0x150)]&&_0x3b71e9[_0x47df64(0x1de)]==_0x3e84a8['to_bay']&&_0x3b71e9[_0x47df64(0x1c2)]==_0x3e84a8[_0x47df64(0x1c2)]&&_0x3b71e9[_0x47df64(0x10a)]==_0x3e84a8[_0x47df64(0x10a)]&&(_0x3b71e9['product_stock']=parseInt(_0x3b71e9[_0x47df64(0x186)])-parseInt(_0x3e84a8[_0x47df64(0x174)]));});}}),await _0x1a0767['save'](),_0xc0a74f[_0x4cb8ab(0x158)]=_0x4c81b2,_0xc0a74f[_0x4cb8ab(0x190)]=_0x57c244,_0xc0a74f[_0x4cb8ab(0x182)]=_0x2ee242,_0xc0a74f['product']=_0x85563f,_0xc0a74f['note']=_0x14f14c,_0xc0a74f[_0x4cb8ab(0x147)]=_0x407aa3;const _0x11cd8d=await _0xc0a74f[_0x4cb8ab(0x19c)]();console['log'](_0x11cd8d);const _0x3089c5=await warehouse[_0x4cb8ab(0x19a)]({'name':_0x57c244,'room':_0x1b6c06});_0x11cd8d[_0x4cb8ab(0xf6)][_0x4cb8ab(0x18d)](_0x12bf61=>{var _0x1ad756=_0x4cb8ab;if(_0x12bf61['to_quantity']>0x0){const _0x2bc114=_0x3089c5['product_details'][_0x1ad756(0x1a7)](_0x244ccc=>{var _0x370bb0=_0x1ad756;_0x244ccc[_0x370bb0(0x134)]==_0x12bf61[_0x370bb0(0x134)]&&_0x244ccc[_0x370bb0(0x1d2)]==_0x12bf61['from_floorlevel']&&_0x244ccc['type']==_0x12bf61['from_types']&&_0x244ccc[_0x370bb0(0x17e)]==_0x12bf61[_0x370bb0(0x140)]&&_0x244ccc[_0x370bb0(0x1de)]==_0x12bf61[_0x370bb0(0x15f)]&&_0x244ccc[_0x370bb0(0x1c2)]==_0x12bf61[_0x370bb0(0x112)]&&_0x244ccc[_0x370bb0(0x10a)]==_0x12bf61[_0x370bb0(0x1d5)]&&(_0x244ccc[_0x370bb0(0x186)]=parseInt(_0x244ccc[_0x370bb0(0x186)])-parseInt(_0x12bf61[_0x370bb0(0x174)]));});}}),await _0x3089c5[_0x4cb8ab(0x19c)]();const _0x713fee=await warehouse[_0x4cb8ab(0x19a)]({'name':_0x2ee242,'room':_0x50d85c});_0x11cd8d[_0x4cb8ab(0xf6)]['forEach'](_0x4d1df3=>{var _0x30fd62=_0x4cb8ab;if(_0x4d1df3[_0x30fd62(0x174)]>0x0){var _0x3b8e6c=0x0;const _0x422a70=_0x713fee['product_details'][_0x30fd62(0x1a7)](_0x5d9b40=>{var _0x4e7a26=_0x30fd62;_0x5d9b40[_0x4e7a26(0x134)]==_0x4d1df3[_0x4e7a26(0x134)]&&_0x5d9b40['floorlevel']==_0x4d1df3['to_floorlevel']&&_0x5d9b40[_0x4e7a26(0x14f)]==_0x4d1df3['to_types']&&_0x5d9b40[_0x4e7a26(0x17e)]==_0x4d1df3[_0x4e7a26(0x150)]&&_0x5d9b40['bay']==_0x4d1df3[_0x4e7a26(0x133)]&&_0x5d9b40[_0x4e7a26(0x1c2)]==_0x4d1df3[_0x4e7a26(0x1c2)]&&_0x5d9b40['storage']==_0x4d1df3[_0x4e7a26(0x10a)]&&(_0x5d9b40[_0x4e7a26(0x186)]=parseInt(_0x5d9b40[_0x4e7a26(0x186)])+parseInt(_0x4d1df3['to_quantity']),_0x3b8e6c++);});_0x3b8e6c=='0'&&(_0x713fee[_0x30fd62(0x1a4)]=_0x713fee[_0x30fd62(0x1a4)][_0x30fd62(0x16c)]({'product_name':_0x4d1df3['product_name'],'product_stock':_0x4d1df3[_0x30fd62(0x174)],'bay':_0x4d1df3['to_bay'],'bin':_0x4d1df3[_0x30fd62(0x150)],'type':_0x4d1df3[_0x30fd62(0x11e)],'floorlevel':_0x4d1df3[_0x30fd62(0x1a9)],'storage':_0x4d1df3[_0x30fd62(0x10a)],'rack':_0x4d1df3[_0x30fd62(0x1c2)],'product_code':_0x4d1df3[_0x30fd62(0x1bd)],'primary_code':_0x4d1df3[_0x30fd62(0x121)],'secondary_code':_0x4d1df3[_0x30fd62(0x199)],'maxProducts':_0x4d1df3[_0x30fd62(0x183)],'storage':_0x4d1df3[_0x30fd62(0x10a)],'rack':_0x4d1df3[_0x30fd62(0x1c2)]}));}}),await _0x713fee[_0x4cb8ab(0x19c)](),_0xa6d7e2[_0x4cb8ab(0x155)](_0x4cb8ab(0x192),_0x4cb8ab(0x15b)),_0xe2cbb[_0x4cb8ab(0x187)]('/transfer/view');}catch(_0xd6a201){console[_0x4cb8ab(0x126)](_0xd6a201);}}),router['post'](a0_0x2e9814(0x1a6),async(_0x47a99f,_0x4e5cd6)=>{var _0x54147f=a0_0x2e9814;const {FromWareHouse:_0x850847,FromRoom:_0x493113,ToWarehouse:_0x39a489,ToRoom:_0x38ebc8,primary_code:_0x5e4777,Roomslist:_0x234592}=_0x47a99f[_0x54147f(0xf5)],_0x434a43=_0x234592[_0x54147f(0x12f)](','),_0x597621=[];async function _0x3e5588(_0x59c1ea){var _0x322ffe=_0x54147f;const _0x270e30=await warehouse['aggregate']([{'$match':{'name':_0x850847,'room':_0x59c1ea}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x5e4777}},{'$group':{'_id':_0x322ffe(0x170),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x322ffe(0x135)},'primary_code':{'$first':_0x322ffe(0x119)},'secondary_code':{'$first':_0x322ffe(0x15e)},'product_code':{'$first':_0x322ffe(0x1b3)},'level':{'$first':_0x322ffe(0x1e0)},'isle':{'$first':_0x322ffe(0xf2)},'type':{'$first':_0x322ffe(0x19d)},'pallet':{'$first':_0x322ffe(0x171)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x322ffe(0x18a)},'rack':{'$first':_0x322ffe(0xfa)},'expiry_date':{'$first':_0x322ffe(0x1ce)},'production_date':{'$first':_0x322ffe(0x1d6)},'batch_code':{'$first':_0x322ffe(0x106)},'maxPerUnit':{'$first':_0x322ffe(0x154)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x322ffe(0x14d)},'maxProducts':{'$first':_0x322ffe(0xf4)},'invoice_product':{'$first':_0x322ffe(0x1af)}}}]),_0x59bcba=await warehouse[_0x322ffe(0x149)]([{'$match':{'name':_0x850847,'room':_0x59c1ea}},{'$unwind':_0x322ffe(0x168)},{'$match':{'product_details.secondary_code':_0x5e4777}},{'$group':{'_id':_0x322ffe(0x170),'name':{'$first':_0x322ffe(0x156)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x322ffe(0x119)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x322ffe(0x1b3)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x322ffe(0xf2)},'type':{'$first':_0x322ffe(0x19d)},'pallet':{'$first':_0x322ffe(0x171)},'unit':{'$first':_0x322ffe(0x137)},'secondary_unit':{'$first':_0x322ffe(0x115)},'storage':{'$first':_0x322ffe(0x18a)},'rack':{'$first':_0x322ffe(0xfa)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x322ffe(0x1d6)},'batch_code':{'$first':_0x322ffe(0x106)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x322ffe(0x14d)},'maxProducts':{'$first':_0x322ffe(0xf4)},'invoice_product':{'$first':'$product_details.invoice'}}}]);if(_0x270e30[_0x322ffe(0x10c)]>0x0)_0x597621[_0x322ffe(0x160)](_0x270e30);else _0x59bcba[_0x322ffe(0x10c)]>0x0&&_0x597621[_0x322ffe(0x160)](_0x59bcba);}const _0xe39287=_0x434a43['map'](_0x4caf74=>_0x3e5588(_0x4caf74));await Promise[_0x54147f(0x145)](_0xe39287),_0x4e5cd6[_0x54147f(0x132)](_0x597621);}),router['post']('/barcode_scanner2',async(_0x498655,_0xa192be)=>{var _0x16aaae=a0_0x2e9814;try{const {FromWareHouse:_0x2a4dbf,FromRoom:_0x170fb7,ToWarehouse:_0x1efb9b,ToRoom:_0x3958d9,secondary_code:_0x2db12b}=_0x498655[_0x16aaae(0xf5)],_0x31c771=await warehouse[_0x16aaae(0x149)]([{'$match':{'name':_0x2a4dbf}},{'$unwind':_0x16aaae(0x168)},{'$match':{'product_details.secondary_code':_0x2db12b}},{'$group':{'_id':_0x16aaae(0x170),'name':{'$first':_0x16aaae(0x156)},'primary_code':{'$first':_0x16aaae(0x119)},'secondary_code':{'$first':_0x16aaae(0x15e)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x16aaae(0x135)},'warehouse':{'$first':'$name'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x16aaae(0x1bc)},'pallet':{'$first':_0x16aaae(0x125)},'maxProducts':{'$first':_0x16aaae(0xf4)},'unit':{'$first':'$product_details.unit'}}}]);_0xa192be[_0x16aaae(0xf9)](0xc8)[_0x16aaae(0x132)](_0x31c771);}catch(_0x399d48){_0xa192be[_0x16aaae(0xf9)](0x194)[_0x16aaae(0x132)]({'message':_0x399d48[_0x16aaae(0x1b5)]});}}),router[a0_0x2e9814(0xef)](a0_0x2e9814(0x1d8),async(_0x3fb3d7,_0x193bf0)=>{var _0x92c48a=a0_0x2e9814;try{const {FromWareHouse:_0x480d76,FromRoom:_0x478063,ToWarehouse:_0x26e4f8,ToRoom:_0x8d3397,product_code:_0x43eb53}=_0x3fb3d7[_0x92c48a(0xf5)],_0x227781=await warehouse[_0x92c48a(0x149)]([{'$match':{'name':_0x480d76}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x43eb53}},{'$group':{'_id':_0x92c48a(0x170),'name':{'$first':_0x92c48a(0x156)},'primary_code':{'$first':_0x92c48a(0x119)},'secondary_code':{'$first':_0x92c48a(0x15e)},'product_code':{'$first':_0x92c48a(0x1b3)},'instock':{'$first':_0x92c48a(0x135)},'warehouse':{'$first':_0x92c48a(0x13e)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x92c48a(0x1bc)},'pallet':{'$first':_0x92c48a(0x125)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'}}}]);_0x193bf0[_0x92c48a(0xf9)](0xc8)[_0x92c48a(0x132)](_0x227781);}catch(_0x5be784){_0x193bf0[_0x92c48a(0xf9)](0x194)['json']({'message':_0x5be784[_0x92c48a(0x1b5)]});}}),router[a0_0x2e9814(0xef)](a0_0x2e9814(0x153),async(_0x3ecec7,_0x4208ea)=>{var _0x30dff4=a0_0x2e9814;const {level:_0x14115f,isle:_0x4877f7,pallet:_0x2fa9,warehouses:_0x59bfc6,room:_0x12a4b7}=_0x3ecec7[_0x30dff4(0xf5)];try{const _0x395021=await warehouse['aggregate']([{'$match':{'name':_0x59bfc6,'room':_0x12a4b7}},{'$unwind':_0x30dff4(0x168)},{'$match':{'product_details.level':parseInt(_0x14115f),'product_details.isle':_0x4877f7,'product_details.pallet':parseInt(_0x2fa9)}},{'$group':{'_id':_0x30dff4(0x170),'name':{'$first':_0x30dff4(0x156)},'product_stock':{'$first':_0x30dff4(0x135)},'level':{'$first':_0x30dff4(0xf7)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x30dff4(0x125)},'maxProducts':{'$first':_0x30dff4(0xf4)}}}]);_0x4208ea[_0x30dff4(0xf9)](0xc8)[_0x30dff4(0x132)](_0x395021);}catch(_0x31f784){_0x4208ea['status'](0x194)[_0x30dff4(0x132)]({'message':_0x31f784['message']});}}),module[a0_0x2e9814(0x1da)]=router;