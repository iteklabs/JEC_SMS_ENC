var a0_0xe83a36=a0_0x2340;(function(_0x4fb90e,_0x9d0b06){var _0x4f293c=a0_0x2340,_0x554251=_0x4fb90e();while(!![]){try{var _0x5271ad=-parseInt(_0x4f293c(0x177))/0x1+-parseInt(_0x4f293c(0x1ac))/0x2+-parseInt(_0x4f293c(0x1eb))/0x3+parseInt(_0x4f293c(0x188))/0x4+parseInt(_0x4f293c(0x1cb))/0x5*(-parseInt(_0x4f293c(0x1f0))/0x6)+-parseInt(_0x4f293c(0x198))/0x7*(parseInt(_0x4f293c(0x206))/0x8)+parseInt(_0x4f293c(0x158))/0x9;if(_0x5271ad===_0x9d0b06)break;else _0x554251['push'](_0x554251['shift']());}catch(_0x3ee078){_0x554251['push'](_0x554251['shift']());}}}(a0_0x1217,0xb3663));const express=require(a0_0xe83a36(0x138)),app=express(),router=express[a0_0xe83a36(0x173)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0xe83a36(0x1ce)),users=require('../public/language/languages.json'),nodemailer=require(a0_0xe83a36(0x17a));function a0_0x1217(){var _0x38bd4e=['$product_details.product_stock','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','edit_transfer_view','all','$product_details.secondary_code','padStart','map','push','status','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Hindi','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','catch','$product_details.floorlevel','$product.to_room_name','from_prod_qty','staff','from_room_name','get','Shelves','Router','French','$product_details.unit','max_per_unit','93251VYuxMP','<tr>','params','nodemailer','$name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','New_Qty_Converted','Rack\x20C','product_details','_id','Rack\x20E','to_types','unit','body','$product_details.expiry_date','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/transfer/view','4383576BhuYuH','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$_id','logo','RMSEmail','id_transaction_id','$product_details.primary_code','$product_details.maxProducts','from_bay','transfer','concat','Spanish','Transfer\x20Mail','from_prod_pallet','from_rack','/CheckingWarehouse','13678vOrUMO','Product\x20Transfer\x20successfully','to_invoice','from_prod_level','password','$product_details.isle','$product_details.rack','Rack\x20B','An\x20error\x20occurred\x20while\x20saving\x20data.','Rack\x20F','Transfer\x20Edit\x20Successfully','floorlevel','Enabled','$product_details.maxPerUnit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','An\x20error\x20occurred.','production_date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','then','to_prod_pallet','841548nsbkTE','Floor','To_invoice','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Logo.png','/barcode_scanner2','floor','Receiving\x20Area','secondary_unit','errors','expiry_date','forEach','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Rack\x20A','from_prod_isle','find','bin','json','primary_code','random','rak','/preview/:id','<span\x20style=\x22float:\x20right;\x22>','</td>','$product','Return\x20Rooms','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','to_prod_qty','$product.from_room_name','$product_details.production_date','warehouse','635MahZIE','English','to_prod_level','../middleware/auth','length','save','slice','getFullYear','\x20</h2>','to_bay','maxperunit','$to_warehouse','port','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','from_quantity','createTransport','findOne','$product_details.invoice','findById','$product_details._id','\x20<>\x20','$product_details.type','Enclosed','$invoice','ToRoomAssigned','to_floorlevel','to_room','Ambient','German','$product_details.bay','log','$product_details.product_name','1611621TGfVWf','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','/view/add_transfer','<strong>\x20Regards\x20</strong>','$product_details.secondary_unit','60066qmfBEr','storage','to_warehouse','render','filter','/view/:id','to_prod_isle','from_bin','Raw\x20Materials','date','English\x20(US)','error','<h5\x20style=\x22text-align:\x20left;\x22>','/../public','from_storage','product_code3','language','aggregate','sendMail','from_types','</h5>','<h5>','432LGAZGg','</tr>','site_title','True','$date','Arabic','message','here','RoomAssigned','getMonth','to_room_name','to_quantity','product_stock','role','MaxStocks_data2','$isAllowEdit','from_warehouse','secondary_code','prod_name','Portuguese','redirect','rack','type','Level','email','$product_details','host','note','product','back','id_transaction','<div>','</div>','TRF-','Arabic\x20(ae)','<tbody\x20style=\x22text-align:\x20center;\x22>','$room','$product_details.storage','success','express','to_bin','<html><head><title></title>','</body></html>','<h2>\x20','Portuguese\x20(BR)','/view','batch_code','Rack\x20D','Email\x20sent\x20successfully','Chinese','$product_details.product_code','master','primary_unit','Transfer\x20Finalize\x20Successfully','$product_details.level','product_code','bay','getDate','image','$product_details.bin','user','post','$product_details.pallet','prod_cat','from_invoice','invoice','$finalize','</tbody>','maxProducts','from_rak','/upload/','18603630kIyLel','string','from_floorlevel','flash','Error\x20Occurs','$product_details.batch_code'];a0_0x1217=function(){return _0x38bd4e;};return a0_0x1217();}router['get'](a0_0xe83a36(0x13e),auth,async(_0x36d789,_0x479163)=>{var _0x27d409=a0_0xe83a36;try{const {username:_0x1b3b46,email:_0x1803f6,role:_0x18fe81}=_0x36d789[_0x27d409(0x14d)],_0x5b429f=_0x36d789[_0x27d409(0x14d)],_0x15d9ee=await profile[_0x27d409(0x1db)]({'email':_0x5b429f[_0x27d409(0x129)]}),_0x4e26bc=await master_shop[_0x27d409(0x1bb)]();console[_0x27d409(0x1e9)](_0x27d409(0x144),_0x4e26bc);let _0x3fdb2e;if(_0x5b429f[_0x27d409(0x11e)]==_0x27d409(0x16f)){const _0x24ed2c=await staff['findOne']({'email':_0x5b429f[_0x27d409(0x129)]});_0x3fdb2e=await transfers[_0x27d409(0x1bb)]({'from_warehouse':_0x24ed2c[_0x27d409(0x1ca)]});}else _0x3fdb2e=await transfers['aggregate']([{'$unwind':_0x27d409(0x1c4)},{'$group':{'_id':_0x27d409(0x18a),'invoice':{'$first':_0x27d409(0x1e2)},'date':{'$first':_0x27d409(0x20a)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x27d409(0x1d6)},'from_room_name':{'$addToSet':_0x27d409(0x1c8)},'to_room_name':{'$addToSet':_0x27d409(0x16d)},'finalize':{'$first':_0x27d409(0x153)},'isAllowEdit':{'$first':_0x27d409(0x120)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4e26bc[0x0]['language']==_0x27d409(0x1fa)){var _0x25ab2f=users[_0x27d409(0x1cc)];console['log'](_0x25ab2f);}else{if(_0x4e26bc[0x0]['language']==_0x27d409(0x169))var _0x25ab2f=users[_0x27d409(0x169)];else{if(_0x4e26bc[0x0]['language']==_0x27d409(0x1e7))var _0x25ab2f=users[_0x27d409(0x1e7)];else{if(_0x4e26bc[0x0]['language']==_0x27d409(0x193))var _0x25ab2f=users['Spanish'];else{if(_0x4e26bc[0x0]['language']==_0x27d409(0x174))var _0x25ab2f=users['French'];else{if(_0x4e26bc[0x0][_0x27d409(0x200)]==_0x27d409(0x13d))var _0x25ab2f=users[_0x27d409(0x124)];else{if(_0x4e26bc[0x0][_0x27d409(0x200)]==_0x27d409(0x142))var _0x25ab2f=users[_0x27d409(0x142)];else{if(_0x4e26bc[0x0][_0x27d409(0x200)]==_0x27d409(0x133))var _0x25ab2f=users[_0x27d409(0x20b)];}}}}}}}_0x479163[_0x27d409(0x1f3)](_0x27d409(0x191),{'success':_0x36d789[_0x27d409(0x15b)](_0x27d409(0x137)),'errors':_0x36d789[_0x27d409(0x15b)]('errors'),'role':_0x5b429f,'profile':_0x15d9ee,'master_shop':_0x4e26bc,'transfer':_0x3fdb2e,'language':_0x25ab2f});}catch(_0x236eb2){console[_0x27d409(0x1e9)](_0x236eb2);}});async function getRandom8DigitNumber(){var _0x472b99=a0_0xe83a36;const _0x19805c=0x989680,_0x3c3aa1=0x5f5e0ff,_0x5ca422=Math[_0x472b99(0x1b2)](Math[_0x472b99(0x1bf)]()*(_0x3c3aa1-_0x19805c+0x1))+_0x19805c;var _0x49eb01;const _0x2b71a1=await transfers[_0x472b99(0x1db)]({'invoice':_0x472b99(0x132)+_0x5ca422});return _0x2b71a1&&_0x2b71a1['length']>0x0?_0x49eb01=_0x472b99(0x132)+_0x5ca422:_0x49eb01=_0x472b99(0x132)+_0x5ca422,_0x49eb01;}router[a0_0xe83a36(0x171)](a0_0xe83a36(0x1ed),auth,async(_0x537b89,_0x4171b9)=>{var _0x4690b7=a0_0xe83a36;try{const {username:_0x4e8665,email:_0x4e2cc5,role:_0x144f4a}=_0x537b89[_0x4690b7(0x14d)],_0x283b36=_0x537b89[_0x4690b7(0x14d)],_0x5abc61=await profile[_0x4690b7(0x1db)]({'email':_0x283b36['email']}),_0x442e08=await master_shop[_0x4690b7(0x1bb)]();console[_0x4690b7(0x1e9)](_0x4690b7(0x144),_0x442e08);let _0x4c80d2;if(_0x283b36[_0x4690b7(0x11e)]==_0x4690b7(0x16f)){const _0x21f7e4=await staff[_0x4690b7(0x1db)]({'email':_0x283b36['email']});_0x4c80d2=await warehouse['aggregate']([{'$match':{'status':_0x4690b7(0x1a4),'name':_0x21f7e4[_0x4690b7(0x1ca)],'warehouse_category':_0x4690b7(0x1f8)}},{'$group':{'_id':_0x4690b7(0x17b),'name':{'$first':'$name'}}}]);}else _0x4c80d2=await warehouse[_0x4690b7(0x201)]([{'$match':{'status':_0x4690b7(0x1a4),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x4690b7(0x17b)}}}]);var _0x550f23=[_0x4690b7(0x1e6),_0x4690b7(0x1e1),_0x4690b7(0x1c5)];const _0x7e41eb=await transfers['find']({}),_0x56ccdd=_0x7e41eb[_0x4690b7(0x1cf)]+0x1,_0x5d1746=_0x4690b7(0x132)+_0x56ccdd['toString']()[_0x4690b7(0x164)](0x5,'0');if(_0x442e08[0x0]['language']==_0x4690b7(0x1fa)){var _0x1aea80=users['English'];console[_0x4690b7(0x1e9)](_0x1aea80);}else{if(_0x442e08[0x0][_0x4690b7(0x200)]==_0x4690b7(0x169))var _0x1aea80=users[_0x4690b7(0x169)];else{if(_0x442e08[0x0][_0x4690b7(0x200)]=='German')var _0x1aea80=users[_0x4690b7(0x1e7)];else{if(_0x442e08[0x0]['language']==_0x4690b7(0x193))var _0x1aea80=users[_0x4690b7(0x193)];else{if(_0x442e08[0x0][_0x4690b7(0x200)]==_0x4690b7(0x174))var _0x1aea80=users[_0x4690b7(0x174)];else{if(_0x442e08[0x0][_0x4690b7(0x200)]==_0x4690b7(0x13d))var _0x1aea80=users[_0x4690b7(0x124)];else{if(_0x442e08[0x0][_0x4690b7(0x200)]==_0x4690b7(0x142))var _0x1aea80=users[_0x4690b7(0x142)];else{if(_0x442e08[0x0][_0x4690b7(0x200)]==_0x4690b7(0x133))var _0x1aea80=users[_0x4690b7(0x20b)];}}}}}}}const _0x4a6e00=getRandom8DigitNumber();_0x4a6e00[_0x4690b7(0x1aa)](_0xa00539=>{var _0x21c9b2=_0x4690b7;_0x4171b9['render']('add_transfer',{'success':_0x537b89['flash'](_0x21c9b2(0x137)),'errors':_0x537b89[_0x21c9b2(0x15b)](_0x21c9b2(0x1b5)),'role':_0x283b36,'profile':_0x5abc61,'master_shop':_0x442e08,'warehouse':_0x4c80d2,'language':_0x1aea80,'rooms_data':_0x550f23,'invoice':_0xa00539});})[_0x4690b7(0x16b)](_0x3054f0=>{var _0x3aaa2b=_0x4690b7;_0x537b89[_0x3aaa2b(0x15b)](_0x3aaa2b(0x1b5),_0x3aaa2b(0x1a6)),_0x4171b9[_0x3aaa2b(0x125)](_0x3aaa2b(0x187));});}catch(_0x14bc31){console[_0x4690b7(0x1e9)](_0x14bc31);}}),router[a0_0xe83a36(0x14e)](a0_0xe83a36(0x1ed),auth,async(_0xf3874d,_0x5dc03b)=>{var _0x205900=a0_0xe83a36;try{console[_0x205900(0x1e9)](_0xf3874d[_0x205900(0x184)]);const {date:_0x27677e,from_warehouse:_0x16c3f6,FromRoom_name:_0x4ba222,to_warehouse:_0x46981f,ToRoom_name:_0x2bc544,prod_name:_0x4118ca,from_prod_qty:_0x50a116,from_prod_level:_0x36c2d0,from_prod_isle:_0x603551,from_prod_pallet:_0x5cb265,to_prod_qty:_0x4041f3,to_prod_level:_0x1dcbe3,to_prod_isle:_0xf7d70e,to_prod_pallet:_0x11ca71,primary_code:_0x4832b2,secondary_code:_0x5f299c,product_code3:_0x3aafc5,note:_0x1b5d4c,MaxStocks_data2:_0x2f25ba,invoice:_0x2d9e30,expiry_date:_0x39103b}=_0xf3874d[_0x205900(0x184)];if(typeof _0x4118ca=='string')var _0x37b0e7=[_0xf3874d[_0x205900(0x184)]['prod_name']],_0x438173=[_0xf3874d[_0x205900(0x184)]['from_prod_qty']],_0x364cde=[_0xf3874d['body'][_0x205900(0x19b)]],_0x54f6d7=[_0xf3874d['body'][_0x205900(0x17d)]],_0x316405=[_0xf3874d[_0x205900(0x184)][_0x205900(0x1cd)]],_0x32727c=[_0xf3874d[_0x205900(0x184)][_0x205900(0x1be)]],_0x43eab0=[_0xf3874d[_0x205900(0x184)][_0x205900(0x122)]],_0x43df16=[_0xf3874d[_0x205900(0x184)][_0x205900(0x1ff)]],_0x5d38d6=[_0xf3874d[_0x205900(0x184)]['MaxStocks_data2']],_0x238a5d=[_0xf3874d[_0x205900(0x184)][_0x205900(0x145)]],_0x39b86c=[_0xf3874d[_0x205900(0x184)][_0x205900(0x1b4)]],_0x13ac93=[_0xf3874d[_0x205900(0x184)]['batch_code']],_0x53ab6d=[_0xf3874d[_0x205900(0x184)][_0x205900(0x1b6)]],_0x5e8846=[_0xf3874d['body'][_0x205900(0x176)]],_0xa54f2e=[_0xf3874d[_0x205900(0x184)][_0x205900(0x1a8)]],_0x3a83ed=[_0xf3874d[_0x205900(0x184)][_0x205900(0x150)]],_0x1705cc=[_0xf3874d[_0x205900(0x184)][_0x205900(0x20e)]],_0x8b23c9=[_0xf3874d['body'][_0x205900(0x1e3)]],_0x22e4eb=[_0xf3874d[_0x205900(0x184)]['from_invoice']],_0x5bd8a0=[_0xf3874d['body'][_0x205900(0x19a)]],_0x200359=[_0xf3874d[_0x205900(0x184)][_0x205900(0x12f)]];else var _0x37b0e7=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x123)]],_0x438173=[..._0xf3874d[_0x205900(0x184)]['from_prod_qty']],_0x364cde=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x19b)]],_0x54f6d7=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x17d)]],_0x316405=[..._0xf3874d['body'][_0x205900(0x1cd)]],_0x32727c=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x1be)]],_0x43eab0=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x122)]],_0x43df16=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x1ff)]],_0x5d38d6=[..._0xf3874d['body'][_0x205900(0x11f)]],_0x238a5d=[..._0xf3874d[_0x205900(0x184)]['primary_unit']],_0x39b86c=[..._0xf3874d['body'][_0x205900(0x1b4)]],_0x13ac93=[..._0xf3874d['body'][_0x205900(0x13f)]],_0x53ab6d=[..._0xf3874d['body'][_0x205900(0x1b6)]],_0x5e8846=[..._0xf3874d['body']['max_per_unit']],_0xa54f2e=[..._0xf3874d[_0x205900(0x184)]['production_date']],_0x3a83ed=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x150)]],_0x1705cc=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x20e)]],_0x8b23c9=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x1e3)]],_0x22e4eb=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x151)]],_0x5bd8a0=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x19a)]],_0x200359=[..._0xf3874d[_0x205900(0x184)][_0x205900(0x12f)]];const _0x49a9e0=_0x37b0e7[_0x205900(0x165)](_0x28dde8=>{return _0x28dde8={'product_name':_0x28dde8};});_0x438173[_0x205900(0x1b7)]((_0x479631,_0x270ee7)=>{var _0x30e688=_0x205900;_0x49a9e0[_0x270ee7][_0x30e688(0x1d9)]=_0x479631;}),_0x22e4eb[_0x205900(0x1b7)]((_0x4dbd78,_0xeaa85e)=>{_0x49a9e0[_0xeaa85e]['from_invoice']=_0x4dbd78;}),_0x5bd8a0['forEach']((_0x3e1898,_0x569d97)=>{var _0x595989=_0x205900;_0x49a9e0[_0x569d97][_0x595989(0x1ae)]=_0x3e1898;}),_0x200359[_0x205900(0x1b7)]((_0x5a5f14,_0x266216)=>{var _0x12e0b9=_0x205900;_0x49a9e0[_0x266216][_0x12e0b9(0x18d)]=_0x5a5f14;}),_0x364cde[_0x205900(0x1b7)]((_0x52ea97,_0xaef09)=>{var _0x25083d=_0x205900;_0x1705cc[_0x25083d(0x1b7)]((_0x536cce,_0xc34a6e)=>{var _0x2a2eda=_0x25083d;if(_0x536cce==_0x2a2eda(0x1b3)&&_0xaef09==_0xc34a6e){var _0x4f3689=_0x52ea97[_0x2a2eda(0x1d1)](0x3);_0x49a9e0[_0xaef09][_0x2a2eda(0x1fe)]=_0x52ea97[0x0],_0x49a9e0[_0xaef09][_0x2a2eda(0x196)]=_0x52ea97[0x1],_0x49a9e0[_0xaef09][_0x2a2eda(0x190)]=0x0,_0x49a9e0[_0xaef09]['from_bin']=0x0,_0x49a9e0[_0xaef09][_0x2a2eda(0x203)]=_0x2a2eda(0x1ad),_0x49a9e0[_0xaef09]['from_floorlevel']=_0x4f3689;}else{if(_0x536cce==_0x2a2eda(0x172)&&_0xaef09==_0xc34a6e){var _0x4f3689=_0x52ea97[_0x2a2eda(0x1d1)](0x3);_0x49a9e0[_0xaef09][_0x2a2eda(0x1fe)]=_0x52ea97[0x0],_0x49a9e0[_0xaef09][_0x2a2eda(0x196)]=_0x52ea97[0x1],_0x49a9e0[_0xaef09][_0x2a2eda(0x190)]=0x0,_0x49a9e0[_0xaef09]['from_bin']=0x0,_0x49a9e0[_0xaef09]['from_types']=_0x2a2eda(0x1ad),_0x49a9e0[_0xaef09][_0x2a2eda(0x15a)]=_0x52ea97[0x5];}else{if(_0xaef09==_0xc34a6e){if(_0x52ea97[0x0]=='A'&&_0x52ea97[0x1]=='L'&&_0x52ea97[0x2]=='L')console['log'](_0x536cce+_0x2a2eda(0x1df)+_0xaef09+_0x2a2eda(0x1df)+_0xc34a6e+_0x2a2eda(0x1df)+_0x52ea97+'here'),_0x49a9e0[_0xaef09][_0x2a2eda(0x1fe)]=_0x52ea97[0x0],_0x49a9e0[_0xaef09][_0x2a2eda(0x196)]=_0x52ea97[0x1],_0x49a9e0[_0xaef09][_0x2a2eda(0x190)]=0x0,_0x49a9e0[_0xaef09][_0x2a2eda(0x1f7)]=0x0,_0x49a9e0[_0xaef09][_0x2a2eda(0x203)]='Floor',_0x49a9e0[_0xaef09][_0x2a2eda(0x15a)]=_0x52ea97[0x3];else{var _0x5e8b4c;if(_0x52ea97[0x4]=='L')_0x5e8b4c=_0x2a2eda(0x128);else _0x52ea97[0x4]=='F'&&(_0x5e8b4c=_0x2a2eda(0x1ad));_0x49a9e0[_0xaef09]['from_storage']=_0x52ea97[0x0],_0x49a9e0[_0xaef09][_0x2a2eda(0x196)]=_0x52ea97[0x1],_0x49a9e0[_0xaef09][_0x2a2eda(0x190)]=_0x52ea97[0x2],_0x49a9e0[_0xaef09][_0x2a2eda(0x1f7)]=_0x52ea97[0x3],_0x49a9e0[_0xaef09][_0x2a2eda(0x203)]=_0x5e8b4c,_0x49a9e0[_0xaef09][_0x2a2eda(0x15a)]=_0x52ea97[0x5];}}}}});}),_0x54f6d7[_0x205900(0x1b7)]((_0x5a3436,_0x50ce34)=>{_0x49a9e0[_0x50ce34]['to_quantity']=_0x5a3436;}),_0x316405[_0x205900(0x1b7)]((_0x7a3e71,_0x1cdf1a)=>{var _0x8c21db=_0x205900;_0x8b23c9[_0x8c21db(0x1b7)]((_0x727806,_0x48585a)=>{var _0x2b97d3=_0x8c21db;if(_0x727806=='Receiving\x20Area'&&_0x1cdf1a==_0x48585a){var _0x2425ec=_0x7a3e71[_0x2b97d3(0x1d1)](0x3);_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1f1)]=_0x7a3e71[0x0],_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x126)]=_0x7a3e71[0x1],_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1d4)]=0x0,_0x49a9e0[_0x1cdf1a]['to_bin']=0x0,_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x182)]='Floor',_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1e4)]=_0x2425ec;}else{if(_0x727806=='Shelves'&&_0x1cdf1a==_0x48585a){var _0x2425ec=_0x7a3e71[_0x2b97d3(0x1d1)](0x3);_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1f1)]=_0x7a3e71[0x0],_0x49a9e0[_0x1cdf1a]['rack']=_0x7a3e71[0x1],_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1d4)]=0x0,_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x139)]=0x0,_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x182)]=_0x2b97d3(0x1ad),_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1e4)]=_0x7a3e71[0x5];}else{if(_0x1cdf1a==_0x48585a){if(_0x7a3e71[0x0]=='A'&&_0x7a3e71[0x1]=='L'&&_0x7a3e71[0x2]=='L')console[_0x2b97d3(0x1e9)](_0x727806+'\x20<>\x20'+_0x1cdf1a+_0x2b97d3(0x1df)+_0x48585a+_0x2b97d3(0x1df)+_0x7a3e71+_0x2b97d3(0x20d)),_0x49a9e0[_0x1cdf1a]['storage']=_0x7a3e71[0x0],_0x49a9e0[_0x1cdf1a]['rack']=_0x7a3e71[0x1],_0x49a9e0[_0x1cdf1a]['to_bay']=0x0,_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x139)]=0x0,_0x49a9e0[_0x1cdf1a]['to_types']='Floor',_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1e4)]=_0x7a3e71[0x3];else{var _0x58a452;if(_0x7a3e71[0x4]=='L')_0x58a452='Level';else _0x7a3e71[0x4]=='F'&&(_0x58a452=_0x2b97d3(0x1ad));_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1f1)]=_0x7a3e71[0x0],_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x126)]=_0x7a3e71[0x1],_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1d4)]=_0x7a3e71[0x2],_0x49a9e0[_0x1cdf1a]['to_bin']=_0x7a3e71[0x3],_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x182)]=_0x58a452,_0x49a9e0[_0x1cdf1a][_0x2b97d3(0x1e4)]=_0x7a3e71[0x5];}}}}});}),_0x32727c[_0x205900(0x1b7)]((_0x5f459d,_0x4f97f1)=>{var _0x2d11a0=_0x205900;_0x49a9e0[_0x4f97f1][_0x2d11a0(0x1be)]=_0x5f459d;}),_0x43eab0[_0x205900(0x1b7)]((_0x392481,_0x958531)=>{_0x49a9e0[_0x958531]['secondary_code']=_0x392481;}),_0x43df16['forEach']((_0x19d2bf,_0x5dea96)=>{_0x49a9e0[_0x5dea96]['product_code']=_0x19d2bf;}),_0x5d38d6['forEach']((_0x592d38,_0x46a575)=>{var _0x19d92f=_0x205900;_0x49a9e0[_0x46a575][_0x19d92f(0x155)]=_0x592d38;}),_0x238a5d[_0x205900(0x1b7)]((_0x10e442,_0xf4b0f5)=>{var _0x37e88b=_0x205900;_0x49a9e0[_0xf4b0f5][_0x37e88b(0x183)]=_0x10e442;}),_0x39b86c[_0x205900(0x1b7)]((_0x56b50d,_0x33863c)=>{var _0x214ebc=_0x205900;_0x49a9e0[_0x33863c][_0x214ebc(0x1b4)]=_0x56b50d;}),_0x13ac93[_0x205900(0x1b7)]((_0x2ea083,_0x284dc3)=>{_0x49a9e0[_0x284dc3]['batch_code']=_0x2ea083;}),_0x53ab6d[_0x205900(0x1b7)]((_0x259b5c,_0x5c3b52)=>{var _0x3a4bf0=_0x205900;_0x49a9e0[_0x5c3b52][_0x3a4bf0(0x1b6)]=_0x259b5c;}),_0x5e8846[_0x205900(0x1b7)]((_0x51553d,_0x1e046c)=>{var _0x1bb9fa=_0x205900;_0x49a9e0[_0x1e046c][_0x1bb9fa(0x1d5)]=_0x51553d;}),_0xa54f2e[_0x205900(0x1b7)]((_0x31bc71,_0x241279)=>{var _0x2fac7f=_0x205900;_0x49a9e0[_0x241279][_0x2fac7f(0x1a8)]=_0x31bc71;}),_0x3a83ed[_0x205900(0x1b7)]((_0x26d590,_0x5c0278)=>{var _0x3fc672=_0x205900;_0x49a9e0[_0x5c0278][_0x3fc672(0x150)]=_0x26d590;}),_0x1705cc[_0x205900(0x1b7)]((_0x471b92,_0x3a444e)=>{var _0x27d288=_0x205900;_0x49a9e0[_0x3a444e][_0x27d288(0x170)]=_0x471b92;}),_0x8b23c9[_0x205900(0x1b7)]((_0x2dec5f,_0x5b070a)=>{var _0x5c1078=_0x205900;_0x49a9e0[_0x5b070a][_0x5c1078(0x210)]=_0x2dec5f;});const _0x6f64bd=_0x49a9e0[_0x205900(0x1f4)](_0x294cec=>_0x294cec[_0x205900(0x211)]!=='0'&&_0x294cec[_0x205900(0x211)]!==''||_0x294cec[_0x205900(0x1e4)]!=='0'&&_0x294cec[_0x205900(0x1e4)]!==''),_0x1c44a6=new transfers({'date':_0x27677e,'from_warehouse':_0x16c3f6,'to_warehouse':_0x46981f,'product':_0x6f64bd,'note':_0x1b5d4c,'invoice':_0x2d9e30}),_0x1f697d=await _0x1c44a6[_0x205900(0x1d0)]();_0xf3874d[_0x205900(0x15b)](_0x205900(0x137),_0x205900(0x199)),_0x5dc03b[_0x205900(0x125)]('/transfer/preview/'+_0x1f697d[_0x205900(0x180)]);}catch(_0xc95f4f){console[_0x205900(0x1e9)](_0xc95f4f),_0x5dc03b[_0x205900(0x167)](0xc8)[_0x205900(0x1bd)]({'errorMessage':_0xc95f4f[_0x205900(0x20c)]});}}),router[a0_0xe83a36(0x171)]('/preview/:id',auth,async(_0x1bd6a3,_0x504bf8)=>{var _0x478f68=a0_0xe83a36;try{const {username:_0x2f7d68,email:_0xead6d3,role:_0x442da0}=_0x1bd6a3['user'],_0x211fba=_0x1bd6a3[_0x478f68(0x14d)],_0x55a2ec=await profile[_0x478f68(0x1db)]({'email':_0x211fba[_0x478f68(0x129)]}),_0x3f8ece=await master_shop[_0x478f68(0x1bb)]();console['log']('master',_0x3f8ece);const _0x896f13=await transfers[_0x478f68(0x1dd)](_0x1bd6a3[_0x478f68(0x179)]['id']);let _0x5fd274=new Date(_0x896f13['expiry_date']),_0x1720b7=('0'+_0x5fd274[_0x478f68(0x14a)]())[_0x478f68(0x1d1)](-0x2),_0x262112=('0'+(_0x5fd274[_0x478f68(0x20f)]()+0x1))[_0x478f68(0x1d1)](-0x2),_0x402440=_0x5fd274[_0x478f68(0x1d2)](),_0x57a68a=_0x402440+'-'+_0x262112+'-'+_0x1720b7,_0x42495a;if(_0x211fba[_0x478f68(0x11e)]=='staff'){const _0x2680e1=await staff[_0x478f68(0x1db)]({'email':_0x211fba[_0x478f68(0x129)]});_0x42495a=await warehouse[_0x478f68(0x1bb)]({'status':_0x478f68(0x1a4),'name':_0x2680e1[_0x478f68(0x1ca)],'warehouse_category':_0x478f68(0x1f8)});}else _0x42495a=await warehouse['find']({'status':_0x478f68(0x1a4),'warehouse_category':'Raw\x20Materials'});const _0x4e3832=await warehouse[_0x478f68(0x201)]([{'$match':{'name':_0x896f13[_0x478f68(0x121)]}},{'$unwind':_0x478f68(0x12a)},{'$group':{'_id':_0x478f68(0x1de),'name':{'$first':_0x478f68(0x1ea)},'product_stock':{'$first':_0x478f68(0x15e)},'bay':{'$first':_0x478f68(0x1e8)},'bin':{'$first':_0x478f68(0x14c)},'type':{'$first':_0x478f68(0x1e0)},'floorlevel':{'$first':_0x478f68(0x16c)},'primary_code':{'$first':_0x478f68(0x18e)},'secondary_code':{'$first':_0x478f68(0x163)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x478f68(0x136)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x478f68(0x185)},'production_date':{'$first':_0x478f68(0x1c9)},'room':{'$first':_0x478f68(0x135)}}}]);if(_0x3f8ece[0x0]['language']==_0x478f68(0x1fa)){var _0x4059b4=users[_0x478f68(0x1cc)];console['log'](_0x4059b4);}else{if(_0x3f8ece[0x0][_0x478f68(0x200)]=='Hindi')var _0x4059b4=users[_0x478f68(0x169)];else{if(_0x3f8ece[0x0][_0x478f68(0x200)]==_0x478f68(0x1e7))var _0x4059b4=users['German'];else{if(_0x3f8ece[0x0][_0x478f68(0x200)]==_0x478f68(0x193))var _0x4059b4=users[_0x478f68(0x193)];else{if(_0x3f8ece[0x0][_0x478f68(0x200)]==_0x478f68(0x174))var _0x4059b4=users[_0x478f68(0x174)];else{if(_0x3f8ece[0x0][_0x478f68(0x200)]==_0x478f68(0x13d))var _0x4059b4=users['Portuguese'];else{if(_0x3f8ece[0x0]['language']=='Chinese')var _0x4059b4=users[_0x478f68(0x142)];else{if(_0x3f8ece[0x0][_0x478f68(0x200)]==_0x478f68(0x133))var _0x4059b4=users[_0x478f68(0x20b)];}}}}}}}_0x504bf8[_0x478f68(0x1f3)](_0x478f68(0x161),{'success':_0x1bd6a3[_0x478f68(0x15b)](_0x478f68(0x137)),'errors':_0x1bd6a3[_0x478f68(0x15b)](_0x478f68(0x1b5)),'role':_0x211fba,'profile':_0x55a2ec,'master_shop':_0x3f8ece,'warehouse':_0x42495a,'transfer':_0x896f13,'stock':_0x4e3832,'language':_0x4059b4});}catch(_0x58f54e){console[_0x478f68(0x1e9)](_0x58f54e);}}),router['post'](a0_0xe83a36(0x1c1),auth,async(_0x5722a9,_0x2598bf)=>{var _0x3c2eeb=a0_0xe83a36;try{const _0x3c403c=_0x5722a9[_0x3c2eeb(0x179)]['id'],{from_warehouse:_0x21e743,FromRoom_name:_0x5b453c,to_warehouse:_0x5c3972,ToRoom_name:_0x15b41f}=_0x5722a9[_0x3c2eeb(0x184)],_0x57ad15=await transfers[_0x3c2eeb(0x1dd)]({'_id':_0x3c403c}),_0x3f25e5=_0x57ad15[_0x3c2eeb(0x12d)][_0x3c2eeb(0x165)](async _0x1cf812=>{var _0x4d44bf=_0x3c2eeb;if(_0x1cf812['to_quantity']>0x0){var _0x5e9500=await warehouse[_0x4d44bf(0x1db)]({'name':_0x57ad15[_0x4d44bf(0x121)],'room':_0x1cf812['from_room_name'],'warehouse_category':'Raw\x20Materials'});const _0x4d1232=_0x5e9500[_0x4d44bf(0x17f)]['map'](_0x509afb=>{var _0x497864=_0x4d44bf;_0x509afb[_0x497864(0x15f)]==_0x1cf812['product_name']&&_0x509afb['floorlevel']==_0x1cf812[_0x497864(0x15a)]&&_0x509afb['type']==_0x1cf812['from_types']&&_0x509afb['bin']==_0x1cf812[_0x497864(0x1f7)]&&_0x509afb[_0x497864(0x149)]==_0x1cf812['from_bay']&&_0x509afb[_0x497864(0x126)]==_0x1cf812[_0x497864(0x196)]&&_0x509afb['storage']==_0x1cf812[_0x497864(0x1fe)]&&_0x509afb[_0x497864(0x1b6)]==_0x1cf812[_0x497864(0x1b6)]&&_0x509afb[_0x497864(0x13f)]==_0x1cf812[_0x497864(0x13f)]&&_0x509afb['production_date']==_0x1cf812[_0x497864(0x1a8)]&&_0x509afb[_0x497864(0x152)]==_0x1cf812['from_invoice']&&_0x509afb[_0x497864(0x180)]==_0x1cf812[_0x497864(0x18d)]&&(_0x509afb[_0x497864(0x11d)]=_0x509afb[_0x497864(0x11d)]-_0x1cf812[_0x497864(0x211)]);});}return _0x5e9500;});Promise[_0x3c2eeb(0x162)](_0x3f25e5)[_0x3c2eeb(0x1aa)](async _0x482389=>{var _0x31e997=_0x3c2eeb;try{for(const _0x1aa4f5 of _0x482389){await _0x1aa4f5[_0x31e997(0x1d0)]();}try{const _0x45a893=_0x57ad15['product']['map'](async _0xb38dbb=>{var _0x264820=_0x31e997;if(_0xb38dbb[_0x264820(0x211)]>0x0){var _0x5eb2a3=await warehouse[_0x264820(0x1db)]({'name':_0x57ad15[_0x264820(0x1f2)],'room':_0xb38dbb[_0x264820(0x210)],'warehouse_category':_0x264820(0x1f8)}),_0x5dbd27=0x0;const _0x4a0b08=_0x5eb2a3[_0x264820(0x17f)]['map'](_0xb4a49b=>{var _0x26b97a=_0x264820;_0xb4a49b[_0x26b97a(0x15f)]==_0xb38dbb[_0x26b97a(0x15f)]&&_0xb4a49b[_0x26b97a(0x1a3)]==_0xb38dbb[_0x26b97a(0x1e4)]&&_0xb4a49b[_0x26b97a(0x127)]==_0xb38dbb[_0x26b97a(0x182)]&&_0xb4a49b['bin']==_0xb38dbb[_0x26b97a(0x139)]&&_0xb4a49b[_0x26b97a(0x149)]==_0xb38dbb['to_bay']&&_0xb4a49b[_0x26b97a(0x126)]==_0xb38dbb['rack']&&_0xb4a49b[_0x26b97a(0x1f1)]==_0xb38dbb[_0x26b97a(0x1f1)]&&_0xb4a49b[_0x26b97a(0x1b6)]==_0xb38dbb[_0x26b97a(0x1b6)]&&_0xb4a49b['batch_code']==_0xb38dbb[_0x26b97a(0x13f)]&&_0xb4a49b[_0x26b97a(0x1a8)]==_0xb38dbb[_0x26b97a(0x1a8)]&&_0xb4a49b['invoice']==_0xb38dbb[_0x26b97a(0x1ae)]&&(_0xb4a49b['product_stock']=_0xb4a49b[_0x26b97a(0x11d)]+_0xb38dbb[_0x26b97a(0x211)],_0x5dbd27++);});_0x5dbd27=='0'&&(_0x5eb2a3[_0x264820(0x17f)]=_0x5eb2a3[_0x264820(0x17f)][_0x264820(0x192)]({'product_name':_0xb38dbb[_0x264820(0x15f)],'product_stock':_0xb38dbb['to_quantity'],'bay':_0xb38dbb[_0x264820(0x1d4)],'bin':_0xb38dbb[_0x264820(0x139)],'type':_0xb38dbb[_0x264820(0x182)],'floorlevel':_0xb38dbb[_0x264820(0x1e4)],'storage':_0xb38dbb[_0x264820(0x1f1)],'rack':_0xb38dbb[_0x264820(0x126)],'product_code':_0xb38dbb[_0x264820(0x148)],'primary_code':_0xb38dbb[_0x264820(0x1be)],'secondary_code':_0xb38dbb[_0x264820(0x122)],'maxProducts':_0xb38dbb['maxProducts'],'storage':_0xb38dbb[_0x264820(0x1f1)],'rack':_0xb38dbb[_0x264820(0x126)],'expiry_date':_0xb38dbb[_0x264820(0x1b6)],'maxPerUnit':_0xb38dbb['maxperunit'],'batch_code':_0xb38dbb['batch_code'],'production_date':_0xb38dbb[_0x264820(0x1a8)]}));}return _0x5eb2a3;});Promise[_0x31e997(0x162)](_0x45a893)['then'](async _0x5403fc=>{var _0xc2daa9=_0x31e997;try{for(const _0x4e365c of _0x5403fc){await warehouse['updateOne']({'_id':_0x4e365c[_0xc2daa9(0x180)]},{'$addToSet':{'product_details':{'$each':_0x4e365c['product_details']}}});}_0x57ad15['finalize']=_0xc2daa9(0x209);const _0x5df94c=await _0x57ad15[_0xc2daa9(0x1d0)](),_0x2d685c=await master_shop[_0xc2daa9(0x1bb)](),_0x4919d0=await email_settings[_0xc2daa9(0x1db)](),_0x4150e6=await supervisor_settings['find']();var _0x54920d=_0x57ad15[_0xc2daa9(0x12d)],_0x1cb0f7='',_0x272768;for(_0x272768 in _0x54920d){_0x1cb0f7+=_0xc2daa9(0x178)+_0xc2daa9(0x1c6)+_0x54920d[_0x272768][_0xc2daa9(0x15f)]+'</td>'+_0xc2daa9(0x1c6)+_0x54920d[_0x272768]['product_code']+_0xc2daa9(0x1c3)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54920d[_0x272768]['to_quantity']+'</td>'+_0xc2daa9(0x1c6)+_0x54920d[_0x272768][_0xc2daa9(0x183)]+_0xc2daa9(0x1c3)+_0xc2daa9(0x1c6)+_0x54920d[_0x272768][_0xc2daa9(0x1b4)]+_0xc2daa9(0x1c3)+_0xc2daa9(0x1c6)+_0x57ad15[_0xc2daa9(0x1f2)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x54920d[_0x272768]['to_room_name']+_0xc2daa9(0x1c3)+_0xc2daa9(0x1c6)+_0x54920d[_0x272768]['storage']+_0x54920d[_0x272768]['rack']+_0x54920d[_0x272768][_0xc2daa9(0x1d4)]+_0x54920d[_0x272768][_0xc2daa9(0x139)]+_0x54920d[_0x272768][_0xc2daa9(0x182)][0x0]+_0x54920d[_0x272768][_0xc2daa9(0x1e4)]+'</td>',_0xc2daa9(0x207);}let _0x20051f=nodemailer[_0xc2daa9(0x1da)]({'host':_0x4919d0[_0xc2daa9(0x12b)],'port':Number(_0x4919d0[_0xc2daa9(0x1d7)]),'secure':![],'auth':{'user':_0x4919d0[_0xc2daa9(0x129)],'pass':_0x4919d0[_0xc2daa9(0x19c)]}}),_0x85fde3={'from':_0x4919d0[_0xc2daa9(0x129)],'to':_0x4150e6[0x0][_0xc2daa9(0x18c)],'subject':_0xc2daa9(0x194),'attachments':[{'filename':_0xc2daa9(0x1b0),'path':__dirname+_0xc2daa9(0x1fd)+_0xc2daa9(0x157)+_0x2d685c[0x0][_0xc2daa9(0x14b)],'cid':_0xc2daa9(0x18b)}],'html':'<!DOCTYPE\x20html>'+_0xc2daa9(0x13a)+'</head><body>'+_0xc2daa9(0x130)+_0xc2daa9(0x1af)+_0xc2daa9(0x130)+_0xc2daa9(0x1a9)+'</div>'+'<div>'+_0xc2daa9(0x13c)+_0x2d685c[0x0][_0xc2daa9(0x208)]+_0xc2daa9(0x1d3)+'</div>'+_0xc2daa9(0x131)+'<hr\x20class=\x22my-3\x22>'+_0xc2daa9(0x130)+_0xc2daa9(0x1fc)+'\x20Order\x20Number\x20:\x20'+_0x57ad15['invoice']+'\x20'+_0xc2daa9(0x1c2)+'\x20Order\x20Date\x20:\x20'+_0x57ad15[_0xc2daa9(0x1f9)]+'\x20'+'</span>'+_0xc2daa9(0x204)+_0xc2daa9(0x131)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xc2daa9(0x17c)+_0xc2daa9(0x178)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0xc2daa9(0x1ec)+_0xc2daa9(0x1d8)+_0xc2daa9(0x189)+_0xc2daa9(0x168)+_0xc2daa9(0x16a)+_0xc2daa9(0x1b8)+_0xc2daa9(0x160)+'</tr>'+'</thead>'+_0xc2daa9(0x134)+'\x20'+_0x1cb0f7+'\x20'+_0xc2daa9(0x154)+'</table>'+_0xc2daa9(0x130)+_0xc2daa9(0x1ee)+_0xc2daa9(0x205)+_0x2d685c[0x0][_0xc2daa9(0x208)]+_0xc2daa9(0x204)+_0xc2daa9(0x131)+_0xc2daa9(0x131)+_0xc2daa9(0x13b)};_0x20051f[_0xc2daa9(0x202)](_0x85fde3,function(_0x5cfc7f,_0x549d87){var _0x523465=_0xc2daa9;_0x5cfc7f?(console[_0x523465(0x1e9)](_0x5cfc7f),console[_0x523465(0x1e9)](_0x523465(0x15c))):console[_0x523465(0x1e9)](_0x523465(0x141));}),_0x5722a9['flash'](_0xc2daa9(0x137),_0xc2daa9(0x146)),_0x2598bf[_0xc2daa9(0x125)]('/picking_list/PDF_transfer_rm/'+_0x5df94c[_0xc2daa9(0x180)]);}catch(_0x378244){console[_0xc2daa9(0x1fb)](_0x378244),_0x2598bf[_0xc2daa9(0x167)](0x1f4)[_0xc2daa9(0x1bd)]({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x378244[_0xc2daa9(0x20c)]});}})[_0x31e997(0x16b)](_0x4b5ab1=>{var _0x2f0b33=_0x31e997;console['error'](_0x4b5ab1),_0x2598bf['status'](0x1f4)[_0x2f0b33(0x1bd)]({'Perror':_0x2f0b33(0x1a7)});});}catch(_0x2a1662){_0x2598bf[_0x31e997(0x1bd)](_0x2a1662);}}catch(_0x493247){console['error'](_0x493247),_0x2598bf[_0x31e997(0x167)](0x1f4)[_0x31e997(0x1bd)]({'Merror':_0x31e997(0x1a0),'Message':_0x493247[_0x31e997(0x20c)]});}})['catch'](_0x44d850=>{var _0x112f3c=_0x3c2eeb;console[_0x112f3c(0x1fb)](_0x44d850),_0x2598bf['status'](0x1f4)[_0x112f3c(0x1bd)]({'Merror':_0x112f3c(0x1a7)});});}catch(_0x436c1){console[_0x3c2eeb(0x1e9)](_0x436c1);}});function BayBinSelected(_0x1523b4,_0x3ebc7f){var _0xb047a9=a0_0xe83a36,_0x46a7d1=[],_0x118a01=[],_0x1738cd=[],_0x4e906e=[],_0x17e2f5=[],_0xf17ae0=[];let _0x37f17d=[];if(_0x1523b4=='DRY\x20STORAGE')switch(_0x3ebc7f){case _0xb047a9(0x1b9):_0x46a7d1=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x118a01=[0x1,0x2],_0x4e906e=[0x1,0x2,0x3,0x4,0x5],_0x1738cd=['Level',_0xb047a9(0x1ad)],_0x17e2f5=['D'],_0xf17ae0=['A'];break;case _0xb047a9(0x19f):_0x46a7d1=[0x6,0x5,0x4,0x3,0x2,0x1],_0x118a01=[0x1,0x2],_0x4e906e=[0x1,0x2,0x3,0x4,0x5],_0x1738cd=['Level',_0xb047a9(0x1ad)],_0x17e2f5=['D'],_0xf17ae0=['B'];break;case _0xb047a9(0x172):_0x46a7d1=[0x0],_0x118a01=[0x0],_0x4e906e=[0x1,0x2,0x3,0x4,0x5],_0x1738cd=[_0xb047a9(0x1ad)],_0x17e2f5=['D'],_0xf17ae0=['S'];break;case _0xb047a9(0x1b3):_0x46a7d1=[0x0],_0x118a01=[0x0],_0x4e906e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x1738cd=[_0xb047a9(0x1ad)],_0x17e2f5=['D'],_0xf17ae0=['R'];break;}else{if(_0x1523b4=='COLD\x20STORAGE')switch(_0x3ebc7f){case _0xb047a9(0x1b9):_0x46a7d1=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x118a01=['B','F'],_0x4e906e=[0x1,0x2,0x3,0x4,0x5],_0x1738cd=[_0xb047a9(0x128),_0xb047a9(0x1ad)],_0x17e2f5=['C'],_0xf17ae0=['A'];break;case _0xb047a9(0x19f):_0x46a7d1=[0x5,0x4,0x3,0x2,0x1],_0x118a01=['F','B','S'],_0x4e906e=[0x1,0x2,0x3,0x4,0x5],_0x1738cd=[_0xb047a9(0x128),'Floor'],_0x17e2f5=['C'],_0xf17ae0=['B'];break;case _0xb047a9(0x17e):_0x46a7d1=[0x1,0x2,0x3,0x4,0x5],_0x118a01=['B','F','S'],_0x4e906e=[0x5,0x4,0x3,0x2,0x1],_0x1738cd=[_0xb047a9(0x128),_0xb047a9(0x1ad)],_0x17e2f5=['C'],_0xf17ae0=['C'];break;case _0xb047a9(0x140):_0x46a7d1=[0x5,0x4,0x3,0x2,0x1],_0x118a01=['F','B','S'],_0x4e906e=[0x1,0x2,0x3,0x4,0x5],_0x1738cd=[_0xb047a9(0x128),_0xb047a9(0x1ad)],_0x17e2f5=['C'],_0xf17ae0=['D'];break;case _0xb047a9(0x181):_0x46a7d1=[0x4,0x3,0x2,0x1],_0x118a01=[0x1,0x2],_0x4e906e=[0x1,0x2,0x3,0x4,0x5],_0x1738cd=['Level','Floor'],_0x17e2f5=['C'],_0xf17ae0=['E'];break;case _0xb047a9(0x1a1):_0x46a7d1=[0x1,0x2,0x3],_0x118a01=[0x1,0x2],_0x4e906e=[0x1,0x2,0x3,0x4,0x5],_0x1738cd=[_0xb047a9(0x128)],_0x17e2f5=['C'],_0xf17ae0=['F'];break;}}return{'levels':_0x46a7d1,'Isle':_0x118a01,'rack':_0x4e906e,'type':_0x1738cd,'storage':_0x17e2f5,'rak':_0xf17ae0};}function a0_0x2340(_0x25ec75,_0x17592d){var _0x1217e1=a0_0x1217();return a0_0x2340=function(_0x2340ae,_0x4c516f){_0x2340ae=_0x2340ae-0x11d;var _0x21f6df=_0x1217e1[_0x2340ae];return _0x21f6df;},a0_0x2340(_0x25ec75,_0x17592d);}router['get']('/view/:id',auth,async(_0x17d015,_0x41740d)=>{var _0x2012a8=a0_0xe83a36;try{const {username:_0x4b755b,email:_0x312f00,role:_0x1b94ce}=_0x17d015[_0x2012a8(0x14d)],_0x515dff=_0x17d015[_0x2012a8(0x14d)],_0x52c116=await profile[_0x2012a8(0x1db)]({'email':_0x515dff['email']}),_0x489873=await master_shop[_0x2012a8(0x1bb)](),_0x156bff=await transfers['findById'](_0x17d015[_0x2012a8(0x179)]['id']);let _0x56f279;if(_0x515dff[_0x2012a8(0x11e)]==_0x2012a8(0x16f)){const _0x135ad2=await staff[_0x2012a8(0x1db)]({'email':_0x515dff[_0x2012a8(0x129)]});_0x56f279=await warehouse[_0x2012a8(0x201)]([{'$match':{'status':_0x2012a8(0x1a4),'name':_0x135ad2[_0x2012a8(0x1ca)],'warehouse_category':_0x2012a8(0x1f8)}},{'$group':{'_id':_0x2012a8(0x17b),'name':{'$first':_0x2012a8(0x17b)}}}]);}else _0x56f279=await warehouse[_0x2012a8(0x201)]([{'$match':{'status':_0x2012a8(0x1a4),'warehouse_category':_0x2012a8(0x1f8)}},{'$group':{'_id':_0x2012a8(0x17b),'name':{'$first':'$name'}}}]);const _0x8cabf8=await warehouse[_0x2012a8(0x201)]([{'$match':{'name':_0x156bff[_0x2012a8(0x121)],'warehouse_category':_0x2012a8(0x1f8)}},{'$unwind':_0x2012a8(0x12a)},{'$group':{'_id':_0x2012a8(0x1de),'name':{'$first':_0x2012a8(0x1ea)},'product_stock':{'$first':_0x2012a8(0x15e)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2012a8(0x1e0)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2012a8(0x18e)},'secondary_code':{'$first':_0x2012a8(0x163)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2012a8(0x136)},'rack':{'$first':_0x2012a8(0x19e)},'expiry_date':{'$first':_0x2012a8(0x185)},'production_date':{'$first':_0x2012a8(0x1c9)},'room':{'$first':_0x2012a8(0x135)}}}]),_0x5d6c1d=await product[_0x2012a8(0x1bb)]({}),_0x5ebf93=BayBinSelected(_0x156bff[_0x2012a8(0x1f2)],_0x156bff[_0x2012a8(0x1e5)]);if(_0x489873[0x0]['language']==_0x2012a8(0x1fa)){var _0x574dca=users[_0x2012a8(0x1cc)];console[_0x2012a8(0x1e9)](_0x574dca);}else{if(_0x489873[0x0]['language']==_0x2012a8(0x169))var _0x574dca=users['Hindi'];else{if(_0x489873[0x0][_0x2012a8(0x200)]==_0x2012a8(0x1e7))var _0x574dca=users[_0x2012a8(0x1e7)];else{if(_0x489873[0x0][_0x2012a8(0x200)]==_0x2012a8(0x193))var _0x574dca=users[_0x2012a8(0x193)];else{if(_0x489873[0x0]['language']==_0x2012a8(0x174))var _0x574dca=users['French'];else{if(_0x489873[0x0][_0x2012a8(0x200)]==_0x2012a8(0x13d))var _0x574dca=users[_0x2012a8(0x124)];else{if(_0x489873[0x0][_0x2012a8(0x200)]==_0x2012a8(0x142))var _0x574dca=users[_0x2012a8(0x142)];else{if(_0x489873[0x0][_0x2012a8(0x200)]=='Arabic\x20(ae)')var _0x574dca=users[_0x2012a8(0x20b)];}}}}}}}_0x41740d[_0x2012a8(0x1f3)]('edit_transfer',{'success':_0x17d015[_0x2012a8(0x15b)](_0x2012a8(0x137)),'errors':_0x17d015[_0x2012a8(0x15b)](_0x2012a8(0x1b5)),'role':_0x515dff,'profile':_0x52c116,'master_shop':_0x489873,'warehouse':_0x56f279,'transfer':_0x156bff,'stock':_0x8cabf8,'unit':_0x5d6c1d,'language':_0x574dca});}catch(_0x17b54e){console[_0x2012a8(0x1e9)](_0x17b54e);}}),router['post'](a0_0xe83a36(0x1f5),auth,async(_0x2f55a7,_0x3843c6)=>{var _0xdc75ca=a0_0xe83a36;try{const _0x253a8e=_0x2f55a7[_0xdc75ca(0x179)]['id'],_0x1844f7=await transfers[_0xdc75ca(0x1dd)](_0x253a8e);_0x3843c6[_0xdc75ca(0x1bd)](_0x2f55a7['body']);return;const {date:_0x5ecf44,from_warehouse:_0x1923b4,FromRoom_name:_0x565598,to_warehouse:_0xaaa2ad,ToRoom_name:_0x2083b6,prod_name:_0x4b4b40,from_prod_qty:_0x12503e,from_prod_level:_0x6a5f1a,from_prod_isle:_0x20296d,from_prod_pallet:_0x404e0e,to_prod_qty:_0x75cdc,to_prod_level:_0x3f12a5,to_prod_isle:_0x5ee217,to_prod_pallet:_0x2ebc5d,primary_code:_0xeec62a,secondary_code:_0x5813a9,product_code3:_0x472f6e,note:_0x3bdb34,invoice:_0x39e344,expiry_date:_0x66a873}=_0x2f55a7[_0xdc75ca(0x184)];if(typeof _0x4b4b40==_0xdc75ca(0x159))var _0x444ae8=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x123)]],_0x43681f=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x16e)]],_0x59c613=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x19b)]],_0x41257=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1ba)]],_0x39c124=[_0x2f55a7[_0xdc75ca(0x184)]['from_prod_pallet']],_0x3db7a2=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x203)]],_0x536ebd=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1c7)]],_0x112689=[_0x2f55a7['body'][_0xdc75ca(0x1cd)]],_0x4d54e5=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1f6)]],_0x2c2bd7=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1ab)]],_0x1b4a9b=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x182)]],_0x33062e=[_0x2f55a7[_0xdc75ca(0x184)]['storage']],_0x92caba=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1c0)]],_0x45f2ec=[_0x2f55a7[_0xdc75ca(0x184)]['primary_code']],_0x135afd=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x122)]],_0x4a1832=[_0x2f55a7['body'][_0xdc75ca(0x1ff)]],_0x5c67c8=[_0x2f55a7['body']['MaxStocks_data2']],_0x5a83cb=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x183)]],_0x2f53a6=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1b4)]],_0x596bf9=[_0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x13f)]],_0x1d3c46=[_0x2f55a7[_0xdc75ca(0x184)]['expiry_date']],_0x27a612=[_0x2f55a7['body'][_0xdc75ca(0x1fe)]],_0x1c1170=[_0x2f55a7['body'][_0xdc75ca(0x156)]];else var _0x444ae8=[..._0x2f55a7['body']['prod_name']],_0x33062e=[..._0x2f55a7['body'][_0xdc75ca(0x1f1)]],_0x92caba=[..._0x2f55a7['body'][_0xdc75ca(0x1c0)]],_0x3db7a2=[..._0x2f55a7[_0xdc75ca(0x184)]['from_types']],_0x1b4a9b=[..._0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x182)]],_0x43681f=[..._0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x16e)]],_0x59c613=[..._0x2f55a7['body'][_0xdc75ca(0x19b)]],_0x41257=[..._0x2f55a7['body'][_0xdc75ca(0x1ba)]],_0x39c124=[..._0x2f55a7['body'][_0xdc75ca(0x195)]],_0x536ebd=[..._0x2f55a7[_0xdc75ca(0x184)]['to_prod_qty']],_0x112689=[..._0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1cd)]],_0x4d54e5=[..._0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1f6)]],_0x2c2bd7=[..._0x2f55a7['body']['to_prod_pallet']],_0x45f2ec=[..._0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1be)]],_0x135afd=[..._0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x122)]],_0x4a1832=[..._0x2f55a7['body'][_0xdc75ca(0x1ff)]],_0x5c67c8=[..._0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x11f)]],_0x5a83cb=[..._0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x183)]],_0x2f53a6=[..._0x2f55a7[_0xdc75ca(0x184)][_0xdc75ca(0x1b4)]],_0x596bf9=[..._0x2f55a7['body'][_0xdc75ca(0x13f)]],_0x1d3c46=[..._0x2f55a7['body'][_0xdc75ca(0x1b6)]],_0x27a612=[..._0x2f55a7['body'][_0xdc75ca(0x1fe)]],_0x1c1170=[..._0x2f55a7['body'][_0xdc75ca(0x156)]];const _0x4c5e8e=_0x444ae8['map'](_0x5c913f=>{return _0x5c913f={'product_name':_0x5c913f};});_0x43681f[_0xdc75ca(0x1b7)]((_0x1939b8,_0x36bc62)=>{var _0x3f1362=_0xdc75ca;_0x4c5e8e[_0x36bc62][_0x3f1362(0x1d9)]=_0x1939b8;}),_0x59c613[_0xdc75ca(0x1b7)]((_0x1f17b8,_0x4361e7)=>{var _0x189c59=_0xdc75ca;_0x4c5e8e[_0x4361e7][_0x189c59(0x190)]=_0x1f17b8;}),_0x41257['forEach']((_0x26a356,_0x421fb5)=>{var _0x9de708=_0xdc75ca;_0x4c5e8e[_0x421fb5][_0x9de708(0x1f7)]=_0x26a356;}),_0x39c124[_0xdc75ca(0x1b7)]((_0x35191c,_0x5e41a1)=>{var _0x5e26a9=_0xdc75ca;_0x4c5e8e[_0x5e41a1][_0x5e26a9(0x15a)]=_0x35191c;}),_0x536ebd['forEach']((_0x148052,_0xfd7b7c)=>{var _0x2fc952=_0xdc75ca;_0x4c5e8e[_0xfd7b7c][_0x2fc952(0x211)]=_0x148052;}),_0x112689[_0xdc75ca(0x1b7)]((_0x5278c1,_0x1621a1)=>{_0x4c5e8e[_0x1621a1]['to_bay']=_0x5278c1;}),_0x4d54e5['forEach']((_0x1c36d4,_0xe15a40)=>{var _0x353aa6=_0xdc75ca;_0x4c5e8e[_0xe15a40][_0x353aa6(0x139)]=_0x1c36d4;}),_0x2c2bd7['forEach']((_0x83ce3d,_0x2051c7)=>{var _0x447a37=_0xdc75ca;_0x4c5e8e[_0x2051c7][_0x447a37(0x1e4)]=_0x83ce3d;}),_0x45f2ec['forEach']((_0x565409,_0x3d70c9)=>{var _0x55448e=_0xdc75ca;_0x4c5e8e[_0x3d70c9][_0x55448e(0x1be)]=_0x565409;}),_0x135afd[_0xdc75ca(0x1b7)]((_0x24b607,_0x404105)=>{_0x4c5e8e[_0x404105]['secondary_code']=_0x24b607;}),_0x4a1832['forEach']((_0x197f48,_0x48b474)=>{var _0x1b4a95=_0xdc75ca;_0x4c5e8e[_0x48b474][_0x1b4a95(0x148)]=_0x197f48;}),_0x5c67c8['forEach']((_0x3ccc93,_0x439fae)=>{var _0x3d1644=_0xdc75ca;_0x4c5e8e[_0x439fae][_0x3d1644(0x155)]=_0x3ccc93;}),_0x5a83cb[_0xdc75ca(0x1b7)]((_0x29d922,_0x9f5f58)=>{_0x4c5e8e[_0x9f5f58]['unit']=_0x29d922;}),_0x2f53a6['forEach']((_0x53a8b2,_0x22dd2e)=>{var _0x515d10=_0xdc75ca;_0x4c5e8e[_0x22dd2e][_0x515d10(0x1b4)]=_0x53a8b2;}),_0x596bf9[_0xdc75ca(0x1b7)]((_0x44e5ac,_0x259c9c)=>{var _0x9f1412=_0xdc75ca;_0x4c5e8e[_0x259c9c][_0x9f1412(0x13f)]=_0x44e5ac;}),_0x1d3c46['forEach']((_0x2443bf,_0x533184)=>{var _0x3364d0=_0xdc75ca;_0x4c5e8e[_0x533184][_0x3364d0(0x1b6)]=_0x2443bf;}),_0x33062e[_0xdc75ca(0x1b7)]((_0x5c2f86,_0x5ed795)=>{var _0x544db6=_0xdc75ca;_0x4c5e8e[_0x5ed795][_0x544db6(0x1f1)]=_0x5c2f86;}),_0x92caba[_0xdc75ca(0x1b7)]((_0x13c7a6,_0x1f07f7)=>{var _0x111d79=_0xdc75ca;_0x4c5e8e[_0x1f07f7][_0x111d79(0x126)]=_0x13c7a6;}),_0x3db7a2['forEach']((_0x3ef1fe,_0x49ab56)=>{var _0x583b6d=_0xdc75ca;_0x4c5e8e[_0x49ab56][_0x583b6d(0x203)]=_0x3ef1fe;}),_0x1b4a9b[_0xdc75ca(0x1b7)]((_0x1634e4,_0x411250)=>{var _0x348310=_0xdc75ca;_0x4c5e8e[_0x411250][_0x348310(0x182)]=_0x1634e4;}),_0x27a612[_0xdc75ca(0x1b7)]((_0x5020d1,_0x15e187)=>{var _0x17eaab=_0xdc75ca;_0x4c5e8e[_0x15e187][_0x17eaab(0x1fe)]=_0x5020d1;}),_0x1c1170[_0xdc75ca(0x1b7)]((_0x971ba,_0x1922aa)=>{_0x4c5e8e[_0x1922aa]['from_rack']=_0x971ba;});const _0x540672=_0x4c5e8e['filter'](_0x31050e=>_0x31050e['to_quantity']!=='0'&&_0x31050e[_0xdc75ca(0x211)]!==''||_0x31050e['to_floorlevel']!=='0'&&_0x31050e[_0xdc75ca(0x1e4)]!=='');var _0x2ed7ec=0x0;_0x540672['forEach'](_0x5903a1=>{var _0x3e2388=_0xdc75ca;parseInt(_0x5903a1[_0x3e2388(0x1d9)])<parseInt(_0x5903a1[_0x3e2388(0x211)])&&_0x2ed7ec++;});if(_0x2ed7ec!=0x0)return _0x2f55a7[_0xdc75ca(0x15b)](_0xdc75ca(0x1b5),_0xdc75ca(0x186)),_0x3843c6[_0xdc75ca(0x125)](_0xdc75ca(0x12e));const _0x26e6ae=await warehouse[_0xdc75ca(0x1db)]({'name':_0x1844f7['from_warehouse'],'room':_0x1844f7['from_room']});_0x1844f7[_0xdc75ca(0x12d)]['forEach'](_0x230fcb=>{var _0x2ecaf6=_0xdc75ca;if(_0x230fcb[_0x2ecaf6(0x211)]>0x0){const _0x2cabbb=_0x26e6ae[_0x2ecaf6(0x17f)][_0x2ecaf6(0x165)](_0x19c222=>{var _0x7e9d8e=_0x2ecaf6;_0x19c222[_0x7e9d8e(0x15f)]==_0x230fcb['product_name']&&_0x19c222[_0x7e9d8e(0x1a3)]==_0x230fcb[_0x7e9d8e(0x15a)]&&_0x19c222[_0x7e9d8e(0x127)]==_0x230fcb[_0x7e9d8e(0x203)]&&_0x19c222[_0x7e9d8e(0x1bc)]==_0x230fcb[_0x7e9d8e(0x1f7)]&&_0x19c222[_0x7e9d8e(0x149)]==_0x230fcb[_0x7e9d8e(0x190)]&&_0x19c222[_0x7e9d8e(0x126)]==_0x230fcb[_0x7e9d8e(0x196)]&&_0x19c222[_0x7e9d8e(0x1f1)]==_0x230fcb[_0x7e9d8e(0x1fe)]&&(_0x19c222[_0x7e9d8e(0x11d)]=parseInt(_0x19c222['product_stock'])+parseInt(_0x230fcb[_0x7e9d8e(0x211)]));});}}),await _0x26e6ae[_0xdc75ca(0x1d0)]();const _0x328ab6=await warehouse[_0xdc75ca(0x1db)]({'name':_0x1844f7[_0xdc75ca(0x1f2)],'room':_0x1844f7[_0xdc75ca(0x1e5)]});_0x1844f7['product'][_0xdc75ca(0x1b7)](_0x5bd72d=>{var _0x4ee7c0=_0xdc75ca;if(_0x5bd72d[_0x4ee7c0(0x211)]>0x0){const _0x4cd8af=_0x328ab6[_0x4ee7c0(0x17f)][_0x4ee7c0(0x165)](_0x133879=>{var _0x6bb72f=_0x4ee7c0;_0x133879[_0x6bb72f(0x15f)]==_0x5bd72d[_0x6bb72f(0x15f)]&&_0x133879[_0x6bb72f(0x1a3)]==_0x5bd72d['to_floorlevel']&&_0x133879[_0x6bb72f(0x127)]==_0x5bd72d[_0x6bb72f(0x182)]&&_0x133879[_0x6bb72f(0x1bc)]==_0x5bd72d[_0x6bb72f(0x139)]&&_0x133879[_0x6bb72f(0x149)]==_0x5bd72d[_0x6bb72f(0x1d4)]&&_0x133879[_0x6bb72f(0x126)]==_0x5bd72d[_0x6bb72f(0x126)]&&_0x133879[_0x6bb72f(0x1f1)]==_0x5bd72d[_0x6bb72f(0x1f1)]&&(_0x133879[_0x6bb72f(0x11d)]=parseInt(_0x133879['product_stock'])-parseInt(_0x5bd72d[_0x6bb72f(0x211)]));});}}),await _0x328ab6[_0xdc75ca(0x1d0)](),_0x1844f7[_0xdc75ca(0x1f9)]=_0x5ecf44,_0x1844f7[_0xdc75ca(0x121)]=_0x1923b4,_0x1844f7[_0xdc75ca(0x1f2)]=_0xaaa2ad,_0x1844f7['product']=_0x540672,_0x1844f7[_0xdc75ca(0x12c)]=_0x3bdb34,_0x1844f7[_0xdc75ca(0x152)]=_0x39e344;const _0x357a29=await _0x1844f7[_0xdc75ca(0x1d0)]();console[_0xdc75ca(0x1e9)](_0x357a29);const _0x24bae0=await warehouse[_0xdc75ca(0x1db)]({'name':_0x1923b4,'room':_0x565598});_0x357a29['product']['forEach'](_0x2cfd78=>{var _0x2e7b70=_0xdc75ca;if(_0x2cfd78[_0x2e7b70(0x211)]>0x0){const _0x366564=_0x24bae0['product_details'][_0x2e7b70(0x165)](_0x1357e2=>{var _0x4d7f95=_0x2e7b70;_0x1357e2[_0x4d7f95(0x15f)]==_0x2cfd78[_0x4d7f95(0x15f)]&&_0x1357e2[_0x4d7f95(0x1a3)]==_0x2cfd78[_0x4d7f95(0x15a)]&&_0x1357e2[_0x4d7f95(0x127)]==_0x2cfd78[_0x4d7f95(0x203)]&&_0x1357e2[_0x4d7f95(0x1bc)]==_0x2cfd78[_0x4d7f95(0x1f7)]&&_0x1357e2[_0x4d7f95(0x149)]==_0x2cfd78[_0x4d7f95(0x190)]&&_0x1357e2[_0x4d7f95(0x126)]==_0x2cfd78['from_rack']&&_0x1357e2[_0x4d7f95(0x1f1)]==_0x2cfd78[_0x4d7f95(0x1fe)]&&(_0x1357e2[_0x4d7f95(0x11d)]=parseInt(_0x1357e2['product_stock'])-parseInt(_0x2cfd78[_0x4d7f95(0x211)]));});}}),await _0x24bae0[_0xdc75ca(0x1d0)]();const _0x5847f0=await warehouse[_0xdc75ca(0x1db)]({'name':_0xaaa2ad,'room':_0x2083b6});_0x357a29[_0xdc75ca(0x12d)][_0xdc75ca(0x1b7)](_0x1dc2e4=>{var _0x47e025=_0xdc75ca;if(_0x1dc2e4[_0x47e025(0x211)]>0x0){var _0x596954=0x0;const _0x4f13dc=_0x5847f0[_0x47e025(0x17f)][_0x47e025(0x165)](_0x4997ea=>{var _0x428e5c=_0x47e025;_0x4997ea[_0x428e5c(0x15f)]==_0x1dc2e4[_0x428e5c(0x15f)]&&_0x4997ea[_0x428e5c(0x1a3)]==_0x1dc2e4[_0x428e5c(0x1e4)]&&_0x4997ea[_0x428e5c(0x127)]==_0x1dc2e4[_0x428e5c(0x182)]&&_0x4997ea['bin']==_0x1dc2e4['to_bin']&&_0x4997ea[_0x428e5c(0x149)]==_0x1dc2e4[_0x428e5c(0x1d4)]&&_0x4997ea['rack']==_0x1dc2e4[_0x428e5c(0x126)]&&_0x4997ea['storage']==_0x1dc2e4[_0x428e5c(0x1f1)]&&(_0x4997ea['product_stock']=parseInt(_0x4997ea[_0x428e5c(0x11d)])+parseInt(_0x1dc2e4[_0x428e5c(0x211)]),_0x596954++);});_0x596954=='0'&&(_0x5847f0['product_details']=_0x5847f0[_0x47e025(0x17f)][_0x47e025(0x192)]({'product_name':_0x1dc2e4[_0x47e025(0x15f)],'product_stock':_0x1dc2e4['to_quantity'],'bay':_0x1dc2e4['to_bay'],'bin':_0x1dc2e4[_0x47e025(0x139)],'type':_0x1dc2e4[_0x47e025(0x182)],'floorlevel':_0x1dc2e4[_0x47e025(0x1e4)],'storage':_0x1dc2e4[_0x47e025(0x1f1)],'rack':_0x1dc2e4[_0x47e025(0x126)],'product_code':_0x1dc2e4['product_code'],'primary_code':_0x1dc2e4[_0x47e025(0x1be)],'secondary_code':_0x1dc2e4[_0x47e025(0x122)],'maxProducts':_0x1dc2e4[_0x47e025(0x155)],'storage':_0x1dc2e4[_0x47e025(0x1f1)],'rack':_0x1dc2e4[_0x47e025(0x126)]}));}}),await _0x5847f0[_0xdc75ca(0x1d0)](),_0x2f55a7[_0xdc75ca(0x15b)](_0xdc75ca(0x137),_0xdc75ca(0x1a2)),_0x3843c6[_0xdc75ca(0x125)]('/transfer/view');}catch(_0x3dee48){console[_0xdc75ca(0x1e9)](_0x3dee48);}}),router['post']('/barcode_scanner',async(_0x1c536e,_0x39e5b4)=>{var _0x22542a=a0_0xe83a36;const {FromWareHouse:_0x543bb1,FromRoom:_0x3ad3a3,ToWarehouse:_0x477eae,ToRoom:_0x2d9991,primary_code:_0x13de0e,Roomslist:_0x104c92}=_0x1c536e['body'],_0x28ce1e=_0x104c92['split'](','),_0x1aa8b3=[];async function _0x25c4a2(_0xdc34f6){var _0x3fa6b9=a0_0x2340;const _0x4024f9=await warehouse[_0x3fa6b9(0x201)]([{'$match':{'name':_0x543bb1,'room':_0xdc34f6}},{'$unwind':_0x3fa6b9(0x12a)},{'$match':{'product_details.primary_code':_0x13de0e}},{'$group':{'_id':_0x3fa6b9(0x1de),'name':{'$first':_0x3fa6b9(0x1ea)},'instock':{'$first':_0x3fa6b9(0x15e)},'primary_code':{'$first':_0x3fa6b9(0x18e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3fa6b9(0x1e8)},'isle':{'$first':_0x3fa6b9(0x14c)},'type':{'$first':_0x3fa6b9(0x1e0)},'pallet':{'$first':_0x3fa6b9(0x16c)},'unit':{'$first':_0x3fa6b9(0x175)},'secondary_unit':{'$first':_0x3fa6b9(0x1ef)},'storage':{'$first':_0x3fa6b9(0x136)},'rack':{'$first':_0x3fa6b9(0x19e)},'expiry_date':{'$first':_0x3fa6b9(0x185)},'production_date':{'$first':_0x3fa6b9(0x1c9)},'batch_code':{'$first':_0x3fa6b9(0x15d)},'maxPerUnit':{'$first':_0x3fa6b9(0x1a5)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x3fa6b9(0x18f)},'invoice_product':{'$first':_0x3fa6b9(0x1dc)}}}]),_0x54047f=await warehouse[_0x3fa6b9(0x201)]([{'$match':{'name':_0x543bb1,'room':_0xdc34f6}},{'$unwind':_0x3fa6b9(0x12a)},{'$match':{'product_details.secondary_code':_0x13de0e}},{'$group':{'_id':_0x3fa6b9(0x1de),'name':{'$first':_0x3fa6b9(0x1ea)},'instock':{'$first':_0x3fa6b9(0x15e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3fa6b9(0x163)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3fa6b9(0x1e8)},'isle':{'$first':_0x3fa6b9(0x14c)},'type':{'$first':_0x3fa6b9(0x1e0)},'pallet':{'$first':_0x3fa6b9(0x16c)},'unit':{'$first':_0x3fa6b9(0x175)},'secondary_unit':{'$first':_0x3fa6b9(0x1ef)},'storage':{'$first':_0x3fa6b9(0x136)},'rack':{'$first':_0x3fa6b9(0x19e)},'expiry_date':{'$first':_0x3fa6b9(0x185)},'production_date':{'$first':_0x3fa6b9(0x1c9)},'batch_code':{'$first':_0x3fa6b9(0x15d)},'maxPerUnit':{'$first':_0x3fa6b9(0x1a5)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x3fa6b9(0x135)},'maxProducts':{'$first':_0x3fa6b9(0x18f)},'invoice_product':{'$first':_0x3fa6b9(0x1dc)}}}]);if(_0x4024f9['length']>0x0)_0x1aa8b3['push'](_0x4024f9);else _0x54047f[_0x3fa6b9(0x1cf)]>0x0&&_0x1aa8b3[_0x3fa6b9(0x166)](_0x54047f);}const _0x45c17b=_0x28ce1e[_0x22542a(0x165)](_0x5ed3ea=>_0x25c4a2(_0x5ed3ea));await Promise['all'](_0x45c17b),_0x39e5b4[_0x22542a(0x1bd)](_0x1aa8b3);}),router['post'](a0_0xe83a36(0x1b1),async(_0x57cc4b,_0x554b82)=>{var _0x1cdd55=a0_0xe83a36;try{const {FromWareHouse:_0x7e1025,FromRoom:_0xd8e8e6,ToWarehouse:_0x5c464c,ToRoom:_0x297470,secondary_code:_0x117c18}=_0x57cc4b['body'],_0x4f08a0=await warehouse[_0x1cdd55(0x201)]([{'$match':{'name':_0x7e1025}},{'$unwind':_0x1cdd55(0x12a)},{'$match':{'product_details.secondary_code':_0x117c18}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1cdd55(0x1ea)},'primary_code':{'$first':_0x1cdd55(0x18e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1cdd55(0x143)},'instock':{'$first':_0x1cdd55(0x15e)},'warehouse':{'$first':'$name'},'level':{'$first':_0x1cdd55(0x147)},'isle':{'$first':_0x1cdd55(0x19d)},'pallet':{'$first':_0x1cdd55(0x14f)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x1cdd55(0x175)}}}]);_0x554b82['status'](0xc8)[_0x1cdd55(0x1bd)](_0x4f08a0);}catch(_0x1dde0a){_0x554b82[_0x1cdd55(0x167)](0x194)[_0x1cdd55(0x1bd)]({'message':_0x1dde0a[_0x1cdd55(0x20c)]});}}),router[a0_0xe83a36(0x14e)]('/barcode_scanner3',async(_0x2cca66,_0x529129)=>{var _0x3bb061=a0_0xe83a36;try{const {FromWareHouse:_0x38b731,FromRoom:_0x482da0,ToWarehouse:_0x4b778e,ToRoom:_0x33310b,product_code:_0x4faf9f}=_0x2cca66[_0x3bb061(0x184)],_0x1a4439=await warehouse[_0x3bb061(0x201)]([{'$match':{'name':_0x38b731}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x4faf9f}},{'$group':{'_id':_0x3bb061(0x1de),'name':{'$first':_0x3bb061(0x1ea)},'primary_code':{'$first':_0x3bb061(0x18e)},'secondary_code':{'$first':_0x3bb061(0x163)},'product_code':{'$first':_0x3bb061(0x143)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x3bb061(0x17b)},'level':{'$first':_0x3bb061(0x147)},'isle':{'$first':_0x3bb061(0x19d)},'pallet':{'$first':_0x3bb061(0x14f)},'maxProducts':{'$first':_0x3bb061(0x18f)},'unit':{'$first':_0x3bb061(0x175)}}}]);_0x529129[_0x3bb061(0x167)](0xc8)[_0x3bb061(0x1bd)](_0x1a4439);}catch(_0x3321d6){_0x529129[_0x3bb061(0x167)](0x194)[_0x3bb061(0x1bd)]({'message':_0x3321d6[_0x3bb061(0x20c)]});}}),router[a0_0xe83a36(0x14e)](a0_0xe83a36(0x197),async(_0x176ca7,_0x37719a)=>{var _0x55e447=a0_0xe83a36;const {level:_0x7b5796,isle:_0x4034e1,pallet:_0x44c825,warehouses:_0x1105d2,room:_0x165a37}=_0x176ca7[_0x55e447(0x184)];try{const _0x5c161d=await warehouse[_0x55e447(0x201)]([{'$match':{'name':_0x1105d2,'room':_0x165a37}},{'$unwind':_0x55e447(0x12a)},{'$match':{'product_details.level':parseInt(_0x7b5796),'product_details.isle':_0x4034e1,'product_details.pallet':parseInt(_0x44c825)}},{'$group':{'_id':_0x55e447(0x1de),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x55e447(0x15e)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x55e447(0x19d)},'pallet':{'$first':_0x55e447(0x14f)},'maxProducts':{'$first':_0x55e447(0x18f)}}}]);_0x37719a[_0x55e447(0x167)](0xc8)['json'](_0x5c161d);}catch(_0x1033ce){_0x37719a['status'](0x194)[_0x55e447(0x1bd)]({'message':_0x1033ce[_0x55e447(0x20c)]});}}),module['exports']=router;