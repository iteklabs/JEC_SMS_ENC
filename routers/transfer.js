function a0_0x5c6d(){var _0x130936=['render','$product_details.unit','save','11241571RQtKvT','production_date','$product_details.bay','warehouse','forEach','Shelves','findOne','726otmqZl','to_prod_level','$product_details.batch_code','id_transaction','/barcode_scanner2','from_rack','to_bay','flash','invoice','filter','/barcode_scanner','to_prod_pallet','from_room_name','master','An\x20error\x20occurred.','$product_details.secondary_code','$product_details.storage','$product_details.type','$product_details','then','random','body','$product_details.invoice','Arabic','Rack\x20B','<!DOCTYPE\x20html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/view','$product_details.maxProducts','$from_warehouse','<html><head><title></title>','email','$name','from_floorlevel','here','TRF-','batch_code','product_name','port','French','createTransport','_id','type','/preview/:id','Rack\x20A','Spanish','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','English\x20(US)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','from_quantity','expiry_date','An\x20error\x20occurred\x20while\x20saving\x20data.','aggregate','image','2316918vGYwQP','floor','$product_details.maxPerUnit','Transfer\x20Edit\x20Successfully','\x20Order\x20Date\x20:\x20','<span\x20style=\x22float:\x20right;\x22>','$product_details.production_date','366821eIgjuW','Rack\x20D','note','from_bay','from_invoice','$product_details.secondary_unit','catch','13707XNwcJY','$product.from_room_name','/CheckingWarehouse','136hjAZch','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.rack','/picking_list/PDF_transfer_rm/','from_rak','back','split','Portuguese\x20(BR)','5NhaWcc','host','product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Level','max_per_unit','../models/all_models','bin','slice','Receiving\x20Area','Email\x20sent\x20successfully','message','success','Hindi','</tr>','rak','prod_name','errors','127359LefcIZ','English','RMSEmail','language','\x20</h2>','$room','$product_details.product_name','DRY\x20STORAGE','string','Enclosed','product_stock','New_Qty_Converted','date','$product_details.product_code','length','floorlevel','Logo.png','Transfer\x20Finalize\x20Successfully','get','to_bin','</tbody>','status','Return\x20Rooms','product_code3','concat','padStart','post','</body></html>','/transfer/preview/','<div>','json','../public/language/languages.json','<h5\x20style=\x22text-align:\x20left;\x22>','1892QoyBtr','transfer','/view/:id','finalize','nodemailer','</table>','to_warehouse','$product_details.floorlevel','primary_unit','from_prod_level','product_details','<tbody\x20style=\x22text-align:\x20center;\x22>','<tr>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','to_quantity','from_prod_qty','$product_details.isle','from_types','push','from_prod_pallet','to_room_name','Product\x20Transfer\x20successfully','Rack\x20F','</td>','Floor','$product_details.product_stock','<h2>\x20','110DQKhuH','</div>','to_invoice','to_floorlevel','prod_cat','maxperunit','bay','/../public','$_id','</span>','maxProducts','To_invoice','map','staff','$product_details.level','add_transfer','RoomAssigned','Transfer\x20Mail','Enabled','password','$product_details._id','$product_details.expiry_date','COLD\x20STORAGE','<h5>','params','\x20Order\x20Number\x20:\x20','secondary_code','error','Raw\x20Materials','$finalize','$product_details.pallet','from_storage','findById','Chinese','storage','sendMail','unit','redirect','from_prod_isle','site_title','True','to_types','Arabic\x20(ae)','log','$product_details.bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','id_transaction_id','rack','Router','from_room','/upload/','Error\x20Occurs','to_prod_isle','/view/add_transfer','to_prod_qty','role','from_bin','exports','secondary_unit','/transfer/view','to_room','edit_transfer_view','\x20<>\x20','toString','</h5>','German','6541500zEmDVH','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','product_code','$product_details.primary_code','<table\x20style=\x22width:\x20100%\x20!important;\x22>','from_warehouse','find','primary_code','Portuguese','all','MaxStocks_data2','user'];a0_0x5c6d=function(){return _0x130936;};return a0_0x5c6d();}var a0_0x23e509=a0_0xeeec;(function(_0x50bb43,_0x2c17a7){var _0x1e2527=a0_0xeeec,_0x2a82c2=_0x50bb43();while(!![]){try{var _0x299cc3=-parseInt(_0x1e2527(0x182))/0x1*(-parseInt(_0x1e2527(0xe6))/0x2)+parseInt(_0x1e2527(0x13e))/0x3*(-parseInt(_0x1e2527(0xcb))/0x4)+-parseInt(_0x1e2527(0x18d))/0x5*(-parseInt(_0x1e2527(0x174))/0x6)+parseInt(_0x1e2527(0x17b))/0x7+-parseInt(_0x1e2527(0x185))/0x8*(-parseInt(_0x1e2527(0xaa))/0x9)+parseInt(_0x1e2527(0x128))/0xa+-parseInt(_0x1e2527(0x137))/0xb;if(_0x299cc3===_0x2c17a7)break;else _0x2a82c2['push'](_0x2a82c2['shift']());}catch(_0x40852d){_0x2a82c2['push'](_0x2a82c2['shift']());}}}(a0_0x5c6d,0xe81cb));const express=require('express'),app=express(),router=express[a0_0x23e509(0x116)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x23e509(0x9e)),auth=require('../middleware/auth'),users=require(a0_0x23e509(0xc9)),nodemailer=require(a0_0x23e509(0xcf));router[a0_0x23e509(0xbc)](a0_0x23e509(0x159),auth,async(_0x46f65e,_0x662156)=>{var _0x48a42c=a0_0x23e509;try{const {username:_0xbda7ca,email:_0x4f2220,role:_0x544795}=_0x46f65e[_0x48a42c(0x133)],_0x1319e1=_0x46f65e[_0x48a42c(0x133)],_0x1591ec=await profile['findOne']({'email':_0x1319e1['email']}),_0xac31bc=await master_shop['find']();console[_0x48a42c(0x111)](_0x48a42c(0x14b),_0xac31bc);let _0x420234;if(_0x1319e1[_0x48a42c(0x11d)]==_0x48a42c(0xf3)){const _0x3936a1=await staff[_0x48a42c(0x13d)]({'email':_0x1319e1[_0x48a42c(0x15d)]});_0x420234=await transfers[_0x48a42c(0x12e)]({'from_warehouse':_0x3936a1[_0x48a42c(0x13a)]});}else _0x420234=await transfers['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x48a42c(0xee),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x48a42c(0x15b)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x48a42c(0x183)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x48a42c(0x103)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xac31bc[0x0]['language']==_0x48a42c(0x16d)){var _0x1d81cf=users[_0x48a42c(0xab)];console[_0x48a42c(0x111)](_0x1d81cf);}else{if(_0xac31bc[0x0][_0x48a42c(0xad)]=='Hindi')var _0x1d81cf=users[_0x48a42c(0xa5)];else{if(_0xac31bc[0x0][_0x48a42c(0xad)]==_0x48a42c(0x127))var _0x1d81cf=users[_0x48a42c(0x127)];else{if(_0xac31bc[0x0][_0x48a42c(0xad)]==_0x48a42c(0x16b))var _0x1d81cf=users[_0x48a42c(0x16b)];else{if(_0xac31bc[0x0]['language']==_0x48a42c(0x165))var _0x1d81cf=users[_0x48a42c(0x165)];else{if(_0xac31bc[0x0][_0x48a42c(0xad)]==_0x48a42c(0x18c))var _0x1d81cf=users[_0x48a42c(0x130)];else{if(_0xac31bc[0x0][_0x48a42c(0xad)]==_0x48a42c(0x107))var _0x1d81cf=users[_0x48a42c(0x107)];else{if(_0xac31bc[0x0][_0x48a42c(0xad)]=='Arabic\x20(ae)')var _0x1d81cf=users['Arabic'];}}}}}}}_0x662156[_0x48a42c(0x134)](_0x48a42c(0xcc),{'success':_0x46f65e[_0x48a42c(0x145)](_0x48a42c(0xa4)),'errors':_0x46f65e['flash'](_0x48a42c(0xa9)),'role':_0x1319e1,'profile':_0x1591ec,'master_shop':_0xac31bc,'transfer':_0x420234,'language':_0x1d81cf});}catch(_0x399bdf){console['log'](_0x399bdf);}});async function getRandom8DigitNumber(){var _0x363135=a0_0x23e509;const _0x3c58ea=0x989680,_0x48c3e2=0x5f5e0ff,_0x4fb3e6=Math[_0x363135(0x175)](Math[_0x363135(0x152)]()*(_0x48c3e2-_0x3c58ea+0x1))+_0x3c58ea;var _0x42172d;const _0x3b1903=await transfers[_0x363135(0x13d)]({'invoice':_0x363135(0x161)+_0x4fb3e6});return _0x3b1903&&_0x3b1903[_0x363135(0xb8)]>0x0?_0x42172d=_0x363135(0x161)+_0x4fb3e6:_0x42172d=_0x363135(0x161)+_0x4fb3e6,_0x42172d;}function a0_0xeeec(_0x46cbb3,_0x341de3){var _0x5c6d55=a0_0x5c6d();return a0_0xeeec=function(_0xeeecf,_0xa47588){_0xeeecf=_0xeeecf-0x9a;var _0x1f6668=_0x5c6d55[_0xeeecf];return _0x1f6668;},a0_0xeeec(_0x46cbb3,_0x341de3);}router[a0_0x23e509(0xbc)]('/view/add_transfer',auth,async(_0x29b91e,_0x587399)=>{var _0x147482=a0_0x23e509;try{const {username:_0x40b049,email:_0x6316a0,role:_0x4cd65b}=_0x29b91e[_0x147482(0x133)],_0x4ff9e8=_0x29b91e[_0x147482(0x133)],_0x5ee71c=await profile[_0x147482(0x13d)]({'email':_0x4ff9e8[_0x147482(0x15d)]}),_0x55dfcc=await master_shop[_0x147482(0x12e)]();console[_0x147482(0x111)]('master',_0x55dfcc);let _0x3875ad;if(_0x4ff9e8[_0x147482(0x11d)]==_0x147482(0xf3)){const _0xf697ff=await staff[_0x147482(0x13d)]({'email':_0x4ff9e8[_0x147482(0x15d)]});_0x3875ad=await warehouse[_0x147482(0x172)]([{'$match':{'status':_0x147482(0xf8),'name':_0xf697ff[_0x147482(0x13a)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x147482(0x15e)}}}]);}else _0x3875ad=await warehouse[_0x147482(0x172)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x147482(0x15e),'name':{'$first':_0x147482(0x15e)}}}]);var _0x338a36=['Ambient',_0x147482(0xb3),_0x147482(0xc0)];const _0x28fa03=await transfers['find']({}),_0x1b64e2=_0x28fa03[_0x147482(0xb8)]+0x1,_0xfa10a0=_0x147482(0x161)+_0x1b64e2[_0x147482(0x125)]()[_0x147482(0xc3)](0x5,'0');if(_0x55dfcc[0x0][_0x147482(0xad)]==_0x147482(0x16d)){var _0x3f6bcc=users[_0x147482(0xab)];console[_0x147482(0x111)](_0x3f6bcc);}else{if(_0x55dfcc[0x0][_0x147482(0xad)]==_0x147482(0xa5))var _0x3f6bcc=users[_0x147482(0xa5)];else{if(_0x55dfcc[0x0][_0x147482(0xad)]==_0x147482(0x127))var _0x3f6bcc=users[_0x147482(0x127)];else{if(_0x55dfcc[0x0]['language']=='Spanish')var _0x3f6bcc=users[_0x147482(0x16b)];else{if(_0x55dfcc[0x0][_0x147482(0xad)]==_0x147482(0x165))var _0x3f6bcc=users[_0x147482(0x165)];else{if(_0x55dfcc[0x0]['language']==_0x147482(0x18c))var _0x3f6bcc=users['Portuguese'];else{if(_0x55dfcc[0x0][_0x147482(0xad)]==_0x147482(0x107))var _0x3f6bcc=users[_0x147482(0x107)];else{if(_0x55dfcc[0x0]['language']==_0x147482(0x110))var _0x3f6bcc=users['Arabic'];}}}}}}}const _0x4a3c61=getRandom8DigitNumber();_0x4a3c61['then'](_0xa2967f=>{var _0x5e7b4d=_0x147482;_0x587399[_0x5e7b4d(0x134)](_0x5e7b4d(0xf5),{'success':_0x29b91e[_0x5e7b4d(0x145)]('success'),'errors':_0x29b91e['flash'](_0x5e7b4d(0xa9)),'role':_0x4ff9e8,'profile':_0x5ee71c,'master_shop':_0x55dfcc,'warehouse':_0x3875ad,'language':_0x3f6bcc,'rooms_data':_0x338a36,'invoice':_0xa2967f});})[_0x147482(0x181)](_0x17f4fe=>{var _0xf342ba=_0x147482;_0x29b91e[_0xf342ba(0x145)](_0xf342ba(0xa9),_0xf342ba(0x9b)),_0x587399[_0xf342ba(0x10b)]('/transfer/view');});}catch(_0x55dd00){console[_0x147482(0x111)](_0x55dd00);}}),router[a0_0x23e509(0xc4)](a0_0x23e509(0x11b),auth,async(_0x38de48,_0xb95a36)=>{var _0x13991a=a0_0x23e509;try{console[_0x13991a(0x111)](_0x38de48[_0x13991a(0x153)]);const {date:_0xac787d,from_warehouse:_0x40f66e,FromRoom_name:_0x244ecf,to_warehouse:_0x4b64a3,ToRoom_name:_0x2a6e1b,prod_name:_0xc183ae,from_prod_qty:_0x18cd30,from_prod_level:_0x4b2be1,from_prod_isle:_0x889274,from_prod_pallet:_0xb90380,to_prod_qty:_0x440ed7,to_prod_level:_0x2a16e8,to_prod_isle:_0x28defd,to_prod_pallet:_0x4c6f00,primary_code:_0x2b5431,secondary_code:_0x2571ff,product_code3:_0x30712f,note:_0xe33e9b,MaxStocks_data2:_0x2d36af,invoice:_0x470927,expiry_date:_0x381fb3}=_0x38de48[_0x13991a(0x153)];if(typeof _0xc183ae==_0x13991a(0xb2))var _0x2a5b5c=[_0x38de48[_0x13991a(0x153)]['prod_name']],_0x1ac0b4=[_0x38de48['body']['from_prod_qty']],_0x3c6b1f=[_0x38de48[_0x13991a(0x153)][_0x13991a(0xd4)]],_0x4b02f2=[_0x38de48[_0x13991a(0x153)][_0x13991a(0xb5)]],_0x658bc1=[_0x38de48[_0x13991a(0x153)][_0x13991a(0x13f)]],_0x300d87=[_0x38de48[_0x13991a(0x153)][_0x13991a(0x12f)]],_0x23c2e0=[_0x38de48[_0x13991a(0x153)][_0x13991a(0x100)]],_0xb1e79=[_0x38de48[_0x13991a(0x153)][_0x13991a(0xc1)]],_0x3b2bb4=[_0x38de48[_0x13991a(0x153)][_0x13991a(0x132)]],_0x44a16c=[_0x38de48['body'][_0x13991a(0xd3)]],_0x157687=[_0x38de48[_0x13991a(0x153)][_0x13991a(0x120)]],_0x4b94d2=[_0x38de48[_0x13991a(0x153)]['batch_code']],_0x71c030=[_0x38de48['body'][_0x13991a(0x170)]],_0x5a5a0e=[_0x38de48[_0x13991a(0x153)][_0x13991a(0x9d)]],_0x432029=[_0x38de48['body'][_0x13991a(0x138)]],_0x178674=[_0x38de48[_0x13991a(0x153)]['prod_cat']],_0xf2b706=[_0x38de48[_0x13991a(0x153)][_0x13991a(0xf6)]],_0x2bfd92=[_0x38de48['body']['ToRoomAssigned']],_0x138d08=[_0x38de48['body']['from_invoice']],_0x87b591=[_0x38de48[_0x13991a(0x153)][_0x13991a(0xe8)]],_0x24f7eb=[_0x38de48['body'][_0x13991a(0x141)]];else var _0x2a5b5c=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0xa8)]],_0x1ac0b4=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0xda)]],_0x3c6b1f=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0xd4)]],_0x4b02f2=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0xb5)]],_0x658bc1=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0x13f)]],_0x300d87=[..._0x38de48[_0x13991a(0x153)]['primary_code']],_0x23c2e0=[..._0x38de48['body'][_0x13991a(0x100)]],_0xb1e79=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0xc1)]],_0x3b2bb4=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0x132)]],_0x44a16c=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0xd3)]],_0x157687=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0x120)]],_0x4b94d2=[..._0x38de48[_0x13991a(0x153)]['batch_code']],_0x71c030=[..._0x38de48['body'][_0x13991a(0x170)]],_0x5a5a0e=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0x9d)]],_0x432029=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0x138)]],_0x178674=[..._0x38de48['body'][_0x13991a(0xea)]],_0xf2b706=[..._0x38de48[_0x13991a(0x153)]['RoomAssigned']],_0x2bfd92=[..._0x38de48[_0x13991a(0x153)]['ToRoomAssigned']],_0x138d08=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0x17f)]],_0x87b591=[..._0x38de48[_0x13991a(0x153)][_0x13991a(0xe8)]],_0x24f7eb=[..._0x38de48['body']['id_transaction']];const _0x4df24a=_0x2a5b5c['map'](_0x51e7b4=>{return _0x51e7b4={'product_name':_0x51e7b4};});_0x1ac0b4['forEach']((_0x5f1ec4,_0x162cb7)=>{var _0x54952f=_0x13991a;_0x4df24a[_0x162cb7][_0x54952f(0x16f)]=_0x5f1ec4;}),_0x138d08[_0x13991a(0x13b)]((_0x7703ab,_0x8386cd)=>{var _0x58a8d8=_0x13991a;_0x4df24a[_0x8386cd][_0x58a8d8(0x17f)]=_0x7703ab;}),_0x87b591[_0x13991a(0x13b)]((_0x2f7bb7,_0x490979)=>{_0x4df24a[_0x490979]['To_invoice']=_0x2f7bb7;}),_0x24f7eb[_0x13991a(0x13b)]((_0x317508,_0x1da54d)=>{var _0x3fc44a=_0x13991a;_0x4df24a[_0x1da54d][_0x3fc44a(0x114)]=_0x317508;}),_0x3c6b1f['forEach']((_0x37fa35,_0x31fa98)=>{var _0x3813ae=_0x13991a;_0xf2b706[_0x3813ae(0x13b)]((_0xd75b29,_0x322492)=>{var _0x2afb87=_0x3813ae;if(_0xd75b29==_0x2afb87(0xa1)&&_0x31fa98==_0x322492){var _0x413242=_0x37fa35['slice'](0x3);_0x4df24a[_0x31fa98][_0x2afb87(0x105)]=_0x37fa35[0x0],_0x4df24a[_0x31fa98][_0x2afb87(0x143)]=_0x37fa35[0x1],_0x4df24a[_0x31fa98]['from_bay']=0x0,_0x4df24a[_0x31fa98][_0x2afb87(0x11e)]=0x0,_0x4df24a[_0x31fa98][_0x2afb87(0xdc)]=_0x2afb87(0xe3),_0x4df24a[_0x31fa98][_0x2afb87(0x15f)]=_0x413242;}else{if(_0xd75b29==_0x2afb87(0x13c)&&_0x31fa98==_0x322492){var _0x413242=_0x37fa35[_0x2afb87(0xa0)](0x3);_0x4df24a[_0x31fa98][_0x2afb87(0x105)]=_0x37fa35[0x0],_0x4df24a[_0x31fa98]['from_rack']=_0x37fa35[0x1],_0x4df24a[_0x31fa98][_0x2afb87(0x17e)]=0x0,_0x4df24a[_0x31fa98]['from_bin']=0x0,_0x4df24a[_0x31fa98][_0x2afb87(0xdc)]='Floor',_0x4df24a[_0x31fa98][_0x2afb87(0x15f)]=_0x37fa35[0x5];}else{if(_0x31fa98==_0x322492){if(_0x37fa35[0x0]=='A'&&_0x37fa35[0x1]=='L'&&_0x37fa35[0x2]=='L')console['log'](_0xd75b29+_0x2afb87(0x124)+_0x31fa98+_0x2afb87(0x124)+_0x322492+'\x20<>\x20'+_0x37fa35+_0x2afb87(0x160)),_0x4df24a[_0x31fa98][_0x2afb87(0x105)]=_0x37fa35[0x0],_0x4df24a[_0x31fa98]['from_rack']=_0x37fa35[0x1],_0x4df24a[_0x31fa98][_0x2afb87(0x17e)]=0x0,_0x4df24a[_0x31fa98][_0x2afb87(0x11e)]=0x0,_0x4df24a[_0x31fa98][_0x2afb87(0xdc)]=_0x2afb87(0xe3),_0x4df24a[_0x31fa98][_0x2afb87(0x15f)]=_0x37fa35[0x3];else{var _0x59050f;if(_0x37fa35[0x4]=='L')_0x59050f=_0x2afb87(0x9c);else _0x37fa35[0x4]=='F'&&(_0x59050f=_0x2afb87(0xe3));_0x4df24a[_0x31fa98]['from_storage']=_0x37fa35[0x0],_0x4df24a[_0x31fa98][_0x2afb87(0x143)]=_0x37fa35[0x1],_0x4df24a[_0x31fa98][_0x2afb87(0x17e)]=_0x37fa35[0x2],_0x4df24a[_0x31fa98]['from_bin']=_0x37fa35[0x3],_0x4df24a[_0x31fa98][_0x2afb87(0xdc)]=_0x59050f,_0x4df24a[_0x31fa98][_0x2afb87(0x15f)]=_0x37fa35[0x5];}}}}});}),_0x4b02f2[_0x13991a(0x13b)]((_0x3e0566,_0x331b0d)=>{_0x4df24a[_0x331b0d]['to_quantity']=_0x3e0566;}),_0x658bc1[_0x13991a(0x13b)]((_0x5e6606,_0x5e184a)=>{var _0x36cf5c=_0x13991a;_0x2bfd92[_0x36cf5c(0x13b)]((_0x18cde8,_0x55f744)=>{var _0x2e6537=_0x36cf5c;if(_0x18cde8==_0x2e6537(0xa1)&&_0x5e184a==_0x55f744){var _0x1817c6=_0x5e6606[_0x2e6537(0xa0)](0x3);_0x4df24a[_0x5e184a]['storage']=_0x5e6606[0x0],_0x4df24a[_0x5e184a][_0x2e6537(0x115)]=_0x5e6606[0x1],_0x4df24a[_0x5e184a][_0x2e6537(0x144)]=0x0,_0x4df24a[_0x5e184a][_0x2e6537(0xbd)]=0x0,_0x4df24a[_0x5e184a][_0x2e6537(0x10f)]=_0x2e6537(0xe3),_0x4df24a[_0x5e184a][_0x2e6537(0xe9)]=_0x1817c6;}else{if(_0x18cde8==_0x2e6537(0x13c)&&_0x5e184a==_0x55f744){var _0x1817c6=_0x5e6606[_0x2e6537(0xa0)](0x3);_0x4df24a[_0x5e184a][_0x2e6537(0x108)]=_0x5e6606[0x0],_0x4df24a[_0x5e184a][_0x2e6537(0x115)]=_0x5e6606[0x1],_0x4df24a[_0x5e184a]['to_bay']=0x0,_0x4df24a[_0x5e184a][_0x2e6537(0xbd)]=0x0,_0x4df24a[_0x5e184a]['to_types']=_0x2e6537(0xe3),_0x4df24a[_0x5e184a][_0x2e6537(0xe9)]=_0x5e6606[0x5];}else{if(_0x5e184a==_0x55f744){if(_0x5e6606[0x0]=='A'&&_0x5e6606[0x1]=='L'&&_0x5e6606[0x2]=='L')console[_0x2e6537(0x111)](_0x18cde8+_0x2e6537(0x124)+_0x5e184a+_0x2e6537(0x124)+_0x55f744+_0x2e6537(0x124)+_0x5e6606+_0x2e6537(0x160)),_0x4df24a[_0x5e184a][_0x2e6537(0x108)]=_0x5e6606[0x0],_0x4df24a[_0x5e184a][_0x2e6537(0x115)]=_0x5e6606[0x1],_0x4df24a[_0x5e184a][_0x2e6537(0x144)]=0x0,_0x4df24a[_0x5e184a][_0x2e6537(0xbd)]=0x0,_0x4df24a[_0x5e184a][_0x2e6537(0x10f)]=_0x2e6537(0xe3),_0x4df24a[_0x5e184a]['to_floorlevel']=_0x5e6606[0x3];else{var _0x26a45d;if(_0x5e6606[0x4]=='L')_0x26a45d=_0x2e6537(0x9c);else _0x5e6606[0x4]=='F'&&(_0x26a45d=_0x2e6537(0xe3));_0x4df24a[_0x5e184a][_0x2e6537(0x108)]=_0x5e6606[0x0],_0x4df24a[_0x5e184a][_0x2e6537(0x115)]=_0x5e6606[0x1],_0x4df24a[_0x5e184a][_0x2e6537(0x144)]=_0x5e6606[0x2],_0x4df24a[_0x5e184a][_0x2e6537(0xbd)]=_0x5e6606[0x3],_0x4df24a[_0x5e184a][_0x2e6537(0x10f)]=_0x26a45d,_0x4df24a[_0x5e184a]['to_floorlevel']=_0x5e6606[0x5];}}}}});}),_0x300d87[_0x13991a(0x13b)]((_0x4ef14e,_0x5cabed)=>{var _0x2e9dc5=_0x13991a;_0x4df24a[_0x5cabed][_0x2e9dc5(0x12f)]=_0x4ef14e;}),_0x23c2e0[_0x13991a(0x13b)]((_0x5541f6,_0x270d94)=>{var _0x11532c=_0x13991a;_0x4df24a[_0x270d94][_0x11532c(0x100)]=_0x5541f6;}),_0xb1e79[_0x13991a(0x13b)]((_0x2ee0bf,_0x37624f)=>{var _0x2f6b4f=_0x13991a;_0x4df24a[_0x37624f][_0x2f6b4f(0x12a)]=_0x2ee0bf;}),_0x3b2bb4[_0x13991a(0x13b)]((_0x31eea8,_0x42cd85)=>{var _0x533a8d=_0x13991a;_0x4df24a[_0x42cd85][_0x533a8d(0xf0)]=_0x31eea8;}),_0x44a16c['forEach']((_0xf1fa95,_0x317561)=>{var _0x5d7c29=_0x13991a;_0x4df24a[_0x317561][_0x5d7c29(0x10a)]=_0xf1fa95;}),_0x157687['forEach']((_0x36fa90,_0x255e96)=>{var _0xb85a77=_0x13991a;_0x4df24a[_0x255e96][_0xb85a77(0x120)]=_0x36fa90;}),_0x4b94d2['forEach']((_0x1d3d41,_0x15f407)=>{var _0x56227f=_0x13991a;_0x4df24a[_0x15f407][_0x56227f(0x162)]=_0x1d3d41;}),_0x71c030[_0x13991a(0x13b)]((_0x321456,_0x1f621b)=>{var _0xf0ba0a=_0x13991a;_0x4df24a[_0x1f621b][_0xf0ba0a(0x170)]=_0x321456;}),_0x5a5a0e[_0x13991a(0x13b)]((_0x5b89bb,_0x54838a)=>{_0x4df24a[_0x54838a]['maxperunit']=_0x5b89bb;}),_0x432029[_0x13991a(0x13b)]((_0x1c4cc5,_0x411fe8)=>{var _0x17020f=_0x13991a;_0x4df24a[_0x411fe8][_0x17020f(0x138)]=_0x1c4cc5;}),_0x178674[_0x13991a(0x13b)]((_0x4c091e,_0x17f592)=>{var _0x301f28=_0x13991a;_0x4df24a[_0x17f592][_0x301f28(0xea)]=_0x4c091e;}),_0xf2b706['forEach']((_0x4e154d,_0x41f67c)=>{var _0x4ca17e=_0x13991a;_0x4df24a[_0x41f67c][_0x4ca17e(0x14a)]=_0x4e154d;}),_0x2bfd92[_0x13991a(0x13b)]((_0x28ccd7,_0x275077)=>{var _0x52ba29=_0x13991a;_0x4df24a[_0x275077][_0x52ba29(0xdf)]=_0x28ccd7;});const _0x25f4bf=_0x4df24a[_0x13991a(0x147)](_0x400c20=>_0x400c20[_0x13991a(0xd9)]!=='0'&&_0x400c20[_0x13991a(0xd9)]!==''||_0x400c20[_0x13991a(0xe9)]!=='0'&&_0x400c20[_0x13991a(0xe9)]!==''),_0xd7b15f=new transfers({'date':_0xac787d,'from_warehouse':_0x40f66e,'to_warehouse':_0x4b64a3,'product':_0x25f4bf,'note':_0xe33e9b,'invoice':_0x470927}),_0x1d2b0b=await _0xd7b15f[_0x13991a(0x136)]();_0x38de48['flash'](_0x13991a(0xa4),_0x13991a(0xe0)),_0xb95a36[_0x13991a(0x10b)](_0x13991a(0xc6)+_0x1d2b0b['_id']);}catch(_0x5bce4d){console[_0x13991a(0x111)](_0x5bce4d),_0xb95a36[_0x13991a(0xbf)](0xc8)[_0x13991a(0xc8)]({'errorMessage':_0x5bce4d['message']});}}),router['get']('/preview/:id',auth,async(_0x1e9bc6,_0x3b23bb)=>{var _0x4395f8=a0_0x23e509;try{const {username:_0x205d77,email:_0x50e672,role:_0x32550e}=_0x1e9bc6[_0x4395f8(0x133)],_0x4c6b57=_0x1e9bc6['user'],_0x5ec48c=await profile[_0x4395f8(0x13d)]({'email':_0x4c6b57[_0x4395f8(0x15d)]}),_0x4b87b1=await master_shop[_0x4395f8(0x12e)]();console[_0x4395f8(0x111)]('master',_0x4b87b1);const _0x32727d=await transfers[_0x4395f8(0x106)](_0x1e9bc6[_0x4395f8(0xfe)]['id']);let _0x36cab6=new Date(_0x32727d[_0x4395f8(0x170)]),_0x48aded=('0'+_0x36cab6['getDate']())[_0x4395f8(0xa0)](-0x2),_0x4dd6f4=('0'+(_0x36cab6['getMonth']()+0x1))['slice'](-0x2),_0xffbfd0=_0x36cab6['getFullYear'](),_0x14495c=_0xffbfd0+'-'+_0x4dd6f4+'-'+_0x48aded,_0x1cfdd4;if(_0x4c6b57['role']=='staff'){const _0x2f03c4=await staff[_0x4395f8(0x13d)]({'email':_0x4c6b57[_0x4395f8(0x15d)]});_0x1cfdd4=await warehouse['find']({'status':_0x4395f8(0xf8),'name':_0x2f03c4[_0x4395f8(0x13a)],'warehouse_category':_0x4395f8(0x102)});}else _0x1cfdd4=await warehouse[_0x4395f8(0x12e)]({'status':_0x4395f8(0xf8),'warehouse_category':'Raw\x20Materials'});const _0x17b3d2=await warehouse[_0x4395f8(0x172)]([{'$match':{'name':_0x32727d[_0x4395f8(0x12d)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4395f8(0xfa),'name':{'$first':_0x4395f8(0xb0)},'product_stock':{'$first':_0x4395f8(0xe4)},'bay':{'$first':_0x4395f8(0x139)},'bin':{'$first':_0x4395f8(0x112)},'type':{'$first':_0x4395f8(0x14f)},'floorlevel':{'$first':_0x4395f8(0xd2)},'primary_code':{'$first':_0x4395f8(0x12b)},'secondary_code':{'$first':_0x4395f8(0x14d)},'product_code':{'$first':_0x4395f8(0xb7)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4395f8(0x187)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4395f8(0x17a)},'room':{'$first':_0x4395f8(0xaf)}}}]);if(_0x4b87b1[0x0][_0x4395f8(0xad)]=='English\x20(US)'){var _0x1ddbc1=users['English'];console[_0x4395f8(0x111)](_0x1ddbc1);}else{if(_0x4b87b1[0x0][_0x4395f8(0xad)]==_0x4395f8(0xa5))var _0x1ddbc1=users['Hindi'];else{if(_0x4b87b1[0x0][_0x4395f8(0xad)]==_0x4395f8(0x127))var _0x1ddbc1=users[_0x4395f8(0x127)];else{if(_0x4b87b1[0x0]['language']==_0x4395f8(0x16b))var _0x1ddbc1=users[_0x4395f8(0x16b)];else{if(_0x4b87b1[0x0][_0x4395f8(0xad)]==_0x4395f8(0x165))var _0x1ddbc1=users[_0x4395f8(0x165)];else{if(_0x4b87b1[0x0][_0x4395f8(0xad)]==_0x4395f8(0x18c))var _0x1ddbc1=users[_0x4395f8(0x130)];else{if(_0x4b87b1[0x0][_0x4395f8(0xad)]==_0x4395f8(0x107))var _0x1ddbc1=users['Chinese'];else{if(_0x4b87b1[0x0]['language']==_0x4395f8(0x110))var _0x1ddbc1=users[_0x4395f8(0x155)];}}}}}}}_0x3b23bb['render'](_0x4395f8(0x123),{'success':_0x1e9bc6['flash'](_0x4395f8(0xa4)),'errors':_0x1e9bc6['flash'](_0x4395f8(0xa9)),'role':_0x4c6b57,'profile':_0x5ec48c,'master_shop':_0x4b87b1,'warehouse':_0x1cfdd4,'transfer':_0x32727d,'stock':_0x17b3d2,'language':_0x1ddbc1});}catch(_0x237d4a){console['log'](_0x237d4a);}}),router[a0_0x23e509(0xc4)](a0_0x23e509(0x169),auth,async(_0x117a1d,_0x4e4db6)=>{var _0x1503cc=a0_0x23e509;try{const _0x385d5f=_0x117a1d[_0x1503cc(0xfe)]['id'],{from_warehouse:_0xe42c35,FromRoom_name:_0x37ed50,to_warehouse:_0x1cb58e,ToRoom_name:_0x3b7418}=_0x117a1d[_0x1503cc(0x153)],_0x4df844=await transfers[_0x1503cc(0x106)]({'_id':_0x385d5f}),_0x5a5bab=_0x4df844[_0x1503cc(0x18f)][_0x1503cc(0xf2)](async _0x113376=>{var _0x316bb7=_0x1503cc;if(_0x113376[_0x316bb7(0xd9)]>0x0){var _0x52a8e1=await warehouse[_0x316bb7(0x13d)]({'name':_0x4df844['from_warehouse'],'room':_0x113376[_0x316bb7(0x14a)],'warehouse_category':_0x316bb7(0x102)});const _0x1cf19d=_0x52a8e1[_0x316bb7(0xd5)][_0x316bb7(0xf2)](_0x507eea=>{var _0x5bf988=_0x316bb7;_0x507eea[_0x5bf988(0x163)]==_0x113376[_0x5bf988(0x163)]&&_0x507eea[_0x5bf988(0xb9)]==_0x113376[_0x5bf988(0x15f)]&&_0x507eea[_0x5bf988(0x168)]==_0x113376[_0x5bf988(0xdc)]&&_0x507eea[_0x5bf988(0x9f)]==_0x113376[_0x5bf988(0x11e)]&&_0x507eea[_0x5bf988(0xec)]==_0x113376[_0x5bf988(0x17e)]&&_0x507eea[_0x5bf988(0x115)]==_0x113376[_0x5bf988(0x143)]&&_0x507eea['storage']==_0x113376[_0x5bf988(0x105)]&&_0x507eea[_0x5bf988(0x170)]==_0x113376[_0x5bf988(0x170)]&&_0x507eea[_0x5bf988(0x162)]==_0x113376[_0x5bf988(0x162)]&&_0x507eea['production_date']==_0x113376[_0x5bf988(0x138)]&&_0x507eea[_0x5bf988(0x146)]==_0x113376[_0x5bf988(0x17f)]&&_0x507eea[_0x5bf988(0x167)]==_0x113376['id_transaction_id']&&(_0x507eea[_0x5bf988(0xb4)]=_0x507eea['product_stock']-_0x113376[_0x5bf988(0xd9)]);});}return _0x52a8e1;});Promise['all'](_0x5a5bab)[_0x1503cc(0x151)](async _0x55c979=>{var _0x2f232e=_0x1503cc;try{for(const _0x476546 of _0x55c979){await _0x476546[_0x2f232e(0x136)]();}try{const _0x168b85=_0x4df844[_0x2f232e(0x18f)][_0x2f232e(0xf2)](async _0x434f62=>{var _0x4eaa1d=_0x2f232e;if(_0x434f62['to_quantity']>0x0){var _0x3f8e55=await warehouse[_0x4eaa1d(0x13d)]({'name':_0x4df844[_0x4eaa1d(0xd1)],'room':_0x434f62[_0x4eaa1d(0xdf)],'warehouse_category':'Raw\x20Materials'}),_0xc5c984=0x0;const _0x57843d=_0x3f8e55[_0x4eaa1d(0xd5)][_0x4eaa1d(0xf2)](_0x21ec36=>{var _0x4fcd64=_0x4eaa1d;_0x21ec36[_0x4fcd64(0x163)]==_0x434f62[_0x4fcd64(0x163)]&&_0x21ec36[_0x4fcd64(0xb9)]==_0x434f62[_0x4fcd64(0xe9)]&&_0x21ec36[_0x4fcd64(0x168)]==_0x434f62[_0x4fcd64(0x10f)]&&_0x21ec36[_0x4fcd64(0x9f)]==_0x434f62[_0x4fcd64(0xbd)]&&_0x21ec36[_0x4fcd64(0xec)]==_0x434f62[_0x4fcd64(0x144)]&&_0x21ec36[_0x4fcd64(0x115)]==_0x434f62['rack']&&_0x21ec36[_0x4fcd64(0x108)]==_0x434f62[_0x4fcd64(0x108)]&&_0x21ec36[_0x4fcd64(0x170)]==_0x434f62[_0x4fcd64(0x170)]&&_0x21ec36[_0x4fcd64(0x162)]==_0x434f62[_0x4fcd64(0x162)]&&_0x21ec36[_0x4fcd64(0x138)]==_0x434f62[_0x4fcd64(0x138)]&&_0x21ec36[_0x4fcd64(0x146)]==_0x434f62[_0x4fcd64(0xf1)]&&(_0x21ec36[_0x4fcd64(0xb4)]=_0x21ec36['product_stock']+_0x434f62[_0x4fcd64(0xd9)],_0xc5c984++);});_0xc5c984=='0'&&(_0x3f8e55[_0x4eaa1d(0xd5)]=_0x3f8e55[_0x4eaa1d(0xd5)][_0x4eaa1d(0xc2)]({'product_name':_0x434f62[_0x4eaa1d(0x163)],'product_stock':_0x434f62[_0x4eaa1d(0xd9)],'bay':_0x434f62[_0x4eaa1d(0x144)],'bin':_0x434f62[_0x4eaa1d(0xbd)],'type':_0x434f62['to_types'],'floorlevel':_0x434f62['to_floorlevel'],'storage':_0x434f62[_0x4eaa1d(0x108)],'rack':_0x434f62[_0x4eaa1d(0x115)],'product_code':_0x434f62['product_code'],'primary_code':_0x434f62[_0x4eaa1d(0x12f)],'secondary_code':_0x434f62[_0x4eaa1d(0x100)],'maxProducts':_0x434f62[_0x4eaa1d(0xf0)],'storage':_0x434f62['storage'],'rack':_0x434f62['rack'],'expiry_date':_0x434f62['expiry_date'],'maxPerUnit':_0x434f62[_0x4eaa1d(0xeb)],'batch_code':_0x434f62[_0x4eaa1d(0x162)],'production_date':_0x434f62['production_date']}));}return _0x3f8e55;});Promise[_0x2f232e(0x131)](_0x168b85)[_0x2f232e(0x151)](async _0x2e3299=>{var _0xd62e92=_0x2f232e;try{for(const _0x192133 of _0x2e3299){await warehouse['updateOne']({'_id':_0x192133[_0xd62e92(0x167)]},{'$addToSet':{'product_details':{'$each':_0x192133[_0xd62e92(0xd5)]}}});}_0x4df844[_0xd62e92(0xce)]=_0xd62e92(0x10e);const _0x3ed415=await _0x4df844[_0xd62e92(0x136)](),_0x3c5963=await master_shop[_0xd62e92(0x12e)](),_0x4b0316=await email_settings['findOne'](),_0x133a4f=await supervisor_settings[_0xd62e92(0x12e)]();var _0x4dc78b=_0x4df844[_0xd62e92(0x18f)],_0x33f9c9='',_0x1b9e34;for(_0x1b9e34 in _0x4dc78b){_0x33f9c9+=_0xd62e92(0xd7)+_0xd62e92(0x186)+_0x4dc78b[_0x1b9e34][_0xd62e92(0x163)]+_0xd62e92(0xe2)+_0xd62e92(0x186)+_0x4dc78b[_0x1b9e34]['product_code']+_0xd62e92(0xe2)+_0xd62e92(0x186)+_0x4dc78b[_0x1b9e34][_0xd62e92(0xd9)]+_0xd62e92(0xe2)+_0xd62e92(0x186)+_0x4dc78b[_0x1b9e34][_0xd62e92(0x10a)]+_0xd62e92(0xe2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4dc78b[_0x1b9e34]['secondary_unit']+_0xd62e92(0xe2)+_0xd62e92(0x186)+_0x4df844[_0xd62e92(0xd1)]+_0xd62e92(0xe2)+_0xd62e92(0x186)+_0x4dc78b[_0x1b9e34][_0xd62e92(0xdf)]+_0xd62e92(0xe2)+_0xd62e92(0x186)+_0x4dc78b[_0x1b9e34][_0xd62e92(0x108)]+_0x4dc78b[_0x1b9e34][_0xd62e92(0x115)]+_0x4dc78b[_0x1b9e34][_0xd62e92(0x144)]+_0x4dc78b[_0x1b9e34][_0xd62e92(0xbd)]+_0x4dc78b[_0x1b9e34][_0xd62e92(0x10f)][0x0]+_0x4dc78b[_0x1b9e34][_0xd62e92(0xe9)]+_0xd62e92(0xe2),_0xd62e92(0xa6);}let _0x2f48ba=nodemailer[_0xd62e92(0x166)]({'host':_0x4b0316[_0xd62e92(0x18e)],'port':Number(_0x4b0316[_0xd62e92(0x164)]),'secure':![],'auth':{'user':_0x4b0316[_0xd62e92(0x15d)],'pass':_0x4b0316[_0xd62e92(0xf9)]}}),_0xe62ea3={'from':_0x4b0316['email'],'to':_0x133a4f[0x0][_0xd62e92(0xac)],'subject':_0xd62e92(0xf7),'attachments':[{'filename':_0xd62e92(0xba),'path':__dirname+_0xd62e92(0xed)+_0xd62e92(0x118)+_0x3c5963[0x0][_0xd62e92(0x173)],'cid':'logo'}],'html':_0xd62e92(0x157)+_0xd62e92(0x15c)+'</head><body>'+'<div>'+_0xd62e92(0xd8)+_0xd62e92(0xc7)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0xd62e92(0xe7)+_0xd62e92(0xc7)+_0xd62e92(0xe5)+_0x3c5963[0x0][_0xd62e92(0x10d)]+_0xd62e92(0xae)+_0xd62e92(0xe7)+'</div>'+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0xd62e92(0xca)+_0xd62e92(0xff)+_0x4df844[_0xd62e92(0x146)]+'\x20'+_0xd62e92(0x179)+_0xd62e92(0x178)+_0x4df844[_0xd62e92(0xb6)]+'\x20'+_0xd62e92(0xef)+_0xd62e92(0x126)+_0xd62e92(0xe7)+_0xd62e92(0x12c)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xd62e92(0xd7)+_0xd62e92(0x16c)+_0xd62e92(0x129)+_0xd62e92(0x113)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0xd62e92(0x9a)+_0xd62e92(0x158)+_0xd62e92(0x16e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0xd62e92(0xa6)+'</thead>'+_0xd62e92(0xd6)+'\x20'+_0x33f9c9+'\x20'+_0xd62e92(0xbe)+_0xd62e92(0xd0)+_0xd62e92(0xc7)+'<strong>\x20Regards\x20</strong>'+_0xd62e92(0xfd)+_0x3c5963[0x0][_0xd62e92(0x10d)]+_0xd62e92(0x126)+'</div>'+_0xd62e92(0xe7)+_0xd62e92(0xc5)};_0x2f48ba[_0xd62e92(0x109)](_0xe62ea3,function(_0x39bbb3,_0x4c40b6){var _0x243364=_0xd62e92;_0x39bbb3?(console[_0x243364(0x111)](_0x39bbb3),console[_0x243364(0x111)](_0x243364(0x119))):console[_0x243364(0x111)](_0x243364(0xa2));}),_0x117a1d[_0xd62e92(0x145)]('success',_0xd62e92(0xbb)),_0x4e4db6[_0xd62e92(0x10b)](_0xd62e92(0x188)+_0x3ed415['_id']);}catch(_0x18296e){console[_0xd62e92(0x101)](_0x18296e),_0x4e4db6['status'](0x1f4)[_0xd62e92(0xc8)]({'Perror':_0xd62e92(0x171),'message':_0x18296e['message']});}})[_0x2f232e(0x181)](_0x136cba=>{var _0x26b774=_0x2f232e;console['error'](_0x136cba),_0x4e4db6[_0x26b774(0xbf)](0x1f4)[_0x26b774(0xc8)]({'Perror':_0x26b774(0x14c)});});}catch(_0x36788b){_0x4e4db6[_0x2f232e(0xc8)](_0x36788b);}}catch(_0x1238e8){console[_0x2f232e(0x101)](_0x1238e8),_0x4e4db6['status'](0x1f4)[_0x2f232e(0xc8)]({'Merror':_0x2f232e(0x171),'Message':_0x1238e8[_0x2f232e(0xa3)]});}})[_0x1503cc(0x181)](_0x1d2967=>{var _0x33dcf0=_0x1503cc;console[_0x33dcf0(0x101)](_0x1d2967),_0x4e4db6[_0x33dcf0(0xbf)](0x1f4)[_0x33dcf0(0xc8)]({'Merror':_0x33dcf0(0x14c)});});}catch(_0x10e2ef){console[_0x1503cc(0x111)](_0x10e2ef);}});function BayBinSelected(_0x810538,_0x140696){var _0x511ddd=a0_0x23e509,_0xb777ca=[],_0x558e2e=[],_0x226e1a=[],_0x37f1ee=[],_0xa2c0ca=[],_0x4193c9=[];let _0x18fbf2=[];if(_0x810538==_0x511ddd(0xb1))switch(_0x140696){case _0x511ddd(0x16a):_0xb777ca=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x558e2e=[0x1,0x2],_0x37f1ee=[0x1,0x2,0x3,0x4,0x5],_0x226e1a=['Level',_0x511ddd(0xe3)],_0xa2c0ca=['D'],_0x4193c9=['A'];break;case _0x511ddd(0x156):_0xb777ca=[0x6,0x5,0x4,0x3,0x2,0x1],_0x558e2e=[0x1,0x2],_0x37f1ee=[0x1,0x2,0x3,0x4,0x5],_0x226e1a=[_0x511ddd(0x9c),_0x511ddd(0xe3)],_0xa2c0ca=['D'],_0x4193c9=['B'];break;case _0x511ddd(0x13c):_0xb777ca=[0x0],_0x558e2e=[0x0],_0x37f1ee=[0x1,0x2,0x3,0x4,0x5],_0x226e1a=['Floor'],_0xa2c0ca=['D'],_0x4193c9=['S'];break;case _0x511ddd(0xa1):_0xb777ca=[0x0],_0x558e2e=[0x0],_0x37f1ee=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x226e1a=[_0x511ddd(0xe3)],_0xa2c0ca=['D'],_0x4193c9=['R'];break;}else{if(_0x810538==_0x511ddd(0xfc))switch(_0x140696){case _0x511ddd(0x16a):_0xb777ca=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x558e2e=['B','F'],_0x37f1ee=[0x1,0x2,0x3,0x4,0x5],_0x226e1a=[_0x511ddd(0x9c),_0x511ddd(0xe3)],_0xa2c0ca=['C'],_0x4193c9=['A'];break;case _0x511ddd(0x156):_0xb777ca=[0x5,0x4,0x3,0x2,0x1],_0x558e2e=['F','B','S'],_0x37f1ee=[0x1,0x2,0x3,0x4,0x5],_0x226e1a=[_0x511ddd(0x9c),'Floor'],_0xa2c0ca=['C'],_0x4193c9=['B'];break;case'Rack\x20C':_0xb777ca=[0x1,0x2,0x3,0x4,0x5],_0x558e2e=['B','F','S'],_0x37f1ee=[0x5,0x4,0x3,0x2,0x1],_0x226e1a=[_0x511ddd(0x9c),'Floor'],_0xa2c0ca=['C'],_0x4193c9=['C'];break;case _0x511ddd(0x17c):_0xb777ca=[0x5,0x4,0x3,0x2,0x1],_0x558e2e=['F','B','S'],_0x37f1ee=[0x1,0x2,0x3,0x4,0x5],_0x226e1a=['Level',_0x511ddd(0xe3)],_0xa2c0ca=['C'],_0x4193c9=['D'];break;case'Rack\x20E':_0xb777ca=[0x4,0x3,0x2,0x1],_0x558e2e=[0x1,0x2],_0x37f1ee=[0x1,0x2,0x3,0x4,0x5],_0x226e1a=[_0x511ddd(0x9c),_0x511ddd(0xe3)],_0xa2c0ca=['C'],_0x4193c9=['E'];break;case _0x511ddd(0xe1):_0xb777ca=[0x1,0x2,0x3],_0x558e2e=[0x1,0x2],_0x37f1ee=[0x1,0x2,0x3,0x4,0x5],_0x226e1a=[_0x511ddd(0x9c)],_0xa2c0ca=['C'],_0x4193c9=['F'];break;}}return{'levels':_0xb777ca,'Isle':_0x558e2e,'rack':_0x37f1ee,'type':_0x226e1a,'storage':_0xa2c0ca,'rak':_0x4193c9};}router[a0_0x23e509(0xbc)](a0_0x23e509(0xcd),auth,async(_0x200e21,_0x258c5b)=>{var _0x15a80e=a0_0x23e509;try{const {username:_0x1dfbe3,email:_0x48b67c,role:_0xcca5ed}=_0x200e21[_0x15a80e(0x133)],_0x1a368a=_0x200e21[_0x15a80e(0x133)],_0x230d4e=await profile[_0x15a80e(0x13d)]({'email':_0x1a368a['email']}),_0x14b71d=await master_shop[_0x15a80e(0x12e)](),_0x282edc=await transfers[_0x15a80e(0x106)](_0x200e21['params']['id']);let _0x468f1a;if(_0x1a368a[_0x15a80e(0x11d)]==_0x15a80e(0xf3)){const _0x787c96=await staff[_0x15a80e(0x13d)]({'email':_0x1a368a['email']});_0x468f1a=await warehouse[_0x15a80e(0x172)]([{'$match':{'status':_0x15a80e(0xf8),'name':_0x787c96[_0x15a80e(0x13a)],'warehouse_category':_0x15a80e(0x102)}},{'$group':{'_id':_0x15a80e(0x15e),'name':{'$first':_0x15a80e(0x15e)}}}]);}else _0x468f1a=await warehouse['aggregate']([{'$match':{'status':_0x15a80e(0xf8),'warehouse_category':_0x15a80e(0x102)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x39b09b=await warehouse[_0x15a80e(0x172)]([{'$match':{'name':_0x282edc[_0x15a80e(0x12d)],'warehouse_category':_0x15a80e(0x102)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x15a80e(0xfa),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x15a80e(0xe4)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x15a80e(0x112)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x15a80e(0xd2)},'primary_code':{'$first':_0x15a80e(0x12b)},'secondary_code':{'$first':_0x15a80e(0x14d)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x15a80e(0x14e)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x15a80e(0x17a)},'room':{'$first':'$room'}}}]),_0x130b1f=await product[_0x15a80e(0x12e)]({}),_0x9a9b5f=BayBinSelected(_0x282edc[_0x15a80e(0xd1)],_0x282edc[_0x15a80e(0x122)]);if(_0x14b71d[0x0][_0x15a80e(0xad)]==_0x15a80e(0x16d)){var _0xbcbfaf=users[_0x15a80e(0xab)];console[_0x15a80e(0x111)](_0xbcbfaf);}else{if(_0x14b71d[0x0][_0x15a80e(0xad)]==_0x15a80e(0xa5))var _0xbcbfaf=users[_0x15a80e(0xa5)];else{if(_0x14b71d[0x0]['language']==_0x15a80e(0x127))var _0xbcbfaf=users['German'];else{if(_0x14b71d[0x0][_0x15a80e(0xad)]==_0x15a80e(0x16b))var _0xbcbfaf=users[_0x15a80e(0x16b)];else{if(_0x14b71d[0x0]['language']==_0x15a80e(0x165))var _0xbcbfaf=users[_0x15a80e(0x165)];else{if(_0x14b71d[0x0][_0x15a80e(0xad)]=='Portuguese\x20(BR)')var _0xbcbfaf=users[_0x15a80e(0x130)];else{if(_0x14b71d[0x0]['language']==_0x15a80e(0x107))var _0xbcbfaf=users[_0x15a80e(0x107)];else{if(_0x14b71d[0x0][_0x15a80e(0xad)]==_0x15a80e(0x110))var _0xbcbfaf=users[_0x15a80e(0x155)];}}}}}}}_0x258c5b[_0x15a80e(0x134)]('edit_transfer',{'success':_0x200e21['flash'](_0x15a80e(0xa4)),'errors':_0x200e21['flash'](_0x15a80e(0xa9)),'role':_0x1a368a,'profile':_0x230d4e,'master_shop':_0x14b71d,'warehouse':_0x468f1a,'transfer':_0x282edc,'stock':_0x39b09b,'unit':_0x130b1f,'language':_0xbcbfaf});}catch(_0x3855a0){console[_0x15a80e(0x111)](_0x3855a0);}}),router[a0_0x23e509(0xc4)](a0_0x23e509(0xcd),auth,async(_0x48cc55,_0x2e323d)=>{var _0x386257=a0_0x23e509;try{const _0x23df7f=_0x48cc55[_0x386257(0xfe)]['id'],_0x34d1bc=await transfers[_0x386257(0x106)](_0x23df7f);_0x2e323d[_0x386257(0xc8)](_0x48cc55[_0x386257(0x153)]);return;const {date:_0x315e61,from_warehouse:_0x4383e3,FromRoom_name:_0x36a7d4,to_warehouse:_0xfccd7a,ToRoom_name:_0x25399b,prod_name:_0x1992ba,from_prod_qty:_0x1a2b27,from_prod_level:_0x4ed9f7,from_prod_isle:_0x3c62e1,from_prod_pallet:_0x2801e4,to_prod_qty:_0x277bd5,to_prod_level:_0x5020a7,to_prod_isle:_0x57e935,to_prod_pallet:_0x51914d,primary_code:_0x367713,secondary_code:_0x16ac9a,product_code3:_0x502500,note:_0xe997ac,invoice:_0x32a335,expiry_date:_0x29b213}=_0x48cc55['body'];if(typeof _0x1992ba==_0x386257(0xb2))var _0x50ea2a=[_0x48cc55[_0x386257(0x153)]['prod_name']],_0x2e8f10=[_0x48cc55[_0x386257(0x153)][_0x386257(0xda)]],_0x26adcc=[_0x48cc55[_0x386257(0x153)]['from_prod_level']],_0x1f659e=[_0x48cc55[_0x386257(0x153)][_0x386257(0x10c)]],_0x2e9fb6=[_0x48cc55[_0x386257(0x153)][_0x386257(0xde)]],_0x2f4bfb=[_0x48cc55[_0x386257(0x153)]['from_types']],_0xdda93d=[_0x48cc55[_0x386257(0x153)][_0x386257(0x11c)]],_0x575b4e=[_0x48cc55[_0x386257(0x153)]['to_prod_level']],_0x383d88=[_0x48cc55[_0x386257(0x153)][_0x386257(0x11a)]],_0xb50490=[_0x48cc55['body'][_0x386257(0x149)]],_0x14ec1d=[_0x48cc55[_0x386257(0x153)][_0x386257(0x10f)]],_0x184c42=[_0x48cc55[_0x386257(0x153)]['storage']],_0x2b616d=[_0x48cc55[_0x386257(0x153)][_0x386257(0xa7)]],_0x1e5dea=[_0x48cc55[_0x386257(0x153)][_0x386257(0x12f)]],_0x554dfd=[_0x48cc55[_0x386257(0x153)]['secondary_code']],_0x16b22c=[_0x48cc55[_0x386257(0x153)][_0x386257(0xc1)]],_0x3cdcd6=[_0x48cc55['body']['MaxStocks_data2']],_0x372e58=[_0x48cc55['body']['unit']],_0x23af85=[_0x48cc55[_0x386257(0x153)][_0x386257(0x120)]],_0x160463=[_0x48cc55[_0x386257(0x153)]['batch_code']],_0x4692a2=[_0x48cc55[_0x386257(0x153)][_0x386257(0x170)]],_0x167178=[_0x48cc55[_0x386257(0x153)][_0x386257(0x105)]],_0x4d0f37=[_0x48cc55[_0x386257(0x153)][_0x386257(0x189)]];else var _0x50ea2a=[..._0x48cc55['body'][_0x386257(0xa8)]],_0x184c42=[..._0x48cc55[_0x386257(0x153)][_0x386257(0x108)]],_0x2b616d=[..._0x48cc55[_0x386257(0x153)][_0x386257(0xa7)]],_0x2f4bfb=[..._0x48cc55[_0x386257(0x153)]['from_types']],_0x14ec1d=[..._0x48cc55['body'][_0x386257(0x10f)]],_0x2e8f10=[..._0x48cc55[_0x386257(0x153)][_0x386257(0xda)]],_0x26adcc=[..._0x48cc55[_0x386257(0x153)][_0x386257(0xd4)]],_0x1f659e=[..._0x48cc55['body'][_0x386257(0x10c)]],_0x2e9fb6=[..._0x48cc55[_0x386257(0x153)][_0x386257(0xde)]],_0xdda93d=[..._0x48cc55[_0x386257(0x153)][_0x386257(0x11c)]],_0x575b4e=[..._0x48cc55[_0x386257(0x153)][_0x386257(0x13f)]],_0x383d88=[..._0x48cc55[_0x386257(0x153)][_0x386257(0x11a)]],_0xb50490=[..._0x48cc55[_0x386257(0x153)]['to_prod_pallet']],_0x1e5dea=[..._0x48cc55['body']['primary_code']],_0x554dfd=[..._0x48cc55['body'][_0x386257(0x100)]],_0x16b22c=[..._0x48cc55[_0x386257(0x153)][_0x386257(0xc1)]],_0x3cdcd6=[..._0x48cc55['body'][_0x386257(0x132)]],_0x372e58=[..._0x48cc55[_0x386257(0x153)][_0x386257(0x10a)]],_0x23af85=[..._0x48cc55[_0x386257(0x153)][_0x386257(0x120)]],_0x160463=[..._0x48cc55[_0x386257(0x153)][_0x386257(0x162)]],_0x4692a2=[..._0x48cc55[_0x386257(0x153)][_0x386257(0x170)]],_0x167178=[..._0x48cc55[_0x386257(0x153)]['from_storage']],_0x4d0f37=[..._0x48cc55[_0x386257(0x153)][_0x386257(0x189)]];const _0x538ba9=_0x50ea2a[_0x386257(0xf2)](_0x56f5db=>{return _0x56f5db={'product_name':_0x56f5db};});_0x2e8f10['forEach']((_0x22109d,_0x1112ba)=>{var _0x1c933e=_0x386257;_0x538ba9[_0x1112ba][_0x1c933e(0x16f)]=_0x22109d;}),_0x26adcc['forEach']((_0x3872df,_0x359196)=>{var _0x368c14=_0x386257;_0x538ba9[_0x359196][_0x368c14(0x17e)]=_0x3872df;}),_0x1f659e[_0x386257(0x13b)]((_0x29149d,_0x288c3d)=>{_0x538ba9[_0x288c3d]['from_bin']=_0x29149d;}),_0x2e9fb6['forEach']((_0x4825b9,_0x3411a3)=>{var _0xa95b0f=_0x386257;_0x538ba9[_0x3411a3][_0xa95b0f(0x15f)]=_0x4825b9;}),_0xdda93d[_0x386257(0x13b)]((_0x52045a,_0x580227)=>{var _0x1d4d94=_0x386257;_0x538ba9[_0x580227][_0x1d4d94(0xd9)]=_0x52045a;}),_0x575b4e[_0x386257(0x13b)]((_0x128fa3,_0xf41c02)=>{_0x538ba9[_0xf41c02]['to_bay']=_0x128fa3;}),_0x383d88['forEach']((_0x5ad013,_0x26cda6)=>{var _0x5b67f5=_0x386257;_0x538ba9[_0x26cda6][_0x5b67f5(0xbd)]=_0x5ad013;}),_0xb50490['forEach']((_0x309a55,_0x1e5b05)=>{var _0x2e01dd=_0x386257;_0x538ba9[_0x1e5b05][_0x2e01dd(0xe9)]=_0x309a55;}),_0x1e5dea['forEach']((_0x32c5ab,_0x1fbdc)=>{var _0x11689f=_0x386257;_0x538ba9[_0x1fbdc][_0x11689f(0x12f)]=_0x32c5ab;}),_0x554dfd[_0x386257(0x13b)]((_0x3ab6a8,_0x46edf0)=>{var _0x34682e=_0x386257;_0x538ba9[_0x46edf0][_0x34682e(0x100)]=_0x3ab6a8;}),_0x16b22c[_0x386257(0x13b)]((_0x54873c,_0x282248)=>{var _0x1f06da=_0x386257;_0x538ba9[_0x282248][_0x1f06da(0x12a)]=_0x54873c;}),_0x3cdcd6[_0x386257(0x13b)]((_0x5a0513,_0xd9ab6)=>{_0x538ba9[_0xd9ab6]['maxProducts']=_0x5a0513;}),_0x372e58[_0x386257(0x13b)]((_0x114a84,_0x24d38a)=>{_0x538ba9[_0x24d38a]['unit']=_0x114a84;}),_0x23af85[_0x386257(0x13b)]((_0x5a3700,_0x101d26)=>{var _0xd6e847=_0x386257;_0x538ba9[_0x101d26][_0xd6e847(0x120)]=_0x5a3700;}),_0x160463[_0x386257(0x13b)]((_0x13a759,_0x35989a)=>{var _0x12e322=_0x386257;_0x538ba9[_0x35989a][_0x12e322(0x162)]=_0x13a759;}),_0x4692a2[_0x386257(0x13b)]((_0x4025b5,_0x5f25f5)=>{var _0x4ecbef=_0x386257;_0x538ba9[_0x5f25f5][_0x4ecbef(0x170)]=_0x4025b5;}),_0x184c42[_0x386257(0x13b)]((_0x133103,_0x219b14)=>{var _0x351373=_0x386257;_0x538ba9[_0x219b14][_0x351373(0x108)]=_0x133103;}),_0x2b616d[_0x386257(0x13b)]((_0x43f9ed,_0x5215a0)=>{var _0x32f076=_0x386257;_0x538ba9[_0x5215a0][_0x32f076(0x115)]=_0x43f9ed;}),_0x2f4bfb[_0x386257(0x13b)]((_0x1d1aa6,_0x18fb3d)=>{var _0x4e5ab6=_0x386257;_0x538ba9[_0x18fb3d][_0x4e5ab6(0xdc)]=_0x1d1aa6;}),_0x14ec1d[_0x386257(0x13b)]((_0x5cb802,_0x58c989)=>{var _0x5911fe=_0x386257;_0x538ba9[_0x58c989][_0x5911fe(0x10f)]=_0x5cb802;}),_0x167178[_0x386257(0x13b)]((_0xf92ec4,_0x5ae5dd)=>{var _0x2a6a08=_0x386257;_0x538ba9[_0x5ae5dd][_0x2a6a08(0x105)]=_0xf92ec4;}),_0x4d0f37[_0x386257(0x13b)]((_0x7eb4c3,_0x59ec25)=>{var _0x49c867=_0x386257;_0x538ba9[_0x59ec25][_0x49c867(0x143)]=_0x7eb4c3;});const _0xdcd3d4=_0x538ba9[_0x386257(0x147)](_0x5b677e=>_0x5b677e[_0x386257(0xd9)]!=='0'&&_0x5b677e[_0x386257(0xd9)]!==''||_0x5b677e['to_floorlevel']!=='0'&&_0x5b677e[_0x386257(0xe9)]!=='');var _0x491341=0x0;_0xdcd3d4[_0x386257(0x13b)](_0x4488d1=>{var _0x3e0120=_0x386257;parseInt(_0x4488d1['from_quantity'])<parseInt(_0x4488d1[_0x3e0120(0xd9)])&&_0x491341++;});if(_0x491341!=0x0)return _0x48cc55[_0x386257(0x145)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x2e323d[_0x386257(0x10b)](_0x386257(0x18a));const _0x397cec=await warehouse[_0x386257(0x13d)]({'name':_0x34d1bc[_0x386257(0x12d)],'room':_0x34d1bc[_0x386257(0x117)]});_0x34d1bc[_0x386257(0x18f)][_0x386257(0x13b)](_0x44ec28=>{var _0x47f1f5=_0x386257;if(_0x44ec28[_0x47f1f5(0xd9)]>0x0){const _0x13a3bb=_0x397cec[_0x47f1f5(0xd5)][_0x47f1f5(0xf2)](_0x1d6227=>{var _0x10e681=_0x47f1f5;_0x1d6227[_0x10e681(0x163)]==_0x44ec28['product_name']&&_0x1d6227[_0x10e681(0xb9)]==_0x44ec28[_0x10e681(0x15f)]&&_0x1d6227[_0x10e681(0x168)]==_0x44ec28['from_types']&&_0x1d6227[_0x10e681(0x9f)]==_0x44ec28[_0x10e681(0x11e)]&&_0x1d6227[_0x10e681(0xec)]==_0x44ec28[_0x10e681(0x17e)]&&_0x1d6227[_0x10e681(0x115)]==_0x44ec28[_0x10e681(0x143)]&&_0x1d6227[_0x10e681(0x108)]==_0x44ec28[_0x10e681(0x105)]&&(_0x1d6227[_0x10e681(0xb4)]=parseInt(_0x1d6227[_0x10e681(0xb4)])+parseInt(_0x44ec28[_0x10e681(0xd9)]));});}}),await _0x397cec[_0x386257(0x136)]();const _0x2882af=await warehouse[_0x386257(0x13d)]({'name':_0x34d1bc[_0x386257(0xd1)],'room':_0x34d1bc[_0x386257(0x122)]});_0x34d1bc['product'][_0x386257(0x13b)](_0x56b581=>{var _0x474948=_0x386257;if(_0x56b581[_0x474948(0xd9)]>0x0){const _0x22f116=_0x2882af[_0x474948(0xd5)][_0x474948(0xf2)](_0x9b1f8=>{var _0x4e2e06=_0x474948;_0x9b1f8[_0x4e2e06(0x163)]==_0x56b581[_0x4e2e06(0x163)]&&_0x9b1f8[_0x4e2e06(0xb9)]==_0x56b581[_0x4e2e06(0xe9)]&&_0x9b1f8['type']==_0x56b581[_0x4e2e06(0x10f)]&&_0x9b1f8['bin']==_0x56b581['to_bin']&&_0x9b1f8[_0x4e2e06(0xec)]==_0x56b581[_0x4e2e06(0x144)]&&_0x9b1f8[_0x4e2e06(0x115)]==_0x56b581['rack']&&_0x9b1f8['storage']==_0x56b581['storage']&&(_0x9b1f8['product_stock']=parseInt(_0x9b1f8[_0x4e2e06(0xb4)])-parseInt(_0x56b581[_0x4e2e06(0xd9)]));});}}),await _0x2882af[_0x386257(0x136)](),_0x34d1bc[_0x386257(0xb6)]=_0x315e61,_0x34d1bc[_0x386257(0x12d)]=_0x4383e3,_0x34d1bc[_0x386257(0xd1)]=_0xfccd7a,_0x34d1bc['product']=_0xdcd3d4,_0x34d1bc[_0x386257(0x17d)]=_0xe997ac,_0x34d1bc[_0x386257(0x146)]=_0x32a335;const _0x16576d=await _0x34d1bc[_0x386257(0x136)]();console[_0x386257(0x111)](_0x16576d);const _0x478153=await warehouse['findOne']({'name':_0x4383e3,'room':_0x36a7d4});_0x16576d[_0x386257(0x18f)][_0x386257(0x13b)](_0x296ce4=>{var _0x53fe79=_0x386257;if(_0x296ce4[_0x53fe79(0xd9)]>0x0){const _0x1d9478=_0x478153[_0x53fe79(0xd5)][_0x53fe79(0xf2)](_0x36c853=>{var _0x59598b=_0x53fe79;_0x36c853['product_name']==_0x296ce4[_0x59598b(0x163)]&&_0x36c853[_0x59598b(0xb9)]==_0x296ce4[_0x59598b(0x15f)]&&_0x36c853[_0x59598b(0x168)]==_0x296ce4[_0x59598b(0xdc)]&&_0x36c853[_0x59598b(0x9f)]==_0x296ce4[_0x59598b(0x11e)]&&_0x36c853['bay']==_0x296ce4[_0x59598b(0x17e)]&&_0x36c853[_0x59598b(0x115)]==_0x296ce4[_0x59598b(0x143)]&&_0x36c853['storage']==_0x296ce4[_0x59598b(0x105)]&&(_0x36c853['product_stock']=parseInt(_0x36c853[_0x59598b(0xb4)])-parseInt(_0x296ce4[_0x59598b(0xd9)]));});}}),await _0x478153['save']();const _0x1af70f=await warehouse[_0x386257(0x13d)]({'name':_0xfccd7a,'room':_0x25399b});_0x16576d['product'][_0x386257(0x13b)](_0x5cbb46=>{var _0x23c991=_0x386257;if(_0x5cbb46[_0x23c991(0xd9)]>0x0){var _0x3631a1=0x0;const _0x25afe2=_0x1af70f['product_details'][_0x23c991(0xf2)](_0x435f6b=>{var _0x444d33=_0x23c991;_0x435f6b[_0x444d33(0x163)]==_0x5cbb46['product_name']&&_0x435f6b['floorlevel']==_0x5cbb46[_0x444d33(0xe9)]&&_0x435f6b[_0x444d33(0x168)]==_0x5cbb46[_0x444d33(0x10f)]&&_0x435f6b[_0x444d33(0x9f)]==_0x5cbb46['to_bin']&&_0x435f6b[_0x444d33(0xec)]==_0x5cbb46[_0x444d33(0x144)]&&_0x435f6b[_0x444d33(0x115)]==_0x5cbb46[_0x444d33(0x115)]&&_0x435f6b[_0x444d33(0x108)]==_0x5cbb46[_0x444d33(0x108)]&&(_0x435f6b[_0x444d33(0xb4)]=parseInt(_0x435f6b['product_stock'])+parseInt(_0x5cbb46['to_quantity']),_0x3631a1++);});_0x3631a1=='0'&&(_0x1af70f[_0x23c991(0xd5)]=_0x1af70f[_0x23c991(0xd5)]['concat']({'product_name':_0x5cbb46[_0x23c991(0x163)],'product_stock':_0x5cbb46[_0x23c991(0xd9)],'bay':_0x5cbb46['to_bay'],'bin':_0x5cbb46[_0x23c991(0xbd)],'type':_0x5cbb46[_0x23c991(0x10f)],'floorlevel':_0x5cbb46['to_floorlevel'],'storage':_0x5cbb46['storage'],'rack':_0x5cbb46[_0x23c991(0x115)],'product_code':_0x5cbb46[_0x23c991(0x12a)],'primary_code':_0x5cbb46[_0x23c991(0x12f)],'secondary_code':_0x5cbb46[_0x23c991(0x100)],'maxProducts':_0x5cbb46['maxProducts'],'storage':_0x5cbb46['storage'],'rack':_0x5cbb46[_0x23c991(0x115)]}));}}),await _0x1af70f[_0x386257(0x136)](),_0x48cc55[_0x386257(0x145)]('success',_0x386257(0x177)),_0x2e323d[_0x386257(0x10b)](_0x386257(0x121));}catch(_0x4200d8){console['log'](_0x4200d8);}}),router['post'](a0_0x23e509(0x148),async(_0x79b9d2,_0x3fc2f2)=>{var _0x102b4d=a0_0x23e509;const {FromWareHouse:_0x56ef5b,FromRoom:_0x391fc5,ToWarehouse:_0x145149,ToRoom:_0xf46fd3,primary_code:_0x5a6c6e,Roomslist:_0x351d2e}=_0x79b9d2['body'],_0x3f6517=_0x351d2e[_0x102b4d(0x18b)](','),_0x654c90=[];async function _0x5c7f65(_0x4e5ee){var _0x121af1=_0x102b4d;const _0x13a8f6=await warehouse[_0x121af1(0x172)]([{'$match':{'name':_0x56ef5b,'room':_0x4e5ee}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x5a6c6e}},{'$group':{'_id':_0x121af1(0xfa),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x121af1(0xe4)},'primary_code':{'$first':_0x121af1(0x12b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x121af1(0xb7)},'level':{'$first':_0x121af1(0x139)},'isle':{'$first':_0x121af1(0x112)},'type':{'$first':_0x121af1(0x14f)},'pallet':{'$first':_0x121af1(0xd2)},'unit':{'$first':_0x121af1(0x135)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x121af1(0x14e)},'rack':{'$first':_0x121af1(0x187)},'expiry_date':{'$first':_0x121af1(0xfb)},'production_date':{'$first':_0x121af1(0x17a)},'batch_code':{'$first':_0x121af1(0x140)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x121af1(0xaf)},'maxProducts':{'$first':_0x121af1(0x15a)},'invoice_product':{'$first':_0x121af1(0x154)}}}]),_0xb48092=await warehouse[_0x121af1(0x172)]([{'$match':{'name':_0x56ef5b,'room':_0x4e5ee}},{'$unwind':_0x121af1(0x150)},{'$match':{'product_details.secondary_code':_0x5a6c6e}},{'$group':{'_id':_0x121af1(0xfa),'name':{'$first':_0x121af1(0xb0)},'instock':{'$first':_0x121af1(0xe4)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x121af1(0x14d)},'product_code':{'$first':_0x121af1(0xb7)},'level':{'$first':_0x121af1(0x139)},'isle':{'$first':_0x121af1(0x112)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x121af1(0xd2)},'unit':{'$first':_0x121af1(0x135)},'secondary_unit':{'$first':_0x121af1(0x180)},'storage':{'$first':_0x121af1(0x14e)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x121af1(0xfb)},'production_date':{'$first':_0x121af1(0x17a)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x121af1(0x176)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x121af1(0xaf)},'maxProducts':{'$first':_0x121af1(0x15a)},'invoice_product':{'$first':_0x121af1(0x154)}}}]);if(_0x13a8f6['length']>0x0)_0x654c90[_0x121af1(0xdd)](_0x13a8f6);else _0xb48092[_0x121af1(0xb8)]>0x0&&_0x654c90[_0x121af1(0xdd)](_0xb48092);}const _0x239876=_0x3f6517[_0x102b4d(0xf2)](_0x5a16c7=>_0x5c7f65(_0x5a16c7));await Promise[_0x102b4d(0x131)](_0x239876),_0x3fc2f2[_0x102b4d(0xc8)](_0x654c90);}),router['post'](a0_0x23e509(0x142),async(_0x20f122,_0x1d7297)=>{var _0x5d1821=a0_0x23e509;try{const {FromWareHouse:_0x1b7687,FromRoom:_0xff34a3,ToWarehouse:_0x2978d7,ToRoom:_0x3c04f1,secondary_code:_0x91d3a}=_0x20f122[_0x5d1821(0x153)],_0x33a14c=await warehouse[_0x5d1821(0x172)]([{'$match':{'name':_0x1b7687}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x91d3a}},{'$group':{'_id':_0x5d1821(0xfa),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x5d1821(0x12b)},'secondary_code':{'$first':_0x5d1821(0x14d)},'product_code':{'$first':_0x5d1821(0xb7)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x5d1821(0x15e)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x5d1821(0xdb)},'pallet':{'$first':_0x5d1821(0x104)},'maxProducts':{'$first':_0x5d1821(0x15a)},'unit':{'$first':_0x5d1821(0x135)}}}]);_0x1d7297[_0x5d1821(0xbf)](0xc8)['json'](_0x33a14c);}catch(_0x6cb84f){_0x1d7297[_0x5d1821(0xbf)](0x194)[_0x5d1821(0xc8)]({'message':_0x6cb84f['message']});}}),router[a0_0x23e509(0xc4)]('/barcode_scanner3',async(_0x3b1c81,_0x551195)=>{var _0x2cd482=a0_0x23e509;try{const {FromWareHouse:_0x4dda1d,FromRoom:_0x15e385,ToWarehouse:_0x3dbe9a,ToRoom:_0x5d7377,product_code:_0x2801c2}=_0x3b1c81['body'],_0x2b8f80=await warehouse['aggregate']([{'$match':{'name':_0x4dda1d}},{'$unwind':_0x2cd482(0x150)},{'$match':{'product_details.product_code':_0x2801c2}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2cd482(0xb0)},'primary_code':{'$first':_0x2cd482(0x12b)},'secondary_code':{'$first':_0x2cd482(0x14d)},'product_code':{'$first':_0x2cd482(0xb7)},'instock':{'$first':_0x2cd482(0xe4)},'warehouse':{'$first':_0x2cd482(0x15e)},'level':{'$first':_0x2cd482(0xf4)},'isle':{'$first':_0x2cd482(0xdb)},'pallet':{'$first':_0x2cd482(0x104)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x2cd482(0x135)}}}]);_0x551195['status'](0xc8)[_0x2cd482(0xc8)](_0x2b8f80);}catch(_0x4f04cd){_0x551195[_0x2cd482(0xbf)](0x194)[_0x2cd482(0xc8)]({'message':_0x4f04cd[_0x2cd482(0xa3)]});}}),router[a0_0x23e509(0xc4)](a0_0x23e509(0x184),async(_0x486062,_0x26d252)=>{var _0x24abc8=a0_0x23e509;const {level:_0x1dbe5d,isle:_0x2769d7,pallet:_0x36d671,warehouses:_0x45cace,room:_0x5ea21f}=_0x486062['body'];try{const _0x58ea79=await warehouse[_0x24abc8(0x172)]([{'$match':{'name':_0x45cace,'room':_0x5ea21f}},{'$unwind':_0x24abc8(0x150)},{'$match':{'product_details.level':parseInt(_0x1dbe5d),'product_details.isle':_0x2769d7,'product_details.pallet':parseInt(_0x36d671)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x24abc8(0xb0)},'product_stock':{'$first':_0x24abc8(0xe4)},'level':{'$first':_0x24abc8(0xf4)},'isle':{'$first':_0x24abc8(0xdb)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x24abc8(0x15a)}}}]);_0x26d252[_0x24abc8(0xbf)](0xc8)[_0x24abc8(0xc8)](_0x58ea79);}catch(_0x31c35b){_0x26d252[_0x24abc8(0xbf)](0x194)[_0x24abc8(0xc8)]({'message':_0x31c35b['message']});}}),module[a0_0x23e509(0x11f)]=router;