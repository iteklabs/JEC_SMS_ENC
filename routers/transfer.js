var a0_0x2fc07c=a0_0x3900;(function(_0x46a233,_0x5baa50){var _0x28034e=a0_0x3900,_0x285c69=_0x46a233();while(!![]){try{var _0x3511ec=parseInt(_0x28034e(0x162))/0x1+parseInt(_0x28034e(0xfe))/0x2+parseInt(_0x28034e(0x152))/0x3*(-parseInt(_0x28034e(0xfd))/0x4)+-parseInt(_0x28034e(0x18b))/0x5*(parseInt(_0x28034e(0xb1))/0x6)+-parseInt(_0x28034e(0x12a))/0x7*(parseInt(_0x28034e(0x170))/0x8)+parseInt(_0x28034e(0xe7))/0x9*(-parseInt(_0x28034e(0x16e))/0xa)+parseInt(_0x28034e(0x118))/0xb;if(_0x3511ec===_0x5baa50)break;else _0x285c69['push'](_0x285c69['shift']());}catch(_0x369e60){_0x285c69['push'](_0x285c69['shift']());}}}(a0_0x322d,0x2cd5f));const express=require(a0_0x2fc07c(0x15d)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x2fc07c(0x129)),auth=require(a0_0x2fc07c(0x172)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x2fc07c(0x11c));function a0_0x3900(_0x287eca,_0x1013a2){var _0x322da9=a0_0x322d();return a0_0x3900=function(_0x3900e9,_0x4e664b){_0x3900e9=_0x3900e9-0xa8;var _0x58a43c=_0x322da9[_0x3900e9];return _0x58a43c;},a0_0x3900(_0x287eca,_0x1013a2);}function a0_0x322d(){var _0x285a15=['/barcode_scanner3','$product_details.isle','map','Hindi','6114086XecrIj','English\x20(US)','Product\x20Transfer\x20successfully','from_room_name','nodemailer','French','\x20Order\x20Number\x20:\x20','redirect','<strong>\x20Regards\x20</strong>','from_rak','role','$product_details.product_stock','$product_details.invoice','<!DOCTYPE\x20html>','from_prod_pallet','edit_transfer','from_bin','../models/all_models','21rbkfWn','back','random','$room','date','Shelves','status','$product_details.floorlevel','to_types','Portuguese\x20(BR)','Error\x20Occurs','Rack\x20B','$product_details.pallet','from_prod_isle','product_name','expiry_date','language','updateOne','bay','<h5\x20style=\x22text-align:\x20left;\x22>','from_invoice','$product_details.bin','padStart','$product_details.maxProducts','storage','</h5>','split','Arabic\x20(ae)','Transfer\x20Edit\x20Successfully','batch_code','catch','<h5>','to_warehouse','floorlevel','Enabled','Chinese','to_prod_level','logo','to_bay','$to_warehouse','19563CwfnzZ','error','</div>','Raw\x20Materials','/transfer/preview/','$date','host','to_room_name','params','filter','$product_details.type','express','product_stock','id_transaction','from_types','from_warehouse','100441QkHWLl','find','</td>','to_room','True','site_title','getMonth','to_prod_isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','<h2>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</tbody>','340JGguGF','product','610024UpEtYR','Portuguese','../middleware/auth','</thead>','from_storage','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','maxProducts','$product_details.production_date','floor','Rack\x20F','to_prod_pallet','from_rack','\x20</h2>','$product_details.rack','Transfer\x20Finalize\x20Successfully','message','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.secondary_code','Level','$product_details.secondary_unit','COLD\x20STORAGE','</span>','primary_code','<html><head><title></title>','all','25IykBTC','flash','$product_details','Floor','to_quantity','/view/:id','Email\x20sent\x20successfully','Rack\x20A','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','secondary_unit','$product_details.unit','production_date','/view/add_transfer','Receiving\x20Area','$product_details.expiry_date','</tr>','New_Qty_Converted','To_invoice','/preview/:id','</head><body>','\x20<>\x20','slice','edit_transfer_view','staff','There\x27s\x20a\x20error\x20in\x20this\x20transaction','sendMail','266028UnWTrH','length','max_per_unit','success','</table>','from_room','$product_details.bay','Return\x20Rooms','$product_details.maxPerUnit','from_quantity','Rack\x20E','aggregate','getDate','to_floorlevel','get','Logo.png','findById','$product_details.product_code','ToRoomAssigned','Rack\x20D','product_details','maxperunit','$product_details.storage','port','Enclosed','MaxStocks_data2','Spanish','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_code3','findOne','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','to_prod_qty','$product_details.level','exports','prod_cat','unit','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','createTransport','render','string','<tr>','add_transfer','post','to_bin','</body></html>','German','note','TRF-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','English','id_transaction_id','/upload/','$_id','52389HGAcrE','email','master','$name','save','$product.to_room_name','<div>','getFullYear','from_prod_qty','from_bay','bin','from_floorlevel','Ambient','invoice','$product_details.batch_code','An\x20error\x20occurred\x20while\x20saving\x20data.','warehouse','product_code','transfer','push','secondary_code','Transfer\x20Mail','100ZXbURg','677536LqsDIk','prod_name','$product_details.product_name','json','_id','user','type','then','from_prod_level','body','/transfer/view','Arabic','forEach','to_invoice','rack','RoomAssigned','An\x20error\x20occurred.','errors','$product_details._id','/CheckingWarehouse','/view','\x20Order\x20Date\x20:\x20'];a0_0x322d=function(){return _0x285a15;};return a0_0x322d();}router[a0_0x2fc07c(0xbf)](a0_0x2fc07c(0x112),auth,async(_0x23f31a,_0x611057)=>{var _0x140dfa=a0_0x2fc07c;try{const {username:_0x2f78b1,email:_0x363ebd,role:_0x459f6f}=_0x23f31a[_0x140dfa(0x103)],_0x40897e=_0x23f31a[_0x140dfa(0x103)],_0x3bbdf8=await profile[_0x140dfa(0xce)]({'email':_0x40897e['email']}),_0x4174b6=await master_shop[_0x140dfa(0x163)]();console[_0x140dfa(0xcf)](_0x140dfa(0xe9),_0x4174b6);let _0x210fcf;if(_0x40897e[_0x140dfa(0x122)]==_0x140dfa(0xae)){const _0x59f333=await staff['findOne']({'email':_0x40897e[_0x140dfa(0xe8)]});_0x210fcf=await transfers[_0x140dfa(0x163)]({'from_warehouse':_0x59f333[_0x140dfa(0xf7)]});}else _0x210fcf=await transfers[_0x140dfa(0xbc)]([{'$unwind':'$product'},{'$group':{'_id':_0x140dfa(0xe6),'invoice':{'$first':'$invoice'},'date':{'$first':_0x140dfa(0x157)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x140dfa(0x151)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x140dfa(0xec)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4174b6[0x0]['language']==_0x140dfa(0x119)){var _0x3090a6=users[_0x140dfa(0xe3)];console[_0x140dfa(0xcf)](_0x3090a6);}else{if(_0x4174b6[0x0]['language']==_0x140dfa(0x117))var _0x3090a6=users[_0x140dfa(0x117)];else{if(_0x4174b6[0x0]['language']==_0x140dfa(0xdf))var _0x3090a6=users[_0x140dfa(0xdf)];else{if(_0x4174b6[0x0][_0x140dfa(0x13a)]==_0x140dfa(0xcb))var _0x3090a6=users[_0x140dfa(0xcb)];else{if(_0x4174b6[0x0]['language']==_0x140dfa(0x11d))var _0x3090a6=users[_0x140dfa(0x11d)];else{if(_0x4174b6[0x0][_0x140dfa(0x13a)]=='Portuguese\x20(BR)')var _0x3090a6=users[_0x140dfa(0x171)];else{if(_0x4174b6[0x0][_0x140dfa(0x13a)]==_0x140dfa(0x14d))var _0x3090a6=users[_0x140dfa(0x14d)];else{if(_0x4174b6[0x0]['language']==_0x140dfa(0x145))var _0x3090a6=users[_0x140dfa(0x109)];}}}}}}}_0x611057[_0x140dfa(0xd8)](_0x140dfa(0xf9),{'success':_0x23f31a[_0x140dfa(0x18c)](_0x140dfa(0xb4)),'errors':_0x23f31a[_0x140dfa(0x18c)](_0x140dfa(0x10f)),'role':_0x40897e,'profile':_0x3bbdf8,'master_shop':_0x4174b6,'transfer':_0x210fcf,'language':_0x3090a6});}catch(_0x52b43e){console[_0x140dfa(0xcf)](_0x52b43e);}});async function getRandom8DigitNumber(){var _0x381b06=a0_0x2fc07c;const _0x13229f=0x989680,_0x2293fa=0x5f5e0ff,_0x3fd23c=Math[_0x381b06(0x179)](Math[_0x381b06(0x12c)]()*(_0x2293fa-_0x13229f+0x1))+_0x13229f;var _0x328348;const _0x118ccb=await transfers[_0x381b06(0xce)]({'invoice':_0x381b06(0xe1)+_0x3fd23c});return _0x118ccb&&_0x118ccb[_0x381b06(0xb2)]>0x0?_0x328348=_0x381b06(0xe1)+_0x3fd23c:_0x328348=_0x381b06(0xe1)+_0x3fd23c,_0x328348;}router['get'](a0_0x2fc07c(0x197),auth,async(_0x257778,_0x110585)=>{var _0x3e94e5=a0_0x2fc07c;try{const {username:_0x199f75,email:_0x240ba5,role:_0x54652f}=_0x257778[_0x3e94e5(0x103)],_0x325fc3=_0x257778['user'],_0x19aab2=await profile[_0x3e94e5(0xce)]({'email':_0x325fc3[_0x3e94e5(0xe8)]}),_0x26a9a0=await master_shop[_0x3e94e5(0x163)]();console[_0x3e94e5(0xcf)](_0x3e94e5(0xe9),_0x26a9a0);let _0x28d1bf;if(_0x325fc3[_0x3e94e5(0x122)]==_0x3e94e5(0xae)){const _0x3e6692=await staff[_0x3e94e5(0xce)]({'email':_0x325fc3[_0x3e94e5(0xe8)]});_0x28d1bf=await warehouse[_0x3e94e5(0xbc)]([{'$match':{'status':_0x3e94e5(0x14c),'name':_0x3e6692['warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3e94e5(0xea),'name':{'$first':_0x3e94e5(0xea)}}}]);}else _0x28d1bf=await warehouse[_0x3e94e5(0xbc)]([{'$match':{'status':_0x3e94e5(0x14c),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3e94e5(0xea),'name':{'$first':_0x3e94e5(0xea)}}}]);var _0x428c79=[_0x3e94e5(0xf3),_0x3e94e5(0xc9),_0x3e94e5(0xb8)];const _0xaf0786=await transfers[_0x3e94e5(0x163)]({}),_0x477ea6=_0xaf0786['length']+0x1,_0x23b013=_0x3e94e5(0xe1)+_0x477ea6['toString']()[_0x3e94e5(0x140)](0x5,'0');if(_0x26a9a0[0x0][_0x3e94e5(0x13a)]==_0x3e94e5(0x119)){var _0x3dd9ec=users['English'];console[_0x3e94e5(0xcf)](_0x3dd9ec);}else{if(_0x26a9a0[0x0][_0x3e94e5(0x13a)]=='Hindi')var _0x3dd9ec=users[_0x3e94e5(0x117)];else{if(_0x26a9a0[0x0][_0x3e94e5(0x13a)]==_0x3e94e5(0xdf))var _0x3dd9ec=users[_0x3e94e5(0xdf)];else{if(_0x26a9a0[0x0][_0x3e94e5(0x13a)]==_0x3e94e5(0xcb))var _0x3dd9ec=users[_0x3e94e5(0xcb)];else{if(_0x26a9a0[0x0]['language']=='French')var _0x3dd9ec=users['French'];else{if(_0x26a9a0[0x0][_0x3e94e5(0x13a)]==_0x3e94e5(0x133))var _0x3dd9ec=users['Portuguese'];else{if(_0x26a9a0[0x0]['language']==_0x3e94e5(0x14d))var _0x3dd9ec=users[_0x3e94e5(0x14d)];else{if(_0x26a9a0[0x0][_0x3e94e5(0x13a)]==_0x3e94e5(0x145))var _0x3dd9ec=users[_0x3e94e5(0x109)];}}}}}}}const _0x431538=getRandom8DigitNumber();_0x431538[_0x3e94e5(0x105)](_0x72b573=>{var _0x56ab07=_0x3e94e5;_0x110585['render'](_0x56ab07(0xdb),{'success':_0x257778[_0x56ab07(0x18c)]('success'),'errors':_0x257778[_0x56ab07(0x18c)](_0x56ab07(0x10f)),'role':_0x325fc3,'profile':_0x19aab2,'master_shop':_0x26a9a0,'warehouse':_0x28d1bf,'language':_0x3dd9ec,'rooms_data':_0x428c79,'invoice':_0x72b573});})['catch'](_0x91f81c=>{var _0x1860a5=_0x3e94e5;_0x257778[_0x1860a5(0x18c)](_0x1860a5(0x10f),_0x1860a5(0xaf)),_0x110585[_0x1860a5(0x11f)]('/transfer/view');});}catch(_0x20568d){console[_0x3e94e5(0xcf)](_0x20568d);}}),router[a0_0x2fc07c(0xdc)](a0_0x2fc07c(0x197),auth,async(_0x10a074,_0x30e79e)=>{var _0x1598b4=a0_0x2fc07c;try{console['log'](_0x10a074[_0x1598b4(0x107)]);const {date:_0x15591e,from_warehouse:_0x5f5ff,FromRoom_name:_0x23fbe2,to_warehouse:_0x3ccb50,ToRoom_name:_0x40eafc,prod_name:_0x181f5c,from_prod_qty:_0x5067e3,from_prod_level:_0x2c77e9,from_prod_isle:_0x39a19a,from_prod_pallet:_0x79636a,to_prod_qty:_0x2285fb,to_prod_level:_0x176963,to_prod_isle:_0x198c8c,to_prod_pallet:_0x7e2da,primary_code:_0x2cba75,secondary_code:_0x1e773b,product_code3:_0x1e16d3,note:_0x29df04,MaxStocks_data2:_0x53a225,invoice:_0x34a2ce,expiry_date:_0x42e951}=_0x10a074[_0x1598b4(0x107)];if(typeof _0x181f5c==_0x1598b4(0xd9))var _0x414f1c=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0xff)]],_0x46b2d1=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0xef)]],_0x5dc983=[_0x10a074['body']['from_prod_level']],_0x54cde7=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0x19b)]],_0x10e325=[_0x10a074['body'][_0x1598b4(0x14e)]],_0x3c4f34=[_0x10a074['body']['primary_code']],_0x3d21ac=[_0x10a074[_0x1598b4(0x107)]['secondary_code']],_0x46f6e5=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0xcd)]],_0x11573b=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0xca)]],_0x43daa8=[_0x10a074[_0x1598b4(0x107)]['primary_unit']],_0x12f591=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0x194)]],_0x16d426=[_0x10a074['body']['batch_code']],_0x292b41=[_0x10a074[_0x1598b4(0x107)]['expiry_date']],_0x42c715=[_0x10a074['body'][_0x1598b4(0xb3)]],_0xd2c834=[_0x10a074[_0x1598b4(0x107)]['production_date']],_0x17d61e=[_0x10a074[_0x1598b4(0x107)]['prod_cat']],_0x4e69e8=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0x10d)]],_0x3a9e3e=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0xc3)]],_0x43385b=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0x13e)]],_0x1e94ef=[_0x10a074[_0x1598b4(0x107)][_0x1598b4(0x10b)]],_0x3f48f1=[_0x10a074[_0x1598b4(0x107)]['id_transaction']];else var _0x414f1c=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0xff)]],_0x46b2d1=[..._0x10a074['body'][_0x1598b4(0xef)]],_0x5dc983=[..._0x10a074[_0x1598b4(0x107)]['from_prod_level']],_0x54cde7=[..._0x10a074[_0x1598b4(0x107)]['New_Qty_Converted']],_0x10e325=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0x14e)]],_0x3c4f34=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0x188)]],_0x3d21ac=[..._0x10a074['body'][_0x1598b4(0xfb)]],_0x46f6e5=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0xcd)]],_0x11573b=[..._0x10a074['body'][_0x1598b4(0xca)]],_0x43daa8=[..._0x10a074[_0x1598b4(0x107)]['primary_unit']],_0x12f591=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0x194)]],_0x16d426=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0x147)]],_0x292b41=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0x139)]],_0x42c715=[..._0x10a074['body']['max_per_unit']],_0xd2c834=[..._0x10a074[_0x1598b4(0x107)]['production_date']],_0x17d61e=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0xd4)]],_0x4e69e8=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0x10d)]],_0x3a9e3e=[..._0x10a074[_0x1598b4(0x107)][_0x1598b4(0xc3)]],_0x43385b=[..._0x10a074[_0x1598b4(0x107)]['from_invoice']],_0x1e94ef=[..._0x10a074[_0x1598b4(0x107)]['to_invoice']],_0x3f48f1=[..._0x10a074['body'][_0x1598b4(0x15f)]];const _0x74fb2d=_0x414f1c[_0x1598b4(0x116)](_0x173aba=>{return _0x173aba={'product_name':_0x173aba};});_0x46b2d1[_0x1598b4(0x10a)]((_0x2895be,_0x35dc09)=>{var _0x29f2fb=_0x1598b4;_0x74fb2d[_0x35dc09][_0x29f2fb(0xba)]=_0x2895be;}),_0x43385b[_0x1598b4(0x10a)]((_0x1aacd7,_0x4e86c1)=>{_0x74fb2d[_0x4e86c1]['from_invoice']=_0x1aacd7;}),_0x1e94ef[_0x1598b4(0x10a)]((_0x4f60ac,_0x52fe00)=>{var _0x1e2245=_0x1598b4;_0x74fb2d[_0x52fe00][_0x1e2245(0xa8)]=_0x4f60ac;}),_0x3f48f1['forEach']((_0x3db10a,_0x1fe6ab)=>{_0x74fb2d[_0x1fe6ab]['id_transaction_id']=_0x3db10a;}),_0x5dc983[_0x1598b4(0x10a)]((_0x31cd2a,_0x2ba278)=>{var _0x54a19b=_0x1598b4;_0x4e69e8[_0x54a19b(0x10a)]((_0x525f87,_0x40acc6)=>{var _0x3bf041=_0x54a19b;if(_0x525f87==_0x3bf041(0x198)&&_0x2ba278==_0x40acc6){var _0x5cf798=_0x31cd2a[_0x3bf041(0xac)](0x3);_0x74fb2d[_0x2ba278][_0x3bf041(0x174)]=_0x31cd2a[0x0],_0x74fb2d[_0x2ba278][_0x3bf041(0x17c)]=_0x31cd2a[0x1],_0x74fb2d[_0x2ba278][_0x3bf041(0xf0)]=0x0,_0x74fb2d[_0x2ba278]['from_bin']=0x0,_0x74fb2d[_0x2ba278][_0x3bf041(0x160)]=_0x3bf041(0x18e),_0x74fb2d[_0x2ba278][_0x3bf041(0xf2)]=_0x5cf798;}else{if(_0x525f87==_0x3bf041(0x12f)&&_0x2ba278==_0x40acc6){var _0x5cf798=_0x31cd2a['slice'](0x3);_0x74fb2d[_0x2ba278]['from_storage']=_0x31cd2a[0x0],_0x74fb2d[_0x2ba278]['from_rack']=_0x31cd2a[0x1],_0x74fb2d[_0x2ba278][_0x3bf041(0xf0)]=0x0,_0x74fb2d[_0x2ba278][_0x3bf041(0x128)]=0x0,_0x74fb2d[_0x2ba278][_0x3bf041(0x160)]=_0x3bf041(0x18e),_0x74fb2d[_0x2ba278]['from_floorlevel']=_0x31cd2a[0x5];}else{if(_0x2ba278==_0x40acc6){if(_0x31cd2a[0x0]=='A'&&_0x31cd2a[0x1]=='L'&&_0x31cd2a[0x2]=='L')console[_0x3bf041(0xcf)](_0x525f87+_0x3bf041(0xab)+_0x2ba278+_0x3bf041(0xab)+_0x40acc6+_0x3bf041(0xab)+_0x31cd2a+'here'),_0x74fb2d[_0x2ba278][_0x3bf041(0x174)]=_0x31cd2a[0x0],_0x74fb2d[_0x2ba278][_0x3bf041(0x17c)]=_0x31cd2a[0x1],_0x74fb2d[_0x2ba278]['from_bay']=0x0,_0x74fb2d[_0x2ba278][_0x3bf041(0x128)]=0x0,_0x74fb2d[_0x2ba278]['from_types']='Floor',_0x74fb2d[_0x2ba278][_0x3bf041(0xf2)]=_0x31cd2a[0x3];else{var _0x37d86f;if(_0x31cd2a[0x4]=='L')_0x37d86f='Level';else _0x31cd2a[0x4]=='F'&&(_0x37d86f='Floor');_0x74fb2d[_0x2ba278]['from_storage']=_0x31cd2a[0x0],_0x74fb2d[_0x2ba278][_0x3bf041(0x17c)]=_0x31cd2a[0x1],_0x74fb2d[_0x2ba278][_0x3bf041(0xf0)]=_0x31cd2a[0x2],_0x74fb2d[_0x2ba278][_0x3bf041(0x128)]=_0x31cd2a[0x3],_0x74fb2d[_0x2ba278][_0x3bf041(0x160)]=_0x37d86f,_0x74fb2d[_0x2ba278]['from_floorlevel']=_0x31cd2a[0x5];}}}}});}),_0x54cde7[_0x1598b4(0x10a)]((_0x4b9372,_0x4c6e2c)=>{var _0x3ed9a3=_0x1598b4;_0x74fb2d[_0x4c6e2c][_0x3ed9a3(0x18f)]=_0x4b9372;}),_0x10e325[_0x1598b4(0x10a)]((_0x384c5b,_0x37d932)=>{var _0x5862b2=_0x1598b4;_0x3a9e3e[_0x5862b2(0x10a)]((_0x5d0f89,_0x59ddd1)=>{var _0x4da95e=_0x5862b2;if(_0x5d0f89==_0x4da95e(0x198)&&_0x37d932==_0x59ddd1){var _0x26fe2f=_0x384c5b['slice'](0x3);_0x74fb2d[_0x37d932][_0x4da95e(0x142)]=_0x384c5b[0x0],_0x74fb2d[_0x37d932][_0x4da95e(0x10c)]=_0x384c5b[0x1],_0x74fb2d[_0x37d932][_0x4da95e(0x150)]=0x0,_0x74fb2d[_0x37d932][_0x4da95e(0xdd)]=0x0,_0x74fb2d[_0x37d932][_0x4da95e(0x132)]=_0x4da95e(0x18e),_0x74fb2d[_0x37d932][_0x4da95e(0xbe)]=_0x26fe2f;}else{if(_0x5d0f89==_0x4da95e(0x12f)&&_0x37d932==_0x59ddd1){var _0x26fe2f=_0x384c5b[_0x4da95e(0xac)](0x3);_0x74fb2d[_0x37d932][_0x4da95e(0x142)]=_0x384c5b[0x0],_0x74fb2d[_0x37d932]['rack']=_0x384c5b[0x1],_0x74fb2d[_0x37d932]['to_bay']=0x0,_0x74fb2d[_0x37d932][_0x4da95e(0xdd)]=0x0,_0x74fb2d[_0x37d932][_0x4da95e(0x132)]=_0x4da95e(0x18e),_0x74fb2d[_0x37d932][_0x4da95e(0xbe)]=_0x384c5b[0x5];}else{if(_0x37d932==_0x59ddd1){if(_0x384c5b[0x0]=='A'&&_0x384c5b[0x1]=='L'&&_0x384c5b[0x2]=='L')console[_0x4da95e(0xcf)](_0x5d0f89+'\x20<>\x20'+_0x37d932+_0x4da95e(0xab)+_0x59ddd1+_0x4da95e(0xab)+_0x384c5b+'here'),_0x74fb2d[_0x37d932][_0x4da95e(0x142)]=_0x384c5b[0x0],_0x74fb2d[_0x37d932][_0x4da95e(0x10c)]=_0x384c5b[0x1],_0x74fb2d[_0x37d932][_0x4da95e(0x150)]=0x0,_0x74fb2d[_0x37d932]['to_bin']=0x0,_0x74fb2d[_0x37d932][_0x4da95e(0x132)]=_0x4da95e(0x18e),_0x74fb2d[_0x37d932]['to_floorlevel']=_0x384c5b[0x3];else{var _0x336b8d;if(_0x384c5b[0x4]=='L')_0x336b8d=_0x4da95e(0x184);else _0x384c5b[0x4]=='F'&&(_0x336b8d=_0x4da95e(0x18e));_0x74fb2d[_0x37d932][_0x4da95e(0x142)]=_0x384c5b[0x0],_0x74fb2d[_0x37d932][_0x4da95e(0x10c)]=_0x384c5b[0x1],_0x74fb2d[_0x37d932][_0x4da95e(0x150)]=_0x384c5b[0x2],_0x74fb2d[_0x37d932][_0x4da95e(0xdd)]=_0x384c5b[0x3],_0x74fb2d[_0x37d932]['to_types']=_0x336b8d,_0x74fb2d[_0x37d932]['to_floorlevel']=_0x384c5b[0x5];}}}}});}),_0x3c4f34[_0x1598b4(0x10a)]((_0x3546d1,_0x439e79)=>{var _0x51ec6a=_0x1598b4;_0x74fb2d[_0x439e79][_0x51ec6a(0x188)]=_0x3546d1;}),_0x3d21ac[_0x1598b4(0x10a)]((_0x4b811b,_0x44ed10)=>{var _0x9ee9c9=_0x1598b4;_0x74fb2d[_0x44ed10][_0x9ee9c9(0xfb)]=_0x4b811b;}),_0x46f6e5[_0x1598b4(0x10a)]((_0x53ebe3,_0x5802aa)=>{var _0x9dad7=_0x1598b4;_0x74fb2d[_0x5802aa][_0x9dad7(0xf8)]=_0x53ebe3;}),_0x11573b[_0x1598b4(0x10a)]((_0xc3b97c,_0x4d9cf1)=>{_0x74fb2d[_0x4d9cf1]['maxProducts']=_0xc3b97c;}),_0x43daa8[_0x1598b4(0x10a)]((_0xdd24d7,_0x1fe7a4)=>{var _0x5d9a5e=_0x1598b4;_0x74fb2d[_0x1fe7a4][_0x5d9a5e(0xd5)]=_0xdd24d7;}),_0x12f591[_0x1598b4(0x10a)]((_0x1bbe86,_0x2af3b8)=>{var _0xe0c105=_0x1598b4;_0x74fb2d[_0x2af3b8][_0xe0c105(0x194)]=_0x1bbe86;}),_0x16d426[_0x1598b4(0x10a)]((_0xa5f8c7,_0x2a9a21)=>{_0x74fb2d[_0x2a9a21]['batch_code']=_0xa5f8c7;}),_0x292b41[_0x1598b4(0x10a)]((_0x959829,_0x3e5ba1)=>{_0x74fb2d[_0x3e5ba1]['expiry_date']=_0x959829;}),_0x42c715[_0x1598b4(0x10a)]((_0x599f86,_0x3fda62)=>{_0x74fb2d[_0x3fda62]['maxperunit']=_0x599f86;}),_0xd2c834[_0x1598b4(0x10a)]((_0x58e7d1,_0x392091)=>{var _0x36a7cf=_0x1598b4;_0x74fb2d[_0x392091][_0x36a7cf(0x196)]=_0x58e7d1;}),_0x17d61e[_0x1598b4(0x10a)]((_0x3fc7d3,_0x170796)=>{var _0x16107e=_0x1598b4;_0x74fb2d[_0x170796][_0x16107e(0xd4)]=_0x3fc7d3;}),_0x4e69e8[_0x1598b4(0x10a)]((_0x3e6fc4,_0x302551)=>{_0x74fb2d[_0x302551]['from_room_name']=_0x3e6fc4;}),_0x3a9e3e[_0x1598b4(0x10a)]((_0x4629ac,_0x22b727)=>{var _0x56c3be=_0x1598b4;_0x74fb2d[_0x22b727][_0x56c3be(0x159)]=_0x4629ac;});const _0x102fe3=_0x74fb2d[_0x1598b4(0x15b)](_0x2c480e=>_0x2c480e[_0x1598b4(0x18f)]!=='0'&&_0x2c480e['to_quantity']!==''||_0x2c480e[_0x1598b4(0xbe)]!=='0'&&_0x2c480e[_0x1598b4(0xbe)]!==''),_0x53e1e6=new transfers({'date':_0x15591e,'from_warehouse':_0x5f5ff,'to_warehouse':_0x3ccb50,'product':_0x102fe3,'note':_0x29df04,'invoice':_0x34a2ce}),_0x1b6787=await _0x53e1e6[_0x1598b4(0xeb)]();_0x10a074[_0x1598b4(0x18c)](_0x1598b4(0xb4),_0x1598b4(0x11a)),_0x30e79e[_0x1598b4(0x11f)](_0x1598b4(0x156)+_0x1b6787[_0x1598b4(0x102)]);}catch(_0x5742ab){console[_0x1598b4(0xcf)](_0x5742ab),_0x30e79e['status'](0xc8)[_0x1598b4(0x101)]({'errorMessage':_0x5742ab[_0x1598b4(0x180)]});}}),router[a0_0x2fc07c(0xbf)]('/preview/:id',auth,async(_0xfea700,_0x3aab99)=>{var _0x5f3ab3=a0_0x2fc07c;try{const {username:_0x7e27ab,email:_0x80bf73,role:_0x3bd4e1}=_0xfea700['user'],_0x3697de=_0xfea700[_0x5f3ab3(0x103)],_0x5d376f=await profile[_0x5f3ab3(0xce)]({'email':_0x3697de[_0x5f3ab3(0xe8)]}),_0x21bb1c=await master_shop[_0x5f3ab3(0x163)]();console[_0x5f3ab3(0xcf)](_0x5f3ab3(0xe9),_0x21bb1c);const _0x54dc38=await transfers[_0x5f3ab3(0xc1)](_0xfea700[_0x5f3ab3(0x15a)]['id']);let _0x452823=new Date(_0x54dc38[_0x5f3ab3(0x139)]),_0x5f000e=('0'+_0x452823[_0x5f3ab3(0xbd)]())['slice'](-0x2),_0x524f33=('0'+(_0x452823[_0x5f3ab3(0x168)]()+0x1))[_0x5f3ab3(0xac)](-0x2),_0x1b887d=_0x452823[_0x5f3ab3(0xee)](),_0x3e90d7=_0x1b887d+'-'+_0x524f33+'-'+_0x5f000e,_0x10be0c;if(_0x3697de[_0x5f3ab3(0x122)]==_0x5f3ab3(0xae)){const _0x1eb7a7=await staff['findOne']({'email':_0x3697de[_0x5f3ab3(0xe8)]});_0x10be0c=await warehouse[_0x5f3ab3(0x163)]({'status':_0x5f3ab3(0x14c),'name':_0x1eb7a7[_0x5f3ab3(0xf7)],'warehouse_category':_0x5f3ab3(0x155)});}else _0x10be0c=await warehouse[_0x5f3ab3(0x163)]({'status':_0x5f3ab3(0x14c),'warehouse_category':_0x5f3ab3(0x155)});const _0x150b5d=await warehouse[_0x5f3ab3(0xbc)]([{'$match':{'name':_0x54dc38['from_warehouse']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5f3ab3(0x110),'name':{'$first':_0x5f3ab3(0x100)},'product_stock':{'$first':_0x5f3ab3(0x123)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5f3ab3(0x15c)},'floorlevel':{'$first':_0x5f3ab3(0x131)},'primary_code':{'$first':_0x5f3ab3(0x175)},'secondary_code':{'$first':_0x5f3ab3(0x183)},'product_code':{'$first':_0x5f3ab3(0xc2)},'storage':{'$first':_0x5f3ab3(0xc7)},'rack':{'$first':_0x5f3ab3(0x17e)},'expiry_date':{'$first':_0x5f3ab3(0x199)},'production_date':{'$first':_0x5f3ab3(0x178)},'room':{'$first':_0x5f3ab3(0x12d)}}}]);if(_0x21bb1c[0x0]['language']==_0x5f3ab3(0x119)){var _0x476569=users[_0x5f3ab3(0xe3)];console[_0x5f3ab3(0xcf)](_0x476569);}else{if(_0x21bb1c[0x0][_0x5f3ab3(0x13a)]=='Hindi')var _0x476569=users[_0x5f3ab3(0x117)];else{if(_0x21bb1c[0x0][_0x5f3ab3(0x13a)]==_0x5f3ab3(0xdf))var _0x476569=users['German'];else{if(_0x21bb1c[0x0][_0x5f3ab3(0x13a)]==_0x5f3ab3(0xcb))var _0x476569=users[_0x5f3ab3(0xcb)];else{if(_0x21bb1c[0x0][_0x5f3ab3(0x13a)]==_0x5f3ab3(0x11d))var _0x476569=users[_0x5f3ab3(0x11d)];else{if(_0x21bb1c[0x0][_0x5f3ab3(0x13a)]==_0x5f3ab3(0x133))var _0x476569=users[_0x5f3ab3(0x171)];else{if(_0x21bb1c[0x0]['language']==_0x5f3ab3(0x14d))var _0x476569=users[_0x5f3ab3(0x14d)];else{if(_0x21bb1c[0x0][_0x5f3ab3(0x13a)]==_0x5f3ab3(0x145))var _0x476569=users[_0x5f3ab3(0x109)];}}}}}}}_0x3aab99[_0x5f3ab3(0xd8)](_0x5f3ab3(0xad),{'success':_0xfea700[_0x5f3ab3(0x18c)](_0x5f3ab3(0xb4)),'errors':_0xfea700[_0x5f3ab3(0x18c)](_0x5f3ab3(0x10f)),'role':_0x3697de,'profile':_0x5d376f,'master_shop':_0x21bb1c,'warehouse':_0x10be0c,'transfer':_0x54dc38,'stock':_0x150b5d,'language':_0x476569});}catch(_0x199688){console[_0x5f3ab3(0xcf)](_0x199688);}}),router['post'](a0_0x2fc07c(0xa9),auth,async(_0x5bf8ef,_0x2d0c40)=>{var _0x2aa767=a0_0x2fc07c;try{const _0x4bc864=_0x5bf8ef[_0x2aa767(0x15a)]['id'],{from_warehouse:_0x455a63,FromRoom_name:_0x5d302f,to_warehouse:_0x507380,ToRoom_name:_0x509cea}=_0x5bf8ef[_0x2aa767(0x107)],_0x11a2ac=await transfers[_0x2aa767(0xc1)]({'_id':_0x4bc864}),_0x5b064d=_0x11a2ac[_0x2aa767(0x16f)][_0x2aa767(0x116)](async _0x115424=>{var _0x26bff2=_0x2aa767;if(_0x115424['to_quantity']>0x0){var _0x506e6c=await warehouse[_0x26bff2(0xce)]({'name':_0x11a2ac[_0x26bff2(0x161)],'room':_0x115424[_0x26bff2(0x11b)],'warehouse_category':_0x26bff2(0x155)});const _0x405f6b=_0x506e6c[_0x26bff2(0xc5)]['map'](_0x46e8f5=>{var _0x5dcb46=_0x26bff2;_0x46e8f5[_0x5dcb46(0x138)]==_0x115424['product_name']&&_0x46e8f5[_0x5dcb46(0x14b)]==_0x115424[_0x5dcb46(0xf2)]&&_0x46e8f5[_0x5dcb46(0x104)]==_0x115424[_0x5dcb46(0x160)]&&_0x46e8f5[_0x5dcb46(0xf1)]==_0x115424[_0x5dcb46(0x128)]&&_0x46e8f5[_0x5dcb46(0x13c)]==_0x115424['from_bay']&&_0x46e8f5['rack']==_0x115424[_0x5dcb46(0x17c)]&&_0x46e8f5[_0x5dcb46(0x142)]==_0x115424[_0x5dcb46(0x174)]&&_0x46e8f5[_0x5dcb46(0x139)]==_0x115424[_0x5dcb46(0x139)]&&_0x46e8f5[_0x5dcb46(0x147)]==_0x115424[_0x5dcb46(0x147)]&&_0x46e8f5[_0x5dcb46(0x196)]==_0x115424[_0x5dcb46(0x196)]&&_0x46e8f5['invoice']==_0x115424[_0x5dcb46(0x13e)]&&_0x46e8f5['_id']==_0x115424[_0x5dcb46(0xe4)]&&(_0x46e8f5[_0x5dcb46(0x15e)]=_0x46e8f5[_0x5dcb46(0x15e)]-_0x115424[_0x5dcb46(0x18f)]);});}return _0x506e6c;});Promise[_0x2aa767(0x18a)](_0x5b064d)[_0x2aa767(0x105)](async _0x4db37b=>{var _0x27eb87=_0x2aa767;try{for(const _0x4f83aa of _0x4db37b){await _0x4f83aa['save']();}try{const _0xfa29b3=_0x11a2ac[_0x27eb87(0x16f)][_0x27eb87(0x116)](async _0x4f04b8=>{var _0x383698=_0x27eb87;if(_0x4f04b8[_0x383698(0x18f)]>0x0){var _0x390551=await warehouse[_0x383698(0xce)]({'name':_0x11a2ac[_0x383698(0x14a)],'room':_0x4f04b8[_0x383698(0x159)],'warehouse_category':_0x383698(0x155)}),_0x4a8090=0x0;const _0x388c6e=_0x390551['product_details'][_0x383698(0x116)](_0x4eb305=>{var _0x4d1c53=_0x383698;_0x4eb305['product_name']==_0x4f04b8[_0x4d1c53(0x138)]&&_0x4eb305[_0x4d1c53(0x14b)]==_0x4f04b8[_0x4d1c53(0xbe)]&&_0x4eb305[_0x4d1c53(0x104)]==_0x4f04b8['to_types']&&_0x4eb305[_0x4d1c53(0xf1)]==_0x4f04b8[_0x4d1c53(0xdd)]&&_0x4eb305['bay']==_0x4f04b8[_0x4d1c53(0x150)]&&_0x4eb305['rack']==_0x4f04b8['rack']&&_0x4eb305[_0x4d1c53(0x142)]==_0x4f04b8['storage']&&_0x4eb305[_0x4d1c53(0x139)]==_0x4f04b8[_0x4d1c53(0x139)]&&_0x4eb305['batch_code']==_0x4f04b8[_0x4d1c53(0x147)]&&_0x4eb305['production_date']==_0x4f04b8['production_date']&&_0x4eb305[_0x4d1c53(0xf4)]==_0x4f04b8[_0x4d1c53(0xa8)]&&(_0x4eb305['product_stock']=_0x4eb305[_0x4d1c53(0x15e)]+_0x4f04b8[_0x4d1c53(0x18f)],_0x4a8090++);});_0x4a8090=='0'&&(_0x390551[_0x383698(0xc5)]=_0x390551[_0x383698(0xc5)]['concat']({'product_name':_0x4f04b8[_0x383698(0x138)],'product_stock':_0x4f04b8[_0x383698(0x18f)],'bay':_0x4f04b8[_0x383698(0x150)],'bin':_0x4f04b8[_0x383698(0xdd)],'type':_0x4f04b8[_0x383698(0x132)],'floorlevel':_0x4f04b8['to_floorlevel'],'storage':_0x4f04b8[_0x383698(0x142)],'rack':_0x4f04b8[_0x383698(0x10c)],'product_code':_0x4f04b8[_0x383698(0xf8)],'primary_code':_0x4f04b8[_0x383698(0x188)],'secondary_code':_0x4f04b8[_0x383698(0xfb)],'maxProducts':_0x4f04b8[_0x383698(0x177)],'storage':_0x4f04b8[_0x383698(0x142)],'rack':_0x4f04b8[_0x383698(0x10c)],'expiry_date':_0x4f04b8[_0x383698(0x139)],'maxPerUnit':_0x4f04b8[_0x383698(0xc6)],'batch_code':_0x4f04b8[_0x383698(0x147)],'production_date':_0x4f04b8['production_date']}));}return _0x390551;});Promise[_0x27eb87(0x18a)](_0xfa29b3)[_0x27eb87(0x105)](async _0x2f1fdc=>{var _0x101733=_0x27eb87;try{for(const _0x39c238 of _0x2f1fdc){await warehouse[_0x101733(0x13b)]({'_id':_0x39c238[_0x101733(0x102)]},{'$addToSet':{'product_details':{'$each':_0x39c238[_0x101733(0xc5)]}}});}_0x11a2ac['finalize']=_0x101733(0x166);const _0x32eaa3=await _0x11a2ac[_0x101733(0xeb)](),_0x263f5e=await master_shop[_0x101733(0x163)](),_0x27b753=await email_settings[_0x101733(0xce)](),_0x176632=await supervisor_settings['find']();var _0x203eb2=_0x11a2ac['product'],_0x16f0ac='',_0x338202;for(_0x338202 in _0x203eb2){_0x16f0ac+=_0x101733(0xda)+_0x101733(0xcc)+_0x203eb2[_0x338202][_0x101733(0x138)]+_0x101733(0x164)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x203eb2[_0x338202]['product_code']+'</td>'+_0x101733(0xcc)+_0x203eb2[_0x338202][_0x101733(0x18f)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x203eb2[_0x338202][_0x101733(0xd5)]+'</td>'+_0x101733(0xcc)+_0x203eb2[_0x338202]['secondary_unit']+_0x101733(0x164)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x11a2ac[_0x101733(0x14a)]+'</td>'+_0x101733(0xcc)+_0x203eb2[_0x338202]['to_room_name']+_0x101733(0x164)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x203eb2[_0x338202][_0x101733(0x142)]+_0x203eb2[_0x338202]['rack']+_0x203eb2[_0x338202][_0x101733(0x150)]+_0x203eb2[_0x338202][_0x101733(0xdd)]+_0x203eb2[_0x338202][_0x101733(0x132)][0x0]+_0x203eb2[_0x338202][_0x101733(0xbe)]+_0x101733(0x164),_0x101733(0x19a);}let _0x830b7b=nodemailer[_0x101733(0xd7)]({'host':_0x27b753[_0x101733(0x158)],'port':Number(_0x27b753[_0x101733(0xc8)]),'secure':![],'auth':{'user':_0x27b753['email'],'pass':_0x27b753['password']}}),_0x478ddb={'from':_0x27b753[_0x101733(0xe8)],'to':_0x176632[0x0]['RMSEmail'],'subject':_0x101733(0xfc),'attachments':[{'filename':_0x101733(0xc0),'path':__dirname+'/../public'+_0x101733(0xe5)+_0x263f5e[0x0]['image'],'cid':_0x101733(0x14f)}],'html':_0x101733(0x125)+_0x101733(0x189)+_0x101733(0xaa)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x101733(0xed)+_0x101733(0x181)+_0x101733(0x154)+'<div>'+_0x101733(0x16b)+_0x263f5e[0x0][_0x101733(0x167)]+_0x101733(0x17d)+_0x101733(0x154)+_0x101733(0x154)+'<hr\x20class=\x22my-3\x22>'+_0x101733(0xed)+_0x101733(0x13d)+_0x101733(0x11e)+_0x11a2ac[_0x101733(0xf4)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x101733(0x113)+_0x11a2ac[_0x101733(0x12e)]+'\x20'+_0x101733(0x187)+_0x101733(0x143)+_0x101733(0x154)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x101733(0xd6)+_0x101733(0xda)+_0x101733(0xe2)+_0x101733(0xd0)+_0x101733(0x176)+_0x101733(0x16c)+_0x101733(0x16a)+_0x101733(0x193)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x101733(0x182)+_0x101733(0x19a)+_0x101733(0x173)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x16f0ac+'\x20'+_0x101733(0x16d)+_0x101733(0xb5)+'<div>'+_0x101733(0x120)+_0x101733(0x149)+_0x263f5e[0x0][_0x101733(0x167)]+_0x101733(0x143)+'</div>'+_0x101733(0x154)+_0x101733(0xde)};_0x830b7b[_0x101733(0xb0)](_0x478ddb,function(_0x106374,_0x52a9d6){var _0x1a8f30=_0x101733;_0x106374?(console[_0x1a8f30(0xcf)](_0x106374),console[_0x1a8f30(0xcf)](_0x1a8f30(0x134))):console[_0x1a8f30(0xcf)](_0x1a8f30(0x191));}),_0x5bf8ef['flash']('success',_0x101733(0x17f)),_0x2d0c40[_0x101733(0x11f)]('/picking_list/PDF_transfer_rm/'+_0x32eaa3['_id']);}catch(_0x4d0402){console[_0x101733(0x153)](_0x4d0402),_0x2d0c40[_0x101733(0x130)](0x1f4)[_0x101733(0x101)]({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x4d0402['message']});}})[_0x27eb87(0x148)](_0x206fce=>{var _0x221861=_0x27eb87;console[_0x221861(0x153)](_0x206fce),_0x2d0c40[_0x221861(0x130)](0x1f4)[_0x221861(0x101)]({'Perror':_0x221861(0x10e)});});}catch(_0x9cd378){_0x2d0c40[_0x27eb87(0x101)](_0x9cd378);}}catch(_0xd3d7bf){console[_0x27eb87(0x153)](_0xd3d7bf),_0x2d0c40['status'](0x1f4)['json']({'Merror':_0x27eb87(0xf6),'Message':_0xd3d7bf['message']});}})['catch'](_0x5ad64c=>{var _0x41764b=_0x2aa767;console[_0x41764b(0x153)](_0x5ad64c),_0x2d0c40[_0x41764b(0x130)](0x1f4)['json']({'Merror':_0x41764b(0x10e)});});}catch(_0x58a935){console['log'](_0x58a935);}});function BayBinSelected(_0x2b2c8b,_0xd43e1f){var _0x448651=a0_0x2fc07c,_0xca3f25=[],_0x12e888=[],_0x2a0aa3=[],_0x544a36=[],_0x53b67f=[],_0x1854b3=[];let _0x419f79=[];if(_0x2b2c8b=='DRY\x20STORAGE')switch(_0xd43e1f){case _0x448651(0x192):_0xca3f25=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x12e888=[0x1,0x2],_0x544a36=[0x1,0x2,0x3,0x4,0x5],_0x2a0aa3=[_0x448651(0x184),_0x448651(0x18e)],_0x53b67f=['D'],_0x1854b3=['A'];break;case _0x448651(0x135):_0xca3f25=[0x6,0x5,0x4,0x3,0x2,0x1],_0x12e888=[0x1,0x2],_0x544a36=[0x1,0x2,0x3,0x4,0x5],_0x2a0aa3=[_0x448651(0x184),_0x448651(0x18e)],_0x53b67f=['D'],_0x1854b3=['B'];break;case'Shelves':_0xca3f25=[0x0],_0x12e888=[0x0],_0x544a36=[0x1,0x2,0x3,0x4,0x5],_0x2a0aa3=['Floor'],_0x53b67f=['D'],_0x1854b3=['S'];break;case _0x448651(0x198):_0xca3f25=[0x0],_0x12e888=[0x0],_0x544a36=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x2a0aa3=[_0x448651(0x18e)],_0x53b67f=['D'],_0x1854b3=['R'];break;}else{if(_0x2b2c8b==_0x448651(0x186))switch(_0xd43e1f){case _0x448651(0x192):_0xca3f25=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x12e888=['B','F'],_0x544a36=[0x1,0x2,0x3,0x4,0x5],_0x2a0aa3=['Level',_0x448651(0x18e)],_0x53b67f=['C'],_0x1854b3=['A'];break;case _0x448651(0x135):_0xca3f25=[0x5,0x4,0x3,0x2,0x1],_0x12e888=['F','B','S'],_0x544a36=[0x1,0x2,0x3,0x4,0x5],_0x2a0aa3=['Level',_0x448651(0x18e)],_0x53b67f=['C'],_0x1854b3=['B'];break;case'Rack\x20C':_0xca3f25=[0x1,0x2,0x3,0x4,0x5],_0x12e888=['B','F','S'],_0x544a36=[0x5,0x4,0x3,0x2,0x1],_0x2a0aa3=[_0x448651(0x184),_0x448651(0x18e)],_0x53b67f=['C'],_0x1854b3=['C'];break;case _0x448651(0xc4):_0xca3f25=[0x5,0x4,0x3,0x2,0x1],_0x12e888=['F','B','S'],_0x544a36=[0x1,0x2,0x3,0x4,0x5],_0x2a0aa3=['Level',_0x448651(0x18e)],_0x53b67f=['C'],_0x1854b3=['D'];break;case _0x448651(0xbb):_0xca3f25=[0x4,0x3,0x2,0x1],_0x12e888=[0x1,0x2],_0x544a36=[0x1,0x2,0x3,0x4,0x5],_0x2a0aa3=[_0x448651(0x184),_0x448651(0x18e)],_0x53b67f=['C'],_0x1854b3=['E'];break;case _0x448651(0x17a):_0xca3f25=[0x1,0x2,0x3],_0x12e888=[0x1,0x2],_0x544a36=[0x1,0x2,0x3,0x4,0x5],_0x2a0aa3=[_0x448651(0x184)],_0x53b67f=['C'],_0x1854b3=['F'];break;}}return{'levels':_0xca3f25,'Isle':_0x12e888,'rack':_0x544a36,'type':_0x2a0aa3,'storage':_0x53b67f,'rak':_0x1854b3};}router[a0_0x2fc07c(0xbf)](a0_0x2fc07c(0x190),auth,async(_0x18a379,_0x2a9a77)=>{var _0x44be0d=a0_0x2fc07c;try{const {username:_0x409843,email:_0x3367f3,role:_0xb7cad2}=_0x18a379[_0x44be0d(0x103)],_0x4b07b4=_0x18a379[_0x44be0d(0x103)],_0x3bcc54=await profile[_0x44be0d(0xce)]({'email':_0x4b07b4['email']}),_0xe9ac12=await master_shop[_0x44be0d(0x163)](),_0x3b4f14=await transfers[_0x44be0d(0xc1)](_0x18a379[_0x44be0d(0x15a)]['id']);let _0x549bf6;if(_0x4b07b4[_0x44be0d(0x122)]==_0x44be0d(0xae)){const _0x5ab165=await staff[_0x44be0d(0xce)]({'email':_0x4b07b4['email']});_0x549bf6=await warehouse[_0x44be0d(0xbc)]([{'$match':{'status':_0x44be0d(0x14c),'name':_0x5ab165['warehouse'],'warehouse_category':_0x44be0d(0x155)}},{'$group':{'_id':_0x44be0d(0xea),'name':{'$first':_0x44be0d(0xea)}}}]);}else _0x549bf6=await warehouse[_0x44be0d(0xbc)]([{'$match':{'status':_0x44be0d(0x14c),'warehouse_category':_0x44be0d(0x155)}},{'$group':{'_id':_0x44be0d(0xea),'name':{'$first':_0x44be0d(0xea)}}}]);const _0x1260bf=await warehouse[_0x44be0d(0xbc)]([{'$match':{'name':_0x3b4f14[_0x44be0d(0x161)],'warehouse_category':_0x44be0d(0x155)}},{'$unwind':_0x44be0d(0x18d)},{'$group':{'_id':_0x44be0d(0x110),'name':{'$first':_0x44be0d(0x100)},'product_stock':{'$first':_0x44be0d(0x123)},'bay':{'$first':_0x44be0d(0xb7)},'bin':{'$first':_0x44be0d(0x13f)},'type':{'$first':_0x44be0d(0x15c)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x44be0d(0x175)},'secondary_code':{'$first':_0x44be0d(0x183)},'product_code':{'$first':_0x44be0d(0xc2)},'storage':{'$first':_0x44be0d(0xc7)},'rack':{'$first':_0x44be0d(0x17e)},'expiry_date':{'$first':_0x44be0d(0x199)},'production_date':{'$first':_0x44be0d(0x178)},'room':{'$first':_0x44be0d(0x12d)}}}]),_0x66806=await product[_0x44be0d(0x163)]({}),_0x68fb8f=BayBinSelected(_0x3b4f14[_0x44be0d(0x14a)],_0x3b4f14[_0x44be0d(0x165)]);if(_0xe9ac12[0x0][_0x44be0d(0x13a)]==_0x44be0d(0x119)){var _0x41672b=users['English'];console['log'](_0x41672b);}else{if(_0xe9ac12[0x0][_0x44be0d(0x13a)]==_0x44be0d(0x117))var _0x41672b=users[_0x44be0d(0x117)];else{if(_0xe9ac12[0x0][_0x44be0d(0x13a)]==_0x44be0d(0xdf))var _0x41672b=users['German'];else{if(_0xe9ac12[0x0][_0x44be0d(0x13a)]==_0x44be0d(0xcb))var _0x41672b=users['Spanish'];else{if(_0xe9ac12[0x0][_0x44be0d(0x13a)]=='French')var _0x41672b=users[_0x44be0d(0x11d)];else{if(_0xe9ac12[0x0][_0x44be0d(0x13a)]==_0x44be0d(0x133))var _0x41672b=users[_0x44be0d(0x171)];else{if(_0xe9ac12[0x0]['language']==_0x44be0d(0x14d))var _0x41672b=users[_0x44be0d(0x14d)];else{if(_0xe9ac12[0x0][_0x44be0d(0x13a)]==_0x44be0d(0x145))var _0x41672b=users[_0x44be0d(0x109)];}}}}}}}_0x2a9a77[_0x44be0d(0xd8)](_0x44be0d(0x127),{'success':_0x18a379[_0x44be0d(0x18c)](_0x44be0d(0xb4)),'errors':_0x18a379['flash'](_0x44be0d(0x10f)),'role':_0x4b07b4,'profile':_0x3bcc54,'master_shop':_0xe9ac12,'warehouse':_0x549bf6,'transfer':_0x3b4f14,'stock':_0x1260bf,'unit':_0x66806,'language':_0x41672b});}catch(_0x5b54f5){console[_0x44be0d(0xcf)](_0x5b54f5);}}),router[a0_0x2fc07c(0xdc)]('/view/:id',auth,async(_0x222e5c,_0x16c080)=>{var _0x3ff867=a0_0x2fc07c;try{const _0x5ef710=_0x222e5c[_0x3ff867(0x15a)]['id'],_0x3968ca=await transfers['findById'](_0x5ef710);_0x16c080[_0x3ff867(0x101)](_0x222e5c[_0x3ff867(0x107)]);return;const {date:_0x161acc,from_warehouse:_0x22c8fe,FromRoom_name:_0x375da0,to_warehouse:_0x28d360,ToRoom_name:_0x3761b0,prod_name:_0x46bb92,from_prod_qty:_0x4057f7,from_prod_level:_0x1e62ba,from_prod_isle:_0x2934d8,from_prod_pallet:_0x23483d,to_prod_qty:_0x42ecd4,to_prod_level:_0x4d43d8,to_prod_isle:_0x57be58,to_prod_pallet:_0x429344,primary_code:_0x4aa4ce,secondary_code:_0x5930bf,product_code3:_0x1ddec9,note:_0x26c636,invoice:_0x4a6a58,expiry_date:_0x305eaf}=_0x222e5c['body'];if(typeof _0x46bb92==_0x3ff867(0xd9))var _0x10a51d=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0xff)]],_0x5f256f=[_0x222e5c[_0x3ff867(0x107)]['from_prod_qty']],_0x299414=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x106)]],_0x5a0a36=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x137)]],_0x117999=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x126)]],_0x1c767d=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x160)]],_0x37cc62=[_0x222e5c[_0x3ff867(0x107)]['to_prod_qty']],_0x4eb520=[_0x222e5c[_0x3ff867(0x107)]['to_prod_level']],_0x3a9e26=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x169)]],_0x2bf2cd=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x17b)]],_0x1db54a=[_0x222e5c[_0x3ff867(0x107)]['to_types']],_0x62d848=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x142)]],_0x245ce4=[_0x222e5c['body']['rak']],_0x1a6a1e=[_0x222e5c['body'][_0x3ff867(0x188)]],_0x120831=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0xfb)]],_0x47e43c=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0xcd)]],_0x12c33c=[_0x222e5c['body'][_0x3ff867(0xca)]],_0x720a7d=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0xd5)]],_0x3cf537=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x194)]],_0x180e22=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x147)]],_0xd15591=[_0x222e5c['body']['expiry_date']],_0x3fc131=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x174)]],_0xa0e47d=[_0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x121)]];else var _0x10a51d=[..._0x222e5c[_0x3ff867(0x107)]['prod_name']],_0x62d848=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x142)]],_0x245ce4=[..._0x222e5c[_0x3ff867(0x107)]['rak']],_0x1c767d=[..._0x222e5c['body'][_0x3ff867(0x160)]],_0x1db54a=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x132)]],_0x5f256f=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0xef)]],_0x299414=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x106)]],_0x5a0a36=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x137)]],_0x117999=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x126)]],_0x37cc62=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0xd1)]],_0x4eb520=[..._0x222e5c[_0x3ff867(0x107)]['to_prod_level']],_0x3a9e26=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x169)]],_0x2bf2cd=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x17b)]],_0x1a6a1e=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x188)]],_0x120831=[..._0x222e5c['body'][_0x3ff867(0xfb)]],_0x47e43c=[..._0x222e5c[_0x3ff867(0x107)]['product_code3']],_0x12c33c=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0xca)]],_0x720a7d=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0xd5)]],_0x3cf537=[..._0x222e5c[_0x3ff867(0x107)][_0x3ff867(0x194)]],_0x180e22=[..._0x222e5c['body'][_0x3ff867(0x147)]],_0xd15591=[..._0x222e5c[_0x3ff867(0x107)]['expiry_date']],_0x3fc131=[..._0x222e5c['body'][_0x3ff867(0x174)]],_0xa0e47d=[..._0x222e5c[_0x3ff867(0x107)]['from_rak']];const _0xe6bd12=_0x10a51d['map'](_0x148623=>{return _0x148623={'product_name':_0x148623};});_0x5f256f[_0x3ff867(0x10a)]((_0x43aca5,_0x4132d4)=>{_0xe6bd12[_0x4132d4]['from_quantity']=_0x43aca5;}),_0x299414['forEach']((_0x30f36c,_0x4a1269)=>{var _0x3bfe9b=_0x3ff867;_0xe6bd12[_0x4a1269][_0x3bfe9b(0xf0)]=_0x30f36c;}),_0x5a0a36['forEach']((_0x3dcf6c,_0x223313)=>{var _0x38afdb=_0x3ff867;_0xe6bd12[_0x223313][_0x38afdb(0x128)]=_0x3dcf6c;}),_0x117999[_0x3ff867(0x10a)]((_0x2c22a1,_0x5cc823)=>{var _0x123ce7=_0x3ff867;_0xe6bd12[_0x5cc823][_0x123ce7(0xf2)]=_0x2c22a1;}),_0x37cc62[_0x3ff867(0x10a)]((_0x17c024,_0x474976)=>{var _0x28fbe2=_0x3ff867;_0xe6bd12[_0x474976][_0x28fbe2(0x18f)]=_0x17c024;}),_0x4eb520['forEach']((_0x1c3396,_0x101851)=>{_0xe6bd12[_0x101851]['to_bay']=_0x1c3396;}),_0x3a9e26[_0x3ff867(0x10a)]((_0x381d61,_0x3b3df0)=>{var _0x2f88ff=_0x3ff867;_0xe6bd12[_0x3b3df0][_0x2f88ff(0xdd)]=_0x381d61;}),_0x2bf2cd[_0x3ff867(0x10a)]((_0x14368e,_0x1590b6)=>{_0xe6bd12[_0x1590b6]['to_floorlevel']=_0x14368e;}),_0x1a6a1e[_0x3ff867(0x10a)]((_0x247b3d,_0x26d2b0)=>{_0xe6bd12[_0x26d2b0]['primary_code']=_0x247b3d;}),_0x120831[_0x3ff867(0x10a)]((_0x5cf4d0,_0x4bbfce)=>{var _0x4b715f=_0x3ff867;_0xe6bd12[_0x4bbfce][_0x4b715f(0xfb)]=_0x5cf4d0;}),_0x47e43c[_0x3ff867(0x10a)]((_0x35bb52,_0x3322b6)=>{_0xe6bd12[_0x3322b6]['product_code']=_0x35bb52;}),_0x12c33c[_0x3ff867(0x10a)]((_0x51c342,_0x50457a)=>{var _0xdfe2de=_0x3ff867;_0xe6bd12[_0x50457a][_0xdfe2de(0x177)]=_0x51c342;}),_0x720a7d['forEach']((_0x418a31,_0x291912)=>{_0xe6bd12[_0x291912]['unit']=_0x418a31;}),_0x3cf537[_0x3ff867(0x10a)]((_0x2eafa1,_0x3c9e6a)=>{var _0xe0c09c=_0x3ff867;_0xe6bd12[_0x3c9e6a][_0xe0c09c(0x194)]=_0x2eafa1;}),_0x180e22['forEach']((_0x4aec05,_0x21b57b)=>{_0xe6bd12[_0x21b57b]['batch_code']=_0x4aec05;}),_0xd15591[_0x3ff867(0x10a)]((_0x1c1ebb,_0x4cd4ae)=>{var _0xa92339=_0x3ff867;_0xe6bd12[_0x4cd4ae][_0xa92339(0x139)]=_0x1c1ebb;}),_0x62d848[_0x3ff867(0x10a)]((_0x15ede5,_0x269fc2)=>{var _0x43a6e6=_0x3ff867;_0xe6bd12[_0x269fc2][_0x43a6e6(0x142)]=_0x15ede5;}),_0x245ce4['forEach']((_0x164ac8,_0x2bee64)=>{_0xe6bd12[_0x2bee64]['rack']=_0x164ac8;}),_0x1c767d[_0x3ff867(0x10a)]((_0x1989eb,_0x425922)=>{var _0x2d3f7e=_0x3ff867;_0xe6bd12[_0x425922][_0x2d3f7e(0x160)]=_0x1989eb;}),_0x1db54a[_0x3ff867(0x10a)]((_0x4b0729,_0x2a428d)=>{var _0x36a3d2=_0x3ff867;_0xe6bd12[_0x2a428d][_0x36a3d2(0x132)]=_0x4b0729;}),_0x3fc131[_0x3ff867(0x10a)]((_0x3204a9,_0x4f91eb)=>{var _0xb07574=_0x3ff867;_0xe6bd12[_0x4f91eb][_0xb07574(0x174)]=_0x3204a9;}),_0xa0e47d['forEach']((_0x35a15f,_0x48c8c5)=>{var _0x693973=_0x3ff867;_0xe6bd12[_0x48c8c5][_0x693973(0x17c)]=_0x35a15f;});const _0x1ce6bb=_0xe6bd12['filter'](_0x1199a0=>_0x1199a0['to_quantity']!=='0'&&_0x1199a0[_0x3ff867(0x18f)]!==''||_0x1199a0[_0x3ff867(0xbe)]!=='0'&&_0x1199a0['to_floorlevel']!=='');var _0x23e9fd=0x0;_0x1ce6bb[_0x3ff867(0x10a)](_0x225a2d=>{var _0x396673=_0x3ff867;parseInt(_0x225a2d[_0x396673(0xba)])<parseInt(_0x225a2d[_0x396673(0x18f)])&&_0x23e9fd++;});if(_0x23e9fd!=0x0)return _0x222e5c['flash'](_0x3ff867(0x10f),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x16c080[_0x3ff867(0x11f)](_0x3ff867(0x12b));const _0x10436e=await warehouse[_0x3ff867(0xce)]({'name':_0x3968ca[_0x3ff867(0x161)],'room':_0x3968ca[_0x3ff867(0xb6)]});_0x3968ca[_0x3ff867(0x16f)][_0x3ff867(0x10a)](_0x386904=>{var _0x30ff09=_0x3ff867;if(_0x386904['to_quantity']>0x0){const _0x4ed3d1=_0x10436e[_0x30ff09(0xc5)][_0x30ff09(0x116)](_0x46298f=>{var _0x314896=_0x30ff09;_0x46298f['product_name']==_0x386904[_0x314896(0x138)]&&_0x46298f[_0x314896(0x14b)]==_0x386904[_0x314896(0xf2)]&&_0x46298f[_0x314896(0x104)]==_0x386904[_0x314896(0x160)]&&_0x46298f[_0x314896(0xf1)]==_0x386904[_0x314896(0x128)]&&_0x46298f[_0x314896(0x13c)]==_0x386904[_0x314896(0xf0)]&&_0x46298f[_0x314896(0x10c)]==_0x386904[_0x314896(0x17c)]&&_0x46298f['storage']==_0x386904['from_storage']&&(_0x46298f[_0x314896(0x15e)]=parseInt(_0x46298f[_0x314896(0x15e)])+parseInt(_0x386904[_0x314896(0x18f)]));});}}),await _0x10436e[_0x3ff867(0xeb)]();const _0x21824b=await warehouse['findOne']({'name':_0x3968ca[_0x3ff867(0x14a)],'room':_0x3968ca[_0x3ff867(0x165)]});_0x3968ca[_0x3ff867(0x16f)][_0x3ff867(0x10a)](_0x277bb8=>{var _0x144be6=_0x3ff867;if(_0x277bb8[_0x144be6(0x18f)]>0x0){const _0x49f3dd=_0x21824b[_0x144be6(0xc5)][_0x144be6(0x116)](_0x4dc97b=>{var _0x13782c=_0x144be6;_0x4dc97b['product_name']==_0x277bb8[_0x13782c(0x138)]&&_0x4dc97b[_0x13782c(0x14b)]==_0x277bb8[_0x13782c(0xbe)]&&_0x4dc97b[_0x13782c(0x104)]==_0x277bb8[_0x13782c(0x132)]&&_0x4dc97b['bin']==_0x277bb8[_0x13782c(0xdd)]&&_0x4dc97b['bay']==_0x277bb8['to_bay']&&_0x4dc97b[_0x13782c(0x10c)]==_0x277bb8['rack']&&_0x4dc97b[_0x13782c(0x142)]==_0x277bb8['storage']&&(_0x4dc97b['product_stock']=parseInt(_0x4dc97b['product_stock'])-parseInt(_0x277bb8['to_quantity']));});}}),await _0x21824b[_0x3ff867(0xeb)](),_0x3968ca['date']=_0x161acc,_0x3968ca[_0x3ff867(0x161)]=_0x22c8fe,_0x3968ca[_0x3ff867(0x14a)]=_0x28d360,_0x3968ca['product']=_0x1ce6bb,_0x3968ca[_0x3ff867(0xe0)]=_0x26c636,_0x3968ca[_0x3ff867(0xf4)]=_0x4a6a58;const _0x286620=await _0x3968ca[_0x3ff867(0xeb)]();console[_0x3ff867(0xcf)](_0x286620);const _0x415bb5=await warehouse[_0x3ff867(0xce)]({'name':_0x22c8fe,'room':_0x375da0});_0x286620[_0x3ff867(0x16f)][_0x3ff867(0x10a)](_0xbb62f3=>{var _0x161a2b=_0x3ff867;if(_0xbb62f3[_0x161a2b(0x18f)]>0x0){const _0x90fe4c=_0x415bb5[_0x161a2b(0xc5)][_0x161a2b(0x116)](_0x4e56ab=>{var _0x66a869=_0x161a2b;_0x4e56ab[_0x66a869(0x138)]==_0xbb62f3[_0x66a869(0x138)]&&_0x4e56ab[_0x66a869(0x14b)]==_0xbb62f3['from_floorlevel']&&_0x4e56ab[_0x66a869(0x104)]==_0xbb62f3[_0x66a869(0x160)]&&_0x4e56ab['bin']==_0xbb62f3[_0x66a869(0x128)]&&_0x4e56ab['bay']==_0xbb62f3[_0x66a869(0xf0)]&&_0x4e56ab[_0x66a869(0x10c)]==_0xbb62f3[_0x66a869(0x17c)]&&_0x4e56ab[_0x66a869(0x142)]==_0xbb62f3['from_storage']&&(_0x4e56ab[_0x66a869(0x15e)]=parseInt(_0x4e56ab[_0x66a869(0x15e)])-parseInt(_0xbb62f3['to_quantity']));});}}),await _0x415bb5[_0x3ff867(0xeb)]();const _0x5764a0=await warehouse[_0x3ff867(0xce)]({'name':_0x28d360,'room':_0x3761b0});_0x286620[_0x3ff867(0x16f)][_0x3ff867(0x10a)](_0x17681e=>{var _0x4f5583=_0x3ff867;if(_0x17681e[_0x4f5583(0x18f)]>0x0){var _0x398381=0x0;const _0x12df2d=_0x5764a0[_0x4f5583(0xc5)][_0x4f5583(0x116)](_0x474ee9=>{var _0x1933a3=_0x4f5583;_0x474ee9[_0x1933a3(0x138)]==_0x17681e[_0x1933a3(0x138)]&&_0x474ee9[_0x1933a3(0x14b)]==_0x17681e[_0x1933a3(0xbe)]&&_0x474ee9[_0x1933a3(0x104)]==_0x17681e['to_types']&&_0x474ee9['bin']==_0x17681e[_0x1933a3(0xdd)]&&_0x474ee9[_0x1933a3(0x13c)]==_0x17681e['to_bay']&&_0x474ee9[_0x1933a3(0x10c)]==_0x17681e['rack']&&_0x474ee9[_0x1933a3(0x142)]==_0x17681e['storage']&&(_0x474ee9[_0x1933a3(0x15e)]=parseInt(_0x474ee9[_0x1933a3(0x15e)])+parseInt(_0x17681e['to_quantity']),_0x398381++);});_0x398381=='0'&&(_0x5764a0[_0x4f5583(0xc5)]=_0x5764a0[_0x4f5583(0xc5)]['concat']({'product_name':_0x17681e['product_name'],'product_stock':_0x17681e['to_quantity'],'bay':_0x17681e['to_bay'],'bin':_0x17681e[_0x4f5583(0xdd)],'type':_0x17681e[_0x4f5583(0x132)],'floorlevel':_0x17681e[_0x4f5583(0xbe)],'storage':_0x17681e['storage'],'rack':_0x17681e[_0x4f5583(0x10c)],'product_code':_0x17681e[_0x4f5583(0xf8)],'primary_code':_0x17681e[_0x4f5583(0x188)],'secondary_code':_0x17681e[_0x4f5583(0xfb)],'maxProducts':_0x17681e['maxProducts'],'storage':_0x17681e[_0x4f5583(0x142)],'rack':_0x17681e[_0x4f5583(0x10c)]}));}}),await _0x5764a0[_0x3ff867(0xeb)](),_0x222e5c[_0x3ff867(0x18c)](_0x3ff867(0xb4),_0x3ff867(0x146)),_0x16c080[_0x3ff867(0x11f)](_0x3ff867(0x108));}catch(_0x562dca){console[_0x3ff867(0xcf)](_0x562dca);}}),router[a0_0x2fc07c(0xdc)]('/barcode_scanner',async(_0xc00ecf,_0x2d2a22)=>{var _0x1c7a62=a0_0x2fc07c;const {FromWareHouse:_0x46d4d4,FromRoom:_0x193f87,ToWarehouse:_0x47ed11,ToRoom:_0x2a122b,primary_code:_0x40d161,Roomslist:_0x5d4d55}=_0xc00ecf[_0x1c7a62(0x107)],_0x416f42=_0x5d4d55[_0x1c7a62(0x144)](','),_0x3f77e3=[];async function _0x36593b(_0x427252){var _0x32ab36=_0x1c7a62;const _0x2fa08d=await warehouse[_0x32ab36(0xbc)]([{'$match':{'name':_0x46d4d4,'room':_0x427252}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x40d161}},{'$group':{'_id':_0x32ab36(0x110),'name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x32ab36(0x183)},'product_code':{'$first':_0x32ab36(0xc2)},'level':{'$first':_0x32ab36(0xb7)},'isle':{'$first':_0x32ab36(0x13f)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x32ab36(0x131)},'unit':{'$first':_0x32ab36(0x195)},'secondary_unit':{'$first':_0x32ab36(0x185)},'storage':{'$first':_0x32ab36(0xc7)},'rack':{'$first':_0x32ab36(0x17e)},'expiry_date':{'$first':_0x32ab36(0x199)},'production_date':{'$first':_0x32ab36(0x178)},'batch_code':{'$first':_0x32ab36(0xf5)},'maxPerUnit':{'$first':_0x32ab36(0xb9)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x32ab36(0x12d)},'maxProducts':{'$first':_0x32ab36(0x141)},'invoice_product':{'$first':_0x32ab36(0x124)}}}]),_0x58fd27=await warehouse[_0x32ab36(0xbc)]([{'$match':{'name':_0x46d4d4,'room':_0x427252}},{'$unwind':_0x32ab36(0x18d)},{'$match':{'product_details.secondary_code':_0x40d161}},{'$group':{'_id':_0x32ab36(0x110),'name':{'$first':_0x32ab36(0x100)},'instock':{'$first':_0x32ab36(0x123)},'primary_code':{'$first':_0x32ab36(0x175)},'secondary_code':{'$first':_0x32ab36(0x183)},'product_code':{'$first':_0x32ab36(0xc2)},'level':{'$first':_0x32ab36(0xb7)},'isle':{'$first':_0x32ab36(0x13f)},'type':{'$first':_0x32ab36(0x15c)},'pallet':{'$first':_0x32ab36(0x131)},'unit':{'$first':_0x32ab36(0x195)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x32ab36(0xc7)},'rack':{'$first':_0x32ab36(0x17e)},'expiry_date':{'$first':_0x32ab36(0x199)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x32ab36(0xf5)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x32ab36(0x12d)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':'$product_details.invoice'}}}]);if(_0x2fa08d[_0x32ab36(0xb2)]>0x0)_0x3f77e3[_0x32ab36(0xfa)](_0x2fa08d);else _0x58fd27[_0x32ab36(0xb2)]>0x0&&_0x3f77e3[_0x32ab36(0xfa)](_0x58fd27);}const _0x38b4ff=_0x416f42[_0x1c7a62(0x116)](_0x5c8fb7=>_0x36593b(_0x5c8fb7));await Promise['all'](_0x38b4ff),_0x2d2a22[_0x1c7a62(0x101)](_0x3f77e3);}),router[a0_0x2fc07c(0xdc)]('/barcode_scanner2',async(_0x4d7be8,_0x2711ab)=>{var _0x36add6=a0_0x2fc07c;try{const {FromWareHouse:_0x5cadae,FromRoom:_0x1e2a04,ToWarehouse:_0x4e706d,ToRoom:_0x5b2c02,secondary_code:_0x574c6a}=_0x4d7be8[_0x36add6(0x107)],_0x1f5896=await warehouse[_0x36add6(0xbc)]([{'$match':{'name':_0x5cadae}},{'$unwind':_0x36add6(0x18d)},{'$match':{'product_details.secondary_code':_0x574c6a}},{'$group':{'_id':_0x36add6(0x110),'name':{'$first':_0x36add6(0x100)},'primary_code':{'$first':_0x36add6(0x175)},'secondary_code':{'$first':_0x36add6(0x183)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x36add6(0x123)},'warehouse':{'$first':_0x36add6(0xea)},'level':{'$first':_0x36add6(0xd2)},'isle':{'$first':_0x36add6(0x115)},'pallet':{'$first':_0x36add6(0x136)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x36add6(0x195)}}}]);_0x2711ab[_0x36add6(0x130)](0xc8)['json'](_0x1f5896);}catch(_0x1c9547){_0x2711ab['status'](0x194)[_0x36add6(0x101)]({'message':_0x1c9547[_0x36add6(0x180)]});}}),router['post'](a0_0x2fc07c(0x114),async(_0x580f7b,_0xd0d6e9)=>{var _0x60c928=a0_0x2fc07c;try{const {FromWareHouse:_0x332bef,FromRoom:_0x10845c,ToWarehouse:_0x416c66,ToRoom:_0x2781dc,product_code:_0x2f24c2}=_0x580f7b[_0x60c928(0x107)],_0x4fb3f4=await warehouse['aggregate']([{'$match':{'name':_0x332bef}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x2f24c2}},{'$group':{'_id':_0x60c928(0x110),'name':{'$first':_0x60c928(0x100)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x60c928(0x183)},'product_code':{'$first':_0x60c928(0xc2)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x60c928(0xea)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x60c928(0x115)},'pallet':{'$first':_0x60c928(0x136)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x60c928(0x195)}}}]);_0xd0d6e9['status'](0xc8)[_0x60c928(0x101)](_0x4fb3f4);}catch(_0x165997){_0xd0d6e9['status'](0x194)['json']({'message':_0x165997[_0x60c928(0x180)]});}}),router[a0_0x2fc07c(0xdc)](a0_0x2fc07c(0x111),async(_0x1f619a,_0x58ddd3)=>{var _0x45be68=a0_0x2fc07c;const {level:_0x4c7354,isle:_0x1c2ff3,pallet:_0x1d3896,warehouses:_0x1674dc,room:_0x4cbf5f}=_0x1f619a[_0x45be68(0x107)];try{const _0x3e17e2=await warehouse[_0x45be68(0xbc)]([{'$match':{'name':_0x1674dc,'room':_0x4cbf5f}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x4c7354),'product_details.isle':_0x1c2ff3,'product_details.pallet':parseInt(_0x1d3896)}},{'$group':{'_id':_0x45be68(0x110),'name':{'$first':_0x45be68(0x100)},'product_stock':{'$first':_0x45be68(0x123)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x45be68(0x115)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x45be68(0x141)}}}]);_0x58ddd3[_0x45be68(0x130)](0xc8)[_0x45be68(0x101)](_0x3e17e2);}catch(_0x1ec8a3){_0x58ddd3[_0x45be68(0x130)](0x194)['json']({'message':_0x1ec8a3[_0x45be68(0x180)]});}}),module[a0_0x2fc07c(0xd3)]=router;