var a0_0x4b1cea=a0_0x3c53;(function(_0x53ba91,_0x140196){var _0x5eacbd=a0_0x3c53,_0x3817d7=_0x53ba91();while(!![]){try{var _0xd6cf7f=parseInt(_0x5eacbd(0x191))/0x1+parseInt(_0x5eacbd(0x278))/0x2*(-parseInt(_0x5eacbd(0x1fd))/0x3)+-parseInt(_0x5eacbd(0x27d))/0x4*(parseInt(_0x5eacbd(0x253))/0x5)+parseInt(_0x5eacbd(0x264))/0x6+parseInt(_0x5eacbd(0x193))/0x7+parseInt(_0x5eacbd(0x26a))/0x8+parseInt(_0x5eacbd(0x1d8))/0x9*(-parseInt(_0x5eacbd(0x1f2))/0xa);if(_0xd6cf7f===_0x140196)break;else _0x3817d7['push'](_0x3817d7['shift']());}catch(_0x57e434){_0x3817d7['push'](_0x3817d7['shift']());}}}(a0_0x499b,0x1c10d));const express=require(a0_0x4b1cea(0x260)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x4b1cea(0x271)),auth=require(a0_0x4b1cea(0x228)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');function a0_0x3c53(_0x95d237,_0x6b25a5){var _0x499b80=a0_0x499b();return a0_0x3c53=function(_0x3c539f,_0x4e9e57){_0x3c539f=_0x3c539f-0x185;var _0x2daba0=_0x499b80[_0x3c539f];return _0x2daba0;},a0_0x3c53(_0x95d237,_0x6b25a5);}router[a0_0x4b1cea(0x1d4)](a0_0x4b1cea(0x18a),auth,async(_0x16f1c4,_0x2e9f69)=>{var _0x3131d7=a0_0x4b1cea;try{const {username:_0x26bdd1,email:_0x24c737,role:_0x232cb9}=_0x16f1c4[_0x3131d7(0x1a0)],_0x19bc8f=_0x16f1c4[_0x3131d7(0x1a0)],_0x16ce38=await profile[_0x3131d7(0x1d2)]({'email':_0x19bc8f[_0x3131d7(0x1ce)]}),_0x19a460=await master_shop[_0x3131d7(0x192)]();console['log'](_0x3131d7(0x1a9),_0x19a460);let _0x415c9e;if(_0x19bc8f['role']==_0x3131d7(0x1d0)){const _0x27b307=await staff[_0x3131d7(0x1d2)]({'email':_0x19bc8f[_0x3131d7(0x1ce)]});_0x415c9e=await transfers[_0x3131d7(0x192)]({'from_warehouse':_0x27b307[_0x3131d7(0x200)]});}else _0x415c9e=await transfers['aggregate']([{'$unwind':_0x3131d7(0x1df)},{'$group':{'_id':_0x3131d7(0x1c1),'invoice':{'$first':_0x3131d7(0x185)},'date':{'$first':_0x3131d7(0x1ec)},'from_warehouse':{'$first':_0x3131d7(0x23a)},'to_warehouse':{'$first':_0x3131d7(0x261)},'from_room_name':{'$addToSet':_0x3131d7(0x237)},'to_room_name':{'$addToSet':_0x3131d7(0x230)},'finalize':{'$first':_0x3131d7(0x229)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x19a460[0x0]['language']==_0x3131d7(0x1b5)){var _0x3ba778=users[_0x3131d7(0x27a)];console[_0x3131d7(0x265)](_0x3ba778);}else{if(_0x19a460[0x0][_0x3131d7(0x1c4)]=='Hindi')var _0x3ba778=users[_0x3131d7(0x203)];else{if(_0x19a460[0x0][_0x3131d7(0x1c4)]=='German')var _0x3ba778=users[_0x3131d7(0x19b)];else{if(_0x19a460[0x0][_0x3131d7(0x1c4)]==_0x3131d7(0x25e))var _0x3ba778=users[_0x3131d7(0x25e)];else{if(_0x19a460[0x0][_0x3131d7(0x1c4)]=='French')var _0x3ba778=users[_0x3131d7(0x1fa)];else{if(_0x19a460[0x0][_0x3131d7(0x1c4)]==_0x3131d7(0x21b))var _0x3ba778=users[_0x3131d7(0x1dc)];else{if(_0x19a460[0x0][_0x3131d7(0x1c4)]==_0x3131d7(0x194))var _0x3ba778=users[_0x3131d7(0x194)];else{if(_0x19a460[0x0][_0x3131d7(0x1c4)]=='Arabic\x20(ae)')var _0x3ba778=users['Arabic'];}}}}}}}_0x2e9f69[_0x3131d7(0x1b1)]('transfer',{'success':_0x16f1c4[_0x3131d7(0x215)](_0x3131d7(0x22e)),'errors':_0x16f1c4[_0x3131d7(0x215)]('errors'),'role':_0x19bc8f,'profile':_0x16ce38,'master_shop':_0x19a460,'transfer':_0x415c9e,'language':_0x3ba778});}catch(_0x33822a){console[_0x3131d7(0x265)](_0x33822a);}});async function getRandom8DigitNumber(){var _0x3960b2=a0_0x4b1cea;const _0x42e953=0x989680,_0x32e360=0x5f5e0ff,_0x174c5=Math[_0x3960b2(0x1d1)](Math['random']()*(_0x32e360-_0x42e953+0x1))+_0x42e953;var _0x149070;const _0x4f8e71=await transfers[_0x3960b2(0x1d2)]({'invoice':'TRF-'+_0x174c5});return _0x4f8e71&&_0x4f8e71['length']>0x0?_0x149070=_0x3960b2(0x22c)+_0x174c5:_0x149070=_0x3960b2(0x22c)+_0x174c5,_0x149070;}function a0_0x499b(){var _0x17b012=['flash','product_stock','from_prod_pallet','/upload/','logo','$room','Portuguese\x20(BR)','note','Floor','maxProducts','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</h5>','/transfer/view','expiry_date','Email\x20sent\x20successfully','Level','/barcode_scanner2','port','product_details','../middleware/auth','$finalize','secondary_code','slice','TRF-','RoomAssigned','success','forEach','$product.to_room_name','padStart','<!DOCTYPE\x20html>','site_title','$product_details.maxProducts','$product_details.production_date','Rack\x20C','$product.from_room_name','/view/add_transfer','$product_details._id','$from_warehouse','Rack\x20F','$product_details.secondary_unit','True','$product_details.bin','Receiving\x20Area','errors','floorlevel','status','production_date','<strong>\x20Regards\x20</strong>','createTransport','maxperunit','$product_details.product_name','to_prod_level','edit_transfer_view','</head><body>','to_prod_qty','<div>','\x20<>\x20','Product\x20Transfer\x20successfully','id_transaction_id','Error\x20Occurs','primary_code','$product_details.primary_code','5btOKwn','from_types','exports','Rack\x20D','length','Rack\x20A','primary_unit','aggregate','_id','role','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Spanish','id_transaction','express','$to_warehouse','MaxStocks_data2','max_per_unit','120468MFigHw','log','Enabled','save','toString','product_code3','1338928ttwQCu','</span>','all','$product_details','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.unit','Arabic','../models/all_models','error','to_warehouse','$product_details.floorlevel','Transfer\x20Finalize\x20Successfully','push','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','2732dhDaJZ','from_quantity','English','updateOne','</body></html>','342208aOsTGa','to_prod_pallet','$invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.product_stock','date','product_name','/view','to_bay','Ambient','from_storage','$product_details.expiry_date','getFullYear','$product_details.secondary_code','200217LMYasj','find','607663SEwTvK','Chinese','bay','from_rack','finalize','Transfer\x20Mail','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','product','German','prod_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','sendMail','\x20</h2>','user','\x20Order\x20Date\x20:\x20','To_invoice','params','then','RMSEmail','An\x20error\x20occurred.','redirect','/picking_list/PDF_transfer_rm/','master','Raw\x20Materials','here','Shelves','</table>','to_types','bin','from_rak','render','from_prod_qty','<tbody\x20style=\x22text-align:\x20center;\x22>','New_Qty_Converted','English\x20(US)','rack','$product_details.bay','<h5>','Rack\x20E','to_floorlevel','from_bin','json','</tbody>','Arabic\x20(ae)','getDate','</tr>','$_id','getMonth','Enclosed','language','\x20Order\x20Number\x20:\x20','$product_details.invoice','from_bay','to_room_name','An\x20error\x20occurred\x20while\x20saving\x20data.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','</td>','body','/../public','email','to_quantity','staff','floor','findOne','from_room','get','post','to_room','ToRoomAssigned','1113309scDSYn','Transfer\x20Edit\x20Successfully','prod_name','to_invoice','Portuguese','invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product','to_bin','Logo.png','edit_transfer','<tr>','host','/view/:id','message','map','from_invoice','$name','secondary_unit','$product_details.pallet','$date','DRY\x20STORAGE','string','unit','findById','filter','10YRxYsH','</div>','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','type','$product_details.maxPerUnit','product_code','password','French','back','/CheckingWarehouse','330xFKPZg','from_warehouse','from_prod_isle','warehouse','concat','add_transfer','Hindi','catch','$product_details.rack','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','from_room_name','/transfer/preview/','$product_details.product_code','from_prod_level','rak','batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.level','to_prod_isle','$product_details.isle','split','from_floorlevel','storage'];a0_0x499b=function(){return _0x17b012;};return a0_0x499b();}router['get'](a0_0x4b1cea(0x238),auth,async(_0x1ffe45,_0x3bef75)=>{var _0x1ec408=a0_0x4b1cea;try{const {username:_0x24af01,email:_0x39e17a,role:_0x4d52e9}=_0x1ffe45['user'],_0x4b6a8b=_0x1ffe45[_0x1ec408(0x1a0)],_0x5afc6c=await profile[_0x1ec408(0x1d2)]({'email':_0x4b6a8b[_0x1ec408(0x1ce)]}),_0x7a78c1=await master_shop[_0x1ec408(0x192)]();console[_0x1ec408(0x265)](_0x1ec408(0x1a9),_0x7a78c1);let _0x17dd02;if(_0x4b6a8b[_0x1ec408(0x25c)]==_0x1ec408(0x1d0)){const _0x548200=await staff[_0x1ec408(0x1d2)]({'email':_0x4b6a8b[_0x1ec408(0x1ce)]});_0x17dd02=await warehouse[_0x1ec408(0x25a)]([{'$match':{'status':'Enabled','name':_0x548200[_0x1ec408(0x200)],'warehouse_category':_0x1ec408(0x1aa)}},{'$group':{'_id':'$name','name':{'$first':_0x1ec408(0x1e9)}}}]);}else _0x17dd02=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x1ec408(0x1aa)}},{'$group':{'_id':_0x1ec408(0x1e9),'name':{'$first':_0x1ec408(0x1e9)}}}]);var _0x2cd3b0=[_0x1ec408(0x18c),_0x1ec408(0x1c3),'Return\x20Rooms'];const _0x5ac8da=await transfers[_0x1ec408(0x192)]({}),_0x1d73b2=_0x5ac8da['length']+0x1,_0x3c5186=_0x1ec408(0x22c)+_0x1d73b2[_0x1ec408(0x268)]()[_0x1ec408(0x231)](0x5,'0');if(_0x7a78c1[0x0]['language']==_0x1ec408(0x1b5)){var _0x3d0f61=users['English'];console[_0x1ec408(0x265)](_0x3d0f61);}else{if(_0x7a78c1[0x0][_0x1ec408(0x1c4)]==_0x1ec408(0x203))var _0x3d0f61=users[_0x1ec408(0x203)];else{if(_0x7a78c1[0x0][_0x1ec408(0x1c4)]==_0x1ec408(0x19b))var _0x3d0f61=users['German'];else{if(_0x7a78c1[0x0][_0x1ec408(0x1c4)]==_0x1ec408(0x25e))var _0x3d0f61=users['Spanish'];else{if(_0x7a78c1[0x0][_0x1ec408(0x1c4)]==_0x1ec408(0x1fa))var _0x3d0f61=users[_0x1ec408(0x1fa)];else{if(_0x7a78c1[0x0]['language']==_0x1ec408(0x21b))var _0x3d0f61=users[_0x1ec408(0x1dc)];else{if(_0x7a78c1[0x0][_0x1ec408(0x1c4)]==_0x1ec408(0x194))var _0x3d0f61=users[_0x1ec408(0x194)];else{if(_0x7a78c1[0x0][_0x1ec408(0x1c4)]=='Arabic\x20(ae)')var _0x3d0f61=users['Arabic'];}}}}}}}const _0x3344bd=getRandom8DigitNumber();_0x3344bd[_0x1ec408(0x1a4)](_0x264fb3=>{var _0x54d341=_0x1ec408;_0x3bef75[_0x54d341(0x1b1)](_0x54d341(0x202),{'success':_0x1ffe45[_0x54d341(0x215)](_0x54d341(0x22e)),'errors':_0x1ffe45[_0x54d341(0x215)]('errors'),'role':_0x4b6a8b,'profile':_0x5afc6c,'master_shop':_0x7a78c1,'warehouse':_0x17dd02,'language':_0x3d0f61,'rooms_data':_0x2cd3b0,'invoice':_0x264fb3});})[_0x1ec408(0x204)](_0x377a5e=>{var _0x567d46=_0x1ec408;_0x1ffe45[_0x567d46(0x215)](_0x567d46(0x240),_0x567d46(0x1de)),_0x3bef75[_0x567d46(0x1a7)](_0x567d46(0x221));});}catch(_0x420f12){console[_0x1ec408(0x265)](_0x420f12);}}),router[a0_0x4b1cea(0x1d5)](a0_0x4b1cea(0x238),auth,async(_0x3964c3,_0x129390)=>{var _0x4d6da7=a0_0x4b1cea;try{console['log'](_0x3964c3[_0x4d6da7(0x1cc)]);const {date:_0x3eb654,from_warehouse:_0x40f1b7,FromRoom_name:_0x2a07b7,to_warehouse:_0x4c39d7,ToRoom_name:_0x32baec,prod_name:_0x25496d,from_prod_qty:_0x4719bb,from_prod_level:_0x4b03c3,from_prod_isle:_0x1db461,from_prod_pallet:_0x401833,to_prod_qty:_0x5f0654,to_prod_level:_0x518493,to_prod_isle:_0x14fde7,to_prod_pallet:_0xd648dc,primary_code:_0x2ddd4b,secondary_code:_0x236093,product_code3:_0x38f2ff,note:_0x2e5977,MaxStocks_data2:_0x1d401d,invoice:_0x229d23,expiry_date:_0x3ccf94}=_0x3964c3[_0x4d6da7(0x1cc)];if(typeof _0x25496d==_0x4d6da7(0x1ee))var _0x1161b6=[_0x3964c3[_0x4d6da7(0x1cc)]['prod_name']],_0x2b9b29=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x1b2)]],_0x3d4385=[_0x3964c3['body'][_0x4d6da7(0x20b)]],_0x51dc80=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x1b4)]],_0x250269=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x248)]],_0x8a7c8d=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x251)]],_0x43c29c=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x22a)]],_0x5a48ea=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x269)]],_0x482682=[_0x3964c3[_0x4d6da7(0x1cc)]['MaxStocks_data2']],_0x33b449=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x259)]],_0x39ae2d=[_0x3964c3['body'][_0x4d6da7(0x1ea)]],_0x530257=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x20d)]],_0x3959e0=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x222)]],_0x410660=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x263)]],_0x55c25b=[_0x3964c3['body'][_0x4d6da7(0x243)]],_0x7ef560=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x19c)]],_0x4d6782=[_0x3964c3[_0x4d6da7(0x1cc)]['RoomAssigned']],_0x124b28=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x1d7)]],_0xf13657=[_0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x1e8)]],_0x295259=[_0x3964c3['body'][_0x4d6da7(0x1db)]],_0xe4e638=[_0x3964c3['body'][_0x4d6da7(0x25f)]];else var _0x1161b6=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x1da)]],_0x2b9b29=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x1b2)]],_0x3d4385=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x20b)]],_0x51dc80=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x1b4)]],_0x250269=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x248)]],_0x8a7c8d=[..._0x3964c3['body'][_0x4d6da7(0x251)]],_0x43c29c=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x22a)]],_0x5a48ea=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x269)]],_0x482682=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x262)]],_0x33b449=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x259)]],_0x39ae2d=[..._0x3964c3[_0x4d6da7(0x1cc)]['secondary_unit']],_0x530257=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x20d)]],_0x3959e0=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x222)]],_0x410660=[..._0x3964c3['body'][_0x4d6da7(0x263)]],_0x55c25b=[..._0x3964c3[_0x4d6da7(0x1cc)]['production_date']],_0x7ef560=[..._0x3964c3['body'][_0x4d6da7(0x19c)]],_0x4d6782=[..._0x3964c3['body'][_0x4d6da7(0x22d)]],_0x124b28=[..._0x3964c3['body']['ToRoomAssigned']],_0xf13657=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x1e8)]],_0x295259=[..._0x3964c3[_0x4d6da7(0x1cc)][_0x4d6da7(0x1db)]],_0xe4e638=[..._0x3964c3[_0x4d6da7(0x1cc)]['id_transaction']];const _0x359dd9=_0x1161b6['map'](_0x34c4e0=>{return _0x34c4e0={'product_name':_0x34c4e0};});_0x2b9b29[_0x4d6da7(0x22f)]((_0x59e4a9,_0x45dba7)=>{_0x359dd9[_0x45dba7]['from_quantity']=_0x59e4a9;}),_0xf13657[_0x4d6da7(0x22f)]((_0x29cafe,_0x180beb)=>{var _0x7cb157=_0x4d6da7;_0x359dd9[_0x180beb][_0x7cb157(0x1e8)]=_0x29cafe;}),_0x295259['forEach']((_0x10d0c1,_0xb8f73a)=>{var _0x1daadc=_0x4d6da7;_0x359dd9[_0xb8f73a][_0x1daadc(0x1a2)]=_0x10d0c1;}),_0xe4e638[_0x4d6da7(0x22f)]((_0x53a370,_0x92be68)=>{var _0x47684c=_0x4d6da7;_0x359dd9[_0x92be68][_0x47684c(0x24f)]=_0x53a370;}),_0x3d4385[_0x4d6da7(0x22f)]((_0x18de04,_0x2749bc)=>{var _0x4f35b8=_0x4d6da7;_0x4d6782[_0x4f35b8(0x22f)]((_0x536d37,_0x320136)=>{var _0x354f4f=_0x4f35b8;if(_0x536d37==_0x354f4f(0x23f)&&_0x2749bc==_0x320136){var _0x1a5130=_0x18de04[_0x354f4f(0x22b)](0x3);_0x359dd9[_0x2749bc][_0x354f4f(0x18d)]=_0x18de04[0x0],_0x359dd9[_0x2749bc][_0x354f4f(0x196)]=_0x18de04[0x1],_0x359dd9[_0x2749bc]['from_bay']=0x0,_0x359dd9[_0x2749bc][_0x354f4f(0x1bb)]=0x0,_0x359dd9[_0x2749bc][_0x354f4f(0x254)]=_0x354f4f(0x21d),_0x359dd9[_0x2749bc]['from_floorlevel']=_0x1a5130;}else{if(_0x536d37==_0x354f4f(0x1ac)&&_0x2749bc==_0x320136){var _0x1a5130=_0x18de04[_0x354f4f(0x22b)](0x3);_0x359dd9[_0x2749bc]['from_storage']=_0x18de04[0x0],_0x359dd9[_0x2749bc][_0x354f4f(0x196)]=_0x18de04[0x1],_0x359dd9[_0x2749bc][_0x354f4f(0x1c7)]=0x0,_0x359dd9[_0x2749bc]['from_bin']=0x0,_0x359dd9[_0x2749bc][_0x354f4f(0x254)]=_0x354f4f(0x21d),_0x359dd9[_0x2749bc][_0x354f4f(0x213)]=_0x18de04[0x5];}else{if(_0x2749bc==_0x320136){if(_0x18de04[0x0]=='A'&&_0x18de04[0x1]=='L'&&_0x18de04[0x2]=='L')console[_0x354f4f(0x265)](_0x536d37+_0x354f4f(0x24d)+_0x2749bc+_0x354f4f(0x24d)+_0x320136+_0x354f4f(0x24d)+_0x18de04+_0x354f4f(0x1ab)),_0x359dd9[_0x2749bc][_0x354f4f(0x18d)]=_0x18de04[0x0],_0x359dd9[_0x2749bc][_0x354f4f(0x196)]=_0x18de04[0x1],_0x359dd9[_0x2749bc][_0x354f4f(0x1c7)]=0x0,_0x359dd9[_0x2749bc][_0x354f4f(0x1bb)]=0x0,_0x359dd9[_0x2749bc][_0x354f4f(0x254)]=_0x354f4f(0x21d),_0x359dd9[_0x2749bc][_0x354f4f(0x213)]=_0x18de04[0x3];else{var _0x36a707;if(_0x18de04[0x4]=='L')_0x36a707=_0x354f4f(0x224);else _0x18de04[0x4]=='F'&&(_0x36a707='Floor');_0x359dd9[_0x2749bc][_0x354f4f(0x18d)]=_0x18de04[0x0],_0x359dd9[_0x2749bc]['from_rack']=_0x18de04[0x1],_0x359dd9[_0x2749bc]['from_bay']=_0x18de04[0x2],_0x359dd9[_0x2749bc][_0x354f4f(0x1bb)]=_0x18de04[0x3],_0x359dd9[_0x2749bc][_0x354f4f(0x254)]=_0x36a707,_0x359dd9[_0x2749bc][_0x354f4f(0x213)]=_0x18de04[0x5];}}}}});}),_0x51dc80['forEach']((_0x4bbdd1,_0x31dd32)=>{var _0x1571b5=_0x4d6da7;_0x359dd9[_0x31dd32][_0x1571b5(0x1cf)]=_0x4bbdd1;}),_0x250269[_0x4d6da7(0x22f)]((_0x54c6ba,_0x169ebc)=>{var _0x402a16=_0x4d6da7;_0x124b28[_0x402a16(0x22f)]((_0x355842,_0x40d269)=>{var _0x18e345=_0x402a16;if(_0x355842==_0x18e345(0x23f)&&_0x169ebc==_0x40d269){var _0x7d685=_0x54c6ba[_0x18e345(0x22b)](0x3);_0x359dd9[_0x169ebc][_0x18e345(0x214)]=_0x54c6ba[0x0],_0x359dd9[_0x169ebc][_0x18e345(0x1b6)]=_0x54c6ba[0x1],_0x359dd9[_0x169ebc][_0x18e345(0x18b)]=0x0,_0x359dd9[_0x169ebc][_0x18e345(0x1e0)]=0x0,_0x359dd9[_0x169ebc][_0x18e345(0x1ae)]=_0x18e345(0x21d),_0x359dd9[_0x169ebc]['to_floorlevel']=_0x7d685;}else{if(_0x355842=='Shelves'&&_0x169ebc==_0x40d269){var _0x7d685=_0x54c6ba['slice'](0x3);_0x359dd9[_0x169ebc][_0x18e345(0x214)]=_0x54c6ba[0x0],_0x359dd9[_0x169ebc][_0x18e345(0x1b6)]=_0x54c6ba[0x1],_0x359dd9[_0x169ebc][_0x18e345(0x18b)]=0x0,_0x359dd9[_0x169ebc]['to_bin']=0x0,_0x359dd9[_0x169ebc]['to_types']='Floor',_0x359dd9[_0x169ebc][_0x18e345(0x1ba)]=_0x54c6ba[0x5];}else{if(_0x169ebc==_0x40d269){if(_0x54c6ba[0x0]=='A'&&_0x54c6ba[0x1]=='L'&&_0x54c6ba[0x2]=='L')console[_0x18e345(0x265)](_0x355842+_0x18e345(0x24d)+_0x169ebc+_0x18e345(0x24d)+_0x40d269+_0x18e345(0x24d)+_0x54c6ba+_0x18e345(0x1ab)),_0x359dd9[_0x169ebc][_0x18e345(0x214)]=_0x54c6ba[0x0],_0x359dd9[_0x169ebc][_0x18e345(0x1b6)]=_0x54c6ba[0x1],_0x359dd9[_0x169ebc][_0x18e345(0x18b)]=0x0,_0x359dd9[_0x169ebc][_0x18e345(0x1e0)]=0x0,_0x359dd9[_0x169ebc][_0x18e345(0x1ae)]=_0x18e345(0x21d),_0x359dd9[_0x169ebc][_0x18e345(0x1ba)]=_0x54c6ba[0x3];else{var _0x1cab3e;if(_0x54c6ba[0x4]=='L')_0x1cab3e='Level';else _0x54c6ba[0x4]=='F'&&(_0x1cab3e=_0x18e345(0x21d));_0x359dd9[_0x169ebc][_0x18e345(0x214)]=_0x54c6ba[0x0],_0x359dd9[_0x169ebc]['rack']=_0x54c6ba[0x1],_0x359dd9[_0x169ebc][_0x18e345(0x18b)]=_0x54c6ba[0x2],_0x359dd9[_0x169ebc]['to_bin']=_0x54c6ba[0x3],_0x359dd9[_0x169ebc]['to_types']=_0x1cab3e,_0x359dd9[_0x169ebc][_0x18e345(0x1ba)]=_0x54c6ba[0x5];}}}}});}),_0x8a7c8d[_0x4d6da7(0x22f)]((_0x258e7a,_0x1ecdb6)=>{var _0x55c9c2=_0x4d6da7;_0x359dd9[_0x1ecdb6][_0x55c9c2(0x251)]=_0x258e7a;}),_0x43c29c['forEach']((_0xa8a22c,_0x402d12)=>{_0x359dd9[_0x402d12]['secondary_code']=_0xa8a22c;}),_0x5a48ea[_0x4d6da7(0x22f)]((_0x1d1a1e,_0x559e5c)=>{_0x359dd9[_0x559e5c]['product_code']=_0x1d1a1e;}),_0x482682[_0x4d6da7(0x22f)]((_0x33a007,_0x5cb019)=>{var _0x3b98a6=_0x4d6da7;_0x359dd9[_0x5cb019][_0x3b98a6(0x21e)]=_0x33a007;}),_0x33b449[_0x4d6da7(0x22f)]((_0x16a90e,_0x487354)=>{_0x359dd9[_0x487354]['unit']=_0x16a90e;}),_0x39ae2d['forEach']((_0x4f0963,_0x191d5e)=>{var _0x444a09=_0x4d6da7;_0x359dd9[_0x191d5e][_0x444a09(0x1ea)]=_0x4f0963;}),_0x530257['forEach']((_0x5b7839,_0x48499e)=>{var _0x5df808=_0x4d6da7;_0x359dd9[_0x48499e][_0x5df808(0x20d)]=_0x5b7839;}),_0x3959e0['forEach']((_0x2f0307,_0x4a0b75)=>{var _0x4ed96e=_0x4d6da7;_0x359dd9[_0x4a0b75][_0x4ed96e(0x222)]=_0x2f0307;}),_0x410660[_0x4d6da7(0x22f)]((_0x25b407,_0x3ed44b)=>{_0x359dd9[_0x3ed44b]['maxperunit']=_0x25b407;}),_0x55c25b[_0x4d6da7(0x22f)]((_0xe491b,_0x5d10cb)=>{_0x359dd9[_0x5d10cb]['production_date']=_0xe491b;}),_0x7ef560['forEach']((_0x13b862,_0x445f6c)=>{var _0x222301=_0x4d6da7;_0x359dd9[_0x445f6c][_0x222301(0x19c)]=_0x13b862;}),_0x4d6782['forEach']((_0xea1bc6,_0x4abeb5)=>{_0x359dd9[_0x4abeb5]['from_room_name']=_0xea1bc6;}),_0x124b28[_0x4d6da7(0x22f)]((_0x2305d4,_0x4561b5)=>{_0x359dd9[_0x4561b5]['to_room_name']=_0x2305d4;});const _0x3b1ab2=_0x359dd9[_0x4d6da7(0x1f1)](_0x2a55a8=>_0x2a55a8[_0x4d6da7(0x1cf)]!=='0'&&_0x2a55a8[_0x4d6da7(0x1cf)]!==''||_0x2a55a8[_0x4d6da7(0x1ba)]!=='0'&&_0x2a55a8[_0x4d6da7(0x1ba)]!==''),_0x12696e=new transfers({'date':_0x3eb654,'from_warehouse':_0x40f1b7,'to_warehouse':_0x4c39d7,'product':_0x3b1ab2,'note':_0x2e5977,'invoice':_0x229d23}),_0x58d16f=await _0x12696e[_0x4d6da7(0x267)]();_0x3964c3['flash'](_0x4d6da7(0x22e),_0x4d6da7(0x24e)),_0x129390[_0x4d6da7(0x1a7)](_0x4d6da7(0x209)+_0x58d16f[_0x4d6da7(0x25b)]);}catch(_0x5105d1){console[_0x4d6da7(0x265)](_0x5105d1),_0x129390[_0x4d6da7(0x242)](0xc8)[_0x4d6da7(0x1bc)]({'errorMessage':_0x5105d1[_0x4d6da7(0x1e6)]});}}),router[a0_0x4b1cea(0x1d4)]('/preview/:id',auth,async(_0x13d6c9,_0x500d2a)=>{var _0x46b2a8=a0_0x4b1cea;try{const {username:_0x5f24c7,email:_0x2a9f0c,role:_0x4bedbd}=_0x13d6c9[_0x46b2a8(0x1a0)],_0x5c0f48=_0x13d6c9[_0x46b2a8(0x1a0)],_0x59197c=await profile[_0x46b2a8(0x1d2)]({'email':_0x5c0f48[_0x46b2a8(0x1ce)]}),_0x2eea83=await master_shop[_0x46b2a8(0x192)]();console[_0x46b2a8(0x265)](_0x46b2a8(0x1a9),_0x2eea83);const _0x3725a1=await transfers[_0x46b2a8(0x1f0)](_0x13d6c9[_0x46b2a8(0x1a3)]['id']);let _0x302677=new Date(_0x3725a1['expiry_date']),_0x2a8bb3=('0'+_0x302677[_0x46b2a8(0x1bf)]())[_0x46b2a8(0x22b)](-0x2),_0x320939=('0'+(_0x302677[_0x46b2a8(0x1c2)]()+0x1))[_0x46b2a8(0x22b)](-0x2),_0x881dd8=_0x302677[_0x46b2a8(0x18f)](),_0x2b9b01=_0x881dd8+'-'+_0x320939+'-'+_0x2a8bb3,_0x3c0f23;if(_0x5c0f48['role']=='staff'){const _0x119173=await staff[_0x46b2a8(0x1d2)]({'email':_0x5c0f48[_0x46b2a8(0x1ce)]});_0x3c0f23=await warehouse['find']({'status':_0x46b2a8(0x266),'name':_0x119173['warehouse'],'warehouse_category':'Raw\x20Materials'});}else _0x3c0f23=await warehouse[_0x46b2a8(0x192)]({'status':'Enabled','warehouse_category':_0x46b2a8(0x1aa)});const _0x354fa2=await warehouse[_0x46b2a8(0x25a)]([{'$match':{'name':_0x3725a1[_0x46b2a8(0x1fe)]}},{'$unwind':_0x46b2a8(0x26d)},{'$group':{'_id':_0x46b2a8(0x239),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x46b2a8(0x187)},'bay':{'$first':_0x46b2a8(0x1b7)},'bin':{'$first':_0x46b2a8(0x23e)},'type':{'$first':_0x46b2a8(0x206)},'floorlevel':{'$first':_0x46b2a8(0x274)},'primary_code':{'$first':_0x46b2a8(0x252)},'secondary_code':{'$first':_0x46b2a8(0x190)},'product_code':{'$first':_0x46b2a8(0x20a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x46b2a8(0x18e)},'production_date':{'$first':_0x46b2a8(0x235)},'room':{'$first':'$room'}}}]);if(_0x2eea83[0x0][_0x46b2a8(0x1c4)]==_0x46b2a8(0x1b5)){var _0x151464=users['English'];console[_0x46b2a8(0x265)](_0x151464);}else{if(_0x2eea83[0x0][_0x46b2a8(0x1c4)]=='Hindi')var _0x151464=users[_0x46b2a8(0x203)];else{if(_0x2eea83[0x0]['language']=='German')var _0x151464=users['German'];else{if(_0x2eea83[0x0][_0x46b2a8(0x1c4)]==_0x46b2a8(0x25e))var _0x151464=users[_0x46b2a8(0x25e)];else{if(_0x2eea83[0x0][_0x46b2a8(0x1c4)]==_0x46b2a8(0x1fa))var _0x151464=users[_0x46b2a8(0x1fa)];else{if(_0x2eea83[0x0]['language']==_0x46b2a8(0x21b))var _0x151464=users['Portuguese'];else{if(_0x2eea83[0x0]['language']==_0x46b2a8(0x194))var _0x151464=users['Chinese'];else{if(_0x2eea83[0x0][_0x46b2a8(0x1c4)]==_0x46b2a8(0x1be))var _0x151464=users['Arabic'];}}}}}}}_0x500d2a[_0x46b2a8(0x1b1)](_0x46b2a8(0x249),{'success':_0x13d6c9['flash']('success'),'errors':_0x13d6c9[_0x46b2a8(0x215)]('errors'),'role':_0x5c0f48,'profile':_0x59197c,'master_shop':_0x2eea83,'warehouse':_0x3c0f23,'transfer':_0x3725a1,'stock':_0x354fa2,'language':_0x151464});}catch(_0x5e97c2){console['log'](_0x5e97c2);}}),router[a0_0x4b1cea(0x1d5)]('/preview/:id',auth,async(_0x5d6b8e,_0x2becaf)=>{var _0x57eb18=a0_0x4b1cea;try{const _0xe22db1=_0x5d6b8e[_0x57eb18(0x1a3)]['id'],{from_warehouse:_0x4e93ed,FromRoom_name:_0x3f7fb6,to_warehouse:_0x45ed1a,ToRoom_name:_0x276a3f}=_0x5d6b8e[_0x57eb18(0x1cc)],_0x500e7=await transfers['findById']({'_id':_0xe22db1}),_0x12cc41=_0x500e7[_0x57eb18(0x19a)][_0x57eb18(0x1e7)](async _0x15a9b5=>{var _0x552758=_0x57eb18;if(_0x15a9b5[_0x552758(0x1cf)]>0x0){var _0x4e3d34=await warehouse[_0x552758(0x1d2)]({'name':_0x500e7['from_warehouse'],'room':_0x15a9b5[_0x552758(0x208)],'warehouse_category':_0x552758(0x1aa)});const _0x558b5d=_0x4e3d34[_0x552758(0x227)][_0x552758(0x1e7)](_0x343d6e=>{var _0x1162eb=_0x552758;_0x343d6e[_0x1162eb(0x189)]==_0x15a9b5[_0x1162eb(0x189)]&&_0x343d6e['floorlevel']==_0x15a9b5[_0x1162eb(0x213)]&&_0x343d6e[_0x1162eb(0x1f6)]==_0x15a9b5[_0x1162eb(0x254)]&&_0x343d6e[_0x1162eb(0x1af)]==_0x15a9b5[_0x1162eb(0x1bb)]&&_0x343d6e[_0x1162eb(0x195)]==_0x15a9b5[_0x1162eb(0x1c7)]&&_0x343d6e[_0x1162eb(0x1b6)]==_0x15a9b5[_0x1162eb(0x196)]&&_0x343d6e[_0x1162eb(0x214)]==_0x15a9b5['from_storage']&&_0x343d6e[_0x1162eb(0x222)]==_0x15a9b5[_0x1162eb(0x222)]&&_0x343d6e['batch_code']==_0x15a9b5[_0x1162eb(0x20d)]&&_0x343d6e[_0x1162eb(0x243)]==_0x15a9b5[_0x1162eb(0x243)]&&_0x343d6e[_0x1162eb(0x1dd)]==_0x15a9b5['from_invoice']&&_0x343d6e[_0x1162eb(0x25b)]==_0x15a9b5[_0x1162eb(0x24f)]&&(_0x343d6e[_0x1162eb(0x216)]=_0x343d6e[_0x1162eb(0x216)]-_0x15a9b5[_0x1162eb(0x1cf)]);});}return _0x4e3d34;});Promise[_0x57eb18(0x26c)](_0x12cc41)[_0x57eb18(0x1a4)](async _0x1043c0=>{var _0xe22bc4=_0x57eb18;try{for(const _0x575b56 of _0x1043c0){await _0x575b56[_0xe22bc4(0x267)]();}try{const _0x29a3c4=_0x500e7['product']['map'](async _0x542759=>{var _0x571cf4=_0xe22bc4;if(_0x542759[_0x571cf4(0x1cf)]>0x0){var _0x3aa09f=await warehouse[_0x571cf4(0x1d2)]({'name':_0x500e7[_0x571cf4(0x273)],'room':_0x542759[_0x571cf4(0x1c8)],'warehouse_category':'Raw\x20Materials'}),_0x158f2c=0x0;const _0x16931c=_0x3aa09f['product_details'][_0x571cf4(0x1e7)](_0x91cd84=>{var _0x26e3d6=_0x571cf4;_0x91cd84[_0x26e3d6(0x189)]==_0x542759[_0x26e3d6(0x189)]&&_0x91cd84[_0x26e3d6(0x241)]==_0x542759['to_floorlevel']&&_0x91cd84[_0x26e3d6(0x1f6)]==_0x542759[_0x26e3d6(0x1ae)]&&_0x91cd84['bin']==_0x542759[_0x26e3d6(0x1e0)]&&_0x91cd84[_0x26e3d6(0x195)]==_0x542759[_0x26e3d6(0x18b)]&&_0x91cd84[_0x26e3d6(0x1b6)]==_0x542759[_0x26e3d6(0x1b6)]&&_0x91cd84[_0x26e3d6(0x214)]==_0x542759[_0x26e3d6(0x214)]&&_0x91cd84['expiry_date']==_0x542759[_0x26e3d6(0x222)]&&_0x91cd84[_0x26e3d6(0x20d)]==_0x542759[_0x26e3d6(0x20d)]&&_0x91cd84[_0x26e3d6(0x243)]==_0x542759[_0x26e3d6(0x243)]&&_0x91cd84[_0x26e3d6(0x1dd)]==_0x542759[_0x26e3d6(0x1a2)]&&(_0x91cd84[_0x26e3d6(0x216)]=_0x91cd84[_0x26e3d6(0x216)]+_0x542759[_0x26e3d6(0x1cf)],_0x158f2c++);});_0x158f2c=='0'&&(_0x3aa09f[_0x571cf4(0x227)]=_0x3aa09f[_0x571cf4(0x227)][_0x571cf4(0x201)]({'product_name':_0x542759[_0x571cf4(0x189)],'product_stock':_0x542759['to_quantity'],'bay':_0x542759['to_bay'],'bin':_0x542759[_0x571cf4(0x1e0)],'type':_0x542759['to_types'],'floorlevel':_0x542759[_0x571cf4(0x1ba)],'storage':_0x542759[_0x571cf4(0x214)],'rack':_0x542759[_0x571cf4(0x1b6)],'product_code':_0x542759[_0x571cf4(0x1f8)],'primary_code':_0x542759[_0x571cf4(0x251)],'secondary_code':_0x542759[_0x571cf4(0x22a)],'maxProducts':_0x542759[_0x571cf4(0x21e)],'storage':_0x542759[_0x571cf4(0x214)],'rack':_0x542759[_0x571cf4(0x1b6)],'expiry_date':_0x542759['expiry_date'],'maxPerUnit':_0x542759[_0x571cf4(0x246)],'batch_code':_0x542759[_0x571cf4(0x20d)],'production_date':_0x542759[_0x571cf4(0x243)]}));}return _0x3aa09f;});Promise[_0xe22bc4(0x26c)](_0x29a3c4)['then'](async _0x5eaae9=>{var _0x4e2929=_0xe22bc4;try{for(const _0x3c1d9e of _0x5eaae9){await warehouse[_0x4e2929(0x27b)]({'_id':_0x3c1d9e['_id']},{'$addToSet':{'product_details':{'$each':_0x3c1d9e[_0x4e2929(0x227)]}}});}_0x500e7[_0x4e2929(0x197)]=_0x4e2929(0x23d);const _0x2f84be=await _0x500e7[_0x4e2929(0x267)](),_0x48423d=await master_shop[_0x4e2929(0x192)](),_0x38cb1f=await email_settings[_0x4e2929(0x1d2)](),_0x24c5c2=await supervisor_settings[_0x4e2929(0x192)]();var _0x31663c=_0x500e7[_0x4e2929(0x19a)],_0x47afb7='',_0x3176e6;for(_0x3176e6 in _0x31663c){_0x47afb7+=_0x4e2929(0x1e3)+_0x4e2929(0x26e)+_0x31663c[_0x3176e6][_0x4e2929(0x189)]+_0x4e2929(0x1cb)+_0x4e2929(0x26e)+_0x31663c[_0x3176e6][_0x4e2929(0x1f8)]+_0x4e2929(0x1cb)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x31663c[_0x3176e6][_0x4e2929(0x1cf)]+_0x4e2929(0x1cb)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x31663c[_0x3176e6][_0x4e2929(0x1ef)]+'</td>'+_0x4e2929(0x26e)+_0x31663c[_0x3176e6]['secondary_unit']+_0x4e2929(0x1cb)+_0x4e2929(0x26e)+_0x500e7[_0x4e2929(0x273)]+'</td>'+_0x4e2929(0x26e)+_0x31663c[_0x3176e6][_0x4e2929(0x1c8)]+_0x4e2929(0x1cb)+_0x4e2929(0x26e)+_0x31663c[_0x3176e6][_0x4e2929(0x214)]+_0x31663c[_0x3176e6][_0x4e2929(0x1b6)]+_0x31663c[_0x3176e6][_0x4e2929(0x18b)]+_0x31663c[_0x3176e6]['to_bin']+_0x31663c[_0x3176e6]['to_types'][0x0]+_0x31663c[_0x3176e6]['to_floorlevel']+_0x4e2929(0x1cb),'</tr>';}let _0xd4486d=nodemailer[_0x4e2929(0x245)]({'host':_0x38cb1f[_0x4e2929(0x1e4)],'port':Number(_0x38cb1f[_0x4e2929(0x226)]),'secure':![],'auth':{'user':_0x38cb1f[_0x4e2929(0x1ce)],'pass':_0x38cb1f[_0x4e2929(0x1f9)]}}),_0x425e7e={'from':_0x38cb1f[_0x4e2929(0x1ce)],'to':_0x24c5c2[0x0][_0x4e2929(0x1a5)],'subject':_0x4e2929(0x198),'attachments':[{'filename':_0x4e2929(0x1e1),'path':__dirname+_0x4e2929(0x1cd)+_0x4e2929(0x218)+_0x48423d[0x0]['image'],'cid':_0x4e2929(0x219)}],'html':_0x4e2929(0x232)+'<html><head><title></title>'+_0x4e2929(0x24a)+_0x4e2929(0x24c)+_0x4e2929(0x21f)+_0x4e2929(0x24c)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x4e2929(0x24c)+'<h2>\x20'+_0x48423d[0x0][_0x4e2929(0x233)]+_0x4e2929(0x19f)+_0x4e2929(0x1f3)+'</div>'+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x4e2929(0x1c5)+_0x500e7[_0x4e2929(0x1dd)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x4e2929(0x1a1)+_0x500e7[_0x4e2929(0x188)]+'\x20'+_0x4e2929(0x26b)+_0x4e2929(0x220)+_0x4e2929(0x1f3)+_0x4e2929(0x25d)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x4e2929(0x186)+_0x4e2929(0x1ca)+_0x4e2929(0x277)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x4e2929(0x19d)+_0x4e2929(0x1f5)+_0x4e2929(0x20e)+_0x4e2929(0x207)+_0x4e2929(0x1c0)+'</thead>'+_0x4e2929(0x1b3)+'\x20'+_0x47afb7+'\x20'+_0x4e2929(0x1bd)+_0x4e2929(0x1ad)+_0x4e2929(0x24c)+_0x4e2929(0x244)+_0x4e2929(0x1b8)+_0x48423d[0x0][_0x4e2929(0x233)]+_0x4e2929(0x220)+'</div>'+'</div>'+_0x4e2929(0x27c)};_0xd4486d[_0x4e2929(0x19e)](_0x425e7e,function(_0x379bcf,_0x34703b){var _0x549a0e=_0x4e2929;_0x379bcf?(console['log'](_0x379bcf),console[_0x549a0e(0x265)](_0x549a0e(0x250))):console[_0x549a0e(0x265)](_0x549a0e(0x223));}),_0x5d6b8e[_0x4e2929(0x215)](_0x4e2929(0x22e),_0x4e2929(0x275)),_0x2becaf[_0x4e2929(0x1a7)](_0x4e2929(0x1a8)+_0x2f84be[_0x4e2929(0x25b)]);}catch(_0x5d3aca){console['error'](_0x5d3aca),_0x2becaf[_0x4e2929(0x242)](0x1f4)['json']({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x5d3aca['message']});}})[_0xe22bc4(0x204)](_0x2141b6=>{var _0x2c7bc5=_0xe22bc4;console['error'](_0x2141b6),_0x2becaf[_0x2c7bc5(0x242)](0x1f4)[_0x2c7bc5(0x1bc)]({'Perror':_0x2c7bc5(0x1a6)});});}catch(_0x5c7169){_0x2becaf[_0xe22bc4(0x1bc)](_0x5c7169);}}catch(_0x12b5a2){console[_0xe22bc4(0x272)](_0x12b5a2),_0x2becaf[_0xe22bc4(0x242)](0x1f4)[_0xe22bc4(0x1bc)]({'Merror':_0xe22bc4(0x1c9),'Message':_0x12b5a2[_0xe22bc4(0x1e6)]});}})[_0x57eb18(0x204)](_0x2ce868=>{var _0xdc3bf=_0x57eb18;console[_0xdc3bf(0x272)](_0x2ce868),_0x2becaf[_0xdc3bf(0x242)](0x1f4)[_0xdc3bf(0x1bc)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x175d82){console[_0x57eb18(0x265)](_0x175d82);}});function BayBinSelected(_0x3842a5,_0x334671){var _0x516c96=a0_0x4b1cea,_0x390eef=[],_0x25656b=[],_0x2a62dd=[],_0x5e24f4=[],_0x20cac8=[],_0x91c4e8=[];let _0x2de368=[];if(_0x3842a5==_0x516c96(0x1ed))switch(_0x334671){case _0x516c96(0x258):_0x390eef=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x25656b=[0x1,0x2],_0x5e24f4=[0x1,0x2,0x3,0x4,0x5],_0x2a62dd=[_0x516c96(0x224),_0x516c96(0x21d)],_0x20cac8=['D'],_0x91c4e8=['A'];break;case'Rack\x20B':_0x390eef=[0x6,0x5,0x4,0x3,0x2,0x1],_0x25656b=[0x1,0x2],_0x5e24f4=[0x1,0x2,0x3,0x4,0x5],_0x2a62dd=['Level',_0x516c96(0x21d)],_0x20cac8=['D'],_0x91c4e8=['B'];break;case'Shelves':_0x390eef=[0x0],_0x25656b=[0x0],_0x5e24f4=[0x1,0x2,0x3,0x4,0x5],_0x2a62dd=['Floor'],_0x20cac8=['D'],_0x91c4e8=['S'];break;case _0x516c96(0x23f):_0x390eef=[0x0],_0x25656b=[0x0],_0x5e24f4=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x2a62dd=[_0x516c96(0x21d)],_0x20cac8=['D'],_0x91c4e8=['R'];break;}else{if(_0x3842a5=='COLD\x20STORAGE')switch(_0x334671){case'Rack\x20A':_0x390eef=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x25656b=['B','F'],_0x5e24f4=[0x1,0x2,0x3,0x4,0x5],_0x2a62dd=[_0x516c96(0x224),_0x516c96(0x21d)],_0x20cac8=['C'],_0x91c4e8=['A'];break;case'Rack\x20B':_0x390eef=[0x5,0x4,0x3,0x2,0x1],_0x25656b=['F','B','S'],_0x5e24f4=[0x1,0x2,0x3,0x4,0x5],_0x2a62dd=[_0x516c96(0x224),_0x516c96(0x21d)],_0x20cac8=['C'],_0x91c4e8=['B'];break;case _0x516c96(0x236):_0x390eef=[0x1,0x2,0x3,0x4,0x5],_0x25656b=['B','F','S'],_0x5e24f4=[0x5,0x4,0x3,0x2,0x1],_0x2a62dd=[_0x516c96(0x224),'Floor'],_0x20cac8=['C'],_0x91c4e8=['C'];break;case _0x516c96(0x256):_0x390eef=[0x5,0x4,0x3,0x2,0x1],_0x25656b=['F','B','S'],_0x5e24f4=[0x1,0x2,0x3,0x4,0x5],_0x2a62dd=[_0x516c96(0x224),_0x516c96(0x21d)],_0x20cac8=['C'],_0x91c4e8=['D'];break;case _0x516c96(0x1b9):_0x390eef=[0x4,0x3,0x2,0x1],_0x25656b=[0x1,0x2],_0x5e24f4=[0x1,0x2,0x3,0x4,0x5],_0x2a62dd=[_0x516c96(0x224),_0x516c96(0x21d)],_0x20cac8=['C'],_0x91c4e8=['E'];break;case _0x516c96(0x23b):_0x390eef=[0x1,0x2,0x3],_0x25656b=[0x1,0x2],_0x5e24f4=[0x1,0x2,0x3,0x4,0x5],_0x2a62dd=[_0x516c96(0x224)],_0x20cac8=['C'],_0x91c4e8=['F'];break;}}return{'levels':_0x390eef,'Isle':_0x25656b,'rack':_0x5e24f4,'type':_0x2a62dd,'storage':_0x20cac8,'rak':_0x91c4e8};}router[a0_0x4b1cea(0x1d4)](a0_0x4b1cea(0x1e5),auth,async(_0x9ca54d,_0xae7493)=>{var _0x338b70=a0_0x4b1cea;try{const {username:_0x13c8ea,email:_0x322f70,role:_0x5ba106}=_0x9ca54d[_0x338b70(0x1a0)],_0x1b7b58=_0x9ca54d[_0x338b70(0x1a0)],_0x14b365=await profile[_0x338b70(0x1d2)]({'email':_0x1b7b58['email']}),_0x2a2631=await master_shop[_0x338b70(0x192)](),_0x103736=await transfers['findById'](_0x9ca54d['params']['id']);let _0x4de900;if(_0x1b7b58[_0x338b70(0x25c)]==_0x338b70(0x1d0)){const _0x2fccd4=await staff[_0x338b70(0x1d2)]({'email':_0x1b7b58[_0x338b70(0x1ce)]});_0x4de900=await warehouse['aggregate']([{'$match':{'status':_0x338b70(0x266),'name':_0x2fccd4['warehouse'],'warehouse_category':_0x338b70(0x1aa)}},{'$group':{'_id':'$name','name':{'$first':_0x338b70(0x1e9)}}}]);}else _0x4de900=await warehouse[_0x338b70(0x25a)]([{'$match':{'status':_0x338b70(0x266),'warehouse_category':_0x338b70(0x1aa)}},{'$group':{'_id':_0x338b70(0x1e9),'name':{'$first':'$name'}}}]);const _0x5cb4dc=await warehouse[_0x338b70(0x25a)]([{'$match':{'name':_0x103736['from_warehouse'],'warehouse_category':_0x338b70(0x1aa)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x338b70(0x239),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x338b70(0x23e)},'type':{'$first':_0x338b70(0x206)},'floorlevel':{'$first':_0x338b70(0x274)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x338b70(0x20a)},'storage':{'$first':_0x338b70(0x1f4)},'rack':{'$first':_0x338b70(0x205)},'expiry_date':{'$first':_0x338b70(0x18e)},'production_date':{'$first':_0x338b70(0x235)},'room':{'$first':'$room'}}}]),_0x49e6c2=await product['find']({}),_0x569d9c=BayBinSelected(_0x103736['to_warehouse'],_0x103736['to_room']);if(_0x2a2631[0x0][_0x338b70(0x1c4)]=='English\x20(US)'){var _0x456495=users['English'];console['log'](_0x456495);}else{if(_0x2a2631[0x0][_0x338b70(0x1c4)]==_0x338b70(0x203))var _0x456495=users[_0x338b70(0x203)];else{if(_0x2a2631[0x0][_0x338b70(0x1c4)]==_0x338b70(0x19b))var _0x456495=users[_0x338b70(0x19b)];else{if(_0x2a2631[0x0][_0x338b70(0x1c4)]=='Spanish')var _0x456495=users[_0x338b70(0x25e)];else{if(_0x2a2631[0x0][_0x338b70(0x1c4)]==_0x338b70(0x1fa))var _0x456495=users['French'];else{if(_0x2a2631[0x0][_0x338b70(0x1c4)]==_0x338b70(0x21b))var _0x456495=users[_0x338b70(0x1dc)];else{if(_0x2a2631[0x0][_0x338b70(0x1c4)]=='Chinese')var _0x456495=users[_0x338b70(0x194)];else{if(_0x2a2631[0x0][_0x338b70(0x1c4)]=='Arabic\x20(ae)')var _0x456495=users[_0x338b70(0x270)];}}}}}}}_0xae7493[_0x338b70(0x1b1)](_0x338b70(0x1e2),{'success':_0x9ca54d[_0x338b70(0x215)](_0x338b70(0x22e)),'errors':_0x9ca54d[_0x338b70(0x215)]('errors'),'role':_0x1b7b58,'profile':_0x14b365,'master_shop':_0x2a2631,'warehouse':_0x4de900,'transfer':_0x103736,'stock':_0x5cb4dc,'unit':_0x49e6c2,'language':_0x456495});}catch(_0x3f7493){console[_0x338b70(0x265)](_0x3f7493);}}),router['post'](a0_0x4b1cea(0x1e5),auth,async(_0x5ba58b,_0x3d4975)=>{var _0x235538=a0_0x4b1cea;try{const _0x32ac34=_0x5ba58b['params']['id'],_0xddc01c=await transfers[_0x235538(0x1f0)](_0x32ac34);_0x3d4975[_0x235538(0x1bc)](_0x5ba58b[_0x235538(0x1cc)]);return;const {date:_0x14287a,from_warehouse:_0x2679c5,FromRoom_name:_0x22c740,to_warehouse:_0x1d864b,ToRoom_name:_0x3a68c3,prod_name:_0x57e67a,from_prod_qty:_0x398c8d,from_prod_level:_0x5ab7d8,from_prod_isle:_0x210da6,from_prod_pallet:_0x568ca4,to_prod_qty:_0x4ac435,to_prod_level:_0x3029bd,to_prod_isle:_0x4fa83b,to_prod_pallet:_0x461bc8,primary_code:_0x33a611,secondary_code:_0x2407d4,product_code3:_0x5f8690,note:_0x46f5fe,invoice:_0x347945,expiry_date:_0x57dca6}=_0x5ba58b[_0x235538(0x1cc)];if(typeof _0x57e67a=='string')var _0x3d542b=[_0x5ba58b[_0x235538(0x1cc)]['prod_name']],_0x55576d=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x1b2)]],_0x11f2d0=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x20b)]],_0x245260=[_0x5ba58b[_0x235538(0x1cc)]['from_prod_isle']],_0x245ca7=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x217)]],_0x4c032b=[_0x5ba58b['body'][_0x235538(0x254)]],_0x10cf42=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x24b)]],_0x53c16e=[_0x5ba58b[_0x235538(0x1cc)]['to_prod_level']],_0x39e17e=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x210)]],_0x569398=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x27e)]],_0x1037a8=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x1ae)]],_0x3c6c1e=[_0x5ba58b['body'][_0x235538(0x214)]],_0x127f19=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x20c)]],_0x1301fc=[_0x5ba58b[_0x235538(0x1cc)]['primary_code']],_0x52f9ca=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x22a)]],_0xa2ccc3=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x269)]],_0x370e3a=[_0x5ba58b['body']['MaxStocks_data2']],_0x2a1cb8=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x1ef)]],_0x17c830=[_0x5ba58b['body'][_0x235538(0x1ea)]],_0x430577=[_0x5ba58b[_0x235538(0x1cc)][_0x235538(0x20d)]],_0x2bc963=[_0x5ba58b[_0x235538(0x1cc)]['expiry_date']],_0x4932ee=[_0x5ba58b['body'][_0x235538(0x18d)]],_0x3d990e=[_0x5ba58b[_0x235538(0x1cc)]['from_rak']];else var _0x3d542b=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x1da)]],_0x3c6c1e=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x214)]],_0x127f19=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x20c)]],_0x4c032b=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x254)]],_0x1037a8=[..._0x5ba58b['body'][_0x235538(0x1ae)]],_0x55576d=[..._0x5ba58b['body']['from_prod_qty']],_0x11f2d0=[..._0x5ba58b['body']['from_prod_level']],_0x245260=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x1ff)]],_0x245ca7=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x217)]],_0x10cf42=[..._0x5ba58b['body'][_0x235538(0x24b)]],_0x53c16e=[..._0x5ba58b[_0x235538(0x1cc)]['to_prod_level']],_0x39e17e=[..._0x5ba58b['body'][_0x235538(0x210)]],_0x569398=[..._0x5ba58b['body'][_0x235538(0x27e)]],_0x1301fc=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x251)]],_0x52f9ca=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x22a)]],_0xa2ccc3=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x269)]],_0x370e3a=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x262)]],_0x2a1cb8=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x1ef)]],_0x17c830=[..._0x5ba58b['body']['secondary_unit']],_0x430577=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x20d)]],_0x2bc963=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x222)]],_0x4932ee=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x18d)]],_0x3d990e=[..._0x5ba58b[_0x235538(0x1cc)][_0x235538(0x1b0)]];const _0x545665=_0x3d542b[_0x235538(0x1e7)](_0x3b3bfe=>{return _0x3b3bfe={'product_name':_0x3b3bfe};});_0x55576d[_0x235538(0x22f)]((_0x4a0f9f,_0xbfa3ab)=>{var _0x562c87=_0x235538;_0x545665[_0xbfa3ab][_0x562c87(0x279)]=_0x4a0f9f;}),_0x11f2d0['forEach']((_0x9d89b1,_0xe9c8d3)=>{var _0xcdaa7a=_0x235538;_0x545665[_0xe9c8d3][_0xcdaa7a(0x1c7)]=_0x9d89b1;}),_0x245260['forEach']((_0x159b38,_0x4171e4)=>{var _0x2360d8=_0x235538;_0x545665[_0x4171e4][_0x2360d8(0x1bb)]=_0x159b38;}),_0x245ca7[_0x235538(0x22f)]((_0x199300,_0x19673b)=>{_0x545665[_0x19673b]['from_floorlevel']=_0x199300;}),_0x10cf42['forEach']((_0x48e0e4,_0x2339d3)=>{_0x545665[_0x2339d3]['to_quantity']=_0x48e0e4;}),_0x53c16e[_0x235538(0x22f)]((_0x3aaad9,_0x195051)=>{var _0x150fa8=_0x235538;_0x545665[_0x195051][_0x150fa8(0x18b)]=_0x3aaad9;}),_0x39e17e['forEach']((_0x15696b,_0x260463)=>{_0x545665[_0x260463]['to_bin']=_0x15696b;}),_0x569398['forEach']((_0x4bc439,_0x327557)=>{var _0x5d8373=_0x235538;_0x545665[_0x327557][_0x5d8373(0x1ba)]=_0x4bc439;}),_0x1301fc[_0x235538(0x22f)]((_0x462992,_0x37095d)=>{_0x545665[_0x37095d]['primary_code']=_0x462992;}),_0x52f9ca[_0x235538(0x22f)]((_0x2a71fb,_0x3e29a6)=>{var _0x5a9b1d=_0x235538;_0x545665[_0x3e29a6][_0x5a9b1d(0x22a)]=_0x2a71fb;}),_0xa2ccc3[_0x235538(0x22f)]((_0x5c76cf,_0x3a20e6)=>{_0x545665[_0x3a20e6]['product_code']=_0x5c76cf;}),_0x370e3a[_0x235538(0x22f)]((_0x791ea0,_0x1f3988)=>{var _0x5b56dd=_0x235538;_0x545665[_0x1f3988][_0x5b56dd(0x21e)]=_0x791ea0;}),_0x2a1cb8[_0x235538(0x22f)]((_0x3f9e1d,_0x3f8bc2)=>{var _0x5327d8=_0x235538;_0x545665[_0x3f8bc2][_0x5327d8(0x1ef)]=_0x3f9e1d;}),_0x17c830[_0x235538(0x22f)]((_0x27c2be,_0x1907f7)=>{var _0x23ea0=_0x235538;_0x545665[_0x1907f7][_0x23ea0(0x1ea)]=_0x27c2be;}),_0x430577[_0x235538(0x22f)]((_0x3eb334,_0xbb5d20)=>{var _0x2d8106=_0x235538;_0x545665[_0xbb5d20][_0x2d8106(0x20d)]=_0x3eb334;}),_0x2bc963[_0x235538(0x22f)]((_0x5b2a6d,_0x4a1d7f)=>{var _0x201269=_0x235538;_0x545665[_0x4a1d7f][_0x201269(0x222)]=_0x5b2a6d;}),_0x3c6c1e[_0x235538(0x22f)]((_0x3e7795,_0x3b66f2)=>{var _0x32034d=_0x235538;_0x545665[_0x3b66f2][_0x32034d(0x214)]=_0x3e7795;}),_0x127f19['forEach']((_0x6dd8ae,_0x3e084f)=>{_0x545665[_0x3e084f]['rack']=_0x6dd8ae;}),_0x4c032b[_0x235538(0x22f)]((_0x1af0fe,_0x5406b7)=>{var _0x30b2d5=_0x235538;_0x545665[_0x5406b7][_0x30b2d5(0x254)]=_0x1af0fe;}),_0x1037a8[_0x235538(0x22f)]((_0x12fdb6,_0x2130fe)=>{var _0x2998cc=_0x235538;_0x545665[_0x2130fe][_0x2998cc(0x1ae)]=_0x12fdb6;}),_0x4932ee['forEach']((_0x29cd61,_0x59a298)=>{var _0x53cb65=_0x235538;_0x545665[_0x59a298][_0x53cb65(0x18d)]=_0x29cd61;}),_0x3d990e['forEach']((_0x5cca2d,_0x50d310)=>{var _0x11b833=_0x235538;_0x545665[_0x50d310][_0x11b833(0x196)]=_0x5cca2d;});const _0xb0aae4=_0x545665['filter'](_0x4d4e45=>_0x4d4e45[_0x235538(0x1cf)]!=='0'&&_0x4d4e45[_0x235538(0x1cf)]!==''||_0x4d4e45[_0x235538(0x1ba)]!=='0'&&_0x4d4e45[_0x235538(0x1ba)]!=='');var _0x51cbca=0x0;_0xb0aae4[_0x235538(0x22f)](_0x50c267=>{var _0x13a71b=_0x235538;parseInt(_0x50c267[_0x13a71b(0x279)])<parseInt(_0x50c267['to_quantity'])&&_0x51cbca++;});if(_0x51cbca!=0x0)return _0x5ba58b[_0x235538(0x215)](_0x235538(0x240),_0x235538(0x199)),_0x3d4975[_0x235538(0x1a7)](_0x235538(0x1fb));const _0x24baad=await warehouse[_0x235538(0x1d2)]({'name':_0xddc01c[_0x235538(0x1fe)],'room':_0xddc01c[_0x235538(0x1d3)]});_0xddc01c[_0x235538(0x19a)][_0x235538(0x22f)](_0x388aa8=>{var _0x30734b=_0x235538;if(_0x388aa8[_0x30734b(0x1cf)]>0x0){const _0x448a2d=_0x24baad[_0x30734b(0x227)][_0x30734b(0x1e7)](_0x5beea2=>{var _0x58396a=_0x30734b;_0x5beea2[_0x58396a(0x189)]==_0x388aa8[_0x58396a(0x189)]&&_0x5beea2[_0x58396a(0x241)]==_0x388aa8['from_floorlevel']&&_0x5beea2[_0x58396a(0x1f6)]==_0x388aa8[_0x58396a(0x254)]&&_0x5beea2[_0x58396a(0x1af)]==_0x388aa8['from_bin']&&_0x5beea2[_0x58396a(0x195)]==_0x388aa8[_0x58396a(0x1c7)]&&_0x5beea2[_0x58396a(0x1b6)]==_0x388aa8[_0x58396a(0x196)]&&_0x5beea2['storage']==_0x388aa8[_0x58396a(0x18d)]&&(_0x5beea2[_0x58396a(0x216)]=parseInt(_0x5beea2[_0x58396a(0x216)])+parseInt(_0x388aa8[_0x58396a(0x1cf)]));});}}),await _0x24baad[_0x235538(0x267)]();const _0x3c9e21=await warehouse[_0x235538(0x1d2)]({'name':_0xddc01c[_0x235538(0x273)],'room':_0xddc01c[_0x235538(0x1d6)]});_0xddc01c[_0x235538(0x19a)][_0x235538(0x22f)](_0x4f3e8b=>{var _0x5b6203=_0x235538;if(_0x4f3e8b[_0x5b6203(0x1cf)]>0x0){const _0x322b75=_0x3c9e21[_0x5b6203(0x227)]['map'](_0x12118e=>{var _0x5ace5e=_0x5b6203;_0x12118e[_0x5ace5e(0x189)]==_0x4f3e8b[_0x5ace5e(0x189)]&&_0x12118e[_0x5ace5e(0x241)]==_0x4f3e8b[_0x5ace5e(0x1ba)]&&_0x12118e[_0x5ace5e(0x1f6)]==_0x4f3e8b['to_types']&&_0x12118e['bin']==_0x4f3e8b['to_bin']&&_0x12118e[_0x5ace5e(0x195)]==_0x4f3e8b[_0x5ace5e(0x18b)]&&_0x12118e[_0x5ace5e(0x1b6)]==_0x4f3e8b[_0x5ace5e(0x1b6)]&&_0x12118e[_0x5ace5e(0x214)]==_0x4f3e8b[_0x5ace5e(0x214)]&&(_0x12118e[_0x5ace5e(0x216)]=parseInt(_0x12118e[_0x5ace5e(0x216)])-parseInt(_0x4f3e8b[_0x5ace5e(0x1cf)]));});}}),await _0x3c9e21[_0x235538(0x267)](),_0xddc01c[_0x235538(0x188)]=_0x14287a,_0xddc01c['from_warehouse']=_0x2679c5,_0xddc01c[_0x235538(0x273)]=_0x1d864b,_0xddc01c[_0x235538(0x19a)]=_0xb0aae4,_0xddc01c[_0x235538(0x21c)]=_0x46f5fe,_0xddc01c[_0x235538(0x1dd)]=_0x347945;const _0x4262b2=await _0xddc01c[_0x235538(0x267)]();console['log'](_0x4262b2);const _0x11ef01=await warehouse[_0x235538(0x1d2)]({'name':_0x2679c5,'room':_0x22c740});_0x4262b2[_0x235538(0x19a)]['forEach'](_0x446813=>{var _0x1fedc2=_0x235538;if(_0x446813['to_quantity']>0x0){const _0x31a9db=_0x11ef01[_0x1fedc2(0x227)]['map'](_0x486d5b=>{var _0x1e89fa=_0x1fedc2;_0x486d5b[_0x1e89fa(0x189)]==_0x446813[_0x1e89fa(0x189)]&&_0x486d5b[_0x1e89fa(0x241)]==_0x446813[_0x1e89fa(0x213)]&&_0x486d5b[_0x1e89fa(0x1f6)]==_0x446813['from_types']&&_0x486d5b[_0x1e89fa(0x1af)]==_0x446813[_0x1e89fa(0x1bb)]&&_0x486d5b[_0x1e89fa(0x195)]==_0x446813[_0x1e89fa(0x1c7)]&&_0x486d5b[_0x1e89fa(0x1b6)]==_0x446813[_0x1e89fa(0x196)]&&_0x486d5b[_0x1e89fa(0x214)]==_0x446813['from_storage']&&(_0x486d5b['product_stock']=parseInt(_0x486d5b['product_stock'])-parseInt(_0x446813[_0x1e89fa(0x1cf)]));});}}),await _0x11ef01[_0x235538(0x267)]();const _0x442469=await warehouse['findOne']({'name':_0x1d864b,'room':_0x3a68c3});_0x4262b2[_0x235538(0x19a)][_0x235538(0x22f)](_0xe31c44=>{var _0x2286fa=_0x235538;if(_0xe31c44[_0x2286fa(0x1cf)]>0x0){var _0x5e154c=0x0;const _0x56f1e0=_0x442469[_0x2286fa(0x227)][_0x2286fa(0x1e7)](_0x236d7c=>{var _0x2af873=_0x2286fa;_0x236d7c[_0x2af873(0x189)]==_0xe31c44[_0x2af873(0x189)]&&_0x236d7c[_0x2af873(0x241)]==_0xe31c44[_0x2af873(0x1ba)]&&_0x236d7c[_0x2af873(0x1f6)]==_0xe31c44[_0x2af873(0x1ae)]&&_0x236d7c[_0x2af873(0x1af)]==_0xe31c44[_0x2af873(0x1e0)]&&_0x236d7c[_0x2af873(0x195)]==_0xe31c44[_0x2af873(0x18b)]&&_0x236d7c[_0x2af873(0x1b6)]==_0xe31c44[_0x2af873(0x1b6)]&&_0x236d7c['storage']==_0xe31c44[_0x2af873(0x214)]&&(_0x236d7c[_0x2af873(0x216)]=parseInt(_0x236d7c[_0x2af873(0x216)])+parseInt(_0xe31c44['to_quantity']),_0x5e154c++);});_0x5e154c=='0'&&(_0x442469[_0x2286fa(0x227)]=_0x442469[_0x2286fa(0x227)][_0x2286fa(0x201)]({'product_name':_0xe31c44[_0x2286fa(0x189)],'product_stock':_0xe31c44[_0x2286fa(0x1cf)],'bay':_0xe31c44[_0x2286fa(0x18b)],'bin':_0xe31c44[_0x2286fa(0x1e0)],'type':_0xe31c44[_0x2286fa(0x1ae)],'floorlevel':_0xe31c44['to_floorlevel'],'storage':_0xe31c44[_0x2286fa(0x214)],'rack':_0xe31c44[_0x2286fa(0x1b6)],'product_code':_0xe31c44[_0x2286fa(0x1f8)],'primary_code':_0xe31c44[_0x2286fa(0x251)],'secondary_code':_0xe31c44[_0x2286fa(0x22a)],'maxProducts':_0xe31c44['maxProducts'],'storage':_0xe31c44[_0x2286fa(0x214)],'rack':_0xe31c44[_0x2286fa(0x1b6)]}));}}),await _0x442469[_0x235538(0x267)](),_0x5ba58b['flash']('success',_0x235538(0x1d9)),_0x3d4975[_0x235538(0x1a7)](_0x235538(0x221));}catch(_0x97dd40){console[_0x235538(0x265)](_0x97dd40);}}),router[a0_0x4b1cea(0x1d5)]('/barcode_scanner',async(_0x1dd424,_0x32666c)=>{var _0x5cb10f=a0_0x4b1cea;const {FromWareHouse:_0x32952e,FromRoom:_0x4cda45,ToWarehouse:_0x42e952,ToRoom:_0x3c97ad,primary_code:_0x2a3df2,Roomslist:_0x3609c1}=_0x1dd424[_0x5cb10f(0x1cc)],_0x5dd979=_0x3609c1[_0x5cb10f(0x212)](','),_0x1139d8=[];async function _0x4a2cdd(_0x406c4b){var _0x30554f=_0x5cb10f;const _0x28735d=await warehouse[_0x30554f(0x25a)]([{'$match':{'name':_0x32952e,'room':_0x406c4b}},{'$unwind':_0x30554f(0x26d)},{'$match':{'product_details.primary_code':_0x2a3df2}},{'$group':{'_id':_0x30554f(0x239),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x30554f(0x187)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x30554f(0x190)},'product_code':{'$first':_0x30554f(0x20a)},'level':{'$first':_0x30554f(0x1b7)},'isle':{'$first':_0x30554f(0x23e)},'type':{'$first':_0x30554f(0x206)},'pallet':{'$first':_0x30554f(0x274)},'unit':{'$first':_0x30554f(0x26f)},'secondary_unit':{'$first':_0x30554f(0x23c)},'storage':{'$first':_0x30554f(0x1f4)},'rack':{'$first':_0x30554f(0x205)},'expiry_date':{'$first':_0x30554f(0x18e)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x30554f(0x1f7)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x30554f(0x21a)},'maxProducts':{'$first':_0x30554f(0x234)},'invoice_product':{'$first':_0x30554f(0x1c6)}}}]),_0x140096=await warehouse[_0x30554f(0x25a)]([{'$match':{'name':_0x32952e,'room':_0x406c4b}},{'$unwind':_0x30554f(0x26d)},{'$match':{'product_details.secondary_code':_0x2a3df2}},{'$group':{'_id':_0x30554f(0x239),'name':{'$first':_0x30554f(0x247)},'instock':{'$first':_0x30554f(0x187)},'primary_code':{'$first':_0x30554f(0x252)},'secondary_code':{'$first':_0x30554f(0x190)},'product_code':{'$first':_0x30554f(0x20a)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x30554f(0x23e)},'type':{'$first':_0x30554f(0x206)},'pallet':{'$first':_0x30554f(0x274)},'unit':{'$first':_0x30554f(0x26f)},'secondary_unit':{'$first':_0x30554f(0x23c)},'storage':{'$first':_0x30554f(0x1f4)},'rack':{'$first':_0x30554f(0x205)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x30554f(0x1f7)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x30554f(0x1c6)}}}]);if(_0x28735d[_0x30554f(0x257)]>0x0)_0x1139d8[_0x30554f(0x276)](_0x28735d);else _0x140096['length']>0x0&&_0x1139d8[_0x30554f(0x276)](_0x140096);}const _0x4b2532=_0x5dd979[_0x5cb10f(0x1e7)](_0x1781ad=>_0x4a2cdd(_0x1781ad));await Promise[_0x5cb10f(0x26c)](_0x4b2532),_0x32666c[_0x5cb10f(0x1bc)](_0x1139d8);}),router['post'](a0_0x4b1cea(0x225),async(_0xcc5810,_0x4307f3)=>{var _0x55e6be=a0_0x4b1cea;try{const {FromWareHouse:_0x2f2cae,FromRoom:_0x4d6759,ToWarehouse:_0x8641d8,ToRoom:_0x5ce393,secondary_code:_0x119eb0}=_0xcc5810[_0x55e6be(0x1cc)],_0x15af35=await warehouse['aggregate']([{'$match':{'name':_0x2f2cae}},{'$unwind':_0x55e6be(0x26d)},{'$match':{'product_details.secondary_code':_0x119eb0}},{'$group':{'_id':_0x55e6be(0x239),'name':{'$first':_0x55e6be(0x247)},'primary_code':{'$first':_0x55e6be(0x252)},'secondary_code':{'$first':_0x55e6be(0x190)},'product_code':{'$first':_0x55e6be(0x20a)},'instock':{'$first':_0x55e6be(0x187)},'warehouse':{'$first':_0x55e6be(0x1e9)},'level':{'$first':_0x55e6be(0x20f)},'isle':{'$first':_0x55e6be(0x211)},'pallet':{'$first':_0x55e6be(0x1eb)},'maxProducts':{'$first':_0x55e6be(0x234)},'unit':{'$first':_0x55e6be(0x26f)}}}]);_0x4307f3['status'](0xc8)[_0x55e6be(0x1bc)](_0x15af35);}catch(_0x3cd4f8){_0x4307f3['status'](0x194)['json']({'message':_0x3cd4f8[_0x55e6be(0x1e6)]});}}),router[a0_0x4b1cea(0x1d5)]('/barcode_scanner3',async(_0x2fc7e4,_0x19f9e7)=>{var _0x3e78e9=a0_0x4b1cea;try{const {FromWareHouse:_0x46ab66,FromRoom:_0x309198,ToWarehouse:_0x317620,ToRoom:_0xe0e8a7,product_code:_0x1657fe}=_0x2fc7e4[_0x3e78e9(0x1cc)],_0x45410e=await warehouse[_0x3e78e9(0x25a)]([{'$match':{'name':_0x46ab66}},{'$unwind':_0x3e78e9(0x26d)},{'$match':{'product_details.product_code':_0x1657fe}},{'$group':{'_id':_0x3e78e9(0x239),'name':{'$first':_0x3e78e9(0x247)},'primary_code':{'$first':_0x3e78e9(0x252)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3e78e9(0x20a)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x3e78e9(0x20f)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x3e78e9(0x1eb)},'maxProducts':{'$first':_0x3e78e9(0x234)},'unit':{'$first':_0x3e78e9(0x26f)}}}]);_0x19f9e7[_0x3e78e9(0x242)](0xc8)[_0x3e78e9(0x1bc)](_0x45410e);}catch(_0x264cfe){_0x19f9e7[_0x3e78e9(0x242)](0x194)[_0x3e78e9(0x1bc)]({'message':_0x264cfe['message']});}}),router[a0_0x4b1cea(0x1d5)](a0_0x4b1cea(0x1fc),async(_0x740934,_0x401841)=>{var _0xdc4d0=a0_0x4b1cea;const {level:_0x211f9e,isle:_0x17b337,pallet:_0x55e1ac,warehouses:_0x1aaafe,room:_0xf09d6a}=_0x740934[_0xdc4d0(0x1cc)];try{const _0x4d5f1d=await warehouse[_0xdc4d0(0x25a)]([{'$match':{'name':_0x1aaafe,'room':_0xf09d6a}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x211f9e),'product_details.isle':_0x17b337,'product_details.pallet':parseInt(_0x55e1ac)}},{'$group':{'_id':_0xdc4d0(0x239),'name':{'$first':_0xdc4d0(0x247)},'product_stock':{'$first':_0xdc4d0(0x187)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0xdc4d0(0x211)},'pallet':{'$first':_0xdc4d0(0x1eb)},'maxProducts':{'$first':_0xdc4d0(0x234)}}}]);_0x401841[_0xdc4d0(0x242)](0xc8)[_0xdc4d0(0x1bc)](_0x4d5f1d);}catch(_0x141418){_0x401841[_0xdc4d0(0x242)](0x194)[_0xdc4d0(0x1bc)]({'message':_0x141418[_0xdc4d0(0x1e6)]});}}),module[a0_0x4b1cea(0x255)]=router;