var a0_0x264cb7=a0_0x1b37;(function(_0x1cc38b,_0x1b978e){var _0x186823=a0_0x1b37,_0x37daf0=_0x1cc38b();while(!![]){try{var _0x8132e5=-parseInt(_0x186823(0xee))/0x1+-parseInt(_0x186823(0x69))/0x2+parseInt(_0x186823(0x131))/0x3+-parseInt(_0x186823(0xdd))/0x4*(-parseInt(_0x186823(0xe0))/0x5)+parseInt(_0x186823(0xa7))/0x6*(parseInt(_0x186823(0xbd))/0x7)+parseInt(_0x186823(0xeb))/0x8*(-parseInt(_0x186823(0xb1))/0x9)+parseInt(_0x186823(0xe2))/0xa*(-parseInt(_0x186823(0x103))/0xb);if(_0x8132e5===_0x1b978e)break;else _0x37daf0['push'](_0x37daf0['shift']());}catch(_0x4029f){_0x37daf0['push'](_0x37daf0['shift']());}}}(a0_0x261a,0x79710));const express=require(a0_0x264cb7(0x67)),app=express(),router=express[a0_0x264cb7(0x115)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x264cb7(0xcc)),nodemailer=require(a0_0x264cb7(0x101));router[a0_0x264cb7(0xcd)](a0_0x264cb7(0x14a),auth,async(_0x3feb2d,_0x3bc4ba)=>{var _0x48c9f0=a0_0x264cb7;try{const {username:_0x6ee3b5,email:_0x4da7de,role:_0x2ea537}=_0x3feb2d['user'],_0x3ba7dd=_0x3feb2d[_0x48c9f0(0xc4)],_0x1695b3=await profile[_0x48c9f0(0x88)]({'email':_0x3ba7dd[_0x48c9f0(0x148)]}),_0x2b4d83=await master_shop['find']();console[_0x48c9f0(0x8c)](_0x48c9f0(0x109),_0x2b4d83);let _0x119bf2;if(_0x3ba7dd[_0x48c9f0(0xc7)]==_0x48c9f0(0x12a)){const _0x5de456=await staff[_0x48c9f0(0x88)]({'email':_0x3ba7dd[_0x48c9f0(0x148)]});_0x119bf2=await transfers['find']({'from_warehouse':_0x5de456[_0x48c9f0(0xc8)]});}else _0x119bf2=await transfers['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x48c9f0(0xbe),'invoice':{'$first':_0x48c9f0(0x8f)},'date':{'$first':_0x48c9f0(0x66)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x48c9f0(0xb2)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x48c9f0(0xc1)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x48c9f0(0x100)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2b4d83[0x0][_0x48c9f0(0x90)]==_0x48c9f0(0x123)){var _0x310083=users[_0x48c9f0(0xc0)];console['log'](_0x310083);}else{if(_0x2b4d83[0x0][_0x48c9f0(0x90)]==_0x48c9f0(0xd1))var _0x310083=users[_0x48c9f0(0xd1)];else{if(_0x2b4d83[0x0][_0x48c9f0(0x90)]==_0x48c9f0(0x75))var _0x310083=users['German'];else{if(_0x2b4d83[0x0][_0x48c9f0(0x90)]==_0x48c9f0(0xf8))var _0x310083=users[_0x48c9f0(0xf8)];else{if(_0x2b4d83[0x0][_0x48c9f0(0x90)]==_0x48c9f0(0x122))var _0x310083=users['French'];else{if(_0x2b4d83[0x0][_0x48c9f0(0x90)]=='Portuguese\x20(BR)')var _0x310083=users[_0x48c9f0(0x143)];else{if(_0x2b4d83[0x0][_0x48c9f0(0x90)]==_0x48c9f0(0x13b))var _0x310083=users['Chinese'];else{if(_0x2b4d83[0x0][_0x48c9f0(0x90)]==_0x48c9f0(0x12c))var _0x310083=users[_0x48c9f0(0x121)];}}}}}}}_0x3bc4ba[_0x48c9f0(0x84)](_0x48c9f0(0x144),{'success':_0x3feb2d[_0x48c9f0(0x8b)]('success'),'errors':_0x3feb2d[_0x48c9f0(0x8b)](_0x48c9f0(0x10e)),'role':_0x3ba7dd,'profile':_0x1695b3,'master_shop':_0x2b4d83,'transfer':_0x119bf2,'language':_0x310083});}catch(_0x38a523){console[_0x48c9f0(0x8c)](_0x38a523);}});async function getRandom8DigitNumber(){var _0x3244fa=a0_0x264cb7;const _0x583613=0x989680,_0x3873f6=0x5f5e0ff,_0x29e542=Math[_0x3244fa(0xa1)](Math['random']()*(_0x3873f6-_0x583613+0x1))+_0x583613;var _0x3ca0e8;const _0xce0088=await transfers[_0x3244fa(0x88)]({'invoice':_0x3244fa(0x7f)+_0x29e542});return _0xce0088&&_0xce0088['length']>0x0?_0x3ca0e8=_0x3244fa(0x7f)+_0x29e542:_0x3ca0e8=_0x3244fa(0x7f)+_0x29e542,_0x3ca0e8;}router[a0_0x264cb7(0xcd)](a0_0x264cb7(0x91),auth,async(_0x6f2316,_0x541cdc)=>{var _0x1602e2=a0_0x264cb7;try{const {username:_0x214a35,email:_0x3a84ba,role:_0x59cd84}=_0x6f2316[_0x1602e2(0xc4)],_0x7d9bd2=_0x6f2316[_0x1602e2(0xc4)],_0xbc0aee=await profile['findOne']({'email':_0x7d9bd2[_0x1602e2(0x148)]}),_0x5ab9a9=await master_shop[_0x1602e2(0x98)]();console[_0x1602e2(0x8c)](_0x1602e2(0x109),_0x5ab9a9);let _0x920e58;if(_0x7d9bd2['role']==_0x1602e2(0x12a)){const _0x1eefa8=await staff[_0x1602e2(0x88)]({'email':_0x7d9bd2['email']});_0x920e58=await warehouse[_0x1602e2(0x145)]([{'$match':{'status':_0x1602e2(0x129),'name':_0x1eefa8[_0x1602e2(0xc8)],'warehouse_category':_0x1602e2(0x6e)}},{'$group':{'_id':_0x1602e2(0x126),'name':{'$first':_0x1602e2(0x126)}}}]);}else _0x920e58=await warehouse[_0x1602e2(0x145)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x1602e2(0x126),'name':{'$first':_0x1602e2(0x126)}}}]);var _0x2f76fd=['Ambient',_0x1602e2(0x14d),_0x1602e2(0x106)];const _0x280027=await transfers[_0x1602e2(0x98)]({}),_0x1fc2a5=_0x280027['length']+0x1,_0x3195c8=_0x1602e2(0x7f)+_0x1fc2a5['toString']()['padStart'](0x5,'0');if(_0x5ab9a9[0x0]['language']==_0x1602e2(0x123)){var _0x289a44=users[_0x1602e2(0xc0)];console[_0x1602e2(0x8c)](_0x289a44);}else{if(_0x5ab9a9[0x0]['language']==_0x1602e2(0xd1))var _0x289a44=users[_0x1602e2(0xd1)];else{if(_0x5ab9a9[0x0][_0x1602e2(0x90)]==_0x1602e2(0x75))var _0x289a44=users[_0x1602e2(0x75)];else{if(_0x5ab9a9[0x0][_0x1602e2(0x90)]=='Spanish')var _0x289a44=users[_0x1602e2(0xf8)];else{if(_0x5ab9a9[0x0][_0x1602e2(0x90)]==_0x1602e2(0x122))var _0x289a44=users['French'];else{if(_0x5ab9a9[0x0][_0x1602e2(0x90)]==_0x1602e2(0x14c))var _0x289a44=users[_0x1602e2(0x143)];else{if(_0x5ab9a9[0x0][_0x1602e2(0x90)]==_0x1602e2(0x13b))var _0x289a44=users[_0x1602e2(0x13b)];else{if(_0x5ab9a9[0x0][_0x1602e2(0x90)]==_0x1602e2(0x12c))var _0x289a44=users[_0x1602e2(0x121)];}}}}}}}const _0x10a541=getRandom8DigitNumber();_0x10a541[_0x1602e2(0xb4)](_0x4d127e=>{var _0x35117f=_0x1602e2;_0x541cdc['render'](_0x35117f(0x95),{'success':_0x6f2316[_0x35117f(0x8b)](_0x35117f(0xa2)),'errors':_0x6f2316['flash'](_0x35117f(0x10e)),'role':_0x7d9bd2,'profile':_0xbc0aee,'master_shop':_0x5ab9a9,'warehouse':_0x920e58,'language':_0x289a44,'rooms_data':_0x2f76fd,'invoice':_0x4d127e});})[_0x1602e2(0x150)](_0x25224d=>{var _0x41e174=_0x1602e2;_0x6f2316['flash'](_0x41e174(0x10e),_0x41e174(0xde)),_0x541cdc[_0x41e174(0xd3)](_0x41e174(0x111));});}catch(_0xc49992){console['log'](_0xc49992);}}),router[a0_0x264cb7(0xfa)](a0_0x264cb7(0x91),auth,async(_0x894931,_0x4ab3a2)=>{var _0x156e2d=a0_0x264cb7;try{console[_0x156e2d(0x8c)](_0x894931[_0x156e2d(0x9d)]);const {date:_0x462b35,from_warehouse:_0x1a3c94,FromRoom_name:_0x5b7180,to_warehouse:_0x24baaf,ToRoom_name:_0x515c39,prod_name:_0x4b4e95,from_prod_qty:_0x44e943,from_prod_level:_0x3556a1,from_prod_isle:_0x3828ce,from_prod_pallet:_0x215980,to_prod_qty:_0x52ecab,to_prod_level:_0x1537a4,to_prod_isle:_0x85224f,to_prod_pallet:_0x462ca2,primary_code:_0x2a9ad6,secondary_code:_0x24b9ff,product_code3:_0x213373,note:_0x1a899f,MaxStocks_data2:_0x4fc1b3,invoice:_0x402382,expiry_date:_0x57422d}=_0x894931[_0x156e2d(0x9d)];if(typeof _0x4b4e95=='string')var _0x2a138=[_0x894931['body'][_0x156e2d(0xc2)]],_0x3e1ce0=[_0x894931['body'][_0x156e2d(0xfe)]],_0xfa984e=[_0x894931['body'][_0x156e2d(0x120)]],_0x15a512=[_0x894931[_0x156e2d(0x9d)]['New_Qty_Converted']],_0x2c4af5=[_0x894931['body'][_0x156e2d(0xa0)]],_0x26d28a=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0x11e)]],_0x372a8e=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0x12d)]],_0x22ea23=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0x133)]],_0x46cba0=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0xaf)]],_0x30ea61=[_0x894931['body'][_0x156e2d(0x94)]],_0xcdbe28=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0x82)]],_0x2afacd=[_0x894931['body']['batch_code']],_0x35c8b0=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0x13f)]],_0x3c212d=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0x108)]],_0x4df166=[_0x894931['body'][_0x156e2d(0xf1)]],_0x341bdc=[_0x894931[_0x156e2d(0x9d)]['prod_cat']],_0x37b2ed=[_0x894931['body'][_0x156e2d(0x118)]],_0x7080e9=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0x13d)]],_0x327c92=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0xa5)]],_0x728b40=[_0x894931[_0x156e2d(0x9d)][_0x156e2d(0x125)]],_0x13b8f2=[_0x894931[_0x156e2d(0x9d)]['id_transaction']];else var _0x2a138=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0xc2)]],_0x3e1ce0=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0xfe)]],_0xfa984e=[..._0x894931[_0x156e2d(0x9d)]['from_prod_level']],_0x15a512=[..._0x894931[_0x156e2d(0x9d)]['New_Qty_Converted']],_0x2c4af5=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0xa0)]],_0x26d28a=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0x11e)]],_0x372a8e=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0x12d)]],_0x22ea23=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0x133)]],_0x46cba0=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0xaf)]],_0x30ea61=[..._0x894931['body'][_0x156e2d(0x94)]],_0xcdbe28=[..._0x894931['body'][_0x156e2d(0x82)]],_0x2afacd=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0x124)]],_0x35c8b0=[..._0x894931['body']['expiry_date']],_0x3c212d=[..._0x894931['body'][_0x156e2d(0x108)]],_0x4df166=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0xf1)]],_0x341bdc=[..._0x894931[_0x156e2d(0x9d)]['prod_cat']],_0x37b2ed=[..._0x894931['body'][_0x156e2d(0x118)]],_0x7080e9=[..._0x894931['body']['ToRoomAssigned']],_0x327c92=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0xa5)]],_0x728b40=[..._0x894931['body'][_0x156e2d(0x125)]],_0x13b8f2=[..._0x894931[_0x156e2d(0x9d)][_0x156e2d(0xe3)]];const _0xad9718=_0x2a138['map'](_0x1d13ba=>{return _0x1d13ba={'product_name':_0x1d13ba};});_0x3e1ce0[_0x156e2d(0x12f)]((_0x4d739d,_0x134279)=>{var _0x1621de=_0x156e2d;_0xad9718[_0x134279][_0x1621de(0x11c)]=_0x4d739d;}),_0x327c92[_0x156e2d(0x12f)]((_0x2275d3,_0x52cf53)=>{var _0x311a6a=_0x156e2d;_0xad9718[_0x52cf53][_0x311a6a(0xa5)]=_0x2275d3;}),_0x728b40['forEach']((_0x292a38,_0xf204ec)=>{_0xad9718[_0xf204ec]['To_invoice']=_0x292a38;}),_0x13b8f2[_0x156e2d(0x12f)]((_0x505e7c,_0x1c8ba5)=>{var _0x517a5b=_0x156e2d;_0xad9718[_0x1c8ba5][_0x517a5b(0x99)]=_0x505e7c;}),_0xfa984e['forEach']((_0x35ccf5,_0x46b120)=>{var _0x28644f=_0x156e2d;_0x37b2ed[_0x28644f(0x12f)]((_0x244567,_0x35f0b8)=>{var _0x1aff70=_0x28644f;if(_0x244567=='Receiving\x20Area'&&_0x46b120==_0x35f0b8){var _0x13aeee=_0x35ccf5[_0x1aff70(0x135)](0x3);_0xad9718[_0x46b120][_0x1aff70(0x7c)]=_0x35ccf5[0x0],_0xad9718[_0x46b120][_0x1aff70(0xa6)]=_0x35ccf5[0x1],_0xad9718[_0x46b120]['from_bay']=0x0,_0xad9718[_0x46b120][_0x1aff70(0xed)]=0x0,_0xad9718[_0x46b120][_0x1aff70(0x112)]=_0x1aff70(0xb7),_0xad9718[_0x46b120][_0x1aff70(0xd4)]=_0x13aeee;}else{if(_0x244567==_0x1aff70(0x10f)&&_0x46b120==_0x35f0b8){var _0x13aeee=_0x35ccf5[_0x1aff70(0x135)](0x3);_0xad9718[_0x46b120][_0x1aff70(0x7c)]=_0x35ccf5[0x0],_0xad9718[_0x46b120]['from_rack']=_0x35ccf5[0x1],_0xad9718[_0x46b120][_0x1aff70(0x12e)]=0x0,_0xad9718[_0x46b120][_0x1aff70(0xed)]=0x0,_0xad9718[_0x46b120][_0x1aff70(0x112)]=_0x1aff70(0xb7),_0xad9718[_0x46b120]['from_floorlevel']=_0x35ccf5[0x5];}else{if(_0x46b120==_0x35f0b8){if(_0x35ccf5[0x0]=='A'&&_0x35ccf5[0x1]=='L'&&_0x35ccf5[0x2]=='L')console[_0x1aff70(0x8c)](_0x244567+_0x1aff70(0xdc)+_0x46b120+'\x20<>\x20'+_0x35f0b8+_0x1aff70(0xdc)+_0x35ccf5+_0x1aff70(0xdf)),_0xad9718[_0x46b120]['from_storage']=_0x35ccf5[0x0],_0xad9718[_0x46b120]['from_rack']=_0x35ccf5[0x1],_0xad9718[_0x46b120][_0x1aff70(0x12e)]=0x0,_0xad9718[_0x46b120][_0x1aff70(0xed)]=0x0,_0xad9718[_0x46b120][_0x1aff70(0x112)]='Floor',_0xad9718[_0x46b120][_0x1aff70(0xd4)]=_0x35ccf5[0x3];else{var _0xdadd65;if(_0x35ccf5[0x4]=='L')_0xdadd65=_0x1aff70(0xca);else _0x35ccf5[0x4]=='F'&&(_0xdadd65=_0x1aff70(0xb7));_0xad9718[_0x46b120][_0x1aff70(0x7c)]=_0x35ccf5[0x0],_0xad9718[_0x46b120][_0x1aff70(0xa6)]=_0x35ccf5[0x1],_0xad9718[_0x46b120][_0x1aff70(0x12e)]=_0x35ccf5[0x2],_0xad9718[_0x46b120][_0x1aff70(0xed)]=_0x35ccf5[0x3],_0xad9718[_0x46b120][_0x1aff70(0x112)]=_0xdadd65,_0xad9718[_0x46b120][_0x1aff70(0xd4)]=_0x35ccf5[0x5];}}}}});}),_0x15a512['forEach']((_0x2a0037,_0x3a04f1)=>{var _0x5bf3a3=_0x156e2d;_0xad9718[_0x3a04f1][_0x5bf3a3(0xa4)]=_0x2a0037;}),_0x2c4af5['forEach']((_0x3e2be2,_0x4d2a86)=>{var _0x3dc654=_0x156e2d;_0x7080e9[_0x3dc654(0x12f)]((_0x3f6fa1,_0x475b25)=>{var _0x4c8269=_0x3dc654;if(_0x3f6fa1==_0x4c8269(0x83)&&_0x4d2a86==_0x475b25){var _0x41c558=_0x3e2be2[_0x4c8269(0x135)](0x3);_0xad9718[_0x4d2a86][_0x4c8269(0x7d)]=_0x3e2be2[0x0],_0xad9718[_0x4d2a86][_0x4c8269(0x7b)]=_0x3e2be2[0x1],_0xad9718[_0x4d2a86][_0x4c8269(0x8d)]=0x0,_0xad9718[_0x4d2a86][_0x4c8269(0xb8)]=0x0,_0xad9718[_0x4d2a86][_0x4c8269(0x137)]=_0x4c8269(0xb7),_0xad9718[_0x4d2a86][_0x4c8269(0xb3)]=_0x41c558;}else{if(_0x3f6fa1==_0x4c8269(0x10f)&&_0x4d2a86==_0x475b25){var _0x41c558=_0x3e2be2[_0x4c8269(0x135)](0x3);_0xad9718[_0x4d2a86][_0x4c8269(0x7d)]=_0x3e2be2[0x0],_0xad9718[_0x4d2a86][_0x4c8269(0x7b)]=_0x3e2be2[0x1],_0xad9718[_0x4d2a86][_0x4c8269(0x8d)]=0x0,_0xad9718[_0x4d2a86][_0x4c8269(0xb8)]=0x0,_0xad9718[_0x4d2a86][_0x4c8269(0x137)]=_0x4c8269(0xb7),_0xad9718[_0x4d2a86][_0x4c8269(0xb3)]=_0x3e2be2[0x5];}else{if(_0x4d2a86==_0x475b25){if(_0x3e2be2[0x0]=='A'&&_0x3e2be2[0x1]=='L'&&_0x3e2be2[0x2]=='L')console[_0x4c8269(0x8c)](_0x3f6fa1+_0x4c8269(0xdc)+_0x4d2a86+_0x4c8269(0xdc)+_0x475b25+_0x4c8269(0xdc)+_0x3e2be2+'here'),_0xad9718[_0x4d2a86][_0x4c8269(0x7d)]=_0x3e2be2[0x0],_0xad9718[_0x4d2a86][_0x4c8269(0x7b)]=_0x3e2be2[0x1],_0xad9718[_0x4d2a86][_0x4c8269(0x8d)]=0x0,_0xad9718[_0x4d2a86][_0x4c8269(0xb8)]=0x0,_0xad9718[_0x4d2a86][_0x4c8269(0x137)]='Floor',_0xad9718[_0x4d2a86][_0x4c8269(0xb3)]=_0x3e2be2[0x3];else{var _0x23bd81;if(_0x3e2be2[0x4]=='L')_0x23bd81=_0x4c8269(0xca);else _0x3e2be2[0x4]=='F'&&(_0x23bd81=_0x4c8269(0xb7));_0xad9718[_0x4d2a86]['storage']=_0x3e2be2[0x0],_0xad9718[_0x4d2a86][_0x4c8269(0x7b)]=_0x3e2be2[0x1],_0xad9718[_0x4d2a86][_0x4c8269(0x8d)]=_0x3e2be2[0x2],_0xad9718[_0x4d2a86][_0x4c8269(0xb8)]=_0x3e2be2[0x3],_0xad9718[_0x4d2a86][_0x4c8269(0x137)]=_0x23bd81,_0xad9718[_0x4d2a86][_0x4c8269(0xb3)]=_0x3e2be2[0x5];}}}}});}),_0x26d28a[_0x156e2d(0x12f)]((_0x4147c7,_0x1957b2)=>{_0xad9718[_0x1957b2]['primary_code']=_0x4147c7;}),_0x372a8e[_0x156e2d(0x12f)]((_0x4dc31c,_0x5d1479)=>{var _0x45027d=_0x156e2d;_0xad9718[_0x5d1479][_0x45027d(0x12d)]=_0x4dc31c;}),_0x22ea23['forEach']((_0x49b3d7,_0x35d827)=>{var _0xa59fd7=_0x156e2d;_0xad9718[_0x35d827][_0xa59fd7(0x13a)]=_0x49b3d7;}),_0x46cba0[_0x156e2d(0x12f)]((_0x327181,_0x1f7663)=>{_0xad9718[_0x1f7663]['maxProducts']=_0x327181;}),_0x30ea61[_0x156e2d(0x12f)]((_0x455b71,_0x2ea8c1)=>{var _0x469c67=_0x156e2d;_0xad9718[_0x2ea8c1][_0x469c67(0x134)]=_0x455b71;}),_0xcdbe28[_0x156e2d(0x12f)]((_0x31aa4b,_0x26932a)=>{var _0x2b272f=_0x156e2d;_0xad9718[_0x26932a][_0x2b272f(0x82)]=_0x31aa4b;}),_0x2afacd[_0x156e2d(0x12f)]((_0x3711f3,_0x1b7770)=>{var _0x52db37=_0x156e2d;_0xad9718[_0x1b7770][_0x52db37(0x124)]=_0x3711f3;}),_0x35c8b0['forEach']((_0x3bc125,_0x459a33)=>{var _0x68abf8=_0x156e2d;_0xad9718[_0x459a33][_0x68abf8(0x13f)]=_0x3bc125;}),_0x3c212d[_0x156e2d(0x12f)]((_0x1956e1,_0x517d08)=>{var _0x405038=_0x156e2d;_0xad9718[_0x517d08][_0x405038(0x10a)]=_0x1956e1;}),_0x4df166[_0x156e2d(0x12f)]((_0x482180,_0x375f86)=>{_0xad9718[_0x375f86]['production_date']=_0x482180;}),_0x341bdc[_0x156e2d(0x12f)]((_0x3be06a,_0x3681c5)=>{var _0x3b27fc=_0x156e2d;_0xad9718[_0x3681c5][_0x3b27fc(0x10d)]=_0x3be06a;}),_0x37b2ed['forEach']((_0x1b45f0,_0x5aec71)=>{_0xad9718[_0x5aec71]['from_room_name']=_0x1b45f0;}),_0x7080e9[_0x156e2d(0x12f)]((_0x144ee3,_0x2e7977)=>{var _0x5d568c=_0x156e2d;_0xad9718[_0x2e7977][_0x5d568c(0x65)]=_0x144ee3;});const _0x52c643=_0xad9718[_0x156e2d(0x92)](_0x20304a=>_0x20304a[_0x156e2d(0xa4)]!=='0'&&_0x20304a[_0x156e2d(0xa4)]!==''||_0x20304a[_0x156e2d(0xb3)]!=='0'&&_0x20304a[_0x156e2d(0xb3)]!==''),_0x3aaa08=new transfers({'date':_0x462b35,'from_warehouse':_0x1a3c94,'to_warehouse':_0x24baaf,'product':_0x52c643,'note':_0x1a899f,'invoice':_0x402382}),_0x4dc976=await _0x3aaa08[_0x156e2d(0xf6)]();_0x894931[_0x156e2d(0x8b)]('success',_0x156e2d(0x76)),_0x4ab3a2[_0x156e2d(0xd3)](_0x156e2d(0x93)+_0x4dc976[_0x156e2d(0x14b)]);}catch(_0x56a554){console[_0x156e2d(0x8c)](_0x56a554),_0x4ab3a2['status'](0xc8)[_0x156e2d(0xaa)]({'errorMessage':_0x56a554[_0x156e2d(0x96)]});}}),router['get'](a0_0x264cb7(0xff),auth,async(_0x594c91,_0x4c9b0e)=>{var _0x596fc7=a0_0x264cb7;try{const {username:_0x40bf1d,email:_0x553cad,role:_0x5358d0}=_0x594c91['user'],_0x435dd8=_0x594c91[_0x596fc7(0xc4)],_0x364d65=await profile[_0x596fc7(0x88)]({'email':_0x435dd8[_0x596fc7(0x148)]}),_0x21cf16=await master_shop[_0x596fc7(0x98)]();console[_0x596fc7(0x8c)]('master',_0x21cf16);const _0xec9821=await transfers['findById'](_0x594c91['params']['id']);let _0x36bfec=new Date(_0xec9821['expiry_date']),_0x464f15=('0'+_0x36bfec[_0x596fc7(0x6b)]())[_0x596fc7(0x135)](-0x2),_0x4f5d12=('0'+(_0x36bfec['getMonth']()+0x1))[_0x596fc7(0x135)](-0x2),_0x1ce5d6=_0x36bfec[_0x596fc7(0x71)](),_0x36065d=_0x1ce5d6+'-'+_0x4f5d12+'-'+_0x464f15,_0x26b9b5;if(_0x435dd8[_0x596fc7(0xc7)]==_0x596fc7(0x12a)){const _0x3edbce=await staff[_0x596fc7(0x88)]({'email':_0x435dd8[_0x596fc7(0x148)]});_0x26b9b5=await warehouse['find']({'status':_0x596fc7(0x129),'name':_0x3edbce[_0x596fc7(0xc8)],'warehouse_category':_0x596fc7(0x6e)});}else _0x26b9b5=await warehouse[_0x596fc7(0x98)]({'status':'Enabled','warehouse_category':_0x596fc7(0x6e)});const _0x232713=await warehouse[_0x596fc7(0x145)]([{'$match':{'name':_0xec9821[_0x596fc7(0xfd)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x596fc7(0x9a),'name':{'$first':_0x596fc7(0xb0)},'product_stock':{'$first':_0x596fc7(0x136)},'bay':{'$first':_0x596fc7(0x97)},'bin':{'$first':_0x596fc7(0x8e)},'type':{'$first':_0x596fc7(0xfb)},'floorlevel':{'$first':_0x596fc7(0xe8)},'primary_code':{'$first':_0x596fc7(0xd7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x596fc7(0xf9)},'rack':{'$first':_0x596fc7(0x10c)},'expiry_date':{'$first':_0x596fc7(0x141)},'production_date':{'$first':_0x596fc7(0x79)},'room':{'$first':_0x596fc7(0x70)}}}]);if(_0x21cf16[0x0][_0x596fc7(0x90)]=='English\x20(US)'){var _0x1e893a=users[_0x596fc7(0xc0)];console[_0x596fc7(0x8c)](_0x1e893a);}else{if(_0x21cf16[0x0]['language']=='Hindi')var _0x1e893a=users['Hindi'];else{if(_0x21cf16[0x0]['language']=='German')var _0x1e893a=users['German'];else{if(_0x21cf16[0x0][_0x596fc7(0x90)]==_0x596fc7(0xf8))var _0x1e893a=users[_0x596fc7(0xf8)];else{if(_0x21cf16[0x0][_0x596fc7(0x90)]==_0x596fc7(0x122))var _0x1e893a=users[_0x596fc7(0x122)];else{if(_0x21cf16[0x0][_0x596fc7(0x90)]==_0x596fc7(0x14c))var _0x1e893a=users[_0x596fc7(0x143)];else{if(_0x21cf16[0x0][_0x596fc7(0x90)]==_0x596fc7(0x13b))var _0x1e893a=users[_0x596fc7(0x13b)];else{if(_0x21cf16[0x0]['language']==_0x596fc7(0x12c))var _0x1e893a=users['Arabic'];}}}}}}}_0x4c9b0e[_0x596fc7(0x84)]('edit_transfer_view',{'success':_0x594c91[_0x596fc7(0x8b)](_0x596fc7(0xa2)),'errors':_0x594c91[_0x596fc7(0x8b)](_0x596fc7(0x10e)),'role':_0x435dd8,'profile':_0x364d65,'master_shop':_0x21cf16,'warehouse':_0x26b9b5,'transfer':_0xec9821,'stock':_0x232713,'language':_0x1e893a});}catch(_0x214532){console['log'](_0x214532);}}),router[a0_0x264cb7(0xfa)](a0_0x264cb7(0xff),auth,async(_0xf6756e,_0x3fcf68)=>{var _0x1d70bc=a0_0x264cb7;try{const _0xd52b2=_0xf6756e[_0x1d70bc(0x64)]['id'],{from_warehouse:_0x19dd58,FromRoom_name:_0x3b8f1d,to_warehouse:_0x50d02a,ToRoom_name:_0x3d691d}=_0xf6756e[_0x1d70bc(0x9d)],_0x4f6f29=await transfers[_0x1d70bc(0x138)]({'_id':_0xd52b2}),_0x9a61a6=_0x4f6f29[_0x1d70bc(0x139)][_0x1d70bc(0xd2)](async _0x6d8ac2=>{var _0x525b81=_0x1d70bc;if(_0x6d8ac2['to_quantity']>0x0){var _0x15acee=await warehouse[_0x525b81(0x88)]({'name':_0x4f6f29[_0x525b81(0xfd)],'room':_0x6d8ac2[_0x525b81(0x119)],'warehouse_category':_0x525b81(0x6e)});const _0x3c3e69=_0x15acee[_0x525b81(0x86)][_0x525b81(0xd2)](_0x5c6e3a=>{var _0x70f782=_0x525b81;_0x5c6e3a[_0x70f782(0xac)]==_0x6d8ac2[_0x70f782(0xac)]&&_0x5c6e3a['floorlevel']==_0x6d8ac2[_0x70f782(0xd4)]&&_0x5c6e3a[_0x70f782(0xec)]==_0x6d8ac2[_0x70f782(0x112)]&&_0x5c6e3a['bin']==_0x6d8ac2['from_bin']&&_0x5c6e3a[_0x70f782(0xab)]==_0x6d8ac2[_0x70f782(0x12e)]&&_0x5c6e3a[_0x70f782(0x7b)]==_0x6d8ac2['from_rack']&&_0x5c6e3a['storage']==_0x6d8ac2[_0x70f782(0x7c)]&&_0x5c6e3a[_0x70f782(0x13f)]==_0x6d8ac2[_0x70f782(0x13f)]&&_0x5c6e3a['batch_code']==_0x6d8ac2[_0x70f782(0x124)]&&_0x5c6e3a['production_date']==_0x6d8ac2[_0x70f782(0xf1)]&&_0x5c6e3a[_0x70f782(0x117)]==_0x6d8ac2[_0x70f782(0xa5)]&&_0x5c6e3a[_0x70f782(0x14b)]==_0x6d8ac2[_0x70f782(0x99)]&&(_0x5c6e3a['product_stock']=_0x5c6e3a['product_stock']-_0x6d8ac2[_0x70f782(0xa4)]);});}return _0x15acee;});Promise[_0x1d70bc(0x89)](_0x9a61a6)[_0x1d70bc(0xb4)](async _0x4305be=>{var _0x4de9f2=_0x1d70bc;try{for(const _0x29f093 of _0x4305be){await _0x29f093[_0x4de9f2(0xf6)]();}try{const _0x54aff1=_0x4f6f29[_0x4de9f2(0x139)][_0x4de9f2(0xd2)](async _0x281dd4=>{var _0x550722=_0x4de9f2;if(_0x281dd4[_0x550722(0xa4)]>0x0){var _0x1f1c19=await warehouse[_0x550722(0x88)]({'name':_0x4f6f29[_0x550722(0x130)],'room':_0x281dd4[_0x550722(0x65)],'warehouse_category':_0x550722(0x6e)}),_0x3e5168=0x0;const _0x494c59=_0x1f1c19[_0x550722(0x86)][_0x550722(0xd2)](_0x141dad=>{var _0x561ab6=_0x550722;_0x141dad['product_name']==_0x281dd4['product_name']&&_0x141dad['floorlevel']==_0x281dd4['to_floorlevel']&&_0x141dad[_0x561ab6(0xec)]==_0x281dd4[_0x561ab6(0x137)]&&_0x141dad[_0x561ab6(0x7a)]==_0x281dd4[_0x561ab6(0xb8)]&&_0x141dad['bay']==_0x281dd4['to_bay']&&_0x141dad[_0x561ab6(0x7b)]==_0x281dd4[_0x561ab6(0x7b)]&&_0x141dad[_0x561ab6(0x7d)]==_0x281dd4['storage']&&_0x141dad['expiry_date']==_0x281dd4[_0x561ab6(0x13f)]&&_0x141dad['batch_code']==_0x281dd4[_0x561ab6(0x124)]&&_0x141dad['production_date']==_0x281dd4['production_date']&&_0x141dad[_0x561ab6(0x117)]==_0x281dd4[_0x561ab6(0xa8)]&&(_0x141dad['product_stock']=_0x141dad[_0x561ab6(0x146)]+_0x281dd4[_0x561ab6(0xa4)],_0x3e5168++);});_0x3e5168=='0'&&(_0x1f1c19[_0x550722(0x86)]=_0x1f1c19[_0x550722(0x86)][_0x550722(0x128)]({'product_name':_0x281dd4[_0x550722(0xac)],'product_stock':_0x281dd4[_0x550722(0xa4)],'bay':_0x281dd4['to_bay'],'bin':_0x281dd4['to_bin'],'type':_0x281dd4['to_types'],'floorlevel':_0x281dd4[_0x550722(0xb3)],'storage':_0x281dd4[_0x550722(0x7d)],'rack':_0x281dd4[_0x550722(0x7b)],'product_code':_0x281dd4[_0x550722(0x13a)],'primary_code':_0x281dd4[_0x550722(0x11e)],'secondary_code':_0x281dd4[_0x550722(0x12d)],'maxProducts':_0x281dd4[_0x550722(0xd8)],'storage':_0x281dd4[_0x550722(0x7d)],'rack':_0x281dd4[_0x550722(0x7b)],'expiry_date':_0x281dd4[_0x550722(0x13f)],'maxPerUnit':_0x281dd4['maxperunit'],'batch_code':_0x281dd4[_0x550722(0x124)],'production_date':_0x281dd4['production_date']}));}return _0x1f1c19;});Promise[_0x4de9f2(0x89)](_0x54aff1)[_0x4de9f2(0xb4)](async _0x4d0448=>{var _0x489877=_0x4de9f2;try{for(const _0x3c92f8 of _0x4d0448){await warehouse[_0x489877(0xb6)]({'_id':_0x3c92f8[_0x489877(0x14b)]},{'$addToSet':{'product_details':{'$each':_0x3c92f8[_0x489877(0x86)]}}});}_0x4f6f29[_0x489877(0xe1)]='True';const _0xf0fc2=await _0x4f6f29['save'](),_0x2eaed9=await master_shop[_0x489877(0x98)](),_0x4195a8=await email_settings['findOne'](),_0xa6ba8b=await supervisor_settings[_0x489877(0x98)]();var _0x2535b6=_0x4f6f29[_0x489877(0x139)],_0x36e65c='',_0x775e67;for(_0x775e67 in _0x2535b6){_0x36e65c+='<tr>'+_0x489877(0x147)+_0x2535b6[_0x775e67][_0x489877(0xac)]+_0x489877(0x6d)+_0x489877(0x147)+_0x2535b6[_0x775e67][_0x489877(0x13a)]+_0x489877(0x6d)+_0x489877(0x147)+_0x2535b6[_0x775e67][_0x489877(0xa4)]+_0x489877(0x6d)+_0x489877(0x147)+_0x2535b6[_0x775e67]['unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2535b6[_0x775e67][_0x489877(0x82)]+'</td>'+_0x489877(0x147)+_0x4f6f29[_0x489877(0x130)]+_0x489877(0x6d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2535b6[_0x775e67][_0x489877(0x65)]+_0x489877(0x6d)+_0x489877(0x147)+_0x2535b6[_0x775e67][_0x489877(0x7d)]+_0x2535b6[_0x775e67][_0x489877(0x7b)]+_0x2535b6[_0x775e67][_0x489877(0x8d)]+_0x2535b6[_0x775e67]['to_bin']+_0x2535b6[_0x775e67][_0x489877(0x137)][0x0]+_0x2535b6[_0x775e67][_0x489877(0xb3)]+_0x489877(0x6d),'</tr>';}let _0x142954=nodemailer['createTransport']({'host':_0x4195a8['host'],'port':Number(_0x4195a8['port']),'secure':![],'auth':{'user':_0x4195a8[_0x489877(0x148)],'pass':_0x4195a8['password']}}),_0x2c77a4={'from':_0x4195a8[_0x489877(0x148)],'to':_0xa6ba8b[0x0][_0x489877(0xd0)],'subject':_0x489877(0xa9),'attachments':[{'filename':_0x489877(0xf2),'path':__dirname+_0x489877(0xe6)+'/upload/'+_0x2eaed9[0x0]['image'],'cid':'logo'}],'html':_0x489877(0x10b)+_0x489877(0xc6)+'</head><body>'+_0x489877(0x77)+_0x489877(0x85)+_0x489877(0x77)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x489877(0x11a)+_0x489877(0x77)+_0x489877(0x102)+_0x2eaed9[0x0][_0x489877(0xbc)]+_0x489877(0xfc)+_0x489877(0x11a)+'</div>'+_0x489877(0xb5)+_0x489877(0x77)+_0x489877(0x9f)+'\x20Order\x20Number\x20:\x20'+_0x4f6f29[_0x489877(0x117)]+'\x20'+_0x489877(0x14f)+'\x20Order\x20Date\x20:\x20'+_0x4f6f29[_0x489877(0xa3)]+'\x20'+'</span>'+_0x489877(0xd5)+_0x489877(0x11a)+_0x489877(0x113)+_0x489877(0xda)+'<tr>'+_0x489877(0x7e)+_0x489877(0x12b)+_0x489877(0x9c)+_0x489877(0x6a)+_0x489877(0xe7)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x489877(0x104)+_0x489877(0x13e)+_0x489877(0x142)+'</thead>'+_0x489877(0x68)+'\x20'+_0x36e65c+'\x20'+'</tbody>'+_0x489877(0x73)+_0x489877(0x77)+_0x489877(0x132)+_0x489877(0xbf)+_0x2eaed9[0x0][_0x489877(0xbc)]+_0x489877(0xd5)+'</div>'+'</div>'+_0x489877(0xc9)};_0x142954['sendMail'](_0x2c77a4,function(_0x4e6f5f,_0x500e7d){var _0x475319=_0x489877;_0x4e6f5f?(console[_0x475319(0x8c)](_0x4e6f5f),console[_0x475319(0x8c)](_0x475319(0x114))):console[_0x475319(0x8c)](_0x475319(0x6f));}),_0xf6756e[_0x489877(0x8b)](_0x489877(0xa2),_0x489877(0x140)),_0x3fcf68[_0x489877(0xd3)](_0x489877(0xae)+_0xf0fc2[_0x489877(0x14b)]);}catch(_0x3aacc7){console['error'](_0x3aacc7),_0x3fcf68[_0x489877(0xe5)](0x1f4)[_0x489877(0xaa)]({'Perror':_0x489877(0x87),'message':_0x3aacc7[_0x489877(0x96)]});}})[_0x4de9f2(0x150)](_0x26d301=>{var _0x49cfad=_0x4de9f2;console[_0x49cfad(0xf4)](_0x26d301),_0x3fcf68['status'](0x1f4)[_0x49cfad(0xaa)]({'Perror':_0x49cfad(0xad)});});}catch(_0x3577b5){_0x3fcf68['json'](_0x3577b5);}}catch(_0x592623){console[_0x4de9f2(0xf4)](_0x592623),_0x3fcf68[_0x4de9f2(0xe5)](0x1f4)['json']({'Merror':_0x4de9f2(0x87),'Message':_0x592623[_0x4de9f2(0x96)]});}})[_0x1d70bc(0x150)](_0x4f3bc1=>{var _0x1ce89b=_0x1d70bc;console[_0x1ce89b(0xf4)](_0x4f3bc1),_0x3fcf68['status'](0x1f4)[_0x1ce89b(0xaa)]({'Merror':_0x1ce89b(0xad)});});}catch(_0x2782d8){console[_0x1d70bc(0x8c)](_0x2782d8);}});function BayBinSelected(_0x4d686b,_0x56add2){var _0x3cabe5=a0_0x264cb7,_0x47141e=[],_0x1d68a3=[],_0x32f35b=[],_0x2aa72d=[],_0x249bd5=[],_0x14264e=[];let _0x369e83=[];if(_0x4d686b==_0x3cabe5(0x9e))switch(_0x56add2){case _0x3cabe5(0xcb):_0x47141e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x1d68a3=[0x1,0x2],_0x2aa72d=[0x1,0x2,0x3,0x4,0x5],_0x32f35b=[_0x3cabe5(0xca),_0x3cabe5(0xb7)],_0x249bd5=['D'],_0x14264e=['A'];break;case'Rack\x20B':_0x47141e=[0x6,0x5,0x4,0x3,0x2,0x1],_0x1d68a3=[0x1,0x2],_0x2aa72d=[0x1,0x2,0x3,0x4,0x5],_0x32f35b=[_0x3cabe5(0xca),_0x3cabe5(0xb7)],_0x249bd5=['D'],_0x14264e=['B'];break;case _0x3cabe5(0x10f):_0x47141e=[0x0],_0x1d68a3=[0x0],_0x2aa72d=[0x1,0x2,0x3,0x4,0x5],_0x32f35b=['Floor'],_0x249bd5=['D'],_0x14264e=['S'];break;case'Receiving\x20Area':_0x47141e=[0x0],_0x1d68a3=[0x0],_0x2aa72d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x32f35b=[_0x3cabe5(0xb7)],_0x249bd5=['D'],_0x14264e=['R'];break;}else{if(_0x4d686b==_0x3cabe5(0xea))switch(_0x56add2){case'Rack\x20A':_0x47141e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x1d68a3=['B','F'],_0x2aa72d=[0x1,0x2,0x3,0x4,0x5],_0x32f35b=[_0x3cabe5(0xca),_0x3cabe5(0xb7)],_0x249bd5=['C'],_0x14264e=['A'];break;case'Rack\x20B':_0x47141e=[0x5,0x4,0x3,0x2,0x1],_0x1d68a3=['F','B','S'],_0x2aa72d=[0x1,0x2,0x3,0x4,0x5],_0x32f35b=[_0x3cabe5(0xca),'Floor'],_0x249bd5=['C'],_0x14264e=['B'];break;case _0x3cabe5(0xf5):_0x47141e=[0x1,0x2,0x3,0x4,0x5],_0x1d68a3=['B','F','S'],_0x2aa72d=[0x5,0x4,0x3,0x2,0x1],_0x32f35b=['Level',_0x3cabe5(0xb7)],_0x249bd5=['C'],_0x14264e=['C'];break;case'Rack\x20D':_0x47141e=[0x5,0x4,0x3,0x2,0x1],_0x1d68a3=['F','B','S'],_0x2aa72d=[0x1,0x2,0x3,0x4,0x5],_0x32f35b=[_0x3cabe5(0xca),_0x3cabe5(0xb7)],_0x249bd5=['C'],_0x14264e=['D'];break;case _0x3cabe5(0xcf):_0x47141e=[0x4,0x3,0x2,0x1],_0x1d68a3=[0x1,0x2],_0x2aa72d=[0x1,0x2,0x3,0x4,0x5],_0x32f35b=['Level','Floor'],_0x249bd5=['C'],_0x14264e=['E'];break;case _0x3cabe5(0xd6):_0x47141e=[0x1,0x2,0x3],_0x1d68a3=[0x1,0x2],_0x2aa72d=[0x1,0x2,0x3,0x4,0x5],_0x32f35b=['Level'],_0x249bd5=['C'],_0x14264e=['F'];break;}}return{'levels':_0x47141e,'Isle':_0x1d68a3,'rack':_0x2aa72d,'type':_0x32f35b,'storage':_0x249bd5,'rak':_0x14264e};}router[a0_0x264cb7(0xcd)](a0_0x264cb7(0xb9),auth,async(_0x2710da,_0x550955)=>{var _0x52fa79=a0_0x264cb7;try{const {username:_0xffdf24,email:_0x5efd9d,role:_0x4e6cf8}=_0x2710da[_0x52fa79(0xc4)],_0x2f55a1=_0x2710da['user'],_0xb3203c=await profile[_0x52fa79(0x88)]({'email':_0x2f55a1[_0x52fa79(0x148)]}),_0x41a401=await master_shop[_0x52fa79(0x98)](),_0x2531cd=await transfers[_0x52fa79(0x138)](_0x2710da[_0x52fa79(0x64)]['id']);let _0x9f7455;if(_0x2f55a1[_0x52fa79(0xc7)]==_0x52fa79(0x12a)){const _0x33109a=await staff['findOne']({'email':_0x2f55a1[_0x52fa79(0x148)]});_0x9f7455=await warehouse[_0x52fa79(0x145)]([{'$match':{'status':_0x52fa79(0x129),'name':_0x33109a['warehouse'],'warehouse_category':_0x52fa79(0x6e)}},{'$group':{'_id':_0x52fa79(0x126),'name':{'$first':_0x52fa79(0x126)}}}]);}else _0x9f7455=await warehouse['aggregate']([{'$match':{'status':_0x52fa79(0x129),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x52fa79(0x126)}}}]);const _0x529a7c=await warehouse[_0x52fa79(0x145)]([{'$match':{'name':_0x2531cd[_0x52fa79(0xfd)],'warehouse_category':_0x52fa79(0x6e)}},{'$unwind':_0x52fa79(0xc5)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x52fa79(0xb0)},'product_stock':{'$first':_0x52fa79(0x136)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x52fa79(0x8e)},'type':{'$first':_0x52fa79(0xfb)},'floorlevel':{'$first':_0x52fa79(0xe8)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x52fa79(0xef)},'storage':{'$first':_0x52fa79(0xf9)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x52fa79(0x141)},'production_date':{'$first':_0x52fa79(0x79)},'room':{'$first':_0x52fa79(0x70)}}}]),_0x187822=await product['find']({}),_0x1eced9=BayBinSelected(_0x2531cd[_0x52fa79(0x130)],_0x2531cd[_0x52fa79(0xf3)]);if(_0x41a401[0x0][_0x52fa79(0x90)]=='English\x20(US)'){var _0xb04dda=users[_0x52fa79(0xc0)];console[_0x52fa79(0x8c)](_0xb04dda);}else{if(_0x41a401[0x0]['language']==_0x52fa79(0xd1))var _0xb04dda=users[_0x52fa79(0xd1)];else{if(_0x41a401[0x0]['language']==_0x52fa79(0x75))var _0xb04dda=users[_0x52fa79(0x75)];else{if(_0x41a401[0x0][_0x52fa79(0x90)]==_0x52fa79(0xf8))var _0xb04dda=users['Spanish'];else{if(_0x41a401[0x0][_0x52fa79(0x90)]==_0x52fa79(0x122))var _0xb04dda=users[_0x52fa79(0x122)];else{if(_0x41a401[0x0]['language']==_0x52fa79(0x14c))var _0xb04dda=users[_0x52fa79(0x143)];else{if(_0x41a401[0x0][_0x52fa79(0x90)]==_0x52fa79(0x13b))var _0xb04dda=users[_0x52fa79(0x13b)];else{if(_0x41a401[0x0][_0x52fa79(0x90)]==_0x52fa79(0x12c))var _0xb04dda=users['Arabic'];}}}}}}}_0x550955['render']('edit_transfer',{'success':_0x2710da[_0x52fa79(0x8b)]('success'),'errors':_0x2710da['flash'](_0x52fa79(0x10e)),'role':_0x2f55a1,'profile':_0xb3203c,'master_shop':_0x41a401,'warehouse':_0x9f7455,'transfer':_0x2531cd,'stock':_0x529a7c,'unit':_0x187822,'language':_0xb04dda});}catch(_0x1febeb){console['log'](_0x1febeb);}}),router[a0_0x264cb7(0xfa)](a0_0x264cb7(0xb9),auth,async(_0x4fb34e,_0x9780f7)=>{var _0x58d4de=a0_0x264cb7;try{const _0x545eaf=_0x4fb34e['params']['id'],_0x26d998=await transfers[_0x58d4de(0x138)](_0x545eaf);_0x9780f7[_0x58d4de(0xaa)](_0x4fb34e['body']);return;const {date:_0x3f3b8c,from_warehouse:_0x11a7eb,FromRoom_name:_0x1518f4,to_warehouse:_0x1a4a96,ToRoom_name:_0x53a1da,prod_name:_0x5c9629,from_prod_qty:_0x4829b3,from_prod_level:_0x2f0ea0,from_prod_isle:_0x51499f,from_prod_pallet:_0x2fd335,to_prod_qty:_0x531f4b,to_prod_level:_0x15ad53,to_prod_isle:_0x32eba2,to_prod_pallet:_0x5e9071,primary_code:_0x570c2c,secondary_code:_0x5f3847,product_code3:_0x1d7d78,note:_0x710b29,invoice:_0x3aa5cb,expiry_date:_0x23c031}=_0x4fb34e[_0x58d4de(0x9d)];if(typeof _0x5c9629==_0x58d4de(0x6c))var _0x3255d2=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xc2)]],_0xbb3e50=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xfe)]],_0x539034=[_0x4fb34e[_0x58d4de(0x9d)]['from_prod_level']],_0x20be93=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xc3)]],_0x535641=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x80)]],_0x1436ba=[_0x4fb34e['body'][_0x58d4de(0x112)]],_0x1b9417=[_0x4fb34e[_0x58d4de(0x9d)]['to_prod_qty']],_0x48554d=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xa0)]],_0x55ea06=[_0x4fb34e['body'][_0x58d4de(0xf7)]],_0x2cd850=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x9b)]],_0x32f227=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x137)]],_0x5ac8b5=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x7d)]],_0x5bedcb=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xd9)]],_0x54fb61=[_0x4fb34e[_0x58d4de(0x9d)]['primary_code']],_0x120775=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x12d)]],_0xb41014=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x133)]],_0x14d803=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xaf)]],_0x5788d5=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x134)]],_0x99c507=[_0x4fb34e['body'][_0x58d4de(0x82)]],_0x566291=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x124)]],_0x2ab2df=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x13f)]],_0xfedd75=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x7c)]],_0x296509=[_0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xe9)]];else var _0x3255d2=[..._0x4fb34e['body'][_0x58d4de(0xc2)]],_0x5ac8b5=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x7d)]],_0x5bedcb=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xd9)]],_0x1436ba=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x112)]],_0x32f227=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x137)]],_0xbb3e50=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xfe)]],_0x539034=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x120)]],_0x20be93=[..._0x4fb34e['body'][_0x58d4de(0xc3)]],_0x535641=[..._0x4fb34e['body'][_0x58d4de(0x80)]],_0x1b9417=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x78)]],_0x48554d=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xa0)]],_0x55ea06=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xf7)]],_0x2cd850=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x9b)]],_0x54fb61=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x11e)]],_0x120775=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x12d)]],_0xb41014=[..._0x4fb34e[_0x58d4de(0x9d)]['product_code3']],_0x14d803=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xaf)]],_0x5788d5=[..._0x4fb34e[_0x58d4de(0x9d)]['unit']],_0x99c507=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x82)]],_0x566291=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x124)]],_0x2ab2df=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x13f)]],_0xfedd75=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0x7c)]],_0x296509=[..._0x4fb34e[_0x58d4de(0x9d)][_0x58d4de(0xe9)]];const _0x4481ec=_0x3255d2[_0x58d4de(0xd2)](_0x3f9530=>{return _0x3f9530={'product_name':_0x3f9530};});_0xbb3e50[_0x58d4de(0x12f)]((_0x38e7e2,_0x2ebb48)=>{var _0x401f7c=_0x58d4de;_0x4481ec[_0x2ebb48][_0x401f7c(0x11c)]=_0x38e7e2;}),_0x539034[_0x58d4de(0x12f)]((_0x48d924,_0x3e351a)=>{var _0xbf611b=_0x58d4de;_0x4481ec[_0x3e351a][_0xbf611b(0x12e)]=_0x48d924;}),_0x20be93['forEach']((_0xc25056,_0x29eb82)=>{var _0x25c88b=_0x58d4de;_0x4481ec[_0x29eb82][_0x25c88b(0xed)]=_0xc25056;}),_0x535641[_0x58d4de(0x12f)]((_0x41182c,_0x5240c5)=>{var _0x58551e=_0x58d4de;_0x4481ec[_0x5240c5][_0x58551e(0xd4)]=_0x41182c;}),_0x1b9417[_0x58d4de(0x12f)]((_0x3d647a,_0x491b71)=>{var _0x1c2318=_0x58d4de;_0x4481ec[_0x491b71][_0x1c2318(0xa4)]=_0x3d647a;}),_0x48554d[_0x58d4de(0x12f)]((_0x3805c6,_0x5c4896)=>{var _0xe3d83b=_0x58d4de;_0x4481ec[_0x5c4896][_0xe3d83b(0x8d)]=_0x3805c6;}),_0x55ea06[_0x58d4de(0x12f)]((_0x412564,_0x173b6f)=>{var _0xbbfdc0=_0x58d4de;_0x4481ec[_0x173b6f][_0xbbfdc0(0xb8)]=_0x412564;}),_0x2cd850['forEach']((_0xdb8b65,_0x177583)=>{_0x4481ec[_0x177583]['to_floorlevel']=_0xdb8b65;}),_0x54fb61['forEach']((_0x3c22f5,_0x197bb6)=>{_0x4481ec[_0x197bb6]['primary_code']=_0x3c22f5;}),_0x120775[_0x58d4de(0x12f)]((_0xd8b9a0,_0x1ea32a)=>{var _0x497936=_0x58d4de;_0x4481ec[_0x1ea32a][_0x497936(0x12d)]=_0xd8b9a0;}),_0xb41014[_0x58d4de(0x12f)]((_0x237876,_0x4f976f)=>{var _0x2f781e=_0x58d4de;_0x4481ec[_0x4f976f][_0x2f781e(0x13a)]=_0x237876;}),_0x14d803[_0x58d4de(0x12f)]((_0x5c1538,_0x5969fa)=>{var _0x2ae029=_0x58d4de;_0x4481ec[_0x5969fa][_0x2ae029(0xd8)]=_0x5c1538;}),_0x5788d5[_0x58d4de(0x12f)]((_0x2f5224,_0x561ce4)=>{_0x4481ec[_0x561ce4]['unit']=_0x2f5224;}),_0x99c507[_0x58d4de(0x12f)]((_0x5c12f6,_0x35f6f7)=>{var _0x5c8277=_0x58d4de;_0x4481ec[_0x35f6f7][_0x5c8277(0x82)]=_0x5c12f6;}),_0x566291[_0x58d4de(0x12f)]((_0x459f9b,_0x4b4493)=>{_0x4481ec[_0x4b4493]['batch_code']=_0x459f9b;}),_0x2ab2df[_0x58d4de(0x12f)]((_0x8d874b,_0x499dda)=>{var _0x3cf636=_0x58d4de;_0x4481ec[_0x499dda][_0x3cf636(0x13f)]=_0x8d874b;}),_0x5ac8b5[_0x58d4de(0x12f)]((_0x9ee670,_0x4246c5)=>{_0x4481ec[_0x4246c5]['storage']=_0x9ee670;}),_0x5bedcb['forEach']((_0x35ea9e,_0x516f9a)=>{var _0x4e8767=_0x58d4de;_0x4481ec[_0x516f9a][_0x4e8767(0x7b)]=_0x35ea9e;}),_0x1436ba[_0x58d4de(0x12f)]((_0xbe4599,_0x521975)=>{var _0x32cc05=_0x58d4de;_0x4481ec[_0x521975][_0x32cc05(0x112)]=_0xbe4599;}),_0x32f227[_0x58d4de(0x12f)]((_0x175dee,_0x15d71d)=>{var _0x37ec4d=_0x58d4de;_0x4481ec[_0x15d71d][_0x37ec4d(0x137)]=_0x175dee;}),_0xfedd75[_0x58d4de(0x12f)]((_0x13a2cf,_0x3bf59a)=>{var _0x5f2361=_0x58d4de;_0x4481ec[_0x3bf59a][_0x5f2361(0x7c)]=_0x13a2cf;}),_0x296509[_0x58d4de(0x12f)]((_0x4dd3fa,_0x27ba7a)=>{var _0x59f62a=_0x58d4de;_0x4481ec[_0x27ba7a][_0x59f62a(0xa6)]=_0x4dd3fa;});const _0x3e1ab5=_0x4481ec['filter'](_0x222ee2=>_0x222ee2['to_quantity']!=='0'&&_0x222ee2['to_quantity']!==''||_0x222ee2[_0x58d4de(0xb3)]!=='0'&&_0x222ee2[_0x58d4de(0xb3)]!=='');var _0x135b3d=0x0;_0x3e1ab5[_0x58d4de(0x12f)](_0x16ac2d=>{var _0x4a3296=_0x58d4de;parseInt(_0x16ac2d['from_quantity'])<parseInt(_0x16ac2d[_0x4a3296(0xa4)])&&_0x135b3d++;});if(_0x135b3d!=0x0)return _0x4fb34e[_0x58d4de(0x8b)](_0x58d4de(0x10e),_0x58d4de(0x11d)),_0x9780f7[_0x58d4de(0xd3)]('back');const _0x4aa5c8=await warehouse[_0x58d4de(0x88)]({'name':_0x26d998['from_warehouse'],'room':_0x26d998[_0x58d4de(0xce)]});_0x26d998[_0x58d4de(0x139)][_0x58d4de(0x12f)](_0xdfd802=>{var _0x17730f=_0x58d4de;if(_0xdfd802['to_quantity']>0x0){const _0x1b560c=_0x4aa5c8[_0x17730f(0x86)][_0x17730f(0xd2)](_0x47e01c=>{var _0x37514b=_0x17730f;_0x47e01c['product_name']==_0xdfd802['product_name']&&_0x47e01c[_0x37514b(0x8a)]==_0xdfd802[_0x37514b(0xd4)]&&_0x47e01c[_0x37514b(0xec)]==_0xdfd802[_0x37514b(0x112)]&&_0x47e01c[_0x37514b(0x7a)]==_0xdfd802[_0x37514b(0xed)]&&_0x47e01c['bay']==_0xdfd802[_0x37514b(0x12e)]&&_0x47e01c[_0x37514b(0x7b)]==_0xdfd802['from_rack']&&_0x47e01c[_0x37514b(0x7d)]==_0xdfd802[_0x37514b(0x7c)]&&(_0x47e01c[_0x37514b(0x146)]=parseInt(_0x47e01c[_0x37514b(0x146)])+parseInt(_0xdfd802[_0x37514b(0xa4)]));});}}),await _0x4aa5c8[_0x58d4de(0xf6)]();const _0x14bbab=await warehouse[_0x58d4de(0x88)]({'name':_0x26d998[_0x58d4de(0x130)],'room':_0x26d998['to_room']});_0x26d998[_0x58d4de(0x139)][_0x58d4de(0x12f)](_0x10d813=>{var _0x102444=_0x58d4de;if(_0x10d813[_0x102444(0xa4)]>0x0){const _0x3d1aa1=_0x14bbab[_0x102444(0x86)][_0x102444(0xd2)](_0x5ac8bc=>{var _0x481b5e=_0x102444;_0x5ac8bc[_0x481b5e(0xac)]==_0x10d813[_0x481b5e(0xac)]&&_0x5ac8bc[_0x481b5e(0x8a)]==_0x10d813['to_floorlevel']&&_0x5ac8bc[_0x481b5e(0xec)]==_0x10d813['to_types']&&_0x5ac8bc[_0x481b5e(0x7a)]==_0x10d813[_0x481b5e(0xb8)]&&_0x5ac8bc['bay']==_0x10d813['to_bay']&&_0x5ac8bc[_0x481b5e(0x7b)]==_0x10d813[_0x481b5e(0x7b)]&&_0x5ac8bc['storage']==_0x10d813[_0x481b5e(0x7d)]&&(_0x5ac8bc[_0x481b5e(0x146)]=parseInt(_0x5ac8bc['product_stock'])-parseInt(_0x10d813[_0x481b5e(0xa4)]));});}}),await _0x14bbab[_0x58d4de(0xf6)](),_0x26d998['date']=_0x3f3b8c,_0x26d998[_0x58d4de(0xfd)]=_0x11a7eb,_0x26d998[_0x58d4de(0x130)]=_0x1a4a96,_0x26d998['product']=_0x3e1ab5,_0x26d998['note']=_0x710b29,_0x26d998[_0x58d4de(0x117)]=_0x3aa5cb;const _0xcf06a5=await _0x26d998[_0x58d4de(0xf6)]();console['log'](_0xcf06a5);const _0x32883d=await warehouse[_0x58d4de(0x88)]({'name':_0x11a7eb,'room':_0x1518f4});_0xcf06a5['product'][_0x58d4de(0x12f)](_0x1365dd=>{var _0x52189f=_0x58d4de;if(_0x1365dd[_0x52189f(0xa4)]>0x0){const _0x27bfc7=_0x32883d[_0x52189f(0x86)][_0x52189f(0xd2)](_0x5e8fab=>{var _0x3ced43=_0x52189f;_0x5e8fab['product_name']==_0x1365dd['product_name']&&_0x5e8fab[_0x3ced43(0x8a)]==_0x1365dd[_0x3ced43(0xd4)]&&_0x5e8fab[_0x3ced43(0xec)]==_0x1365dd['from_types']&&_0x5e8fab[_0x3ced43(0x7a)]==_0x1365dd['from_bin']&&_0x5e8fab[_0x3ced43(0xab)]==_0x1365dd['from_bay']&&_0x5e8fab['rack']==_0x1365dd[_0x3ced43(0xa6)]&&_0x5e8fab['storage']==_0x1365dd[_0x3ced43(0x7c)]&&(_0x5e8fab['product_stock']=parseInt(_0x5e8fab[_0x3ced43(0x146)])-parseInt(_0x1365dd[_0x3ced43(0xa4)]));});}}),await _0x32883d[_0x58d4de(0xf6)]();const _0x2cc6ea=await warehouse['findOne']({'name':_0x1a4a96,'room':_0x53a1da});_0xcf06a5[_0x58d4de(0x139)][_0x58d4de(0x12f)](_0x32a09b=>{var _0x561a1b=_0x58d4de;if(_0x32a09b[_0x561a1b(0xa4)]>0x0){var _0x3809cb=0x0;const _0xff6ad2=_0x2cc6ea['product_details'][_0x561a1b(0xd2)](_0x5d711e=>{var _0x4e4f1e=_0x561a1b;_0x5d711e[_0x4e4f1e(0xac)]==_0x32a09b[_0x4e4f1e(0xac)]&&_0x5d711e[_0x4e4f1e(0x8a)]==_0x32a09b[_0x4e4f1e(0xb3)]&&_0x5d711e[_0x4e4f1e(0xec)]==_0x32a09b[_0x4e4f1e(0x137)]&&_0x5d711e[_0x4e4f1e(0x7a)]==_0x32a09b[_0x4e4f1e(0xb8)]&&_0x5d711e[_0x4e4f1e(0xab)]==_0x32a09b[_0x4e4f1e(0x8d)]&&_0x5d711e[_0x4e4f1e(0x7b)]==_0x32a09b['rack']&&_0x5d711e[_0x4e4f1e(0x7d)]==_0x32a09b[_0x4e4f1e(0x7d)]&&(_0x5d711e[_0x4e4f1e(0x146)]=parseInt(_0x5d711e[_0x4e4f1e(0x146)])+parseInt(_0x32a09b[_0x4e4f1e(0xa4)]),_0x3809cb++);});_0x3809cb=='0'&&(_0x2cc6ea[_0x561a1b(0x86)]=_0x2cc6ea[_0x561a1b(0x86)]['concat']({'product_name':_0x32a09b[_0x561a1b(0xac)],'product_stock':_0x32a09b[_0x561a1b(0xa4)],'bay':_0x32a09b[_0x561a1b(0x8d)],'bin':_0x32a09b[_0x561a1b(0xb8)],'type':_0x32a09b['to_types'],'floorlevel':_0x32a09b[_0x561a1b(0xb3)],'storage':_0x32a09b[_0x561a1b(0x7d)],'rack':_0x32a09b[_0x561a1b(0x7b)],'product_code':_0x32a09b[_0x561a1b(0x13a)],'primary_code':_0x32a09b[_0x561a1b(0x11e)],'secondary_code':_0x32a09b['secondary_code'],'maxProducts':_0x32a09b['maxProducts'],'storage':_0x32a09b[_0x561a1b(0x7d)],'rack':_0x32a09b[_0x561a1b(0x7b)]}));}}),await _0x2cc6ea[_0x58d4de(0xf6)](),_0x4fb34e[_0x58d4de(0x8b)](_0x58d4de(0xa2),_0x58d4de(0x72)),_0x9780f7[_0x58d4de(0xd3)](_0x58d4de(0x111));}catch(_0x48d7e0){console[_0x58d4de(0x8c)](_0x48d7e0);}}),router[a0_0x264cb7(0xfa)](a0_0x264cb7(0xf0),async(_0x12c3f,_0x22feb2)=>{var _0xca0152=a0_0x264cb7;const {FromWareHouse:_0x57ced7,FromRoom:_0x3bcac0,ToWarehouse:_0xc70e0b,ToRoom:_0x2749b6,primary_code:_0x45438e,Roomslist:_0x4d5424}=_0x12c3f[_0xca0152(0x9d)],_0x1c0f29=_0x4d5424[_0xca0152(0x74)](','),_0x2d2f12=[];async function _0x1d74c0(_0x1a0859){var _0x4a2b8d=_0xca0152;const _0x3703b7=await warehouse['aggregate']([{'$match':{'name':_0x57ced7,'room':_0x1a0859}},{'$unwind':_0x4a2b8d(0xc5)},{'$match':{'product_details.primary_code':_0x45438e}},{'$group':{'_id':_0x4a2b8d(0x9a),'name':{'$first':_0x4a2b8d(0xb0)},'instock':{'$first':_0x4a2b8d(0x136)},'primary_code':{'$first':_0x4a2b8d(0xd7)},'secondary_code':{'$first':_0x4a2b8d(0x14e)},'product_code':{'$first':_0x4a2b8d(0xef)},'level':{'$first':_0x4a2b8d(0x97)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x4a2b8d(0xe8)},'unit':{'$first':_0x4a2b8d(0x149)},'secondary_unit':{'$first':_0x4a2b8d(0x127)},'storage':{'$first':_0x4a2b8d(0xf9)},'rack':{'$first':_0x4a2b8d(0x10c)},'expiry_date':{'$first':_0x4a2b8d(0x141)},'production_date':{'$first':_0x4a2b8d(0x79)},'batch_code':{'$first':_0x4a2b8d(0x11b)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x4a2b8d(0x70)},'maxProducts':{'$first':_0x4a2b8d(0xbb)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x409af1=await warehouse[_0x4a2b8d(0x145)]([{'$match':{'name':_0x57ced7,'room':_0x1a0859}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x45438e}},{'$group':{'_id':_0x4a2b8d(0x9a),'name':{'$first':_0x4a2b8d(0xb0)},'instock':{'$first':_0x4a2b8d(0x136)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4a2b8d(0xef)},'level':{'$first':_0x4a2b8d(0x97)},'isle':{'$first':_0x4a2b8d(0x8e)},'type':{'$first':_0x4a2b8d(0xfb)},'pallet':{'$first':_0x4a2b8d(0xe8)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4a2b8d(0x127)},'storage':{'$first':_0x4a2b8d(0xf9)},'rack':{'$first':_0x4a2b8d(0x10c)},'expiry_date':{'$first':_0x4a2b8d(0x141)},'production_date':{'$first':_0x4a2b8d(0x79)},'batch_code':{'$first':_0x4a2b8d(0x11b)},'maxPerUnit':{'$first':_0x4a2b8d(0x107)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x4a2b8d(0xbb)},'invoice_product':{'$first':_0x4a2b8d(0x105)}}}]);if(_0x3703b7[_0x4a2b8d(0x110)]>0x0)_0x2d2f12[_0x4a2b8d(0x116)](_0x3703b7);else _0x409af1['length']>0x0&&_0x2d2f12[_0x4a2b8d(0x116)](_0x409af1);}const _0x2c67d8=_0x1c0f29[_0xca0152(0xd2)](_0xf2a10f=>_0x1d74c0(_0xf2a10f));await Promise[_0xca0152(0x89)](_0x2c67d8),_0x22feb2['json'](_0x2d2f12);}),router[a0_0x264cb7(0xfa)](a0_0x264cb7(0x13c),async(_0x5465e5,_0x34d239)=>{var _0x54e179=a0_0x264cb7;try{const {FromWareHouse:_0xbe917,FromRoom:_0x2353d9,ToWarehouse:_0x3b5a6b,ToRoom:_0x851748,secondary_code:_0x2292ca}=_0x5465e5[_0x54e179(0x9d)],_0x380e22=await warehouse[_0x54e179(0x145)]([{'$match':{'name':_0xbe917}},{'$unwind':_0x54e179(0xc5)},{'$match':{'product_details.secondary_code':_0x2292ca}},{'$group':{'_id':_0x54e179(0x9a),'name':{'$first':_0x54e179(0xb0)},'primary_code':{'$first':_0x54e179(0xd7)},'secondary_code':{'$first':_0x54e179(0x14e)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x54e179(0x136)},'warehouse':{'$first':'$name'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x54e179(0x81)},'pallet':{'$first':_0x54e179(0xdb)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x54e179(0x149)}}}]);_0x34d239[_0x54e179(0xe5)](0xc8)[_0x54e179(0xaa)](_0x380e22);}catch(_0x488852){_0x34d239['status'](0x194)[_0x54e179(0xaa)]({'message':_0x488852['message']});}}),router[a0_0x264cb7(0xfa)](a0_0x264cb7(0x11f),async(_0x27640d,_0xa228b1)=>{var _0x2a1bad=a0_0x264cb7;try{const {FromWareHouse:_0x345ac0,FromRoom:_0x2081a0,ToWarehouse:_0x42e301,ToRoom:_0x17ab69,product_code:_0x369303}=_0x27640d[_0x2a1bad(0x9d)],_0x33ac3f=await warehouse[_0x2a1bad(0x145)]([{'$match':{'name':_0x345ac0}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x369303}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x2a1bad(0xd7)},'secondary_code':{'$first':_0x2a1bad(0x14e)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x2a1bad(0x136)},'warehouse':{'$first':_0x2a1bad(0x126)},'level':{'$first':_0x2a1bad(0xe4)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x2a1bad(0xdb)},'maxProducts':{'$first':_0x2a1bad(0xbb)},'unit':{'$first':'$product_details.unit'}}}]);_0xa228b1[_0x2a1bad(0xe5)](0xc8)[_0x2a1bad(0xaa)](_0x33ac3f);}catch(_0x213bda){_0xa228b1[_0x2a1bad(0xe5)](0x194)[_0x2a1bad(0xaa)]({'message':_0x213bda['message']});}}),router[a0_0x264cb7(0xfa)](a0_0x264cb7(0xba),async(_0x27caf2,_0x2aab04)=>{var _0x5b4140=a0_0x264cb7;const {level:_0x4d11bf,isle:_0x5f081e,pallet:_0x748961,warehouses:_0x293157,room:_0x131ceb}=_0x27caf2['body'];try{const _0x1c58ad=await warehouse[_0x5b4140(0x145)]([{'$match':{'name':_0x293157,'room':_0x131ceb}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x4d11bf),'product_details.isle':_0x5f081e,'product_details.pallet':parseInt(_0x748961)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5b4140(0x136)},'level':{'$first':_0x5b4140(0xe4)},'isle':{'$first':_0x5b4140(0x81)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2aab04['status'](0xc8)[_0x5b4140(0xaa)](_0x1c58ad);}catch(_0x1f83dd){_0x2aab04['status'](0x194)['json']({'message':_0x1f83dd['message']});}}),module['exports']=router;function a0_0x1b37(_0x552603,_0x4667a3){var _0x261ab3=a0_0x261a();return a0_0x1b37=function(_0x1b37bd,_0x244afe){_0x1b37bd=_0x1b37bd-0x64;var _0x43e721=_0x261ab3[_0x1b37bd];return _0x43e721;},a0_0x1b37(_0x552603,_0x4667a3);}function a0_0x261a(){var _0x20fb7f=['product_code','Chinese','/barcode_scanner2','ToRoomAssigned','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','expiry_date','Transfer\x20Finalize\x20Successfully','$product_details.expiry_date','</tr>','Portuguese','transfer','aggregate','product_stock','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','email','$product_details.unit','/view','_id','Portuguese\x20(BR)','Enclosed','$product_details.secondary_code','<span\x20style=\x22float:\x20right;\x22>','catch','params','to_room_name','$date','express','<tbody\x20style=\x22text-align:\x20center;\x22>','1513286JsYXPN','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','getDate','string','</td>','Raw\x20Materials','Email\x20sent\x20successfully','$room','getFullYear','Transfer\x20Edit\x20Successfully','</table>','split','German','Product\x20Transfer\x20successfully','<div>','to_prod_qty','$product_details.production_date','bin','rack','from_storage','storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','TRF-','from_prod_pallet','$product_details.isle','secondary_unit','Receiving\x20Area','render','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','product_details','An\x20error\x20occurred\x20while\x20saving\x20data.','findOne','all','floorlevel','flash','log','to_bay','$product_details.bin','$invoice','language','/view/add_transfer','filter','/transfer/preview/','primary_unit','add_transfer','message','$product_details.bay','find','id_transaction_id','$product_details._id','to_prod_pallet','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','body','DRY\x20STORAGE','<h5\x20style=\x22text-align:\x20left;\x22>','to_prod_level','floor','success','date','to_quantity','from_invoice','from_rack','6dyytAl','To_invoice','Transfer\x20Mail','json','bay','product_name','An\x20error\x20occurred.','/picking_list/PDF_transfer_rm/','MaxStocks_data2','$product_details.product_name','14202PaHGBp','$to_warehouse','to_floorlevel','then','<hr\x20class=\x22my-3\x22>','updateOne','Floor','to_bin','/view/:id','/CheckingWarehouse','$product_details.maxProducts','site_title','5188169tLHUTc','$_id','<h5>','English','$product.to_room_name','prod_name','from_prod_isle','user','$product_details','<html><head><title></title>','role','warehouse','</body></html>','Level','Rack\x20A','../public/language/languages.json','get','from_room','Rack\x20E','RMSEmail','Hindi','map','redirect','from_floorlevel','</h5>','Rack\x20F','$product_details.primary_code','maxProducts','rak','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.pallet','\x20<>\x20','42892doKKfb','There\x27s\x20a\x20error\x20in\x20this\x20transaction','here','330kCPida','finalize','110SuLyBZ','id_transaction','$product_details.level','status','/../public','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.floorlevel','from_rak','COLD\x20STORAGE','2272IKXlvo','type','from_bin','437916lJrWpD','$product_details.product_code','/barcode_scanner','production_date','Logo.png','to_room','error','Rack\x20C','save','to_prod_isle','Spanish','$product_details.storage','post','$product_details.type','\x20</h2>','from_warehouse','from_prod_qty','/preview/:id','$isAllowEdit','nodemailer','<h2>\x20','64658iwXgas','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.invoice','Return\x20Rooms','$product_details.maxPerUnit','max_per_unit','master','maxperunit','<!DOCTYPE\x20html>','$product_details.rack','prod_cat','errors','Shelves','length','/transfer/view','from_types','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Error\x20Occurs','Router','push','invoice','RoomAssigned','from_room_name','</div>','$product_details.batch_code','from_quantity','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','primary_code','/barcode_scanner3','from_prod_level','Arabic','French','English\x20(US)','batch_code','to_invoice','$name','$product_details.secondary_unit','concat','Enabled','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Arabic\x20(ae)','secondary_code','from_bay','forEach','to_warehouse','2267724ryeDvi','<strong>\x20Regards\x20</strong>','product_code3','unit','slice','$product_details.product_stock','to_types','findById','product'];a0_0x261a=function(){return _0x20fb7f;};return a0_0x261a();}