var a0_0x5b2f7a=a0_0x4b2b;(function(_0x598588,_0x554a79){var _0x3ac060=a0_0x4b2b,_0x13dfa8=_0x598588();while(!![]){try{var _0x11852c=-parseInt(_0x3ac060(0x1d2))/0x1*(parseInt(_0x3ac060(0x1e1))/0x2)+parseInt(_0x3ac060(0x17c))/0x3*(parseInt(_0x3ac060(0x184))/0x4)+-parseInt(_0x3ac060(0x17b))/0x5*(-parseInt(_0x3ac060(0x210))/0x6)+parseInt(_0x3ac060(0x207))/0x7+parseInt(_0x3ac060(0x194))/0x8+parseInt(_0x3ac060(0x191))/0x9+-parseInt(_0x3ac060(0x1bd))/0xa;if(_0x11852c===_0x554a79)break;else _0x13dfa8['push'](_0x13dfa8['shift']());}catch(_0x559378){_0x13dfa8['push'](_0x13dfa8['shift']());}}}(a0_0x4c94,0x9e69d));const express=require(a0_0x5b2f7a(0x1c5)),app=express(),router=express[a0_0x5b2f7a(0x20a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x5b2f7a(0x247)),auth=require(a0_0x5b2f7a(0x1c8)),users=require(a0_0x5b2f7a(0x1bc)),nodemailer=require(a0_0x5b2f7a(0x1e0));router[a0_0x5b2f7a(0x1f4)](a0_0x5b2f7a(0x16a),auth,async(_0x21c7f8,_0x85cf4e)=>{var _0x316c4b=a0_0x5b2f7a;try{const {username:_0x4020b6,email:_0x13828f,role:_0x52d1a7}=_0x21c7f8[_0x316c4b(0x21e)],_0x28e91d=_0x21c7f8[_0x316c4b(0x21e)],_0x56b245=await profile[_0x316c4b(0x1fc)]({'email':_0x28e91d[_0x316c4b(0x1e9)]}),_0x89c92b=await master_shop['find']();console[_0x316c4b(0x24a)]('master',_0x89c92b);let _0x10d774;if(_0x28e91d[_0x316c4b(0x1a0)]==_0x316c4b(0x19f)){const _0x463615=await staff['findOne']({'email':_0x28e91d[_0x316c4b(0x1e9)]});_0x10d774=await transfers['find']({'from_warehouse':_0x463615[_0x316c4b(0x226)]});}else _0x10d774=await transfers[_0x316c4b(0x1ce)]([{'$unwind':'$product'},{'$group':{'_id':_0x316c4b(0x192),'invoice':{'$first':'$invoice'},'date':{'$first':_0x316c4b(0x239)},'from_warehouse':{'$first':_0x316c4b(0x16c)},'to_warehouse':{'$first':_0x316c4b(0x240)},'from_room_name':{'$addToSet':_0x316c4b(0x214)},'to_room_name':{'$addToSet':_0x316c4b(0x1cb)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x316c4b(0x1a9)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x89c92b[0x0]['language']=='English\x20(US)'){var _0x22832e=users[_0x316c4b(0x21b)];console[_0x316c4b(0x24a)](_0x22832e);}else{if(_0x89c92b[0x0][_0x316c4b(0x183)]=='Hindi')var _0x22832e=users['Hindi'];else{if(_0x89c92b[0x0][_0x316c4b(0x183)]==_0x316c4b(0x211))var _0x22832e=users[_0x316c4b(0x211)];else{if(_0x89c92b[0x0][_0x316c4b(0x183)]==_0x316c4b(0x225))var _0x22832e=users['Spanish'];else{if(_0x89c92b[0x0][_0x316c4b(0x183)]==_0x316c4b(0x22f))var _0x22832e=users[_0x316c4b(0x22f)];else{if(_0x89c92b[0x0][_0x316c4b(0x183)]==_0x316c4b(0x1b9))var _0x22832e=users[_0x316c4b(0x1f5)];else{if(_0x89c92b[0x0][_0x316c4b(0x183)]==_0x316c4b(0x159))var _0x22832e=users[_0x316c4b(0x159)];else{if(_0x89c92b[0x0][_0x316c4b(0x183)]==_0x316c4b(0x203))var _0x22832e=users[_0x316c4b(0x245)];}}}}}}}_0x85cf4e['render'](_0x316c4b(0x181),{'success':_0x21c7f8[_0x316c4b(0x18f)](_0x316c4b(0x1ba)),'errors':_0x21c7f8[_0x316c4b(0x18f)](_0x316c4b(0x1c4)),'role':_0x28e91d,'profile':_0x56b245,'master_shop':_0x89c92b,'transfer':_0x10d774,'language':_0x22832e});}catch(_0xf66697){console['log'](_0xf66697);}});async function getRandom8DigitNumber(){var _0x2336c5=a0_0x5b2f7a;const _0x58d251=0x989680,_0x153db8=0x5f5e0ff,_0x1153e5=Math[_0x2336c5(0x170)](Math[_0x2336c5(0x1d5)]()*(_0x153db8-_0x58d251+0x1))+_0x58d251;var _0x3c9840;const _0x4d0f4c=await transfers[_0x2336c5(0x1fc)]({'invoice':'TRF-'+_0x1153e5});return _0x4d0f4c&&_0x4d0f4c['length']>0x0?_0x3c9840='TRF-'+_0x1153e5:_0x3c9840=_0x2336c5(0x1f2)+_0x1153e5,_0x3c9840;}function a0_0x4b2b(_0x16e6de,_0x1b44d0){var _0x4c9436=a0_0x4c94();return a0_0x4b2b=function(_0x4b2b82,_0x45894c){_0x4b2b82=_0x4b2b82-0x156;var _0x2a31fb=_0x4c9436[_0x4b2b82];return _0x2a31fb;},a0_0x4b2b(_0x16e6de,_0x1b44d0);}router[a0_0x5b2f7a(0x1f4)](a0_0x5b2f7a(0x1f6),auth,async(_0x2d0e9c,_0x1aa647)=>{var _0x24d52c=a0_0x5b2f7a;try{const {username:_0xbf3ed2,email:_0xdf0dfd,role:_0x1426cf}=_0x2d0e9c['user'],_0x5b77fc=_0x2d0e9c[_0x24d52c(0x21e)],_0x170791=await profile[_0x24d52c(0x1fc)]({'email':_0x5b77fc[_0x24d52c(0x1e9)]}),_0x303665=await master_shop[_0x24d52c(0x180)]();console[_0x24d52c(0x24a)](_0x24d52c(0x182),_0x303665);let _0x1f9aec;if(_0x5b77fc[_0x24d52c(0x1a0)]==_0x24d52c(0x19f)){const _0x4bf87e=await staff['findOne']({'email':_0x5b77fc[_0x24d52c(0x1e9)]});_0x1f9aec=await warehouse[_0x24d52c(0x1ce)]([{'$match':{'status':_0x24d52c(0x220),'name':_0x4bf87e[_0x24d52c(0x226)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x24d52c(0x158),'name':{'$first':'$name'}}}]);}else _0x1f9aec=await warehouse['aggregate']([{'$match':{'status':_0x24d52c(0x220),'warehouse_category':_0x24d52c(0x1b6)}},{'$group':{'_id':_0x24d52c(0x158),'name':{'$first':'$name'}}}]);var _0x382c1c=[_0x24d52c(0x17f),_0x24d52c(0x1c0),'Return\x20Rooms'];const _0x598d56=await transfers[_0x24d52c(0x180)]({}),_0x359374=_0x598d56[_0x24d52c(0x1a8)]+0x1,_0x2ee5bb=_0x24d52c(0x1f2)+_0x359374[_0x24d52c(0x206)]()[_0x24d52c(0x15d)](0x5,'0');if(_0x303665[0x0]['language']==_0x24d52c(0x162)){var _0xb2e27f=users['English'];console['log'](_0xb2e27f);}else{if(_0x303665[0x0][_0x24d52c(0x183)]==_0x24d52c(0x1dd))var _0xb2e27f=users[_0x24d52c(0x1dd)];else{if(_0x303665[0x0][_0x24d52c(0x183)]==_0x24d52c(0x211))var _0xb2e27f=users[_0x24d52c(0x211)];else{if(_0x303665[0x0][_0x24d52c(0x183)]==_0x24d52c(0x225))var _0xb2e27f=users[_0x24d52c(0x225)];else{if(_0x303665[0x0][_0x24d52c(0x183)]=='French')var _0xb2e27f=users['French'];else{if(_0x303665[0x0][_0x24d52c(0x183)]==_0x24d52c(0x1b9))var _0xb2e27f=users[_0x24d52c(0x1f5)];else{if(_0x303665[0x0][_0x24d52c(0x183)]==_0x24d52c(0x159))var _0xb2e27f=users[_0x24d52c(0x159)];else{if(_0x303665[0x0][_0x24d52c(0x183)]==_0x24d52c(0x203))var _0xb2e27f=users[_0x24d52c(0x245)];}}}}}}}const _0x3b01d6=getRandom8DigitNumber();_0x3b01d6[_0x24d52c(0x1fd)](_0x375956=>{var _0x11b90b=_0x24d52c;_0x1aa647[_0x11b90b(0x20b)]('add_transfer',{'success':_0x2d0e9c[_0x11b90b(0x18f)](_0x11b90b(0x1ba)),'errors':_0x2d0e9c[_0x11b90b(0x18f)]('errors'),'role':_0x5b77fc,'profile':_0x170791,'master_shop':_0x303665,'warehouse':_0x1f9aec,'language':_0xb2e27f,'rooms_data':_0x382c1c,'invoice':_0x375956});})['catch'](_0x3f7f8d=>{var _0x18b9e6=_0x24d52c;_0x2d0e9c[_0x18b9e6(0x18f)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1aa647['redirect'](_0x18b9e6(0x1d7));});}catch(_0x313655){console[_0x24d52c(0x24a)](_0x313655);}}),router['post']('/view/add_transfer',auth,async(_0x93bd03,_0x106e38)=>{var _0x57d80a=a0_0x5b2f7a;try{console[_0x57d80a(0x24a)](_0x93bd03[_0x57d80a(0x218)]);const {date:_0x37b870,from_warehouse:_0x28ee4a,FromRoom_name:_0x578934,to_warehouse:_0x32ac7b,ToRoom_name:_0x51f5d9,prod_name:_0x15ae1d,from_prod_qty:_0x479810,from_prod_level:_0xa40da0,from_prod_isle:_0x4205dc,from_prod_pallet:_0x25ae99,to_prod_qty:_0x5809e0,to_prod_level:_0x3ca8f1,to_prod_isle:_0x210784,to_prod_pallet:_0x71fb69,primary_code:_0x46ce3c,secondary_code:_0x485936,product_code3:_0x2f00d2,note:_0x155373,MaxStocks_data2:_0x3306a6,invoice:_0x7cbf69,expiry_date:_0x174711}=_0x93bd03[_0x57d80a(0x218)];if(typeof _0x15ae1d==_0x57d80a(0x1fb))var _0x2d8e3f=[_0x93bd03['body'][_0x57d80a(0x177)]],_0x95f328=[_0x93bd03[_0x57d80a(0x218)]['from_prod_qty']],_0x2cbf23=[_0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x1dc)]],_0x152cda=[_0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x174)]],_0x5e07a4=[_0x93bd03['body'][_0x57d80a(0x1c6)]],_0x5e74db=[_0x93bd03[_0x57d80a(0x218)]['primary_code']],_0x459279=[_0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x215)]],_0x46bfb9=[_0x93bd03[_0x57d80a(0x218)]['product_code3']],_0x2a02c9=[_0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x1db)]],_0x33e866=[_0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x229)]],_0x49c2b4=[_0x93bd03[_0x57d80a(0x218)]['secondary_unit']],_0x3b91f9=[_0x93bd03[_0x57d80a(0x218)]['batch_code']],_0x228f68=[_0x93bd03['body'][_0x57d80a(0x1d4)]],_0x13fd5d=[_0x93bd03['body'][_0x57d80a(0x21f)]],_0x4d12ac=[_0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x24c)]],_0x4c7b9a=[_0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x157)]],_0x27ba3a=[_0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x19c)]],_0x1d1993=[_0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x227)]],_0x99994b=[_0x93bd03['body'][_0x57d80a(0x223)]],_0x84b1ac=[_0x93bd03[_0x57d80a(0x218)]['to_invoice']],_0x54aaad=[_0x93bd03['body'][_0x57d80a(0x166)]];else var _0x2d8e3f=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x177)]],_0x95f328=[..._0x93bd03['body'][_0x57d80a(0x19b)]],_0x2cbf23=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x1dc)]],_0x152cda=[..._0x93bd03['body'][_0x57d80a(0x174)]],_0x5e07a4=[..._0x93bd03['body'][_0x57d80a(0x1c6)]],_0x5e74db=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x1f1)]],_0x459279=[..._0x93bd03['body'][_0x57d80a(0x215)]],_0x46bfb9=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x186)]],_0x2a02c9=[..._0x93bd03['body'][_0x57d80a(0x1db)]],_0x33e866=[..._0x93bd03[_0x57d80a(0x218)]['primary_unit']],_0x49c2b4=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x1f0)]],_0x3b91f9=[..._0x93bd03['body'][_0x57d80a(0x1e2)]],_0x228f68=[..._0x93bd03[_0x57d80a(0x218)]['expiry_date']],_0x13fd5d=[..._0x93bd03['body'][_0x57d80a(0x21f)]],_0x4d12ac=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x24c)]],_0x4c7b9a=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x157)]],_0x27ba3a=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x19c)]],_0x1d1993=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x227)]],_0x99994b=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x223)]],_0x84b1ac=[..._0x93bd03['body']['to_invoice']],_0x54aaad=[..._0x93bd03[_0x57d80a(0x218)][_0x57d80a(0x166)]];const _0x32dc70=_0x2d8e3f['map'](_0x1164ae=>{return _0x1164ae={'product_name':_0x1164ae};});_0x95f328[_0x57d80a(0x221)]((_0x5e3f97,_0x149992)=>{var _0x45d74c=_0x57d80a;_0x32dc70[_0x149992][_0x45d74c(0x15b)]=_0x5e3f97;}),_0x99994b[_0x57d80a(0x221)]((_0x2c117c,_0x153e5c)=>{_0x32dc70[_0x153e5c]['from_invoice']=_0x2c117c;}),_0x84b1ac['forEach']((_0x54da75,_0x5e404e)=>{var _0x4614ad=_0x57d80a;_0x32dc70[_0x5e404e][_0x4614ad(0x232)]=_0x54da75;}),_0x54aaad[_0x57d80a(0x221)]((_0xe7dc0,_0x122036)=>{var _0x469653=_0x57d80a;_0x32dc70[_0x122036][_0x469653(0x1b0)]=_0xe7dc0;}),_0x2cbf23[_0x57d80a(0x221)]((_0x1ac9d9,_0x18b2db)=>{var _0x412cb0=_0x57d80a;_0x27ba3a[_0x412cb0(0x221)]((_0x2424e6,_0xb7d086)=>{var _0x4059e2=_0x412cb0;if(_0x2424e6==_0x4059e2(0x22c)&&_0x18b2db==_0xb7d086){var _0x2f5887=_0x1ac9d9[_0x4059e2(0x1c9)](0x3);_0x32dc70[_0x18b2db][_0x4059e2(0x1e7)]=_0x1ac9d9[0x0],_0x32dc70[_0x18b2db][_0x4059e2(0x242)]=_0x1ac9d9[0x1],_0x32dc70[_0x18b2db][_0x4059e2(0x238)]=0x0,_0x32dc70[_0x18b2db][_0x4059e2(0x15c)]=0x0,_0x32dc70[_0x18b2db][_0x4059e2(0x219)]=_0x4059e2(0x16e),_0x32dc70[_0x18b2db][_0x4059e2(0x15e)]=_0x2f5887;}else{if(_0x2424e6==_0x4059e2(0x185)&&_0x18b2db==_0xb7d086){var _0x2f5887=_0x1ac9d9[_0x4059e2(0x1c9)](0x3);_0x32dc70[_0x18b2db][_0x4059e2(0x1e7)]=_0x1ac9d9[0x0],_0x32dc70[_0x18b2db][_0x4059e2(0x242)]=_0x1ac9d9[0x1],_0x32dc70[_0x18b2db][_0x4059e2(0x238)]=0x0,_0x32dc70[_0x18b2db][_0x4059e2(0x15c)]=0x0,_0x32dc70[_0x18b2db][_0x4059e2(0x219)]=_0x4059e2(0x16e),_0x32dc70[_0x18b2db][_0x4059e2(0x15e)]=_0x1ac9d9[0x5];}else{if(_0x18b2db==_0xb7d086){if(_0x1ac9d9[0x0]=='A'&&_0x1ac9d9[0x1]=='L'&&_0x1ac9d9[0x2]=='L')console[_0x4059e2(0x24a)](_0x2424e6+'\x20<>\x20'+_0x18b2db+'\x20<>\x20'+_0xb7d086+_0x4059e2(0x216)+_0x1ac9d9+_0x4059e2(0x161)),_0x32dc70[_0x18b2db][_0x4059e2(0x1e7)]=_0x1ac9d9[0x0],_0x32dc70[_0x18b2db][_0x4059e2(0x242)]=_0x1ac9d9[0x1],_0x32dc70[_0x18b2db][_0x4059e2(0x238)]=0x0,_0x32dc70[_0x18b2db][_0x4059e2(0x15c)]=0x0,_0x32dc70[_0x18b2db][_0x4059e2(0x219)]='Floor',_0x32dc70[_0x18b2db][_0x4059e2(0x15e)]=_0x1ac9d9[0x3];else{var _0x25de94;if(_0x1ac9d9[0x4]=='L')_0x25de94=_0x4059e2(0x1a4);else _0x1ac9d9[0x4]=='F'&&(_0x25de94=_0x4059e2(0x16e));_0x32dc70[_0x18b2db]['from_storage']=_0x1ac9d9[0x0],_0x32dc70[_0x18b2db]['from_rack']=_0x1ac9d9[0x1],_0x32dc70[_0x18b2db][_0x4059e2(0x238)]=_0x1ac9d9[0x2],_0x32dc70[_0x18b2db][_0x4059e2(0x15c)]=_0x1ac9d9[0x3],_0x32dc70[_0x18b2db][_0x4059e2(0x219)]=_0x25de94,_0x32dc70[_0x18b2db][_0x4059e2(0x15e)]=_0x1ac9d9[0x5];}}}}});}),_0x152cda['forEach']((_0x48088c,_0x169758)=>{var _0x5e5046=_0x57d80a;_0x32dc70[_0x169758][_0x5e5046(0x18b)]=_0x48088c;}),_0x5e07a4[_0x57d80a(0x221)]((_0x4caaa8,_0x8a31ee)=>{var _0x595713=_0x57d80a;_0x1d1993[_0x595713(0x221)]((_0x1411c7,_0x2d7cb9)=>{var _0x130081=_0x595713;if(_0x1411c7=='Receiving\x20Area'&&_0x8a31ee==_0x2d7cb9){var _0x53549e=_0x4caaa8[_0x130081(0x1c9)](0x3);_0x32dc70[_0x8a31ee]['storage']=_0x4caaa8[0x0],_0x32dc70[_0x8a31ee]['rack']=_0x4caaa8[0x1],_0x32dc70[_0x8a31ee][_0x130081(0x1bf)]=0x0,_0x32dc70[_0x8a31ee]['to_bin']=0x0,_0x32dc70[_0x8a31ee][_0x130081(0x1b3)]=_0x130081(0x16e),_0x32dc70[_0x8a31ee][_0x130081(0x18a)]=_0x53549e;}else{if(_0x1411c7==_0x130081(0x185)&&_0x8a31ee==_0x2d7cb9){var _0x53549e=_0x4caaa8[_0x130081(0x1c9)](0x3);_0x32dc70[_0x8a31ee]['storage']=_0x4caaa8[0x0],_0x32dc70[_0x8a31ee][_0x130081(0x1b4)]=_0x4caaa8[0x1],_0x32dc70[_0x8a31ee][_0x130081(0x1bf)]=0x0,_0x32dc70[_0x8a31ee][_0x130081(0x237)]=0x0,_0x32dc70[_0x8a31ee][_0x130081(0x1b3)]='Floor',_0x32dc70[_0x8a31ee][_0x130081(0x18a)]=_0x4caaa8[0x5];}else{if(_0x8a31ee==_0x2d7cb9){if(_0x4caaa8[0x0]=='A'&&_0x4caaa8[0x1]=='L'&&_0x4caaa8[0x2]=='L')console[_0x130081(0x24a)](_0x1411c7+_0x130081(0x216)+_0x8a31ee+_0x130081(0x216)+_0x2d7cb9+_0x130081(0x216)+_0x4caaa8+_0x130081(0x161)),_0x32dc70[_0x8a31ee]['storage']=_0x4caaa8[0x0],_0x32dc70[_0x8a31ee][_0x130081(0x1b4)]=_0x4caaa8[0x1],_0x32dc70[_0x8a31ee][_0x130081(0x1bf)]=0x0,_0x32dc70[_0x8a31ee][_0x130081(0x237)]=0x0,_0x32dc70[_0x8a31ee][_0x130081(0x1b3)]=_0x130081(0x16e),_0x32dc70[_0x8a31ee]['to_floorlevel']=_0x4caaa8[0x3];else{var _0x5ba28d;if(_0x4caaa8[0x4]=='L')_0x5ba28d=_0x130081(0x1a4);else _0x4caaa8[0x4]=='F'&&(_0x5ba28d='Floor');_0x32dc70[_0x8a31ee][_0x130081(0x233)]=_0x4caaa8[0x0],_0x32dc70[_0x8a31ee]['rack']=_0x4caaa8[0x1],_0x32dc70[_0x8a31ee][_0x130081(0x1bf)]=_0x4caaa8[0x2],_0x32dc70[_0x8a31ee][_0x130081(0x237)]=_0x4caaa8[0x3],_0x32dc70[_0x8a31ee][_0x130081(0x1b3)]=_0x5ba28d,_0x32dc70[_0x8a31ee][_0x130081(0x18a)]=_0x4caaa8[0x5];}}}}});}),_0x5e74db[_0x57d80a(0x221)]((_0x574ffb,_0x8edf50)=>{var _0x4c976a=_0x57d80a;_0x32dc70[_0x8edf50][_0x4c976a(0x1f1)]=_0x574ffb;}),_0x459279[_0x57d80a(0x221)]((_0x364ba2,_0x487428)=>{_0x32dc70[_0x487428]['secondary_code']=_0x364ba2;}),_0x46bfb9[_0x57d80a(0x221)]((_0x33ccde,_0x6d17a4)=>{_0x32dc70[_0x6d17a4]['product_code']=_0x33ccde;}),_0x2a02c9[_0x57d80a(0x221)]((_0x4eede2,_0x3ac19d)=>{_0x32dc70[_0x3ac19d]['maxProducts']=_0x4eede2;}),_0x33e866[_0x57d80a(0x221)]((_0x21a0a8,_0x5b73c0)=>{_0x32dc70[_0x5b73c0]['unit']=_0x21a0a8;}),_0x49c2b4['forEach']((_0x400ff2,_0x399bca)=>{var _0x425199=_0x57d80a;_0x32dc70[_0x399bca][_0x425199(0x1f0)]=_0x400ff2;}),_0x3b91f9[_0x57d80a(0x221)]((_0x11fadc,_0x116c77)=>{var _0xf02d46=_0x57d80a;_0x32dc70[_0x116c77][_0xf02d46(0x1e2)]=_0x11fadc;}),_0x228f68['forEach']((_0x516444,_0x1c24ae)=>{var _0x33cd7d=_0x57d80a;_0x32dc70[_0x1c24ae][_0x33cd7d(0x1d4)]=_0x516444;}),_0x13fd5d['forEach']((_0x15a279,_0xed8065)=>{_0x32dc70[_0xed8065]['maxperunit']=_0x15a279;}),_0x4d12ac['forEach']((_0x4db5e9,_0x3004e0)=>{var _0x13d4c9=_0x57d80a;_0x32dc70[_0x3004e0][_0x13d4c9(0x24c)]=_0x4db5e9;}),_0x4c7b9a[_0x57d80a(0x221)]((_0x4fc131,_0x450a25)=>{_0x32dc70[_0x450a25]['prod_cat']=_0x4fc131;}),_0x27ba3a[_0x57d80a(0x221)]((_0x2f95e3,_0x5104a2)=>{var _0xa8f69=_0x57d80a;_0x32dc70[_0x5104a2][_0xa8f69(0x20c)]=_0x2f95e3;}),_0x1d1993[_0x57d80a(0x221)]((_0x1e1e56,_0x3a21b3)=>{_0x32dc70[_0x3a21b3]['to_room_name']=_0x1e1e56;});const _0x21303b=_0x32dc70[_0x57d80a(0x1ab)](_0x2e2215=>_0x2e2215[_0x57d80a(0x18b)]!=='0'&&_0x2e2215[_0x57d80a(0x18b)]!==''||_0x2e2215[_0x57d80a(0x18a)]!=='0'&&_0x2e2215[_0x57d80a(0x18a)]!==''),_0x4ebb6f=new transfers({'date':_0x37b870,'from_warehouse':_0x28ee4a,'to_warehouse':_0x32ac7b,'product':_0x21303b,'note':_0x155373,'invoice':_0x7cbf69}),_0x31b24d=await _0x4ebb6f[_0x57d80a(0x1cc)]();_0x93bd03['flash'](_0x57d80a(0x1ba),_0x57d80a(0x178)),_0x106e38['redirect']('/transfer/preview/'+_0x31b24d['_id']);}catch(_0x383c68){console[_0x57d80a(0x24a)](_0x383c68),_0x106e38[_0x57d80a(0x244)](0xc8)[_0x57d80a(0x1da)]({'errorMessage':_0x383c68['message']});}}),router[a0_0x5b2f7a(0x1f4)]('/preview/:id',auth,async(_0x27e737,_0x1bab71)=>{var _0x1c909a=a0_0x5b2f7a;try{const {username:_0x3e7815,email:_0x1e4fff,role:_0x414934}=_0x27e737[_0x1c909a(0x21e)],_0x375d91=_0x27e737[_0x1c909a(0x21e)],_0x2785b7=await profile['findOne']({'email':_0x375d91[_0x1c909a(0x1e9)]}),_0x46e236=await master_shop['find']();console[_0x1c909a(0x24a)]('master',_0x46e236);const _0xea7348=await transfers['findById'](_0x27e737['params']['id']);let _0x89a6c6=new Date(_0xea7348[_0x1c909a(0x1d4)]),_0x4c9c6f=('0'+_0x89a6c6[_0x1c909a(0x19a)]())[_0x1c909a(0x1c9)](-0x2),_0x335548=('0'+(_0x89a6c6[_0x1c909a(0x241)]()+0x1))[_0x1c909a(0x1c9)](-0x2),_0x54b109=_0x89a6c6['getFullYear'](),_0x27678=_0x54b109+'-'+_0x335548+'-'+_0x4c9c6f,_0x47a671;if(_0x375d91[_0x1c909a(0x1a0)]==_0x1c909a(0x19f)){const _0x2a3dde=await staff[_0x1c909a(0x1fc)]({'email':_0x375d91[_0x1c909a(0x1e9)]});_0x47a671=await warehouse[_0x1c909a(0x180)]({'status':_0x1c909a(0x220),'name':_0x2a3dde[_0x1c909a(0x226)],'warehouse_category':_0x1c909a(0x1b6)});}else _0x47a671=await warehouse['find']({'status':_0x1c909a(0x220),'warehouse_category':_0x1c909a(0x1b6)});const _0x4666d4=await warehouse['aggregate']([{'$match':{'name':_0xea7348[_0x1c909a(0x23d)]}},{'$unwind':_0x1c909a(0x224)},{'$group':{'_id':_0x1c909a(0x163),'name':{'$first':_0x1c909a(0x23b)},'product_stock':{'$first':_0x1c909a(0x16f)},'bay':{'$first':_0x1c909a(0x198)},'bin':{'$first':_0x1c909a(0x1b8)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1c909a(0x15a)},'secondary_code':{'$first':_0x1c909a(0x175)},'product_code':{'$first':_0x1c909a(0x1de)},'storage':{'$first':_0x1c909a(0x1a2)},'rack':{'$first':_0x1c909a(0x22d)},'expiry_date':{'$first':_0x1c909a(0x1f3)},'production_date':{'$first':_0x1c909a(0x248)},'room':{'$first':'$room'}}}]);if(_0x46e236[0x0]['language']==_0x1c909a(0x162)){var _0x4ecdc3=users[_0x1c909a(0x21b)];console['log'](_0x4ecdc3);}else{if(_0x46e236[0x0]['language']=='Hindi')var _0x4ecdc3=users['Hindi'];else{if(_0x46e236[0x0]['language']==_0x1c909a(0x211))var _0x4ecdc3=users['German'];else{if(_0x46e236[0x0][_0x1c909a(0x183)]=='Spanish')var _0x4ecdc3=users['Spanish'];else{if(_0x46e236[0x0][_0x1c909a(0x183)]==_0x1c909a(0x22f))var _0x4ecdc3=users[_0x1c909a(0x22f)];else{if(_0x46e236[0x0][_0x1c909a(0x183)]=='Portuguese\x20(BR)')var _0x4ecdc3=users[_0x1c909a(0x1f5)];else{if(_0x46e236[0x0][_0x1c909a(0x183)]=='Chinese')var _0x4ecdc3=users[_0x1c909a(0x159)];else{if(_0x46e236[0x0][_0x1c909a(0x183)]==_0x1c909a(0x203))var _0x4ecdc3=users[_0x1c909a(0x245)];}}}}}}}_0x1bab71[_0x1c909a(0x20b)](_0x1c909a(0x21d),{'success':_0x27e737[_0x1c909a(0x18f)](_0x1c909a(0x1ba)),'errors':_0x27e737[_0x1c909a(0x18f)](_0x1c909a(0x1c4)),'role':_0x375d91,'profile':_0x2785b7,'master_shop':_0x46e236,'warehouse':_0x47a671,'transfer':_0xea7348,'stock':_0x4666d4,'language':_0x4ecdc3});}catch(_0x510248){console[_0x1c909a(0x24a)](_0x510248);}}),router[a0_0x5b2f7a(0x1ec)]('/preview/:id',auth,async(_0x557e4b,_0x550cf4)=>{var _0x4dc248=a0_0x5b2f7a;try{const _0x48c006=_0x557e4b[_0x4dc248(0x236)]['id'],{from_warehouse:_0x3e297b,FromRoom_name:_0x54a3e4,to_warehouse:_0x339c92,ToRoom_name:_0x3b5b1a}=_0x557e4b[_0x4dc248(0x218)],_0x10062f=await transfers[_0x4dc248(0x160)]({'_id':_0x48c006}),_0x50042f=_0x10062f['product']['map'](async _0x2cb7cc=>{var _0x2f7091=_0x4dc248;if(_0x2cb7cc[_0x2f7091(0x18b)]>0x0){var _0x374b36=await warehouse[_0x2f7091(0x1fc)]({'name':_0x10062f[_0x2f7091(0x23d)],'room':_0x2cb7cc[_0x2f7091(0x20c)],'warehouse_category':_0x2f7091(0x1b6)});const _0x335ddd=_0x374b36[_0x2f7091(0x1b7)][_0x2f7091(0x16b)](_0x1d20ad=>{var _0x1c70eb=_0x2f7091;_0x1d20ad['product_name']==_0x2cb7cc[_0x1c70eb(0x222)]&&_0x1d20ad['floorlevel']==_0x2cb7cc[_0x1c70eb(0x15e)]&&_0x1d20ad[_0x1c70eb(0x212)]==_0x2cb7cc[_0x1c70eb(0x219)]&&_0x1d20ad['bin']==_0x2cb7cc[_0x1c70eb(0x15c)]&&_0x1d20ad['bay']==_0x2cb7cc[_0x1c70eb(0x238)]&&_0x1d20ad['rack']==_0x2cb7cc[_0x1c70eb(0x242)]&&_0x1d20ad[_0x1c70eb(0x233)]==_0x2cb7cc['from_storage']&&_0x1d20ad['expiry_date']==_0x2cb7cc['expiry_date']&&_0x1d20ad[_0x1c70eb(0x1e2)]==_0x2cb7cc['batch_code']&&_0x1d20ad[_0x1c70eb(0x24c)]==_0x2cb7cc[_0x1c70eb(0x24c)]&&_0x1d20ad[_0x1c70eb(0x20e)]==_0x2cb7cc[_0x1c70eb(0x223)]&&_0x1d20ad['_id']==_0x2cb7cc[_0x1c70eb(0x1b0)]&&(_0x1d20ad[_0x1c70eb(0x167)]=_0x1d20ad[_0x1c70eb(0x167)]-_0x2cb7cc['to_quantity']);});}return _0x374b36;});Promise[_0x4dc248(0x1cd)](_0x50042f)['then'](async _0x5c1011=>{var _0x2fe700=_0x4dc248;try{for(const _0x48dfd8 of _0x5c1011){await _0x48dfd8[_0x2fe700(0x1cc)]();}try{const _0x1b633e=_0x10062f[_0x2fe700(0x23f)][_0x2fe700(0x16b)](async _0x15b1c3=>{var _0x4301c3=_0x2fe700;if(_0x15b1c3['to_quantity']>0x0){var _0x3e1254=await warehouse[_0x4301c3(0x1fc)]({'name':_0x10062f[_0x4301c3(0x179)],'room':_0x15b1c3[_0x4301c3(0x17e)],'warehouse_category':_0x4301c3(0x1b6)}),_0x40f635=0x0;const _0x2ec638=_0x3e1254[_0x4301c3(0x1b7)][_0x4301c3(0x16b)](_0xe97116=>{var _0x594f51=_0x4301c3;_0xe97116[_0x594f51(0x222)]==_0x15b1c3['product_name']&&_0xe97116[_0x594f51(0x169)]==_0x15b1c3['to_floorlevel']&&_0xe97116[_0x594f51(0x212)]==_0x15b1c3[_0x594f51(0x1b3)]&&_0xe97116[_0x594f51(0x1d8)]==_0x15b1c3[_0x594f51(0x237)]&&_0xe97116['bay']==_0x15b1c3[_0x594f51(0x1bf)]&&_0xe97116[_0x594f51(0x1b4)]==_0x15b1c3[_0x594f51(0x1b4)]&&_0xe97116[_0x594f51(0x233)]==_0x15b1c3['storage']&&_0xe97116[_0x594f51(0x1d4)]==_0x15b1c3[_0x594f51(0x1d4)]&&_0xe97116[_0x594f51(0x1e2)]==_0x15b1c3[_0x594f51(0x1e2)]&&_0xe97116[_0x594f51(0x24c)]==_0x15b1c3[_0x594f51(0x24c)]&&_0xe97116[_0x594f51(0x20e)]==_0x15b1c3[_0x594f51(0x232)]&&(_0xe97116[_0x594f51(0x167)]=_0xe97116[_0x594f51(0x167)]+_0x15b1c3[_0x594f51(0x18b)],_0x40f635++);});_0x40f635=='0'&&(_0x3e1254[_0x4301c3(0x1b7)]=_0x3e1254[_0x4301c3(0x1b7)][_0x4301c3(0x22e)]({'product_name':_0x15b1c3['product_name'],'product_stock':_0x15b1c3[_0x4301c3(0x18b)],'bay':_0x15b1c3[_0x4301c3(0x1bf)],'bin':_0x15b1c3[_0x4301c3(0x237)],'type':_0x15b1c3[_0x4301c3(0x1b3)],'floorlevel':_0x15b1c3[_0x4301c3(0x18a)],'storage':_0x15b1c3[_0x4301c3(0x233)],'rack':_0x15b1c3['rack'],'product_code':_0x15b1c3[_0x4301c3(0x196)],'primary_code':_0x15b1c3['primary_code'],'secondary_code':_0x15b1c3[_0x4301c3(0x215)],'maxProducts':_0x15b1c3['maxProducts'],'storage':_0x15b1c3[_0x4301c3(0x233)],'rack':_0x15b1c3[_0x4301c3(0x1b4)],'expiry_date':_0x15b1c3[_0x4301c3(0x1d4)],'maxPerUnit':_0x15b1c3[_0x4301c3(0x231)],'batch_code':_0x15b1c3[_0x4301c3(0x1e2)],'production_date':_0x15b1c3[_0x4301c3(0x24c)]}));}return _0x3e1254;});Promise[_0x2fe700(0x1cd)](_0x1b633e)[_0x2fe700(0x1fd)](async _0x24e9d1=>{var _0x560987=_0x2fe700;try{for(const _0x5a45cf of _0x24e9d1){await warehouse[_0x560987(0x1c1)]({'_id':_0x5a45cf[_0x560987(0x173)]},{'$addToSet':{'product_details':{'$each':_0x5a45cf[_0x560987(0x1b7)]}}});}_0x10062f[_0x560987(0x1e5)]=_0x560987(0x235);const _0x44bede=await _0x10062f[_0x560987(0x1cc)](),_0x4e67e1=await master_shop[_0x560987(0x180)](),_0x49d1ab=await email_settings[_0x560987(0x1fc)](),_0x39e37d=await supervisor_settings[_0x560987(0x180)]();var _0x84c1b6=_0x10062f[_0x560987(0x23f)],_0xe3ca75='',_0x1486db;for(_0x1486db in _0x84c1b6){_0xe3ca75+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x84c1b6[_0x1486db][_0x560987(0x222)]+_0x560987(0x1f7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x84c1b6[_0x1486db][_0x560987(0x196)]+_0x560987(0x1f7)+_0x560987(0x1a1)+_0x84c1b6[_0x1486db][_0x560987(0x18b)]+'</td>'+_0x560987(0x1a1)+_0x84c1b6[_0x1486db][_0x560987(0x1e6)]+_0x560987(0x1f7)+_0x560987(0x1a1)+_0x84c1b6[_0x1486db][_0x560987(0x1f0)]+_0x560987(0x1f7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10062f[_0x560987(0x179)]+_0x560987(0x1f7)+_0x560987(0x1a1)+_0x84c1b6[_0x1486db][_0x560987(0x17e)]+_0x560987(0x1f7)+_0x560987(0x1a1)+_0x84c1b6[_0x1486db][_0x560987(0x233)]+_0x84c1b6[_0x1486db]['rack']+_0x84c1b6[_0x1486db][_0x560987(0x1bf)]+_0x84c1b6[_0x1486db]['to_bin']+_0x84c1b6[_0x1486db][_0x560987(0x1b3)][0x0]+_0x84c1b6[_0x1486db][_0x560987(0x18a)]+'</td>',_0x560987(0x208);}let _0x1ad1af=nodemailer['createTransport']({'host':_0x49d1ab[_0x560987(0x234)],'port':Number(_0x49d1ab['port']),'secure':![],'auth':{'user':_0x49d1ab[_0x560987(0x1e9)],'pass':_0x49d1ab[_0x560987(0x1d6)]}}),_0x31fdfc={'from':_0x49d1ab[_0x560987(0x1e9)],'to':_0x39e37d[0x0][_0x560987(0x1ca)],'subject':'Transfer\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x560987(0x164)+_0x560987(0x1c2)+_0x4e67e1[0x0][_0x560987(0x246)],'cid':_0x560987(0x188)}],'html':'<!DOCTYPE\x20html>'+_0x560987(0x22b)+_0x560987(0x1ef)+_0x560987(0x249)+_0x560987(0x1aa)+_0x560987(0x249)+_0x560987(0x1e8)+'</div>'+_0x560987(0x249)+'<h2>\x20'+_0x4e67e1[0x0][_0x560987(0x165)]+_0x560987(0x1a3)+_0x560987(0x202)+_0x560987(0x202)+_0x560987(0x1fe)+_0x560987(0x249)+_0x560987(0x204)+'\x20Order\x20Number\x20:\x20'+_0x10062f['invoice']+'\x20'+_0x560987(0x1ad)+_0x560987(0x1bb)+_0x10062f[_0x560987(0x1eb)]+'\x20'+_0x560987(0x197)+_0x560987(0x217)+_0x560987(0x202)+_0x560987(0x17d)+_0x560987(0x19e)+_0x560987(0x21c)+_0x560987(0x156)+_0x560987(0x1be)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x560987(0x213)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x560987(0x1e4)+_0x560987(0x1df)+'</tr>'+_0x560987(0x1b1)+_0x560987(0x17a)+'\x20'+_0xe3ca75+'\x20'+_0x560987(0x1e3)+_0x560987(0x1d1)+_0x560987(0x249)+_0x560987(0x201)+'<h5>'+_0x4e67e1[0x0][_0x560987(0x165)]+_0x560987(0x217)+_0x560987(0x202)+_0x560987(0x202)+_0x560987(0x1a5)};_0x1ad1af[_0x560987(0x23a)](_0x31fdfc,function(_0x5cde3c,_0x59ba09){var _0x18ef6e=_0x560987;_0x5cde3c?(console[_0x18ef6e(0x24a)](_0x5cde3c),console[_0x18ef6e(0x24a)](_0x18ef6e(0x22a))):console[_0x18ef6e(0x24a)](_0x18ef6e(0x1ff));}),_0x557e4b['flash']('success',_0x560987(0x176)),_0x550cf4[_0x560987(0x1c7)](_0x560987(0x1cf)+_0x44bede['_id']);}catch(_0x16d64f){console[_0x560987(0x1d0)](_0x16d64f),_0x550cf4[_0x560987(0x244)](0x1f4)['json']({'Perror':_0x560987(0x243),'message':_0x16d64f[_0x560987(0x168)]});}})[_0x2fe700(0x24b)](_0x3d63d4=>{var _0x221d15=_0x2fe700;console['error'](_0x3d63d4),_0x550cf4[_0x221d15(0x244)](0x1f4)['json']({'Perror':'An\x20error\x20occurred.'});});}catch(_0x3779a4){_0x550cf4[_0x2fe700(0x1da)](_0x3779a4);}}catch(_0x4fa955){console['error'](_0x4fa955),_0x550cf4['status'](0x1f4)['json']({'Merror':_0x2fe700(0x243),'Message':_0x4fa955[_0x2fe700(0x168)]});}})[_0x4dc248(0x24b)](_0x4ebbc7=>{var _0x357d37=_0x4dc248;console[_0x357d37(0x1d0)](_0x4ebbc7),_0x550cf4[_0x357d37(0x244)](0x1f4)[_0x357d37(0x1da)]({'Merror':_0x357d37(0x1d9)});});}catch(_0x578d89){console[_0x4dc248(0x24a)](_0x578d89);}});function a0_0x4c94(){var _0x41662d=['product_stock','message','floorlevel','/view','map','$from_warehouse','Rack\x20E','Floor','$product_details.product_stock','floor','/barcode_scanner','Rack\x20A','_id','New_Qty_Converted','$product_details.secondary_code','Transfer\x20Finalize\x20Successfully','prod_name','Product\x20Transfer\x20successfully','to_warehouse','<tbody\x20style=\x22text-align:\x20center;\x22>','248410pNByHS','51RefCwO','<table\x20style=\x22width:\x20100%\x20!important;\x22>','to_room_name','Ambient','find','transfer','master','language','201952YnOFRC','Shelves','product_code3','COLD\x20STORAGE','logo','Transfer\x20Edit\x20Successfully','to_floorlevel','to_quantity','back','Rack\x20C','$product_details.floorlevel','flash','split','8837631yVkhGE','$_id','$product_details.maxProducts','2448480PPXime','/view/:id','product_code','</span>','$product_details.bay','bay','getDate','from_prod_qty','RoomAssigned','to_room','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','staff','role','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.storage','\x20</h2>','Level','</body></html>','$product_details.maxPerUnit','from_room','length','$isAllowEdit','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','filter','from_rak','<span\x20style=\x22float:\x20right;\x22>','$room','note','id_transaction_id','</thead>','DRY\x20STORAGE','to_types','rack','$product_details.unit','Raw\x20Materials','product_details','$product_details.bin','Portuguese\x20(BR)','success','\x20Order\x20Date\x20:\x20','../public/language/languages.json','22975790ZfgoOK','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','to_bay','Enclosed','updateOne','/upload/','maxProducts','errors','express','to_prod_level','redirect','../middleware/auth','slice','RMSEmail','$product.to_room_name','save','all','aggregate','/picking_list/PDF_transfer_rm/','error','</table>','359xugsXG','$product_details.type','expiry_date','random','password','/transfer/view','bin','An\x20error\x20occurred.','json','MaxStocks_data2','from_prod_level','Hindi','$product_details.product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','nodemailer','3640BiZnGg','batch_code','</tbody>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','finalize','unit','from_storage','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','email','Rack\x20B','date','post','to_prod_isle','edit_transfer','</head><body>','secondary_unit','primary_code','TRF-','$product_details.expiry_date','get','Portuguese','/view/add_transfer','</td>','to_prod_pallet','$product_details.secondary_unit','push','string','findOne','then','<hr\x20class=\x22my-3\x22>','Email\x20sent\x20successfully','$product_details.level','<strong>\x20Regards\x20</strong>','</div>','Arabic\x20(ae)','<h5\x20style=\x22text-align:\x20left;\x22>','exports','toString','1480185Ruwjye','</tr>','rak','Router','render','from_room_name','from_prod_isle','invoice','from_prod_pallet','150LaooAW','German','type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product.from_room_name','secondary_code','\x20<>\x20','</h5>','body','from_types','$product_details.pallet','English','<tr>','edit_transfer_view','user','max_per_unit','Enabled','forEach','product_name','from_invoice','$product_details','Spanish','warehouse','ToRoomAssigned','$product_details.invoice','primary_unit','Error\x20Occurs','<html><head><title></title>','Receiving\x20Area','$product_details.rack','concat','French','$product_details.batch_code','maxperunit','To_invoice','storage','host','True','params','to_bin','from_bay','$date','sendMail','$product_details.product_name','$product_details.isle','from_warehouse','/barcode_scanner2','product','$to_warehouse','getMonth','from_rack','An\x20error\x20occurred\x20while\x20saving\x20data.','status','Arabic','image','../models/all_models','$product_details.production_date','<div>','log','catch','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','prod_cat','$name','Chinese','$product_details.primary_code','from_quantity','from_bin','padStart','from_floorlevel','to_prod_qty','findById','here','English\x20(US)','$product_details._id','/../public','site_title','id_transaction'];a0_0x4c94=function(){return _0x41662d;};return a0_0x4c94();}function BayBinSelected(_0x4835c8,_0x510624){var _0x5c07d2=a0_0x5b2f7a,_0x4dc917=[],_0x3f62ee=[],_0x3d06e7=[],_0xc9a894=[],_0x3c7158=[],_0xfec550=[];let _0x1a1d2f=[];if(_0x4835c8==_0x5c07d2(0x1b2))switch(_0x510624){case _0x5c07d2(0x172):_0x4dc917=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x3f62ee=[0x1,0x2],_0xc9a894=[0x1,0x2,0x3,0x4,0x5],_0x3d06e7=[_0x5c07d2(0x1a4),_0x5c07d2(0x16e)],_0x3c7158=['D'],_0xfec550=['A'];break;case _0x5c07d2(0x1ea):_0x4dc917=[0x6,0x5,0x4,0x3,0x2,0x1],_0x3f62ee=[0x1,0x2],_0xc9a894=[0x1,0x2,0x3,0x4,0x5],_0x3d06e7=[_0x5c07d2(0x1a4),_0x5c07d2(0x16e)],_0x3c7158=['D'],_0xfec550=['B'];break;case _0x5c07d2(0x185):_0x4dc917=[0x0],_0x3f62ee=[0x0],_0xc9a894=[0x1,0x2,0x3,0x4,0x5],_0x3d06e7=['Floor'],_0x3c7158=['D'],_0xfec550=['S'];break;case _0x5c07d2(0x22c):_0x4dc917=[0x0],_0x3f62ee=[0x0],_0xc9a894=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x3d06e7=[_0x5c07d2(0x16e)],_0x3c7158=['D'],_0xfec550=['R'];break;}else{if(_0x4835c8==_0x5c07d2(0x187))switch(_0x510624){case'Rack\x20A':_0x4dc917=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x3f62ee=['B','F'],_0xc9a894=[0x1,0x2,0x3,0x4,0x5],_0x3d06e7=[_0x5c07d2(0x1a4),_0x5c07d2(0x16e)],_0x3c7158=['C'],_0xfec550=['A'];break;case'Rack\x20B':_0x4dc917=[0x5,0x4,0x3,0x2,0x1],_0x3f62ee=['F','B','S'],_0xc9a894=[0x1,0x2,0x3,0x4,0x5],_0x3d06e7=[_0x5c07d2(0x1a4),'Floor'],_0x3c7158=['C'],_0xfec550=['B'];break;case _0x5c07d2(0x18d):_0x4dc917=[0x1,0x2,0x3,0x4,0x5],_0x3f62ee=['B','F','S'],_0xc9a894=[0x5,0x4,0x3,0x2,0x1],_0x3d06e7=[_0x5c07d2(0x1a4),_0x5c07d2(0x16e)],_0x3c7158=['C'],_0xfec550=['C'];break;case'Rack\x20D':_0x4dc917=[0x5,0x4,0x3,0x2,0x1],_0x3f62ee=['F','B','S'],_0xc9a894=[0x1,0x2,0x3,0x4,0x5],_0x3d06e7=['Level',_0x5c07d2(0x16e)],_0x3c7158=['C'],_0xfec550=['D'];break;case _0x5c07d2(0x16d):_0x4dc917=[0x4,0x3,0x2,0x1],_0x3f62ee=[0x1,0x2],_0xc9a894=[0x1,0x2,0x3,0x4,0x5],_0x3d06e7=[_0x5c07d2(0x1a4),'Floor'],_0x3c7158=['C'],_0xfec550=['E'];break;case'Rack\x20F':_0x4dc917=[0x1,0x2,0x3],_0x3f62ee=[0x1,0x2],_0xc9a894=[0x1,0x2,0x3,0x4,0x5],_0x3d06e7=[_0x5c07d2(0x1a4)],_0x3c7158=['C'],_0xfec550=['F'];break;}}return{'levels':_0x4dc917,'Isle':_0x3f62ee,'rack':_0xc9a894,'type':_0x3d06e7,'storage':_0x3c7158,'rak':_0xfec550};}router['get'](a0_0x5b2f7a(0x195),auth,async(_0x4c414f,_0x1cd2e8)=>{var _0x1d0154=a0_0x5b2f7a;try{const {username:_0x374b6e,email:_0x18adf8,role:_0x2295f9}=_0x4c414f[_0x1d0154(0x21e)],_0x4e91c4=_0x4c414f[_0x1d0154(0x21e)],_0xac2fd1=await profile[_0x1d0154(0x1fc)]({'email':_0x4e91c4[_0x1d0154(0x1e9)]}),_0x2a4e94=await master_shop[_0x1d0154(0x180)](),_0xca4276=await transfers[_0x1d0154(0x160)](_0x4c414f[_0x1d0154(0x236)]['id']);let _0x8685b1;if(_0x4e91c4[_0x1d0154(0x1a0)]==_0x1d0154(0x19f)){const _0xb9f51e=await staff[_0x1d0154(0x1fc)]({'email':_0x4e91c4[_0x1d0154(0x1e9)]});_0x8685b1=await warehouse[_0x1d0154(0x1ce)]([{'$match':{'status':_0x1d0154(0x220),'name':_0xb9f51e[_0x1d0154(0x226)],'warehouse_category':_0x1d0154(0x1b6)}},{'$group':{'_id':'$name','name':{'$first':_0x1d0154(0x158)}}}]);}else _0x8685b1=await warehouse[_0x1d0154(0x1ce)]([{'$match':{'status':_0x1d0154(0x220),'warehouse_category':_0x1d0154(0x1b6)}},{'$group':{'_id':_0x1d0154(0x158),'name':{'$first':_0x1d0154(0x158)}}}]);const _0x73226e=await warehouse[_0x1d0154(0x1ce)]([{'$match':{'name':_0xca4276['from_warehouse'],'warehouse_category':_0x1d0154(0x1b6)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1d0154(0x163),'name':{'$first':_0x1d0154(0x23b)},'product_stock':{'$first':_0x1d0154(0x16f)},'bay':{'$first':_0x1d0154(0x198)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1d0154(0x18e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1d0154(0x1de)},'storage':{'$first':_0x1d0154(0x1a2)},'rack':{'$first':_0x1d0154(0x22d)},'expiry_date':{'$first':_0x1d0154(0x1f3)},'production_date':{'$first':_0x1d0154(0x248)},'room':{'$first':'$room'}}}]),_0xacf40c=await product['find']({}),_0x46b790=BayBinSelected(_0xca4276[_0x1d0154(0x179)],_0xca4276[_0x1d0154(0x19d)]);if(_0x2a4e94[0x0][_0x1d0154(0x183)]==_0x1d0154(0x162)){var _0x46036b=users['English'];console[_0x1d0154(0x24a)](_0x46036b);}else{if(_0x2a4e94[0x0][_0x1d0154(0x183)]==_0x1d0154(0x1dd))var _0x46036b=users[_0x1d0154(0x1dd)];else{if(_0x2a4e94[0x0]['language']=='German')var _0x46036b=users[_0x1d0154(0x211)];else{if(_0x2a4e94[0x0]['language']==_0x1d0154(0x225))var _0x46036b=users[_0x1d0154(0x225)];else{if(_0x2a4e94[0x0][_0x1d0154(0x183)]==_0x1d0154(0x22f))var _0x46036b=users[_0x1d0154(0x22f)];else{if(_0x2a4e94[0x0][_0x1d0154(0x183)]==_0x1d0154(0x1b9))var _0x46036b=users[_0x1d0154(0x1f5)];else{if(_0x2a4e94[0x0][_0x1d0154(0x183)]=='Chinese')var _0x46036b=users['Chinese'];else{if(_0x2a4e94[0x0]['language']==_0x1d0154(0x203))var _0x46036b=users['Arabic'];}}}}}}}_0x1cd2e8[_0x1d0154(0x20b)](_0x1d0154(0x1ee),{'success':_0x4c414f[_0x1d0154(0x18f)]('success'),'errors':_0x4c414f[_0x1d0154(0x18f)]('errors'),'role':_0x4e91c4,'profile':_0xac2fd1,'master_shop':_0x2a4e94,'warehouse':_0x8685b1,'transfer':_0xca4276,'stock':_0x73226e,'unit':_0xacf40c,'language':_0x46036b});}catch(_0x2c6033){console['log'](_0x2c6033);}}),router['post'](a0_0x5b2f7a(0x195),auth,async(_0x1b7619,_0x3af2c8)=>{var _0x75e01e=a0_0x5b2f7a;try{const _0xf0fcdd=_0x1b7619[_0x75e01e(0x236)]['id'],_0x43ca9f=await transfers[_0x75e01e(0x160)](_0xf0fcdd);_0x3af2c8['json'](_0x1b7619[_0x75e01e(0x218)]);return;const {date:_0x20df2d,from_warehouse:_0x47fcda,FromRoom_name:_0x28ddae,to_warehouse:_0x416489,ToRoom_name:_0x24e35d,prod_name:_0x433c10,from_prod_qty:_0x1c342d,from_prod_level:_0x4852ec,from_prod_isle:_0x42be52,from_prod_pallet:_0x49c91b,to_prod_qty:_0x23a7df,to_prod_level:_0x215d53,to_prod_isle:_0x4d769e,to_prod_pallet:_0xfefc46,primary_code:_0x87ff59,secondary_code:_0x4dc305,product_code3:_0x56ddcd,note:_0x4dfc1f,invoice:_0x590141,expiry_date:_0x4d046}=_0x1b7619['body'];if(typeof _0x433c10=='string')var _0x526c01=[_0x1b7619['body'][_0x75e01e(0x177)]],_0x765e21=[_0x1b7619['body']['from_prod_qty']],_0x1c77a3=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1dc)]],_0x1d9578=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x20d)]],_0x3e3231=[_0x1b7619['body'][_0x75e01e(0x20f)]],_0xab58a8=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x219)]],_0x153bb6=[_0x1b7619['body'][_0x75e01e(0x15f)]],_0xd84fe5=[_0x1b7619['body'][_0x75e01e(0x1c6)]],_0x3c368d=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1ed)]],_0xcbcf92=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1f8)]],_0x551579=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1b3)]],_0x2dfdd4=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x233)]],_0x5e7910=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x209)]],_0x24c5da=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1f1)]],_0x30b31e=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x215)]],_0x53749c=[_0x1b7619['body'][_0x75e01e(0x186)]],_0x2a231f=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1db)]],_0x12180c=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1e6)]],_0x2c26e7=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1f0)]],_0x46a2c8=[_0x1b7619[_0x75e01e(0x218)]['batch_code']],_0x49841e=[_0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1d4)]],_0x35e80e=[_0x1b7619[_0x75e01e(0x218)]['from_storage']],_0x2b80e4=[_0x1b7619[_0x75e01e(0x218)]['from_rak']];else var _0x526c01=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x177)]],_0x2dfdd4=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x233)]],_0x5e7910=[..._0x1b7619[_0x75e01e(0x218)]['rak']],_0xab58a8=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x219)]],_0x551579=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1b3)]],_0x765e21=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x19b)]],_0x1c77a3=[..._0x1b7619['body'][_0x75e01e(0x1dc)]],_0x1d9578=[..._0x1b7619[_0x75e01e(0x218)]['from_prod_isle']],_0x3e3231=[..._0x1b7619['body'][_0x75e01e(0x20f)]],_0x153bb6=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x15f)]],_0xd84fe5=[..._0x1b7619[_0x75e01e(0x218)]['to_prod_level']],_0x3c368d=[..._0x1b7619[_0x75e01e(0x218)]['to_prod_isle']],_0xcbcf92=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1f8)]],_0x24c5da=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1f1)]],_0x30b31e=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x215)]],_0x53749c=[..._0x1b7619[_0x75e01e(0x218)]['product_code3']],_0x2a231f=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1db)]],_0x12180c=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1e6)]],_0x2c26e7=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1f0)]],_0x46a2c8=[..._0x1b7619['body']['batch_code']],_0x49841e=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1d4)]],_0x35e80e=[..._0x1b7619[_0x75e01e(0x218)]['from_storage']],_0x2b80e4=[..._0x1b7619[_0x75e01e(0x218)][_0x75e01e(0x1ac)]];const _0x2c1c34=_0x526c01[_0x75e01e(0x16b)](_0x147066=>{return _0x147066={'product_name':_0x147066};});_0x765e21[_0x75e01e(0x221)]((_0x441639,_0x44000d)=>{var _0x461197=_0x75e01e;_0x2c1c34[_0x44000d][_0x461197(0x15b)]=_0x441639;}),_0x1c77a3[_0x75e01e(0x221)]((_0x4f3080,_0x276562)=>{var _0x34a90c=_0x75e01e;_0x2c1c34[_0x276562][_0x34a90c(0x238)]=_0x4f3080;}),_0x1d9578[_0x75e01e(0x221)]((_0x8cdd30,_0x3ad7ff)=>{var _0x120a00=_0x75e01e;_0x2c1c34[_0x3ad7ff][_0x120a00(0x15c)]=_0x8cdd30;}),_0x3e3231[_0x75e01e(0x221)]((_0x5f4fad,_0x528253)=>{var _0x283b6d=_0x75e01e;_0x2c1c34[_0x528253][_0x283b6d(0x15e)]=_0x5f4fad;}),_0x153bb6[_0x75e01e(0x221)]((_0x4840fb,_0x3ad865)=>{var _0x1d4b10=_0x75e01e;_0x2c1c34[_0x3ad865][_0x1d4b10(0x18b)]=_0x4840fb;}),_0xd84fe5[_0x75e01e(0x221)]((_0x4d0e13,_0x231322)=>{var _0x3273c3=_0x75e01e;_0x2c1c34[_0x231322][_0x3273c3(0x1bf)]=_0x4d0e13;}),_0x3c368d[_0x75e01e(0x221)]((_0x565af0,_0x5e6869)=>{var _0x52a4e3=_0x75e01e;_0x2c1c34[_0x5e6869][_0x52a4e3(0x237)]=_0x565af0;}),_0xcbcf92[_0x75e01e(0x221)]((_0x50fa12,_0x1452f7)=>{var _0x4a08c3=_0x75e01e;_0x2c1c34[_0x1452f7][_0x4a08c3(0x18a)]=_0x50fa12;}),_0x24c5da[_0x75e01e(0x221)]((_0x4c9645,_0x94fe4b)=>{_0x2c1c34[_0x94fe4b]['primary_code']=_0x4c9645;}),_0x30b31e[_0x75e01e(0x221)]((_0xa4dd59,_0x2fca22)=>{var _0x20d38c=_0x75e01e;_0x2c1c34[_0x2fca22][_0x20d38c(0x215)]=_0xa4dd59;}),_0x53749c['forEach']((_0x10e9d5,_0x36ab45)=>{var _0x4fb001=_0x75e01e;_0x2c1c34[_0x36ab45][_0x4fb001(0x196)]=_0x10e9d5;}),_0x2a231f[_0x75e01e(0x221)]((_0x1679e5,_0x4a82c5)=>{var _0x3d2332=_0x75e01e;_0x2c1c34[_0x4a82c5][_0x3d2332(0x1c3)]=_0x1679e5;}),_0x12180c[_0x75e01e(0x221)]((_0x5aca82,_0x40cf97)=>{var _0x526bff=_0x75e01e;_0x2c1c34[_0x40cf97][_0x526bff(0x1e6)]=_0x5aca82;}),_0x2c26e7['forEach']((_0x2142a3,_0x53391e)=>{var _0x33f494=_0x75e01e;_0x2c1c34[_0x53391e][_0x33f494(0x1f0)]=_0x2142a3;}),_0x46a2c8['forEach']((_0x47d13b,_0x190712)=>{var _0x544b6c=_0x75e01e;_0x2c1c34[_0x190712][_0x544b6c(0x1e2)]=_0x47d13b;}),_0x49841e[_0x75e01e(0x221)]((_0x3ee7c4,_0x1b395b)=>{_0x2c1c34[_0x1b395b]['expiry_date']=_0x3ee7c4;}),_0x2dfdd4[_0x75e01e(0x221)]((_0x5c3297,_0x4e4dc9)=>{var _0x3432c4=_0x75e01e;_0x2c1c34[_0x4e4dc9][_0x3432c4(0x233)]=_0x5c3297;}),_0x5e7910[_0x75e01e(0x221)]((_0x155982,_0x4bbf78)=>{var _0x3c2b65=_0x75e01e;_0x2c1c34[_0x4bbf78][_0x3c2b65(0x1b4)]=_0x155982;}),_0xab58a8[_0x75e01e(0x221)]((_0x59400b,_0x482888)=>{var _0x3f9686=_0x75e01e;_0x2c1c34[_0x482888][_0x3f9686(0x219)]=_0x59400b;}),_0x551579['forEach']((_0x532efc,_0x5b47fe)=>{var _0x1b2749=_0x75e01e;_0x2c1c34[_0x5b47fe][_0x1b2749(0x1b3)]=_0x532efc;}),_0x35e80e[_0x75e01e(0x221)]((_0x51751d,_0x4108a4)=>{var _0xf5ff97=_0x75e01e;_0x2c1c34[_0x4108a4][_0xf5ff97(0x1e7)]=_0x51751d;}),_0x2b80e4[_0x75e01e(0x221)]((_0x37bb7e,_0x5e5efd)=>{var _0x20474f=_0x75e01e;_0x2c1c34[_0x5e5efd][_0x20474f(0x242)]=_0x37bb7e;});const _0x40a4d6=_0x2c1c34[_0x75e01e(0x1ab)](_0x5750a1=>_0x5750a1['to_quantity']!=='0'&&_0x5750a1['to_quantity']!==''||_0x5750a1[_0x75e01e(0x18a)]!=='0'&&_0x5750a1[_0x75e01e(0x18a)]!=='');var _0x1ed504=0x0;_0x40a4d6[_0x75e01e(0x221)](_0xbdaceb=>{var _0x49bb23=_0x75e01e;parseInt(_0xbdaceb[_0x49bb23(0x15b)])<parseInt(_0xbdaceb[_0x49bb23(0x18b)])&&_0x1ed504++;});if(_0x1ed504!=0x0)return _0x1b7619['flash'](_0x75e01e(0x1c4),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x3af2c8['redirect'](_0x75e01e(0x18c));const _0x294500=await warehouse[_0x75e01e(0x1fc)]({'name':_0x43ca9f['from_warehouse'],'room':_0x43ca9f[_0x75e01e(0x1a7)]});_0x43ca9f['product'][_0x75e01e(0x221)](_0x137e2d=>{var _0x16341e=_0x75e01e;if(_0x137e2d['to_quantity']>0x0){const _0x3c2832=_0x294500[_0x16341e(0x1b7)][_0x16341e(0x16b)](_0x5ed034=>{var _0x57896b=_0x16341e;_0x5ed034[_0x57896b(0x222)]==_0x137e2d[_0x57896b(0x222)]&&_0x5ed034[_0x57896b(0x169)]==_0x137e2d[_0x57896b(0x15e)]&&_0x5ed034[_0x57896b(0x212)]==_0x137e2d[_0x57896b(0x219)]&&_0x5ed034[_0x57896b(0x1d8)]==_0x137e2d[_0x57896b(0x15c)]&&_0x5ed034[_0x57896b(0x199)]==_0x137e2d['from_bay']&&_0x5ed034['rack']==_0x137e2d[_0x57896b(0x242)]&&_0x5ed034[_0x57896b(0x233)]==_0x137e2d[_0x57896b(0x1e7)]&&(_0x5ed034[_0x57896b(0x167)]=parseInt(_0x5ed034[_0x57896b(0x167)])+parseInt(_0x137e2d[_0x57896b(0x18b)]));});}}),await _0x294500['save']();const _0xe5698f=await warehouse['findOne']({'name':_0x43ca9f[_0x75e01e(0x179)],'room':_0x43ca9f[_0x75e01e(0x19d)]});_0x43ca9f[_0x75e01e(0x23f)][_0x75e01e(0x221)](_0x2cb82f=>{var _0x319999=_0x75e01e;if(_0x2cb82f[_0x319999(0x18b)]>0x0){const _0x39b903=_0xe5698f[_0x319999(0x1b7)][_0x319999(0x16b)](_0x468976=>{var _0x5a833d=_0x319999;_0x468976[_0x5a833d(0x222)]==_0x2cb82f['product_name']&&_0x468976[_0x5a833d(0x169)]==_0x2cb82f[_0x5a833d(0x18a)]&&_0x468976[_0x5a833d(0x212)]==_0x2cb82f['to_types']&&_0x468976[_0x5a833d(0x1d8)]==_0x2cb82f[_0x5a833d(0x237)]&&_0x468976[_0x5a833d(0x199)]==_0x2cb82f[_0x5a833d(0x1bf)]&&_0x468976['rack']==_0x2cb82f[_0x5a833d(0x1b4)]&&_0x468976[_0x5a833d(0x233)]==_0x2cb82f[_0x5a833d(0x233)]&&(_0x468976['product_stock']=parseInt(_0x468976[_0x5a833d(0x167)])-parseInt(_0x2cb82f[_0x5a833d(0x18b)]));});}}),await _0xe5698f[_0x75e01e(0x1cc)](),_0x43ca9f[_0x75e01e(0x1eb)]=_0x20df2d,_0x43ca9f['from_warehouse']=_0x47fcda,_0x43ca9f[_0x75e01e(0x179)]=_0x416489,_0x43ca9f[_0x75e01e(0x23f)]=_0x40a4d6,_0x43ca9f[_0x75e01e(0x1af)]=_0x4dfc1f,_0x43ca9f[_0x75e01e(0x20e)]=_0x590141;const _0x2a053e=await _0x43ca9f[_0x75e01e(0x1cc)]();console[_0x75e01e(0x24a)](_0x2a053e);const _0x1f6d8b=await warehouse[_0x75e01e(0x1fc)]({'name':_0x47fcda,'room':_0x28ddae});_0x2a053e[_0x75e01e(0x23f)]['forEach'](_0x20e2b3=>{var _0x4ecf09=_0x75e01e;if(_0x20e2b3[_0x4ecf09(0x18b)]>0x0){const _0x3b2a38=_0x1f6d8b[_0x4ecf09(0x1b7)][_0x4ecf09(0x16b)](_0x270a60=>{var _0x24037a=_0x4ecf09;_0x270a60[_0x24037a(0x222)]==_0x20e2b3[_0x24037a(0x222)]&&_0x270a60[_0x24037a(0x169)]==_0x20e2b3[_0x24037a(0x15e)]&&_0x270a60[_0x24037a(0x212)]==_0x20e2b3[_0x24037a(0x219)]&&_0x270a60[_0x24037a(0x1d8)]==_0x20e2b3['from_bin']&&_0x270a60[_0x24037a(0x199)]==_0x20e2b3[_0x24037a(0x238)]&&_0x270a60[_0x24037a(0x1b4)]==_0x20e2b3[_0x24037a(0x242)]&&_0x270a60['storage']==_0x20e2b3['from_storage']&&(_0x270a60['product_stock']=parseInt(_0x270a60[_0x24037a(0x167)])-parseInt(_0x20e2b3[_0x24037a(0x18b)]));});}}),await _0x1f6d8b[_0x75e01e(0x1cc)]();const _0x148566=await warehouse[_0x75e01e(0x1fc)]({'name':_0x416489,'room':_0x24e35d});_0x2a053e['product'][_0x75e01e(0x221)](_0x4eb735=>{var _0x214590=_0x75e01e;if(_0x4eb735[_0x214590(0x18b)]>0x0){var _0x5aa7b5=0x0;const _0xdd92e6=_0x148566['product_details']['map'](_0x13e7d0=>{var _0x4ffdcd=_0x214590;_0x13e7d0['product_name']==_0x4eb735[_0x4ffdcd(0x222)]&&_0x13e7d0['floorlevel']==_0x4eb735['to_floorlevel']&&_0x13e7d0[_0x4ffdcd(0x212)]==_0x4eb735[_0x4ffdcd(0x1b3)]&&_0x13e7d0[_0x4ffdcd(0x1d8)]==_0x4eb735[_0x4ffdcd(0x237)]&&_0x13e7d0[_0x4ffdcd(0x199)]==_0x4eb735[_0x4ffdcd(0x1bf)]&&_0x13e7d0[_0x4ffdcd(0x1b4)]==_0x4eb735[_0x4ffdcd(0x1b4)]&&_0x13e7d0[_0x4ffdcd(0x233)]==_0x4eb735[_0x4ffdcd(0x233)]&&(_0x13e7d0[_0x4ffdcd(0x167)]=parseInt(_0x13e7d0[_0x4ffdcd(0x167)])+parseInt(_0x4eb735[_0x4ffdcd(0x18b)]),_0x5aa7b5++);});_0x5aa7b5=='0'&&(_0x148566[_0x214590(0x1b7)]=_0x148566[_0x214590(0x1b7)][_0x214590(0x22e)]({'product_name':_0x4eb735[_0x214590(0x222)],'product_stock':_0x4eb735['to_quantity'],'bay':_0x4eb735['to_bay'],'bin':_0x4eb735[_0x214590(0x237)],'type':_0x4eb735[_0x214590(0x1b3)],'floorlevel':_0x4eb735[_0x214590(0x18a)],'storage':_0x4eb735[_0x214590(0x233)],'rack':_0x4eb735[_0x214590(0x1b4)],'product_code':_0x4eb735[_0x214590(0x196)],'primary_code':_0x4eb735[_0x214590(0x1f1)],'secondary_code':_0x4eb735[_0x214590(0x215)],'maxProducts':_0x4eb735['maxProducts'],'storage':_0x4eb735['storage'],'rack':_0x4eb735[_0x214590(0x1b4)]}));}}),await _0x148566['save'](),_0x1b7619[_0x75e01e(0x18f)]('success',_0x75e01e(0x189)),_0x3af2c8['redirect'](_0x75e01e(0x1d7));}catch(_0x537833){console['log'](_0x537833);}}),router['post'](a0_0x5b2f7a(0x171),async(_0x6794ab,_0x4e6e11)=>{var _0x3b7719=a0_0x5b2f7a;const {FromWareHouse:_0x36bdb3,FromRoom:_0x293283,ToWarehouse:_0xc0c98b,ToRoom:_0x521f17,primary_code:_0x50eb2e,Roomslist:_0x217858}=_0x6794ab[_0x3b7719(0x218)],_0x5f4db1=_0x217858[_0x3b7719(0x190)](','),_0x243820=[];async function _0x37bc15(_0x362cc3){var _0x17740f=_0x3b7719;const _0x19a4e5=await warehouse['aggregate']([{'$match':{'name':_0x36bdb3,'room':_0x362cc3}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x50eb2e}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x17740f(0x23b)},'instock':{'$first':_0x17740f(0x16f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x17740f(0x175)},'product_code':{'$first':_0x17740f(0x1de)},'level':{'$first':_0x17740f(0x198)},'isle':{'$first':_0x17740f(0x1b8)},'type':{'$first':_0x17740f(0x1d3)},'pallet':{'$first':_0x17740f(0x18e)},'unit':{'$first':_0x17740f(0x1b5)},'secondary_unit':{'$first':_0x17740f(0x1f9)},'storage':{'$first':_0x17740f(0x1a2)},'rack':{'$first':_0x17740f(0x22d)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x17740f(0x248)},'batch_code':{'$first':_0x17740f(0x230)},'maxPerUnit':{'$first':_0x17740f(0x1a6)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x17740f(0x1ae)},'maxProducts':{'$first':_0x17740f(0x193)},'invoice_product':{'$first':_0x17740f(0x228)}}}]),_0x48e46d=await warehouse[_0x17740f(0x1ce)]([{'$match':{'name':_0x36bdb3,'room':_0x362cc3}},{'$unwind':_0x17740f(0x224)},{'$match':{'product_details.secondary_code':_0x50eb2e}},{'$group':{'_id':_0x17740f(0x163),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x17740f(0x16f)},'primary_code':{'$first':_0x17740f(0x15a)},'secondary_code':{'$first':_0x17740f(0x175)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x17740f(0x1d3)},'pallet':{'$first':_0x17740f(0x18e)},'unit':{'$first':_0x17740f(0x1b5)},'secondary_unit':{'$first':_0x17740f(0x1f9)},'storage':{'$first':_0x17740f(0x1a2)},'rack':{'$first':_0x17740f(0x22d)},'expiry_date':{'$first':_0x17740f(0x1f3)},'production_date':{'$first':_0x17740f(0x248)},'batch_code':{'$first':_0x17740f(0x230)},'maxPerUnit':{'$first':_0x17740f(0x1a6)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x17740f(0x1ae)},'maxProducts':{'$first':_0x17740f(0x193)},'invoice_product':{'$first':_0x17740f(0x228)}}}]);if(_0x19a4e5['length']>0x0)_0x243820[_0x17740f(0x1fa)](_0x19a4e5);else _0x48e46d[_0x17740f(0x1a8)]>0x0&&_0x243820[_0x17740f(0x1fa)](_0x48e46d);}const _0x5d0c4a=_0x5f4db1[_0x3b7719(0x16b)](_0x260213=>_0x37bc15(_0x260213));await Promise['all'](_0x5d0c4a),_0x4e6e11[_0x3b7719(0x1da)](_0x243820);}),router[a0_0x5b2f7a(0x1ec)](a0_0x5b2f7a(0x23e),async(_0x3437cb,_0x97d748)=>{var _0x3c873e=a0_0x5b2f7a;try{const {FromWareHouse:_0x122889,FromRoom:_0xb4e0f7,ToWarehouse:_0x214dc4,ToRoom:_0x585064,secondary_code:_0x269c9d}=_0x3437cb['body'],_0x52cafd=await warehouse[_0x3c873e(0x1ce)]([{'$match':{'name':_0x122889}},{'$unwind':_0x3c873e(0x224)},{'$match':{'product_details.secondary_code':_0x269c9d}},{'$group':{'_id':_0x3c873e(0x163),'name':{'$first':_0x3c873e(0x23b)},'primary_code':{'$first':_0x3c873e(0x15a)},'secondary_code':{'$first':_0x3c873e(0x175)},'product_code':{'$first':_0x3c873e(0x1de)},'instock':{'$first':_0x3c873e(0x16f)},'warehouse':{'$first':_0x3c873e(0x158)},'level':{'$first':_0x3c873e(0x200)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x3c873e(0x193)},'unit':{'$first':'$product_details.unit'}}}]);_0x97d748[_0x3c873e(0x244)](0xc8)[_0x3c873e(0x1da)](_0x52cafd);}catch(_0x4bc1e7){_0x97d748[_0x3c873e(0x244)](0x194)[_0x3c873e(0x1da)]({'message':_0x4bc1e7[_0x3c873e(0x168)]});}}),router['post']('/barcode_scanner3',async(_0x4ae8f8,_0x4839c9)=>{var _0x4a353a=a0_0x5b2f7a;try{const {FromWareHouse:_0x1d99bf,FromRoom:_0x1b7ad7,ToWarehouse:_0x376009,ToRoom:_0x17d5d5,product_code:_0x34bb0a}=_0x4ae8f8[_0x4a353a(0x218)],_0x70e369=await warehouse[_0x4a353a(0x1ce)]([{'$match':{'name':_0x1d99bf}},{'$unwind':_0x4a353a(0x224)},{'$match':{'product_details.product_code':_0x34bb0a}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4a353a(0x23b)},'primary_code':{'$first':_0x4a353a(0x15a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4a353a(0x1de)},'instock':{'$first':_0x4a353a(0x16f)},'warehouse':{'$first':_0x4a353a(0x158)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x4a353a(0x23c)},'pallet':{'$first':_0x4a353a(0x21a)},'maxProducts':{'$first':_0x4a353a(0x193)},'unit':{'$first':'$product_details.unit'}}}]);_0x4839c9['status'](0xc8)[_0x4a353a(0x1da)](_0x70e369);}catch(_0x58176b){_0x4839c9[_0x4a353a(0x244)](0x194)[_0x4a353a(0x1da)]({'message':_0x58176b['message']});}}),router[a0_0x5b2f7a(0x1ec)]('/CheckingWarehouse',async(_0x173a2c,_0x845edd)=>{var _0xb0a502=a0_0x5b2f7a;const {level:_0x23ecf2,isle:_0x5bbf26,pallet:_0x5c7950,warehouses:_0x39a15e,room:_0x285773}=_0x173a2c['body'];try{const _0xef1b17=await warehouse[_0xb0a502(0x1ce)]([{'$match':{'name':_0x39a15e,'room':_0x285773}},{'$unwind':_0xb0a502(0x224)},{'$match':{'product_details.level':parseInt(_0x23ecf2),'product_details.isle':_0x5bbf26,'product_details.pallet':parseInt(_0x5c7950)}},{'$group':{'_id':_0xb0a502(0x163),'name':{'$first':_0xb0a502(0x23b)},'product_stock':{'$first':_0xb0a502(0x16f)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0xb0a502(0x21a)},'maxProducts':{'$first':_0xb0a502(0x193)}}}]);_0x845edd[_0xb0a502(0x244)](0xc8)[_0xb0a502(0x1da)](_0xef1b17);}catch(_0x4049a8){_0x845edd[_0xb0a502(0x244)](0x194)[_0xb0a502(0x1da)]({'message':_0x4049a8['message']});}}),module[a0_0x5b2f7a(0x205)]=router;