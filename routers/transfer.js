var a0_0xa51cb4=a0_0x3e76;(function(_0x40289f,_0x5649b0){var _0x357dc4=a0_0x3e76,_0x5afd6f=_0x40289f();while(!![]){try{var _0x4b82cf=-parseInt(_0x357dc4(0x1e5))/0x1*(parseInt(_0x357dc4(0x209))/0x2)+parseInt(_0x357dc4(0x246))/0x3*(-parseInt(_0x357dc4(0x19a))/0x4)+parseInt(_0x357dc4(0x1d4))/0x5*(-parseInt(_0x357dc4(0x1c5))/0x6)+parseInt(_0x357dc4(0x225))/0x7+parseInt(_0x357dc4(0x1ac))/0x8*(parseInt(_0x357dc4(0x21e))/0x9)+parseInt(_0x357dc4(0x1f6))/0xa+-parseInt(_0x357dc4(0x272))/0xb;if(_0x4b82cf===_0x5649b0)break;else _0x5afd6f['push'](_0x5afd6f['shift']());}catch(_0x1ef34a){_0x5afd6f['push'](_0x5afd6f['shift']());}}}(a0_0x1ca7,0x79528));const express=require(a0_0xa51cb4(0x1ba)),app=express(),router=express[a0_0xa51cb4(0x20e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0xa51cb4(0x1af)),auth=require(a0_0xa51cb4(0x1a5)),users=require(a0_0xa51cb4(0x254)),nodemailer=require(a0_0xa51cb4(0x1e8));router[a0_0xa51cb4(0x1ae)](a0_0xa51cb4(0x1ab),auth,async(_0x32f079,_0x12eb1)=>{var _0x3322b5=a0_0xa51cb4;try{const {username:_0x3ac41c,email:_0x4f0e43,role:_0x28f226}=_0x32f079[_0x3322b5(0x202)],_0x143fa2=_0x32f079['user'],_0x5d712f=await profile[_0x3322b5(0x22c)]({'email':_0x143fa2['email']}),_0x499cd8=await master_shop[_0x3322b5(0x1b6)]();console[_0x3322b5(0x265)]('master',_0x499cd8);let _0x149c75;if(_0x143fa2[_0x3322b5(0x21a)]==_0x3322b5(0x242)){const _0x5730ff=await staff[_0x3322b5(0x22c)]({'email':_0x143fa2[_0x3322b5(0x259)]});_0x149c75=await transfers[_0x3322b5(0x1b6)]({'from_warehouse':_0x5730ff['warehouse']});}else _0x149c75=await transfers[_0x3322b5(0x1bb)]([{'$unwind':_0x3322b5(0x19f)},{'$group':{'_id':_0x3322b5(0x19b),'invoice':{'$first':_0x3322b5(0x26c)},'date':{'$first':_0x3322b5(0x285)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x3322b5(0x203)},'from_room_name':{'$addToSet':_0x3322b5(0x266)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x3322b5(0x1e7)},'isAllowEdit':{'$first':_0x3322b5(0x28f)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x499cd8[0x0][_0x3322b5(0x1ea)]=='English\x20(US)'){var _0x543a89=users[_0x3322b5(0x25b)];console[_0x3322b5(0x265)](_0x543a89);}else{if(_0x499cd8[0x0][_0x3322b5(0x1ea)]==_0x3322b5(0x1d8))var _0x543a89=users[_0x3322b5(0x1d8)];else{if(_0x499cd8[0x0][_0x3322b5(0x1ea)]==_0x3322b5(0x1f1))var _0x543a89=users['German'];else{if(_0x499cd8[0x0]['language']==_0x3322b5(0x22e))var _0x543a89=users[_0x3322b5(0x22e)];else{if(_0x499cd8[0x0]['language']==_0x3322b5(0x205))var _0x543a89=users[_0x3322b5(0x205)];else{if(_0x499cd8[0x0][_0x3322b5(0x1ea)]==_0x3322b5(0x1a8))var _0x543a89=users['Portuguese'];else{if(_0x499cd8[0x0][_0x3322b5(0x1ea)]==_0x3322b5(0x1e9))var _0x543a89=users[_0x3322b5(0x1e9)];else{if(_0x499cd8[0x0][_0x3322b5(0x1ea)]=='Arabic\x20(ae)')var _0x543a89=users[_0x3322b5(0x1ff)];}}}}}}}_0x12eb1[_0x3322b5(0x201)](_0x3322b5(0x1d2),{'success':_0x32f079[_0x3322b5(0x1a3)](_0x3322b5(0x1cc)),'errors':_0x32f079[_0x3322b5(0x1a3)](_0x3322b5(0x27a)),'role':_0x143fa2,'profile':_0x5d712f,'master_shop':_0x499cd8,'transfer':_0x149c75,'language':_0x543a89});}catch(_0x58d120){console[_0x3322b5(0x265)](_0x58d120);}});function a0_0x3e76(_0x50edea,_0x46765e){var _0x1ca782=a0_0x1ca7();return a0_0x3e76=function(_0x3e7612,_0x1cfffc){_0x3e7612=_0x3e7612-0x199;var _0x570fcf=_0x1ca782[_0x3e7612];return _0x570fcf;},a0_0x3e76(_0x50edea,_0x46765e);}async function getRandom8DigitNumber(){var _0x3a01bc=a0_0xa51cb4;const _0x790eaa=0x989680,_0x77f07c=0x5f5e0ff,_0x155b58=Math['floor'](Math[_0x3a01bc(0x28c)]()*(_0x77f07c-_0x790eaa+0x1))+_0x790eaa;var _0x556678;const _0x36f8df=await transfers[_0x3a01bc(0x22c)]({'invoice':_0x3a01bc(0x245)+_0x155b58});return _0x36f8df&&_0x36f8df[_0x3a01bc(0x295)]>0x0?_0x556678=_0x3a01bc(0x245)+_0x155b58:_0x556678=_0x3a01bc(0x245)+_0x155b58,_0x556678;}router[a0_0xa51cb4(0x1ae)](a0_0xa51cb4(0x244),auth,async(_0x166484,_0x23dd4d)=>{var _0x255941=a0_0xa51cb4;try{const {username:_0x1685fd,email:_0x4e3832,role:_0x268511}=_0x166484['user'],_0x1929a9=_0x166484[_0x255941(0x202)],_0x74cb88=await profile[_0x255941(0x22c)]({'email':_0x1929a9[_0x255941(0x259)]}),_0x3d226c=await master_shop[_0x255941(0x1b6)]();console['log'](_0x255941(0x19c),_0x3d226c);let _0x2a0e5a;if(_0x1929a9[_0x255941(0x21a)]==_0x255941(0x242)){const _0x424431=await staff[_0x255941(0x22c)]({'email':_0x1929a9[_0x255941(0x259)]});_0x2a0e5a=await warehouse[_0x255941(0x1bb)]([{'$match':{'status':_0x255941(0x21c),'name':_0x424431['warehouse'],'warehouse_category':_0x255941(0x260)}},{'$group':{'_id':_0x255941(0x20a),'name':{'$first':_0x255941(0x20a)}}}]);}else _0x2a0e5a=await warehouse['aggregate']([{'$match':{'status':_0x255941(0x21c),'warehouse_category':_0x255941(0x260)}},{'$group':{'_id':_0x255941(0x20a),'name':{'$first':_0x255941(0x20a)}}}]);var _0x6af58d=['Ambient',_0x255941(0x21b),_0x255941(0x231)];const _0x25eeff=await transfers[_0x255941(0x1b6)]({}),_0x547c6e=_0x25eeff['length']+0x1,_0x4daf0c='TRF-'+_0x547c6e[_0x255941(0x1cf)]()[_0x255941(0x1d1)](0x5,'0');if(_0x3d226c[0x0][_0x255941(0x1ea)]==_0x255941(0x1a0)){var _0xe2cc5=users[_0x255941(0x25b)];console[_0x255941(0x265)](_0xe2cc5);}else{if(_0x3d226c[0x0][_0x255941(0x1ea)]==_0x255941(0x1d8))var _0xe2cc5=users['Hindi'];else{if(_0x3d226c[0x0]['language']=='German')var _0xe2cc5=users[_0x255941(0x1f1)];else{if(_0x3d226c[0x0][_0x255941(0x1ea)]==_0x255941(0x22e))var _0xe2cc5=users[_0x255941(0x22e)];else{if(_0x3d226c[0x0]['language']==_0x255941(0x205))var _0xe2cc5=users[_0x255941(0x205)];else{if(_0x3d226c[0x0][_0x255941(0x1ea)]==_0x255941(0x1a8))var _0xe2cc5=users[_0x255941(0x23f)];else{if(_0x3d226c[0x0][_0x255941(0x1ea)]==_0x255941(0x1e9))var _0xe2cc5=users[_0x255941(0x1e9)];else{if(_0x3d226c[0x0][_0x255941(0x1ea)]=='Arabic\x20(ae)')var _0xe2cc5=users[_0x255941(0x1ff)];}}}}}}}const _0xe428d2=getRandom8DigitNumber();_0xe428d2[_0x255941(0x1f9)](_0x46ad36=>{var _0x186bda=_0x255941;_0x23dd4d[_0x186bda(0x201)](_0x186bda(0x1fa),{'success':_0x166484[_0x186bda(0x1a3)]('success'),'errors':_0x166484[_0x186bda(0x1a3)](_0x186bda(0x27a)),'role':_0x1929a9,'profile':_0x74cb88,'master_shop':_0x3d226c,'warehouse':_0x2a0e5a,'language':_0xe2cc5,'rooms_data':_0x6af58d,'invoice':_0x46ad36});})[_0x255941(0x1cb)](_0x367838=>{var _0x5efcc9=_0x255941;_0x166484[_0x5efcc9(0x1a3)](_0x5efcc9(0x27a),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x23dd4d['redirect'](_0x5efcc9(0x207));});}catch(_0x1fcae8){console[_0x255941(0x265)](_0x1fcae8);}}),router[a0_0xa51cb4(0x274)](a0_0xa51cb4(0x244),auth,async(_0x3e3228,_0x538322)=>{var _0x3202b5=a0_0xa51cb4;try{console[_0x3202b5(0x265)](_0x3e3228[_0x3202b5(0x262)]);const {date:_0x3b0ba0,from_warehouse:_0x2e722a,FromRoom_name:_0x4fd6ba,to_warehouse:_0x1efe38,ToRoom_name:_0x8d04e9,prod_name:_0x454066,from_prod_qty:_0x3c4c86,from_prod_level:_0x15ddeb,from_prod_isle:_0x426bff,from_prod_pallet:_0x15d456,to_prod_qty:_0x154ebe,to_prod_level:_0xb8d23,to_prod_isle:_0x1a6bc1,to_prod_pallet:_0x2e2334,primary_code:_0x35122e,secondary_code:_0x126e0c,product_code3:_0x4e01fc,note:_0xa785d9,MaxStocks_data2:_0xa79a10,invoice:_0x4e7124,expiry_date:_0x3212ac}=_0x3e3228[_0x3202b5(0x262)];if(typeof _0x454066==_0x3202b5(0x23c))var _0x40d3ed=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1e6)]],_0x2d9059=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1ed)]],_0x2bcfcd=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1e3)]],_0x4dcd1b=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x267)]],_0x51838b=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x275)]],_0x254b9f=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x20b)]],_0x262206=[_0x3e3228['body'][_0x3202b5(0x287)]],_0x17a771=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x253)]],_0x3d03f0=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1fb)]],_0x272637=[_0x3e3228['body'][_0x3202b5(0x233)]],_0x1a2f50=[_0x3e3228['body'][_0x3202b5(0x1c0)]],_0x2d05c9=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x22b)]],_0x292adc=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1e1)]],_0x346f3b=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1fd)]],_0x85edf7=[_0x3e3228['body']['production_date']],_0x45fd0c=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x268)]],_0x12d8de=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1a6)]],_0x38ea7c=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1a4)]],_0xd76017=[_0x3e3228['body'][_0x3202b5(0x1f2)]],_0x361710=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1f8)]],_0x354a1b=[_0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1b9)]];else var _0x40d3ed=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1e6)]],_0x2d9059=[..._0x3e3228['body']['from_prod_qty']],_0x2bcfcd=[..._0x3e3228['body']['from_prod_level']],_0x4dcd1b=[..._0x3e3228['body']['New_Qty_Converted']],_0x51838b=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x275)]],_0x254b9f=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x20b)]],_0x262206=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x287)]],_0x17a771=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x253)]],_0x3d03f0=[..._0x3e3228[_0x3202b5(0x262)]['MaxStocks_data2']],_0x272637=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x233)]],_0x1a2f50=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1c0)]],_0x2d05c9=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x22b)]],_0x292adc=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1e1)]],_0x346f3b=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1fd)]],_0x85edf7=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1dc)]],_0x45fd0c=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x268)]],_0x12d8de=[..._0x3e3228['body'][_0x3202b5(0x1a6)]],_0x38ea7c=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1a4)]],_0xd76017=[..._0x3e3228['body']['from_invoice']],_0x361710=[..._0x3e3228[_0x3202b5(0x262)][_0x3202b5(0x1f8)]],_0x354a1b=[..._0x3e3228['body']['id_transaction']];const _0x9580f1=_0x40d3ed['map'](_0x46ea74=>{return _0x46ea74={'product_name':_0x46ea74};});_0x2d9059[_0x3202b5(0x24d)]((_0x1d39f7,_0x44ac2d)=>{_0x9580f1[_0x44ac2d]['from_quantity']=_0x1d39f7;}),_0xd76017[_0x3202b5(0x24d)]((_0x31ba34,_0x1f457a)=>{var _0x944ad1=_0x3202b5;_0x9580f1[_0x1f457a][_0x944ad1(0x1f2)]=_0x31ba34;}),_0x361710[_0x3202b5(0x24d)]((_0x24c7d5,_0x46bfa1)=>{var _0x4e3fbe=_0x3202b5;_0x9580f1[_0x46bfa1][_0x4e3fbe(0x240)]=_0x24c7d5;}),_0x354a1b['forEach']((_0x291254,_0x2440ed)=>{var _0x180b18=_0x3202b5;_0x9580f1[_0x2440ed][_0x180b18(0x1b0)]=_0x291254;}),_0x2bcfcd[_0x3202b5(0x24d)]((_0x5b42ba,_0x58f444)=>{var _0x3dac9c=_0x3202b5;_0x12d8de[_0x3dac9c(0x24d)]((_0x50ba99,_0x58b0f3)=>{var _0x37ae37=_0x3dac9c;if(_0x50ba99==_0x37ae37(0x1c9)&&_0x58f444==_0x58b0f3){var _0x6778c6=_0x5b42ba[_0x37ae37(0x1da)](0x3);_0x9580f1[_0x58f444][_0x37ae37(0x255)]=_0x5b42ba[0x0],_0x9580f1[_0x58f444][_0x37ae37(0x273)]=_0x5b42ba[0x1],_0x9580f1[_0x58f444]['from_bay']=0x0,_0x9580f1[_0x58f444][_0x37ae37(0x229)]=0x0,_0x9580f1[_0x58f444][_0x37ae37(0x1be)]=_0x37ae37(0x278),_0x9580f1[_0x58f444][_0x37ae37(0x1c8)]=_0x6778c6;}else{if(_0x50ba99==_0x37ae37(0x210)&&_0x58f444==_0x58b0f3){var _0x6778c6=_0x5b42ba[_0x37ae37(0x1da)](0x3);_0x9580f1[_0x58f444][_0x37ae37(0x255)]=_0x5b42ba[0x0],_0x9580f1[_0x58f444]['from_rack']=_0x5b42ba[0x1],_0x9580f1[_0x58f444][_0x37ae37(0x19d)]=0x0,_0x9580f1[_0x58f444]['from_bin']=0x0,_0x9580f1[_0x58f444][_0x37ae37(0x1be)]=_0x37ae37(0x278),_0x9580f1[_0x58f444]['from_floorlevel']=_0x5b42ba[0x5];}else{if(_0x58f444==_0x58b0f3){if(_0x5b42ba[0x0]=='A'&&_0x5b42ba[0x1]=='L'&&_0x5b42ba[0x2]=='L')console[_0x37ae37(0x265)](_0x50ba99+'\x20<>\x20'+_0x58f444+_0x37ae37(0x1b2)+_0x58b0f3+_0x37ae37(0x1b2)+_0x5b42ba+_0x37ae37(0x1eb)),_0x9580f1[_0x58f444][_0x37ae37(0x255)]=_0x5b42ba[0x0],_0x9580f1[_0x58f444][_0x37ae37(0x273)]=_0x5b42ba[0x1],_0x9580f1[_0x58f444][_0x37ae37(0x19d)]=0x0,_0x9580f1[_0x58f444][_0x37ae37(0x229)]=0x0,_0x9580f1[_0x58f444][_0x37ae37(0x1be)]='Floor',_0x9580f1[_0x58f444][_0x37ae37(0x1c8)]=_0x5b42ba[0x3];else{var _0x582a16;if(_0x5b42ba[0x4]=='L')_0x582a16=_0x37ae37(0x236);else _0x5b42ba[0x4]=='F'&&(_0x582a16=_0x37ae37(0x278));_0x9580f1[_0x58f444]['from_storage']=_0x5b42ba[0x0],_0x9580f1[_0x58f444][_0x37ae37(0x273)]=_0x5b42ba[0x1],_0x9580f1[_0x58f444][_0x37ae37(0x19d)]=_0x5b42ba[0x2],_0x9580f1[_0x58f444][_0x37ae37(0x229)]=_0x5b42ba[0x3],_0x9580f1[_0x58f444][_0x37ae37(0x1be)]=_0x582a16,_0x9580f1[_0x58f444][_0x37ae37(0x1c8)]=_0x5b42ba[0x5];}}}}});}),_0x4dcd1b[_0x3202b5(0x24d)]((_0x21fefd,_0x33b024)=>{var _0x50b6f8=_0x3202b5;_0x9580f1[_0x33b024][_0x50b6f8(0x1ee)]=_0x21fefd;}),_0x51838b['forEach']((_0x57e724,_0x48fcab)=>{_0x38ea7c['forEach']((_0x42f4eb,_0x35c235)=>{var _0x30aefb=a0_0x3e76;if(_0x42f4eb==_0x30aefb(0x1c9)&&_0x48fcab==_0x35c235){var _0x3a42f4=_0x57e724[_0x30aefb(0x1da)](0x3);_0x9580f1[_0x48fcab][_0x30aefb(0x1f0)]=_0x57e724[0x0],_0x9580f1[_0x48fcab]['rack']=_0x57e724[0x1],_0x9580f1[_0x48fcab][_0x30aefb(0x1c3)]=0x0,_0x9580f1[_0x48fcab][_0x30aefb(0x270)]=0x0,_0x9580f1[_0x48fcab][_0x30aefb(0x1b7)]=_0x30aefb(0x278),_0x9580f1[_0x48fcab][_0x30aefb(0x1bf)]=_0x3a42f4;}else{if(_0x42f4eb==_0x30aefb(0x210)&&_0x48fcab==_0x35c235){var _0x3a42f4=_0x57e724[_0x30aefb(0x1da)](0x3);_0x9580f1[_0x48fcab][_0x30aefb(0x1f0)]=_0x57e724[0x0],_0x9580f1[_0x48fcab][_0x30aefb(0x1dd)]=_0x57e724[0x1],_0x9580f1[_0x48fcab]['to_bay']=0x0,_0x9580f1[_0x48fcab]['to_bin']=0x0,_0x9580f1[_0x48fcab][_0x30aefb(0x1b7)]=_0x30aefb(0x278),_0x9580f1[_0x48fcab]['to_floorlevel']=_0x57e724[0x5];}else{if(_0x48fcab==_0x35c235){if(_0x57e724[0x0]=='A'&&_0x57e724[0x1]=='L'&&_0x57e724[0x2]=='L')console[_0x30aefb(0x265)](_0x42f4eb+_0x30aefb(0x1b2)+_0x48fcab+_0x30aefb(0x1b2)+_0x35c235+'\x20<>\x20'+_0x57e724+'here'),_0x9580f1[_0x48fcab]['storage']=_0x57e724[0x0],_0x9580f1[_0x48fcab]['rack']=_0x57e724[0x1],_0x9580f1[_0x48fcab][_0x30aefb(0x1c3)]=0x0,_0x9580f1[_0x48fcab][_0x30aefb(0x270)]=0x0,_0x9580f1[_0x48fcab]['to_types']=_0x30aefb(0x278),_0x9580f1[_0x48fcab]['to_floorlevel']=_0x57e724[0x3];else{var _0x19380b;if(_0x57e724[0x4]=='L')_0x19380b=_0x30aefb(0x236);else _0x57e724[0x4]=='F'&&(_0x19380b=_0x30aefb(0x278));_0x9580f1[_0x48fcab][_0x30aefb(0x1f0)]=_0x57e724[0x0],_0x9580f1[_0x48fcab][_0x30aefb(0x1dd)]=_0x57e724[0x1],_0x9580f1[_0x48fcab][_0x30aefb(0x1c3)]=_0x57e724[0x2],_0x9580f1[_0x48fcab]['to_bin']=_0x57e724[0x3],_0x9580f1[_0x48fcab][_0x30aefb(0x1b7)]=_0x19380b,_0x9580f1[_0x48fcab][_0x30aefb(0x1bf)]=_0x57e724[0x5];}}}}});}),_0x254b9f[_0x3202b5(0x24d)]((_0x5573ee,_0x4b3bc3)=>{var _0x490ccd=_0x3202b5;_0x9580f1[_0x4b3bc3][_0x490ccd(0x20b)]=_0x5573ee;}),_0x262206[_0x3202b5(0x24d)]((_0x582062,_0x268c75)=>{var _0x4ed0af=_0x3202b5;_0x9580f1[_0x268c75][_0x4ed0af(0x287)]=_0x582062;}),_0x17a771['forEach']((_0x29d701,_0x5efee7)=>{_0x9580f1[_0x5efee7]['product_code']=_0x29d701;}),_0x3d03f0[_0x3202b5(0x24d)]((_0x23a244,_0x86240)=>{var _0x2522eb=_0x3202b5;_0x9580f1[_0x86240][_0x2522eb(0x24b)]=_0x23a244;}),_0x272637[_0x3202b5(0x24d)]((_0x46ed04,_0x58be0c)=>{var _0x22737f=_0x3202b5;_0x9580f1[_0x58be0c][_0x22737f(0x234)]=_0x46ed04;}),_0x1a2f50[_0x3202b5(0x24d)]((_0x4a879a,_0x238cd6)=>{var _0x288840=_0x3202b5;_0x9580f1[_0x238cd6][_0x288840(0x1c0)]=_0x4a879a;}),_0x2d05c9['forEach']((_0x2bec55,_0x344877)=>{var _0x5d49ad=_0x3202b5;_0x9580f1[_0x344877][_0x5d49ad(0x22b)]=_0x2bec55;}),_0x292adc[_0x3202b5(0x24d)]((_0x42d6bf,_0x496299)=>{var _0x17100a=_0x3202b5;_0x9580f1[_0x496299][_0x17100a(0x1e1)]=_0x42d6bf;}),_0x346f3b[_0x3202b5(0x24d)]((_0x1b4c23,_0x32f570)=>{var _0x5a780c=_0x3202b5;_0x9580f1[_0x32f570][_0x5a780c(0x1f3)]=_0x1b4c23;}),_0x85edf7['forEach']((_0x4b8c5f,_0x3dfa00)=>{var _0x24c9c0=_0x3202b5;_0x9580f1[_0x3dfa00][_0x24c9c0(0x1dc)]=_0x4b8c5f;}),_0x45fd0c['forEach']((_0x3aa84f,_0x277b9e)=>{_0x9580f1[_0x277b9e]['prod_cat']=_0x3aa84f;}),_0x12d8de[_0x3202b5(0x24d)]((_0x56df72,_0x53d140)=>{var _0x3abf69=_0x3202b5;_0x9580f1[_0x53d140][_0x3abf69(0x1a2)]=_0x56df72;}),_0x38ea7c['forEach']((_0x2e0f8c,_0x38f743)=>{var _0x126a76=_0x3202b5;_0x9580f1[_0x38f743][_0x126a76(0x247)]=_0x2e0f8c;});const _0x4a28e0=_0x9580f1[_0x3202b5(0x239)](_0x16e134=>_0x16e134[_0x3202b5(0x1ee)]!=='0'&&_0x16e134[_0x3202b5(0x1ee)]!==''||_0x16e134[_0x3202b5(0x1bf)]!=='0'&&_0x16e134['to_floorlevel']!==''),_0x588b74=new transfers({'date':_0x3b0ba0,'from_warehouse':_0x2e722a,'to_warehouse':_0x1efe38,'product':_0x4a28e0,'note':_0xa785d9,'invoice':_0x4e7124}),_0x1b4b80=await _0x588b74['save']();_0x3e3228[_0x3202b5(0x1a3)](_0x3202b5(0x1cc),'Product\x20Transfer\x20successfully'),_0x538322[_0x3202b5(0x227)](_0x3202b5(0x281)+_0x1b4b80['_id']);}catch(_0x533d20){console['log'](_0x533d20),_0x538322[_0x3202b5(0x23e)](0xc8)[_0x3202b5(0x1ca)]({'errorMessage':_0x533d20[_0x3202b5(0x20f)]});}}),router[a0_0xa51cb4(0x1ae)]('/preview/:id',auth,async(_0x3ed1c9,_0x52e1c6)=>{var _0x46bfc4=a0_0xa51cb4;try{const {username:_0xdabf2f,email:_0x257bb8,role:_0x4fa197}=_0x3ed1c9[_0x46bfc4(0x202)],_0xf26286=_0x3ed1c9[_0x46bfc4(0x202)],_0x2cf9ce=await profile['findOne']({'email':_0xf26286['email']}),_0x7d92cd=await master_shop[_0x46bfc4(0x1b6)]();console[_0x46bfc4(0x265)](_0x46bfc4(0x19c),_0x7d92cd);const _0x49cedd=await transfers['findById'](_0x3ed1c9['params']['id']);let _0x2353ea=new Date(_0x49cedd[_0x46bfc4(0x1e1)]),_0xa0032b=('0'+_0x2353ea[_0x46bfc4(0x19e)]())[_0x46bfc4(0x1da)](-0x2),_0x5da31c=('0'+(_0x2353ea[_0x46bfc4(0x1c2)]()+0x1))['slice'](-0x2),_0x4c3060=_0x2353ea['getFullYear'](),_0x125d87=_0x4c3060+'-'+_0x5da31c+'-'+_0xa0032b,_0x34f76e;if(_0xf26286[_0x46bfc4(0x21a)]=='staff'){const _0x55ee19=await staff[_0x46bfc4(0x22c)]({'email':_0xf26286['email']});_0x34f76e=await warehouse[_0x46bfc4(0x1b6)]({'status':_0x46bfc4(0x21c),'name':_0x55ee19[_0x46bfc4(0x221)],'warehouse_category':'Raw\x20Materials'});}else _0x34f76e=await warehouse[_0x46bfc4(0x1b6)]({'status':_0x46bfc4(0x21c),'warehouse_category':_0x46bfc4(0x260)});const _0x40e67c=await warehouse[_0x46bfc4(0x1bb)]([{'$match':{'name':_0x49cedd[_0x46bfc4(0x24f)]}},{'$unwind':_0x46bfc4(0x258)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x46bfc4(0x211)},'product_stock':{'$first':_0x46bfc4(0x1cd)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x46bfc4(0x216)},'type':{'$first':_0x46bfc4(0x279)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x46bfc4(0x199)},'secondary_code':{'$first':_0x46bfc4(0x1d5)},'product_code':{'$first':_0x46bfc4(0x1d9)},'storage':{'$first':_0x46bfc4(0x25e)},'rack':{'$first':_0x46bfc4(0x23d)},'expiry_date':{'$first':_0x46bfc4(0x25c)},'production_date':{'$first':_0x46bfc4(0x294)},'room':{'$first':_0x46bfc4(0x1ce)}}}]);if(_0x7d92cd[0x0][_0x46bfc4(0x1ea)]==_0x46bfc4(0x1a0)){var _0x5ab284=users[_0x46bfc4(0x25b)];console['log'](_0x5ab284);}else{if(_0x7d92cd[0x0][_0x46bfc4(0x1ea)]==_0x46bfc4(0x1d8))var _0x5ab284=users['Hindi'];else{if(_0x7d92cd[0x0][_0x46bfc4(0x1ea)]==_0x46bfc4(0x1f1))var _0x5ab284=users[_0x46bfc4(0x1f1)];else{if(_0x7d92cd[0x0][_0x46bfc4(0x1ea)]==_0x46bfc4(0x22e))var _0x5ab284=users[_0x46bfc4(0x22e)];else{if(_0x7d92cd[0x0][_0x46bfc4(0x1ea)]==_0x46bfc4(0x205))var _0x5ab284=users['French'];else{if(_0x7d92cd[0x0]['language']==_0x46bfc4(0x1a8))var _0x5ab284=users['Portuguese'];else{if(_0x7d92cd[0x0]['language']==_0x46bfc4(0x1e9))var _0x5ab284=users[_0x46bfc4(0x1e9)];else{if(_0x7d92cd[0x0]['language']=='Arabic\x20(ae)')var _0x5ab284=users[_0x46bfc4(0x1ff)];}}}}}}}_0x52e1c6[_0x46bfc4(0x201)](_0x46bfc4(0x1de),{'success':_0x3ed1c9[_0x46bfc4(0x1a3)]('success'),'errors':_0x3ed1c9[_0x46bfc4(0x1a3)](_0x46bfc4(0x27a)),'role':_0xf26286,'profile':_0x2cf9ce,'master_shop':_0x7d92cd,'warehouse':_0x34f76e,'transfer':_0x49cedd,'stock':_0x40e67c,'language':_0x5ab284});}catch(_0x4a7d32){console[_0x46bfc4(0x265)](_0x4a7d32);}}),router[a0_0xa51cb4(0x274)]('/preview/:id',auth,async(_0x394efd,_0x50e89a)=>{var _0x4a752b=a0_0xa51cb4;try{const _0x20a733=_0x394efd[_0x4a752b(0x212)]['id'],{from_warehouse:_0x47e744,FromRoom_name:_0x5c0263,to_warehouse:_0x518b90,ToRoom_name:_0x47f283}=_0x394efd['body'],_0x239134=await transfers[_0x4a752b(0x27e)]({'_id':_0x20a733}),_0x1cd77b=_0x239134[_0x4a752b(0x252)][_0x4a752b(0x27f)](async _0x862046=>{var _0x2de278=_0x4a752b;if(_0x862046[_0x2de278(0x1ee)]>0x0){var _0x5f3558=await warehouse[_0x2de278(0x22c)]({'name':_0x239134['from_warehouse'],'room':_0x862046[_0x2de278(0x1a2)],'warehouse_category':_0x2de278(0x260)});const _0x41c404=_0x5f3558[_0x2de278(0x1a9)][_0x2de278(0x27f)](_0x93283d=>{var _0x5c5008=_0x2de278;_0x93283d[_0x5c5008(0x222)]==_0x862046[_0x5c5008(0x222)]&&_0x93283d[_0x5c5008(0x1bc)]==_0x862046['from_floorlevel']&&_0x93283d[_0x5c5008(0x214)]==_0x862046[_0x5c5008(0x1be)]&&_0x93283d[_0x5c5008(0x22d)]==_0x862046[_0x5c5008(0x229)]&&_0x93283d[_0x5c5008(0x27c)]==_0x862046[_0x5c5008(0x19d)]&&_0x93283d[_0x5c5008(0x1dd)]==_0x862046['from_rack']&&_0x93283d[_0x5c5008(0x1f0)]==_0x862046[_0x5c5008(0x255)]&&_0x93283d[_0x5c5008(0x1e1)]==_0x862046[_0x5c5008(0x1e1)]&&_0x93283d[_0x5c5008(0x22b)]==_0x862046['batch_code']&&_0x93283d['production_date']==_0x862046['production_date']&&_0x93283d[_0x5c5008(0x1bd)]==_0x862046['from_invoice']&&_0x93283d[_0x5c5008(0x224)]==_0x862046['id_transaction_id']&&(_0x93283d[_0x5c5008(0x280)]=_0x93283d['product_stock']-_0x862046[_0x5c5008(0x1ee)]);});}return _0x5f3558;});Promise['all'](_0x1cd77b)[_0x4a752b(0x1f9)](async _0x1f8007=>{var _0x5d4107=_0x4a752b;try{for(const _0x55b5f4 of _0x1f8007){await _0x55b5f4['save']();}try{const _0x10a9c9=_0x239134['product'][_0x5d4107(0x27f)](async _0x2891ea=>{var _0x4856c5=_0x5d4107;if(_0x2891ea[_0x4856c5(0x1ee)]>0x0){var _0x48fd7a=await warehouse[_0x4856c5(0x22c)]({'name':_0x239134[_0x4856c5(0x27d)],'room':_0x2891ea[_0x4856c5(0x247)],'warehouse_category':'Raw\x20Materials'}),_0x15e5b1=0x0;const _0x5e7a5d=_0x48fd7a[_0x4856c5(0x1a9)][_0x4856c5(0x27f)](_0x37c866=>{var _0x443505=_0x4856c5;_0x37c866['product_name']==_0x2891ea['product_name']&&_0x37c866[_0x443505(0x1bc)]==_0x2891ea[_0x443505(0x1bf)]&&_0x37c866[_0x443505(0x214)]==_0x2891ea[_0x443505(0x1b7)]&&_0x37c866[_0x443505(0x22d)]==_0x2891ea['to_bin']&&_0x37c866[_0x443505(0x27c)]==_0x2891ea['to_bay']&&_0x37c866[_0x443505(0x1dd)]==_0x2891ea[_0x443505(0x1dd)]&&_0x37c866[_0x443505(0x1f0)]==_0x2891ea[_0x443505(0x1f0)]&&_0x37c866['expiry_date']==_0x2891ea['expiry_date']&&_0x37c866['batch_code']==_0x2891ea[_0x443505(0x22b)]&&_0x37c866['production_date']==_0x2891ea['production_date']&&_0x37c866[_0x443505(0x1bd)]==_0x2891ea[_0x443505(0x240)]&&(_0x37c866['product_stock']=_0x37c866['product_stock']+_0x2891ea[_0x443505(0x1ee)],_0x15e5b1++);});_0x15e5b1=='0'&&(_0x48fd7a['product_details']=_0x48fd7a[_0x4856c5(0x1a9)][_0x4856c5(0x277)]({'product_name':_0x2891ea[_0x4856c5(0x222)],'product_stock':_0x2891ea[_0x4856c5(0x1ee)],'bay':_0x2891ea[_0x4856c5(0x1c3)],'bin':_0x2891ea['to_bin'],'type':_0x2891ea[_0x4856c5(0x1b7)],'floorlevel':_0x2891ea['to_floorlevel'],'storage':_0x2891ea['storage'],'rack':_0x2891ea[_0x4856c5(0x1dd)],'product_code':_0x2891ea[_0x4856c5(0x293)],'primary_code':_0x2891ea[_0x4856c5(0x20b)],'secondary_code':_0x2891ea[_0x4856c5(0x287)],'maxProducts':_0x2891ea[_0x4856c5(0x24b)],'storage':_0x2891ea[_0x4856c5(0x1f0)],'rack':_0x2891ea[_0x4856c5(0x1dd)],'expiry_date':_0x2891ea[_0x4856c5(0x1e1)],'maxPerUnit':_0x2891ea[_0x4856c5(0x1f3)],'batch_code':_0x2891ea[_0x4856c5(0x22b)],'production_date':_0x2891ea[_0x4856c5(0x1dc)]}));}return _0x48fd7a;});Promise[_0x5d4107(0x26e)](_0x10a9c9)[_0x5d4107(0x1f9)](async _0x31b443=>{var _0x27ddfe=_0x5d4107;try{for(const _0x21b684 of _0x31b443){await warehouse[_0x27ddfe(0x291)]({'_id':_0x21b684['_id']},{'$addToSet':{'product_details':{'$each':_0x21b684[_0x27ddfe(0x1a9)]}}});}_0x239134[_0x27ddfe(0x269)]=_0x27ddfe(0x223);const _0x4fa380=await _0x239134[_0x27ddfe(0x241)](),_0xc6100b=await master_shop['find'](),_0xa35f7b=await email_settings['findOne'](),_0x32f82f=await supervisor_settings[_0x27ddfe(0x1b6)]();var _0xd0de72=_0x239134['product'],_0x5c9558='',_0x4aea96;for(_0x4aea96 in _0xd0de72){_0x5c9558+=_0x27ddfe(0x1ad)+_0x27ddfe(0x21f)+_0xd0de72[_0x4aea96]['product_name']+_0x27ddfe(0x24c)+_0x27ddfe(0x21f)+_0xd0de72[_0x4aea96][_0x27ddfe(0x293)]+'</td>'+_0x27ddfe(0x21f)+_0xd0de72[_0x4aea96][_0x27ddfe(0x1ee)]+_0x27ddfe(0x24c)+_0x27ddfe(0x21f)+_0xd0de72[_0x4aea96][_0x27ddfe(0x234)]+_0x27ddfe(0x24c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xd0de72[_0x4aea96]['secondary_unit']+'</td>'+_0x27ddfe(0x21f)+_0x239134[_0x27ddfe(0x27d)]+_0x27ddfe(0x24c)+_0x27ddfe(0x21f)+_0xd0de72[_0x4aea96][_0x27ddfe(0x247)]+_0x27ddfe(0x24c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xd0de72[_0x4aea96][_0x27ddfe(0x1f0)]+_0xd0de72[_0x4aea96][_0x27ddfe(0x1dd)]+_0xd0de72[_0x4aea96][_0x27ddfe(0x1c3)]+_0xd0de72[_0x4aea96][_0x27ddfe(0x270)]+_0xd0de72[_0x4aea96][_0x27ddfe(0x1b7)][0x0]+_0xd0de72[_0x4aea96][_0x27ddfe(0x1bf)]+_0x27ddfe(0x24c),_0x27ddfe(0x226);}let _0x2cc4f7=nodemailer[_0x27ddfe(0x1aa)]({'host':_0xa35f7b[_0x27ddfe(0x220)],'port':Number(_0xa35f7b[_0x27ddfe(0x228)]),'secure':![],'auth':{'user':_0xa35f7b['email'],'pass':_0xa35f7b[_0x27ddfe(0x282)]}}),_0x2107ac={'from':_0xa35f7b['email'],'to':_0x32f82f[0x0][_0x27ddfe(0x230)],'subject':_0x27ddfe(0x1d6),'attachments':[{'filename':_0x27ddfe(0x290),'path':__dirname+'/../public'+_0x27ddfe(0x1e4)+_0xc6100b[0x0][_0x27ddfe(0x1f4)],'cid':_0x27ddfe(0x208)}],'html':_0x27ddfe(0x1c6)+_0x27ddfe(0x1f5)+_0x27ddfe(0x1c7)+_0x27ddfe(0x206)+_0x27ddfe(0x23b)+_0x27ddfe(0x206)+_0x27ddfe(0x1a1)+_0x27ddfe(0x1c4)+_0x27ddfe(0x206)+_0x27ddfe(0x1fe)+_0xc6100b[0x0][_0x27ddfe(0x263)]+_0x27ddfe(0x28e)+_0x27ddfe(0x1c4)+_0x27ddfe(0x1c4)+_0x27ddfe(0x25a)+_0x27ddfe(0x206)+_0x27ddfe(0x286)+_0x27ddfe(0x26d)+_0x239134[_0x27ddfe(0x1bd)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x239134[_0x27ddfe(0x257)]+'\x20'+_0x27ddfe(0x218)+_0x27ddfe(0x1d3)+_0x27ddfe(0x1c4)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x27ddfe(0x1fc)+_0x27ddfe(0x1ad)+_0x27ddfe(0x20c)+_0x27ddfe(0x237)+_0x27ddfe(0x248)+_0x27ddfe(0x20d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x27ddfe(0x25f)+_0x27ddfe(0x1b1)+_0x27ddfe(0x1d7)+_0x27ddfe(0x226)+_0x27ddfe(0x26b)+_0x27ddfe(0x292)+'\x20'+_0x5c9558+'\x20'+_0x27ddfe(0x238)+_0x27ddfe(0x251)+_0x27ddfe(0x206)+'<strong>\x20Regards\x20</strong>'+_0x27ddfe(0x232)+_0xc6100b[0x0][_0x27ddfe(0x263)]+_0x27ddfe(0x1d3)+_0x27ddfe(0x1c4)+_0x27ddfe(0x1c4)+_0x27ddfe(0x1b8)};_0x2cc4f7[_0x27ddfe(0x217)](_0x2107ac,function(_0x808731,_0x36eb4c){var _0x4b2c3c=_0x27ddfe;_0x808731?(console[_0x4b2c3c(0x265)](_0x808731),console['log']('Error\x20Occurs')):console[_0x4b2c3c(0x265)](_0x4b2c3c(0x204));}),_0x394efd[_0x27ddfe(0x1a3)]('success',_0x27ddfe(0x22a)),_0x50e89a[_0x27ddfe(0x227)]('/picking_list/PDF_transfer_rm/'+_0x4fa380['_id']);}catch(_0x355734){console[_0x27ddfe(0x1db)](_0x355734),_0x50e89a[_0x27ddfe(0x23e)](0x1f4)[_0x27ddfe(0x1ca)]({'Perror':_0x27ddfe(0x235),'message':_0x355734[_0x27ddfe(0x20f)]});}})[_0x5d4107(0x1cb)](_0x4fb31d=>{var _0x2dee95=_0x5d4107;console[_0x2dee95(0x1db)](_0x4fb31d),_0x50e89a['status'](0x1f4)['json']({'Perror':_0x2dee95(0x276)});});}catch(_0x4213ce){_0x50e89a[_0x5d4107(0x1ca)](_0x4213ce);}}catch(_0x5b7a3d){console['error'](_0x5b7a3d),_0x50e89a['status'](0x1f4)['json']({'Merror':_0x5d4107(0x235),'Message':_0x5b7a3d[_0x5d4107(0x20f)]});}})[_0x4a752b(0x1cb)](_0x2db7e7=>{var _0xf498f0=_0x4a752b;console[_0xf498f0(0x1db)](_0x2db7e7),_0x50e89a[_0xf498f0(0x23e)](0x1f4)['json']({'Merror':_0xf498f0(0x276)});});}catch(_0x4c46d9){console[_0x4a752b(0x265)](_0x4c46d9);}});function a0_0x1ca7(){var _0xa8537d=['RMSEmail','Return\x20Rooms','<h5>','primary_unit','unit','An\x20error\x20occurred\x20while\x20saving\x20data.','Level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','</tbody>','filter','/barcode_scanner2','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','string','$product_details.rack','status','Portuguese','To_invoice','save','staff','/barcode_scanner','/view/add_transfer','TRF-','39myFIIx','to_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.batch_code','$product_details.maxProducts','maxProducts','</td>','forEach','Rack\x20E','from_warehouse','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','</table>','product','product_code3','../public/language/languages.json','from_storage','rak','date','$product_details','email','<hr\x20class=\x22my-3\x22>','English','$product_details.expiry_date','$product_details.pallet','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Raw\x20Materials','$product_details.floorlevel','body','site_title','/view/:id','log','$product.from_room_name','New_Qty_Converted','prod_cat','finalize','back','</thead>','$invoice','\x20Order\x20Number\x20:\x20','all','push','to_bin','to_room','4085169jeMLJw','from_rack','post','to_prod_level','An\x20error\x20occurred.','concat','Floor','$product_details.type','errors','$product_details.maxPerUnit','bay','to_warehouse','findById','map','product_stock','/transfer/preview/','password','Rack\x20D','from_prod_pallet','$date','<h5\x20style=\x22text-align:\x20left;\x22>','secondary_code','from_quantity','Arabic\x20(ae)','COLD\x20STORAGE','Transfer\x20Edit\x20Successfully','random','$product_details.level','\x20</h2>','$isAllowEdit','Logo.png','updateOne','<tbody\x20style=\x22text-align:\x20center;\x22>','product_code','$product_details.production_date','length','edit_transfer','$product_details.primary_code','119032fIFPih','$_id','master','from_bay','getDate','$product','English\x20(US)','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','from_room_name','flash','ToRoomAssigned','../middleware/auth','RoomAssigned','split','Portuguese\x20(BR)','product_details','createTransport','/view','24LRLWuQ','<tr>','get','../models/all_models','id_transaction_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','\x20<>\x20','from_prod_isle','/CheckingWarehouse','$product_details.unit','find','to_types','</body></html>','id_transaction','express','aggregate','floorlevel','invoice','from_types','to_floorlevel','secondary_unit','$product_details.isle','getMonth','to_bay','</div>','823002jSJbQy','<!DOCTYPE\x20html>','</head><body>','from_floorlevel','Receiving\x20Area','json','catch','success','$product_details.product_stock','$room','toString','from_rak','padStart','transfer','</h5>','10yQKhNp','$product_details.secondary_code','Transfer\x20Mail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Hindi','$product_details.product_code','slice','error','production_date','rack','edit_transfer_view','Rack\x20F','$product_details._id','expiry_date','DRY\x20STORAGE','from_prod_level','/upload/','4503rvnPuo','prod_name','$finalize','nodemailer','Chinese','language','here','to_prod_qty','from_prod_qty','to_quantity','to_prod_isle','storage','German','from_invoice','maxperunit','image','<html><head><title></title>','7752910xpuWFv','to_prod_pallet','to_invoice','then','add_transfer','MaxStocks_data2','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','max_per_unit','<h2>\x20','Arabic','$product_details.bay','render','user','$to_warehouse','Email\x20sent\x20successfully','French','<div>','/transfer/view','logo','294AMetED','$name','primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Router','message','Shelves','$product_details.product_name','params','Rack\x20B','type','from_room','$product_details.bin','sendMail','</span>','/barcode_scanner3','role','Enclosed','Enabled','$product_details.invoice','2587887vQqoNh','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','host','warehouse','product_name','True','_id','3874668NMLjHe','</tr>','redirect','port','from_bin','Transfer\x20Finalize\x20Successfully','batch_code','findOne','bin','Spanish','$product_details.secondary_unit'];a0_0x1ca7=function(){return _0xa8537d;};return a0_0x1ca7();}function BayBinSelected(_0x18a740,_0x9ad546){var _0x52f5ea=a0_0xa51cb4,_0x218c75=[],_0x5c1296=[],_0x29d447=[],_0x39358d=[],_0x5db372=[],_0x3daae7=[];let _0x16a505=[];if(_0x18a740==_0x52f5ea(0x1e2))switch(_0x9ad546){case'Rack\x20A':_0x218c75=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x5c1296=[0x1,0x2],_0x39358d=[0x1,0x2,0x3,0x4,0x5],_0x29d447=[_0x52f5ea(0x236),_0x52f5ea(0x278)],_0x5db372=['D'],_0x3daae7=['A'];break;case _0x52f5ea(0x213):_0x218c75=[0x6,0x5,0x4,0x3,0x2,0x1],_0x5c1296=[0x1,0x2],_0x39358d=[0x1,0x2,0x3,0x4,0x5],_0x29d447=[_0x52f5ea(0x236),'Floor'],_0x5db372=['D'],_0x3daae7=['B'];break;case _0x52f5ea(0x210):_0x218c75=[0x0],_0x5c1296=[0x0],_0x39358d=[0x1,0x2,0x3,0x4,0x5],_0x29d447=[_0x52f5ea(0x278)],_0x5db372=['D'],_0x3daae7=['S'];break;case'Receiving\x20Area':_0x218c75=[0x0],_0x5c1296=[0x0],_0x39358d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x29d447=[_0x52f5ea(0x278)],_0x5db372=['D'],_0x3daae7=['R'];break;}else{if(_0x18a740==_0x52f5ea(0x28a))switch(_0x9ad546){case'Rack\x20A':_0x218c75=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x5c1296=['B','F'],_0x39358d=[0x1,0x2,0x3,0x4,0x5],_0x29d447=['Level',_0x52f5ea(0x278)],_0x5db372=['C'],_0x3daae7=['A'];break;case _0x52f5ea(0x213):_0x218c75=[0x5,0x4,0x3,0x2,0x1],_0x5c1296=['F','B','S'],_0x39358d=[0x1,0x2,0x3,0x4,0x5],_0x29d447=[_0x52f5ea(0x236),_0x52f5ea(0x278)],_0x5db372=['C'],_0x3daae7=['B'];break;case'Rack\x20C':_0x218c75=[0x1,0x2,0x3,0x4,0x5],_0x5c1296=['B','F','S'],_0x39358d=[0x5,0x4,0x3,0x2,0x1],_0x29d447=[_0x52f5ea(0x236),_0x52f5ea(0x278)],_0x5db372=['C'],_0x3daae7=['C'];break;case _0x52f5ea(0x283):_0x218c75=[0x5,0x4,0x3,0x2,0x1],_0x5c1296=['F','B','S'],_0x39358d=[0x1,0x2,0x3,0x4,0x5],_0x29d447=[_0x52f5ea(0x236),_0x52f5ea(0x278)],_0x5db372=['C'],_0x3daae7=['D'];break;case _0x52f5ea(0x24e):_0x218c75=[0x4,0x3,0x2,0x1],_0x5c1296=[0x1,0x2],_0x39358d=[0x1,0x2,0x3,0x4,0x5],_0x29d447=[_0x52f5ea(0x236),_0x52f5ea(0x278)],_0x5db372=['C'],_0x3daae7=['E'];break;case _0x52f5ea(0x1df):_0x218c75=[0x1,0x2,0x3],_0x5c1296=[0x1,0x2],_0x39358d=[0x1,0x2,0x3,0x4,0x5],_0x29d447=['Level'],_0x5db372=['C'],_0x3daae7=['F'];break;}}return{'levels':_0x218c75,'Isle':_0x5c1296,'rack':_0x39358d,'type':_0x29d447,'storage':_0x5db372,'rak':_0x3daae7};}router['get'](a0_0xa51cb4(0x264),auth,async(_0x370846,_0x2596b6)=>{var _0x4d2483=a0_0xa51cb4;try{const {username:_0x22947b,email:_0x1b0747,role:_0x4e31f7}=_0x370846[_0x4d2483(0x202)],_0x42fe9a=_0x370846[_0x4d2483(0x202)],_0x4635de=await profile[_0x4d2483(0x22c)]({'email':_0x42fe9a[_0x4d2483(0x259)]}),_0x38e701=await master_shop[_0x4d2483(0x1b6)](),_0x4da529=await transfers[_0x4d2483(0x27e)](_0x370846[_0x4d2483(0x212)]['id']);let _0x5236c5;if(_0x42fe9a[_0x4d2483(0x21a)]==_0x4d2483(0x242)){const _0x4f8b01=await staff[_0x4d2483(0x22c)]({'email':_0x42fe9a[_0x4d2483(0x259)]});_0x5236c5=await warehouse[_0x4d2483(0x1bb)]([{'$match':{'status':_0x4d2483(0x21c),'name':_0x4f8b01['warehouse'],'warehouse_category':_0x4d2483(0x260)}},{'$group':{'_id':_0x4d2483(0x20a),'name':{'$first':'$name'}}}]);}else _0x5236c5=await warehouse[_0x4d2483(0x1bb)]([{'$match':{'status':'Enabled','warehouse_category':_0x4d2483(0x260)}},{'$group':{'_id':_0x4d2483(0x20a),'name':{'$first':'$name'}}}]);const _0x279d0d=await warehouse[_0x4d2483(0x1bb)]([{'$match':{'name':_0x4da529[_0x4d2483(0x24f)],'warehouse_category':_0x4d2483(0x260)}},{'$unwind':_0x4d2483(0x258)},{'$group':{'_id':_0x4d2483(0x1e0),'name':{'$first':_0x4d2483(0x211)},'product_stock':{'$first':_0x4d2483(0x1cd)},'bay':{'$first':_0x4d2483(0x200)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4d2483(0x279)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4d2483(0x1d5)},'product_code':{'$first':_0x4d2483(0x1d9)},'storage':{'$first':_0x4d2483(0x25e)},'rack':{'$first':_0x4d2483(0x23d)},'expiry_date':{'$first':_0x4d2483(0x25c)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x4d2483(0x1ce)}}}]),_0x28ba5e=await product[_0x4d2483(0x1b6)]({}),_0x415907=BayBinSelected(_0x4da529['to_warehouse'],_0x4da529[_0x4d2483(0x271)]);if(_0x38e701[0x0]['language']==_0x4d2483(0x1a0)){var _0x4ef0e9=users[_0x4d2483(0x25b)];console[_0x4d2483(0x265)](_0x4ef0e9);}else{if(_0x38e701[0x0][_0x4d2483(0x1ea)]==_0x4d2483(0x1d8))var _0x4ef0e9=users['Hindi'];else{if(_0x38e701[0x0][_0x4d2483(0x1ea)]=='German')var _0x4ef0e9=users[_0x4d2483(0x1f1)];else{if(_0x38e701[0x0][_0x4d2483(0x1ea)]==_0x4d2483(0x22e))var _0x4ef0e9=users['Spanish'];else{if(_0x38e701[0x0]['language']==_0x4d2483(0x205))var _0x4ef0e9=users[_0x4d2483(0x205)];else{if(_0x38e701[0x0]['language']==_0x4d2483(0x1a8))var _0x4ef0e9=users[_0x4d2483(0x23f)];else{if(_0x38e701[0x0][_0x4d2483(0x1ea)]=='Chinese')var _0x4ef0e9=users[_0x4d2483(0x1e9)];else{if(_0x38e701[0x0][_0x4d2483(0x1ea)]==_0x4d2483(0x289))var _0x4ef0e9=users['Arabic'];}}}}}}}_0x2596b6[_0x4d2483(0x201)](_0x4d2483(0x296),{'success':_0x370846['flash'](_0x4d2483(0x1cc)),'errors':_0x370846[_0x4d2483(0x1a3)]('errors'),'role':_0x42fe9a,'profile':_0x4635de,'master_shop':_0x38e701,'warehouse':_0x5236c5,'transfer':_0x4da529,'stock':_0x279d0d,'unit':_0x28ba5e,'language':_0x4ef0e9});}catch(_0x43d9b1){console[_0x4d2483(0x265)](_0x43d9b1);}}),router['post'](a0_0xa51cb4(0x264),auth,async(_0x23bdff,_0x120865)=>{var _0x1b2ec3=a0_0xa51cb4;try{const _0x32c60f=_0x23bdff['params']['id'],_0x3d84ca=await transfers[_0x1b2ec3(0x27e)](_0x32c60f);_0x120865['json'](_0x23bdff[_0x1b2ec3(0x262)]);return;const {date:_0x3a2099,from_warehouse:_0x555e14,FromRoom_name:_0xe5c64c,to_warehouse:_0x357689,ToRoom_name:_0x2d3909,prod_name:_0x1d32c1,from_prod_qty:_0x534edb,from_prod_level:_0x3be33d,from_prod_isle:_0x2c7edc,from_prod_pallet:_0x3c6a56,to_prod_qty:_0x31d01a,to_prod_level:_0x59a4c5,to_prod_isle:_0xd7c090,to_prod_pallet:_0x3ac147,primary_code:_0x22a508,secondary_code:_0x3752f8,product_code3:_0x351291,note:_0xff97bf,invoice:_0x403934,expiry_date:_0x51651c}=_0x23bdff[_0x1b2ec3(0x262)];if(typeof _0x1d32c1==_0x1b2ec3(0x23c))var _0xd65009=[_0x23bdff['body'][_0x1b2ec3(0x1e6)]],_0x38535d=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1ed)]],_0xc60627=[_0x23bdff['body'][_0x1b2ec3(0x1e3)]],_0x28968f=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1b3)]],_0xce2bad=[_0x23bdff['body'][_0x1b2ec3(0x284)]],_0x5e8e87=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1be)]],_0x2baaa2=[_0x23bdff['body'][_0x1b2ec3(0x1ec)]],_0x3d1e04=[_0x23bdff[_0x1b2ec3(0x262)]['to_prod_level']],_0x5ad68c=[_0x23bdff[_0x1b2ec3(0x262)]['to_prod_isle']],_0x5eaf72=[_0x23bdff[_0x1b2ec3(0x262)]['to_prod_pallet']],_0x99e31d=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1b7)]],_0x35d31a=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1f0)]],_0x3f1997=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x256)]],_0x45de5e=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x20b)]],_0x5cdbca=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x287)]],_0x1a8b39=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x253)]],_0x4ebcc3=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1fb)]],_0x2e2420=[_0x23bdff['body'][_0x1b2ec3(0x234)]],_0x417a13=[_0x23bdff['body'][_0x1b2ec3(0x1c0)]],_0x553c64=[_0x23bdff['body'][_0x1b2ec3(0x22b)]],_0x7d85ea=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1e1)]],_0x28857a=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x255)]],_0x2e6366=[_0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1d0)]];else var _0xd65009=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1e6)]],_0x35d31a=[..._0x23bdff['body'][_0x1b2ec3(0x1f0)]],_0x3f1997=[..._0x23bdff[_0x1b2ec3(0x262)]['rak']],_0x5e8e87=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1be)]],_0x99e31d=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1b7)]],_0x38535d=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1ed)]],_0xc60627=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1e3)]],_0x28968f=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1b3)]],_0xce2bad=[..._0x23bdff[_0x1b2ec3(0x262)]['from_prod_pallet']],_0x2baaa2=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1ec)]],_0x3d1e04=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x275)]],_0x5ad68c=[..._0x23bdff['body'][_0x1b2ec3(0x1ef)]],_0x5eaf72=[..._0x23bdff['body'][_0x1b2ec3(0x1f7)]],_0x45de5e=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x20b)]],_0x5cdbca=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x287)]],_0x1a8b39=[..._0x23bdff['body'][_0x1b2ec3(0x253)]],_0x4ebcc3=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1fb)]],_0x2e2420=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x234)]],_0x417a13=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1c0)]],_0x553c64=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x22b)]],_0x7d85ea=[..._0x23bdff['body'][_0x1b2ec3(0x1e1)]],_0x28857a=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x255)]],_0x2e6366=[..._0x23bdff[_0x1b2ec3(0x262)][_0x1b2ec3(0x1d0)]];const _0x5c2b5e=_0xd65009['map'](_0x964370=>{return _0x964370={'product_name':_0x964370};});_0x38535d['forEach']((_0x5873b4,_0x2b1636)=>{var _0xd6ff3b=_0x1b2ec3;_0x5c2b5e[_0x2b1636][_0xd6ff3b(0x288)]=_0x5873b4;}),_0xc60627['forEach']((_0x3455eb,_0x2040bb)=>{var _0x14fa41=_0x1b2ec3;_0x5c2b5e[_0x2040bb][_0x14fa41(0x19d)]=_0x3455eb;}),_0x28968f['forEach']((_0x2a8b87,_0x60af1a)=>{_0x5c2b5e[_0x60af1a]['from_bin']=_0x2a8b87;}),_0xce2bad['forEach']((_0x512bc3,_0xf4c399)=>{var _0x4a3e16=_0x1b2ec3;_0x5c2b5e[_0xf4c399][_0x4a3e16(0x1c8)]=_0x512bc3;}),_0x2baaa2[_0x1b2ec3(0x24d)]((_0x3e64bc,_0x3d6386)=>{_0x5c2b5e[_0x3d6386]['to_quantity']=_0x3e64bc;}),_0x3d1e04[_0x1b2ec3(0x24d)]((_0x571ff9,_0x5f4d8b)=>{var _0x2dcc8d=_0x1b2ec3;_0x5c2b5e[_0x5f4d8b][_0x2dcc8d(0x1c3)]=_0x571ff9;}),_0x5ad68c[_0x1b2ec3(0x24d)]((_0x37c99c,_0x2a7f49)=>{_0x5c2b5e[_0x2a7f49]['to_bin']=_0x37c99c;}),_0x5eaf72[_0x1b2ec3(0x24d)]((_0x471b14,_0x1eac3f)=>{var _0x5bc62d=_0x1b2ec3;_0x5c2b5e[_0x1eac3f][_0x5bc62d(0x1bf)]=_0x471b14;}),_0x45de5e[_0x1b2ec3(0x24d)]((_0x366bbe,_0x23c0e3)=>{_0x5c2b5e[_0x23c0e3]['primary_code']=_0x366bbe;}),_0x5cdbca[_0x1b2ec3(0x24d)]((_0xeda212,_0x31b88b)=>{var _0x50d0f8=_0x1b2ec3;_0x5c2b5e[_0x31b88b][_0x50d0f8(0x287)]=_0xeda212;}),_0x1a8b39[_0x1b2ec3(0x24d)]((_0x792e63,_0x40adca)=>{_0x5c2b5e[_0x40adca]['product_code']=_0x792e63;}),_0x4ebcc3[_0x1b2ec3(0x24d)]((_0x196437,_0x14b74a)=>{var _0x23c6d9=_0x1b2ec3;_0x5c2b5e[_0x14b74a][_0x23c6d9(0x24b)]=_0x196437;}),_0x2e2420[_0x1b2ec3(0x24d)]((_0x617fd7,_0x2cc20c)=>{var _0x566768=_0x1b2ec3;_0x5c2b5e[_0x2cc20c][_0x566768(0x234)]=_0x617fd7;}),_0x417a13[_0x1b2ec3(0x24d)]((_0x11c4a7,_0x37ceb3)=>{var _0x177889=_0x1b2ec3;_0x5c2b5e[_0x37ceb3][_0x177889(0x1c0)]=_0x11c4a7;}),_0x553c64['forEach']((_0x402cdd,_0x50b922)=>{var _0xa0af09=_0x1b2ec3;_0x5c2b5e[_0x50b922][_0xa0af09(0x22b)]=_0x402cdd;}),_0x7d85ea[_0x1b2ec3(0x24d)]((_0x402b8b,_0x23811c)=>{var _0x39a0b7=_0x1b2ec3;_0x5c2b5e[_0x23811c][_0x39a0b7(0x1e1)]=_0x402b8b;}),_0x35d31a[_0x1b2ec3(0x24d)]((_0x4f5bfd,_0x1f0ec7)=>{var _0x3bf2fb=_0x1b2ec3;_0x5c2b5e[_0x1f0ec7][_0x3bf2fb(0x1f0)]=_0x4f5bfd;}),_0x3f1997['forEach']((_0x4defe1,_0x5736bd)=>{var _0x583c59=_0x1b2ec3;_0x5c2b5e[_0x5736bd][_0x583c59(0x1dd)]=_0x4defe1;}),_0x5e8e87['forEach']((_0x10717a,_0x36494d)=>{_0x5c2b5e[_0x36494d]['from_types']=_0x10717a;}),_0x99e31d[_0x1b2ec3(0x24d)]((_0x20c42c,_0x31d13f)=>{var _0x4ddf14=_0x1b2ec3;_0x5c2b5e[_0x31d13f][_0x4ddf14(0x1b7)]=_0x20c42c;}),_0x28857a[_0x1b2ec3(0x24d)]((_0x3cf17d,_0x37b09b)=>{_0x5c2b5e[_0x37b09b]['from_storage']=_0x3cf17d;}),_0x2e6366[_0x1b2ec3(0x24d)]((_0x57f566,_0x4bdfc7)=>{var _0x2b7766=_0x1b2ec3;_0x5c2b5e[_0x4bdfc7][_0x2b7766(0x273)]=_0x57f566;});const _0x55027d=_0x5c2b5e['filter'](_0xf588cc=>_0xf588cc['to_quantity']!=='0'&&_0xf588cc[_0x1b2ec3(0x1ee)]!==''||_0xf588cc[_0x1b2ec3(0x1bf)]!=='0'&&_0xf588cc[_0x1b2ec3(0x1bf)]!=='');var _0x34ded1=0x0;_0x55027d[_0x1b2ec3(0x24d)](_0x9adb3=>{var _0x2c97af=_0x1b2ec3;parseInt(_0x9adb3[_0x2c97af(0x288)])<parseInt(_0x9adb3[_0x2c97af(0x1ee)])&&_0x34ded1++;});if(_0x34ded1!=0x0)return _0x23bdff['flash'](_0x1b2ec3(0x27a),_0x1b2ec3(0x250)),_0x120865[_0x1b2ec3(0x227)](_0x1b2ec3(0x26a));const _0x337028=await warehouse[_0x1b2ec3(0x22c)]({'name':_0x3d84ca['from_warehouse'],'room':_0x3d84ca[_0x1b2ec3(0x215)]});_0x3d84ca['product'][_0x1b2ec3(0x24d)](_0x38a73a=>{var _0x5001c1=_0x1b2ec3;if(_0x38a73a['to_quantity']>0x0){const _0x295025=_0x337028['product_details'][_0x5001c1(0x27f)](_0x5972ec=>{var _0x12feef=_0x5001c1;_0x5972ec[_0x12feef(0x222)]==_0x38a73a[_0x12feef(0x222)]&&_0x5972ec[_0x12feef(0x1bc)]==_0x38a73a[_0x12feef(0x1c8)]&&_0x5972ec[_0x12feef(0x214)]==_0x38a73a[_0x12feef(0x1be)]&&_0x5972ec['bin']==_0x38a73a[_0x12feef(0x229)]&&_0x5972ec[_0x12feef(0x27c)]==_0x38a73a[_0x12feef(0x19d)]&&_0x5972ec[_0x12feef(0x1dd)]==_0x38a73a[_0x12feef(0x273)]&&_0x5972ec[_0x12feef(0x1f0)]==_0x38a73a[_0x12feef(0x255)]&&(_0x5972ec['product_stock']=parseInt(_0x5972ec['product_stock'])+parseInt(_0x38a73a['to_quantity']));});}}),await _0x337028[_0x1b2ec3(0x241)]();const _0x29d7f=await warehouse[_0x1b2ec3(0x22c)]({'name':_0x3d84ca[_0x1b2ec3(0x27d)],'room':_0x3d84ca[_0x1b2ec3(0x271)]});_0x3d84ca[_0x1b2ec3(0x252)][_0x1b2ec3(0x24d)](_0x622ca9=>{var _0x3254c1=_0x1b2ec3;if(_0x622ca9[_0x3254c1(0x1ee)]>0x0){const _0x48da8f=_0x29d7f[_0x3254c1(0x1a9)][_0x3254c1(0x27f)](_0x57dff9=>{var _0x5e6664=_0x3254c1;_0x57dff9[_0x5e6664(0x222)]==_0x622ca9['product_name']&&_0x57dff9[_0x5e6664(0x1bc)]==_0x622ca9[_0x5e6664(0x1bf)]&&_0x57dff9[_0x5e6664(0x214)]==_0x622ca9[_0x5e6664(0x1b7)]&&_0x57dff9['bin']==_0x622ca9[_0x5e6664(0x270)]&&_0x57dff9[_0x5e6664(0x27c)]==_0x622ca9[_0x5e6664(0x1c3)]&&_0x57dff9['rack']==_0x622ca9[_0x5e6664(0x1dd)]&&_0x57dff9['storage']==_0x622ca9[_0x5e6664(0x1f0)]&&(_0x57dff9[_0x5e6664(0x280)]=parseInt(_0x57dff9[_0x5e6664(0x280)])-parseInt(_0x622ca9[_0x5e6664(0x1ee)]));});}}),await _0x29d7f[_0x1b2ec3(0x241)](),_0x3d84ca['date']=_0x3a2099,_0x3d84ca[_0x1b2ec3(0x24f)]=_0x555e14,_0x3d84ca[_0x1b2ec3(0x27d)]=_0x357689,_0x3d84ca['product']=_0x55027d,_0x3d84ca['note']=_0xff97bf,_0x3d84ca[_0x1b2ec3(0x1bd)]=_0x403934;const _0x7f87f8=await _0x3d84ca[_0x1b2ec3(0x241)]();console[_0x1b2ec3(0x265)](_0x7f87f8);const _0x3e64ab=await warehouse['findOne']({'name':_0x555e14,'room':_0xe5c64c});_0x7f87f8[_0x1b2ec3(0x252)]['forEach'](_0x35ef9a=>{var _0x1fbd66=_0x1b2ec3;if(_0x35ef9a['to_quantity']>0x0){const _0x59c4a6=_0x3e64ab[_0x1fbd66(0x1a9)]['map'](_0x3f7e85=>{var _0xf9ffaa=_0x1fbd66;_0x3f7e85[_0xf9ffaa(0x222)]==_0x35ef9a[_0xf9ffaa(0x222)]&&_0x3f7e85[_0xf9ffaa(0x1bc)]==_0x35ef9a[_0xf9ffaa(0x1c8)]&&_0x3f7e85[_0xf9ffaa(0x214)]==_0x35ef9a['from_types']&&_0x3f7e85[_0xf9ffaa(0x22d)]==_0x35ef9a[_0xf9ffaa(0x229)]&&_0x3f7e85[_0xf9ffaa(0x27c)]==_0x35ef9a[_0xf9ffaa(0x19d)]&&_0x3f7e85[_0xf9ffaa(0x1dd)]==_0x35ef9a[_0xf9ffaa(0x273)]&&_0x3f7e85['storage']==_0x35ef9a[_0xf9ffaa(0x255)]&&(_0x3f7e85[_0xf9ffaa(0x280)]=parseInt(_0x3f7e85[_0xf9ffaa(0x280)])-parseInt(_0x35ef9a[_0xf9ffaa(0x1ee)]));});}}),await _0x3e64ab[_0x1b2ec3(0x241)]();const _0x232c71=await warehouse[_0x1b2ec3(0x22c)]({'name':_0x357689,'room':_0x2d3909});_0x7f87f8[_0x1b2ec3(0x252)][_0x1b2ec3(0x24d)](_0x598ecf=>{var _0x57027e=_0x1b2ec3;if(_0x598ecf[_0x57027e(0x1ee)]>0x0){var _0x4fa331=0x0;const _0x3d3240=_0x232c71[_0x57027e(0x1a9)]['map'](_0x2d3725=>{var _0x350bbc=_0x57027e;_0x2d3725[_0x350bbc(0x222)]==_0x598ecf[_0x350bbc(0x222)]&&_0x2d3725[_0x350bbc(0x1bc)]==_0x598ecf['to_floorlevel']&&_0x2d3725[_0x350bbc(0x214)]==_0x598ecf[_0x350bbc(0x1b7)]&&_0x2d3725[_0x350bbc(0x22d)]==_0x598ecf[_0x350bbc(0x270)]&&_0x2d3725[_0x350bbc(0x27c)]==_0x598ecf[_0x350bbc(0x1c3)]&&_0x2d3725[_0x350bbc(0x1dd)]==_0x598ecf[_0x350bbc(0x1dd)]&&_0x2d3725[_0x350bbc(0x1f0)]==_0x598ecf[_0x350bbc(0x1f0)]&&(_0x2d3725['product_stock']=parseInt(_0x2d3725['product_stock'])+parseInt(_0x598ecf['to_quantity']),_0x4fa331++);});_0x4fa331=='0'&&(_0x232c71[_0x57027e(0x1a9)]=_0x232c71[_0x57027e(0x1a9)][_0x57027e(0x277)]({'product_name':_0x598ecf[_0x57027e(0x222)],'product_stock':_0x598ecf['to_quantity'],'bay':_0x598ecf[_0x57027e(0x1c3)],'bin':_0x598ecf['to_bin'],'type':_0x598ecf['to_types'],'floorlevel':_0x598ecf[_0x57027e(0x1bf)],'storage':_0x598ecf['storage'],'rack':_0x598ecf[_0x57027e(0x1dd)],'product_code':_0x598ecf['product_code'],'primary_code':_0x598ecf['primary_code'],'secondary_code':_0x598ecf[_0x57027e(0x287)],'maxProducts':_0x598ecf[_0x57027e(0x24b)],'storage':_0x598ecf[_0x57027e(0x1f0)],'rack':_0x598ecf[_0x57027e(0x1dd)]}));}}),await _0x232c71['save'](),_0x23bdff[_0x1b2ec3(0x1a3)]('success',_0x1b2ec3(0x28b)),_0x120865[_0x1b2ec3(0x227)](_0x1b2ec3(0x207));}catch(_0x14d45d){console[_0x1b2ec3(0x265)](_0x14d45d);}}),router[a0_0xa51cb4(0x274)](a0_0xa51cb4(0x243),async(_0x4620a1,_0x5ca05d)=>{var _0x5f2865=a0_0xa51cb4;const {FromWareHouse:_0x39d301,FromRoom:_0x1259ef,ToWarehouse:_0x567dd5,ToRoom:_0x5dbba9,primary_code:_0x1a83d7,Roomslist:_0x4937e3}=_0x4620a1[_0x5f2865(0x262)],_0x418862=_0x4937e3[_0x5f2865(0x1a7)](','),_0x5eb1cb=[];async function _0x37c1f2(_0x1548fa){var _0x19c022=_0x5f2865;const _0x34abe3=await warehouse[_0x19c022(0x1bb)]([{'$match':{'name':_0x39d301,'room':_0x1548fa}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x1a83d7}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x19c022(0x1cd)},'primary_code':{'$first':_0x19c022(0x199)},'secondary_code':{'$first':_0x19c022(0x1d5)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x19c022(0x200)},'isle':{'$first':_0x19c022(0x216)},'type':{'$first':_0x19c022(0x279)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x19c022(0x22f)},'storage':{'$first':_0x19c022(0x25e)},'rack':{'$first':_0x19c022(0x23d)},'expiry_date':{'$first':_0x19c022(0x25c)},'production_date':{'$first':_0x19c022(0x294)},'batch_code':{'$first':_0x19c022(0x249)},'maxPerUnit':{'$first':_0x19c022(0x27b)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x19c022(0x24a)},'invoice_product':{'$first':_0x19c022(0x21d)}}}]),_0x34f280=await warehouse[_0x19c022(0x1bb)]([{'$match':{'name':_0x39d301,'room':_0x1548fa}},{'$unwind':_0x19c022(0x258)},{'$match':{'product_details.secondary_code':_0x1a83d7}},{'$group':{'_id':_0x19c022(0x1e0),'name':{'$first':_0x19c022(0x211)},'instock':{'$first':_0x19c022(0x1cd)},'primary_code':{'$first':_0x19c022(0x199)},'secondary_code':{'$first':_0x19c022(0x1d5)},'product_code':{'$first':_0x19c022(0x1d9)},'level':{'$first':_0x19c022(0x200)},'isle':{'$first':_0x19c022(0x216)},'type':{'$first':_0x19c022(0x279)},'pallet':{'$first':_0x19c022(0x261)},'unit':{'$first':_0x19c022(0x1b5)},'secondary_unit':{'$first':_0x19c022(0x22f)},'storage':{'$first':_0x19c022(0x25e)},'rack':{'$first':_0x19c022(0x23d)},'expiry_date':{'$first':_0x19c022(0x25c)},'production_date':{'$first':_0x19c022(0x294)},'batch_code':{'$first':_0x19c022(0x249)},'maxPerUnit':{'$first':_0x19c022(0x27b)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x19c022(0x24a)},'invoice_product':{'$first':_0x19c022(0x21d)}}}]);if(_0x34abe3[_0x19c022(0x295)]>0x0)_0x5eb1cb['push'](_0x34abe3);else _0x34f280[_0x19c022(0x295)]>0x0&&_0x5eb1cb[_0x19c022(0x26f)](_0x34f280);}const _0x45b0d3=_0x418862[_0x5f2865(0x27f)](_0x51dc5a=>_0x37c1f2(_0x51dc5a));await Promise[_0x5f2865(0x26e)](_0x45b0d3),_0x5ca05d['json'](_0x5eb1cb);}),router[a0_0xa51cb4(0x274)](a0_0xa51cb4(0x23a),async(_0x3dd8b6,_0x18b971)=>{var _0x205c23=a0_0xa51cb4;try{const {FromWareHouse:_0x4f4b78,FromRoom:_0x4c4379,ToWarehouse:_0x9d948b,ToRoom:_0x3e6ee8,secondary_code:_0x1831a5}=_0x3dd8b6[_0x205c23(0x262)],_0x4d707e=await warehouse[_0x205c23(0x1bb)]([{'$match':{'name':_0x4f4b78}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x1831a5}},{'$group':{'_id':_0x205c23(0x1e0),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x205c23(0x199)},'secondary_code':{'$first':_0x205c23(0x1d5)},'product_code':{'$first':_0x205c23(0x1d9)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x205c23(0x20a)},'level':{'$first':_0x205c23(0x28d)},'isle':{'$first':_0x205c23(0x1c1)},'pallet':{'$first':_0x205c23(0x25d)},'maxProducts':{'$first':_0x205c23(0x24a)},'unit':{'$first':_0x205c23(0x1b5)}}}]);_0x18b971[_0x205c23(0x23e)](0xc8)[_0x205c23(0x1ca)](_0x4d707e);}catch(_0x4473e5){_0x18b971['status'](0x194)[_0x205c23(0x1ca)]({'message':_0x4473e5['message']});}}),router[a0_0xa51cb4(0x274)](a0_0xa51cb4(0x219),async(_0x152426,_0x30341c)=>{var _0x2b9973=a0_0xa51cb4;try{const {FromWareHouse:_0x94ab39,FromRoom:_0x4f40f8,ToWarehouse:_0x27b689,ToRoom:_0xa2d0f9,product_code:_0x3dded5}=_0x152426[_0x2b9973(0x262)],_0x2e9cbd=await warehouse['aggregate']([{'$match':{'name':_0x94ab39}},{'$unwind':_0x2b9973(0x258)},{'$match':{'product_details.product_code':_0x3dded5}},{'$group':{'_id':_0x2b9973(0x1e0),'name':{'$first':_0x2b9973(0x211)},'primary_code':{'$first':_0x2b9973(0x199)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2b9973(0x1d9)},'instock':{'$first':_0x2b9973(0x1cd)},'warehouse':{'$first':_0x2b9973(0x20a)},'level':{'$first':_0x2b9973(0x28d)},'isle':{'$first':_0x2b9973(0x1c1)},'pallet':{'$first':_0x2b9973(0x25d)},'maxProducts':{'$first':_0x2b9973(0x24a)},'unit':{'$first':_0x2b9973(0x1b5)}}}]);_0x30341c[_0x2b9973(0x23e)](0xc8)['json'](_0x2e9cbd);}catch(_0x337421){_0x30341c[_0x2b9973(0x23e)](0x194)[_0x2b9973(0x1ca)]({'message':_0x337421[_0x2b9973(0x20f)]});}}),router[a0_0xa51cb4(0x274)](a0_0xa51cb4(0x1b4),async(_0x28fa76,_0x378dd3)=>{var _0x33a6d4=a0_0xa51cb4;const {level:_0x2aa168,isle:_0x3f4b7b,pallet:_0x55f3a2,warehouses:_0x20ab50,room:_0x394600}=_0x28fa76[_0x33a6d4(0x262)];try{const _0x148a9f=await warehouse[_0x33a6d4(0x1bb)]([{'$match':{'name':_0x20ab50,'room':_0x394600}},{'$unwind':_0x33a6d4(0x258)},{'$match':{'product_details.level':parseInt(_0x2aa168),'product_details.isle':_0x3f4b7b,'product_details.pallet':parseInt(_0x55f3a2)}},{'$group':{'_id':_0x33a6d4(0x1e0),'name':{'$first':_0x33a6d4(0x211)},'product_stock':{'$first':_0x33a6d4(0x1cd)},'level':{'$first':_0x33a6d4(0x28d)},'isle':{'$first':_0x33a6d4(0x1c1)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x378dd3[_0x33a6d4(0x23e)](0xc8)['json'](_0x148a9f);}catch(_0x361f84){_0x378dd3[_0x33a6d4(0x23e)](0x194)[_0x33a6d4(0x1ca)]({'message':_0x361f84['message']});}}),module['exports']=router;