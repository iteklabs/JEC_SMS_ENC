var a0_0x45dd62=a0_0x3cc7;(function(_0xc4f17f,_0x38b6b7){var _0x142de9=a0_0x3cc7,_0x1123cb=_0xc4f17f();while(!![]){try{var _0x4811e5=parseInt(_0x142de9(0x7b))/0x1*(-parseInt(_0x142de9(0xa8))/0x2)+-parseInt(_0x142de9(0xe2))/0x3*(parseInt(_0x142de9(0xaf))/0x4)+-parseInt(_0x142de9(0x145))/0x5*(-parseInt(_0x142de9(0x15f))/0x6)+parseInt(_0x142de9(0x9e))/0x7+parseInt(_0x142de9(0x121))/0x8*(parseInt(_0x142de9(0xec))/0x9)+parseInt(_0x142de9(0xd6))/0xa+-parseInt(_0x142de9(0x11a))/0xb;if(_0x4811e5===_0x38b6b7)break;else _0x1123cb['push'](_0x1123cb['shift']());}catch(_0x809028){_0x1123cb['push'](_0x1123cb['shift']());}}}(a0_0x53f4,0xe6837));const express=require(a0_0x45dd62(0xe0)),app=express(),router=express[a0_0x45dd62(0x130)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x45dd62(0x72)),auth=require('../middleware/auth'),users=require(a0_0x45dd62(0xcc)),nodemailer=require('nodemailer');router['get']('/view',auth,async(_0x523680,_0x2ff7f9)=>{var _0x35e5e6=a0_0x45dd62;try{const {username:_0x56cde9,email:_0x33d7b0,role:_0x5b4dbc}=_0x523680['user'],_0xb76cf5=_0x523680['user'],_0x56c308=await profile['findOne']({'email':_0xb76cf5[_0x35e5e6(0x75)]}),_0x3b61d1=await master_shop[_0x35e5e6(0x106)]();console['log']('master',_0x3b61d1);let _0x14c570;if(_0xb76cf5[_0x35e5e6(0xb6)]=='staff'){const _0xa9dfd=await staff['findOne']({'email':_0xb76cf5[_0x35e5e6(0x75)]});_0x14c570=await transfers[_0x35e5e6(0x106)]({'from_warehouse':_0xa9dfd[_0x35e5e6(0x142)]});}else _0x14c570=await transfers[_0x35e5e6(0x101)]([{'$unwind':'$product'},{'$group':{'_id':_0x35e5e6(0x126),'invoice':{'$first':_0x35e5e6(0x11d)},'date':{'$first':_0x35e5e6(0x156)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x35e5e6(0xb2)},'to_room_name':{'$addToSet':_0x35e5e6(0xe9)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x35e5e6(0xd5)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3b61d1[0x0][_0x35e5e6(0x82)]==_0x35e5e6(0x154)){var _0x48464b=users[_0x35e5e6(0xaa)];console['log'](_0x48464b);}else{if(_0x3b61d1[0x0][_0x35e5e6(0x82)]==_0x35e5e6(0x81))var _0x48464b=users[_0x35e5e6(0x81)];else{if(_0x3b61d1[0x0][_0x35e5e6(0x82)]==_0x35e5e6(0x9b))var _0x48464b=users[_0x35e5e6(0x9b)];else{if(_0x3b61d1[0x0][_0x35e5e6(0x82)]==_0x35e5e6(0x13b))var _0x48464b=users[_0x35e5e6(0x13b)];else{if(_0x3b61d1[0x0][_0x35e5e6(0x82)]==_0x35e5e6(0x111))var _0x48464b=users[_0x35e5e6(0x111)];else{if(_0x3b61d1[0x0][_0x35e5e6(0x82)]==_0x35e5e6(0x150))var _0x48464b=users[_0x35e5e6(0x9d)];else{if(_0x3b61d1[0x0][_0x35e5e6(0x82)]==_0x35e5e6(0x97))var _0x48464b=users[_0x35e5e6(0x97)];else{if(_0x3b61d1[0x0]['language']==_0x35e5e6(0xd8))var _0x48464b=users[_0x35e5e6(0x80)];}}}}}}}_0x2ff7f9['render']('transfer',{'success':_0x523680[_0x35e5e6(0x14a)](_0x35e5e6(0xe5)),'errors':_0x523680[_0x35e5e6(0x14a)]('errors'),'role':_0xb76cf5,'profile':_0x56c308,'master_shop':_0x3b61d1,'transfer':_0x14c570,'language':_0x48464b});}catch(_0x9ae4d6){console[_0x35e5e6(0x144)](_0x9ae4d6);}});async function getRandom8DigitNumber(){var _0x59c678=a0_0x45dd62;const _0x110f0a=0x989680,_0x312928=0x5f5e0ff,_0x29aaba=Math['floor'](Math[_0x59c678(0x73)]()*(_0x312928-_0x110f0a+0x1))+_0x110f0a;var _0x121e9b;const _0x185649=await transfers[_0x59c678(0x114)]({'invoice':'TRF-'+_0x29aaba});return _0x185649&&_0x185649[_0x59c678(0x102)]>0x0?_0x121e9b=_0x59c678(0x7f)+_0x29aaba:_0x121e9b='TRF-'+_0x29aaba,_0x121e9b;}function a0_0x3cc7(_0x28f537,_0x515adb){var _0x53f4bb=a0_0x53f4();return a0_0x3cc7=function(_0x3cc719,_0x7b1828){_0x3cc719=_0x3cc719-0x71;var _0xcd1530=_0x53f4bb[_0x3cc719];return _0xcd1530;},a0_0x3cc7(_0x28f537,_0x515adb);}router[a0_0x45dd62(0x11e)](a0_0x45dd62(0x12b),auth,async(_0x58056d,_0x2df9a6)=>{var _0x4d3612=a0_0x45dd62;try{const {username:_0x196ac4,email:_0x58133d,role:_0x344d63}=_0x58056d[_0x4d3612(0xc0)],_0x3289b9=_0x58056d[_0x4d3612(0xc0)],_0x2fb2f5=await profile[_0x4d3612(0x114)]({'email':_0x3289b9[_0x4d3612(0x75)]}),_0x5242ba=await master_shop[_0x4d3612(0x106)]();console[_0x4d3612(0x144)]('master',_0x5242ba);let _0xaf257;if(_0x3289b9['role']=='staff'){const _0x3b452e=await staff[_0x4d3612(0x114)]({'email':_0x3289b9['email']});_0xaf257=await warehouse[_0x4d3612(0x101)]([{'$match':{'status':_0x4d3612(0x10e),'name':_0x3b452e['warehouse'],'warehouse_category':_0x4d3612(0x116)}},{'$group':{'_id':_0x4d3612(0x160),'name':{'$first':'$name'}}}]);}else _0xaf257=await warehouse[_0x4d3612(0x101)]([{'$match':{'status':_0x4d3612(0x10e),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4d3612(0x160),'name':{'$first':_0x4d3612(0x160)}}}]);var _0x4903fa=['Ambient',_0x4d3612(0x129),'Return\x20Rooms'];const _0x5560da=await transfers[_0x4d3612(0x106)]({}),_0x3a6ff9=_0x5560da[_0x4d3612(0x102)]+0x1,_0x15c637=_0x4d3612(0x7f)+_0x3a6ff9[_0x4d3612(0x98)]()['padStart'](0x5,'0');if(_0x5242ba[0x0]['language']=='English\x20(US)'){var _0x27c7ff=users[_0x4d3612(0xaa)];console['log'](_0x27c7ff);}else{if(_0x5242ba[0x0][_0x4d3612(0x82)]=='Hindi')var _0x27c7ff=users['Hindi'];else{if(_0x5242ba[0x0]['language']=='German')var _0x27c7ff=users[_0x4d3612(0x9b)];else{if(_0x5242ba[0x0][_0x4d3612(0x82)]==_0x4d3612(0x13b))var _0x27c7ff=users[_0x4d3612(0x13b)];else{if(_0x5242ba[0x0][_0x4d3612(0x82)]=='French')var _0x27c7ff=users[_0x4d3612(0x111)];else{if(_0x5242ba[0x0][_0x4d3612(0x82)]==_0x4d3612(0x150))var _0x27c7ff=users[_0x4d3612(0x9d)];else{if(_0x5242ba[0x0][_0x4d3612(0x82)]=='Chinese')var _0x27c7ff=users[_0x4d3612(0x97)];else{if(_0x5242ba[0x0]['language']==_0x4d3612(0xd8))var _0x27c7ff=users[_0x4d3612(0x80)];}}}}}}}const _0x12d8b8=getRandom8DigitNumber();_0x12d8b8[_0x4d3612(0xf6)](_0x26f37a=>{var _0x3dbe49=_0x4d3612;_0x2df9a6[_0x3dbe49(0x151)](_0x3dbe49(0xac),{'success':_0x58056d[_0x3dbe49(0x14a)](_0x3dbe49(0xe5)),'errors':_0x58056d[_0x3dbe49(0x14a)](_0x3dbe49(0xba)),'role':_0x3289b9,'profile':_0x2fb2f5,'master_shop':_0x5242ba,'warehouse':_0xaf257,'language':_0x27c7ff,'rooms_data':_0x4903fa,'invoice':_0x26f37a});})[_0x4d3612(0x9c)](_0x5f138e=>{var _0x16b0ac=_0x4d3612;_0x58056d['flash'](_0x16b0ac(0xba),_0x16b0ac(0x86)),_0x2df9a6['redirect'](_0x16b0ac(0x71));});}catch(_0x321f9c){console[_0x4d3612(0x144)](_0x321f9c);}}),router[a0_0x45dd62(0x13a)]('/view/add_transfer',auth,async(_0x268a32,_0x7157aa)=>{var _0xc1947a=a0_0x45dd62;try{console[_0xc1947a(0x144)](_0x268a32[_0xc1947a(0x161)]);const {date:_0x4b8376,from_warehouse:_0x595505,FromRoom_name:_0x16d89b,to_warehouse:_0x40d32b,ToRoom_name:_0x30a0e5,prod_name:_0x8e7a82,from_prod_qty:_0x46ac00,from_prod_level:_0x4f0370,from_prod_isle:_0x1350af,from_prod_pallet:_0x78624e,to_prod_qty:_0x34ef9c,to_prod_level:_0x1f5134,to_prod_isle:_0x559558,to_prod_pallet:_0x2e1646,primary_code:_0x39646f,secondary_code:_0x30c85f,product_code3:_0x329c0a,note:_0x5e40ba,MaxStocks_data2:_0x324014,invoice:_0x572aaf,expiry_date:_0x4fe977}=_0x268a32[_0xc1947a(0x161)];if(typeof _0x8e7a82==_0xc1947a(0x14b))var _0x163ed7=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0x149)]],_0x7156fb=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0x84)]],_0x18ad37=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0xb5)]],_0x2aeddd=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0xd1)]],_0x295e81=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0xde)]],_0x134946=[_0x268a32[_0xc1947a(0x161)]['primary_code']],_0x48c322=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0x120)]],_0x22a123=[_0x268a32['body']['product_code3']],_0x1cf9b5=[_0x268a32[_0xc1947a(0x161)]['MaxStocks_data2']],_0x3c6a79=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0x117)]],_0x24253f=[_0x268a32[_0xc1947a(0x161)]['secondary_unit']],_0x398f36=[_0x268a32['body'][_0xc1947a(0x7a)]],_0x525b58=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0x112)]],_0x14a3e9=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0xbb)]],_0xb73761=[_0x268a32['body'][_0xc1947a(0x92)]],_0x4f2cd2=[_0x268a32[_0xc1947a(0x161)]['prod_cat']],_0x4ad52a=[_0x268a32[_0xc1947a(0x161)]['RoomAssigned']],_0x3c409d=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0x15b)]],_0x30b3ac=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0xcd)]],_0x34a780=[_0x268a32[_0xc1947a(0x161)][_0xc1947a(0xa0)]],_0xa4d9fd=[_0x268a32['body'][_0xc1947a(0x105)]];else var _0x163ed7=[..._0x268a32[_0xc1947a(0x161)]['prod_name']],_0x7156fb=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0x84)]],_0x18ad37=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0xb5)]],_0x2aeddd=[..._0x268a32[_0xc1947a(0x161)]['New_Qty_Converted']],_0x295e81=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0xde)]],_0x134946=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0xc9)]],_0x48c322=[..._0x268a32['body'][_0xc1947a(0x120)]],_0x22a123=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0x8c)]],_0x1cf9b5=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0x13d)]],_0x3c6a79=[..._0x268a32[_0xc1947a(0x161)]['primary_unit']],_0x24253f=[..._0x268a32['body'][_0xc1947a(0xf4)]],_0x398f36=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0x7a)]],_0x525b58=[..._0x268a32['body'][_0xc1947a(0x112)]],_0x14a3e9=[..._0x268a32[_0xc1947a(0x161)]['max_per_unit']],_0xb73761=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0x92)]],_0x4f2cd2=[..._0x268a32[_0xc1947a(0x161)]['prod_cat']],_0x4ad52a=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0xe8)]],_0x3c409d=[..._0x268a32[_0xc1947a(0x161)]['ToRoomAssigned']],_0x30b3ac=[..._0x268a32[_0xc1947a(0x161)]['from_invoice']],_0x34a780=[..._0x268a32[_0xc1947a(0x161)][_0xc1947a(0xa0)]],_0xa4d9fd=[..._0x268a32[_0xc1947a(0x161)]['id_transaction']];const _0x37745e=_0x163ed7[_0xc1947a(0xf0)](_0x6a5d04=>{return _0x6a5d04={'product_name':_0x6a5d04};});_0x7156fb['forEach']((_0x1d0913,_0x5d28c1)=>{_0x37745e[_0x5d28c1]['from_quantity']=_0x1d0913;}),_0x30b3ac['forEach']((_0x2b75eb,_0x2a23e0)=>{_0x37745e[_0x2a23e0]['from_invoice']=_0x2b75eb;}),_0x34a780[_0xc1947a(0x127)]((_0x81516a,_0x62119f)=>{var _0x5e68bb=_0xc1947a;_0x37745e[_0x62119f][_0x5e68bb(0x13e)]=_0x81516a;}),_0xa4d9fd[_0xc1947a(0x127)]((_0x5ee265,_0x1c8e1d)=>{var _0x4da874=_0xc1947a;_0x37745e[_0x1c8e1d][_0x4da874(0xa1)]=_0x5ee265;}),_0x18ad37[_0xc1947a(0x127)]((_0x31d3d6,_0x3ae854)=>{var _0x153380=_0xc1947a;_0x4ad52a[_0x153380(0x127)]((_0x139b85,_0x5143ec)=>{var _0x518d2f=_0x153380;if(_0x139b85==_0x518d2f(0xce)&&_0x3ae854==_0x5143ec){var _0x970444=_0x31d3d6[_0x518d2f(0x147)](0x3);_0x37745e[_0x3ae854][_0x518d2f(0x100)]=_0x31d3d6[0x0],_0x37745e[_0x3ae854][_0x518d2f(0xdc)]=_0x31d3d6[0x1],_0x37745e[_0x3ae854][_0x518d2f(0x10b)]=0x0,_0x37745e[_0x3ae854][_0x518d2f(0x122)]=0x0,_0x37745e[_0x3ae854][_0x518d2f(0x99)]='Floor',_0x37745e[_0x3ae854][_0x518d2f(0xea)]=_0x970444;}else{if(_0x139b85=='Shelves'&&_0x3ae854==_0x5143ec){var _0x970444=_0x31d3d6[_0x518d2f(0x147)](0x3);_0x37745e[_0x3ae854][_0x518d2f(0x100)]=_0x31d3d6[0x0],_0x37745e[_0x3ae854][_0x518d2f(0xdc)]=_0x31d3d6[0x1],_0x37745e[_0x3ae854][_0x518d2f(0x10b)]=0x0,_0x37745e[_0x3ae854]['from_bin']=0x0,_0x37745e[_0x3ae854][_0x518d2f(0x99)]=_0x518d2f(0xe6),_0x37745e[_0x3ae854][_0x518d2f(0xea)]=_0x31d3d6[0x5];}else{if(_0x3ae854==_0x5143ec){if(_0x31d3d6[0x0]=='A'&&_0x31d3d6[0x1]=='L'&&_0x31d3d6[0x2]=='L')console['log'](_0x139b85+_0x518d2f(0xcb)+_0x3ae854+_0x518d2f(0xcb)+_0x5143ec+_0x518d2f(0xcb)+_0x31d3d6+_0x518d2f(0x89)),_0x37745e[_0x3ae854]['from_storage']=_0x31d3d6[0x0],_0x37745e[_0x3ae854][_0x518d2f(0xdc)]=_0x31d3d6[0x1],_0x37745e[_0x3ae854][_0x518d2f(0x10b)]=0x0,_0x37745e[_0x3ae854][_0x518d2f(0x122)]=0x0,_0x37745e[_0x3ae854]['from_types']=_0x518d2f(0xe6),_0x37745e[_0x3ae854][_0x518d2f(0xea)]=_0x31d3d6[0x3];else{var _0x4a3d2b;if(_0x31d3d6[0x4]=='L')_0x4a3d2b='Level';else _0x31d3d6[0x4]=='F'&&(_0x4a3d2b=_0x518d2f(0xe6));_0x37745e[_0x3ae854]['from_storage']=_0x31d3d6[0x0],_0x37745e[_0x3ae854][_0x518d2f(0xdc)]=_0x31d3d6[0x1],_0x37745e[_0x3ae854][_0x518d2f(0x10b)]=_0x31d3d6[0x2],_0x37745e[_0x3ae854]['from_bin']=_0x31d3d6[0x3],_0x37745e[_0x3ae854]['from_types']=_0x4a3d2b,_0x37745e[_0x3ae854][_0x518d2f(0xea)]=_0x31d3d6[0x5];}}}}});}),_0x2aeddd[_0xc1947a(0x127)]((_0x5705c1,_0x1e4fe5)=>{_0x37745e[_0x1e4fe5]['to_quantity']=_0x5705c1;}),_0x295e81[_0xc1947a(0x127)]((_0x52f344,_0xb0e23d)=>{_0x3c409d['forEach']((_0x5e3ad0,_0x14444c)=>{var _0x5c8759=a0_0x3cc7;if(_0x5e3ad0==_0x5c8759(0xce)&&_0xb0e23d==_0x14444c){var _0x47958e=_0x52f344['slice'](0x3);_0x37745e[_0xb0e23d][_0x5c8759(0x77)]=_0x52f344[0x0],_0x37745e[_0xb0e23d][_0x5c8759(0x153)]=_0x52f344[0x1],_0x37745e[_0xb0e23d]['to_bay']=0x0,_0x37745e[_0xb0e23d][_0x5c8759(0x115)]=0x0,_0x37745e[_0xb0e23d][_0x5c8759(0x8f)]=_0x5c8759(0xe6),_0x37745e[_0xb0e23d][_0x5c8759(0x109)]=_0x47958e;}else{if(_0x5e3ad0=='Shelves'&&_0xb0e23d==_0x14444c){var _0x47958e=_0x52f344[_0x5c8759(0x147)](0x3);_0x37745e[_0xb0e23d][_0x5c8759(0x77)]=_0x52f344[0x0],_0x37745e[_0xb0e23d][_0x5c8759(0x153)]=_0x52f344[0x1],_0x37745e[_0xb0e23d][_0x5c8759(0xda)]=0x0,_0x37745e[_0xb0e23d][_0x5c8759(0x115)]=0x0,_0x37745e[_0xb0e23d]['to_types']=_0x5c8759(0xe6),_0x37745e[_0xb0e23d][_0x5c8759(0x109)]=_0x52f344[0x5];}else{if(_0xb0e23d==_0x14444c){if(_0x52f344[0x0]=='A'&&_0x52f344[0x1]=='L'&&_0x52f344[0x2]=='L')console[_0x5c8759(0x144)](_0x5e3ad0+_0x5c8759(0xcb)+_0xb0e23d+'\x20<>\x20'+_0x14444c+_0x5c8759(0xcb)+_0x52f344+_0x5c8759(0x89)),_0x37745e[_0xb0e23d]['storage']=_0x52f344[0x0],_0x37745e[_0xb0e23d][_0x5c8759(0x153)]=_0x52f344[0x1],_0x37745e[_0xb0e23d][_0x5c8759(0xda)]=0x0,_0x37745e[_0xb0e23d]['to_bin']=0x0,_0x37745e[_0xb0e23d][_0x5c8759(0x8f)]=_0x5c8759(0xe6),_0x37745e[_0xb0e23d][_0x5c8759(0x109)]=_0x52f344[0x3];else{var _0x576c07;if(_0x52f344[0x4]=='L')_0x576c07=_0x5c8759(0x12f);else _0x52f344[0x4]=='F'&&(_0x576c07=_0x5c8759(0xe6));_0x37745e[_0xb0e23d][_0x5c8759(0x77)]=_0x52f344[0x0],_0x37745e[_0xb0e23d][_0x5c8759(0x153)]=_0x52f344[0x1],_0x37745e[_0xb0e23d][_0x5c8759(0xda)]=_0x52f344[0x2],_0x37745e[_0xb0e23d][_0x5c8759(0x115)]=_0x52f344[0x3],_0x37745e[_0xb0e23d][_0x5c8759(0x8f)]=_0x576c07,_0x37745e[_0xb0e23d][_0x5c8759(0x109)]=_0x52f344[0x5];}}}}});}),_0x134946['forEach']((_0x3800c8,_0x586f4c)=>{var _0x1d1361=_0xc1947a;_0x37745e[_0x586f4c][_0x1d1361(0xc9)]=_0x3800c8;}),_0x48c322[_0xc1947a(0x127)]((_0x58e3db,_0x294c93)=>{var _0xe4a213=_0xc1947a;_0x37745e[_0x294c93][_0xe4a213(0x120)]=_0x58e3db;}),_0x22a123['forEach']((_0x26d120,_0x5f271b)=>{_0x37745e[_0x5f271b]['product_code']=_0x26d120;}),_0x1cf9b5[_0xc1947a(0x127)]((_0x5e124a,_0x2d0c8a)=>{var _0x4b07b1=_0xc1947a;_0x37745e[_0x2d0c8a][_0x4b07b1(0xd4)]=_0x5e124a;}),_0x3c6a79[_0xc1947a(0x127)]((_0x4f1fa3,_0x2265b5)=>{var _0x4cfdbd=_0xc1947a;_0x37745e[_0x2265b5][_0x4cfdbd(0x118)]=_0x4f1fa3;}),_0x24253f['forEach']((_0x18407a,_0x526b3d)=>{var _0x2d69e9=_0xc1947a;_0x37745e[_0x526b3d][_0x2d69e9(0xf4)]=_0x18407a;}),_0x398f36[_0xc1947a(0x127)]((_0x4e68ff,_0x1299e1)=>{var _0x5f771d=_0xc1947a;_0x37745e[_0x1299e1][_0x5f771d(0x7a)]=_0x4e68ff;}),_0x525b58[_0xc1947a(0x127)]((_0xd16f7f,_0x233b7c)=>{var _0x106a52=_0xc1947a;_0x37745e[_0x233b7c][_0x106a52(0x112)]=_0xd16f7f;}),_0x14a3e9[_0xc1947a(0x127)]((_0x742576,_0x2235eb)=>{var _0x27debe=_0xc1947a;_0x37745e[_0x2235eb][_0x27debe(0xa9)]=_0x742576;}),_0xb73761[_0xc1947a(0x127)]((_0x50ede7,_0x5117e9)=>{_0x37745e[_0x5117e9]['production_date']=_0x50ede7;}),_0x4f2cd2[_0xc1947a(0x127)]((_0x526d7b,_0xb04b3e)=>{var _0x2d99a4=_0xc1947a;_0x37745e[_0xb04b3e][_0x2d99a4(0xe4)]=_0x526d7b;}),_0x4ad52a[_0xc1947a(0x127)]((_0x312eea,_0x490d19)=>{var _0x2e1dec=_0xc1947a;_0x37745e[_0x490d19][_0x2e1dec(0x140)]=_0x312eea;}),_0x3c409d[_0xc1947a(0x127)]((_0x1c1f47,_0x164325)=>{_0x37745e[_0x164325]['to_room_name']=_0x1c1f47;});const _0x32ce41=_0x37745e[_0xc1947a(0xf3)](_0x1c2067=>_0x1c2067[_0xc1947a(0x8a)]!=='0'&&_0x1c2067[_0xc1947a(0x8a)]!==''||_0x1c2067[_0xc1947a(0x109)]!=='0'&&_0x1c2067[_0xc1947a(0x109)]!==''),_0x2d7036=new transfers({'date':_0x4b8376,'from_warehouse':_0x595505,'to_warehouse':_0x40d32b,'product':_0x32ce41,'note':_0x5e40ba,'invoice':_0x572aaf}),_0x1fdd0a=await _0x2d7036[_0xc1947a(0x95)]();_0x268a32[_0xc1947a(0x14a)](_0xc1947a(0xe5),'Product\x20Transfer\x20successfully'),_0x7157aa['redirect'](_0xc1947a(0xc7)+_0x1fdd0a[_0xc1947a(0x107)]);}catch(_0x1dfe65){console[_0xc1947a(0x144)](_0x1dfe65),_0x7157aa['status'](0xc8)[_0xc1947a(0xf9)]({'errorMessage':_0x1dfe65['message']});}}),router[a0_0x45dd62(0x11e)](a0_0x45dd62(0x162),auth,async(_0x48c732,_0x4bd34c)=>{var _0x9446e0=a0_0x45dd62;try{const {username:_0x2edebf,email:_0x7c4fbf,role:_0x28660b}=_0x48c732[_0x9446e0(0xc0)],_0x51cd01=_0x48c732['user'],_0x46457f=await profile['findOne']({'email':_0x51cd01[_0x9446e0(0x75)]}),_0x43047c=await master_shop[_0x9446e0(0x106)]();console[_0x9446e0(0x144)](_0x9446e0(0x8b),_0x43047c);const _0x10aa3b=await transfers[_0x9446e0(0xef)](_0x48c732[_0x9446e0(0x133)]['id']);let _0xdeccb5=new Date(_0x10aa3b['expiry_date']),_0x1848d3=('0'+_0xdeccb5[_0x9446e0(0xab)]())[_0x9446e0(0x147)](-0x2),_0x3929af=('0'+(_0xdeccb5['getMonth']()+0x1))[_0x9446e0(0x147)](-0x2),_0x145b47=_0xdeccb5['getFullYear'](),_0x482de4=_0x145b47+'-'+_0x3929af+'-'+_0x1848d3,_0x57d11a;if(_0x51cd01[_0x9446e0(0xb6)]=='staff'){const _0x139e4d=await staff[_0x9446e0(0x114)]({'email':_0x51cd01[_0x9446e0(0x75)]});_0x57d11a=await warehouse[_0x9446e0(0x106)]({'status':_0x9446e0(0x10e),'name':_0x139e4d[_0x9446e0(0x142)],'warehouse_category':_0x9446e0(0x116)});}else _0x57d11a=await warehouse['find']({'status':_0x9446e0(0x10e),'warehouse_category':_0x9446e0(0x116)});const _0x1cbb0a=await warehouse[_0x9446e0(0x101)]([{'$match':{'name':_0x10aa3b['from_warehouse']}},{'$unwind':_0x9446e0(0x10d)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x9446e0(0xa2)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x9446e0(0xdf)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x9446e0(0xee)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x9446e0(0x157)},'rack':{'$first':_0x9446e0(0xb3)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x9446e0(0xbc)},'room':{'$first':_0x9446e0(0x148)}}}]);if(_0x43047c[0x0][_0x9446e0(0x82)]==_0x9446e0(0x154)){var _0x21ace6=users[_0x9446e0(0xaa)];console['log'](_0x21ace6);}else{if(_0x43047c[0x0][_0x9446e0(0x82)]==_0x9446e0(0x81))var _0x21ace6=users[_0x9446e0(0x81)];else{if(_0x43047c[0x0]['language']=='German')var _0x21ace6=users[_0x9446e0(0x9b)];else{if(_0x43047c[0x0][_0x9446e0(0x82)]==_0x9446e0(0x13b))var _0x21ace6=users[_0x9446e0(0x13b)];else{if(_0x43047c[0x0]['language']==_0x9446e0(0x111))var _0x21ace6=users['French'];else{if(_0x43047c[0x0]['language']=='Portuguese\x20(BR)')var _0x21ace6=users[_0x9446e0(0x9d)];else{if(_0x43047c[0x0][_0x9446e0(0x82)]=='Chinese')var _0x21ace6=users[_0x9446e0(0x97)];else{if(_0x43047c[0x0]['language']==_0x9446e0(0xd8))var _0x21ace6=users['Arabic'];}}}}}}}_0x4bd34c[_0x9446e0(0x151)]('edit_transfer_view',{'success':_0x48c732['flash'](_0x9446e0(0xe5)),'errors':_0x48c732['flash']('errors'),'role':_0x51cd01,'profile':_0x46457f,'master_shop':_0x43047c,'warehouse':_0x57d11a,'transfer':_0x10aa3b,'stock':_0x1cbb0a,'language':_0x21ace6});}catch(_0x7d5726){console[_0x9446e0(0x144)](_0x7d5726);}}),router['post']('/preview/:id',auth,async(_0x46f0c0,_0x3114d5)=>{var _0x5d99ce=a0_0x45dd62;try{const _0x198add=_0x46f0c0[_0x5d99ce(0x133)]['id'],{from_warehouse:_0x12f17f,FromRoom_name:_0x4887ea,to_warehouse:_0x11130e,ToRoom_name:_0x218259}=_0x46f0c0['body'],_0x179012=await transfers[_0x5d99ce(0xef)]({'_id':_0x198add}),_0x268a71=_0x179012[_0x5d99ce(0xc2)][_0x5d99ce(0xf0)](async _0x1f0815=>{var _0x120285=_0x5d99ce;if(_0x1f0815[_0x120285(0x8a)]>0x0){var _0x2bc410=await warehouse[_0x120285(0x114)]({'name':_0x179012['from_warehouse'],'room':_0x1f0815[_0x120285(0x140)],'warehouse_category':'Raw\x20Materials'});const _0x5cec8a=_0x2bc410['product_details'][_0x120285(0xf0)](_0x282d74=>{var _0x4c410f=_0x120285;_0x282d74[_0x4c410f(0x124)]==_0x1f0815[_0x4c410f(0x124)]&&_0x282d74[_0x4c410f(0x9a)]==_0x1f0815[_0x4c410f(0xea)]&&_0x282d74[_0x4c410f(0xd0)]==_0x1f0815[_0x4c410f(0x99)]&&_0x282d74[_0x4c410f(0xbd)]==_0x1f0815[_0x4c410f(0x122)]&&_0x282d74['bay']==_0x1f0815['from_bay']&&_0x282d74[_0x4c410f(0x153)]==_0x1f0815[_0x4c410f(0xdc)]&&_0x282d74[_0x4c410f(0x77)]==_0x1f0815[_0x4c410f(0x100)]&&_0x282d74[_0x4c410f(0x112)]==_0x1f0815[_0x4c410f(0x112)]&&_0x282d74['batch_code']==_0x1f0815[_0x4c410f(0x7a)]&&_0x282d74['production_date']==_0x1f0815[_0x4c410f(0x92)]&&_0x282d74[_0x4c410f(0xfa)]==_0x1f0815[_0x4c410f(0xcd)]&&_0x282d74[_0x4c410f(0x107)]==_0x1f0815[_0x4c410f(0xa1)]&&(_0x282d74[_0x4c410f(0xad)]=_0x282d74[_0x4c410f(0xad)]-_0x1f0815[_0x4c410f(0x8a)]);});}return _0x2bc410;});Promise['all'](_0x268a71)[_0x5d99ce(0xf6)](async _0x2eab10=>{var _0x2fd6d8=_0x5d99ce;try{for(const _0x5da858 of _0x2eab10){await _0x5da858[_0x2fd6d8(0x95)]();}try{const _0xf600a2=_0x179012[_0x2fd6d8(0xc2)]['map'](async _0x10e071=>{var _0x3f6eed=_0x2fd6d8;if(_0x10e071['to_quantity']>0x0){var _0x5e67f8=await warehouse['findOne']({'name':_0x179012[_0x3f6eed(0x146)],'room':_0x10e071[_0x3f6eed(0x14d)],'warehouse_category':_0x3f6eed(0x116)}),_0x3ef3b0=0x0;const _0x223b1c=_0x5e67f8[_0x3f6eed(0xf2)][_0x3f6eed(0xf0)](_0x48ac1d=>{var _0x1dfaa3=_0x3f6eed;_0x48ac1d['product_name']==_0x10e071[_0x1dfaa3(0x124)]&&_0x48ac1d[_0x1dfaa3(0x9a)]==_0x10e071[_0x1dfaa3(0x109)]&&_0x48ac1d['type']==_0x10e071['to_types']&&_0x48ac1d[_0x1dfaa3(0xbd)]==_0x10e071[_0x1dfaa3(0x115)]&&_0x48ac1d[_0x1dfaa3(0x158)]==_0x10e071['to_bay']&&_0x48ac1d[_0x1dfaa3(0x153)]==_0x10e071[_0x1dfaa3(0x153)]&&_0x48ac1d['storage']==_0x10e071['storage']&&_0x48ac1d['expiry_date']==_0x10e071[_0x1dfaa3(0x112)]&&_0x48ac1d[_0x1dfaa3(0x7a)]==_0x10e071[_0x1dfaa3(0x7a)]&&_0x48ac1d['production_date']==_0x10e071[_0x1dfaa3(0x92)]&&_0x48ac1d['invoice']==_0x10e071[_0x1dfaa3(0x13e)]&&(_0x48ac1d[_0x1dfaa3(0xad)]=_0x48ac1d[_0x1dfaa3(0xad)]+_0x10e071[_0x1dfaa3(0x8a)],_0x3ef3b0++);});_0x3ef3b0=='0'&&(_0x5e67f8[_0x3f6eed(0xf2)]=_0x5e67f8['product_details']['concat']({'product_name':_0x10e071[_0x3f6eed(0x124)],'product_stock':_0x10e071[_0x3f6eed(0x8a)],'bay':_0x10e071['to_bay'],'bin':_0x10e071['to_bin'],'type':_0x10e071[_0x3f6eed(0x8f)],'floorlevel':_0x10e071[_0x3f6eed(0x109)],'storage':_0x10e071[_0x3f6eed(0x77)],'rack':_0x10e071['rack'],'product_code':_0x10e071['product_code'],'primary_code':_0x10e071[_0x3f6eed(0xc9)],'secondary_code':_0x10e071[_0x3f6eed(0x120)],'maxProducts':_0x10e071[_0x3f6eed(0xd4)],'storage':_0x10e071[_0x3f6eed(0x77)],'rack':_0x10e071[_0x3f6eed(0x153)],'expiry_date':_0x10e071[_0x3f6eed(0x112)],'maxPerUnit':_0x10e071[_0x3f6eed(0xa9)],'batch_code':_0x10e071[_0x3f6eed(0x7a)],'production_date':_0x10e071[_0x3f6eed(0x92)]}));}return _0x5e67f8;});Promise[_0x2fd6d8(0xa4)](_0xf600a2)[_0x2fd6d8(0xf6)](async _0x553c21=>{var _0x3132a2=_0x2fd6d8;try{for(const _0x286881 of _0x553c21){await warehouse[_0x3132a2(0xca)]({'_id':_0x286881[_0x3132a2(0x107)]},{'$addToSet':{'product_details':{'$each':_0x286881[_0x3132a2(0xf2)]}}});}_0x179012['finalize']=_0x3132a2(0x11b);const _0x32d3b3=await _0x179012['save'](),_0x1eae8d=await master_shop[_0x3132a2(0x106)](),_0x395bae=await email_settings[_0x3132a2(0x114)](),_0x4ad7d5=await supervisor_settings[_0x3132a2(0x106)]();var _0x21498f=_0x179012[_0x3132a2(0xc2)],_0x18908c='',_0x197937;for(_0x197937 in _0x21498f){_0x18908c+=_0x3132a2(0xc4)+_0x3132a2(0x13f)+_0x21498f[_0x197937][_0x3132a2(0x124)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x21498f[_0x197937][_0x3132a2(0x8d)]+_0x3132a2(0x152)+_0x3132a2(0x13f)+_0x21498f[_0x197937][_0x3132a2(0x8a)]+_0x3132a2(0x152)+_0x3132a2(0x13f)+_0x21498f[_0x197937]['unit']+_0x3132a2(0x152)+_0x3132a2(0x13f)+_0x21498f[_0x197937]['secondary_unit']+_0x3132a2(0x152)+_0x3132a2(0x13f)+_0x179012[_0x3132a2(0x146)]+_0x3132a2(0x152)+_0x3132a2(0x13f)+_0x21498f[_0x197937][_0x3132a2(0x14d)]+_0x3132a2(0x152)+_0x3132a2(0x13f)+_0x21498f[_0x197937][_0x3132a2(0x77)]+_0x21498f[_0x197937]['rack']+_0x21498f[_0x197937][_0x3132a2(0xda)]+_0x21498f[_0x197937][_0x3132a2(0x115)]+_0x21498f[_0x197937][_0x3132a2(0x8f)][0x0]+_0x21498f[_0x197937][_0x3132a2(0x109)]+_0x3132a2(0x152),'</tr>';}let _0x383a73=nodemailer[_0x3132a2(0xfc)]({'host':_0x395bae['host'],'port':Number(_0x395bae[_0x3132a2(0xeb)]),'secure':![],'auth':{'user':_0x395bae[_0x3132a2(0x75)],'pass':_0x395bae[_0x3132a2(0x7e)]}}),_0x2e52b8={'from':_0x395bae['email'],'to':_0x4ad7d5[0x0][_0x3132a2(0xc1)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x3132a2(0x93),'path':__dirname+_0x3132a2(0x14f)+'/upload/'+_0x1eae8d[0x0][_0x3132a2(0x96)],'cid':_0x3132a2(0x90)}],'html':_0x3132a2(0x103)+_0x3132a2(0x11f)+_0x3132a2(0x94)+_0x3132a2(0x137)+_0x3132a2(0xed)+_0x3132a2(0x137)+_0x3132a2(0x9f)+_0x3132a2(0x7c)+'<div>'+_0x3132a2(0x131)+_0x1eae8d[0x0]['site_title']+'\x20</h2>'+_0x3132a2(0x7c)+'</div>'+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x179012['invoice']+'\x20'+_0x3132a2(0x119)+_0x3132a2(0xfd)+_0x179012[_0x3132a2(0x10a)]+'\x20'+_0x3132a2(0xbe)+_0x3132a2(0x78)+_0x3132a2(0x7c)+_0x3132a2(0xb4)+_0x3132a2(0x10f)+'<tr>'+_0x3132a2(0x15d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x3132a2(0x15a)+_0x3132a2(0x8e)+_0x3132a2(0xc8)+_0x3132a2(0x110)+_0x3132a2(0x125)+_0x3132a2(0x79)+_0x3132a2(0xd9)+_0x3132a2(0xe7)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x18908c+'\x20'+_0x3132a2(0xdb)+_0x3132a2(0xf5)+_0x3132a2(0x137)+_0x3132a2(0x141)+_0x3132a2(0xb1)+_0x1eae8d[0x0][_0x3132a2(0x128)]+_0x3132a2(0x78)+_0x3132a2(0x7c)+_0x3132a2(0x7c)+_0x3132a2(0x87)};_0x383a73[_0x3132a2(0xb8)](_0x2e52b8,function(_0x315260,_0x153b4b){var _0x14aa2a=_0x3132a2;_0x315260?(console['log'](_0x315260),console['log'](_0x14aa2a(0xb0))):console[_0x14aa2a(0x144)](_0x14aa2a(0x132));}),_0x46f0c0[_0x3132a2(0x14a)](_0x3132a2(0xe5),_0x3132a2(0xf7)),_0x3114d5['redirect'](_0x3132a2(0xa7)+_0x32d3b3[_0x3132a2(0x107)]);}catch(_0x2c87e6){console[_0x3132a2(0xfe)](_0x2c87e6),_0x3114d5['status'](0x1f4)['json']({'Perror':_0x3132a2(0x113),'message':_0x2c87e6[_0x3132a2(0xe3)]});}})['catch'](_0x2d3571=>{var _0x501219=_0x2fd6d8;console[_0x501219(0xfe)](_0x2d3571),_0x3114d5[_0x501219(0xd2)](0x1f4)[_0x501219(0xf9)]({'Perror':_0x501219(0xd3)});});}catch(_0x5df31f){_0x3114d5[_0x2fd6d8(0xf9)](_0x5df31f);}}catch(_0x5911d8){console[_0x2fd6d8(0xfe)](_0x5911d8),_0x3114d5[_0x2fd6d8(0xd2)](0x1f4)[_0x2fd6d8(0xf9)]({'Merror':_0x2fd6d8(0x113),'Message':_0x5911d8[_0x2fd6d8(0xe3)]});}})[_0x5d99ce(0x9c)](_0x5556eb=>{var _0x124f47=_0x5d99ce;console[_0x124f47(0xfe)](_0x5556eb),_0x3114d5[_0x124f47(0xd2)](0x1f4)[_0x124f47(0xf9)]({'Merror':_0x124f47(0xd3)});});}catch(_0x54a687){console[_0x5d99ce(0x144)](_0x54a687);}});function a0_0x53f4(){var _0x1f4451=['body','/preview/:id','/transfer/view','../models/all_models','random','$product_details.bin','email','to_prod_pallet','storage','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','batch_code','1ucTQWy','</div>','push','password','TRF-','Arabic','Hindi','language','from_prod_isle','from_prod_qty','Rack\x20A','There\x27s\x20a\x20error\x20in\x20this\x20transaction','</body></html>','from_rak','here','to_quantity','master','product_code3','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','to_types','logo','to_room','production_date','Logo.png','</head><body>','save','image','Chinese','toString','from_types','floorlevel','German','catch','Portuguese','9495556eGkrqU','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','to_invoice','id_transaction_id','$product_details.product_name','$product_details.secondary_unit','all','$product_details.invoice','Rack\x20F','/picking_list/PDF_transfer_rm/','2494628EsYswZ','maxperunit','English','getDate','add_transfer','product_stock','$product_details.isle','56tJVHfl','Error\x20Occurs','<h5>','$product.from_room_name','$product_details.rack','<table\x20style=\x22width:\x20100%\x20!important;\x22>','from_prod_level','role','Transfer\x20Edit\x20Successfully','sendMail','from_prod_pallet','errors','max_per_unit','$product_details.production_date','bin','</span>','/barcode_scanner2','user','RMSEmail','product','redirect','<tr>','$product_details.type','$product_details.product_stock','/transfer/preview/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','primary_code','updateOne','\x20<>\x20','../public/language/languages.json','from_invoice','Receiving\x20Area','edit_transfer','type','New_Qty_Converted','status','An\x20error\x20occurred.','maxProducts','$isAllowEdit','732780lZtvWN','back','Arabic\x20(ae)','</tr>','to_bay','</tbody>','from_rack','$product_details.maxProducts','to_prod_level','$product_details.bay','express','$product_details.secondary_code','200064yLulvb','message','prod_cat','success','Floor','</thead>','RoomAssigned','$product.to_room_name','from_floorlevel','port','45wAUuNC','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.floorlevel','findById','map','to_prod_isle','product_details','filter','secondary_unit','</table>','then','Transfer\x20Finalize\x20Successfully','staff','json','invoice','$product_details.pallet','createTransport','\x20Order\x20Date\x20:\x20','error','note','from_storage','aggregate','length','<!DOCTYPE\x20html>','Rack\x20B','id_transaction','find','_id','from_warehouse','to_floorlevel','date','from_bay','rak','$product_details','Enabled','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','French','expiry_date','An\x20error\x20occurred\x20while\x20saving\x20data.','findOne','to_bin','Raw\x20Materials','primary_unit','unit','<span\x20style=\x22float:\x20right;\x22>','8437704nccpyC','True','$product_details.primary_code','$invoice','get','<html><head><title></title>','secondary_code','2670984heJVCA','from_bin','Rack\x20E','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$_id','forEach','site_title','Enclosed','$product_details.unit','/view/add_transfer','$product_details.batch_code','to_prod_qty','COLD\x20STORAGE','Level','Router','<h2>\x20','Email\x20sent\x20successfully','params','/view/:id','$product_details.maxPerUnit','DRY\x20STORAGE','<div>','from_room','/CheckingWarehouse','post','Spanish','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','MaxStocks_data2','To_invoice','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','from_room_name','<strong>\x20Regards\x20</strong>','warehouse','from_quantity','log','63955SLOReH','to_warehouse','slice','$room','prod_name','flash','string','Rack\x20C','to_room_name','exports','/../public','Portuguese\x20(BR)','render','</td>','rack','English\x20(US)','$product_details.product_code','$date','$product_details.storage','bay','$product_details._id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','ToRoomAssigned','$product_details.expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.level','372ahFtzJ','$name'];a0_0x53f4=function(){return _0x1f4451;};return a0_0x53f4();}function BayBinSelected(_0x339721,_0x1667e1){var _0x453569=a0_0x45dd62,_0x51ae61=[],_0x40bbe5=[],_0x1fac8b=[],_0x5c0c62=[],_0x2c9f4e=[],_0x240ff1=[];let _0x371295=[];if(_0x339721==_0x453569(0x136))switch(_0x1667e1){case _0x453569(0x85):_0x51ae61=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x40bbe5=[0x1,0x2],_0x5c0c62=[0x1,0x2,0x3,0x4,0x5],_0x1fac8b=['Level',_0x453569(0xe6)],_0x2c9f4e=['D'],_0x240ff1=['A'];break;case _0x453569(0x104):_0x51ae61=[0x6,0x5,0x4,0x3,0x2,0x1],_0x40bbe5=[0x1,0x2],_0x5c0c62=[0x1,0x2,0x3,0x4,0x5],_0x1fac8b=[_0x453569(0x12f),_0x453569(0xe6)],_0x2c9f4e=['D'],_0x240ff1=['B'];break;case'Shelves':_0x51ae61=[0x0],_0x40bbe5=[0x0],_0x5c0c62=[0x1,0x2,0x3,0x4,0x5],_0x1fac8b=[_0x453569(0xe6)],_0x2c9f4e=['D'],_0x240ff1=['S'];break;case _0x453569(0xce):_0x51ae61=[0x0],_0x40bbe5=[0x0],_0x5c0c62=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x1fac8b=[_0x453569(0xe6)],_0x2c9f4e=['D'],_0x240ff1=['R'];break;}else{if(_0x339721==_0x453569(0x12e))switch(_0x1667e1){case _0x453569(0x85):_0x51ae61=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x40bbe5=['B','F'],_0x5c0c62=[0x1,0x2,0x3,0x4,0x5],_0x1fac8b=[_0x453569(0x12f),_0x453569(0xe6)],_0x2c9f4e=['C'],_0x240ff1=['A'];break;case _0x453569(0x104):_0x51ae61=[0x5,0x4,0x3,0x2,0x1],_0x40bbe5=['F','B','S'],_0x5c0c62=[0x1,0x2,0x3,0x4,0x5],_0x1fac8b=[_0x453569(0x12f),_0x453569(0xe6)],_0x2c9f4e=['C'],_0x240ff1=['B'];break;case _0x453569(0x14c):_0x51ae61=[0x1,0x2,0x3,0x4,0x5],_0x40bbe5=['B','F','S'],_0x5c0c62=[0x5,0x4,0x3,0x2,0x1],_0x1fac8b=[_0x453569(0x12f),_0x453569(0xe6)],_0x2c9f4e=['C'],_0x240ff1=['C'];break;case'Rack\x20D':_0x51ae61=[0x5,0x4,0x3,0x2,0x1],_0x40bbe5=['F','B','S'],_0x5c0c62=[0x1,0x2,0x3,0x4,0x5],_0x1fac8b=[_0x453569(0x12f),_0x453569(0xe6)],_0x2c9f4e=['C'],_0x240ff1=['D'];break;case _0x453569(0x123):_0x51ae61=[0x4,0x3,0x2,0x1],_0x40bbe5=[0x1,0x2],_0x5c0c62=[0x1,0x2,0x3,0x4,0x5],_0x1fac8b=['Level',_0x453569(0xe6)],_0x2c9f4e=['C'],_0x240ff1=['E'];break;case _0x453569(0xa6):_0x51ae61=[0x1,0x2,0x3],_0x40bbe5=[0x1,0x2],_0x5c0c62=[0x1,0x2,0x3,0x4,0x5],_0x1fac8b=[_0x453569(0x12f)],_0x2c9f4e=['C'],_0x240ff1=['F'];break;}}return{'levels':_0x51ae61,'Isle':_0x40bbe5,'rack':_0x5c0c62,'type':_0x1fac8b,'storage':_0x2c9f4e,'rak':_0x240ff1};}router[a0_0x45dd62(0x11e)](a0_0x45dd62(0x134),auth,async(_0x1cf007,_0x1c9d86)=>{var _0x33bd0e=a0_0x45dd62;try{const {username:_0x435ec1,email:_0x17c32b,role:_0x448ccc}=_0x1cf007[_0x33bd0e(0xc0)],_0xafac27=_0x1cf007[_0x33bd0e(0xc0)],_0x4e474b=await profile[_0x33bd0e(0x114)]({'email':_0xafac27['email']}),_0x314dfb=await master_shop['find'](),_0x26d3be=await transfers[_0x33bd0e(0xef)](_0x1cf007['params']['id']);let _0x568e43;if(_0xafac27['role']==_0x33bd0e(0xf8)){const _0x20a950=await staff[_0x33bd0e(0x114)]({'email':_0xafac27[_0x33bd0e(0x75)]});_0x568e43=await warehouse[_0x33bd0e(0x101)]([{'$match':{'status':_0x33bd0e(0x10e),'name':_0x20a950[_0x33bd0e(0x142)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x33bd0e(0x160),'name':{'$first':_0x33bd0e(0x160)}}}]);}else _0x568e43=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x33bd0e(0x116)}},{'$group':{'_id':_0x33bd0e(0x160),'name':{'$first':_0x33bd0e(0x160)}}}]);const _0x390bf6=await warehouse[_0x33bd0e(0x101)]([{'$match':{'name':_0x26d3be[_0x33bd0e(0x108)],'warehouse_category':_0x33bd0e(0x116)}},{'$unwind':_0x33bd0e(0x10d)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x33bd0e(0xa2)},'product_stock':{'$first':_0x33bd0e(0xc6)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x33bd0e(0x74)},'type':{'$first':_0x33bd0e(0xc5)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x33bd0e(0x11c)},'secondary_code':{'$first':_0x33bd0e(0xe1)},'product_code':{'$first':_0x33bd0e(0x155)},'storage':{'$first':_0x33bd0e(0x157)},'rack':{'$first':_0x33bd0e(0xb3)},'expiry_date':{'$first':_0x33bd0e(0x15c)},'production_date':{'$first':_0x33bd0e(0xbc)},'room':{'$first':_0x33bd0e(0x148)}}}]),_0x1e6ed7=await product[_0x33bd0e(0x106)]({}),_0x249924=BayBinSelected(_0x26d3be['to_warehouse'],_0x26d3be[_0x33bd0e(0x91)]);if(_0x314dfb[0x0][_0x33bd0e(0x82)]==_0x33bd0e(0x154)){var _0x3cccbc=users[_0x33bd0e(0xaa)];console['log'](_0x3cccbc);}else{if(_0x314dfb[0x0][_0x33bd0e(0x82)]==_0x33bd0e(0x81))var _0x3cccbc=users[_0x33bd0e(0x81)];else{if(_0x314dfb[0x0][_0x33bd0e(0x82)]==_0x33bd0e(0x9b))var _0x3cccbc=users[_0x33bd0e(0x9b)];else{if(_0x314dfb[0x0][_0x33bd0e(0x82)]==_0x33bd0e(0x13b))var _0x3cccbc=users['Spanish'];else{if(_0x314dfb[0x0][_0x33bd0e(0x82)]==_0x33bd0e(0x111))var _0x3cccbc=users['French'];else{if(_0x314dfb[0x0][_0x33bd0e(0x82)]==_0x33bd0e(0x150))var _0x3cccbc=users['Portuguese'];else{if(_0x314dfb[0x0][_0x33bd0e(0x82)]==_0x33bd0e(0x97))var _0x3cccbc=users[_0x33bd0e(0x97)];else{if(_0x314dfb[0x0][_0x33bd0e(0x82)]==_0x33bd0e(0xd8))var _0x3cccbc=users[_0x33bd0e(0x80)];}}}}}}}_0x1c9d86['render'](_0x33bd0e(0xcf),{'success':_0x1cf007[_0x33bd0e(0x14a)](_0x33bd0e(0xe5)),'errors':_0x1cf007['flash'](_0x33bd0e(0xba)),'role':_0xafac27,'profile':_0x4e474b,'master_shop':_0x314dfb,'warehouse':_0x568e43,'transfer':_0x26d3be,'stock':_0x390bf6,'unit':_0x1e6ed7,'language':_0x3cccbc});}catch(_0x286694){console[_0x33bd0e(0x144)](_0x286694);}}),router['post'](a0_0x45dd62(0x134),auth,async(_0xaeadc7,_0x26fdb4)=>{var _0x51564a=a0_0x45dd62;try{const _0x34161e=_0xaeadc7[_0x51564a(0x133)]['id'],_0x5ced13=await transfers[_0x51564a(0xef)](_0x34161e);_0x26fdb4[_0x51564a(0xf9)](_0xaeadc7[_0x51564a(0x161)]);return;const {date:_0x198a00,from_warehouse:_0x142c6b,FromRoom_name:_0x26a915,to_warehouse:_0x4c436d,ToRoom_name:_0x3b05d0,prod_name:_0x1bb727,from_prod_qty:_0x31b981,from_prod_level:_0x426360,from_prod_isle:_0x4d56d2,from_prod_pallet:_0x4aaab3,to_prod_qty:_0xc9c2b9,to_prod_level:_0x4e5e38,to_prod_isle:_0xdb4c43,to_prod_pallet:_0x456d37,primary_code:_0xbda9d6,secondary_code:_0x4d5143,product_code3:_0x31f21f,note:_0x28c654,invoice:_0x208f15,expiry_date:_0x406a85}=_0xaeadc7[_0x51564a(0x161)];if(typeof _0x1bb727=='string')var _0x87fe98=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x149)]],_0x59fb4c=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x84)]],_0x4ca562=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0xb5)]],_0x193bfa=[_0xaeadc7[_0x51564a(0x161)]['from_prod_isle']],_0x3e7bc1=[_0xaeadc7['body'][_0x51564a(0xb9)]],_0x4ee7a6=[_0xaeadc7['body'][_0x51564a(0x99)]],_0x414011=[_0xaeadc7[_0x51564a(0x161)]['to_prod_qty']],_0x584dd7=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0xde)]],_0xb7b916=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0xf1)]],_0x1f555b=[_0xaeadc7[_0x51564a(0x161)]['to_prod_pallet']],_0x32cbe5=[_0xaeadc7['body'][_0x51564a(0x8f)]],_0x25f783=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x77)]],_0x2d37ad=[_0xaeadc7['body'][_0x51564a(0x10c)]],_0x473de5=[_0xaeadc7[_0x51564a(0x161)]['primary_code']],_0x3101b4=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x120)]],_0x101591=[_0xaeadc7['body'][_0x51564a(0x8c)]],_0x461494=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x13d)]],_0x34a20d=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x118)]],_0x9b065e=[_0xaeadc7['body'][_0x51564a(0xf4)]],_0x5c7872=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x7a)]],_0x53b223=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x112)]],_0x4f966d=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x100)]],_0xc4825d=[_0xaeadc7[_0x51564a(0x161)][_0x51564a(0x88)]];else var _0x87fe98=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x149)]],_0x25f783=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x77)]],_0x2d37ad=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x10c)]],_0x4ee7a6=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x99)]],_0x32cbe5=[..._0xaeadc7['body']['to_types']],_0x59fb4c=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x84)]],_0x4ca562=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0xb5)]],_0x193bfa=[..._0xaeadc7['body'][_0x51564a(0x83)]],_0x3e7bc1=[..._0xaeadc7['body'][_0x51564a(0xb9)]],_0x414011=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x12d)]],_0x584dd7=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0xde)]],_0xb7b916=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0xf1)]],_0x1f555b=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x76)]],_0x473de5=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0xc9)]],_0x3101b4=[..._0xaeadc7['body'][_0x51564a(0x120)]],_0x101591=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x8c)]],_0x461494=[..._0xaeadc7['body'][_0x51564a(0x13d)]],_0x34a20d=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x118)]],_0x9b065e=[..._0xaeadc7[_0x51564a(0x161)]['secondary_unit']],_0x5c7872=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x7a)]],_0x53b223=[..._0xaeadc7[_0x51564a(0x161)]['expiry_date']],_0x4f966d=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x100)]],_0xc4825d=[..._0xaeadc7[_0x51564a(0x161)][_0x51564a(0x88)]];const _0x9a1708=_0x87fe98[_0x51564a(0xf0)](_0x446525=>{return _0x446525={'product_name':_0x446525};});_0x59fb4c[_0x51564a(0x127)]((_0x1c2551,_0x31c021)=>{var _0x17451a=_0x51564a;_0x9a1708[_0x31c021][_0x17451a(0x143)]=_0x1c2551;}),_0x4ca562[_0x51564a(0x127)]((_0x3b96d9,_0x1158e1)=>{var _0x1f6a7a=_0x51564a;_0x9a1708[_0x1158e1][_0x1f6a7a(0x10b)]=_0x3b96d9;}),_0x193bfa[_0x51564a(0x127)]((_0x2b75e2,_0xf61d3d)=>{_0x9a1708[_0xf61d3d]['from_bin']=_0x2b75e2;}),_0x3e7bc1[_0x51564a(0x127)]((_0x314f4b,_0x29e42)=>{var _0x52f4ca=_0x51564a;_0x9a1708[_0x29e42][_0x52f4ca(0xea)]=_0x314f4b;}),_0x414011[_0x51564a(0x127)]((_0x26a004,_0xa5465a)=>{var _0x4a46c9=_0x51564a;_0x9a1708[_0xa5465a][_0x4a46c9(0x8a)]=_0x26a004;}),_0x584dd7['forEach']((_0x30cb4e,_0x399b60)=>{_0x9a1708[_0x399b60]['to_bay']=_0x30cb4e;}),_0xb7b916[_0x51564a(0x127)]((_0x334eab,_0x435269)=>{_0x9a1708[_0x435269]['to_bin']=_0x334eab;}),_0x1f555b[_0x51564a(0x127)]((_0x220e48,_0xb61c94)=>{_0x9a1708[_0xb61c94]['to_floorlevel']=_0x220e48;}),_0x473de5[_0x51564a(0x127)]((_0x2f8fbf,_0x2d178f)=>{_0x9a1708[_0x2d178f]['primary_code']=_0x2f8fbf;}),_0x3101b4[_0x51564a(0x127)]((_0x593b76,_0x5d7e42)=>{var _0x472ac1=_0x51564a;_0x9a1708[_0x5d7e42][_0x472ac1(0x120)]=_0x593b76;}),_0x101591[_0x51564a(0x127)]((_0x3dc7d9,_0x254920)=>{var _0x4e77da=_0x51564a;_0x9a1708[_0x254920][_0x4e77da(0x8d)]=_0x3dc7d9;}),_0x461494[_0x51564a(0x127)]((_0x101c27,_0x409386)=>{var _0x2d5bd6=_0x51564a;_0x9a1708[_0x409386][_0x2d5bd6(0xd4)]=_0x101c27;}),_0x34a20d[_0x51564a(0x127)]((_0x206c7c,_0xf5d8f5)=>{_0x9a1708[_0xf5d8f5]['unit']=_0x206c7c;}),_0x9b065e[_0x51564a(0x127)]((_0x366ae7,_0x5d5fee)=>{var _0x49bbe4=_0x51564a;_0x9a1708[_0x5d5fee][_0x49bbe4(0xf4)]=_0x366ae7;}),_0x5c7872[_0x51564a(0x127)]((_0x1d9f8f,_0x2c6231)=>{var _0x47fa64=_0x51564a;_0x9a1708[_0x2c6231][_0x47fa64(0x7a)]=_0x1d9f8f;}),_0x53b223[_0x51564a(0x127)]((_0x128878,_0x1a0320)=>{var _0x4179dd=_0x51564a;_0x9a1708[_0x1a0320][_0x4179dd(0x112)]=_0x128878;}),_0x25f783[_0x51564a(0x127)]((_0x16d2d0,_0x1cff8d)=>{var _0x3acc5c=_0x51564a;_0x9a1708[_0x1cff8d][_0x3acc5c(0x77)]=_0x16d2d0;}),_0x2d37ad[_0x51564a(0x127)]((_0x3b44eb,_0x1e81cf)=>{_0x9a1708[_0x1e81cf]['rack']=_0x3b44eb;}),_0x4ee7a6[_0x51564a(0x127)]((_0x36da8c,_0x12f884)=>{_0x9a1708[_0x12f884]['from_types']=_0x36da8c;}),_0x32cbe5['forEach']((_0x4ef035,_0x5ae2dd)=>{_0x9a1708[_0x5ae2dd]['to_types']=_0x4ef035;}),_0x4f966d['forEach']((_0x2fab00,_0x27e6ca)=>{var _0xb7bfac=_0x51564a;_0x9a1708[_0x27e6ca][_0xb7bfac(0x100)]=_0x2fab00;}),_0xc4825d[_0x51564a(0x127)]((_0x462326,_0x16a8e9)=>{var _0x1f595a=_0x51564a;_0x9a1708[_0x16a8e9][_0x1f595a(0xdc)]=_0x462326;});const _0x1f88ce=_0x9a1708['filter'](_0xcd0fc7=>_0xcd0fc7[_0x51564a(0x8a)]!=='0'&&_0xcd0fc7[_0x51564a(0x8a)]!==''||_0xcd0fc7[_0x51564a(0x109)]!=='0'&&_0xcd0fc7[_0x51564a(0x109)]!=='');var _0x5aa9a7=0x0;_0x1f88ce['forEach'](_0x37c304=>{var _0x3f8d71=_0x51564a;parseInt(_0x37c304[_0x3f8d71(0x143)])<parseInt(_0x37c304[_0x3f8d71(0x8a)])&&_0x5aa9a7++;});if(_0x5aa9a7!=0x0)return _0xaeadc7[_0x51564a(0x14a)](_0x51564a(0xba),_0x51564a(0x13c)),_0x26fdb4[_0x51564a(0xc3)](_0x51564a(0xd7));const _0x106a32=await warehouse['findOne']({'name':_0x5ced13[_0x51564a(0x108)],'room':_0x5ced13[_0x51564a(0x138)]});_0x5ced13[_0x51564a(0xc2)][_0x51564a(0x127)](_0x370d91=>{var _0x27e9d0=_0x51564a;if(_0x370d91[_0x27e9d0(0x8a)]>0x0){const _0x19a113=_0x106a32['product_details'][_0x27e9d0(0xf0)](_0x464695=>{var _0x21ca26=_0x27e9d0;_0x464695['product_name']==_0x370d91[_0x21ca26(0x124)]&&_0x464695[_0x21ca26(0x9a)]==_0x370d91[_0x21ca26(0xea)]&&_0x464695['type']==_0x370d91[_0x21ca26(0x99)]&&_0x464695[_0x21ca26(0xbd)]==_0x370d91[_0x21ca26(0x122)]&&_0x464695['bay']==_0x370d91['from_bay']&&_0x464695[_0x21ca26(0x153)]==_0x370d91[_0x21ca26(0xdc)]&&_0x464695[_0x21ca26(0x77)]==_0x370d91[_0x21ca26(0x100)]&&(_0x464695[_0x21ca26(0xad)]=parseInt(_0x464695[_0x21ca26(0xad)])+parseInt(_0x370d91[_0x21ca26(0x8a)]));});}}),await _0x106a32[_0x51564a(0x95)]();const _0x2ec1b2=await warehouse['findOne']({'name':_0x5ced13[_0x51564a(0x146)],'room':_0x5ced13[_0x51564a(0x91)]});_0x5ced13[_0x51564a(0xc2)][_0x51564a(0x127)](_0x23e0ab=>{var _0x39090f=_0x51564a;if(_0x23e0ab[_0x39090f(0x8a)]>0x0){const _0x37067b=_0x2ec1b2['product_details']['map'](_0x342efb=>{var _0x4987a4=_0x39090f;_0x342efb['product_name']==_0x23e0ab[_0x4987a4(0x124)]&&_0x342efb[_0x4987a4(0x9a)]==_0x23e0ab[_0x4987a4(0x109)]&&_0x342efb[_0x4987a4(0xd0)]==_0x23e0ab[_0x4987a4(0x8f)]&&_0x342efb[_0x4987a4(0xbd)]==_0x23e0ab[_0x4987a4(0x115)]&&_0x342efb[_0x4987a4(0x158)]==_0x23e0ab[_0x4987a4(0xda)]&&_0x342efb[_0x4987a4(0x153)]==_0x23e0ab['rack']&&_0x342efb['storage']==_0x23e0ab[_0x4987a4(0x77)]&&(_0x342efb[_0x4987a4(0xad)]=parseInt(_0x342efb[_0x4987a4(0xad)])-parseInt(_0x23e0ab[_0x4987a4(0x8a)]));});}}),await _0x2ec1b2[_0x51564a(0x95)](),_0x5ced13['date']=_0x198a00,_0x5ced13[_0x51564a(0x108)]=_0x142c6b,_0x5ced13['to_warehouse']=_0x4c436d,_0x5ced13[_0x51564a(0xc2)]=_0x1f88ce,_0x5ced13[_0x51564a(0xff)]=_0x28c654,_0x5ced13[_0x51564a(0xfa)]=_0x208f15;const _0x3bbbe6=await _0x5ced13['save']();console[_0x51564a(0x144)](_0x3bbbe6);const _0x14feba=await warehouse['findOne']({'name':_0x142c6b,'room':_0x26a915});_0x3bbbe6[_0x51564a(0xc2)][_0x51564a(0x127)](_0x3b3fe0=>{var _0x4067dc=_0x51564a;if(_0x3b3fe0[_0x4067dc(0x8a)]>0x0){const _0x25dc4b=_0x14feba[_0x4067dc(0xf2)][_0x4067dc(0xf0)](_0x29351d=>{var _0x4ea539=_0x4067dc;_0x29351d[_0x4ea539(0x124)]==_0x3b3fe0[_0x4ea539(0x124)]&&_0x29351d[_0x4ea539(0x9a)]==_0x3b3fe0['from_floorlevel']&&_0x29351d[_0x4ea539(0xd0)]==_0x3b3fe0[_0x4ea539(0x99)]&&_0x29351d[_0x4ea539(0xbd)]==_0x3b3fe0[_0x4ea539(0x122)]&&_0x29351d['bay']==_0x3b3fe0['from_bay']&&_0x29351d[_0x4ea539(0x153)]==_0x3b3fe0[_0x4ea539(0xdc)]&&_0x29351d['storage']==_0x3b3fe0[_0x4ea539(0x100)]&&(_0x29351d[_0x4ea539(0xad)]=parseInt(_0x29351d[_0x4ea539(0xad)])-parseInt(_0x3b3fe0[_0x4ea539(0x8a)]));});}}),await _0x14feba[_0x51564a(0x95)]();const _0x405946=await warehouse['findOne']({'name':_0x4c436d,'room':_0x3b05d0});_0x3bbbe6[_0x51564a(0xc2)][_0x51564a(0x127)](_0x3c332f=>{var _0x425d5a=_0x51564a;if(_0x3c332f['to_quantity']>0x0){var _0x2fc259=0x0;const _0x2be179=_0x405946[_0x425d5a(0xf2)][_0x425d5a(0xf0)](_0x3f579d=>{var _0x1f2161=_0x425d5a;_0x3f579d[_0x1f2161(0x124)]==_0x3c332f[_0x1f2161(0x124)]&&_0x3f579d['floorlevel']==_0x3c332f[_0x1f2161(0x109)]&&_0x3f579d['type']==_0x3c332f[_0x1f2161(0x8f)]&&_0x3f579d['bin']==_0x3c332f[_0x1f2161(0x115)]&&_0x3f579d[_0x1f2161(0x158)]==_0x3c332f[_0x1f2161(0xda)]&&_0x3f579d['rack']==_0x3c332f[_0x1f2161(0x153)]&&_0x3f579d['storage']==_0x3c332f[_0x1f2161(0x77)]&&(_0x3f579d[_0x1f2161(0xad)]=parseInt(_0x3f579d[_0x1f2161(0xad)])+parseInt(_0x3c332f[_0x1f2161(0x8a)]),_0x2fc259++);});_0x2fc259=='0'&&(_0x405946['product_details']=_0x405946['product_details']['concat']({'product_name':_0x3c332f[_0x425d5a(0x124)],'product_stock':_0x3c332f[_0x425d5a(0x8a)],'bay':_0x3c332f['to_bay'],'bin':_0x3c332f[_0x425d5a(0x115)],'type':_0x3c332f[_0x425d5a(0x8f)],'floorlevel':_0x3c332f[_0x425d5a(0x109)],'storage':_0x3c332f[_0x425d5a(0x77)],'rack':_0x3c332f['rack'],'product_code':_0x3c332f[_0x425d5a(0x8d)],'primary_code':_0x3c332f['primary_code'],'secondary_code':_0x3c332f[_0x425d5a(0x120)],'maxProducts':_0x3c332f['maxProducts'],'storage':_0x3c332f[_0x425d5a(0x77)],'rack':_0x3c332f['rack']}));}}),await _0x405946[_0x51564a(0x95)](),_0xaeadc7[_0x51564a(0x14a)](_0x51564a(0xe5),_0x51564a(0xb7)),_0x26fdb4[_0x51564a(0xc3)]('/transfer/view');}catch(_0x18866b){console['log'](_0x18866b);}}),router[a0_0x45dd62(0x13a)]('/barcode_scanner',async(_0x51e108,_0x19d8e4)=>{var _0x2da2ec=a0_0x45dd62;const {FromWareHouse:_0x31eab6,FromRoom:_0x16efed,ToWarehouse:_0x4ea96b,ToRoom:_0x29cc7f,primary_code:_0x5d2a5e,Roomslist:_0x3fe69a}=_0x51e108[_0x2da2ec(0x161)],_0x19ea01=_0x3fe69a['split'](','),_0x20142b=[];async function _0x2fa2ed(_0x3b60db){var _0x1e3e19=_0x2da2ec;const _0x1b0766=await warehouse['aggregate']([{'$match':{'name':_0x31eab6,'room':_0x3b60db}},{'$unwind':_0x1e3e19(0x10d)},{'$match':{'product_details.primary_code':_0x5d2a5e}},{'$group':{'_id':_0x1e3e19(0x159),'name':{'$first':_0x1e3e19(0xa2)},'instock':{'$first':_0x1e3e19(0xc6)},'primary_code':{'$first':_0x1e3e19(0x11c)},'secondary_code':{'$first':_0x1e3e19(0xe1)},'product_code':{'$first':_0x1e3e19(0x155)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x1e3e19(0x74)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1e3e19(0xee)},'unit':{'$first':_0x1e3e19(0x12a)},'secondary_unit':{'$first':_0x1e3e19(0xa3)},'storage':{'$first':_0x1e3e19(0x157)},'rack':{'$first':_0x1e3e19(0xb3)},'expiry_date':{'$first':_0x1e3e19(0x15c)},'production_date':{'$first':_0x1e3e19(0xbc)},'batch_code':{'$first':_0x1e3e19(0x12c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x1e3e19(0x148)},'maxProducts':{'$first':_0x1e3e19(0xdd)},'invoice_product':{'$first':_0x1e3e19(0xa5)}}}]),_0x5693cd=await warehouse[_0x1e3e19(0x101)]([{'$match':{'name':_0x31eab6,'room':_0x3b60db}},{'$unwind':_0x1e3e19(0x10d)},{'$match':{'product_details.secondary_code':_0x5d2a5e}},{'$group':{'_id':_0x1e3e19(0x159),'name':{'$first':_0x1e3e19(0xa2)},'instock':{'$first':_0x1e3e19(0xc6)},'primary_code':{'$first':_0x1e3e19(0x11c)},'secondary_code':{'$first':_0x1e3e19(0xe1)},'product_code':{'$first':_0x1e3e19(0x155)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1e3e19(0xc5)},'pallet':{'$first':_0x1e3e19(0xee)},'unit':{'$first':_0x1e3e19(0x12a)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x1e3e19(0x157)},'rack':{'$first':_0x1e3e19(0xb3)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1e3e19(0xbc)},'batch_code':{'$first':_0x1e3e19(0x12c)},'maxPerUnit':{'$first':_0x1e3e19(0x135)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x1e3e19(0x148)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x1e3e19(0xa5)}}}]);if(_0x1b0766['length']>0x0)_0x20142b[_0x1e3e19(0x7d)](_0x1b0766);else _0x5693cd[_0x1e3e19(0x102)]>0x0&&_0x20142b[_0x1e3e19(0x7d)](_0x5693cd);}const _0x3b9189=_0x19ea01[_0x2da2ec(0xf0)](_0x17fa9b=>_0x2fa2ed(_0x17fa9b));await Promise[_0x2da2ec(0xa4)](_0x3b9189),_0x19d8e4[_0x2da2ec(0xf9)](_0x20142b);}),router[a0_0x45dd62(0x13a)](a0_0x45dd62(0xbf),async(_0x5b31a9,_0x16d28f)=>{var _0xb0f5e9=a0_0x45dd62;try{const {FromWareHouse:_0x28012b,FromRoom:_0x473c1d,ToWarehouse:_0x290fda,ToRoom:_0x2ea364,secondary_code:_0xb9cd8c}=_0x5b31a9[_0xb0f5e9(0x161)],_0x5087df=await warehouse['aggregate']([{'$match':{'name':_0x28012b}},{'$unwind':_0xb0f5e9(0x10d)},{'$match':{'product_details.secondary_code':_0xb9cd8c}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xb0f5e9(0xa2)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xb0f5e9(0xe1)},'product_code':{'$first':_0xb0f5e9(0x155)},'instock':{'$first':_0xb0f5e9(0xc6)},'warehouse':{'$first':_0xb0f5e9(0x160)},'level':{'$first':_0xb0f5e9(0x15e)},'isle':{'$first':_0xb0f5e9(0xae)},'pallet':{'$first':_0xb0f5e9(0xfb)},'maxProducts':{'$first':_0xb0f5e9(0xdd)},'unit':{'$first':_0xb0f5e9(0x12a)}}}]);_0x16d28f[_0xb0f5e9(0xd2)](0xc8)[_0xb0f5e9(0xf9)](_0x5087df);}catch(_0x23728c){_0x16d28f['status'](0x194)[_0xb0f5e9(0xf9)]({'message':_0x23728c[_0xb0f5e9(0xe3)]});}}),router[a0_0x45dd62(0x13a)]('/barcode_scanner3',async(_0x49a15c,_0xfa475)=>{var _0x241a0d=a0_0x45dd62;try{const {FromWareHouse:_0x4ceed8,FromRoom:_0x90d8b5,ToWarehouse:_0x25e802,ToRoom:_0x19a70,product_code:_0x3499f2}=_0x49a15c[_0x241a0d(0x161)],_0x19cf01=await warehouse[_0x241a0d(0x101)]([{'$match':{'name':_0x4ceed8}},{'$unwind':_0x241a0d(0x10d)},{'$match':{'product_details.product_code':_0x3499f2}},{'$group':{'_id':_0x241a0d(0x159),'name':{'$first':_0x241a0d(0xa2)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x241a0d(0x155)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x241a0d(0x15e)},'isle':{'$first':_0x241a0d(0xae)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x241a0d(0xdd)},'unit':{'$first':_0x241a0d(0x12a)}}}]);_0xfa475['status'](0xc8)[_0x241a0d(0xf9)](_0x19cf01);}catch(_0x8dc4de){_0xfa475[_0x241a0d(0xd2)](0x194)[_0x241a0d(0xf9)]({'message':_0x8dc4de[_0x241a0d(0xe3)]});}}),router[a0_0x45dd62(0x13a)](a0_0x45dd62(0x139),async(_0x3a27f2,_0x580e8a)=>{var _0x986b43=a0_0x45dd62;const {level:_0x2c95d8,isle:_0x4dfdcd,pallet:_0x308ee,warehouses:_0x41ee24,room:_0x193be0}=_0x3a27f2[_0x986b43(0x161)];try{const _0x422f81=await warehouse['aggregate']([{'$match':{'name':_0x41ee24,'room':_0x193be0}},{'$unwind':_0x986b43(0x10d)},{'$match':{'product_details.level':parseInt(_0x2c95d8),'product_details.isle':_0x4dfdcd,'product_details.pallet':parseInt(_0x308ee)}},{'$group':{'_id':_0x986b43(0x159),'name':{'$first':_0x986b43(0xa2)},'product_stock':{'$first':_0x986b43(0xc6)},'level':{'$first':_0x986b43(0x15e)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x986b43(0xfb)},'maxProducts':{'$first':_0x986b43(0xdd)}}}]);_0x580e8a[_0x986b43(0xd2)](0xc8)['json'](_0x422f81);}catch(_0x207fc2){_0x580e8a[_0x986b43(0xd2)](0x194)[_0x986b43(0xf9)]({'message':_0x207fc2[_0x986b43(0xe3)]});}}),module[a0_0x45dd62(0x14e)]=router;