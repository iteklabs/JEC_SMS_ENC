function a0_0x5760(_0x44009e,_0x222de1){var _0x2c4291=a0_0x2c42();return a0_0x5760=function(_0x57601b,_0x47c084){_0x57601b=_0x57601b-0xfc;var _0x4e57cd=_0x2c4291[_0x57601b];return _0x4e57cd;},a0_0x5760(_0x44009e,_0x222de1);}var a0_0x366757=a0_0x5760;function a0_0x2c42(){var _0x2c5e87=['findOne','$from_warehouse','storage','$product_details.rack','from_warehouse','catch','staff','Portuguese','maxProducts','../middleware/auth','post','from_bin','RMSEmail','\x20Order\x20Date\x20:\x20','<hr\x20class=\x22my-3\x22>','concat','Rack\x20F','email','to_prod_pallet','../public/language/languages.json','edit_transfer_view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','here','\x20<>\x20','bay','to_quantity','$invoice','error','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','slice','Return\x20Rooms','Transfer\x20Mail','$finalize','Rack\x20B','Hindi','finalize','Raw\x20Materials','Floor','$product_details.production_date','body','MaxStocks_data2','from_storage','1523210kGgjhJ','TRF-','English\x20(US)','</tr>','rak','<strong>\x20Regards\x20</strong>','to_room_name','id_transaction_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','express','logo','<html><head><title></title>','$product_details.secondary_unit','$product_details.product_code','302726tQKdFT','$room','note','floor','Enclosed','prod_cat','$product.from_room_name','to_prod_isle','Arabic','length','to_warehouse','from_prod_isle','/view','host','$product.to_room_name','_id','date','Ambient','flash','$product_details.product_stock','$product_details.batch_code','prod_name','$product_details.bay','forEach','/transfer/preview/','Email\x20sent\x20successfully','errors','Arabic\x20(ae)','log','from_quantity','random','role','render','33tVRnhv','8WiVbAK','createTransport','<!DOCTYPE\x20html>','to_floorlevel','$product_details.type','product_code','Rack\x20A','product_details','max_per_unit','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<h5\x20style=\x22text-align:\x20left;\x22>','Enabled','id_transaction','push','from_prod_level','from_types','port','getFullYear','$product_details.bin','from_rack','redirect','ToRoomAssigned','getMonth','$date','expiry_date','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','aggregate','<tr>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','</span>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','455908xNggnR','params','French','COLD\x20STORAGE','image','5328827IcqSAK','</body></html>','262098lKZIHk','warehouse','from_bay','status','json','77zobGHe','$product_details.floorlevel','from_room_name','10171890wuJSnj','$product_details.maxProducts','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','An\x20error\x20occurred\x20while\x20saving\x20data.','Rack\x20D','Shelves','from_room','$product_details.isle','then','primary_unit','\x20</h2>','transfer','bin','nodemailer','get','$product_details.product_name','$product_details.storage','/transfer/view','/picking_list/PDF_transfer_rm/','rack','<tbody\x20style=\x22text-align:\x20center;\x22>','password','$product_details.maxPerUnit','$product_details._id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.pallet','/preview/:id','<h5>','filter','An\x20error\x20occurred.','<h2>\x20','to_bay','</h5>','to_types','Transfer\x20Edit\x20Successfully','split','Spanish','from_invoice','../models/all_models','secondary_unit','secondary_code','to_prod_level','to_bin','New_Qty_Converted','To_invoice','language','$product_details.level','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','20180wlvitN','Logo.png','primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','German','product_stock','/../public','Receiving\x20Area','$to_warehouse','</table>','master','site_title','message','all','Rack\x20E','$name','$product_details.expiry_date','success','add_transfer','product','from_floorlevel','product_code3','</div>','Rack\x20C','save','30MVCQbe','RoomAssigned','/view/:id','find','findById','to_invoice','type','Chinese','maxperunit','Portuguese\x20(BR)','$product_details.unit','invoice','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_prod_qty','</td>','Level','product_name','user','$product_details.secondary_code','True','<div>','string','map','$product_details.invoice','$product_details','production_date','batch_code','back','Transfer\x20Finalize\x20Successfully','floorlevel','unit','getDate','/barcode_scanner3'];a0_0x2c42=function(){return _0x2c5e87;};return a0_0x2c42();}(function(_0x37d591,_0x559cbd){var _0x44fe41=a0_0x5760,_0x1166d6=_0x37d591();while(!![]){try{var _0x52bc3b=-parseInt(_0x44fe41(0x1a8))/0x1+parseInt(_0x44fe41(0x1e9))/0x2+-parseInt(_0x44fe41(0x1c9))/0x3*(parseInt(_0x44fe41(0x133))/0x4)+-parseInt(_0x44fe41(0x14c))/0x5*(-parseInt(_0x44fe41(0x1f0))/0x6)+parseInt(_0x44fe41(0x1ee))/0x7*(parseInt(_0x44fe41(0x1ca))/0x8)+-parseInt(_0x44fe41(0x102))/0x9+parseInt(_0x44fe41(0x19a))/0xa*(parseInt(_0x44fe41(0xff))/0xb);if(_0x52bc3b===_0x559cbd)break;else _0x1166d6['push'](_0x1166d6['shift']());}catch(_0x18bf6b){_0x1166d6['push'](_0x1166d6['shift']());}}}(a0_0x2c42,0xca6c9));const express=require(a0_0x366757(0x1a3)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x366757(0x128)),auth=require(a0_0x366757(0x179)),users=require(a0_0x366757(0x183)),nodemailer=require(a0_0x366757(0x10f));router['get'](a0_0x366757(0x1b4),auth,async(_0x26f1dc,_0x4225c1)=>{var _0x4e7358=a0_0x366757;try{const {username:_0x126c43,email:_0x29b3ff,role:_0x5986d8}=_0x26f1dc[_0x4e7358(0x160)],_0x1630cf=_0x26f1dc[_0x4e7358(0x160)],_0x4eb94e=await profile[_0x4e7358(0x170)]({'email':_0x1630cf[_0x4e7358(0x181)]}),_0x4b82c2=await master_shop['find']();console[_0x4e7358(0x1c4)](_0x4e7358(0x13d),_0x4b82c2);let _0x1e74c3;if(_0x1630cf[_0x4e7358(0x1c7)]=='staff'){const _0x5ed8bf=await staff['findOne']({'email':_0x1630cf[_0x4e7358(0x181)]});_0x1e74c3=await transfers[_0x4e7358(0x14f)]({'from_warehouse':_0x5ed8bf[_0x4e7358(0x1f1)]});}else _0x1e74c3=await transfers[_0x4e7358(0x1e4)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x4e7358(0x18a)},'date':{'$first':_0x4e7358(0x1e1)},'from_warehouse':{'$first':_0x4e7358(0x171)},'to_warehouse':{'$first':_0x4e7358(0x13b)},'from_room_name':{'$addToSet':_0x4e7358(0x1ae)},'to_room_name':{'$addToSet':_0x4e7358(0x1b6)},'finalize':{'$first':_0x4e7358(0x190)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4b82c2[0x0][_0x4e7358(0x12f)]==_0x4e7358(0x19c)){var _0x1b2b58=users[_0x4e7358(0x15a)];console[_0x4e7358(0x1c4)](_0x1b2b58);}else{if(_0x4b82c2[0x0][_0x4e7358(0x12f)]==_0x4e7358(0x192))var _0x1b2b58=users[_0x4e7358(0x192)];else{if(_0x4b82c2[0x0][_0x4e7358(0x12f)]==_0x4e7358(0x137))var _0x1b2b58=users[_0x4e7358(0x137)];else{if(_0x4b82c2[0x0]['language']==_0x4e7358(0x126))var _0x1b2b58=users[_0x4e7358(0x126)];else{if(_0x4b82c2[0x0][_0x4e7358(0x12f)]==_0x4e7358(0x1eb))var _0x1b2b58=users[_0x4e7358(0x1eb)];else{if(_0x4b82c2[0x0][_0x4e7358(0x12f)]==_0x4e7358(0x155))var _0x1b2b58=users[_0x4e7358(0x177)];else{if(_0x4b82c2[0x0][_0x4e7358(0x12f)]==_0x4e7358(0x153))var _0x1b2b58=users[_0x4e7358(0x153)];else{if(_0x4b82c2[0x0][_0x4e7358(0x12f)]==_0x4e7358(0x1c3))var _0x1b2b58=users[_0x4e7358(0x1b0)];}}}}}}}_0x4225c1['render'](_0x4e7358(0x10d),{'success':_0x26f1dc['flash'](_0x4e7358(0x144)),'errors':_0x26f1dc[_0x4e7358(0x1ba)]('errors'),'role':_0x1630cf,'profile':_0x4eb94e,'master_shop':_0x4b82c2,'transfer':_0x1e74c3,'language':_0x1b2b58});}catch(_0x7633c5){console[_0x4e7358(0x1c4)](_0x7633c5);}});async function getRandom8DigitNumber(){var _0xec152=a0_0x366757;const _0x1bd8ef=0x989680,_0xb05d48=0x5f5e0ff,_0x27d591=Math[_0xec152(0x1ab)](Math[_0xec152(0x1c6)]()*(_0xb05d48-_0x1bd8ef+0x1))+_0x1bd8ef;var _0x4610c2;const _0x5c5f80=await transfers[_0xec152(0x170)]({'invoice':_0xec152(0x19b)+_0x27d591});return _0x5c5f80&&_0x5c5f80[_0xec152(0x1b1)]>0x0?_0x4610c2=_0xec152(0x19b)+_0x27d591:_0x4610c2='TRF-'+_0x27d591,_0x4610c2;}router[a0_0x366757(0x110)]('/view/add_transfer',auth,async(_0x55c555,_0x1834d2)=>{var _0x4c14b=a0_0x366757;try{const {username:_0xd59283,email:_0x5193c7,role:_0x5e32dc}=_0x55c555['user'],_0x4c68d6=_0x55c555['user'],_0x511662=await profile[_0x4c14b(0x170)]({'email':_0x4c68d6[_0x4c14b(0x181)]}),_0x20d41b=await master_shop['find']();console[_0x4c14b(0x1c4)]('master',_0x20d41b);let _0x1b0e0d;if(_0x4c68d6[_0x4c14b(0x1c7)]==_0x4c14b(0x176)){const _0x584711=await staff['findOne']({'email':_0x4c68d6[_0x4c14b(0x181)]});_0x1b0e0d=await warehouse['aggregate']([{'$match':{'status':_0x4c14b(0x1d5),'name':_0x584711[_0x4c14b(0x1f1)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4c14b(0x142),'name':{'$first':_0x4c14b(0x142)}}}]);}else _0x1b0e0d=await warehouse[_0x4c14b(0x1e4)]([{'$match':{'status':'Enabled','warehouse_category':_0x4c14b(0x194)}},{'$group':{'_id':'$name','name':{'$first':_0x4c14b(0x142)}}}]);var _0x174596=[_0x4c14b(0x1b9),_0x4c14b(0x1ac),_0x4c14b(0x18e)];const _0xa09b12=await transfers[_0x4c14b(0x14f)]({}),_0x21ae39=_0xa09b12['length']+0x1,_0x3b971f='TRF-'+_0x21ae39['toString']()['padStart'](0x5,'0');if(_0x20d41b[0x0][_0x4c14b(0x12f)]==_0x4c14b(0x19c)){var _0x13c748=users[_0x4c14b(0x15a)];console['log'](_0x13c748);}else{if(_0x20d41b[0x0][_0x4c14b(0x12f)]=='Hindi')var _0x13c748=users[_0x4c14b(0x192)];else{if(_0x20d41b[0x0]['language']=='German')var _0x13c748=users[_0x4c14b(0x137)];else{if(_0x20d41b[0x0][_0x4c14b(0x12f)]==_0x4c14b(0x126))var _0x13c748=users['Spanish'];else{if(_0x20d41b[0x0]['language']==_0x4c14b(0x1eb))var _0x13c748=users[_0x4c14b(0x1eb)];else{if(_0x20d41b[0x0][_0x4c14b(0x12f)]==_0x4c14b(0x155))var _0x13c748=users['Portuguese'];else{if(_0x20d41b[0x0][_0x4c14b(0x12f)]=='Chinese')var _0x13c748=users[_0x4c14b(0x153)];else{if(_0x20d41b[0x0]['language']==_0x4c14b(0x1c3))var _0x13c748=users[_0x4c14b(0x1b0)];}}}}}}}const _0x3d3fbd=getRandom8DigitNumber();_0x3d3fbd[_0x4c14b(0x10a)](_0x2dbb94=>{var _0x18c454=_0x4c14b;_0x1834d2[_0x18c454(0x1c8)](_0x18c454(0x145),{'success':_0x55c555[_0x18c454(0x1ba)]('success'),'errors':_0x55c555['flash'](_0x18c454(0x1c2)),'role':_0x4c68d6,'profile':_0x511662,'master_shop':_0x20d41b,'warehouse':_0x1b0e0d,'language':_0x13c748,'rooms_data':_0x174596,'invoice':_0x2dbb94});})[_0x4c14b(0x175)](_0xf49997=>{var _0x2686da=_0x4c14b;_0x55c555[_0x2686da(0x1ba)]('errors',_0x2686da(0x1e6)),_0x1834d2['redirect'](_0x2686da(0x113));});}catch(_0x4e3edb){console[_0x4c14b(0x1c4)](_0x4e3edb);}}),router[a0_0x366757(0x17a)]('/view/add_transfer',auth,async(_0x555430,_0x5dbd66)=>{var _0x5ccfda=a0_0x366757;try{console[_0x5ccfda(0x1c4)](_0x555430[_0x5ccfda(0x197)]);const {date:_0x596b5a,from_warehouse:_0x43935f,FromRoom_name:_0x1026f9,to_warehouse:_0xbb8f0c,ToRoom_name:_0x4bd571,prod_name:_0x2f5c11,from_prod_qty:_0x43318c,from_prod_level:_0x6cd37a,from_prod_isle:_0x6f8e7d,from_prod_pallet:_0x116398,to_prod_qty:_0x3efcbe,to_prod_level:_0x191f92,to_prod_isle:_0xe10eaf,to_prod_pallet:_0x506acf,primary_code:_0x1fd7b0,secondary_code:_0x53758b,product_code3:_0x227398,note:_0x509e7c,MaxStocks_data2:_0x444100,invoice:_0x3ee5d4,expiry_date:_0xc50bb8}=_0x555430[_0x5ccfda(0x197)];if(typeof _0x2f5c11==_0x5ccfda(0x164))var _0x3972e8=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x1bd)]],_0x4d15a0=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x15c)]],_0x171efc=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x1d8)]],_0x1f104b=[_0x555430['body'][_0x5ccfda(0x12d)]],_0x336091=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x12b)]],_0x168931=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x135)]],_0x350991=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x12a)]],_0x160a8e=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x148)]],_0x1de07b=[_0x555430[_0x5ccfda(0x197)]['MaxStocks_data2']],_0x8b454a=[_0x555430['body'][_0x5ccfda(0x10b)]],_0x912c9c=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x129)]],_0x3ecc9f=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x169)]],_0x1f50b9=[_0x555430[_0x5ccfda(0x197)]['expiry_date']],_0x565d9f=[_0x555430[_0x5ccfda(0x197)]['max_per_unit']],_0x5b8df9=[_0x555430['body'][_0x5ccfda(0x168)]],_0x18b028=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x1ad)]],_0x127ce9=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x14d)]],_0x838f4b=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x1df)]],_0x13c7c5=[_0x555430[_0x5ccfda(0x197)]['from_invoice']],_0x589a26=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x151)]],_0x14c425=[_0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x1d6)]];else var _0x3972e8=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x1bd)]],_0x4d15a0=[..._0x555430[_0x5ccfda(0x197)]['from_prod_qty']],_0x171efc=[..._0x555430['body'][_0x5ccfda(0x1d8)]],_0x1f104b=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x12d)]],_0x336091=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x12b)]],_0x168931=[..._0x555430[_0x5ccfda(0x197)]['primary_code']],_0x350991=[..._0x555430['body'][_0x5ccfda(0x12a)]],_0x160a8e=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x148)]],_0x1de07b=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x198)]],_0x8b454a=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x10b)]],_0x912c9c=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x129)]],_0x3ecc9f=[..._0x555430['body'][_0x5ccfda(0x169)]],_0x1f50b9=[..._0x555430[_0x5ccfda(0x197)]['expiry_date']],_0x565d9f=[..._0x555430['body'][_0x5ccfda(0x1d2)]],_0x5b8df9=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x168)]],_0x18b028=[..._0x555430[_0x5ccfda(0x197)]['prod_cat']],_0x127ce9=[..._0x555430['body']['RoomAssigned']],_0x838f4b=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x1df)]],_0x13c7c5=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x127)]],_0x589a26=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x151)]],_0x14c425=[..._0x555430[_0x5ccfda(0x197)][_0x5ccfda(0x1d6)]];const _0x25f641=_0x3972e8['map'](_0x571668=>{return _0x571668={'product_name':_0x571668};});_0x4d15a0[_0x5ccfda(0x1bf)]((_0x105210,_0x1601d4)=>{var _0x284ced=_0x5ccfda;_0x25f641[_0x1601d4][_0x284ced(0x1c5)]=_0x105210;}),_0x13c7c5[_0x5ccfda(0x1bf)]((_0x16624f,_0x589e57)=>{var _0x1020fc=_0x5ccfda;_0x25f641[_0x589e57][_0x1020fc(0x127)]=_0x16624f;}),_0x589a26[_0x5ccfda(0x1bf)]((_0x2864c4,_0x32d18e)=>{var _0x562482=_0x5ccfda;_0x25f641[_0x32d18e][_0x562482(0x12e)]=_0x2864c4;}),_0x14c425[_0x5ccfda(0x1bf)]((_0x1bda2c,_0x401d38)=>{var _0x11dd3c=_0x5ccfda;_0x25f641[_0x401d38][_0x11dd3c(0x1a1)]=_0x1bda2c;}),_0x171efc['forEach']((_0x2ab998,_0x2c8fa4)=>{_0x127ce9['forEach']((_0x8e730c,_0x79ffa8)=>{var _0x8bc458=a0_0x5760;if(_0x8e730c=='Receiving\x20Area'&&_0x2c8fa4==_0x79ffa8){var _0x473f55=_0x2ab998[_0x8bc458(0x18d)](0x3);_0x25f641[_0x2c8fa4]['from_storage']=_0x2ab998[0x0],_0x25f641[_0x2c8fa4]['from_rack']=_0x2ab998[0x1],_0x25f641[_0x2c8fa4][_0x8bc458(0xfc)]=0x0,_0x25f641[_0x2c8fa4][_0x8bc458(0x17b)]=0x0,_0x25f641[_0x2c8fa4]['from_types']=_0x8bc458(0x195),_0x25f641[_0x2c8fa4][_0x8bc458(0x147)]=_0x473f55;}else{if(_0x8e730c==_0x8bc458(0x107)&&_0x2c8fa4==_0x79ffa8){var _0x473f55=_0x2ab998[_0x8bc458(0x18d)](0x3);_0x25f641[_0x2c8fa4][_0x8bc458(0x199)]=_0x2ab998[0x0],_0x25f641[_0x2c8fa4][_0x8bc458(0x1dd)]=_0x2ab998[0x1],_0x25f641[_0x2c8fa4][_0x8bc458(0xfc)]=0x0,_0x25f641[_0x2c8fa4][_0x8bc458(0x17b)]=0x0,_0x25f641[_0x2c8fa4][_0x8bc458(0x1d9)]=_0x8bc458(0x195),_0x25f641[_0x2c8fa4][_0x8bc458(0x147)]=_0x2ab998[0x5];}else{if(_0x2c8fa4==_0x79ffa8){if(_0x2ab998[0x0]=='A'&&_0x2ab998[0x1]=='L'&&_0x2ab998[0x2]=='L')console[_0x8bc458(0x1c4)](_0x8e730c+_0x8bc458(0x187)+_0x2c8fa4+'\x20<>\x20'+_0x79ffa8+_0x8bc458(0x187)+_0x2ab998+_0x8bc458(0x186)),_0x25f641[_0x2c8fa4]['from_storage']=_0x2ab998[0x0],_0x25f641[_0x2c8fa4][_0x8bc458(0x1dd)]=_0x2ab998[0x1],_0x25f641[_0x2c8fa4]['from_bay']=0x0,_0x25f641[_0x2c8fa4][_0x8bc458(0x17b)]=0x0,_0x25f641[_0x2c8fa4]['from_types']=_0x8bc458(0x195),_0x25f641[_0x2c8fa4]['from_floorlevel']=_0x2ab998[0x3];else{var _0xeef41b;if(_0x2ab998[0x4]=='L')_0xeef41b=_0x8bc458(0x15e);else _0x2ab998[0x4]=='F'&&(_0xeef41b='Floor');_0x25f641[_0x2c8fa4][_0x8bc458(0x199)]=_0x2ab998[0x0],_0x25f641[_0x2c8fa4][_0x8bc458(0x1dd)]=_0x2ab998[0x1],_0x25f641[_0x2c8fa4][_0x8bc458(0xfc)]=_0x2ab998[0x2],_0x25f641[_0x2c8fa4][_0x8bc458(0x17b)]=_0x2ab998[0x3],_0x25f641[_0x2c8fa4][_0x8bc458(0x1d9)]=_0xeef41b,_0x25f641[_0x2c8fa4][_0x8bc458(0x147)]=_0x2ab998[0x5];}}}}});}),_0x1f104b['forEach']((_0x1322e1,_0x573e46)=>{var _0x5a797b=_0x5ccfda;_0x25f641[_0x573e46][_0x5a797b(0x189)]=_0x1322e1;}),_0x336091[_0x5ccfda(0x1bf)]((_0xca55e9,_0x51b2a7)=>{_0x838f4b['forEach']((_0x37c04e,_0x43ceda)=>{var _0x1d4565=a0_0x5760;if(_0x37c04e==_0x1d4565(0x13a)&&_0x51b2a7==_0x43ceda){var _0x2c19c6=_0xca55e9[_0x1d4565(0x18d)](0x3);_0x25f641[_0x51b2a7][_0x1d4565(0x172)]=_0xca55e9[0x0],_0x25f641[_0x51b2a7][_0x1d4565(0x115)]=_0xca55e9[0x1],_0x25f641[_0x51b2a7]['to_bay']=0x0,_0x25f641[_0x51b2a7][_0x1d4565(0x12c)]=0x0,_0x25f641[_0x51b2a7][_0x1d4565(0x123)]=_0x1d4565(0x195),_0x25f641[_0x51b2a7][_0x1d4565(0x1cd)]=_0x2c19c6;}else{if(_0x37c04e==_0x1d4565(0x107)&&_0x51b2a7==_0x43ceda){var _0x2c19c6=_0xca55e9[_0x1d4565(0x18d)](0x3);_0x25f641[_0x51b2a7][_0x1d4565(0x172)]=_0xca55e9[0x0],_0x25f641[_0x51b2a7][_0x1d4565(0x115)]=_0xca55e9[0x1],_0x25f641[_0x51b2a7][_0x1d4565(0x121)]=0x0,_0x25f641[_0x51b2a7][_0x1d4565(0x12c)]=0x0,_0x25f641[_0x51b2a7]['to_types']=_0x1d4565(0x195),_0x25f641[_0x51b2a7][_0x1d4565(0x1cd)]=_0xca55e9[0x5];}else{if(_0x51b2a7==_0x43ceda){if(_0xca55e9[0x0]=='A'&&_0xca55e9[0x1]=='L'&&_0xca55e9[0x2]=='L')console[_0x1d4565(0x1c4)](_0x37c04e+'\x20<>\x20'+_0x51b2a7+_0x1d4565(0x187)+_0x43ceda+_0x1d4565(0x187)+_0xca55e9+_0x1d4565(0x186)),_0x25f641[_0x51b2a7][_0x1d4565(0x172)]=_0xca55e9[0x0],_0x25f641[_0x51b2a7][_0x1d4565(0x115)]=_0xca55e9[0x1],_0x25f641[_0x51b2a7][_0x1d4565(0x121)]=0x0,_0x25f641[_0x51b2a7][_0x1d4565(0x12c)]=0x0,_0x25f641[_0x51b2a7][_0x1d4565(0x123)]=_0x1d4565(0x195),_0x25f641[_0x51b2a7][_0x1d4565(0x1cd)]=_0xca55e9[0x3];else{var _0x1a706b;if(_0xca55e9[0x4]=='L')_0x1a706b=_0x1d4565(0x15e);else _0xca55e9[0x4]=='F'&&(_0x1a706b=_0x1d4565(0x195));_0x25f641[_0x51b2a7]['storage']=_0xca55e9[0x0],_0x25f641[_0x51b2a7][_0x1d4565(0x115)]=_0xca55e9[0x1],_0x25f641[_0x51b2a7][_0x1d4565(0x121)]=_0xca55e9[0x2],_0x25f641[_0x51b2a7][_0x1d4565(0x12c)]=_0xca55e9[0x3],_0x25f641[_0x51b2a7][_0x1d4565(0x123)]=_0x1a706b,_0x25f641[_0x51b2a7][_0x1d4565(0x1cd)]=_0xca55e9[0x5];}}}}});}),_0x168931['forEach']((_0x3e41e3,_0x3b9bc6)=>{_0x25f641[_0x3b9bc6]['primary_code']=_0x3e41e3;}),_0x350991[_0x5ccfda(0x1bf)]((_0xb757ec,_0x5d33a5)=>{_0x25f641[_0x5d33a5]['secondary_code']=_0xb757ec;}),_0x160a8e[_0x5ccfda(0x1bf)]((_0x20d025,_0x6d6bb0)=>{_0x25f641[_0x6d6bb0]['product_code']=_0x20d025;}),_0x1de07b[_0x5ccfda(0x1bf)]((_0x2739fa,_0x26f485)=>{var _0x4b12cd=_0x5ccfda;_0x25f641[_0x26f485][_0x4b12cd(0x178)]=_0x2739fa;}),_0x8b454a[_0x5ccfda(0x1bf)]((_0xc971c9,_0xe599e3)=>{var _0x282209=_0x5ccfda;_0x25f641[_0xe599e3][_0x282209(0x16d)]=_0xc971c9;}),_0x912c9c['forEach']((_0x5ceab6,_0x147cda)=>{var _0xd07dd5=_0x5ccfda;_0x25f641[_0x147cda][_0xd07dd5(0x129)]=_0x5ceab6;}),_0x3ecc9f[_0x5ccfda(0x1bf)]((_0x2ee251,_0x291211)=>{_0x25f641[_0x291211]['batch_code']=_0x2ee251;}),_0x1f50b9[_0x5ccfda(0x1bf)]((_0x11bff0,_0x55df9d)=>{var _0x3f8769=_0x5ccfda;_0x25f641[_0x55df9d][_0x3f8769(0x1e2)]=_0x11bff0;}),_0x565d9f[_0x5ccfda(0x1bf)]((_0x1fab71,_0x42ec11)=>{var _0xa2425d=_0x5ccfda;_0x25f641[_0x42ec11][_0xa2425d(0x154)]=_0x1fab71;}),_0x5b8df9[_0x5ccfda(0x1bf)]((_0x222142,_0x1be1c5)=>{_0x25f641[_0x1be1c5]['production_date']=_0x222142;}),_0x18b028[_0x5ccfda(0x1bf)]((_0x27c63d,_0x4b8159)=>{var _0x520024=_0x5ccfda;_0x25f641[_0x4b8159][_0x520024(0x1ad)]=_0x27c63d;}),_0x127ce9['forEach']((_0x418f1b,_0x532cbb)=>{var _0x632676=_0x5ccfda;_0x25f641[_0x532cbb][_0x632676(0x101)]=_0x418f1b;}),_0x838f4b[_0x5ccfda(0x1bf)]((_0x3d8888,_0x5988f6)=>{var _0x2c5141=_0x5ccfda;_0x25f641[_0x5988f6][_0x2c5141(0x1a0)]=_0x3d8888;});const _0x807570=_0x25f641[_0x5ccfda(0x11e)](_0x45c80a=>_0x45c80a[_0x5ccfda(0x189)]!=='0'&&_0x45c80a[_0x5ccfda(0x189)]!==''||_0x45c80a[_0x5ccfda(0x1cd)]!=='0'&&_0x45c80a[_0x5ccfda(0x1cd)]!==''),_0x17b4c8=new transfers({'date':_0x596b5a,'from_warehouse':_0x43935f,'to_warehouse':_0xbb8f0c,'product':_0x807570,'note':_0x509e7c,'invoice':_0x3ee5d4}),_0x2c7ddb=await _0x17b4c8[_0x5ccfda(0x14b)]();_0x555430[_0x5ccfda(0x1ba)]('success','Product\x20Transfer\x20successfully'),_0x5dbd66[_0x5ccfda(0x1de)](_0x5ccfda(0x1c0)+_0x2c7ddb[_0x5ccfda(0x1b7)]);}catch(_0x5c1dda){console[_0x5ccfda(0x1c4)](_0x5c1dda),_0x5dbd66[_0x5ccfda(0xfd)](0xc8)[_0x5ccfda(0xfe)]({'errorMessage':_0x5c1dda[_0x5ccfda(0x13f)]});}}),router['get'](a0_0x366757(0x11c),auth,async(_0x39662f,_0x362ef6)=>{var _0x2cf264=a0_0x366757;try{const {username:_0x299338,email:_0x3a6cbb,role:_0x1fb44d}=_0x39662f[_0x2cf264(0x160)],_0xdfd44a=_0x39662f[_0x2cf264(0x160)],_0x394826=await profile['findOne']({'email':_0xdfd44a[_0x2cf264(0x181)]}),_0x4bda61=await master_shop[_0x2cf264(0x14f)]();console[_0x2cf264(0x1c4)](_0x2cf264(0x13d),_0x4bda61);const _0x62336c=await transfers[_0x2cf264(0x150)](_0x39662f['params']['id']);let _0x8b99b=new Date(_0x62336c[_0x2cf264(0x1e2)]),_0x16eb9e=('0'+_0x8b99b[_0x2cf264(0x16e)]())[_0x2cf264(0x18d)](-0x2),_0x541002=('0'+(_0x8b99b[_0x2cf264(0x1e0)]()+0x1))['slice'](-0x2),_0x5d33b2=_0x8b99b[_0x2cf264(0x1db)](),_0x3cf878=_0x5d33b2+'-'+_0x541002+'-'+_0x16eb9e,_0xe64a47;if(_0xdfd44a[_0x2cf264(0x1c7)]==_0x2cf264(0x176)){const _0x35ae7f=await staff[_0x2cf264(0x170)]({'email':_0xdfd44a[_0x2cf264(0x181)]});_0xe64a47=await warehouse[_0x2cf264(0x14f)]({'status':_0x2cf264(0x1d5),'name':_0x35ae7f[_0x2cf264(0x1f1)],'warehouse_category':'Raw\x20Materials'});}else _0xe64a47=await warehouse['find']({'status':'Enabled','warehouse_category':_0x2cf264(0x194)});const _0x4a64d5=await warehouse[_0x2cf264(0x1e4)]([{'$match':{'name':_0x62336c[_0x2cf264(0x174)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2cf264(0x119),'name':{'$first':_0x2cf264(0x111)},'product_stock':{'$first':_0x2cf264(0x1bb)},'bay':{'$first':_0x2cf264(0x1be)},'bin':{'$first':_0x2cf264(0x1dc)},'type':{'$first':_0x2cf264(0x1ce)},'floorlevel':{'$first':_0x2cf264(0x100)},'primary_code':{'$first':_0x2cf264(0x158)},'secondary_code':{'$first':_0x2cf264(0x161)},'product_code':{'$first':_0x2cf264(0x1a7)},'storage':{'$first':_0x2cf264(0x112)},'rack':{'$first':_0x2cf264(0x173)},'expiry_date':{'$first':_0x2cf264(0x143)},'production_date':{'$first':_0x2cf264(0x196)},'room':{'$first':'$room'}}}]);if(_0x4bda61[0x0][_0x2cf264(0x12f)]=='English\x20(US)'){var _0x4d2a03=users[_0x2cf264(0x15a)];console[_0x2cf264(0x1c4)](_0x4d2a03);}else{if(_0x4bda61[0x0][_0x2cf264(0x12f)]=='Hindi')var _0x4d2a03=users['Hindi'];else{if(_0x4bda61[0x0][_0x2cf264(0x12f)]=='German')var _0x4d2a03=users[_0x2cf264(0x137)];else{if(_0x4bda61[0x0][_0x2cf264(0x12f)]==_0x2cf264(0x126))var _0x4d2a03=users[_0x2cf264(0x126)];else{if(_0x4bda61[0x0]['language']==_0x2cf264(0x1eb))var _0x4d2a03=users[_0x2cf264(0x1eb)];else{if(_0x4bda61[0x0][_0x2cf264(0x12f)]==_0x2cf264(0x155))var _0x4d2a03=users['Portuguese'];else{if(_0x4bda61[0x0][_0x2cf264(0x12f)]==_0x2cf264(0x153))var _0x4d2a03=users[_0x2cf264(0x153)];else{if(_0x4bda61[0x0][_0x2cf264(0x12f)]==_0x2cf264(0x1c3))var _0x4d2a03=users[_0x2cf264(0x1b0)];}}}}}}}_0x362ef6[_0x2cf264(0x1c8)](_0x2cf264(0x184),{'success':_0x39662f['flash'](_0x2cf264(0x144)),'errors':_0x39662f[_0x2cf264(0x1ba)](_0x2cf264(0x1c2)),'role':_0xdfd44a,'profile':_0x394826,'master_shop':_0x4bda61,'warehouse':_0xe64a47,'transfer':_0x62336c,'stock':_0x4a64d5,'language':_0x4d2a03});}catch(_0x47346b){console[_0x2cf264(0x1c4)](_0x47346b);}}),router[a0_0x366757(0x17a)](a0_0x366757(0x11c),auth,async(_0x1035b3,_0x515cb6)=>{var _0x56cab0=a0_0x366757;try{const _0x4549b4=_0x1035b3[_0x56cab0(0x1ea)]['id'],{from_warehouse:_0x2d78a7,FromRoom_name:_0x4d2650,to_warehouse:_0x4ac1c5,ToRoom_name:_0xa3534}=_0x1035b3[_0x56cab0(0x197)],_0x1767cf=await transfers[_0x56cab0(0x150)]({'_id':_0x4549b4}),_0x499728=_0x1767cf[_0x56cab0(0x146)]['map'](async _0x5a4343=>{var _0xe42aac=_0x56cab0;if(_0x5a4343[_0xe42aac(0x189)]>0x0){var _0x4150df=await warehouse[_0xe42aac(0x170)]({'name':_0x1767cf['from_warehouse'],'room':_0x5a4343['from_room_name'],'warehouse_category':'Raw\x20Materials'});const _0x585c32=_0x4150df['product_details'][_0xe42aac(0x165)](_0x33171b=>{var _0x47a2ce=_0xe42aac;_0x33171b[_0x47a2ce(0x15f)]==_0x5a4343[_0x47a2ce(0x15f)]&&_0x33171b[_0x47a2ce(0x16c)]==_0x5a4343[_0x47a2ce(0x147)]&&_0x33171b[_0x47a2ce(0x152)]==_0x5a4343['from_types']&&_0x33171b[_0x47a2ce(0x10e)]==_0x5a4343['from_bin']&&_0x33171b[_0x47a2ce(0x188)]==_0x5a4343[_0x47a2ce(0xfc)]&&_0x33171b[_0x47a2ce(0x115)]==_0x5a4343[_0x47a2ce(0x1dd)]&&_0x33171b[_0x47a2ce(0x172)]==_0x5a4343[_0x47a2ce(0x199)]&&_0x33171b['expiry_date']==_0x5a4343[_0x47a2ce(0x1e2)]&&_0x33171b[_0x47a2ce(0x169)]==_0x5a4343[_0x47a2ce(0x169)]&&_0x33171b['production_date']==_0x5a4343['production_date']&&_0x33171b['invoice']==_0x5a4343[_0x47a2ce(0x127)]&&_0x33171b[_0x47a2ce(0x1b7)]==_0x5a4343['id_transaction_id']&&(_0x33171b[_0x47a2ce(0x138)]=_0x33171b[_0x47a2ce(0x138)]-_0x5a4343[_0x47a2ce(0x189)]);});}return _0x4150df;});Promise[_0x56cab0(0x140)](_0x499728)[_0x56cab0(0x10a)](async _0x4b5571=>{var _0x1380e7=_0x56cab0;try{for(const _0x5dec69 of _0x4b5571){await _0x5dec69[_0x1380e7(0x14b)]();}try{const _0x371683=_0x1767cf[_0x1380e7(0x146)][_0x1380e7(0x165)](async _0x5cd308=>{var _0x3115d0=_0x1380e7;if(_0x5cd308[_0x3115d0(0x189)]>0x0){var _0x222f40=await warehouse['findOne']({'name':_0x1767cf[_0x3115d0(0x1b2)],'room':_0x5cd308['to_room_name'],'warehouse_category':_0x3115d0(0x194)}),_0x39ef11=0x0;const _0xaab020=_0x222f40[_0x3115d0(0x1d1)][_0x3115d0(0x165)](_0x49d5b5=>{var _0x46515c=_0x3115d0;_0x49d5b5['product_name']==_0x5cd308[_0x46515c(0x15f)]&&_0x49d5b5['floorlevel']==_0x5cd308[_0x46515c(0x1cd)]&&_0x49d5b5[_0x46515c(0x152)]==_0x5cd308[_0x46515c(0x123)]&&_0x49d5b5['bin']==_0x5cd308[_0x46515c(0x12c)]&&_0x49d5b5[_0x46515c(0x188)]==_0x5cd308[_0x46515c(0x121)]&&_0x49d5b5[_0x46515c(0x115)]==_0x5cd308['rack']&&_0x49d5b5['storage']==_0x5cd308['storage']&&_0x49d5b5[_0x46515c(0x1e2)]==_0x5cd308['expiry_date']&&_0x49d5b5[_0x46515c(0x169)]==_0x5cd308[_0x46515c(0x169)]&&_0x49d5b5[_0x46515c(0x168)]==_0x5cd308['production_date']&&_0x49d5b5[_0x46515c(0x157)]==_0x5cd308[_0x46515c(0x12e)]&&(_0x49d5b5['product_stock']=_0x49d5b5[_0x46515c(0x138)]+_0x5cd308[_0x46515c(0x189)],_0x39ef11++);});_0x39ef11=='0'&&(_0x222f40[_0x3115d0(0x1d1)]=_0x222f40['product_details'][_0x3115d0(0x17f)]({'product_name':_0x5cd308['product_name'],'product_stock':_0x5cd308[_0x3115d0(0x189)],'bay':_0x5cd308['to_bay'],'bin':_0x5cd308['to_bin'],'type':_0x5cd308[_0x3115d0(0x123)],'floorlevel':_0x5cd308['to_floorlevel'],'storage':_0x5cd308[_0x3115d0(0x172)],'rack':_0x5cd308[_0x3115d0(0x115)],'product_code':_0x5cd308[_0x3115d0(0x1cf)],'primary_code':_0x5cd308[_0x3115d0(0x135)],'secondary_code':_0x5cd308['secondary_code'],'maxProducts':_0x5cd308[_0x3115d0(0x178)],'storage':_0x5cd308[_0x3115d0(0x172)],'rack':_0x5cd308[_0x3115d0(0x115)],'expiry_date':_0x5cd308[_0x3115d0(0x1e2)],'maxPerUnit':_0x5cd308[_0x3115d0(0x154)],'batch_code':_0x5cd308[_0x3115d0(0x169)],'production_date':_0x5cd308[_0x3115d0(0x168)]}));}return _0x222f40;});Promise[_0x1380e7(0x140)](_0x371683)[_0x1380e7(0x10a)](async _0x769cf9=>{var _0x4a9dcb=_0x1380e7;try{for(const _0x104ac2 of _0x769cf9){await warehouse['updateOne']({'_id':_0x104ac2['_id']},{'$addToSet':{'product_details':{'$each':_0x104ac2[_0x4a9dcb(0x1d1)]}}});}_0x1767cf[_0x4a9dcb(0x193)]=_0x4a9dcb(0x162);const _0x35e321=await _0x1767cf[_0x4a9dcb(0x14b)](),_0x253e95=await master_shop[_0x4a9dcb(0x14f)](),_0x179972=await email_settings[_0x4a9dcb(0x170)](),_0x35940f=await supervisor_settings['find']();var _0x553ba6=_0x1767cf[_0x4a9dcb(0x146)],_0x17c9d9='',_0x3e7b83;for(_0x3e7b83 in _0x553ba6){_0x17c9d9+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x15f)]+'</td>'+_0x4a9dcb(0x1e8)+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x1cf)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x189)]+_0x4a9dcb(0x15d)+_0x4a9dcb(0x1e8)+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x16d)]+_0x4a9dcb(0x15d)+_0x4a9dcb(0x1e8)+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x129)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1767cf[_0x4a9dcb(0x1b2)]+_0x4a9dcb(0x15d)+_0x4a9dcb(0x1e8)+_0x553ba6[_0x3e7b83]['to_room_name']+_0x4a9dcb(0x15d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x172)]+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x115)]+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x121)]+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x12c)]+_0x553ba6[_0x3e7b83][_0x4a9dcb(0x123)][0x0]+_0x553ba6[_0x3e7b83]['to_floorlevel']+_0x4a9dcb(0x15d),_0x4a9dcb(0x19d);}let _0x2744a5=nodemailer[_0x4a9dcb(0x1cb)]({'host':_0x179972[_0x4a9dcb(0x1b5)],'port':Number(_0x179972[_0x4a9dcb(0x1da)]),'secure':![],'auth':{'user':_0x179972['email'],'pass':_0x179972[_0x4a9dcb(0x117)]}}),_0x4161fa={'from':_0x179972[_0x4a9dcb(0x181)],'to':_0x35940f[0x0][_0x4a9dcb(0x17c)],'subject':_0x4a9dcb(0x18f),'attachments':[{'filename':_0x4a9dcb(0x134),'path':__dirname+_0x4a9dcb(0x139)+'/upload/'+_0x253e95[0x0][_0x4a9dcb(0x1ed)],'cid':_0x4a9dcb(0x1a4)}],'html':_0x4a9dcb(0x1cc)+_0x4a9dcb(0x1a5)+'</head><body>'+_0x4a9dcb(0x163)+_0x4a9dcb(0x132)+'<div>'+_0x4a9dcb(0x131)+_0x4a9dcb(0x149)+_0x4a9dcb(0x163)+_0x4a9dcb(0x120)+_0x253e95[0x0][_0x4a9dcb(0x13e)]+_0x4a9dcb(0x10c)+_0x4a9dcb(0x149)+_0x4a9dcb(0x149)+_0x4a9dcb(0x17e)+_0x4a9dcb(0x163)+_0x4a9dcb(0x1d4)+'\x20Order\x20Number\x20:\x20'+_0x1767cf[_0x4a9dcb(0x157)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x4a9dcb(0x17d)+_0x1767cf[_0x4a9dcb(0x1b8)]+'\x20'+_0x4a9dcb(0x1e7)+'</h5>'+_0x4a9dcb(0x149)+_0x4a9dcb(0x1d3)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4a9dcb(0x1e5)+_0x4a9dcb(0x15b)+_0x4a9dcb(0x136)+_0x4a9dcb(0x1a2)+_0x4a9dcb(0x159)+_0x4a9dcb(0x18c)+_0x4a9dcb(0x104)+_0x4a9dcb(0x185)+_0x4a9dcb(0x11a)+_0x4a9dcb(0x19d)+'</thead>'+_0x4a9dcb(0x116)+'\x20'+_0x17c9d9+'\x20'+'</tbody>'+_0x4a9dcb(0x13c)+_0x4a9dcb(0x163)+_0x4a9dcb(0x19f)+_0x4a9dcb(0x11d)+_0x253e95[0x0][_0x4a9dcb(0x13e)]+_0x4a9dcb(0x122)+_0x4a9dcb(0x149)+_0x4a9dcb(0x149)+_0x4a9dcb(0x1ef)};_0x2744a5['sendMail'](_0x4161fa,function(_0x1b0ab5,_0x2c92ca){var _0x4c97bf=_0x4a9dcb;_0x1b0ab5?(console[_0x4c97bf(0x1c4)](_0x1b0ab5),console[_0x4c97bf(0x1c4)]('Error\x20Occurs')):console[_0x4c97bf(0x1c4)](_0x4c97bf(0x1c1));}),_0x1035b3['flash']('success',_0x4a9dcb(0x16b)),_0x515cb6['redirect'](_0x4a9dcb(0x114)+_0x35e321[_0x4a9dcb(0x1b7)]);}catch(_0x5c2b3a){console['error'](_0x5c2b3a),_0x515cb6[_0x4a9dcb(0xfd)](0x1f4)[_0x4a9dcb(0xfe)]({'Perror':_0x4a9dcb(0x105),'message':_0x5c2b3a[_0x4a9dcb(0x13f)]});}})[_0x1380e7(0x175)](_0x24a946=>{var _0x33f85d=_0x1380e7;console['error'](_0x24a946),_0x515cb6['status'](0x1f4)['json']({'Perror':_0x33f85d(0x11f)});});}catch(_0x2b4a22){_0x515cb6[_0x1380e7(0xfe)](_0x2b4a22);}}catch(_0x1bfdf4){console['error'](_0x1bfdf4),_0x515cb6[_0x1380e7(0xfd)](0x1f4)[_0x1380e7(0xfe)]({'Merror':_0x1380e7(0x105),'Message':_0x1bfdf4[_0x1380e7(0x13f)]});}})[_0x56cab0(0x175)](_0x251f51=>{var _0x408a6e=_0x56cab0;console[_0x408a6e(0x18b)](_0x251f51),_0x515cb6['status'](0x1f4)[_0x408a6e(0xfe)]({'Merror':_0x408a6e(0x11f)});});}catch(_0x365ed8){console[_0x56cab0(0x1c4)](_0x365ed8);}});function BayBinSelected(_0x32b7b3,_0x5b5fc7){var _0x5699d3=a0_0x366757,_0x2b0e03=[],_0x2b8bab=[],_0x5caf0d=[],_0x1a86c5=[],_0x11403c=[],_0x538b17=[];let _0x374e94=[];if(_0x32b7b3=='DRY\x20STORAGE')switch(_0x5b5fc7){case _0x5699d3(0x1d0):_0x2b0e03=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2b8bab=[0x1,0x2],_0x1a86c5=[0x1,0x2,0x3,0x4,0x5],_0x5caf0d=['Level',_0x5699d3(0x195)],_0x11403c=['D'],_0x538b17=['A'];break;case _0x5699d3(0x191):_0x2b0e03=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2b8bab=[0x1,0x2],_0x1a86c5=[0x1,0x2,0x3,0x4,0x5],_0x5caf0d=[_0x5699d3(0x15e),_0x5699d3(0x195)],_0x11403c=['D'],_0x538b17=['B'];break;case _0x5699d3(0x107):_0x2b0e03=[0x0],_0x2b8bab=[0x0],_0x1a86c5=[0x1,0x2,0x3,0x4,0x5],_0x5caf0d=[_0x5699d3(0x195)],_0x11403c=['D'],_0x538b17=['S'];break;case'Receiving\x20Area':_0x2b0e03=[0x0],_0x2b8bab=[0x0],_0x1a86c5=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5caf0d=[_0x5699d3(0x195)],_0x11403c=['D'],_0x538b17=['R'];break;}else{if(_0x32b7b3==_0x5699d3(0x1ec))switch(_0x5b5fc7){case _0x5699d3(0x1d0):_0x2b0e03=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2b8bab=['B','F'],_0x1a86c5=[0x1,0x2,0x3,0x4,0x5],_0x5caf0d=[_0x5699d3(0x15e),_0x5699d3(0x195)],_0x11403c=['C'],_0x538b17=['A'];break;case'Rack\x20B':_0x2b0e03=[0x5,0x4,0x3,0x2,0x1],_0x2b8bab=['F','B','S'],_0x1a86c5=[0x1,0x2,0x3,0x4,0x5],_0x5caf0d=[_0x5699d3(0x15e),'Floor'],_0x11403c=['C'],_0x538b17=['B'];break;case _0x5699d3(0x14a):_0x2b0e03=[0x1,0x2,0x3,0x4,0x5],_0x2b8bab=['B','F','S'],_0x1a86c5=[0x5,0x4,0x3,0x2,0x1],_0x5caf0d=[_0x5699d3(0x15e),'Floor'],_0x11403c=['C'],_0x538b17=['C'];break;case _0x5699d3(0x106):_0x2b0e03=[0x5,0x4,0x3,0x2,0x1],_0x2b8bab=['F','B','S'],_0x1a86c5=[0x1,0x2,0x3,0x4,0x5],_0x5caf0d=[_0x5699d3(0x15e),_0x5699d3(0x195)],_0x11403c=['C'],_0x538b17=['D'];break;case _0x5699d3(0x141):_0x2b0e03=[0x4,0x3,0x2,0x1],_0x2b8bab=[0x1,0x2],_0x1a86c5=[0x1,0x2,0x3,0x4,0x5],_0x5caf0d=['Level',_0x5699d3(0x195)],_0x11403c=['C'],_0x538b17=['E'];break;case _0x5699d3(0x180):_0x2b0e03=[0x1,0x2,0x3],_0x2b8bab=[0x1,0x2],_0x1a86c5=[0x1,0x2,0x3,0x4,0x5],_0x5caf0d=['Level'],_0x11403c=['C'],_0x538b17=['F'];break;}}return{'levels':_0x2b0e03,'Isle':_0x2b8bab,'rack':_0x1a86c5,'type':_0x5caf0d,'storage':_0x11403c,'rak':_0x538b17};}router['get']('/view/:id',auth,async(_0x33a615,_0x1be2e4)=>{var _0x4bc3cc=a0_0x366757;try{const {username:_0x1c3f05,email:_0x3f1c6f,role:_0x5ad54e}=_0x33a615[_0x4bc3cc(0x160)],_0x360461=_0x33a615[_0x4bc3cc(0x160)],_0x112761=await profile[_0x4bc3cc(0x170)]({'email':_0x360461[_0x4bc3cc(0x181)]}),_0x192e87=await master_shop[_0x4bc3cc(0x14f)](),_0x22eae1=await transfers['findById'](_0x33a615[_0x4bc3cc(0x1ea)]['id']);let _0x1dc83e;if(_0x360461['role']==_0x4bc3cc(0x176)){const _0x48fe01=await staff[_0x4bc3cc(0x170)]({'email':_0x360461[_0x4bc3cc(0x181)]});_0x1dc83e=await warehouse[_0x4bc3cc(0x1e4)]([{'$match':{'status':_0x4bc3cc(0x1d5),'name':_0x48fe01[_0x4bc3cc(0x1f1)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4bc3cc(0x142),'name':{'$first':_0x4bc3cc(0x142)}}}]);}else _0x1dc83e=await warehouse['aggregate']([{'$match':{'status':_0x4bc3cc(0x1d5),'warehouse_category':_0x4bc3cc(0x194)}},{'$group':{'_id':_0x4bc3cc(0x142),'name':{'$first':_0x4bc3cc(0x142)}}}]);const _0x1f9a17=await warehouse[_0x4bc3cc(0x1e4)]([{'$match':{'name':_0x22eae1[_0x4bc3cc(0x174)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x4bc3cc(0x167)},{'$group':{'_id':_0x4bc3cc(0x119),'name':{'$first':_0x4bc3cc(0x111)},'product_stock':{'$first':_0x4bc3cc(0x1bb)},'bay':{'$first':_0x4bc3cc(0x1be)},'bin':{'$first':_0x4bc3cc(0x1dc)},'type':{'$first':_0x4bc3cc(0x1ce)},'floorlevel':{'$first':_0x4bc3cc(0x100)},'primary_code':{'$first':_0x4bc3cc(0x158)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4bc3cc(0x112)},'rack':{'$first':_0x4bc3cc(0x173)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4bc3cc(0x196)},'room':{'$first':_0x4bc3cc(0x1a9)}}}]),_0x4ea9cb=await product['find']({}),_0x36772c=BayBinSelected(_0x22eae1[_0x4bc3cc(0x1b2)],_0x22eae1['to_room']);if(_0x192e87[0x0][_0x4bc3cc(0x12f)]==_0x4bc3cc(0x19c)){var _0x58f326=users[_0x4bc3cc(0x15a)];console[_0x4bc3cc(0x1c4)](_0x58f326);}else{if(_0x192e87[0x0][_0x4bc3cc(0x12f)]==_0x4bc3cc(0x192))var _0x58f326=users[_0x4bc3cc(0x192)];else{if(_0x192e87[0x0][_0x4bc3cc(0x12f)]==_0x4bc3cc(0x137))var _0x58f326=users['German'];else{if(_0x192e87[0x0][_0x4bc3cc(0x12f)]==_0x4bc3cc(0x126))var _0x58f326=users[_0x4bc3cc(0x126)];else{if(_0x192e87[0x0]['language']==_0x4bc3cc(0x1eb))var _0x58f326=users['French'];else{if(_0x192e87[0x0]['language']=='Portuguese\x20(BR)')var _0x58f326=users[_0x4bc3cc(0x177)];else{if(_0x192e87[0x0][_0x4bc3cc(0x12f)]=='Chinese')var _0x58f326=users[_0x4bc3cc(0x153)];else{if(_0x192e87[0x0][_0x4bc3cc(0x12f)]==_0x4bc3cc(0x1c3))var _0x58f326=users[_0x4bc3cc(0x1b0)];}}}}}}}_0x1be2e4[_0x4bc3cc(0x1c8)]('edit_transfer',{'success':_0x33a615['flash'](_0x4bc3cc(0x144)),'errors':_0x33a615[_0x4bc3cc(0x1ba)](_0x4bc3cc(0x1c2)),'role':_0x360461,'profile':_0x112761,'master_shop':_0x192e87,'warehouse':_0x1dc83e,'transfer':_0x22eae1,'stock':_0x1f9a17,'unit':_0x4ea9cb,'language':_0x58f326});}catch(_0x2cb845){console[_0x4bc3cc(0x1c4)](_0x2cb845);}}),router[a0_0x366757(0x17a)](a0_0x366757(0x14e),auth,async(_0x44ade5,_0x162077)=>{var _0x5d5894=a0_0x366757;try{const _0x386d86=_0x44ade5[_0x5d5894(0x1ea)]['id'],_0x415954=await transfers[_0x5d5894(0x150)](_0x386d86);_0x162077[_0x5d5894(0xfe)](_0x44ade5['body']);return;const {date:_0x1da4c6,from_warehouse:_0xa9f5c2,FromRoom_name:_0x2f3a68,to_warehouse:_0x4adaee,ToRoom_name:_0x1eea71,prod_name:_0x5c42fb,from_prod_qty:_0xd87132,from_prod_level:_0x1b3afa,from_prod_isle:_0x362329,from_prod_pallet:_0x1a62f0,to_prod_qty:_0x1f80f6,to_prod_level:_0x19046b,to_prod_isle:_0x2b1860,to_prod_pallet:_0x2eb110,primary_code:_0x5384cc,secondary_code:_0x356368,product_code3:_0x1e88e5,note:_0x44641f,invoice:_0x5db73b,expiry_date:_0x5a2141}=_0x44ade5[_0x5d5894(0x197)];if(typeof _0x5c42fb==_0x5d5894(0x164))var _0x3c7a4e=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x1bd)]],_0x54c2a9=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x15c)]],_0x31df99=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x1d8)]],_0x2846eb=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x1b3)]],_0x290418=[_0x44ade5[_0x5d5894(0x197)]['from_prod_pallet']],_0x11d182=[_0x44ade5['body'][_0x5d5894(0x1d9)]],_0x579636=[_0x44ade5[_0x5d5894(0x197)]['to_prod_qty']],_0x5d63e9=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x12b)]],_0x454259=[_0x44ade5['body'][_0x5d5894(0x1af)]],_0x30b229=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x182)]],_0x4d5e24=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x123)]],_0x28014c=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x172)]],_0x1312d1=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x19e)]],_0x472f08=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x135)]],_0x1aa07b=[_0x44ade5['body'][_0x5d5894(0x12a)]],_0x218139=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x148)]],_0x437428=[_0x44ade5[_0x5d5894(0x197)]['MaxStocks_data2']],_0x26d7a0=[_0x44ade5['body'][_0x5d5894(0x16d)]],_0x4dd711=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x129)]],_0x363586=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x169)]],_0x165946=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x1e2)]],_0x209fa0=[_0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x199)]],_0x687147=[_0x44ade5[_0x5d5894(0x197)]['from_rak']];else var _0x3c7a4e=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x1bd)]],_0x28014c=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x172)]],_0x1312d1=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x19e)]],_0x11d182=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x1d9)]],_0x4d5e24=[..._0x44ade5['body'][_0x5d5894(0x123)]],_0x54c2a9=[..._0x44ade5['body'][_0x5d5894(0x15c)]],_0x31df99=[..._0x44ade5[_0x5d5894(0x197)]['from_prod_level']],_0x2846eb=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x1b3)]],_0x290418=[..._0x44ade5['body']['from_prod_pallet']],_0x579636=[..._0x44ade5['body']['to_prod_qty']],_0x5d63e9=[..._0x44ade5['body'][_0x5d5894(0x12b)]],_0x454259=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x1af)]],_0x30b229=[..._0x44ade5[_0x5d5894(0x197)]['to_prod_pallet']],_0x472f08=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x135)]],_0x1aa07b=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x12a)]],_0x218139=[..._0x44ade5[_0x5d5894(0x197)]['product_code3']],_0x437428=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x198)]],_0x26d7a0=[..._0x44ade5['body']['unit']],_0x4dd711=[..._0x44ade5['body'][_0x5d5894(0x129)]],_0x363586=[..._0x44ade5['body'][_0x5d5894(0x169)]],_0x165946=[..._0x44ade5[_0x5d5894(0x197)][_0x5d5894(0x1e2)]],_0x209fa0=[..._0x44ade5['body']['from_storage']],_0x687147=[..._0x44ade5[_0x5d5894(0x197)]['from_rak']];const _0x1e7f5b=_0x3c7a4e[_0x5d5894(0x165)](_0x4b2308=>{return _0x4b2308={'product_name':_0x4b2308};});_0x54c2a9[_0x5d5894(0x1bf)]((_0x93b99c,_0xb4ad4c)=>{var _0x3c8bb7=_0x5d5894;_0x1e7f5b[_0xb4ad4c][_0x3c8bb7(0x1c5)]=_0x93b99c;}),_0x31df99[_0x5d5894(0x1bf)]((_0x2dde6a,_0x17672f)=>{var _0x12dfa8=_0x5d5894;_0x1e7f5b[_0x17672f][_0x12dfa8(0xfc)]=_0x2dde6a;}),_0x2846eb[_0x5d5894(0x1bf)]((_0x4f323c,_0x399e6d)=>{_0x1e7f5b[_0x399e6d]['from_bin']=_0x4f323c;}),_0x290418[_0x5d5894(0x1bf)]((_0x552d8a,_0x17dad5)=>{var _0xe87bf9=_0x5d5894;_0x1e7f5b[_0x17dad5][_0xe87bf9(0x147)]=_0x552d8a;}),_0x579636['forEach']((_0x5ae94e,_0x268116)=>{var _0x2a2f65=_0x5d5894;_0x1e7f5b[_0x268116][_0x2a2f65(0x189)]=_0x5ae94e;}),_0x5d63e9[_0x5d5894(0x1bf)]((_0xea87c0,_0x5bf912)=>{var _0x4c57c2=_0x5d5894;_0x1e7f5b[_0x5bf912][_0x4c57c2(0x121)]=_0xea87c0;}),_0x454259['forEach']((_0x2697d7,_0x26cf85)=>{var _0x3ba227=_0x5d5894;_0x1e7f5b[_0x26cf85][_0x3ba227(0x12c)]=_0x2697d7;}),_0x30b229[_0x5d5894(0x1bf)]((_0x56ff84,_0x5d8649)=>{var _0x328d1c=_0x5d5894;_0x1e7f5b[_0x5d8649][_0x328d1c(0x1cd)]=_0x56ff84;}),_0x472f08[_0x5d5894(0x1bf)]((_0x5bed2f,_0x35b853)=>{_0x1e7f5b[_0x35b853]['primary_code']=_0x5bed2f;}),_0x1aa07b[_0x5d5894(0x1bf)]((_0x3ba026,_0x37f6de)=>{_0x1e7f5b[_0x37f6de]['secondary_code']=_0x3ba026;}),_0x218139['forEach']((_0x2d3bb2,_0x2aaf0c)=>{var _0x267f86=_0x5d5894;_0x1e7f5b[_0x2aaf0c][_0x267f86(0x1cf)]=_0x2d3bb2;}),_0x437428[_0x5d5894(0x1bf)]((_0x3596c9,_0x1567fa)=>{var _0x1156ec=_0x5d5894;_0x1e7f5b[_0x1567fa][_0x1156ec(0x178)]=_0x3596c9;}),_0x26d7a0[_0x5d5894(0x1bf)]((_0x592235,_0x32919a)=>{_0x1e7f5b[_0x32919a]['unit']=_0x592235;}),_0x4dd711[_0x5d5894(0x1bf)]((_0x372c92,_0x572d29)=>{_0x1e7f5b[_0x572d29]['secondary_unit']=_0x372c92;}),_0x363586[_0x5d5894(0x1bf)]((_0x22d20d,_0x43f34c)=>{var _0x4d19ea=_0x5d5894;_0x1e7f5b[_0x43f34c][_0x4d19ea(0x169)]=_0x22d20d;}),_0x165946[_0x5d5894(0x1bf)]((_0x4bbbe,_0x34a4ef)=>{var _0x497e39=_0x5d5894;_0x1e7f5b[_0x34a4ef][_0x497e39(0x1e2)]=_0x4bbbe;}),_0x28014c[_0x5d5894(0x1bf)]((_0x3d2780,_0x464f3a)=>{_0x1e7f5b[_0x464f3a]['storage']=_0x3d2780;}),_0x1312d1[_0x5d5894(0x1bf)]((_0x2767ca,_0x2f022f)=>{var _0x12d1d3=_0x5d5894;_0x1e7f5b[_0x2f022f][_0x12d1d3(0x115)]=_0x2767ca;}),_0x11d182[_0x5d5894(0x1bf)]((_0x586ff6,_0x4936dd)=>{var _0x18cb0e=_0x5d5894;_0x1e7f5b[_0x4936dd][_0x18cb0e(0x1d9)]=_0x586ff6;}),_0x4d5e24[_0x5d5894(0x1bf)]((_0x5b599b,_0x523284)=>{var _0x368a88=_0x5d5894;_0x1e7f5b[_0x523284][_0x368a88(0x123)]=_0x5b599b;}),_0x209fa0[_0x5d5894(0x1bf)]((_0x431e87,_0x35a52a)=>{var _0x2cb7c5=_0x5d5894;_0x1e7f5b[_0x35a52a][_0x2cb7c5(0x199)]=_0x431e87;}),_0x687147[_0x5d5894(0x1bf)]((_0x419119,_0x479fc8)=>{var _0x41e23f=_0x5d5894;_0x1e7f5b[_0x479fc8][_0x41e23f(0x1dd)]=_0x419119;});const _0x3dfc51=_0x1e7f5b[_0x5d5894(0x11e)](_0x2d583e=>_0x2d583e[_0x5d5894(0x189)]!=='0'&&_0x2d583e[_0x5d5894(0x189)]!==''||_0x2d583e[_0x5d5894(0x1cd)]!=='0'&&_0x2d583e[_0x5d5894(0x1cd)]!=='');var _0x4485d2=0x0;_0x3dfc51[_0x5d5894(0x1bf)](_0xdcbee0=>{var _0x10e81b=_0x5d5894;parseInt(_0xdcbee0['from_quantity'])<parseInt(_0xdcbee0[_0x10e81b(0x189)])&&_0x4485d2++;});if(_0x4485d2!=0x0)return _0x44ade5['flash'](_0x5d5894(0x1c2),_0x5d5894(0x1e3)),_0x162077[_0x5d5894(0x1de)](_0x5d5894(0x16a));const _0x3143e6=await warehouse[_0x5d5894(0x170)]({'name':_0x415954[_0x5d5894(0x174)],'room':_0x415954[_0x5d5894(0x108)]});_0x415954[_0x5d5894(0x146)][_0x5d5894(0x1bf)](_0x254b3b=>{var _0x247594=_0x5d5894;if(_0x254b3b[_0x247594(0x189)]>0x0){const _0x47d045=_0x3143e6[_0x247594(0x1d1)][_0x247594(0x165)](_0x1d9b97=>{var _0x58a54a=_0x247594;_0x1d9b97[_0x58a54a(0x15f)]==_0x254b3b[_0x58a54a(0x15f)]&&_0x1d9b97['floorlevel']==_0x254b3b[_0x58a54a(0x147)]&&_0x1d9b97[_0x58a54a(0x152)]==_0x254b3b[_0x58a54a(0x1d9)]&&_0x1d9b97['bin']==_0x254b3b[_0x58a54a(0x17b)]&&_0x1d9b97[_0x58a54a(0x188)]==_0x254b3b[_0x58a54a(0xfc)]&&_0x1d9b97[_0x58a54a(0x115)]==_0x254b3b['from_rack']&&_0x1d9b97[_0x58a54a(0x172)]==_0x254b3b[_0x58a54a(0x199)]&&(_0x1d9b97[_0x58a54a(0x138)]=parseInt(_0x1d9b97[_0x58a54a(0x138)])+parseInt(_0x254b3b[_0x58a54a(0x189)]));});}}),await _0x3143e6[_0x5d5894(0x14b)]();const _0x1e6a77=await warehouse[_0x5d5894(0x170)]({'name':_0x415954[_0x5d5894(0x1b2)],'room':_0x415954['to_room']});_0x415954[_0x5d5894(0x146)][_0x5d5894(0x1bf)](_0x1a7993=>{var _0xd91abb=_0x5d5894;if(_0x1a7993[_0xd91abb(0x189)]>0x0){const _0x1b3824=_0x1e6a77['product_details']['map'](_0x4eb5e1=>{var _0x448478=_0xd91abb;_0x4eb5e1['product_name']==_0x1a7993[_0x448478(0x15f)]&&_0x4eb5e1['floorlevel']==_0x1a7993[_0x448478(0x1cd)]&&_0x4eb5e1[_0x448478(0x152)]==_0x1a7993[_0x448478(0x123)]&&_0x4eb5e1[_0x448478(0x10e)]==_0x1a7993[_0x448478(0x12c)]&&_0x4eb5e1[_0x448478(0x188)]==_0x1a7993[_0x448478(0x121)]&&_0x4eb5e1['rack']==_0x1a7993[_0x448478(0x115)]&&_0x4eb5e1[_0x448478(0x172)]==_0x1a7993[_0x448478(0x172)]&&(_0x4eb5e1['product_stock']=parseInt(_0x4eb5e1['product_stock'])-parseInt(_0x1a7993[_0x448478(0x189)]));});}}),await _0x1e6a77[_0x5d5894(0x14b)](),_0x415954['date']=_0x1da4c6,_0x415954[_0x5d5894(0x174)]=_0xa9f5c2,_0x415954['to_warehouse']=_0x4adaee,_0x415954[_0x5d5894(0x146)]=_0x3dfc51,_0x415954[_0x5d5894(0x1aa)]=_0x44641f,_0x415954[_0x5d5894(0x157)]=_0x5db73b;const _0x3dfb37=await _0x415954[_0x5d5894(0x14b)]();console[_0x5d5894(0x1c4)](_0x3dfb37);const _0x244d81=await warehouse[_0x5d5894(0x170)]({'name':_0xa9f5c2,'room':_0x2f3a68});_0x3dfb37[_0x5d5894(0x146)][_0x5d5894(0x1bf)](_0x7bd551=>{var _0x73384b=_0x5d5894;if(_0x7bd551['to_quantity']>0x0){const _0x80b1d4=_0x244d81[_0x73384b(0x1d1)][_0x73384b(0x165)](_0x59a5c2=>{var _0x2ec95a=_0x73384b;_0x59a5c2['product_name']==_0x7bd551[_0x2ec95a(0x15f)]&&_0x59a5c2[_0x2ec95a(0x16c)]==_0x7bd551[_0x2ec95a(0x147)]&&_0x59a5c2['type']==_0x7bd551[_0x2ec95a(0x1d9)]&&_0x59a5c2['bin']==_0x7bd551[_0x2ec95a(0x17b)]&&_0x59a5c2[_0x2ec95a(0x188)]==_0x7bd551[_0x2ec95a(0xfc)]&&_0x59a5c2['rack']==_0x7bd551[_0x2ec95a(0x1dd)]&&_0x59a5c2[_0x2ec95a(0x172)]==_0x7bd551[_0x2ec95a(0x199)]&&(_0x59a5c2[_0x2ec95a(0x138)]=parseInt(_0x59a5c2[_0x2ec95a(0x138)])-parseInt(_0x7bd551[_0x2ec95a(0x189)]));});}}),await _0x244d81[_0x5d5894(0x14b)]();const _0x4f2461=await warehouse[_0x5d5894(0x170)]({'name':_0x4adaee,'room':_0x1eea71});_0x3dfb37[_0x5d5894(0x146)][_0x5d5894(0x1bf)](_0x49faaf=>{var _0x32acd7=_0x5d5894;if(_0x49faaf[_0x32acd7(0x189)]>0x0){var _0x313fe1=0x0;const _0x20bdda=_0x4f2461[_0x32acd7(0x1d1)]['map'](_0x3d212d=>{var _0x32802d=_0x32acd7;_0x3d212d[_0x32802d(0x15f)]==_0x49faaf[_0x32802d(0x15f)]&&_0x3d212d[_0x32802d(0x16c)]==_0x49faaf[_0x32802d(0x1cd)]&&_0x3d212d['type']==_0x49faaf[_0x32802d(0x123)]&&_0x3d212d['bin']==_0x49faaf[_0x32802d(0x12c)]&&_0x3d212d['bay']==_0x49faaf[_0x32802d(0x121)]&&_0x3d212d[_0x32802d(0x115)]==_0x49faaf['rack']&&_0x3d212d[_0x32802d(0x172)]==_0x49faaf[_0x32802d(0x172)]&&(_0x3d212d[_0x32802d(0x138)]=parseInt(_0x3d212d['product_stock'])+parseInt(_0x49faaf[_0x32802d(0x189)]),_0x313fe1++);});_0x313fe1=='0'&&(_0x4f2461[_0x32acd7(0x1d1)]=_0x4f2461[_0x32acd7(0x1d1)][_0x32acd7(0x17f)]({'product_name':_0x49faaf[_0x32acd7(0x15f)],'product_stock':_0x49faaf['to_quantity'],'bay':_0x49faaf[_0x32acd7(0x121)],'bin':_0x49faaf[_0x32acd7(0x12c)],'type':_0x49faaf[_0x32acd7(0x123)],'floorlevel':_0x49faaf[_0x32acd7(0x1cd)],'storage':_0x49faaf[_0x32acd7(0x172)],'rack':_0x49faaf[_0x32acd7(0x115)],'product_code':_0x49faaf[_0x32acd7(0x1cf)],'primary_code':_0x49faaf[_0x32acd7(0x135)],'secondary_code':_0x49faaf[_0x32acd7(0x12a)],'maxProducts':_0x49faaf[_0x32acd7(0x178)],'storage':_0x49faaf[_0x32acd7(0x172)],'rack':_0x49faaf[_0x32acd7(0x115)]}));}}),await _0x4f2461[_0x5d5894(0x14b)](),_0x44ade5[_0x5d5894(0x1ba)](_0x5d5894(0x144),_0x5d5894(0x124)),_0x162077[_0x5d5894(0x1de)](_0x5d5894(0x113));}catch(_0x28d28a){console['log'](_0x28d28a);}}),router[a0_0x366757(0x17a)]('/barcode_scanner',async(_0x42d2d0,_0x1f15cc)=>{var _0x31c90e=a0_0x366757;const {FromWareHouse:_0x1ef483,FromRoom:_0x102d20,ToWarehouse:_0x11a66d,ToRoom:_0x45722c,primary_code:_0x621a22,Roomslist:_0x5eca05}=_0x42d2d0[_0x31c90e(0x197)],_0x45ee2a=_0x5eca05[_0x31c90e(0x125)](','),_0x25f334=[];async function _0x39c40e(_0x83070a){var _0x5d5614=_0x31c90e;const _0x3e2770=await warehouse[_0x5d5614(0x1e4)]([{'$match':{'name':_0x1ef483,'room':_0x83070a}},{'$unwind':_0x5d5614(0x167)},{'$match':{'product_details.primary_code':_0x621a22}},{'$group':{'_id':_0x5d5614(0x119),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x5d5614(0x1bb)},'primary_code':{'$first':_0x5d5614(0x158)},'secondary_code':{'$first':_0x5d5614(0x161)},'product_code':{'$first':_0x5d5614(0x1a7)},'level':{'$first':_0x5d5614(0x1be)},'isle':{'$first':_0x5d5614(0x1dc)},'type':{'$first':_0x5d5614(0x1ce)},'pallet':{'$first':_0x5d5614(0x100)},'unit':{'$first':_0x5d5614(0x156)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x5d5614(0x112)},'rack':{'$first':_0x5d5614(0x173)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5d5614(0x196)},'batch_code':{'$first':_0x5d5614(0x1bc)},'maxPerUnit':{'$first':_0x5d5614(0x118)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x5d5614(0x1a9)},'maxProducts':{'$first':_0x5d5614(0x103)},'invoice_product':{'$first':_0x5d5614(0x166)}}}]),_0x2e9c3b=await warehouse[_0x5d5614(0x1e4)]([{'$match':{'name':_0x1ef483,'room':_0x83070a}},{'$unwind':_0x5d5614(0x167)},{'$match':{'product_details.secondary_code':_0x621a22}},{'$group':{'_id':_0x5d5614(0x119),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x5d5614(0x1bb)},'primary_code':{'$first':_0x5d5614(0x158)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5d5614(0x1a7)},'level':{'$first':_0x5d5614(0x1be)},'isle':{'$first':_0x5d5614(0x1dc)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5d5614(0x156)},'secondary_unit':{'$first':_0x5d5614(0x1a6)},'storage':{'$first':_0x5d5614(0x112)},'rack':{'$first':_0x5d5614(0x173)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5d5614(0x196)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x5d5614(0x118)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x5d5614(0x1a9)},'maxProducts':{'$first':_0x5d5614(0x103)},'invoice_product':{'$first':_0x5d5614(0x166)}}}]);if(_0x3e2770[_0x5d5614(0x1b1)]>0x0)_0x25f334[_0x5d5614(0x1d7)](_0x3e2770);else _0x2e9c3b[_0x5d5614(0x1b1)]>0x0&&_0x25f334[_0x5d5614(0x1d7)](_0x2e9c3b);}const _0x760a4d=_0x45ee2a[_0x31c90e(0x165)](_0x28e067=>_0x39c40e(_0x28e067));await Promise['all'](_0x760a4d),_0x1f15cc[_0x31c90e(0xfe)](_0x25f334);}),router[a0_0x366757(0x17a)]('/barcode_scanner2',async(_0x140b29,_0x3189f3)=>{var _0x5a7792=a0_0x366757;try{const {FromWareHouse:_0x52f18d,FromRoom:_0x214009,ToWarehouse:_0xa689aa,ToRoom:_0x2d661b,secondary_code:_0xbc3f8c}=_0x140b29['body'],_0x3918c9=await warehouse[_0x5a7792(0x1e4)]([{'$match':{'name':_0x52f18d}},{'$unwind':_0x5a7792(0x167)},{'$match':{'product_details.secondary_code':_0xbc3f8c}},{'$group':{'_id':_0x5a7792(0x119),'name':{'$first':_0x5a7792(0x111)},'primary_code':{'$first':_0x5a7792(0x158)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x5a7792(0x1bb)},'warehouse':{'$first':'$name'},'level':{'$first':_0x5a7792(0x130)},'isle':{'$first':_0x5a7792(0x109)},'pallet':{'$first':_0x5a7792(0x11b)},'maxProducts':{'$first':_0x5a7792(0x103)},'unit':{'$first':'$product_details.unit'}}}]);_0x3189f3[_0x5a7792(0xfd)](0xc8)[_0x5a7792(0xfe)](_0x3918c9);}catch(_0x7bd28d){_0x3189f3[_0x5a7792(0xfd)](0x194)[_0x5a7792(0xfe)]({'message':_0x7bd28d[_0x5a7792(0x13f)]});}}),router[a0_0x366757(0x17a)](a0_0x366757(0x16f),async(_0x1455af,_0x421c9e)=>{var _0x5e56a2=a0_0x366757;try{const {FromWareHouse:_0x5d9087,FromRoom:_0x1d3df7,ToWarehouse:_0x1e1399,ToRoom:_0x259fb8,product_code:_0x394f84}=_0x1455af['body'],_0x585fa7=await warehouse[_0x5e56a2(0x1e4)]([{'$match':{'name':_0x5d9087}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x394f84}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5e56a2(0x111)},'primary_code':{'$first':_0x5e56a2(0x158)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x5e56a2(0x1bb)},'warehouse':{'$first':'$name'},'level':{'$first':_0x5e56a2(0x130)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x5e56a2(0x156)}}}]);_0x421c9e[_0x5e56a2(0xfd)](0xc8)[_0x5e56a2(0xfe)](_0x585fa7);}catch(_0x65ff1){_0x421c9e['status'](0x194)['json']({'message':_0x65ff1[_0x5e56a2(0x13f)]});}}),router[a0_0x366757(0x17a)]('/CheckingWarehouse',async(_0x5235d4,_0x39795e)=>{var _0x679855=a0_0x366757;const {level:_0x87316c,isle:_0x45a34e,pallet:_0x47b8fa,warehouses:_0x2a2d93,room:_0x1868c6}=_0x5235d4[_0x679855(0x197)];try{const _0x5e2791=await warehouse[_0x679855(0x1e4)]([{'$match':{'name':_0x2a2d93,'room':_0x1868c6}},{'$unwind':_0x679855(0x167)},{'$match':{'product_details.level':parseInt(_0x87316c),'product_details.isle':_0x45a34e,'product_details.pallet':parseInt(_0x47b8fa)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x679855(0x111)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x679855(0x130)},'isle':{'$first':_0x679855(0x109)},'pallet':{'$first':_0x679855(0x11b)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x39795e[_0x679855(0xfd)](0xc8)[_0x679855(0xfe)](_0x5e2791);}catch(_0x5d3c31){_0x39795e[_0x679855(0xfd)](0x194)[_0x679855(0xfe)]({'message':_0x5d3c31[_0x679855(0x13f)]});}}),module['exports']=router;