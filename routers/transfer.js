var a0_0xd7508b=a0_0x2b73;(function(_0x29d836,_0x70ec6a){var _0x4701f4=a0_0x2b73,_0x337619=_0x29d836();while(!![]){try{var _0x1ec580=-parseInt(_0x4701f4(0xe9))/0x1+parseInt(_0x4701f4(0x17e))/0x2+-parseInt(_0x4701f4(0x105))/0x3+-parseInt(_0x4701f4(0x168))/0x4*(parseInt(_0x4701f4(0xc3))/0x5)+parseInt(_0x4701f4(0x163))/0x6+-parseInt(_0x4701f4(0x170))/0x7*(parseInt(_0x4701f4(0xe8))/0x8)+parseInt(_0x4701f4(0xd6))/0x9*(parseInt(_0x4701f4(0x13c))/0xa);if(_0x1ec580===_0x70ec6a)break;else _0x337619['push'](_0x337619['shift']());}catch(_0x24f66c){_0x337619['push'](_0x337619['shift']());}}}(a0_0x25d8,0x30462));const express=require(a0_0xd7508b(0x149)),app=express(),router=express[a0_0xd7508b(0x135)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require(a0_0xd7508b(0x12b));router[a0_0xd7508b(0x137)](a0_0xd7508b(0x17a),auth,async(_0xecedbc,_0x7b58de)=>{var _0x7baa61=a0_0xd7508b;try{const {username:_0x2358fc,email:_0x3a282a,role:_0x350586}=_0xecedbc[_0x7baa61(0x181)],_0x5071ed=_0xecedbc[_0x7baa61(0x181)],_0x4c972a=await profile[_0x7baa61(0xf5)]({'email':_0x5071ed['email']}),_0x353d1c=await master_shop[_0x7baa61(0x11e)]();console[_0x7baa61(0xac)](_0x7baa61(0x14d),_0x353d1c);let _0x4d12cb;if(_0x5071ed[_0x7baa61(0x172)]=='staff'){const _0x376e22=await staff[_0x7baa61(0xf5)]({'email':_0x5071ed[_0x7baa61(0x96)]});_0x4d12cb=await transfers['find']({'from_warehouse':_0x376e22[_0x7baa61(0x160)]});}else _0x4d12cb=await transfers['aggregate']([{'$unwind':_0x7baa61(0xfd)},{'$group':{'_id':'$_id','invoice':{'$first':_0x7baa61(0x169)},'date':{'$first':_0x7baa61(0xba)},'from_warehouse':{'$first':_0x7baa61(0xa3)},'to_warehouse':{'$first':_0x7baa61(0xe4)},'from_room_name':{'$addToSet':_0x7baa61(0x11f)},'to_room_name':{'$addToSet':_0x7baa61(0xc4)},'finalize':{'$first':_0x7baa61(0x116)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x353d1c[0x0][_0x7baa61(0x17c)]==_0x7baa61(0xe3)){var _0x484f30=users['English'];console[_0x7baa61(0xac)](_0x484f30);}else{if(_0x353d1c[0x0][_0x7baa61(0x17c)]==_0x7baa61(0xb6))var _0x484f30=users[_0x7baa61(0xb6)];else{if(_0x353d1c[0x0]['language']==_0x7baa61(0x133))var _0x484f30=users[_0x7baa61(0x133)];else{if(_0x353d1c[0x0][_0x7baa61(0x17c)]==_0x7baa61(0x174))var _0x484f30=users[_0x7baa61(0x174)];else{if(_0x353d1c[0x0][_0x7baa61(0x17c)]==_0x7baa61(0xcb))var _0x484f30=users[_0x7baa61(0xcb)];else{if(_0x353d1c[0x0][_0x7baa61(0x17c)]==_0x7baa61(0xde))var _0x484f30=users[_0x7baa61(0xab)];else{if(_0x353d1c[0x0][_0x7baa61(0x17c)]==_0x7baa61(0xc6))var _0x484f30=users[_0x7baa61(0xc6)];else{if(_0x353d1c[0x0][_0x7baa61(0x17c)]=='Arabic\x20(ae)')var _0x484f30=users[_0x7baa61(0x10f)];}}}}}}}_0x7b58de[_0x7baa61(0xca)](_0x7baa61(0x12c),{'success':_0xecedbc['flash']('success'),'errors':_0xecedbc['flash']('errors'),'role':_0x5071ed,'profile':_0x4c972a,'master_shop':_0x353d1c,'transfer':_0x4d12cb,'language':_0x484f30});}catch(_0x1a8a4f){console['log'](_0x1a8a4f);}});async function getRandom8DigitNumber(){var _0x3d40f9=a0_0xd7508b;const _0x19f62e=0x989680,_0x59091e=0x5f5e0ff,_0x11d059=Math[_0x3d40f9(0x157)](Math[_0x3d40f9(0xd3)]()*(_0x59091e-_0x19f62e+0x1))+_0x19f62e;var _0x50e652;const _0x74489=await transfers[_0x3d40f9(0xf5)]({'invoice':_0x3d40f9(0xd1)+_0x11d059});return _0x74489&&_0x74489[_0x3d40f9(0xf0)]>0x0?_0x50e652=_0x3d40f9(0xd1)+_0x11d059:_0x50e652=_0x3d40f9(0xd1)+_0x11d059,_0x50e652;}router['get'](a0_0xd7508b(0x166),auth,async(_0x2cce63,_0x1af14e)=>{var _0x253000=a0_0xd7508b;try{const {username:_0x15a868,email:_0x44f78b,role:_0xa05195}=_0x2cce63[_0x253000(0x181)],_0xd8fb78=_0x2cce63[_0x253000(0x181)],_0x3e391f=await profile[_0x253000(0xf5)]({'email':_0xd8fb78['email']}),_0x251c92=await master_shop[_0x253000(0x11e)]();console[_0x253000(0xac)]('master',_0x251c92);let _0x49fec4;if(_0xd8fb78[_0x253000(0x172)]==_0x253000(0xee)){const _0x4e6633=await staff[_0x253000(0xf5)]({'email':_0xd8fb78['email']});_0x49fec4=await warehouse[_0x253000(0x9f)]([{'$match':{'status':'Enabled','name':_0x4e6633[_0x253000(0x160)],'warehouse_category':_0x253000(0x147)}},{'$group':{'_id':_0x253000(0x156),'name':{'$first':_0x253000(0x156)}}}]);}else _0x49fec4=await warehouse['aggregate']([{'$match':{'status':_0x253000(0x114),'warehouse_category':_0x253000(0x147)}},{'$group':{'_id':'$name','name':{'$first':_0x253000(0x156)}}}]);var _0x4b49c4=['Ambient','Enclosed',_0x253000(0xb4)];const _0x74ea69=await transfers[_0x253000(0x11e)]({}),_0x4c9f5f=_0x74ea69[_0x253000(0xf0)]+0x1,_0x547ad4=_0x253000(0xd1)+_0x4c9f5f['toString']()[_0x253000(0xc5)](0x5,'0');if(_0x251c92[0x0][_0x253000(0x17c)]==_0x253000(0xe3)){var _0x556844=users['English'];console[_0x253000(0xac)](_0x556844);}else{if(_0x251c92[0x0][_0x253000(0x17c)]==_0x253000(0xb6))var _0x556844=users[_0x253000(0xb6)];else{if(_0x251c92[0x0]['language']==_0x253000(0x133))var _0x556844=users[_0x253000(0x133)];else{if(_0x251c92[0x0][_0x253000(0x17c)]=='Spanish')var _0x556844=users[_0x253000(0x174)];else{if(_0x251c92[0x0][_0x253000(0x17c)]==_0x253000(0xcb))var _0x556844=users[_0x253000(0xcb)];else{if(_0x251c92[0x0][_0x253000(0x17c)]==_0x253000(0xde))var _0x556844=users['Portuguese'];else{if(_0x251c92[0x0][_0x253000(0x17c)]==_0x253000(0xc6))var _0x556844=users[_0x253000(0xc6)];else{if(_0x251c92[0x0]['language']==_0x253000(0x14b))var _0x556844=users[_0x253000(0x10f)];}}}}}}}const _0x1043e=getRandom8DigitNumber();_0x1043e[_0x253000(0xa1)](_0x364694=>{var _0x28a43f=_0x253000;_0x1af14e[_0x28a43f(0xca)](_0x28a43f(0xd7),{'success':_0x2cce63[_0x28a43f(0xb7)](_0x28a43f(0xc8)),'errors':_0x2cce63['flash'](_0x28a43f(0x100)),'role':_0xd8fb78,'profile':_0x3e391f,'master_shop':_0x251c92,'warehouse':_0x49fec4,'language':_0x556844,'rooms_data':_0x4b49c4,'invoice':_0x364694});})[_0x253000(0xb9)](_0x84389f=>{var _0x10bf1f=_0x253000;_0x2cce63[_0x10bf1f(0xb7)](_0x10bf1f(0x100),_0x10bf1f(0x184)),_0x1af14e['redirect'](_0x10bf1f(0x167));});}catch(_0x3a691a){console[_0x253000(0xac)](_0x3a691a);}}),router[a0_0xd7508b(0x151)]('/view/add_transfer',auth,async(_0x15fb3a,_0x3f35e4)=>{var _0x50b256=a0_0xd7508b;try{console[_0x50b256(0xac)](_0x15fb3a[_0x50b256(0x104)]);const {date:_0x5b2c6c,from_warehouse:_0x472f14,FromRoom_name:_0x2285bb,to_warehouse:_0xe117,ToRoom_name:_0x3bdea8,prod_name:_0x22e5e2,from_prod_qty:_0x5ca069,from_prod_level:_0x13c4c2,from_prod_isle:_0x3a99f1,from_prod_pallet:_0x27bb98,to_prod_qty:_0x1ffcae,to_prod_level:_0x4cdb00,to_prod_isle:_0xfde98c,to_prod_pallet:_0x593b68,primary_code:_0x5d4cf6,secondary_code:_0x40bcdc,product_code3:_0x178aae,note:_0x23f0f2,MaxStocks_data2:_0x3fdc5c,invoice:_0x51ed7f,expiry_date:_0x362dfa}=_0x15fb3a[_0x50b256(0x104)];if(typeof _0x22e5e2==_0x50b256(0x16b))var _0x434709=[_0x15fb3a[_0x50b256(0x104)]['prod_name']],_0x942efe=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x112)]],_0x44a6e2=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x92)]],_0x2cb19c=[_0x15fb3a[_0x50b256(0x104)]['New_Qty_Converted']],_0xfa7a05=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0xd9)]],_0x207b40=[_0x15fb3a[_0x50b256(0x104)]['primary_code']],_0x5a125b=[_0x15fb3a['body'][_0x50b256(0xa5)]],_0x12eab2=[_0x15fb3a[_0x50b256(0x104)]['product_code3']],_0xd18667=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x11a)]],_0x12b7a5=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x115)]],_0x29a858=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x16d)]],_0x500cdf=[_0x15fb3a[_0x50b256(0x104)]['batch_code']],_0x434556=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x14e)]],_0xfb4f92=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x93)]],_0x109364=[_0x15fb3a[_0x50b256(0x104)]['production_date']],_0x2cd058=[_0x15fb3a[_0x50b256(0x104)]['prod_cat']],_0x1c7e0a=[_0x15fb3a['body'][_0x50b256(0xbc)]],_0x4487dc=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x164)]],_0x3f131a=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x175)]],_0xb86e42=[_0x15fb3a['body'][_0x50b256(0x177)]],_0x1ca15a=[_0x15fb3a[_0x50b256(0x104)][_0x50b256(0x110)]];else var _0x434709=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x130)]],_0x942efe=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x112)]],_0x44a6e2=[..._0x15fb3a[_0x50b256(0x104)]['from_prod_level']],_0x2cb19c=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x14a)]],_0xfa7a05=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0xd9)]],_0x207b40=[..._0x15fb3a['body'][_0x50b256(0xd0)]],_0x5a125b=[..._0x15fb3a['body'][_0x50b256(0xa5)]],_0x12eab2=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0xe0)]],_0xd18667=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x11a)]],_0x12b7a5=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x115)]],_0x29a858=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x16d)]],_0x500cdf=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0xf4)]],_0x434556=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x14e)]],_0xfb4f92=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x93)]],_0x109364=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x146)]],_0x2cd058=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0xbb)]],_0x1c7e0a=[..._0x15fb3a['body'][_0x50b256(0xbc)]],_0x4487dc=[..._0x15fb3a['body'][_0x50b256(0x164)]],_0x3f131a=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x175)]],_0xb86e42=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x177)]],_0x1ca15a=[..._0x15fb3a[_0x50b256(0x104)][_0x50b256(0x110)]];const _0x39283a=_0x434709[_0x50b256(0x12d)](_0x225332=>{return _0x225332={'product_name':_0x225332};});_0x942efe['forEach']((_0x591a5d,_0x458987)=>{var _0x300f0e=_0x50b256;_0x39283a[_0x458987][_0x300f0e(0x16e)]=_0x591a5d;}),_0x3f131a[_0x50b256(0x17b)]((_0x5e190f,_0x3a59c2)=>{var _0x5778a0=_0x50b256;_0x39283a[_0x3a59c2][_0x5778a0(0x175)]=_0x5e190f;}),_0xb86e42['forEach']((_0x9b6366,_0x48eba0)=>{var _0x182c9d=_0x50b256;_0x39283a[_0x48eba0][_0x182c9d(0xf6)]=_0x9b6366;}),_0x1ca15a['forEach']((_0x2bc548,_0x2c2cfe)=>{_0x39283a[_0x2c2cfe]['id_transaction_id']=_0x2bc548;}),_0x44a6e2[_0x50b256(0x17b)]((_0x1c7c23,_0x4a5139)=>{var _0x459f25=_0x50b256;_0x1c7e0a[_0x459f25(0x17b)]((_0x118a0a,_0x2537f0)=>{var _0x51b38c=_0x459f25;if(_0x118a0a=='Receiving\x20Area'&&_0x4a5139==_0x2537f0){var _0x16eed0=_0x1c7c23['slice'](0x3);_0x39283a[_0x4a5139][_0x51b38c(0xd5)]=_0x1c7c23[0x0],_0x39283a[_0x4a5139]['from_rack']=_0x1c7c23[0x1],_0x39283a[_0x4a5139][_0x51b38c(0xdd)]=0x0,_0x39283a[_0x4a5139][_0x51b38c(0xe1)]=0x0,_0x39283a[_0x4a5139][_0x51b38c(0x136)]=_0x51b38c(0x185),_0x39283a[_0x4a5139][_0x51b38c(0x12e)]=_0x16eed0;}else{if(_0x118a0a==_0x51b38c(0x9b)&&_0x4a5139==_0x2537f0){var _0x16eed0=_0x1c7c23[_0x51b38c(0xea)](0x3);_0x39283a[_0x4a5139]['from_storage']=_0x1c7c23[0x0],_0x39283a[_0x4a5139]['from_rack']=_0x1c7c23[0x1],_0x39283a[_0x4a5139][_0x51b38c(0xdd)]=0x0,_0x39283a[_0x4a5139]['from_bin']=0x0,_0x39283a[_0x4a5139][_0x51b38c(0x136)]=_0x51b38c(0x185),_0x39283a[_0x4a5139][_0x51b38c(0x12e)]=_0x1c7c23[0x5];}else{if(_0x4a5139==_0x2537f0){if(_0x1c7c23[0x0]=='A'&&_0x1c7c23[0x1]=='L'&&_0x1c7c23[0x2]=='L')console[_0x51b38c(0xac)](_0x118a0a+'\x20<>\x20'+_0x4a5139+_0x51b38c(0xcd)+_0x2537f0+'\x20<>\x20'+_0x1c7c23+_0x51b38c(0xe2)),_0x39283a[_0x4a5139][_0x51b38c(0xd5)]=_0x1c7c23[0x0],_0x39283a[_0x4a5139][_0x51b38c(0x99)]=_0x1c7c23[0x1],_0x39283a[_0x4a5139][_0x51b38c(0xdd)]=0x0,_0x39283a[_0x4a5139][_0x51b38c(0xe1)]=0x0,_0x39283a[_0x4a5139][_0x51b38c(0x136)]=_0x51b38c(0x185),_0x39283a[_0x4a5139][_0x51b38c(0x12e)]=_0x1c7c23[0x3];else{var _0x50b20f;if(_0x1c7c23[0x4]=='L')_0x50b20f=_0x51b38c(0x97);else _0x1c7c23[0x4]=='F'&&(_0x50b20f=_0x51b38c(0x185));_0x39283a[_0x4a5139][_0x51b38c(0xd5)]=_0x1c7c23[0x0],_0x39283a[_0x4a5139][_0x51b38c(0x99)]=_0x1c7c23[0x1],_0x39283a[_0x4a5139][_0x51b38c(0xdd)]=_0x1c7c23[0x2],_0x39283a[_0x4a5139]['from_bin']=_0x1c7c23[0x3],_0x39283a[_0x4a5139]['from_types']=_0x50b20f,_0x39283a[_0x4a5139][_0x51b38c(0x12e)]=_0x1c7c23[0x5];}}}}});}),_0x2cb19c[_0x50b256(0x17b)]((_0x2bdc77,_0x3b0d10)=>{var _0x1415b4=_0x50b256;_0x39283a[_0x3b0d10][_0x1415b4(0xa4)]=_0x2bdc77;}),_0xfa7a05['forEach']((_0x55bd9a,_0x3e0c67)=>{var _0xc15f5c=_0x50b256;_0x4487dc[_0xc15f5c(0x17b)]((_0x10a210,_0x3377c7)=>{var _0xb5484f=_0xc15f5c;if(_0x10a210==_0xb5484f(0x142)&&_0x3e0c67==_0x3377c7){var _0x5d039d=_0x55bd9a[_0xb5484f(0xea)](0x3);_0x39283a[_0x3e0c67][_0xb5484f(0x165)]=_0x55bd9a[0x0],_0x39283a[_0x3e0c67][_0xb5484f(0x139)]=_0x55bd9a[0x1],_0x39283a[_0x3e0c67][_0xb5484f(0x10d)]=0x0,_0x39283a[_0x3e0c67][_0xb5484f(0xf8)]=0x0,_0x39283a[_0x3e0c67][_0xb5484f(0xcc)]='Floor',_0x39283a[_0x3e0c67]['to_floorlevel']=_0x5d039d;}else{if(_0x10a210==_0xb5484f(0x9b)&&_0x3e0c67==_0x3377c7){var _0x5d039d=_0x55bd9a[_0xb5484f(0xea)](0x3);_0x39283a[_0x3e0c67][_0xb5484f(0x165)]=_0x55bd9a[0x0],_0x39283a[_0x3e0c67]['rack']=_0x55bd9a[0x1],_0x39283a[_0x3e0c67][_0xb5484f(0x10d)]=0x0,_0x39283a[_0x3e0c67][_0xb5484f(0xf8)]=0x0,_0x39283a[_0x3e0c67][_0xb5484f(0xcc)]=_0xb5484f(0x185),_0x39283a[_0x3e0c67][_0xb5484f(0x12f)]=_0x55bd9a[0x5];}else{if(_0x3e0c67==_0x3377c7){if(_0x55bd9a[0x0]=='A'&&_0x55bd9a[0x1]=='L'&&_0x55bd9a[0x2]=='L')console[_0xb5484f(0xac)](_0x10a210+'\x20<>\x20'+_0x3e0c67+'\x20<>\x20'+_0x3377c7+_0xb5484f(0xcd)+_0x55bd9a+_0xb5484f(0xe2)),_0x39283a[_0x3e0c67]['storage']=_0x55bd9a[0x0],_0x39283a[_0x3e0c67][_0xb5484f(0x139)]=_0x55bd9a[0x1],_0x39283a[_0x3e0c67][_0xb5484f(0x10d)]=0x0,_0x39283a[_0x3e0c67][_0xb5484f(0xf8)]=0x0,_0x39283a[_0x3e0c67][_0xb5484f(0xcc)]='Floor',_0x39283a[_0x3e0c67]['to_floorlevel']=_0x55bd9a[0x3];else{var _0x343801;if(_0x55bd9a[0x4]=='L')_0x343801='Level';else _0x55bd9a[0x4]=='F'&&(_0x343801=_0xb5484f(0x185));_0x39283a[_0x3e0c67][_0xb5484f(0x165)]=_0x55bd9a[0x0],_0x39283a[_0x3e0c67][_0xb5484f(0x139)]=_0x55bd9a[0x1],_0x39283a[_0x3e0c67]['to_bay']=_0x55bd9a[0x2],_0x39283a[_0x3e0c67][_0xb5484f(0xf8)]=_0x55bd9a[0x3],_0x39283a[_0x3e0c67][_0xb5484f(0xcc)]=_0x343801,_0x39283a[_0x3e0c67][_0xb5484f(0x12f)]=_0x55bd9a[0x5];}}}}});}),_0x207b40[_0x50b256(0x17b)]((_0x1ad907,_0x3f63a7)=>{_0x39283a[_0x3f63a7]['primary_code']=_0x1ad907;}),_0x5a125b[_0x50b256(0x17b)]((_0x457af7,_0x26a987)=>{var _0x12f591=_0x50b256;_0x39283a[_0x26a987][_0x12f591(0xa5)]=_0x457af7;}),_0x12eab2[_0x50b256(0x17b)]((_0x1f8e91,_0x178a5d)=>{var _0x4d8e00=_0x50b256;_0x39283a[_0x178a5d][_0x4d8e00(0x15e)]=_0x1f8e91;}),_0xd18667[_0x50b256(0x17b)]((_0x121723,_0x5bd685)=>{_0x39283a[_0x5bd685]['maxProducts']=_0x121723;}),_0x12b7a5[_0x50b256(0x17b)]((_0x1ecf58,_0x1be785)=>{var _0x287b24=_0x50b256;_0x39283a[_0x1be785][_0x287b24(0xad)]=_0x1ecf58;}),_0x29a858[_0x50b256(0x17b)]((_0x297ea6,_0xe120a1)=>{var _0x1d76e3=_0x50b256;_0x39283a[_0xe120a1][_0x1d76e3(0x16d)]=_0x297ea6;}),_0x500cdf[_0x50b256(0x17b)]((_0x497b09,_0x1c5394)=>{var _0x3cd226=_0x50b256;_0x39283a[_0x1c5394][_0x3cd226(0xf4)]=_0x497b09;}),_0x434556[_0x50b256(0x17b)]((_0x1259c4,_0x4de665)=>{_0x39283a[_0x4de665]['expiry_date']=_0x1259c4;}),_0xfb4f92[_0x50b256(0x17b)]((_0x8f3c08,_0x4304df)=>{var _0x248e51=_0x50b256;_0x39283a[_0x4304df][_0x248e51(0x106)]=_0x8f3c08;}),_0x109364[_0x50b256(0x17b)]((_0x180c5f,_0x1deaa8)=>{_0x39283a[_0x1deaa8]['production_date']=_0x180c5f;}),_0x2cd058[_0x50b256(0x17b)]((_0x4500e4,_0x5715c8)=>{_0x39283a[_0x5715c8]['prod_cat']=_0x4500e4;}),_0x1c7e0a[_0x50b256(0x17b)]((_0x28aa41,_0x45e19a)=>{var _0x49949a=_0x50b256;_0x39283a[_0x45e19a][_0x49949a(0x134)]=_0x28aa41;}),_0x4487dc[_0x50b256(0x17b)]((_0x5a45d8,_0x8a45af)=>{var _0x2b068d=_0x50b256;_0x39283a[_0x8a45af][_0x2b068d(0x15b)]=_0x5a45d8;});const _0x83522e=_0x39283a[_0x50b256(0x150)](_0x57ab7f=>_0x57ab7f['to_quantity']!=='0'&&_0x57ab7f[_0x50b256(0xa4)]!==''||_0x57ab7f[_0x50b256(0x12f)]!=='0'&&_0x57ab7f['to_floorlevel']!==''),_0x1c5cbe=new transfers({'date':_0x5b2c6c,'from_warehouse':_0x472f14,'to_warehouse':_0xe117,'product':_0x83522e,'note':_0x23f0f2,'invoice':_0x51ed7f}),_0x4bad69=await _0x1c5cbe[_0x50b256(0xae)]();_0x15fb3a[_0x50b256(0xb7)](_0x50b256(0xc8),_0x50b256(0xa9)),_0x3f35e4[_0x50b256(0xfe)](_0x50b256(0x180)+_0x4bad69[_0x50b256(0x13a)]);}catch(_0x16bc51){console[_0x50b256(0xac)](_0x16bc51),_0x3f35e4[_0x50b256(0xa2)](0xc8)['json']({'errorMessage':_0x16bc51[_0x50b256(0x9a)]});}}),router[a0_0xd7508b(0x137)]('/preview/:id',auth,async(_0x2a1242,_0x287e3d)=>{var _0x75c765=a0_0xd7508b;try{const {username:_0x4354bd,email:_0x2d4b34,role:_0x3dfa56}=_0x2a1242[_0x75c765(0x181)],_0x4322a5=_0x2a1242[_0x75c765(0x181)],_0x1f2d19=await profile[_0x75c765(0xf5)]({'email':_0x4322a5[_0x75c765(0x96)]}),_0x20cd93=await master_shop[_0x75c765(0x11e)]();console[_0x75c765(0xac)](_0x75c765(0x14d),_0x20cd93);const _0x505317=await transfers[_0x75c765(0x95)](_0x2a1242[_0x75c765(0x17d)]['id']);let _0xf03b9=new Date(_0x505317[_0x75c765(0x14e)]),_0x2d8f52=('0'+_0xf03b9[_0x75c765(0x17f)]())['slice'](-0x2),_0x38e7be=('0'+(_0xf03b9['getMonth']()+0x1))[_0x75c765(0xea)](-0x2),_0x47bbcc=_0xf03b9[_0x75c765(0xfa)](),_0x105453=_0x47bbcc+'-'+_0x38e7be+'-'+_0x2d8f52,_0x518110;if(_0x4322a5[_0x75c765(0x172)]==_0x75c765(0xee)){const _0x2b1906=await staff[_0x75c765(0xf5)]({'email':_0x4322a5[_0x75c765(0x96)]});_0x518110=await warehouse[_0x75c765(0x11e)]({'status':'Enabled','name':_0x2b1906[_0x75c765(0x160)],'warehouse_category':_0x75c765(0x147)});}else _0x518110=await warehouse['find']({'status':_0x75c765(0x114),'warehouse_category':_0x75c765(0x147)});const _0x486da4=await warehouse[_0x75c765(0x9f)]([{'$match':{'name':_0x505317['from_warehouse']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x75c765(0xa7),'name':{'$first':_0x75c765(0x182)},'product_stock':{'$first':_0x75c765(0x155)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x75c765(0x113)},'primary_code':{'$first':_0x75c765(0xf7)},'secondary_code':{'$first':_0x75c765(0xb2)},'product_code':{'$first':_0x75c765(0xfb)},'storage':{'$first':_0x75c765(0x158)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x75c765(0xff)},'room':{'$first':_0x75c765(0x111)}}}]);if(_0x20cd93[0x0][_0x75c765(0x17c)]==_0x75c765(0xe3)){var _0x1421d6=users[_0x75c765(0xd2)];console[_0x75c765(0xac)](_0x1421d6);}else{if(_0x20cd93[0x0][_0x75c765(0x17c)]==_0x75c765(0xb6))var _0x1421d6=users[_0x75c765(0xb6)];else{if(_0x20cd93[0x0][_0x75c765(0x17c)]==_0x75c765(0x133))var _0x1421d6=users[_0x75c765(0x133)];else{if(_0x20cd93[0x0][_0x75c765(0x17c)]==_0x75c765(0x174))var _0x1421d6=users[_0x75c765(0x174)];else{if(_0x20cd93[0x0][_0x75c765(0x17c)]==_0x75c765(0xcb))var _0x1421d6=users[_0x75c765(0xcb)];else{if(_0x20cd93[0x0][_0x75c765(0x17c)]==_0x75c765(0xde))var _0x1421d6=users[_0x75c765(0xab)];else{if(_0x20cd93[0x0][_0x75c765(0x17c)]==_0x75c765(0xc6))var _0x1421d6=users['Chinese'];else{if(_0x20cd93[0x0][_0x75c765(0x17c)]=='Arabic\x20(ae)')var _0x1421d6=users['Arabic'];}}}}}}}_0x287e3d['render']('edit_transfer_view',{'success':_0x2a1242[_0x75c765(0xb7)](_0x75c765(0xc8)),'errors':_0x2a1242['flash'](_0x75c765(0x100)),'role':_0x4322a5,'profile':_0x1f2d19,'master_shop':_0x20cd93,'warehouse':_0x518110,'transfer':_0x505317,'stock':_0x486da4,'language':_0x1421d6});}catch(_0x2c3094){console[_0x75c765(0xac)](_0x2c3094);}}),router['post'](a0_0xd7508b(0x125),auth,async(_0x5ece2a,_0x4c8664)=>{var _0x306e70=a0_0xd7508b;try{const _0x142269=_0x5ece2a['params']['id'],{from_warehouse:_0xcce3e2,FromRoom_name:_0x593246,to_warehouse:_0x9347c9,ToRoom_name:_0x30f4e6}=_0x5ece2a[_0x306e70(0x104)],_0x29d09f=await transfers[_0x306e70(0x95)]({'_id':_0x142269}),_0x557392=_0x29d09f[_0x306e70(0x124)][_0x306e70(0x12d)](async _0x5f2f5c=>{var _0x5e0806=_0x306e70;if(_0x5f2f5c['to_quantity']>0x0){var _0x107582=await warehouse['findOne']({'name':_0x29d09f[_0x5e0806(0x98)],'room':_0x5f2f5c[_0x5e0806(0x134)],'warehouse_category':_0x5e0806(0x147)});const _0x47cfe3=_0x107582['product_details'][_0x5e0806(0x12d)](_0x32d174=>{var _0x5e9b63=_0x5e0806;_0x32d174[_0x5e9b63(0x159)]==_0x5f2f5c['product_name']&&_0x32d174[_0x5e9b63(0x91)]==_0x5f2f5c[_0x5e9b63(0x12e)]&&_0x32d174[_0x5e9b63(0xec)]==_0x5f2f5c[_0x5e9b63(0x136)]&&_0x32d174['bin']==_0x5f2f5c[_0x5e9b63(0xe1)]&&_0x32d174[_0x5e9b63(0x16c)]==_0x5f2f5c[_0x5e9b63(0xdd)]&&_0x32d174[_0x5e9b63(0x139)]==_0x5f2f5c[_0x5e9b63(0x99)]&&_0x32d174[_0x5e9b63(0x165)]==_0x5f2f5c[_0x5e9b63(0xd5)]&&_0x32d174[_0x5e9b63(0x14e)]==_0x5f2f5c[_0x5e9b63(0x14e)]&&_0x32d174[_0x5e9b63(0xf4)]==_0x5f2f5c[_0x5e9b63(0xf4)]&&_0x32d174[_0x5e9b63(0x146)]==_0x5f2f5c[_0x5e9b63(0x146)]&&_0x32d174[_0x5e9b63(0x178)]==_0x5f2f5c['from_invoice']&&_0x32d174[_0x5e9b63(0x13a)]==_0x5f2f5c['id_transaction_id']&&(_0x32d174[_0x5e9b63(0xda)]=_0x32d174['product_stock']-_0x5f2f5c['to_quantity']);});}return _0x107582;});Promise[_0x306e70(0xdc)](_0x557392)[_0x306e70(0xa1)](async _0x30c018=>{var _0x4b59e0=_0x306e70;try{for(const _0x5b50b6 of _0x30c018){await _0x5b50b6[_0x4b59e0(0xae)]();}try{const _0x47c477=_0x29d09f[_0x4b59e0(0x124)][_0x4b59e0(0x12d)](async _0x4660bb=>{var _0x4d1ec1=_0x4b59e0;if(_0x4660bb[_0x4d1ec1(0xa4)]>0x0){var _0x23ba10=await warehouse[_0x4d1ec1(0xf5)]({'name':_0x29d09f[_0x4d1ec1(0x14f)],'room':_0x4660bb[_0x4d1ec1(0x15b)],'warehouse_category':_0x4d1ec1(0x147)}),_0x19d024=0x0;const _0x303bf3=_0x23ba10['product_details'][_0x4d1ec1(0x12d)](_0x4fdd53=>{var _0x183ce7=_0x4d1ec1;_0x4fdd53[_0x183ce7(0x159)]==_0x4660bb[_0x183ce7(0x159)]&&_0x4fdd53[_0x183ce7(0x91)]==_0x4660bb[_0x183ce7(0x12f)]&&_0x4fdd53['type']==_0x4660bb[_0x183ce7(0xcc)]&&_0x4fdd53[_0x183ce7(0x13b)]==_0x4660bb[_0x183ce7(0xf8)]&&_0x4fdd53['bay']==_0x4660bb[_0x183ce7(0x10d)]&&_0x4fdd53['rack']==_0x4660bb[_0x183ce7(0x139)]&&_0x4fdd53['storage']==_0x4660bb['storage']&&_0x4fdd53['expiry_date']==_0x4660bb['expiry_date']&&_0x4fdd53[_0x183ce7(0xf4)]==_0x4660bb[_0x183ce7(0xf4)]&&_0x4fdd53[_0x183ce7(0x146)]==_0x4660bb[_0x183ce7(0x146)]&&_0x4fdd53[_0x183ce7(0x178)]==_0x4660bb['To_invoice']&&(_0x4fdd53[_0x183ce7(0xda)]=_0x4fdd53[_0x183ce7(0xda)]+_0x4660bb[_0x183ce7(0xa4)],_0x19d024++);});_0x19d024=='0'&&(_0x23ba10[_0x4d1ec1(0x12a)]=_0x23ba10[_0x4d1ec1(0x12a)][_0x4d1ec1(0xa0)]({'product_name':_0x4660bb['product_name'],'product_stock':_0x4660bb[_0x4d1ec1(0xa4)],'bay':_0x4660bb[_0x4d1ec1(0x10d)],'bin':_0x4660bb[_0x4d1ec1(0xf8)],'type':_0x4660bb[_0x4d1ec1(0xcc)],'floorlevel':_0x4660bb['to_floorlevel'],'storage':_0x4660bb[_0x4d1ec1(0x165)],'rack':_0x4660bb[_0x4d1ec1(0x139)],'product_code':_0x4660bb[_0x4d1ec1(0x15e)],'primary_code':_0x4660bb['primary_code'],'secondary_code':_0x4660bb[_0x4d1ec1(0xa5)],'maxProducts':_0x4660bb[_0x4d1ec1(0x176)],'storage':_0x4660bb[_0x4d1ec1(0x165)],'rack':_0x4660bb['rack'],'expiry_date':_0x4660bb[_0x4d1ec1(0x14e)],'maxPerUnit':_0x4660bb[_0x4d1ec1(0x106)],'batch_code':_0x4660bb[_0x4d1ec1(0xf4)],'production_date':_0x4660bb[_0x4d1ec1(0x146)]}));}return _0x23ba10;});Promise['all'](_0x47c477)[_0x4b59e0(0xa1)](async _0x35b20e=>{var _0x59a0c8=_0x4b59e0;try{for(const _0x35505b of _0x35b20e){await warehouse[_0x59a0c8(0x15c)]({'_id':_0x35505b[_0x59a0c8(0x13a)]},{'$addToSet':{'product_details':{'$each':_0x35505b[_0x59a0c8(0x12a)]}}});}_0x29d09f[_0x59a0c8(0x9d)]=_0x59a0c8(0xbf);const _0x517ea0=await _0x29d09f[_0x59a0c8(0xae)](),_0x38f1dc=await master_shop[_0x59a0c8(0x11e)](),_0x4e6554=await email_settings[_0x59a0c8(0xf5)](),_0x2253c0=await supervisor_settings[_0x59a0c8(0x11e)]();var _0x502704=_0x29d09f[_0x59a0c8(0x124)],_0x40ad28='',_0x182605;for(_0x182605 in _0x502704){_0x40ad28+=_0x59a0c8(0x122)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x502704[_0x182605]['product_name']+_0x59a0c8(0x145)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x502704[_0x182605][_0x59a0c8(0x15e)]+_0x59a0c8(0x145)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x502704[_0x182605][_0x59a0c8(0xa4)]+'</td>'+_0x59a0c8(0x118)+_0x502704[_0x182605][_0x59a0c8(0xad)]+_0x59a0c8(0x145)+_0x59a0c8(0x118)+_0x502704[_0x182605][_0x59a0c8(0x16d)]+_0x59a0c8(0x145)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x29d09f['to_warehouse']+_0x59a0c8(0x145)+_0x59a0c8(0x118)+_0x502704[_0x182605][_0x59a0c8(0x15b)]+_0x59a0c8(0x145)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x502704[_0x182605][_0x59a0c8(0x165)]+_0x502704[_0x182605]['rack']+_0x502704[_0x182605]['to_bay']+_0x502704[_0x182605][_0x59a0c8(0xf8)]+_0x502704[_0x182605][_0x59a0c8(0xcc)][0x0]+_0x502704[_0x182605][_0x59a0c8(0x12f)]+_0x59a0c8(0x145),_0x59a0c8(0x153);}let _0x2e9b1d=nodemailer[_0x59a0c8(0x183)]({'host':_0x4e6554['host'],'port':Number(_0x4e6554[_0x59a0c8(0xb1)]),'secure':![],'auth':{'user':_0x4e6554[_0x59a0c8(0x96)],'pass':_0x4e6554[_0x59a0c8(0x13f)]}}),_0x420c12={'from':_0x4e6554[_0x59a0c8(0x96)],'to':_0x2253c0[0x0][_0x59a0c8(0xf3)],'subject':_0x59a0c8(0xd4),'attachments':[{'filename':'Logo.png','path':__dirname+_0x59a0c8(0xaf)+_0x59a0c8(0x15d)+_0x38f1dc[0x0][_0x59a0c8(0x16f)],'cid':'logo'}],'html':_0x59a0c8(0x141)+_0x59a0c8(0xbd)+'</head><body>'+_0x59a0c8(0xa6)+_0x59a0c8(0xc1)+'<div>'+_0x59a0c8(0x109)+'</div>'+_0x59a0c8(0xa6)+'<h2>\x20'+_0x38f1dc[0x0][_0x59a0c8(0x154)]+_0x59a0c8(0x10e)+'</div>'+_0x59a0c8(0xb0)+_0x59a0c8(0x10c)+_0x59a0c8(0xa6)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x29d09f['invoice']+'\x20'+_0x59a0c8(0x128)+_0x59a0c8(0x11d)+_0x29d09f[_0x59a0c8(0x11b)]+'\x20'+_0x59a0c8(0x121)+'</h5>'+_0x59a0c8(0xb0)+_0x59a0c8(0xfc)+_0x59a0c8(0x179)+'<tr>'+_0x59a0c8(0x143)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x59a0c8(0x13d)+_0x59a0c8(0xa8)+_0x59a0c8(0x162)+_0x59a0c8(0x117)+_0x59a0c8(0xd8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x59a0c8(0x153)+_0x59a0c8(0x15a)+_0x59a0c8(0x171)+'\x20'+_0x40ad28+'\x20'+'</tbody>'+'</table>'+_0x59a0c8(0xa6)+_0x59a0c8(0xdf)+_0x59a0c8(0xef)+_0x38f1dc[0x0][_0x59a0c8(0x154)]+_0x59a0c8(0x131)+'</div>'+'</div>'+_0x59a0c8(0xc9)};_0x2e9b1d[_0x59a0c8(0xe5)](_0x420c12,function(_0x4226da,_0x5a7fec){var _0x32d432=_0x59a0c8;_0x4226da?(console['log'](_0x4226da),console[_0x32d432(0xac)](_0x32d432(0xc0))):console[_0x32d432(0xac)](_0x32d432(0x140));}),_0x5ece2a[_0x59a0c8(0xb7)](_0x59a0c8(0xc8),_0x59a0c8(0x94)),_0x4c8664['redirect']('/picking_list/PDF_transfer_rm/'+_0x517ea0[_0x59a0c8(0x13a)]);}catch(_0x2c0942){console[_0x59a0c8(0xb5)](_0x2c0942),_0x4c8664[_0x59a0c8(0xa2)](0x1f4)[_0x59a0c8(0xaa)]({'Perror':_0x59a0c8(0x108),'message':_0x2c0942[_0x59a0c8(0x9a)]});}})['catch'](_0x4e4d0=>{var _0x4b477e=_0x4b59e0;console[_0x4b477e(0xb5)](_0x4e4d0),_0x4c8664[_0x4b477e(0xa2)](0x1f4)['json']({'Perror':_0x4b477e(0x15f)});});}catch(_0x573680){_0x4c8664[_0x4b59e0(0xaa)](_0x573680);}}catch(_0x515194){console[_0x4b59e0(0xb5)](_0x515194),_0x4c8664['status'](0x1f4)[_0x4b59e0(0xaa)]({'Merror':_0x4b59e0(0x108),'Message':_0x515194[_0x4b59e0(0x9a)]});}})[_0x306e70(0xb9)](_0x46bce7=>{var _0xb901ee=_0x306e70;console[_0xb901ee(0xb5)](_0x46bce7),_0x4c8664[_0xb901ee(0xa2)](0x1f4)[_0xb901ee(0xaa)]({'Merror':_0xb901ee(0x15f)});});}catch(_0x5e0218){console['log'](_0x5e0218);}});function BayBinSelected(_0x223380,_0x4c1c56){var _0x36ca97=a0_0xd7508b,_0xe224f4=[],_0x358215=[],_0x24c798=[],_0x211775=[],_0x5070ed=[],_0x458979=[];let _0x48a13d=[];if(_0x223380=='DRY\x20STORAGE')switch(_0x4c1c56){case _0x36ca97(0x120):_0xe224f4=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x358215=[0x1,0x2],_0x211775=[0x1,0x2,0x3,0x4,0x5],_0x24c798=['Level',_0x36ca97(0x185)],_0x5070ed=['D'],_0x458979=['A'];break;case _0x36ca97(0x10b):_0xe224f4=[0x6,0x5,0x4,0x3,0x2,0x1],_0x358215=[0x1,0x2],_0x211775=[0x1,0x2,0x3,0x4,0x5],_0x24c798=[_0x36ca97(0x97),_0x36ca97(0x185)],_0x5070ed=['D'],_0x458979=['B'];break;case _0x36ca97(0x9b):_0xe224f4=[0x0],_0x358215=[0x0],_0x211775=[0x1,0x2,0x3,0x4,0x5],_0x24c798=[_0x36ca97(0x185)],_0x5070ed=['D'],_0x458979=['S'];break;case _0x36ca97(0x142):_0xe224f4=[0x0],_0x358215=[0x0],_0x211775=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x24c798=[_0x36ca97(0x185)],_0x5070ed=['D'],_0x458979=['R'];break;}else{if(_0x223380==_0x36ca97(0x9e))switch(_0x4c1c56){case'Rack\x20A':_0xe224f4=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x358215=['B','F'],_0x211775=[0x1,0x2,0x3,0x4,0x5],_0x24c798=['Level','Floor'],_0x5070ed=['C'],_0x458979=['A'];break;case _0x36ca97(0x10b):_0xe224f4=[0x5,0x4,0x3,0x2,0x1],_0x358215=['F','B','S'],_0x211775=[0x1,0x2,0x3,0x4,0x5],_0x24c798=[_0x36ca97(0x97),_0x36ca97(0x185)],_0x5070ed=['C'],_0x458979=['B'];break;case _0x36ca97(0x103):_0xe224f4=[0x1,0x2,0x3,0x4,0x5],_0x358215=['B','F','S'],_0x211775=[0x5,0x4,0x3,0x2,0x1],_0x24c798=[_0x36ca97(0x97),'Floor'],_0x5070ed=['C'],_0x458979=['C'];break;case _0x36ca97(0x11c):_0xe224f4=[0x5,0x4,0x3,0x2,0x1],_0x358215=['F','B','S'],_0x211775=[0x1,0x2,0x3,0x4,0x5],_0x24c798=['Level',_0x36ca97(0x185)],_0x5070ed=['C'],_0x458979=['D'];break;case _0x36ca97(0xf9):_0xe224f4=[0x4,0x3,0x2,0x1],_0x358215=[0x1,0x2],_0x211775=[0x1,0x2,0x3,0x4,0x5],_0x24c798=['Level','Floor'],_0x5070ed=['C'],_0x458979=['E'];break;case _0x36ca97(0xe6):_0xe224f4=[0x1,0x2,0x3],_0x358215=[0x1,0x2],_0x211775=[0x1,0x2,0x3,0x4,0x5],_0x24c798=[_0x36ca97(0x97)],_0x5070ed=['C'],_0x458979=['F'];break;}}return{'levels':_0xe224f4,'Isle':_0x358215,'rack':_0x211775,'type':_0x24c798,'storage':_0x5070ed,'rak':_0x458979};}function a0_0x2b73(_0x275b6a,_0x3e6fde){var _0x25d80b=a0_0x25d8();return a0_0x2b73=function(_0x2b7375,_0x16399b){_0x2b7375=_0x2b7375-0x91;var _0x36bdfa=_0x25d80b[_0x2b7375];return _0x36bdfa;},a0_0x2b73(_0x275b6a,_0x3e6fde);}router[a0_0xd7508b(0x137)](a0_0xd7508b(0xeb),auth,async(_0x2d7312,_0x1c6810)=>{var _0x4629a5=a0_0xd7508b;try{const {username:_0x2a55c0,email:_0x4153ed,role:_0x200e22}=_0x2d7312['user'],_0x53b542=_0x2d7312[_0x4629a5(0x181)],_0x254297=await profile[_0x4629a5(0xf5)]({'email':_0x53b542[_0x4629a5(0x96)]}),_0x1dd837=await master_shop[_0x4629a5(0x11e)](),_0x181e93=await transfers['findById'](_0x2d7312[_0x4629a5(0x17d)]['id']);let _0x1ce963;if(_0x53b542[_0x4629a5(0x172)]==_0x4629a5(0xee)){const _0x161067=await staff['findOne']({'email':_0x53b542[_0x4629a5(0x96)]});_0x1ce963=await warehouse['aggregate']([{'$match':{'status':_0x4629a5(0x114),'name':_0x161067[_0x4629a5(0x160)],'warehouse_category':_0x4629a5(0x147)}},{'$group':{'_id':'$name','name':{'$first':_0x4629a5(0x156)}}}]);}else _0x1ce963=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x4629a5(0x147)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x47e668=await warehouse[_0x4629a5(0x9f)]([{'$match':{'name':_0x181e93['from_warehouse'],'warehouse_category':_0x4629a5(0x147)}},{'$unwind':_0x4629a5(0x119)},{'$group':{'_id':_0x4629a5(0xa7),'name':{'$first':_0x4629a5(0x182)},'product_stock':{'$first':_0x4629a5(0x155)},'bay':{'$first':_0x4629a5(0xdb)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4629a5(0xc7)},'floorlevel':{'$first':_0x4629a5(0x113)},'primary_code':{'$first':_0x4629a5(0xf7)},'secondary_code':{'$first':_0x4629a5(0xb2)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4629a5(0x158)},'rack':{'$first':_0x4629a5(0xce)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x4629a5(0x111)}}}]),_0x53a973=await product[_0x4629a5(0x11e)]({}),_0x7daf99=BayBinSelected(_0x181e93[_0x4629a5(0x14f)],_0x181e93['to_room']);if(_0x1dd837[0x0][_0x4629a5(0x17c)]==_0x4629a5(0xe3)){var _0x29980b=users[_0x4629a5(0xd2)];console[_0x4629a5(0xac)](_0x29980b);}else{if(_0x1dd837[0x0][_0x4629a5(0x17c)]==_0x4629a5(0xb6))var _0x29980b=users['Hindi'];else{if(_0x1dd837[0x0][_0x4629a5(0x17c)]=='German')var _0x29980b=users['German'];else{if(_0x1dd837[0x0][_0x4629a5(0x17c)]==_0x4629a5(0x174))var _0x29980b=users[_0x4629a5(0x174)];else{if(_0x1dd837[0x0][_0x4629a5(0x17c)]=='French')var _0x29980b=users[_0x4629a5(0xcb)];else{if(_0x1dd837[0x0]['language']==_0x4629a5(0xde))var _0x29980b=users[_0x4629a5(0xab)];else{if(_0x1dd837[0x0][_0x4629a5(0x17c)]==_0x4629a5(0xc6))var _0x29980b=users['Chinese'];else{if(_0x1dd837[0x0][_0x4629a5(0x17c)]=='Arabic\x20(ae)')var _0x29980b=users[_0x4629a5(0x10f)];}}}}}}}_0x1c6810[_0x4629a5(0xca)](_0x4629a5(0x102),{'success':_0x2d7312[_0x4629a5(0xb7)](_0x4629a5(0xc8)),'errors':_0x2d7312[_0x4629a5(0xb7)](_0x4629a5(0x100)),'role':_0x53b542,'profile':_0x254297,'master_shop':_0x1dd837,'warehouse':_0x1ce963,'transfer':_0x181e93,'stock':_0x47e668,'unit':_0x53a973,'language':_0x29980b});}catch(_0x54f0f5){console[_0x4629a5(0xac)](_0x54f0f5);}}),router[a0_0xd7508b(0x151)]('/view/:id',auth,async(_0xbb5b37,_0x4409dc)=>{var _0x141435=a0_0xd7508b;try{const _0x528e8a=_0xbb5b37['params']['id'],_0x18fba0=await transfers[_0x141435(0x95)](_0x528e8a);_0x4409dc['json'](_0xbb5b37[_0x141435(0x104)]);return;const {date:_0x247878,from_warehouse:_0x5930cf,FromRoom_name:_0x47bbf8,to_warehouse:_0x23afab,ToRoom_name:_0x4d55c8,prod_name:_0x444321,from_prod_qty:_0x12acf7,from_prod_level:_0x4c3dcd,from_prod_isle:_0x3efb70,from_prod_pallet:_0x2429c7,to_prod_qty:_0x21df8f,to_prod_level:_0x4b8f90,to_prod_isle:_0x49c30e,to_prod_pallet:_0x4bbfcd,primary_code:_0x403008,secondary_code:_0x31935a,product_code3:_0x191df7,note:_0x38b0f1,invoice:_0x57cebe,expiry_date:_0x833216}=_0xbb5b37[_0x141435(0x104)];if(typeof _0x444321==_0x141435(0x16b))var _0x33f849=[_0xbb5b37[_0x141435(0x104)]['prod_name']],_0x4bbd3e=[_0xbb5b37[_0x141435(0x104)]['from_prod_qty']],_0x4ba352=[_0xbb5b37[_0x141435(0x104)][_0x141435(0x92)]],_0x1dcb4c=[_0xbb5b37[_0x141435(0x104)][_0x141435(0x144)]],_0x382e82=[_0xbb5b37[_0x141435(0x104)][_0x141435(0x152)]],_0x2d81b4=[_0xbb5b37['body'][_0x141435(0x136)]],_0x5ed472=[_0xbb5b37[_0x141435(0x104)][_0x141435(0xb8)]],_0x5ce775=[_0xbb5b37[_0x141435(0x104)][_0x141435(0xd9)]],_0x18cae5=[_0xbb5b37['body'][_0x141435(0x127)]],_0x19f1b4=[_0xbb5b37[_0x141435(0x104)][_0x141435(0xcf)]],_0x17f555=[_0xbb5b37[_0x141435(0x104)]['to_types']],_0x30510c=[_0xbb5b37[_0x141435(0x104)]['storage']],_0x2ed7e6=[_0xbb5b37[_0x141435(0x104)]['rak']],_0x5a3d57=[_0xbb5b37[_0x141435(0x104)]['primary_code']],_0x27c027=[_0xbb5b37[_0x141435(0x104)][_0x141435(0xa5)]],_0x3e5ff0=[_0xbb5b37[_0x141435(0x104)][_0x141435(0xe0)]],_0x556e94=[_0xbb5b37[_0x141435(0x104)][_0x141435(0x11a)]],_0x2df242=[_0xbb5b37[_0x141435(0x104)][_0x141435(0xad)]],_0x285efe=[_0xbb5b37['body']['secondary_unit']],_0x3000a9=[_0xbb5b37['body']['batch_code']],_0x47aac6=[_0xbb5b37[_0x141435(0x104)][_0x141435(0x14e)]],_0x2752ac=[_0xbb5b37['body'][_0x141435(0xd5)]],_0x250657=[_0xbb5b37[_0x141435(0x104)]['from_rak']];else var _0x33f849=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0x130)]],_0x30510c=[..._0xbb5b37[_0x141435(0x104)]['storage']],_0x2ed7e6=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0x16a)]],_0x2d81b4=[..._0xbb5b37[_0x141435(0x104)]['from_types']],_0x17f555=[..._0xbb5b37[_0x141435(0x104)]['to_types']],_0x4bbd3e=[..._0xbb5b37[_0x141435(0x104)]['from_prod_qty']],_0x4ba352=[..._0xbb5b37[_0x141435(0x104)]['from_prod_level']],_0x1dcb4c=[..._0xbb5b37['body']['from_prod_isle']],_0x382e82=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0x152)]],_0x5ed472=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0xb8)]],_0x5ce775=[..._0xbb5b37[_0x141435(0x104)]['to_prod_level']],_0x18cae5=[..._0xbb5b37['body'][_0x141435(0x127)]],_0x19f1b4=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0xcf)]],_0x5a3d57=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0xd0)]],_0x27c027=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0xa5)]],_0x3e5ff0=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0xe0)]],_0x556e94=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0x11a)]],_0x2df242=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0xad)]],_0x285efe=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0x16d)]],_0x3000a9=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0xf4)]],_0x47aac6=[..._0xbb5b37['body'][_0x141435(0x14e)]],_0x2752ac=[..._0xbb5b37['body']['from_storage']],_0x250657=[..._0xbb5b37[_0x141435(0x104)][_0x141435(0x13e)]];const _0x247769=_0x33f849[_0x141435(0x12d)](_0x4fb998=>{return _0x4fb998={'product_name':_0x4fb998};});_0x4bbd3e[_0x141435(0x17b)]((_0x155bf8,_0x45183e)=>{var _0x411c79=_0x141435;_0x247769[_0x45183e][_0x411c79(0x16e)]=_0x155bf8;}),_0x4ba352[_0x141435(0x17b)]((_0x287760,_0xf7a0e9)=>{var _0x2ac23f=_0x141435;_0x247769[_0xf7a0e9][_0x2ac23f(0xdd)]=_0x287760;}),_0x1dcb4c[_0x141435(0x17b)]((_0x102df0,_0x516e29)=>{var _0x4e473b=_0x141435;_0x247769[_0x516e29][_0x4e473b(0xe1)]=_0x102df0;}),_0x382e82[_0x141435(0x17b)]((_0x53dd0c,_0x5a4795)=>{var _0x2a4afa=_0x141435;_0x247769[_0x5a4795][_0x2a4afa(0x12e)]=_0x53dd0c;}),_0x5ed472[_0x141435(0x17b)]((_0x52e6cf,_0x4e40ce)=>{_0x247769[_0x4e40ce]['to_quantity']=_0x52e6cf;}),_0x5ce775[_0x141435(0x17b)]((_0xd4fdf8,_0x160df5)=>{var _0x357fd0=_0x141435;_0x247769[_0x160df5][_0x357fd0(0x10d)]=_0xd4fdf8;}),_0x18cae5[_0x141435(0x17b)]((_0x225cbe,_0x899307)=>{var _0x2d46a9=_0x141435;_0x247769[_0x899307][_0x2d46a9(0xf8)]=_0x225cbe;}),_0x19f1b4[_0x141435(0x17b)]((_0xf265b2,_0x483b41)=>{var _0x15ded4=_0x141435;_0x247769[_0x483b41][_0x15ded4(0x12f)]=_0xf265b2;}),_0x5a3d57[_0x141435(0x17b)]((_0x3cc252,_0xa0773a)=>{var _0x3daf4f=_0x141435;_0x247769[_0xa0773a][_0x3daf4f(0xd0)]=_0x3cc252;}),_0x27c027[_0x141435(0x17b)]((_0x202c79,_0x537131)=>{var _0x3466bb=_0x141435;_0x247769[_0x537131][_0x3466bb(0xa5)]=_0x202c79;}),_0x3e5ff0[_0x141435(0x17b)]((_0x5e76c2,_0x5f54be)=>{var _0x331e88=_0x141435;_0x247769[_0x5f54be][_0x331e88(0x15e)]=_0x5e76c2;}),_0x556e94[_0x141435(0x17b)]((_0x4a6c40,_0x287daa)=>{var _0xf72312=_0x141435;_0x247769[_0x287daa][_0xf72312(0x176)]=_0x4a6c40;}),_0x2df242[_0x141435(0x17b)]((_0x1a0735,_0x2a8b3b)=>{_0x247769[_0x2a8b3b]['unit']=_0x1a0735;}),_0x285efe[_0x141435(0x17b)]((_0x4555a8,_0x3fd2e5)=>{var _0x598e56=_0x141435;_0x247769[_0x3fd2e5][_0x598e56(0x16d)]=_0x4555a8;}),_0x3000a9[_0x141435(0x17b)]((_0x971c7f,_0x36cb75)=>{var _0x1690a3=_0x141435;_0x247769[_0x36cb75][_0x1690a3(0xf4)]=_0x971c7f;}),_0x47aac6[_0x141435(0x17b)]((_0x273e71,_0x3e04ab)=>{_0x247769[_0x3e04ab]['expiry_date']=_0x273e71;}),_0x30510c[_0x141435(0x17b)]((_0x5d0a3d,_0x2ae6b7)=>{_0x247769[_0x2ae6b7]['storage']=_0x5d0a3d;}),_0x2ed7e6[_0x141435(0x17b)]((_0x512bfd,_0xb8c293)=>{var _0x527bcb=_0x141435;_0x247769[_0xb8c293][_0x527bcb(0x139)]=_0x512bfd;}),_0x2d81b4[_0x141435(0x17b)]((_0x4b2e02,_0x4095e0)=>{var _0x350b92=_0x141435;_0x247769[_0x4095e0][_0x350b92(0x136)]=_0x4b2e02;}),_0x17f555[_0x141435(0x17b)]((_0x38228f,_0xac8f6f)=>{_0x247769[_0xac8f6f]['to_types']=_0x38228f;}),_0x2752ac[_0x141435(0x17b)]((_0x7273cd,_0x1f0b9a)=>{var _0x1b7550=_0x141435;_0x247769[_0x1f0b9a][_0x1b7550(0xd5)]=_0x7273cd;}),_0x250657[_0x141435(0x17b)]((_0x5b1e08,_0x234dab)=>{var _0x1a414a=_0x141435;_0x247769[_0x234dab][_0x1a414a(0x99)]=_0x5b1e08;});const _0x3d20ad=_0x247769['filter'](_0x532e18=>_0x532e18[_0x141435(0xa4)]!=='0'&&_0x532e18[_0x141435(0xa4)]!==''||_0x532e18['to_floorlevel']!=='0'&&_0x532e18[_0x141435(0x12f)]!=='');var _0x546551=0x0;_0x3d20ad[_0x141435(0x17b)](_0xfed0f3=>{var _0x24f328=_0x141435;parseInt(_0xfed0f3[_0x24f328(0x16e)])<parseInt(_0xfed0f3[_0x24f328(0xa4)])&&_0x546551++;});if(_0x546551!=0x0)return _0xbb5b37[_0x141435(0xb7)](_0x141435(0x100),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x4409dc[_0x141435(0xfe)]('back');const _0x2ec9ee=await warehouse['findOne']({'name':_0x18fba0[_0x141435(0x98)],'room':_0x18fba0[_0x141435(0xb3)]});_0x18fba0['product'][_0x141435(0x17b)](_0x1c70a1=>{var _0x185a51=_0x141435;if(_0x1c70a1[_0x185a51(0xa4)]>0x0){const _0x1be711=_0x2ec9ee[_0x185a51(0x12a)][_0x185a51(0x12d)](_0x516efd=>{var _0x5268e6=_0x185a51;_0x516efd['product_name']==_0x1c70a1[_0x5268e6(0x159)]&&_0x516efd[_0x5268e6(0x91)]==_0x1c70a1[_0x5268e6(0x12e)]&&_0x516efd[_0x5268e6(0xec)]==_0x1c70a1['from_types']&&_0x516efd[_0x5268e6(0x13b)]==_0x1c70a1[_0x5268e6(0xe1)]&&_0x516efd[_0x5268e6(0x16c)]==_0x1c70a1[_0x5268e6(0xdd)]&&_0x516efd['rack']==_0x1c70a1[_0x5268e6(0x99)]&&_0x516efd['storage']==_0x1c70a1[_0x5268e6(0xd5)]&&(_0x516efd[_0x5268e6(0xda)]=parseInt(_0x516efd[_0x5268e6(0xda)])+parseInt(_0x1c70a1[_0x5268e6(0xa4)]));});}}),await _0x2ec9ee['save']();const _0x2927b3=await warehouse[_0x141435(0xf5)]({'name':_0x18fba0[_0x141435(0x14f)],'room':_0x18fba0['to_room']});_0x18fba0['product'][_0x141435(0x17b)](_0x5c8ffd=>{var _0x5ad787=_0x141435;if(_0x5c8ffd['to_quantity']>0x0){const _0x354aa3=_0x2927b3[_0x5ad787(0x12a)][_0x5ad787(0x12d)](_0x579ce1=>{var _0x33c007=_0x5ad787;_0x579ce1[_0x33c007(0x159)]==_0x5c8ffd[_0x33c007(0x159)]&&_0x579ce1[_0x33c007(0x91)]==_0x5c8ffd[_0x33c007(0x12f)]&&_0x579ce1[_0x33c007(0xec)]==_0x5c8ffd[_0x33c007(0xcc)]&&_0x579ce1[_0x33c007(0x13b)]==_0x5c8ffd[_0x33c007(0xf8)]&&_0x579ce1[_0x33c007(0x16c)]==_0x5c8ffd[_0x33c007(0x10d)]&&_0x579ce1['rack']==_0x5c8ffd[_0x33c007(0x139)]&&_0x579ce1[_0x33c007(0x165)]==_0x5c8ffd[_0x33c007(0x165)]&&(_0x579ce1['product_stock']=parseInt(_0x579ce1[_0x33c007(0xda)])-parseInt(_0x5c8ffd[_0x33c007(0xa4)]));});}}),await _0x2927b3[_0x141435(0xae)](),_0x18fba0['date']=_0x247878,_0x18fba0['from_warehouse']=_0x5930cf,_0x18fba0[_0x141435(0x14f)]=_0x23afab,_0x18fba0[_0x141435(0x124)]=_0x3d20ad,_0x18fba0[_0x141435(0x107)]=_0x38b0f1,_0x18fba0['invoice']=_0x57cebe;const _0x4fd802=await _0x18fba0[_0x141435(0xae)]();console[_0x141435(0xac)](_0x4fd802);const _0x5a8a3f=await warehouse[_0x141435(0xf5)]({'name':_0x5930cf,'room':_0x47bbf8});_0x4fd802[_0x141435(0x124)][_0x141435(0x17b)](_0x5be6c9=>{var _0xc815da=_0x141435;if(_0x5be6c9['to_quantity']>0x0){const _0x2417cf=_0x5a8a3f['product_details'][_0xc815da(0x12d)](_0x1506e4=>{var _0x4c6ca6=_0xc815da;_0x1506e4[_0x4c6ca6(0x159)]==_0x5be6c9[_0x4c6ca6(0x159)]&&_0x1506e4['floorlevel']==_0x5be6c9[_0x4c6ca6(0x12e)]&&_0x1506e4[_0x4c6ca6(0xec)]==_0x5be6c9['from_types']&&_0x1506e4[_0x4c6ca6(0x13b)]==_0x5be6c9[_0x4c6ca6(0xe1)]&&_0x1506e4[_0x4c6ca6(0x16c)]==_0x5be6c9[_0x4c6ca6(0xdd)]&&_0x1506e4[_0x4c6ca6(0x139)]==_0x5be6c9[_0x4c6ca6(0x99)]&&_0x1506e4['storage']==_0x5be6c9[_0x4c6ca6(0xd5)]&&(_0x1506e4[_0x4c6ca6(0xda)]=parseInt(_0x1506e4[_0x4c6ca6(0xda)])-parseInt(_0x5be6c9[_0x4c6ca6(0xa4)]));});}}),await _0x5a8a3f['save']();const _0xa2e210=await warehouse[_0x141435(0xf5)]({'name':_0x23afab,'room':_0x4d55c8});_0x4fd802['product'][_0x141435(0x17b)](_0x32ac8e=>{var _0x4cf500=_0x141435;if(_0x32ac8e[_0x4cf500(0xa4)]>0x0){var _0x320a4b=0x0;const _0x456bca=_0xa2e210['product_details']['map'](_0x47d13f=>{var _0x15046a=_0x4cf500;_0x47d13f[_0x15046a(0x159)]==_0x32ac8e['product_name']&&_0x47d13f[_0x15046a(0x91)]==_0x32ac8e['to_floorlevel']&&_0x47d13f[_0x15046a(0xec)]==_0x32ac8e['to_types']&&_0x47d13f[_0x15046a(0x13b)]==_0x32ac8e[_0x15046a(0xf8)]&&_0x47d13f['bay']==_0x32ac8e['to_bay']&&_0x47d13f[_0x15046a(0x139)]==_0x32ac8e['rack']&&_0x47d13f[_0x15046a(0x165)]==_0x32ac8e[_0x15046a(0x165)]&&(_0x47d13f[_0x15046a(0xda)]=parseInt(_0x47d13f[_0x15046a(0xda)])+parseInt(_0x32ac8e[_0x15046a(0xa4)]),_0x320a4b++);});_0x320a4b=='0'&&(_0xa2e210['product_details']=_0xa2e210[_0x4cf500(0x12a)][_0x4cf500(0xa0)]({'product_name':_0x32ac8e[_0x4cf500(0x159)],'product_stock':_0x32ac8e[_0x4cf500(0xa4)],'bay':_0x32ac8e[_0x4cf500(0x10d)],'bin':_0x32ac8e[_0x4cf500(0xf8)],'type':_0x32ac8e[_0x4cf500(0xcc)],'floorlevel':_0x32ac8e[_0x4cf500(0x12f)],'storage':_0x32ac8e[_0x4cf500(0x165)],'rack':_0x32ac8e[_0x4cf500(0x139)],'product_code':_0x32ac8e[_0x4cf500(0x15e)],'primary_code':_0x32ac8e['primary_code'],'secondary_code':_0x32ac8e[_0x4cf500(0xa5)],'maxProducts':_0x32ac8e[_0x4cf500(0x176)],'storage':_0x32ac8e[_0x4cf500(0x165)],'rack':_0x32ac8e[_0x4cf500(0x139)]}));}}),await _0xa2e210[_0x141435(0xae)](),_0xbb5b37[_0x141435(0xb7)](_0x141435(0xc8),_0x141435(0xbe)),_0x4409dc[_0x141435(0xfe)](_0x141435(0x167));}catch(_0x5a3134){console[_0x141435(0xac)](_0x5a3134);}}),router['post'](a0_0xd7508b(0x148),async(_0x170c93,_0x47b7fc)=>{var _0x2622d8=a0_0xd7508b;const {FromWareHouse:_0x2d9238,FromRoom:_0x13fbc7,ToWarehouse:_0x305f3f,ToRoom:_0x1ef9ba,primary_code:_0x2ca560,Roomslist:_0x263521}=_0x170c93[_0x2622d8(0x104)],_0x5cae08=_0x263521[_0x2622d8(0x14c)](','),_0x4dd81c=[];async function _0x2cd054(_0x14ad8a){var _0x2b8977=_0x2622d8;const _0x2d95c6=await warehouse[_0x2b8977(0x9f)]([{'$match':{'name':_0x2d9238,'room':_0x14ad8a}},{'$unwind':_0x2b8977(0x119)},{'$match':{'product_details.primary_code':_0x2ca560}},{'$group':{'_id':_0x2b8977(0xa7),'name':{'$first':_0x2b8977(0x182)},'instock':{'$first':_0x2b8977(0x155)},'primary_code':{'$first':_0x2b8977(0xf7)},'secondary_code':{'$first':_0x2b8977(0xb2)},'product_code':{'$first':_0x2b8977(0xfb)},'level':{'$first':_0x2b8977(0xdb)},'isle':{'$first':_0x2b8977(0x10a)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2b8977(0x113)},'unit':{'$first':_0x2b8977(0x132)},'secondary_unit':{'$first':_0x2b8977(0x161)},'storage':{'$first':_0x2b8977(0x158)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2b8977(0x123)},'production_date':{'$first':_0x2b8977(0xff)},'batch_code':{'$first':_0x2b8977(0xed)},'maxPerUnit':{'$first':_0x2b8977(0x9c)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x2b8977(0x111)},'maxProducts':{'$first':_0x2b8977(0xe7)},'invoice_product':{'$first':_0x2b8977(0x101)}}}]),_0x25b721=await warehouse[_0x2b8977(0x9f)]([{'$match':{'name':_0x2d9238,'room':_0x14ad8a}},{'$unwind':_0x2b8977(0x119)},{'$match':{'product_details.secondary_code':_0x2ca560}},{'$group':{'_id':_0x2b8977(0xa7),'name':{'$first':_0x2b8977(0x182)},'instock':{'$first':_0x2b8977(0x155)},'primary_code':{'$first':_0x2b8977(0xf7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2b8977(0xfb)},'level':{'$first':_0x2b8977(0xdb)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2b8977(0x113)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2b8977(0x161)},'storage':{'$first':_0x2b8977(0x158)},'rack':{'$first':_0x2b8977(0xce)},'expiry_date':{'$first':_0x2b8977(0x123)},'production_date':{'$first':_0x2b8977(0xff)},'batch_code':{'$first':_0x2b8977(0xed)},'maxPerUnit':{'$first':_0x2b8977(0x9c)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x2b8977(0x111)},'maxProducts':{'$first':_0x2b8977(0xe7)},'invoice_product':{'$first':'$product_details.invoice'}}}]);if(_0x2d95c6[_0x2b8977(0xf0)]>0x0)_0x4dd81c[_0x2b8977(0xf2)](_0x2d95c6);else _0x25b721['length']>0x0&&_0x4dd81c[_0x2b8977(0xf2)](_0x25b721);}const _0x36db1c=_0x5cae08[_0x2622d8(0x12d)](_0x488906=>_0x2cd054(_0x488906));await Promise[_0x2622d8(0xdc)](_0x36db1c),_0x47b7fc[_0x2622d8(0xaa)](_0x4dd81c);}),router[a0_0xd7508b(0x151)](a0_0xd7508b(0x138),async(_0x5c4cf7,_0x3d2999)=>{var _0x3a8089=a0_0xd7508b;try{const {FromWareHouse:_0xdbda37,FromRoom:_0x411b3e,ToWarehouse:_0x18295e,ToRoom:_0x2eb466,secondary_code:_0x2fcf31}=_0x5c4cf7['body'],_0x3d8ef9=await warehouse['aggregate']([{'$match':{'name':_0xdbda37}},{'$unwind':_0x3a8089(0x119)},{'$match':{'product_details.secondary_code':_0x2fcf31}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3a8089(0x182)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3a8089(0xb2)},'product_code':{'$first':_0x3a8089(0xfb)},'instock':{'$first':_0x3a8089(0x155)},'warehouse':{'$first':_0x3a8089(0x156)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x3a8089(0x126)},'pallet':{'$first':_0x3a8089(0x173)},'maxProducts':{'$first':_0x3a8089(0xe7)},'unit':{'$first':_0x3a8089(0x132)}}}]);_0x3d2999[_0x3a8089(0xa2)](0xc8)[_0x3a8089(0xaa)](_0x3d8ef9);}catch(_0x297a80){_0x3d2999[_0x3a8089(0xa2)](0x194)['json']({'message':_0x297a80[_0x3a8089(0x9a)]});}}),router[a0_0xd7508b(0x151)]('/barcode_scanner3',async(_0xbcbfdf,_0x57cbc5)=>{var _0x3eb0be=a0_0xd7508b;try{const {FromWareHouse:_0x33562e,FromRoom:_0x566643,ToWarehouse:_0x3c9a3e,ToRoom:_0x2c5bb1,product_code:_0x36409b}=_0xbcbfdf[_0x3eb0be(0x104)],_0x396132=await warehouse[_0x3eb0be(0x9f)]([{'$match':{'name':_0x33562e}},{'$unwind':_0x3eb0be(0x119)},{'$match':{'product_details.product_code':_0x36409b}},{'$group':{'_id':_0x3eb0be(0xa7),'name':{'$first':_0x3eb0be(0x182)},'primary_code':{'$first':_0x3eb0be(0xf7)},'secondary_code':{'$first':_0x3eb0be(0xb2)},'product_code':{'$first':_0x3eb0be(0xfb)},'instock':{'$first':_0x3eb0be(0x155)},'warehouse':{'$first':'$name'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x3eb0be(0x126)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x3eb0be(0xe7)},'unit':{'$first':_0x3eb0be(0x132)}}}]);_0x57cbc5[_0x3eb0be(0xa2)](0xc8)[_0x3eb0be(0xaa)](_0x396132);}catch(_0x547418){_0x57cbc5[_0x3eb0be(0xa2)](0x194)[_0x3eb0be(0xaa)]({'message':_0x547418['message']});}}),router[a0_0xd7508b(0x151)](a0_0xd7508b(0xf1),async(_0x46ef9c,_0x4a618d)=>{var _0xefa291=a0_0xd7508b;const {level:_0x409748,isle:_0x474486,pallet:_0x31abbc,warehouses:_0xad49ba,room:_0x20dde9}=_0x46ef9c['body'];try{const _0x4e803f=await warehouse[_0xefa291(0x9f)]([{'$match':{'name':_0xad49ba,'room':_0x20dde9}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x409748),'product_details.isle':_0x474486,'product_details.pallet':parseInt(_0x31abbc)}},{'$group':{'_id':_0xefa291(0xa7),'name':{'$first':_0xefa291(0x182)},'product_stock':{'$first':_0xefa291(0x155)},'level':{'$first':_0xefa291(0xc2)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0xefa291(0xe7)}}}]);_0x4a618d[_0xefa291(0xa2)](0xc8)['json'](_0x4e803f);}catch(_0x247c5a){_0x4a618d['status'](0x194)[_0xefa291(0xaa)]({'message':_0x247c5a['message']});}}),module[a0_0xd7508b(0x129)]=router;function a0_0x25d8(){var _0x50ab9c=['$product.from_room_name','Rack\x20A','</span>','<tr>','$product_details.expiry_date','product','/preview/:id','$product_details.isle','to_prod_isle','<span\x20style=\x22float:\x20right;\x22>','exports','product_details','nodemailer','transfer','map','from_floorlevel','to_floorlevel','prod_name','</h5>','$product_details.unit','German','from_room_name','Router','from_types','get','/barcode_scanner2','rack','_id','bin','3030590eUIEIB','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','from_rak','password','Email\x20sent\x20successfully','<!DOCTYPE\x20html>','Receiving\x20Area','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_prod_isle','</td>','production_date','Raw\x20Materials','/barcode_scanner','express','New_Qty_Converted','Arabic\x20(ae)','split','master','expiry_date','to_warehouse','filter','post','from_prod_pallet','</tr>','site_title','$product_details.product_stock','$name','floor','$product_details.storage','product_name','</thead>','to_room_name','updateOne','/upload/','product_code','An\x20error\x20occurred.','warehouse','$product_details.secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','1240506aKTHiu','ToRoomAssigned','storage','/view/add_transfer','/transfer/view','36004vZGwIa','$invoice','rak','string','bay','secondary_unit','from_quantity','image','1697129khQjtX','<tbody\x20style=\x22text-align:\x20center;\x22>','role','$product_details.pallet','Spanish','from_invoice','maxProducts','to_invoice','invoice','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/view','forEach','language','params','206882qaLIIe','getDate','/transfer/preview/','user','$product_details.product_name','createTransport','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Floor','floorlevel','from_prod_level','max_per_unit','Transfer\x20Finalize\x20Successfully','findById','email','Level','from_warehouse','from_rack','message','Shelves','$product_details.maxPerUnit','finalize','COLD\x20STORAGE','aggregate','concat','then','status','$from_warehouse','to_quantity','secondary_code','<div>','$product_details._id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Product\x20Transfer\x20successfully','json','Portuguese','log','unit','save','/../public','</div>','port','$product_details.secondary_code','from_room','Return\x20Rooms','error','Hindi','flash','to_prod_qty','catch','$date','prod_cat','RoomAssigned','<html><head><title></title>','Transfer\x20Edit\x20Successfully','True','Error\x20Occurs','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.level','15xhBOwB','$product.to_room_name','padStart','Chinese','$product_details.type','success','</body></html>','render','French','to_types','\x20<>\x20','$product_details.rack','to_prod_pallet','primary_code','TRF-','English','random','Transfer\x20Mail','from_storage','18xgFpLr','add_transfer','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','to_prod_level','product_stock','$product_details.bay','all','from_bay','Portuguese\x20(BR)','<strong>\x20Regards\x20</strong>','product_code3','from_bin','here','English\x20(US)','$to_warehouse','sendMail','Rack\x20F','$product_details.maxProducts','8pGwkrK','146911mNsfpT','slice','/view/:id','type','$product_details.batch_code','staff','<h5>','length','/CheckingWarehouse','push','RMSEmail','batch_code','findOne','To_invoice','$product_details.primary_code','to_bin','Rack\x20E','getFullYear','$product_details.product_code','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product','redirect','$product_details.production_date','errors','$product_details.invoice','edit_transfer','Rack\x20C','body','906657GyOxHX','maxperunit','note','An\x20error\x20occurred\x20while\x20saving\x20data.','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.bin','Rack\x20B','<hr\x20class=\x22my-3\x22>','to_bay','\x20</h2>','Arabic','id_transaction','$room','from_prod_qty','$product_details.floorlevel','Enabled','primary_unit','$finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details','MaxStocks_data2','date','Rack\x20D','\x20Order\x20Date\x20:\x20','find'];a0_0x25d8=function(){return _0x50ab9c;};return a0_0x25d8();}