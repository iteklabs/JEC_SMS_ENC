var a0_0x31bc84=a0_0x2372;(function(_0x3662a2,_0xc332cc){var _0x28786d=a0_0x2372,_0x16fee7=_0x3662a2();while(!![]){try{var _0x1fea04=-parseInt(_0x28786d(0x13f))/0x1*(-parseInt(_0x28786d(0x16d))/0x2)+parseInt(_0x28786d(0x199))/0x3+parseInt(_0x28786d(0x1ba))/0x4+parseInt(_0x28786d(0xed))/0x5+-parseInt(_0x28786d(0x157))/0x6+parseInt(_0x28786d(0x1c5))/0x7*(parseInt(_0x28786d(0x188))/0x8)+-parseInt(_0x28786d(0xf9))/0x9;if(_0x1fea04===_0xc332cc)break;else _0x16fee7['push'](_0x16fee7['shift']());}catch(_0x2e15fb){_0x16fee7['push'](_0x16fee7['shift']());}}}(a0_0x4eef,0xb21e4));function a0_0x2372(_0x54d4c4,_0x513be6){var _0x4eef21=a0_0x4eef();return a0_0x2372=function(_0x237256,_0xb0102b){_0x237256=_0x237256-0xe9;var _0x171e7e=_0x4eef21[_0x237256];return _0x171e7e;},a0_0x2372(_0x54d4c4,_0x513be6);}const express=require('express'),app=express(),router=express[a0_0x31bc84(0x185)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x31bc84(0x15d)),auth=require(a0_0x31bc84(0x1b9)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x31bc84(0x12c));router['get'](a0_0x31bc84(0x102),auth,async(_0x284284,_0x44346e)=>{var _0x8c028=a0_0x31bc84;try{const {username:_0x257656,email:_0x11c083,role:_0x33cf14}=_0x284284['user'],_0xc5f3ee=_0x284284[_0x8c028(0x1c3)],_0x485e95=await profile[_0x8c028(0x143)]({'email':_0xc5f3ee[_0x8c028(0x1a8)]}),_0x3a695e=await master_shop['find']();console[_0x8c028(0xfd)](_0x8c028(0x119),_0x3a695e);let _0x179323;if(_0xc5f3ee[_0x8c028(0x13c)]==_0x8c028(0x1c0)){const _0x51d650=await staff[_0x8c028(0x143)]({'email':_0xc5f3ee['email']});_0x179323=await transfers[_0x8c028(0x1d0)]({'from_warehouse':_0x51d650[_0x8c028(0x1bf)]});}else _0x179323=await transfers[_0x8c028(0x16b)]([{'$unwind':_0x8c028(0xf8)},{'$group':{'_id':_0x8c028(0x1c7),'invoice':{'$first':_0x8c028(0x14d)},'date':{'$first':_0x8c028(0x1b8)},'from_warehouse':{'$first':_0x8c028(0x101)},'to_warehouse':{'$first':_0x8c028(0x198)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x8c028(0x18b)},'finalize':{'$first':_0x8c028(0x14c)},'isAllowEdit':{'$first':_0x8c028(0x10b)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3a695e[0x0][_0x8c028(0x14f)]=='English\x20(US)'){var _0x1980c9=users[_0x8c028(0x1cf)];console[_0x8c028(0xfd)](_0x1980c9);}else{if(_0x3a695e[0x0][_0x8c028(0x14f)]==_0x8c028(0x131))var _0x1980c9=users[_0x8c028(0x131)];else{if(_0x3a695e[0x0][_0x8c028(0x14f)]==_0x8c028(0x11b))var _0x1980c9=users[_0x8c028(0x11b)];else{if(_0x3a695e[0x0][_0x8c028(0x14f)]==_0x8c028(0x1b1))var _0x1980c9=users[_0x8c028(0x1b1)];else{if(_0x3a695e[0x0][_0x8c028(0x14f)]==_0x8c028(0x126))var _0x1980c9=users[_0x8c028(0x126)];else{if(_0x3a695e[0x0][_0x8c028(0x14f)]=='Portuguese\x20(BR)')var _0x1980c9=users['Portuguese'];else{if(_0x3a695e[0x0][_0x8c028(0x14f)]==_0x8c028(0x187))var _0x1980c9=users[_0x8c028(0x187)];else{if(_0x3a695e[0x0][_0x8c028(0x14f)]==_0x8c028(0x19d))var _0x1980c9=users[_0x8c028(0x103)];}}}}}}}_0x44346e[_0x8c028(0x1b4)](_0x8c028(0x168),{'success':_0x284284[_0x8c028(0x1b6)]('success'),'errors':_0x284284[_0x8c028(0x1b6)]('errors'),'role':_0xc5f3ee,'profile':_0x485e95,'master_shop':_0x3a695e,'transfer':_0x179323,'language':_0x1980c9});}catch(_0x5ec90b){console[_0x8c028(0xfd)](_0x5ec90b);}});function a0_0x4eef(){var _0x3369c0=['render','production_date','flash','Portuguese\x20(BR)','$date','../middleware/auth','519508CuZzLD','Rack\x20A','logo','then','floorlevel','warehouse','staff','site_title','expiry_date','user','<span\x20style=\x22float:\x20right;\x22>','161CjDGZB','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$_id','to_types','id_transaction','catch','maxProducts','$product_details.secondary_code','/view/add_transfer','Rack\x20C','English','find','$product_details.rack','edit_transfer_view','$product_details.floorlevel','port','exports','/../public','$product_details.level','post','$name','<h5\x20style=\x22text-align:\x20left;\x22>','finalize','Rack\x20E','</span>','from_quantity','5074520ZieCBU','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','message','<strong>\x20Regards\x20</strong>','DRY\x20STORAGE','Return\x20Rooms','invoice','from_prod_pallet','product_name','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','findById','$product','27507141oRdiRf','An\x20error\x20occurred.','to_bay','to_quantity','log','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Floor','concat','$from_warehouse','/view','Arabic','length','Email\x20sent\x20successfully','$product_details.batch_code','error','random','back','from_prod_qty','$isAllowEdit','TRF-','Enclosed','save','date','redirect','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','\x20Order\x20Date\x20:\x20','</tbody>','Transfer\x20Mail','product_details','$product_details.bin','getMonth','json','master','English\x20(US)','German','Product\x20Transfer\x20successfully','Raw\x20Materials','$product_details.bay','MaxStocks_data2','product_stock','$product_details.storage','<div>','to_bin','New_Qty_Converted','here','French','/preview/:id','</head><body>','/barcode_scanner2','image','batch_code','nodemailer','floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','from_prod_level','from_storage','Hindi','push','forEach','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','type','/transfer/preview/','to_floorlevel','/view/:id','prod_cat','role','rack','An\x20error\x20occurred\x20while\x20saving\x20data.','210TvQuen','from_room_name','$product_details.maxProducts','get','findOne','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','primary_unit','_id','Rack\x20B','to_prod_level','from_bin','$product_details.maxPerUnit','<h5>','$finalize','$invoice','$product_details.product_name','language','storage','maxperunit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','getFullYear','/CheckingWarehouse','$product_details.isle','note','526092dHsRTh','Enabled','$product_details.unit','/barcode_scanner3','\x20Order\x20Number\x20:\x20','True','../models/all_models','from_warehouse','id_transaction_id','from_floorlevel','\x20<>\x20','$product_details.product_stock','from_rak','to_prod_qty','primary_code','<table\x20style=\x22width:\x20100%\x20!important;\x22>','bin','transfer','$product_details.primary_code','to_warehouse','aggregate','prod_name','13198jJhceC','<tr>','</div>','createTransport','COLD\x20STORAGE','</tr>','product_code3','to_prod_isle','from_prod_isle','Shelves','/upload/','unit','to_room_name','bay','$product_details._id','to_invoice','$product_details.invoice','body','password','$product_details.pallet','secondary_unit','$product_details.type','success','RMSEmail','Router','Receiving\x20Area','Chinese','454904BCHeqN','status','$product_details.production_date','$product.to_room_name','To_invoice','</h5>','all','from_bay','from_rack','to_room','$product_details.product_code','ToRoomAssigned','slice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</body></html>','Logo.png','$to_warehouse','105549vrcvgX','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','map','<tbody\x20style=\x22text-align:\x20center;\x22>','Arabic\x20(ae)','max_per_unit','secondary_code','split','Error\x20Occurs','errors','$product_details.expiry_date','string','edit_transfer','from_types','params','email','filter','/barcode_scanner','</td>','RoomAssigned','Level','product','$room','$product_details.secondary_unit','Spanish','product_code','from_invoice'];a0_0x4eef=function(){return _0x3369c0;};return a0_0x4eef();}async function getRandom8DigitNumber(){var _0x2450ab=a0_0x31bc84;const _0x1a283d=0x989680,_0x563314=0x5f5e0ff,_0x1c4399=Math[_0x2450ab(0x12d)](Math[_0x2450ab(0x108)]()*(_0x563314-_0x1a283d+0x1))+_0x1a283d;var _0xd1262e;const _0x420d7c=await transfers[_0x2450ab(0x143)]({'invoice':_0x2450ab(0x10c)+_0x1c4399});return _0x420d7c&&_0x420d7c[_0x2450ab(0x104)]>0x0?_0xd1262e=_0x2450ab(0x10c)+_0x1c4399:_0xd1262e=_0x2450ab(0x10c)+_0x1c4399,_0xd1262e;}router[a0_0x31bc84(0x142)](a0_0x31bc84(0x1cd),auth,async(_0x3dddb0,_0x596b3b)=>{var _0x41ec84=a0_0x31bc84;try{const {username:_0x470b23,email:_0x42df95,role:_0xbe760a}=_0x3dddb0['user'],_0x7159e3=_0x3dddb0[_0x41ec84(0x1c3)],_0x6087b5=await profile[_0x41ec84(0x143)]({'email':_0x7159e3['email']}),_0x1ba762=await master_shop[_0x41ec84(0x1d0)]();console[_0x41ec84(0xfd)](_0x41ec84(0x119),_0x1ba762);let _0x4d561b;if(_0x7159e3['role']==_0x41ec84(0x1c0)){const _0x3bab27=await staff[_0x41ec84(0x143)]({'email':_0x7159e3[_0x41ec84(0x1a8)]});_0x4d561b=await warehouse[_0x41ec84(0x16b)]([{'$match':{'status':_0x41ec84(0x158),'name':_0x3bab27[_0x41ec84(0x1bf)],'warehouse_category':_0x41ec84(0x11d)}},{'$group':{'_id':_0x41ec84(0x1d9),'name':{'$first':_0x41ec84(0x1d9)}}}]);}else _0x4d561b=await warehouse['aggregate']([{'$match':{'status':_0x41ec84(0x158),'warehouse_category':_0x41ec84(0x11d)}},{'$group':{'_id':_0x41ec84(0x1d9),'name':{'$first':'$name'}}}]);var _0x31451e=['Ambient',_0x41ec84(0x10d),_0x41ec84(0xf2)];const _0x350786=await transfers[_0x41ec84(0x1d0)]({}),_0x25b0cd=_0x350786['length']+0x1,_0x2fc260=_0x41ec84(0x10c)+_0x25b0cd['toString']()['padStart'](0x5,'0');if(_0x1ba762[0x0][_0x41ec84(0x14f)]=='English\x20(US)'){var _0x26c198=users[_0x41ec84(0x1cf)];console[_0x41ec84(0xfd)](_0x26c198);}else{if(_0x1ba762[0x0][_0x41ec84(0x14f)]==_0x41ec84(0x131))var _0x26c198=users[_0x41ec84(0x131)];else{if(_0x1ba762[0x0][_0x41ec84(0x14f)]==_0x41ec84(0x11b))var _0x26c198=users[_0x41ec84(0x11b)];else{if(_0x1ba762[0x0][_0x41ec84(0x14f)]==_0x41ec84(0x1b1))var _0x26c198=users[_0x41ec84(0x1b1)];else{if(_0x1ba762[0x0][_0x41ec84(0x14f)]==_0x41ec84(0x126))var _0x26c198=users[_0x41ec84(0x126)];else{if(_0x1ba762[0x0][_0x41ec84(0x14f)]==_0x41ec84(0x1b7))var _0x26c198=users['Portuguese'];else{if(_0x1ba762[0x0][_0x41ec84(0x14f)]=='Chinese')var _0x26c198=users[_0x41ec84(0x187)];else{if(_0x1ba762[0x0][_0x41ec84(0x14f)]==_0x41ec84(0x19d))var _0x26c198=users[_0x41ec84(0x103)];}}}}}}}const _0xa10a6c=getRandom8DigitNumber();_0xa10a6c[_0x41ec84(0x1bd)](_0x1e7e7e=>{var _0x3fb0f0=_0x41ec84;_0x596b3b[_0x3fb0f0(0x1b4)]('add_transfer',{'success':_0x3dddb0[_0x3fb0f0(0x1b6)]('success'),'errors':_0x3dddb0['flash'](_0x3fb0f0(0x1a2)),'role':_0x7159e3,'profile':_0x6087b5,'master_shop':_0x1ba762,'warehouse':_0x4d561b,'language':_0x26c198,'rooms_data':_0x31451e,'invoice':_0x1e7e7e});})[_0x41ec84(0x1ca)](_0xf00a50=>{var _0x1d59dc=_0x41ec84;_0x3dddb0[_0x1d59dc(0x1b6)](_0x1d59dc(0x1a2),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x596b3b['redirect']('/transfer/view');});}catch(_0x2faa0a){console[_0x41ec84(0xfd)](_0x2faa0a);}}),router[a0_0x31bc84(0x1d8)](a0_0x31bc84(0x1cd),auth,async(_0x80743f,_0x926fd8)=>{var _0x18f61a=a0_0x31bc84;try{console[_0x18f61a(0xfd)](_0x80743f['body']);const {date:_0x57bfeb,from_warehouse:_0x14e1da,FromRoom_name:_0x1d01ca,to_warehouse:_0x1cdea7,ToRoom_name:_0x3dcd31,prod_name:_0x280897,from_prod_qty:_0xa54f00,from_prod_level:_0x2a8618,from_prod_isle:_0x2c5c7d,from_prod_pallet:_0x28f337,to_prod_qty:_0x3dc30c,to_prod_level:_0x3f16f6,to_prod_isle:_0x5db000,to_prod_pallet:_0x1a8b24,primary_code:_0x1ca0fd,secondary_code:_0x423666,product_code3:_0x20aa4c,note:_0x34ee16,MaxStocks_data2:_0x304f86,invoice:_0x4ec776,expiry_date:_0x40a3b5}=_0x80743f[_0x18f61a(0x17e)];if(typeof _0x280897==_0x18f61a(0x1a4))var _0x5afdae=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x16c)]],_0x2e240f=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x10a)]],_0x3022f7=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x12f)]],_0x56da65=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x124)]],_0x1ab08b=[_0x80743f['body'][_0x18f61a(0x148)]],_0x3d4626=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x165)]],_0x82724d=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x19f)]],_0x140504=[_0x80743f[_0x18f61a(0x17e)]['product_code3']],_0x3f67c7=[_0x80743f['body']['MaxStocks_data2']],_0x3bfff3=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x145)]],_0x343408=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x181)]],_0xe181fe=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x12b)]],_0x63dba0=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x1c2)]],_0x558e86=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x19e)]],_0x5ddf65=[_0x80743f['body']['production_date']],_0x1fe815=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x13b)]],_0x4414f5=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x1ac)]],_0x24ba58=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x193)]],_0x5894f4=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x1b3)]],_0x21ba5f=[_0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x17c)]],_0x3d60f3=[_0x80743f['body'][_0x18f61a(0x1c9)]];else var _0x5afdae=[..._0x80743f['body'][_0x18f61a(0x16c)]],_0x2e240f=[..._0x80743f[_0x18f61a(0x17e)]['from_prod_qty']],_0x3022f7=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x12f)]],_0x56da65=[..._0x80743f['body'][_0x18f61a(0x124)]],_0x1ab08b=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x148)]],_0x3d4626=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x165)]],_0x82724d=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x19f)]],_0x140504=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x173)]],_0x3f67c7=[..._0x80743f[_0x18f61a(0x17e)]['MaxStocks_data2']],_0x3bfff3=[..._0x80743f['body'][_0x18f61a(0x145)]],_0x343408=[..._0x80743f[_0x18f61a(0x17e)]['secondary_unit']],_0xe181fe=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x12b)]],_0x63dba0=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x1c2)]],_0x558e86=[..._0x80743f['body'][_0x18f61a(0x19e)]],_0x5ddf65=[..._0x80743f[_0x18f61a(0x17e)]['production_date']],_0x1fe815=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x13b)]],_0x4414f5=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x1ac)]],_0x24ba58=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x193)]],_0x5894f4=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x1b3)]],_0x21ba5f=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x17c)]],_0x3d60f3=[..._0x80743f[_0x18f61a(0x17e)][_0x18f61a(0x1c9)]];const _0x42e6e1=_0x5afdae[_0x18f61a(0x19b)](_0x2c69ff=>{return _0x2c69ff={'product_name':_0x2c69ff};});_0x2e240f[_0x18f61a(0x133)]((_0xc980a7,_0x1bee69)=>{var _0x4fa852=_0x18f61a;_0x42e6e1[_0x1bee69][_0x4fa852(0xec)]=_0xc980a7;}),_0x5894f4[_0x18f61a(0x133)]((_0x215cee,_0xa0f463)=>{_0x42e6e1[_0xa0f463]['from_invoice']=_0x215cee;}),_0x21ba5f['forEach']((_0x5a767c,_0x557b66)=>{var _0x316ea9=_0x18f61a;_0x42e6e1[_0x557b66][_0x316ea9(0x18c)]=_0x5a767c;}),_0x3d60f3['forEach']((_0x48af27,_0x32d729)=>{var _0x19fedc=_0x18f61a;_0x42e6e1[_0x32d729][_0x19fedc(0x15f)]=_0x48af27;}),_0x3022f7['forEach']((_0x2266c6,_0x500c3c)=>{_0x4414f5['forEach']((_0x5a8571,_0x3a1896)=>{var _0x144924=a0_0x2372;if(_0x5a8571==_0x144924(0x186)&&_0x500c3c==_0x3a1896){var _0x35eef7=_0x2266c6[_0x144924(0x194)](0x3);_0x42e6e1[_0x500c3c][_0x144924(0x130)]=_0x2266c6[0x0],_0x42e6e1[_0x500c3c]['from_rack']=_0x2266c6[0x1],_0x42e6e1[_0x500c3c][_0x144924(0x18f)]=0x0,_0x42e6e1[_0x500c3c]['from_bin']=0x0,_0x42e6e1[_0x500c3c][_0x144924(0x1a6)]=_0x144924(0xff),_0x42e6e1[_0x500c3c][_0x144924(0x160)]=_0x35eef7;}else{if(_0x5a8571==_0x144924(0x176)&&_0x500c3c==_0x3a1896){var _0x35eef7=_0x2266c6[_0x144924(0x194)](0x3);_0x42e6e1[_0x500c3c][_0x144924(0x130)]=_0x2266c6[0x0],_0x42e6e1[_0x500c3c]['from_rack']=_0x2266c6[0x1],_0x42e6e1[_0x500c3c][_0x144924(0x18f)]=0x0,_0x42e6e1[_0x500c3c]['from_bin']=0x0,_0x42e6e1[_0x500c3c][_0x144924(0x1a6)]=_0x144924(0xff),_0x42e6e1[_0x500c3c]['from_floorlevel']=_0x2266c6[0x5];}else{if(_0x500c3c==_0x3a1896){if(_0x2266c6[0x0]=='A'&&_0x2266c6[0x1]=='L'&&_0x2266c6[0x2]=='L')console['log'](_0x5a8571+_0x144924(0x161)+_0x500c3c+_0x144924(0x161)+_0x3a1896+_0x144924(0x161)+_0x2266c6+_0x144924(0x125)),_0x42e6e1[_0x500c3c][_0x144924(0x130)]=_0x2266c6[0x0],_0x42e6e1[_0x500c3c]['from_rack']=_0x2266c6[0x1],_0x42e6e1[_0x500c3c][_0x144924(0x18f)]=0x0,_0x42e6e1[_0x500c3c][_0x144924(0x149)]=0x0,_0x42e6e1[_0x500c3c]['from_types']=_0x144924(0xff),_0x42e6e1[_0x500c3c][_0x144924(0x160)]=_0x2266c6[0x3];else{var _0x314de4;if(_0x2266c6[0x4]=='L')_0x314de4=_0x144924(0x1ad);else _0x2266c6[0x4]=='F'&&(_0x314de4=_0x144924(0xff));_0x42e6e1[_0x500c3c]['from_storage']=_0x2266c6[0x0],_0x42e6e1[_0x500c3c]['from_rack']=_0x2266c6[0x1],_0x42e6e1[_0x500c3c][_0x144924(0x18f)]=_0x2266c6[0x2],_0x42e6e1[_0x500c3c]['from_bin']=_0x2266c6[0x3],_0x42e6e1[_0x500c3c]['from_types']=_0x314de4,_0x42e6e1[_0x500c3c][_0x144924(0x160)]=_0x2266c6[0x5];}}}}});}),_0x56da65['forEach']((_0x109933,_0x4094c2)=>{var _0x230717=_0x18f61a;_0x42e6e1[_0x4094c2][_0x230717(0xfc)]=_0x109933;}),_0x1ab08b[_0x18f61a(0x133)]((_0x512a55,_0x366638)=>{var _0x20b96e=_0x18f61a;_0x24ba58[_0x20b96e(0x133)]((_0x5444d3,_0xdac784)=>{var _0x57863e=_0x20b96e;if(_0x5444d3==_0x57863e(0x186)&&_0x366638==_0xdac784){var _0x128736=_0x512a55[_0x57863e(0x194)](0x3);_0x42e6e1[_0x366638][_0x57863e(0x150)]=_0x512a55[0x0],_0x42e6e1[_0x366638][_0x57863e(0x13d)]=_0x512a55[0x1],_0x42e6e1[_0x366638][_0x57863e(0xfb)]=0x0,_0x42e6e1[_0x366638][_0x57863e(0x123)]=0x0,_0x42e6e1[_0x366638][_0x57863e(0x1c8)]='Floor',_0x42e6e1[_0x366638][_0x57863e(0x139)]=_0x128736;}else{if(_0x5444d3==_0x57863e(0x176)&&_0x366638==_0xdac784){var _0x128736=_0x512a55[_0x57863e(0x194)](0x3);_0x42e6e1[_0x366638][_0x57863e(0x150)]=_0x512a55[0x0],_0x42e6e1[_0x366638]['rack']=_0x512a55[0x1],_0x42e6e1[_0x366638][_0x57863e(0xfb)]=0x0,_0x42e6e1[_0x366638][_0x57863e(0x123)]=0x0,_0x42e6e1[_0x366638][_0x57863e(0x1c8)]=_0x57863e(0xff),_0x42e6e1[_0x366638]['to_floorlevel']=_0x512a55[0x5];}else{if(_0x366638==_0xdac784){if(_0x512a55[0x0]=='A'&&_0x512a55[0x1]=='L'&&_0x512a55[0x2]=='L')console[_0x57863e(0xfd)](_0x5444d3+_0x57863e(0x161)+_0x366638+'\x20<>\x20'+_0xdac784+_0x57863e(0x161)+_0x512a55+'here'),_0x42e6e1[_0x366638][_0x57863e(0x150)]=_0x512a55[0x0],_0x42e6e1[_0x366638]['rack']=_0x512a55[0x1],_0x42e6e1[_0x366638][_0x57863e(0xfb)]=0x0,_0x42e6e1[_0x366638][_0x57863e(0x123)]=0x0,_0x42e6e1[_0x366638][_0x57863e(0x1c8)]=_0x57863e(0xff),_0x42e6e1[_0x366638]['to_floorlevel']=_0x512a55[0x3];else{var _0x423bd9;if(_0x512a55[0x4]=='L')_0x423bd9=_0x57863e(0x1ad);else _0x512a55[0x4]=='F'&&(_0x423bd9=_0x57863e(0xff));_0x42e6e1[_0x366638][_0x57863e(0x150)]=_0x512a55[0x0],_0x42e6e1[_0x366638][_0x57863e(0x13d)]=_0x512a55[0x1],_0x42e6e1[_0x366638][_0x57863e(0xfb)]=_0x512a55[0x2],_0x42e6e1[_0x366638][_0x57863e(0x123)]=_0x512a55[0x3],_0x42e6e1[_0x366638]['to_types']=_0x423bd9,_0x42e6e1[_0x366638][_0x57863e(0x139)]=_0x512a55[0x5];}}}}});}),_0x3d4626['forEach']((_0x291074,_0x4509a1)=>{var _0x418d8a=_0x18f61a;_0x42e6e1[_0x4509a1][_0x418d8a(0x165)]=_0x291074;}),_0x82724d[_0x18f61a(0x133)]((_0x3d7891,_0x13b2ff)=>{var _0x5214db=_0x18f61a;_0x42e6e1[_0x13b2ff][_0x5214db(0x19f)]=_0x3d7891;}),_0x140504[_0x18f61a(0x133)]((_0x27695f,_0x88fea5)=>{var _0x5d2e00=_0x18f61a;_0x42e6e1[_0x88fea5][_0x5d2e00(0x1b2)]=_0x27695f;}),_0x3f67c7[_0x18f61a(0x133)]((_0xfcbd45,_0x18df50)=>{var _0x507194=_0x18f61a;_0x42e6e1[_0x18df50][_0x507194(0x1cb)]=_0xfcbd45;}),_0x3bfff3['forEach']((_0x18b1c4,_0x45876e)=>{_0x42e6e1[_0x45876e]['unit']=_0x18b1c4;}),_0x343408[_0x18f61a(0x133)]((_0x4ed8b3,_0x41388c)=>{var _0x4735c8=_0x18f61a;_0x42e6e1[_0x41388c][_0x4735c8(0x181)]=_0x4ed8b3;}),_0xe181fe[_0x18f61a(0x133)]((_0x217ecc,_0x3eeb35)=>{var _0x579cea=_0x18f61a;_0x42e6e1[_0x3eeb35][_0x579cea(0x12b)]=_0x217ecc;}),_0x63dba0['forEach']((_0x5b7d42,_0x2ba2fc)=>{var _0x4dc0be=_0x18f61a;_0x42e6e1[_0x2ba2fc][_0x4dc0be(0x1c2)]=_0x5b7d42;}),_0x558e86['forEach']((_0x51e3b9,_0x3e2fdb)=>{var _0x2e73b1=_0x18f61a;_0x42e6e1[_0x3e2fdb][_0x2e73b1(0x151)]=_0x51e3b9;}),_0x5ddf65[_0x18f61a(0x133)]((_0x2af9aa,_0xf0017a)=>{var _0x25738b=_0x18f61a;_0x42e6e1[_0xf0017a][_0x25738b(0x1b5)]=_0x2af9aa;}),_0x1fe815['forEach']((_0x2e0660,_0x154898)=>{var _0x533153=_0x18f61a;_0x42e6e1[_0x154898][_0x533153(0x13b)]=_0x2e0660;}),_0x4414f5['forEach']((_0x4ca118,_0x47a41b)=>{var _0x4c3bb0=_0x18f61a;_0x42e6e1[_0x47a41b][_0x4c3bb0(0x140)]=_0x4ca118;}),_0x24ba58['forEach']((_0x1d56f9,_0x3ce54c)=>{var _0x180de1=_0x18f61a;_0x42e6e1[_0x3ce54c][_0x180de1(0x179)]=_0x1d56f9;});const _0x2280ec=_0x42e6e1['filter'](_0x3b5c6e=>_0x3b5c6e[_0x18f61a(0xfc)]!=='0'&&_0x3b5c6e[_0x18f61a(0xfc)]!==''||_0x3b5c6e['to_floorlevel']!=='0'&&_0x3b5c6e[_0x18f61a(0x139)]!==''),_0x45cefe=new transfers({'date':_0x57bfeb,'from_warehouse':_0x14e1da,'to_warehouse':_0x1cdea7,'product':_0x2280ec,'note':_0x34ee16,'invoice':_0x4ec776}),_0x30ccb1=await _0x45cefe['save']();_0x80743f[_0x18f61a(0x1b6)](_0x18f61a(0x183),_0x18f61a(0x11c)),_0x926fd8[_0x18f61a(0x110)](_0x18f61a(0x138)+_0x30ccb1['_id']);}catch(_0x2444ee){console[_0x18f61a(0xfd)](_0x2444ee),_0x926fd8['status'](0xc8)[_0x18f61a(0x118)]({'errorMessage':_0x2444ee[_0x18f61a(0xef)]});}}),router['get'](a0_0x31bc84(0x127),auth,async(_0x2b8b7b,_0x55cc02)=>{var _0x5aac57=a0_0x31bc84;try{const {username:_0x12eacd,email:_0x3efc5a,role:_0x385827}=_0x2b8b7b[_0x5aac57(0x1c3)],_0x1c2bdd=_0x2b8b7b[_0x5aac57(0x1c3)],_0x259a10=await profile['findOne']({'email':_0x1c2bdd[_0x5aac57(0x1a8)]}),_0x5b6342=await master_shop['find']();console[_0x5aac57(0xfd)](_0x5aac57(0x119),_0x5b6342);const _0x1d7e92=await transfers[_0x5aac57(0xf7)](_0x2b8b7b['params']['id']);let _0x1d1f83=new Date(_0x1d7e92[_0x5aac57(0x1c2)]),_0x3d0824=('0'+_0x1d1f83['getDate']())['slice'](-0x2),_0x637ac0=('0'+(_0x1d1f83[_0x5aac57(0x117)]()+0x1))[_0x5aac57(0x194)](-0x2),_0x30a2a7=_0x1d1f83[_0x5aac57(0x153)](),_0x5d345b=_0x30a2a7+'-'+_0x637ac0+'-'+_0x3d0824,_0x24a0f7;if(_0x1c2bdd['role']=='staff'){const _0x36af4e=await staff['findOne']({'email':_0x1c2bdd[_0x5aac57(0x1a8)]});_0x24a0f7=await warehouse['find']({'status':'Enabled','name':_0x36af4e['warehouse'],'warehouse_category':_0x5aac57(0x11d)});}else _0x24a0f7=await warehouse['find']({'status':'Enabled','warehouse_category':_0x5aac57(0x11d)});const _0x5be41e=await warehouse[_0x5aac57(0x16b)]([{'$match':{'name':_0x1d7e92['from_warehouse']}},{'$unwind':_0x5aac57(0x135)},{'$group':{'_id':_0x5aac57(0x17b),'name':{'$first':_0x5aac57(0x14e)},'product_stock':{'$first':_0x5aac57(0x162)},'bay':{'$first':_0x5aac57(0x11e)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5aac57(0x182)},'floorlevel':{'$first':_0x5aac57(0x1d3)},'primary_code':{'$first':_0x5aac57(0x169)},'secondary_code':{'$first':_0x5aac57(0x1cc)},'product_code':{'$first':_0x5aac57(0x192)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5aac57(0x1d1)},'expiry_date':{'$first':_0x5aac57(0x1a3)},'production_date':{'$first':_0x5aac57(0x18a)},'room':{'$first':_0x5aac57(0x1af)}}}]);if(_0x5b6342[0x0]['language']==_0x5aac57(0x11a)){var _0x2aa744=users[_0x5aac57(0x1cf)];console['log'](_0x2aa744);}else{if(_0x5b6342[0x0][_0x5aac57(0x14f)]==_0x5aac57(0x131))var _0x2aa744=users['Hindi'];else{if(_0x5b6342[0x0][_0x5aac57(0x14f)]==_0x5aac57(0x11b))var _0x2aa744=users[_0x5aac57(0x11b)];else{if(_0x5b6342[0x0][_0x5aac57(0x14f)]==_0x5aac57(0x1b1))var _0x2aa744=users[_0x5aac57(0x1b1)];else{if(_0x5b6342[0x0]['language']=='French')var _0x2aa744=users[_0x5aac57(0x126)];else{if(_0x5b6342[0x0][_0x5aac57(0x14f)]==_0x5aac57(0x1b7))var _0x2aa744=users['Portuguese'];else{if(_0x5b6342[0x0][_0x5aac57(0x14f)]==_0x5aac57(0x187))var _0x2aa744=users['Chinese'];else{if(_0x5b6342[0x0][_0x5aac57(0x14f)]==_0x5aac57(0x19d))var _0x2aa744=users[_0x5aac57(0x103)];}}}}}}}_0x55cc02[_0x5aac57(0x1b4)](_0x5aac57(0x1d2),{'success':_0x2b8b7b[_0x5aac57(0x1b6)](_0x5aac57(0x183)),'errors':_0x2b8b7b[_0x5aac57(0x1b6)](_0x5aac57(0x1a2)),'role':_0x1c2bdd,'profile':_0x259a10,'master_shop':_0x5b6342,'warehouse':_0x24a0f7,'transfer':_0x1d7e92,'stock':_0x5be41e,'language':_0x2aa744});}catch(_0x59e337){console[_0x5aac57(0xfd)](_0x59e337);}}),router[a0_0x31bc84(0x1d8)](a0_0x31bc84(0x127),auth,async(_0x465c0d,_0x4019f1)=>{var _0x397ffe=a0_0x31bc84;try{const _0x5a2765=_0x465c0d[_0x397ffe(0x1a7)]['id'],{from_warehouse:_0x66ee0c,FromRoom_name:_0x1a8c65,to_warehouse:_0x79e5be,ToRoom_name:_0x526c57}=_0x465c0d[_0x397ffe(0x17e)],_0xd8e6b6=await transfers['findById']({'_id':_0x5a2765}),_0x3ea564=_0xd8e6b6['product'][_0x397ffe(0x19b)](async _0x3559ea=>{var _0x527259=_0x397ffe;if(_0x3559ea[_0x527259(0xfc)]>0x0){var _0x3795dd=await warehouse[_0x527259(0x143)]({'name':_0xd8e6b6[_0x527259(0x15e)],'room':_0x3559ea[_0x527259(0x140)],'warehouse_category':_0x527259(0x11d)});const _0x5a0bb3=_0x3795dd[_0x527259(0x115)]['map'](_0x5b2966=>{var _0x45c10c=_0x527259;_0x5b2966['product_name']==_0x3559ea[_0x45c10c(0xf5)]&&_0x5b2966[_0x45c10c(0x1be)]==_0x3559ea['from_floorlevel']&&_0x5b2966['type']==_0x3559ea['from_types']&&_0x5b2966[_0x45c10c(0x167)]==_0x3559ea[_0x45c10c(0x149)]&&_0x5b2966[_0x45c10c(0x17a)]==_0x3559ea[_0x45c10c(0x18f)]&&_0x5b2966[_0x45c10c(0x13d)]==_0x3559ea[_0x45c10c(0x190)]&&_0x5b2966[_0x45c10c(0x150)]==_0x3559ea[_0x45c10c(0x130)]&&_0x5b2966[_0x45c10c(0x1c2)]==_0x3559ea[_0x45c10c(0x1c2)]&&_0x5b2966[_0x45c10c(0x12b)]==_0x3559ea[_0x45c10c(0x12b)]&&_0x5b2966[_0x45c10c(0x1b5)]==_0x3559ea[_0x45c10c(0x1b5)]&&_0x5b2966['invoice']==_0x3559ea['from_invoice']&&_0x5b2966[_0x45c10c(0x146)]==_0x3559ea[_0x45c10c(0x15f)]&&(_0x5b2966[_0x45c10c(0x120)]=_0x5b2966[_0x45c10c(0x120)]-_0x3559ea[_0x45c10c(0xfc)]);});}return _0x3795dd;});Promise['all'](_0x3ea564)[_0x397ffe(0x1bd)](async _0x45bcab=>{var _0x19dc73=_0x397ffe;try{for(const _0x2d9625 of _0x45bcab){await _0x2d9625['save']();}try{const _0x29bac5=_0xd8e6b6['product'][_0x19dc73(0x19b)](async _0x19d549=>{var _0x58063b=_0x19dc73;if(_0x19d549[_0x58063b(0xfc)]>0x0){var _0x3dad91=await warehouse['findOne']({'name':_0xd8e6b6[_0x58063b(0x16a)],'room':_0x19d549[_0x58063b(0x179)],'warehouse_category':_0x58063b(0x11d)}),_0x43921d=0x0;const _0x2681b9=_0x3dad91[_0x58063b(0x115)][_0x58063b(0x19b)](_0x283c9d=>{var _0x449af9=_0x58063b;_0x283c9d[_0x449af9(0xf5)]==_0x19d549[_0x449af9(0xf5)]&&_0x283c9d['floorlevel']==_0x19d549[_0x449af9(0x139)]&&_0x283c9d[_0x449af9(0x137)]==_0x19d549[_0x449af9(0x1c8)]&&_0x283c9d[_0x449af9(0x167)]==_0x19d549[_0x449af9(0x123)]&&_0x283c9d['bay']==_0x19d549[_0x449af9(0xfb)]&&_0x283c9d[_0x449af9(0x13d)]==_0x19d549[_0x449af9(0x13d)]&&_0x283c9d['storage']==_0x19d549[_0x449af9(0x150)]&&_0x283c9d[_0x449af9(0x1c2)]==_0x19d549[_0x449af9(0x1c2)]&&_0x283c9d['batch_code']==_0x19d549['batch_code']&&_0x283c9d[_0x449af9(0x1b5)]==_0x19d549[_0x449af9(0x1b5)]&&_0x283c9d['invoice']==_0x19d549[_0x449af9(0x18c)]&&(_0x283c9d['product_stock']=_0x283c9d['product_stock']+_0x19d549[_0x449af9(0xfc)],_0x43921d++);});_0x43921d=='0'&&(_0x3dad91[_0x58063b(0x115)]=_0x3dad91['product_details'][_0x58063b(0x100)]({'product_name':_0x19d549[_0x58063b(0xf5)],'product_stock':_0x19d549[_0x58063b(0xfc)],'bay':_0x19d549[_0x58063b(0xfb)],'bin':_0x19d549[_0x58063b(0x123)],'type':_0x19d549[_0x58063b(0x1c8)],'floorlevel':_0x19d549['to_floorlevel'],'storage':_0x19d549[_0x58063b(0x150)],'rack':_0x19d549[_0x58063b(0x13d)],'product_code':_0x19d549[_0x58063b(0x1b2)],'primary_code':_0x19d549[_0x58063b(0x165)],'secondary_code':_0x19d549[_0x58063b(0x19f)],'maxProducts':_0x19d549[_0x58063b(0x1cb)],'storage':_0x19d549[_0x58063b(0x150)],'rack':_0x19d549[_0x58063b(0x13d)],'expiry_date':_0x19d549[_0x58063b(0x1c2)],'maxPerUnit':_0x19d549[_0x58063b(0x151)],'batch_code':_0x19d549[_0x58063b(0x12b)],'production_date':_0x19d549[_0x58063b(0x1b5)]}));}return _0x3dad91;});Promise[_0x19dc73(0x18e)](_0x29bac5)[_0x19dc73(0x1bd)](async _0x167bf2=>{var _0x1050cd=_0x19dc73;try{for(const _0x42c1da of _0x167bf2){await warehouse['updateOne']({'_id':_0x42c1da['_id']},{'$addToSet':{'product_details':{'$each':_0x42c1da[_0x1050cd(0x115)]}}});}_0xd8e6b6[_0x1050cd(0xe9)]=_0x1050cd(0x15c);const _0xe3805f=await _0xd8e6b6['save'](),_0x4a0744=await master_shop[_0x1050cd(0x1d0)](),_0x213876=await email_settings[_0x1050cd(0x143)](),_0x13ee80=await supervisor_settings[_0x1050cd(0x1d0)]();var _0x495eca=_0xd8e6b6[_0x1050cd(0x1ae)],_0x510a9f='',_0x4acce5;for(_0x4acce5 in _0x495eca){_0x510a9f+=_0x1050cd(0x16e)+_0x1050cd(0x1c6)+_0x495eca[_0x4acce5][_0x1050cd(0xf5)]+_0x1050cd(0x1ab)+_0x1050cd(0x1c6)+_0x495eca[_0x4acce5][_0x1050cd(0x1b2)]+_0x1050cd(0x1ab)+_0x1050cd(0x1c6)+_0x495eca[_0x4acce5][_0x1050cd(0xfc)]+_0x1050cd(0x1ab)+_0x1050cd(0x1c6)+_0x495eca[_0x4acce5][_0x1050cd(0x178)]+_0x1050cd(0x1ab)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x495eca[_0x4acce5][_0x1050cd(0x181)]+_0x1050cd(0x1ab)+_0x1050cd(0x1c6)+_0xd8e6b6[_0x1050cd(0x16a)]+_0x1050cd(0x1ab)+_0x1050cd(0x1c6)+_0x495eca[_0x4acce5][_0x1050cd(0x179)]+_0x1050cd(0x1ab)+_0x1050cd(0x1c6)+_0x495eca[_0x4acce5]['storage']+_0x495eca[_0x4acce5][_0x1050cd(0x13d)]+_0x495eca[_0x4acce5][_0x1050cd(0xfb)]+_0x495eca[_0x4acce5][_0x1050cd(0x123)]+_0x495eca[_0x4acce5][_0x1050cd(0x1c8)][0x0]+_0x495eca[_0x4acce5][_0x1050cd(0x139)]+_0x1050cd(0x1ab),_0x1050cd(0x172);}let _0x29f19b=nodemailer[_0x1050cd(0x170)]({'host':_0x213876['host'],'port':Number(_0x213876[_0x1050cd(0x1d4)]),'secure':![],'auth':{'user':_0x213876[_0x1050cd(0x1a8)],'pass':_0x213876[_0x1050cd(0x17f)]}}),_0x20eea1={'from':_0x213876['email'],'to':_0x13ee80[0x0][_0x1050cd(0x184)],'subject':_0x1050cd(0x114),'attachments':[{'filename':_0x1050cd(0x197),'path':__dirname+_0x1050cd(0x1d6)+_0x1050cd(0x177)+_0x4a0744[0x0][_0x1050cd(0x12a)],'cid':_0x1050cd(0x1bc)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x1050cd(0x128)+_0x1050cd(0x122)+_0x1050cd(0xf6)+_0x1050cd(0x122)+_0x1050cd(0xfe)+'</div>'+'<div>'+'<h2>\x20'+_0x4a0744[0x0]['site_title']+'\x20</h2>'+_0x1050cd(0x16f)+_0x1050cd(0x16f)+'<hr\x20class=\x22my-3\x22>'+_0x1050cd(0x122)+_0x1050cd(0x1da)+_0x1050cd(0x15b)+_0xd8e6b6[_0x1050cd(0xf3)]+'\x20'+_0x1050cd(0x1c4)+_0x1050cd(0x112)+_0xd8e6b6[_0x1050cd(0x10f)]+'\x20'+_0x1050cd(0xeb)+'</h5>'+_0x1050cd(0x16f)+_0x1050cd(0x166)+_0x1050cd(0xee)+_0x1050cd(0x16e)+_0x1050cd(0x134)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x1050cd(0x152)+_0x1050cd(0x195)+_0x1050cd(0x111)+_0x1050cd(0x144)+_0x1050cd(0x12e)+_0x1050cd(0x136)+_0x1050cd(0x172)+'</thead>'+_0x1050cd(0x19c)+'\x20'+_0x510a9f+'\x20'+_0x1050cd(0x113)+'</table>'+'<div>'+_0x1050cd(0xf0)+_0x1050cd(0x14b)+_0x4a0744[0x0][_0x1050cd(0x1c1)]+_0x1050cd(0x18d)+'</div>'+_0x1050cd(0x16f)+_0x1050cd(0x196)};_0x29f19b['sendMail'](_0x20eea1,function(_0x28fcba,_0x3bb83f){var _0x4bb657=_0x1050cd;_0x28fcba?(console[_0x4bb657(0xfd)](_0x28fcba),console[_0x4bb657(0xfd)](_0x4bb657(0x1a1))):console[_0x4bb657(0xfd)](_0x4bb657(0x105));}),_0x465c0d[_0x1050cd(0x1b6)](_0x1050cd(0x183),'Transfer\x20Finalize\x20Successfully'),_0x4019f1[_0x1050cd(0x110)]('/picking_list/PDF_transfer_rm/'+_0xe3805f[_0x1050cd(0x146)]);}catch(_0x47657a){console[_0x1050cd(0x107)](_0x47657a),_0x4019f1[_0x1050cd(0x189)](0x1f4)[_0x1050cd(0x118)]({'Perror':_0x1050cd(0x13e),'message':_0x47657a[_0x1050cd(0xef)]});}})[_0x19dc73(0x1ca)](_0x253f9b=>{var _0x41c8a2=_0x19dc73;console[_0x41c8a2(0x107)](_0x253f9b),_0x4019f1[_0x41c8a2(0x189)](0x1f4)['json']({'Perror':_0x41c8a2(0xfa)});});}catch(_0xa23237){_0x4019f1['json'](_0xa23237);}}catch(_0x211115){console[_0x19dc73(0x107)](_0x211115),_0x4019f1[_0x19dc73(0x189)](0x1f4)[_0x19dc73(0x118)]({'Merror':_0x19dc73(0x13e),'Message':_0x211115[_0x19dc73(0xef)]});}})[_0x397ffe(0x1ca)](_0x4529e2=>{console['error'](_0x4529e2),_0x4019f1['status'](0x1f4)['json']({'Merror':'An\x20error\x20occurred.'});});}catch(_0x19159d){console[_0x397ffe(0xfd)](_0x19159d);}});function BayBinSelected(_0x5e4ec7,_0x575ffb){var _0x37d690=a0_0x31bc84,_0x282b3a=[],_0x2f2c47=[],_0x8470ea=[],_0x4882e3=[],_0x52e368=[],_0x34aa6e=[];let _0x106f08=[];if(_0x5e4ec7==_0x37d690(0xf1))switch(_0x575ffb){case'Rack\x20A':_0x282b3a=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2f2c47=[0x1,0x2],_0x4882e3=[0x1,0x2,0x3,0x4,0x5],_0x8470ea=[_0x37d690(0x1ad),_0x37d690(0xff)],_0x52e368=['D'],_0x34aa6e=['A'];break;case _0x37d690(0x147):_0x282b3a=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2f2c47=[0x1,0x2],_0x4882e3=[0x1,0x2,0x3,0x4,0x5],_0x8470ea=['Level',_0x37d690(0xff)],_0x52e368=['D'],_0x34aa6e=['B'];break;case _0x37d690(0x176):_0x282b3a=[0x0],_0x2f2c47=[0x0],_0x4882e3=[0x1,0x2,0x3,0x4,0x5],_0x8470ea=[_0x37d690(0xff)],_0x52e368=['D'],_0x34aa6e=['S'];break;case'Receiving\x20Area':_0x282b3a=[0x0],_0x2f2c47=[0x0],_0x4882e3=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x8470ea=[_0x37d690(0xff)],_0x52e368=['D'],_0x34aa6e=['R'];break;}else{if(_0x5e4ec7==_0x37d690(0x171))switch(_0x575ffb){case _0x37d690(0x1bb):_0x282b3a=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2f2c47=['B','F'],_0x4882e3=[0x1,0x2,0x3,0x4,0x5],_0x8470ea=[_0x37d690(0x1ad),'Floor'],_0x52e368=['C'],_0x34aa6e=['A'];break;case _0x37d690(0x147):_0x282b3a=[0x5,0x4,0x3,0x2,0x1],_0x2f2c47=['F','B','S'],_0x4882e3=[0x1,0x2,0x3,0x4,0x5],_0x8470ea=['Level',_0x37d690(0xff)],_0x52e368=['C'],_0x34aa6e=['B'];break;case _0x37d690(0x1ce):_0x282b3a=[0x1,0x2,0x3,0x4,0x5],_0x2f2c47=['B','F','S'],_0x4882e3=[0x5,0x4,0x3,0x2,0x1],_0x8470ea=[_0x37d690(0x1ad),_0x37d690(0xff)],_0x52e368=['C'],_0x34aa6e=['C'];break;case'Rack\x20D':_0x282b3a=[0x5,0x4,0x3,0x2,0x1],_0x2f2c47=['F','B','S'],_0x4882e3=[0x1,0x2,0x3,0x4,0x5],_0x8470ea=['Level',_0x37d690(0xff)],_0x52e368=['C'],_0x34aa6e=['D'];break;case _0x37d690(0xea):_0x282b3a=[0x4,0x3,0x2,0x1],_0x2f2c47=[0x1,0x2],_0x4882e3=[0x1,0x2,0x3,0x4,0x5],_0x8470ea=['Level',_0x37d690(0xff)],_0x52e368=['C'],_0x34aa6e=['E'];break;case'Rack\x20F':_0x282b3a=[0x1,0x2,0x3],_0x2f2c47=[0x1,0x2],_0x4882e3=[0x1,0x2,0x3,0x4,0x5],_0x8470ea=[_0x37d690(0x1ad)],_0x52e368=['C'],_0x34aa6e=['F'];break;}}return{'levels':_0x282b3a,'Isle':_0x2f2c47,'rack':_0x4882e3,'type':_0x8470ea,'storage':_0x52e368,'rak':_0x34aa6e};}router[a0_0x31bc84(0x142)](a0_0x31bc84(0x13a),auth,async(_0x5f06fb,_0x586f7a)=>{var _0x5214b4=a0_0x31bc84;try{const {username:_0x1d1815,email:_0x421eda,role:_0x50719b}=_0x5f06fb['user'],_0x321818=_0x5f06fb[_0x5214b4(0x1c3)],_0x14362c=await profile['findOne']({'email':_0x321818['email']}),_0x36ec98=await master_shop[_0x5214b4(0x1d0)](),_0x86b57a=await transfers['findById'](_0x5f06fb[_0x5214b4(0x1a7)]['id']);let _0x27dfc7;if(_0x321818[_0x5214b4(0x13c)]==_0x5214b4(0x1c0)){const _0x554c25=await staff[_0x5214b4(0x143)]({'email':_0x321818[_0x5214b4(0x1a8)]});_0x27dfc7=await warehouse[_0x5214b4(0x16b)]([{'$match':{'status':_0x5214b4(0x158),'name':_0x554c25[_0x5214b4(0x1bf)],'warehouse_category':_0x5214b4(0x11d)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x27dfc7=await warehouse[_0x5214b4(0x16b)]([{'$match':{'status':_0x5214b4(0x158),'warehouse_category':_0x5214b4(0x11d)}},{'$group':{'_id':_0x5214b4(0x1d9),'name':{'$first':_0x5214b4(0x1d9)}}}]);const _0x4ad4e2=await warehouse[_0x5214b4(0x16b)]([{'$match':{'name':_0x86b57a['from_warehouse'],'warehouse_category':_0x5214b4(0x11d)}},{'$unwind':_0x5214b4(0x135)},{'$group':{'_id':_0x5214b4(0x17b),'name':{'$first':_0x5214b4(0x14e)},'product_stock':{'$first':_0x5214b4(0x162)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x5214b4(0x116)},'type':{'$first':_0x5214b4(0x182)},'floorlevel':{'$first':_0x5214b4(0x1d3)},'primary_code':{'$first':_0x5214b4(0x169)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5214b4(0x192)},'storage':{'$first':_0x5214b4(0x121)},'rack':{'$first':_0x5214b4(0x1d1)},'expiry_date':{'$first':_0x5214b4(0x1a3)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x5214b4(0x1af)}}}]),_0x53cca5=await product[_0x5214b4(0x1d0)]({}),_0x528715=BayBinSelected(_0x86b57a['to_warehouse'],_0x86b57a[_0x5214b4(0x191)]);if(_0x36ec98[0x0][_0x5214b4(0x14f)]==_0x5214b4(0x11a)){var _0x49f76b=users[_0x5214b4(0x1cf)];console[_0x5214b4(0xfd)](_0x49f76b);}else{if(_0x36ec98[0x0][_0x5214b4(0x14f)]==_0x5214b4(0x131))var _0x49f76b=users[_0x5214b4(0x131)];else{if(_0x36ec98[0x0][_0x5214b4(0x14f)]==_0x5214b4(0x11b))var _0x49f76b=users[_0x5214b4(0x11b)];else{if(_0x36ec98[0x0][_0x5214b4(0x14f)]==_0x5214b4(0x1b1))var _0x49f76b=users[_0x5214b4(0x1b1)];else{if(_0x36ec98[0x0][_0x5214b4(0x14f)]==_0x5214b4(0x126))var _0x49f76b=users[_0x5214b4(0x126)];else{if(_0x36ec98[0x0][_0x5214b4(0x14f)]==_0x5214b4(0x1b7))var _0x49f76b=users['Portuguese'];else{if(_0x36ec98[0x0]['language']==_0x5214b4(0x187))var _0x49f76b=users[_0x5214b4(0x187)];else{if(_0x36ec98[0x0][_0x5214b4(0x14f)]=='Arabic\x20(ae)')var _0x49f76b=users[_0x5214b4(0x103)];}}}}}}}_0x586f7a[_0x5214b4(0x1b4)](_0x5214b4(0x1a5),{'success':_0x5f06fb[_0x5214b4(0x1b6)](_0x5214b4(0x183)),'errors':_0x5f06fb[_0x5214b4(0x1b6)](_0x5214b4(0x1a2)),'role':_0x321818,'profile':_0x14362c,'master_shop':_0x36ec98,'warehouse':_0x27dfc7,'transfer':_0x86b57a,'stock':_0x4ad4e2,'unit':_0x53cca5,'language':_0x49f76b});}catch(_0x1e2460){console['log'](_0x1e2460);}}),router[a0_0x31bc84(0x1d8)]('/view/:id',auth,async(_0x5eef6c,_0x4666b9)=>{var _0x3a7ce2=a0_0x31bc84;try{const _0x3aef51=_0x5eef6c[_0x3a7ce2(0x1a7)]['id'],_0x506320=await transfers[_0x3a7ce2(0xf7)](_0x3aef51);_0x4666b9[_0x3a7ce2(0x118)](_0x5eef6c[_0x3a7ce2(0x17e)]);return;const {date:_0x45f3fd,from_warehouse:_0x2deee6,FromRoom_name:_0x3201d3,to_warehouse:_0x3db427,ToRoom_name:_0x5daa4c,prod_name:_0x29e6de,from_prod_qty:_0x2f854a,from_prod_level:_0x292d51,from_prod_isle:_0x31b8a2,from_prod_pallet:_0x46244c,to_prod_qty:_0x4e4e73,to_prod_level:_0x10d396,to_prod_isle:_0x582d9d,to_prod_pallet:_0x1e1706,primary_code:_0x5f0d3b,secondary_code:_0x1eabfb,product_code3:_0x16eaee,note:_0xe07c9e,invoice:_0x349944,expiry_date:_0x41a683}=_0x5eef6c[_0x3a7ce2(0x17e)];if(typeof _0x29e6de==_0x3a7ce2(0x1a4))var _0x4005e4=[_0x5eef6c['body'][_0x3a7ce2(0x16c)]],_0x4cdd7e=[_0x5eef6c[_0x3a7ce2(0x17e)]['from_prod_qty']],_0x2518aa=[_0x5eef6c['body'][_0x3a7ce2(0x12f)]],_0x539a65=[_0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x175)]],_0x151d85=[_0x5eef6c[_0x3a7ce2(0x17e)]['from_prod_pallet']],_0x3fb129=[_0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x1a6)]],_0x4acc8d=[_0x5eef6c['body'][_0x3a7ce2(0x164)]],_0x3a96b4=[_0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x148)]],_0x42b591=[_0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x174)]],_0x4fac3e=[_0x5eef6c['body']['to_prod_pallet']],_0x517f2f=[_0x5eef6c['body'][_0x3a7ce2(0x1c8)]],_0x163fc8=[_0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x150)]],_0x10afaf=[_0x5eef6c[_0x3a7ce2(0x17e)]['rak']],_0x137e57=[_0x5eef6c[_0x3a7ce2(0x17e)]['primary_code']],_0x1f6e4b=[_0x5eef6c[_0x3a7ce2(0x17e)]['secondary_code']],_0x30251b=[_0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x173)]],_0x147b78=[_0x5eef6c[_0x3a7ce2(0x17e)]['MaxStocks_data2']],_0x9fc58d=[_0x5eef6c['body'][_0x3a7ce2(0x178)]],_0x183b5f=[_0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x181)]],_0x30f664=[_0x5eef6c['body'][_0x3a7ce2(0x12b)]],_0x5d181c=[_0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x1c2)]],_0x389bb7=[_0x5eef6c['body']['from_storage']],_0x4066e0=[_0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x163)]];else var _0x4005e4=[..._0x5eef6c['body'][_0x3a7ce2(0x16c)]],_0x163fc8=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x150)]],_0x10afaf=[..._0x5eef6c[_0x3a7ce2(0x17e)]['rak']],_0x3fb129=[..._0x5eef6c[_0x3a7ce2(0x17e)]['from_types']],_0x517f2f=[..._0x5eef6c['body'][_0x3a7ce2(0x1c8)]],_0x4cdd7e=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x10a)]],_0x2518aa=[..._0x5eef6c['body'][_0x3a7ce2(0x12f)]],_0x539a65=[..._0x5eef6c['body']['from_prod_isle']],_0x151d85=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0xf4)]],_0x4acc8d=[..._0x5eef6c[_0x3a7ce2(0x17e)]['to_prod_qty']],_0x3a96b4=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x148)]],_0x42b591=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x174)]],_0x4fac3e=[..._0x5eef6c[_0x3a7ce2(0x17e)]['to_prod_pallet']],_0x137e57=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x165)]],_0x1f6e4b=[..._0x5eef6c[_0x3a7ce2(0x17e)]['secondary_code']],_0x30251b=[..._0x5eef6c['body'][_0x3a7ce2(0x173)]],_0x147b78=[..._0x5eef6c['body'][_0x3a7ce2(0x11f)]],_0x9fc58d=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x178)]],_0x183b5f=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x181)]],_0x30f664=[..._0x5eef6c['body']['batch_code']],_0x5d181c=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x1c2)]],_0x389bb7=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x130)]],_0x4066e0=[..._0x5eef6c[_0x3a7ce2(0x17e)][_0x3a7ce2(0x163)]];const _0x4a1d95=_0x4005e4[_0x3a7ce2(0x19b)](_0x2ab598=>{return _0x2ab598={'product_name':_0x2ab598};});_0x4cdd7e['forEach']((_0x1f87da,_0x3d8a2a)=>{var _0x160a14=_0x3a7ce2;_0x4a1d95[_0x3d8a2a][_0x160a14(0xec)]=_0x1f87da;}),_0x2518aa[_0x3a7ce2(0x133)]((_0x3b054a,_0x181049)=>{var _0x49549b=_0x3a7ce2;_0x4a1d95[_0x181049][_0x49549b(0x18f)]=_0x3b054a;}),_0x539a65[_0x3a7ce2(0x133)]((_0x33f7f8,_0x22f966)=>{var _0x25b19d=_0x3a7ce2;_0x4a1d95[_0x22f966][_0x25b19d(0x149)]=_0x33f7f8;}),_0x151d85['forEach']((_0x25f1b6,_0x31decb)=>{var _0x2a0131=_0x3a7ce2;_0x4a1d95[_0x31decb][_0x2a0131(0x160)]=_0x25f1b6;}),_0x4acc8d[_0x3a7ce2(0x133)]((_0x56981c,_0x1f3d94)=>{var _0x4468f2=_0x3a7ce2;_0x4a1d95[_0x1f3d94][_0x4468f2(0xfc)]=_0x56981c;}),_0x3a96b4['forEach']((_0x160b63,_0x21354b)=>{var _0x39dcdb=_0x3a7ce2;_0x4a1d95[_0x21354b][_0x39dcdb(0xfb)]=_0x160b63;}),_0x42b591[_0x3a7ce2(0x133)]((_0x401f88,_0x40c8fe)=>{var _0x5cfd15=_0x3a7ce2;_0x4a1d95[_0x40c8fe][_0x5cfd15(0x123)]=_0x401f88;}),_0x4fac3e['forEach']((_0x4c193b,_0x177943)=>{var _0x20238c=_0x3a7ce2;_0x4a1d95[_0x177943][_0x20238c(0x139)]=_0x4c193b;}),_0x137e57[_0x3a7ce2(0x133)]((_0x237fa2,_0x5a78c4)=>{var _0x9b3e13=_0x3a7ce2;_0x4a1d95[_0x5a78c4][_0x9b3e13(0x165)]=_0x237fa2;}),_0x1f6e4b['forEach']((_0x3ebcd5,_0x39db17)=>{var _0x19ec69=_0x3a7ce2;_0x4a1d95[_0x39db17][_0x19ec69(0x19f)]=_0x3ebcd5;}),_0x30251b[_0x3a7ce2(0x133)]((_0x23e09d,_0xdf8f55)=>{var _0x434087=_0x3a7ce2;_0x4a1d95[_0xdf8f55][_0x434087(0x1b2)]=_0x23e09d;}),_0x147b78[_0x3a7ce2(0x133)]((_0x3e6e8f,_0x1ecfcc)=>{var _0x523d78=_0x3a7ce2;_0x4a1d95[_0x1ecfcc][_0x523d78(0x1cb)]=_0x3e6e8f;}),_0x9fc58d[_0x3a7ce2(0x133)]((_0x8f01dc,_0x1324c2)=>{_0x4a1d95[_0x1324c2]['unit']=_0x8f01dc;}),_0x183b5f[_0x3a7ce2(0x133)]((_0x128ed6,_0x11637e)=>{var _0x23404b=_0x3a7ce2;_0x4a1d95[_0x11637e][_0x23404b(0x181)]=_0x128ed6;}),_0x30f664[_0x3a7ce2(0x133)]((_0x5331e9,_0x5ed0bf)=>{var _0x5a743f=_0x3a7ce2;_0x4a1d95[_0x5ed0bf][_0x5a743f(0x12b)]=_0x5331e9;}),_0x5d181c[_0x3a7ce2(0x133)]((_0x3fcf71,_0x193947)=>{var _0x2d2f1f=_0x3a7ce2;_0x4a1d95[_0x193947][_0x2d2f1f(0x1c2)]=_0x3fcf71;}),_0x163fc8[_0x3a7ce2(0x133)]((_0x41a693,_0x59b80e)=>{var _0x515974=_0x3a7ce2;_0x4a1d95[_0x59b80e][_0x515974(0x150)]=_0x41a693;}),_0x10afaf[_0x3a7ce2(0x133)]((_0x381091,_0x2a247c)=>{var _0xbe1938=_0x3a7ce2;_0x4a1d95[_0x2a247c][_0xbe1938(0x13d)]=_0x381091;}),_0x3fb129[_0x3a7ce2(0x133)]((_0x5d3f0a,_0x5bb49b)=>{var _0x1febcd=_0x3a7ce2;_0x4a1d95[_0x5bb49b][_0x1febcd(0x1a6)]=_0x5d3f0a;}),_0x517f2f[_0x3a7ce2(0x133)]((_0x1d2098,_0x429a46)=>{var _0x4525cf=_0x3a7ce2;_0x4a1d95[_0x429a46][_0x4525cf(0x1c8)]=_0x1d2098;}),_0x389bb7[_0x3a7ce2(0x133)]((_0x5cfd8e,_0x3b4b01)=>{var _0x253e53=_0x3a7ce2;_0x4a1d95[_0x3b4b01][_0x253e53(0x130)]=_0x5cfd8e;}),_0x4066e0[_0x3a7ce2(0x133)]((_0x3af471,_0x4000ba)=>{var _0x1084b5=_0x3a7ce2;_0x4a1d95[_0x4000ba][_0x1084b5(0x190)]=_0x3af471;});const _0x49238a=_0x4a1d95[_0x3a7ce2(0x1a9)](_0x4c622e=>_0x4c622e[_0x3a7ce2(0xfc)]!=='0'&&_0x4c622e['to_quantity']!==''||_0x4c622e['to_floorlevel']!=='0'&&_0x4c622e[_0x3a7ce2(0x139)]!=='');var _0x50393f=0x0;_0x49238a[_0x3a7ce2(0x133)](_0x496270=>{var _0x28b633=_0x3a7ce2;parseInt(_0x496270['from_quantity'])<parseInt(_0x496270[_0x28b633(0xfc)])&&_0x50393f++;});if(_0x50393f!=0x0)return _0x5eef6c[_0x3a7ce2(0x1b6)](_0x3a7ce2(0x1a2),_0x3a7ce2(0x19a)),_0x4666b9[_0x3a7ce2(0x110)](_0x3a7ce2(0x109));const _0x2293a1=await warehouse[_0x3a7ce2(0x143)]({'name':_0x506320[_0x3a7ce2(0x15e)],'room':_0x506320['from_room']});_0x506320['product'][_0x3a7ce2(0x133)](_0x7a29fa=>{var _0x2bf4d1=_0x3a7ce2;if(_0x7a29fa['to_quantity']>0x0){const _0x442549=_0x2293a1[_0x2bf4d1(0x115)]['map'](_0x1e0f24=>{var _0x1397d2=_0x2bf4d1;_0x1e0f24['product_name']==_0x7a29fa[_0x1397d2(0xf5)]&&_0x1e0f24[_0x1397d2(0x1be)]==_0x7a29fa[_0x1397d2(0x160)]&&_0x1e0f24[_0x1397d2(0x137)]==_0x7a29fa[_0x1397d2(0x1a6)]&&_0x1e0f24[_0x1397d2(0x167)]==_0x7a29fa['from_bin']&&_0x1e0f24[_0x1397d2(0x17a)]==_0x7a29fa[_0x1397d2(0x18f)]&&_0x1e0f24[_0x1397d2(0x13d)]==_0x7a29fa[_0x1397d2(0x190)]&&_0x1e0f24[_0x1397d2(0x150)]==_0x7a29fa['from_storage']&&(_0x1e0f24[_0x1397d2(0x120)]=parseInt(_0x1e0f24[_0x1397d2(0x120)])+parseInt(_0x7a29fa[_0x1397d2(0xfc)]));});}}),await _0x2293a1['save']();const _0x56f892=await warehouse[_0x3a7ce2(0x143)]({'name':_0x506320[_0x3a7ce2(0x16a)],'room':_0x506320[_0x3a7ce2(0x191)]});_0x506320['product'][_0x3a7ce2(0x133)](_0x5cd840=>{var _0x38592f=_0x3a7ce2;if(_0x5cd840[_0x38592f(0xfc)]>0x0){const _0x42175f=_0x56f892[_0x38592f(0x115)][_0x38592f(0x19b)](_0x5d0891=>{var _0x4b6e36=_0x38592f;_0x5d0891[_0x4b6e36(0xf5)]==_0x5cd840[_0x4b6e36(0xf5)]&&_0x5d0891['floorlevel']==_0x5cd840['to_floorlevel']&&_0x5d0891['type']==_0x5cd840['to_types']&&_0x5d0891[_0x4b6e36(0x167)]==_0x5cd840[_0x4b6e36(0x123)]&&_0x5d0891[_0x4b6e36(0x17a)]==_0x5cd840[_0x4b6e36(0xfb)]&&_0x5d0891[_0x4b6e36(0x13d)]==_0x5cd840['rack']&&_0x5d0891[_0x4b6e36(0x150)]==_0x5cd840[_0x4b6e36(0x150)]&&(_0x5d0891['product_stock']=parseInt(_0x5d0891['product_stock'])-parseInt(_0x5cd840['to_quantity']));});}}),await _0x56f892[_0x3a7ce2(0x10e)](),_0x506320[_0x3a7ce2(0x10f)]=_0x45f3fd,_0x506320[_0x3a7ce2(0x15e)]=_0x2deee6,_0x506320[_0x3a7ce2(0x16a)]=_0x3db427,_0x506320[_0x3a7ce2(0x1ae)]=_0x49238a,_0x506320[_0x3a7ce2(0x156)]=_0xe07c9e,_0x506320['invoice']=_0x349944;const _0x55628d=await _0x506320[_0x3a7ce2(0x10e)]();console['log'](_0x55628d);const _0x28b41e=await warehouse[_0x3a7ce2(0x143)]({'name':_0x2deee6,'room':_0x3201d3});_0x55628d[_0x3a7ce2(0x1ae)][_0x3a7ce2(0x133)](_0x5e4e6a=>{var _0x3e8308=_0x3a7ce2;if(_0x5e4e6a['to_quantity']>0x0){const _0x231c4e=_0x28b41e[_0x3e8308(0x115)]['map'](_0xcd3982=>{var _0x130162=_0x3e8308;_0xcd3982[_0x130162(0xf5)]==_0x5e4e6a[_0x130162(0xf5)]&&_0xcd3982[_0x130162(0x1be)]==_0x5e4e6a[_0x130162(0x160)]&&_0xcd3982[_0x130162(0x137)]==_0x5e4e6a[_0x130162(0x1a6)]&&_0xcd3982[_0x130162(0x167)]==_0x5e4e6a['from_bin']&&_0xcd3982['bay']==_0x5e4e6a[_0x130162(0x18f)]&&_0xcd3982[_0x130162(0x13d)]==_0x5e4e6a['from_rack']&&_0xcd3982['storage']==_0x5e4e6a[_0x130162(0x130)]&&(_0xcd3982[_0x130162(0x120)]=parseInt(_0xcd3982['product_stock'])-parseInt(_0x5e4e6a[_0x130162(0xfc)]));});}}),await _0x28b41e[_0x3a7ce2(0x10e)]();const _0x301d85=await warehouse[_0x3a7ce2(0x143)]({'name':_0x3db427,'room':_0x5daa4c});_0x55628d['product'][_0x3a7ce2(0x133)](_0x48e760=>{var _0x4dfcff=_0x3a7ce2;if(_0x48e760[_0x4dfcff(0xfc)]>0x0){var _0x20fde4=0x0;const _0x177025=_0x301d85[_0x4dfcff(0x115)][_0x4dfcff(0x19b)](_0x3fff8f=>{var _0x4f55b5=_0x4dfcff;_0x3fff8f['product_name']==_0x48e760[_0x4f55b5(0xf5)]&&_0x3fff8f[_0x4f55b5(0x1be)]==_0x48e760[_0x4f55b5(0x139)]&&_0x3fff8f[_0x4f55b5(0x137)]==_0x48e760[_0x4f55b5(0x1c8)]&&_0x3fff8f[_0x4f55b5(0x167)]==_0x48e760[_0x4f55b5(0x123)]&&_0x3fff8f[_0x4f55b5(0x17a)]==_0x48e760[_0x4f55b5(0xfb)]&&_0x3fff8f[_0x4f55b5(0x13d)]==_0x48e760['rack']&&_0x3fff8f['storage']==_0x48e760['storage']&&(_0x3fff8f[_0x4f55b5(0x120)]=parseInt(_0x3fff8f[_0x4f55b5(0x120)])+parseInt(_0x48e760[_0x4f55b5(0xfc)]),_0x20fde4++);});_0x20fde4=='0'&&(_0x301d85[_0x4dfcff(0x115)]=_0x301d85['product_details'][_0x4dfcff(0x100)]({'product_name':_0x48e760['product_name'],'product_stock':_0x48e760[_0x4dfcff(0xfc)],'bay':_0x48e760[_0x4dfcff(0xfb)],'bin':_0x48e760['to_bin'],'type':_0x48e760[_0x4dfcff(0x1c8)],'floorlevel':_0x48e760[_0x4dfcff(0x139)],'storage':_0x48e760[_0x4dfcff(0x150)],'rack':_0x48e760['rack'],'product_code':_0x48e760[_0x4dfcff(0x1b2)],'primary_code':_0x48e760['primary_code'],'secondary_code':_0x48e760['secondary_code'],'maxProducts':_0x48e760['maxProducts'],'storage':_0x48e760['storage'],'rack':_0x48e760['rack']}));}}),await _0x301d85['save'](),_0x5eef6c[_0x3a7ce2(0x1b6)](_0x3a7ce2(0x183),'Transfer\x20Edit\x20Successfully'),_0x4666b9[_0x3a7ce2(0x110)]('/transfer/view');}catch(_0xa31515){console[_0x3a7ce2(0xfd)](_0xa31515);}}),router[a0_0x31bc84(0x1d8)](a0_0x31bc84(0x1aa),async(_0x5c0d07,_0x347830)=>{var _0xc36c0f=a0_0x31bc84;const {FromWareHouse:_0x156be7,FromRoom:_0x43f063,ToWarehouse:_0x24a758,ToRoom:_0x59c8fa,primary_code:_0x4abd4b,Roomslist:_0x1123fe}=_0x5c0d07['body'],_0x6bc00d=_0x1123fe[_0xc36c0f(0x1a0)](','),_0x2e58b9=[];async function _0x2fa900(_0x3275f7){var _0x11e3cb=_0xc36c0f;const _0x536dde=await warehouse[_0x11e3cb(0x16b)]([{'$match':{'name':_0x156be7,'room':_0x3275f7}},{'$unwind':_0x11e3cb(0x135)},{'$match':{'product_details.primary_code':_0x4abd4b}},{'$group':{'_id':_0x11e3cb(0x17b),'name':{'$first':_0x11e3cb(0x14e)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x11e3cb(0x169)},'secondary_code':{'$first':_0x11e3cb(0x1cc)},'product_code':{'$first':_0x11e3cb(0x192)},'level':{'$first':_0x11e3cb(0x11e)},'isle':{'$first':_0x11e3cb(0x116)},'type':{'$first':_0x11e3cb(0x182)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x11e3cb(0x159)},'secondary_unit':{'$first':_0x11e3cb(0x1b0)},'storage':{'$first':_0x11e3cb(0x121)},'rack':{'$first':_0x11e3cb(0x1d1)},'expiry_date':{'$first':_0x11e3cb(0x1a3)},'production_date':{'$first':_0x11e3cb(0x18a)},'batch_code':{'$first':_0x11e3cb(0x106)},'maxPerUnit':{'$first':_0x11e3cb(0x14a)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x11e3cb(0x1af)},'maxProducts':{'$first':_0x11e3cb(0x141)},'invoice_product':{'$first':_0x11e3cb(0x17d)}}}]),_0x4c93d6=await warehouse['aggregate']([{'$match':{'name':_0x156be7,'room':_0x3275f7}},{'$unwind':_0x11e3cb(0x135)},{'$match':{'product_details.secondary_code':_0x4abd4b}},{'$group':{'_id':_0x11e3cb(0x17b),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x11e3cb(0x162)},'primary_code':{'$first':_0x11e3cb(0x169)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x11e3cb(0x192)},'level':{'$first':_0x11e3cb(0x11e)},'isle':{'$first':_0x11e3cb(0x116)},'type':{'$first':_0x11e3cb(0x182)},'pallet':{'$first':_0x11e3cb(0x1d3)},'unit':{'$first':_0x11e3cb(0x159)},'secondary_unit':{'$first':_0x11e3cb(0x1b0)},'storage':{'$first':_0x11e3cb(0x121)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x11e3cb(0x1a3)},'production_date':{'$first':_0x11e3cb(0x18a)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x11e3cb(0x1af)},'maxProducts':{'$first':_0x11e3cb(0x141)},'invoice_product':{'$first':_0x11e3cb(0x17d)}}}]);if(_0x536dde['length']>0x0)_0x2e58b9[_0x11e3cb(0x132)](_0x536dde);else _0x4c93d6[_0x11e3cb(0x104)]>0x0&&_0x2e58b9[_0x11e3cb(0x132)](_0x4c93d6);}const _0x139f2b=_0x6bc00d[_0xc36c0f(0x19b)](_0x167fcd=>_0x2fa900(_0x167fcd));await Promise['all'](_0x139f2b),_0x347830[_0xc36c0f(0x118)](_0x2e58b9);}),router[a0_0x31bc84(0x1d8)](a0_0x31bc84(0x129),async(_0x48ca58,_0xda29cc)=>{var _0x173549=a0_0x31bc84;try{const {FromWareHouse:_0x54c7b0,FromRoom:_0xa2a55b,ToWarehouse:_0x58a294,ToRoom:_0x11b83a,secondary_code:_0x5d53b8}=_0x48ca58['body'],_0x59e9ab=await warehouse[_0x173549(0x16b)]([{'$match':{'name':_0x54c7b0}},{'$unwind':_0x173549(0x135)},{'$match':{'product_details.secondary_code':_0x5d53b8}},{'$group':{'_id':_0x173549(0x17b),'name':{'$first':_0x173549(0x14e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x173549(0x192)},'instock':{'$first':_0x173549(0x162)},'warehouse':{'$first':_0x173549(0x1d9)},'level':{'$first':_0x173549(0x1d7)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x173549(0x141)},'unit':{'$first':_0x173549(0x159)}}}]);_0xda29cc[_0x173549(0x189)](0xc8)[_0x173549(0x118)](_0x59e9ab);}catch(_0x5b4c9d){_0xda29cc[_0x173549(0x189)](0x194)[_0x173549(0x118)]({'message':_0x5b4c9d[_0x173549(0xef)]});}}),router[a0_0x31bc84(0x1d8)](a0_0x31bc84(0x15a),async(_0x5f3cda,_0x2b50ad)=>{var _0x4d01de=a0_0x31bc84;try{const {FromWareHouse:_0x55a0ed,FromRoom:_0x2252a6,ToWarehouse:_0x309c8c,ToRoom:_0x186674,product_code:_0x929345}=_0x5f3cda[_0x4d01de(0x17e)],_0x387b8d=await warehouse[_0x4d01de(0x16b)]([{'$match':{'name':_0x55a0ed}},{'$unwind':_0x4d01de(0x135)},{'$match':{'product_details.product_code':_0x929345}},{'$group':{'_id':_0x4d01de(0x17b),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x4d01de(0x169)},'secondary_code':{'$first':_0x4d01de(0x1cc)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x4d01de(0x1d9)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x4d01de(0x155)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x4d01de(0x141)},'unit':{'$first':'$product_details.unit'}}}]);_0x2b50ad[_0x4d01de(0x189)](0xc8)[_0x4d01de(0x118)](_0x387b8d);}catch(_0x3b2d2d){_0x2b50ad[_0x4d01de(0x189)](0x194)[_0x4d01de(0x118)]({'message':_0x3b2d2d[_0x4d01de(0xef)]});}}),router[a0_0x31bc84(0x1d8)](a0_0x31bc84(0x154),async(_0x2c0917,_0x59e7d5)=>{var _0x581c6a=a0_0x31bc84;const {level:_0x8ba71b,isle:_0x551860,pallet:_0x4f8409,warehouses:_0x3ced09,room:_0x17fbf1}=_0x2c0917['body'];try{const _0x491613=await warehouse[_0x581c6a(0x16b)]([{'$match':{'name':_0x3ced09,'room':_0x17fbf1}},{'$unwind':_0x581c6a(0x135)},{'$match':{'product_details.level':parseInt(_0x8ba71b),'product_details.isle':_0x551860,'product_details.pallet':parseInt(_0x4f8409)}},{'$group':{'_id':_0x581c6a(0x17b),'name':{'$first':_0x581c6a(0x14e)},'product_stock':{'$first':_0x581c6a(0x162)},'level':{'$first':_0x581c6a(0x1d7)},'isle':{'$first':_0x581c6a(0x155)},'pallet':{'$first':_0x581c6a(0x180)},'maxProducts':{'$first':_0x581c6a(0x141)}}}]);_0x59e7d5[_0x581c6a(0x189)](0xc8)[_0x581c6a(0x118)](_0x491613);}catch(_0x49fa2f){_0x59e7d5[_0x581c6a(0x189)](0x194)['json']({'message':_0x49fa2f[_0x581c6a(0xef)]});}}),module[a0_0x31bc84(0x1d5)]=router;