var a0_0x3b490a=a0_0x54ec;(function(_0x35c466,_0x4df879){var _0x5b925c=a0_0x54ec,_0x3b5237=_0x35c466();while(!![]){try{var _0x2974c9=parseInt(_0x5b925c(0xef))/0x1*(-parseInt(_0x5b925c(0x177))/0x2)+parseInt(_0x5b925c(0x131))/0x3*(parseInt(_0x5b925c(0x11d))/0x4)+-parseInt(_0x5b925c(0x118))/0x5+-parseInt(_0x5b925c(0x1d6))/0x6*(parseInt(_0x5b925c(0x13f))/0x7)+parseInt(_0x5b925c(0x17b))/0x8*(parseInt(_0x5b925c(0x11e))/0x9)+-parseInt(_0x5b925c(0x17f))/0xa+parseInt(_0x5b925c(0x194))/0xb;if(_0x2974c9===_0x4df879)break;else _0x3b5237['push'](_0x3b5237['shift']());}catch(_0x356957){_0x3b5237['push'](_0x3b5237['shift']());}}}(a0_0x19a8,0xa15e9));const express=require(a0_0x3b490a(0x1de)),app=express(),router=express[a0_0x3b490a(0x1d3)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x3b490a(0x156)),auth=require(a0_0x3b490a(0xea)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x3b490a(0xed));function a0_0x54ec(_0x538f6e,_0x4aae54){var _0x19a8ca=a0_0x19a8();return a0_0x54ec=function(_0x54ecd3,_0x5e4c62){_0x54ecd3=_0x54ecd3-0xe4;var _0x1fc2de=_0x19a8ca[_0x54ecd3];return _0x1fc2de;},a0_0x54ec(_0x538f6e,_0x4aae54);}function a0_0x19a8(){var _0x3c48c3=['<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Raw\x20Materials','$product_details.bin','$product_details.product_code','json','$isAllowEdit','$to_warehouse','<!DOCTYPE\x20html>','An\x20error\x20occurred.','from_bay','aggregate','Portuguese\x20(BR)','/transfer/view','310972YzsOsG','</body></html>','from_rak','to_prod_isle','6400152HvwaGx','_id','Rack\x20D','$from_warehouse','12487610IooBIp','maxProducts','id_transaction','to_room','<div>','findOne','/CheckingWarehouse','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.bay','Transfer\x20Edit\x20Successfully','Product\x20Transfer\x20successfully','toString','concat','Error\x20Occurs','Enabled','to_floorlevel','to_types','staff','$product_details.secondary_code','exports','render','15852100KyGTow','user','from_invoice','$product_details.type','flash','message','</h5>','Spanish','$invoice','$product_details.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Rack\x20C','/preview/:id','$product.to_room_name','Floor','to_prod_level','slice','<html><head><title></title>','from_quantity','body','logo','type','getFullYear','to_warehouse','post','<tbody\x20style=\x22text-align:\x20center;\x22>','English','$product','from_prod_level','Shelves','to_room_name','$product_details.batch_code','floor','maxperunit','$finalize','primary_unit','get','$product_details.unit','$room','$_id','$product_details.product_stock','$product_details.rack','password','bin','$product.from_room_name','Return\x20Rooms','Transfer\x20Finalize\x20Successfully','DRY\x20STORAGE','</div>','map','product_details','/view/:id','findById','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','errors','production_date','from_bin','Level','createTransport','unit','note','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','back','Router','$product_details.maxProducts','product_code3','4035996wOmIMY','<h5\x20style=\x22text-align:\x20left;\x22>','to_prod_pallet','rack','\x20Order\x20Date\x20:\x20','prod_name','Rack\x20A','Logo.png','express','from_warehouse','Rack\x20E','from_room','<h2>\x20','COLD\x20STORAGE','master','finalize','to_invoice','../middleware/auth','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','nodemailer','filter','1vBKeFW','True','transfer','invoice','$product_details','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product','/picking_list/PDF_transfer_rm/','$product_details.isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','all','params','/../public','edit_transfer_view','/view/add_transfer','English\x20(US)','from_prod_qty','from_room_name','German','then','storage','to_prod_qty','</td>','RoomAssigned','email','bay','padStart','New_Qty_Converted','error','$name','site_title','$product_details.storage','Enclosed','success','getMonth','Chinese','MaxStocks_data2','$product_details.production_date','Hindi','push','from_prod_isle','466630JMhBgR','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/view','string','status','54892JXZQoT','9MqYZkJ','To_invoice','warehouse','<tr>','$product_details.pallet','$product_details._id','$product_details.primary_code','TRF-','date','sendMail','max_per_unit','from_floorlevel','id_transaction_id','log','Arabic','</tbody>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','product_code','rak','129ppUipT','length','Portuguese','from_storage','Receiving\x20Area','batch_code','primary_code','ToRoomAssigned','$product_details.invoice','\x20Order\x20Number\x20:\x20','\x20</h2>','to_quantity','/barcode_scanner2','/barcode_scanner3','7waWJLg','</table>','redirect','French','from_prod_pallet','from_types','role','add_transfer','prod_cat','Arabic\x20(ae)','secondary_unit','Rack\x20B','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.secondary_unit','from_rack','<table\x20style=\x22width:\x20100%\x20!important;\x22>','host','secondary_code','Transfer\x20Mail','find','catch','to_bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','../models/all_models','floorlevel','here','forEach','Ambient','An\x20error\x20occurred\x20while\x20saving\x20data.','language','save','$product_details.maxPerUnit','</span>','</head><body>','\x20<>\x20','product_stock','random','$date','$product_details.expiry_date','$product_details.level','</tr>','to_bay','expiry_date'];a0_0x19a8=function(){return _0x3c48c3;};return a0_0x19a8();}router['get'](a0_0x3b490a(0x11a),auth,async(_0x38cc7f,_0x195453)=>{var _0x24350e=a0_0x3b490a;try{const {username:_0x32dc1f,email:_0x5c5434,role:_0x5242e4}=_0x38cc7f[_0x24350e(0x195)],_0x1be675=_0x38cc7f[_0x24350e(0x195)],_0x4b2895=await profile[_0x24350e(0x184)]({'email':_0x1be675[_0x24350e(0x107)]}),_0x22b82b=await master_shop[_0x24350e(0x152)]();console[_0x24350e(0x12b)](_0x24350e(0xe7),_0x22b82b);let _0x38ebc6;if(_0x1be675['role']==_0x24350e(0x190)){const _0x2b51f8=await staff[_0x24350e(0x184)]({'email':_0x1be675[_0x24350e(0x107)]});_0x38ebc6=await transfers[_0x24350e(0x152)]({'from_warehouse':_0x2b51f8[_0x24350e(0x120)]});}else _0x38ebc6=await transfers[_0x24350e(0x174)]([{'$unwind':_0x24350e(0x1af)},{'$group':{'_id':_0x24350e(0x1bb),'invoice':{'$first':_0x24350e(0x19c)},'date':{'$first':_0x24350e(0x164)},'from_warehouse':{'$first':_0x24350e(0x17e)},'to_warehouse':{'$first':_0x24350e(0x170)},'from_room_name':{'$addToSet':_0x24350e(0x1c0)},'to_room_name':{'$addToSet':_0x24350e(0x1a1)},'finalize':{'$first':_0x24350e(0x1b6)},'isAllowEdit':{'$first':_0x24350e(0x16f)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x22b82b[0x0][_0x24350e(0x15c)]=='English\x20(US)'){var _0xa382d7=users[_0x24350e(0x1ae)];console['log'](_0xa382d7);}else{if(_0x22b82b[0x0][_0x24350e(0x15c)]==_0x24350e(0x115))var _0xa382d7=users[_0x24350e(0x115)];else{if(_0x22b82b[0x0][_0x24350e(0x15c)]==_0x24350e(0x101))var _0xa382d7=users[_0x24350e(0x101)];else{if(_0x22b82b[0x0][_0x24350e(0x15c)]=='Spanish')var _0xa382d7=users[_0x24350e(0x19b)];else{if(_0x22b82b[0x0][_0x24350e(0x15c)]=='French')var _0xa382d7=users[_0x24350e(0x142)];else{if(_0x22b82b[0x0][_0x24350e(0x15c)]==_0x24350e(0x175))var _0xa382d7=users[_0x24350e(0x133)];else{if(_0x22b82b[0x0]['language']==_0x24350e(0x112))var _0xa382d7=users[_0x24350e(0x112)];else{if(_0x22b82b[0x0][_0x24350e(0x15c)]=='Arabic\x20(ae)')var _0xa382d7=users[_0x24350e(0x12c)];}}}}}}}_0x195453[_0x24350e(0x193)](_0x24350e(0xf1),{'success':_0x38cc7f[_0x24350e(0x198)](_0x24350e(0x110)),'errors':_0x38cc7f[_0x24350e(0x198)](_0x24350e(0x1ca)),'role':_0x1be675,'profile':_0x4b2895,'master_shop':_0x22b82b,'transfer':_0x38ebc6,'language':_0xa382d7});}catch(_0x278a40){console[_0x24350e(0x12b)](_0x278a40);}});async function getRandom8DigitNumber(){var _0x20c7cf=a0_0x3b490a;const _0x2f4d60=0x989680,_0x194baf=0x5f5e0ff,_0x1f1d79=Math[_0x20c7cf(0x1b4)](Math[_0x20c7cf(0x163)]()*(_0x194baf-_0x2f4d60+0x1))+_0x2f4d60;var _0x15a7c3;const _0x483572=await transfers[_0x20c7cf(0x184)]({'invoice':_0x20c7cf(0x125)+_0x1f1d79});return _0x483572&&_0x483572[_0x20c7cf(0x132)]>0x0?_0x15a7c3='TRF-'+_0x1f1d79:_0x15a7c3='TRF-'+_0x1f1d79,_0x15a7c3;}router[a0_0x3b490a(0x1b8)](a0_0x3b490a(0xfd),auth,async(_0x54a63a,_0x41e5fb)=>{var _0x4beb67=a0_0x3b490a;try{const {username:_0x44e1d0,email:_0x2dc7ad,role:_0x4cf5d1}=_0x54a63a[_0x4beb67(0x195)],_0x4cf31c=_0x54a63a[_0x4beb67(0x195)],_0x5dce9f=await profile['findOne']({'email':_0x4cf31c['email']}),_0x437e9f=await master_shop[_0x4beb67(0x152)]();console['log'](_0x4beb67(0xe7),_0x437e9f);let _0x30f593;if(_0x4cf31c['role']==_0x4beb67(0x190)){const _0x2c79d0=await staff[_0x4beb67(0x184)]({'email':_0x4cf31c[_0x4beb67(0x107)]});_0x30f593=await warehouse[_0x4beb67(0x174)]([{'$match':{'status':_0x4beb67(0x18d),'name':_0x2c79d0[_0x4beb67(0x120)],'warehouse_category':_0x4beb67(0x16b)}},{'$group':{'_id':'$name','name':{'$first':_0x4beb67(0x10c)}}}]);}else _0x30f593=await warehouse[_0x4beb67(0x174)]([{'$match':{'status':_0x4beb67(0x18d),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4beb67(0x10c),'name':{'$first':_0x4beb67(0x10c)}}}]);var _0x504ff0=[_0x4beb67(0x15a),_0x4beb67(0x10f),_0x4beb67(0x1c1)];const _0x113927=await transfers[_0x4beb67(0x152)]({}),_0x4d8fa3=_0x113927['length']+0x1,_0x491cbb='TRF-'+_0x4d8fa3[_0x4beb67(0x18a)]()[_0x4beb67(0x109)](0x5,'0');if(_0x437e9f[0x0][_0x4beb67(0x15c)]=='English\x20(US)'){var _0xe06d9c=users[_0x4beb67(0x1ae)];console['log'](_0xe06d9c);}else{if(_0x437e9f[0x0][_0x4beb67(0x15c)]=='Hindi')var _0xe06d9c=users[_0x4beb67(0x115)];else{if(_0x437e9f[0x0][_0x4beb67(0x15c)]=='German')var _0xe06d9c=users[_0x4beb67(0x101)];else{if(_0x437e9f[0x0][_0x4beb67(0x15c)]==_0x4beb67(0x19b))var _0xe06d9c=users[_0x4beb67(0x19b)];else{if(_0x437e9f[0x0][_0x4beb67(0x15c)]==_0x4beb67(0x142))var _0xe06d9c=users[_0x4beb67(0x142)];else{if(_0x437e9f[0x0][_0x4beb67(0x15c)]==_0x4beb67(0x175))var _0xe06d9c=users[_0x4beb67(0x133)];else{if(_0x437e9f[0x0][_0x4beb67(0x15c)]==_0x4beb67(0x112))var _0xe06d9c=users[_0x4beb67(0x112)];else{if(_0x437e9f[0x0][_0x4beb67(0x15c)]==_0x4beb67(0x148))var _0xe06d9c=users[_0x4beb67(0x12c)];}}}}}}}const _0x44b457=getRandom8DigitNumber();_0x44b457[_0x4beb67(0x102)](_0x3b2cb7=>{var _0x43b8f0=_0x4beb67;_0x41e5fb['render'](_0x43b8f0(0x146),{'success':_0x54a63a['flash'](_0x43b8f0(0x110)),'errors':_0x54a63a['flash'](_0x43b8f0(0x1ca)),'role':_0x4cf31c,'profile':_0x5dce9f,'master_shop':_0x437e9f,'warehouse':_0x30f593,'language':_0xe06d9c,'rooms_data':_0x504ff0,'invoice':_0x3b2cb7});})['catch'](_0x1dc7aa=>{var _0x38bda5=_0x4beb67;_0x54a63a[_0x38bda5(0x198)]('errors',_0x38bda5(0x119)),_0x41e5fb[_0x38bda5(0x141)](_0x38bda5(0x176));});}catch(_0x47e495){console[_0x4beb67(0x12b)](_0x47e495);}}),router['post']('/view/add_transfer',auth,async(_0x104f83,_0x345927)=>{var _0x19bfe4=a0_0x3b490a;try{console[_0x19bfe4(0x12b)](_0x104f83[_0x19bfe4(0x1a7)]);const {date:_0x1d17f6,from_warehouse:_0x2a75d6,FromRoom_name:_0x548167,to_warehouse:_0x53d476,ToRoom_name:_0xf99451,prod_name:_0x5b8c86,from_prod_qty:_0x3a6978,from_prod_level:_0x385413,from_prod_isle:_0x79f548,from_prod_pallet:_0x24c12b,to_prod_qty:_0x410473,to_prod_level:_0x111091,to_prod_isle:_0x1d400b,to_prod_pallet:_0x352b93,primary_code:_0x366320,secondary_code:_0x5e5892,product_code3:_0x24b12b,note:_0x55191a,MaxStocks_data2:_0x98295e,invoice:_0x17482a,expiry_date:_0xecfbda}=_0x104f83['body'];if(typeof _0x5b8c86==_0x19bfe4(0x11b))var _0x16cf02=[_0x104f83['body']['prod_name']],_0x376e87=[_0x104f83['body'][_0x19bfe4(0xff)]],_0x4e1b96=[_0x104f83[_0x19bfe4(0x1a7)]['from_prod_level']],_0x5117e6=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x10a)]],_0x35b46e=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x1a3)]],_0x3f2cd9=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x137)]],_0x558c23=[_0x104f83[_0x19bfe4(0x1a7)]['secondary_code']],_0xf2efc8=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x1d5)]],_0x371614=[_0x104f83[_0x19bfe4(0x1a7)]['MaxStocks_data2']],_0x393bd3=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x1b7)]],_0x47caeb=[_0x104f83[_0x19bfe4(0x1a7)]['secondary_unit']],_0x5c7deb=[_0x104f83[_0x19bfe4(0x1a7)]['batch_code']],_0x3b9b00=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x169)]],_0x2e5303=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x128)]],_0x95ff76=[_0x104f83[_0x19bfe4(0x1a7)]['production_date']],_0x17eeba=[_0x104f83['body'][_0x19bfe4(0x147)]],_0x2aff42=[_0x104f83['body'][_0x19bfe4(0x106)]],_0x3a238e=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x138)]],_0x5d8754=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x196)]],_0x189547=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0xe9)]],_0x556cf0=[_0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x181)]];else var _0x16cf02=[..._0x104f83[_0x19bfe4(0x1a7)]['prod_name']],_0x376e87=[..._0x104f83['body'][_0x19bfe4(0xff)]],_0x4e1b96=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x1b0)]],_0x5117e6=[..._0x104f83['body']['New_Qty_Converted']],_0x35b46e=[..._0x104f83['body'][_0x19bfe4(0x1a3)]],_0x3f2cd9=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x137)]],_0x558c23=[..._0x104f83['body'][_0x19bfe4(0x150)]],_0xf2efc8=[..._0x104f83[_0x19bfe4(0x1a7)]['product_code3']],_0x371614=[..._0x104f83[_0x19bfe4(0x1a7)]['MaxStocks_data2']],_0x393bd3=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x1b7)]],_0x47caeb=[..._0x104f83['body'][_0x19bfe4(0x149)]],_0x5c7deb=[..._0x104f83['body'][_0x19bfe4(0x136)]],_0x3b9b00=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x169)]],_0x2e5303=[..._0x104f83[_0x19bfe4(0x1a7)]['max_per_unit']],_0x95ff76=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x1cb)]],_0x17eeba=[..._0x104f83['body']['prod_cat']],_0x2aff42=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x106)]],_0x3a238e=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x138)]],_0x5d8754=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x196)]],_0x189547=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0xe9)]],_0x556cf0=[..._0x104f83[_0x19bfe4(0x1a7)][_0x19bfe4(0x181)]];const _0x4a67e2=_0x16cf02[_0x19bfe4(0x1c5)](_0x1839bb=>{return _0x1839bb={'product_name':_0x1839bb};});_0x376e87[_0x19bfe4(0x159)]((_0x7b7847,_0x486889)=>{_0x4a67e2[_0x486889]['from_quantity']=_0x7b7847;}),_0x5d8754[_0x19bfe4(0x159)]((_0x423c19,_0x1aca2f)=>{var _0x277887=_0x19bfe4;_0x4a67e2[_0x1aca2f][_0x277887(0x196)]=_0x423c19;}),_0x189547[_0x19bfe4(0x159)]((_0x4f0a11,_0x5a16f5)=>{var _0x366c32=_0x19bfe4;_0x4a67e2[_0x5a16f5][_0x366c32(0x11f)]=_0x4f0a11;}),_0x556cf0[_0x19bfe4(0x159)]((_0x459098,_0x33f7f0)=>{var _0xcbbe04=_0x19bfe4;_0x4a67e2[_0x33f7f0][_0xcbbe04(0x12a)]=_0x459098;}),_0x4e1b96['forEach']((_0x347850,_0x171937)=>{var _0x4f9b79=_0x19bfe4;_0x2aff42[_0x4f9b79(0x159)]((_0x37bf78,_0xe64262)=>{var _0x15f6c1=_0x4f9b79;if(_0x37bf78=='Receiving\x20Area'&&_0x171937==_0xe64262){var _0x3fe583=_0x347850[_0x15f6c1(0x1a4)](0x3);_0x4a67e2[_0x171937][_0x15f6c1(0x134)]=_0x347850[0x0],_0x4a67e2[_0x171937][_0x15f6c1(0x14d)]=_0x347850[0x1],_0x4a67e2[_0x171937][_0x15f6c1(0x173)]=0x0,_0x4a67e2[_0x171937][_0x15f6c1(0x1cc)]=0x0,_0x4a67e2[_0x171937][_0x15f6c1(0x144)]=_0x15f6c1(0x1a2),_0x4a67e2[_0x171937][_0x15f6c1(0x129)]=_0x3fe583;}else{if(_0x37bf78==_0x15f6c1(0x1b1)&&_0x171937==_0xe64262){var _0x3fe583=_0x347850['slice'](0x3);_0x4a67e2[_0x171937][_0x15f6c1(0x134)]=_0x347850[0x0],_0x4a67e2[_0x171937][_0x15f6c1(0x14d)]=_0x347850[0x1],_0x4a67e2[_0x171937][_0x15f6c1(0x173)]=0x0,_0x4a67e2[_0x171937][_0x15f6c1(0x1cc)]=0x0,_0x4a67e2[_0x171937]['from_types']=_0x15f6c1(0x1a2),_0x4a67e2[_0x171937][_0x15f6c1(0x129)]=_0x347850[0x5];}else{if(_0x171937==_0xe64262){if(_0x347850[0x0]=='A'&&_0x347850[0x1]=='L'&&_0x347850[0x2]=='L')console[_0x15f6c1(0x12b)](_0x37bf78+'\x20<>\x20'+_0x171937+_0x15f6c1(0x161)+_0xe64262+_0x15f6c1(0x161)+_0x347850+_0x15f6c1(0x158)),_0x4a67e2[_0x171937][_0x15f6c1(0x134)]=_0x347850[0x0],_0x4a67e2[_0x171937][_0x15f6c1(0x14d)]=_0x347850[0x1],_0x4a67e2[_0x171937]['from_bay']=0x0,_0x4a67e2[_0x171937][_0x15f6c1(0x1cc)]=0x0,_0x4a67e2[_0x171937]['from_types']=_0x15f6c1(0x1a2),_0x4a67e2[_0x171937][_0x15f6c1(0x129)]=_0x347850[0x3];else{var _0x5a8a28;if(_0x347850[0x4]=='L')_0x5a8a28=_0x15f6c1(0x1cd);else _0x347850[0x4]=='F'&&(_0x5a8a28='Floor');_0x4a67e2[_0x171937][_0x15f6c1(0x134)]=_0x347850[0x0],_0x4a67e2[_0x171937]['from_rack']=_0x347850[0x1],_0x4a67e2[_0x171937]['from_bay']=_0x347850[0x2],_0x4a67e2[_0x171937][_0x15f6c1(0x1cc)]=_0x347850[0x3],_0x4a67e2[_0x171937][_0x15f6c1(0x144)]=_0x5a8a28,_0x4a67e2[_0x171937][_0x15f6c1(0x129)]=_0x347850[0x5];}}}}});}),_0x5117e6[_0x19bfe4(0x159)]((_0x3a71b9,_0x4c7097)=>{_0x4a67e2[_0x4c7097]['to_quantity']=_0x3a71b9;}),_0x35b46e['forEach']((_0x422bc0,_0x5cd5bc)=>{var _0x30ab96=_0x19bfe4;_0x3a238e[_0x30ab96(0x159)]((_0x4ef5af,_0x3f1190)=>{var _0x4cbc74=_0x30ab96;if(_0x4ef5af=='Receiving\x20Area'&&_0x5cd5bc==_0x3f1190){var _0x272269=_0x422bc0['slice'](0x3);_0x4a67e2[_0x5cd5bc]['storage']=_0x422bc0[0x0],_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x1d9)]=_0x422bc0[0x1],_0x4a67e2[_0x5cd5bc]['to_bay']=0x0,_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x154)]=0x0,_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x18f)]=_0x4cbc74(0x1a2),_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x18e)]=_0x272269;}else{if(_0x4ef5af==_0x4cbc74(0x1b1)&&_0x5cd5bc==_0x3f1190){var _0x272269=_0x422bc0[_0x4cbc74(0x1a4)](0x3);_0x4a67e2[_0x5cd5bc]['storage']=_0x422bc0[0x0],_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x1d9)]=_0x422bc0[0x1],_0x4a67e2[_0x5cd5bc]['to_bay']=0x0,_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x154)]=0x0,_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x18f)]=_0x4cbc74(0x1a2),_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x18e)]=_0x422bc0[0x5];}else{if(_0x5cd5bc==_0x3f1190){if(_0x422bc0[0x0]=='A'&&_0x422bc0[0x1]=='L'&&_0x422bc0[0x2]=='L')console[_0x4cbc74(0x12b)](_0x4ef5af+_0x4cbc74(0x161)+_0x5cd5bc+_0x4cbc74(0x161)+_0x3f1190+_0x4cbc74(0x161)+_0x422bc0+_0x4cbc74(0x158)),_0x4a67e2[_0x5cd5bc]['storage']=_0x422bc0[0x0],_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x1d9)]=_0x422bc0[0x1],_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x168)]=0x0,_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x154)]=0x0,_0x4a67e2[_0x5cd5bc]['to_types']=_0x4cbc74(0x1a2),_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x18e)]=_0x422bc0[0x3];else{var _0x41a4b2;if(_0x422bc0[0x4]=='L')_0x41a4b2=_0x4cbc74(0x1cd);else _0x422bc0[0x4]=='F'&&(_0x41a4b2=_0x4cbc74(0x1a2));_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x103)]=_0x422bc0[0x0],_0x4a67e2[_0x5cd5bc]['rack']=_0x422bc0[0x1],_0x4a67e2[_0x5cd5bc]['to_bay']=_0x422bc0[0x2],_0x4a67e2[_0x5cd5bc]['to_bin']=_0x422bc0[0x3],_0x4a67e2[_0x5cd5bc]['to_types']=_0x41a4b2,_0x4a67e2[_0x5cd5bc][_0x4cbc74(0x18e)]=_0x422bc0[0x5];}}}}});}),_0x3f2cd9['forEach']((_0x175335,_0x4df135)=>{var _0x334bd7=_0x19bfe4;_0x4a67e2[_0x4df135][_0x334bd7(0x137)]=_0x175335;}),_0x558c23[_0x19bfe4(0x159)]((_0x1ea4d3,_0x2bcdc6)=>{var _0x28ce2f=_0x19bfe4;_0x4a67e2[_0x2bcdc6][_0x28ce2f(0x150)]=_0x1ea4d3;}),_0xf2efc8[_0x19bfe4(0x159)]((_0x4e6151,_0x32255d)=>{var _0xa7e5c1=_0x19bfe4;_0x4a67e2[_0x32255d][_0xa7e5c1(0x12f)]=_0x4e6151;}),_0x371614[_0x19bfe4(0x159)]((_0x3ff426,_0x1aabc0)=>{var _0x1f97aa=_0x19bfe4;_0x4a67e2[_0x1aabc0][_0x1f97aa(0x180)]=_0x3ff426;}),_0x393bd3[_0x19bfe4(0x159)]((_0x867f3c,_0xf55000)=>{var _0x514827=_0x19bfe4;_0x4a67e2[_0xf55000][_0x514827(0x1cf)]=_0x867f3c;}),_0x47caeb[_0x19bfe4(0x159)]((_0x5e43fe,_0x531bdd)=>{_0x4a67e2[_0x531bdd]['secondary_unit']=_0x5e43fe;}),_0x5c7deb[_0x19bfe4(0x159)]((_0x22fb1c,_0x36bb7)=>{_0x4a67e2[_0x36bb7]['batch_code']=_0x22fb1c;}),_0x3b9b00[_0x19bfe4(0x159)]((_0x131514,_0x1919f0)=>{var _0x33f872=_0x19bfe4;_0x4a67e2[_0x1919f0][_0x33f872(0x169)]=_0x131514;}),_0x2e5303[_0x19bfe4(0x159)]((_0xb75fa3,_0x495143)=>{var _0xd9b4d3=_0x19bfe4;_0x4a67e2[_0x495143][_0xd9b4d3(0x1b5)]=_0xb75fa3;}),_0x95ff76[_0x19bfe4(0x159)]((_0x172a88,_0x1dd60c)=>{_0x4a67e2[_0x1dd60c]['production_date']=_0x172a88;}),_0x17eeba['forEach']((_0x2e77bd,_0x4bb385)=>{_0x4a67e2[_0x4bb385]['prod_cat']=_0x2e77bd;}),_0x2aff42[_0x19bfe4(0x159)]((_0x27a382,_0x34ee88)=>{var _0x55560e=_0x19bfe4;_0x4a67e2[_0x34ee88][_0x55560e(0x100)]=_0x27a382;}),_0x3a238e[_0x19bfe4(0x159)]((_0x386dc2,_0x3afe2d)=>{var _0x16050c=_0x19bfe4;_0x4a67e2[_0x3afe2d][_0x16050c(0x1b2)]=_0x386dc2;});const _0x2c6fd8=_0x4a67e2[_0x19bfe4(0xee)](_0x120903=>_0x120903[_0x19bfe4(0x13c)]!=='0'&&_0x120903[_0x19bfe4(0x13c)]!==''||_0x120903[_0x19bfe4(0x18e)]!=='0'&&_0x120903[_0x19bfe4(0x18e)]!==''),_0x30fe27=new transfers({'date':_0x1d17f6,'from_warehouse':_0x2a75d6,'to_warehouse':_0x53d476,'product':_0x2c6fd8,'note':_0x55191a,'invoice':_0x17482a}),_0x3ad3db=await _0x30fe27[_0x19bfe4(0x15d)]();_0x104f83[_0x19bfe4(0x198)](_0x19bfe4(0x110),_0x19bfe4(0x189)),_0x345927[_0x19bfe4(0x141)]('/transfer/preview/'+_0x3ad3db[_0x19bfe4(0x17c)]);}catch(_0x214c34){console[_0x19bfe4(0x12b)](_0x214c34),_0x345927[_0x19bfe4(0x11c)](0xc8)['json']({'errorMessage':_0x214c34[_0x19bfe4(0x199)]});}}),router[a0_0x3b490a(0x1b8)](a0_0x3b490a(0x1a0),auth,async(_0x27e06f,_0x3caeff)=>{var _0x22335=a0_0x3b490a;try{const {username:_0x4f3959,email:_0x5983f4,role:_0x24c8ab}=_0x27e06f[_0x22335(0x195)],_0x56f62e=_0x27e06f['user'],_0x465e39=await profile[_0x22335(0x184)]({'email':_0x56f62e['email']}),_0x2cd54a=await master_shop['find']();console[_0x22335(0x12b)]('master',_0x2cd54a);const _0xa0cbcf=await transfers[_0x22335(0x1c8)](_0x27e06f[_0x22335(0xfa)]['id']);let _0x14cca0=new Date(_0xa0cbcf[_0x22335(0x169)]),_0x539723=('0'+_0x14cca0['getDate']())[_0x22335(0x1a4)](-0x2),_0x2063ae=('0'+(_0x14cca0[_0x22335(0x111)]()+0x1))['slice'](-0x2),_0x181148=_0x14cca0[_0x22335(0x1aa)](),_0x1d6af7=_0x181148+'-'+_0x2063ae+'-'+_0x539723,_0xb2691;if(_0x56f62e['role']==_0x22335(0x190)){const _0x522f5f=await staff[_0x22335(0x184)]({'email':_0x56f62e['email']});_0xb2691=await warehouse[_0x22335(0x152)]({'status':_0x22335(0x18d),'name':_0x522f5f['warehouse'],'warehouse_category':'Raw\x20Materials'});}else _0xb2691=await warehouse['find']({'status':_0x22335(0x18d),'warehouse_category':'Raw\x20Materials'});const _0x45a3aa=await warehouse['aggregate']([{'$match':{'name':_0xa0cbcf[_0x22335(0x1df)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x22335(0x123),'name':{'$first':_0x22335(0x19d)},'product_stock':{'$first':_0x22335(0x1bc)},'bay':{'$first':_0x22335(0x187)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x22335(0x197)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x22335(0x124)},'secondary_code':{'$first':_0x22335(0x191)},'product_code':{'$first':_0x22335(0x16d)},'storage':{'$first':_0x22335(0x10e)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x22335(0x165)},'production_date':{'$first':_0x22335(0x114)},'room':{'$first':_0x22335(0x1ba)}}}]);if(_0x2cd54a[0x0][_0x22335(0x15c)]==_0x22335(0xfe)){var _0x4d8a03=users[_0x22335(0x1ae)];console[_0x22335(0x12b)](_0x4d8a03);}else{if(_0x2cd54a[0x0][_0x22335(0x15c)]==_0x22335(0x115))var _0x4d8a03=users[_0x22335(0x115)];else{if(_0x2cd54a[0x0][_0x22335(0x15c)]=='German')var _0x4d8a03=users[_0x22335(0x101)];else{if(_0x2cd54a[0x0][_0x22335(0x15c)]=='Spanish')var _0x4d8a03=users[_0x22335(0x19b)];else{if(_0x2cd54a[0x0][_0x22335(0x15c)]==_0x22335(0x142))var _0x4d8a03=users[_0x22335(0x142)];else{if(_0x2cd54a[0x0][_0x22335(0x15c)]==_0x22335(0x175))var _0x4d8a03=users[_0x22335(0x133)];else{if(_0x2cd54a[0x0][_0x22335(0x15c)]==_0x22335(0x112))var _0x4d8a03=users[_0x22335(0x112)];else{if(_0x2cd54a[0x0][_0x22335(0x15c)]==_0x22335(0x148))var _0x4d8a03=users['Arabic'];}}}}}}}_0x3caeff[_0x22335(0x193)](_0x22335(0xfc),{'success':_0x27e06f[_0x22335(0x198)](_0x22335(0x110)),'errors':_0x27e06f[_0x22335(0x198)](_0x22335(0x1ca)),'role':_0x56f62e,'profile':_0x465e39,'master_shop':_0x2cd54a,'warehouse':_0xb2691,'transfer':_0xa0cbcf,'stock':_0x45a3aa,'language':_0x4d8a03});}catch(_0x31342e){console[_0x22335(0x12b)](_0x31342e);}}),router[a0_0x3b490a(0x1ac)](a0_0x3b490a(0x1a0),auth,async(_0x36b11e,_0x2cc2ad)=>{var _0x194c11=a0_0x3b490a;try{const _0x35402a=_0x36b11e[_0x194c11(0xfa)]['id'],{from_warehouse:_0x15e396,FromRoom_name:_0x3b871e,to_warehouse:_0x4e778d,ToRoom_name:_0x5d9377}=_0x36b11e[_0x194c11(0x1a7)],_0x4d52ae=await transfers['findById']({'_id':_0x35402a}),_0x3acecb=_0x4d52ae[_0x194c11(0xf5)][_0x194c11(0x1c5)](async _0x59ede7=>{var _0x3cef90=_0x194c11;if(_0x59ede7['to_quantity']>0x0){var _0x271d82=await warehouse['findOne']({'name':_0x4d52ae[_0x3cef90(0x1df)],'room':_0x59ede7[_0x3cef90(0x100)],'warehouse_category':_0x3cef90(0x16b)});const _0x38978f=_0x271d82['product_details'][_0x3cef90(0x1c5)](_0x123861=>{var _0x431475=_0x3cef90;_0x123861['product_name']==_0x59ede7['product_name']&&_0x123861[_0x431475(0x157)]==_0x59ede7[_0x431475(0x129)]&&_0x123861[_0x431475(0x1a9)]==_0x59ede7['from_types']&&_0x123861['bin']==_0x59ede7[_0x431475(0x1cc)]&&_0x123861['bay']==_0x59ede7[_0x431475(0x173)]&&_0x123861[_0x431475(0x1d9)]==_0x59ede7['from_rack']&&_0x123861['storage']==_0x59ede7[_0x431475(0x134)]&&_0x123861[_0x431475(0x169)]==_0x59ede7[_0x431475(0x169)]&&_0x123861[_0x431475(0x136)]==_0x59ede7[_0x431475(0x136)]&&_0x123861['production_date']==_0x59ede7[_0x431475(0x1cb)]&&_0x123861['invoice']==_0x59ede7[_0x431475(0x196)]&&_0x123861[_0x431475(0x17c)]==_0x59ede7[_0x431475(0x12a)]&&(_0x123861[_0x431475(0x162)]=_0x123861['product_stock']-_0x59ede7[_0x431475(0x13c)]);});}return _0x271d82;});Promise['all'](_0x3acecb)['then'](async _0xcbe9ba=>{var _0x48e3eb=_0x194c11;try{for(const _0x3e2bf8 of _0xcbe9ba){await _0x3e2bf8[_0x48e3eb(0x15d)]();}try{const _0x5d51c0=_0x4d52ae[_0x48e3eb(0xf5)][_0x48e3eb(0x1c5)](async _0x4bda65=>{var _0x47c8ca=_0x48e3eb;if(_0x4bda65['to_quantity']>0x0){var _0x2342a0=await warehouse[_0x47c8ca(0x184)]({'name':_0x4d52ae[_0x47c8ca(0x1ab)],'room':_0x4bda65[_0x47c8ca(0x1b2)],'warehouse_category':'Raw\x20Materials'}),_0x51af1d=0x0;const _0x2a0fd7=_0x2342a0[_0x47c8ca(0x1c6)]['map'](_0x2e5c4a=>{var _0x52f1a4=_0x47c8ca;_0x2e5c4a[_0x52f1a4(0xeb)]==_0x4bda65[_0x52f1a4(0xeb)]&&_0x2e5c4a[_0x52f1a4(0x157)]==_0x4bda65['to_floorlevel']&&_0x2e5c4a[_0x52f1a4(0x1a9)]==_0x4bda65['to_types']&&_0x2e5c4a[_0x52f1a4(0x1bf)]==_0x4bda65['to_bin']&&_0x2e5c4a[_0x52f1a4(0x108)]==_0x4bda65['to_bay']&&_0x2e5c4a[_0x52f1a4(0x1d9)]==_0x4bda65[_0x52f1a4(0x1d9)]&&_0x2e5c4a[_0x52f1a4(0x103)]==_0x4bda65[_0x52f1a4(0x103)]&&_0x2e5c4a[_0x52f1a4(0x169)]==_0x4bda65[_0x52f1a4(0x169)]&&_0x2e5c4a['batch_code']==_0x4bda65[_0x52f1a4(0x136)]&&_0x2e5c4a['production_date']==_0x4bda65['production_date']&&_0x2e5c4a[_0x52f1a4(0xf2)]==_0x4bda65[_0x52f1a4(0x11f)]&&(_0x2e5c4a['product_stock']=_0x2e5c4a['product_stock']+_0x4bda65[_0x52f1a4(0x13c)],_0x51af1d++);});_0x51af1d=='0'&&(_0x2342a0[_0x47c8ca(0x1c6)]=_0x2342a0['product_details'][_0x47c8ca(0x18b)]({'product_name':_0x4bda65[_0x47c8ca(0xeb)],'product_stock':_0x4bda65[_0x47c8ca(0x13c)],'bay':_0x4bda65[_0x47c8ca(0x168)],'bin':_0x4bda65['to_bin'],'type':_0x4bda65['to_types'],'floorlevel':_0x4bda65[_0x47c8ca(0x18e)],'storage':_0x4bda65[_0x47c8ca(0x103)],'rack':_0x4bda65['rack'],'product_code':_0x4bda65['product_code'],'primary_code':_0x4bda65[_0x47c8ca(0x137)],'secondary_code':_0x4bda65[_0x47c8ca(0x150)],'maxProducts':_0x4bda65[_0x47c8ca(0x180)],'storage':_0x4bda65['storage'],'rack':_0x4bda65[_0x47c8ca(0x1d9)],'expiry_date':_0x4bda65['expiry_date'],'maxPerUnit':_0x4bda65[_0x47c8ca(0x1b5)],'batch_code':_0x4bda65[_0x47c8ca(0x136)],'production_date':_0x4bda65[_0x47c8ca(0x1cb)]}));}return _0x2342a0;});Promise[_0x48e3eb(0xf9)](_0x5d51c0)[_0x48e3eb(0x102)](async _0x256d46=>{var _0x28b31b=_0x48e3eb;try{for(const _0x3b3bed of _0x256d46){await warehouse['updateOne']({'_id':_0x3b3bed['_id']},{'$addToSet':{'product_details':{'$each':_0x3b3bed[_0x28b31b(0x1c6)]}}});}_0x4d52ae[_0x28b31b(0xe8)]=_0x28b31b(0xf0);const _0x24cd28=await _0x4d52ae['save'](),_0x4882f4=await master_shop[_0x28b31b(0x152)](),_0x557f19=await email_settings[_0x28b31b(0x184)](),_0x3c9915=await supervisor_settings[_0x28b31b(0x152)]();var _0x5b5992=_0x4d52ae[_0x28b31b(0xf5)],_0x2cdf49='',_0x1af523;for(_0x1af523 in _0x5b5992){_0x2cdf49+=_0x28b31b(0x121)+_0x28b31b(0xf4)+_0x5b5992[_0x1af523]['product_name']+'</td>'+_0x28b31b(0xf4)+_0x5b5992[_0x1af523][_0x28b31b(0x12f)]+_0x28b31b(0x105)+_0x28b31b(0xf4)+_0x5b5992[_0x1af523][_0x28b31b(0x13c)]+_0x28b31b(0x105)+_0x28b31b(0xf4)+_0x5b5992[_0x1af523][_0x28b31b(0x1cf)]+'</td>'+_0x28b31b(0xf4)+_0x5b5992[_0x1af523][_0x28b31b(0x149)]+_0x28b31b(0x105)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4d52ae[_0x28b31b(0x1ab)]+_0x28b31b(0x105)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5b5992[_0x1af523][_0x28b31b(0x1b2)]+'</td>'+_0x28b31b(0xf4)+_0x5b5992[_0x1af523]['storage']+_0x5b5992[_0x1af523]['rack']+_0x5b5992[_0x1af523][_0x28b31b(0x168)]+_0x5b5992[_0x1af523][_0x28b31b(0x154)]+_0x5b5992[_0x1af523][_0x28b31b(0x18f)][0x0]+_0x5b5992[_0x1af523][_0x28b31b(0x18e)]+'</td>',_0x28b31b(0x167);}let _0x1497f3=nodemailer[_0x28b31b(0x1ce)]({'host':_0x557f19[_0x28b31b(0x14f)],'port':Number(_0x557f19['port']),'secure':![],'auth':{'user':_0x557f19[_0x28b31b(0x107)],'pass':_0x557f19[_0x28b31b(0x1be)]}}),_0x32bea6={'from':_0x557f19['email'],'to':_0x3c9915[0x0]['RMSEmail'],'subject':_0x28b31b(0x151),'attachments':[{'filename':_0x28b31b(0x1dd),'path':__dirname+_0x28b31b(0xfb)+'/upload/'+_0x4882f4[0x0]['image'],'cid':_0x28b31b(0x1a8)}],'html':_0x28b31b(0x171)+_0x28b31b(0x1a5)+_0x28b31b(0x160)+_0x28b31b(0x183)+_0x28b31b(0x12e)+_0x28b31b(0x183)+_0x28b31b(0x1d1)+'</div>'+_0x28b31b(0x183)+_0x28b31b(0xe5)+_0x4882f4[0x0][_0x28b31b(0x10d)]+_0x28b31b(0x13b)+_0x28b31b(0x1c4)+_0x28b31b(0x1c4)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x28b31b(0x1d7)+_0x28b31b(0x13a)+_0x4d52ae[_0x28b31b(0xf2)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x28b31b(0x1da)+_0x4d52ae[_0x28b31b(0x126)]+'\x20'+_0x28b31b(0x15f)+'</h5>'+_0x28b31b(0x1c4)+_0x28b31b(0x14e)+_0x28b31b(0x1c9)+_0x28b31b(0x121)+_0x28b31b(0xec)+_0x28b31b(0x16a)+_0x28b31b(0x155)+_0x28b31b(0x19e)+_0x28b31b(0xf8)+_0x28b31b(0x14b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+'</thead>'+_0x28b31b(0x1ad)+'\x20'+_0x2cdf49+'\x20'+_0x28b31b(0x12d)+_0x28b31b(0x140)+_0x28b31b(0x183)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x4882f4[0x0][_0x28b31b(0x10d)]+_0x28b31b(0x19a)+_0x28b31b(0x1c4)+_0x28b31b(0x1c4)+_0x28b31b(0x178)};_0x1497f3[_0x28b31b(0x127)](_0x32bea6,function(_0x542e32,_0x48c3b8){var _0x15b452=_0x28b31b;_0x542e32?(console[_0x15b452(0x12b)](_0x542e32),console[_0x15b452(0x12b)](_0x15b452(0x18c))):console[_0x15b452(0x12b)]('Email\x20sent\x20successfully');}),_0x36b11e[_0x28b31b(0x198)](_0x28b31b(0x110),_0x28b31b(0x1c2)),_0x2cc2ad[_0x28b31b(0x141)](_0x28b31b(0xf6)+_0x24cd28['_id']);}catch(_0x528cf8){console['error'](_0x528cf8),_0x2cc2ad['status'](0x1f4)[_0x28b31b(0x16e)]({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x528cf8[_0x28b31b(0x199)]});}})[_0x48e3eb(0x153)](_0x147372=>{var _0x5e3d23=_0x48e3eb;console[_0x5e3d23(0x10b)](_0x147372),_0x2cc2ad[_0x5e3d23(0x11c)](0x1f4)[_0x5e3d23(0x16e)]({'Perror':_0x5e3d23(0x172)});});}catch(_0x1bec00){_0x2cc2ad[_0x48e3eb(0x16e)](_0x1bec00);}}catch(_0x8e9e24){console[_0x48e3eb(0x10b)](_0x8e9e24),_0x2cc2ad[_0x48e3eb(0x11c)](0x1f4)[_0x48e3eb(0x16e)]({'Merror':_0x48e3eb(0x15b),'Message':_0x8e9e24[_0x48e3eb(0x199)]});}})[_0x194c11(0x153)](_0xd83188=>{var _0x500dc4=_0x194c11;console['error'](_0xd83188),_0x2cc2ad[_0x500dc4(0x11c)](0x1f4)[_0x500dc4(0x16e)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x3c65c0){console[_0x194c11(0x12b)](_0x3c65c0);}});function BayBinSelected(_0x22b93a,_0x3ae454){var _0x4124c2=a0_0x3b490a,_0x23499b=[],_0x5b47e6=[],_0x167e2f=[],_0x4d6d6f=[],_0x789b0c=[],_0x58e7fb=[];let _0xc91b69=[];if(_0x22b93a==_0x4124c2(0x1c3))switch(_0x3ae454){case _0x4124c2(0x1dc):_0x23499b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x5b47e6=[0x1,0x2],_0x4d6d6f=[0x1,0x2,0x3,0x4,0x5],_0x167e2f=[_0x4124c2(0x1cd),_0x4124c2(0x1a2)],_0x789b0c=['D'],_0x58e7fb=['A'];break;case _0x4124c2(0x14a):_0x23499b=[0x6,0x5,0x4,0x3,0x2,0x1],_0x5b47e6=[0x1,0x2],_0x4d6d6f=[0x1,0x2,0x3,0x4,0x5],_0x167e2f=[_0x4124c2(0x1cd),'Floor'],_0x789b0c=['D'],_0x58e7fb=['B'];break;case'Shelves':_0x23499b=[0x0],_0x5b47e6=[0x0],_0x4d6d6f=[0x1,0x2,0x3,0x4,0x5],_0x167e2f=['Floor'],_0x789b0c=['D'],_0x58e7fb=['S'];break;case _0x4124c2(0x135):_0x23499b=[0x0],_0x5b47e6=[0x0],_0x4d6d6f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x167e2f=[_0x4124c2(0x1a2)],_0x789b0c=['D'],_0x58e7fb=['R'];break;}else{if(_0x22b93a==_0x4124c2(0xe6))switch(_0x3ae454){case'Rack\x20A':_0x23499b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x5b47e6=['B','F'],_0x4d6d6f=[0x1,0x2,0x3,0x4,0x5],_0x167e2f=[_0x4124c2(0x1cd),_0x4124c2(0x1a2)],_0x789b0c=['C'],_0x58e7fb=['A'];break;case _0x4124c2(0x14a):_0x23499b=[0x5,0x4,0x3,0x2,0x1],_0x5b47e6=['F','B','S'],_0x4d6d6f=[0x1,0x2,0x3,0x4,0x5],_0x167e2f=[_0x4124c2(0x1cd),'Floor'],_0x789b0c=['C'],_0x58e7fb=['B'];break;case _0x4124c2(0x19f):_0x23499b=[0x1,0x2,0x3,0x4,0x5],_0x5b47e6=['B','F','S'],_0x4d6d6f=[0x5,0x4,0x3,0x2,0x1],_0x167e2f=[_0x4124c2(0x1cd),_0x4124c2(0x1a2)],_0x789b0c=['C'],_0x58e7fb=['C'];break;case _0x4124c2(0x17d):_0x23499b=[0x5,0x4,0x3,0x2,0x1],_0x5b47e6=['F','B','S'],_0x4d6d6f=[0x1,0x2,0x3,0x4,0x5],_0x167e2f=[_0x4124c2(0x1cd),_0x4124c2(0x1a2)],_0x789b0c=['C'],_0x58e7fb=['D'];break;case _0x4124c2(0x1e0):_0x23499b=[0x4,0x3,0x2,0x1],_0x5b47e6=[0x1,0x2],_0x4d6d6f=[0x1,0x2,0x3,0x4,0x5],_0x167e2f=['Level',_0x4124c2(0x1a2)],_0x789b0c=['C'],_0x58e7fb=['E'];break;case'Rack\x20F':_0x23499b=[0x1,0x2,0x3],_0x5b47e6=[0x1,0x2],_0x4d6d6f=[0x1,0x2,0x3,0x4,0x5],_0x167e2f=[_0x4124c2(0x1cd)],_0x789b0c=['C'],_0x58e7fb=['F'];break;}}return{'levels':_0x23499b,'Isle':_0x5b47e6,'rack':_0x4d6d6f,'type':_0x167e2f,'storage':_0x789b0c,'rak':_0x58e7fb};}router[a0_0x3b490a(0x1b8)]('/view/:id',auth,async(_0x9840b2,_0x1b63aa)=>{var _0x41f06a=a0_0x3b490a;try{const {username:_0x480d5e,email:_0x18410d,role:_0x5543f4}=_0x9840b2[_0x41f06a(0x195)],_0x1ca737=_0x9840b2[_0x41f06a(0x195)],_0x34c20b=await profile[_0x41f06a(0x184)]({'email':_0x1ca737[_0x41f06a(0x107)]}),_0x3c70d2=await master_shop[_0x41f06a(0x152)](),_0x5df848=await transfers[_0x41f06a(0x1c8)](_0x9840b2[_0x41f06a(0xfa)]['id']);let _0x514cd9;if(_0x1ca737[_0x41f06a(0x145)]==_0x41f06a(0x190)){const _0x246325=await staff['findOne']({'email':_0x1ca737[_0x41f06a(0x107)]});_0x514cd9=await warehouse[_0x41f06a(0x174)]([{'$match':{'status':_0x41f06a(0x18d),'name':_0x246325[_0x41f06a(0x120)],'warehouse_category':_0x41f06a(0x16b)}},{'$group':{'_id':_0x41f06a(0x10c),'name':{'$first':_0x41f06a(0x10c)}}}]);}else _0x514cd9=await warehouse[_0x41f06a(0x174)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x41f06a(0x10c)}}}]);const _0x1830da=await warehouse[_0x41f06a(0x174)]([{'$match':{'name':_0x5df848[_0x41f06a(0x1df)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x41f06a(0x123),'name':{'$first':_0x41f06a(0x19d)},'product_stock':{'$first':_0x41f06a(0x1bc)},'bay':{'$first':_0x41f06a(0x187)},'bin':{'$first':_0x41f06a(0x16c)},'type':{'$first':_0x41f06a(0x197)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x41f06a(0x124)},'secondary_code':{'$first':_0x41f06a(0x191)},'product_code':{'$first':_0x41f06a(0x16d)},'storage':{'$first':_0x41f06a(0x10e)},'rack':{'$first':_0x41f06a(0x1bd)},'expiry_date':{'$first':_0x41f06a(0x165)},'production_date':{'$first':_0x41f06a(0x114)},'room':{'$first':'$room'}}}]),_0x416fd8=await product[_0x41f06a(0x152)]({}),_0x7ecd1e=BayBinSelected(_0x5df848['to_warehouse'],_0x5df848[_0x41f06a(0x182)]);if(_0x3c70d2[0x0][_0x41f06a(0x15c)]==_0x41f06a(0xfe)){var _0x24acb2=users[_0x41f06a(0x1ae)];console[_0x41f06a(0x12b)](_0x24acb2);}else{if(_0x3c70d2[0x0][_0x41f06a(0x15c)]==_0x41f06a(0x115))var _0x24acb2=users[_0x41f06a(0x115)];else{if(_0x3c70d2[0x0][_0x41f06a(0x15c)]==_0x41f06a(0x101))var _0x24acb2=users[_0x41f06a(0x101)];else{if(_0x3c70d2[0x0][_0x41f06a(0x15c)]=='Spanish')var _0x24acb2=users[_0x41f06a(0x19b)];else{if(_0x3c70d2[0x0][_0x41f06a(0x15c)]==_0x41f06a(0x142))var _0x24acb2=users[_0x41f06a(0x142)];else{if(_0x3c70d2[0x0][_0x41f06a(0x15c)]==_0x41f06a(0x175))var _0x24acb2=users[_0x41f06a(0x133)];else{if(_0x3c70d2[0x0]['language']==_0x41f06a(0x112))var _0x24acb2=users[_0x41f06a(0x112)];else{if(_0x3c70d2[0x0]['language']==_0x41f06a(0x148))var _0x24acb2=users[_0x41f06a(0x12c)];}}}}}}}_0x1b63aa[_0x41f06a(0x193)]('edit_transfer',{'success':_0x9840b2[_0x41f06a(0x198)]('success'),'errors':_0x9840b2['flash'](_0x41f06a(0x1ca)),'role':_0x1ca737,'profile':_0x34c20b,'master_shop':_0x3c70d2,'warehouse':_0x514cd9,'transfer':_0x5df848,'stock':_0x1830da,'unit':_0x416fd8,'language':_0x24acb2});}catch(_0x3c8624){console[_0x41f06a(0x12b)](_0x3c8624);}}),router[a0_0x3b490a(0x1ac)](a0_0x3b490a(0x1c7),auth,async(_0x232b18,_0x3e9648)=>{var _0x29222c=a0_0x3b490a;try{const _0x57bba5=_0x232b18[_0x29222c(0xfa)]['id'],_0x301df9=await transfers[_0x29222c(0x1c8)](_0x57bba5);_0x3e9648[_0x29222c(0x16e)](_0x232b18[_0x29222c(0x1a7)]);return;const {date:_0x3f4702,from_warehouse:_0x270e15,FromRoom_name:_0x22c209,to_warehouse:_0x216f35,ToRoom_name:_0x3f24f4,prod_name:_0x5823c8,from_prod_qty:_0x4ff886,from_prod_level:_0x727780,from_prod_isle:_0x634c35,from_prod_pallet:_0x613afb,to_prod_qty:_0x1cf19d,to_prod_level:_0x112a26,to_prod_isle:_0x1d0ee8,to_prod_pallet:_0x3abce2,primary_code:_0x4a376c,secondary_code:_0x5c99cb,product_code3:_0x4159b9,note:_0x58eb8f,invoice:_0x4761ac,expiry_date:_0x4050ce}=_0x232b18[_0x29222c(0x1a7)];if(typeof _0x5823c8==_0x29222c(0x11b))var _0x40ce71=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x1db)]],_0x30e6f5=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0xff)]],_0x1c9668=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x1b0)]],_0xe2c0d1=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x117)]],_0xf12cc3=[_0x232b18['body'][_0x29222c(0x143)]],_0x3a0718=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x144)]],_0x1ff27f=[_0x232b18['body'][_0x29222c(0x104)]],_0x30e49b=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x1a3)]],_0x168789=[_0x232b18['body'][_0x29222c(0x17a)]],_0x3626df=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x1d8)]],_0x4ca3b9=[_0x232b18['body'][_0x29222c(0x18f)]],_0x5b6bd2=[_0x232b18[_0x29222c(0x1a7)]['storage']],_0x57ead0=[_0x232b18[_0x29222c(0x1a7)]['rak']],_0x3c344f=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x137)]],_0xc9bbdd=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x150)]],_0x5acdd8=[_0x232b18['body'][_0x29222c(0x1d5)]],_0x11bb52=[_0x232b18['body'][_0x29222c(0x113)]],_0x4600a3=[_0x232b18['body'][_0x29222c(0x1cf)]],_0x4798af=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x149)]],_0x5bb989=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x136)]],_0x5b978b=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x169)]],_0x5949c2=[_0x232b18['body'][_0x29222c(0x134)]],_0x9232c0=[_0x232b18[_0x29222c(0x1a7)][_0x29222c(0x179)]];else var _0x40ce71=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x1db)]],_0x5b6bd2=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x103)]],_0x57ead0=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x130)]],_0x3a0718=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x144)]],_0x4ca3b9=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x18f)]],_0x30e6f5=[..._0x232b18[_0x29222c(0x1a7)]['from_prod_qty']],_0x1c9668=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x1b0)]],_0xe2c0d1=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x117)]],_0xf12cc3=[..._0x232b18[_0x29222c(0x1a7)]['from_prod_pallet']],_0x1ff27f=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x104)]],_0x30e49b=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x1a3)]],_0x168789=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x17a)]],_0x3626df=[..._0x232b18[_0x29222c(0x1a7)]['to_prod_pallet']],_0x3c344f=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x137)]],_0xc9bbdd=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x150)]],_0x5acdd8=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x1d5)]],_0x11bb52=[..._0x232b18[_0x29222c(0x1a7)]['MaxStocks_data2']],_0x4600a3=[..._0x232b18[_0x29222c(0x1a7)]['unit']],_0x4798af=[..._0x232b18['body'][_0x29222c(0x149)]],_0x5bb989=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x136)]],_0x5b978b=[..._0x232b18['body'][_0x29222c(0x169)]],_0x5949c2=[..._0x232b18['body'][_0x29222c(0x134)]],_0x9232c0=[..._0x232b18[_0x29222c(0x1a7)][_0x29222c(0x179)]];const _0x10f6ed=_0x40ce71['map'](_0x4db116=>{return _0x4db116={'product_name':_0x4db116};});_0x30e6f5[_0x29222c(0x159)]((_0x33836a,_0x84b37)=>{var _0x5048c2=_0x29222c;_0x10f6ed[_0x84b37][_0x5048c2(0x1a6)]=_0x33836a;}),_0x1c9668[_0x29222c(0x159)]((_0x581624,_0x3cda6f)=>{var _0x4a6cca=_0x29222c;_0x10f6ed[_0x3cda6f][_0x4a6cca(0x173)]=_0x581624;}),_0xe2c0d1['forEach']((_0x4aed1d,_0x1bd22f)=>{_0x10f6ed[_0x1bd22f]['from_bin']=_0x4aed1d;}),_0xf12cc3[_0x29222c(0x159)]((_0x110aa7,_0x234d68)=>{var _0x5cd7c1=_0x29222c;_0x10f6ed[_0x234d68][_0x5cd7c1(0x129)]=_0x110aa7;}),_0x1ff27f[_0x29222c(0x159)]((_0x3221f,_0x46ade5)=>{var _0x2309ef=_0x29222c;_0x10f6ed[_0x46ade5][_0x2309ef(0x13c)]=_0x3221f;}),_0x30e49b[_0x29222c(0x159)]((_0x42451d,_0x3b0b0a)=>{var _0x15e63b=_0x29222c;_0x10f6ed[_0x3b0b0a][_0x15e63b(0x168)]=_0x42451d;}),_0x168789[_0x29222c(0x159)]((_0x1d4907,_0x1d2631)=>{_0x10f6ed[_0x1d2631]['to_bin']=_0x1d4907;}),_0x3626df[_0x29222c(0x159)]((_0x11e369,_0x1f5b37)=>{var _0xe354c4=_0x29222c;_0x10f6ed[_0x1f5b37][_0xe354c4(0x18e)]=_0x11e369;}),_0x3c344f[_0x29222c(0x159)]((_0x5f0e2f,_0x3bf339)=>{var _0x15f1c9=_0x29222c;_0x10f6ed[_0x3bf339][_0x15f1c9(0x137)]=_0x5f0e2f;}),_0xc9bbdd['forEach']((_0x234e26,_0xd2c51f)=>{var _0x5ecd68=_0x29222c;_0x10f6ed[_0xd2c51f][_0x5ecd68(0x150)]=_0x234e26;}),_0x5acdd8[_0x29222c(0x159)]((_0xd5b358,_0x5dbf8c)=>{var _0x38830c=_0x29222c;_0x10f6ed[_0x5dbf8c][_0x38830c(0x12f)]=_0xd5b358;}),_0x11bb52['forEach']((_0x22cd88,_0x5fed93)=>{_0x10f6ed[_0x5fed93]['maxProducts']=_0x22cd88;}),_0x4600a3['forEach']((_0x209c62,_0x3a82b3)=>{var _0x47e84c=_0x29222c;_0x10f6ed[_0x3a82b3][_0x47e84c(0x1cf)]=_0x209c62;}),_0x4798af[_0x29222c(0x159)]((_0x4b07ce,_0x28e080)=>{var _0x447c4a=_0x29222c;_0x10f6ed[_0x28e080][_0x447c4a(0x149)]=_0x4b07ce;}),_0x5bb989['forEach']((_0x46f191,_0x2cf4e6)=>{_0x10f6ed[_0x2cf4e6]['batch_code']=_0x46f191;}),_0x5b978b[_0x29222c(0x159)]((_0x4238,_0x16f6bb)=>{var _0x5347e8=_0x29222c;_0x10f6ed[_0x16f6bb][_0x5347e8(0x169)]=_0x4238;}),_0x5b6bd2[_0x29222c(0x159)]((_0x1a4812,_0x4ec508)=>{var _0x5575a1=_0x29222c;_0x10f6ed[_0x4ec508][_0x5575a1(0x103)]=_0x1a4812;}),_0x57ead0[_0x29222c(0x159)]((_0x39ed83,_0x3b81ab)=>{var _0x5ed49c=_0x29222c;_0x10f6ed[_0x3b81ab][_0x5ed49c(0x1d9)]=_0x39ed83;}),_0x3a0718[_0x29222c(0x159)]((_0x46887e,_0x4e360c)=>{var _0x31a338=_0x29222c;_0x10f6ed[_0x4e360c][_0x31a338(0x144)]=_0x46887e;}),_0x4ca3b9['forEach']((_0x571c69,_0x12a608)=>{var _0x24748e=_0x29222c;_0x10f6ed[_0x12a608][_0x24748e(0x18f)]=_0x571c69;}),_0x5949c2['forEach']((_0x38053f,_0x267e54)=>{var _0x587472=_0x29222c;_0x10f6ed[_0x267e54][_0x587472(0x134)]=_0x38053f;}),_0x9232c0['forEach']((_0x2c2081,_0x1242e3)=>{_0x10f6ed[_0x1242e3]['from_rack']=_0x2c2081;});const _0x445037=_0x10f6ed['filter'](_0x4e2784=>_0x4e2784[_0x29222c(0x13c)]!=='0'&&_0x4e2784[_0x29222c(0x13c)]!==''||_0x4e2784[_0x29222c(0x18e)]!=='0'&&_0x4e2784['to_floorlevel']!=='');var _0x1802b4=0x0;_0x445037['forEach'](_0x5e64c1=>{var _0xc27d9a=_0x29222c;parseInt(_0x5e64c1[_0xc27d9a(0x1a6)])<parseInt(_0x5e64c1['to_quantity'])&&_0x1802b4++;});if(_0x1802b4!=0x0)return _0x232b18['flash'](_0x29222c(0x1ca),_0x29222c(0x186)),_0x3e9648[_0x29222c(0x141)](_0x29222c(0x1d2));const _0x3ee6c9=await warehouse['findOne']({'name':_0x301df9[_0x29222c(0x1df)],'room':_0x301df9[_0x29222c(0xe4)]});_0x301df9['product'][_0x29222c(0x159)](_0x46f089=>{var _0x12494e=_0x29222c;if(_0x46f089[_0x12494e(0x13c)]>0x0){const _0x55d0d8=_0x3ee6c9[_0x12494e(0x1c6)][_0x12494e(0x1c5)](_0x484348=>{var _0xe47b32=_0x12494e;_0x484348['product_name']==_0x46f089['product_name']&&_0x484348[_0xe47b32(0x157)]==_0x46f089[_0xe47b32(0x129)]&&_0x484348[_0xe47b32(0x1a9)]==_0x46f089[_0xe47b32(0x144)]&&_0x484348[_0xe47b32(0x1bf)]==_0x46f089[_0xe47b32(0x1cc)]&&_0x484348[_0xe47b32(0x108)]==_0x46f089[_0xe47b32(0x173)]&&_0x484348[_0xe47b32(0x1d9)]==_0x46f089[_0xe47b32(0x14d)]&&_0x484348[_0xe47b32(0x103)]==_0x46f089[_0xe47b32(0x134)]&&(_0x484348[_0xe47b32(0x162)]=parseInt(_0x484348['product_stock'])+parseInt(_0x46f089[_0xe47b32(0x13c)]));});}}),await _0x3ee6c9[_0x29222c(0x15d)]();const _0x2d9879=await warehouse[_0x29222c(0x184)]({'name':_0x301df9[_0x29222c(0x1ab)],'room':_0x301df9[_0x29222c(0x182)]});_0x301df9[_0x29222c(0xf5)]['forEach'](_0x56834e=>{var _0x431e41=_0x29222c;if(_0x56834e[_0x431e41(0x13c)]>0x0){const _0x3e6ab4=_0x2d9879[_0x431e41(0x1c6)][_0x431e41(0x1c5)](_0xcd37b7=>{var _0x4ec623=_0x431e41;_0xcd37b7[_0x4ec623(0xeb)]==_0x56834e[_0x4ec623(0xeb)]&&_0xcd37b7['floorlevel']==_0x56834e['to_floorlevel']&&_0xcd37b7[_0x4ec623(0x1a9)]==_0x56834e[_0x4ec623(0x18f)]&&_0xcd37b7[_0x4ec623(0x1bf)]==_0x56834e['to_bin']&&_0xcd37b7[_0x4ec623(0x108)]==_0x56834e[_0x4ec623(0x168)]&&_0xcd37b7[_0x4ec623(0x1d9)]==_0x56834e[_0x4ec623(0x1d9)]&&_0xcd37b7[_0x4ec623(0x103)]==_0x56834e[_0x4ec623(0x103)]&&(_0xcd37b7['product_stock']=parseInt(_0xcd37b7[_0x4ec623(0x162)])-parseInt(_0x56834e['to_quantity']));});}}),await _0x2d9879[_0x29222c(0x15d)](),_0x301df9[_0x29222c(0x126)]=_0x3f4702,_0x301df9[_0x29222c(0x1df)]=_0x270e15,_0x301df9['to_warehouse']=_0x216f35,_0x301df9[_0x29222c(0xf5)]=_0x445037,_0x301df9[_0x29222c(0x1d0)]=_0x58eb8f,_0x301df9[_0x29222c(0xf2)]=_0x4761ac;const _0x3897a8=await _0x301df9[_0x29222c(0x15d)]();console[_0x29222c(0x12b)](_0x3897a8);const _0x345366=await warehouse[_0x29222c(0x184)]({'name':_0x270e15,'room':_0x22c209});_0x3897a8[_0x29222c(0xf5)][_0x29222c(0x159)](_0x5b8826=>{var _0x2f44df=_0x29222c;if(_0x5b8826[_0x2f44df(0x13c)]>0x0){const _0xb705ee=_0x345366[_0x2f44df(0x1c6)]['map'](_0x50cce4=>{var _0x5bb9eb=_0x2f44df;_0x50cce4[_0x5bb9eb(0xeb)]==_0x5b8826['product_name']&&_0x50cce4[_0x5bb9eb(0x157)]==_0x5b8826[_0x5bb9eb(0x129)]&&_0x50cce4['type']==_0x5b8826['from_types']&&_0x50cce4[_0x5bb9eb(0x1bf)]==_0x5b8826['from_bin']&&_0x50cce4[_0x5bb9eb(0x108)]==_0x5b8826['from_bay']&&_0x50cce4[_0x5bb9eb(0x1d9)]==_0x5b8826[_0x5bb9eb(0x14d)]&&_0x50cce4[_0x5bb9eb(0x103)]==_0x5b8826['from_storage']&&(_0x50cce4[_0x5bb9eb(0x162)]=parseInt(_0x50cce4['product_stock'])-parseInt(_0x5b8826[_0x5bb9eb(0x13c)]));});}}),await _0x345366['save']();const _0x2dbd26=await warehouse[_0x29222c(0x184)]({'name':_0x216f35,'room':_0x3f24f4});_0x3897a8['product']['forEach'](_0x463ce7=>{var _0x3a5690=_0x29222c;if(_0x463ce7['to_quantity']>0x0){var _0x2fd85a=0x0;const _0x27a1db=_0x2dbd26[_0x3a5690(0x1c6)][_0x3a5690(0x1c5)](_0x2ea1f4=>{var _0x4001c1=_0x3a5690;_0x2ea1f4[_0x4001c1(0xeb)]==_0x463ce7[_0x4001c1(0xeb)]&&_0x2ea1f4[_0x4001c1(0x157)]==_0x463ce7[_0x4001c1(0x18e)]&&_0x2ea1f4['type']==_0x463ce7[_0x4001c1(0x18f)]&&_0x2ea1f4[_0x4001c1(0x1bf)]==_0x463ce7[_0x4001c1(0x154)]&&_0x2ea1f4[_0x4001c1(0x108)]==_0x463ce7[_0x4001c1(0x168)]&&_0x2ea1f4[_0x4001c1(0x1d9)]==_0x463ce7[_0x4001c1(0x1d9)]&&_0x2ea1f4[_0x4001c1(0x103)]==_0x463ce7[_0x4001c1(0x103)]&&(_0x2ea1f4[_0x4001c1(0x162)]=parseInt(_0x2ea1f4[_0x4001c1(0x162)])+parseInt(_0x463ce7[_0x4001c1(0x13c)]),_0x2fd85a++);});_0x2fd85a=='0'&&(_0x2dbd26['product_details']=_0x2dbd26['product_details'][_0x3a5690(0x18b)]({'product_name':_0x463ce7[_0x3a5690(0xeb)],'product_stock':_0x463ce7[_0x3a5690(0x13c)],'bay':_0x463ce7[_0x3a5690(0x168)],'bin':_0x463ce7['to_bin'],'type':_0x463ce7[_0x3a5690(0x18f)],'floorlevel':_0x463ce7[_0x3a5690(0x18e)],'storage':_0x463ce7['storage'],'rack':_0x463ce7['rack'],'product_code':_0x463ce7[_0x3a5690(0x12f)],'primary_code':_0x463ce7['primary_code'],'secondary_code':_0x463ce7[_0x3a5690(0x150)],'maxProducts':_0x463ce7[_0x3a5690(0x180)],'storage':_0x463ce7['storage'],'rack':_0x463ce7[_0x3a5690(0x1d9)]}));}}),await _0x2dbd26['save'](),_0x232b18[_0x29222c(0x198)](_0x29222c(0x110),_0x29222c(0x188)),_0x3e9648[_0x29222c(0x141)](_0x29222c(0x176));}catch(_0x51c5ae){console[_0x29222c(0x12b)](_0x51c5ae);}}),router[a0_0x3b490a(0x1ac)]('/barcode_scanner',async(_0x3c4b9b,_0x22ca78)=>{var _0x290ce8=a0_0x3b490a;const {FromWareHouse:_0x3169b4,FromRoom:_0x143a33,ToWarehouse:_0x409a2b,ToRoom:_0x164ba6,primary_code:_0x569541,Roomslist:_0x1d10f8}=_0x3c4b9b[_0x290ce8(0x1a7)],_0xdb3452=_0x1d10f8['split'](','),_0x5c0b2a=[];async function _0xfbe9ae(_0x1fe388){var _0x1a2094=_0x290ce8;const _0x45c5bd=await warehouse[_0x1a2094(0x174)]([{'$match':{'name':_0x3169b4,'room':_0x1fe388}},{'$unwind':_0x1a2094(0xf3)},{'$match':{'product_details.primary_code':_0x569541}},{'$group':{'_id':_0x1a2094(0x123),'name':{'$first':_0x1a2094(0x19d)},'instock':{'$first':_0x1a2094(0x1bc)},'primary_code':{'$first':_0x1a2094(0x124)},'secondary_code':{'$first':_0x1a2094(0x191)},'product_code':{'$first':_0x1a2094(0x16d)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x1a2094(0x16c)},'type':{'$first':_0x1a2094(0x197)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x1a2094(0x14c)},'storage':{'$first':_0x1a2094(0x10e)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1a2094(0x165)},'production_date':{'$first':_0x1a2094(0x114)},'batch_code':{'$first':_0x1a2094(0x1b3)},'maxPerUnit':{'$first':_0x1a2094(0x15e)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x1a2094(0x1ba)},'maxProducts':{'$first':_0x1a2094(0x1d4)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x24d834=await warehouse['aggregate']([{'$match':{'name':_0x3169b4,'room':_0x1fe388}},{'$unwind':_0x1a2094(0xf3)},{'$match':{'product_details.secondary_code':_0x569541}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1a2094(0x19d)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x1a2094(0x124)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1a2094(0x16d)},'level':{'$first':_0x1a2094(0x187)},'isle':{'$first':_0x1a2094(0x16c)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1a2094(0x1b9)},'secondary_unit':{'$first':_0x1a2094(0x14c)},'storage':{'$first':_0x1a2094(0x10e)},'rack':{'$first':_0x1a2094(0x1bd)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1a2094(0x114)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x1a2094(0x15e)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x1a2094(0x1ba)},'maxProducts':{'$first':_0x1a2094(0x1d4)},'invoice_product':{'$first':_0x1a2094(0x139)}}}]);if(_0x45c5bd[_0x1a2094(0x132)]>0x0)_0x5c0b2a[_0x1a2094(0x116)](_0x45c5bd);else _0x24d834[_0x1a2094(0x132)]>0x0&&_0x5c0b2a[_0x1a2094(0x116)](_0x24d834);}const _0x3a9d40=_0xdb3452[_0x290ce8(0x1c5)](_0x12de97=>_0xfbe9ae(_0x12de97));await Promise['all'](_0x3a9d40),_0x22ca78['json'](_0x5c0b2a);}),router['post'](a0_0x3b490a(0x13d),async(_0x41319b,_0x129c12)=>{var _0x4d83c5=a0_0x3b490a;try{const {FromWareHouse:_0x38754b,FromRoom:_0x34c7d7,ToWarehouse:_0xe4d100,ToRoom:_0xe56369,secondary_code:_0x72fc6f}=_0x41319b[_0x4d83c5(0x1a7)],_0x48f6ba=await warehouse[_0x4d83c5(0x174)]([{'$match':{'name':_0x38754b}},{'$unwind':_0x4d83c5(0xf3)},{'$match':{'product_details.secondary_code':_0x72fc6f}},{'$group':{'_id':_0x4d83c5(0x123),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x4d83c5(0x124)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4d83c5(0x16d)},'instock':{'$first':_0x4d83c5(0x1bc)},'warehouse':{'$first':_0x4d83c5(0x10c)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x4d83c5(0xf7)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x4d83c5(0x1d4)},'unit':{'$first':_0x4d83c5(0x1b9)}}}]);_0x129c12[_0x4d83c5(0x11c)](0xc8)[_0x4d83c5(0x16e)](_0x48f6ba);}catch(_0x183218){_0x129c12[_0x4d83c5(0x11c)](0x194)[_0x4d83c5(0x16e)]({'message':_0x183218['message']});}}),router['post'](a0_0x3b490a(0x13e),async(_0x4f2697,_0xd5f478)=>{var _0x49a880=a0_0x3b490a;try{const {FromWareHouse:_0x244227,FromRoom:_0x57b499,ToWarehouse:_0x494702,ToRoom:_0x2ca1ba,product_code:_0x2876a4}=_0x4f2697[_0x49a880(0x1a7)],_0xe9a6d9=await warehouse['aggregate']([{'$match':{'name':_0x244227}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x2876a4}},{'$group':{'_id':_0x49a880(0x123),'name':{'$first':_0x49a880(0x19d)},'primary_code':{'$first':_0x49a880(0x124)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x49a880(0x1bc)},'warehouse':{'$first':_0x49a880(0x10c)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x49a880(0xf7)},'pallet':{'$first':_0x49a880(0x122)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x49a880(0x1b9)}}}]);_0xd5f478['status'](0xc8)[_0x49a880(0x16e)](_0xe9a6d9);}catch(_0x2d55f8){_0xd5f478[_0x49a880(0x11c)](0x194)[_0x49a880(0x16e)]({'message':_0x2d55f8['message']});}}),router[a0_0x3b490a(0x1ac)](a0_0x3b490a(0x185),async(_0x44804f,_0x1def83)=>{var _0x533029=a0_0x3b490a;const {level:_0xba6140,isle:_0x31fdde,pallet:_0x26e34b,warehouses:_0x568d7f,room:_0x4ea8be}=_0x44804f[_0x533029(0x1a7)];try{const _0x3eb06a=await warehouse['aggregate']([{'$match':{'name':_0x568d7f,'room':_0x4ea8be}},{'$unwind':_0x533029(0xf3)},{'$match':{'product_details.level':parseInt(_0xba6140),'product_details.isle':_0x31fdde,'product_details.pallet':parseInt(_0x26e34b)}},{'$group':{'_id':_0x533029(0x123),'name':{'$first':_0x533029(0x19d)},'product_stock':{'$first':_0x533029(0x1bc)},'level':{'$first':_0x533029(0x166)},'isle':{'$first':_0x533029(0xf7)},'pallet':{'$first':_0x533029(0x122)},'maxProducts':{'$first':_0x533029(0x1d4)}}}]);_0x1def83[_0x533029(0x11c)](0xc8)['json'](_0x3eb06a);}catch(_0x386d74){_0x1def83[_0x533029(0x11c)](0x194)['json']({'message':_0x386d74[_0x533029(0x199)]});}}),module[a0_0x3b490a(0x192)]=router;