var a0_0x4856a5=a0_0x5817;(function(_0x247131,_0x1dfb8b){var _0x27cc71=a0_0x5817,_0x3fb4ab=_0x247131();while(!![]){try{var _0x13782a=-parseInt(_0x27cc71(0x17a))/0x1*(parseInt(_0x27cc71(0xd0))/0x2)+parseInt(_0x27cc71(0x195))/0x3+-parseInt(_0x27cc71(0x1a8))/0x4+-parseInt(_0x27cc71(0x13e))/0x5*(-parseInt(_0x27cc71(0xc0))/0x6)+parseInt(_0x27cc71(0x174))/0x7+-parseInt(_0x27cc71(0x13b))/0x8+parseInt(_0x27cc71(0xfb))/0x9*(parseInt(_0x27cc71(0x144))/0xa);if(_0x13782a===_0x1dfb8b)break;else _0x3fb4ab['push'](_0x3fb4ab['shift']());}catch(_0x243dde){_0x3fb4ab['push'](_0x3fb4ab['shift']());}}}(a0_0x15c9,0x8bf71));function a0_0x15c9(){var _0x4c28bd=['from_bin','/CheckingWarehouse','updateOne','True','$to_warehouse','add_transfer','$product_details.bay','from_floorlevel','../models/all_models','from_invoice','redirect','$product_details.product_stock','1628658mXYrGU','production_date','getMonth','New_Qty_Converted','to_room_name','role','Return\x20Rooms','\x20<>\x20','prod_name','/../public','staff','primary_unit','date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','password','$product_details.product_name','Raw\x20Materials','from_room','transfer','2591644JvzAqf','Spanish','to_room','To_invoice','to_bin','</div>','</tr>','to_bay','$room','findById','810fmEaMd','post','string','Level','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','nodemailer','$product_details.type','Enabled','image','$product_details._id','Arabic','<html><head><title></title>','/preview/:id','aggregate','to_quantity','master','1057088URHiWG','$product_details.unit','express','to_prod_qty','/upload/','$product_details.floorlevel','to_floorlevel','Receiving\x20Area','storage','email','TRF-','</span>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','rack','Rack\x20D','/view/:id','from_bay','host','../middleware/auth','product_details','<!DOCTYPE\x20html>','</table>','<h5\x20style=\x22text-align:\x20left;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Chinese','</h5>','$name','prod_cat','params','$product_details.batch_code','$product_details.maxPerUnit','edit_transfer_view','<strong>\x20Regards\x20</strong>','$product_details.maxProducts','English\x20(US)','\x20Order\x20Date\x20:\x20','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','French','$invoice','getFullYear','language','9KspjTI','from_rak','forEach','Portuguese','$product_details.production_date','map','from_warehouse','product_name','<h2>\x20','<table\x20style=\x22width:\x20100%\x20!important;\x22>','here','id_transaction_id','find','split','/transfer/view','secondary_code','<span\x20style=\x22float:\x20right;\x22>','slice','errors','from_prod_isle','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Shelves','$product_details.secondary_unit','/view/add_transfer','findOne','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','COLD\x20STORAGE','then','$_id','Hindi','save','from_prod_qty','$product_details.isle','site_title','from_prod_level','floorlevel','MaxStocks_data2','logo','from_rack','Portuguese\x20(BR)','max_per_unit','rak','to_prod_level','user','createTransport','product_code3','message','from_storage','get','batch_code','/picking_list/PDF_transfer_rm/','Rack\x20B','filter','flash','$product_details.expiry_date','success','to_prod_isle','$product_details','Router','</tbody>','maxperunit','secondary_unit','Rack\x20A','2138472njyDSv','note','Ambient','150FhxiUS','to_invoice','to_warehouse','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','concat','ToRoomAssigned','7802790KpBWdX','edit_transfer','push','Floor','random','getDate','all','primary_code','maxProducts','json','padStart','bin','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','DRY\x20STORAGE','/view','log','German','RoomAssigned','Error\x20Occurs','floor','Arabic\x20(ae)','from_room_name','$product_details.rack','\x20Order\x20Number\x20:\x20','/barcode_scanner','Transfer\x20Mail','$product_details.pallet','body','unit','to_prod_pallet','<tr>','$product_details.product_code','status','An\x20error\x20occurred\x20while\x20saving\x20data.','</td>','error','/transfer/preview/','expiry_date','type','bay','from_prod_pallet','warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_stock','id_transaction','from_types','_id','4828922sURSMc','$product_details.bin','to_types','from_quantity','catch','toString','1GRagbF','\x20</h2>','$product_details.secondary_code','<div>','English','Product\x20Transfer\x20successfully','Transfer\x20Finalize\x20Successfully','render','product','port','length','finalize','exports','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','invoice'];a0_0x15c9=function(){return _0x4c28bd;};return a0_0x15c9();}const express=require(a0_0x4856a5(0xd2)),app=express(),router=express[a0_0x4856a5(0x136)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x4856a5(0x191)),auth=require(a0_0x4856a5(0xe4)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x4856a5(0xc5));router[a0_0x4856a5(0x12c)](a0_0x4856a5(0x153),auth,async(_0x1c82c3,_0x3174f4)=>{var _0x6eeb7b=a0_0x4856a5;try{const {username:_0x15af68,email:_0x5aef65,role:_0x279c08}=_0x1c82c3[_0x6eeb7b(0x127)],_0xda2834=_0x1c82c3[_0x6eeb7b(0x127)],_0x44c5cb=await profile[_0x6eeb7b(0x113)]({'email':_0xda2834[_0x6eeb7b(0xd9)]}),_0x42e9ee=await master_shop['find']();console[_0x6eeb7b(0x154)](_0x6eeb7b(0xcf),_0x42e9ee);let _0x5b5d0b;if(_0xda2834[_0x6eeb7b(0x19a)]==_0x6eeb7b(0x19f)){const _0x5d57f3=await staff[_0x6eeb7b(0x113)]({'email':_0xda2834[_0x6eeb7b(0xd9)]});_0x5b5d0b=await transfers[_0x6eeb7b(0x107)]({'from_warehouse':_0x5d57f3[_0x6eeb7b(0x16e)]});}else _0x5b5d0b=await transfers[_0x6eeb7b(0xcd)]([{'$unwind':'$product'},{'$group':{'_id':_0x6eeb7b(0x118),'invoice':{'$first':_0x6eeb7b(0xf8)},'date':{'$first':'$date'},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x6eeb7b(0x18d)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x42e9ee[0x0][_0x6eeb7b(0xfa)]==_0x6eeb7b(0xf4)){var _0x2db591=users[_0x6eeb7b(0x17e)];console[_0x6eeb7b(0x154)](_0x2db591);}else{if(_0x42e9ee[0x0]['language']==_0x6eeb7b(0x119))var _0x2db591=users[_0x6eeb7b(0x119)];else{if(_0x42e9ee[0x0][_0x6eeb7b(0xfa)]==_0x6eeb7b(0x155))var _0x2db591=users['German'];else{if(_0x42e9ee[0x0][_0x6eeb7b(0xfa)]==_0x6eeb7b(0x1a9))var _0x2db591=users[_0x6eeb7b(0x1a9)];else{if(_0x42e9ee[0x0][_0x6eeb7b(0xfa)]=='French')var _0x2db591=users['French'];else{if(_0x42e9ee[0x0][_0x6eeb7b(0xfa)]==_0x6eeb7b(0x123))var _0x2db591=users[_0x6eeb7b(0xfe)];else{if(_0x42e9ee[0x0][_0x6eeb7b(0xfa)]=='Chinese')var _0x2db591=users[_0x6eeb7b(0xea)];else{if(_0x42e9ee[0x0][_0x6eeb7b(0xfa)]==_0x6eeb7b(0x159))var _0x2db591=users[_0x6eeb7b(0xca)];}}}}}}}_0x3174f4['render'](_0x6eeb7b(0x1a7),{'success':_0x1c82c3[_0x6eeb7b(0x131)](_0x6eeb7b(0x133)),'errors':_0x1c82c3[_0x6eeb7b(0x131)](_0x6eeb7b(0x10d)),'role':_0xda2834,'profile':_0x44c5cb,'master_shop':_0x42e9ee,'transfer':_0x5b5d0b,'language':_0x2db591});}catch(_0x48a2af){console[_0x6eeb7b(0x154)](_0x48a2af);}});function a0_0x5817(_0x4376c1,_0x51dfb7){var _0x15c9a7=a0_0x15c9();return a0_0x5817=function(_0x581717,_0x4137ef){_0x581717=_0x581717-0xbf;var _0x2b7048=_0x15c9a7[_0x581717];return _0x2b7048;},a0_0x5817(_0x4376c1,_0x51dfb7);}async function getRandom8DigitNumber(){var _0x596a66=a0_0x4856a5;const _0x45e8d0=0x989680,_0x29a806=0x5f5e0ff,_0x4d178b=Math[_0x596a66(0x158)](Math[_0x596a66(0x148)]()*(_0x29a806-_0x45e8d0+0x1))+_0x45e8d0;var _0x34adcf;const _0x1f222e=await transfers[_0x596a66(0x113)]({'invoice':_0x596a66(0xda)+_0x4d178b});return _0x1f222e&&_0x1f222e[_0x596a66(0x184)]>0x0?_0x34adcf=_0x596a66(0xda)+_0x4d178b:_0x34adcf=_0x596a66(0xda)+_0x4d178b,_0x34adcf;}router[a0_0x4856a5(0x12c)](a0_0x4856a5(0x112),auth,async(_0x803df,_0x272f34)=>{var _0x154c34=a0_0x4856a5;try{const {username:_0x1f082c,email:_0x55aba1,role:_0x49b33a}=_0x803df['user'],_0x4f1b3c=_0x803df[_0x154c34(0x127)],_0x293eb2=await profile[_0x154c34(0x113)]({'email':_0x4f1b3c[_0x154c34(0xd9)]}),_0xb48367=await master_shop[_0x154c34(0x107)]();console[_0x154c34(0x154)]('master',_0xb48367);let _0x459a3a;if(_0x4f1b3c['role']==_0x154c34(0x19f)){const _0x544390=await staff[_0x154c34(0x113)]({'email':_0x4f1b3c[_0x154c34(0xd9)]});_0x459a3a=await warehouse['aggregate']([{'$match':{'status':_0x154c34(0xc7),'name':_0x544390['warehouse'],'warehouse_category':_0x154c34(0x1a5)}},{'$group':{'_id':_0x154c34(0xec),'name':{'$first':_0x154c34(0xec)}}}]);}else _0x459a3a=await warehouse['aggregate']([{'$match':{'status':_0x154c34(0xc7),'warehouse_category':_0x154c34(0x1a5)}},{'$group':{'_id':'$name','name':{'$first':_0x154c34(0xec)}}}]);var _0x2c5e3a=[_0x154c34(0x13d),'Enclosed',_0x154c34(0x19b)];const _0xb23457=await transfers[_0x154c34(0x107)]({}),_0x34d1b4=_0xb23457[_0x154c34(0x184)]+0x1,_0x646e4e=_0x154c34(0xda)+_0x34d1b4[_0x154c34(0x179)]()[_0x154c34(0x14e)](0x5,'0');if(_0xb48367[0x0][_0x154c34(0xfa)]==_0x154c34(0xf4)){var _0x1381d6=users[_0x154c34(0x17e)];console[_0x154c34(0x154)](_0x1381d6);}else{if(_0xb48367[0x0][_0x154c34(0xfa)]==_0x154c34(0x119))var _0x1381d6=users[_0x154c34(0x119)];else{if(_0xb48367[0x0][_0x154c34(0xfa)]==_0x154c34(0x155))var _0x1381d6=users[_0x154c34(0x155)];else{if(_0xb48367[0x0]['language']==_0x154c34(0x1a9))var _0x1381d6=users['Spanish'];else{if(_0xb48367[0x0]['language']==_0x154c34(0xf7))var _0x1381d6=users[_0x154c34(0xf7)];else{if(_0xb48367[0x0][_0x154c34(0xfa)]=='Portuguese\x20(BR)')var _0x1381d6=users['Portuguese'];else{if(_0xb48367[0x0][_0x154c34(0xfa)]==_0x154c34(0xea))var _0x1381d6=users[_0x154c34(0xea)];else{if(_0xb48367[0x0][_0x154c34(0xfa)]==_0x154c34(0x159))var _0x1381d6=users['Arabic'];}}}}}}}const _0x1cbb1d=getRandom8DigitNumber();_0x1cbb1d[_0x154c34(0x117)](_0x5e9135=>{var _0x1013c4=_0x154c34;_0x272f34['render'](_0x1013c4(0x18e),{'success':_0x803df[_0x1013c4(0x131)]('success'),'errors':_0x803df[_0x1013c4(0x131)](_0x1013c4(0x10d)),'role':_0x4f1b3c,'profile':_0x293eb2,'master_shop':_0xb48367,'warehouse':_0x459a3a,'language':_0x1381d6,'rooms_data':_0x2c5e3a,'invoice':_0x5e9135});})[_0x154c34(0x178)](_0x4f3297=>{var _0xb3bda2=_0x154c34;_0x803df[_0xb3bda2(0x131)](_0xb3bda2(0x10d),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x272f34[_0xb3bda2(0x193)]('/transfer/view');});}catch(_0x4a7f91){console[_0x154c34(0x154)](_0x4a7f91);}}),router[a0_0x4856a5(0xc1)](a0_0x4856a5(0x112),auth,async(_0x2049ab,_0x24888b)=>{var _0x5a7459=a0_0x4856a5;try{console['log'](_0x2049ab[_0x5a7459(0x160)]);const {date:_0x1ab1ee,from_warehouse:_0x73ee5f,FromRoom_name:_0x287ca3,to_warehouse:_0x2f63c5,ToRoom_name:_0x1b7017,prod_name:_0x218cff,from_prod_qty:_0x5a0d4e,from_prod_level:_0x463c2d,from_prod_isle:_0x45d9ac,from_prod_pallet:_0x5c2c05,to_prod_qty:_0x54bf89,to_prod_level:_0x57904a,to_prod_isle:_0x1fd354,to_prod_pallet:_0x168a9b,primary_code:_0x580b81,secondary_code:_0x1a0a7a,product_code3:_0xf529be,note:_0x3a5304,MaxStocks_data2:_0x4d5220,invoice:_0x3aed4c,expiry_date:_0x34c582}=_0x2049ab[_0x5a7459(0x160)];if(typeof _0x218cff==_0x5a7459(0xc2))var _0x22fe99=[_0x2049ab['body'][_0x5a7459(0x19d)]],_0x3b0adc=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x11b)]],_0x1596b6=[_0x2049ab[_0x5a7459(0x160)]['from_prod_level']],_0x28e927=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x198)]],_0x1c6ac8=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x126)]],_0x39810b=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x14b)]],_0x45c1ce=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x10a)]],_0x207106=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x129)]],_0x4b017e=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x120)]],_0x14a037=[_0x2049ab['body'][_0x5a7459(0x1a0)]],_0x3119c3=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x139)]],_0x3425bf=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x12d)]],_0x24aa9=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x16a)]],_0x8652cd=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x124)]],_0x502d20=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x196)]],_0x530415=[_0x2049ab['body'][_0x5a7459(0xed)]],_0x251f2e=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x156)]],_0x34ae74=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x143)]],_0x582c72=[_0x2049ab['body'][_0x5a7459(0x192)]],_0xd41da9=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x13f)]],_0x395625=[_0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x171)]];else var _0x22fe99=[..._0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x19d)]],_0x3b0adc=[..._0x2049ab['body']['from_prod_qty']],_0x1596b6=[..._0x2049ab['body'][_0x5a7459(0x11e)]],_0x28e927=[..._0x2049ab[_0x5a7459(0x160)]['New_Qty_Converted']],_0x1c6ac8=[..._0x2049ab['body'][_0x5a7459(0x126)]],_0x39810b=[..._0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x14b)]],_0x45c1ce=[..._0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x10a)]],_0x207106=[..._0x2049ab['body']['product_code3']],_0x4b017e=[..._0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x120)]],_0x14a037=[..._0x2049ab['body'][_0x5a7459(0x1a0)]],_0x3119c3=[..._0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x139)]],_0x3425bf=[..._0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x12d)]],_0x24aa9=[..._0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x16a)]],_0x8652cd=[..._0x2049ab['body'][_0x5a7459(0x124)]],_0x502d20=[..._0x2049ab[_0x5a7459(0x160)]['production_date']],_0x530415=[..._0x2049ab[_0x5a7459(0x160)][_0x5a7459(0xed)]],_0x251f2e=[..._0x2049ab[_0x5a7459(0x160)]['RoomAssigned']],_0x34ae74=[..._0x2049ab['body'][_0x5a7459(0x143)]],_0x582c72=[..._0x2049ab[_0x5a7459(0x160)]['from_invoice']],_0xd41da9=[..._0x2049ab[_0x5a7459(0x160)][_0x5a7459(0x13f)]],_0x395625=[..._0x2049ab['body'][_0x5a7459(0x171)]];const _0x367722=_0x22fe99['map'](_0x1dc8cb=>{return _0x1dc8cb={'product_name':_0x1dc8cb};});_0x3b0adc[_0x5a7459(0xfd)]((_0xbee5d4,_0x63b157)=>{var _0x4a00ef=_0x5a7459;_0x367722[_0x63b157][_0x4a00ef(0x177)]=_0xbee5d4;}),_0x582c72['forEach']((_0x1b6a67,_0x3f9a0f)=>{var _0xdc3e42=_0x5a7459;_0x367722[_0x3f9a0f][_0xdc3e42(0x192)]=_0x1b6a67;}),_0xd41da9['forEach']((_0x18499a,_0x56ee71)=>{_0x367722[_0x56ee71]['To_invoice']=_0x18499a;}),_0x395625[_0x5a7459(0xfd)]((_0x260f2c,_0x12427d)=>{var _0x1245e9=_0x5a7459;_0x367722[_0x12427d][_0x1245e9(0x106)]=_0x260f2c;}),_0x1596b6[_0x5a7459(0xfd)]((_0x323e17,_0x48d8da)=>{_0x251f2e['forEach']((_0x27e0a9,_0x5ecb85)=>{var _0x17b689=a0_0x5817;if(_0x27e0a9==_0x17b689(0xd7)&&_0x48d8da==_0x5ecb85){var _0x90aa12=_0x323e17[_0x17b689(0x10c)](0x3);_0x367722[_0x48d8da][_0x17b689(0x12b)]=_0x323e17[0x0],_0x367722[_0x48d8da][_0x17b689(0x122)]=_0x323e17[0x1],_0x367722[_0x48d8da]['from_bay']=0x0,_0x367722[_0x48d8da]['from_bin']=0x0,_0x367722[_0x48d8da]['from_types']='Floor',_0x367722[_0x48d8da][_0x17b689(0x190)]=_0x90aa12;}else{if(_0x27e0a9==_0x17b689(0x110)&&_0x48d8da==_0x5ecb85){var _0x90aa12=_0x323e17[_0x17b689(0x10c)](0x3);_0x367722[_0x48d8da][_0x17b689(0x12b)]=_0x323e17[0x0],_0x367722[_0x48d8da][_0x17b689(0x122)]=_0x323e17[0x1],_0x367722[_0x48d8da][_0x17b689(0xe2)]=0x0,_0x367722[_0x48d8da][_0x17b689(0x189)]=0x0,_0x367722[_0x48d8da][_0x17b689(0x172)]='Floor',_0x367722[_0x48d8da][_0x17b689(0x190)]=_0x323e17[0x5];}else{if(_0x48d8da==_0x5ecb85){if(_0x323e17[0x0]=='A'&&_0x323e17[0x1]=='L'&&_0x323e17[0x2]=='L')console['log'](_0x27e0a9+'\x20<>\x20'+_0x48d8da+_0x17b689(0x19c)+_0x5ecb85+_0x17b689(0x19c)+_0x323e17+'here'),_0x367722[_0x48d8da][_0x17b689(0x12b)]=_0x323e17[0x0],_0x367722[_0x48d8da][_0x17b689(0x122)]=_0x323e17[0x1],_0x367722[_0x48d8da][_0x17b689(0xe2)]=0x0,_0x367722[_0x48d8da][_0x17b689(0x189)]=0x0,_0x367722[_0x48d8da][_0x17b689(0x172)]=_0x17b689(0x147),_0x367722[_0x48d8da][_0x17b689(0x190)]=_0x323e17[0x3];else{var _0x822bae;if(_0x323e17[0x4]=='L')_0x822bae=_0x17b689(0xc3);else _0x323e17[0x4]=='F'&&(_0x822bae='Floor');_0x367722[_0x48d8da]['from_storage']=_0x323e17[0x0],_0x367722[_0x48d8da][_0x17b689(0x122)]=_0x323e17[0x1],_0x367722[_0x48d8da][_0x17b689(0xe2)]=_0x323e17[0x2],_0x367722[_0x48d8da]['from_bin']=_0x323e17[0x3],_0x367722[_0x48d8da][_0x17b689(0x172)]=_0x822bae,_0x367722[_0x48d8da][_0x17b689(0x190)]=_0x323e17[0x5];}}}}});}),_0x28e927[_0x5a7459(0xfd)]((_0x105e2f,_0x2b00b2)=>{var _0x7760ba=_0x5a7459;_0x367722[_0x2b00b2][_0x7760ba(0xce)]=_0x105e2f;}),_0x1c6ac8['forEach']((_0x3d1daa,_0x49fd06)=>{_0x34ae74['forEach']((_0x3b7af3,_0x5b74ce)=>{var _0x13b624=a0_0x5817;if(_0x3b7af3==_0x13b624(0xd7)&&_0x49fd06==_0x5b74ce){var _0x2ff6f=_0x3d1daa[_0x13b624(0x10c)](0x3);_0x367722[_0x49fd06]['storage']=_0x3d1daa[0x0],_0x367722[_0x49fd06][_0x13b624(0xdf)]=_0x3d1daa[0x1],_0x367722[_0x49fd06][_0x13b624(0x1af)]=0x0,_0x367722[_0x49fd06][_0x13b624(0x1ac)]=0x0,_0x367722[_0x49fd06][_0x13b624(0x176)]=_0x13b624(0x147),_0x367722[_0x49fd06][_0x13b624(0xd6)]=_0x2ff6f;}else{if(_0x3b7af3==_0x13b624(0x110)&&_0x49fd06==_0x5b74ce){var _0x2ff6f=_0x3d1daa['slice'](0x3);_0x367722[_0x49fd06]['storage']=_0x3d1daa[0x0],_0x367722[_0x49fd06][_0x13b624(0xdf)]=_0x3d1daa[0x1],_0x367722[_0x49fd06][_0x13b624(0x1af)]=0x0,_0x367722[_0x49fd06][_0x13b624(0x1ac)]=0x0,_0x367722[_0x49fd06][_0x13b624(0x176)]=_0x13b624(0x147),_0x367722[_0x49fd06][_0x13b624(0xd6)]=_0x3d1daa[0x5];}else{if(_0x49fd06==_0x5b74ce){if(_0x3d1daa[0x0]=='A'&&_0x3d1daa[0x1]=='L'&&_0x3d1daa[0x2]=='L')console[_0x13b624(0x154)](_0x3b7af3+_0x13b624(0x19c)+_0x49fd06+'\x20<>\x20'+_0x5b74ce+'\x20<>\x20'+_0x3d1daa+_0x13b624(0x105)),_0x367722[_0x49fd06][_0x13b624(0xd8)]=_0x3d1daa[0x0],_0x367722[_0x49fd06][_0x13b624(0xdf)]=_0x3d1daa[0x1],_0x367722[_0x49fd06][_0x13b624(0x1af)]=0x0,_0x367722[_0x49fd06]['to_bin']=0x0,_0x367722[_0x49fd06]['to_types']=_0x13b624(0x147),_0x367722[_0x49fd06][_0x13b624(0xd6)]=_0x3d1daa[0x3];else{var _0x40b26d;if(_0x3d1daa[0x4]=='L')_0x40b26d=_0x13b624(0xc3);else _0x3d1daa[0x4]=='F'&&(_0x40b26d=_0x13b624(0x147));_0x367722[_0x49fd06][_0x13b624(0xd8)]=_0x3d1daa[0x0],_0x367722[_0x49fd06][_0x13b624(0xdf)]=_0x3d1daa[0x1],_0x367722[_0x49fd06][_0x13b624(0x1af)]=_0x3d1daa[0x2],_0x367722[_0x49fd06][_0x13b624(0x1ac)]=_0x3d1daa[0x3],_0x367722[_0x49fd06][_0x13b624(0x176)]=_0x40b26d,_0x367722[_0x49fd06][_0x13b624(0xd6)]=_0x3d1daa[0x5];}}}}});}),_0x39810b[_0x5a7459(0xfd)]((_0x4c4a6c,_0x34a608)=>{var _0x17ff49=_0x5a7459;_0x367722[_0x34a608][_0x17ff49(0x14b)]=_0x4c4a6c;}),_0x45c1ce[_0x5a7459(0xfd)]((_0x426aa0,_0xfac132)=>{var _0x452c49=_0x5a7459;_0x367722[_0xfac132][_0x452c49(0x10a)]=_0x426aa0;}),_0x207106[_0x5a7459(0xfd)]((_0x468dde,_0x1c9f8d)=>{var _0x24f7ab=_0x5a7459;_0x367722[_0x1c9f8d][_0x24f7ab(0x150)]=_0x468dde;}),_0x4b017e[_0x5a7459(0xfd)]((_0x4e9ea5,_0x182e61)=>{var _0x496e7f=_0x5a7459;_0x367722[_0x182e61][_0x496e7f(0x14c)]=_0x4e9ea5;}),_0x14a037['forEach']((_0xaf383d,_0x42202d)=>{var _0xd8527c=_0x5a7459;_0x367722[_0x42202d][_0xd8527c(0x161)]=_0xaf383d;}),_0x3119c3[_0x5a7459(0xfd)]((_0x4a0f45,_0x271c71)=>{var _0x186225=_0x5a7459;_0x367722[_0x271c71][_0x186225(0x139)]=_0x4a0f45;}),_0x3425bf[_0x5a7459(0xfd)]((_0x2f5188,_0x56d6c6)=>{var _0x4b0c07=_0x5a7459;_0x367722[_0x56d6c6][_0x4b0c07(0x12d)]=_0x2f5188;}),_0x24aa9[_0x5a7459(0xfd)]((_0x344a90,_0x5a32a1)=>{var _0x3f235d=_0x5a7459;_0x367722[_0x5a32a1][_0x3f235d(0x16a)]=_0x344a90;}),_0x8652cd[_0x5a7459(0xfd)]((_0x110192,_0x2e9288)=>{var _0x417b36=_0x5a7459;_0x367722[_0x2e9288][_0x417b36(0x138)]=_0x110192;}),_0x502d20[_0x5a7459(0xfd)]((_0x28be69,_0x48e894)=>{_0x367722[_0x48e894]['production_date']=_0x28be69;}),_0x530415['forEach']((_0x1f1fcd,_0x2a5060)=>{var _0x482d24=_0x5a7459;_0x367722[_0x2a5060][_0x482d24(0xed)]=_0x1f1fcd;}),_0x251f2e['forEach']((_0x59d178,_0x27305b)=>{var _0x1cada9=_0x5a7459;_0x367722[_0x27305b][_0x1cada9(0x15a)]=_0x59d178;}),_0x34ae74[_0x5a7459(0xfd)]((_0x11ba03,_0x317221)=>{var _0x438242=_0x5a7459;_0x367722[_0x317221][_0x438242(0x199)]=_0x11ba03;});const _0x1ee7f6=_0x367722['filter'](_0x4bb397=>_0x4bb397[_0x5a7459(0xce)]!=='0'&&_0x4bb397['to_quantity']!==''||_0x4bb397[_0x5a7459(0xd6)]!=='0'&&_0x4bb397[_0x5a7459(0xd6)]!==''),_0x15be75=new transfers({'date':_0x1ab1ee,'from_warehouse':_0x73ee5f,'to_warehouse':_0x2f63c5,'product':_0x1ee7f6,'note':_0x3a5304,'invoice':_0x3aed4c}),_0x4b9a57=await _0x15be75[_0x5a7459(0x11a)]();_0x2049ab[_0x5a7459(0x131)](_0x5a7459(0x133),_0x5a7459(0x17f)),_0x24888b[_0x5a7459(0x193)](_0x5a7459(0x169)+_0x4b9a57['_id']);}catch(_0x3803f9){console[_0x5a7459(0x154)](_0x3803f9),_0x24888b[_0x5a7459(0x165)](0xc8)[_0x5a7459(0x14d)]({'errorMessage':_0x3803f9[_0x5a7459(0x12a)]});}}),router[a0_0x4856a5(0x12c)]('/preview/:id',auth,async(_0x40fe5d,_0x2a2062)=>{var _0x1b6ba2=a0_0x4856a5;try{const {username:_0x2c3916,email:_0x362dc6,role:_0xab366b}=_0x40fe5d[_0x1b6ba2(0x127)],_0x4449ad=_0x40fe5d[_0x1b6ba2(0x127)],_0x24f948=await profile[_0x1b6ba2(0x113)]({'email':_0x4449ad['email']}),_0x555dd1=await master_shop[_0x1b6ba2(0x107)]();console[_0x1b6ba2(0x154)](_0x1b6ba2(0xcf),_0x555dd1);const _0x59d1cf=await transfers['findById'](_0x40fe5d[_0x1b6ba2(0xee)]['id']);let _0x2c98f0=new Date(_0x59d1cf[_0x1b6ba2(0x16a)]),_0x158004=('0'+_0x2c98f0[_0x1b6ba2(0x149)]())[_0x1b6ba2(0x10c)](-0x2),_0x4b2b8f=('0'+(_0x2c98f0[_0x1b6ba2(0x197)]()+0x1))[_0x1b6ba2(0x10c)](-0x2),_0x302191=_0x2c98f0[_0x1b6ba2(0xf9)](),_0x23e218=_0x302191+'-'+_0x4b2b8f+'-'+_0x158004,_0x8e9969;if(_0x4449ad[_0x1b6ba2(0x19a)]==_0x1b6ba2(0x19f)){const _0x2234a0=await staff['findOne']({'email':_0x4449ad[_0x1b6ba2(0xd9)]});_0x8e9969=await warehouse[_0x1b6ba2(0x107)]({'status':_0x1b6ba2(0xc7),'name':_0x2234a0[_0x1b6ba2(0x16e)],'warehouse_category':_0x1b6ba2(0x1a5)});}else _0x8e9969=await warehouse['find']({'status':_0x1b6ba2(0xc7),'warehouse_category':_0x1b6ba2(0x1a5)});const _0x4d3511=await warehouse[_0x1b6ba2(0xcd)]([{'$match':{'name':_0x59d1cf[_0x1b6ba2(0x101)]}},{'$unwind':_0x1b6ba2(0x135)},{'$group':{'_id':_0x1b6ba2(0xc9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1b6ba2(0x194)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1b6ba2(0x175)},'type':{'$first':_0x1b6ba2(0xc6)},'floorlevel':{'$first':_0x1b6ba2(0xd5)},'primary_code':{'$first':_0x1b6ba2(0x114)},'secondary_code':{'$first':_0x1b6ba2(0x17c)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x1b6ba2(0xdd)},'rack':{'$first':_0x1b6ba2(0x15b)},'expiry_date':{'$first':_0x1b6ba2(0x132)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]);if(_0x555dd1[0x0][_0x1b6ba2(0xfa)]==_0x1b6ba2(0xf4)){var _0x20cf30=users[_0x1b6ba2(0x17e)];console[_0x1b6ba2(0x154)](_0x20cf30);}else{if(_0x555dd1[0x0]['language']==_0x1b6ba2(0x119))var _0x20cf30=users[_0x1b6ba2(0x119)];else{if(_0x555dd1[0x0][_0x1b6ba2(0xfa)]==_0x1b6ba2(0x155))var _0x20cf30=users[_0x1b6ba2(0x155)];else{if(_0x555dd1[0x0][_0x1b6ba2(0xfa)]==_0x1b6ba2(0x1a9))var _0x20cf30=users['Spanish'];else{if(_0x555dd1[0x0]['language']==_0x1b6ba2(0xf7))var _0x20cf30=users[_0x1b6ba2(0xf7)];else{if(_0x555dd1[0x0][_0x1b6ba2(0xfa)]==_0x1b6ba2(0x123))var _0x20cf30=users[_0x1b6ba2(0xfe)];else{if(_0x555dd1[0x0]['language']==_0x1b6ba2(0xea))var _0x20cf30=users['Chinese'];else{if(_0x555dd1[0x0]['language']==_0x1b6ba2(0x159))var _0x20cf30=users['Arabic'];}}}}}}}_0x2a2062[_0x1b6ba2(0x181)](_0x1b6ba2(0xf1),{'success':_0x40fe5d[_0x1b6ba2(0x131)](_0x1b6ba2(0x133)),'errors':_0x40fe5d[_0x1b6ba2(0x131)]('errors'),'role':_0x4449ad,'profile':_0x24f948,'master_shop':_0x555dd1,'warehouse':_0x8e9969,'transfer':_0x59d1cf,'stock':_0x4d3511,'language':_0x20cf30});}catch(_0x1c08c1){console[_0x1b6ba2(0x154)](_0x1c08c1);}}),router[a0_0x4856a5(0xc1)](a0_0x4856a5(0xcc),auth,async(_0x3ba9a3,_0x1ada48)=>{var _0x246bd0=a0_0x4856a5;try{const _0x2b685d=_0x3ba9a3[_0x246bd0(0xee)]['id'],{from_warehouse:_0x3d7a6b,FromRoom_name:_0x2f8dd9,to_warehouse:_0x7abe29,ToRoom_name:_0x1db6b6}=_0x3ba9a3[_0x246bd0(0x160)],_0x4e56c7=await transfers[_0x246bd0(0xbf)]({'_id':_0x2b685d}),_0x5a620c=_0x4e56c7[_0x246bd0(0x182)][_0x246bd0(0x100)](async _0x2b7f9a=>{var _0x3b0402=_0x246bd0;if(_0x2b7f9a[_0x3b0402(0xce)]>0x0){var _0x5da2e0=await warehouse[_0x3b0402(0x113)]({'name':_0x4e56c7[_0x3b0402(0x101)],'room':_0x2b7f9a[_0x3b0402(0x15a)],'warehouse_category':_0x3b0402(0x1a5)});const _0x15a973=_0x5da2e0[_0x3b0402(0xe5)]['map'](_0x950b1c=>{var _0x135d46=_0x3b0402;_0x950b1c[_0x135d46(0x102)]==_0x2b7f9a[_0x135d46(0x102)]&&_0x950b1c['floorlevel']==_0x2b7f9a[_0x135d46(0x190)]&&_0x950b1c['type']==_0x2b7f9a[_0x135d46(0x172)]&&_0x950b1c[_0x135d46(0x14f)]==_0x2b7f9a[_0x135d46(0x189)]&&_0x950b1c['bay']==_0x2b7f9a['from_bay']&&_0x950b1c[_0x135d46(0xdf)]==_0x2b7f9a[_0x135d46(0x122)]&&_0x950b1c[_0x135d46(0xd8)]==_0x2b7f9a[_0x135d46(0x12b)]&&_0x950b1c[_0x135d46(0x16a)]==_0x2b7f9a[_0x135d46(0x16a)]&&_0x950b1c['batch_code']==_0x2b7f9a[_0x135d46(0x12d)]&&_0x950b1c[_0x135d46(0x196)]==_0x2b7f9a[_0x135d46(0x196)]&&_0x950b1c[_0x135d46(0x188)]==_0x2b7f9a[_0x135d46(0x192)]&&_0x950b1c[_0x135d46(0x173)]==_0x2b7f9a['id_transaction_id']&&(_0x950b1c[_0x135d46(0x170)]=_0x950b1c[_0x135d46(0x170)]-_0x2b7f9a[_0x135d46(0xce)]);});}return _0x5da2e0;});Promise['all'](_0x5a620c)[_0x246bd0(0x117)](async _0x10fced=>{var _0x17667f=_0x246bd0;try{for(const _0x233de4 of _0x10fced){await _0x233de4['save']();}try{const _0x4a0d05=_0x4e56c7[_0x17667f(0x182)][_0x17667f(0x100)](async _0xc35c60=>{var _0x3972ee=_0x17667f;if(_0xc35c60[_0x3972ee(0xce)]>0x0){var _0x19fe9c=await warehouse[_0x3972ee(0x113)]({'name':_0x4e56c7[_0x3972ee(0x140)],'room':_0xc35c60[_0x3972ee(0x199)],'warehouse_category':'Raw\x20Materials'}),_0x5841ff=0x0;const _0x5af5c8=_0x19fe9c['product_details'][_0x3972ee(0x100)](_0x46297b=>{var _0x5912d4=_0x3972ee;_0x46297b[_0x5912d4(0x102)]==_0xc35c60[_0x5912d4(0x102)]&&_0x46297b['floorlevel']==_0xc35c60['to_floorlevel']&&_0x46297b[_0x5912d4(0x16b)]==_0xc35c60[_0x5912d4(0x176)]&&_0x46297b['bin']==_0xc35c60[_0x5912d4(0x1ac)]&&_0x46297b['bay']==_0xc35c60['to_bay']&&_0x46297b[_0x5912d4(0xdf)]==_0xc35c60['rack']&&_0x46297b[_0x5912d4(0xd8)]==_0xc35c60[_0x5912d4(0xd8)]&&_0x46297b[_0x5912d4(0x16a)]==_0xc35c60['expiry_date']&&_0x46297b[_0x5912d4(0x12d)]==_0xc35c60[_0x5912d4(0x12d)]&&_0x46297b[_0x5912d4(0x196)]==_0xc35c60[_0x5912d4(0x196)]&&_0x46297b[_0x5912d4(0x188)]==_0xc35c60[_0x5912d4(0x1ab)]&&(_0x46297b[_0x5912d4(0x170)]=_0x46297b[_0x5912d4(0x170)]+_0xc35c60['to_quantity'],_0x5841ff++);});_0x5841ff=='0'&&(_0x19fe9c[_0x3972ee(0xe5)]=_0x19fe9c[_0x3972ee(0xe5)]['concat']({'product_name':_0xc35c60[_0x3972ee(0x102)],'product_stock':_0xc35c60[_0x3972ee(0xce)],'bay':_0xc35c60[_0x3972ee(0x1af)],'bin':_0xc35c60[_0x3972ee(0x1ac)],'type':_0xc35c60[_0x3972ee(0x176)],'floorlevel':_0xc35c60[_0x3972ee(0xd6)],'storage':_0xc35c60[_0x3972ee(0xd8)],'rack':_0xc35c60[_0x3972ee(0xdf)],'product_code':_0xc35c60[_0x3972ee(0x150)],'primary_code':_0xc35c60[_0x3972ee(0x14b)],'secondary_code':_0xc35c60[_0x3972ee(0x10a)],'maxProducts':_0xc35c60[_0x3972ee(0x14c)],'storage':_0xc35c60['storage'],'rack':_0xc35c60[_0x3972ee(0xdf)],'expiry_date':_0xc35c60[_0x3972ee(0x16a)],'maxPerUnit':_0xc35c60[_0x3972ee(0x138)],'batch_code':_0xc35c60['batch_code'],'production_date':_0xc35c60['production_date']}));}return _0x19fe9c;});Promise[_0x17667f(0x14a)](_0x4a0d05)['then'](async _0x33a096=>{var _0x43d26d=_0x17667f;try{for(const _0x553007 of _0x33a096){await warehouse[_0x43d26d(0x18b)]({'_id':_0x553007[_0x43d26d(0x173)]},{'$addToSet':{'product_details':{'$each':_0x553007[_0x43d26d(0xe5)]}}});}_0x4e56c7[_0x43d26d(0x185)]=_0x43d26d(0x18c);const _0x4fcfd4=await _0x4e56c7[_0x43d26d(0x11a)](),_0x52af33=await master_shop[_0x43d26d(0x107)](),_0x314044=await email_settings[_0x43d26d(0x113)](),_0x45a35e=await supervisor_settings['find']();var _0x491952=_0x4e56c7[_0x43d26d(0x182)],_0x148a75='',_0x3bb45d;for(_0x3bb45d in _0x491952){_0x148a75+=_0x43d26d(0x163)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x491952[_0x3bb45d][_0x43d26d(0x102)]+_0x43d26d(0x167)+_0x43d26d(0x141)+_0x491952[_0x3bb45d][_0x43d26d(0x150)]+_0x43d26d(0x167)+_0x43d26d(0x141)+_0x491952[_0x3bb45d][_0x43d26d(0xce)]+_0x43d26d(0x167)+_0x43d26d(0x141)+_0x491952[_0x3bb45d][_0x43d26d(0x161)]+_0x43d26d(0x167)+_0x43d26d(0x141)+_0x491952[_0x3bb45d][_0x43d26d(0x139)]+'</td>'+_0x43d26d(0x141)+_0x4e56c7['to_warehouse']+'</td>'+_0x43d26d(0x141)+_0x491952[_0x3bb45d][_0x43d26d(0x199)]+_0x43d26d(0x167)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x491952[_0x3bb45d][_0x43d26d(0xd8)]+_0x491952[_0x3bb45d]['rack']+_0x491952[_0x3bb45d]['to_bay']+_0x491952[_0x3bb45d][_0x43d26d(0x1ac)]+_0x491952[_0x3bb45d][_0x43d26d(0x176)][0x0]+_0x491952[_0x3bb45d][_0x43d26d(0xd6)]+_0x43d26d(0x167),_0x43d26d(0x1ae);}let _0x4b4573=nodemailer[_0x43d26d(0x128)]({'host':_0x314044[_0x43d26d(0xe3)],'port':Number(_0x314044[_0x43d26d(0x183)]),'secure':![],'auth':{'user':_0x314044[_0x43d26d(0xd9)],'pass':_0x314044[_0x43d26d(0x1a3)]}}),_0x43f734={'from':_0x314044[_0x43d26d(0xd9)],'to':_0x45a35e[0x0]['RMSEmail'],'subject':_0x43d26d(0x15e),'attachments':[{'filename':'Logo.png','path':__dirname+_0x43d26d(0x19e)+_0x43d26d(0xd4)+_0x52af33[0x0][_0x43d26d(0xc8)],'cid':_0x43d26d(0x121)}],'html':_0x43d26d(0xe6)+_0x43d26d(0xcb)+'</head><body>'+_0x43d26d(0x17d)+_0x43d26d(0xf6)+_0x43d26d(0x17d)+_0x43d26d(0xdc)+_0x43d26d(0x1ad)+'<div>'+_0x43d26d(0x103)+_0x52af33[0x0][_0x43d26d(0x11d)]+_0x43d26d(0x17b)+_0x43d26d(0x1ad)+_0x43d26d(0x1ad)+'<hr\x20class=\x22my-3\x22>'+_0x43d26d(0x17d)+_0x43d26d(0xe8)+_0x43d26d(0x15c)+_0x4e56c7[_0x43d26d(0x188)]+'\x20'+_0x43d26d(0x10b)+_0x43d26d(0xf5)+_0x4e56c7[_0x43d26d(0x1a1)]+'\x20'+_0x43d26d(0xdb)+_0x43d26d(0xeb)+_0x43d26d(0x1ad)+_0x43d26d(0x104)+_0x43d26d(0xc4)+_0x43d26d(0x163)+_0x43d26d(0xde)+_0x43d26d(0x151)+_0x43d26d(0x115)+_0x43d26d(0x16f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x43d26d(0x1a2)+_0x43d26d(0x187)+_0x43d26d(0xe9)+_0x43d26d(0x1ae)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x148a75+'\x20'+_0x43d26d(0x137)+_0x43d26d(0xe7)+_0x43d26d(0x17d)+_0x43d26d(0xf2)+'<h5>'+_0x52af33[0x0][_0x43d26d(0x11d)]+'</h5>'+'</div>'+_0x43d26d(0x1ad)+'</body></html>'};_0x4b4573['sendMail'](_0x43f734,function(_0x3f9bde,_0x4e71f5){var _0x5df099=_0x43d26d;_0x3f9bde?(console['log'](_0x3f9bde),console[_0x5df099(0x154)](_0x5df099(0x157))):console[_0x5df099(0x154)]('Email\x20sent\x20successfully');}),_0x3ba9a3[_0x43d26d(0x131)](_0x43d26d(0x133),_0x43d26d(0x180)),_0x1ada48['redirect'](_0x43d26d(0x12e)+_0x4fcfd4[_0x43d26d(0x173)]);}catch(_0x30e5d4){console[_0x43d26d(0x168)](_0x30e5d4),_0x1ada48[_0x43d26d(0x165)](0x1f4)[_0x43d26d(0x14d)]({'Perror':_0x43d26d(0x166),'message':_0x30e5d4['message']});}})[_0x17667f(0x178)](_0x3170ba=>{var _0x2258c4=_0x17667f;console[_0x2258c4(0x168)](_0x3170ba),_0x1ada48['status'](0x1f4)['json']({'Perror':'An\x20error\x20occurred.'});});}catch(_0x618dc2){_0x1ada48[_0x17667f(0x14d)](_0x618dc2);}}catch(_0x11b0f6){console[_0x17667f(0x168)](_0x11b0f6),_0x1ada48[_0x17667f(0x165)](0x1f4)[_0x17667f(0x14d)]({'Merror':_0x17667f(0x166),'Message':_0x11b0f6['message']});}})[_0x246bd0(0x178)](_0x58bdee=>{var _0x438919=_0x246bd0;console[_0x438919(0x168)](_0x58bdee),_0x1ada48[_0x438919(0x165)](0x1f4)[_0x438919(0x14d)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x5d36a4){console[_0x246bd0(0x154)](_0x5d36a4);}});function BayBinSelected(_0x4f5f4b,_0x54fe43){var _0x18336c=a0_0x4856a5,_0x2e04cd=[],_0x24f55e=[],_0x42e46d=[],_0x4921cc=[],_0x2f4e62=[],_0x2c37eb=[];let _0xe5545a=[];if(_0x4f5f4b==_0x18336c(0x152))switch(_0x54fe43){case _0x18336c(0x13a):_0x2e04cd=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x24f55e=[0x1,0x2],_0x4921cc=[0x1,0x2,0x3,0x4,0x5],_0x42e46d=[_0x18336c(0xc3),_0x18336c(0x147)],_0x2f4e62=['D'],_0x2c37eb=['A'];break;case _0x18336c(0x12f):_0x2e04cd=[0x6,0x5,0x4,0x3,0x2,0x1],_0x24f55e=[0x1,0x2],_0x4921cc=[0x1,0x2,0x3,0x4,0x5],_0x42e46d=[_0x18336c(0xc3),_0x18336c(0x147)],_0x2f4e62=['D'],_0x2c37eb=['B'];break;case _0x18336c(0x110):_0x2e04cd=[0x0],_0x24f55e=[0x0],_0x4921cc=[0x1,0x2,0x3,0x4,0x5],_0x42e46d=['Floor'],_0x2f4e62=['D'],_0x2c37eb=['S'];break;case _0x18336c(0xd7):_0x2e04cd=[0x0],_0x24f55e=[0x0],_0x4921cc=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x42e46d=[_0x18336c(0x147)],_0x2f4e62=['D'],_0x2c37eb=['R'];break;}else{if(_0x4f5f4b==_0x18336c(0x116))switch(_0x54fe43){case'Rack\x20A':_0x2e04cd=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x24f55e=['B','F'],_0x4921cc=[0x1,0x2,0x3,0x4,0x5],_0x42e46d=[_0x18336c(0xc3),_0x18336c(0x147)],_0x2f4e62=['C'],_0x2c37eb=['A'];break;case _0x18336c(0x12f):_0x2e04cd=[0x5,0x4,0x3,0x2,0x1],_0x24f55e=['F','B','S'],_0x4921cc=[0x1,0x2,0x3,0x4,0x5],_0x42e46d=['Level',_0x18336c(0x147)],_0x2f4e62=['C'],_0x2c37eb=['B'];break;case'Rack\x20C':_0x2e04cd=[0x1,0x2,0x3,0x4,0x5],_0x24f55e=['B','F','S'],_0x4921cc=[0x5,0x4,0x3,0x2,0x1],_0x42e46d=[_0x18336c(0xc3),'Floor'],_0x2f4e62=['C'],_0x2c37eb=['C'];break;case _0x18336c(0xe0):_0x2e04cd=[0x5,0x4,0x3,0x2,0x1],_0x24f55e=['F','B','S'],_0x4921cc=[0x1,0x2,0x3,0x4,0x5],_0x42e46d=[_0x18336c(0xc3),_0x18336c(0x147)],_0x2f4e62=['C'],_0x2c37eb=['D'];break;case'Rack\x20E':_0x2e04cd=[0x4,0x3,0x2,0x1],_0x24f55e=[0x1,0x2],_0x4921cc=[0x1,0x2,0x3,0x4,0x5],_0x42e46d=[_0x18336c(0xc3),_0x18336c(0x147)],_0x2f4e62=['C'],_0x2c37eb=['E'];break;case'Rack\x20F':_0x2e04cd=[0x1,0x2,0x3],_0x24f55e=[0x1,0x2],_0x4921cc=[0x1,0x2,0x3,0x4,0x5],_0x42e46d=[_0x18336c(0xc3)],_0x2f4e62=['C'],_0x2c37eb=['F'];break;}}return{'levels':_0x2e04cd,'Isle':_0x24f55e,'rack':_0x4921cc,'type':_0x42e46d,'storage':_0x2f4e62,'rak':_0x2c37eb};}router[a0_0x4856a5(0x12c)](a0_0x4856a5(0xe1),auth,async(_0x6a4b04,_0xe169d6)=>{var _0xbcdbeb=a0_0x4856a5;try{const {username:_0x58b876,email:_0x19b1cf,role:_0x16755c}=_0x6a4b04['user'],_0x30d987=_0x6a4b04[_0xbcdbeb(0x127)],_0x311e9e=await profile[_0xbcdbeb(0x113)]({'email':_0x30d987[_0xbcdbeb(0xd9)]}),_0x50a16e=await master_shop[_0xbcdbeb(0x107)](),_0x5be1db=await transfers['findById'](_0x6a4b04[_0xbcdbeb(0xee)]['id']);let _0xa95de8;if(_0x30d987[_0xbcdbeb(0x19a)]==_0xbcdbeb(0x19f)){const _0x4cf2ea=await staff['findOne']({'email':_0x30d987[_0xbcdbeb(0xd9)]});_0xa95de8=await warehouse[_0xbcdbeb(0xcd)]([{'$match':{'status':'Enabled','name':_0x4cf2ea[_0xbcdbeb(0x16e)],'warehouse_category':_0xbcdbeb(0x1a5)}},{'$group':{'_id':_0xbcdbeb(0xec),'name':{'$first':_0xbcdbeb(0xec)}}}]);}else _0xa95de8=await warehouse[_0xbcdbeb(0xcd)]([{'$match':{'status':_0xbcdbeb(0xc7),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0xbcdbeb(0xec),'name':{'$first':_0xbcdbeb(0xec)}}}]);const _0x3c4dfc=await warehouse[_0xbcdbeb(0xcd)]([{'$match':{'name':_0x5be1db[_0xbcdbeb(0x101)],'warehouse_category':_0xbcdbeb(0x1a5)}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0xbcdbeb(0x1a4)},'product_stock':{'$first':_0xbcdbeb(0x194)},'bay':{'$first':_0xbcdbeb(0x18f)},'bin':{'$first':_0xbcdbeb(0x175)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xbcdbeb(0xd5)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0xbcdbeb(0xdd)},'rack':{'$first':_0xbcdbeb(0x15b)},'expiry_date':{'$first':_0xbcdbeb(0x132)},'production_date':{'$first':_0xbcdbeb(0xff)},'room':{'$first':_0xbcdbeb(0x1b0)}}}]),_0x52e9f5=await product[_0xbcdbeb(0x107)]({}),_0x512f98=BayBinSelected(_0x5be1db['to_warehouse'],_0x5be1db[_0xbcdbeb(0x1aa)]);if(_0x50a16e[0x0][_0xbcdbeb(0xfa)]==_0xbcdbeb(0xf4)){var _0x9e70ba=users[_0xbcdbeb(0x17e)];console[_0xbcdbeb(0x154)](_0x9e70ba);}else{if(_0x50a16e[0x0][_0xbcdbeb(0xfa)]=='Hindi')var _0x9e70ba=users[_0xbcdbeb(0x119)];else{if(_0x50a16e[0x0][_0xbcdbeb(0xfa)]==_0xbcdbeb(0x155))var _0x9e70ba=users['German'];else{if(_0x50a16e[0x0][_0xbcdbeb(0xfa)]==_0xbcdbeb(0x1a9))var _0x9e70ba=users[_0xbcdbeb(0x1a9)];else{if(_0x50a16e[0x0][_0xbcdbeb(0xfa)]==_0xbcdbeb(0xf7))var _0x9e70ba=users[_0xbcdbeb(0xf7)];else{if(_0x50a16e[0x0]['language']==_0xbcdbeb(0x123))var _0x9e70ba=users['Portuguese'];else{if(_0x50a16e[0x0]['language']==_0xbcdbeb(0xea))var _0x9e70ba=users[_0xbcdbeb(0xea)];else{if(_0x50a16e[0x0]['language']==_0xbcdbeb(0x159))var _0x9e70ba=users['Arabic'];}}}}}}}_0xe169d6[_0xbcdbeb(0x181)](_0xbcdbeb(0x145),{'success':_0x6a4b04[_0xbcdbeb(0x131)](_0xbcdbeb(0x133)),'errors':_0x6a4b04['flash']('errors'),'role':_0x30d987,'profile':_0x311e9e,'master_shop':_0x50a16e,'warehouse':_0xa95de8,'transfer':_0x5be1db,'stock':_0x3c4dfc,'unit':_0x52e9f5,'language':_0x9e70ba});}catch(_0x2ea700){console[_0xbcdbeb(0x154)](_0x2ea700);}}),router['post'](a0_0x4856a5(0xe1),auth,async(_0x853a3c,_0x4da39f)=>{var _0x186362=a0_0x4856a5;try{const _0x1f86bc=_0x853a3c[_0x186362(0xee)]['id'],_0xe1f39=await transfers[_0x186362(0xbf)](_0x1f86bc);_0x4da39f['json'](_0x853a3c['body']);return;const {date:_0x24f26f,from_warehouse:_0x108feb,FromRoom_name:_0xfa49,to_warehouse:_0x4bf9d4,ToRoom_name:_0x2d53e4,prod_name:_0x41a3e3,from_prod_qty:_0x141d94,from_prod_level:_0x3218f9,from_prod_isle:_0x3c0f84,from_prod_pallet:_0x5cc470,to_prod_qty:_0x19bd92,to_prod_level:_0x21b651,to_prod_isle:_0x12cc1b,to_prod_pallet:_0x2a2651,primary_code:_0x3ecc83,secondary_code:_0x38964f,product_code3:_0x24eca1,note:_0x4317a4,invoice:_0x3d753e,expiry_date:_0x88d745}=_0x853a3c[_0x186362(0x160)];if(typeof _0x41a3e3==_0x186362(0xc2))var _0x37a2f6=[_0x853a3c[_0x186362(0x160)]['prod_name']],_0x121806=[_0x853a3c['body'][_0x186362(0x11b)]],_0x5e2290=[_0x853a3c[_0x186362(0x160)][_0x186362(0x11e)]],_0x302bb4=[_0x853a3c[_0x186362(0x160)]['from_prod_isle']],_0x3a2a31=[_0x853a3c[_0x186362(0x160)][_0x186362(0x16d)]],_0x51aa95=[_0x853a3c[_0x186362(0x160)][_0x186362(0x172)]],_0x2b9bfb=[_0x853a3c[_0x186362(0x160)][_0x186362(0xd3)]],_0x52fc49=[_0x853a3c[_0x186362(0x160)][_0x186362(0x126)]],_0x4985d6=[_0x853a3c[_0x186362(0x160)][_0x186362(0x134)]],_0x1a0e76=[_0x853a3c[_0x186362(0x160)][_0x186362(0x162)]],_0x15e323=[_0x853a3c[_0x186362(0x160)][_0x186362(0x176)]],_0x1ea29d=[_0x853a3c[_0x186362(0x160)][_0x186362(0xd8)]],_0x57e424=[_0x853a3c[_0x186362(0x160)][_0x186362(0x125)]],_0x59b7a0=[_0x853a3c[_0x186362(0x160)][_0x186362(0x14b)]],_0x3e3ccf=[_0x853a3c[_0x186362(0x160)][_0x186362(0x10a)]],_0x145955=[_0x853a3c[_0x186362(0x160)][_0x186362(0x129)]],_0x39eb5d=[_0x853a3c[_0x186362(0x160)]['MaxStocks_data2']],_0x458653=[_0x853a3c[_0x186362(0x160)]['unit']],_0x1d13b6=[_0x853a3c[_0x186362(0x160)][_0x186362(0x139)]],_0xc7da3b=[_0x853a3c[_0x186362(0x160)]['batch_code']],_0x395acf=[_0x853a3c[_0x186362(0x160)]['expiry_date']],_0x595336=[_0x853a3c[_0x186362(0x160)][_0x186362(0x12b)]],_0x1b66a8=[_0x853a3c[_0x186362(0x160)]['from_rak']];else var _0x37a2f6=[..._0x853a3c['body']['prod_name']],_0x1ea29d=[..._0x853a3c[_0x186362(0x160)][_0x186362(0xd8)]],_0x57e424=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x125)]],_0x51aa95=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x172)]],_0x15e323=[..._0x853a3c[_0x186362(0x160)]['to_types']],_0x121806=[..._0x853a3c['body'][_0x186362(0x11b)]],_0x5e2290=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x11e)]],_0x302bb4=[..._0x853a3c['body'][_0x186362(0x10e)]],_0x3a2a31=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x16d)]],_0x2b9bfb=[..._0x853a3c[_0x186362(0x160)][_0x186362(0xd3)]],_0x52fc49=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x126)]],_0x4985d6=[..._0x853a3c['body'][_0x186362(0x134)]],_0x1a0e76=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x162)]],_0x59b7a0=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x14b)]],_0x3e3ccf=[..._0x853a3c['body']['secondary_code']],_0x145955=[..._0x853a3c[_0x186362(0x160)]['product_code3']],_0x39eb5d=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x120)]],_0x458653=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x161)]],_0x1d13b6=[..._0x853a3c['body'][_0x186362(0x139)]],_0xc7da3b=[..._0x853a3c['body'][_0x186362(0x12d)]],_0x395acf=[..._0x853a3c[_0x186362(0x160)][_0x186362(0x16a)]],_0x595336=[..._0x853a3c['body'][_0x186362(0x12b)]],_0x1b66a8=[..._0x853a3c[_0x186362(0x160)][_0x186362(0xfc)]];const _0x445ba1=_0x37a2f6[_0x186362(0x100)](_0x238319=>{return _0x238319={'product_name':_0x238319};});_0x121806[_0x186362(0xfd)]((_0x289948,_0x407d7f)=>{var _0x34cd10=_0x186362;_0x445ba1[_0x407d7f][_0x34cd10(0x177)]=_0x289948;}),_0x5e2290[_0x186362(0xfd)]((_0x237b18,_0x5edcaf)=>{var _0x21fd74=_0x186362;_0x445ba1[_0x5edcaf][_0x21fd74(0xe2)]=_0x237b18;}),_0x302bb4['forEach']((_0x6424c4,_0x32e000)=>{var _0x51b9b7=_0x186362;_0x445ba1[_0x32e000][_0x51b9b7(0x189)]=_0x6424c4;}),_0x3a2a31['forEach']((_0x3af89b,_0x55050a)=>{_0x445ba1[_0x55050a]['from_floorlevel']=_0x3af89b;}),_0x2b9bfb['forEach']((_0x54f604,_0x1fbd07)=>{var _0x321b5c=_0x186362;_0x445ba1[_0x1fbd07][_0x321b5c(0xce)]=_0x54f604;}),_0x52fc49[_0x186362(0xfd)]((_0x27285b,_0x1285ad)=>{var _0x1e9fc0=_0x186362;_0x445ba1[_0x1285ad][_0x1e9fc0(0x1af)]=_0x27285b;}),_0x4985d6[_0x186362(0xfd)]((_0x84fe75,_0xe4ce99)=>{var _0x23a9d4=_0x186362;_0x445ba1[_0xe4ce99][_0x23a9d4(0x1ac)]=_0x84fe75;}),_0x1a0e76['forEach']((_0x51bbc7,_0x4a4da6)=>{var _0x2267aa=_0x186362;_0x445ba1[_0x4a4da6][_0x2267aa(0xd6)]=_0x51bbc7;}),_0x59b7a0['forEach']((_0x2934dd,_0x52518e)=>{var _0x34a51d=_0x186362;_0x445ba1[_0x52518e][_0x34a51d(0x14b)]=_0x2934dd;}),_0x3e3ccf[_0x186362(0xfd)]((_0x3adb09,_0x1405f8)=>{var _0x498230=_0x186362;_0x445ba1[_0x1405f8][_0x498230(0x10a)]=_0x3adb09;}),_0x145955['forEach']((_0x339f65,_0x4b7932)=>{_0x445ba1[_0x4b7932]['product_code']=_0x339f65;}),_0x39eb5d[_0x186362(0xfd)]((_0x17e2a3,_0x403df3)=>{var _0x4ec9f0=_0x186362;_0x445ba1[_0x403df3][_0x4ec9f0(0x14c)]=_0x17e2a3;}),_0x458653[_0x186362(0xfd)]((_0x599e14,_0x5cf54d)=>{var _0x176234=_0x186362;_0x445ba1[_0x5cf54d][_0x176234(0x161)]=_0x599e14;}),_0x1d13b6[_0x186362(0xfd)]((_0xdd7bac,_0x114816)=>{_0x445ba1[_0x114816]['secondary_unit']=_0xdd7bac;}),_0xc7da3b[_0x186362(0xfd)]((_0x571a01,_0x2aa2d0)=>{_0x445ba1[_0x2aa2d0]['batch_code']=_0x571a01;}),_0x395acf[_0x186362(0xfd)]((_0x2a82f9,_0x1e40ba)=>{var _0x2d7bad=_0x186362;_0x445ba1[_0x1e40ba][_0x2d7bad(0x16a)]=_0x2a82f9;}),_0x1ea29d[_0x186362(0xfd)]((_0x2facbb,_0x101379)=>{var _0x53b016=_0x186362;_0x445ba1[_0x101379][_0x53b016(0xd8)]=_0x2facbb;}),_0x57e424[_0x186362(0xfd)]((_0x6fe8ea,_0x1fa761)=>{var _0x15e54e=_0x186362;_0x445ba1[_0x1fa761][_0x15e54e(0xdf)]=_0x6fe8ea;}),_0x51aa95[_0x186362(0xfd)]((_0xcb7109,_0xe67a02)=>{_0x445ba1[_0xe67a02]['from_types']=_0xcb7109;}),_0x15e323['forEach']((_0x70bd86,_0x141a05)=>{var _0x717a53=_0x186362;_0x445ba1[_0x141a05][_0x717a53(0x176)]=_0x70bd86;}),_0x595336['forEach']((_0x535388,_0x2a9a2e)=>{var _0x409e5b=_0x186362;_0x445ba1[_0x2a9a2e][_0x409e5b(0x12b)]=_0x535388;}),_0x1b66a8[_0x186362(0xfd)]((_0x28ed4d,_0xca66ee)=>{var _0x4f62a3=_0x186362;_0x445ba1[_0xca66ee][_0x4f62a3(0x122)]=_0x28ed4d;});const _0x2a6e14=_0x445ba1[_0x186362(0x130)](_0x1c8bb4=>_0x1c8bb4[_0x186362(0xce)]!=='0'&&_0x1c8bb4[_0x186362(0xce)]!==''||_0x1c8bb4[_0x186362(0xd6)]!=='0'&&_0x1c8bb4[_0x186362(0xd6)]!=='');var _0x2af898=0x0;_0x2a6e14[_0x186362(0xfd)](_0x3bcd07=>{var _0x5f119b=_0x186362;parseInt(_0x3bcd07['from_quantity'])<parseInt(_0x3bcd07[_0x5f119b(0xce)])&&_0x2af898++;});if(_0x2af898!=0x0)return _0x853a3c[_0x186362(0x131)](_0x186362(0x10d),_0x186362(0x10f)),_0x4da39f[_0x186362(0x193)]('back');const _0x5b2362=await warehouse[_0x186362(0x113)]({'name':_0xe1f39[_0x186362(0x101)],'room':_0xe1f39[_0x186362(0x1a6)]});_0xe1f39[_0x186362(0x182)][_0x186362(0xfd)](_0x2ca389=>{if(_0x2ca389['to_quantity']>0x0){const _0x55c955=_0x5b2362['product_details']['map'](_0x38ab2f=>{var _0x4293dc=a0_0x5817;_0x38ab2f[_0x4293dc(0x102)]==_0x2ca389[_0x4293dc(0x102)]&&_0x38ab2f[_0x4293dc(0x11f)]==_0x2ca389[_0x4293dc(0x190)]&&_0x38ab2f['type']==_0x2ca389[_0x4293dc(0x172)]&&_0x38ab2f[_0x4293dc(0x14f)]==_0x2ca389[_0x4293dc(0x189)]&&_0x38ab2f[_0x4293dc(0x16c)]==_0x2ca389[_0x4293dc(0xe2)]&&_0x38ab2f['rack']==_0x2ca389[_0x4293dc(0x122)]&&_0x38ab2f[_0x4293dc(0xd8)]==_0x2ca389['from_storage']&&(_0x38ab2f[_0x4293dc(0x170)]=parseInt(_0x38ab2f[_0x4293dc(0x170)])+parseInt(_0x2ca389[_0x4293dc(0xce)]));});}}),await _0x5b2362[_0x186362(0x11a)]();const _0x541b2b=await warehouse['findOne']({'name':_0xe1f39[_0x186362(0x140)],'room':_0xe1f39[_0x186362(0x1aa)]});_0xe1f39[_0x186362(0x182)]['forEach'](_0x795b33=>{var _0x4a5281=_0x186362;if(_0x795b33[_0x4a5281(0xce)]>0x0){const _0x2fb3f1=_0x541b2b[_0x4a5281(0xe5)][_0x4a5281(0x100)](_0x10baaa=>{var _0x51e61d=_0x4a5281;_0x10baaa[_0x51e61d(0x102)]==_0x795b33[_0x51e61d(0x102)]&&_0x10baaa[_0x51e61d(0x11f)]==_0x795b33[_0x51e61d(0xd6)]&&_0x10baaa[_0x51e61d(0x16b)]==_0x795b33[_0x51e61d(0x176)]&&_0x10baaa[_0x51e61d(0x14f)]==_0x795b33[_0x51e61d(0x1ac)]&&_0x10baaa[_0x51e61d(0x16c)]==_0x795b33[_0x51e61d(0x1af)]&&_0x10baaa['rack']==_0x795b33[_0x51e61d(0xdf)]&&_0x10baaa[_0x51e61d(0xd8)]==_0x795b33['storage']&&(_0x10baaa['product_stock']=parseInt(_0x10baaa['product_stock'])-parseInt(_0x795b33[_0x51e61d(0xce)]));});}}),await _0x541b2b['save'](),_0xe1f39[_0x186362(0x1a1)]=_0x24f26f,_0xe1f39[_0x186362(0x101)]=_0x108feb,_0xe1f39[_0x186362(0x140)]=_0x4bf9d4,_0xe1f39[_0x186362(0x182)]=_0x2a6e14,_0xe1f39[_0x186362(0x13c)]=_0x4317a4,_0xe1f39[_0x186362(0x188)]=_0x3d753e;const _0x9ca912=await _0xe1f39['save']();console['log'](_0x9ca912);const _0x4d8bc0=await warehouse[_0x186362(0x113)]({'name':_0x108feb,'room':_0xfa49});_0x9ca912['product']['forEach'](_0x2afc87=>{var _0x2b3da4=_0x186362;if(_0x2afc87[_0x2b3da4(0xce)]>0x0){const _0x34a907=_0x4d8bc0[_0x2b3da4(0xe5)]['map'](_0x3b8804=>{var _0x3d5c30=_0x2b3da4;_0x3b8804[_0x3d5c30(0x102)]==_0x2afc87[_0x3d5c30(0x102)]&&_0x3b8804[_0x3d5c30(0x11f)]==_0x2afc87[_0x3d5c30(0x190)]&&_0x3b8804[_0x3d5c30(0x16b)]==_0x2afc87[_0x3d5c30(0x172)]&&_0x3b8804[_0x3d5c30(0x14f)]==_0x2afc87['from_bin']&&_0x3b8804[_0x3d5c30(0x16c)]==_0x2afc87[_0x3d5c30(0xe2)]&&_0x3b8804[_0x3d5c30(0xdf)]==_0x2afc87[_0x3d5c30(0x122)]&&_0x3b8804[_0x3d5c30(0xd8)]==_0x2afc87['from_storage']&&(_0x3b8804[_0x3d5c30(0x170)]=parseInt(_0x3b8804['product_stock'])-parseInt(_0x2afc87[_0x3d5c30(0xce)]));});}}),await _0x4d8bc0['save']();const _0x2bc8e6=await warehouse[_0x186362(0x113)]({'name':_0x4bf9d4,'room':_0x2d53e4});_0x9ca912[_0x186362(0x182)]['forEach'](_0x724d35=>{var _0x2ab7ef=_0x186362;if(_0x724d35[_0x2ab7ef(0xce)]>0x0){var _0x4d59e4=0x0;const _0x3a1d0f=_0x2bc8e6[_0x2ab7ef(0xe5)][_0x2ab7ef(0x100)](_0x305eda=>{var _0x2c3e16=_0x2ab7ef;_0x305eda['product_name']==_0x724d35[_0x2c3e16(0x102)]&&_0x305eda['floorlevel']==_0x724d35[_0x2c3e16(0xd6)]&&_0x305eda[_0x2c3e16(0x16b)]==_0x724d35[_0x2c3e16(0x176)]&&_0x305eda[_0x2c3e16(0x14f)]==_0x724d35['to_bin']&&_0x305eda[_0x2c3e16(0x16c)]==_0x724d35[_0x2c3e16(0x1af)]&&_0x305eda[_0x2c3e16(0xdf)]==_0x724d35[_0x2c3e16(0xdf)]&&_0x305eda[_0x2c3e16(0xd8)]==_0x724d35['storage']&&(_0x305eda[_0x2c3e16(0x170)]=parseInt(_0x305eda[_0x2c3e16(0x170)])+parseInt(_0x724d35['to_quantity']),_0x4d59e4++);});_0x4d59e4=='0'&&(_0x2bc8e6[_0x2ab7ef(0xe5)]=_0x2bc8e6['product_details'][_0x2ab7ef(0x142)]({'product_name':_0x724d35[_0x2ab7ef(0x102)],'product_stock':_0x724d35['to_quantity'],'bay':_0x724d35['to_bay'],'bin':_0x724d35[_0x2ab7ef(0x1ac)],'type':_0x724d35[_0x2ab7ef(0x176)],'floorlevel':_0x724d35[_0x2ab7ef(0xd6)],'storage':_0x724d35['storage'],'rack':_0x724d35[_0x2ab7ef(0xdf)],'product_code':_0x724d35[_0x2ab7ef(0x150)],'primary_code':_0x724d35[_0x2ab7ef(0x14b)],'secondary_code':_0x724d35[_0x2ab7ef(0x10a)],'maxProducts':_0x724d35[_0x2ab7ef(0x14c)],'storage':_0x724d35[_0x2ab7ef(0xd8)],'rack':_0x724d35[_0x2ab7ef(0xdf)]}));}}),await _0x2bc8e6[_0x186362(0x11a)](),_0x853a3c[_0x186362(0x131)](_0x186362(0x133),'Transfer\x20Edit\x20Successfully'),_0x4da39f[_0x186362(0x193)](_0x186362(0x109));}catch(_0x160666){console['log'](_0x160666);}}),router[a0_0x4856a5(0xc1)](a0_0x4856a5(0x15d),async(_0x464e21,_0x251c0a)=>{var _0xf2f65e=a0_0x4856a5;const {FromWareHouse:_0xf5d50,FromRoom:_0x46173c,ToWarehouse:_0x25a548,ToRoom:_0xdb8a89,primary_code:_0x57efff,Roomslist:_0x52e2d8}=_0x464e21[_0xf2f65e(0x160)],_0x53396b=_0x52e2d8[_0xf2f65e(0x108)](','),_0x37af1=[];async function _0x23f999(_0x53d537){var _0x59c86d=_0xf2f65e;const _0x288ef5=await warehouse[_0x59c86d(0xcd)]([{'$match':{'name':_0xf5d50,'room':_0x53d537}},{'$unwind':_0x59c86d(0x135)},{'$match':{'product_details.primary_code':_0x57efff}},{'$group':{'_id':_0x59c86d(0xc9),'name':{'$first':_0x59c86d(0x1a4)},'instock':{'$first':_0x59c86d(0x194)},'primary_code':{'$first':_0x59c86d(0x114)},'secondary_code':{'$first':_0x59c86d(0x17c)},'product_code':{'$first':_0x59c86d(0x164)},'level':{'$first':_0x59c86d(0x18f)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x59c86d(0xc6)},'pallet':{'$first':_0x59c86d(0xd5)},'unit':{'$first':_0x59c86d(0xd1)},'secondary_unit':{'$first':_0x59c86d(0x111)},'storage':{'$first':_0x59c86d(0xdd)},'rack':{'$first':_0x59c86d(0x15b)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x59c86d(0xff)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x59c86d(0xf0)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x59c86d(0x1b0)},'maxProducts':{'$first':_0x59c86d(0xf3)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x3571f2=await warehouse['aggregate']([{'$match':{'name':_0xf5d50,'room':_0x53d537}},{'$unwind':_0x59c86d(0x135)},{'$match':{'product_details.secondary_code':_0x57efff}},{'$group':{'_id':_0x59c86d(0xc9),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x59c86d(0x194)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x59c86d(0x17c)},'product_code':{'$first':_0x59c86d(0x164)},'level':{'$first':_0x59c86d(0x18f)},'isle':{'$first':_0x59c86d(0x175)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x59c86d(0x111)},'storage':{'$first':_0x59c86d(0xdd)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x59c86d(0x132)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x59c86d(0xef)},'maxPerUnit':{'$first':_0x59c86d(0xf0)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x59c86d(0x1b0)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':'$product_details.invoice'}}}]);if(_0x288ef5[_0x59c86d(0x184)]>0x0)_0x37af1['push'](_0x288ef5);else _0x3571f2[_0x59c86d(0x184)]>0x0&&_0x37af1[_0x59c86d(0x146)](_0x3571f2);}const _0x49c060=_0x53396b[_0xf2f65e(0x100)](_0x39e191=>_0x23f999(_0x39e191));await Promise[_0xf2f65e(0x14a)](_0x49c060),_0x251c0a[_0xf2f65e(0x14d)](_0x37af1);}),router['post']('/barcode_scanner2',async(_0x57d7ec,_0x4e1c84)=>{var _0x116380=a0_0x4856a5;try{const {FromWareHouse:_0x16d3d8,FromRoom:_0x551d3d,ToWarehouse:_0xb3e86f,ToRoom:_0x2e480f,secondary_code:_0x593c10}=_0x57d7ec[_0x116380(0x160)],_0x2be1a2=await warehouse[_0x116380(0xcd)]([{'$match':{'name':_0x16d3d8}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x593c10}},{'$group':{'_id':_0x116380(0xc9),'name':{'$first':_0x116380(0x1a4)},'primary_code':{'$first':_0x116380(0x114)},'secondary_code':{'$first':_0x116380(0x17c)},'product_code':{'$first':_0x116380(0x164)},'instock':{'$first':_0x116380(0x194)},'warehouse':{'$first':_0x116380(0xec)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x116380(0x15f)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x116380(0xd1)}}}]);_0x4e1c84[_0x116380(0x165)](0xc8)['json'](_0x2be1a2);}catch(_0x1efbbe){_0x4e1c84[_0x116380(0x165)](0x194)[_0x116380(0x14d)]({'message':_0x1efbbe[_0x116380(0x12a)]});}}),router[a0_0x4856a5(0xc1)]('/barcode_scanner3',async(_0xd37b6,_0x2e66f0)=>{var _0x344f68=a0_0x4856a5;try{const {FromWareHouse:_0x223542,FromRoom:_0x21905a,ToWarehouse:_0x393a9c,ToRoom:_0x3352b6,product_code:_0x428302}=_0xd37b6['body'],_0xa0a904=await warehouse[_0x344f68(0xcd)]([{'$match':{'name':_0x223542}},{'$unwind':_0x344f68(0x135)},{'$match':{'product_details.product_code':_0x428302}},{'$group':{'_id':_0x344f68(0xc9),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x344f68(0x114)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x344f68(0xec)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x344f68(0x11c)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x344f68(0xd1)}}}]);_0x2e66f0[_0x344f68(0x165)](0xc8)[_0x344f68(0x14d)](_0xa0a904);}catch(_0x6395b9){_0x2e66f0[_0x344f68(0x165)](0x194)[_0x344f68(0x14d)]({'message':_0x6395b9[_0x344f68(0x12a)]});}}),router[a0_0x4856a5(0xc1)](a0_0x4856a5(0x18a),async(_0x25d070,_0x4e4eae)=>{var _0x5a7a04=a0_0x4856a5;const {level:_0x3215c2,isle:_0x3b0991,pallet:_0x42928d,warehouses:_0x248053,room:_0x362c94}=_0x25d070[_0x5a7a04(0x160)];try{const _0x333002=await warehouse[_0x5a7a04(0xcd)]([{'$match':{'name':_0x248053,'room':_0x362c94}},{'$unwind':_0x5a7a04(0x135)},{'$match':{'product_details.level':parseInt(_0x3215c2),'product_details.isle':_0x3b0991,'product_details.pallet':parseInt(_0x42928d)}},{'$group':{'_id':_0x5a7a04(0xc9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5a7a04(0x194)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x5a7a04(0x15f)},'maxProducts':{'$first':_0x5a7a04(0xf3)}}}]);_0x4e4eae['status'](0xc8)['json'](_0x333002);}catch(_0x4a4a0e){_0x4e4eae[_0x5a7a04(0x165)](0x194)[_0x5a7a04(0x14d)]({'message':_0x4a4a0e[_0x5a7a04(0x12a)]});}}),module[a0_0x4856a5(0x186)]=router;