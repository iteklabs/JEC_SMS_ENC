var a0_0x15fd10=a0_0x143a;(function(_0x49e619,_0x58f6ab){var _0x38edd7=a0_0x143a,_0x5827d8=_0x49e619();while(!![]){try{var _0x3d1f8b=-parseInt(_0x38edd7(0x1cc))/0x1*(-parseInt(_0x38edd7(0x1fd))/0x2)+-parseInt(_0x38edd7(0x1f2))/0x3+-parseInt(_0x38edd7(0x18e))/0x4+-parseInt(_0x38edd7(0x1de))/0x5*(parseInt(_0x38edd7(0x20a))/0x6)+-parseInt(_0x38edd7(0x1b5))/0x7*(parseInt(_0x38edd7(0x138))/0x8)+parseInt(_0x38edd7(0x1b6))/0x9*(parseInt(_0x38edd7(0x1b7))/0xa)+-parseInt(_0x38edd7(0x186))/0xb*(-parseInt(_0x38edd7(0x1ca))/0xc);if(_0x3d1f8b===_0x58f6ab)break;else _0x5827d8['push'](_0x5827d8['shift']());}catch(_0x57d243){_0x5827d8['push'](_0x5827d8['shift']());}}}(a0_0x2fc1,0xd7363));const express=require(a0_0x15fd10(0x17b)),app=express(),router=express[a0_0x15fd10(0x1f7)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x15fd10(0x1e8)),auth=require(a0_0x15fd10(0x13e)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x15fd10(0x14f));router[a0_0x15fd10(0x137)](a0_0x15fd10(0x15f),auth,async(_0x3ddad7,_0x4fb19b)=>{var _0x3bd62b=a0_0x15fd10;try{const {username:_0x217df7,email:_0x292537,role:_0x1f7aae}=_0x3ddad7[_0x3bd62b(0x20b)],_0x267891=_0x3ddad7[_0x3bd62b(0x20b)],_0x195253=await profile[_0x3bd62b(0x214)]({'email':_0x267891[_0x3bd62b(0x190)]}),_0x1e52a6=await master_shop[_0x3bd62b(0x146)]();console[_0x3bd62b(0x223)](_0x3bd62b(0x1e0),_0x1e52a6);let _0x13cdff;if(_0x267891[_0x3bd62b(0x161)]=='staff'){const _0x49f065=await staff['findOne']({'email':_0x267891[_0x3bd62b(0x190)]});_0x13cdff=await transfers[_0x3bd62b(0x146)]({'from_warehouse':_0x49f065[_0x3bd62b(0x210)]});}else _0x13cdff=await transfers[_0x3bd62b(0x21d)]([{'$unwind':_0x3bd62b(0x1ee)},{'$group':{'_id':_0x3bd62b(0x1b2),'invoice':{'$first':_0x3bd62b(0x15e)},'date':{'$first':_0x3bd62b(0x147)},'from_warehouse':{'$first':_0x3bd62b(0x21f)},'to_warehouse':{'$first':_0x3bd62b(0x184)},'from_room_name':{'$addToSet':_0x3bd62b(0x167)},'to_room_name':{'$addToSet':_0x3bd62b(0x141)},'finalize':{'$first':_0x3bd62b(0x185)},'isAllowEdit':{'$first':_0x3bd62b(0x177)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1e52a6[0x0][_0x3bd62b(0x170)]==_0x3bd62b(0x13f)){var _0xd6c92f=users[_0x3bd62b(0x1b4)];console['log'](_0xd6c92f);}else{if(_0x1e52a6[0x0][_0x3bd62b(0x170)]==_0x3bd62b(0x1ec))var _0xd6c92f=users[_0x3bd62b(0x1ec)];else{if(_0x1e52a6[0x0][_0x3bd62b(0x170)]=='German')var _0xd6c92f=users['German'];else{if(_0x1e52a6[0x0][_0x3bd62b(0x170)]==_0x3bd62b(0x1b1))var _0xd6c92f=users[_0x3bd62b(0x1b1)];else{if(_0x1e52a6[0x0]['language']==_0x3bd62b(0x19b))var _0xd6c92f=users[_0x3bd62b(0x19b)];else{if(_0x1e52a6[0x0][_0x3bd62b(0x170)]==_0x3bd62b(0x131))var _0xd6c92f=users[_0x3bd62b(0x1d2)];else{if(_0x1e52a6[0x0][_0x3bd62b(0x170)]==_0x3bd62b(0x1ea))var _0xd6c92f=users[_0x3bd62b(0x1ea)];else{if(_0x1e52a6[0x0][_0x3bd62b(0x170)]==_0x3bd62b(0x15c))var _0xd6c92f=users['Arabic'];}}}}}}}_0x4fb19b[_0x3bd62b(0x19f)](_0x3bd62b(0x142),{'success':_0x3ddad7['flash'](_0x3bd62b(0x180)),'errors':_0x3ddad7[_0x3bd62b(0x18c)]('errors'),'role':_0x267891,'profile':_0x195253,'master_shop':_0x1e52a6,'transfer':_0x13cdff,'language':_0xd6c92f});}catch(_0x4cead8){console[_0x3bd62b(0x223)](_0x4cead8);}});function a0_0x2fc1(){var _0x4bae1d=['Spanish','$_id','There\x27s\x20a\x20error\x20in\x20this\x20transaction','English','56BElGde','11561301yIkopC','10MGBeys','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','redirect','/view/add_transfer','exports','To_invoice','$name','product_code','from_prod_qty','Rack\x20D','max_per_unit','catch','site_title','<div>','ToRoomAssigned','\x20<>\x20','primary_code','unit','port','203784HrhHlj','$product_details.rack','1SBoYCE','\x20Order\x20Date\x20:\x20','maxProducts','Enabled','$product_details.isle','to_room_name','Portuguese','to_bay','$product_details.level','from_bay','padStart','from_quantity','</thead>','storage','$product_details.production_date','/../public','</tr>','rak','380fAzSBW','/barcode_scanner3','master','floor','from_prod_level','\x20Order\x20Number\x20:\x20','$product_details.floorlevel','Receiving\x20Area','id_transaction','findById','../models/all_models','production_date','Chinese','secondary_unit','Hindi','$product_details.bay','$product','from_prod_isle','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<span\x20style=\x22float:\x20right;\x22>','1506120YIkWPy','<html><head><title></title>','<!DOCTYPE\x20html>','Rack\x20C','<h5\x20style=\x22text-align:\x20left;\x22>','Router','then','TRF-','image','Rack\x20B','$product_details.secondary_unit','1425262JsVKvB','/CheckingWarehouse','<tr>','Error\x20Occurs','expiry_date','date','</h5>','$product_details.maxPerUnit','$product_details.type','from_rak','Enclosed','staff','edit_transfer_view','23964pujmWM','user','to_prod_isle','json','Floor','to_floorlevel','warehouse','$product_details.primary_code','bin','product_code3','findOne','/upload/','True','to_quantity','Level','floorlevel','Arabic','$product_details.product_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','aggregate','Rack\x20A','$from_warehouse','slice','RoomAssigned','$product_details.expiry_date','log','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','save','<strong>\x20Regards\x20</strong>','getMonth','Portuguese\x20(BR)','to_bin','Shelves','errors','<hr\x20class=\x22my-3\x22>','to_types','get','1610624UxMvyF','logo','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','body','getFullYear','from_floorlevel','../middleware/auth','English\x20(US)','batch_code','$product.to_room_name','transfer','_id','An\x20error\x20occurred\x20while\x20saving\x20data.','from_invoice','find','$date','Return\x20Rooms','from_types','params','to_invoice','RMSEmail','product_name','</tbody>','nodemailer','$product_details.product_name','status','/barcode_scanner','push','forEach','toString','edit_transfer','<h2>\x20','password','German','Ambient','Rack\x20F','Arabic\x20(ae)','invoice','$invoice','/view','/view/:id','role','$product_details.invoice','Email\x20sent\x20successfully','$product_details.secondary_code','all','$product_details.product_stock','$product.from_room_name','$product_details.maxProducts','back','rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','from_bin','primary_unit','to_warehouse','language','error','prod_name','An\x20error\x20occurred.','map','type','product','$isAllowEdit','</div>','post','Raw\x20Materials','express','to_prod_qty','$product_details.batch_code','Transfer\x20Mail','$room','success','bay','$product_details.unit','length','$to_warehouse','$finalize','1012yTrqnH','Product\x20Transfer\x20successfully','</table>','random','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','/transfer/view','flash','</td>','1047396BfJpcB','from_room_name','email','$product_details._id','product_stock','/preview/:id','to_prod_level','prod_cat','MaxStocks_data2','here','Logo.png','from_warehouse','secondary_code','French','concat','filter','message','render','$product_details.storage','from_room','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.bin','from_rack','add_transfer','/picking_list/PDF_transfer_rm/','$product_details','to_prod_pallet','New_Qty_Converted','from_storage','product_details','$product_details.pallet','getDate','from_prod_pallet','Transfer\x20Edit\x20Successfully','</head><body>'];a0_0x2fc1=function(){return _0x4bae1d;};return a0_0x2fc1();}async function getRandom8DigitNumber(){var _0xedf99d=a0_0x15fd10;const _0x1f8cd4=0x989680,_0x5b5ca2=0x5f5e0ff,_0x29661f=Math[_0xedf99d(0x1e1)](Math[_0xedf99d(0x189)]()*(_0x5b5ca2-_0x1f8cd4+0x1))+_0x1f8cd4;var _0x3461d4;const _0x3559eb=await transfers[_0xedf99d(0x214)]({'invoice':_0xedf99d(0x1f9)+_0x29661f});return _0x3559eb&&_0x3559eb['length']>0x0?_0x3461d4=_0xedf99d(0x1f9)+_0x29661f:_0x3461d4='TRF-'+_0x29661f,_0x3461d4;}router[a0_0x15fd10(0x137)](a0_0x15fd10(0x1ba),auth,async(_0x37c32c,_0x493925)=>{var _0x183dc9=a0_0x15fd10;try{const {username:_0x376d55,email:_0x5b082c,role:_0x118c9b}=_0x37c32c[_0x183dc9(0x20b)],_0x421757=_0x37c32c['user'],_0x387587=await profile[_0x183dc9(0x214)]({'email':_0x421757[_0x183dc9(0x190)]}),_0x47b500=await master_shop[_0x183dc9(0x146)]();console['log']('master',_0x47b500);let _0x3cb22c;if(_0x421757[_0x183dc9(0x161)]==_0x183dc9(0x208)){const _0x4261ee=await staff[_0x183dc9(0x214)]({'email':_0x421757['email']});_0x3cb22c=await warehouse[_0x183dc9(0x21d)]([{'$match':{'status':_0x183dc9(0x1cf),'name':_0x4261ee['warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x183dc9(0x1bd)}}}]);}else _0x3cb22c=await warehouse[_0x183dc9(0x21d)]([{'$match':{'status':_0x183dc9(0x1cf),'warehouse_category':_0x183dc9(0x17a)}},{'$group':{'_id':'$name','name':{'$first':_0x183dc9(0x1bd)}}}]);var _0x15804d=[_0x183dc9(0x15a),_0x183dc9(0x207),_0x183dc9(0x148)];const _0x376228=await transfers[_0x183dc9(0x146)]({}),_0x343886=_0x376228['length']+0x1,_0x221f84=_0x183dc9(0x1f9)+_0x343886[_0x183dc9(0x155)]()[_0x183dc9(0x1d6)](0x5,'0');if(_0x47b500[0x0]['language']==_0x183dc9(0x13f)){var _0x2aa391=users['English'];console[_0x183dc9(0x223)](_0x2aa391);}else{if(_0x47b500[0x0][_0x183dc9(0x170)]==_0x183dc9(0x1ec))var _0x2aa391=users[_0x183dc9(0x1ec)];else{if(_0x47b500[0x0][_0x183dc9(0x170)]=='German')var _0x2aa391=users[_0x183dc9(0x159)];else{if(_0x47b500[0x0][_0x183dc9(0x170)]==_0x183dc9(0x1b1))var _0x2aa391=users[_0x183dc9(0x1b1)];else{if(_0x47b500[0x0][_0x183dc9(0x170)]==_0x183dc9(0x19b))var _0x2aa391=users[_0x183dc9(0x19b)];else{if(_0x47b500[0x0]['language']==_0x183dc9(0x131))var _0x2aa391=users[_0x183dc9(0x1d2)];else{if(_0x47b500[0x0][_0x183dc9(0x170)]=='Chinese')var _0x2aa391=users[_0x183dc9(0x1ea)];else{if(_0x47b500[0x0][_0x183dc9(0x170)]==_0x183dc9(0x15c))var _0x2aa391=users[_0x183dc9(0x21a)];}}}}}}}const _0x5302d1=getRandom8DigitNumber();_0x5302d1['then'](_0x712d53=>{var _0x2304e3=_0x183dc9;_0x493925[_0x2304e3(0x19f)](_0x2304e3(0x1a5),{'success':_0x37c32c[_0x2304e3(0x18c)]('success'),'errors':_0x37c32c['flash'](_0x2304e3(0x134)),'role':_0x421757,'profile':_0x387587,'master_shop':_0x47b500,'warehouse':_0x3cb22c,'language':_0x2aa391,'rooms_data':_0x15804d,'invoice':_0x712d53});})['catch'](_0x491c33=>{var _0x438a0e=_0x183dc9;_0x37c32c[_0x438a0e(0x18c)](_0x438a0e(0x134),_0x438a0e(0x1b3)),_0x493925[_0x438a0e(0x1b9)](_0x438a0e(0x18b));});}catch(_0x53bcaa){console['log'](_0x53bcaa);}}),router[a0_0x15fd10(0x179)](a0_0x15fd10(0x1ba),auth,async(_0x69a8da,_0x197dab)=>{var _0x22356f=a0_0x15fd10;try{console[_0x22356f(0x223)](_0x69a8da[_0x22356f(0x13b)]);const {date:_0x204c11,from_warehouse:_0x3e690c,FromRoom_name:_0x5cc531,to_warehouse:_0x1c0ad7,ToRoom_name:_0x1a74d2,prod_name:_0x1e4096,from_prod_qty:_0x40445b,from_prod_level:_0x4dc258,from_prod_isle:_0x39de67,from_prod_pallet:_0xd0efa0,to_prod_qty:_0x4c9c4,to_prod_level:_0xa73e50,to_prod_isle:_0x1b4563,to_prod_pallet:_0x122c0e,primary_code:_0x4065dc,secondary_code:_0x56ac7a,product_code3:_0x2d7eb9,note:_0x3eaca3,MaxStocks_data2:_0x501d4f,invoice:_0x201137,expiry_date:_0x59df9e}=_0x69a8da[_0x22356f(0x13b)];if(typeof _0x1e4096=='string')var _0x1475ce=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x172)]],_0x460255=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x1bf)]],_0x36b4f3=[_0x69a8da['body'][_0x22356f(0x1e2)]],_0x56fa9b=[_0x69a8da['body'][_0x22356f(0x1a9)]],_0x51d876=[_0x69a8da[_0x22356f(0x13b)]['to_prod_level']],_0x32561f=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x1c7)]],_0x34d65c=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x19a)]],_0x5e1cb3=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x213)]],_0x142796=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x196)]],_0xc4fcf8=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x16e)]],_0x3db011=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x1eb)]],_0x27e43a=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x140)]],_0x78ce75=[_0x69a8da['body']['expiry_date']],_0x1ef68c=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x1c1)]],_0x3a067d=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x1e9)]],_0x3cd352=[_0x69a8da['body'][_0x22356f(0x195)]],_0x2da376=[_0x69a8da['body'][_0x22356f(0x221)]],_0xa5a317=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x1c5)]],_0x8d9a3b=[_0x69a8da[_0x22356f(0x13b)][_0x22356f(0x145)]],_0x4dfcc6=[_0x69a8da[_0x22356f(0x13b)]['to_invoice']],_0x36ed5e=[_0x69a8da[_0x22356f(0x13b)]['id_transaction']];else var _0x1475ce=[..._0x69a8da[_0x22356f(0x13b)][_0x22356f(0x172)]],_0x460255=[..._0x69a8da['body'][_0x22356f(0x1bf)]],_0x36b4f3=[..._0x69a8da['body'][_0x22356f(0x1e2)]],_0x56fa9b=[..._0x69a8da[_0x22356f(0x13b)][_0x22356f(0x1a9)]],_0x51d876=[..._0x69a8da[_0x22356f(0x13b)]['to_prod_level']],_0x32561f=[..._0x69a8da[_0x22356f(0x13b)][_0x22356f(0x1c7)]],_0x34d65c=[..._0x69a8da[_0x22356f(0x13b)][_0x22356f(0x19a)]],_0x5e1cb3=[..._0x69a8da['body'][_0x22356f(0x213)]],_0x142796=[..._0x69a8da[_0x22356f(0x13b)][_0x22356f(0x196)]],_0xc4fcf8=[..._0x69a8da['body']['primary_unit']],_0x3db011=[..._0x69a8da['body']['secondary_unit']],_0x27e43a=[..._0x69a8da['body'][_0x22356f(0x140)]],_0x78ce75=[..._0x69a8da['body'][_0x22356f(0x201)]],_0x1ef68c=[..._0x69a8da[_0x22356f(0x13b)]['max_per_unit']],_0x3a067d=[..._0x69a8da[_0x22356f(0x13b)]['production_date']],_0x3cd352=[..._0x69a8da[_0x22356f(0x13b)][_0x22356f(0x195)]],_0x2da376=[..._0x69a8da['body'][_0x22356f(0x221)]],_0xa5a317=[..._0x69a8da[_0x22356f(0x13b)]['ToRoomAssigned']],_0x8d9a3b=[..._0x69a8da[_0x22356f(0x13b)][_0x22356f(0x145)]],_0x4dfcc6=[..._0x69a8da[_0x22356f(0x13b)][_0x22356f(0x14b)]],_0x36ed5e=[..._0x69a8da['body'][_0x22356f(0x1e6)]];const _0xfc5a13=_0x1475ce['map'](_0x7a6b16=>{return _0x7a6b16={'product_name':_0x7a6b16};});_0x460255[_0x22356f(0x154)]((_0x24a8c6,_0x2a2612)=>{var _0xf20ec0=_0x22356f;_0xfc5a13[_0x2a2612][_0xf20ec0(0x1d7)]=_0x24a8c6;}),_0x8d9a3b['forEach']((_0x5e69ce,_0x48a2d5)=>{var _0x314638=_0x22356f;_0xfc5a13[_0x48a2d5][_0x314638(0x145)]=_0x5e69ce;}),_0x4dfcc6['forEach']((_0x131307,_0x41d73d)=>{var _0x430a6a=_0x22356f;_0xfc5a13[_0x41d73d][_0x430a6a(0x1bc)]=_0x131307;}),_0x36ed5e[_0x22356f(0x154)]((_0x1ba060,_0x382ee7)=>{_0xfc5a13[_0x382ee7]['id_transaction_id']=_0x1ba060;}),_0x36b4f3['forEach']((_0x2d1cf4,_0x72ea02)=>{var _0x5a1837=_0x22356f;_0x2da376[_0x5a1837(0x154)]((_0x5e10eb,_0x365ed9)=>{var _0x515f72=_0x5a1837;if(_0x5e10eb=='Receiving\x20Area'&&_0x72ea02==_0x365ed9){var _0x40fc04=_0x2d1cf4[_0x515f72(0x220)](0x3);_0xfc5a13[_0x72ea02][_0x515f72(0x1aa)]=_0x2d1cf4[0x0],_0xfc5a13[_0x72ea02][_0x515f72(0x1a4)]=_0x2d1cf4[0x1],_0xfc5a13[_0x72ea02][_0x515f72(0x1d5)]=0x0,_0xfc5a13[_0x72ea02][_0x515f72(0x16d)]=0x0,_0xfc5a13[_0x72ea02][_0x515f72(0x149)]=_0x515f72(0x20e),_0xfc5a13[_0x72ea02]['from_floorlevel']=_0x40fc04;}else{if(_0x5e10eb==_0x515f72(0x133)&&_0x72ea02==_0x365ed9){var _0x40fc04=_0x2d1cf4['slice'](0x3);_0xfc5a13[_0x72ea02][_0x515f72(0x1aa)]=_0x2d1cf4[0x0],_0xfc5a13[_0x72ea02]['from_rack']=_0x2d1cf4[0x1],_0xfc5a13[_0x72ea02]['from_bay']=0x0,_0xfc5a13[_0x72ea02]['from_bin']=0x0,_0xfc5a13[_0x72ea02][_0x515f72(0x149)]=_0x515f72(0x20e),_0xfc5a13[_0x72ea02][_0x515f72(0x13d)]=_0x2d1cf4[0x5];}else{if(_0x72ea02==_0x365ed9){if(_0x2d1cf4[0x0]=='A'&&_0x2d1cf4[0x1]=='L'&&_0x2d1cf4[0x2]=='L')console[_0x515f72(0x223)](_0x5e10eb+_0x515f72(0x1c6)+_0x72ea02+_0x515f72(0x1c6)+_0x365ed9+'\x20<>\x20'+_0x2d1cf4+_0x515f72(0x197)),_0xfc5a13[_0x72ea02][_0x515f72(0x1aa)]=_0x2d1cf4[0x0],_0xfc5a13[_0x72ea02][_0x515f72(0x1a4)]=_0x2d1cf4[0x1],_0xfc5a13[_0x72ea02][_0x515f72(0x1d5)]=0x0,_0xfc5a13[_0x72ea02]['from_bin']=0x0,_0xfc5a13[_0x72ea02][_0x515f72(0x149)]=_0x515f72(0x20e),_0xfc5a13[_0x72ea02][_0x515f72(0x13d)]=_0x2d1cf4[0x3];else{var _0x1fd3b1;if(_0x2d1cf4[0x4]=='L')_0x1fd3b1=_0x515f72(0x218);else _0x2d1cf4[0x4]=='F'&&(_0x1fd3b1=_0x515f72(0x20e));_0xfc5a13[_0x72ea02][_0x515f72(0x1aa)]=_0x2d1cf4[0x0],_0xfc5a13[_0x72ea02][_0x515f72(0x1a4)]=_0x2d1cf4[0x1],_0xfc5a13[_0x72ea02][_0x515f72(0x1d5)]=_0x2d1cf4[0x2],_0xfc5a13[_0x72ea02][_0x515f72(0x16d)]=_0x2d1cf4[0x3],_0xfc5a13[_0x72ea02][_0x515f72(0x149)]=_0x1fd3b1,_0xfc5a13[_0x72ea02][_0x515f72(0x13d)]=_0x2d1cf4[0x5];}}}}});}),_0x56fa9b[_0x22356f(0x154)]((_0x560e55,_0x488d55)=>{var _0x3441e1=_0x22356f;_0xfc5a13[_0x488d55][_0x3441e1(0x217)]=_0x560e55;}),_0x51d876[_0x22356f(0x154)]((_0x4cb10f,_0x35054b)=>{var _0x5369e2=_0x22356f;_0xa5a317[_0x5369e2(0x154)]((_0x1c9ef3,_0x299df7)=>{var _0x144ed1=_0x5369e2;if(_0x1c9ef3==_0x144ed1(0x1e5)&&_0x35054b==_0x299df7){var _0x41b8fc=_0x4cb10f['slice'](0x3);_0xfc5a13[_0x35054b]['storage']=_0x4cb10f[0x0],_0xfc5a13[_0x35054b]['rack']=_0x4cb10f[0x1],_0xfc5a13[_0x35054b][_0x144ed1(0x1d3)]=0x0,_0xfc5a13[_0x35054b][_0x144ed1(0x132)]=0x0,_0xfc5a13[_0x35054b][_0x144ed1(0x136)]=_0x144ed1(0x20e),_0xfc5a13[_0x35054b][_0x144ed1(0x20f)]=_0x41b8fc;}else{if(_0x1c9ef3==_0x144ed1(0x133)&&_0x35054b==_0x299df7){var _0x41b8fc=_0x4cb10f[_0x144ed1(0x220)](0x3);_0xfc5a13[_0x35054b][_0x144ed1(0x1d9)]=_0x4cb10f[0x0],_0xfc5a13[_0x35054b][_0x144ed1(0x16a)]=_0x4cb10f[0x1],_0xfc5a13[_0x35054b][_0x144ed1(0x1d3)]=0x0,_0xfc5a13[_0x35054b]['to_bin']=0x0,_0xfc5a13[_0x35054b][_0x144ed1(0x136)]='Floor',_0xfc5a13[_0x35054b][_0x144ed1(0x20f)]=_0x4cb10f[0x5];}else{if(_0x35054b==_0x299df7){if(_0x4cb10f[0x0]=='A'&&_0x4cb10f[0x1]=='L'&&_0x4cb10f[0x2]=='L')console['log'](_0x1c9ef3+_0x144ed1(0x1c6)+_0x35054b+'\x20<>\x20'+_0x299df7+_0x144ed1(0x1c6)+_0x4cb10f+_0x144ed1(0x197)),_0xfc5a13[_0x35054b][_0x144ed1(0x1d9)]=_0x4cb10f[0x0],_0xfc5a13[_0x35054b][_0x144ed1(0x16a)]=_0x4cb10f[0x1],_0xfc5a13[_0x35054b]['to_bay']=0x0,_0xfc5a13[_0x35054b][_0x144ed1(0x132)]=0x0,_0xfc5a13[_0x35054b][_0x144ed1(0x136)]=_0x144ed1(0x20e),_0xfc5a13[_0x35054b][_0x144ed1(0x20f)]=_0x4cb10f[0x3];else{var _0x4d3a2b;if(_0x4cb10f[0x4]=='L')_0x4d3a2b='Level';else _0x4cb10f[0x4]=='F'&&(_0x4d3a2b=_0x144ed1(0x20e));_0xfc5a13[_0x35054b][_0x144ed1(0x1d9)]=_0x4cb10f[0x0],_0xfc5a13[_0x35054b][_0x144ed1(0x16a)]=_0x4cb10f[0x1],_0xfc5a13[_0x35054b]['to_bay']=_0x4cb10f[0x2],_0xfc5a13[_0x35054b]['to_bin']=_0x4cb10f[0x3],_0xfc5a13[_0x35054b]['to_types']=_0x4d3a2b,_0xfc5a13[_0x35054b][_0x144ed1(0x20f)]=_0x4cb10f[0x5];}}}}});}),_0x32561f['forEach']((_0x1eb94f,_0x29c861)=>{_0xfc5a13[_0x29c861]['primary_code']=_0x1eb94f;}),_0x34d65c[_0x22356f(0x154)]((_0x220623,_0x194f7e)=>{var _0x36fce1=_0x22356f;_0xfc5a13[_0x194f7e][_0x36fce1(0x19a)]=_0x220623;}),_0x5e1cb3[_0x22356f(0x154)]((_0x286a0e,_0x647f32)=>{_0xfc5a13[_0x647f32]['product_code']=_0x286a0e;}),_0x142796['forEach']((_0x1e3cb7,_0x3843b5)=>{_0xfc5a13[_0x3843b5]['maxProducts']=_0x1e3cb7;}),_0xc4fcf8[_0x22356f(0x154)]((_0x50fe6f,_0x3568eb)=>{_0xfc5a13[_0x3568eb]['unit']=_0x50fe6f;}),_0x3db011[_0x22356f(0x154)]((_0x35b69b,_0x12b8d8)=>{var _0x4632e7=_0x22356f;_0xfc5a13[_0x12b8d8][_0x4632e7(0x1eb)]=_0x35b69b;}),_0x27e43a[_0x22356f(0x154)]((_0x1f0981,_0x58adde)=>{var _0x294cf5=_0x22356f;_0xfc5a13[_0x58adde][_0x294cf5(0x140)]=_0x1f0981;}),_0x78ce75[_0x22356f(0x154)]((_0x4908ba,_0x5dc84b)=>{var _0x5e3c43=_0x22356f;_0xfc5a13[_0x5dc84b][_0x5e3c43(0x201)]=_0x4908ba;}),_0x1ef68c[_0x22356f(0x154)]((_0x40b8ab,_0x4c4429)=>{_0xfc5a13[_0x4c4429]['maxperunit']=_0x40b8ab;}),_0x3a067d['forEach']((_0x8f5278,_0x75c7b0)=>{var _0x1f753f=_0x22356f;_0xfc5a13[_0x75c7b0][_0x1f753f(0x1e9)]=_0x8f5278;}),_0x3cd352[_0x22356f(0x154)]((_0x527cf3,_0x34d28c)=>{var _0x40b556=_0x22356f;_0xfc5a13[_0x34d28c][_0x40b556(0x195)]=_0x527cf3;}),_0x2da376[_0x22356f(0x154)]((_0x1be28a,_0x21515e)=>{var _0x2f7196=_0x22356f;_0xfc5a13[_0x21515e][_0x2f7196(0x18f)]=_0x1be28a;}),_0xa5a317['forEach']((_0x312c5b,_0x45d6ef)=>{var _0x363198=_0x22356f;_0xfc5a13[_0x45d6ef][_0x363198(0x1d1)]=_0x312c5b;});const _0x100888=_0xfc5a13[_0x22356f(0x19d)](_0x4e4daa=>_0x4e4daa[_0x22356f(0x217)]!=='0'&&_0x4e4daa[_0x22356f(0x217)]!==''||_0x4e4daa[_0x22356f(0x20f)]!=='0'&&_0x4e4daa[_0x22356f(0x20f)]!==''),_0x488935=new transfers({'date':_0x204c11,'from_warehouse':_0x3e690c,'to_warehouse':_0x1c0ad7,'product':_0x100888,'note':_0x3eaca3,'invoice':_0x201137}),_0x106f0f=await _0x488935[_0x22356f(0x12e)]();_0x69a8da[_0x22356f(0x18c)](_0x22356f(0x180),_0x22356f(0x187)),_0x197dab[_0x22356f(0x1b9)]('/transfer/preview/'+_0x106f0f[_0x22356f(0x143)]);}catch(_0x4c7501){console['log'](_0x4c7501),_0x197dab['status'](0xc8)[_0x22356f(0x20d)]({'errorMessage':_0x4c7501[_0x22356f(0x19e)]});}}),router[a0_0x15fd10(0x137)](a0_0x15fd10(0x193),auth,async(_0x376057,_0x45c8a4)=>{var _0x4b9b5c=a0_0x15fd10;try{const {username:_0x29f14a,email:_0x1ee807,role:_0x169021}=_0x376057['user'],_0x1bbac5=_0x376057['user'],_0x29639b=await profile[_0x4b9b5c(0x214)]({'email':_0x1bbac5[_0x4b9b5c(0x190)]}),_0xa26b46=await master_shop[_0x4b9b5c(0x146)]();console[_0x4b9b5c(0x223)](_0x4b9b5c(0x1e0),_0xa26b46);const _0x47ae74=await transfers['findById'](_0x376057[_0x4b9b5c(0x14a)]['id']);let _0x2e615d=new Date(_0x47ae74[_0x4b9b5c(0x201)]),_0x3d101b=('0'+_0x2e615d[_0x4b9b5c(0x1ad)]())['slice'](-0x2),_0x2ea294=('0'+(_0x2e615d[_0x4b9b5c(0x130)]()+0x1))[_0x4b9b5c(0x220)](-0x2),_0x26e5e6=_0x2e615d[_0x4b9b5c(0x13c)](),_0x54852a=_0x26e5e6+'-'+_0x2ea294+'-'+_0x3d101b,_0x1300c3;if(_0x1bbac5[_0x4b9b5c(0x161)]==_0x4b9b5c(0x208)){const _0x2d6bf1=await staff['findOne']({'email':_0x1bbac5[_0x4b9b5c(0x190)]});_0x1300c3=await warehouse[_0x4b9b5c(0x146)]({'status':_0x4b9b5c(0x1cf),'name':_0x2d6bf1['warehouse'],'warehouse_category':_0x4b9b5c(0x17a)});}else _0x1300c3=await warehouse['find']({'status':'Enabled','warehouse_category':_0x4b9b5c(0x17a)});const _0x580d62=await warehouse[_0x4b9b5c(0x21d)]([{'$match':{'name':_0x47ae74[_0x4b9b5c(0x199)]}},{'$unwind':_0x4b9b5c(0x1a7)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4b9b5c(0x166)},'bay':{'$first':_0x4b9b5c(0x1ed)},'bin':{'$first':_0x4b9b5c(0x1a3)},'type':{'$first':_0x4b9b5c(0x205)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4b9b5c(0x211)},'secondary_code':{'$first':_0x4b9b5c(0x164)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4b9b5c(0x1a0)},'rack':{'$first':_0x4b9b5c(0x1cb)},'expiry_date':{'$first':_0x4b9b5c(0x222)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x4b9b5c(0x17f)}}}]);if(_0xa26b46[0x0][_0x4b9b5c(0x170)]==_0x4b9b5c(0x13f)){var _0x5d69c7=users[_0x4b9b5c(0x1b4)];console[_0x4b9b5c(0x223)](_0x5d69c7);}else{if(_0xa26b46[0x0][_0x4b9b5c(0x170)]==_0x4b9b5c(0x1ec))var _0x5d69c7=users[_0x4b9b5c(0x1ec)];else{if(_0xa26b46[0x0][_0x4b9b5c(0x170)]==_0x4b9b5c(0x159))var _0x5d69c7=users[_0x4b9b5c(0x159)];else{if(_0xa26b46[0x0]['language']==_0x4b9b5c(0x1b1))var _0x5d69c7=users[_0x4b9b5c(0x1b1)];else{if(_0xa26b46[0x0][_0x4b9b5c(0x170)]==_0x4b9b5c(0x19b))var _0x5d69c7=users['French'];else{if(_0xa26b46[0x0][_0x4b9b5c(0x170)]==_0x4b9b5c(0x131))var _0x5d69c7=users['Portuguese'];else{if(_0xa26b46[0x0][_0x4b9b5c(0x170)]==_0x4b9b5c(0x1ea))var _0x5d69c7=users[_0x4b9b5c(0x1ea)];else{if(_0xa26b46[0x0][_0x4b9b5c(0x170)]==_0x4b9b5c(0x15c))var _0x5d69c7=users['Arabic'];}}}}}}}_0x45c8a4['render'](_0x4b9b5c(0x209),{'success':_0x376057['flash'](_0x4b9b5c(0x180)),'errors':_0x376057['flash'](_0x4b9b5c(0x134)),'role':_0x1bbac5,'profile':_0x29639b,'master_shop':_0xa26b46,'warehouse':_0x1300c3,'transfer':_0x47ae74,'stock':_0x580d62,'language':_0x5d69c7});}catch(_0x478c12){console[_0x4b9b5c(0x223)](_0x478c12);}}),router[a0_0x15fd10(0x179)]('/preview/:id',auth,async(_0x29e96d,_0x2f8600)=>{var _0xa545bd=a0_0x15fd10;try{const _0x3a47e9=_0x29e96d[_0xa545bd(0x14a)]['id'],{from_warehouse:_0x4c90bb,FromRoom_name:_0x340eb3,to_warehouse:_0x749a05,ToRoom_name:_0x5d7670}=_0x29e96d[_0xa545bd(0x13b)],_0x3aa79c=await transfers[_0xa545bd(0x1e7)]({'_id':_0x3a47e9}),_0x4b9769=_0x3aa79c['product']['map'](async _0x53c893=>{var _0x345007=_0xa545bd;if(_0x53c893[_0x345007(0x217)]>0x0){var _0x3c3a0f=await warehouse[_0x345007(0x214)]({'name':_0x3aa79c[_0x345007(0x199)],'room':_0x53c893['from_room_name'],'warehouse_category':'Raw\x20Materials'});const _0x3c87e9=_0x3c3a0f['product_details']['map'](_0x1174e7=>{var _0x78f350=_0x345007;_0x1174e7['product_name']==_0x53c893[_0x78f350(0x14d)]&&_0x1174e7[_0x78f350(0x219)]==_0x53c893['from_floorlevel']&&_0x1174e7['type']==_0x53c893[_0x78f350(0x149)]&&_0x1174e7[_0x78f350(0x212)]==_0x53c893[_0x78f350(0x16d)]&&_0x1174e7['bay']==_0x53c893[_0x78f350(0x1d5)]&&_0x1174e7[_0x78f350(0x16a)]==_0x53c893[_0x78f350(0x1a4)]&&_0x1174e7[_0x78f350(0x1d9)]==_0x53c893['from_storage']&&_0x1174e7['expiry_date']==_0x53c893[_0x78f350(0x201)]&&_0x1174e7[_0x78f350(0x140)]==_0x53c893['batch_code']&&_0x1174e7[_0x78f350(0x1e9)]==_0x53c893[_0x78f350(0x1e9)]&&_0x1174e7[_0x78f350(0x15d)]==_0x53c893['from_invoice']&&_0x1174e7[_0x78f350(0x143)]==_0x53c893['id_transaction_id']&&(_0x1174e7[_0x78f350(0x192)]=_0x1174e7[_0x78f350(0x192)]-_0x53c893[_0x78f350(0x217)]);});}return _0x3c3a0f;});Promise[_0xa545bd(0x165)](_0x4b9769)[_0xa545bd(0x1f8)](async _0x479936=>{var _0x28c383=_0xa545bd;try{for(const _0xdd138 of _0x479936){await _0xdd138['save']();}try{const _0x1589b2=_0x3aa79c['product'][_0x28c383(0x174)](async _0x1c3173=>{var _0x285b74=_0x28c383;if(_0x1c3173[_0x285b74(0x217)]>0x0){var _0x2debd1=await warehouse[_0x285b74(0x214)]({'name':_0x3aa79c[_0x285b74(0x16f)],'room':_0x1c3173['to_room_name'],'warehouse_category':_0x285b74(0x17a)}),_0x1f684d=0x0;const _0x19884b=_0x2debd1[_0x285b74(0x1ab)]['map'](_0x37d76b=>{var _0x1f05b5=_0x285b74;_0x37d76b['product_name']==_0x1c3173[_0x1f05b5(0x14d)]&&_0x37d76b[_0x1f05b5(0x219)]==_0x1c3173[_0x1f05b5(0x20f)]&&_0x37d76b[_0x1f05b5(0x175)]==_0x1c3173[_0x1f05b5(0x136)]&&_0x37d76b[_0x1f05b5(0x212)]==_0x1c3173['to_bin']&&_0x37d76b['bay']==_0x1c3173['to_bay']&&_0x37d76b[_0x1f05b5(0x16a)]==_0x1c3173[_0x1f05b5(0x16a)]&&_0x37d76b[_0x1f05b5(0x1d9)]==_0x1c3173[_0x1f05b5(0x1d9)]&&_0x37d76b[_0x1f05b5(0x201)]==_0x1c3173[_0x1f05b5(0x201)]&&_0x37d76b[_0x1f05b5(0x140)]==_0x1c3173['batch_code']&&_0x37d76b[_0x1f05b5(0x1e9)]==_0x1c3173['production_date']&&_0x37d76b[_0x1f05b5(0x15d)]==_0x1c3173['To_invoice']&&(_0x37d76b['product_stock']=_0x37d76b[_0x1f05b5(0x192)]+_0x1c3173[_0x1f05b5(0x217)],_0x1f684d++);});_0x1f684d=='0'&&(_0x2debd1[_0x285b74(0x1ab)]=_0x2debd1[_0x285b74(0x1ab)]['concat']({'product_name':_0x1c3173[_0x285b74(0x14d)],'product_stock':_0x1c3173[_0x285b74(0x217)],'bay':_0x1c3173[_0x285b74(0x1d3)],'bin':_0x1c3173[_0x285b74(0x132)],'type':_0x1c3173[_0x285b74(0x136)],'floorlevel':_0x1c3173[_0x285b74(0x20f)],'storage':_0x1c3173[_0x285b74(0x1d9)],'rack':_0x1c3173['rack'],'product_code':_0x1c3173[_0x285b74(0x1be)],'primary_code':_0x1c3173[_0x285b74(0x1c7)],'secondary_code':_0x1c3173[_0x285b74(0x19a)],'maxProducts':_0x1c3173[_0x285b74(0x1ce)],'storage':_0x1c3173[_0x285b74(0x1d9)],'rack':_0x1c3173['rack'],'expiry_date':_0x1c3173[_0x285b74(0x201)],'maxPerUnit':_0x1c3173['maxperunit'],'batch_code':_0x1c3173[_0x285b74(0x140)],'production_date':_0x1c3173[_0x285b74(0x1e9)]}));}return _0x2debd1;});Promise[_0x28c383(0x165)](_0x1589b2)['then'](async _0x2107d8=>{var _0x32eec8=_0x28c383;try{for(const _0x26507f of _0x2107d8){await warehouse['updateOne']({'_id':_0x26507f['_id']},{'$addToSet':{'product_details':{'$each':_0x26507f[_0x32eec8(0x1ab)]}}});}_0x3aa79c['finalize']=_0x32eec8(0x216);const _0x5d0762=await _0x3aa79c[_0x32eec8(0x12e)](),_0x47ebc3=await master_shop[_0x32eec8(0x146)](),_0x215297=await email_settings[_0x32eec8(0x214)](),_0x38da15=await supervisor_settings[_0x32eec8(0x146)]();var _0x238121=_0x3aa79c[_0x32eec8(0x176)],_0xc4341c='',_0x47dd64;for(_0x47dd64 in _0x238121){_0xc4341c+=_0x32eec8(0x1ff)+_0x32eec8(0x1a2)+_0x238121[_0x47dd64][_0x32eec8(0x14d)]+_0x32eec8(0x18d)+_0x32eec8(0x1a2)+_0x238121[_0x47dd64][_0x32eec8(0x1be)]+'</td>'+_0x32eec8(0x1a2)+_0x238121[_0x47dd64][_0x32eec8(0x217)]+_0x32eec8(0x18d)+_0x32eec8(0x1a2)+_0x238121[_0x47dd64]['unit']+'</td>'+_0x32eec8(0x1a2)+_0x238121[_0x47dd64][_0x32eec8(0x1eb)]+_0x32eec8(0x18d)+_0x32eec8(0x1a2)+_0x3aa79c[_0x32eec8(0x16f)]+_0x32eec8(0x18d)+_0x32eec8(0x1a2)+_0x238121[_0x47dd64][_0x32eec8(0x1d1)]+_0x32eec8(0x18d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x238121[_0x47dd64][_0x32eec8(0x1d9)]+_0x238121[_0x47dd64]['rack']+_0x238121[_0x47dd64][_0x32eec8(0x1d3)]+_0x238121[_0x47dd64][_0x32eec8(0x132)]+_0x238121[_0x47dd64][_0x32eec8(0x136)][0x0]+_0x238121[_0x47dd64][_0x32eec8(0x20f)]+_0x32eec8(0x18d),'</tr>';}let _0x332479=nodemailer['createTransport']({'host':_0x215297['host'],'port':Number(_0x215297[_0x32eec8(0x1c9)]),'secure':![],'auth':{'user':_0x215297[_0x32eec8(0x190)],'pass':_0x215297[_0x32eec8(0x158)]}}),_0x35311f={'from':_0x215297['email'],'to':_0x38da15[0x0][_0x32eec8(0x14c)],'subject':_0x32eec8(0x17e),'attachments':[{'filename':_0x32eec8(0x198),'path':__dirname+_0x32eec8(0x1db)+_0x32eec8(0x215)+_0x47ebc3[0x0][_0x32eec8(0x1fa)],'cid':_0x32eec8(0x139)}],'html':_0x32eec8(0x1f4)+_0x32eec8(0x1f3)+_0x32eec8(0x1b0)+'<div>'+_0x32eec8(0x21c)+_0x32eec8(0x1c4)+_0x32eec8(0x1f0)+'</div>'+'<div>'+_0x32eec8(0x157)+_0x47ebc3[0x0][_0x32eec8(0x1c3)]+'\x20</h2>'+'</div>'+_0x32eec8(0x178)+_0x32eec8(0x135)+_0x32eec8(0x1c4)+_0x32eec8(0x1f6)+_0x32eec8(0x1e3)+_0x3aa79c['invoice']+'\x20'+_0x32eec8(0x1f1)+_0x32eec8(0x1cd)+_0x3aa79c[_0x32eec8(0x202)]+'\x20'+'</span>'+_0x32eec8(0x203)+_0x32eec8(0x178)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x32eec8(0x224)+_0x32eec8(0x1ff)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x32eec8(0x18a)+_0x32eec8(0x16b)+_0x32eec8(0x16c)+_0x32eec8(0x13a)+_0x32eec8(0x1b8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x32eec8(0x1dc)+_0x32eec8(0x1d8)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0xc4341c+'\x20'+_0x32eec8(0x14e)+_0x32eec8(0x188)+_0x32eec8(0x1c4)+_0x32eec8(0x12f)+'<h5>'+_0x47ebc3[0x0][_0x32eec8(0x1c3)]+'</h5>'+_0x32eec8(0x178)+'</div>'+'</body></html>'};_0x332479['sendMail'](_0x35311f,function(_0x1c6532,_0x3adbdc){var _0x1bc6ac=_0x32eec8;_0x1c6532?(console[_0x1bc6ac(0x223)](_0x1c6532),console['log'](_0x1bc6ac(0x200))):console['log'](_0x1bc6ac(0x163));}),_0x29e96d[_0x32eec8(0x18c)](_0x32eec8(0x180),'Transfer\x20Finalize\x20Successfully'),_0x2f8600[_0x32eec8(0x1b9)](_0x32eec8(0x1a6)+_0x5d0762[_0x32eec8(0x143)]);}catch(_0x82509d){console[_0x32eec8(0x171)](_0x82509d),_0x2f8600[_0x32eec8(0x151)](0x1f4)['json']({'Perror':_0x32eec8(0x144),'message':_0x82509d[_0x32eec8(0x19e)]});}})[_0x28c383(0x1c2)](_0x54fecc=>{var _0x566b4b=_0x28c383;console[_0x566b4b(0x171)](_0x54fecc),_0x2f8600[_0x566b4b(0x151)](0x1f4)[_0x566b4b(0x20d)]({'Perror':_0x566b4b(0x173)});});}catch(_0x52280a){_0x2f8600[_0x28c383(0x20d)](_0x52280a);}}catch(_0x41c0a4){console['error'](_0x41c0a4),_0x2f8600[_0x28c383(0x151)](0x1f4)[_0x28c383(0x20d)]({'Merror':_0x28c383(0x144),'Message':_0x41c0a4[_0x28c383(0x19e)]});}})['catch'](_0x474154=>{var _0x3bffb0=_0xa545bd;console[_0x3bffb0(0x171)](_0x474154),_0x2f8600['status'](0x1f4)[_0x3bffb0(0x20d)]({'Merror':_0x3bffb0(0x173)});});}catch(_0x54cd8e){console['log'](_0x54cd8e);}});function BayBinSelected(_0x1866eb,_0x2234be){var _0x4bff3e=a0_0x15fd10,_0x43a75d=[],_0x47c7bf=[],_0x4ce776=[],_0x5e453d=[],_0x25c32b=[],_0x1131ce=[];let _0x50ff2c=[];if(_0x1866eb=='DRY\x20STORAGE')switch(_0x2234be){case _0x4bff3e(0x21e):_0x43a75d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x47c7bf=[0x1,0x2],_0x5e453d=[0x1,0x2,0x3,0x4,0x5],_0x4ce776=['Level',_0x4bff3e(0x20e)],_0x25c32b=['D'],_0x1131ce=['A'];break;case _0x4bff3e(0x1fb):_0x43a75d=[0x6,0x5,0x4,0x3,0x2,0x1],_0x47c7bf=[0x1,0x2],_0x5e453d=[0x1,0x2,0x3,0x4,0x5],_0x4ce776=[_0x4bff3e(0x218),'Floor'],_0x25c32b=['D'],_0x1131ce=['B'];break;case _0x4bff3e(0x133):_0x43a75d=[0x0],_0x47c7bf=[0x0],_0x5e453d=[0x1,0x2,0x3,0x4,0x5],_0x4ce776=[_0x4bff3e(0x20e)],_0x25c32b=['D'],_0x1131ce=['S'];break;case _0x4bff3e(0x1e5):_0x43a75d=[0x0],_0x47c7bf=[0x0],_0x5e453d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x4ce776=['Floor'],_0x25c32b=['D'],_0x1131ce=['R'];break;}else{if(_0x1866eb=='COLD\x20STORAGE')switch(_0x2234be){case _0x4bff3e(0x21e):_0x43a75d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x47c7bf=['B','F'],_0x5e453d=[0x1,0x2,0x3,0x4,0x5],_0x4ce776=[_0x4bff3e(0x218),_0x4bff3e(0x20e)],_0x25c32b=['C'],_0x1131ce=['A'];break;case _0x4bff3e(0x1fb):_0x43a75d=[0x5,0x4,0x3,0x2,0x1],_0x47c7bf=['F','B','S'],_0x5e453d=[0x1,0x2,0x3,0x4,0x5],_0x4ce776=['Level',_0x4bff3e(0x20e)],_0x25c32b=['C'],_0x1131ce=['B'];break;case _0x4bff3e(0x1f5):_0x43a75d=[0x1,0x2,0x3,0x4,0x5],_0x47c7bf=['B','F','S'],_0x5e453d=[0x5,0x4,0x3,0x2,0x1],_0x4ce776=[_0x4bff3e(0x218),'Floor'],_0x25c32b=['C'],_0x1131ce=['C'];break;case _0x4bff3e(0x1c0):_0x43a75d=[0x5,0x4,0x3,0x2,0x1],_0x47c7bf=['F','B','S'],_0x5e453d=[0x1,0x2,0x3,0x4,0x5],_0x4ce776=[_0x4bff3e(0x218),_0x4bff3e(0x20e)],_0x25c32b=['C'],_0x1131ce=['D'];break;case'Rack\x20E':_0x43a75d=[0x4,0x3,0x2,0x1],_0x47c7bf=[0x1,0x2],_0x5e453d=[0x1,0x2,0x3,0x4,0x5],_0x4ce776=[_0x4bff3e(0x218),'Floor'],_0x25c32b=['C'],_0x1131ce=['E'];break;case _0x4bff3e(0x15b):_0x43a75d=[0x1,0x2,0x3],_0x47c7bf=[0x1,0x2],_0x5e453d=[0x1,0x2,0x3,0x4,0x5],_0x4ce776=[_0x4bff3e(0x218)],_0x25c32b=['C'],_0x1131ce=['F'];break;}}return{'levels':_0x43a75d,'Isle':_0x47c7bf,'rack':_0x5e453d,'type':_0x4ce776,'storage':_0x25c32b,'rak':_0x1131ce};}function a0_0x143a(_0xc18289,_0x15cb90){var _0x2fc1e3=a0_0x2fc1();return a0_0x143a=function(_0x143abe,_0x35a056){_0x143abe=_0x143abe-0x12e;var _0x63e799=_0x2fc1e3[_0x143abe];return _0x63e799;},a0_0x143a(_0xc18289,_0x15cb90);}router[a0_0x15fd10(0x137)](a0_0x15fd10(0x160),auth,async(_0x333b04,_0x201de7)=>{var _0x3cc9a5=a0_0x15fd10;try{const {username:_0x176504,email:_0x2c58ea,role:_0x22afba}=_0x333b04[_0x3cc9a5(0x20b)],_0x55e2ee=_0x333b04[_0x3cc9a5(0x20b)],_0x733c8e=await profile[_0x3cc9a5(0x214)]({'email':_0x55e2ee[_0x3cc9a5(0x190)]}),_0x1f1039=await master_shop[_0x3cc9a5(0x146)](),_0x298938=await transfers[_0x3cc9a5(0x1e7)](_0x333b04[_0x3cc9a5(0x14a)]['id']);let _0x455397;if(_0x55e2ee[_0x3cc9a5(0x161)]==_0x3cc9a5(0x208)){const _0x335dc6=await staff[_0x3cc9a5(0x214)]({'email':_0x55e2ee[_0x3cc9a5(0x190)]});_0x455397=await warehouse[_0x3cc9a5(0x21d)]([{'$match':{'status':_0x3cc9a5(0x1cf),'name':_0x335dc6[_0x3cc9a5(0x210)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3cc9a5(0x1bd),'name':{'$first':_0x3cc9a5(0x1bd)}}}]);}else _0x455397=await warehouse[_0x3cc9a5(0x21d)]([{'$match':{'status':_0x3cc9a5(0x1cf),'warehouse_category':_0x3cc9a5(0x17a)}},{'$group':{'_id':_0x3cc9a5(0x1bd),'name':{'$first':'$name'}}}]);const _0x9e61b3=await warehouse[_0x3cc9a5(0x21d)]([{'$match':{'name':_0x298938[_0x3cc9a5(0x199)],'warehouse_category':_0x3cc9a5(0x17a)}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3cc9a5(0x150)},'product_stock':{'$first':_0x3cc9a5(0x166)},'bay':{'$first':_0x3cc9a5(0x1ed)},'bin':{'$first':_0x3cc9a5(0x1a3)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3cc9a5(0x21b)},'storage':{'$first':_0x3cc9a5(0x1a0)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3cc9a5(0x1da)},'room':{'$first':_0x3cc9a5(0x17f)}}}]),_0x1e8e74=await product[_0x3cc9a5(0x146)]({}),_0x391180=BayBinSelected(_0x298938[_0x3cc9a5(0x16f)],_0x298938['to_room']);if(_0x1f1039[0x0][_0x3cc9a5(0x170)]==_0x3cc9a5(0x13f)){var _0xa32b5=users['English'];console[_0x3cc9a5(0x223)](_0xa32b5);}else{if(_0x1f1039[0x0][_0x3cc9a5(0x170)]=='Hindi')var _0xa32b5=users[_0x3cc9a5(0x1ec)];else{if(_0x1f1039[0x0]['language']=='German')var _0xa32b5=users['German'];else{if(_0x1f1039[0x0][_0x3cc9a5(0x170)]=='Spanish')var _0xa32b5=users[_0x3cc9a5(0x1b1)];else{if(_0x1f1039[0x0][_0x3cc9a5(0x170)]==_0x3cc9a5(0x19b))var _0xa32b5=users[_0x3cc9a5(0x19b)];else{if(_0x1f1039[0x0][_0x3cc9a5(0x170)]==_0x3cc9a5(0x131))var _0xa32b5=users[_0x3cc9a5(0x1d2)];else{if(_0x1f1039[0x0][_0x3cc9a5(0x170)]=='Chinese')var _0xa32b5=users[_0x3cc9a5(0x1ea)];else{if(_0x1f1039[0x0][_0x3cc9a5(0x170)]=='Arabic\x20(ae)')var _0xa32b5=users[_0x3cc9a5(0x21a)];}}}}}}}_0x201de7[_0x3cc9a5(0x19f)](_0x3cc9a5(0x156),{'success':_0x333b04[_0x3cc9a5(0x18c)]('success'),'errors':_0x333b04[_0x3cc9a5(0x18c)](_0x3cc9a5(0x134)),'role':_0x55e2ee,'profile':_0x733c8e,'master_shop':_0x1f1039,'warehouse':_0x455397,'transfer':_0x298938,'stock':_0x9e61b3,'unit':_0x1e8e74,'language':_0xa32b5});}catch(_0x3dabfb){console[_0x3cc9a5(0x223)](_0x3dabfb);}}),router[a0_0x15fd10(0x179)](a0_0x15fd10(0x160),auth,async(_0x13d150,_0x3cda4b)=>{var _0x592bcf=a0_0x15fd10;try{const _0x245aee=_0x13d150[_0x592bcf(0x14a)]['id'],_0x3f08b0=await transfers[_0x592bcf(0x1e7)](_0x245aee);_0x3cda4b[_0x592bcf(0x20d)](_0x13d150[_0x592bcf(0x13b)]);return;const {date:_0x255ea4,from_warehouse:_0x4a4005,FromRoom_name:_0x58a03c,to_warehouse:_0x53186a,ToRoom_name:_0x16e924,prod_name:_0x23cb20,from_prod_qty:_0x51325f,from_prod_level:_0x3d41d9,from_prod_isle:_0x13e5d3,from_prod_pallet:_0x2ad328,to_prod_qty:_0x2bb33d,to_prod_level:_0x4b9a29,to_prod_isle:_0x719748,to_prod_pallet:_0x57e504,primary_code:_0x265a9a,secondary_code:_0x302c61,product_code3:_0x43ca1b,note:_0x40e5d9,invoice:_0x8e88a3,expiry_date:_0x4f8aea}=_0x13d150[_0x592bcf(0x13b)];if(typeof _0x23cb20=='string')var _0x30b213=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x172)]],_0x25b2b7=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1bf)]],_0x3b4d09=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1e2)]],_0x1f2f7e=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1ef)]],_0x24f634=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1ae)]],_0x32fec4=[_0x13d150['body'][_0x592bcf(0x149)]],_0x32bcee=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x17c)]],_0x2ea78d=[_0x13d150['body'][_0x592bcf(0x194)]],_0x1be8f2=[_0x13d150['body'][_0x592bcf(0x20c)]],_0x4aca16=[_0x13d150[_0x592bcf(0x13b)]['to_prod_pallet']],_0x42a6f7=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x136)]],_0x3a0de9=[_0x13d150['body'][_0x592bcf(0x1d9)]],_0x4f2565=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1dd)]],_0x4ab483=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1c7)]],_0x411046=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x19a)]],_0x30cd42=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x213)]],_0x9378fb=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x196)]],_0x9d264a=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1c8)]],_0x55c74f=[_0x13d150['body'][_0x592bcf(0x1eb)]],_0x1517aa=[_0x13d150[_0x592bcf(0x13b)]['batch_code']],_0x1bedb2=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x201)]],_0x16489e=[_0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1aa)]],_0x5745ec=[_0x13d150[_0x592bcf(0x13b)]['from_rak']];else var _0x30b213=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x172)]],_0x3a0de9=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1d9)]],_0x4f2565=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1dd)]],_0x32fec4=[..._0x13d150[_0x592bcf(0x13b)]['from_types']],_0x42a6f7=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x136)]],_0x25b2b7=[..._0x13d150[_0x592bcf(0x13b)]['from_prod_qty']],_0x3b4d09=[..._0x13d150['body'][_0x592bcf(0x1e2)]],_0x1f2f7e=[..._0x13d150['body']['from_prod_isle']],_0x24f634=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1ae)]],_0x32bcee=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x17c)]],_0x2ea78d=[..._0x13d150[_0x592bcf(0x13b)]['to_prod_level']],_0x1be8f2=[..._0x13d150['body'][_0x592bcf(0x20c)]],_0x4aca16=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1a8)]],_0x4ab483=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1c7)]],_0x411046=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x19a)]],_0x30cd42=[..._0x13d150[_0x592bcf(0x13b)]['product_code3']],_0x9378fb=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x196)]],_0x9d264a=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1c8)]],_0x55c74f=[..._0x13d150['body']['secondary_unit']],_0x1517aa=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x140)]],_0x1bedb2=[..._0x13d150['body']['expiry_date']],_0x16489e=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x1aa)]],_0x5745ec=[..._0x13d150[_0x592bcf(0x13b)][_0x592bcf(0x206)]];const _0x5dc15f=_0x30b213[_0x592bcf(0x174)](_0x10009d=>{return _0x10009d={'product_name':_0x10009d};});_0x25b2b7[_0x592bcf(0x154)]((_0x349cd7,_0x3473ce)=>{_0x5dc15f[_0x3473ce]['from_quantity']=_0x349cd7;}),_0x3b4d09['forEach']((_0x4816be,_0x290f85)=>{_0x5dc15f[_0x290f85]['from_bay']=_0x4816be;}),_0x1f2f7e[_0x592bcf(0x154)]((_0x4fd548,_0x3e2a53)=>{_0x5dc15f[_0x3e2a53]['from_bin']=_0x4fd548;}),_0x24f634[_0x592bcf(0x154)]((_0x2997ce,_0x15549b)=>{_0x5dc15f[_0x15549b]['from_floorlevel']=_0x2997ce;}),_0x32bcee['forEach']((_0x10341e,_0x583eb4)=>{_0x5dc15f[_0x583eb4]['to_quantity']=_0x10341e;}),_0x2ea78d['forEach']((_0x1019d8,_0x44d23d)=>{var _0xd71bb0=_0x592bcf;_0x5dc15f[_0x44d23d][_0xd71bb0(0x1d3)]=_0x1019d8;}),_0x1be8f2[_0x592bcf(0x154)]((_0x570d9b,_0x248cc5)=>{var _0x14e6e9=_0x592bcf;_0x5dc15f[_0x248cc5][_0x14e6e9(0x132)]=_0x570d9b;}),_0x4aca16[_0x592bcf(0x154)]((_0x5c9f7f,_0x198667)=>{var _0x7ad694=_0x592bcf;_0x5dc15f[_0x198667][_0x7ad694(0x20f)]=_0x5c9f7f;}),_0x4ab483[_0x592bcf(0x154)]((_0x5c078d,_0x2bb817)=>{_0x5dc15f[_0x2bb817]['primary_code']=_0x5c078d;}),_0x411046[_0x592bcf(0x154)]((_0x5adcdb,_0x55a3a2)=>{_0x5dc15f[_0x55a3a2]['secondary_code']=_0x5adcdb;}),_0x30cd42[_0x592bcf(0x154)]((_0x443a15,_0x23c050)=>{var _0x1d3c1a=_0x592bcf;_0x5dc15f[_0x23c050][_0x1d3c1a(0x1be)]=_0x443a15;}),_0x9378fb[_0x592bcf(0x154)]((_0x1748d9,_0x556704)=>{var _0x113240=_0x592bcf;_0x5dc15f[_0x556704][_0x113240(0x1ce)]=_0x1748d9;}),_0x9d264a[_0x592bcf(0x154)]((_0x42bf07,_0x348870)=>{var _0x4bb961=_0x592bcf;_0x5dc15f[_0x348870][_0x4bb961(0x1c8)]=_0x42bf07;}),_0x55c74f['forEach']((_0x331a68,_0x3f33ed)=>{var _0x4308d3=_0x592bcf;_0x5dc15f[_0x3f33ed][_0x4308d3(0x1eb)]=_0x331a68;}),_0x1517aa[_0x592bcf(0x154)]((_0x2c1691,_0xb789bb)=>{var _0x2496e8=_0x592bcf;_0x5dc15f[_0xb789bb][_0x2496e8(0x140)]=_0x2c1691;}),_0x1bedb2['forEach']((_0x16335e,_0x1d4a63)=>{var _0x4fdfd7=_0x592bcf;_0x5dc15f[_0x1d4a63][_0x4fdfd7(0x201)]=_0x16335e;}),_0x3a0de9[_0x592bcf(0x154)]((_0x3d5aed,_0x23b9b6)=>{_0x5dc15f[_0x23b9b6]['storage']=_0x3d5aed;}),_0x4f2565[_0x592bcf(0x154)]((_0x40b28c,_0x554895)=>{_0x5dc15f[_0x554895]['rack']=_0x40b28c;}),_0x32fec4[_0x592bcf(0x154)]((_0x56f5de,_0x5bc2c3)=>{var _0x4d7334=_0x592bcf;_0x5dc15f[_0x5bc2c3][_0x4d7334(0x149)]=_0x56f5de;}),_0x42a6f7[_0x592bcf(0x154)]((_0x32d1d0,_0x45e861)=>{var _0x2f0770=_0x592bcf;_0x5dc15f[_0x45e861][_0x2f0770(0x136)]=_0x32d1d0;}),_0x16489e['forEach']((_0x1e6da0,_0x3fad85)=>{var _0xd73367=_0x592bcf;_0x5dc15f[_0x3fad85][_0xd73367(0x1aa)]=_0x1e6da0;}),_0x5745ec[_0x592bcf(0x154)]((_0x1c5603,_0x236602)=>{var _0x415698=_0x592bcf;_0x5dc15f[_0x236602][_0x415698(0x1a4)]=_0x1c5603;});const _0x53fe61=_0x5dc15f[_0x592bcf(0x19d)](_0x23c037=>_0x23c037['to_quantity']!=='0'&&_0x23c037[_0x592bcf(0x217)]!==''||_0x23c037['to_floorlevel']!=='0'&&_0x23c037[_0x592bcf(0x20f)]!=='');var _0x18ec12=0x0;_0x53fe61[_0x592bcf(0x154)](_0x4ecaf2=>{var _0xef448a=_0x592bcf;parseInt(_0x4ecaf2['from_quantity'])<parseInt(_0x4ecaf2[_0xef448a(0x217)])&&_0x18ec12++;});if(_0x18ec12!=0x0)return _0x13d150[_0x592bcf(0x18c)](_0x592bcf(0x134),_0x592bcf(0x225)),_0x3cda4b['redirect'](_0x592bcf(0x169));const _0x264e5c=await warehouse[_0x592bcf(0x214)]({'name':_0x3f08b0[_0x592bcf(0x199)],'room':_0x3f08b0[_0x592bcf(0x1a1)]});_0x3f08b0[_0x592bcf(0x176)][_0x592bcf(0x154)](_0x223bde=>{var _0x38b507=_0x592bcf;if(_0x223bde[_0x38b507(0x217)]>0x0){const _0x36694e=_0x264e5c[_0x38b507(0x1ab)][_0x38b507(0x174)](_0x46387f=>{var _0x53b622=_0x38b507;_0x46387f[_0x53b622(0x14d)]==_0x223bde['product_name']&&_0x46387f['floorlevel']==_0x223bde[_0x53b622(0x13d)]&&_0x46387f['type']==_0x223bde['from_types']&&_0x46387f[_0x53b622(0x212)]==_0x223bde[_0x53b622(0x16d)]&&_0x46387f['bay']==_0x223bde[_0x53b622(0x1d5)]&&_0x46387f[_0x53b622(0x16a)]==_0x223bde['from_rack']&&_0x46387f[_0x53b622(0x1d9)]==_0x223bde[_0x53b622(0x1aa)]&&(_0x46387f[_0x53b622(0x192)]=parseInt(_0x46387f['product_stock'])+parseInt(_0x223bde[_0x53b622(0x217)]));});}}),await _0x264e5c[_0x592bcf(0x12e)]();const _0x5a6d0a=await warehouse[_0x592bcf(0x214)]({'name':_0x3f08b0[_0x592bcf(0x16f)],'room':_0x3f08b0['to_room']});_0x3f08b0['product'][_0x592bcf(0x154)](_0x5d4cf4=>{var _0x3883b6=_0x592bcf;if(_0x5d4cf4[_0x3883b6(0x217)]>0x0){const _0x2fc306=_0x5a6d0a[_0x3883b6(0x1ab)][_0x3883b6(0x174)](_0x241243=>{var _0x21b15c=_0x3883b6;_0x241243[_0x21b15c(0x14d)]==_0x5d4cf4[_0x21b15c(0x14d)]&&_0x241243[_0x21b15c(0x219)]==_0x5d4cf4[_0x21b15c(0x20f)]&&_0x241243['type']==_0x5d4cf4[_0x21b15c(0x136)]&&_0x241243[_0x21b15c(0x212)]==_0x5d4cf4[_0x21b15c(0x132)]&&_0x241243[_0x21b15c(0x181)]==_0x5d4cf4['to_bay']&&_0x241243[_0x21b15c(0x16a)]==_0x5d4cf4[_0x21b15c(0x16a)]&&_0x241243[_0x21b15c(0x1d9)]==_0x5d4cf4[_0x21b15c(0x1d9)]&&(_0x241243[_0x21b15c(0x192)]=parseInt(_0x241243['product_stock'])-parseInt(_0x5d4cf4[_0x21b15c(0x217)]));});}}),await _0x5a6d0a[_0x592bcf(0x12e)](),_0x3f08b0[_0x592bcf(0x202)]=_0x255ea4,_0x3f08b0[_0x592bcf(0x199)]=_0x4a4005,_0x3f08b0[_0x592bcf(0x16f)]=_0x53186a,_0x3f08b0['product']=_0x53fe61,_0x3f08b0['note']=_0x40e5d9,_0x3f08b0['invoice']=_0x8e88a3;const _0x2ab8c7=await _0x3f08b0[_0x592bcf(0x12e)]();console[_0x592bcf(0x223)](_0x2ab8c7);const _0x59f1f4=await warehouse[_0x592bcf(0x214)]({'name':_0x4a4005,'room':_0x58a03c});_0x2ab8c7['product'][_0x592bcf(0x154)](_0x2a94d6=>{var _0x3531d8=_0x592bcf;if(_0x2a94d6['to_quantity']>0x0){const _0x2d87ca=_0x59f1f4[_0x3531d8(0x1ab)][_0x3531d8(0x174)](_0x3cbea7=>{var _0x230f0f=_0x3531d8;_0x3cbea7[_0x230f0f(0x14d)]==_0x2a94d6[_0x230f0f(0x14d)]&&_0x3cbea7['floorlevel']==_0x2a94d6[_0x230f0f(0x13d)]&&_0x3cbea7[_0x230f0f(0x175)]==_0x2a94d6[_0x230f0f(0x149)]&&_0x3cbea7[_0x230f0f(0x212)]==_0x2a94d6['from_bin']&&_0x3cbea7[_0x230f0f(0x181)]==_0x2a94d6['from_bay']&&_0x3cbea7[_0x230f0f(0x16a)]==_0x2a94d6[_0x230f0f(0x1a4)]&&_0x3cbea7['storage']==_0x2a94d6[_0x230f0f(0x1aa)]&&(_0x3cbea7[_0x230f0f(0x192)]=parseInt(_0x3cbea7[_0x230f0f(0x192)])-parseInt(_0x2a94d6[_0x230f0f(0x217)]));});}}),await _0x59f1f4[_0x592bcf(0x12e)]();const _0x16933d=await warehouse[_0x592bcf(0x214)]({'name':_0x53186a,'room':_0x16e924});_0x2ab8c7[_0x592bcf(0x176)][_0x592bcf(0x154)](_0x1956d5=>{var _0x5bfd3b=_0x592bcf;if(_0x1956d5['to_quantity']>0x0){var _0x198fa8=0x0;const _0x30fdaf=_0x16933d['product_details'][_0x5bfd3b(0x174)](_0x2214fb=>{var _0x267dd0=_0x5bfd3b;_0x2214fb[_0x267dd0(0x14d)]==_0x1956d5[_0x267dd0(0x14d)]&&_0x2214fb[_0x267dd0(0x219)]==_0x1956d5['to_floorlevel']&&_0x2214fb['type']==_0x1956d5[_0x267dd0(0x136)]&&_0x2214fb['bin']==_0x1956d5['to_bin']&&_0x2214fb['bay']==_0x1956d5[_0x267dd0(0x1d3)]&&_0x2214fb['rack']==_0x1956d5['rack']&&_0x2214fb['storage']==_0x1956d5['storage']&&(_0x2214fb[_0x267dd0(0x192)]=parseInt(_0x2214fb[_0x267dd0(0x192)])+parseInt(_0x1956d5[_0x267dd0(0x217)]),_0x198fa8++);});_0x198fa8=='0'&&(_0x16933d['product_details']=_0x16933d[_0x5bfd3b(0x1ab)][_0x5bfd3b(0x19c)]({'product_name':_0x1956d5[_0x5bfd3b(0x14d)],'product_stock':_0x1956d5[_0x5bfd3b(0x217)],'bay':_0x1956d5[_0x5bfd3b(0x1d3)],'bin':_0x1956d5[_0x5bfd3b(0x132)],'type':_0x1956d5[_0x5bfd3b(0x136)],'floorlevel':_0x1956d5['to_floorlevel'],'storage':_0x1956d5[_0x5bfd3b(0x1d9)],'rack':_0x1956d5['rack'],'product_code':_0x1956d5[_0x5bfd3b(0x1be)],'primary_code':_0x1956d5['primary_code'],'secondary_code':_0x1956d5['secondary_code'],'maxProducts':_0x1956d5[_0x5bfd3b(0x1ce)],'storage':_0x1956d5[_0x5bfd3b(0x1d9)],'rack':_0x1956d5['rack']}));}}),await _0x16933d[_0x592bcf(0x12e)](),_0x13d150[_0x592bcf(0x18c)]('success',_0x592bcf(0x1af)),_0x3cda4b[_0x592bcf(0x1b9)]('/transfer/view');}catch(_0x5b203b){console['log'](_0x5b203b);}}),router[a0_0x15fd10(0x179)](a0_0x15fd10(0x152),async(_0x5c0391,_0x125663)=>{var _0x332624=a0_0x15fd10;const {FromWareHouse:_0x5a33b1,FromRoom:_0x127270,ToWarehouse:_0x1706cc,ToRoom:_0x30fac7,primary_code:_0x2afeda,Roomslist:_0x24fbd1}=_0x5c0391['body'],_0x792410=_0x24fbd1['split'](','),_0x31da01=[];async function _0x542b00(_0x72cd4c){var _0xec991f=a0_0x143a;const _0x2df868=await warehouse[_0xec991f(0x21d)]([{'$match':{'name':_0x5a33b1,'room':_0x72cd4c}},{'$unwind':_0xec991f(0x1a7)},{'$match':{'product_details.primary_code':_0x2afeda}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0xec991f(0x166)},'primary_code':{'$first':_0xec991f(0x211)},'secondary_code':{'$first':_0xec991f(0x164)},'product_code':{'$first':_0xec991f(0x21b)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0xec991f(0x1a3)},'type':{'$first':_0xec991f(0x205)},'pallet':{'$first':_0xec991f(0x1e4)},'unit':{'$first':_0xec991f(0x182)},'secondary_unit':{'$first':_0xec991f(0x1fc)},'storage':{'$first':_0xec991f(0x1a0)},'rack':{'$first':_0xec991f(0x1cb)},'expiry_date':{'$first':_0xec991f(0x222)},'production_date':{'$first':_0xec991f(0x1da)},'batch_code':{'$first':_0xec991f(0x17d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0xec991f(0x17f)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x2905f9=await warehouse[_0xec991f(0x21d)]([{'$match':{'name':_0x5a33b1,'room':_0x72cd4c}},{'$unwind':_0xec991f(0x1a7)},{'$match':{'product_details.secondary_code':_0x2afeda}},{'$group':{'_id':_0xec991f(0x191),'name':{'$first':_0xec991f(0x150)},'instock':{'$first':_0xec991f(0x166)},'primary_code':{'$first':_0xec991f(0x211)},'secondary_code':{'$first':_0xec991f(0x164)},'product_code':{'$first':_0xec991f(0x21b)},'level':{'$first':_0xec991f(0x1ed)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0xec991f(0x182)},'secondary_unit':{'$first':_0xec991f(0x1fc)},'storage':{'$first':_0xec991f(0x1a0)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xec991f(0x222)},'production_date':{'$first':_0xec991f(0x1da)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0xec991f(0x204)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0xec991f(0x17f)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0xec991f(0x162)}}}]);if(_0x2df868[_0xec991f(0x183)]>0x0)_0x31da01[_0xec991f(0x153)](_0x2df868);else _0x2905f9[_0xec991f(0x183)]>0x0&&_0x31da01[_0xec991f(0x153)](_0x2905f9);}const _0xd6f024=_0x792410[_0x332624(0x174)](_0x3aa668=>_0x542b00(_0x3aa668));await Promise[_0x332624(0x165)](_0xd6f024),_0x125663[_0x332624(0x20d)](_0x31da01);}),router[a0_0x15fd10(0x179)]('/barcode_scanner2',async(_0xe178a,_0x1decaa)=>{var _0x3eb7b7=a0_0x15fd10;try{const {FromWareHouse:_0x49f447,FromRoom:_0x988311,ToWarehouse:_0xaaf6f3,ToRoom:_0x246594,secondary_code:_0x578577}=_0xe178a[_0x3eb7b7(0x13b)],_0x4488ca=await warehouse[_0x3eb7b7(0x21d)]([{'$match':{'name':_0x49f447}},{'$unwind':_0x3eb7b7(0x1a7)},{'$match':{'product_details.secondary_code':_0x578577}},{'$group':{'_id':_0x3eb7b7(0x191),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x3eb7b7(0x211)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3eb7b7(0x21b)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x3eb7b7(0x1bd)},'level':{'$first':_0x3eb7b7(0x1d4)},'isle':{'$first':_0x3eb7b7(0x1d0)},'pallet':{'$first':_0x3eb7b7(0x1ac)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x3eb7b7(0x182)}}}]);_0x1decaa[_0x3eb7b7(0x151)](0xc8)[_0x3eb7b7(0x20d)](_0x4488ca);}catch(_0x2706f8){_0x1decaa[_0x3eb7b7(0x151)](0x194)[_0x3eb7b7(0x20d)]({'message':_0x2706f8[_0x3eb7b7(0x19e)]});}}),router[a0_0x15fd10(0x179)](a0_0x15fd10(0x1df),async(_0x2af99e,_0x52b6db)=>{var _0x18fe46=a0_0x15fd10;try{const {FromWareHouse:_0x3c1b2b,FromRoom:_0x3fe581,ToWarehouse:_0x5b40b3,ToRoom:_0x42d433,product_code:_0x569e00}=_0x2af99e[_0x18fe46(0x13b)],_0x48a583=await warehouse[_0x18fe46(0x21d)]([{'$match':{'name':_0x3c1b2b}},{'$unwind':_0x18fe46(0x1a7)},{'$match':{'product_details.product_code':_0x569e00}},{'$group':{'_id':_0x18fe46(0x191),'name':{'$first':_0x18fe46(0x150)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x18fe46(0x21b)},'instock':{'$first':_0x18fe46(0x166)},'warehouse':{'$first':'$name'},'level':{'$first':_0x18fe46(0x1d4)},'isle':{'$first':_0x18fe46(0x1d0)},'pallet':{'$first':_0x18fe46(0x1ac)},'maxProducts':{'$first':_0x18fe46(0x168)},'unit':{'$first':'$product_details.unit'}}}]);_0x52b6db['status'](0xc8)['json'](_0x48a583);}catch(_0xbbb036){_0x52b6db[_0x18fe46(0x151)](0x194)[_0x18fe46(0x20d)]({'message':_0xbbb036[_0x18fe46(0x19e)]});}}),router[a0_0x15fd10(0x179)](a0_0x15fd10(0x1fe),async(_0x16df0e,_0x3b0c2a)=>{var _0x19095a=a0_0x15fd10;const {level:_0x27b4c5,isle:_0x4b62ac,pallet:_0x35ee01,warehouses:_0x40f137,room:_0x396d5b}=_0x16df0e['body'];try{const _0x455491=await warehouse[_0x19095a(0x21d)]([{'$match':{'name':_0x40f137,'room':_0x396d5b}},{'$unwind':_0x19095a(0x1a7)},{'$match':{'product_details.level':parseInt(_0x27b4c5),'product_details.isle':_0x4b62ac,'product_details.pallet':parseInt(_0x35ee01)}},{'$group':{'_id':_0x19095a(0x191),'name':{'$first':_0x19095a(0x150)},'product_stock':{'$first':_0x19095a(0x166)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x19095a(0x1d0)},'pallet':{'$first':_0x19095a(0x1ac)},'maxProducts':{'$first':_0x19095a(0x168)}}}]);_0x3b0c2a[_0x19095a(0x151)](0xc8)[_0x19095a(0x20d)](_0x455491);}catch(_0x5885ff){_0x3b0c2a[_0x19095a(0x151)](0x194)[_0x19095a(0x20d)]({'message':_0x5885ff[_0x19095a(0x19e)]});}}),module[a0_0x15fd10(0x1bb)]=router;