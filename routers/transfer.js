var a0_0x37eb0f=a0_0x3fb0;(function(_0xe22916,_0x151853){var _0x1d682c=a0_0x3fb0,_0x113c92=_0xe22916();while(!![]){try{var _0x252e98=-parseInt(_0x1d682c(0x241))/0x1*(parseInt(_0x1d682c(0x1c0))/0x2)+-parseInt(_0x1d682c(0x1a1))/0x3*(-parseInt(_0x1d682c(0x211))/0x4)+parseInt(_0x1d682c(0x17e))/0x5+-parseInt(_0x1d682c(0x172))/0x6+-parseInt(_0x1d682c(0x1e5))/0x7*(parseInt(_0x1d682c(0x253))/0x8)+parseInt(_0x1d682c(0x190))/0x9*(parseInt(_0x1d682c(0x1c9))/0xa)+parseInt(_0x1d682c(0x165))/0xb*(-parseInt(_0x1d682c(0x242))/0xc);if(_0x252e98===_0x151853)break;else _0x113c92['push'](_0x113c92['shift']());}catch(_0x3cfeb7){_0x113c92['push'](_0x113c92['shift']());}}}(a0_0x598d,0xb1e4a));const express=require(a0_0x37eb0f(0x178)),app=express(),router=express[a0_0x37eb0f(0x1e4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x37eb0f(0x21a)),auth=require('../middleware/auth'),users=require(a0_0x37eb0f(0x1dd)),nodemailer=require(a0_0x37eb0f(0x1cd));router[a0_0x37eb0f(0x249)](a0_0x37eb0f(0x15c),auth,async(_0x2f7cb0,_0x5e99ec)=>{var _0x2d844a=a0_0x37eb0f;try{const {username:_0x47afc5,email:_0x4716a1,role:_0xee471b}=_0x2f7cb0[_0x2d844a(0x195)],_0x15aa21=_0x2f7cb0['user'],_0x248148=await profile[_0x2d844a(0x1c8)]({'email':_0x15aa21[_0x2d844a(0x225)]}),_0x136b61=await master_shop[_0x2d844a(0x16c)]();console[_0x2d844a(0x222)]('master',_0x136b61);let _0x47a1d2;if(_0x15aa21[_0x2d844a(0x193)]=='staff'){const _0x2404fc=await staff['findOne']({'email':_0x15aa21[_0x2d844a(0x225)]});_0x47a1d2=await transfers['find']({'from_warehouse':_0x2404fc[_0x2d844a(0x160)]});}else _0x47a1d2=await transfers['aggregate']([{'$unwind':_0x2d844a(0x246)},{'$group':{'_id':_0x2d844a(0x179),'invoice':{'$first':'$invoice'},'date':{'$first':_0x2d844a(0x1e2)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x2d844a(0x1b1)},'from_room_name':{'$addToSet':_0x2d844a(0x220)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x2d844a(0x201)},'isAllowEdit':{'$first':_0x2d844a(0x1c2)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x136b61[0x0]['language']==_0x2d844a(0x22e)){var _0x3d42e9=users['English'];console[_0x2d844a(0x222)](_0x3d42e9);}else{if(_0x136b61[0x0][_0x2d844a(0x194)]=='Hindi')var _0x3d42e9=users[_0x2d844a(0x186)];else{if(_0x136b61[0x0]['language']==_0x2d844a(0x22c))var _0x3d42e9=users['German'];else{if(_0x136b61[0x0][_0x2d844a(0x194)]=='Spanish')var _0x3d42e9=users['Spanish'];else{if(_0x136b61[0x0]['language']=='French')var _0x3d42e9=users[_0x2d844a(0x22d)];else{if(_0x136b61[0x0][_0x2d844a(0x194)]==_0x2d844a(0x243))var _0x3d42e9=users['Portuguese'];else{if(_0x136b61[0x0][_0x2d844a(0x194)]==_0x2d844a(0x209))var _0x3d42e9=users[_0x2d844a(0x209)];else{if(_0x136b61[0x0]['language']==_0x2d844a(0x163))var _0x3d42e9=users[_0x2d844a(0x247)];}}}}}}}_0x5e99ec[_0x2d844a(0x214)](_0x2d844a(0x250),{'success':_0x2f7cb0[_0x2d844a(0x24e)]('success'),'errors':_0x2f7cb0[_0x2d844a(0x24e)](_0x2d844a(0x202)),'role':_0x15aa21,'profile':_0x248148,'master_shop':_0x136b61,'transfer':_0x47a1d2,'language':_0x3d42e9});}catch(_0x7d83e5){console[_0x2d844a(0x222)](_0x7d83e5);}});function a0_0x598d(){var _0x7a580b=['$product_details._id','Transfer\x20Edit\x20Successfully','from_prod_pallet','find','\x20<>\x20','/view/:id','$product_details.storage','<h5>','to_prod_isle','1903116zInLOC','$product_details.type','$product_details.secondary_unit','/preview/:id','product','findById','express','$_id','status','<div>','Shelves','to_room_name','6188330JDhDfa','then','Rack\x20A','True','Email\x20sent\x20successfully','to_types','sendMail','to_prod_level','Hindi','length','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','batch_code','port','Enclosed','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','max_per_unit','$product_details.invoice','6836985LtqUuU','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','staff','role','language','user','from_prod_qty','map','Rack\x20E','/transfer/view','\x20Order\x20Date\x20:\x20','exports','from_floorlevel','padStart','Rack\x20B','</table>','from_bay','4312302BagsFe','/upload/','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Rack\x20C','/picking_list/PDF_transfer_rm/','</div>','password','$product_details.level','/barcode_scanner2','to_floorlevel','<h5\x20style=\x22text-align:\x20left;\x22>','from_types','id_transaction_id','rak','$product_details.expiry_date','filter','$to_warehouse','$product_details.secondary_code','DRY\x20STORAGE','$product_details.pallet','$product_details.production_date','image','product_code','from_quantity','$product_details.product_code','to_quantity','Spanish','</td>','RoomAssigned','here','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','2706552OuDlPz','edit_transfer','$isAllowEdit','/transfer/preview/','save','$product_details.floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','product_stock','findOne','10mUCLWG','<span\x20style=\x22float:\x20right;\x22>','MaxStocks_data2','expiry_date','nodemailer','Logo.png','concat','rack','New_Qty_Converted','Receiving\x20Area','</span>','slice','floorlevel','Floor','invoice','$product_details.product_name','$product_details.bay','string','message','host','../public/language/languages.json','unit','$product_details.batch_code','forEach','toString','$date','to_bin','Router','33334qmRlBg','Portuguese','from_invoice','prod_cat','/barcode_scanner','storage','Rack\x20F','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','production_date','to_prod_qty','/view/add_transfer','/../public','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.unit','from_storage','post','\x20Order\x20Number\x20:\x20','redirect','TRF-','_id','primary_unit','site_title','Raw\x20Materials','</h5>','note','</tr>','from_room_name','<html><head><title></title>','$finalize','errors','bin','from_bin','type','back','edit_transfer_view','from_room','Chinese','$product_details.isle','params','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','aggregate','master','<table\x20style=\x22width:\x20100%\x20!important;\x22>','to_warehouse','4iXyEVd','$product_details.product_stock','product_details','render','prod_name','push','Ambient','</head><body>','body','../models/all_models','bay','from_rak','id_transaction','$product_details.rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product.from_room_name','$product_details.bin','log','product_name','<tr>','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','to_bay','<!DOCTYPE\x20html>','$product_details.maxProducts','from_rack','An\x20error\x20occurred.','German','French','English\x20(US)','error','to_prod_pallet','Product\x20Transfer\x20successfully','/barcode_scanner3','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','maxProducts','secondary_unit','catch','<tbody\x20style=\x22text-align:\x20center;\x22>','$name','\x20</h2>','primary_code','updateOne','maxperunit','from_prod_level','secondary_code','from_warehouse','Level','1TlcZuE','3970524WysxxD','Portuguese\x20(BR)','<h2>\x20','$product_details.primary_code','$product','Arabic','Enabled','get','<hr\x20class=\x22my-3\x22>','json','getDate','product_code3','flash','all','transfer','add_transfer','Rack\x20D','1184hCZVTl','/view','ToRoomAssigned','from_prod_isle','$product_details','warehouse','$room','</thead>','Arabic\x20(ae)','to_invoice','11wltsCO','$product_details.maxPerUnit','finalize','success'];a0_0x598d=function(){return _0x7a580b;};return a0_0x598d();}async function getRandom8DigitNumber(){var _0x48e06b=a0_0x37eb0f;const _0x597a74=0x989680,_0x429ab3=0x5f5e0ff,_0x5788d2=Math['floor'](Math['random']()*(_0x429ab3-_0x597a74+0x1))+_0x597a74;var _0x5220ed;const _0x3fb4c1=await transfers['findOne']({'invoice':_0x48e06b(0x1f7)+_0x5788d2});return _0x3fb4c1&&_0x3fb4c1[_0x48e06b(0x187)]>0x0?_0x5220ed=_0x48e06b(0x1f7)+_0x5788d2:_0x5220ed=_0x48e06b(0x1f7)+_0x5788d2,_0x5220ed;}router[a0_0x37eb0f(0x249)](a0_0x37eb0f(0x1ef),auth,async(_0x4a6628,_0x3d2e58)=>{var _0x284156=a0_0x37eb0f;try{const {username:_0x2cb665,email:_0x1078b0,role:_0x72f6e4}=_0x4a6628['user'],_0x2b8e03=_0x4a6628['user'],_0x1125f9=await profile['findOne']({'email':_0x2b8e03['email']}),_0x4f7901=await master_shop['find']();console[_0x284156(0x222)](_0x284156(0x20e),_0x4f7901);let _0x30fa9a;if(_0x2b8e03['role']=='staff'){const _0x1f18a4=await staff[_0x284156(0x1c8)]({'email':_0x2b8e03[_0x284156(0x225)]});_0x30fa9a=await warehouse[_0x284156(0x20d)]([{'$match':{'status':_0x284156(0x248),'name':_0x1f18a4[_0x284156(0x160)],'warehouse_category':_0x284156(0x1fb)}},{'$group':{'_id':'$name','name':{'$first':_0x284156(0x238)}}}]);}else _0x30fa9a=await warehouse['aggregate']([{'$match':{'status':_0x284156(0x248),'warehouse_category':_0x284156(0x1fb)}},{'$group':{'_id':'$name','name':{'$first':_0x284156(0x238)}}}]);var _0x52ce20=[_0x284156(0x217),_0x284156(0x18c),'Return\x20Rooms'];const _0x34f79c=await transfers[_0x284156(0x16c)]({}),_0x235869=_0x34f79c['length']+0x1,_0x5ac648=_0x284156(0x1f7)+_0x235869[_0x284156(0x1e1)]()[_0x284156(0x19d)](0x5,'0');if(_0x4f7901[0x0]['language']==_0x284156(0x22e)){var _0x3fc5cf=users['English'];console[_0x284156(0x222)](_0x3fc5cf);}else{if(_0x4f7901[0x0]['language']==_0x284156(0x186))var _0x3fc5cf=users[_0x284156(0x186)];else{if(_0x4f7901[0x0][_0x284156(0x194)]==_0x284156(0x22c))var _0x3fc5cf=users[_0x284156(0x22c)];else{if(_0x4f7901[0x0][_0x284156(0x194)]==_0x284156(0x1bb))var _0x3fc5cf=users[_0x284156(0x1bb)];else{if(_0x4f7901[0x0][_0x284156(0x194)]==_0x284156(0x22d))var _0x3fc5cf=users['French'];else{if(_0x4f7901[0x0][_0x284156(0x194)]==_0x284156(0x243))var _0x3fc5cf=users[_0x284156(0x1e6)];else{if(_0x4f7901[0x0][_0x284156(0x194)]==_0x284156(0x209))var _0x3fc5cf=users[_0x284156(0x209)];else{if(_0x4f7901[0x0][_0x284156(0x194)]==_0x284156(0x163))var _0x3fc5cf=users[_0x284156(0x247)];}}}}}}}const _0x2a413f=getRandom8DigitNumber();_0x2a413f[_0x284156(0x17f)](_0x1e2f66=>{var _0x5cf257=_0x284156;_0x3d2e58[_0x5cf257(0x214)](_0x5cf257(0x251),{'success':_0x4a6628[_0x5cf257(0x24e)](_0x5cf257(0x168)),'errors':_0x4a6628['flash'](_0x5cf257(0x202)),'role':_0x2b8e03,'profile':_0x1125f9,'master_shop':_0x4f7901,'warehouse':_0x30fa9a,'language':_0x3fc5cf,'rooms_data':_0x52ce20,'invoice':_0x1e2f66});})[_0x284156(0x236)](_0x4cdf11=>{var _0xeb4c26=_0x284156;_0x4a6628[_0xeb4c26(0x24e)](_0xeb4c26(0x202),_0xeb4c26(0x1a3)),_0x3d2e58[_0xeb4c26(0x1f6)](_0xeb4c26(0x199));});}catch(_0x523c40){console[_0x284156(0x222)](_0x523c40);}}),router[a0_0x37eb0f(0x1f4)](a0_0x37eb0f(0x1ef),auth,async(_0x57f1bf,_0x287ca5)=>{var _0x336885=a0_0x37eb0f;try{console['log'](_0x57f1bf['body']);const {date:_0x41c2b9,from_warehouse:_0x39e7ca,FromRoom_name:_0xd2750a,to_warehouse:_0x2f1a1e,ToRoom_name:_0x17fab3,prod_name:_0x454886,from_prod_qty:_0xeaa984,from_prod_level:_0x1311ae,from_prod_isle:_0x975cf4,from_prod_pallet:_0x4b19a5,to_prod_qty:_0x1031e8,to_prod_level:_0x438ce7,to_prod_isle:_0x3b46f5,to_prod_pallet:_0x3d572f,primary_code:_0xa36e1,secondary_code:_0x54169e,product_code3:_0x4937c6,note:_0x4c0704,MaxStocks_data2:_0xc814d9,invoice:_0x361ae1,expiry_date:_0x2f5906}=_0x57f1bf[_0x336885(0x219)];if(typeof _0x454886=='string')var _0x303260=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x215)]],_0x3daf28=[_0x57f1bf['body'][_0x336885(0x196)]],_0x5357d1=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x23d)]],_0x1ed105=[_0x57f1bf[_0x336885(0x219)]['New_Qty_Converted']],_0x3de878=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x185)]],_0x3c3ebc=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x23a)]],_0x5eacea=[_0x57f1bf[_0x336885(0x219)]['secondary_code']],_0x311273=[_0x57f1bf[_0x336885(0x219)]['product_code3']],_0x53c3bb=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x1cb)]],_0x5bfd84=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x1f9)]],_0x512f2b=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x235)]],_0x37e3f5=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x18a)]],_0x88e165=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x1cc)]],_0x1c57b9=[_0x57f1bf['body'][_0x336885(0x18e)]],_0x31ce90=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x1ed)]],_0x2c5c80=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x1e8)]],_0x59c6d5=[_0x57f1bf[_0x336885(0x219)]['RoomAssigned']],_0x6fcc7f=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x15d)]],_0x8a91ff=[_0x57f1bf['body']['from_invoice']],_0x4d5e98=[_0x57f1bf[_0x336885(0x219)]['to_invoice']],_0x4fc2aa=[_0x57f1bf[_0x336885(0x219)][_0x336885(0x21d)]];else var _0x303260=[..._0x57f1bf['body'][_0x336885(0x215)]],_0x3daf28=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x196)]],_0x5357d1=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x23d)]],_0x1ed105=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x1d1)]],_0x3de878=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x185)]],_0x3c3ebc=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x23a)]],_0x5eacea=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x23e)]],_0x311273=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x24d)]],_0x53c3bb=[..._0x57f1bf['body'][_0x336885(0x1cb)]],_0x5bfd84=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x1f9)]],_0x512f2b=[..._0x57f1bf['body']['secondary_unit']],_0x37e3f5=[..._0x57f1bf[_0x336885(0x219)]['batch_code']],_0x88e165=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x1cc)]],_0x1c57b9=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x18e)]],_0x31ce90=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x1ed)]],_0x2c5c80=[..._0x57f1bf['body'][_0x336885(0x1e8)]],_0x59c6d5=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x1bd)]],_0x6fcc7f=[..._0x57f1bf[_0x336885(0x219)][_0x336885(0x15d)]],_0x8a91ff=[..._0x57f1bf[_0x336885(0x219)]['from_invoice']],_0x4d5e98=[..._0x57f1bf['body'][_0x336885(0x164)]],_0x4fc2aa=[..._0x57f1bf['body'][_0x336885(0x21d)]];const _0x14b2bc=_0x303260[_0x336885(0x197)](_0x348632=>{return _0x348632={'product_name':_0x348632};});_0x3daf28[_0x336885(0x1e0)]((_0x2144a6,_0x158bd4)=>{var _0x48d461=_0x336885;_0x14b2bc[_0x158bd4][_0x48d461(0x1b8)]=_0x2144a6;}),_0x8a91ff[_0x336885(0x1e0)]((_0x31c989,_0x2d3951)=>{var _0x595be2=_0x336885;_0x14b2bc[_0x2d3951][_0x595be2(0x1e7)]=_0x31c989;}),_0x4d5e98[_0x336885(0x1e0)]((_0x423981,_0x4dd179)=>{_0x14b2bc[_0x4dd179]['To_invoice']=_0x423981;}),_0x4fc2aa[_0x336885(0x1e0)]((_0x52ae32,_0x4b71a5)=>{_0x14b2bc[_0x4b71a5]['id_transaction_id']=_0x52ae32;}),_0x5357d1[_0x336885(0x1e0)]((_0x4da353,_0x2e5e89)=>{var _0x42c722=_0x336885;_0x59c6d5[_0x42c722(0x1e0)]((_0xc2a412,_0x1e4306)=>{var _0x16c298=_0x42c722;if(_0xc2a412==_0x16c298(0x1d2)&&_0x2e5e89==_0x1e4306){var _0x210ff1=_0x4da353[_0x16c298(0x1d4)](0x3);_0x14b2bc[_0x2e5e89]['from_storage']=_0x4da353[0x0],_0x14b2bc[_0x2e5e89][_0x16c298(0x22a)]=_0x4da353[0x1],_0x14b2bc[_0x2e5e89][_0x16c298(0x1a0)]=0x0,_0x14b2bc[_0x2e5e89]['from_bin']=0x0,_0x14b2bc[_0x2e5e89][_0x16c298(0x1ac)]=_0x16c298(0x1d6),_0x14b2bc[_0x2e5e89][_0x16c298(0x19c)]=_0x210ff1;}else{if(_0xc2a412==_0x16c298(0x17c)&&_0x2e5e89==_0x1e4306){var _0x210ff1=_0x4da353[_0x16c298(0x1d4)](0x3);_0x14b2bc[_0x2e5e89]['from_storage']=_0x4da353[0x0],_0x14b2bc[_0x2e5e89][_0x16c298(0x22a)]=_0x4da353[0x1],_0x14b2bc[_0x2e5e89]['from_bay']=0x0,_0x14b2bc[_0x2e5e89][_0x16c298(0x204)]=0x0,_0x14b2bc[_0x2e5e89][_0x16c298(0x1ac)]=_0x16c298(0x1d6),_0x14b2bc[_0x2e5e89]['from_floorlevel']=_0x4da353[0x5];}else{if(_0x2e5e89==_0x1e4306){if(_0x4da353[0x0]=='A'&&_0x4da353[0x1]=='L'&&_0x4da353[0x2]=='L')console['log'](_0xc2a412+_0x16c298(0x16d)+_0x2e5e89+_0x16c298(0x16d)+_0x1e4306+'\x20<>\x20'+_0x4da353+_0x16c298(0x1be)),_0x14b2bc[_0x2e5e89]['from_storage']=_0x4da353[0x0],_0x14b2bc[_0x2e5e89]['from_rack']=_0x4da353[0x1],_0x14b2bc[_0x2e5e89][_0x16c298(0x1a0)]=0x0,_0x14b2bc[_0x2e5e89][_0x16c298(0x204)]=0x0,_0x14b2bc[_0x2e5e89]['from_types']=_0x16c298(0x1d6),_0x14b2bc[_0x2e5e89][_0x16c298(0x19c)]=_0x4da353[0x3];else{var _0x2eed98;if(_0x4da353[0x4]=='L')_0x2eed98=_0x16c298(0x240);else _0x4da353[0x4]=='F'&&(_0x2eed98=_0x16c298(0x1d6));_0x14b2bc[_0x2e5e89][_0x16c298(0x1f3)]=_0x4da353[0x0],_0x14b2bc[_0x2e5e89][_0x16c298(0x22a)]=_0x4da353[0x1],_0x14b2bc[_0x2e5e89]['from_bay']=_0x4da353[0x2],_0x14b2bc[_0x2e5e89][_0x16c298(0x204)]=_0x4da353[0x3],_0x14b2bc[_0x2e5e89][_0x16c298(0x1ac)]=_0x2eed98,_0x14b2bc[_0x2e5e89]['from_floorlevel']=_0x4da353[0x5];}}}}});}),_0x1ed105[_0x336885(0x1e0)]((_0x50fd5e,_0xdd62b8)=>{_0x14b2bc[_0xdd62b8]['to_quantity']=_0x50fd5e;}),_0x3de878[_0x336885(0x1e0)]((_0x4290f2,_0x4cf2ec)=>{_0x6fcc7f['forEach']((_0x2eced6,_0x45a1be)=>{var _0xef4613=a0_0x3fb0;if(_0x2eced6==_0xef4613(0x1d2)&&_0x4cf2ec==_0x45a1be){var _0x3fd805=_0x4290f2[_0xef4613(0x1d4)](0x3);_0x14b2bc[_0x4cf2ec][_0xef4613(0x1ea)]=_0x4290f2[0x0],_0x14b2bc[_0x4cf2ec]['rack']=_0x4290f2[0x1],_0x14b2bc[_0x4cf2ec]['to_bay']=0x0,_0x14b2bc[_0x4cf2ec][_0xef4613(0x1e3)]=0x0,_0x14b2bc[_0x4cf2ec][_0xef4613(0x183)]=_0xef4613(0x1d6),_0x14b2bc[_0x4cf2ec]['to_floorlevel']=_0x3fd805;}else{if(_0x2eced6==_0xef4613(0x17c)&&_0x4cf2ec==_0x45a1be){var _0x3fd805=_0x4290f2[_0xef4613(0x1d4)](0x3);_0x14b2bc[_0x4cf2ec][_0xef4613(0x1ea)]=_0x4290f2[0x0],_0x14b2bc[_0x4cf2ec][_0xef4613(0x1d0)]=_0x4290f2[0x1],_0x14b2bc[_0x4cf2ec][_0xef4613(0x227)]=0x0,_0x14b2bc[_0x4cf2ec][_0xef4613(0x1e3)]=0x0,_0x14b2bc[_0x4cf2ec]['to_types']=_0xef4613(0x1d6),_0x14b2bc[_0x4cf2ec][_0xef4613(0x1aa)]=_0x4290f2[0x5];}else{if(_0x4cf2ec==_0x45a1be){if(_0x4290f2[0x0]=='A'&&_0x4290f2[0x1]=='L'&&_0x4290f2[0x2]=='L')console[_0xef4613(0x222)](_0x2eced6+_0xef4613(0x16d)+_0x4cf2ec+_0xef4613(0x16d)+_0x45a1be+'\x20<>\x20'+_0x4290f2+_0xef4613(0x1be)),_0x14b2bc[_0x4cf2ec][_0xef4613(0x1ea)]=_0x4290f2[0x0],_0x14b2bc[_0x4cf2ec][_0xef4613(0x1d0)]=_0x4290f2[0x1],_0x14b2bc[_0x4cf2ec]['to_bay']=0x0,_0x14b2bc[_0x4cf2ec]['to_bin']=0x0,_0x14b2bc[_0x4cf2ec][_0xef4613(0x183)]=_0xef4613(0x1d6),_0x14b2bc[_0x4cf2ec][_0xef4613(0x1aa)]=_0x4290f2[0x3];else{var _0x1d4e9c;if(_0x4290f2[0x4]=='L')_0x1d4e9c=_0xef4613(0x240);else _0x4290f2[0x4]=='F'&&(_0x1d4e9c=_0xef4613(0x1d6));_0x14b2bc[_0x4cf2ec][_0xef4613(0x1ea)]=_0x4290f2[0x0],_0x14b2bc[_0x4cf2ec][_0xef4613(0x1d0)]=_0x4290f2[0x1],_0x14b2bc[_0x4cf2ec][_0xef4613(0x227)]=_0x4290f2[0x2],_0x14b2bc[_0x4cf2ec][_0xef4613(0x1e3)]=_0x4290f2[0x3],_0x14b2bc[_0x4cf2ec][_0xef4613(0x183)]=_0x1d4e9c,_0x14b2bc[_0x4cf2ec][_0xef4613(0x1aa)]=_0x4290f2[0x5];}}}}});}),_0x3c3ebc[_0x336885(0x1e0)]((_0x5bc378,_0x5bbd47)=>{_0x14b2bc[_0x5bbd47]['primary_code']=_0x5bc378;}),_0x5eacea['forEach']((_0x395717,_0x43c4e1)=>{_0x14b2bc[_0x43c4e1]['secondary_code']=_0x395717;}),_0x311273[_0x336885(0x1e0)]((_0x1eeb2d,_0x293aa0)=>{var _0x355e5a=_0x336885;_0x14b2bc[_0x293aa0][_0x355e5a(0x1b7)]=_0x1eeb2d;}),_0x53c3bb[_0x336885(0x1e0)]((_0x34881e,_0x2fe8ab)=>{_0x14b2bc[_0x2fe8ab]['maxProducts']=_0x34881e;}),_0x5bfd84[_0x336885(0x1e0)]((_0x1b45da,_0x361a10)=>{var _0x1e1624=_0x336885;_0x14b2bc[_0x361a10][_0x1e1624(0x1de)]=_0x1b45da;}),_0x512f2b[_0x336885(0x1e0)]((_0x345350,_0x199f6a)=>{_0x14b2bc[_0x199f6a]['secondary_unit']=_0x345350;}),_0x37e3f5[_0x336885(0x1e0)]((_0x30502a,_0xf0ebac)=>{_0x14b2bc[_0xf0ebac]['batch_code']=_0x30502a;}),_0x88e165[_0x336885(0x1e0)]((_0x5ea882,_0x3bcb16)=>{var _0x594957=_0x336885;_0x14b2bc[_0x3bcb16][_0x594957(0x1cc)]=_0x5ea882;}),_0x1c57b9[_0x336885(0x1e0)]((_0xcb7a01,_0x1f1300)=>{_0x14b2bc[_0x1f1300]['maxperunit']=_0xcb7a01;}),_0x31ce90[_0x336885(0x1e0)]((_0x291e92,_0x564a0d)=>{var _0x4888b1=_0x336885;_0x14b2bc[_0x564a0d][_0x4888b1(0x1ed)]=_0x291e92;}),_0x2c5c80[_0x336885(0x1e0)]((_0xb13561,_0x4ba382)=>{var _0x4e1fc1=_0x336885;_0x14b2bc[_0x4ba382][_0x4e1fc1(0x1e8)]=_0xb13561;}),_0x59c6d5[_0x336885(0x1e0)]((_0x5dd9c4,_0x33c302)=>{var _0x8fee5f=_0x336885;_0x14b2bc[_0x33c302][_0x8fee5f(0x1ff)]=_0x5dd9c4;}),_0x6fcc7f[_0x336885(0x1e0)]((_0x312ade,_0x12d703)=>{var _0x903c42=_0x336885;_0x14b2bc[_0x12d703][_0x903c42(0x17d)]=_0x312ade;});const _0x28b0ba=_0x14b2bc['filter'](_0x441be2=>_0x441be2['to_quantity']!=='0'&&_0x441be2['to_quantity']!==''||_0x441be2[_0x336885(0x1aa)]!=='0'&&_0x441be2[_0x336885(0x1aa)]!==''),_0x33c388=new transfers({'date':_0x41c2b9,'from_warehouse':_0x39e7ca,'to_warehouse':_0x2f1a1e,'product':_0x28b0ba,'note':_0x4c0704,'invoice':_0x361ae1}),_0x25957c=await _0x33c388[_0x336885(0x1c4)]();_0x57f1bf['flash']('success',_0x336885(0x231)),_0x287ca5['redirect'](_0x336885(0x1c3)+_0x25957c['_id']);}catch(_0x53fb81){console['log'](_0x53fb81),_0x287ca5[_0x336885(0x17a)](0xc8)[_0x336885(0x24b)]({'errorMessage':_0x53fb81['message']});}}),router[a0_0x37eb0f(0x249)](a0_0x37eb0f(0x175),auth,async(_0x241797,_0x325a83)=>{var _0x1925ad=a0_0x37eb0f;try{const {username:_0x1118a6,email:_0x5d2ec5,role:_0x584f44}=_0x241797[_0x1925ad(0x195)],_0x56cbdc=_0x241797[_0x1925ad(0x195)],_0xf219d4=await profile['findOne']({'email':_0x56cbdc[_0x1925ad(0x225)]}),_0x438a0e=await master_shop[_0x1925ad(0x16c)]();console[_0x1925ad(0x222)](_0x1925ad(0x20e),_0x438a0e);const _0x2853ce=await transfers[_0x1925ad(0x177)](_0x241797['params']['id']);let _0x143bb0=new Date(_0x2853ce[_0x1925ad(0x1cc)]),_0x2a1d0b=('0'+_0x143bb0[_0x1925ad(0x24c)]())['slice'](-0x2),_0x2ebfcf=('0'+(_0x143bb0['getMonth']()+0x1))['slice'](-0x2),_0x1e4422=_0x143bb0['getFullYear'](),_0x128497=_0x1e4422+'-'+_0x2ebfcf+'-'+_0x2a1d0b,_0x37f2d1;if(_0x56cbdc['role']==_0x1925ad(0x192)){const _0x3bdcb8=await staff['findOne']({'email':_0x56cbdc[_0x1925ad(0x225)]});_0x37f2d1=await warehouse[_0x1925ad(0x16c)]({'status':_0x1925ad(0x248),'name':_0x3bdcb8[_0x1925ad(0x160)],'warehouse_category':_0x1925ad(0x1fb)});}else _0x37f2d1=await warehouse['find']({'status':_0x1925ad(0x248),'warehouse_category':_0x1925ad(0x1fb)});const _0x187dcb=await warehouse[_0x1925ad(0x20d)]([{'$match':{'name':_0x2853ce[_0x1925ad(0x23f)]}},{'$unwind':_0x1925ad(0x15f)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1925ad(0x1d8)},'product_stock':{'$first':_0x1925ad(0x212)},'bay':{'$first':_0x1925ad(0x1d9)},'bin':{'$first':_0x1925ad(0x221)},'type':{'$first':_0x1925ad(0x173)},'floorlevel':{'$first':_0x1925ad(0x1c5)},'primary_code':{'$first':_0x1925ad(0x245)},'secondary_code':{'$first':_0x1925ad(0x1b2)},'product_code':{'$first':_0x1925ad(0x1b9)},'storage':{'$first':_0x1925ad(0x16f)},'rack':{'$first':_0x1925ad(0x21e)},'expiry_date':{'$first':_0x1925ad(0x1af)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x1925ad(0x161)}}}]);if(_0x438a0e[0x0][_0x1925ad(0x194)]==_0x1925ad(0x22e)){var _0x80ef6d=users[_0x1925ad(0x188)];console[_0x1925ad(0x222)](_0x80ef6d);}else{if(_0x438a0e[0x0][_0x1925ad(0x194)]==_0x1925ad(0x186))var _0x80ef6d=users[_0x1925ad(0x186)];else{if(_0x438a0e[0x0]['language']=='German')var _0x80ef6d=users[_0x1925ad(0x22c)];else{if(_0x438a0e[0x0]['language']=='Spanish')var _0x80ef6d=users[_0x1925ad(0x1bb)];else{if(_0x438a0e[0x0][_0x1925ad(0x194)]==_0x1925ad(0x22d))var _0x80ef6d=users[_0x1925ad(0x22d)];else{if(_0x438a0e[0x0][_0x1925ad(0x194)]==_0x1925ad(0x243))var _0x80ef6d=users[_0x1925ad(0x1e6)];else{if(_0x438a0e[0x0][_0x1925ad(0x194)]==_0x1925ad(0x209))var _0x80ef6d=users['Chinese'];else{if(_0x438a0e[0x0][_0x1925ad(0x194)]=='Arabic\x20(ae)')var _0x80ef6d=users[_0x1925ad(0x247)];}}}}}}}_0x325a83[_0x1925ad(0x214)](_0x1925ad(0x207),{'success':_0x241797[_0x1925ad(0x24e)](_0x1925ad(0x168)),'errors':_0x241797['flash']('errors'),'role':_0x56cbdc,'profile':_0xf219d4,'master_shop':_0x438a0e,'warehouse':_0x37f2d1,'transfer':_0x2853ce,'stock':_0x187dcb,'language':_0x80ef6d});}catch(_0x42345e){console[_0x1925ad(0x222)](_0x42345e);}}),router[a0_0x37eb0f(0x1f4)]('/preview/:id',auth,async(_0x2a19ee,_0x4fe144)=>{var _0x49893a=a0_0x37eb0f;try{const _0x29140f=_0x2a19ee['params']['id'],{from_warehouse:_0x512891,FromRoom_name:_0x2d3318,to_warehouse:_0x3a38f3,ToRoom_name:_0xfaf154}=_0x2a19ee[_0x49893a(0x219)],_0x432f41=await transfers[_0x49893a(0x177)]({'_id':_0x29140f}),_0x19e21f=_0x432f41[_0x49893a(0x176)][_0x49893a(0x197)](async _0x1a434f=>{var _0x1bb5e6=_0x49893a;if(_0x1a434f['to_quantity']>0x0){var _0x3cc5e9=await warehouse[_0x1bb5e6(0x1c8)]({'name':_0x432f41[_0x1bb5e6(0x23f)],'room':_0x1a434f['from_room_name'],'warehouse_category':_0x1bb5e6(0x1fb)});const _0x2c226d=_0x3cc5e9[_0x1bb5e6(0x213)][_0x1bb5e6(0x197)](_0x39ffbe=>{var _0x265fee=_0x1bb5e6;_0x39ffbe[_0x265fee(0x223)]==_0x1a434f['product_name']&&_0x39ffbe[_0x265fee(0x1d5)]==_0x1a434f[_0x265fee(0x19c)]&&_0x39ffbe['type']==_0x1a434f[_0x265fee(0x1ac)]&&_0x39ffbe[_0x265fee(0x203)]==_0x1a434f[_0x265fee(0x204)]&&_0x39ffbe[_0x265fee(0x21b)]==_0x1a434f[_0x265fee(0x1a0)]&&_0x39ffbe[_0x265fee(0x1d0)]==_0x1a434f[_0x265fee(0x22a)]&&_0x39ffbe[_0x265fee(0x1ea)]==_0x1a434f[_0x265fee(0x1f3)]&&_0x39ffbe['expiry_date']==_0x1a434f[_0x265fee(0x1cc)]&&_0x39ffbe[_0x265fee(0x18a)]==_0x1a434f['batch_code']&&_0x39ffbe[_0x265fee(0x1ed)]==_0x1a434f[_0x265fee(0x1ed)]&&_0x39ffbe['invoice']==_0x1a434f[_0x265fee(0x1e7)]&&_0x39ffbe[_0x265fee(0x1f8)]==_0x1a434f[_0x265fee(0x1ad)]&&(_0x39ffbe[_0x265fee(0x1c7)]=_0x39ffbe[_0x265fee(0x1c7)]-_0x1a434f[_0x265fee(0x1ba)]);});}return _0x3cc5e9;});Promise[_0x49893a(0x24f)](_0x19e21f)[_0x49893a(0x17f)](async _0x233a40=>{var _0x294b60=_0x49893a;try{for(const _0x432bca of _0x233a40){await _0x432bca['save']();}try{const _0x1906aa=_0x432f41['product'][_0x294b60(0x197)](async _0x4e0f90=>{var _0x5e87f4=_0x294b60;if(_0x4e0f90[_0x5e87f4(0x1ba)]>0x0){var _0x3186f8=await warehouse[_0x5e87f4(0x1c8)]({'name':_0x432f41[_0x5e87f4(0x210)],'room':_0x4e0f90['to_room_name'],'warehouse_category':'Raw\x20Materials'}),_0x5cf668=0x0;const _0x26601f=_0x3186f8[_0x5e87f4(0x213)][_0x5e87f4(0x197)](_0x151144=>{var _0xa785d7=_0x5e87f4;_0x151144[_0xa785d7(0x223)]==_0x4e0f90[_0xa785d7(0x223)]&&_0x151144[_0xa785d7(0x1d5)]==_0x4e0f90[_0xa785d7(0x1aa)]&&_0x151144[_0xa785d7(0x205)]==_0x4e0f90[_0xa785d7(0x183)]&&_0x151144[_0xa785d7(0x203)]==_0x4e0f90[_0xa785d7(0x1e3)]&&_0x151144[_0xa785d7(0x21b)]==_0x4e0f90[_0xa785d7(0x227)]&&_0x151144[_0xa785d7(0x1d0)]==_0x4e0f90['rack']&&_0x151144[_0xa785d7(0x1ea)]==_0x4e0f90[_0xa785d7(0x1ea)]&&_0x151144[_0xa785d7(0x1cc)]==_0x4e0f90[_0xa785d7(0x1cc)]&&_0x151144[_0xa785d7(0x18a)]==_0x4e0f90[_0xa785d7(0x18a)]&&_0x151144[_0xa785d7(0x1ed)]==_0x4e0f90[_0xa785d7(0x1ed)]&&_0x151144[_0xa785d7(0x1d7)]==_0x4e0f90['To_invoice']&&(_0x151144[_0xa785d7(0x1c7)]=_0x151144[_0xa785d7(0x1c7)]+_0x4e0f90['to_quantity'],_0x5cf668++);});_0x5cf668=='0'&&(_0x3186f8[_0x5e87f4(0x213)]=_0x3186f8[_0x5e87f4(0x213)][_0x5e87f4(0x1cf)]({'product_name':_0x4e0f90['product_name'],'product_stock':_0x4e0f90['to_quantity'],'bay':_0x4e0f90['to_bay'],'bin':_0x4e0f90['to_bin'],'type':_0x4e0f90['to_types'],'floorlevel':_0x4e0f90[_0x5e87f4(0x1aa)],'storage':_0x4e0f90['storage'],'rack':_0x4e0f90[_0x5e87f4(0x1d0)],'product_code':_0x4e0f90[_0x5e87f4(0x1b7)],'primary_code':_0x4e0f90['primary_code'],'secondary_code':_0x4e0f90[_0x5e87f4(0x23e)],'maxProducts':_0x4e0f90[_0x5e87f4(0x234)],'storage':_0x4e0f90['storage'],'rack':_0x4e0f90[_0x5e87f4(0x1d0)],'expiry_date':_0x4e0f90[_0x5e87f4(0x1cc)],'maxPerUnit':_0x4e0f90[_0x5e87f4(0x23c)],'batch_code':_0x4e0f90[_0x5e87f4(0x18a)],'production_date':_0x4e0f90[_0x5e87f4(0x1ed)]}));}return _0x3186f8;});Promise[_0x294b60(0x24f)](_0x1906aa)['then'](async _0x242d2c=>{var _0x227a72=_0x294b60;try{for(const _0x780c85 of _0x242d2c){await warehouse[_0x227a72(0x23b)]({'_id':_0x780c85[_0x227a72(0x1f8)]},{'$addToSet':{'product_details':{'$each':_0x780c85[_0x227a72(0x213)]}}});}_0x432f41[_0x227a72(0x167)]=_0x227a72(0x181);const _0x35a288=await _0x432f41['save'](),_0x558968=await master_shop[_0x227a72(0x16c)](),_0x129935=await email_settings['findOne'](),_0x35cc37=await supervisor_settings[_0x227a72(0x16c)]();var _0x74eff4=_0x432f41[_0x227a72(0x176)],_0x64a58d='',_0x50a049;for(_0x50a049 in _0x74eff4){_0x64a58d+=_0x227a72(0x224)+_0x227a72(0x191)+_0x74eff4[_0x50a049][_0x227a72(0x223)]+_0x227a72(0x1bc)+_0x227a72(0x191)+_0x74eff4[_0x50a049][_0x227a72(0x1b7)]+_0x227a72(0x1bc)+_0x227a72(0x191)+_0x74eff4[_0x50a049][_0x227a72(0x1ba)]+_0x227a72(0x1bc)+_0x227a72(0x191)+_0x74eff4[_0x50a049]['unit']+'</td>'+_0x227a72(0x191)+_0x74eff4[_0x50a049][_0x227a72(0x235)]+_0x227a72(0x1bc)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x432f41[_0x227a72(0x210)]+'</td>'+_0x227a72(0x191)+_0x74eff4[_0x50a049][_0x227a72(0x17d)]+_0x227a72(0x1bc)+_0x227a72(0x191)+_0x74eff4[_0x50a049][_0x227a72(0x1ea)]+_0x74eff4[_0x50a049][_0x227a72(0x1d0)]+_0x74eff4[_0x50a049][_0x227a72(0x227)]+_0x74eff4[_0x50a049][_0x227a72(0x1e3)]+_0x74eff4[_0x50a049]['to_types'][0x0]+_0x74eff4[_0x50a049][_0x227a72(0x1aa)]+'</td>',_0x227a72(0x1fe);}let _0x148510=nodemailer['createTransport']({'host':_0x129935[_0x227a72(0x1dc)],'port':Number(_0x129935[_0x227a72(0x18b)]),'secure':![],'auth':{'user':_0x129935[_0x227a72(0x225)],'pass':_0x129935[_0x227a72(0x1a7)]}}),_0x3308d3={'from':_0x129935[_0x227a72(0x225)],'to':_0x35cc37[0x0]['RMSEmail'],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x227a72(0x1ce),'path':__dirname+_0x227a72(0x1f0)+_0x227a72(0x1a2)+_0x558968[0x0][_0x227a72(0x1b6)],'cid':'logo'}],'html':_0x227a72(0x228)+_0x227a72(0x200)+_0x227a72(0x218)+_0x227a72(0x17b)+_0x227a72(0x18d)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x227a72(0x1a6)+'<div>'+_0x227a72(0x244)+_0x558968[0x0]['site_title']+_0x227a72(0x239)+_0x227a72(0x1a6)+_0x227a72(0x1a6)+_0x227a72(0x24a)+_0x227a72(0x17b)+_0x227a72(0x1ab)+_0x227a72(0x1f5)+_0x432f41[_0x227a72(0x1d7)]+'\x20'+_0x227a72(0x1ca)+_0x227a72(0x19a)+_0x432f41['date']+'\x20'+_0x227a72(0x1d3)+_0x227a72(0x1fc)+_0x227a72(0x1a6)+_0x227a72(0x20f)+_0x227a72(0x20c)+_0x227a72(0x224)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x227a72(0x226)+_0x227a72(0x189)+_0x227a72(0x1ec)+_0x227a72(0x233)+_0x227a72(0x1c6)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x227a72(0x21f)+_0x227a72(0x1fe)+_0x227a72(0x162)+_0x227a72(0x237)+'\x20'+_0x64a58d+'\x20'+'</tbody>'+_0x227a72(0x19f)+_0x227a72(0x17b)+'<strong>\x20Regards\x20</strong>'+_0x227a72(0x170)+_0x558968[0x0][_0x227a72(0x1fa)]+_0x227a72(0x1fc)+_0x227a72(0x1a6)+'</div>'+'</body></html>'};_0x148510[_0x227a72(0x184)](_0x3308d3,function(_0x2cc44b,_0x58e1a1){var _0x5d5991=_0x227a72;_0x2cc44b?(console[_0x5d5991(0x222)](_0x2cc44b),console[_0x5d5991(0x222)]('Error\x20Occurs')):console['log'](_0x5d5991(0x182));}),_0x2a19ee[_0x227a72(0x24e)](_0x227a72(0x168),'Transfer\x20Finalize\x20Successfully'),_0x4fe144[_0x227a72(0x1f6)](_0x227a72(0x1a5)+_0x35a288[_0x227a72(0x1f8)]);}catch(_0x24b0f0){console['error'](_0x24b0f0),_0x4fe144[_0x227a72(0x17a)](0x1f4)[_0x227a72(0x24b)]({'Perror':_0x227a72(0x1f1),'message':_0x24b0f0[_0x227a72(0x1db)]});}})[_0x294b60(0x236)](_0x5f4432=>{var _0x26e449=_0x294b60;console[_0x26e449(0x22f)](_0x5f4432),_0x4fe144[_0x26e449(0x17a)](0x1f4)[_0x26e449(0x24b)]({'Perror':_0x26e449(0x22b)});});}catch(_0xe9f25f){_0x4fe144[_0x294b60(0x24b)](_0xe9f25f);}}catch(_0x40fa3b){console[_0x294b60(0x22f)](_0x40fa3b),_0x4fe144[_0x294b60(0x17a)](0x1f4)['json']({'Merror':_0x294b60(0x1f1),'Message':_0x40fa3b[_0x294b60(0x1db)]});}})[_0x49893a(0x236)](_0x2dac69=>{var _0x322d52=_0x49893a;console[_0x322d52(0x22f)](_0x2dac69),_0x4fe144['status'](0x1f4)[_0x322d52(0x24b)]({'Merror':_0x322d52(0x22b)});});}catch(_0xf16e80){console[_0x49893a(0x222)](_0xf16e80);}});function BayBinSelected(_0x1d23d2,_0x215b91){var _0xd590e2=a0_0x37eb0f,_0x18c952=[],_0x4684c6=[],_0x4143c3=[],_0x326537=[],_0x487c24=[],_0x1a180b=[];let _0xe960ae=[];if(_0x1d23d2==_0xd590e2(0x1b3))switch(_0x215b91){case'Rack\x20A':_0x18c952=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4684c6=[0x1,0x2],_0x326537=[0x1,0x2,0x3,0x4,0x5],_0x4143c3=[_0xd590e2(0x240),_0xd590e2(0x1d6)],_0x487c24=['D'],_0x1a180b=['A'];break;case _0xd590e2(0x19e):_0x18c952=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4684c6=[0x1,0x2],_0x326537=[0x1,0x2,0x3,0x4,0x5],_0x4143c3=[_0xd590e2(0x240),_0xd590e2(0x1d6)],_0x487c24=['D'],_0x1a180b=['B'];break;case'Shelves':_0x18c952=[0x0],_0x4684c6=[0x0],_0x326537=[0x1,0x2,0x3,0x4,0x5],_0x4143c3=['Floor'],_0x487c24=['D'],_0x1a180b=['S'];break;case'Receiving\x20Area':_0x18c952=[0x0],_0x4684c6=[0x0],_0x326537=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x4143c3=[_0xd590e2(0x1d6)],_0x487c24=['D'],_0x1a180b=['R'];break;}else{if(_0x1d23d2=='COLD\x20STORAGE')switch(_0x215b91){case _0xd590e2(0x180):_0x18c952=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4684c6=['B','F'],_0x326537=[0x1,0x2,0x3,0x4,0x5],_0x4143c3=[_0xd590e2(0x240),'Floor'],_0x487c24=['C'],_0x1a180b=['A'];break;case'Rack\x20B':_0x18c952=[0x5,0x4,0x3,0x2,0x1],_0x4684c6=['F','B','S'],_0x326537=[0x1,0x2,0x3,0x4,0x5],_0x4143c3=['Level','Floor'],_0x487c24=['C'],_0x1a180b=['B'];break;case _0xd590e2(0x1a4):_0x18c952=[0x1,0x2,0x3,0x4,0x5],_0x4684c6=['B','F','S'],_0x326537=[0x5,0x4,0x3,0x2,0x1],_0x4143c3=['Level',_0xd590e2(0x1d6)],_0x487c24=['C'],_0x1a180b=['C'];break;case _0xd590e2(0x252):_0x18c952=[0x5,0x4,0x3,0x2,0x1],_0x4684c6=['F','B','S'],_0x326537=[0x1,0x2,0x3,0x4,0x5],_0x4143c3=[_0xd590e2(0x240),'Floor'],_0x487c24=['C'],_0x1a180b=['D'];break;case _0xd590e2(0x198):_0x18c952=[0x4,0x3,0x2,0x1],_0x4684c6=[0x1,0x2],_0x326537=[0x1,0x2,0x3,0x4,0x5],_0x4143c3=[_0xd590e2(0x240),_0xd590e2(0x1d6)],_0x487c24=['C'],_0x1a180b=['E'];break;case _0xd590e2(0x1eb):_0x18c952=[0x1,0x2,0x3],_0x4684c6=[0x1,0x2],_0x326537=[0x1,0x2,0x3,0x4,0x5],_0x4143c3=[_0xd590e2(0x240)],_0x487c24=['C'],_0x1a180b=['F'];break;}}return{'levels':_0x18c952,'Isle':_0x4684c6,'rack':_0x326537,'type':_0x4143c3,'storage':_0x487c24,'rak':_0x1a180b};}function a0_0x3fb0(_0x2ef267,_0x21e6e3){var _0x598d7e=a0_0x598d();return a0_0x3fb0=function(_0x3fb06a,_0x4b84a3){_0x3fb06a=_0x3fb06a-0x15c;var _0x4b187e=_0x598d7e[_0x3fb06a];return _0x4b187e;},a0_0x3fb0(_0x2ef267,_0x21e6e3);}router[a0_0x37eb0f(0x249)](a0_0x37eb0f(0x16e),auth,async(_0x1874e7,_0x824964)=>{var _0x175c12=a0_0x37eb0f;try{const {username:_0x4b17c4,email:_0x5c5995,role:_0x5b4a18}=_0x1874e7['user'],_0x1a694e=_0x1874e7[_0x175c12(0x195)],_0x4eb74f=await profile['findOne']({'email':_0x1a694e[_0x175c12(0x225)]}),_0x6228b=await master_shop[_0x175c12(0x16c)](),_0x32c163=await transfers['findById'](_0x1874e7[_0x175c12(0x20b)]['id']);let _0x40e99d;if(_0x1a694e[_0x175c12(0x193)]==_0x175c12(0x192)){const _0x45cebb=await staff[_0x175c12(0x1c8)]({'email':_0x1a694e[_0x175c12(0x225)]});_0x40e99d=await warehouse[_0x175c12(0x20d)]([{'$match':{'status':_0x175c12(0x248),'name':_0x45cebb[_0x175c12(0x160)],'warehouse_category':_0x175c12(0x1fb)}},{'$group':{'_id':'$name','name':{'$first':_0x175c12(0x238)}}}]);}else _0x40e99d=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x175c12(0x1fb)}},{'$group':{'_id':'$name','name':{'$first':_0x175c12(0x238)}}}]);const _0x583845=await warehouse[_0x175c12(0x20d)]([{'$match':{'name':_0x32c163[_0x175c12(0x23f)],'warehouse_category':_0x175c12(0x1fb)}},{'$unwind':_0x175c12(0x15f)},{'$group':{'_id':_0x175c12(0x169),'name':{'$first':_0x175c12(0x1d8)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x175c12(0x1d9)},'bin':{'$first':_0x175c12(0x221)},'type':{'$first':_0x175c12(0x173)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x175c12(0x1b9)},'storage':{'$first':_0x175c12(0x16f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x175c12(0x1af)},'production_date':{'$first':_0x175c12(0x1b5)},'room':{'$first':_0x175c12(0x161)}}}]),_0x5d5f0c=await product['find']({}),_0x432d91=BayBinSelected(_0x32c163['to_warehouse'],_0x32c163['to_room']);if(_0x6228b[0x0][_0x175c12(0x194)]==_0x175c12(0x22e)){var _0x16da2b=users[_0x175c12(0x188)];console[_0x175c12(0x222)](_0x16da2b);}else{if(_0x6228b[0x0][_0x175c12(0x194)]==_0x175c12(0x186))var _0x16da2b=users[_0x175c12(0x186)];else{if(_0x6228b[0x0][_0x175c12(0x194)]==_0x175c12(0x22c))var _0x16da2b=users[_0x175c12(0x22c)];else{if(_0x6228b[0x0][_0x175c12(0x194)]==_0x175c12(0x1bb))var _0x16da2b=users[_0x175c12(0x1bb)];else{if(_0x6228b[0x0]['language']==_0x175c12(0x22d))var _0x16da2b=users[_0x175c12(0x22d)];else{if(_0x6228b[0x0]['language']==_0x175c12(0x243))var _0x16da2b=users['Portuguese'];else{if(_0x6228b[0x0][_0x175c12(0x194)]=='Chinese')var _0x16da2b=users[_0x175c12(0x209)];else{if(_0x6228b[0x0]['language']==_0x175c12(0x163))var _0x16da2b=users[_0x175c12(0x247)];}}}}}}}_0x824964[_0x175c12(0x214)](_0x175c12(0x1c1),{'success':_0x1874e7[_0x175c12(0x24e)]('success'),'errors':_0x1874e7[_0x175c12(0x24e)](_0x175c12(0x202)),'role':_0x1a694e,'profile':_0x4eb74f,'master_shop':_0x6228b,'warehouse':_0x40e99d,'transfer':_0x32c163,'stock':_0x583845,'unit':_0x5d5f0c,'language':_0x16da2b});}catch(_0x467d42){console[_0x175c12(0x222)](_0x467d42);}}),router['post'](a0_0x37eb0f(0x16e),auth,async(_0x504f8f,_0x20c152)=>{var _0x55da1d=a0_0x37eb0f;try{const _0x506487=_0x504f8f[_0x55da1d(0x20b)]['id'],_0x2c5109=await transfers[_0x55da1d(0x177)](_0x506487);_0x20c152[_0x55da1d(0x24b)](_0x504f8f[_0x55da1d(0x219)]);return;const {date:_0x45f376,from_warehouse:_0x2377a4,FromRoom_name:_0x3b4326,to_warehouse:_0x33c07e,ToRoom_name:_0x3d8c5c,prod_name:_0x180a52,from_prod_qty:_0x3622e8,from_prod_level:_0x3846b9,from_prod_isle:_0x2df078,from_prod_pallet:_0x3c0a71,to_prod_qty:_0x2915a4,to_prod_level:_0x24f79d,to_prod_isle:_0x4aa3c6,to_prod_pallet:_0x50e57c,primary_code:_0x350924,secondary_code:_0x4f6c10,product_code3:_0x51594c,note:_0x3acd31,invoice:_0x337e75,expiry_date:_0x50d54c}=_0x504f8f[_0x55da1d(0x219)];if(typeof _0x180a52==_0x55da1d(0x1da))var _0x3c8645=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x215)]],_0x5f1c95=[_0x504f8f['body'][_0x55da1d(0x196)]],_0x5a5d6b=[_0x504f8f['body']['from_prod_level']],_0x5dd0a2=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x15e)]],_0x350b07=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x16b)]],_0x1b2121=[_0x504f8f[_0x55da1d(0x219)]['from_types']],_0x844b78=[_0x504f8f['body'][_0x55da1d(0x1ee)]],_0x5d4338=[_0x504f8f['body'][_0x55da1d(0x185)]],_0x17831d=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x171)]],_0x3f70e3=[_0x504f8f['body'][_0x55da1d(0x230)]],_0x30f5d8=[_0x504f8f[_0x55da1d(0x219)]['to_types']],_0x8132a2=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1ea)]],_0x56fa7d=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1ae)]],_0x454f73=[_0x504f8f[_0x55da1d(0x219)]['primary_code']],_0x3255df=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x23e)]],_0x2eaa76=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x24d)]],_0x319b25=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1cb)]],_0x28fd48=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1de)]],_0x55610f=[_0x504f8f[_0x55da1d(0x219)]['secondary_unit']],_0xf00d1=[_0x504f8f['body']['batch_code']],_0x4f1498=[_0x504f8f['body'][_0x55da1d(0x1cc)]],_0x52ddd4=[_0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1f3)]],_0x4cabc0=[_0x504f8f[_0x55da1d(0x219)]['from_rak']];else var _0x3c8645=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x215)]],_0x8132a2=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1ea)]],_0x56fa7d=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1ae)]],_0x1b2121=[..._0x504f8f['body']['from_types']],_0x30f5d8=[..._0x504f8f[_0x55da1d(0x219)]['to_types']],_0x5f1c95=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x196)]],_0x5a5d6b=[..._0x504f8f['body']['from_prod_level']],_0x5dd0a2=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x15e)]],_0x350b07=[..._0x504f8f['body']['from_prod_pallet']],_0x844b78=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1ee)]],_0x5d4338=[..._0x504f8f['body'][_0x55da1d(0x185)]],_0x17831d=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x171)]],_0x3f70e3=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x230)]],_0x454f73=[..._0x504f8f[_0x55da1d(0x219)]['primary_code']],_0x3255df=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x23e)]],_0x2eaa76=[..._0x504f8f['body'][_0x55da1d(0x24d)]],_0x319b25=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1cb)]],_0x28fd48=[..._0x504f8f['body'][_0x55da1d(0x1de)]],_0x55610f=[..._0x504f8f[_0x55da1d(0x219)]['secondary_unit']],_0xf00d1=[..._0x504f8f['body']['batch_code']],_0x4f1498=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1cc)]],_0x52ddd4=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x1f3)]],_0x4cabc0=[..._0x504f8f[_0x55da1d(0x219)][_0x55da1d(0x21c)]];const _0x596be1=_0x3c8645[_0x55da1d(0x197)](_0x245781=>{return _0x245781={'product_name':_0x245781};});_0x5f1c95['forEach']((_0xe52292,_0x4511d9)=>{var _0x174f84=_0x55da1d;_0x596be1[_0x4511d9][_0x174f84(0x1b8)]=_0xe52292;}),_0x5a5d6b['forEach']((_0x555858,_0x28a374)=>{var _0x43aae1=_0x55da1d;_0x596be1[_0x28a374][_0x43aae1(0x1a0)]=_0x555858;}),_0x5dd0a2[_0x55da1d(0x1e0)]((_0x5b0b9e,_0x282506)=>{var _0x5168cc=_0x55da1d;_0x596be1[_0x282506][_0x5168cc(0x204)]=_0x5b0b9e;}),_0x350b07['forEach']((_0x2935ac,_0x1abf46)=>{_0x596be1[_0x1abf46]['from_floorlevel']=_0x2935ac;}),_0x844b78[_0x55da1d(0x1e0)]((_0x14fb10,_0x14a9b0)=>{_0x596be1[_0x14a9b0]['to_quantity']=_0x14fb10;}),_0x5d4338[_0x55da1d(0x1e0)]((_0x3f3795,_0x20d96f)=>{var _0x1ce789=_0x55da1d;_0x596be1[_0x20d96f][_0x1ce789(0x227)]=_0x3f3795;}),_0x17831d['forEach']((_0x124087,_0x45788b)=>{var _0x3cf9a=_0x55da1d;_0x596be1[_0x45788b][_0x3cf9a(0x1e3)]=_0x124087;}),_0x3f70e3['forEach']((_0x2f30fb,_0x297507)=>{var _0xb9aa4c=_0x55da1d;_0x596be1[_0x297507][_0xb9aa4c(0x1aa)]=_0x2f30fb;}),_0x454f73[_0x55da1d(0x1e0)]((_0x1be905,_0x387df5)=>{_0x596be1[_0x387df5]['primary_code']=_0x1be905;}),_0x3255df['forEach']((_0x2d0c39,_0x7a1f17)=>{var _0x5da456=_0x55da1d;_0x596be1[_0x7a1f17][_0x5da456(0x23e)]=_0x2d0c39;}),_0x2eaa76['forEach']((_0x529d61,_0x1ecc5e)=>{var _0x7f7a0c=_0x55da1d;_0x596be1[_0x1ecc5e][_0x7f7a0c(0x1b7)]=_0x529d61;}),_0x319b25[_0x55da1d(0x1e0)]((_0x43e29f,_0x281914)=>{var _0x592d69=_0x55da1d;_0x596be1[_0x281914][_0x592d69(0x234)]=_0x43e29f;}),_0x28fd48['forEach']((_0x51ef7e,_0x3f03cb)=>{_0x596be1[_0x3f03cb]['unit']=_0x51ef7e;}),_0x55610f[_0x55da1d(0x1e0)]((_0x172155,_0x3c7e7b)=>{_0x596be1[_0x3c7e7b]['secondary_unit']=_0x172155;}),_0xf00d1[_0x55da1d(0x1e0)]((_0x6c665c,_0x1703b6)=>{var _0x5cbfa7=_0x55da1d;_0x596be1[_0x1703b6][_0x5cbfa7(0x18a)]=_0x6c665c;}),_0x4f1498[_0x55da1d(0x1e0)]((_0x37cf9d,_0x568899)=>{_0x596be1[_0x568899]['expiry_date']=_0x37cf9d;}),_0x8132a2[_0x55da1d(0x1e0)]((_0x3155d9,_0x579d97)=>{_0x596be1[_0x579d97]['storage']=_0x3155d9;}),_0x56fa7d['forEach']((_0x5dcab5,_0x37628b)=>{_0x596be1[_0x37628b]['rack']=_0x5dcab5;}),_0x1b2121['forEach']((_0x5924cc,_0x94443f)=>{var _0x5792b4=_0x55da1d;_0x596be1[_0x94443f][_0x5792b4(0x1ac)]=_0x5924cc;}),_0x30f5d8[_0x55da1d(0x1e0)]((_0x279722,_0x33e197)=>{_0x596be1[_0x33e197]['to_types']=_0x279722;}),_0x52ddd4[_0x55da1d(0x1e0)]((_0x134b49,_0x1af634)=>{var _0x130ff6=_0x55da1d;_0x596be1[_0x1af634][_0x130ff6(0x1f3)]=_0x134b49;}),_0x4cabc0[_0x55da1d(0x1e0)]((_0xaad136,_0x3b614c)=>{_0x596be1[_0x3b614c]['from_rack']=_0xaad136;});const _0x47b3c5=_0x596be1[_0x55da1d(0x1b0)](_0x555fc8=>_0x555fc8[_0x55da1d(0x1ba)]!=='0'&&_0x555fc8['to_quantity']!==''||_0x555fc8[_0x55da1d(0x1aa)]!=='0'&&_0x555fc8[_0x55da1d(0x1aa)]!=='');var _0x1b392e=0x0;_0x47b3c5['forEach'](_0x53966c=>{var _0x13b1d9=_0x55da1d;parseInt(_0x53966c[_0x13b1d9(0x1b8)])<parseInt(_0x53966c['to_quantity'])&&_0x1b392e++;});if(_0x1b392e!=0x0)return _0x504f8f[_0x55da1d(0x24e)](_0x55da1d(0x202),_0x55da1d(0x1bf)),_0x20c152['redirect'](_0x55da1d(0x206));const _0x400d31=await warehouse[_0x55da1d(0x1c8)]({'name':_0x2c5109[_0x55da1d(0x23f)],'room':_0x2c5109[_0x55da1d(0x208)]});_0x2c5109[_0x55da1d(0x176)][_0x55da1d(0x1e0)](_0x57cb45=>{var _0x3ae3b2=_0x55da1d;if(_0x57cb45[_0x3ae3b2(0x1ba)]>0x0){const _0x3128f7=_0x400d31[_0x3ae3b2(0x213)]['map'](_0x79bdde=>{var _0x396f23=_0x3ae3b2;_0x79bdde[_0x396f23(0x223)]==_0x57cb45[_0x396f23(0x223)]&&_0x79bdde[_0x396f23(0x1d5)]==_0x57cb45[_0x396f23(0x19c)]&&_0x79bdde[_0x396f23(0x205)]==_0x57cb45[_0x396f23(0x1ac)]&&_0x79bdde[_0x396f23(0x203)]==_0x57cb45[_0x396f23(0x204)]&&_0x79bdde[_0x396f23(0x21b)]==_0x57cb45[_0x396f23(0x1a0)]&&_0x79bdde[_0x396f23(0x1d0)]==_0x57cb45[_0x396f23(0x22a)]&&_0x79bdde[_0x396f23(0x1ea)]==_0x57cb45[_0x396f23(0x1f3)]&&(_0x79bdde[_0x396f23(0x1c7)]=parseInt(_0x79bdde[_0x396f23(0x1c7)])+parseInt(_0x57cb45[_0x396f23(0x1ba)]));});}}),await _0x400d31['save']();const _0x16b0c8=await warehouse['findOne']({'name':_0x2c5109[_0x55da1d(0x210)],'room':_0x2c5109['to_room']});_0x2c5109['product'][_0x55da1d(0x1e0)](_0x17c235=>{var _0x569396=_0x55da1d;if(_0x17c235[_0x569396(0x1ba)]>0x0){const _0x2a9db6=_0x16b0c8['product_details'][_0x569396(0x197)](_0x16ed63=>{var _0x449845=_0x569396;_0x16ed63['product_name']==_0x17c235[_0x449845(0x223)]&&_0x16ed63[_0x449845(0x1d5)]==_0x17c235[_0x449845(0x1aa)]&&_0x16ed63[_0x449845(0x205)]==_0x17c235[_0x449845(0x183)]&&_0x16ed63[_0x449845(0x203)]==_0x17c235[_0x449845(0x1e3)]&&_0x16ed63[_0x449845(0x21b)]==_0x17c235['to_bay']&&_0x16ed63['rack']==_0x17c235[_0x449845(0x1d0)]&&_0x16ed63[_0x449845(0x1ea)]==_0x17c235[_0x449845(0x1ea)]&&(_0x16ed63['product_stock']=parseInt(_0x16ed63[_0x449845(0x1c7)])-parseInt(_0x17c235[_0x449845(0x1ba)]));});}}),await _0x16b0c8[_0x55da1d(0x1c4)](),_0x2c5109['date']=_0x45f376,_0x2c5109[_0x55da1d(0x23f)]=_0x2377a4,_0x2c5109[_0x55da1d(0x210)]=_0x33c07e,_0x2c5109[_0x55da1d(0x176)]=_0x47b3c5,_0x2c5109[_0x55da1d(0x1fd)]=_0x3acd31,_0x2c5109['invoice']=_0x337e75;const _0x2783f2=await _0x2c5109[_0x55da1d(0x1c4)]();console[_0x55da1d(0x222)](_0x2783f2);const _0xfa0b95=await warehouse[_0x55da1d(0x1c8)]({'name':_0x2377a4,'room':_0x3b4326});_0x2783f2[_0x55da1d(0x176)][_0x55da1d(0x1e0)](_0x21d18b=>{var _0x5e9519=_0x55da1d;if(_0x21d18b[_0x5e9519(0x1ba)]>0x0){const _0x4cc609=_0xfa0b95[_0x5e9519(0x213)][_0x5e9519(0x197)](_0xa75ae2=>{var _0x172a56=_0x5e9519;_0xa75ae2[_0x172a56(0x223)]==_0x21d18b['product_name']&&_0xa75ae2[_0x172a56(0x1d5)]==_0x21d18b['from_floorlevel']&&_0xa75ae2[_0x172a56(0x205)]==_0x21d18b['from_types']&&_0xa75ae2[_0x172a56(0x203)]==_0x21d18b[_0x172a56(0x204)]&&_0xa75ae2[_0x172a56(0x21b)]==_0x21d18b['from_bay']&&_0xa75ae2['rack']==_0x21d18b['from_rack']&&_0xa75ae2[_0x172a56(0x1ea)]==_0x21d18b['from_storage']&&(_0xa75ae2[_0x172a56(0x1c7)]=parseInt(_0xa75ae2['product_stock'])-parseInt(_0x21d18b[_0x172a56(0x1ba)]));});}}),await _0xfa0b95['save']();const _0x518e68=await warehouse[_0x55da1d(0x1c8)]({'name':_0x33c07e,'room':_0x3d8c5c});_0x2783f2[_0x55da1d(0x176)]['forEach'](_0x4fc4ca=>{var _0x2681e2=_0x55da1d;if(_0x4fc4ca[_0x2681e2(0x1ba)]>0x0){var _0x33d37a=0x0;const _0x4b4425=_0x518e68[_0x2681e2(0x213)][_0x2681e2(0x197)](_0x5900cd=>{var _0x4fcf5d=_0x2681e2;_0x5900cd['product_name']==_0x4fc4ca[_0x4fcf5d(0x223)]&&_0x5900cd['floorlevel']==_0x4fc4ca[_0x4fcf5d(0x1aa)]&&_0x5900cd[_0x4fcf5d(0x205)]==_0x4fc4ca[_0x4fcf5d(0x183)]&&_0x5900cd[_0x4fcf5d(0x203)]==_0x4fc4ca[_0x4fcf5d(0x1e3)]&&_0x5900cd[_0x4fcf5d(0x21b)]==_0x4fc4ca[_0x4fcf5d(0x227)]&&_0x5900cd['rack']==_0x4fc4ca['rack']&&_0x5900cd[_0x4fcf5d(0x1ea)]==_0x4fc4ca[_0x4fcf5d(0x1ea)]&&(_0x5900cd[_0x4fcf5d(0x1c7)]=parseInt(_0x5900cd['product_stock'])+parseInt(_0x4fc4ca['to_quantity']),_0x33d37a++);});_0x33d37a=='0'&&(_0x518e68['product_details']=_0x518e68[_0x2681e2(0x213)][_0x2681e2(0x1cf)]({'product_name':_0x4fc4ca[_0x2681e2(0x223)],'product_stock':_0x4fc4ca[_0x2681e2(0x1ba)],'bay':_0x4fc4ca['to_bay'],'bin':_0x4fc4ca['to_bin'],'type':_0x4fc4ca['to_types'],'floorlevel':_0x4fc4ca[_0x2681e2(0x1aa)],'storage':_0x4fc4ca['storage'],'rack':_0x4fc4ca['rack'],'product_code':_0x4fc4ca[_0x2681e2(0x1b7)],'primary_code':_0x4fc4ca['primary_code'],'secondary_code':_0x4fc4ca['secondary_code'],'maxProducts':_0x4fc4ca[_0x2681e2(0x234)],'storage':_0x4fc4ca[_0x2681e2(0x1ea)],'rack':_0x4fc4ca['rack']}));}}),await _0x518e68['save'](),_0x504f8f['flash'](_0x55da1d(0x168),_0x55da1d(0x16a)),_0x20c152[_0x55da1d(0x1f6)]('/transfer/view');}catch(_0x1c6841){console[_0x55da1d(0x222)](_0x1c6841);}}),router['post'](a0_0x37eb0f(0x1e9),async(_0x4b391a,_0x10970d)=>{var _0x1a27e4=a0_0x37eb0f;const {FromWareHouse:_0x1b17bb,FromRoom:_0x442068,ToWarehouse:_0x3e4c87,ToRoom:_0x38214c,primary_code:_0x4a9d59,Roomslist:_0x3adc1f}=_0x4b391a['body'],_0x4d437f=_0x3adc1f['split'](','),_0x93401a=[];async function _0x38960a(_0x414d26){var _0x1c1f34=a0_0x3fb0;const _0x3df268=await warehouse[_0x1c1f34(0x20d)]([{'$match':{'name':_0x1b17bb,'room':_0x414d26}},{'$unwind':_0x1c1f34(0x15f)},{'$match':{'product_details.primary_code':_0x4a9d59}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1c1f34(0x1d8)},'instock':{'$first':_0x1c1f34(0x212)},'primary_code':{'$first':_0x1c1f34(0x245)},'secondary_code':{'$first':_0x1c1f34(0x1b2)},'product_code':{'$first':_0x1c1f34(0x1b9)},'level':{'$first':_0x1c1f34(0x1d9)},'isle':{'$first':_0x1c1f34(0x221)},'type':{'$first':_0x1c1f34(0x173)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1c1f34(0x1f2)},'secondary_unit':{'$first':_0x1c1f34(0x174)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1c1f34(0x1af)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1c1f34(0x1df)},'maxPerUnit':{'$first':_0x1c1f34(0x166)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x1c1f34(0x161)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x1c1f34(0x18f)}}}]),_0x5905e3=await warehouse[_0x1c1f34(0x20d)]([{'$match':{'name':_0x1b17bb,'room':_0x414d26}},{'$unwind':_0x1c1f34(0x15f)},{'$match':{'product_details.secondary_code':_0x4a9d59}},{'$group':{'_id':_0x1c1f34(0x169),'name':{'$first':_0x1c1f34(0x1d8)},'instock':{'$first':_0x1c1f34(0x212)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1c1f34(0x1b9)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x1c1f34(0x221)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1c1f34(0x1c5)},'unit':{'$first':_0x1c1f34(0x1f2)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1c1f34(0x1af)},'production_date':{'$first':_0x1c1f34(0x1b5)},'batch_code':{'$first':_0x1c1f34(0x1df)},'maxPerUnit':{'$first':_0x1c1f34(0x166)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x1c1f34(0x161)},'maxProducts':{'$first':_0x1c1f34(0x229)},'invoice_product':{'$first':_0x1c1f34(0x18f)}}}]);if(_0x3df268[_0x1c1f34(0x187)]>0x0)_0x93401a[_0x1c1f34(0x216)](_0x3df268);else _0x5905e3['length']>0x0&&_0x93401a['push'](_0x5905e3);}const _0x4f666c=_0x4d437f[_0x1a27e4(0x197)](_0x4f7d53=>_0x38960a(_0x4f7d53));await Promise['all'](_0x4f666c),_0x10970d[_0x1a27e4(0x24b)](_0x93401a);}),router[a0_0x37eb0f(0x1f4)](a0_0x37eb0f(0x1a9),async(_0x4c9371,_0x7e8bfe)=>{var _0x247683=a0_0x37eb0f;try{const {FromWareHouse:_0x55d6a0,FromRoom:_0x907b2,ToWarehouse:_0x392a02,ToRoom:_0x408c85,secondary_code:_0xd20abb}=_0x4c9371[_0x247683(0x219)],_0x34a215=await warehouse[_0x247683(0x20d)]([{'$match':{'name':_0x55d6a0}},{'$unwind':_0x247683(0x15f)},{'$match':{'product_details.secondary_code':_0xd20abb}},{'$group':{'_id':_0x247683(0x169),'name':{'$first':_0x247683(0x1d8)},'primary_code':{'$first':_0x247683(0x245)},'secondary_code':{'$first':_0x247683(0x1b2)},'product_code':{'$first':_0x247683(0x1b9)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x247683(0x238)},'level':{'$first':_0x247683(0x1a8)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x247683(0x1b4)},'maxProducts':{'$first':_0x247683(0x229)},'unit':{'$first':'$product_details.unit'}}}]);_0x7e8bfe[_0x247683(0x17a)](0xc8)[_0x247683(0x24b)](_0x34a215);}catch(_0x10b4da){_0x7e8bfe[_0x247683(0x17a)](0x194)[_0x247683(0x24b)]({'message':_0x10b4da['message']});}}),router[a0_0x37eb0f(0x1f4)](a0_0x37eb0f(0x232),async(_0x5854e0,_0x2b0089)=>{var _0x27a8d2=a0_0x37eb0f;try{const {FromWareHouse:_0x3cf896,FromRoom:_0x39448a,ToWarehouse:_0x376ddc,ToRoom:_0xa96c1f,product_code:_0x8997c}=_0x5854e0[_0x27a8d2(0x219)],_0x4dcd65=await warehouse[_0x27a8d2(0x20d)]([{'$match':{'name':_0x3cf896}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x8997c}},{'$group':{'_id':_0x27a8d2(0x169),'name':{'$first':_0x27a8d2(0x1d8)},'primary_code':{'$first':_0x27a8d2(0x245)},'secondary_code':{'$first':_0x27a8d2(0x1b2)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x27a8d2(0x212)},'warehouse':{'$first':_0x27a8d2(0x238)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x27a8d2(0x1b4)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x27a8d2(0x1f2)}}}]);_0x2b0089['status'](0xc8)[_0x27a8d2(0x24b)](_0x4dcd65);}catch(_0x1a5a9d){_0x2b0089[_0x27a8d2(0x17a)](0x194)[_0x27a8d2(0x24b)]({'message':_0x1a5a9d[_0x27a8d2(0x1db)]});}}),router[a0_0x37eb0f(0x1f4)]('/CheckingWarehouse',async(_0x530a71,_0x545c78)=>{var _0x13be53=a0_0x37eb0f;const {level:_0x57496d,isle:_0x55deac,pallet:_0x4cec32,warehouses:_0x214bbf,room:_0x1643d5}=_0x530a71[_0x13be53(0x219)];try{const _0x41b50c=await warehouse[_0x13be53(0x20d)]([{'$match':{'name':_0x214bbf,'room':_0x1643d5}},{'$unwind':_0x13be53(0x15f)},{'$match':{'product_details.level':parseInt(_0x57496d),'product_details.isle':_0x55deac,'product_details.pallet':parseInt(_0x4cec32)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x13be53(0x1d8)},'product_stock':{'$first':_0x13be53(0x212)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x13be53(0x20a)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x13be53(0x229)}}}]);_0x545c78[_0x13be53(0x17a)](0xc8)[_0x13be53(0x24b)](_0x41b50c);}catch(_0x1a6c0d){_0x545c78[_0x13be53(0x17a)](0x194)[_0x13be53(0x24b)]({'message':_0x1a6c0d[_0x13be53(0x1db)]});}}),module[a0_0x37eb0f(0x19b)]=router;