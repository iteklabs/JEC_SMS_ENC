function a0_0x4bc0(){var _0x2afdbf=['language','from_floorlevel','master','$product_details.type','$product_details.product_stock','/barcode_scanner3','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','add_transfer','to_bay','Rack\x20A','An\x20error\x20occurred\x20while\x20saving\x20data.','Email\x20sent\x20successfully','$product_details.product_code','\x20Order\x20Number\x20:\x20','storage','Ambient','/view','from_types','</div>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','An\x20error\x20occurred.','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','from_warehouse','to_prod_pallet','image','filter','$product_details.isle','log','message','rak','New_Qty_Converted','to_floorlevel','DRY\x20STORAGE','_id','to_room_name','site_title','<!DOCTYPE\x20html>','$product_details.production_date','all','find','to_bin','here','warehouse','json','getFullYear','render','135Nocaxx','$product_details.expiry_date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Portuguese\x20(BR)','floorlevel','$name','error','$product_details.maxPerUnit','<span\x20style=\x22float:\x20right;\x22>','Hindi','to_room','id_transaction','Arabic\x20(ae)','TRF-','Rack\x20F','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Level','/transfer/preview/','redirect','then','createTransport','product_name','$product_details.pallet','/view/:id','$product_details','$isAllowEdit','$product_details.storage','Rack\x20E','/upload/','2395560oURJTt','$product_details.rack','$product_details.invoice','findOne','$product_details.bay','split','product_stock','concat','forEach','slice','$product.from_room_name','<h5>','Floor','\x20Order\x20Date\x20:\x20','../models/all_models','to_prod_level','from_prod_qty','sendMail','get','Receiving\x20Area','</h5>','from_prod_isle','$product_details.level','staff','primary_unit','post','Product\x20Transfer\x20successfully','Rack\x20B','</tr>','from_prod_level','product_code3','rack','secondary_code','$product_details.bin','<strong>\x20Regards\x20</strong>','Arabic','maxProducts','random','length','/picking_list/PDF_transfer_rm/','push','from_invoice','$product_details.floorlevel','/barcode_scanner2','user','Logo.png','$date','string','from_room_name','French','<h5\x20style=\x22text-align:\x20left;\x22>','802809XOopqe','<tr>','To_invoice','role','from_quantity','Router','$product_details.secondary_code','to_warehouse','from_storage','Shelves','$product_details.batch_code','61668IXOElv','<hr\x20class=\x22my-3\x22>','save','RoomAssigned','$room','bay','params','Enabled','findById','to_invoice','prod_cat','</td>','prod_name','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','production_date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','type','product','\x20<>\x20','host','map','product_details','$product_details._id','/CheckingWarehouse','unit','Portuguese','/view/add_transfer','Raw\x20Materials','invoice','ToRoomAssigned','from_rack','Spanish','../public/language/languages.json','English','</thead>','to_types','secondary_unit','product_code','\x20</h2>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','status','MaxStocks_data2','Rack\x20D','errors','catch','$product_details.secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','batch_code','finalize','expiry_date','password','body','email','Transfer\x20Edit\x20Successfully','$product_details.unit','maxperunit','394655pNZnVK','from_prod_pallet','$product_details.primary_code','padStart','to_quantity','flash','1498734nhsaKd','to_prod_isle','toString','/transfer/view','English\x20(US)','from_bay','Rack\x20C','aggregate','$product_details.product_name','<div>','True','from_bin','$to_warehouse','COLD\x20STORAGE','Enclosed','bin','</span>','max_per_unit','$finalize','Chinese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','primary_code','3689508wNLoqN','from_rak','3958605tdALWw','RMSEmail','$product','Transfer\x20Finalize\x20Successfully','transfer','</head><body>','Transfer\x20Mail','$product_details.maxProducts','success','logo','port','getDate','$from_warehouse','German','</tbody>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','exports','from_room'];a0_0x4bc0=function(){return _0x2afdbf;};return a0_0x4bc0();}var a0_0x438b09=a0_0x1bcd;(function(_0x529951,_0x3620cc){var _0x3256a8=a0_0x1bcd,_0x336320=_0x529951();while(!![]){try{var _0x4f7a7e=parseInt(_0x3256a8(0x18d))/0x1+parseInt(_0x3256a8(0x193))/0x2+-parseInt(_0x3256a8(0x14a))/0x3+parseInt(_0x3256a8(0x155))/0x4*(parseInt(_0x3256a8(0xf9))/0x5)+-parseInt(_0x3256a8(0xb6))/0x6+-parseInt(_0x3256a8(0xb8))/0x7+parseInt(_0x3256a8(0x117))/0x8;if(_0x4f7a7e===_0x3620cc)break;else _0x336320['push'](_0x336320['shift']());}catch(_0x1b8ae2){_0x336320['push'](_0x336320['shift']());}}}(a0_0x4bc0,0x6482a));const express=require('express'),app=express(),router=express[a0_0x438b09(0x14f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x438b09(0x125)),auth=require('../middleware/auth'),users=require(a0_0x438b09(0x175)),nodemailer=require('nodemailer');router[a0_0x438b09(0x129)](a0_0x438b09(0xdb),auth,async(_0x5bba30,_0x2f7815)=>{var _0x86af6c=a0_0x438b09;try{const {username:_0xcdb260,email:_0x14d0b7,role:_0x54c743}=_0x5bba30[_0x86af6c(0x143)],_0x4182bf=_0x5bba30[_0x86af6c(0x143)],_0x5d6fc2=await profile['findOne']({'email':_0x4182bf['email']}),_0x1b2c11=await master_shop['find']();console[_0x86af6c(0xe6)](_0x86af6c(0xcc),_0x1b2c11);let _0x22a123;if(_0x4182bf[_0x86af6c(0x14d)]==_0x86af6c(0x12e)){const _0x57c8c7=await staff[_0x86af6c(0x11a)]({'email':_0x4182bf[_0x86af6c(0x189)]});_0x22a123=await transfers[_0x86af6c(0xf2)]({'from_warehouse':_0x57c8c7[_0x86af6c(0xf5)]});}else _0x22a123=await transfers[_0x86af6c(0xa7)]([{'$unwind':_0x86af6c(0xba)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x86af6c(0x145)},'from_warehouse':{'$first':_0x86af6c(0xc4)},'to_warehouse':{'$first':_0x86af6c(0xac)},'from_room_name':{'$addToSet':_0x86af6c(0x121)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x86af6c(0xb2)},'isAllowEdit':{'$first':_0x86af6c(0x113)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1b2c11[0x0][_0x86af6c(0xca)]==_0x86af6c(0xa4)){var _0x40493b=users['English'];console['log'](_0x40493b);}else{if(_0x1b2c11[0x0][_0x86af6c(0xca)]==_0x86af6c(0x102))var _0x40493b=users[_0x86af6c(0x102)];else{if(_0x1b2c11[0x0][_0x86af6c(0xca)]=='German')var _0x40493b=users[_0x86af6c(0xc5)];else{if(_0x1b2c11[0x0][_0x86af6c(0xca)]==_0x86af6c(0x174))var _0x40493b=users[_0x86af6c(0x174)];else{if(_0x1b2c11[0x0]['language']==_0x86af6c(0x148))var _0x40493b=users['French'];else{if(_0x1b2c11[0x0][_0x86af6c(0xca)]==_0x86af6c(0xfc))var _0x40493b=users['Portuguese'];else{if(_0x1b2c11[0x0][_0x86af6c(0xca)]=='Chinese')var _0x40493b=users[_0x86af6c(0xb3)];else{if(_0x1b2c11[0x0][_0x86af6c(0xca)]==_0x86af6c(0x105))var _0x40493b=users[_0x86af6c(0x13a)];}}}}}}}_0x2f7815[_0x86af6c(0xf8)](_0x86af6c(0xbc),{'success':_0x5bba30[_0x86af6c(0x192)](_0x86af6c(0xc0)),'errors':_0x5bba30[_0x86af6c(0x192)](_0x86af6c(0x180)),'role':_0x4182bf,'profile':_0x5d6fc2,'master_shop':_0x1b2c11,'transfer':_0x22a123,'language':_0x40493b});}catch(_0x14dd82){console[_0x86af6c(0xe6)](_0x14dd82);}});async function getRandom8DigitNumber(){var _0x299988=a0_0x438b09;const _0x16e939=0x989680,_0x5007b3=0x5f5e0ff,_0x21e784=Math['floor'](Math[_0x299988(0x13c)]()*(_0x5007b3-_0x16e939+0x1))+_0x16e939;var _0x439b05;const _0x133228=await transfers[_0x299988(0x11a)]({'invoice':_0x299988(0x106)+_0x21e784});return _0x133228&&_0x133228['length']>0x0?_0x439b05=_0x299988(0x106)+_0x21e784:_0x439b05='TRF-'+_0x21e784,_0x439b05;}router[a0_0x438b09(0x129)](a0_0x438b09(0x16f),auth,async(_0x2d4c21,_0x1f617c)=>{var _0x4bca88=a0_0x438b09;try{const {username:_0x2d8f9a,email:_0x324ef0,role:_0x417e14}=_0x2d4c21[_0x4bca88(0x143)],_0x3af199=_0x2d4c21[_0x4bca88(0x143)],_0x105ed2=await profile[_0x4bca88(0x11a)]({'email':_0x3af199[_0x4bca88(0x189)]}),_0x253364=await master_shop[_0x4bca88(0xf2)]();console[_0x4bca88(0xe6)](_0x4bca88(0xcc),_0x253364);let _0x7e83b7;if(_0x3af199[_0x4bca88(0x14d)]==_0x4bca88(0x12e)){const _0x1f5bde=await staff['findOne']({'email':_0x3af199['email']});_0x7e83b7=await warehouse[_0x4bca88(0xa7)]([{'$match':{'status':_0x4bca88(0x15c),'name':_0x1f5bde['warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4bca88(0xfe),'name':{'$first':_0x4bca88(0xfe)}}}]);}else _0x7e83b7=await warehouse['aggregate']([{'$match':{'status':_0x4bca88(0x15c),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4bca88(0xfe),'name':{'$first':'$name'}}}]);var _0x5a6523=[_0x4bca88(0xda),_0x4bca88(0xae),'Return\x20Rooms'];const _0x582e44=await transfers[_0x4bca88(0xf2)]({}),_0x26a191=_0x582e44['length']+0x1,_0x37f975=_0x4bca88(0x106)+_0x26a191[_0x4bca88(0x195)]()[_0x4bca88(0x190)](0x5,'0');if(_0x253364[0x0][_0x4bca88(0xca)]=='English\x20(US)'){var _0x49eca9=users[_0x4bca88(0x176)];console[_0x4bca88(0xe6)](_0x49eca9);}else{if(_0x253364[0x0][_0x4bca88(0xca)]==_0x4bca88(0x102))var _0x49eca9=users['Hindi'];else{if(_0x253364[0x0][_0x4bca88(0xca)]=='German')var _0x49eca9=users[_0x4bca88(0xc5)];else{if(_0x253364[0x0][_0x4bca88(0xca)]==_0x4bca88(0x174))var _0x49eca9=users['Spanish'];else{if(_0x253364[0x0][_0x4bca88(0xca)]==_0x4bca88(0x148))var _0x49eca9=users[_0x4bca88(0x148)];else{if(_0x253364[0x0][_0x4bca88(0xca)]=='Portuguese\x20(BR)')var _0x49eca9=users[_0x4bca88(0x16e)];else{if(_0x253364[0x0]['language']==_0x4bca88(0xb3))var _0x49eca9=users['Chinese'];else{if(_0x253364[0x0][_0x4bca88(0xca)]==_0x4bca88(0x105))var _0x49eca9=users[_0x4bca88(0x13a)];}}}}}}}const _0x3b85d7=getRandom8DigitNumber();_0x3b85d7[_0x4bca88(0x10d)](_0x227cb9=>{var _0x3df697=_0x4bca88;_0x1f617c[_0x3df697(0xf8)](_0x3df697(0xd2),{'success':_0x2d4c21[_0x3df697(0x192)](_0x3df697(0xc0)),'errors':_0x2d4c21[_0x3df697(0x192)](_0x3df697(0x180)),'role':_0x3af199,'profile':_0x105ed2,'master_shop':_0x253364,'warehouse':_0x7e83b7,'language':_0x49eca9,'rooms_data':_0x5a6523,'invoice':_0x227cb9});})[_0x4bca88(0x181)](_0xf84f09=>{var _0x542cce=_0x4bca88;_0x2d4c21[_0x542cce(0x192)](_0x542cce(0x180),_0x542cce(0x109)),_0x1f617c[_0x542cce(0x10c)](_0x542cce(0x196));});}catch(_0x406a3b){console[_0x4bca88(0xe6)](_0x406a3b);}}),router[a0_0x438b09(0x130)]('/view/add_transfer',auth,async(_0x272dc9,_0x2f0297)=>{var _0x4b54f2=a0_0x438b09;try{console[_0x4b54f2(0xe6)](_0x272dc9['body']);const {date:_0x3ca384,from_warehouse:_0x4994d0,FromRoom_name:_0x227606,to_warehouse:_0x4010a0,ToRoom_name:_0xeb34c9,prod_name:_0x52acd9,from_prod_qty:_0x2041d8,from_prod_level:_0x342077,from_prod_isle:_0x496bf4,from_prod_pallet:_0x286552,to_prod_qty:_0x472337,to_prod_level:_0x599198,to_prod_isle:_0x1a569e,to_prod_pallet:_0x44cc9e,primary_code:_0x391d5e,secondary_code:_0x3e1a7c,product_code3:_0x550972,note:_0x5367f8,MaxStocks_data2:_0x3fd62b,invoice:_0x3e7db8,expiry_date:_0x521c6c}=_0x272dc9[_0x4b54f2(0x188)];if(typeof _0x52acd9==_0x4b54f2(0x146))var _0x4b06a5=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x161)]],_0x156297=[_0x272dc9['body'][_0x4b54f2(0x127)]],_0x3ffd03=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x134)]],_0x49919d=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0xe9)]],_0x49cf71=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x126)]],_0x21f146=[_0x272dc9[_0x4b54f2(0x188)]['primary_code']],_0x41d015=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x137)]],_0x332eb3=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x135)]],_0x599316=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x17e)]],_0x14c317=[_0x272dc9['body']['primary_unit']],_0x4f1c05=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x179)]],_0x55ef1a=[_0x272dc9[_0x4b54f2(0x188)]['batch_code']],_0x5517e1=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x186)]],_0x413f71=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0xb1)]],_0x2fc176=[_0x272dc9['body'][_0x4b54f2(0x163)]],_0x579e0f=[_0x272dc9['body'][_0x4b54f2(0x15f)]],_0x269dd5=[_0x272dc9[_0x4b54f2(0x188)]['RoomAssigned']],_0x18af3c=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x172)]],_0xda671=[_0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x140)]],_0x5dd510=[_0x272dc9[_0x4b54f2(0x188)]['to_invoice']],_0x284d4c=[_0x272dc9['body'][_0x4b54f2(0x104)]];else var _0x4b06a5=[..._0x272dc9['body'][_0x4b54f2(0x161)]],_0x156297=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x127)]],_0x3ffd03=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x134)]],_0x49919d=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0xe9)]],_0x49cf71=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x126)]],_0x21f146=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0xb5)]],_0x41d015=[..._0x272dc9['body'][_0x4b54f2(0x137)]],_0x332eb3=[..._0x272dc9['body'][_0x4b54f2(0x135)]],_0x599316=[..._0x272dc9['body'][_0x4b54f2(0x17e)]],_0x14c317=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x12f)]],_0x4f1c05=[..._0x272dc9['body'][_0x4b54f2(0x179)]],_0x55ef1a=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x184)]],_0x5517e1=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x186)]],_0x413f71=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0xb1)]],_0x2fc176=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x163)]],_0x579e0f=[..._0x272dc9['body'][_0x4b54f2(0x15f)]],_0x269dd5=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x158)]],_0x18af3c=[..._0x272dc9['body']['ToRoomAssigned']],_0xda671=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x140)]],_0x5dd510=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x15e)]],_0x284d4c=[..._0x272dc9[_0x4b54f2(0x188)][_0x4b54f2(0x104)]];const _0xf3099b=_0x4b06a5[_0x4b54f2(0x169)](_0x458f72=>{return _0x458f72={'product_name':_0x458f72};});_0x156297['forEach']((_0x58c377,_0x251abf)=>{_0xf3099b[_0x251abf]['from_quantity']=_0x58c377;}),_0xda671['forEach']((_0x5d2baf,_0x531211)=>{var _0x3efd04=_0x4b54f2;_0xf3099b[_0x531211][_0x3efd04(0x140)]=_0x5d2baf;}),_0x5dd510[_0x4b54f2(0x11f)]((_0x3a2632,_0x40ede0)=>{_0xf3099b[_0x40ede0]['To_invoice']=_0x3a2632;}),_0x284d4c[_0x4b54f2(0x11f)]((_0x5c48ab,_0x12181f)=>{_0xf3099b[_0x12181f]['id_transaction_id']=_0x5c48ab;}),_0x3ffd03[_0x4b54f2(0x11f)]((_0x2770c2,_0x4d32b4)=>{var _0x47f89e=_0x4b54f2;_0x269dd5[_0x47f89e(0x11f)]((_0x1e0954,_0x3856b3)=>{var _0x33bcde=_0x47f89e;if(_0x1e0954==_0x33bcde(0x12a)&&_0x4d32b4==_0x3856b3){var _0x596a24=_0x2770c2[_0x33bcde(0x120)](0x3);_0xf3099b[_0x4d32b4][_0x33bcde(0x152)]=_0x2770c2[0x0],_0xf3099b[_0x4d32b4][_0x33bcde(0x173)]=_0x2770c2[0x1],_0xf3099b[_0x4d32b4][_0x33bcde(0xa5)]=0x0,_0xf3099b[_0x4d32b4][_0x33bcde(0xab)]=0x0,_0xf3099b[_0x4d32b4][_0x33bcde(0xdc)]=_0x33bcde(0x123),_0xf3099b[_0x4d32b4][_0x33bcde(0xcb)]=_0x596a24;}else{if(_0x1e0954==_0x33bcde(0x153)&&_0x4d32b4==_0x3856b3){var _0x596a24=_0x2770c2['slice'](0x3);_0xf3099b[_0x4d32b4][_0x33bcde(0x152)]=_0x2770c2[0x0],_0xf3099b[_0x4d32b4][_0x33bcde(0x173)]=_0x2770c2[0x1],_0xf3099b[_0x4d32b4][_0x33bcde(0xa5)]=0x0,_0xf3099b[_0x4d32b4]['from_bin']=0x0,_0xf3099b[_0x4d32b4]['from_types']=_0x33bcde(0x123),_0xf3099b[_0x4d32b4][_0x33bcde(0xcb)]=_0x2770c2[0x5];}else{if(_0x4d32b4==_0x3856b3){if(_0x2770c2[0x0]=='A'&&_0x2770c2[0x1]=='L'&&_0x2770c2[0x2]=='L')console[_0x33bcde(0xe6)](_0x1e0954+_0x33bcde(0x167)+_0x4d32b4+_0x33bcde(0x167)+_0x3856b3+_0x33bcde(0x167)+_0x2770c2+_0x33bcde(0xf4)),_0xf3099b[_0x4d32b4][_0x33bcde(0x152)]=_0x2770c2[0x0],_0xf3099b[_0x4d32b4][_0x33bcde(0x173)]=_0x2770c2[0x1],_0xf3099b[_0x4d32b4][_0x33bcde(0xa5)]=0x0,_0xf3099b[_0x4d32b4][_0x33bcde(0xab)]=0x0,_0xf3099b[_0x4d32b4][_0x33bcde(0xdc)]=_0x33bcde(0x123),_0xf3099b[_0x4d32b4][_0x33bcde(0xcb)]=_0x2770c2[0x3];else{var _0x438b67;if(_0x2770c2[0x4]=='L')_0x438b67=_0x33bcde(0x10a);else _0x2770c2[0x4]=='F'&&(_0x438b67='Floor');_0xf3099b[_0x4d32b4][_0x33bcde(0x152)]=_0x2770c2[0x0],_0xf3099b[_0x4d32b4][_0x33bcde(0x173)]=_0x2770c2[0x1],_0xf3099b[_0x4d32b4]['from_bay']=_0x2770c2[0x2],_0xf3099b[_0x4d32b4][_0x33bcde(0xab)]=_0x2770c2[0x3],_0xf3099b[_0x4d32b4]['from_types']=_0x438b67,_0xf3099b[_0x4d32b4][_0x33bcde(0xcb)]=_0x2770c2[0x5];}}}}});}),_0x49919d[_0x4b54f2(0x11f)]((_0x2b4db7,_0xbf0420)=>{var _0x42775a=_0x4b54f2;_0xf3099b[_0xbf0420][_0x42775a(0x191)]=_0x2b4db7;}),_0x49cf71[_0x4b54f2(0x11f)]((_0x2649b6,_0x5cc5a5)=>{var _0x365ec6=_0x4b54f2;_0x18af3c[_0x365ec6(0x11f)]((_0x5713a2,_0x4139f8)=>{var _0x302a5d=_0x365ec6;if(_0x5713a2==_0x302a5d(0x12a)&&_0x5cc5a5==_0x4139f8){var _0x299a5e=_0x2649b6['slice'](0x3);_0xf3099b[_0x5cc5a5]['storage']=_0x2649b6[0x0],_0xf3099b[_0x5cc5a5][_0x302a5d(0x136)]=_0x2649b6[0x1],_0xf3099b[_0x5cc5a5][_0x302a5d(0xd3)]=0x0,_0xf3099b[_0x5cc5a5]['to_bin']=0x0,_0xf3099b[_0x5cc5a5][_0x302a5d(0x178)]=_0x302a5d(0x123),_0xf3099b[_0x5cc5a5][_0x302a5d(0xea)]=_0x299a5e;}else{if(_0x5713a2==_0x302a5d(0x153)&&_0x5cc5a5==_0x4139f8){var _0x299a5e=_0x2649b6[_0x302a5d(0x120)](0x3);_0xf3099b[_0x5cc5a5][_0x302a5d(0xd9)]=_0x2649b6[0x0],_0xf3099b[_0x5cc5a5]['rack']=_0x2649b6[0x1],_0xf3099b[_0x5cc5a5]['to_bay']=0x0,_0xf3099b[_0x5cc5a5]['to_bin']=0x0,_0xf3099b[_0x5cc5a5][_0x302a5d(0x178)]=_0x302a5d(0x123),_0xf3099b[_0x5cc5a5]['to_floorlevel']=_0x2649b6[0x5];}else{if(_0x5cc5a5==_0x4139f8){if(_0x2649b6[0x0]=='A'&&_0x2649b6[0x1]=='L'&&_0x2649b6[0x2]=='L')console['log'](_0x5713a2+_0x302a5d(0x167)+_0x5cc5a5+_0x302a5d(0x167)+_0x4139f8+_0x302a5d(0x167)+_0x2649b6+'here'),_0xf3099b[_0x5cc5a5][_0x302a5d(0xd9)]=_0x2649b6[0x0],_0xf3099b[_0x5cc5a5][_0x302a5d(0x136)]=_0x2649b6[0x1],_0xf3099b[_0x5cc5a5][_0x302a5d(0xd3)]=0x0,_0xf3099b[_0x5cc5a5][_0x302a5d(0xf3)]=0x0,_0xf3099b[_0x5cc5a5][_0x302a5d(0x178)]=_0x302a5d(0x123),_0xf3099b[_0x5cc5a5][_0x302a5d(0xea)]=_0x2649b6[0x3];else{var _0x2f76ef;if(_0x2649b6[0x4]=='L')_0x2f76ef=_0x302a5d(0x10a);else _0x2649b6[0x4]=='F'&&(_0x2f76ef='Floor');_0xf3099b[_0x5cc5a5][_0x302a5d(0xd9)]=_0x2649b6[0x0],_0xf3099b[_0x5cc5a5][_0x302a5d(0x136)]=_0x2649b6[0x1],_0xf3099b[_0x5cc5a5][_0x302a5d(0xd3)]=_0x2649b6[0x2],_0xf3099b[_0x5cc5a5][_0x302a5d(0xf3)]=_0x2649b6[0x3],_0xf3099b[_0x5cc5a5][_0x302a5d(0x178)]=_0x2f76ef,_0xf3099b[_0x5cc5a5][_0x302a5d(0xea)]=_0x2649b6[0x5];}}}}});}),_0x21f146[_0x4b54f2(0x11f)]((_0x3cd220,_0x93888a)=>{var _0x59a8c3=_0x4b54f2;_0xf3099b[_0x93888a][_0x59a8c3(0xb5)]=_0x3cd220;}),_0x41d015[_0x4b54f2(0x11f)]((_0x5e3b70,_0x5a885e)=>{var _0x21e354=_0x4b54f2;_0xf3099b[_0x5a885e][_0x21e354(0x137)]=_0x5e3b70;}),_0x332eb3[_0x4b54f2(0x11f)]((_0x49f49b,_0x39b526)=>{_0xf3099b[_0x39b526]['product_code']=_0x49f49b;}),_0x599316['forEach']((_0x291cbc,_0x39cee7)=>{var _0x30d91c=_0x4b54f2;_0xf3099b[_0x39cee7][_0x30d91c(0x13b)]=_0x291cbc;}),_0x14c317['forEach']((_0x5748e9,_0x40f408)=>{_0xf3099b[_0x40f408]['unit']=_0x5748e9;}),_0x4f1c05[_0x4b54f2(0x11f)]((_0x5d080f,_0x2502cf)=>{_0xf3099b[_0x2502cf]['secondary_unit']=_0x5d080f;}),_0x55ef1a[_0x4b54f2(0x11f)]((_0x225132,_0x5215dc)=>{var _0x26ccc6=_0x4b54f2;_0xf3099b[_0x5215dc][_0x26ccc6(0x184)]=_0x225132;}),_0x5517e1[_0x4b54f2(0x11f)]((_0x35a836,_0x9781e0)=>{var _0x1874ee=_0x4b54f2;_0xf3099b[_0x9781e0][_0x1874ee(0x186)]=_0x35a836;}),_0x413f71['forEach']((_0x20541c,_0x386797)=>{var _0x592271=_0x4b54f2;_0xf3099b[_0x386797][_0x592271(0x18c)]=_0x20541c;}),_0x2fc176[_0x4b54f2(0x11f)]((_0x369f94,_0x1fed16)=>{var _0x5ab3c0=_0x4b54f2;_0xf3099b[_0x1fed16][_0x5ab3c0(0x163)]=_0x369f94;}),_0x579e0f['forEach']((_0x32212b,_0x5096ff)=>{_0xf3099b[_0x5096ff]['prod_cat']=_0x32212b;}),_0x269dd5[_0x4b54f2(0x11f)]((_0xcb6405,_0x2c5a14)=>{var _0x1df24c=_0x4b54f2;_0xf3099b[_0x2c5a14][_0x1df24c(0x147)]=_0xcb6405;}),_0x18af3c['forEach']((_0x4e75a9,_0x546fbb)=>{var _0x4ec7a5=_0x4b54f2;_0xf3099b[_0x546fbb][_0x4ec7a5(0xed)]=_0x4e75a9;});const _0x4425e0=_0xf3099b[_0x4b54f2(0xe4)](_0x327cc3=>_0x327cc3[_0x4b54f2(0x191)]!=='0'&&_0x327cc3[_0x4b54f2(0x191)]!==''||_0x327cc3[_0x4b54f2(0xea)]!=='0'&&_0x327cc3[_0x4b54f2(0xea)]!==''),_0x55b2cc=new transfers({'date':_0x3ca384,'from_warehouse':_0x4994d0,'to_warehouse':_0x4010a0,'product':_0x4425e0,'note':_0x5367f8,'invoice':_0x3e7db8}),_0x5a372e=await _0x55b2cc['save']();_0x272dc9[_0x4b54f2(0x192)](_0x4b54f2(0xc0),_0x4b54f2(0x131)),_0x2f0297[_0x4b54f2(0x10c)](_0x4b54f2(0x10b)+_0x5a372e[_0x4b54f2(0xec)]);}catch(_0x5418bb){console[_0x4b54f2(0xe6)](_0x5418bb),_0x2f0297['status'](0xc8)[_0x4b54f2(0xf6)]({'errorMessage':_0x5418bb[_0x4b54f2(0xe7)]});}}),router[a0_0x438b09(0x129)]('/preview/:id',auth,async(_0x98b1bd,_0x266450)=>{var _0xe64eb9=a0_0x438b09;try{const {username:_0x14284e,email:_0x1f6469,role:_0x257d7c}=_0x98b1bd[_0xe64eb9(0x143)],_0x4e9b9d=_0x98b1bd[_0xe64eb9(0x143)],_0x1e48ff=await profile['findOne']({'email':_0x4e9b9d[_0xe64eb9(0x189)]}),_0x1cf986=await master_shop['find']();console['log']('master',_0x1cf986);const _0x308048=await transfers[_0xe64eb9(0x15d)](_0x98b1bd['params']['id']);let _0x930bb=new Date(_0x308048[_0xe64eb9(0x186)]),_0xccf28c=('0'+_0x930bb[_0xe64eb9(0xc3)]())[_0xe64eb9(0x120)](-0x2),_0x6dc77d=('0'+(_0x930bb['getMonth']()+0x1))[_0xe64eb9(0x120)](-0x2),_0x579b07=_0x930bb[_0xe64eb9(0xf7)](),_0x1967a8=_0x579b07+'-'+_0x6dc77d+'-'+_0xccf28c,_0x5ca493;if(_0x4e9b9d[_0xe64eb9(0x14d)]==_0xe64eb9(0x12e)){const _0x4aec46=await staff[_0xe64eb9(0x11a)]({'email':_0x4e9b9d[_0xe64eb9(0x189)]});_0x5ca493=await warehouse[_0xe64eb9(0xf2)]({'status':_0xe64eb9(0x15c),'name':_0x4aec46['warehouse'],'warehouse_category':_0xe64eb9(0x170)});}else _0x5ca493=await warehouse[_0xe64eb9(0xf2)]({'status':_0xe64eb9(0x15c),'warehouse_category':_0xe64eb9(0x170)});const _0x37d01b=await warehouse[_0xe64eb9(0xa7)]([{'$match':{'name':_0x308048[_0xe64eb9(0xe1)]}},{'$unwind':_0xe64eb9(0x112)},{'$group':{'_id':'$product_details._id','name':{'$first':_0xe64eb9(0xa8)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xe64eb9(0x11b)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xe64eb9(0xcd)},'floorlevel':{'$first':_0xe64eb9(0x141)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xe64eb9(0x150)},'product_code':{'$first':_0xe64eb9(0xd7)},'storage':{'$first':_0xe64eb9(0x114)},'rack':{'$first':_0xe64eb9(0x118)},'expiry_date':{'$first':_0xe64eb9(0xfa)},'production_date':{'$first':_0xe64eb9(0xf0)},'room':{'$first':_0xe64eb9(0x159)}}}]);if(_0x1cf986[0x0][_0xe64eb9(0xca)]==_0xe64eb9(0xa4)){var _0xed6725=users[_0xe64eb9(0x176)];console[_0xe64eb9(0xe6)](_0xed6725);}else{if(_0x1cf986[0x0][_0xe64eb9(0xca)]==_0xe64eb9(0x102))var _0xed6725=users['Hindi'];else{if(_0x1cf986[0x0]['language']==_0xe64eb9(0xc5))var _0xed6725=users['German'];else{if(_0x1cf986[0x0]['language']==_0xe64eb9(0x174))var _0xed6725=users['Spanish'];else{if(_0x1cf986[0x0][_0xe64eb9(0xca)]==_0xe64eb9(0x148))var _0xed6725=users[_0xe64eb9(0x148)];else{if(_0x1cf986[0x0][_0xe64eb9(0xca)]==_0xe64eb9(0xfc))var _0xed6725=users[_0xe64eb9(0x16e)];else{if(_0x1cf986[0x0]['language']=='Chinese')var _0xed6725=users[_0xe64eb9(0xb3)];else{if(_0x1cf986[0x0][_0xe64eb9(0xca)]=='Arabic\x20(ae)')var _0xed6725=users[_0xe64eb9(0x13a)];}}}}}}}_0x266450[_0xe64eb9(0xf8)]('edit_transfer_view',{'success':_0x98b1bd[_0xe64eb9(0x192)]('success'),'errors':_0x98b1bd[_0xe64eb9(0x192)]('errors'),'role':_0x4e9b9d,'profile':_0x1e48ff,'master_shop':_0x1cf986,'warehouse':_0x5ca493,'transfer':_0x308048,'stock':_0x37d01b,'language':_0xed6725});}catch(_0x225d5){console[_0xe64eb9(0xe6)](_0x225d5);}}),router[a0_0x438b09(0x130)]('/preview/:id',auth,async(_0x14414c,_0x2167a9)=>{var _0xba575b=a0_0x438b09;try{const _0x178826=_0x14414c[_0xba575b(0x15b)]['id'],{from_warehouse:_0x4615b0,FromRoom_name:_0x18d8d7,to_warehouse:_0x1011d8,ToRoom_name:_0x52953b}=_0x14414c[_0xba575b(0x188)],_0x3b14e4=await transfers[_0xba575b(0x15d)]({'_id':_0x178826}),_0x48cd2c=_0x3b14e4[_0xba575b(0x166)][_0xba575b(0x169)](async _0x3c0293=>{var _0x34c86d=_0xba575b;if(_0x3c0293[_0x34c86d(0x191)]>0x0){var _0x511167=await warehouse['findOne']({'name':_0x3b14e4[_0x34c86d(0xe1)],'room':_0x3c0293[_0x34c86d(0x147)],'warehouse_category':_0x34c86d(0x170)});const _0x57c2e0=_0x511167[_0x34c86d(0x16a)]['map'](_0x27756f=>{var _0x4300ef=_0x34c86d;_0x27756f[_0x4300ef(0x10f)]==_0x3c0293[_0x4300ef(0x10f)]&&_0x27756f['floorlevel']==_0x3c0293[_0x4300ef(0xcb)]&&_0x27756f['type']==_0x3c0293[_0x4300ef(0xdc)]&&_0x27756f[_0x4300ef(0xaf)]==_0x3c0293[_0x4300ef(0xab)]&&_0x27756f[_0x4300ef(0x15a)]==_0x3c0293[_0x4300ef(0xa5)]&&_0x27756f[_0x4300ef(0x136)]==_0x3c0293[_0x4300ef(0x173)]&&_0x27756f[_0x4300ef(0xd9)]==_0x3c0293[_0x4300ef(0x152)]&&_0x27756f[_0x4300ef(0x186)]==_0x3c0293[_0x4300ef(0x186)]&&_0x27756f[_0x4300ef(0x184)]==_0x3c0293[_0x4300ef(0x184)]&&_0x27756f[_0x4300ef(0x163)]==_0x3c0293[_0x4300ef(0x163)]&&_0x27756f[_0x4300ef(0x171)]==_0x3c0293[_0x4300ef(0x140)]&&_0x27756f[_0x4300ef(0xec)]==_0x3c0293['id_transaction_id']&&(_0x27756f[_0x4300ef(0x11d)]=_0x27756f[_0x4300ef(0x11d)]-_0x3c0293[_0x4300ef(0x191)]);});}return _0x511167;});Promise[_0xba575b(0xf1)](_0x48cd2c)[_0xba575b(0x10d)](async _0x386d5c=>{var _0x5a78d9=_0xba575b;try{for(const _0x12f64b of _0x386d5c){await _0x12f64b[_0x5a78d9(0x157)]();}try{const _0x4abadd=_0x3b14e4['product'][_0x5a78d9(0x169)](async _0x437840=>{var _0xd29588=_0x5a78d9;if(_0x437840[_0xd29588(0x191)]>0x0){var _0x4d7be7=await warehouse[_0xd29588(0x11a)]({'name':_0x3b14e4['to_warehouse'],'room':_0x437840[_0xd29588(0xed)],'warehouse_category':'Raw\x20Materials'}),_0x4b3427=0x0;const _0x2890a7=_0x4d7be7[_0xd29588(0x16a)][_0xd29588(0x169)](_0x4545b5=>{var _0x44a088=_0xd29588;_0x4545b5[_0x44a088(0x10f)]==_0x437840[_0x44a088(0x10f)]&&_0x4545b5[_0x44a088(0xfd)]==_0x437840[_0x44a088(0xea)]&&_0x4545b5['type']==_0x437840[_0x44a088(0x178)]&&_0x4545b5[_0x44a088(0xaf)]==_0x437840['to_bin']&&_0x4545b5['bay']==_0x437840[_0x44a088(0xd3)]&&_0x4545b5[_0x44a088(0x136)]==_0x437840[_0x44a088(0x136)]&&_0x4545b5['storage']==_0x437840[_0x44a088(0xd9)]&&_0x4545b5[_0x44a088(0x186)]==_0x437840['expiry_date']&&_0x4545b5[_0x44a088(0x184)]==_0x437840[_0x44a088(0x184)]&&_0x4545b5[_0x44a088(0x163)]==_0x437840[_0x44a088(0x163)]&&_0x4545b5[_0x44a088(0x171)]==_0x437840[_0x44a088(0x14c)]&&(_0x4545b5[_0x44a088(0x11d)]=_0x4545b5[_0x44a088(0x11d)]+_0x437840[_0x44a088(0x191)],_0x4b3427++);});_0x4b3427=='0'&&(_0x4d7be7[_0xd29588(0x16a)]=_0x4d7be7[_0xd29588(0x16a)][_0xd29588(0x11e)]({'product_name':_0x437840[_0xd29588(0x10f)],'product_stock':_0x437840[_0xd29588(0x191)],'bay':_0x437840[_0xd29588(0xd3)],'bin':_0x437840['to_bin'],'type':_0x437840[_0xd29588(0x178)],'floorlevel':_0x437840[_0xd29588(0xea)],'storage':_0x437840['storage'],'rack':_0x437840[_0xd29588(0x136)],'product_code':_0x437840[_0xd29588(0x17a)],'primary_code':_0x437840[_0xd29588(0xb5)],'secondary_code':_0x437840[_0xd29588(0x137)],'maxProducts':_0x437840[_0xd29588(0x13b)],'storage':_0x437840[_0xd29588(0xd9)],'rack':_0x437840[_0xd29588(0x136)],'expiry_date':_0x437840[_0xd29588(0x186)],'maxPerUnit':_0x437840['maxperunit'],'batch_code':_0x437840[_0xd29588(0x184)],'production_date':_0x437840[_0xd29588(0x163)]}));}return _0x4d7be7;});Promise[_0x5a78d9(0xf1)](_0x4abadd)[_0x5a78d9(0x10d)](async _0x3b0334=>{var _0xb39d69=_0x5a78d9;try{for(const _0x268f60 of _0x3b0334){await warehouse['updateOne']({'_id':_0x268f60[_0xb39d69(0xec)]},{'$addToSet':{'product_details':{'$each':_0x268f60[_0xb39d69(0x16a)]}}});}_0x3b14e4[_0xb39d69(0x185)]=_0xb39d69(0xaa);const _0x1097b0=await _0x3b14e4['save'](),_0x3addb0=await master_shop['find'](),_0x3d86ac=await email_settings['findOne'](),_0x19d43b=await supervisor_settings['find']();var _0x9b3787=_0x3b14e4[_0xb39d69(0x166)],_0x18dca8='',_0x32d79a;for(_0x32d79a in _0x9b3787){_0x18dca8+=_0xb39d69(0x14b)+_0xb39d69(0x164)+_0x9b3787[_0x32d79a][_0xb39d69(0x10f)]+'</td>'+_0xb39d69(0x164)+_0x9b3787[_0x32d79a][_0xb39d69(0x17a)]+_0xb39d69(0x160)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9b3787[_0x32d79a]['to_quantity']+_0xb39d69(0x160)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9b3787[_0x32d79a][_0xb39d69(0x16d)]+_0xb39d69(0x160)+_0xb39d69(0x164)+_0x9b3787[_0x32d79a][_0xb39d69(0x179)]+_0xb39d69(0x160)+_0xb39d69(0x164)+_0x3b14e4[_0xb39d69(0x151)]+_0xb39d69(0x160)+_0xb39d69(0x164)+_0x9b3787[_0x32d79a][_0xb39d69(0xed)]+_0xb39d69(0x160)+_0xb39d69(0x164)+_0x9b3787[_0x32d79a][_0xb39d69(0xd9)]+_0x9b3787[_0x32d79a]['rack']+_0x9b3787[_0x32d79a][_0xb39d69(0xd3)]+_0x9b3787[_0x32d79a][_0xb39d69(0xf3)]+_0x9b3787[_0x32d79a][_0xb39d69(0x178)][0x0]+_0x9b3787[_0x32d79a][_0xb39d69(0xea)]+_0xb39d69(0x160),_0xb39d69(0x133);}let _0x5e90d9=nodemailer[_0xb39d69(0x10e)]({'host':_0x3d86ac[_0xb39d69(0x168)],'port':Number(_0x3d86ac[_0xb39d69(0xc2)]),'secure':![],'auth':{'user':_0x3d86ac[_0xb39d69(0x189)],'pass':_0x3d86ac[_0xb39d69(0x187)]}}),_0x1c222e={'from':_0x3d86ac[_0xb39d69(0x189)],'to':_0x19d43b[0x0][_0xb39d69(0xb9)],'subject':_0xb39d69(0xbe),'attachments':[{'filename':_0xb39d69(0x144),'path':__dirname+'/../public'+_0xb39d69(0x116)+_0x3addb0[0x0][_0xb39d69(0xe3)],'cid':_0xb39d69(0xc1)}],'html':_0xb39d69(0xef)+'<html><head><title></title>'+_0xb39d69(0xbd)+_0xb39d69(0xa9)+_0xb39d69(0x162)+'<div>'+_0xb39d69(0xfb)+_0xb39d69(0xdd)+_0xb39d69(0xa9)+'<h2>\x20'+_0x3addb0[0x0][_0xb39d69(0xee)]+_0xb39d69(0x17b)+_0xb39d69(0xdd)+'</div>'+_0xb39d69(0x156)+_0xb39d69(0xa9)+_0xb39d69(0x149)+_0xb39d69(0xd8)+_0x3b14e4[_0xb39d69(0x171)]+'\x20'+_0xb39d69(0x101)+_0xb39d69(0x124)+_0x3b14e4['date']+'\x20'+_0xb39d69(0xb0)+_0xb39d69(0x12b)+_0xb39d69(0xdd)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xb39d69(0xde)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0xb39d69(0xd1)+_0xb39d69(0x17c)+_0xb39d69(0x183)+_0xb39d69(0x108)+_0xb39d69(0xb4)+_0xb39d69(0xc7)+'</tr>'+_0xb39d69(0x177)+_0xb39d69(0xd0)+'\x20'+_0x18dca8+'\x20'+_0xb39d69(0xc6)+'</table>'+_0xb39d69(0xa9)+_0xb39d69(0x139)+_0xb39d69(0x122)+_0x3addb0[0x0][_0xb39d69(0xee)]+_0xb39d69(0x12b)+'</div>'+_0xb39d69(0xdd)+'</body></html>'};_0x5e90d9[_0xb39d69(0x128)](_0x1c222e,function(_0x18807e,_0xa5f7df){var _0x194a67=_0xb39d69;_0x18807e?(console[_0x194a67(0xe6)](_0x18807e),console['log']('Error\x20Occurs')):console[_0x194a67(0xe6)](_0x194a67(0xd6));}),_0x14414c['flash'](_0xb39d69(0xc0),_0xb39d69(0xbb)),_0x2167a9[_0xb39d69(0x10c)](_0xb39d69(0x13e)+_0x1097b0['_id']);}catch(_0x495a93){console[_0xb39d69(0xff)](_0x495a93),_0x2167a9[_0xb39d69(0x17d)](0x1f4)[_0xb39d69(0xf6)]({'Perror':_0xb39d69(0xd5),'message':_0x495a93[_0xb39d69(0xe7)]});}})[_0x5a78d9(0x181)](_0x45386b=>{var _0x2d0056=_0x5a78d9;console[_0x2d0056(0xff)](_0x45386b),_0x2167a9[_0x2d0056(0x17d)](0x1f4)[_0x2d0056(0xf6)]({'Perror':_0x2d0056(0xdf)});});}catch(_0x3904c2){_0x2167a9[_0x5a78d9(0xf6)](_0x3904c2);}}catch(_0x2421e6){console['error'](_0x2421e6),_0x2167a9[_0x5a78d9(0x17d)](0x1f4)[_0x5a78d9(0xf6)]({'Merror':_0x5a78d9(0xd5),'Message':_0x2421e6[_0x5a78d9(0xe7)]});}})[_0xba575b(0x181)](_0x4b3597=>{var _0x2f0525=_0xba575b;console[_0x2f0525(0xff)](_0x4b3597),_0x2167a9[_0x2f0525(0x17d)](0x1f4)[_0x2f0525(0xf6)]({'Merror':_0x2f0525(0xdf)});});}catch(_0x204f2a){console['log'](_0x204f2a);}});function BayBinSelected(_0x225d21,_0x536805){var _0x335853=a0_0x438b09,_0x536c4e=[],_0x482866=[],_0x5c9284=[],_0x26371f=[],_0x518147=[],_0x1f20dd=[];let _0x459459=[];if(_0x225d21==_0x335853(0xeb))switch(_0x536805){case _0x335853(0xd4):_0x536c4e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x482866=[0x1,0x2],_0x26371f=[0x1,0x2,0x3,0x4,0x5],_0x5c9284=[_0x335853(0x10a),_0x335853(0x123)],_0x518147=['D'],_0x1f20dd=['A'];break;case _0x335853(0x132):_0x536c4e=[0x6,0x5,0x4,0x3,0x2,0x1],_0x482866=[0x1,0x2],_0x26371f=[0x1,0x2,0x3,0x4,0x5],_0x5c9284=[_0x335853(0x10a),_0x335853(0x123)],_0x518147=['D'],_0x1f20dd=['B'];break;case _0x335853(0x153):_0x536c4e=[0x0],_0x482866=[0x0],_0x26371f=[0x1,0x2,0x3,0x4,0x5],_0x5c9284=['Floor'],_0x518147=['D'],_0x1f20dd=['S'];break;case _0x335853(0x12a):_0x536c4e=[0x0],_0x482866=[0x0],_0x26371f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5c9284=['Floor'],_0x518147=['D'],_0x1f20dd=['R'];break;}else{if(_0x225d21==_0x335853(0xad))switch(_0x536805){case _0x335853(0xd4):_0x536c4e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x482866=['B','F'],_0x26371f=[0x1,0x2,0x3,0x4,0x5],_0x5c9284=[_0x335853(0x10a),_0x335853(0x123)],_0x518147=['C'],_0x1f20dd=['A'];break;case _0x335853(0x132):_0x536c4e=[0x5,0x4,0x3,0x2,0x1],_0x482866=['F','B','S'],_0x26371f=[0x1,0x2,0x3,0x4,0x5],_0x5c9284=[_0x335853(0x10a),'Floor'],_0x518147=['C'],_0x1f20dd=['B'];break;case _0x335853(0xa6):_0x536c4e=[0x1,0x2,0x3,0x4,0x5],_0x482866=['B','F','S'],_0x26371f=[0x5,0x4,0x3,0x2,0x1],_0x5c9284=[_0x335853(0x10a),_0x335853(0x123)],_0x518147=['C'],_0x1f20dd=['C'];break;case _0x335853(0x17f):_0x536c4e=[0x5,0x4,0x3,0x2,0x1],_0x482866=['F','B','S'],_0x26371f=[0x1,0x2,0x3,0x4,0x5],_0x5c9284=['Level',_0x335853(0x123)],_0x518147=['C'],_0x1f20dd=['D'];break;case _0x335853(0x115):_0x536c4e=[0x4,0x3,0x2,0x1],_0x482866=[0x1,0x2],_0x26371f=[0x1,0x2,0x3,0x4,0x5],_0x5c9284=[_0x335853(0x10a),_0x335853(0x123)],_0x518147=['C'],_0x1f20dd=['E'];break;case _0x335853(0x107):_0x536c4e=[0x1,0x2,0x3],_0x482866=[0x1,0x2],_0x26371f=[0x1,0x2,0x3,0x4,0x5],_0x5c9284=['Level'],_0x518147=['C'],_0x1f20dd=['F'];break;}}return{'levels':_0x536c4e,'Isle':_0x482866,'rack':_0x26371f,'type':_0x5c9284,'storage':_0x518147,'rak':_0x1f20dd};}function a0_0x1bcd(_0x513c40,_0x128f5a){var _0x4bc07f=a0_0x4bc0();return a0_0x1bcd=function(_0x1bcda3,_0x48b8f4){_0x1bcda3=_0x1bcda3-0xa4;var _0x53f29e=_0x4bc07f[_0x1bcda3];return _0x53f29e;},a0_0x1bcd(_0x513c40,_0x128f5a);}router[a0_0x438b09(0x129)]('/view/:id',auth,async(_0x295451,_0xbef65c)=>{var _0xbacbe9=a0_0x438b09;try{const {username:_0x26e297,email:_0xf57faa,role:_0x508f2a}=_0x295451[_0xbacbe9(0x143)],_0x146bd9=_0x295451[_0xbacbe9(0x143)],_0x270214=await profile[_0xbacbe9(0x11a)]({'email':_0x146bd9[_0xbacbe9(0x189)]}),_0x50adf7=await master_shop[_0xbacbe9(0xf2)](),_0x4ead1d=await transfers[_0xbacbe9(0x15d)](_0x295451[_0xbacbe9(0x15b)]['id']);let _0x122128;if(_0x146bd9[_0xbacbe9(0x14d)]==_0xbacbe9(0x12e)){const _0x55487f=await staff[_0xbacbe9(0x11a)]({'email':_0x146bd9[_0xbacbe9(0x189)]});_0x122128=await warehouse[_0xbacbe9(0xa7)]([{'$match':{'status':_0xbacbe9(0x15c),'name':_0x55487f[_0xbacbe9(0xf5)],'warehouse_category':_0xbacbe9(0x170)}},{'$group':{'_id':_0xbacbe9(0xfe),'name':{'$first':_0xbacbe9(0xfe)}}}]);}else _0x122128=await warehouse[_0xbacbe9(0xa7)]([{'$match':{'status':_0xbacbe9(0x15c),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0xbacbe9(0xfe),'name':{'$first':_0xbacbe9(0xfe)}}}]);const _0x251d8e=await warehouse[_0xbacbe9(0xa7)]([{'$match':{'name':_0x4ead1d[_0xbacbe9(0xe1)],'warehouse_category':_0xbacbe9(0x170)}},{'$unwind':_0xbacbe9(0x112)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xbacbe9(0xce)},'bay':{'$first':_0xbacbe9(0x11b)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xbacbe9(0x141)},'primary_code':{'$first':_0xbacbe9(0x18f)},'secondary_code':{'$first':_0xbacbe9(0x150)},'product_code':{'$first':_0xbacbe9(0xd7)},'storage':{'$first':_0xbacbe9(0x114)},'rack':{'$first':_0xbacbe9(0x118)},'expiry_date':{'$first':_0xbacbe9(0xfa)},'production_date':{'$first':_0xbacbe9(0xf0)},'room':{'$first':_0xbacbe9(0x159)}}}]),_0x358b84=await product[_0xbacbe9(0xf2)]({}),_0x232cc9=BayBinSelected(_0x4ead1d[_0xbacbe9(0x151)],_0x4ead1d[_0xbacbe9(0x103)]);if(_0x50adf7[0x0]['language']==_0xbacbe9(0xa4)){var _0x39b395=users['English'];console[_0xbacbe9(0xe6)](_0x39b395);}else{if(_0x50adf7[0x0][_0xbacbe9(0xca)]=='Hindi')var _0x39b395=users[_0xbacbe9(0x102)];else{if(_0x50adf7[0x0]['language']==_0xbacbe9(0xc5))var _0x39b395=users[_0xbacbe9(0xc5)];else{if(_0x50adf7[0x0]['language']==_0xbacbe9(0x174))var _0x39b395=users['Spanish'];else{if(_0x50adf7[0x0]['language']==_0xbacbe9(0x148))var _0x39b395=users['French'];else{if(_0x50adf7[0x0][_0xbacbe9(0xca)]==_0xbacbe9(0xfc))var _0x39b395=users[_0xbacbe9(0x16e)];else{if(_0x50adf7[0x0][_0xbacbe9(0xca)]==_0xbacbe9(0xb3))var _0x39b395=users['Chinese'];else{if(_0x50adf7[0x0][_0xbacbe9(0xca)]==_0xbacbe9(0x105))var _0x39b395=users[_0xbacbe9(0x13a)];}}}}}}}_0xbef65c[_0xbacbe9(0xf8)]('edit_transfer',{'success':_0x295451[_0xbacbe9(0x192)](_0xbacbe9(0xc0)),'errors':_0x295451[_0xbacbe9(0x192)](_0xbacbe9(0x180)),'role':_0x146bd9,'profile':_0x270214,'master_shop':_0x50adf7,'warehouse':_0x122128,'transfer':_0x4ead1d,'stock':_0x251d8e,'unit':_0x358b84,'language':_0x39b395});}catch(_0x23a83b){console[_0xbacbe9(0xe6)](_0x23a83b);}}),router['post'](a0_0x438b09(0x111),auth,async(_0x36b2f3,_0x235291)=>{var _0x35729b=a0_0x438b09;try{const _0x82dd3e=_0x36b2f3['params']['id'],_0x48eca8=await transfers[_0x35729b(0x15d)](_0x82dd3e);_0x235291['json'](_0x36b2f3[_0x35729b(0x188)]);return;const {date:_0x4ac675,from_warehouse:_0x1842f0,FromRoom_name:_0x637341,to_warehouse:_0x57b256,ToRoom_name:_0x571d73,prod_name:_0x51a78c,from_prod_qty:_0x32ab23,from_prod_level:_0x3f8746,from_prod_isle:_0x44a85b,from_prod_pallet:_0x135c30,to_prod_qty:_0x3c53a8,to_prod_level:_0x3fa989,to_prod_isle:_0x151df2,to_prod_pallet:_0x347846,primary_code:_0x2c9bad,secondary_code:_0x23b018,product_code3:_0x2803a7,note:_0x195686,invoice:_0x32abdc,expiry_date:_0x34fc4f}=_0x36b2f3[_0x35729b(0x188)];if(typeof _0x51a78c==_0x35729b(0x146))var _0x1969aa=[_0x36b2f3['body'][_0x35729b(0x161)]],_0x26ee32=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0x127)]],_0x5e4a1c=[_0x36b2f3['body']['from_prod_level']],_0x118d90=[_0x36b2f3[_0x35729b(0x188)]['from_prod_isle']],_0xfe6305=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0x18e)]],_0x4f0729=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0xdc)]],_0x28e6d2=[_0x36b2f3[_0x35729b(0x188)]['to_prod_qty']],_0x1f5c74=[_0x36b2f3[_0x35729b(0x188)]['to_prod_level']],_0x3af949=[_0x36b2f3[_0x35729b(0x188)]['to_prod_isle']],_0x51b962=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0xe2)]],_0x33c5b7=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0x178)]],_0x11fad5=[_0x36b2f3[_0x35729b(0x188)]['storage']],_0x162d0e=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0xe8)]],_0x1854f2=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0xb5)]],_0x13b162=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0x137)]],_0x4dc6d0=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0x135)]],_0x41ccd2=[_0x36b2f3['body'][_0x35729b(0x17e)]],_0x386546=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0x16d)]],_0x234a23=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0x179)]],_0x4e0401=[_0x36b2f3[_0x35729b(0x188)][_0x35729b(0x184)]],_0x3fa92c=[_0x36b2f3[_0x35729b(0x188)]['expiry_date']],_0x539233=[_0x36b2f3[_0x35729b(0x188)]['from_storage']],_0x1e961c=[_0x36b2f3['body'][_0x35729b(0xb7)]];else var _0x1969aa=[..._0x36b2f3['body'][_0x35729b(0x161)]],_0x11fad5=[..._0x36b2f3[_0x35729b(0x188)][_0x35729b(0xd9)]],_0x162d0e=[..._0x36b2f3['body'][_0x35729b(0xe8)]],_0x4f0729=[..._0x36b2f3[_0x35729b(0x188)]['from_types']],_0x33c5b7=[..._0x36b2f3['body'][_0x35729b(0x178)]],_0x26ee32=[..._0x36b2f3['body']['from_prod_qty']],_0x5e4a1c=[..._0x36b2f3['body'][_0x35729b(0x134)]],_0x118d90=[..._0x36b2f3['body'][_0x35729b(0x12c)]],_0xfe6305=[..._0x36b2f3[_0x35729b(0x188)]['from_prod_pallet']],_0x28e6d2=[..._0x36b2f3[_0x35729b(0x188)]['to_prod_qty']],_0x1f5c74=[..._0x36b2f3['body']['to_prod_level']],_0x3af949=[..._0x36b2f3['body'][_0x35729b(0x194)]],_0x51b962=[..._0x36b2f3[_0x35729b(0x188)]['to_prod_pallet']],_0x1854f2=[..._0x36b2f3[_0x35729b(0x188)][_0x35729b(0xb5)]],_0x13b162=[..._0x36b2f3[_0x35729b(0x188)][_0x35729b(0x137)]],_0x4dc6d0=[..._0x36b2f3['body'][_0x35729b(0x135)]],_0x41ccd2=[..._0x36b2f3['body'][_0x35729b(0x17e)]],_0x386546=[..._0x36b2f3[_0x35729b(0x188)][_0x35729b(0x16d)]],_0x234a23=[..._0x36b2f3['body'][_0x35729b(0x179)]],_0x4e0401=[..._0x36b2f3['body']['batch_code']],_0x3fa92c=[..._0x36b2f3['body'][_0x35729b(0x186)]],_0x539233=[..._0x36b2f3['body']['from_storage']],_0x1e961c=[..._0x36b2f3['body'][_0x35729b(0xb7)]];const _0x32b86c=_0x1969aa[_0x35729b(0x169)](_0x3a9ec8=>{return _0x3a9ec8={'product_name':_0x3a9ec8};});_0x26ee32[_0x35729b(0x11f)]((_0x55c5cc,_0x39627d)=>{var _0x11e0eb=_0x35729b;_0x32b86c[_0x39627d][_0x11e0eb(0x14e)]=_0x55c5cc;}),_0x5e4a1c[_0x35729b(0x11f)]((_0x285e42,_0x29a38f)=>{var _0xcd2883=_0x35729b;_0x32b86c[_0x29a38f][_0xcd2883(0xa5)]=_0x285e42;}),_0x118d90['forEach']((_0x1edb0e,_0x2fd5a9)=>{var _0x1fe3bf=_0x35729b;_0x32b86c[_0x2fd5a9][_0x1fe3bf(0xab)]=_0x1edb0e;}),_0xfe6305[_0x35729b(0x11f)]((_0x131fb6,_0x153947)=>{var _0x30192f=_0x35729b;_0x32b86c[_0x153947][_0x30192f(0xcb)]=_0x131fb6;}),_0x28e6d2[_0x35729b(0x11f)]((_0x504e01,_0x4e8a1c)=>{var _0x45ef61=_0x35729b;_0x32b86c[_0x4e8a1c][_0x45ef61(0x191)]=_0x504e01;}),_0x1f5c74[_0x35729b(0x11f)]((_0x1cca3f,_0x5a9175)=>{var _0x1214e9=_0x35729b;_0x32b86c[_0x5a9175][_0x1214e9(0xd3)]=_0x1cca3f;}),_0x3af949[_0x35729b(0x11f)]((_0x540e53,_0x336ae0)=>{var _0x472b61=_0x35729b;_0x32b86c[_0x336ae0][_0x472b61(0xf3)]=_0x540e53;}),_0x51b962['forEach']((_0x334050,_0x5b245f)=>{var _0x181a9c=_0x35729b;_0x32b86c[_0x5b245f][_0x181a9c(0xea)]=_0x334050;}),_0x1854f2[_0x35729b(0x11f)]((_0x3a460a,_0x1042c4)=>{_0x32b86c[_0x1042c4]['primary_code']=_0x3a460a;}),_0x13b162['forEach']((_0x59806a,_0x393629)=>{_0x32b86c[_0x393629]['secondary_code']=_0x59806a;}),_0x4dc6d0[_0x35729b(0x11f)]((_0x3ca718,_0x409085)=>{var _0x1bb89b=_0x35729b;_0x32b86c[_0x409085][_0x1bb89b(0x17a)]=_0x3ca718;}),_0x41ccd2['forEach']((_0x4f387b,_0x3f471a)=>{_0x32b86c[_0x3f471a]['maxProducts']=_0x4f387b;}),_0x386546['forEach']((_0x3e3e41,_0x3d033f)=>{var _0x357492=_0x35729b;_0x32b86c[_0x3d033f][_0x357492(0x16d)]=_0x3e3e41;}),_0x234a23[_0x35729b(0x11f)]((_0x1624e2,_0x15b8b2)=>{var _0x3b6379=_0x35729b;_0x32b86c[_0x15b8b2][_0x3b6379(0x179)]=_0x1624e2;}),_0x4e0401['forEach']((_0x39be62,_0x22fbf5)=>{var _0x506f12=_0x35729b;_0x32b86c[_0x22fbf5][_0x506f12(0x184)]=_0x39be62;}),_0x3fa92c[_0x35729b(0x11f)]((_0x52f677,_0x1c70d4)=>{_0x32b86c[_0x1c70d4]['expiry_date']=_0x52f677;}),_0x11fad5[_0x35729b(0x11f)]((_0x1cc00b,_0xe45e)=>{var _0x2b45e7=_0x35729b;_0x32b86c[_0xe45e][_0x2b45e7(0xd9)]=_0x1cc00b;}),_0x162d0e[_0x35729b(0x11f)]((_0x33588d,_0x3d2b6c)=>{_0x32b86c[_0x3d2b6c]['rack']=_0x33588d;}),_0x4f0729['forEach']((_0x5296cf,_0x28d9b0)=>{var _0x47ac11=_0x35729b;_0x32b86c[_0x28d9b0][_0x47ac11(0xdc)]=_0x5296cf;}),_0x33c5b7[_0x35729b(0x11f)]((_0x15129e,_0x155ba7)=>{var _0x272b93=_0x35729b;_0x32b86c[_0x155ba7][_0x272b93(0x178)]=_0x15129e;}),_0x539233[_0x35729b(0x11f)]((_0x265e22,_0x5fc5bc)=>{_0x32b86c[_0x5fc5bc]['from_storage']=_0x265e22;}),_0x1e961c[_0x35729b(0x11f)]((_0x5c8549,_0x5a0c15)=>{var _0xe386cc=_0x35729b;_0x32b86c[_0x5a0c15][_0xe386cc(0x173)]=_0x5c8549;});const _0x123e02=_0x32b86c[_0x35729b(0xe4)](_0x147ea2=>_0x147ea2[_0x35729b(0x191)]!=='0'&&_0x147ea2[_0x35729b(0x191)]!==''||_0x147ea2['to_floorlevel']!=='0'&&_0x147ea2[_0x35729b(0xea)]!=='');var _0x457a83=0x0;_0x123e02['forEach'](_0x4681b0=>{var _0x430f76=_0x35729b;parseInt(_0x4681b0[_0x430f76(0x14e)])<parseInt(_0x4681b0['to_quantity'])&&_0x457a83++;});if(_0x457a83!=0x0)return _0x36b2f3['flash']('errors',_0x35729b(0xe0)),_0x235291[_0x35729b(0x10c)]('back');const _0x55c09c=await warehouse[_0x35729b(0x11a)]({'name':_0x48eca8[_0x35729b(0xe1)],'room':_0x48eca8[_0x35729b(0xc9)]});_0x48eca8[_0x35729b(0x166)][_0x35729b(0x11f)](_0x193a61=>{var _0x3ade92=_0x35729b;if(_0x193a61[_0x3ade92(0x191)]>0x0){const _0x6ad84e=_0x55c09c[_0x3ade92(0x16a)][_0x3ade92(0x169)](_0x12be59=>{var _0x343a88=_0x3ade92;_0x12be59[_0x343a88(0x10f)]==_0x193a61[_0x343a88(0x10f)]&&_0x12be59[_0x343a88(0xfd)]==_0x193a61[_0x343a88(0xcb)]&&_0x12be59[_0x343a88(0x165)]==_0x193a61['from_types']&&_0x12be59[_0x343a88(0xaf)]==_0x193a61[_0x343a88(0xab)]&&_0x12be59[_0x343a88(0x15a)]==_0x193a61[_0x343a88(0xa5)]&&_0x12be59['rack']==_0x193a61['from_rack']&&_0x12be59[_0x343a88(0xd9)]==_0x193a61[_0x343a88(0x152)]&&(_0x12be59[_0x343a88(0x11d)]=parseInt(_0x12be59['product_stock'])+parseInt(_0x193a61[_0x343a88(0x191)]));});}}),await _0x55c09c[_0x35729b(0x157)]();const _0x2f796f=await warehouse[_0x35729b(0x11a)]({'name':_0x48eca8[_0x35729b(0x151)],'room':_0x48eca8[_0x35729b(0x103)]});_0x48eca8[_0x35729b(0x166)][_0x35729b(0x11f)](_0x5c93b0=>{var _0x3c642a=_0x35729b;if(_0x5c93b0['to_quantity']>0x0){const _0x4446a2=_0x2f796f[_0x3c642a(0x16a)][_0x3c642a(0x169)](_0x2d9b29=>{var _0x5a54b7=_0x3c642a;_0x2d9b29[_0x5a54b7(0x10f)]==_0x5c93b0[_0x5a54b7(0x10f)]&&_0x2d9b29[_0x5a54b7(0xfd)]==_0x5c93b0[_0x5a54b7(0xea)]&&_0x2d9b29['type']==_0x5c93b0[_0x5a54b7(0x178)]&&_0x2d9b29[_0x5a54b7(0xaf)]==_0x5c93b0[_0x5a54b7(0xf3)]&&_0x2d9b29[_0x5a54b7(0x15a)]==_0x5c93b0['to_bay']&&_0x2d9b29['rack']==_0x5c93b0[_0x5a54b7(0x136)]&&_0x2d9b29[_0x5a54b7(0xd9)]==_0x5c93b0[_0x5a54b7(0xd9)]&&(_0x2d9b29[_0x5a54b7(0x11d)]=parseInt(_0x2d9b29[_0x5a54b7(0x11d)])-parseInt(_0x5c93b0[_0x5a54b7(0x191)]));});}}),await _0x2f796f[_0x35729b(0x157)](),_0x48eca8['date']=_0x4ac675,_0x48eca8[_0x35729b(0xe1)]=_0x1842f0,_0x48eca8[_0x35729b(0x151)]=_0x57b256,_0x48eca8['product']=_0x123e02,_0x48eca8['note']=_0x195686,_0x48eca8[_0x35729b(0x171)]=_0x32abdc;const _0x5ed236=await _0x48eca8['save']();console[_0x35729b(0xe6)](_0x5ed236);const _0x4bf51b=await warehouse[_0x35729b(0x11a)]({'name':_0x1842f0,'room':_0x637341});_0x5ed236[_0x35729b(0x166)]['forEach'](_0x152aa1=>{var _0x5a75b2=_0x35729b;if(_0x152aa1[_0x5a75b2(0x191)]>0x0){const _0x34f6fb=_0x4bf51b[_0x5a75b2(0x16a)][_0x5a75b2(0x169)](_0x56dc9d=>{var _0x69ed56=_0x5a75b2;_0x56dc9d[_0x69ed56(0x10f)]==_0x152aa1['product_name']&&_0x56dc9d['floorlevel']==_0x152aa1[_0x69ed56(0xcb)]&&_0x56dc9d[_0x69ed56(0x165)]==_0x152aa1['from_types']&&_0x56dc9d['bin']==_0x152aa1[_0x69ed56(0xab)]&&_0x56dc9d[_0x69ed56(0x15a)]==_0x152aa1['from_bay']&&_0x56dc9d[_0x69ed56(0x136)]==_0x152aa1[_0x69ed56(0x173)]&&_0x56dc9d[_0x69ed56(0xd9)]==_0x152aa1[_0x69ed56(0x152)]&&(_0x56dc9d[_0x69ed56(0x11d)]=parseInt(_0x56dc9d[_0x69ed56(0x11d)])-parseInt(_0x152aa1[_0x69ed56(0x191)]));});}}),await _0x4bf51b[_0x35729b(0x157)]();const _0xd5d759=await warehouse['findOne']({'name':_0x57b256,'room':_0x571d73});_0x5ed236[_0x35729b(0x166)]['forEach'](_0x236bf0=>{var _0xc176a1=_0x35729b;if(_0x236bf0[_0xc176a1(0x191)]>0x0){var _0x3712bb=0x0;const _0x5d6695=_0xd5d759[_0xc176a1(0x16a)]['map'](_0x11c182=>{var _0x28256e=_0xc176a1;_0x11c182['product_name']==_0x236bf0['product_name']&&_0x11c182[_0x28256e(0xfd)]==_0x236bf0[_0x28256e(0xea)]&&_0x11c182[_0x28256e(0x165)]==_0x236bf0[_0x28256e(0x178)]&&_0x11c182[_0x28256e(0xaf)]==_0x236bf0[_0x28256e(0xf3)]&&_0x11c182[_0x28256e(0x15a)]==_0x236bf0['to_bay']&&_0x11c182[_0x28256e(0x136)]==_0x236bf0[_0x28256e(0x136)]&&_0x11c182['storage']==_0x236bf0['storage']&&(_0x11c182[_0x28256e(0x11d)]=parseInt(_0x11c182[_0x28256e(0x11d)])+parseInt(_0x236bf0[_0x28256e(0x191)]),_0x3712bb++);});_0x3712bb=='0'&&(_0xd5d759[_0xc176a1(0x16a)]=_0xd5d759['product_details']['concat']({'product_name':_0x236bf0[_0xc176a1(0x10f)],'product_stock':_0x236bf0[_0xc176a1(0x191)],'bay':_0x236bf0[_0xc176a1(0xd3)],'bin':_0x236bf0['to_bin'],'type':_0x236bf0['to_types'],'floorlevel':_0x236bf0[_0xc176a1(0xea)],'storage':_0x236bf0[_0xc176a1(0xd9)],'rack':_0x236bf0['rack'],'product_code':_0x236bf0[_0xc176a1(0x17a)],'primary_code':_0x236bf0[_0xc176a1(0xb5)],'secondary_code':_0x236bf0[_0xc176a1(0x137)],'maxProducts':_0x236bf0[_0xc176a1(0x13b)],'storage':_0x236bf0[_0xc176a1(0xd9)],'rack':_0x236bf0[_0xc176a1(0x136)]}));}}),await _0xd5d759['save'](),_0x36b2f3['flash']('success',_0x35729b(0x18a)),_0x235291[_0x35729b(0x10c)](_0x35729b(0x196));}catch(_0x2712f8){console['log'](_0x2712f8);}}),router[a0_0x438b09(0x130)]('/barcode_scanner',async(_0x14083a,_0x2f64a5)=>{var _0x1bb544=a0_0x438b09;const {FromWareHouse:_0x250940,FromRoom:_0x38a0b3,ToWarehouse:_0x9ff628,ToRoom:_0x588246,primary_code:_0x4626bd,Roomslist:_0x5b1405}=_0x14083a[_0x1bb544(0x188)],_0x4357a2=_0x5b1405[_0x1bb544(0x11c)](','),_0xbc4df2=[];async function _0x3495b1(_0x3ec2d9){var _0x14798e=_0x1bb544;const _0x2abc5d=await warehouse[_0x14798e(0xa7)]([{'$match':{'name':_0x250940,'room':_0x3ec2d9}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x4626bd}},{'$group':{'_id':_0x14798e(0x16b),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x14798e(0xce)},'primary_code':{'$first':_0x14798e(0x18f)},'secondary_code':{'$first':_0x14798e(0x150)},'product_code':{'$first':_0x14798e(0xd7)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x14798e(0xcd)},'pallet':{'$first':_0x14798e(0x141)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x14798e(0x182)},'storage':{'$first':_0x14798e(0x114)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x14798e(0xfa)},'production_date':{'$first':_0x14798e(0xf0)},'batch_code':{'$first':_0x14798e(0x154)},'maxPerUnit':{'$first':_0x14798e(0x100)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x14798e(0x119)}}}]),_0x2874ce=await warehouse[_0x14798e(0xa7)]([{'$match':{'name':_0x250940,'room':_0x3ec2d9}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4626bd}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x14798e(0xa8)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x14798e(0x150)},'product_code':{'$first':_0x14798e(0xd7)},'level':{'$first':_0x14798e(0x11b)},'isle':{'$first':_0x14798e(0x138)},'type':{'$first':_0x14798e(0xcd)},'pallet':{'$first':_0x14798e(0x141)},'unit':{'$first':_0x14798e(0x18b)},'secondary_unit':{'$first':_0x14798e(0x182)},'storage':{'$first':_0x14798e(0x114)},'rack':{'$first':_0x14798e(0x118)},'expiry_date':{'$first':_0x14798e(0xfa)},'production_date':{'$first':_0x14798e(0xf0)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x14798e(0x100)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x14798e(0x159)},'maxProducts':{'$first':_0x14798e(0xbf)},'invoice_product':{'$first':_0x14798e(0x119)}}}]);if(_0x2abc5d[_0x14798e(0x13d)]>0x0)_0xbc4df2['push'](_0x2abc5d);else _0x2874ce[_0x14798e(0x13d)]>0x0&&_0xbc4df2[_0x14798e(0x13f)](_0x2874ce);}const _0xc05ff1=_0x4357a2['map'](_0xe88ed6=>_0x3495b1(_0xe88ed6));await Promise[_0x1bb544(0xf1)](_0xc05ff1),_0x2f64a5[_0x1bb544(0xf6)](_0xbc4df2);}),router[a0_0x438b09(0x130)](a0_0x438b09(0x142),async(_0x5d46ab,_0x585aa5)=>{var _0x213529=a0_0x438b09;try{const {FromWareHouse:_0x45eb54,FromRoom:_0xa6fe92,ToWarehouse:_0x1fb325,ToRoom:_0x2c59ba,secondary_code:_0x61388c}=_0x5d46ab[_0x213529(0x188)],_0xd52f2a=await warehouse['aggregate']([{'$match':{'name':_0x45eb54}},{'$unwind':_0x213529(0x112)},{'$match':{'product_details.secondary_code':_0x61388c}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x213529(0xa8)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x213529(0x150)},'product_code':{'$first':_0x213529(0xd7)},'instock':{'$first':_0x213529(0xce)},'warehouse':{'$first':_0x213529(0xfe)},'level':{'$first':_0x213529(0x12d)},'isle':{'$first':_0x213529(0xe5)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x213529(0xbf)},'unit':{'$first':'$product_details.unit'}}}]);_0x585aa5[_0x213529(0x17d)](0xc8)['json'](_0xd52f2a);}catch(_0xa02bef){_0x585aa5[_0x213529(0x17d)](0x194)[_0x213529(0xf6)]({'message':_0xa02bef['message']});}}),router['post'](a0_0x438b09(0xcf),async(_0x5ea75f,_0x29a1e8)=>{var _0xe3663c=a0_0x438b09;try{const {FromWareHouse:_0x4bb958,FromRoom:_0x4e3cd9,ToWarehouse:_0x5668e2,ToRoom:_0x37e3ab,product_code:_0x28b490}=_0x5ea75f[_0xe3663c(0x188)],_0x4c2bd8=await warehouse[_0xe3663c(0xa7)]([{'$match':{'name':_0x4bb958}},{'$unwind':_0xe3663c(0x112)},{'$match':{'product_details.product_code':_0x28b490}},{'$group':{'_id':_0xe3663c(0x16b),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xe3663c(0x150)},'product_code':{'$first':_0xe3663c(0xd7)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0xe3663c(0xfe)},'level':{'$first':_0xe3663c(0x12d)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0xe3663c(0x110)},'maxProducts':{'$first':_0xe3663c(0xbf)},'unit':{'$first':'$product_details.unit'}}}]);_0x29a1e8[_0xe3663c(0x17d)](0xc8)['json'](_0x4c2bd8);}catch(_0x1c3973){_0x29a1e8[_0xe3663c(0x17d)](0x194)[_0xe3663c(0xf6)]({'message':_0x1c3973[_0xe3663c(0xe7)]});}}),router[a0_0x438b09(0x130)](a0_0x438b09(0x16c),async(_0x451eda,_0x241990)=>{var _0x1b458c=a0_0x438b09;const {level:_0x5c90b1,isle:_0x3aa3cb,pallet:_0x25848d,warehouses:_0x1bc0d0,room:_0x4c0861}=_0x451eda[_0x1b458c(0x188)];try{const _0xc204ec=await warehouse[_0x1b458c(0xa7)]([{'$match':{'name':_0x1bc0d0,'room':_0x4c0861}},{'$unwind':_0x1b458c(0x112)},{'$match':{'product_details.level':parseInt(_0x5c90b1),'product_details.isle':_0x3aa3cb,'product_details.pallet':parseInt(_0x25848d)}},{'$group':{'_id':_0x1b458c(0x16b),'name':{'$first':_0x1b458c(0xa8)},'product_stock':{'$first':_0x1b458c(0xce)},'level':{'$first':_0x1b458c(0x12d)},'isle':{'$first':_0x1b458c(0xe5)},'pallet':{'$first':_0x1b458c(0x110)},'maxProducts':{'$first':_0x1b458c(0xbf)}}}]);_0x241990[_0x1b458c(0x17d)](0xc8)['json'](_0xc204ec);}catch(_0x224937){_0x241990[_0x1b458c(0x17d)](0x194)['json']({'message':_0x224937['message']});}}),module[a0_0x438b09(0xc8)]=router;