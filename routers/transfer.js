var a0_0x22fc28=a0_0x4d7a;(function(_0x514c29,_0x2c7e1c){var _0x4683a5=a0_0x4d7a,_0x5227ce=_0x514c29();while(!![]){try{var _0x358a49=parseInt(_0x4683a5(0x1cf))/0x1*(-parseInt(_0x4683a5(0x180))/0x2)+-parseInt(_0x4683a5(0x16b))/0x3*(-parseInt(_0x4683a5(0x1de))/0x4)+-parseInt(_0x4683a5(0x1f0))/0x5+parseInt(_0x4683a5(0x200))/0x6+-parseInt(_0x4683a5(0x16a))/0x7+-parseInt(_0x4683a5(0x1ee))/0x8+parseInt(_0x4683a5(0x18b))/0x9;if(_0x358a49===_0x2c7e1c)break;else _0x5227ce['push'](_0x5227ce['shift']());}catch(_0x381829){_0x5227ce['push'](_0x5227ce['shift']());}}}(a0_0xf1e2,0xe096d));function a0_0x4d7a(_0x3bce31,_0x134eec){var _0xf1e274=a0_0xf1e2();return a0_0x4d7a=function(_0x4d7a16,_0x4a5cd9){_0x4d7a16=_0x4d7a16-0x11c;var _0x54e78a=_0xf1e274[_0x4d7a16];return _0x54e78a;},a0_0x4d7a(_0x3bce31,_0x134eec);}const express=require(a0_0x22fc28(0x17b)),app=express(),router=express[a0_0x22fc28(0x154)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x22fc28(0x1d4)),users=require(a0_0x22fc28(0x1ca)),nodemailer=require(a0_0x22fc28(0x1af));router[a0_0x22fc28(0x162)]('/view',auth,async(_0x3ba01b,_0x5eada1)=>{var _0xa95fab=a0_0x22fc28;try{const {username:_0x3c0351,email:_0x39fc31,role:_0x32e0fe}=_0x3ba01b[_0xa95fab(0x1cd)],_0x170a1d=_0x3ba01b['user'],_0x2a40fa=await profile[_0xa95fab(0x177)]({'email':_0x170a1d[_0xa95fab(0x1ec)]}),_0x497734=await master_shop[_0xa95fab(0x1b6)]();console['log'](_0xa95fab(0x156),_0x497734);let _0x42b412;if(_0x170a1d[_0xa95fab(0x1f8)]==_0xa95fab(0x1b2)){const _0x149034=await staff['findOne']({'email':_0x170a1d[_0xa95fab(0x1ec)]});_0x42b412=await transfers[_0xa95fab(0x1b6)]({'from_warehouse':_0x149034[_0xa95fab(0x136)]});}else _0x42b412=await transfers['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0xa95fab(0x1c6),'invoice':{'$first':'$invoice'},'date':{'$first':_0xa95fab(0x20b)},'from_warehouse':{'$first':_0xa95fab(0x1fa)},'to_warehouse':{'$first':_0xa95fab(0x18f)},'from_room_name':{'$addToSet':_0xa95fab(0x152)},'to_room_name':{'$addToSet':_0xa95fab(0x174)},'finalize':{'$first':_0xa95fab(0x1e5)},'isAllowEdit':{'$first':_0xa95fab(0x126)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x497734[0x0][_0xa95fab(0x1f7)]==_0xa95fab(0x178)){var _0x523087=users[_0xa95fab(0x149)];console[_0xa95fab(0x20e)](_0x523087);}else{if(_0x497734[0x0][_0xa95fab(0x1f7)]=='Hindi')var _0x523087=users['Hindi'];else{if(_0x497734[0x0][_0xa95fab(0x1f7)]==_0xa95fab(0x15c))var _0x523087=users[_0xa95fab(0x15c)];else{if(_0x497734[0x0]['language']==_0xa95fab(0x17f))var _0x523087=users['Spanish'];else{if(_0x497734[0x0][_0xa95fab(0x1f7)]==_0xa95fab(0x1d1))var _0x523087=users[_0xa95fab(0x1d1)];else{if(_0x497734[0x0][_0xa95fab(0x1f7)]==_0xa95fab(0x1ff))var _0x523087=users[_0xa95fab(0x1e6)];else{if(_0x497734[0x0]['language']=='Chinese')var _0x523087=users[_0xa95fab(0x1ac)];else{if(_0x497734[0x0][_0xa95fab(0x1f7)]=='Arabic\x20(ae)')var _0x523087=users[_0xa95fab(0x208)];}}}}}}}_0x5eada1['render'](_0xa95fab(0x186),{'success':_0x3ba01b[_0xa95fab(0x1d8)](_0xa95fab(0x14e)),'errors':_0x3ba01b[_0xa95fab(0x1d8)]('errors'),'role':_0x170a1d,'profile':_0x2a40fa,'master_shop':_0x497734,'transfer':_0x42b412,'language':_0x523087});}catch(_0x21adbd){console['log'](_0x21adbd);}});async function getRandom8DigitNumber(){var _0x223a5f=a0_0x22fc28;const _0x22ff7e=0x989680,_0x538473=0x5f5e0ff,_0x4bc679=Math[_0x223a5f(0x1b3)](Math['random']()*(_0x538473-_0x22ff7e+0x1))+_0x22ff7e;var _0x9ce86e;const _0x2f7b48=await transfers[_0x223a5f(0x177)]({'invoice':'TRF-'+_0x4bc679});return _0x2f7b48&&_0x2f7b48[_0x223a5f(0x12b)]>0x0?_0x9ce86e=_0x223a5f(0x1e0)+_0x4bc679:_0x9ce86e=_0x223a5f(0x1e0)+_0x4bc679,_0x9ce86e;}router[a0_0x22fc28(0x162)](a0_0x22fc28(0x1ba),auth,async(_0x5f9120,_0x13360d)=>{var _0x293b70=a0_0x22fc28;try{const {username:_0x28d4cd,email:_0x2e015e,role:_0xea9d82}=_0x5f9120[_0x293b70(0x1cd)],_0x4e42b0=_0x5f9120[_0x293b70(0x1cd)],_0x417250=await profile['findOne']({'email':_0x4e42b0[_0x293b70(0x1ec)]}),_0xa07a4c=await master_shop['find']();console['log']('master',_0xa07a4c);let _0x451e02;if(_0x4e42b0[_0x293b70(0x1f8)]==_0x293b70(0x1b2)){const _0x2b84b6=await staff[_0x293b70(0x177)]({'email':_0x4e42b0[_0x293b70(0x1ec)]});_0x451e02=await warehouse[_0x293b70(0x131)]([{'$match':{'status':_0x293b70(0x1b7),'name':_0x2b84b6['warehouse'],'warehouse_category':_0x293b70(0x1d9)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x451e02=await warehouse[_0x293b70(0x131)]([{'$match':{'status':_0x293b70(0x1b7),'warehouse_category':_0x293b70(0x1d9)}},{'$group':{'_id':_0x293b70(0x184),'name':{'$first':'$name'}}}]);var _0x4ea7cb=['Ambient','Enclosed','Return\x20Rooms'];const _0x4af581=await transfers[_0x293b70(0x1b6)]({}),_0x27cbad=_0x4af581['length']+0x1,_0x5338b5=_0x293b70(0x1e0)+_0x27cbad[_0x293b70(0x19a)]()[_0x293b70(0x1db)](0x5,'0');if(_0xa07a4c[0x0][_0x293b70(0x1f7)]=='English\x20(US)'){var _0x283f15=users[_0x293b70(0x149)];console[_0x293b70(0x20e)](_0x283f15);}else{if(_0xa07a4c[0x0]['language']==_0x293b70(0x182))var _0x283f15=users[_0x293b70(0x182)];else{if(_0xa07a4c[0x0][_0x293b70(0x1f7)]==_0x293b70(0x15c))var _0x283f15=users[_0x293b70(0x15c)];else{if(_0xa07a4c[0x0]['language']==_0x293b70(0x17f))var _0x283f15=users[_0x293b70(0x17f)];else{if(_0xa07a4c[0x0][_0x293b70(0x1f7)]=='French')var _0x283f15=users[_0x293b70(0x1d1)];else{if(_0xa07a4c[0x0][_0x293b70(0x1f7)]==_0x293b70(0x1ff))var _0x283f15=users[_0x293b70(0x1e6)];else{if(_0xa07a4c[0x0][_0x293b70(0x1f7)]==_0x293b70(0x1ac))var _0x283f15=users[_0x293b70(0x1ac)];else{if(_0xa07a4c[0x0][_0x293b70(0x1f7)]==_0x293b70(0x1c0))var _0x283f15=users['Arabic'];}}}}}}}const _0x1eee27=getRandom8DigitNumber();_0x1eee27[_0x293b70(0x1ae)](_0x8cf1a9=>{var _0x149d60=_0x293b70;_0x13360d['render'](_0x149d60(0x137),{'success':_0x5f9120[_0x149d60(0x1d8)](_0x149d60(0x14e)),'errors':_0x5f9120['flash']('errors'),'role':_0x4e42b0,'profile':_0x417250,'master_shop':_0xa07a4c,'warehouse':_0x451e02,'language':_0x283f15,'rooms_data':_0x4ea7cb,'invoice':_0x8cf1a9});})[_0x293b70(0x199)](_0x4866e2=>{var _0xff26b9=_0x293b70;_0x5f9120[_0xff26b9(0x1d8)]('errors',_0xff26b9(0x1f9)),_0x13360d[_0xff26b9(0x124)](_0xff26b9(0x172));});}catch(_0x36592d){console[_0x293b70(0x20e)](_0x36592d);}}),router[a0_0x22fc28(0x209)](a0_0x22fc28(0x1ba),auth,async(_0x193062,_0xccbc8a)=>{var _0x1ba0ee=a0_0x22fc28;try{console[_0x1ba0ee(0x20e)](_0x193062[_0x1ba0ee(0x1a8)]);const {date:_0x53b60d,from_warehouse:_0x37e777,FromRoom_name:_0x39a792,to_warehouse:_0x3f258c,ToRoom_name:_0x405a9d,prod_name:_0x4eda48,from_prod_qty:_0x422664,from_prod_level:_0x4a1a93,from_prod_isle:_0x30ac62,from_prod_pallet:_0x13b26e,to_prod_qty:_0x4ddf33,to_prod_level:_0x4df79c,to_prod_isle:_0x558f69,to_prod_pallet:_0x2b8471,primary_code:_0x3da3af,secondary_code:_0x443846,product_code3:_0x1c7b74,note:_0x3ef52b,MaxStocks_data2:_0x371f39,invoice:_0x257980,expiry_date:_0x42f30d}=_0x193062['body'];if(typeof _0x4eda48==_0x1ba0ee(0x18c))var _0x39a58c=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x11f)]],_0x2a98e5=[_0x193062[_0x1ba0ee(0x1a8)]['from_prod_qty']],_0x18ea4d=[_0x193062[_0x1ba0ee(0x1a8)]['from_prod_level']],_0x4b0a9f=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x16f)]],_0x2991f6=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x11d)]],_0x2b7812=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x12c)]],_0x51a7b7=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x12e)]],_0x335462=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x161)]],_0x19d972=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x190)]],_0x5c81c9=[_0x193062[_0x1ba0ee(0x1a8)]['primary_unit']],_0x27a9b5=[_0x193062[_0x1ba0ee(0x1a8)]['secondary_unit']],_0x34c379=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x195)]],_0x305a59=[_0x193062['body'][_0x1ba0ee(0x1b0)]],_0x1d7ad3=[_0x193062['body'][_0x1ba0ee(0x14b)]],_0x51e956=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x18d)]],_0xd63e5a=[_0x193062['body']['prod_cat']],_0x41e5f5=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x20c)]],_0x340ee8=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x20a)]],_0x1c4b69=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x181)]],_0x4abc45=[_0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x127)]],_0x3cd530=[_0x193062[_0x1ba0ee(0x1a8)]['id_transaction']];else var _0x39a58c=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x11f)]],_0x2a98e5=[..._0x193062['body'][_0x1ba0ee(0x1eb)]],_0x18ea4d=[..._0x193062['body'][_0x1ba0ee(0x163)]],_0x4b0a9f=[..._0x193062[_0x1ba0ee(0x1a8)]['New_Qty_Converted']],_0x2991f6=[..._0x193062['body']['to_prod_level']],_0x2b7812=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x12c)]],_0x51a7b7=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x12e)]],_0x335462=[..._0x193062['body'][_0x1ba0ee(0x161)]],_0x19d972=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x190)]],_0x5c81c9=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x14c)]],_0x27a9b5=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x1c3)]],_0x34c379=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x195)]],_0x305a59=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x1b0)]],_0x1d7ad3=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x14b)]],_0x51e956=[..._0x193062[_0x1ba0ee(0x1a8)]['production_date']],_0xd63e5a=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x148)]],_0x41e5f5=[..._0x193062['body'][_0x1ba0ee(0x20c)]],_0x340ee8=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x20a)]],_0x1c4b69=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x181)]],_0x4abc45=[..._0x193062[_0x1ba0ee(0x1a8)][_0x1ba0ee(0x127)]],_0x3cd530=[..._0x193062['body'][_0x1ba0ee(0x1e3)]];const _0x13424b=_0x39a58c[_0x1ba0ee(0x175)](_0x35f9b5=>{return _0x35f9b5={'product_name':_0x35f9b5};});_0x2a98e5[_0x1ba0ee(0x17c)]((_0x197699,_0x4e138e)=>{var _0x404bb6=_0x1ba0ee;_0x13424b[_0x4e138e][_0x404bb6(0x1b8)]=_0x197699;}),_0x1c4b69[_0x1ba0ee(0x17c)]((_0x14a25e,_0x123222)=>{var _0x4cf697=_0x1ba0ee;_0x13424b[_0x123222][_0x4cf697(0x181)]=_0x14a25e;}),_0x4abc45[_0x1ba0ee(0x17c)]((_0x1d2e18,_0x53d9f5)=>{var _0x6c8601=_0x1ba0ee;_0x13424b[_0x53d9f5][_0x6c8601(0x19e)]=_0x1d2e18;}),_0x3cd530[_0x1ba0ee(0x17c)]((_0x190af5,_0x2f3e52)=>{var _0x23551e=_0x1ba0ee;_0x13424b[_0x2f3e52][_0x23551e(0x197)]=_0x190af5;}),_0x18ea4d[_0x1ba0ee(0x17c)]((_0x19da9d,_0x16f50b)=>{var _0x5ae88c=_0x1ba0ee;_0x41e5f5[_0x5ae88c(0x17c)]((_0x44a36b,_0x29308d)=>{var _0x18e2da=_0x5ae88c;if(_0x44a36b==_0x18e2da(0x194)&&_0x16f50b==_0x29308d){var _0x3263fe=_0x19da9d['slice'](0x3);_0x13424b[_0x16f50b][_0x18e2da(0x1a9)]=_0x19da9d[0x0],_0x13424b[_0x16f50b]['from_rack']=_0x19da9d[0x1],_0x13424b[_0x16f50b][_0x18e2da(0x129)]=0x0,_0x13424b[_0x16f50b][_0x18e2da(0x15e)]=0x0,_0x13424b[_0x16f50b][_0x18e2da(0x187)]='Floor',_0x13424b[_0x16f50b]['from_floorlevel']=_0x3263fe;}else{if(_0x44a36b==_0x18e2da(0x15a)&&_0x16f50b==_0x29308d){var _0x3263fe=_0x19da9d[_0x18e2da(0x138)](0x3);_0x13424b[_0x16f50b][_0x18e2da(0x1a9)]=_0x19da9d[0x0],_0x13424b[_0x16f50b]['from_rack']=_0x19da9d[0x1],_0x13424b[_0x16f50b][_0x18e2da(0x129)]=0x0,_0x13424b[_0x16f50b]['from_bin']=0x0,_0x13424b[_0x16f50b]['from_types']='Floor',_0x13424b[_0x16f50b]['from_floorlevel']=_0x19da9d[0x5];}else{if(_0x16f50b==_0x29308d){if(_0x19da9d[0x0]=='A'&&_0x19da9d[0x1]=='L'&&_0x19da9d[0x2]=='L')console[_0x18e2da(0x20e)](_0x44a36b+_0x18e2da(0x1e2)+_0x16f50b+'\x20<>\x20'+_0x29308d+'\x20<>\x20'+_0x19da9d+_0x18e2da(0x1dd)),_0x13424b[_0x16f50b]['from_storage']=_0x19da9d[0x0],_0x13424b[_0x16f50b][_0x18e2da(0x206)]=_0x19da9d[0x1],_0x13424b[_0x16f50b][_0x18e2da(0x129)]=0x0,_0x13424b[_0x16f50b]['from_bin']=0x0,_0x13424b[_0x16f50b]['from_types']=_0x18e2da(0x203),_0x13424b[_0x16f50b]['from_floorlevel']=_0x19da9d[0x3];else{var _0x2e3aec;if(_0x19da9d[0x4]=='L')_0x2e3aec='Level';else _0x19da9d[0x4]=='F'&&(_0x2e3aec=_0x18e2da(0x203));_0x13424b[_0x16f50b][_0x18e2da(0x1a9)]=_0x19da9d[0x0],_0x13424b[_0x16f50b][_0x18e2da(0x206)]=_0x19da9d[0x1],_0x13424b[_0x16f50b][_0x18e2da(0x129)]=_0x19da9d[0x2],_0x13424b[_0x16f50b]['from_bin']=_0x19da9d[0x3],_0x13424b[_0x16f50b][_0x18e2da(0x187)]=_0x2e3aec,_0x13424b[_0x16f50b][_0x18e2da(0x13b)]=_0x19da9d[0x5];}}}}});}),_0x4b0a9f[_0x1ba0ee(0x17c)]((_0x10fffd,_0x2423d5)=>{var _0x39fb8c=_0x1ba0ee;_0x13424b[_0x2423d5][_0x39fb8c(0x120)]=_0x10fffd;}),_0x2991f6['forEach']((_0x162bec,_0x45531f)=>{var _0x1db3dc=_0x1ba0ee;_0x340ee8[_0x1db3dc(0x17c)]((_0x2db248,_0x2e9713)=>{var _0x458a56=_0x1db3dc;if(_0x2db248=='Receiving\x20Area'&&_0x45531f==_0x2e9713){var _0x221a6d=_0x162bec[_0x458a56(0x138)](0x3);_0x13424b[_0x45531f]['storage']=_0x162bec[0x0],_0x13424b[_0x45531f][_0x458a56(0x1c1)]=_0x162bec[0x1],_0x13424b[_0x45531f][_0x458a56(0x171)]=0x0,_0x13424b[_0x45531f]['to_bin']=0x0,_0x13424b[_0x45531f][_0x458a56(0x139)]='Floor',_0x13424b[_0x45531f]['to_floorlevel']=_0x221a6d;}else{if(_0x2db248=='Shelves'&&_0x45531f==_0x2e9713){var _0x221a6d=_0x162bec['slice'](0x3);_0x13424b[_0x45531f]['storage']=_0x162bec[0x0],_0x13424b[_0x45531f][_0x458a56(0x1c1)]=_0x162bec[0x1],_0x13424b[_0x45531f][_0x458a56(0x171)]=0x0,_0x13424b[_0x45531f]['to_bin']=0x0,_0x13424b[_0x45531f][_0x458a56(0x139)]=_0x458a56(0x203),_0x13424b[_0x45531f]['to_floorlevel']=_0x162bec[0x5];}else{if(_0x45531f==_0x2e9713){if(_0x162bec[0x0]=='A'&&_0x162bec[0x1]=='L'&&_0x162bec[0x2]=='L')console[_0x458a56(0x20e)](_0x2db248+_0x458a56(0x1e2)+_0x45531f+'\x20<>\x20'+_0x2e9713+_0x458a56(0x1e2)+_0x162bec+_0x458a56(0x1dd)),_0x13424b[_0x45531f][_0x458a56(0x1cb)]=_0x162bec[0x0],_0x13424b[_0x45531f][_0x458a56(0x1c1)]=_0x162bec[0x1],_0x13424b[_0x45531f]['to_bay']=0x0,_0x13424b[_0x45531f][_0x458a56(0x167)]=0x0,_0x13424b[_0x45531f][_0x458a56(0x139)]=_0x458a56(0x203),_0x13424b[_0x45531f][_0x458a56(0x1aa)]=_0x162bec[0x3];else{var _0x178538;if(_0x162bec[0x4]=='L')_0x178538=_0x458a56(0x1df);else _0x162bec[0x4]=='F'&&(_0x178538='Floor');_0x13424b[_0x45531f][_0x458a56(0x1cb)]=_0x162bec[0x0],_0x13424b[_0x45531f]['rack']=_0x162bec[0x1],_0x13424b[_0x45531f][_0x458a56(0x171)]=_0x162bec[0x2],_0x13424b[_0x45531f][_0x458a56(0x167)]=_0x162bec[0x3],_0x13424b[_0x45531f][_0x458a56(0x139)]=_0x178538,_0x13424b[_0x45531f]['to_floorlevel']=_0x162bec[0x5];}}}}});}),_0x2b7812[_0x1ba0ee(0x17c)]((_0x9b1306,_0x2a75ba)=>{var _0x41c72b=_0x1ba0ee;_0x13424b[_0x2a75ba][_0x41c72b(0x12c)]=_0x9b1306;}),_0x51a7b7[_0x1ba0ee(0x17c)]((_0x22e767,_0x19a8ac)=>{var _0x163f5d=_0x1ba0ee;_0x13424b[_0x19a8ac][_0x163f5d(0x12e)]=_0x22e767;}),_0x335462[_0x1ba0ee(0x17c)]((_0x1780c8,_0x3dbab2)=>{var _0x1efa91=_0x1ba0ee;_0x13424b[_0x3dbab2][_0x1efa91(0x1bf)]=_0x1780c8;}),_0x19d972['forEach']((_0xbe8804,_0x1ee59a)=>{var _0x3af74f=_0x1ba0ee;_0x13424b[_0x1ee59a][_0x3af74f(0x158)]=_0xbe8804;}),_0x5c81c9[_0x1ba0ee(0x17c)]((_0xde83a8,_0x102ad8)=>{_0x13424b[_0x102ad8]['unit']=_0xde83a8;}),_0x27a9b5[_0x1ba0ee(0x17c)]((_0x3dfa9a,_0x182e62)=>{var _0xfc58fd=_0x1ba0ee;_0x13424b[_0x182e62][_0xfc58fd(0x1c3)]=_0x3dfa9a;}),_0x34c379[_0x1ba0ee(0x17c)]((_0x586a16,_0x1c0ae4)=>{_0x13424b[_0x1c0ae4]['batch_code']=_0x586a16;}),_0x305a59[_0x1ba0ee(0x17c)]((_0x59463f,_0x3b9a37)=>{_0x13424b[_0x3b9a37]['expiry_date']=_0x59463f;}),_0x1d7ad3['forEach']((_0x454eb0,_0x130c7c)=>{_0x13424b[_0x130c7c]['maxperunit']=_0x454eb0;}),_0x51e956[_0x1ba0ee(0x17c)]((_0x34565b,_0x552f3f)=>{var _0x4650b4=_0x1ba0ee;_0x13424b[_0x552f3f][_0x4650b4(0x18d)]=_0x34565b;}),_0xd63e5a['forEach']((_0xdf08eb,_0x40ba4e)=>{var _0x4fb57d=_0x1ba0ee;_0x13424b[_0x40ba4e][_0x4fb57d(0x148)]=_0xdf08eb;}),_0x41e5f5[_0x1ba0ee(0x17c)]((_0x100cb3,_0xf66e8)=>{var _0x362b6b=_0x1ba0ee;_0x13424b[_0xf66e8][_0x362b6b(0x125)]=_0x100cb3;}),_0x340ee8[_0x1ba0ee(0x17c)]((_0x58e2db,_0x563c7c)=>{var _0x16dd9b=_0x1ba0ee;_0x13424b[_0x563c7c][_0x16dd9b(0x13a)]=_0x58e2db;});const _0x4e1003=_0x13424b[_0x1ba0ee(0x13f)](_0x51ea72=>_0x51ea72['to_quantity']!=='0'&&_0x51ea72[_0x1ba0ee(0x120)]!==''||_0x51ea72[_0x1ba0ee(0x1aa)]!=='0'&&_0x51ea72[_0x1ba0ee(0x1aa)]!==''),_0x74c4c9=new transfers({'date':_0x53b60d,'from_warehouse':_0x37e777,'to_warehouse':_0x3f258c,'product':_0x4e1003,'note':_0x3ef52b,'invoice':_0x257980}),_0x2b394b=await _0x74c4c9['save']();_0x193062[_0x1ba0ee(0x1d8)](_0x1ba0ee(0x14e),'Product\x20Transfer\x20successfully'),_0xccbc8a[_0x1ba0ee(0x124)](_0x1ba0ee(0x185)+_0x2b394b[_0x1ba0ee(0x13c)]);}catch(_0xfa56d9){console['log'](_0xfa56d9),_0xccbc8a[_0x1ba0ee(0x132)](0xc8)[_0x1ba0ee(0x17d)]({'errorMessage':_0xfa56d9[_0x1ba0ee(0x1b9)]});}}),router[a0_0x22fc28(0x162)]('/preview/:id',auth,async(_0x4be5e1,_0x25d38b)=>{var _0x506c8a=a0_0x22fc28;try{const {username:_0x2439ae,email:_0x9d9312,role:_0x3c3d8a}=_0x4be5e1[_0x506c8a(0x1cd)],_0x448df6=_0x4be5e1[_0x506c8a(0x1cd)],_0x46c431=await profile['findOne']({'email':_0x448df6['email']}),_0x9f3b3e=await master_shop[_0x506c8a(0x1b6)]();console[_0x506c8a(0x20e)](_0x506c8a(0x156),_0x9f3b3e);const _0x20e123=await transfers[_0x506c8a(0x18a)](_0x4be5e1['params']['id']);let _0x1d2766=new Date(_0x20e123[_0x506c8a(0x1b0)]),_0x4af9e8=('0'+_0x1d2766[_0x506c8a(0x1f3)]())['slice'](-0x2),_0x41de85=('0'+(_0x1d2766['getMonth']()+0x1))[_0x506c8a(0x138)](-0x2),_0x34b4a2=_0x1d2766[_0x506c8a(0x1c9)](),_0x263a08=_0x34b4a2+'-'+_0x41de85+'-'+_0x4af9e8,_0x221ffa;if(_0x448df6['role']=='staff'){const _0x4abb65=await staff[_0x506c8a(0x177)]({'email':_0x448df6[_0x506c8a(0x1ec)]});_0x221ffa=await warehouse['find']({'status':'Enabled','name':_0x4abb65[_0x506c8a(0x136)],'warehouse_category':_0x506c8a(0x1d9)});}else _0x221ffa=await warehouse[_0x506c8a(0x1b6)]({'status':_0x506c8a(0x1b7),'warehouse_category':_0x506c8a(0x1d9)});const _0x596121=await warehouse['aggregate']([{'$match':{'name':_0x20e123['from_warehouse']}},{'$unwind':_0x506c8a(0x13e)},{'$group':{'_id':_0x506c8a(0x1fe),'name':{'$first':_0x506c8a(0x1b5)},'product_stock':{'$first':_0x506c8a(0x1ed)},'bay':{'$first':_0x506c8a(0x192)},'bin':{'$first':_0x506c8a(0x143)},'type':{'$first':_0x506c8a(0x191)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x506c8a(0x164)},'secondary_code':{'$first':_0x506c8a(0x1bb)},'product_code':{'$first':_0x506c8a(0x1dc)},'storage':{'$first':_0x506c8a(0x1ce)},'rack':{'$first':_0x506c8a(0x17e)},'expiry_date':{'$first':_0x506c8a(0x207)},'production_date':{'$first':_0x506c8a(0x121)},'room':{'$first':_0x506c8a(0x188)}}}]);if(_0x9f3b3e[0x0]['language']==_0x506c8a(0x178)){var _0x1cd625=users[_0x506c8a(0x149)];console[_0x506c8a(0x20e)](_0x1cd625);}else{if(_0x9f3b3e[0x0][_0x506c8a(0x1f7)]=='Hindi')var _0x1cd625=users[_0x506c8a(0x182)];else{if(_0x9f3b3e[0x0]['language']==_0x506c8a(0x15c))var _0x1cd625=users['German'];else{if(_0x9f3b3e[0x0][_0x506c8a(0x1f7)]==_0x506c8a(0x17f))var _0x1cd625=users['Spanish'];else{if(_0x9f3b3e[0x0][_0x506c8a(0x1f7)]==_0x506c8a(0x1d1))var _0x1cd625=users[_0x506c8a(0x1d1)];else{if(_0x9f3b3e[0x0][_0x506c8a(0x1f7)]=='Portuguese\x20(BR)')var _0x1cd625=users['Portuguese'];else{if(_0x9f3b3e[0x0]['language']==_0x506c8a(0x1ac))var _0x1cd625=users[_0x506c8a(0x1ac)];else{if(_0x9f3b3e[0x0][_0x506c8a(0x1f7)]=='Arabic\x20(ae)')var _0x1cd625=users[_0x506c8a(0x208)];}}}}}}}_0x25d38b['render'](_0x506c8a(0x19d),{'success':_0x4be5e1['flash'](_0x506c8a(0x14e)),'errors':_0x4be5e1[_0x506c8a(0x1d8)](_0x506c8a(0x153)),'role':_0x448df6,'profile':_0x46c431,'master_shop':_0x9f3b3e,'warehouse':_0x221ffa,'transfer':_0x20e123,'stock':_0x596121,'language':_0x1cd625});}catch(_0x3fcec9){console[_0x506c8a(0x20e)](_0x3fcec9);}}),router[a0_0x22fc28(0x209)](a0_0x22fc28(0x1c8),auth,async(_0x4fdf72,_0x9200cd)=>{var _0x5edbbd=a0_0x22fc28;try{const _0x24bcb4=_0x4fdf72[_0x5edbbd(0x1f5)]['id'],{from_warehouse:_0x21d82a,FromRoom_name:_0x986d85,to_warehouse:_0x2512e9,ToRoom_name:_0x357d65}=_0x4fdf72[_0x5edbbd(0x1a8)],_0x57cf66=await transfers[_0x5edbbd(0x18a)]({'_id':_0x24bcb4}),_0xa64b2c=_0x57cf66[_0x5edbbd(0x1a1)][_0x5edbbd(0x175)](async _0x16e323=>{var _0x4c7d42=_0x5edbbd;if(_0x16e323['to_quantity']>0x0){var _0x4396f3=await warehouse[_0x4c7d42(0x177)]({'name':_0x57cf66['from_warehouse'],'room':_0x16e323['from_room_name'],'warehouse_category':_0x4c7d42(0x1d9)});const _0x166075=_0x4396f3[_0x4c7d42(0x160)][_0x4c7d42(0x175)](_0x29d7c7=>{var _0x3f46a8=_0x4c7d42;_0x29d7c7[_0x3f46a8(0x176)]==_0x16e323[_0x3f46a8(0x176)]&&_0x29d7c7[_0x3f46a8(0x173)]==_0x16e323[_0x3f46a8(0x13b)]&&_0x29d7c7[_0x3f46a8(0x141)]==_0x16e323[_0x3f46a8(0x187)]&&_0x29d7c7[_0x3f46a8(0x18e)]==_0x16e323[_0x3f46a8(0x15e)]&&_0x29d7c7[_0x3f46a8(0x1b1)]==_0x16e323[_0x3f46a8(0x129)]&&_0x29d7c7['rack']==_0x16e323[_0x3f46a8(0x206)]&&_0x29d7c7['storage']==_0x16e323[_0x3f46a8(0x1a9)]&&_0x29d7c7[_0x3f46a8(0x1b0)]==_0x16e323[_0x3f46a8(0x1b0)]&&_0x29d7c7[_0x3f46a8(0x195)]==_0x16e323['batch_code']&&_0x29d7c7['production_date']==_0x16e323[_0x3f46a8(0x18d)]&&_0x29d7c7['invoice']==_0x16e323[_0x3f46a8(0x181)]&&_0x29d7c7['_id']==_0x16e323[_0x3f46a8(0x197)]&&(_0x29d7c7[_0x3f46a8(0x15b)]=_0x29d7c7['product_stock']-_0x16e323['to_quantity']);});}return _0x4396f3;});Promise['all'](_0xa64b2c)['then'](async _0x6c0341=>{var _0x3c31e6=_0x5edbbd;try{for(const _0x24f3a5 of _0x6c0341){await _0x24f3a5['save']();}try{const _0x16cb4a=_0x57cf66[_0x3c31e6(0x1a1)]['map'](async _0x15a541=>{var _0x569c5f=_0x3c31e6;if(_0x15a541['to_quantity']>0x0){var _0x22fad2=await warehouse[_0x569c5f(0x177)]({'name':_0x57cf66[_0x569c5f(0x198)],'room':_0x15a541[_0x569c5f(0x13a)],'warehouse_category':_0x569c5f(0x1d9)}),_0x592a00=0x0;const _0x3a8571=_0x22fad2['product_details'][_0x569c5f(0x175)](_0x604f41=>{var _0x6eeb74=_0x569c5f;_0x604f41[_0x6eeb74(0x176)]==_0x15a541['product_name']&&_0x604f41['floorlevel']==_0x15a541[_0x6eeb74(0x1aa)]&&_0x604f41['type']==_0x15a541['to_types']&&_0x604f41[_0x6eeb74(0x18e)]==_0x15a541[_0x6eeb74(0x167)]&&_0x604f41['bay']==_0x15a541['to_bay']&&_0x604f41[_0x6eeb74(0x1c1)]==_0x15a541[_0x6eeb74(0x1c1)]&&_0x604f41['storage']==_0x15a541[_0x6eeb74(0x1cb)]&&_0x604f41[_0x6eeb74(0x1b0)]==_0x15a541[_0x6eeb74(0x1b0)]&&_0x604f41['batch_code']==_0x15a541[_0x6eeb74(0x195)]&&_0x604f41[_0x6eeb74(0x18d)]==_0x15a541['production_date']&&_0x604f41[_0x6eeb74(0x16c)]==_0x15a541['To_invoice']&&(_0x604f41[_0x6eeb74(0x15b)]=_0x604f41['product_stock']+_0x15a541[_0x6eeb74(0x120)],_0x592a00++);});_0x592a00=='0'&&(_0x22fad2[_0x569c5f(0x160)]=_0x22fad2[_0x569c5f(0x160)][_0x569c5f(0x165)]({'product_name':_0x15a541[_0x569c5f(0x176)],'product_stock':_0x15a541[_0x569c5f(0x120)],'bay':_0x15a541[_0x569c5f(0x171)],'bin':_0x15a541[_0x569c5f(0x167)],'type':_0x15a541[_0x569c5f(0x139)],'floorlevel':_0x15a541['to_floorlevel'],'storage':_0x15a541[_0x569c5f(0x1cb)],'rack':_0x15a541[_0x569c5f(0x1c1)],'product_code':_0x15a541[_0x569c5f(0x1bf)],'primary_code':_0x15a541[_0x569c5f(0x12c)],'secondary_code':_0x15a541[_0x569c5f(0x12e)],'maxProducts':_0x15a541[_0x569c5f(0x158)],'storage':_0x15a541[_0x569c5f(0x1cb)],'rack':_0x15a541[_0x569c5f(0x1c1)],'expiry_date':_0x15a541[_0x569c5f(0x1b0)],'maxPerUnit':_0x15a541[_0x569c5f(0x1da)],'batch_code':_0x15a541[_0x569c5f(0x195)],'production_date':_0x15a541[_0x569c5f(0x18d)]}));}return _0x22fad2;});Promise[_0x3c31e6(0x212)](_0x16cb4a)[_0x3c31e6(0x1ae)](async _0x532b97=>{var _0x3790d4=_0x3c31e6;try{for(const _0x1df29b of _0x532b97){await warehouse[_0x3790d4(0x17a)]({'_id':_0x1df29b['_id']},{'$addToSet':{'product_details':{'$each':_0x1df29b[_0x3790d4(0x160)]}}});}_0x57cf66[_0x3790d4(0x1fc)]=_0x3790d4(0x166);const _0x533f10=await _0x57cf66[_0x3790d4(0x1a7)](),_0x4dd484=await master_shop[_0x3790d4(0x1b6)](),_0x399698=await email_settings[_0x3790d4(0x177)](),_0x3d51df=await supervisor_settings[_0x3790d4(0x1b6)]();var _0x1a7344=_0x57cf66[_0x3790d4(0x1a1)],_0x105fab='',_0x28ee43;for(_0x28ee43 in _0x1a7344){_0x105fab+=_0x3790d4(0x1d6)+_0x3790d4(0x179)+_0x1a7344[_0x28ee43][_0x3790d4(0x176)]+'</td>'+_0x3790d4(0x179)+_0x1a7344[_0x28ee43]['product_code']+_0x3790d4(0x1be)+_0x3790d4(0x179)+_0x1a7344[_0x28ee43][_0x3790d4(0x120)]+_0x3790d4(0x1be)+_0x3790d4(0x179)+_0x1a7344[_0x28ee43][_0x3790d4(0x123)]+_0x3790d4(0x1be)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a7344[_0x28ee43][_0x3790d4(0x1c3)]+_0x3790d4(0x1be)+_0x3790d4(0x179)+_0x57cf66[_0x3790d4(0x198)]+'</td>'+_0x3790d4(0x179)+_0x1a7344[_0x28ee43][_0x3790d4(0x13a)]+'</td>'+_0x3790d4(0x179)+_0x1a7344[_0x28ee43][_0x3790d4(0x1cb)]+_0x1a7344[_0x28ee43][_0x3790d4(0x1c1)]+_0x1a7344[_0x28ee43][_0x3790d4(0x171)]+_0x1a7344[_0x28ee43][_0x3790d4(0x167)]+_0x1a7344[_0x28ee43]['to_types'][0x0]+_0x1a7344[_0x28ee43][_0x3790d4(0x1aa)]+_0x3790d4(0x1be),_0x3790d4(0x1f6);}let _0x5af8a4=nodemailer['createTransport']({'host':_0x399698[_0x3790d4(0x168)],'port':Number(_0x399698[_0x3790d4(0x205)]),'secure':![],'auth':{'user':_0x399698['email'],'pass':_0x399698[_0x3790d4(0x14f)]}}),_0x2536c8={'from':_0x399698[_0x3790d4(0x1ec)],'to':_0x3d51df[0x0][_0x3790d4(0x1cc)],'subject':_0x3790d4(0x189),'attachments':[{'filename':_0x3790d4(0x135),'path':__dirname+_0x3790d4(0x144)+_0x3790d4(0x11e)+_0x4dd484[0x0]['image'],'cid':'logo'}],'html':_0x3790d4(0x170)+_0x3790d4(0x1ea)+_0x3790d4(0x1a6)+_0x3790d4(0x1a4)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x3790d4(0x1a4)+_0x3790d4(0x147)+_0x4dd484[0x0][_0x3790d4(0x1e8)]+_0x3790d4(0x1e1)+_0x3790d4(0x193)+_0x3790d4(0x193)+_0x3790d4(0x14d)+'<div>'+_0x3790d4(0x1d7)+_0x3790d4(0x11c)+_0x57cf66[_0x3790d4(0x16c)]+'\x20'+_0x3790d4(0x155)+'\x20Order\x20Date\x20:\x20'+_0x57cf66[_0x3790d4(0x1a2)]+'\x20'+_0x3790d4(0x20f)+_0x3790d4(0x1a3)+_0x3790d4(0x193)+_0x3790d4(0x1a5)+_0x3790d4(0x13d)+_0x3790d4(0x1d6)+_0x3790d4(0x1c7)+_0x3790d4(0x151)+_0x3790d4(0x19c)+_0x3790d4(0x1ab)+_0x3790d4(0x142)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x3790d4(0x1ef)+_0x3790d4(0x1f6)+_0x3790d4(0x204)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x105fab+'\x20'+_0x3790d4(0x210)+_0x3790d4(0x14a)+'<div>'+_0x3790d4(0x19f)+_0x3790d4(0x196)+_0x4dd484[0x0][_0x3790d4(0x1e8)]+_0x3790d4(0x1a3)+_0x3790d4(0x193)+_0x3790d4(0x193)+_0x3790d4(0x1f1)};_0x5af8a4[_0x3790d4(0x1ad)](_0x2536c8,function(_0x2c245e,_0x301187){var _0x102bd7=_0x3790d4;_0x2c245e?(console['log'](_0x2c245e),console[_0x102bd7(0x20e)](_0x102bd7(0x20d))):console[_0x102bd7(0x20e)](_0x102bd7(0x1f2));}),_0x4fdf72[_0x3790d4(0x1d8)]('success',_0x3790d4(0x1c4)),_0x9200cd[_0x3790d4(0x124)](_0x3790d4(0x1c5)+_0x533f10[_0x3790d4(0x13c)]);}catch(_0x36fb3f){console['error'](_0x36fb3f),_0x9200cd[_0x3790d4(0x132)](0x1f4)[_0x3790d4(0x17d)]({'Perror':_0x3790d4(0x1d3),'message':_0x36fb3f[_0x3790d4(0x1b9)]});}})['catch'](_0x105c30=>{var _0x5c167a=_0x3c31e6;console[_0x5c167a(0x1bd)](_0x105c30),_0x9200cd[_0x5c167a(0x132)](0x1f4)[_0x5c167a(0x17d)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x50887e){_0x9200cd[_0x3c31e6(0x17d)](_0x50887e);}}catch(_0x4ad065){console['error'](_0x4ad065),_0x9200cd['status'](0x1f4)['json']({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x4ad065[_0x3c31e6(0x1b9)]});}})[_0x5edbbd(0x199)](_0xe3a7e7=>{var _0x1ab78e=_0x5edbbd;console[_0x1ab78e(0x1bd)](_0xe3a7e7),_0x9200cd[_0x1ab78e(0x132)](0x1f4)['json']({'Merror':_0x1ab78e(0x15f)});});}catch(_0x14cd57){console['log'](_0x14cd57);}});function a0_0xf1e2(){var _0xb58d86=['$to_warehouse','MaxStocks_data2','$product_details.type','$product_details.bay','</div>','Receiving\x20Area','batch_code','<h5>','id_transaction_id','to_warehouse','catch','toString','split','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','edit_transfer_view','To_invoice','<strong>\x20Regards\x20</strong>','/view/:id','product','date','</h5>','<div>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','</head><body>','save','body','from_storage','to_floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Chinese','sendMail','then','nodemailer','expiry_date','bay','staff','floor','Rack\x20B','$product_details.product_name','find','Enabled','from_quantity','message','/view/add_transfer','$product_details.secondary_code','$product_details.invoice','error','</td>','product_code','Arabic\x20(ae)','rack','Rack\x20C','secondary_unit','Transfer\x20Finalize\x20Successfully','/picking_list/PDF_transfer_rm/','$_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/preview/:id','getFullYear','../public/language/languages.json','storage','RMSEmail','user','$product_details.storage','1jVOdwg','back','French','$product_details.maxProducts','An\x20error\x20occurred\x20while\x20saving\x20data.','../middleware/auth','$product_details.maxPerUnit','<tr>','<h5\x20style=\x22text-align:\x20left;\x22>','flash','Raw\x20Materials','maxperunit','padStart','$product_details.product_code','here','24148LoPDEx','Level','TRF-','\x20</h2>','\x20<>\x20','id_transaction','$product_details.isle','$finalize','Portuguese','COLD\x20STORAGE','site_title','Rack\x20A','<html><head><title></title>','from_prod_qty','email','$product_details.product_stock','8032640xgsNei','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','2086035clXHqL','</body></html>','Email\x20sent\x20successfully','getDate','$product_details.floorlevel','params','</tr>','language','role','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$from_warehouse','Rack\x20F','finalize','to_prod_pallet','$product_details._id','Portuguese\x20(BR)','6888414GCZkpa','to_prod_qty','Rack\x20D','Floor','</thead>','port','from_rack','$product_details.expiry_date','Arabic','post','ToRoomAssigned','$date','RoomAssigned','Error\x20Occurs','log','</span>','</tbody>','$product_details.level','all','\x20Order\x20Number\x20:\x20','to_prod_level','/upload/','prod_name','to_quantity','$product_details.production_date','note','unit','redirect','from_room_name','$isAllowEdit','to_invoice','from_prod_isle','from_bay','push','length','primary_code','$product_details.unit','secondary_code','$product_details.secondary_unit','from_warehouse','aggregate','status','from_prod_pallet','from_room','Logo.png','warehouse','add_transfer','slice','to_types','to_room_name','from_floorlevel','_id','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details','filter','DRY\x20STORAGE','type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.bin','/../public','Transfer\x20Edit\x20Successfully','/barcode_scanner3','<h2>\x20','prod_cat','English','</table>','max_per_unit','primary_unit','<hr\x20class=\x22my-3\x22>','success','password','exports','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product.from_room_name','errors','Router','<span\x20style=\x22float:\x20right;\x22>','master','from_rak','maxProducts','$product_details.batch_code','Shelves','product_stock','German','Rack\x20E','from_bin','An\x20error\x20occurred.','product_details','product_code3','get','from_prod_level','$product_details.primary_code','concat','True','to_bin','host','/CheckingWarehouse','12210646MQebLf','813GRAVXr','invoice','to_room','edit_transfer','New_Qty_Converted','<!DOCTYPE\x20html>','to_bay','/transfer/view','floorlevel','$product.to_room_name','map','product_name','findOne','English\x20(US)','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','updateOne','express','forEach','json','$product_details.rack','Spanish','2621074SjWohk','from_invoice','Hindi','rak','$name','/transfer/preview/','transfer','from_types','$room','Transfer\x20Mail','findById','23508207OpxBLa','string','production_date','bin'];a0_0xf1e2=function(){return _0xb58d86;};return a0_0xf1e2();}function BayBinSelected(_0x3c6699,_0x50037e){var _0x418864=a0_0x22fc28,_0x36c274=[],_0x425615=[],_0x434cf9=[],_0x118636=[],_0x4123d=[],_0xecff0=[];let _0x3e95c1=[];if(_0x3c6699==_0x418864(0x140))switch(_0x50037e){case _0x418864(0x1e9):_0x36c274=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x425615=[0x1,0x2],_0x118636=[0x1,0x2,0x3,0x4,0x5],_0x434cf9=[_0x418864(0x1df),_0x418864(0x203)],_0x4123d=['D'],_0xecff0=['A'];break;case _0x418864(0x1b4):_0x36c274=[0x6,0x5,0x4,0x3,0x2,0x1],_0x425615=[0x1,0x2],_0x118636=[0x1,0x2,0x3,0x4,0x5],_0x434cf9=[_0x418864(0x1df),'Floor'],_0x4123d=['D'],_0xecff0=['B'];break;case _0x418864(0x15a):_0x36c274=[0x0],_0x425615=[0x0],_0x118636=[0x1,0x2,0x3,0x4,0x5],_0x434cf9=['Floor'],_0x4123d=['D'],_0xecff0=['S'];break;case _0x418864(0x194):_0x36c274=[0x0],_0x425615=[0x0],_0x118636=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x434cf9=[_0x418864(0x203)],_0x4123d=['D'],_0xecff0=['R'];break;}else{if(_0x3c6699==_0x418864(0x1e7))switch(_0x50037e){case _0x418864(0x1e9):_0x36c274=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x425615=['B','F'],_0x118636=[0x1,0x2,0x3,0x4,0x5],_0x434cf9=['Level',_0x418864(0x203)],_0x4123d=['C'],_0xecff0=['A'];break;case _0x418864(0x1b4):_0x36c274=[0x5,0x4,0x3,0x2,0x1],_0x425615=['F','B','S'],_0x118636=[0x1,0x2,0x3,0x4,0x5],_0x434cf9=['Level',_0x418864(0x203)],_0x4123d=['C'],_0xecff0=['B'];break;case _0x418864(0x1c2):_0x36c274=[0x1,0x2,0x3,0x4,0x5],_0x425615=['B','F','S'],_0x118636=[0x5,0x4,0x3,0x2,0x1],_0x434cf9=['Level','Floor'],_0x4123d=['C'],_0xecff0=['C'];break;case _0x418864(0x202):_0x36c274=[0x5,0x4,0x3,0x2,0x1],_0x425615=['F','B','S'],_0x118636=[0x1,0x2,0x3,0x4,0x5],_0x434cf9=[_0x418864(0x1df),_0x418864(0x203)],_0x4123d=['C'],_0xecff0=['D'];break;case _0x418864(0x15d):_0x36c274=[0x4,0x3,0x2,0x1],_0x425615=[0x1,0x2],_0x118636=[0x1,0x2,0x3,0x4,0x5],_0x434cf9=['Level',_0x418864(0x203)],_0x4123d=['C'],_0xecff0=['E'];break;case _0x418864(0x1fb):_0x36c274=[0x1,0x2,0x3],_0x425615=[0x1,0x2],_0x118636=[0x1,0x2,0x3,0x4,0x5],_0x434cf9=[_0x418864(0x1df)],_0x4123d=['C'],_0xecff0=['F'];break;}}return{'levels':_0x36c274,'Isle':_0x425615,'rack':_0x118636,'type':_0x434cf9,'storage':_0x4123d,'rak':_0xecff0};}router['get'](a0_0x22fc28(0x1a0),auth,async(_0x62f59a,_0x11a7f4)=>{var _0x1b0176=a0_0x22fc28;try{const {username:_0x3ac487,email:_0x55a996,role:_0x19c7d2}=_0x62f59a[_0x1b0176(0x1cd)],_0x1c9bb9=_0x62f59a['user'],_0x1660a7=await profile[_0x1b0176(0x177)]({'email':_0x1c9bb9[_0x1b0176(0x1ec)]}),_0x2c1a27=await master_shop[_0x1b0176(0x1b6)](),_0x2f5c3a=await transfers['findById'](_0x62f59a[_0x1b0176(0x1f5)]['id']);let _0x92c1b6;if(_0x1c9bb9['role']==_0x1b0176(0x1b2)){const _0x30a846=await staff[_0x1b0176(0x177)]({'email':_0x1c9bb9[_0x1b0176(0x1ec)]});_0x92c1b6=await warehouse[_0x1b0176(0x131)]([{'$match':{'status':'Enabled','name':_0x30a846[_0x1b0176(0x136)],'warehouse_category':_0x1b0176(0x1d9)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x92c1b6=await warehouse[_0x1b0176(0x131)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x1b0176(0x184),'name':{'$first':_0x1b0176(0x184)}}}]);const _0x517f06=await warehouse[_0x1b0176(0x131)]([{'$match':{'name':_0x2f5c3a[_0x1b0176(0x130)],'warehouse_category':_0x1b0176(0x1d9)}},{'$unwind':_0x1b0176(0x13e)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1b0176(0x1b5)},'product_stock':{'$first':_0x1b0176(0x1ed)},'bay':{'$first':_0x1b0176(0x192)},'bin':{'$first':_0x1b0176(0x143)},'type':{'$first':_0x1b0176(0x191)},'floorlevel':{'$first':_0x1b0176(0x1f4)},'primary_code':{'$first':_0x1b0176(0x164)},'secondary_code':{'$first':_0x1b0176(0x1bb)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x1b0176(0x1ce)},'rack':{'$first':_0x1b0176(0x17e)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1b0176(0x121)},'room':{'$first':'$room'}}}]),_0x423c51=await product['find']({}),_0x3158ba=BayBinSelected(_0x2f5c3a[_0x1b0176(0x198)],_0x2f5c3a[_0x1b0176(0x16d)]);if(_0x2c1a27[0x0][_0x1b0176(0x1f7)]=='English\x20(US)'){var _0x7abfc7=users[_0x1b0176(0x149)];console['log'](_0x7abfc7);}else{if(_0x2c1a27[0x0][_0x1b0176(0x1f7)]==_0x1b0176(0x182))var _0x7abfc7=users['Hindi'];else{if(_0x2c1a27[0x0][_0x1b0176(0x1f7)]==_0x1b0176(0x15c))var _0x7abfc7=users[_0x1b0176(0x15c)];else{if(_0x2c1a27[0x0][_0x1b0176(0x1f7)]==_0x1b0176(0x17f))var _0x7abfc7=users[_0x1b0176(0x17f)];else{if(_0x2c1a27[0x0][_0x1b0176(0x1f7)]==_0x1b0176(0x1d1))var _0x7abfc7=users['French'];else{if(_0x2c1a27[0x0]['language']==_0x1b0176(0x1ff))var _0x7abfc7=users[_0x1b0176(0x1e6)];else{if(_0x2c1a27[0x0][_0x1b0176(0x1f7)]==_0x1b0176(0x1ac))var _0x7abfc7=users['Chinese'];else{if(_0x2c1a27[0x0][_0x1b0176(0x1f7)]=='Arabic\x20(ae)')var _0x7abfc7=users[_0x1b0176(0x208)];}}}}}}}_0x11a7f4['render'](_0x1b0176(0x16e),{'success':_0x62f59a[_0x1b0176(0x1d8)]('success'),'errors':_0x62f59a[_0x1b0176(0x1d8)](_0x1b0176(0x153)),'role':_0x1c9bb9,'profile':_0x1660a7,'master_shop':_0x2c1a27,'warehouse':_0x92c1b6,'transfer':_0x2f5c3a,'stock':_0x517f06,'unit':_0x423c51,'language':_0x7abfc7});}catch(_0x3b1c6d){console[_0x1b0176(0x20e)](_0x3b1c6d);}}),router['post'](a0_0x22fc28(0x1a0),auth,async(_0x24126d,_0x49be83)=>{var _0x5f547b=a0_0x22fc28;try{const _0x2a94e7=_0x24126d['params']['id'],_0x1dcf82=await transfers['findById'](_0x2a94e7);_0x49be83[_0x5f547b(0x17d)](_0x24126d[_0x5f547b(0x1a8)]);return;const {date:_0x4c0338,from_warehouse:_0x26ddfb,FromRoom_name:_0x3c412e,to_warehouse:_0x1f4b15,ToRoom_name:_0x340709,prod_name:_0x5af288,from_prod_qty:_0x1c6623,from_prod_level:_0x483012,from_prod_isle:_0x562ccf,from_prod_pallet:_0x149bf9,to_prod_qty:_0x1afff0,to_prod_level:_0x58b39e,to_prod_isle:_0x127c20,to_prod_pallet:_0x3839d5,primary_code:_0x35ec56,secondary_code:_0x2580ca,product_code3:_0x3becdb,note:_0x5a04ce,invoice:_0x2abd3f,expiry_date:_0x3056fc}=_0x24126d[_0x5f547b(0x1a8)];if(typeof _0x5af288==_0x5f547b(0x18c))var _0x16653c=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x11f)]],_0x12dc38=[_0x24126d[_0x5f547b(0x1a8)]['from_prod_qty']],_0x4a3cc2=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x163)]],_0x871497=[_0x24126d[_0x5f547b(0x1a8)]['from_prod_isle']],_0x102572=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x133)]],_0x65dd6f=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x187)]],_0x2651ae=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x201)]],_0x487678=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x11d)]],_0x33ff29=[_0x24126d['body']['to_prod_isle']],_0x68a382=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x1fd)]],_0x6e6e95=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x139)]],_0x3ec5e4=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x1cb)]],_0x46c91a=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x183)]],_0x1747bb=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x12c)]],_0x32b9e0=[_0x24126d['body'][_0x5f547b(0x12e)]],_0x27f61f=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x161)]],_0x3e9e87=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x190)]],_0x25c844=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x123)]],_0x100dbc=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x1c3)]],_0x1c3014=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x195)]],_0x2d31a2=[_0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x1b0)]],_0x2c8b19=[_0x24126d['body'][_0x5f547b(0x1a9)]],_0x478e86=[_0x24126d[_0x5f547b(0x1a8)]['from_rak']];else var _0x16653c=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x11f)]],_0x3ec5e4=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x1cb)]],_0x46c91a=[..._0x24126d[_0x5f547b(0x1a8)]['rak']],_0x65dd6f=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x187)]],_0x6e6e95=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x139)]],_0x12dc38=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x1eb)]],_0x4a3cc2=[..._0x24126d[_0x5f547b(0x1a8)]['from_prod_level']],_0x871497=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x128)]],_0x102572=[..._0x24126d['body'][_0x5f547b(0x133)]],_0x2651ae=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x201)]],_0x487678=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x11d)]],_0x33ff29=[..._0x24126d[_0x5f547b(0x1a8)]['to_prod_isle']],_0x68a382=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x1fd)]],_0x1747bb=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x12c)]],_0x32b9e0=[..._0x24126d[_0x5f547b(0x1a8)]['secondary_code']],_0x27f61f=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x161)]],_0x3e9e87=[..._0x24126d['body'][_0x5f547b(0x190)]],_0x25c844=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x123)]],_0x100dbc=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x1c3)]],_0x1c3014=[..._0x24126d['body']['batch_code']],_0x2d31a2=[..._0x24126d['body'][_0x5f547b(0x1b0)]],_0x2c8b19=[..._0x24126d[_0x5f547b(0x1a8)][_0x5f547b(0x1a9)]],_0x478e86=[..._0x24126d['body'][_0x5f547b(0x157)]];const _0x3713b3=_0x16653c[_0x5f547b(0x175)](_0x5a7c69=>{return _0x5a7c69={'product_name':_0x5a7c69};});_0x12dc38[_0x5f547b(0x17c)]((_0x535a6f,_0x245199)=>{var _0x1739bf=_0x5f547b;_0x3713b3[_0x245199][_0x1739bf(0x1b8)]=_0x535a6f;}),_0x4a3cc2[_0x5f547b(0x17c)]((_0x15d528,_0x259b9b)=>{var _0xd1dc9=_0x5f547b;_0x3713b3[_0x259b9b][_0xd1dc9(0x129)]=_0x15d528;}),_0x871497['forEach']((_0x41d345,_0x2e32b0)=>{var _0x2f222f=_0x5f547b;_0x3713b3[_0x2e32b0][_0x2f222f(0x15e)]=_0x41d345;}),_0x102572['forEach']((_0x4d611e,_0x2b21be)=>{_0x3713b3[_0x2b21be]['from_floorlevel']=_0x4d611e;}),_0x2651ae[_0x5f547b(0x17c)]((_0x111552,_0x18c6ac)=>{var _0x187da3=_0x5f547b;_0x3713b3[_0x18c6ac][_0x187da3(0x120)]=_0x111552;}),_0x487678['forEach']((_0x47d9dc,_0x3400a4)=>{var _0x35ddbc=_0x5f547b;_0x3713b3[_0x3400a4][_0x35ddbc(0x171)]=_0x47d9dc;}),_0x33ff29[_0x5f547b(0x17c)]((_0x2fec7a,_0x19984a)=>{_0x3713b3[_0x19984a]['to_bin']=_0x2fec7a;}),_0x68a382[_0x5f547b(0x17c)]((_0x3eea52,_0x3d0167)=>{var _0xd4c282=_0x5f547b;_0x3713b3[_0x3d0167][_0xd4c282(0x1aa)]=_0x3eea52;}),_0x1747bb['forEach']((_0x60e164,_0x3b05c8)=>{_0x3713b3[_0x3b05c8]['primary_code']=_0x60e164;}),_0x32b9e0[_0x5f547b(0x17c)]((_0x285bbc,_0x372db3)=>{_0x3713b3[_0x372db3]['secondary_code']=_0x285bbc;}),_0x27f61f['forEach']((_0x56ebd5,_0x506538)=>{var _0x16162b=_0x5f547b;_0x3713b3[_0x506538][_0x16162b(0x1bf)]=_0x56ebd5;}),_0x3e9e87[_0x5f547b(0x17c)]((_0x10e932,_0x2df6f3)=>{_0x3713b3[_0x2df6f3]['maxProducts']=_0x10e932;}),_0x25c844['forEach']((_0x208511,_0x5436a6)=>{var _0xf66fb5=_0x5f547b;_0x3713b3[_0x5436a6][_0xf66fb5(0x123)]=_0x208511;}),_0x100dbc[_0x5f547b(0x17c)]((_0x4bbaa5,_0x1d7f84)=>{var _0x36af0b=_0x5f547b;_0x3713b3[_0x1d7f84][_0x36af0b(0x1c3)]=_0x4bbaa5;}),_0x1c3014[_0x5f547b(0x17c)]((_0x48da3d,_0x10cc4e)=>{var _0x46a2b8=_0x5f547b;_0x3713b3[_0x10cc4e][_0x46a2b8(0x195)]=_0x48da3d;}),_0x2d31a2[_0x5f547b(0x17c)]((_0x228c37,_0x4c0b7f)=>{var _0x174720=_0x5f547b;_0x3713b3[_0x4c0b7f][_0x174720(0x1b0)]=_0x228c37;}),_0x3ec5e4[_0x5f547b(0x17c)]((_0x28346,_0xc196c)=>{_0x3713b3[_0xc196c]['storage']=_0x28346;}),_0x46c91a['forEach']((_0x3fcb45,_0x2f00b9)=>{_0x3713b3[_0x2f00b9]['rack']=_0x3fcb45;}),_0x65dd6f['forEach']((_0x181df7,_0x2e83fa)=>{_0x3713b3[_0x2e83fa]['from_types']=_0x181df7;}),_0x6e6e95[_0x5f547b(0x17c)]((_0x54cf4f,_0x5763ad)=>{var _0x49311e=_0x5f547b;_0x3713b3[_0x5763ad][_0x49311e(0x139)]=_0x54cf4f;}),_0x2c8b19[_0x5f547b(0x17c)]((_0x5ba3cf,_0x3c1c4e)=>{var _0x101470=_0x5f547b;_0x3713b3[_0x3c1c4e][_0x101470(0x1a9)]=_0x5ba3cf;}),_0x478e86[_0x5f547b(0x17c)]((_0x363a32,_0x5e3a0e)=>{_0x3713b3[_0x5e3a0e]['from_rack']=_0x363a32;});const _0x53580b=_0x3713b3[_0x5f547b(0x13f)](_0x3a53ef=>_0x3a53ef[_0x5f547b(0x120)]!=='0'&&_0x3a53ef['to_quantity']!==''||_0x3a53ef[_0x5f547b(0x1aa)]!=='0'&&_0x3a53ef['to_floorlevel']!=='');var _0x6cb6f3=0x0;_0x53580b[_0x5f547b(0x17c)](_0x2be9f0=>{var _0x227bc1=_0x5f547b;parseInt(_0x2be9f0[_0x227bc1(0x1b8)])<parseInt(_0x2be9f0[_0x227bc1(0x120)])&&_0x6cb6f3++;});if(_0x6cb6f3!=0x0)return _0x24126d[_0x5f547b(0x1d8)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x49be83['redirect'](_0x5f547b(0x1d0));const _0xbbfc9e=await warehouse[_0x5f547b(0x177)]({'name':_0x1dcf82['from_warehouse'],'room':_0x1dcf82[_0x5f547b(0x134)]});_0x1dcf82['product'][_0x5f547b(0x17c)](_0x2f2c09=>{var _0x267c91=_0x5f547b;if(_0x2f2c09['to_quantity']>0x0){const _0x22e99c=_0xbbfc9e[_0x267c91(0x160)]['map'](_0x5e5115=>{var _0x13d2bd=_0x267c91;_0x5e5115['product_name']==_0x2f2c09[_0x13d2bd(0x176)]&&_0x5e5115['floorlevel']==_0x2f2c09[_0x13d2bd(0x13b)]&&_0x5e5115['type']==_0x2f2c09[_0x13d2bd(0x187)]&&_0x5e5115[_0x13d2bd(0x18e)]==_0x2f2c09[_0x13d2bd(0x15e)]&&_0x5e5115[_0x13d2bd(0x1b1)]==_0x2f2c09[_0x13d2bd(0x129)]&&_0x5e5115[_0x13d2bd(0x1c1)]==_0x2f2c09[_0x13d2bd(0x206)]&&_0x5e5115[_0x13d2bd(0x1cb)]==_0x2f2c09['from_storage']&&(_0x5e5115[_0x13d2bd(0x15b)]=parseInt(_0x5e5115[_0x13d2bd(0x15b)])+parseInt(_0x2f2c09['to_quantity']));});}}),await _0xbbfc9e[_0x5f547b(0x1a7)]();const _0x25979c=await warehouse[_0x5f547b(0x177)]({'name':_0x1dcf82['to_warehouse'],'room':_0x1dcf82[_0x5f547b(0x16d)]});_0x1dcf82[_0x5f547b(0x1a1)][_0x5f547b(0x17c)](_0x42c087=>{var _0x658938=_0x5f547b;if(_0x42c087[_0x658938(0x120)]>0x0){const _0x80b87b=_0x25979c[_0x658938(0x160)][_0x658938(0x175)](_0x3be412=>{var _0x21a0c8=_0x658938;_0x3be412[_0x21a0c8(0x176)]==_0x42c087[_0x21a0c8(0x176)]&&_0x3be412['floorlevel']==_0x42c087['to_floorlevel']&&_0x3be412['type']==_0x42c087[_0x21a0c8(0x139)]&&_0x3be412[_0x21a0c8(0x18e)]==_0x42c087[_0x21a0c8(0x167)]&&_0x3be412['bay']==_0x42c087[_0x21a0c8(0x171)]&&_0x3be412[_0x21a0c8(0x1c1)]==_0x42c087['rack']&&_0x3be412[_0x21a0c8(0x1cb)]==_0x42c087[_0x21a0c8(0x1cb)]&&(_0x3be412[_0x21a0c8(0x15b)]=parseInt(_0x3be412[_0x21a0c8(0x15b)])-parseInt(_0x42c087['to_quantity']));});}}),await _0x25979c['save'](),_0x1dcf82[_0x5f547b(0x1a2)]=_0x4c0338,_0x1dcf82[_0x5f547b(0x130)]=_0x26ddfb,_0x1dcf82[_0x5f547b(0x198)]=_0x1f4b15,_0x1dcf82[_0x5f547b(0x1a1)]=_0x53580b,_0x1dcf82[_0x5f547b(0x122)]=_0x5a04ce,_0x1dcf82[_0x5f547b(0x16c)]=_0x2abd3f;const _0x106173=await _0x1dcf82['save']();console[_0x5f547b(0x20e)](_0x106173);const _0x56f350=await warehouse[_0x5f547b(0x177)]({'name':_0x26ddfb,'room':_0x3c412e});_0x106173['product'][_0x5f547b(0x17c)](_0x15cb22=>{var _0x4f2f7b=_0x5f547b;if(_0x15cb22[_0x4f2f7b(0x120)]>0x0){const _0x3dd7a4=_0x56f350[_0x4f2f7b(0x160)][_0x4f2f7b(0x175)](_0x185a42=>{var _0x552cfb=_0x4f2f7b;_0x185a42[_0x552cfb(0x176)]==_0x15cb22[_0x552cfb(0x176)]&&_0x185a42[_0x552cfb(0x173)]==_0x15cb22[_0x552cfb(0x13b)]&&_0x185a42['type']==_0x15cb22[_0x552cfb(0x187)]&&_0x185a42[_0x552cfb(0x18e)]==_0x15cb22['from_bin']&&_0x185a42[_0x552cfb(0x1b1)]==_0x15cb22[_0x552cfb(0x129)]&&_0x185a42[_0x552cfb(0x1c1)]==_0x15cb22['from_rack']&&_0x185a42[_0x552cfb(0x1cb)]==_0x15cb22[_0x552cfb(0x1a9)]&&(_0x185a42['product_stock']=parseInt(_0x185a42[_0x552cfb(0x15b)])-parseInt(_0x15cb22['to_quantity']));});}}),await _0x56f350['save']();const _0x291c58=await warehouse['findOne']({'name':_0x1f4b15,'room':_0x340709});_0x106173[_0x5f547b(0x1a1)][_0x5f547b(0x17c)](_0x135ff0=>{var _0x2176b0=_0x5f547b;if(_0x135ff0[_0x2176b0(0x120)]>0x0){var _0x30c8b1=0x0;const _0x5ece64=_0x291c58[_0x2176b0(0x160)][_0x2176b0(0x175)](_0x311c46=>{var _0xdd15d7=_0x2176b0;_0x311c46[_0xdd15d7(0x176)]==_0x135ff0[_0xdd15d7(0x176)]&&_0x311c46[_0xdd15d7(0x173)]==_0x135ff0[_0xdd15d7(0x1aa)]&&_0x311c46[_0xdd15d7(0x141)]==_0x135ff0[_0xdd15d7(0x139)]&&_0x311c46[_0xdd15d7(0x18e)]==_0x135ff0[_0xdd15d7(0x167)]&&_0x311c46[_0xdd15d7(0x1b1)]==_0x135ff0[_0xdd15d7(0x171)]&&_0x311c46[_0xdd15d7(0x1c1)]==_0x135ff0[_0xdd15d7(0x1c1)]&&_0x311c46[_0xdd15d7(0x1cb)]==_0x135ff0[_0xdd15d7(0x1cb)]&&(_0x311c46[_0xdd15d7(0x15b)]=parseInt(_0x311c46[_0xdd15d7(0x15b)])+parseInt(_0x135ff0['to_quantity']),_0x30c8b1++);});_0x30c8b1=='0'&&(_0x291c58[_0x2176b0(0x160)]=_0x291c58[_0x2176b0(0x160)][_0x2176b0(0x165)]({'product_name':_0x135ff0[_0x2176b0(0x176)],'product_stock':_0x135ff0[_0x2176b0(0x120)],'bay':_0x135ff0[_0x2176b0(0x171)],'bin':_0x135ff0[_0x2176b0(0x167)],'type':_0x135ff0[_0x2176b0(0x139)],'floorlevel':_0x135ff0[_0x2176b0(0x1aa)],'storage':_0x135ff0[_0x2176b0(0x1cb)],'rack':_0x135ff0['rack'],'product_code':_0x135ff0[_0x2176b0(0x1bf)],'primary_code':_0x135ff0['primary_code'],'secondary_code':_0x135ff0[_0x2176b0(0x12e)],'maxProducts':_0x135ff0[_0x2176b0(0x158)],'storage':_0x135ff0[_0x2176b0(0x1cb)],'rack':_0x135ff0['rack']}));}}),await _0x291c58[_0x5f547b(0x1a7)](),_0x24126d[_0x5f547b(0x1d8)](_0x5f547b(0x14e),_0x5f547b(0x145)),_0x49be83[_0x5f547b(0x124)](_0x5f547b(0x172));}catch(_0x36b16a){console['log'](_0x36b16a);}}),router['post']('/barcode_scanner',async(_0xe665ff,_0x2b2214)=>{var _0x394fbf=a0_0x22fc28;const {FromWareHouse:_0x540389,FromRoom:_0xe56461,ToWarehouse:_0x387f0f,ToRoom:_0x4f61c4,primary_code:_0x1e302c,Roomslist:_0x297bb8}=_0xe665ff[_0x394fbf(0x1a8)],_0x335a6b=_0x297bb8[_0x394fbf(0x19b)](','),_0x42a70e=[];async function _0x22ccb7(_0xf99ad1){var _0xf07b2=_0x394fbf;const _0x282bc7=await warehouse[_0xf07b2(0x131)]([{'$match':{'name':_0x540389,'room':_0xf99ad1}},{'$unwind':_0xf07b2(0x13e)},{'$match':{'product_details.primary_code':_0x1e302c}},{'$group':{'_id':_0xf07b2(0x1fe),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0xf07b2(0x1ed)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xf07b2(0x1bb)},'product_code':{'$first':_0xf07b2(0x1dc)},'level':{'$first':_0xf07b2(0x192)},'isle':{'$first':_0xf07b2(0x143)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0xf07b2(0x1f4)},'unit':{'$first':_0xf07b2(0x12d)},'secondary_unit':{'$first':_0xf07b2(0x12f)},'storage':{'$first':_0xf07b2(0x1ce)},'rack':{'$first':_0xf07b2(0x17e)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xf07b2(0x121)},'batch_code':{'$first':_0xf07b2(0x159)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0xf07b2(0x188)},'maxProducts':{'$first':_0xf07b2(0x1d2)},'invoice_product':{'$first':_0xf07b2(0x1bc)}}}]),_0x3254ac=await warehouse[_0xf07b2(0x131)]([{'$match':{'name':_0x540389,'room':_0xf99ad1}},{'$unwind':_0xf07b2(0x13e)},{'$match':{'product_details.secondary_code':_0x1e302c}},{'$group':{'_id':_0xf07b2(0x1fe),'name':{'$first':_0xf07b2(0x1b5)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xf07b2(0x1dc)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0xf07b2(0x143)},'type':{'$first':_0xf07b2(0x191)},'pallet':{'$first':_0xf07b2(0x1f4)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xf07b2(0x12f)},'storage':{'$first':_0xf07b2(0x1ce)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xf07b2(0x207)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0xf07b2(0x1d5)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0xf07b2(0x1d2)},'invoice_product':{'$first':_0xf07b2(0x1bc)}}}]);if(_0x282bc7['length']>0x0)_0x42a70e[_0xf07b2(0x12a)](_0x282bc7);else _0x3254ac[_0xf07b2(0x12b)]>0x0&&_0x42a70e[_0xf07b2(0x12a)](_0x3254ac);}const _0x35a32e=_0x335a6b[_0x394fbf(0x175)](_0x5e51ee=>_0x22ccb7(_0x5e51ee));await Promise[_0x394fbf(0x212)](_0x35a32e),_0x2b2214[_0x394fbf(0x17d)](_0x42a70e);}),router[a0_0x22fc28(0x209)]('/barcode_scanner2',async(_0x459991,_0x15277e)=>{var _0x15b347=a0_0x22fc28;try{const {FromWareHouse:_0x35537d,FromRoom:_0x319cb2,ToWarehouse:_0x12f8d7,ToRoom:_0x1e7e93,secondary_code:_0x3b1cad}=_0x459991[_0x15b347(0x1a8)],_0x5d5ae2=await warehouse[_0x15b347(0x131)]([{'$match':{'name':_0x35537d}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3b1cad}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x15b347(0x164)},'secondary_code':{'$first':_0x15b347(0x1bb)},'product_code':{'$first':_0x15b347(0x1dc)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x15b347(0x184)},'level':{'$first':_0x15b347(0x211)},'isle':{'$first':_0x15b347(0x1e4)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x15b347(0x1d2)},'unit':{'$first':_0x15b347(0x12d)}}}]);_0x15277e[_0x15b347(0x132)](0xc8)[_0x15b347(0x17d)](_0x5d5ae2);}catch(_0x2262b6){_0x15277e[_0x15b347(0x132)](0x194)[_0x15b347(0x17d)]({'message':_0x2262b6[_0x15b347(0x1b9)]});}}),router[a0_0x22fc28(0x209)](a0_0x22fc28(0x146),async(_0x2828de,_0x1eb06d)=>{var _0x321d99=a0_0x22fc28;try{const {FromWareHouse:_0xb5580f,FromRoom:_0x576350,ToWarehouse:_0xc095f2,ToRoom:_0x38ca58,product_code:_0x1ea1d9}=_0x2828de[_0x321d99(0x1a8)],_0xec34b8=await warehouse['aggregate']([{'$match':{'name':_0xb5580f}},{'$unwind':_0x321d99(0x13e)},{'$match':{'product_details.product_code':_0x1ea1d9}},{'$group':{'_id':_0x321d99(0x1fe),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x321d99(0x164)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x321d99(0x1ed)},'warehouse':{'$first':_0x321d99(0x184)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x321d99(0x1e4)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x321d99(0x1d2)},'unit':{'$first':_0x321d99(0x12d)}}}]);_0x1eb06d['status'](0xc8)['json'](_0xec34b8);}catch(_0x247fe0){_0x1eb06d[_0x321d99(0x132)](0x194)[_0x321d99(0x17d)]({'message':_0x247fe0[_0x321d99(0x1b9)]});}}),router[a0_0x22fc28(0x209)](a0_0x22fc28(0x169),async(_0x1c0951,_0x3a7ffa)=>{var _0x44e1d2=a0_0x22fc28;const {level:_0x2b9551,isle:_0x33b076,pallet:_0x106569,warehouses:_0x4ef983,room:_0x4be4ee}=_0x1c0951[_0x44e1d2(0x1a8)];try{const _0x6fd1c0=await warehouse[_0x44e1d2(0x131)]([{'$match':{'name':_0x4ef983,'room':_0x4be4ee}},{'$unwind':_0x44e1d2(0x13e)},{'$match':{'product_details.level':parseInt(_0x2b9551),'product_details.isle':_0x33b076,'product_details.pallet':parseInt(_0x106569)}},{'$group':{'_id':_0x44e1d2(0x1fe),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x44e1d2(0x1ed)},'level':{'$first':_0x44e1d2(0x211)},'isle':{'$first':_0x44e1d2(0x1e4)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x44e1d2(0x1d2)}}}]);_0x3a7ffa[_0x44e1d2(0x132)](0xc8)[_0x44e1d2(0x17d)](_0x6fd1c0);}catch(_0x2f80d5){_0x3a7ffa[_0x44e1d2(0x132)](0x194)[_0x44e1d2(0x17d)]({'message':_0x2f80d5[_0x44e1d2(0x1b9)]});}}),module[a0_0x22fc28(0x150)]=router;