var a0_0x5ee381=a0_0x504c;(function(_0x53b1d0,_0x5b095c){var _0x3d1822=a0_0x504c,_0x475bf3=_0x53b1d0();while(!![]){try{var _0x6df3c2=-parseInt(_0x3d1822(0x168))/0x1*(parseInt(_0x3d1822(0x1dc))/0x2)+-parseInt(_0x3d1822(0x174))/0x3+parseInt(_0x3d1822(0x1fb))/0x4*(-parseInt(_0x3d1822(0x1c7))/0x5)+parseInt(_0x3d1822(0x169))/0x6+-parseInt(_0x3d1822(0x1e4))/0x7+-parseInt(_0x3d1822(0x1b3))/0x8*(parseInt(_0x3d1822(0x1ab))/0x9)+parseInt(_0x3d1822(0x158))/0xa;if(_0x6df3c2===_0x5b095c)break;else _0x475bf3['push'](_0x475bf3['shift']());}catch(_0x2af2bb){_0x475bf3['push'](_0x475bf3['shift']());}}}(a0_0x162a,0x4114d));const express=require(a0_0x5ee381(0x216)),app=express(),router=express[a0_0x5ee381(0x13b)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x5ee381(0x1be)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x5ee381(0x19c));function a0_0x504c(_0x54979c,_0x2abaef){var _0x162a57=a0_0x162a();return a0_0x504c=function(_0x504c46,_0x11f220){_0x504c46=_0x504c46-0x130;var _0x2512f9=_0x162a57[_0x504c46];return _0x2512f9;},a0_0x504c(_0x54979c,_0x2abaef);}router['get']('/view',auth,async(_0x59aaf0,_0x535d3b)=>{var _0x39d33d=a0_0x5ee381;try{const {username:_0x3665ce,email:_0x1d5237,role:_0x181ead}=_0x59aaf0[_0x39d33d(0x157)],_0x215c5a=_0x59aaf0['user'],_0x220b0b=await profile[_0x39d33d(0x1ad)]({'email':_0x215c5a[_0x39d33d(0x16d)]}),_0x2b8235=await master_shop[_0x39d33d(0x1cd)]();console[_0x39d33d(0x15c)]('master',_0x2b8235);let _0x589243;if(_0x215c5a[_0x39d33d(0x1aa)]==_0x39d33d(0x130)){const _0x319476=await staff[_0x39d33d(0x1ad)]({'email':_0x215c5a['email']});_0x589243=await transfers[_0x39d33d(0x1cd)]({'from_warehouse':_0x319476[_0x39d33d(0x135)]});}else _0x589243=await transfers[_0x39d33d(0x1b5)]([{'$unwind':_0x39d33d(0x171)},{'$group':{'_id':_0x39d33d(0x20a),'invoice':{'$first':_0x39d33d(0x141)},'date':{'$first':_0x39d33d(0x139)},'from_warehouse':{'$first':_0x39d33d(0x181)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x39d33d(0x1ce)},'isAllowEdit':{'$first':_0x39d33d(0x1af)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2b8235[0x0]['language']=='English\x20(US)'){var _0x33faa9=users['English'];console[_0x39d33d(0x15c)](_0x33faa9);}else{if(_0x2b8235[0x0][_0x39d33d(0x137)]==_0x39d33d(0x1a9))var _0x33faa9=users['Hindi'];else{if(_0x2b8235[0x0][_0x39d33d(0x137)]==_0x39d33d(0x18d))var _0x33faa9=users[_0x39d33d(0x18d)];else{if(_0x2b8235[0x0][_0x39d33d(0x137)]==_0x39d33d(0x144))var _0x33faa9=users[_0x39d33d(0x144)];else{if(_0x2b8235[0x0][_0x39d33d(0x137)]==_0x39d33d(0x13c))var _0x33faa9=users[_0x39d33d(0x13c)];else{if(_0x2b8235[0x0]['language']==_0x39d33d(0x1d3))var _0x33faa9=users[_0x39d33d(0x138)];else{if(_0x2b8235[0x0][_0x39d33d(0x137)]==_0x39d33d(0x193))var _0x33faa9=users[_0x39d33d(0x193)];else{if(_0x2b8235[0x0]['language']==_0x39d33d(0x1a2))var _0x33faa9=users['Arabic'];}}}}}}}_0x535d3b[_0x39d33d(0x220)]('transfer',{'success':_0x59aaf0[_0x39d33d(0x160)](_0x39d33d(0x21c)),'errors':_0x59aaf0['flash'](_0x39d33d(0x1d9)),'role':_0x215c5a,'profile':_0x220b0b,'master_shop':_0x2b8235,'transfer':_0x589243,'language':_0x33faa9});}catch(_0x4f0d09){console[_0x39d33d(0x15c)](_0x4f0d09);}});async function getRandom8DigitNumber(){var _0x4fe6d1=a0_0x5ee381;const _0x2234a4=0x989680,_0x44bd88=0x5f5e0ff,_0x262879=Math[_0x4fe6d1(0x1f4)](Math[_0x4fe6d1(0x200)]()*(_0x44bd88-_0x2234a4+0x1))+_0x2234a4;var _0x2d17e4;const _0x51ab46=await transfers[_0x4fe6d1(0x1ad)]({'invoice':_0x4fe6d1(0x16e)+_0x262879});return _0x51ab46&&_0x51ab46['length']>0x0?_0x2d17e4=_0x4fe6d1(0x16e)+_0x262879:_0x2d17e4=_0x4fe6d1(0x16e)+_0x262879,_0x2d17e4;}router[a0_0x5ee381(0x1ea)](a0_0x5ee381(0x179),auth,async(_0x2eac02,_0x2859bc)=>{var _0x365c10=a0_0x5ee381;try{const {username:_0x274afe,email:_0x1004ba,role:_0x1c6a29}=_0x2eac02['user'],_0x5bb92a=_0x2eac02[_0x365c10(0x157)],_0x2be887=await profile['findOne']({'email':_0x5bb92a['email']}),_0x271c4b=await master_shop[_0x365c10(0x1cd)]();console[_0x365c10(0x15c)](_0x365c10(0x1c4),_0x271c4b);let _0x33d842;if(_0x5bb92a[_0x365c10(0x1aa)]=='staff'){const _0x9ee6ba=await staff['findOne']({'email':_0x5bb92a['email']});_0x33d842=await warehouse[_0x365c10(0x1b5)]([{'$match':{'status':_0x365c10(0x219),'name':_0x9ee6ba[_0x365c10(0x135)],'warehouse_category':_0x365c10(0x187)}},{'$group':{'_id':_0x365c10(0x146),'name':{'$first':_0x365c10(0x146)}}}]);}else _0x33d842=await warehouse[_0x365c10(0x1b5)]([{'$match':{'status':'Enabled','warehouse_category':_0x365c10(0x187)}},{'$group':{'_id':_0x365c10(0x146),'name':{'$first':'$name'}}}]);var _0x465fb6=[_0x365c10(0x13a),_0x365c10(0x17a),_0x365c10(0x215)];const _0x2f2096=await transfers[_0x365c10(0x1cd)]({}),_0x1efd70=_0x2f2096[_0x365c10(0x1e5)]+0x1,_0x4e7549='TRF-'+_0x1efd70[_0x365c10(0x17c)]()[_0x365c10(0x1dd)](0x5,'0');if(_0x271c4b[0x0][_0x365c10(0x137)]==_0x365c10(0x1fd)){var _0x17ee4f=users[_0x365c10(0x186)];console['log'](_0x17ee4f);}else{if(_0x271c4b[0x0][_0x365c10(0x137)]==_0x365c10(0x1a9))var _0x17ee4f=users[_0x365c10(0x1a9)];else{if(_0x271c4b[0x0][_0x365c10(0x137)]==_0x365c10(0x18d))var _0x17ee4f=users[_0x365c10(0x18d)];else{if(_0x271c4b[0x0][_0x365c10(0x137)]==_0x365c10(0x144))var _0x17ee4f=users['Spanish'];else{if(_0x271c4b[0x0][_0x365c10(0x137)]==_0x365c10(0x13c))var _0x17ee4f=users[_0x365c10(0x13c)];else{if(_0x271c4b[0x0]['language']==_0x365c10(0x1d3))var _0x17ee4f=users[_0x365c10(0x138)];else{if(_0x271c4b[0x0][_0x365c10(0x137)]=='Chinese')var _0x17ee4f=users[_0x365c10(0x193)];else{if(_0x271c4b[0x0][_0x365c10(0x137)]==_0x365c10(0x1a2))var _0x17ee4f=users[_0x365c10(0x1df)];}}}}}}}const _0x28f00b=getRandom8DigitNumber();_0x28f00b['then'](_0x5c50bf=>{var _0x21b04f=_0x365c10;_0x2859bc[_0x21b04f(0x220)](_0x21b04f(0x1cf),{'success':_0x2eac02[_0x21b04f(0x160)]('success'),'errors':_0x2eac02[_0x21b04f(0x160)](_0x21b04f(0x1d9)),'role':_0x5bb92a,'profile':_0x2be887,'master_shop':_0x271c4b,'warehouse':_0x33d842,'language':_0x17ee4f,'rooms_data':_0x465fb6,'invoice':_0x5c50bf});})[_0x365c10(0x15f)](_0x25bf5e=>{var _0x412a83=_0x365c10;_0x2eac02[_0x412a83(0x160)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2859bc[_0x412a83(0x1f6)](_0x412a83(0x18c));});}catch(_0xf6a73b){console['log'](_0xf6a73b);}}),router[a0_0x5ee381(0x15e)]('/view/add_transfer',auth,async(_0x2e0049,_0x29b46d)=>{var _0x5bda35=a0_0x5ee381;try{console['log'](_0x2e0049[_0x5bda35(0x17f)]);const {date:_0x5e3b62,from_warehouse:_0x5d873e,FromRoom_name:_0x5de85a,to_warehouse:_0x56d91a,ToRoom_name:_0x32da27,prod_name:_0x43bb31,from_prod_qty:_0x444963,from_prod_level:_0xa35115,from_prod_isle:_0x798138,from_prod_pallet:_0x3e9e72,to_prod_qty:_0x55daf4,to_prod_level:_0xc09265,to_prod_isle:_0x5e9b6d,to_prod_pallet:_0x295bb6,primary_code:_0x2550c8,secondary_code:_0x5043ea,product_code3:_0x53e41b,note:_0x2af0ec,MaxStocks_data2:_0xb1bbde,invoice:_0x530218,expiry_date:_0x153d7a}=_0x2e0049[_0x5bda35(0x17f)];if(typeof _0x43bb31==_0x5bda35(0x156))var _0x46430a=[_0x2e0049[_0x5bda35(0x17f)]['prod_name']],_0x1c227c=[_0x2e0049['body'][_0x5bda35(0x147)]],_0x33cc9a=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x188)]],_0x280e30=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x182)]],_0x5b810d=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x194)]],_0x3f5f34=[_0x2e0049[_0x5bda35(0x17f)]['primary_code']],_0x570658=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x178)]],_0x1763c7=[_0x2e0049['body'][_0x5bda35(0x140)]],_0x5ad137=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x202)]],_0x5e3485=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1c2)]],_0x34e868=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x153)]],_0x38aa64=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x192)]],_0x124b54=[_0x2e0049['body'][_0x5bda35(0x1f5)]],_0x27ea58=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x161)]],_0x2ded32=[_0x2e0049[_0x5bda35(0x17f)]['production_date']],_0x5a4d93=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x21a)]],_0x5ea5ed=[_0x2e0049['body'][_0x5bda35(0x1c8)]],_0x1623c0=[_0x2e0049[_0x5bda35(0x17f)]['ToRoomAssigned']],_0x23f398=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1f8)]],_0x3cd912=[_0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1a4)]],_0x4ed144=[_0x2e0049[_0x5bda35(0x17f)]['id_transaction']];else var _0x46430a=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x204)]],_0x1c227c=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x147)]],_0x33cc9a=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x188)]],_0x280e30=[..._0x2e0049[_0x5bda35(0x17f)]['New_Qty_Converted']],_0x5b810d=[..._0x2e0049['body']['to_prod_level']],_0x3f5f34=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1f9)]],_0x570658=[..._0x2e0049['body'][_0x5bda35(0x178)]],_0x1763c7=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x140)]],_0x5ad137=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x202)]],_0x5e3485=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1c2)]],_0x34e868=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x153)]],_0x38aa64=[..._0x2e0049[_0x5bda35(0x17f)]['batch_code']],_0x124b54=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1f5)]],_0x27ea58=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x161)]],_0x2ded32=[..._0x2e0049[_0x5bda35(0x17f)]['production_date']],_0x5a4d93=[..._0x2e0049['body']['prod_cat']],_0x5ea5ed=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1c8)]],_0x1623c0=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1db)]],_0x23f398=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1f8)]],_0x3cd912=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x1a4)]],_0x4ed144=[..._0x2e0049[_0x5bda35(0x17f)][_0x5bda35(0x184)]];const _0x166266=_0x46430a[_0x5bda35(0x1ef)](_0x28ef37=>{return _0x28ef37={'product_name':_0x28ef37};});_0x1c227c['forEach']((_0x5679ee,_0x226e9f)=>{_0x166266[_0x226e9f]['from_quantity']=_0x5679ee;}),_0x23f398[_0x5bda35(0x1f1)]((_0x253e17,_0x5ec2e8)=>{var _0x48c30e=_0x5bda35;_0x166266[_0x5ec2e8][_0x48c30e(0x1f8)]=_0x253e17;}),_0x3cd912[_0x5bda35(0x1f1)]((_0x35af7e,_0x57dd28)=>{var _0x45effd=_0x5bda35;_0x166266[_0x57dd28][_0x45effd(0x198)]=_0x35af7e;}),_0x4ed144[_0x5bda35(0x1f1)]((_0x1e1c0a,_0x4fb4bb)=>{var _0x221dba=_0x5bda35;_0x166266[_0x4fb4bb][_0x221dba(0x1c1)]=_0x1e1c0a;}),_0x33cc9a[_0x5bda35(0x1f1)]((_0x29763f,_0x2861af)=>{var _0xa51fda=_0x5bda35;_0x5ea5ed[_0xa51fda(0x1f1)]((_0x4b5c4b,_0x5778fa)=>{var _0x43d67a=_0xa51fda;if(_0x4b5c4b==_0x43d67a(0x177)&&_0x2861af==_0x5778fa){var _0x4f4158=_0x29763f[_0x43d67a(0x142)](0x3);_0x166266[_0x2861af]['from_storage']=_0x29763f[0x0],_0x166266[_0x2861af][_0x43d67a(0x1ca)]=_0x29763f[0x1],_0x166266[_0x2861af]['from_bay']=0x0,_0x166266[_0x2861af][_0x43d67a(0x16b)]=0x0,_0x166266[_0x2861af]['from_types']=_0x43d67a(0x154),_0x166266[_0x2861af][_0x43d67a(0x210)]=_0x4f4158;}else{if(_0x4b5c4b==_0x43d67a(0x1fc)&&_0x2861af==_0x5778fa){var _0x4f4158=_0x29763f[_0x43d67a(0x142)](0x3);_0x166266[_0x2861af][_0x43d67a(0x1e8)]=_0x29763f[0x0],_0x166266[_0x2861af][_0x43d67a(0x1ca)]=_0x29763f[0x1],_0x166266[_0x2861af][_0x43d67a(0x15d)]=0x0,_0x166266[_0x2861af][_0x43d67a(0x16b)]=0x0,_0x166266[_0x2861af][_0x43d67a(0x213)]='Floor',_0x166266[_0x2861af][_0x43d67a(0x210)]=_0x29763f[0x5];}else{if(_0x2861af==_0x5778fa){if(_0x29763f[0x0]=='A'&&_0x29763f[0x1]=='L'&&_0x29763f[0x2]=='L')console['log'](_0x4b5c4b+_0x43d67a(0x20e)+_0x2861af+'\x20<>\x20'+_0x5778fa+_0x43d67a(0x20e)+_0x29763f+_0x43d67a(0x175)),_0x166266[_0x2861af][_0x43d67a(0x1e8)]=_0x29763f[0x0],_0x166266[_0x2861af]['from_rack']=_0x29763f[0x1],_0x166266[_0x2861af][_0x43d67a(0x15d)]=0x0,_0x166266[_0x2861af][_0x43d67a(0x16b)]=0x0,_0x166266[_0x2861af][_0x43d67a(0x213)]=_0x43d67a(0x154),_0x166266[_0x2861af][_0x43d67a(0x210)]=_0x29763f[0x3];else{var _0x4fd56b;if(_0x29763f[0x4]=='L')_0x4fd56b=_0x43d67a(0x14f);else _0x29763f[0x4]=='F'&&(_0x4fd56b=_0x43d67a(0x154));_0x166266[_0x2861af][_0x43d67a(0x1e8)]=_0x29763f[0x0],_0x166266[_0x2861af][_0x43d67a(0x1ca)]=_0x29763f[0x1],_0x166266[_0x2861af][_0x43d67a(0x15d)]=_0x29763f[0x2],_0x166266[_0x2861af][_0x43d67a(0x16b)]=_0x29763f[0x3],_0x166266[_0x2861af][_0x43d67a(0x213)]=_0x4fd56b,_0x166266[_0x2861af]['from_floorlevel']=_0x29763f[0x5];}}}}});}),_0x280e30['forEach']((_0x342159,_0x22fe63)=>{_0x166266[_0x22fe63]['to_quantity']=_0x342159;}),_0x5b810d[_0x5bda35(0x1f1)]((_0x2ea98d,_0x3500a9)=>{var _0x11f4bc=_0x5bda35;_0x1623c0[_0x11f4bc(0x1f1)]((_0x40e023,_0x2fd945)=>{var _0x1b08cb=_0x11f4bc;if(_0x40e023==_0x1b08cb(0x177)&&_0x3500a9==_0x2fd945){var _0x2abeb0=_0x2ea98d[_0x1b08cb(0x142)](0x3);_0x166266[_0x3500a9][_0x1b08cb(0x1e6)]=_0x2ea98d[0x0],_0x166266[_0x3500a9][_0x1b08cb(0x1eb)]=_0x2ea98d[0x1],_0x166266[_0x3500a9]['to_bay']=0x0,_0x166266[_0x3500a9][_0x1b08cb(0x20c)]=0x0,_0x166266[_0x3500a9][_0x1b08cb(0x133)]=_0x1b08cb(0x154),_0x166266[_0x3500a9][_0x1b08cb(0x1c9)]=_0x2abeb0;}else{if(_0x40e023==_0x1b08cb(0x1fc)&&_0x3500a9==_0x2fd945){var _0x2abeb0=_0x2ea98d[_0x1b08cb(0x142)](0x3);_0x166266[_0x3500a9][_0x1b08cb(0x1e6)]=_0x2ea98d[0x0],_0x166266[_0x3500a9][_0x1b08cb(0x1eb)]=_0x2ea98d[0x1],_0x166266[_0x3500a9][_0x1b08cb(0x1d4)]=0x0,_0x166266[_0x3500a9][_0x1b08cb(0x20c)]=0x0,_0x166266[_0x3500a9][_0x1b08cb(0x133)]=_0x1b08cb(0x154),_0x166266[_0x3500a9][_0x1b08cb(0x1c9)]=_0x2ea98d[0x5];}else{if(_0x3500a9==_0x2fd945){if(_0x2ea98d[0x0]=='A'&&_0x2ea98d[0x1]=='L'&&_0x2ea98d[0x2]=='L')console[_0x1b08cb(0x15c)](_0x40e023+_0x1b08cb(0x20e)+_0x3500a9+'\x20<>\x20'+_0x2fd945+'\x20<>\x20'+_0x2ea98d+_0x1b08cb(0x175)),_0x166266[_0x3500a9][_0x1b08cb(0x1e6)]=_0x2ea98d[0x0],_0x166266[_0x3500a9][_0x1b08cb(0x1eb)]=_0x2ea98d[0x1],_0x166266[_0x3500a9][_0x1b08cb(0x1d4)]=0x0,_0x166266[_0x3500a9][_0x1b08cb(0x20c)]=0x0,_0x166266[_0x3500a9]['to_types']=_0x1b08cb(0x154),_0x166266[_0x3500a9][_0x1b08cb(0x1c9)]=_0x2ea98d[0x3];else{var _0x49ccc7;if(_0x2ea98d[0x4]=='L')_0x49ccc7=_0x1b08cb(0x14f);else _0x2ea98d[0x4]=='F'&&(_0x49ccc7=_0x1b08cb(0x154));_0x166266[_0x3500a9][_0x1b08cb(0x1e6)]=_0x2ea98d[0x0],_0x166266[_0x3500a9]['rack']=_0x2ea98d[0x1],_0x166266[_0x3500a9]['to_bay']=_0x2ea98d[0x2],_0x166266[_0x3500a9][_0x1b08cb(0x20c)]=_0x2ea98d[0x3],_0x166266[_0x3500a9][_0x1b08cb(0x133)]=_0x49ccc7,_0x166266[_0x3500a9][_0x1b08cb(0x1c9)]=_0x2ea98d[0x5];}}}}});}),_0x3f5f34['forEach']((_0x6151e9,_0x20eb05)=>{var _0x54dd88=_0x5bda35;_0x166266[_0x20eb05][_0x54dd88(0x1f9)]=_0x6151e9;}),_0x570658[_0x5bda35(0x1f1)]((_0x3c157d,_0x1a3f04)=>{var _0x41473a=_0x5bda35;_0x166266[_0x1a3f04][_0x41473a(0x178)]=_0x3c157d;}),_0x1763c7['forEach']((_0x4ef9fc,_0x30129f)=>{_0x166266[_0x30129f]['product_code']=_0x4ef9fc;}),_0x5ad137[_0x5bda35(0x1f1)]((_0x4f369b,_0x56a80e)=>{var _0x1e25eb=_0x5bda35;_0x166266[_0x56a80e][_0x1e25eb(0x1bb)]=_0x4f369b;}),_0x5e3485['forEach']((_0x58b05e,_0x26b6d7)=>{var _0x3eeffc=_0x5bda35;_0x166266[_0x26b6d7][_0x3eeffc(0x207)]=_0x58b05e;}),_0x34e868['forEach']((_0x583552,_0x30a0bf)=>{var _0x55c551=_0x5bda35;_0x166266[_0x30a0bf][_0x55c551(0x153)]=_0x583552;}),_0x38aa64[_0x5bda35(0x1f1)]((_0x4c692f,_0x3c19e5)=>{_0x166266[_0x3c19e5]['batch_code']=_0x4c692f;}),_0x124b54[_0x5bda35(0x1f1)]((_0x52c425,_0x146060)=>{var _0x1bca37=_0x5bda35;_0x166266[_0x146060][_0x1bca37(0x1f5)]=_0x52c425;}),_0x27ea58[_0x5bda35(0x1f1)]((_0x2b9c52,_0x19ce66)=>{_0x166266[_0x19ce66]['maxperunit']=_0x2b9c52;}),_0x2ded32[_0x5bda35(0x1f1)]((_0x473c90,_0x578f4e)=>{var _0x3d4441=_0x5bda35;_0x166266[_0x578f4e][_0x3d4441(0x19b)]=_0x473c90;}),_0x5a4d93[_0x5bda35(0x1f1)]((_0x27f41e,_0x396f12)=>{var _0x4aee82=_0x5bda35;_0x166266[_0x396f12][_0x4aee82(0x21a)]=_0x27f41e;}),_0x5ea5ed[_0x5bda35(0x1f1)]((_0x5b9af6,_0x39de03)=>{var _0x378ea4=_0x5bda35;_0x166266[_0x39de03][_0x378ea4(0x1e1)]=_0x5b9af6;}),_0x1623c0[_0x5bda35(0x1f1)]((_0xb2a041,_0x13fb61)=>{_0x166266[_0x13fb61]['to_room_name']=_0xb2a041;});const _0x198cc2=_0x166266[_0x5bda35(0x195)](_0x31a4c4=>_0x31a4c4[_0x5bda35(0x1a6)]!=='0'&&_0x31a4c4[_0x5bda35(0x1a6)]!==''||_0x31a4c4[_0x5bda35(0x1c9)]!=='0'&&_0x31a4c4[_0x5bda35(0x1c9)]!==''),_0x3195cc=new transfers({'date':_0x5e3b62,'from_warehouse':_0x5d873e,'to_warehouse':_0x56d91a,'product':_0x198cc2,'note':_0x2af0ec,'invoice':_0x530218}),_0x5181b8=await _0x3195cc[_0x5bda35(0x20b)]();_0x2e0049['flash'](_0x5bda35(0x21c),_0x5bda35(0x1fe)),_0x29b46d[_0x5bda35(0x1f6)](_0x5bda35(0x1f3)+_0x5181b8[_0x5bda35(0x1ae)]);}catch(_0x8b40c3){console[_0x5bda35(0x15c)](_0x8b40c3),_0x29b46d[_0x5bda35(0x189)](0xc8)[_0x5bda35(0x14a)]({'errorMessage':_0x8b40c3['message']});}}),router[a0_0x5ee381(0x1ea)](a0_0x5ee381(0x217),auth,async(_0x5a9bf7,_0x290950)=>{var _0x5da6e4=a0_0x5ee381;try{const {username:_0x6df0b0,email:_0x72565e,role:_0x19e423}=_0x5a9bf7[_0x5da6e4(0x157)],_0xeed550=_0x5a9bf7['user'],_0x560689=await profile['findOne']({'email':_0xeed550[_0x5da6e4(0x16d)]}),_0x18f743=await master_shop['find']();console[_0x5da6e4(0x15c)]('master',_0x18f743);const _0x181047=await transfers[_0x5da6e4(0x162)](_0x5a9bf7[_0x5da6e4(0x1f2)]['id']);let _0xe1de80=new Date(_0x181047['expiry_date']),_0x473e06=('0'+_0xe1de80['getDate']())[_0x5da6e4(0x142)](-0x2),_0x2b8d07=('0'+(_0xe1de80[_0x5da6e4(0x180)]()+0x1))[_0x5da6e4(0x142)](-0x2),_0x24de5d=_0xe1de80['getFullYear'](),_0xa811cf=_0x24de5d+'-'+_0x2b8d07+'-'+_0x473e06,_0x24b65d;if(_0xeed550[_0x5da6e4(0x1aa)]=='staff'){const _0x1b00be=await staff[_0x5da6e4(0x1ad)]({'email':_0xeed550[_0x5da6e4(0x16d)]});_0x24b65d=await warehouse['find']({'status':_0x5da6e4(0x219),'name':_0x1b00be[_0x5da6e4(0x135)],'warehouse_category':_0x5da6e4(0x187)});}else _0x24b65d=await warehouse[_0x5da6e4(0x1cd)]({'status':_0x5da6e4(0x219),'warehouse_category':'Raw\x20Materials'});const _0x346405=await warehouse[_0x5da6e4(0x1b5)]([{'$match':{'name':_0x181047[_0x5da6e4(0x1da)]}},{'$unwind':_0x5da6e4(0x17b)},{'$group':{'_id':_0x5da6e4(0x1a7),'name':{'$first':_0x5da6e4(0x13e)},'product_stock':{'$first':_0x5da6e4(0x18a)},'bay':{'$first':_0x5da6e4(0x1ec)},'bin':{'$first':_0x5da6e4(0x18f)},'type':{'$first':_0x5da6e4(0x1b4)},'floorlevel':{'$first':_0x5da6e4(0x1ff)},'primary_code':{'$first':_0x5da6e4(0x1b7)},'secondary_code':{'$first':_0x5da6e4(0x1bd)},'product_code':{'$first':_0x5da6e4(0x21f)},'storage':{'$first':_0x5da6e4(0x1a3)},'rack':{'$first':_0x5da6e4(0x1c3)},'expiry_date':{'$first':_0x5da6e4(0x218)},'production_date':{'$first':_0x5da6e4(0x131)},'room':{'$first':_0x5da6e4(0x197)}}}]);if(_0x18f743[0x0][_0x5da6e4(0x137)]=='English\x20(US)'){var _0x143616=users['English'];console[_0x5da6e4(0x15c)](_0x143616);}else{if(_0x18f743[0x0][_0x5da6e4(0x137)]==_0x5da6e4(0x1a9))var _0x143616=users['Hindi'];else{if(_0x18f743[0x0][_0x5da6e4(0x137)]=='German')var _0x143616=users['German'];else{if(_0x18f743[0x0]['language']=='Spanish')var _0x143616=users[_0x5da6e4(0x144)];else{if(_0x18f743[0x0][_0x5da6e4(0x137)]==_0x5da6e4(0x13c))var _0x143616=users[_0x5da6e4(0x13c)];else{if(_0x18f743[0x0]['language']==_0x5da6e4(0x1d3))var _0x143616=users[_0x5da6e4(0x138)];else{if(_0x18f743[0x0][_0x5da6e4(0x137)]=='Chinese')var _0x143616=users[_0x5da6e4(0x193)];else{if(_0x18f743[0x0][_0x5da6e4(0x137)]=='Arabic\x20(ae)')var _0x143616=users['Arabic'];}}}}}}}_0x290950[_0x5da6e4(0x220)](_0x5da6e4(0x15a),{'success':_0x5a9bf7[_0x5da6e4(0x160)]('success'),'errors':_0x5a9bf7['flash']('errors'),'role':_0xeed550,'profile':_0x560689,'master_shop':_0x18f743,'warehouse':_0x24b65d,'transfer':_0x181047,'stock':_0x346405,'language':_0x143616});}catch(_0x43df40){console[_0x5da6e4(0x15c)](_0x43df40);}}),router[a0_0x5ee381(0x15e)]('/preview/:id',auth,async(_0x524668,_0x535f19)=>{var _0x467409=a0_0x5ee381;try{const _0x2ce88a=_0x524668[_0x467409(0x1f2)]['id'],{from_warehouse:_0x40eb12,FromRoom_name:_0x18bd75,to_warehouse:_0x377b9c,ToRoom_name:_0x74fe3b}=_0x524668['body'],_0xc27fae=await transfers['findById']({'_id':_0x2ce88a}),_0x1ccfc0=_0xc27fae[_0x467409(0x196)]['map'](async _0x183a32=>{var _0x28b52e=_0x467409;if(_0x183a32[_0x28b52e(0x1a6)]>0x0){var _0x151ff2=await warehouse[_0x28b52e(0x1ad)]({'name':_0xc27fae[_0x28b52e(0x1da)],'room':_0x183a32[_0x28b52e(0x1e1)],'warehouse_category':'Raw\x20Materials'});const _0x540dcc=_0x151ff2['product_details'][_0x28b52e(0x1ef)](_0xe83ffe=>{var _0x21c220=_0x28b52e;_0xe83ffe[_0x21c220(0x1bc)]==_0x183a32[_0x21c220(0x1bc)]&&_0xe83ffe[_0x21c220(0x14e)]==_0x183a32[_0x21c220(0x210)]&&_0xe83ffe['type']==_0x183a32[_0x21c220(0x213)]&&_0xe83ffe['bin']==_0x183a32[_0x21c220(0x16b)]&&_0xe83ffe[_0x21c220(0x14d)]==_0x183a32[_0x21c220(0x15d)]&&_0xe83ffe['rack']==_0x183a32[_0x21c220(0x1ca)]&&_0xe83ffe[_0x21c220(0x1e6)]==_0x183a32[_0x21c220(0x1e8)]&&_0xe83ffe['expiry_date']==_0x183a32['expiry_date']&&_0xe83ffe['batch_code']==_0x183a32['batch_code']&&_0xe83ffe['production_date']==_0x183a32['production_date']&&_0xe83ffe['invoice']==_0x183a32[_0x21c220(0x1f8)]&&_0xe83ffe[_0x21c220(0x1ae)]==_0x183a32['id_transaction_id']&&(_0xe83ffe[_0x21c220(0x13d)]=_0xe83ffe[_0x21c220(0x13d)]-_0x183a32[_0x21c220(0x1a6)]);});}return _0x151ff2;});Promise[_0x467409(0x1e0)](_0x1ccfc0)[_0x467409(0x21e)](async _0x4701ef=>{var _0x4ffab4=_0x467409;try{for(const _0x3e01c0 of _0x4701ef){await _0x3e01c0[_0x4ffab4(0x20b)]();}try{const _0x34e44b=_0xc27fae[_0x4ffab4(0x196)]['map'](async _0x3bc76e=>{var _0x2c4f1d=_0x4ffab4;if(_0x3bc76e[_0x2c4f1d(0x1a6)]>0x0){var _0x18ede1=await warehouse[_0x2c4f1d(0x1ad)]({'name':_0xc27fae['to_warehouse'],'room':_0x3bc76e[_0x2c4f1d(0x136)],'warehouse_category':_0x2c4f1d(0x187)}),_0x2a2841=0x0;const _0x3678d7=_0x18ede1['product_details'][_0x2c4f1d(0x1ef)](_0x4368d8=>{var _0x1c1f48=_0x2c4f1d;_0x4368d8[_0x1c1f48(0x1bc)]==_0x3bc76e[_0x1c1f48(0x1bc)]&&_0x4368d8[_0x1c1f48(0x14e)]==_0x3bc76e['to_floorlevel']&&_0x4368d8[_0x1c1f48(0x164)]==_0x3bc76e[_0x1c1f48(0x133)]&&_0x4368d8[_0x1c1f48(0x143)]==_0x3bc76e[_0x1c1f48(0x20c)]&&_0x4368d8[_0x1c1f48(0x14d)]==_0x3bc76e['to_bay']&&_0x4368d8[_0x1c1f48(0x1eb)]==_0x3bc76e[_0x1c1f48(0x1eb)]&&_0x4368d8['storage']==_0x3bc76e[_0x1c1f48(0x1e6)]&&_0x4368d8[_0x1c1f48(0x1f5)]==_0x3bc76e[_0x1c1f48(0x1f5)]&&_0x4368d8['batch_code']==_0x3bc76e[_0x1c1f48(0x192)]&&_0x4368d8[_0x1c1f48(0x19b)]==_0x3bc76e[_0x1c1f48(0x19b)]&&_0x4368d8[_0x1c1f48(0x1c5)]==_0x3bc76e['To_invoice']&&(_0x4368d8['product_stock']=_0x4368d8[_0x1c1f48(0x13d)]+_0x3bc76e[_0x1c1f48(0x1a6)],_0x2a2841++);});_0x2a2841=='0'&&(_0x18ede1[_0x2c4f1d(0x1cb)]=_0x18ede1['product_details']['concat']({'product_name':_0x3bc76e[_0x2c4f1d(0x1bc)],'product_stock':_0x3bc76e[_0x2c4f1d(0x1a6)],'bay':_0x3bc76e[_0x2c4f1d(0x1d4)],'bin':_0x3bc76e[_0x2c4f1d(0x20c)],'type':_0x3bc76e['to_types'],'floorlevel':_0x3bc76e[_0x2c4f1d(0x1c9)],'storage':_0x3bc76e[_0x2c4f1d(0x1e6)],'rack':_0x3bc76e[_0x2c4f1d(0x1eb)],'product_code':_0x3bc76e[_0x2c4f1d(0x176)],'primary_code':_0x3bc76e[_0x2c4f1d(0x1f9)],'secondary_code':_0x3bc76e[_0x2c4f1d(0x178)],'maxProducts':_0x3bc76e[_0x2c4f1d(0x1bb)],'storage':_0x3bc76e[_0x2c4f1d(0x1e6)],'rack':_0x3bc76e['rack'],'expiry_date':_0x3bc76e[_0x2c4f1d(0x1f5)],'maxPerUnit':_0x3bc76e['maxperunit'],'batch_code':_0x3bc76e[_0x2c4f1d(0x192)],'production_date':_0x3bc76e[_0x2c4f1d(0x19b)]}));}return _0x18ede1;});Promise['all'](_0x34e44b)[_0x4ffab4(0x21e)](async _0x18e11e=>{var _0x458d9e=_0x4ffab4;try{for(const _0x5a0416 of _0x18e11e){await warehouse['updateOne']({'_id':_0x5a0416[_0x458d9e(0x1ae)]},{'$addToSet':{'product_details':{'$each':_0x5a0416[_0x458d9e(0x1cb)]}}});}_0xc27fae['finalize']=_0x458d9e(0x152);const _0x36d95b=await _0xc27fae[_0x458d9e(0x20b)](),_0x303bd2=await master_shop[_0x458d9e(0x1cd)](),_0x4969af=await email_settings['findOne'](),_0x18e063=await supervisor_settings[_0x458d9e(0x1cd)]();var _0x191d1c=_0xc27fae['product'],_0x303801='',_0x39bfab;for(_0x39bfab in _0x191d1c){_0x303801+=_0x458d9e(0x183)+_0x458d9e(0x1b1)+_0x191d1c[_0x39bfab][_0x458d9e(0x1bc)]+_0x458d9e(0x201)+_0x458d9e(0x1b1)+_0x191d1c[_0x39bfab]['product_code']+_0x458d9e(0x201)+_0x458d9e(0x1b1)+_0x191d1c[_0x39bfab][_0x458d9e(0x1a6)]+_0x458d9e(0x201)+_0x458d9e(0x1b1)+_0x191d1c[_0x39bfab][_0x458d9e(0x207)]+_0x458d9e(0x201)+_0x458d9e(0x1b1)+_0x191d1c[_0x39bfab][_0x458d9e(0x153)]+'</td>'+_0x458d9e(0x1b1)+_0xc27fae[_0x458d9e(0x14c)]+_0x458d9e(0x201)+_0x458d9e(0x1b1)+_0x191d1c[_0x39bfab][_0x458d9e(0x136)]+'</td>'+_0x458d9e(0x1b1)+_0x191d1c[_0x39bfab]['storage']+_0x191d1c[_0x39bfab][_0x458d9e(0x1eb)]+_0x191d1c[_0x39bfab][_0x458d9e(0x1d4)]+_0x191d1c[_0x39bfab][_0x458d9e(0x20c)]+_0x191d1c[_0x39bfab][_0x458d9e(0x133)][0x0]+_0x191d1c[_0x39bfab][_0x458d9e(0x1c9)]+_0x458d9e(0x201),_0x458d9e(0x165);}let _0x4ed181=nodemailer[_0x458d9e(0x206)]({'host':_0x4969af[_0x458d9e(0x214)],'port':Number(_0x4969af[_0x458d9e(0x172)]),'secure':![],'auth':{'user':_0x4969af[_0x458d9e(0x16d)],'pass':_0x4969af['password']}}),_0x42e81c={'from':_0x4969af[_0x458d9e(0x16d)],'to':_0x18e063[0x0][_0x458d9e(0x191)],'subject':_0x458d9e(0x185),'attachments':[{'filename':_0x458d9e(0x155),'path':__dirname+_0x458d9e(0x1ee)+_0x458d9e(0x19a)+_0x303bd2[0x0][_0x458d9e(0x208)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x458d9e(0x18b)+_0x458d9e(0x15b)+_0x458d9e(0x1a5)+_0x458d9e(0x149)+_0x458d9e(0x1a5)+_0x458d9e(0x148)+_0x458d9e(0x1d1)+_0x458d9e(0x1a5)+_0x458d9e(0x167)+_0x303bd2[0x0][_0x458d9e(0x20d)]+_0x458d9e(0x1c6)+_0x458d9e(0x1d1)+'</div>'+_0x458d9e(0x1ba)+_0x458d9e(0x1a5)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0xc27fae[_0x458d9e(0x1c5)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x458d9e(0x1e3)+_0xc27fae[_0x458d9e(0x212)]+'\x20'+_0x458d9e(0x16f)+'</h5>'+_0x458d9e(0x1d1)+_0x458d9e(0x145)+_0x458d9e(0x1d7)+_0x458d9e(0x183)+_0x458d9e(0x1d2)+_0x458d9e(0x1f7)+_0x458d9e(0x1bf)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x458d9e(0x1fa)+_0x458d9e(0x1de)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x458d9e(0x1c0)+'</tr>'+'</thead>'+_0x458d9e(0x150)+'\x20'+_0x303801+'\x20'+'</tbody>'+_0x458d9e(0x1d8)+_0x458d9e(0x1a5)+_0x458d9e(0x1ed)+_0x458d9e(0x1b9)+_0x303bd2[0x0][_0x458d9e(0x20d)]+_0x458d9e(0x1d6)+'</div>'+_0x458d9e(0x1d1)+_0x458d9e(0x1a8)};_0x4ed181[_0x458d9e(0x19e)](_0x42e81c,function(_0x360bdb,_0x28b070){var _0x309941=_0x458d9e;_0x360bdb?(console[_0x309941(0x15c)](_0x360bdb),console['log']('Error\x20Occurs')):console[_0x309941(0x15c)](_0x309941(0x1a0));}),_0x524668[_0x458d9e(0x160)](_0x458d9e(0x21c),'Transfer\x20Finalize\x20Successfully'),_0x535f19[_0x458d9e(0x1f6)]('/picking_list/PDF_transfer_rm/'+_0x36d95b['_id']);}catch(_0x1019ab){console[_0x458d9e(0x166)](_0x1019ab),_0x535f19[_0x458d9e(0x189)](0x1f4)[_0x458d9e(0x14a)]({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x1019ab['message']});}})[_0x4ffab4(0x15f)](_0x421be3=>{var _0x5606af=_0x4ffab4;console['error'](_0x421be3),_0x535f19['status'](0x1f4)[_0x5606af(0x14a)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x354d53){_0x535f19[_0x4ffab4(0x14a)](_0x354d53);}}catch(_0x26723b){console[_0x4ffab4(0x166)](_0x26723b),_0x535f19[_0x4ffab4(0x189)](0x1f4)[_0x4ffab4(0x14a)]({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x26723b[_0x4ffab4(0x1a1)]});}})[_0x467409(0x15f)](_0x2ac6c0=>{var _0x291446=_0x467409;console['error'](_0x2ac6c0),_0x535f19[_0x291446(0x189)](0x1f4)[_0x291446(0x14a)]({'Merror':_0x291446(0x1d5)});});}catch(_0x33b4dd){console['log'](_0x33b4dd);}});function BayBinSelected(_0x4238d1,_0x1557b7){var _0x295235=a0_0x5ee381,_0x48e95f=[],_0x19476b=[],_0xdfbf9=[],_0x457c00=[],_0x128fbc=[],_0x5238e8=[];let _0x390619=[];if(_0x4238d1==_0x295235(0x203))switch(_0x1557b7){case _0x295235(0x14b):_0x48e95f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x19476b=[0x1,0x2],_0x457c00=[0x1,0x2,0x3,0x4,0x5],_0xdfbf9=[_0x295235(0x14f),_0x295235(0x154)],_0x128fbc=['D'],_0x5238e8=['A'];break;case _0x295235(0x170):_0x48e95f=[0x6,0x5,0x4,0x3,0x2,0x1],_0x19476b=[0x1,0x2],_0x457c00=[0x1,0x2,0x3,0x4,0x5],_0xdfbf9=[_0x295235(0x14f),_0x295235(0x154)],_0x128fbc=['D'],_0x5238e8=['B'];break;case'Shelves':_0x48e95f=[0x0],_0x19476b=[0x0],_0x457c00=[0x1,0x2,0x3,0x4,0x5],_0xdfbf9=[_0x295235(0x154)],_0x128fbc=['D'],_0x5238e8=['S'];break;case _0x295235(0x177):_0x48e95f=[0x0],_0x19476b=[0x0],_0x457c00=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0xdfbf9=[_0x295235(0x154)],_0x128fbc=['D'],_0x5238e8=['R'];break;}else{if(_0x4238d1==_0x295235(0x199))switch(_0x1557b7){case _0x295235(0x14b):_0x48e95f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x19476b=['B','F'],_0x457c00=[0x1,0x2,0x3,0x4,0x5],_0xdfbf9=[_0x295235(0x14f),_0x295235(0x154)],_0x128fbc=['C'],_0x5238e8=['A'];break;case _0x295235(0x170):_0x48e95f=[0x5,0x4,0x3,0x2,0x1],_0x19476b=['F','B','S'],_0x457c00=[0x1,0x2,0x3,0x4,0x5],_0xdfbf9=[_0x295235(0x14f),'Floor'],_0x128fbc=['C'],_0x5238e8=['B'];break;case _0x295235(0x159):_0x48e95f=[0x1,0x2,0x3,0x4,0x5],_0x19476b=['B','F','S'],_0x457c00=[0x5,0x4,0x3,0x2,0x1],_0xdfbf9=[_0x295235(0x14f),_0x295235(0x154)],_0x128fbc=['C'],_0x5238e8=['C'];break;case'Rack\x20D':_0x48e95f=[0x5,0x4,0x3,0x2,0x1],_0x19476b=['F','B','S'],_0x457c00=[0x1,0x2,0x3,0x4,0x5],_0xdfbf9=['Level','Floor'],_0x128fbc=['C'],_0x5238e8=['D'];break;case _0x295235(0x1f0):_0x48e95f=[0x4,0x3,0x2,0x1],_0x19476b=[0x1,0x2],_0x457c00=[0x1,0x2,0x3,0x4,0x5],_0xdfbf9=[_0x295235(0x14f),_0x295235(0x154)],_0x128fbc=['C'],_0x5238e8=['E'];break;case _0x295235(0x209):_0x48e95f=[0x1,0x2,0x3],_0x19476b=[0x1,0x2],_0x457c00=[0x1,0x2,0x3,0x4,0x5],_0xdfbf9=[_0x295235(0x14f)],_0x128fbc=['C'],_0x5238e8=['F'];break;}}return{'levels':_0x48e95f,'Isle':_0x19476b,'rack':_0x457c00,'type':_0xdfbf9,'storage':_0x128fbc,'rak':_0x5238e8};}router[a0_0x5ee381(0x1ea)](a0_0x5ee381(0x1cc),auth,async(_0x21c31e,_0x498c78)=>{var _0x5c643e=a0_0x5ee381;try{const {username:_0xfa57c,email:_0xc87757,role:_0x61442}=_0x21c31e[_0x5c643e(0x157)],_0x2415e0=_0x21c31e[_0x5c643e(0x157)],_0x2f2881=await profile['findOne']({'email':_0x2415e0[_0x5c643e(0x16d)]}),_0x10c945=await master_shop[_0x5c643e(0x1cd)](),_0x29237a=await transfers[_0x5c643e(0x162)](_0x21c31e[_0x5c643e(0x1f2)]['id']);let _0x3a9794;if(_0x2415e0[_0x5c643e(0x1aa)]==_0x5c643e(0x130)){const _0x55cc78=await staff[_0x5c643e(0x1ad)]({'email':_0x2415e0[_0x5c643e(0x16d)]});_0x3a9794=await warehouse['aggregate']([{'$match':{'status':_0x5c643e(0x219),'name':_0x55cc78[_0x5c643e(0x135)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x5c643e(0x146),'name':{'$first':'$name'}}}]);}else _0x3a9794=await warehouse['aggregate']([{'$match':{'status':_0x5c643e(0x219),'warehouse_category':_0x5c643e(0x187)}},{'$group':{'_id':_0x5c643e(0x146),'name':{'$first':_0x5c643e(0x146)}}}]);const _0x4b9da8=await warehouse['aggregate']([{'$match':{'name':_0x29237a['from_warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5c643e(0x1a7),'name':{'$first':_0x5c643e(0x13e)},'product_stock':{'$first':_0x5c643e(0x18a)},'bay':{'$first':_0x5c643e(0x1ec)},'bin':{'$first':_0x5c643e(0x18f)},'type':{'$first':_0x5c643e(0x1b4)},'floorlevel':{'$first':_0x5c643e(0x1ff)},'primary_code':{'$first':_0x5c643e(0x1b7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5c643e(0x1a3)},'rack':{'$first':_0x5c643e(0x1c3)},'expiry_date':{'$first':_0x5c643e(0x218)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x5c643e(0x197)}}}]),_0x3b8b64=await product[_0x5c643e(0x1cd)]({}),_0x252db2=BayBinSelected(_0x29237a[_0x5c643e(0x14c)],_0x29237a[_0x5c643e(0x17e)]);if(_0x10c945[0x0]['language']==_0x5c643e(0x1fd)){var _0xfc071a=users[_0x5c643e(0x186)];console['log'](_0xfc071a);}else{if(_0x10c945[0x0][_0x5c643e(0x137)]=='Hindi')var _0xfc071a=users[_0x5c643e(0x1a9)];else{if(_0x10c945[0x0][_0x5c643e(0x137)]==_0x5c643e(0x18d))var _0xfc071a=users['German'];else{if(_0x10c945[0x0][_0x5c643e(0x137)]==_0x5c643e(0x144))var _0xfc071a=users[_0x5c643e(0x144)];else{if(_0x10c945[0x0][_0x5c643e(0x137)]=='French')var _0xfc071a=users[_0x5c643e(0x13c)];else{if(_0x10c945[0x0][_0x5c643e(0x137)]==_0x5c643e(0x1d3))var _0xfc071a=users['Portuguese'];else{if(_0x10c945[0x0][_0x5c643e(0x137)]=='Chinese')var _0xfc071a=users[_0x5c643e(0x193)];else{if(_0x10c945[0x0][_0x5c643e(0x137)]=='Arabic\x20(ae)')var _0xfc071a=users['Arabic'];}}}}}}}_0x498c78[_0x5c643e(0x220)](_0x5c643e(0x163),{'success':_0x21c31e['flash'](_0x5c643e(0x21c)),'errors':_0x21c31e['flash']('errors'),'role':_0x2415e0,'profile':_0x2f2881,'master_shop':_0x10c945,'warehouse':_0x3a9794,'transfer':_0x29237a,'stock':_0x4b9da8,'unit':_0x3b8b64,'language':_0xfc071a});}catch(_0x1c91f2){console[_0x5c643e(0x15c)](_0x1c91f2);}}),router[a0_0x5ee381(0x15e)](a0_0x5ee381(0x1cc),auth,async(_0x56a72a,_0x249efc)=>{var _0x35bf09=a0_0x5ee381;try{const _0x48a1f4=_0x56a72a[_0x35bf09(0x1f2)]['id'],_0x1057d0=await transfers[_0x35bf09(0x162)](_0x48a1f4);_0x249efc[_0x35bf09(0x14a)](_0x56a72a[_0x35bf09(0x17f)]);return;const {date:_0x1aaca7,from_warehouse:_0xd94be1,FromRoom_name:_0x37ced5,to_warehouse:_0xb44555,ToRoom_name:_0x2e2399,prod_name:_0x4921f0,from_prod_qty:_0x81d252,from_prod_level:_0xbb3256,from_prod_isle:_0x41b279,from_prod_pallet:_0xeb8c52,to_prod_qty:_0xa40ae6,to_prod_level:_0x369954,to_prod_isle:_0x38c965,to_prod_pallet:_0x407d4c,primary_code:_0x524c41,secondary_code:_0x462d99,product_code3:_0x4fb313,note:_0x1b6c37,invoice:_0x3947f8,expiry_date:_0x1a1119}=_0x56a72a[_0x35bf09(0x17f)];if(typeof _0x4921f0==_0x35bf09(0x156))var _0x455c6a=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x204)]],_0x2f2aad=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x147)]],_0x1c3aad=[_0x56a72a[_0x35bf09(0x17f)]['from_prod_level']],_0x10a543=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x173)]],_0x274a37=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x190)]],_0x2475fc=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x213)]],_0x3cef65=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x1b6)]],_0x50856e=[_0x56a72a[_0x35bf09(0x17f)]['to_prod_level']],_0x1a05ea=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x211)]],_0x481fa8=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x19f)]],_0x5217c3=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x133)]],_0x143979=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x1e6)]],_0x315a37=[_0x56a72a['body'][_0x35bf09(0x21d)]],_0x4e280b=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x1f9)]],_0x55992b=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x178)]],_0x17d497=[_0x56a72a['body'][_0x35bf09(0x140)]],_0x3a068f=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x202)]],_0x450ec5=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x207)]],_0x46389a=[_0x56a72a['body'][_0x35bf09(0x153)]],_0x3773e6=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x192)]],_0x469971=[_0x56a72a[_0x35bf09(0x17f)]['expiry_date']],_0x1bd944=[_0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x1e8)]],_0x1aec0b=[_0x56a72a['body'][_0x35bf09(0x1e9)]];else var _0x455c6a=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x204)]],_0x143979=[..._0x56a72a[_0x35bf09(0x17f)]['storage']],_0x315a37=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x21d)]],_0x2475fc=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x213)]],_0x5217c3=[..._0x56a72a['body'][_0x35bf09(0x133)]],_0x2f2aad=[..._0x56a72a[_0x35bf09(0x17f)]['from_prod_qty']],_0x1c3aad=[..._0x56a72a[_0x35bf09(0x17f)]['from_prod_level']],_0x10a543=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x173)]],_0x274a37=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x190)]],_0x3cef65=[..._0x56a72a[_0x35bf09(0x17f)]['to_prod_qty']],_0x50856e=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x194)]],_0x1a05ea=[..._0x56a72a['body']['to_prod_isle']],_0x481fa8=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x19f)]],_0x4e280b=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x1f9)]],_0x55992b=[..._0x56a72a[_0x35bf09(0x17f)]['secondary_code']],_0x17d497=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x140)]],_0x3a068f=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x202)]],_0x450ec5=[..._0x56a72a['body'][_0x35bf09(0x207)]],_0x46389a=[..._0x56a72a['body'][_0x35bf09(0x153)]],_0x3773e6=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x192)]],_0x469971=[..._0x56a72a['body'][_0x35bf09(0x1f5)]],_0x1bd944=[..._0x56a72a['body'][_0x35bf09(0x1e8)]],_0x1aec0b=[..._0x56a72a[_0x35bf09(0x17f)][_0x35bf09(0x1e9)]];const _0x58fb8a=_0x455c6a[_0x35bf09(0x1ef)](_0x5432a3=>{return _0x5432a3={'product_name':_0x5432a3};});_0x2f2aad[_0x35bf09(0x1f1)]((_0x28043e,_0x4e5de0)=>{_0x58fb8a[_0x4e5de0]['from_quantity']=_0x28043e;}),_0x1c3aad[_0x35bf09(0x1f1)]((_0x3ce8dc,_0x345b9e)=>{var _0x54c501=_0x35bf09;_0x58fb8a[_0x345b9e][_0x54c501(0x15d)]=_0x3ce8dc;}),_0x10a543[_0x35bf09(0x1f1)]((_0x4a1504,_0x33f949)=>{var _0x1992e9=_0x35bf09;_0x58fb8a[_0x33f949][_0x1992e9(0x16b)]=_0x4a1504;}),_0x274a37['forEach']((_0x384006,_0x44998b)=>{var _0x24a8f7=_0x35bf09;_0x58fb8a[_0x44998b][_0x24a8f7(0x210)]=_0x384006;}),_0x3cef65[_0x35bf09(0x1f1)]((_0x2482dd,_0x46f115)=>{var _0x45988a=_0x35bf09;_0x58fb8a[_0x46f115][_0x45988a(0x1a6)]=_0x2482dd;}),_0x50856e[_0x35bf09(0x1f1)]((_0x69883c,_0x2b0814)=>{var _0x2c8d1e=_0x35bf09;_0x58fb8a[_0x2b0814][_0x2c8d1e(0x1d4)]=_0x69883c;}),_0x1a05ea[_0x35bf09(0x1f1)]((_0x43d77e,_0x1c5d63)=>{var _0x555c6b=_0x35bf09;_0x58fb8a[_0x1c5d63][_0x555c6b(0x20c)]=_0x43d77e;}),_0x481fa8[_0x35bf09(0x1f1)]((_0x7fae12,_0x508ac3)=>{var _0x480e56=_0x35bf09;_0x58fb8a[_0x508ac3][_0x480e56(0x1c9)]=_0x7fae12;}),_0x4e280b[_0x35bf09(0x1f1)]((_0x4f4078,_0x17de14)=>{var _0x5e3446=_0x35bf09;_0x58fb8a[_0x17de14][_0x5e3446(0x1f9)]=_0x4f4078;}),_0x55992b[_0x35bf09(0x1f1)]((_0x49ef2c,_0x501880)=>{var _0x36c049=_0x35bf09;_0x58fb8a[_0x501880][_0x36c049(0x178)]=_0x49ef2c;}),_0x17d497[_0x35bf09(0x1f1)]((_0x43729a,_0x174473)=>{var _0xb99d1=_0x35bf09;_0x58fb8a[_0x174473][_0xb99d1(0x176)]=_0x43729a;}),_0x3a068f[_0x35bf09(0x1f1)]((_0x53379c,_0x57f2db)=>{var _0x29e06e=_0x35bf09;_0x58fb8a[_0x57f2db][_0x29e06e(0x1bb)]=_0x53379c;}),_0x450ec5['forEach']((_0x313ab2,_0x5196cd)=>{_0x58fb8a[_0x5196cd]['unit']=_0x313ab2;}),_0x46389a['forEach']((_0x38d245,_0x48b87c)=>{var _0x4f21e3=_0x35bf09;_0x58fb8a[_0x48b87c][_0x4f21e3(0x153)]=_0x38d245;}),_0x3773e6['forEach']((_0x2b6aa3,_0x20e16a)=>{var _0x13d8f0=_0x35bf09;_0x58fb8a[_0x20e16a][_0x13d8f0(0x192)]=_0x2b6aa3;}),_0x469971[_0x35bf09(0x1f1)]((_0x4bac8e,_0xf4d731)=>{_0x58fb8a[_0xf4d731]['expiry_date']=_0x4bac8e;}),_0x143979[_0x35bf09(0x1f1)]((_0x492790,_0x2c3aaa)=>{_0x58fb8a[_0x2c3aaa]['storage']=_0x492790;}),_0x315a37[_0x35bf09(0x1f1)]((_0x3bb30d,_0x50097c)=>{var _0x4e3ff6=_0x35bf09;_0x58fb8a[_0x50097c][_0x4e3ff6(0x1eb)]=_0x3bb30d;}),_0x2475fc[_0x35bf09(0x1f1)]((_0x4e80eb,_0x230464)=>{_0x58fb8a[_0x230464]['from_types']=_0x4e80eb;}),_0x5217c3[_0x35bf09(0x1f1)]((_0x1d5ee1,_0x25a057)=>{_0x58fb8a[_0x25a057]['to_types']=_0x1d5ee1;}),_0x1bd944[_0x35bf09(0x1f1)]((_0x5cc974,_0x5eb5c5)=>{_0x58fb8a[_0x5eb5c5]['from_storage']=_0x5cc974;}),_0x1aec0b[_0x35bf09(0x1f1)]((_0x40fed2,_0x55e7f1)=>{var _0xf1789b=_0x35bf09;_0x58fb8a[_0x55e7f1][_0xf1789b(0x1ca)]=_0x40fed2;});const _0x3032ad=_0x58fb8a[_0x35bf09(0x195)](_0x5ce2a8=>_0x5ce2a8[_0x35bf09(0x1a6)]!=='0'&&_0x5ce2a8[_0x35bf09(0x1a6)]!==''||_0x5ce2a8['to_floorlevel']!=='0'&&_0x5ce2a8['to_floorlevel']!=='');var _0x777245=0x0;_0x3032ad[_0x35bf09(0x1f1)](_0x48fa4e=>{var _0x41551c=_0x35bf09;parseInt(_0x48fa4e['from_quantity'])<parseInt(_0x48fa4e[_0x41551c(0x1a6)])&&_0x777245++;});if(_0x777245!=0x0)return _0x56a72a[_0x35bf09(0x160)](_0x35bf09(0x1d9),_0x35bf09(0x134)),_0x249efc[_0x35bf09(0x1f6)](_0x35bf09(0x21b));const _0x394e6e=await warehouse[_0x35bf09(0x1ad)]({'name':_0x1057d0[_0x35bf09(0x1da)],'room':_0x1057d0['from_room']});_0x1057d0[_0x35bf09(0x196)][_0x35bf09(0x1f1)](_0x48a4ed=>{var _0x4a524f=_0x35bf09;if(_0x48a4ed[_0x4a524f(0x1a6)]>0x0){const _0x25a16c=_0x394e6e[_0x4a524f(0x1cb)][_0x4a524f(0x1ef)](_0x2f2567=>{var _0x49c997=_0x4a524f;_0x2f2567[_0x49c997(0x1bc)]==_0x48a4ed['product_name']&&_0x2f2567[_0x49c997(0x14e)]==_0x48a4ed[_0x49c997(0x210)]&&_0x2f2567[_0x49c997(0x164)]==_0x48a4ed[_0x49c997(0x213)]&&_0x2f2567[_0x49c997(0x143)]==_0x48a4ed[_0x49c997(0x16b)]&&_0x2f2567['bay']==_0x48a4ed[_0x49c997(0x15d)]&&_0x2f2567[_0x49c997(0x1eb)]==_0x48a4ed['from_rack']&&_0x2f2567['storage']==_0x48a4ed[_0x49c997(0x1e8)]&&(_0x2f2567['product_stock']=parseInt(_0x2f2567['product_stock'])+parseInt(_0x48a4ed[_0x49c997(0x1a6)]));});}}),await _0x394e6e['save']();const _0x52530b=await warehouse['findOne']({'name':_0x1057d0[_0x35bf09(0x14c)],'room':_0x1057d0[_0x35bf09(0x17e)]});_0x1057d0[_0x35bf09(0x196)][_0x35bf09(0x1f1)](_0x1e326e=>{var _0x2a872c=_0x35bf09;if(_0x1e326e[_0x2a872c(0x1a6)]>0x0){const _0x100437=_0x52530b[_0x2a872c(0x1cb)][_0x2a872c(0x1ef)](_0x170c2b=>{var _0x3dc38b=_0x2a872c;_0x170c2b[_0x3dc38b(0x1bc)]==_0x1e326e[_0x3dc38b(0x1bc)]&&_0x170c2b[_0x3dc38b(0x14e)]==_0x1e326e['to_floorlevel']&&_0x170c2b[_0x3dc38b(0x164)]==_0x1e326e[_0x3dc38b(0x133)]&&_0x170c2b[_0x3dc38b(0x143)]==_0x1e326e[_0x3dc38b(0x20c)]&&_0x170c2b[_0x3dc38b(0x14d)]==_0x1e326e[_0x3dc38b(0x1d4)]&&_0x170c2b[_0x3dc38b(0x1eb)]==_0x1e326e['rack']&&_0x170c2b[_0x3dc38b(0x1e6)]==_0x1e326e[_0x3dc38b(0x1e6)]&&(_0x170c2b['product_stock']=parseInt(_0x170c2b[_0x3dc38b(0x13d)])-parseInt(_0x1e326e[_0x3dc38b(0x1a6)]));});}}),await _0x52530b[_0x35bf09(0x20b)](),_0x1057d0[_0x35bf09(0x212)]=_0x1aaca7,_0x1057d0[_0x35bf09(0x1da)]=_0xd94be1,_0x1057d0['to_warehouse']=_0xb44555,_0x1057d0[_0x35bf09(0x196)]=_0x3032ad,_0x1057d0[_0x35bf09(0x1e7)]=_0x1b6c37,_0x1057d0['invoice']=_0x3947f8;const _0x1eb6f0=await _0x1057d0[_0x35bf09(0x20b)]();console[_0x35bf09(0x15c)](_0x1eb6f0);const _0x1e1f92=await warehouse['findOne']({'name':_0xd94be1,'room':_0x37ced5});_0x1eb6f0[_0x35bf09(0x196)][_0x35bf09(0x1f1)](_0x508855=>{var _0xbf71e8=_0x35bf09;if(_0x508855[_0xbf71e8(0x1a6)]>0x0){const _0x3a126b=_0x1e1f92['product_details'][_0xbf71e8(0x1ef)](_0x2570fc=>{var _0x2b94cc=_0xbf71e8;_0x2570fc[_0x2b94cc(0x1bc)]==_0x508855[_0x2b94cc(0x1bc)]&&_0x2570fc[_0x2b94cc(0x14e)]==_0x508855[_0x2b94cc(0x210)]&&_0x2570fc['type']==_0x508855['from_types']&&_0x2570fc[_0x2b94cc(0x143)]==_0x508855['from_bin']&&_0x2570fc[_0x2b94cc(0x14d)]==_0x508855[_0x2b94cc(0x15d)]&&_0x2570fc[_0x2b94cc(0x1eb)]==_0x508855['from_rack']&&_0x2570fc[_0x2b94cc(0x1e6)]==_0x508855[_0x2b94cc(0x1e8)]&&(_0x2570fc[_0x2b94cc(0x13d)]=parseInt(_0x2570fc[_0x2b94cc(0x13d)])-parseInt(_0x508855[_0x2b94cc(0x1a6)]));});}}),await _0x1e1f92['save']();const _0x355844=await warehouse[_0x35bf09(0x1ad)]({'name':_0xb44555,'room':_0x2e2399});_0x1eb6f0[_0x35bf09(0x196)]['forEach'](_0x104c91=>{var _0x97af8f=_0x35bf09;if(_0x104c91['to_quantity']>0x0){var _0x2189e9=0x0;const _0xa1a39f=_0x355844[_0x97af8f(0x1cb)]['map'](_0x14c50b=>{var _0x4d3a1e=_0x97af8f;_0x14c50b['product_name']==_0x104c91[_0x4d3a1e(0x1bc)]&&_0x14c50b['floorlevel']==_0x104c91[_0x4d3a1e(0x1c9)]&&_0x14c50b[_0x4d3a1e(0x164)]==_0x104c91[_0x4d3a1e(0x133)]&&_0x14c50b[_0x4d3a1e(0x143)]==_0x104c91[_0x4d3a1e(0x20c)]&&_0x14c50b['bay']==_0x104c91[_0x4d3a1e(0x1d4)]&&_0x14c50b[_0x4d3a1e(0x1eb)]==_0x104c91['rack']&&_0x14c50b[_0x4d3a1e(0x1e6)]==_0x104c91['storage']&&(_0x14c50b['product_stock']=parseInt(_0x14c50b['product_stock'])+parseInt(_0x104c91[_0x4d3a1e(0x1a6)]),_0x2189e9++);});_0x2189e9=='0'&&(_0x355844['product_details']=_0x355844[_0x97af8f(0x1cb)]['concat']({'product_name':_0x104c91[_0x97af8f(0x1bc)],'product_stock':_0x104c91[_0x97af8f(0x1a6)],'bay':_0x104c91[_0x97af8f(0x1d4)],'bin':_0x104c91[_0x97af8f(0x20c)],'type':_0x104c91[_0x97af8f(0x133)],'floorlevel':_0x104c91['to_floorlevel'],'storage':_0x104c91['storage'],'rack':_0x104c91[_0x97af8f(0x1eb)],'product_code':_0x104c91[_0x97af8f(0x176)],'primary_code':_0x104c91[_0x97af8f(0x1f9)],'secondary_code':_0x104c91[_0x97af8f(0x178)],'maxProducts':_0x104c91['maxProducts'],'storage':_0x104c91[_0x97af8f(0x1e6)],'rack':_0x104c91[_0x97af8f(0x1eb)]}));}}),await _0x355844[_0x35bf09(0x20b)](),_0x56a72a[_0x35bf09(0x160)](_0x35bf09(0x21c),_0x35bf09(0x1b0)),_0x249efc[_0x35bf09(0x1f6)](_0x35bf09(0x18c));}catch(_0x410d23){console['log'](_0x410d23);}}),router['post']('/barcode_scanner',async(_0x377100,_0x440c7a)=>{var _0x4cfc2e=a0_0x5ee381;const {FromWareHouse:_0x24894a,FromRoom:_0x538f5a,ToWarehouse:_0x97ae48,ToRoom:_0x5c3dc4,primary_code:_0x1f698c,Roomslist:_0x5af7f7}=_0x377100[_0x4cfc2e(0x17f)],_0xb0d7e4=_0x5af7f7[_0x4cfc2e(0x18e)](','),_0x3faabe=[];async function _0xbf5e2d(_0x18be2d){var _0x1338f6=_0x4cfc2e;const _0x37db75=await warehouse['aggregate']([{'$match':{'name':_0x24894a,'room':_0x18be2d}},{'$unwind':_0x1338f6(0x17b)},{'$match':{'product_details.primary_code':_0x1f698c}},{'$group':{'_id':_0x1338f6(0x1a7),'name':{'$first':_0x1338f6(0x13e)},'instock':{'$first':_0x1338f6(0x18a)},'primary_code':{'$first':_0x1338f6(0x1b7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1338f6(0x21f)},'level':{'$first':_0x1338f6(0x1ec)},'isle':{'$first':_0x1338f6(0x18f)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1338f6(0x1ff)},'unit':{'$first':_0x1338f6(0x20f)},'secondary_unit':{'$first':_0x1338f6(0x132)},'storage':{'$first':_0x1338f6(0x1a3)},'rack':{'$first':_0x1338f6(0x1c3)},'expiry_date':{'$first':_0x1338f6(0x218)},'production_date':{'$first':_0x1338f6(0x131)},'batch_code':{'$first':_0x1338f6(0x19d)},'maxPerUnit':{'$first':_0x1338f6(0x16a)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x1338f6(0x1b2)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x462572=await warehouse[_0x1338f6(0x1b5)]([{'$match':{'name':_0x24894a,'room':_0x18be2d}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x1f698c}},{'$group':{'_id':_0x1338f6(0x1a7),'name':{'$first':_0x1338f6(0x13e)},'instock':{'$first':_0x1338f6(0x18a)},'primary_code':{'$first':_0x1338f6(0x1b7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1338f6(0x21f)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1338f6(0x1b4)},'pallet':{'$first':_0x1338f6(0x1ff)},'unit':{'$first':_0x1338f6(0x20f)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1338f6(0x1c3)},'expiry_date':{'$first':_0x1338f6(0x218)},'production_date':{'$first':_0x1338f6(0x131)},'batch_code':{'$first':_0x1338f6(0x19d)},'maxPerUnit':{'$first':_0x1338f6(0x16a)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x1338f6(0x197)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x1338f6(0x17d)}}}]);if(_0x37db75[_0x1338f6(0x1e5)]>0x0)_0x3faabe[_0x1338f6(0x16c)](_0x37db75);else _0x462572[_0x1338f6(0x1e5)]>0x0&&_0x3faabe[_0x1338f6(0x16c)](_0x462572);}const _0x2d4b77=_0xb0d7e4[_0x4cfc2e(0x1ef)](_0x38a18c=>_0xbf5e2d(_0x38a18c));await Promise[_0x4cfc2e(0x1e0)](_0x2d4b77),_0x440c7a[_0x4cfc2e(0x14a)](_0x3faabe);}),router[a0_0x5ee381(0x15e)](a0_0x5ee381(0x1ac),async(_0x16498f,_0x52cccb)=>{var _0x3a27cd=a0_0x5ee381;try{const {FromWareHouse:_0x193293,FromRoom:_0x2bdd73,ToWarehouse:_0x33d4c4,ToRoom:_0x13bd89,secondary_code:_0x4b5601}=_0x16498f[_0x3a27cd(0x17f)],_0x1fe0c5=await warehouse['aggregate']([{'$match':{'name':_0x193293}},{'$unwind':_0x3a27cd(0x17b)},{'$match':{'product_details.secondary_code':_0x4b5601}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3a27cd(0x13e)},'primary_code':{'$first':_0x3a27cd(0x1b7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3a27cd(0x21f)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x3a27cd(0x146)},'level':{'$first':_0x3a27cd(0x1d0)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x3a27cd(0x1b2)},'unit':{'$first':'$product_details.unit'}}}]);_0x52cccb[_0x3a27cd(0x189)](0xc8)[_0x3a27cd(0x14a)](_0x1fe0c5);}catch(_0x1c3db9){_0x52cccb[_0x3a27cd(0x189)](0x194)[_0x3a27cd(0x14a)]({'message':_0x1c3db9['message']});}}),router[a0_0x5ee381(0x15e)](a0_0x5ee381(0x13f),async(_0x1b32bb,_0x855b4a)=>{var _0x477084=a0_0x5ee381;try{const {FromWareHouse:_0x5eeac5,FromRoom:_0x2d1040,ToWarehouse:_0x4aeea2,ToRoom:_0xd58954,product_code:_0x399660}=_0x1b32bb[_0x477084(0x17f)],_0x1808d9=await warehouse[_0x477084(0x1b5)]([{'$match':{'name':_0x5eeac5}},{'$unwind':_0x477084(0x17b)},{'$match':{'product_details.product_code':_0x399660}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x477084(0x21f)},'instock':{'$first':_0x477084(0x18a)},'warehouse':{'$first':'$name'},'level':{'$first':_0x477084(0x1d0)},'isle':{'$first':_0x477084(0x1e2)},'pallet':{'$first':_0x477084(0x151)},'maxProducts':{'$first':_0x477084(0x1b2)},'unit':{'$first':_0x477084(0x20f)}}}]);_0x855b4a[_0x477084(0x189)](0xc8)[_0x477084(0x14a)](_0x1808d9);}catch(_0x405965){_0x855b4a[_0x477084(0x189)](0x194)['json']({'message':_0x405965[_0x477084(0x1a1)]});}}),router[a0_0x5ee381(0x15e)](a0_0x5ee381(0x205),async(_0x3d939f,_0x1984d0)=>{var _0x1456fc=a0_0x5ee381;const {level:_0x17304f,isle:_0x287986,pallet:_0x584cee,warehouses:_0x423e4a,room:_0x3abec2}=_0x3d939f['body'];try{const _0x1165fa=await warehouse['aggregate']([{'$match':{'name':_0x423e4a,'room':_0x3abec2}},{'$unwind':_0x1456fc(0x17b)},{'$match':{'product_details.level':parseInt(_0x17304f),'product_details.isle':_0x287986,'product_details.pallet':parseInt(_0x584cee)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1456fc(0x18a)},'level':{'$first':_0x1456fc(0x1d0)},'isle':{'$first':_0x1456fc(0x1e2)},'pallet':{'$first':_0x1456fc(0x151)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x1984d0[_0x1456fc(0x189)](0xc8)[_0x1456fc(0x14a)](_0x1165fa);}catch(_0x1131b1){_0x1984d0[_0x1456fc(0x189)](0x194)[_0x1456fc(0x14a)]({'message':_0x1131b1[_0x1456fc(0x1a1)]});}}),module[a0_0x5ee381(0x1b8)]=router;function a0_0x162a(){var _0x5354aa=['then','$product_details.product_code','render','staff','$product_details.production_date','$product_details.secondary_unit','to_types','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','warehouse','to_room_name','language','Portuguese','$date','Ambient','Router','French','product_stock','$product_details.product_name','/barcode_scanner3','product_code3','$invoice','slice','bin','Spanish','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$name','from_prod_qty','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','json','Rack\x20A','to_warehouse','bay','floorlevel','Level','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.pallet','True','secondary_unit','Floor','Logo.png','string','user','19023470Cfmgbz','Rack\x20C','edit_transfer_view','</head><body>','log','from_bay','post','catch','flash','max_per_unit','findById','edit_transfer','type','</tr>','error','<h2>\x20','509297vgAfcS','329682iCAPtx','$product_details.maxPerUnit','from_bin','push','email','TRF-','</span>','Rack\x20B','$product','port','from_prod_isle','717366bkLsOF','here','product_code','Receiving\x20Area','secondary_code','/view/add_transfer','Enclosed','$product_details','toString','$product_details.invoice','to_room','body','getMonth','$from_warehouse','New_Qty_Converted','<tr>','id_transaction','Transfer\x20Mail','English','Raw\x20Materials','from_prod_level','status','$product_details.product_stock','<html><head><title></title>','/transfer/view','German','split','$product_details.bin','from_prod_pallet','RMSEmail','batch_code','Chinese','to_prod_level','filter','product','$room','To_invoice','COLD\x20STORAGE','/upload/','production_date','nodemailer','$product_details.batch_code','sendMail','to_prod_pallet','Email\x20sent\x20successfully','message','Arabic\x20(ae)','$product_details.storage','to_invoice','<div>','to_quantity','$product_details._id','</body></html>','Hindi','role','63nEYccK','/barcode_scanner2','findOne','_id','$isAllowEdit','Transfer\x20Edit\x20Successfully','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.maxProducts','460808ILeUfF','$product_details.type','aggregate','to_prod_qty','$product_details.primary_code','exports','<h5>','<hr\x20class=\x22my-3\x22>','maxProducts','product_name','$product_details.secondary_code','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','id_transaction_id','primary_unit','$product_details.rack','master','invoice','\x20</h2>','360HwaNIt','RoomAssigned','to_floorlevel','from_rack','product_details','/view/:id','find','$finalize','add_transfer','$product_details.level','</div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Portuguese\x20(BR)','to_bay','An\x20error\x20occurred.','</h5>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</table>','errors','from_warehouse','ToRoomAssigned','2EHqxsP','padStart','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Arabic','all','from_room_name','$product_details.isle','\x20Order\x20Date\x20:\x20','3253537uUNyzF','length','storage','note','from_storage','from_rak','get','rack','$product_details.bay','<strong>\x20Regards\x20</strong>','/../public','map','Rack\x20E','forEach','params','/transfer/preview/','floor','expiry_date','redirect','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','from_invoice','primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','4128xfvRdr','Shelves','English\x20(US)','Product\x20Transfer\x20successfully','$product_details.floorlevel','random','</td>','MaxStocks_data2','DRY\x20STORAGE','prod_name','/CheckingWarehouse','createTransport','unit','image','Rack\x20F','$_id','save','to_bin','site_title','\x20<>\x20','$product_details.unit','from_floorlevel','to_prod_isle','date','from_types','host','Return\x20Rooms','express','/preview/:id','$product_details.expiry_date','Enabled','prod_cat','back','success','rak'];a0_0x162a=function(){return _0x5354aa;};return a0_0x162a();}