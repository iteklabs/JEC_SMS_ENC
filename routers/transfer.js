var a0_0x3057c7=a0_0x2455;(function(_0x2651ff,_0x12cd77){var _0x49d723=a0_0x2455,_0x3a1baa=_0x2651ff();while(!![]){try{var _0x5850a4=parseInt(_0x49d723(0x151))/0x1+-parseInt(_0x49d723(0x86))/0x2*(-parseInt(_0x49d723(0x11a))/0x3)+-parseInt(_0x49d723(0xb6))/0x4*(parseInt(_0x49d723(0xf9))/0x5)+-parseInt(_0x49d723(0x169))/0x6*(-parseInt(_0x49d723(0x124))/0x7)+parseInt(_0x49d723(0xa3))/0x8*(parseInt(_0x49d723(0x93))/0x9)+parseInt(_0x49d723(0x91))/0xa+parseInt(_0x49d723(0x114))/0xb*(-parseInt(_0x49d723(0xe4))/0xc);if(_0x5850a4===_0x12cd77)break;else _0x3a1baa['push'](_0x3a1baa['shift']());}catch(_0x373d95){_0x3a1baa['push'](_0x3a1baa['shift']());}}}(a0_0x4c11,0xa6575));const express=require(a0_0x3057c7(0x139)),app=express(),router=express[a0_0x3057c7(0x107)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x3057c7(0x149)),users=require(a0_0x3057c7(0x136)),nodemailer=require(a0_0x3057c7(0xea));router[a0_0x3057c7(0x128)](a0_0x3057c7(0x118),auth,async(_0x237aa5,_0x597237)=>{var _0x10ec8e=a0_0x3057c7;try{const {username:_0x1008ed,email:_0x5d6b8e,role:_0x482706}=_0x237aa5[_0x10ec8e(0xe6)],_0x3be175=_0x237aa5['user'],_0x19106d=await profile['findOne']({'email':_0x3be175['email']}),_0x4e24c9=await master_shop['find']();console[_0x10ec8e(0xc2)]('master',_0x4e24c9);let _0x433dc0;if(_0x3be175['role']==_0x10ec8e(0x116)){const _0x7edb2b=await staff[_0x10ec8e(0x140)]({'email':_0x3be175[_0x10ec8e(0x17a)]});_0x433dc0=await transfers['find']({'from_warehouse':_0x7edb2b[_0x10ec8e(0x120)]});}else _0x433dc0=await transfers[_0x10ec8e(0x143)]([{'$unwind':_0x10ec8e(0x175)},{'$group':{'_id':_0x10ec8e(0xf6),'invoice':{'$first':_0x10ec8e(0x141)},'date':{'$first':_0x10ec8e(0xf8)},'from_warehouse':{'$first':_0x10ec8e(0x12f)},'to_warehouse':{'$first':_0x10ec8e(0x14e)},'from_room_name':{'$addToSet':_0x10ec8e(0x8d)},'to_room_name':{'$addToSet':_0x10ec8e(0xeb)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x10ec8e(0x89)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4e24c9[0x0][_0x10ec8e(0xd9)]==_0x10ec8e(0x8e)){var _0x27cc49=users['English'];console[_0x10ec8e(0xc2)](_0x27cc49);}else{if(_0x4e24c9[0x0][_0x10ec8e(0xd9)]==_0x10ec8e(0xf7))var _0x27cc49=users[_0x10ec8e(0xf7)];else{if(_0x4e24c9[0x0][_0x10ec8e(0xd9)]==_0x10ec8e(0xdc))var _0x27cc49=users[_0x10ec8e(0xdc)];else{if(_0x4e24c9[0x0][_0x10ec8e(0xd9)]=='Spanish')var _0x27cc49=users['Spanish'];else{if(_0x4e24c9[0x0][_0x10ec8e(0xd9)]==_0x10ec8e(0xf0))var _0x27cc49=users[_0x10ec8e(0xf0)];else{if(_0x4e24c9[0x0][_0x10ec8e(0xd9)]==_0x10ec8e(0xba))var _0x27cc49=users[_0x10ec8e(0xa0)];else{if(_0x4e24c9[0x0][_0x10ec8e(0xd9)]==_0x10ec8e(0x17b))var _0x27cc49=users[_0x10ec8e(0x17b)];else{if(_0x4e24c9[0x0][_0x10ec8e(0xd9)]=='Arabic\x20(ae)')var _0x27cc49=users[_0x10ec8e(0xdd)];}}}}}}}_0x597237[_0x10ec8e(0xb0)](_0x10ec8e(0x16d),{'success':_0x237aa5[_0x10ec8e(0x108)](_0x10ec8e(0xe7)),'errors':_0x237aa5[_0x10ec8e(0x108)](_0x10ec8e(0xfd)),'role':_0x3be175,'profile':_0x19106d,'master_shop':_0x4e24c9,'transfer':_0x433dc0,'language':_0x27cc49});}catch(_0x5e1644){console[_0x10ec8e(0xc2)](_0x5e1644);}});async function getRandom8DigitNumber(){var _0x514699=a0_0x3057c7;const _0xa88a5d=0x989680,_0x1ef91a=0x5f5e0ff,_0x326418=Math[_0x514699(0xb8)](Math['random']()*(_0x1ef91a-_0xa88a5d+0x1))+_0xa88a5d;var _0xa3193f;const _0x1fb6ea=await transfers['findOne']({'invoice':_0x514699(0x9b)+_0x326418});return _0x1fb6ea&&_0x1fb6ea[_0x514699(0x14b)]>0x0?_0xa3193f=_0x514699(0x9b)+_0x326418:_0xa3193f='TRF-'+_0x326418,_0xa3193f;}function a0_0x4c11(){var _0x29051f=['<thead\x20style=\x22width:\x20100%\x20!important;\x22>','\x20</h2>','Portuguese','bay','An\x20error\x20occurred\x20while\x20saving\x20data.','8nHyMLA','$product_details.product_stock','$product_details.maxPerUnit','<span\x20style=\x22float:\x20right;\x22>','English','Spanish','$product_details.rack','Rack\x20A','from_bay','date','</td>','\x20Order\x20Date\x20:\x20','prod_cat','render','product_code3','<h5>','$product_details.type','from_types','from_prod_qty','12SPxQww','from_storage','floor','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Portuguese\x20(BR)','redirect','expiry_date','port','primary_unit','</body></html>','max_per_unit','</span>','log','add_transfer','MaxStocks_data2','DRY\x20STORAGE','from_bin','product_name','invoice','/barcode_scanner3','Raw\x20Materials','/transfer/preview/','product','Product\x20Transfer\x20successfully','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','to_types','\x20Order\x20Number\x20:\x20','floorlevel','secondary_code','to_prod_pallet','$product_details.floorlevel','unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.primary_code','language','Arabic\x20(ae)','find','German','Arabic','$product_details.production_date','storage','slice','to_floorlevel','Ambient','id_transaction','44940aVVShk','$product_details.level','user','success','$product_details.isle','updateOne','nodemailer','$product.to_room_name','then','getMonth','production_date','maxProducts','French','password','$product_details.bay','map','post','<div>','$_id','Hindi','$date','1310025KFLUnu','maxperunit','json','product_code','errors','<tr>','Error\x20Occurs','Rack\x20E','note','getDate','</thead>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Transfer\x20Finalize\x20Successfully','$room','Router','flash','<tbody\x20style=\x22text-align:\x20center;\x22>','prod_name','status','from_invoice','/barcode_scanner','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/transfer/view','toString','product_details','to_bay','from_rack','8899FPDtoN','rak','staff','/view/:id','/view','Rack\x20C','2417412BlqcVj','string','RMSEmail','from_prod_pallet','role','</table>','warehouse','$product_details.expiry_date','</tr>','site_title','1334291sKLFoq','ToRoomAssigned','/barcode_scanner2','getFullYear','get','</h5>','findById','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.product_code','</head><body>','finalize','$from_warehouse','params','to_quantity','Transfer\x20Mail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/picking_list/PDF_transfer_rm/','$product_details.secondary_code','../public/language/languages.json','from_quantity','New_Qty_Converted','express','<h2>\x20','error','message','from_warehouse','/preview/:id','master','findOne','$invoice','Level','aggregate','filter','type','from_prod_isle','$product_details.secondary_unit','id_transaction_id','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','length','to_room_name','rack','$to_warehouse','Rack\x20F','$product_details','767664aFYzAI','from_room','$product_details.bin','all','edit_transfer','COLD\x20STORAGE','/CheckingWarehouse','to_warehouse','To_invoice','Shelves','$product_details.pallet','$product_details.batch_code','from_prod_level','An\x20error\x20occurred.','to_bin','$product_details.storage','batch_code','product_stock','$product_details.product_name','Receiving\x20Area','Rack\x20D','/view/add_transfer','forEach','RoomAssigned','12ltNfJF','from_rak','secondary_unit','</div>','transfer','$product_details.maxProducts','Enabled','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','bin','True','concat','body','$product','$product_details.unit','catch','/../public','$product_details._id','email','Chinese','Floor','to_prod_level','_id','2ZtQpgz','primary_code','Rack\x20B','$isAllowEdit','logo','back','\x20<>\x20','$product.from_room_name','English\x20(US)','exports','Enclosed','13051710fAcTGW','save','11134692ChuTiU','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$name','from_floorlevel','to_invoice','Logo.png','$product_details.invoice','from_room_name','TRF-','to_room','createTransport'];a0_0x4c11=function(){return _0x29051f;};return a0_0x4c11();}function a0_0x2455(_0x4d805e,_0x2f1c1e){var _0x4c115c=a0_0x4c11();return a0_0x2455=function(_0x245557,_0x3f9652){_0x245557=_0x245557-0x86;var _0x2049c1=_0x4c115c[_0x245557];return _0x2049c1;},a0_0x2455(_0x4d805e,_0x2f1c1e);}router[a0_0x3057c7(0x128)](a0_0x3057c7(0x166),auth,async(_0x1c7860,_0x5e4ba6)=>{var _0x5b8411=a0_0x3057c7;try{const {username:_0x440454,email:_0x11aa07,role:_0x15e641}=_0x1c7860[_0x5b8411(0xe6)],_0x44b3de=_0x1c7860[_0x5b8411(0xe6)],_0x49887a=await profile[_0x5b8411(0x140)]({'email':_0x44b3de[_0x5b8411(0x17a)]}),_0x199e4b=await master_shop[_0x5b8411(0xdb)]();console[_0x5b8411(0xc2)](_0x5b8411(0x13f),_0x199e4b);let _0x16999c;if(_0x44b3de[_0x5b8411(0x11e)]=='staff'){const _0x60fc3=await staff[_0x5b8411(0x140)]({'email':_0x44b3de[_0x5b8411(0x17a)]});_0x16999c=await warehouse[_0x5b8411(0x143)]([{'$match':{'status':_0x5b8411(0x16f),'name':_0x60fc3[_0x5b8411(0x120)],'warehouse_category':_0x5b8411(0xca)}},{'$group':{'_id':_0x5b8411(0x95),'name':{'$first':_0x5b8411(0x95)}}}]);}else _0x16999c=await warehouse[_0x5b8411(0x143)]([{'$match':{'status':'Enabled','warehouse_category':_0x5b8411(0xca)}},{'$group':{'_id':_0x5b8411(0x95),'name':{'$first':_0x5b8411(0x95)}}}]);var _0x27a817=[_0x5b8411(0xe2),_0x5b8411(0x90),'Return\x20Rooms'];const _0x14454f=await transfers[_0x5b8411(0xdb)]({}),_0x1e6cef=_0x14454f['length']+0x1,_0x31e017='TRF-'+_0x1e6cef[_0x5b8411(0x110)]()['padStart'](0x5,'0');if(_0x199e4b[0x0]['language']==_0x5b8411(0x8e)){var _0x39d495=users[_0x5b8411(0xa7)];console[_0x5b8411(0xc2)](_0x39d495);}else{if(_0x199e4b[0x0][_0x5b8411(0xd9)]==_0x5b8411(0xf7))var _0x39d495=users[_0x5b8411(0xf7)];else{if(_0x199e4b[0x0][_0x5b8411(0xd9)]==_0x5b8411(0xdc))var _0x39d495=users['German'];else{if(_0x199e4b[0x0][_0x5b8411(0xd9)]=='Spanish')var _0x39d495=users[_0x5b8411(0xa8)];else{if(_0x199e4b[0x0]['language']==_0x5b8411(0xf0))var _0x39d495=users[_0x5b8411(0xf0)];else{if(_0x199e4b[0x0][_0x5b8411(0xd9)]==_0x5b8411(0xba))var _0x39d495=users['Portuguese'];else{if(_0x199e4b[0x0][_0x5b8411(0xd9)]==_0x5b8411(0x17b))var _0x39d495=users['Chinese'];else{if(_0x199e4b[0x0][_0x5b8411(0xd9)]=='Arabic\x20(ae)')var _0x39d495=users[_0x5b8411(0xdd)];}}}}}}}const _0x41d74f=getRandom8DigitNumber();_0x41d74f['then'](_0xbdbbb8=>{var _0x58260c=_0x5b8411;_0x5e4ba6['render'](_0x58260c(0xc3),{'success':_0x1c7860[_0x58260c(0x108)](_0x58260c(0xe7)),'errors':_0x1c7860[_0x58260c(0x108)](_0x58260c(0xfd)),'role':_0x44b3de,'profile':_0x49887a,'master_shop':_0x199e4b,'warehouse':_0x16999c,'language':_0x39d495,'rooms_data':_0x27a817,'invoice':_0xbdbbb8});})[_0x5b8411(0x177)](_0x517c58=>{var _0x80b6f=_0x5b8411;_0x1c7860[_0x80b6f(0x108)](_0x80b6f(0xfd),_0x80b6f(0xce)),_0x5e4ba6[_0x80b6f(0xbb)](_0x80b6f(0x10f));});}catch(_0x5826bc){console[_0x5b8411(0xc2)](_0x5826bc);}}),router[a0_0x3057c7(0xf4)]('/view/add_transfer',auth,async(_0x378d85,_0x5dcfb1)=>{var _0x73d6f3=a0_0x3057c7;try{console[_0x73d6f3(0xc2)](_0x378d85['body']);const {date:_0x3a65b6,from_warehouse:_0x5b4b92,FromRoom_name:_0xe2d28e,to_warehouse:_0x1c3581,ToRoom_name:_0x497dea,prod_name:_0xb53612,from_prod_qty:_0x534931,from_prod_level:_0x3ed455,from_prod_isle:_0x4d13d5,from_prod_pallet:_0x4077b3,to_prod_qty:_0x5b5400,to_prod_level:_0x4daf73,to_prod_isle:_0x4f7373,to_prod_pallet:_0xe379f4,primary_code:_0x1f68f0,secondary_code:_0x311bd8,product_code3:_0x533c75,note:_0x24e01b,MaxStocks_data2:_0x415a82,invoice:_0x3af286,expiry_date:_0x5c31b1}=_0x378d85[_0x73d6f3(0x174)];if(typeof _0xb53612=='string')var _0x425e57=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x10a)]],_0x2c137c=[_0x378d85['body'][_0x73d6f3(0xb5)]],_0x401859=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x15d)]],_0x11d202=[_0x378d85['body']['New_Qty_Converted']],_0x4f36fc=[_0x378d85['body'][_0x73d6f3(0x17d)]],_0x15a695=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x87)]],_0x44dff6=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xd3)]],_0x10bc00=[_0x378d85['body']['product_code3']],_0x22522f=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xc4)]],_0x37975b=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xbe)]],_0x406b2f=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x16b)]],_0x304d79=[_0x378d85['body']['batch_code']],_0x1285dd=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xbc)]],_0x3be922=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xc0)]],_0x4b36e5=[_0x378d85[_0x73d6f3(0x174)]['production_date']],_0x2ac89d=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xaf)]],_0x42fced=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x168)]],_0x27ffeb=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x125)]],_0x10ddee=[_0x378d85['body'][_0x73d6f3(0x10c)]],_0x1853f9=[_0x378d85['body'][_0x73d6f3(0x97)]],_0xe12e96=[_0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xe3)]];else var _0x425e57=[..._0x378d85[_0x73d6f3(0x174)]['prod_name']],_0x2c137c=[..._0x378d85['body'][_0x73d6f3(0xb5)]],_0x401859=[..._0x378d85[_0x73d6f3(0x174)]['from_prod_level']],_0x11d202=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x138)]],_0x4f36fc=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x17d)]],_0x15a695=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x87)]],_0x44dff6=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xd3)]],_0x10bc00=[..._0x378d85['body'][_0x73d6f3(0xb1)]],_0x22522f=[..._0x378d85[_0x73d6f3(0x174)]['MaxStocks_data2']],_0x37975b=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xbe)]],_0x406b2f=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x16b)]],_0x304d79=[..._0x378d85[_0x73d6f3(0x174)]['batch_code']],_0x1285dd=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xbc)]],_0x3be922=[..._0x378d85[_0x73d6f3(0x174)]['max_per_unit']],_0x4b36e5=[..._0x378d85[_0x73d6f3(0x174)]['production_date']],_0x2ac89d=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xaf)]],_0x42fced=[..._0x378d85['body'][_0x73d6f3(0x168)]],_0x27ffeb=[..._0x378d85['body']['ToRoomAssigned']],_0x10ddee=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0x10c)]],_0x1853f9=[..._0x378d85['body'][_0x73d6f3(0x97)]],_0xe12e96=[..._0x378d85[_0x73d6f3(0x174)][_0x73d6f3(0xe3)]];const _0xf870f5=_0x425e57[_0x73d6f3(0xf3)](_0x456bdb=>{return _0x456bdb={'product_name':_0x456bdb};});_0x2c137c[_0x73d6f3(0x167)]((_0x4362bb,_0x442fd3)=>{var _0x2908d8=_0x73d6f3;_0xf870f5[_0x442fd3][_0x2908d8(0x137)]=_0x4362bb;}),_0x10ddee[_0x73d6f3(0x167)]((_0x4c65f9,_0x43ab73)=>{var _0x3f461a=_0x73d6f3;_0xf870f5[_0x43ab73][_0x3f461a(0x10c)]=_0x4c65f9;}),_0x1853f9[_0x73d6f3(0x167)]((_0x2691ad,_0x39dece)=>{var _0x272eb8=_0x73d6f3;_0xf870f5[_0x39dece][_0x272eb8(0x159)]=_0x2691ad;}),_0xe12e96['forEach']((_0x2e8669,_0x2d80ea)=>{var _0x2fb8df=_0x73d6f3;_0xf870f5[_0x2d80ea][_0x2fb8df(0x148)]=_0x2e8669;}),_0x401859[_0x73d6f3(0x167)]((_0x5f4e18,_0x5a755f)=>{var _0x5c21e0=_0x73d6f3;_0x42fced[_0x5c21e0(0x167)]((_0x473da5,_0x560efc)=>{var _0x59b39d=_0x5c21e0;if(_0x473da5=='Receiving\x20Area'&&_0x5a755f==_0x560efc){var _0x4a5497=_0x5f4e18[_0x59b39d(0xe0)](0x3);_0xf870f5[_0x5a755f][_0x59b39d(0xb7)]=_0x5f4e18[0x0],_0xf870f5[_0x5a755f][_0x59b39d(0x113)]=_0x5f4e18[0x1],_0xf870f5[_0x5a755f]['from_bay']=0x0,_0xf870f5[_0x5a755f]['from_bin']=0x0,_0xf870f5[_0x5a755f][_0x59b39d(0xb4)]=_0x59b39d(0x17c),_0xf870f5[_0x5a755f][_0x59b39d(0x96)]=_0x4a5497;}else{if(_0x473da5==_0x59b39d(0x15a)&&_0x5a755f==_0x560efc){var _0x4a5497=_0x5f4e18[_0x59b39d(0xe0)](0x3);_0xf870f5[_0x5a755f][_0x59b39d(0xb7)]=_0x5f4e18[0x0],_0xf870f5[_0x5a755f][_0x59b39d(0x113)]=_0x5f4e18[0x1],_0xf870f5[_0x5a755f][_0x59b39d(0xab)]=0x0,_0xf870f5[_0x5a755f][_0x59b39d(0xc6)]=0x0,_0xf870f5[_0x5a755f]['from_types']='Floor',_0xf870f5[_0x5a755f][_0x59b39d(0x96)]=_0x5f4e18[0x5];}else{if(_0x5a755f==_0x560efc){if(_0x5f4e18[0x0]=='A'&&_0x5f4e18[0x1]=='L'&&_0x5f4e18[0x2]=='L')console['log'](_0x473da5+_0x59b39d(0x8c)+_0x5a755f+_0x59b39d(0x8c)+_0x560efc+_0x59b39d(0x8c)+_0x5f4e18+'here'),_0xf870f5[_0x5a755f]['from_storage']=_0x5f4e18[0x0],_0xf870f5[_0x5a755f][_0x59b39d(0x113)]=_0x5f4e18[0x1],_0xf870f5[_0x5a755f]['from_bay']=0x0,_0xf870f5[_0x5a755f][_0x59b39d(0xc6)]=0x0,_0xf870f5[_0x5a755f][_0x59b39d(0xb4)]=_0x59b39d(0x17c),_0xf870f5[_0x5a755f]['from_floorlevel']=_0x5f4e18[0x3];else{var _0x960142;if(_0x5f4e18[0x4]=='L')_0x960142=_0x59b39d(0x142);else _0x5f4e18[0x4]=='F'&&(_0x960142=_0x59b39d(0x17c));_0xf870f5[_0x5a755f][_0x59b39d(0xb7)]=_0x5f4e18[0x0],_0xf870f5[_0x5a755f][_0x59b39d(0x113)]=_0x5f4e18[0x1],_0xf870f5[_0x5a755f]['from_bay']=_0x5f4e18[0x2],_0xf870f5[_0x5a755f][_0x59b39d(0xc6)]=_0x5f4e18[0x3],_0xf870f5[_0x5a755f][_0x59b39d(0xb4)]=_0x960142,_0xf870f5[_0x5a755f][_0x59b39d(0x96)]=_0x5f4e18[0x5];}}}}});}),_0x11d202[_0x73d6f3(0x167)]((_0x3449e7,_0xee4a45)=>{_0xf870f5[_0xee4a45]['to_quantity']=_0x3449e7;}),_0x4f36fc[_0x73d6f3(0x167)]((_0x368e6a,_0xe4a09b)=>{_0x27ffeb['forEach']((_0x418b2f,_0x513efc)=>{var _0x24bb8a=a0_0x2455;if(_0x418b2f==_0x24bb8a(0x164)&&_0xe4a09b==_0x513efc){var _0x365e3a=_0x368e6a[_0x24bb8a(0xe0)](0x3);_0xf870f5[_0xe4a09b][_0x24bb8a(0xdf)]=_0x368e6a[0x0],_0xf870f5[_0xe4a09b][_0x24bb8a(0x14d)]=_0x368e6a[0x1],_0xf870f5[_0xe4a09b]['to_bay']=0x0,_0xf870f5[_0xe4a09b][_0x24bb8a(0x15f)]=0x0,_0xf870f5[_0xe4a09b]['to_types']='Floor',_0xf870f5[_0xe4a09b][_0x24bb8a(0xe1)]=_0x365e3a;}else{if(_0x418b2f==_0x24bb8a(0x15a)&&_0xe4a09b==_0x513efc){var _0x365e3a=_0x368e6a[_0x24bb8a(0xe0)](0x3);_0xf870f5[_0xe4a09b][_0x24bb8a(0xdf)]=_0x368e6a[0x0],_0xf870f5[_0xe4a09b]['rack']=_0x368e6a[0x1],_0xf870f5[_0xe4a09b][_0x24bb8a(0x112)]=0x0,_0xf870f5[_0xe4a09b]['to_bin']=0x0,_0xf870f5[_0xe4a09b]['to_types']=_0x24bb8a(0x17c),_0xf870f5[_0xe4a09b][_0x24bb8a(0xe1)]=_0x368e6a[0x5];}else{if(_0xe4a09b==_0x513efc){if(_0x368e6a[0x0]=='A'&&_0x368e6a[0x1]=='L'&&_0x368e6a[0x2]=='L')console[_0x24bb8a(0xc2)](_0x418b2f+_0x24bb8a(0x8c)+_0xe4a09b+_0x24bb8a(0x8c)+_0x513efc+_0x24bb8a(0x8c)+_0x368e6a+'here'),_0xf870f5[_0xe4a09b][_0x24bb8a(0xdf)]=_0x368e6a[0x0],_0xf870f5[_0xe4a09b][_0x24bb8a(0x14d)]=_0x368e6a[0x1],_0xf870f5[_0xe4a09b]['to_bay']=0x0,_0xf870f5[_0xe4a09b][_0x24bb8a(0x15f)]=0x0,_0xf870f5[_0xe4a09b]['to_types']='Floor',_0xf870f5[_0xe4a09b]['to_floorlevel']=_0x368e6a[0x3];else{var _0xa8ab68;if(_0x368e6a[0x4]=='L')_0xa8ab68=_0x24bb8a(0x142);else _0x368e6a[0x4]=='F'&&(_0xa8ab68=_0x24bb8a(0x17c));_0xf870f5[_0xe4a09b]['storage']=_0x368e6a[0x0],_0xf870f5[_0xe4a09b][_0x24bb8a(0x14d)]=_0x368e6a[0x1],_0xf870f5[_0xe4a09b][_0x24bb8a(0x112)]=_0x368e6a[0x2],_0xf870f5[_0xe4a09b]['to_bin']=_0x368e6a[0x3],_0xf870f5[_0xe4a09b][_0x24bb8a(0xd0)]=_0xa8ab68,_0xf870f5[_0xe4a09b]['to_floorlevel']=_0x368e6a[0x5];}}}}});}),_0x15a695[_0x73d6f3(0x167)]((_0x3e719e,_0x4d5cd3)=>{var _0x20cf8c=_0x73d6f3;_0xf870f5[_0x4d5cd3][_0x20cf8c(0x87)]=_0x3e719e;}),_0x44dff6['forEach']((_0x61d256,_0x2c6218)=>{var _0x2d3d39=_0x73d6f3;_0xf870f5[_0x2c6218][_0x2d3d39(0xd3)]=_0x61d256;}),_0x10bc00[_0x73d6f3(0x167)]((_0x2be444,_0x20c38f)=>{var _0x5bf42c=_0x73d6f3;_0xf870f5[_0x20c38f][_0x5bf42c(0xfc)]=_0x2be444;}),_0x22522f[_0x73d6f3(0x167)]((_0x1d4a0d,_0x207140)=>{_0xf870f5[_0x207140]['maxProducts']=_0x1d4a0d;}),_0x37975b['forEach']((_0x5e70e2,_0x3f9dcc)=>{var _0x142c72=_0x73d6f3;_0xf870f5[_0x3f9dcc][_0x142c72(0xd6)]=_0x5e70e2;}),_0x406b2f[_0x73d6f3(0x167)]((_0x25a739,_0x2c54ba)=>{var _0x48611d=_0x73d6f3;_0xf870f5[_0x2c54ba][_0x48611d(0x16b)]=_0x25a739;}),_0x304d79['forEach']((_0x3fe817,_0x491572)=>{var _0x402bf5=_0x73d6f3;_0xf870f5[_0x491572][_0x402bf5(0x161)]=_0x3fe817;}),_0x1285dd['forEach']((_0x288056,_0x13dfea)=>{_0xf870f5[_0x13dfea]['expiry_date']=_0x288056;}),_0x3be922[_0x73d6f3(0x167)]((_0x33fb17,_0x2df048)=>{_0xf870f5[_0x2df048]['maxperunit']=_0x33fb17;}),_0x4b36e5[_0x73d6f3(0x167)]((_0x177d73,_0x1bbf71)=>{var _0x3d1efd=_0x73d6f3;_0xf870f5[_0x1bbf71][_0x3d1efd(0xee)]=_0x177d73;}),_0x2ac89d[_0x73d6f3(0x167)]((_0x1e996b,_0xc80a22)=>{var _0x439e86=_0x73d6f3;_0xf870f5[_0xc80a22][_0x439e86(0xaf)]=_0x1e996b;}),_0x42fced[_0x73d6f3(0x167)]((_0x2c9ef6,_0xf1edfe)=>{var _0x4519c8=_0x73d6f3;_0xf870f5[_0xf1edfe][_0x4519c8(0x9a)]=_0x2c9ef6;}),_0x27ffeb['forEach']((_0x2373ae,_0x326cd4)=>{var _0x3dd4aa=_0x73d6f3;_0xf870f5[_0x326cd4][_0x3dd4aa(0x14c)]=_0x2373ae;});const _0x5656b0=_0xf870f5[_0x73d6f3(0x144)](_0x54ff04=>_0x54ff04[_0x73d6f3(0x131)]!=='0'&&_0x54ff04[_0x73d6f3(0x131)]!==''||_0x54ff04[_0x73d6f3(0xe1)]!=='0'&&_0x54ff04[_0x73d6f3(0xe1)]!==''),_0x2725dc=new transfers({'date':_0x3a65b6,'from_warehouse':_0x5b4b92,'to_warehouse':_0x1c3581,'product':_0x5656b0,'note':_0x24e01b,'invoice':_0x3af286}),_0x141fe6=await _0x2725dc[_0x73d6f3(0x92)]();_0x378d85[_0x73d6f3(0x108)](_0x73d6f3(0xe7),_0x73d6f3(0xcd)),_0x5dcfb1['redirect'](_0x73d6f3(0xcb)+_0x141fe6[_0x73d6f3(0x17e)]);}catch(_0x5cc652){console['log'](_0x5cc652),_0x5dcfb1['status'](0xc8)[_0x73d6f3(0xfb)]({'errorMessage':_0x5cc652[_0x73d6f3(0x13c)]});}}),router[a0_0x3057c7(0x128)](a0_0x3057c7(0x13e),auth,async(_0x4d7fa0,_0x486b08)=>{var _0x4dab9c=a0_0x3057c7;try{const {username:_0x1dcbc8,email:_0x59c43a,role:_0x481a11}=_0x4d7fa0[_0x4dab9c(0xe6)],_0x3a85a5=_0x4d7fa0[_0x4dab9c(0xe6)],_0x44bb73=await profile[_0x4dab9c(0x140)]({'email':_0x3a85a5['email']}),_0x3e8f04=await master_shop[_0x4dab9c(0xdb)]();console[_0x4dab9c(0xc2)]('master',_0x3e8f04);const _0x42732c=await transfers[_0x4dab9c(0x12a)](_0x4d7fa0[_0x4dab9c(0x130)]['id']);let _0x3257eb=new Date(_0x42732c[_0x4dab9c(0xbc)]),_0x13c08d=('0'+_0x3257eb[_0x4dab9c(0x102)]())[_0x4dab9c(0xe0)](-0x2),_0x2b9ef5=('0'+(_0x3257eb[_0x4dab9c(0xed)]()+0x1))[_0x4dab9c(0xe0)](-0x2),_0xcf1b96=_0x3257eb[_0x4dab9c(0x127)](),_0x37667a=_0xcf1b96+'-'+_0x2b9ef5+'-'+_0x13c08d,_0x185013;if(_0x3a85a5[_0x4dab9c(0x11e)]==_0x4dab9c(0x116)){const _0x598a8f=await staff['findOne']({'email':_0x3a85a5['email']});_0x185013=await warehouse['find']({'status':'Enabled','name':_0x598a8f[_0x4dab9c(0x120)],'warehouse_category':_0x4dab9c(0xca)});}else _0x185013=await warehouse['find']({'status':_0x4dab9c(0x16f),'warehouse_category':_0x4dab9c(0xca)});const _0x3a2976=await warehouse['aggregate']([{'$match':{'name':_0x42732c['from_warehouse']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4dab9c(0x179),'name':{'$first':_0x4dab9c(0x163)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4dab9c(0xb3)},'floorlevel':{'$first':_0x4dab9c(0xd5)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4dab9c(0x135)},'product_code':{'$first':_0x4dab9c(0x12c)},'storage':{'$first':_0x4dab9c(0x160)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4dab9c(0x121)},'production_date':{'$first':_0x4dab9c(0xde)},'room':{'$first':_0x4dab9c(0x106)}}}]);if(_0x3e8f04[0x0][_0x4dab9c(0xd9)]==_0x4dab9c(0x8e)){var _0x2b1989=users[_0x4dab9c(0xa7)];console[_0x4dab9c(0xc2)](_0x2b1989);}else{if(_0x3e8f04[0x0]['language']==_0x4dab9c(0xf7))var _0x2b1989=users[_0x4dab9c(0xf7)];else{if(_0x3e8f04[0x0]['language']==_0x4dab9c(0xdc))var _0x2b1989=users['German'];else{if(_0x3e8f04[0x0]['language']==_0x4dab9c(0xa8))var _0x2b1989=users[_0x4dab9c(0xa8)];else{if(_0x3e8f04[0x0][_0x4dab9c(0xd9)]=='French')var _0x2b1989=users[_0x4dab9c(0xf0)];else{if(_0x3e8f04[0x0][_0x4dab9c(0xd9)]=='Portuguese\x20(BR)')var _0x2b1989=users['Portuguese'];else{if(_0x3e8f04[0x0]['language']==_0x4dab9c(0x17b))var _0x2b1989=users[_0x4dab9c(0x17b)];else{if(_0x3e8f04[0x0][_0x4dab9c(0xd9)]=='Arabic\x20(ae)')var _0x2b1989=users[_0x4dab9c(0xdd)];}}}}}}}_0x486b08[_0x4dab9c(0xb0)]('edit_transfer_view',{'success':_0x4d7fa0['flash'](_0x4dab9c(0xe7)),'errors':_0x4d7fa0[_0x4dab9c(0x108)](_0x4dab9c(0xfd)),'role':_0x3a85a5,'profile':_0x44bb73,'master_shop':_0x3e8f04,'warehouse':_0x185013,'transfer':_0x42732c,'stock':_0x3a2976,'language':_0x2b1989});}catch(_0x27e7fd){console['log'](_0x27e7fd);}}),router['post'](a0_0x3057c7(0x13e),auth,async(_0x30f0b5,_0x3006ff)=>{var _0x3369c5=a0_0x3057c7;try{const _0x1f96f4=_0x30f0b5[_0x3369c5(0x130)]['id'],{from_warehouse:_0x13e226,FromRoom_name:_0x227de4,to_warehouse:_0x2fe857,ToRoom_name:_0x5ecdcc}=_0x30f0b5[_0x3369c5(0x174)],_0x25d333=await transfers[_0x3369c5(0x12a)]({'_id':_0x1f96f4}),_0x492d62=_0x25d333[_0x3369c5(0xcc)][_0x3369c5(0xf3)](async _0x4aaeea=>{var _0x1070a7=_0x3369c5;if(_0x4aaeea[_0x1070a7(0x131)]>0x0){var _0x25f856=await warehouse['findOne']({'name':_0x25d333[_0x1070a7(0x13d)],'room':_0x4aaeea[_0x1070a7(0x9a)],'warehouse_category':_0x1070a7(0xca)});const _0x8927ea=_0x25f856['product_details'][_0x1070a7(0xf3)](_0xf24da2=>{var _0xcc6ac7=_0x1070a7;_0xf24da2[_0xcc6ac7(0xc7)]==_0x4aaeea[_0xcc6ac7(0xc7)]&&_0xf24da2[_0xcc6ac7(0xd2)]==_0x4aaeea['from_floorlevel']&&_0xf24da2[_0xcc6ac7(0x145)]==_0x4aaeea['from_types']&&_0xf24da2[_0xcc6ac7(0x171)]==_0x4aaeea[_0xcc6ac7(0xc6)]&&_0xf24da2[_0xcc6ac7(0xa1)]==_0x4aaeea[_0xcc6ac7(0xab)]&&_0xf24da2['rack']==_0x4aaeea['from_rack']&&_0xf24da2['storage']==_0x4aaeea['from_storage']&&_0xf24da2[_0xcc6ac7(0xbc)]==_0x4aaeea[_0xcc6ac7(0xbc)]&&_0xf24da2[_0xcc6ac7(0x161)]==_0x4aaeea['batch_code']&&_0xf24da2[_0xcc6ac7(0xee)]==_0x4aaeea[_0xcc6ac7(0xee)]&&_0xf24da2[_0xcc6ac7(0xc8)]==_0x4aaeea['from_invoice']&&_0xf24da2['_id']==_0x4aaeea[_0xcc6ac7(0x148)]&&(_0xf24da2[_0xcc6ac7(0x162)]=_0xf24da2[_0xcc6ac7(0x162)]-_0x4aaeea[_0xcc6ac7(0x131)]);});}return _0x25f856;});Promise[_0x3369c5(0x154)](_0x492d62)[_0x3369c5(0xec)](async _0x1db6f8=>{var _0x1307de=_0x3369c5;try{for(const _0x5652d2 of _0x1db6f8){await _0x5652d2['save']();}try{const _0x494e18=_0x25d333[_0x1307de(0xcc)]['map'](async _0x1dca81=>{var _0x3064de=_0x1307de;if(_0x1dca81[_0x3064de(0x131)]>0x0){var _0x437dfe=await warehouse[_0x3064de(0x140)]({'name':_0x25d333[_0x3064de(0x158)],'room':_0x1dca81[_0x3064de(0x14c)],'warehouse_category':_0x3064de(0xca)}),_0x358ea5=0x0;const _0x2a5596=_0x437dfe[_0x3064de(0x111)][_0x3064de(0xf3)](_0x48ca4c=>{var _0x489e81=_0x3064de;_0x48ca4c['product_name']==_0x1dca81[_0x489e81(0xc7)]&&_0x48ca4c[_0x489e81(0xd2)]==_0x1dca81[_0x489e81(0xe1)]&&_0x48ca4c[_0x489e81(0x145)]==_0x1dca81[_0x489e81(0xd0)]&&_0x48ca4c[_0x489e81(0x171)]==_0x1dca81[_0x489e81(0x15f)]&&_0x48ca4c[_0x489e81(0xa1)]==_0x1dca81[_0x489e81(0x112)]&&_0x48ca4c['rack']==_0x1dca81[_0x489e81(0x14d)]&&_0x48ca4c[_0x489e81(0xdf)]==_0x1dca81[_0x489e81(0xdf)]&&_0x48ca4c[_0x489e81(0xbc)]==_0x1dca81['expiry_date']&&_0x48ca4c[_0x489e81(0x161)]==_0x1dca81['batch_code']&&_0x48ca4c['production_date']==_0x1dca81[_0x489e81(0xee)]&&_0x48ca4c['invoice']==_0x1dca81[_0x489e81(0x159)]&&(_0x48ca4c[_0x489e81(0x162)]=_0x48ca4c[_0x489e81(0x162)]+_0x1dca81[_0x489e81(0x131)],_0x358ea5++);});_0x358ea5=='0'&&(_0x437dfe['product_details']=_0x437dfe[_0x3064de(0x111)][_0x3064de(0x173)]({'product_name':_0x1dca81[_0x3064de(0xc7)],'product_stock':_0x1dca81[_0x3064de(0x131)],'bay':_0x1dca81['to_bay'],'bin':_0x1dca81[_0x3064de(0x15f)],'type':_0x1dca81[_0x3064de(0xd0)],'floorlevel':_0x1dca81[_0x3064de(0xe1)],'storage':_0x1dca81[_0x3064de(0xdf)],'rack':_0x1dca81['rack'],'product_code':_0x1dca81[_0x3064de(0xfc)],'primary_code':_0x1dca81['primary_code'],'secondary_code':_0x1dca81['secondary_code'],'maxProducts':_0x1dca81[_0x3064de(0xef)],'storage':_0x1dca81[_0x3064de(0xdf)],'rack':_0x1dca81['rack'],'expiry_date':_0x1dca81[_0x3064de(0xbc)],'maxPerUnit':_0x1dca81[_0x3064de(0xfa)],'batch_code':_0x1dca81[_0x3064de(0x161)],'production_date':_0x1dca81[_0x3064de(0xee)]}));}return _0x437dfe;});Promise['all'](_0x494e18)[_0x1307de(0xec)](async _0x5e2a2e=>{var _0x47cb46=_0x1307de;try{for(const _0xf70727 of _0x5e2a2e){await warehouse[_0x47cb46(0xe9)]({'_id':_0xf70727['_id']},{'$addToSet':{'product_details':{'$each':_0xf70727[_0x47cb46(0x111)]}}});}_0x25d333[_0x47cb46(0x12e)]=_0x47cb46(0x172);const _0x627fae=await _0x25d333[_0x47cb46(0x92)](),_0x31950b=await master_shop[_0x47cb46(0xdb)](),_0x54d31e=await email_settings[_0x47cb46(0x140)](),_0x35e3f8=await supervisor_settings[_0x47cb46(0xdb)]();var _0x3f7dd9=_0x25d333[_0x47cb46(0xcc)],_0x4665a5='',_0x4a353a;for(_0x4a353a in _0x3f7dd9){_0x4665a5+=_0x47cb46(0xfe)+_0x47cb46(0x10e)+_0x3f7dd9[_0x4a353a][_0x47cb46(0xc7)]+_0x47cb46(0xad)+_0x47cb46(0x10e)+_0x3f7dd9[_0x4a353a][_0x47cb46(0xfc)]+_0x47cb46(0xad)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3f7dd9[_0x4a353a][_0x47cb46(0x131)]+_0x47cb46(0xad)+_0x47cb46(0x10e)+_0x3f7dd9[_0x4a353a]['unit']+_0x47cb46(0xad)+_0x47cb46(0x10e)+_0x3f7dd9[_0x4a353a][_0x47cb46(0x16b)]+_0x47cb46(0xad)+_0x47cb46(0x10e)+_0x25d333[_0x47cb46(0x158)]+_0x47cb46(0xad)+_0x47cb46(0x10e)+_0x3f7dd9[_0x4a353a][_0x47cb46(0x14c)]+_0x47cb46(0xad)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3f7dd9[_0x4a353a][_0x47cb46(0xdf)]+_0x3f7dd9[_0x4a353a][_0x47cb46(0x14d)]+_0x3f7dd9[_0x4a353a][_0x47cb46(0x112)]+_0x3f7dd9[_0x4a353a][_0x47cb46(0x15f)]+_0x3f7dd9[_0x4a353a][_0x47cb46(0xd0)][0x0]+_0x3f7dd9[_0x4a353a]['to_floorlevel']+_0x47cb46(0xad),_0x47cb46(0x122);}let _0x591a11=nodemailer[_0x47cb46(0x9d)]({'host':_0x54d31e['host'],'port':Number(_0x54d31e[_0x47cb46(0xbd)]),'secure':![],'auth':{'user':_0x54d31e[_0x47cb46(0x17a)],'pass':_0x54d31e[_0x47cb46(0xf1)]}}),_0x5c3cde={'from':_0x54d31e[_0x47cb46(0x17a)],'to':_0x35e3f8[0x0][_0x47cb46(0x11c)],'subject':_0x47cb46(0x132),'attachments':[{'filename':_0x47cb46(0x98),'path':__dirname+_0x47cb46(0x178)+'/upload/'+_0x31950b[0x0]['image'],'cid':_0x47cb46(0x8a)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x47cb46(0x12d)+'<div>'+_0x47cb46(0xb9)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x47cb46(0x16c)+_0x47cb46(0xf5)+_0x47cb46(0x13a)+_0x31950b[0x0][_0x47cb46(0x123)]+_0x47cb46(0x9f)+'</div>'+_0x47cb46(0x16c)+'<hr\x20class=\x22my-3\x22>'+_0x47cb46(0xf5)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x47cb46(0xd1)+_0x25d333[_0x47cb46(0xc8)]+'\x20'+_0x47cb46(0xa6)+_0x47cb46(0xae)+_0x25d333[_0x47cb46(0xac)]+'\x20'+_0x47cb46(0xc1)+_0x47cb46(0x129)+_0x47cb46(0x16c)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x47cb46(0x9e)+'<tr>'+_0x47cb46(0x14a)+_0x47cb46(0x94)+_0x47cb46(0x104)+_0x47cb46(0x133)+_0x47cb46(0xd7)+_0x47cb46(0xcf)+_0x47cb46(0x170)+_0x47cb46(0x12b)+_0x47cb46(0x122)+_0x47cb46(0x103)+_0x47cb46(0x109)+'\x20'+_0x4665a5+'\x20'+'</tbody>'+_0x47cb46(0x11f)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x47cb46(0xb2)+_0x31950b[0x0][_0x47cb46(0x123)]+_0x47cb46(0x129)+'</div>'+_0x47cb46(0x16c)+_0x47cb46(0xbf)};_0x591a11['sendMail'](_0x5c3cde,function(_0x4f7535,_0x130955){var _0x2aea1=_0x47cb46;_0x4f7535?(console[_0x2aea1(0xc2)](_0x4f7535),console[_0x2aea1(0xc2)](_0x2aea1(0xff))):console['log']('Email\x20sent\x20successfully');}),_0x30f0b5[_0x47cb46(0x108)](_0x47cb46(0xe7),_0x47cb46(0x105)),_0x3006ff[_0x47cb46(0xbb)](_0x47cb46(0x134)+_0x627fae['_id']);}catch(_0x586e0f){console[_0x47cb46(0x13b)](_0x586e0f),_0x3006ff['status'](0x1f4)['json']({'Perror':_0x47cb46(0xa2),'message':_0x586e0f[_0x47cb46(0x13c)]});}})[_0x1307de(0x177)](_0x2a1ac3=>{var _0x1439b6=_0x1307de;console['error'](_0x2a1ac3),_0x3006ff[_0x1439b6(0x10b)](0x1f4)[_0x1439b6(0xfb)]({'Perror':_0x1439b6(0x15e)});});}catch(_0x52b593){_0x3006ff['json'](_0x52b593);}}catch(_0x1980c0){console['error'](_0x1980c0),_0x3006ff[_0x1307de(0x10b)](0x1f4)[_0x1307de(0xfb)]({'Merror':_0x1307de(0xa2),'Message':_0x1980c0[_0x1307de(0x13c)]});}})[_0x3369c5(0x177)](_0x276171=>{var _0x4704a1=_0x3369c5;console[_0x4704a1(0x13b)](_0x276171),_0x3006ff['status'](0x1f4)[_0x4704a1(0xfb)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x15cc4a){console['log'](_0x15cc4a);}});function BayBinSelected(_0x23b75d,_0x4cc4e2){var _0x129e8c=a0_0x3057c7,_0x1d0ac5=[],_0x538775=[],_0x51166f=[],_0x446049=[],_0x54830f=[],_0x3c5ac9=[];let _0x1c4c0f=[];if(_0x23b75d==_0x129e8c(0xc5))switch(_0x4cc4e2){case _0x129e8c(0xaa):_0x1d0ac5=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x538775=[0x1,0x2],_0x446049=[0x1,0x2,0x3,0x4,0x5],_0x51166f=[_0x129e8c(0x142),_0x129e8c(0x17c)],_0x54830f=['D'],_0x3c5ac9=['A'];break;case _0x129e8c(0x88):_0x1d0ac5=[0x6,0x5,0x4,0x3,0x2,0x1],_0x538775=[0x1,0x2],_0x446049=[0x1,0x2,0x3,0x4,0x5],_0x51166f=[_0x129e8c(0x142),_0x129e8c(0x17c)],_0x54830f=['D'],_0x3c5ac9=['B'];break;case _0x129e8c(0x15a):_0x1d0ac5=[0x0],_0x538775=[0x0],_0x446049=[0x1,0x2,0x3,0x4,0x5],_0x51166f=['Floor'],_0x54830f=['D'],_0x3c5ac9=['S'];break;case'Receiving\x20Area':_0x1d0ac5=[0x0],_0x538775=[0x0],_0x446049=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x51166f=['Floor'],_0x54830f=['D'],_0x3c5ac9=['R'];break;}else{if(_0x23b75d==_0x129e8c(0x156))switch(_0x4cc4e2){case _0x129e8c(0xaa):_0x1d0ac5=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x538775=['B','F'],_0x446049=[0x1,0x2,0x3,0x4,0x5],_0x51166f=[_0x129e8c(0x142),_0x129e8c(0x17c)],_0x54830f=['C'],_0x3c5ac9=['A'];break;case'Rack\x20B':_0x1d0ac5=[0x5,0x4,0x3,0x2,0x1],_0x538775=['F','B','S'],_0x446049=[0x1,0x2,0x3,0x4,0x5],_0x51166f=[_0x129e8c(0x142),'Floor'],_0x54830f=['C'],_0x3c5ac9=['B'];break;case _0x129e8c(0x119):_0x1d0ac5=[0x1,0x2,0x3,0x4,0x5],_0x538775=['B','F','S'],_0x446049=[0x5,0x4,0x3,0x2,0x1],_0x51166f=[_0x129e8c(0x142),'Floor'],_0x54830f=['C'],_0x3c5ac9=['C'];break;case _0x129e8c(0x165):_0x1d0ac5=[0x5,0x4,0x3,0x2,0x1],_0x538775=['F','B','S'],_0x446049=[0x1,0x2,0x3,0x4,0x5],_0x51166f=['Level',_0x129e8c(0x17c)],_0x54830f=['C'],_0x3c5ac9=['D'];break;case _0x129e8c(0x100):_0x1d0ac5=[0x4,0x3,0x2,0x1],_0x538775=[0x1,0x2],_0x446049=[0x1,0x2,0x3,0x4,0x5],_0x51166f=['Level',_0x129e8c(0x17c)],_0x54830f=['C'],_0x3c5ac9=['E'];break;case _0x129e8c(0x14f):_0x1d0ac5=[0x1,0x2,0x3],_0x538775=[0x1,0x2],_0x446049=[0x1,0x2,0x3,0x4,0x5],_0x51166f=['Level'],_0x54830f=['C'],_0x3c5ac9=['F'];break;}}return{'levels':_0x1d0ac5,'Isle':_0x538775,'rack':_0x446049,'type':_0x51166f,'storage':_0x54830f,'rak':_0x3c5ac9};}router['get'](a0_0x3057c7(0x117),auth,async(_0x40b453,_0x2d3285)=>{var _0x4709f3=a0_0x3057c7;try{const {username:_0x21d88b,email:_0x39edc6,role:_0x3c2ac3}=_0x40b453[_0x4709f3(0xe6)],_0x16d35e=_0x40b453[_0x4709f3(0xe6)],_0x1efd39=await profile[_0x4709f3(0x140)]({'email':_0x16d35e[_0x4709f3(0x17a)]}),_0x1badbd=await master_shop[_0x4709f3(0xdb)](),_0x1926c9=await transfers[_0x4709f3(0x12a)](_0x40b453['params']['id']);let _0x269c19;if(_0x16d35e[_0x4709f3(0x11e)]==_0x4709f3(0x116)){const _0xb5926c=await staff[_0x4709f3(0x140)]({'email':_0x16d35e['email']});_0x269c19=await warehouse[_0x4709f3(0x143)]([{'$match':{'status':'Enabled','name':_0xb5926c['warehouse'],'warehouse_category':_0x4709f3(0xca)}},{'$group':{'_id':_0x4709f3(0x95),'name':{'$first':_0x4709f3(0x95)}}}]);}else _0x269c19=await warehouse[_0x4709f3(0x143)]([{'$match':{'status':'Enabled','warehouse_category':_0x4709f3(0xca)}},{'$group':{'_id':_0x4709f3(0x95),'name':{'$first':'$name'}}}]);const _0x553d28=await warehouse[_0x4709f3(0x143)]([{'$match':{'name':_0x1926c9['from_warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x4709f3(0x150)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4709f3(0xa4)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x4709f3(0x153)},'type':{'$first':_0x4709f3(0xb3)},'floorlevel':{'$first':_0x4709f3(0xd5)},'primary_code':{'$first':_0x4709f3(0xd8)},'secondary_code':{'$first':_0x4709f3(0x135)},'product_code':{'$first':_0x4709f3(0x12c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4709f3(0xa9)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]),_0x3fa4ec=await product[_0x4709f3(0xdb)]({}),_0x4d687a=BayBinSelected(_0x1926c9['to_warehouse'],_0x1926c9[_0x4709f3(0x9c)]);if(_0x1badbd[0x0]['language']==_0x4709f3(0x8e)){var _0x924878=users[_0x4709f3(0xa7)];console[_0x4709f3(0xc2)](_0x924878);}else{if(_0x1badbd[0x0][_0x4709f3(0xd9)]==_0x4709f3(0xf7))var _0x924878=users['Hindi'];else{if(_0x1badbd[0x0]['language']==_0x4709f3(0xdc))var _0x924878=users[_0x4709f3(0xdc)];else{if(_0x1badbd[0x0][_0x4709f3(0xd9)]==_0x4709f3(0xa8))var _0x924878=users[_0x4709f3(0xa8)];else{if(_0x1badbd[0x0][_0x4709f3(0xd9)]=='French')var _0x924878=users[_0x4709f3(0xf0)];else{if(_0x1badbd[0x0][_0x4709f3(0xd9)]=='Portuguese\x20(BR)')var _0x924878=users[_0x4709f3(0xa0)];else{if(_0x1badbd[0x0][_0x4709f3(0xd9)]=='Chinese')var _0x924878=users[_0x4709f3(0x17b)];else{if(_0x1badbd[0x0][_0x4709f3(0xd9)]==_0x4709f3(0xda))var _0x924878=users[_0x4709f3(0xdd)];}}}}}}}_0x2d3285[_0x4709f3(0xb0)](_0x4709f3(0x155),{'success':_0x40b453[_0x4709f3(0x108)]('success'),'errors':_0x40b453['flash']('errors'),'role':_0x16d35e,'profile':_0x1efd39,'master_shop':_0x1badbd,'warehouse':_0x269c19,'transfer':_0x1926c9,'stock':_0x553d28,'unit':_0x3fa4ec,'language':_0x924878});}catch(_0x5d0ea3){console[_0x4709f3(0xc2)](_0x5d0ea3);}}),router['post']('/view/:id',auth,async(_0xc9bf3e,_0x2a9aea)=>{var _0x3646ce=a0_0x3057c7;try{const _0x297899=_0xc9bf3e[_0x3646ce(0x130)]['id'],_0x226080=await transfers[_0x3646ce(0x12a)](_0x297899);_0x2a9aea[_0x3646ce(0xfb)](_0xc9bf3e[_0x3646ce(0x174)]);return;const {date:_0x2fbf1c,from_warehouse:_0xf62c66,FromRoom_name:_0x5c3717,to_warehouse:_0x62c876,ToRoom_name:_0x4cff78,prod_name:_0x51341d,from_prod_qty:_0x450bdd,from_prod_level:_0xcd660,from_prod_isle:_0x3b764e,from_prod_pallet:_0x4fb679,to_prod_qty:_0x6cd7b2,to_prod_level:_0x4c4fe0,to_prod_isle:_0x394bfc,to_prod_pallet:_0x2e0049,primary_code:_0x4e9807,secondary_code:_0x474e57,product_code3:_0x241ae8,note:_0x38da89,invoice:_0x562c28,expiry_date:_0x1eed00}=_0xc9bf3e[_0x3646ce(0x174)];if(typeof _0x51341d==_0x3646ce(0x11b))var _0x559c73=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x10a)]],_0x5519c5=[_0xc9bf3e['body'][_0x3646ce(0xb5)]],_0x1ab038=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x15d)]],_0x319663=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x146)]],_0x505917=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x11d)]],_0x22bcf1=[_0xc9bf3e[_0x3646ce(0x174)]['from_types']],_0x399460=[_0xc9bf3e[_0x3646ce(0x174)]['to_prod_qty']],_0x53dbc1=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x17d)]],_0x315ce5=[_0xc9bf3e['body']['to_prod_isle']],_0x29e36e=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xd4)]],_0x1ae001=[_0xc9bf3e['body'][_0x3646ce(0xd0)]],_0x3654a0=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xdf)]],_0x528c82=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x115)]],_0x4eab6f=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x87)]],_0x5ff224=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xd3)]],_0x17ca05=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xb1)]],_0xbd6c53=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xc4)]],_0x436cf9=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xd6)]],_0x53c814=[_0xc9bf3e['body'][_0x3646ce(0x16b)]],_0x959bdc=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x161)]],_0x8bd0d0=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xbc)]],_0x4d4a21=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xb7)]],_0x45784d=[_0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x16a)]];else var _0x559c73=[..._0xc9bf3e['body'][_0x3646ce(0x10a)]],_0x3654a0=[..._0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xdf)]],_0x528c82=[..._0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x115)]],_0x22bcf1=[..._0xc9bf3e[_0x3646ce(0x174)]['from_types']],_0x1ae001=[..._0xc9bf3e['body'][_0x3646ce(0xd0)]],_0x5519c5=[..._0xc9bf3e[_0x3646ce(0x174)]['from_prod_qty']],_0x1ab038=[..._0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x15d)]],_0x319663=[..._0xc9bf3e['body'][_0x3646ce(0x146)]],_0x505917=[..._0xc9bf3e['body'][_0x3646ce(0x11d)]],_0x399460=[..._0xc9bf3e[_0x3646ce(0x174)]['to_prod_qty']],_0x53dbc1=[..._0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0x17d)]],_0x315ce5=[..._0xc9bf3e['body']['to_prod_isle']],_0x29e36e=[..._0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xd4)]],_0x4eab6f=[..._0xc9bf3e['body']['primary_code']],_0x5ff224=[..._0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xd3)]],_0x17ca05=[..._0xc9bf3e['body'][_0x3646ce(0xb1)]],_0xbd6c53=[..._0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xc4)]],_0x436cf9=[..._0xc9bf3e[_0x3646ce(0x174)]['unit']],_0x53c814=[..._0xc9bf3e[_0x3646ce(0x174)]['secondary_unit']],_0x959bdc=[..._0xc9bf3e['body'][_0x3646ce(0x161)]],_0x8bd0d0=[..._0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xbc)]],_0x4d4a21=[..._0xc9bf3e[_0x3646ce(0x174)][_0x3646ce(0xb7)]],_0x45784d=[..._0xc9bf3e[_0x3646ce(0x174)]['from_rak']];const _0x4f2cd6=_0x559c73[_0x3646ce(0xf3)](_0x5b0f65=>{return _0x5b0f65={'product_name':_0x5b0f65};});_0x5519c5['forEach']((_0x1e140c,_0x126779)=>{var _0x3a65a3=_0x3646ce;_0x4f2cd6[_0x126779][_0x3a65a3(0x137)]=_0x1e140c;}),_0x1ab038['forEach']((_0x54e37d,_0x1ff732)=>{_0x4f2cd6[_0x1ff732]['from_bay']=_0x54e37d;}),_0x319663[_0x3646ce(0x167)]((_0x488137,_0x2f4c71)=>{_0x4f2cd6[_0x2f4c71]['from_bin']=_0x488137;}),_0x505917[_0x3646ce(0x167)]((_0x21cd6e,_0x9630a9)=>{_0x4f2cd6[_0x9630a9]['from_floorlevel']=_0x21cd6e;}),_0x399460[_0x3646ce(0x167)]((_0x22078e,_0x577979)=>{_0x4f2cd6[_0x577979]['to_quantity']=_0x22078e;}),_0x53dbc1[_0x3646ce(0x167)]((_0x2f7635,_0x2094d5)=>{var _0x480963=_0x3646ce;_0x4f2cd6[_0x2094d5][_0x480963(0x112)]=_0x2f7635;}),_0x315ce5[_0x3646ce(0x167)]((_0x377bc1,_0x9a33c)=>{var _0x57a4d8=_0x3646ce;_0x4f2cd6[_0x9a33c][_0x57a4d8(0x15f)]=_0x377bc1;}),_0x29e36e[_0x3646ce(0x167)]((_0x4cd0db,_0x1d4b02)=>{var _0x47105e=_0x3646ce;_0x4f2cd6[_0x1d4b02][_0x47105e(0xe1)]=_0x4cd0db;}),_0x4eab6f[_0x3646ce(0x167)]((_0x780af1,_0x53c8c2)=>{var _0x308d5b=_0x3646ce;_0x4f2cd6[_0x53c8c2][_0x308d5b(0x87)]=_0x780af1;}),_0x5ff224['forEach']((_0x485ff6,_0x5e8a7e)=>{var _0x15d842=_0x3646ce;_0x4f2cd6[_0x5e8a7e][_0x15d842(0xd3)]=_0x485ff6;}),_0x17ca05[_0x3646ce(0x167)]((_0x38f920,_0x1acf39)=>{var _0xe10ec=_0x3646ce;_0x4f2cd6[_0x1acf39][_0xe10ec(0xfc)]=_0x38f920;}),_0xbd6c53['forEach']((_0x4636b3,_0x5d0ec4)=>{var _0x4dbd35=_0x3646ce;_0x4f2cd6[_0x5d0ec4][_0x4dbd35(0xef)]=_0x4636b3;}),_0x436cf9[_0x3646ce(0x167)]((_0x9c480f,_0x434dc7)=>{var _0x4da5bf=_0x3646ce;_0x4f2cd6[_0x434dc7][_0x4da5bf(0xd6)]=_0x9c480f;}),_0x53c814['forEach']((_0x4089ff,_0x44a586)=>{var _0x516a07=_0x3646ce;_0x4f2cd6[_0x44a586][_0x516a07(0x16b)]=_0x4089ff;}),_0x959bdc[_0x3646ce(0x167)]((_0x54b9df,_0x99f370)=>{var _0x56d9f1=_0x3646ce;_0x4f2cd6[_0x99f370][_0x56d9f1(0x161)]=_0x54b9df;}),_0x8bd0d0['forEach']((_0x4e810f,_0x357dbf)=>{_0x4f2cd6[_0x357dbf]['expiry_date']=_0x4e810f;}),_0x3654a0['forEach']((_0x1f6a7c,_0x4b27f5)=>{var _0x12f481=_0x3646ce;_0x4f2cd6[_0x4b27f5][_0x12f481(0xdf)]=_0x1f6a7c;}),_0x528c82['forEach']((_0x590b4c,_0x47ffaf)=>{var _0x230bd2=_0x3646ce;_0x4f2cd6[_0x47ffaf][_0x230bd2(0x14d)]=_0x590b4c;}),_0x22bcf1[_0x3646ce(0x167)]((_0x38083b,_0xe2f8e8)=>{var _0x371796=_0x3646ce;_0x4f2cd6[_0xe2f8e8][_0x371796(0xb4)]=_0x38083b;}),_0x1ae001[_0x3646ce(0x167)]((_0x402db7,_0x28b744)=>{var _0x1d0938=_0x3646ce;_0x4f2cd6[_0x28b744][_0x1d0938(0xd0)]=_0x402db7;}),_0x4d4a21[_0x3646ce(0x167)]((_0x487b55,_0x5a02d5)=>{_0x4f2cd6[_0x5a02d5]['from_storage']=_0x487b55;}),_0x45784d[_0x3646ce(0x167)]((_0x1f922,_0x2014ce)=>{_0x4f2cd6[_0x2014ce]['from_rack']=_0x1f922;});const _0x57112f=_0x4f2cd6['filter'](_0x17affa=>_0x17affa[_0x3646ce(0x131)]!=='0'&&_0x17affa[_0x3646ce(0x131)]!==''||_0x17affa[_0x3646ce(0xe1)]!=='0'&&_0x17affa[_0x3646ce(0xe1)]!=='');var _0x22eb45=0x0;_0x57112f[_0x3646ce(0x167)](_0xdd0143=>{parseInt(_0xdd0143['from_quantity'])<parseInt(_0xdd0143['to_quantity'])&&_0x22eb45++;});if(_0x22eb45!=0x0)return _0xc9bf3e[_0x3646ce(0x108)](_0x3646ce(0xfd),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x2a9aea[_0x3646ce(0xbb)](_0x3646ce(0x8b));const _0x2f4cd8=await warehouse[_0x3646ce(0x140)]({'name':_0x226080[_0x3646ce(0x13d)],'room':_0x226080[_0x3646ce(0x152)]});_0x226080[_0x3646ce(0xcc)][_0x3646ce(0x167)](_0x3e9fe6=>{var _0x9e8dd9=_0x3646ce;if(_0x3e9fe6[_0x9e8dd9(0x131)]>0x0){const _0x315a67=_0x2f4cd8['product_details'][_0x9e8dd9(0xf3)](_0x1abd9d=>{var _0x2edf96=_0x9e8dd9;_0x1abd9d[_0x2edf96(0xc7)]==_0x3e9fe6[_0x2edf96(0xc7)]&&_0x1abd9d[_0x2edf96(0xd2)]==_0x3e9fe6[_0x2edf96(0x96)]&&_0x1abd9d[_0x2edf96(0x145)]==_0x3e9fe6['from_types']&&_0x1abd9d[_0x2edf96(0x171)]==_0x3e9fe6[_0x2edf96(0xc6)]&&_0x1abd9d[_0x2edf96(0xa1)]==_0x3e9fe6['from_bay']&&_0x1abd9d[_0x2edf96(0x14d)]==_0x3e9fe6[_0x2edf96(0x113)]&&_0x1abd9d['storage']==_0x3e9fe6['from_storage']&&(_0x1abd9d['product_stock']=parseInt(_0x1abd9d[_0x2edf96(0x162)])+parseInt(_0x3e9fe6[_0x2edf96(0x131)]));});}}),await _0x2f4cd8['save']();const _0xe21bc2=await warehouse[_0x3646ce(0x140)]({'name':_0x226080[_0x3646ce(0x158)],'room':_0x226080[_0x3646ce(0x9c)]});_0x226080[_0x3646ce(0xcc)][_0x3646ce(0x167)](_0x5a4bad=>{var _0x32f0c0=_0x3646ce;if(_0x5a4bad[_0x32f0c0(0x131)]>0x0){const _0x4466b4=_0xe21bc2['product_details'][_0x32f0c0(0xf3)](_0x4ddfb1=>{var _0x4b2d79=_0x32f0c0;_0x4ddfb1['product_name']==_0x5a4bad['product_name']&&_0x4ddfb1[_0x4b2d79(0xd2)]==_0x5a4bad['to_floorlevel']&&_0x4ddfb1[_0x4b2d79(0x145)]==_0x5a4bad[_0x4b2d79(0xd0)]&&_0x4ddfb1[_0x4b2d79(0x171)]==_0x5a4bad[_0x4b2d79(0x15f)]&&_0x4ddfb1[_0x4b2d79(0xa1)]==_0x5a4bad['to_bay']&&_0x4ddfb1[_0x4b2d79(0x14d)]==_0x5a4bad['rack']&&_0x4ddfb1[_0x4b2d79(0xdf)]==_0x5a4bad[_0x4b2d79(0xdf)]&&(_0x4ddfb1['product_stock']=parseInt(_0x4ddfb1[_0x4b2d79(0x162)])-parseInt(_0x5a4bad[_0x4b2d79(0x131)]));});}}),await _0xe21bc2['save'](),_0x226080[_0x3646ce(0xac)]=_0x2fbf1c,_0x226080[_0x3646ce(0x13d)]=_0xf62c66,_0x226080['to_warehouse']=_0x62c876,_0x226080[_0x3646ce(0xcc)]=_0x57112f,_0x226080[_0x3646ce(0x101)]=_0x38da89,_0x226080[_0x3646ce(0xc8)]=_0x562c28;const _0xf4ba85=await _0x226080[_0x3646ce(0x92)]();console[_0x3646ce(0xc2)](_0xf4ba85);const _0x197ba6=await warehouse[_0x3646ce(0x140)]({'name':_0xf62c66,'room':_0x5c3717});_0xf4ba85[_0x3646ce(0xcc)][_0x3646ce(0x167)](_0x4f7acd=>{var _0x3a2b45=_0x3646ce;if(_0x4f7acd[_0x3a2b45(0x131)]>0x0){const _0x472b36=_0x197ba6['product_details'][_0x3a2b45(0xf3)](_0x313903=>{var _0xbc9420=_0x3a2b45;_0x313903['product_name']==_0x4f7acd[_0xbc9420(0xc7)]&&_0x313903[_0xbc9420(0xd2)]==_0x4f7acd[_0xbc9420(0x96)]&&_0x313903[_0xbc9420(0x145)]==_0x4f7acd[_0xbc9420(0xb4)]&&_0x313903[_0xbc9420(0x171)]==_0x4f7acd[_0xbc9420(0xc6)]&&_0x313903['bay']==_0x4f7acd['from_bay']&&_0x313903[_0xbc9420(0x14d)]==_0x4f7acd[_0xbc9420(0x113)]&&_0x313903[_0xbc9420(0xdf)]==_0x4f7acd[_0xbc9420(0xb7)]&&(_0x313903[_0xbc9420(0x162)]=parseInt(_0x313903[_0xbc9420(0x162)])-parseInt(_0x4f7acd[_0xbc9420(0x131)]));});}}),await _0x197ba6[_0x3646ce(0x92)]();const _0x2eb44d=await warehouse[_0x3646ce(0x140)]({'name':_0x62c876,'room':_0x4cff78});_0xf4ba85[_0x3646ce(0xcc)][_0x3646ce(0x167)](_0x44836d=>{var _0x1ae66b=_0x3646ce;if(_0x44836d['to_quantity']>0x0){var _0x3ff04a=0x0;const _0x2a1872=_0x2eb44d[_0x1ae66b(0x111)][_0x1ae66b(0xf3)](_0x444e9e=>{var _0x384d05=_0x1ae66b;_0x444e9e['product_name']==_0x44836d[_0x384d05(0xc7)]&&_0x444e9e[_0x384d05(0xd2)]==_0x44836d[_0x384d05(0xe1)]&&_0x444e9e['type']==_0x44836d[_0x384d05(0xd0)]&&_0x444e9e[_0x384d05(0x171)]==_0x44836d['to_bin']&&_0x444e9e[_0x384d05(0xa1)]==_0x44836d[_0x384d05(0x112)]&&_0x444e9e[_0x384d05(0x14d)]==_0x44836d['rack']&&_0x444e9e[_0x384d05(0xdf)]==_0x44836d['storage']&&(_0x444e9e['product_stock']=parseInt(_0x444e9e[_0x384d05(0x162)])+parseInt(_0x44836d['to_quantity']),_0x3ff04a++);});_0x3ff04a=='0'&&(_0x2eb44d[_0x1ae66b(0x111)]=_0x2eb44d[_0x1ae66b(0x111)]['concat']({'product_name':_0x44836d[_0x1ae66b(0xc7)],'product_stock':_0x44836d[_0x1ae66b(0x131)],'bay':_0x44836d[_0x1ae66b(0x112)],'bin':_0x44836d[_0x1ae66b(0x15f)],'type':_0x44836d[_0x1ae66b(0xd0)],'floorlevel':_0x44836d[_0x1ae66b(0xe1)],'storage':_0x44836d[_0x1ae66b(0xdf)],'rack':_0x44836d[_0x1ae66b(0x14d)],'product_code':_0x44836d[_0x1ae66b(0xfc)],'primary_code':_0x44836d['primary_code'],'secondary_code':_0x44836d['secondary_code'],'maxProducts':_0x44836d[_0x1ae66b(0xef)],'storage':_0x44836d[_0x1ae66b(0xdf)],'rack':_0x44836d[_0x1ae66b(0x14d)]}));}}),await _0x2eb44d[_0x3646ce(0x92)](),_0xc9bf3e[_0x3646ce(0x108)](_0x3646ce(0xe7),'Transfer\x20Edit\x20Successfully'),_0x2a9aea[_0x3646ce(0xbb)](_0x3646ce(0x10f));}catch(_0x339478){console['log'](_0x339478);}}),router[a0_0x3057c7(0xf4)](a0_0x3057c7(0x10d),async(_0x4880d0,_0x44252d)=>{var _0x35d953=a0_0x3057c7;const {FromWareHouse:_0x17df8d,FromRoom:_0x30bf97,ToWarehouse:_0x123cbe,ToRoom:_0x1bcbad,primary_code:_0x1ae7d5,Roomslist:_0x3f5394}=_0x4880d0[_0x35d953(0x174)],_0x1a68f1=_0x3f5394['split'](','),_0x157e29=[];async function _0x2d82f2(_0x2b51ac){var _0x4c7cc6=_0x35d953;const _0x38c218=await warehouse[_0x4c7cc6(0x143)]([{'$match':{'name':_0x17df8d,'room':_0x2b51ac}},{'$unwind':_0x4c7cc6(0x150)},{'$match':{'product_details.primary_code':_0x1ae7d5}},{'$group':{'_id':_0x4c7cc6(0x179),'name':{'$first':_0x4c7cc6(0x163)},'instock':{'$first':_0x4c7cc6(0xa4)},'primary_code':{'$first':_0x4c7cc6(0xd8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4c7cc6(0x12c)},'level':{'$first':_0x4c7cc6(0xf2)},'isle':{'$first':_0x4c7cc6(0x153)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x4c7cc6(0xd5)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4c7cc6(0x147)},'storage':{'$first':_0x4c7cc6(0x160)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4c7cc6(0xde)},'batch_code':{'$first':_0x4c7cc6(0x15c)},'maxPerUnit':{'$first':_0x4c7cc6(0xa5)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x4c7cc6(0x106)},'maxProducts':{'$first':_0x4c7cc6(0x16e)},'invoice_product':{'$first':_0x4c7cc6(0x99)}}}]),_0x2a9e86=await warehouse[_0x4c7cc6(0x143)]([{'$match':{'name':_0x17df8d,'room':_0x2b51ac}},{'$unwind':_0x4c7cc6(0x150)},{'$match':{'product_details.secondary_code':_0x1ae7d5}},{'$group':{'_id':_0x4c7cc6(0x179),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x4c7cc6(0xa4)},'primary_code':{'$first':_0x4c7cc6(0xd8)},'secondary_code':{'$first':_0x4c7cc6(0x135)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4c7cc6(0xf2)},'isle':{'$first':_0x4c7cc6(0x153)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x4c7cc6(0x176)},'secondary_unit':{'$first':_0x4c7cc6(0x147)},'storage':{'$first':_0x4c7cc6(0x160)},'rack':{'$first':_0x4c7cc6(0xa9)},'expiry_date':{'$first':_0x4c7cc6(0x121)},'production_date':{'$first':_0x4c7cc6(0xde)},'batch_code':{'$first':_0x4c7cc6(0x15c)},'maxPerUnit':{'$first':_0x4c7cc6(0xa5)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x4c7cc6(0x106)},'maxProducts':{'$first':_0x4c7cc6(0x16e)},'invoice_product':{'$first':_0x4c7cc6(0x99)}}}]);if(_0x38c218[_0x4c7cc6(0x14b)]>0x0)_0x157e29['push'](_0x38c218);else _0x2a9e86['length']>0x0&&_0x157e29['push'](_0x2a9e86);}const _0x49e856=_0x1a68f1[_0x35d953(0xf3)](_0x965787=>_0x2d82f2(_0x965787));await Promise[_0x35d953(0x154)](_0x49e856),_0x44252d[_0x35d953(0xfb)](_0x157e29);}),router[a0_0x3057c7(0xf4)](a0_0x3057c7(0x126),async(_0x11278b,_0x981fff)=>{var _0x2571a5=a0_0x3057c7;try{const {FromWareHouse:_0x2de5d9,FromRoom:_0x2adb15,ToWarehouse:_0x2b1d63,ToRoom:_0xc946bf,secondary_code:_0x5820f1}=_0x11278b[_0x2571a5(0x174)],_0x35c164=await warehouse[_0x2571a5(0x143)]([{'$match':{'name':_0x2de5d9}},{'$unwind':_0x2571a5(0x150)},{'$match':{'product_details.secondary_code':_0x5820f1}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x2571a5(0xd8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2571a5(0x12c)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x2571a5(0x95)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x2571a5(0xe8)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x2571a5(0x16e)},'unit':{'$first':_0x2571a5(0x176)}}}]);_0x981fff[_0x2571a5(0x10b)](0xc8)[_0x2571a5(0xfb)](_0x35c164);}catch(_0x53f10b){_0x981fff['status'](0x194)[_0x2571a5(0xfb)]({'message':_0x53f10b[_0x2571a5(0x13c)]});}}),router[a0_0x3057c7(0xf4)](a0_0x3057c7(0xc9),async(_0x511c90,_0x2d8c56)=>{var _0x55d688=a0_0x3057c7;try{const {FromWareHouse:_0x5e9069,FromRoom:_0x238320,ToWarehouse:_0x5a5832,ToRoom:_0x249871,product_code:_0x1b5e25}=_0x511c90[_0x55d688(0x174)],_0x23260f=await warehouse[_0x55d688(0x143)]([{'$match':{'name':_0x5e9069}},{'$unwind':_0x55d688(0x150)},{'$match':{'product_details.product_code':_0x1b5e25}},{'$group':{'_id':_0x55d688(0x179),'name':{'$first':_0x55d688(0x163)},'primary_code':{'$first':_0x55d688(0xd8)},'secondary_code':{'$first':_0x55d688(0x135)},'product_code':{'$first':_0x55d688(0x12c)},'instock':{'$first':_0x55d688(0xa4)},'warehouse':{'$first':_0x55d688(0x95)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x55d688(0x15b)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x55d688(0x176)}}}]);_0x2d8c56[_0x55d688(0x10b)](0xc8)[_0x55d688(0xfb)](_0x23260f);}catch(_0x5dfe62){_0x2d8c56[_0x55d688(0x10b)](0x194)[_0x55d688(0xfb)]({'message':_0x5dfe62[_0x55d688(0x13c)]});}}),router[a0_0x3057c7(0xf4)](a0_0x3057c7(0x157),async(_0xeef367,_0x4ba3f0)=>{var _0x5427d8=a0_0x3057c7;const {level:_0x2bea95,isle:_0x47272e,pallet:_0x5de62e,warehouses:_0x36bc16,room:_0x93280b}=_0xeef367[_0x5427d8(0x174)];try{const _0x57fe92=await warehouse[_0x5427d8(0x143)]([{'$match':{'name':_0x36bc16,'room':_0x93280b}},{'$unwind':_0x5427d8(0x150)},{'$match':{'product_details.level':parseInt(_0x2bea95),'product_details.isle':_0x47272e,'product_details.pallet':parseInt(_0x5de62e)}},{'$group':{'_id':_0x5427d8(0x179),'name':{'$first':_0x5427d8(0x163)},'product_stock':{'$first':_0x5427d8(0xa4)},'level':{'$first':_0x5427d8(0xe5)},'isle':{'$first':_0x5427d8(0xe8)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x4ba3f0[_0x5427d8(0x10b)](0xc8)[_0x5427d8(0xfb)](_0x57fe92);}catch(_0x2c7688){_0x4ba3f0[_0x5427d8(0x10b)](0x194)[_0x5427d8(0xfb)]({'message':_0x2c7688[_0x5427d8(0x13c)]});}}),module[a0_0x3057c7(0x8f)]=router;