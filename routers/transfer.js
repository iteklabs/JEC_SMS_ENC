var a0_0x3febab=a0_0x217f;(function(_0x23f78c,_0x1b774a){var _0xc0b888=a0_0x217f,_0x492977=_0x23f78c();while(!![]){try{var _0x4916c6=parseInt(_0xc0b888(0x136))/0x1+parseInt(_0xc0b888(0x16e))/0x2*(parseInt(_0xc0b888(0x160))/0x3)+parseInt(_0xc0b888(0x165))/0x4*(parseInt(_0xc0b888(0x1af))/0x5)+-parseInt(_0xc0b888(0x1ce))/0x6*(parseInt(_0xc0b888(0x1a0))/0x7)+parseInt(_0xc0b888(0x19a))/0x8+-parseInt(_0xc0b888(0x144))/0x9*(-parseInt(_0xc0b888(0x18b))/0xa)+-parseInt(_0xc0b888(0x214))/0xb;if(_0x4916c6===_0x1b774a)break;else _0x492977['push'](_0x492977['shift']());}catch(_0x2195c9){_0x492977['push'](_0x492977['shift']());}}}(a0_0x84a4,0x9939f));const express=require('express'),app=express(),router=express[a0_0x3febab(0x183)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x3febab(0x164)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x3febab(0x157));router[a0_0x3febab(0x1d9)](a0_0x3febab(0x167),auth,async(_0x15ad0f,_0x2da496)=>{var _0x8e9d25=a0_0x3febab;try{const {username:_0x42f200,email:_0x3423b5,role:_0x303ccf}=_0x15ad0f[_0x8e9d25(0x155)],_0x5c8859=_0x15ad0f[_0x8e9d25(0x155)],_0x32588f=await profile[_0x8e9d25(0x1e3)]({'email':_0x5c8859[_0x8e9d25(0x1c5)]}),_0x3bd60e=await master_shop['find']();console[_0x8e9d25(0x1b7)]('master',_0x3bd60e);let _0x2ea06f;if(_0x5c8859[_0x8e9d25(0x20b)]=='staff'){const _0x1635c6=await staff[_0x8e9d25(0x1e3)]({'email':_0x5c8859[_0x8e9d25(0x1c5)]});_0x2ea06f=await transfers[_0x8e9d25(0x1fe)]({'from_warehouse':_0x1635c6[_0x8e9d25(0x1fa)]});}else _0x2ea06f=await transfers[_0x8e9d25(0x1de)]([{'$unwind':_0x8e9d25(0x1d5)},{'$group':{'_id':_0x8e9d25(0x145),'invoice':{'$first':_0x8e9d25(0x1c0)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x8e9d25(0x170)},'to_warehouse':{'$first':_0x8e9d25(0x205)},'from_room_name':{'$addToSet':_0x8e9d25(0x1bf)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x8e9d25(0x18a)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3bd60e[0x0][_0x8e9d25(0x21f)]==_0x8e9d25(0x135)){var _0x2c0525=users[_0x8e9d25(0x1e6)];console['log'](_0x2c0525);}else{if(_0x3bd60e[0x0][_0x8e9d25(0x21f)]==_0x8e9d25(0x1ed))var _0x2c0525=users['Hindi'];else{if(_0x3bd60e[0x0][_0x8e9d25(0x21f)]==_0x8e9d25(0x169))var _0x2c0525=users[_0x8e9d25(0x169)];else{if(_0x3bd60e[0x0][_0x8e9d25(0x21f)]==_0x8e9d25(0x21d))var _0x2c0525=users[_0x8e9d25(0x21d)];else{if(_0x3bd60e[0x0][_0x8e9d25(0x21f)]==_0x8e9d25(0x151))var _0x2c0525=users[_0x8e9d25(0x151)];else{if(_0x3bd60e[0x0][_0x8e9d25(0x21f)]==_0x8e9d25(0x1d4))var _0x2c0525=users[_0x8e9d25(0x194)];else{if(_0x3bd60e[0x0]['language']==_0x8e9d25(0x131))var _0x2c0525=users[_0x8e9d25(0x131)];else{if(_0x3bd60e[0x0][_0x8e9d25(0x21f)]==_0x8e9d25(0x218))var _0x2c0525=users[_0x8e9d25(0x12f)];}}}}}}}_0x2da496[_0x8e9d25(0x203)](_0x8e9d25(0x180),{'success':_0x15ad0f[_0x8e9d25(0x1cc)](_0x8e9d25(0x1a1)),'errors':_0x15ad0f['flash'](_0x8e9d25(0x13b)),'role':_0x5c8859,'profile':_0x32588f,'master_shop':_0x3bd60e,'transfer':_0x2ea06f,'language':_0x2c0525});}catch(_0x41c9e6){console[_0x8e9d25(0x1b7)](_0x41c9e6);}});async function getRandom8DigitNumber(){var _0x1c4e2d=a0_0x3febab;const _0x325952=0x989680,_0x4c9dc4=0x5f5e0ff,_0x5b1b87=Math[_0x1c4e2d(0x168)](Math['random']()*(_0x4c9dc4-_0x325952+0x1))+_0x325952;var _0x406839;const _0x4962e6=await transfers[_0x1c4e2d(0x1e3)]({'invoice':_0x1c4e2d(0x1d8)+_0x5b1b87});return _0x4962e6&&_0x4962e6[_0x1c4e2d(0x1ca)]>0x0?_0x406839=_0x1c4e2d(0x1d8)+_0x5b1b87:_0x406839=_0x1c4e2d(0x1d8)+_0x5b1b87,_0x406839;}function a0_0x84a4(){var _0x546532=['role','Error\x20Occurs','$product_details.invoice','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_stock','getMonth','from_prod_qty','$product_details.product_code','from_quantity','25081276KXpBuc','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Enabled','$product_details.batch_code','Arabic\x20(ae)','padStart','True','Rack\x20B','$product_details.isle','Spanish','maxProducts','language','catch','prod_cat','\x20</h2>','to_prod_pallet','Arabic','then','Chinese','\x20Order\x20Date\x20:\x20','/preview/:id','Transfer\x20Edit\x20Successfully','English\x20(US)','600336FxpJBw','</thead>','Rack\x20F','from_prod_isle','$room','errors','to_bin','/transfer/preview/','findById','post','$product_details.bin','Receiving\x20Area','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','27IwStxy','$_id','product_details','/picking_list/PDF_transfer_rm/','secondary_code','$product_details.floorlevel','<hr\x20class=\x22my-3\x22>','<h5>','$product_details.product_stock','id_transaction','to_floorlevel','$product_details.rack','master','French','\x20Order\x20Number\x20:\x20','back','getDate','user','secondary_unit','nodemailer','$product_details.maxPerUnit','date','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','\x20<>\x20','from_prod_pallet','to_bay','host','batch_code','27aRIktC','bay','bin','$product_details.maxProducts','../middleware/auth','2128732kHKzIP','exports','/view','floor','German','/transfer/view','$product_details._id','</tbody>','</td>','119518EJLbfi','from_bin','$from_warehouse','redirect','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','port','Logo.png','updateOne','$product_details','split','type','production_date','$name','from_prod_level','New_Qty_Converted','product_code','ToRoomAssigned','Rack\x20E','transfer','Rack\x20D','$product_details.pallet','Router','/barcode_scanner2','from_bay','from_rack','error','Raw\x20Materials','RoomAssigned','$isAllowEdit','1023210ejdukz','all','to_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','from_warehouse','unit','edit_transfer_view','save','forEach','Portuguese','<!DOCTYPE\x20html>','$product_details.expiry_date','push','<html><head><title></title>','Level','4000752ZYnLzt','/../public','id_transaction_id','</h5>','maxperunit','Floor','133kgoJtc','success','staff','slice','product','Email\x20sent\x20successfully','_id','expiry_date','site_title','$product_details.product_name','/CheckingWarehouse','product_code3','$product_details.primary_code','rak','</table>','10iLaqjz','to_prod_isle','to_prod_qty','from_invoice','to_types','An\x20error\x20occurred\x20while\x20saving\x20data.','Rack\x20A','Product\x20Transfer\x20successfully','log','</span>','<strong>\x20Regards\x20</strong>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','rack','from_room_name','$product.from_room_name','$invoice','To_invoice','Ambient','to_room_name','status','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','string','</div>','length','from_rak','flash','<tr>','32166pLfaFC','$product_details.secondary_code','Return\x20Rooms','/view/:id','primary_code','MaxStocks_data2','Portuguese\x20(BR)','$product','createTransport','primary_unit','TRF-','get','$product_details.level','body','from_floorlevel','$product_details.production_date','aggregate','$product_details.unit','$product_details.storage','params','to_invoice','findOne','map','product_name','English','Shelves','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','floorlevel','prod_name','logo','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Hindi','message','/upload/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_storage','to_prod_level','$product_details.secondary_unit','</head><body>','</body></html>','</tr>','from_types','Enclosed','to_warehouse','warehouse','<div>','json','to_room','find','<h2>\x20','$product_details.bay','<h5\x20style=\x22text-align:\x20left;\x22>','storage','render','finalize','$to_warehouse','here','getFullYear','Transfer\x20Finalize\x20Successfully','invoice','sendMail'];a0_0x84a4=function(){return _0x546532;};return a0_0x84a4();}function a0_0x217f(_0x43f5c5,_0x18bf4c){var _0x84a457=a0_0x84a4();return a0_0x217f=function(_0x217ff8,_0x1868f9){_0x217ff8=_0x217ff8-0x12c;var _0x3f3fc7=_0x84a457[_0x217ff8];return _0x3f3fc7;},a0_0x217f(_0x43f5c5,_0x18bf4c);}router['get']('/view/add_transfer',auth,async(_0x26068f,_0x193370)=>{var _0x4c84d8=a0_0x3febab;try{const {username:_0x59477e,email:_0x26a2c9,role:_0x400887}=_0x26068f[_0x4c84d8(0x155)],_0x4863f5=_0x26068f[_0x4c84d8(0x155)],_0x1b340f=await profile[_0x4c84d8(0x1e3)]({'email':_0x4863f5[_0x4c84d8(0x1c5)]}),_0x4adb44=await master_shop[_0x4c84d8(0x1fe)]();console['log']('master',_0x4adb44);let _0x1209b3;if(_0x4863f5[_0x4c84d8(0x20b)]==_0x4c84d8(0x1a2)){const _0x557bcd=await staff[_0x4c84d8(0x1e3)]({'email':_0x4863f5[_0x4c84d8(0x1c5)]});_0x1209b3=await warehouse['aggregate']([{'$match':{'status':_0x4c84d8(0x216),'name':_0x557bcd['warehouse'],'warehouse_category':_0x4c84d8(0x188)}},{'$group':{'_id':_0x4c84d8(0x17a),'name':{'$first':_0x4c84d8(0x17a)}}}]);}else _0x1209b3=await warehouse['aggregate']([{'$match':{'status':_0x4c84d8(0x216),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4c84d8(0x17a),'name':{'$first':_0x4c84d8(0x17a)}}}]);var _0x4027b6=[_0x4c84d8(0x1c2),_0x4c84d8(0x1f8),_0x4c84d8(0x1d0)];const _0x3d02e8=await transfers[_0x4c84d8(0x1fe)]({}),_0x3b0bb9=_0x3d02e8['length']+0x1,_0x31f463=_0x4c84d8(0x1d8)+_0x3b0bb9['toString']()[_0x4c84d8(0x219)](0x5,'0');if(_0x4adb44[0x0][_0x4c84d8(0x21f)]=='English\x20(US)'){var _0x9b0617=users[_0x4c84d8(0x1e6)];console[_0x4c84d8(0x1b7)](_0x9b0617);}else{if(_0x4adb44[0x0][_0x4c84d8(0x21f)]==_0x4c84d8(0x1ed))var _0x9b0617=users[_0x4c84d8(0x1ed)];else{if(_0x4adb44[0x0][_0x4c84d8(0x21f)]==_0x4c84d8(0x169))var _0x9b0617=users[_0x4c84d8(0x169)];else{if(_0x4adb44[0x0][_0x4c84d8(0x21f)]==_0x4c84d8(0x21d))var _0x9b0617=users['Spanish'];else{if(_0x4adb44[0x0][_0x4c84d8(0x21f)]==_0x4c84d8(0x151))var _0x9b0617=users[_0x4c84d8(0x151)];else{if(_0x4adb44[0x0][_0x4c84d8(0x21f)]=='Portuguese\x20(BR)')var _0x9b0617=users[_0x4c84d8(0x194)];else{if(_0x4adb44[0x0]['language']==_0x4c84d8(0x131))var _0x9b0617=users[_0x4c84d8(0x131)];else{if(_0x4adb44[0x0][_0x4c84d8(0x21f)]==_0x4c84d8(0x218))var _0x9b0617=users[_0x4c84d8(0x12f)];}}}}}}}const _0x280fba=getRandom8DigitNumber();_0x280fba[_0x4c84d8(0x130)](_0x228fe3=>{var _0x36d00c=_0x4c84d8;_0x193370[_0x36d00c(0x203)]('add_transfer',{'success':_0x26068f[_0x36d00c(0x1cc)](_0x36d00c(0x1a1)),'errors':_0x26068f[_0x36d00c(0x1cc)](_0x36d00c(0x13b)),'role':_0x4863f5,'profile':_0x1b340f,'master_shop':_0x4adb44,'warehouse':_0x1209b3,'language':_0x9b0617,'rooms_data':_0x4027b6,'invoice':_0x228fe3});})[_0x4c84d8(0x220)](_0x5259e1=>{var _0xd88d1b=_0x4c84d8;_0x26068f[_0xd88d1b(0x1cc)]('errors',_0xd88d1b(0x1ec)),_0x193370[_0xd88d1b(0x171)](_0xd88d1b(0x16a));});}catch(_0x3f7712){console[_0x4c84d8(0x1b7)](_0x3f7712);}}),router[a0_0x3febab(0x13f)]('/view/add_transfer',auth,async(_0x151bef,_0xaa4df5)=>{var _0x46314b=a0_0x3febab;try{console['log'](_0x151bef[_0x46314b(0x1db)]);const {date:_0x594f6a,from_warehouse:_0x5f4a31,FromRoom_name:_0x3a9685,to_warehouse:_0x3bf8a5,ToRoom_name:_0x1410b8,prod_name:_0x5ea455,from_prod_qty:_0x12d5be,from_prod_level:_0x4f2dfc,from_prod_isle:_0x149611,from_prod_pallet:_0x8b9dc7,to_prod_qty:_0x1f97bc,to_prod_level:_0x1fad8f,to_prod_isle:_0x80cd0d,to_prod_pallet:_0x46849f,primary_code:_0x60aa43,secondary_code:_0x102f72,product_code3:_0x59dce6,note:_0x1eb29f,MaxStocks_data2:_0x170773,invoice:_0x175c7b,expiry_date:_0xdf62ef}=_0x151bef['body'];if(typeof _0x5ea455==_0x46314b(0x1c8))var _0x264570=[_0x151bef[_0x46314b(0x1db)]['prod_name']],_0x33e2db=[_0x151bef['body'][_0x46314b(0x211)]],_0x1792d0=[_0x151bef['body'][_0x46314b(0x17b)]],_0x4e30f0=[_0x151bef['body'][_0x46314b(0x17c)]],_0x5ad8c0=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x1f2)]],_0x347ca3=[_0x151bef[_0x46314b(0x1db)]['primary_code']],_0x3bb378=[_0x151bef['body'][_0x46314b(0x148)]],_0x5b103a=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x1ab)]],_0xd4c4cc=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x1d3)]],_0xfed814=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x1d7)]],_0x476e20=[_0x151bef[_0x46314b(0x1db)]['secondary_unit']],_0x277eb2=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x15f)]],_0x16eedb=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x1a7)]],_0x178aa2=[_0x151bef['body']['max_per_unit']],_0x190f98=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x179)]],_0x1d25ee=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x12c)]],_0x42fb59=[_0x151bef['body'][_0x46314b(0x189)]],_0x55d249=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x17e)]],_0x25e63e=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x1b2)]],_0x52fb03=[_0x151bef[_0x46314b(0x1db)][_0x46314b(0x1e2)]],_0x5ef0f0=[_0x151bef['body'][_0x46314b(0x14d)]];else var _0x264570=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x1ea)]],_0x33e2db=[..._0x151bef['body']['from_prod_qty']],_0x1792d0=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x17b)]],_0x4e30f0=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x17c)]],_0x5ad8c0=[..._0x151bef['body'][_0x46314b(0x1f2)]],_0x347ca3=[..._0x151bef['body']['primary_code']],_0x3bb378=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x148)]],_0x5b103a=[..._0x151bef['body'][_0x46314b(0x1ab)]],_0xd4c4cc=[..._0x151bef['body'][_0x46314b(0x1d3)]],_0xfed814=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x1d7)]],_0x476e20=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x156)]],_0x277eb2=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x15f)]],_0x16eedb=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x1a7)]],_0x178aa2=[..._0x151bef[_0x46314b(0x1db)]['max_per_unit']],_0x190f98=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x179)]],_0x1d25ee=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x12c)]],_0x42fb59=[..._0x151bef['body'][_0x46314b(0x189)]],_0x55d249=[..._0x151bef[_0x46314b(0x1db)]['ToRoomAssigned']],_0x25e63e=[..._0x151bef[_0x46314b(0x1db)][_0x46314b(0x1b2)]],_0x52fb03=[..._0x151bef['body'][_0x46314b(0x1e2)]],_0x5ef0f0=[..._0x151bef[_0x46314b(0x1db)]['id_transaction']];const _0x5eeb6e=_0x264570[_0x46314b(0x1e4)](_0x5d58ab=>{return _0x5d58ab={'product_name':_0x5d58ab};});_0x33e2db[_0x46314b(0x193)]((_0x219a4c,_0x532180)=>{var _0x54f819=_0x46314b;_0x5eeb6e[_0x532180][_0x54f819(0x213)]=_0x219a4c;}),_0x25e63e[_0x46314b(0x193)]((_0x5899d8,_0x33399a)=>{var _0x5f4900=_0x46314b;_0x5eeb6e[_0x33399a][_0x5f4900(0x1b2)]=_0x5899d8;}),_0x52fb03[_0x46314b(0x193)]((_0x30ef3f,_0x46269b)=>{var _0xc9b0fe=_0x46314b;_0x5eeb6e[_0x46269b][_0xc9b0fe(0x1c1)]=_0x30ef3f;}),_0x5ef0f0[_0x46314b(0x193)]((_0x39e4b3,_0xa1f472)=>{var _0xeb6f57=_0x46314b;_0x5eeb6e[_0xa1f472][_0xeb6f57(0x19c)]=_0x39e4b3;}),_0x1792d0[_0x46314b(0x193)]((_0x49de4d,_0xef7bee)=>{var _0x23a92d=_0x46314b;_0x42fb59[_0x23a92d(0x193)]((_0xffe028,_0x4b4c71)=>{var _0x14abb1=_0x23a92d;if(_0xffe028==_0x14abb1(0x141)&&_0xef7bee==_0x4b4c71){var _0x3c871=_0x49de4d[_0x14abb1(0x1a3)](0x3);_0x5eeb6e[_0xef7bee][_0x14abb1(0x1f1)]=_0x49de4d[0x0],_0x5eeb6e[_0xef7bee][_0x14abb1(0x186)]=_0x49de4d[0x1],_0x5eeb6e[_0xef7bee][_0x14abb1(0x185)]=0x0,_0x5eeb6e[_0xef7bee]['from_bin']=0x0,_0x5eeb6e[_0xef7bee]['from_types']='Floor',_0x5eeb6e[_0xef7bee]['from_floorlevel']=_0x3c871;}else{if(_0xffe028==_0x14abb1(0x1e7)&&_0xef7bee==_0x4b4c71){var _0x3c871=_0x49de4d['slice'](0x3);_0x5eeb6e[_0xef7bee][_0x14abb1(0x1f1)]=_0x49de4d[0x0],_0x5eeb6e[_0xef7bee]['from_rack']=_0x49de4d[0x1],_0x5eeb6e[_0xef7bee][_0x14abb1(0x185)]=0x0,_0x5eeb6e[_0xef7bee][_0x14abb1(0x16f)]=0x0,_0x5eeb6e[_0xef7bee][_0x14abb1(0x1f7)]='Floor',_0x5eeb6e[_0xef7bee][_0x14abb1(0x1dc)]=_0x49de4d[0x5];}else{if(_0xef7bee==_0x4b4c71){if(_0x49de4d[0x0]=='A'&&_0x49de4d[0x1]=='L'&&_0x49de4d[0x2]=='L')console[_0x14abb1(0x1b7)](_0xffe028+_0x14abb1(0x15b)+_0xef7bee+_0x14abb1(0x15b)+_0x4b4c71+_0x14abb1(0x15b)+_0x49de4d+_0x14abb1(0x206)),_0x5eeb6e[_0xef7bee][_0x14abb1(0x1f1)]=_0x49de4d[0x0],_0x5eeb6e[_0xef7bee][_0x14abb1(0x186)]=_0x49de4d[0x1],_0x5eeb6e[_0xef7bee][_0x14abb1(0x185)]=0x0,_0x5eeb6e[_0xef7bee][_0x14abb1(0x16f)]=0x0,_0x5eeb6e[_0xef7bee]['from_types']=_0x14abb1(0x19f),_0x5eeb6e[_0xef7bee][_0x14abb1(0x1dc)]=_0x49de4d[0x3];else{var _0x485cf9;if(_0x49de4d[0x4]=='L')_0x485cf9=_0x14abb1(0x199);else _0x49de4d[0x4]=='F'&&(_0x485cf9='Floor');_0x5eeb6e[_0xef7bee][_0x14abb1(0x1f1)]=_0x49de4d[0x0],_0x5eeb6e[_0xef7bee][_0x14abb1(0x186)]=_0x49de4d[0x1],_0x5eeb6e[_0xef7bee][_0x14abb1(0x185)]=_0x49de4d[0x2],_0x5eeb6e[_0xef7bee][_0x14abb1(0x16f)]=_0x49de4d[0x3],_0x5eeb6e[_0xef7bee]['from_types']=_0x485cf9,_0x5eeb6e[_0xef7bee][_0x14abb1(0x1dc)]=_0x49de4d[0x5];}}}}});}),_0x4e30f0[_0x46314b(0x193)]((_0x227e82,_0x3f6f05)=>{var _0x39ce1d=_0x46314b;_0x5eeb6e[_0x3f6f05][_0x39ce1d(0x18d)]=_0x227e82;}),_0x5ad8c0[_0x46314b(0x193)]((_0x335ed4,_0x282c81)=>{var _0x40f06e=_0x46314b;_0x55d249[_0x40f06e(0x193)]((_0xee3f4,_0x3d0698)=>{var _0x49eb01=_0x40f06e;if(_0xee3f4=='Receiving\x20Area'&&_0x282c81==_0x3d0698){var _0x11a7ec=_0x335ed4[_0x49eb01(0x1a3)](0x3);_0x5eeb6e[_0x282c81]['storage']=_0x335ed4[0x0],_0x5eeb6e[_0x282c81]['rack']=_0x335ed4[0x1],_0x5eeb6e[_0x282c81][_0x49eb01(0x15d)]=0x0,_0x5eeb6e[_0x282c81][_0x49eb01(0x13c)]=0x0,_0x5eeb6e[_0x282c81]['to_types']=_0x49eb01(0x19f),_0x5eeb6e[_0x282c81]['to_floorlevel']=_0x11a7ec;}else{if(_0xee3f4==_0x49eb01(0x1e7)&&_0x282c81==_0x3d0698){var _0x11a7ec=_0x335ed4[_0x49eb01(0x1a3)](0x3);_0x5eeb6e[_0x282c81][_0x49eb01(0x202)]=_0x335ed4[0x0],_0x5eeb6e[_0x282c81][_0x49eb01(0x1bd)]=_0x335ed4[0x1],_0x5eeb6e[_0x282c81][_0x49eb01(0x15d)]=0x0,_0x5eeb6e[_0x282c81]['to_bin']=0x0,_0x5eeb6e[_0x282c81][_0x49eb01(0x1b3)]='Floor',_0x5eeb6e[_0x282c81][_0x49eb01(0x14e)]=_0x335ed4[0x5];}else{if(_0x282c81==_0x3d0698){if(_0x335ed4[0x0]=='A'&&_0x335ed4[0x1]=='L'&&_0x335ed4[0x2]=='L')console[_0x49eb01(0x1b7)](_0xee3f4+_0x49eb01(0x15b)+_0x282c81+_0x49eb01(0x15b)+_0x3d0698+_0x49eb01(0x15b)+_0x335ed4+_0x49eb01(0x206)),_0x5eeb6e[_0x282c81][_0x49eb01(0x202)]=_0x335ed4[0x0],_0x5eeb6e[_0x282c81][_0x49eb01(0x1bd)]=_0x335ed4[0x1],_0x5eeb6e[_0x282c81][_0x49eb01(0x15d)]=0x0,_0x5eeb6e[_0x282c81][_0x49eb01(0x13c)]=0x0,_0x5eeb6e[_0x282c81]['to_types']=_0x49eb01(0x19f),_0x5eeb6e[_0x282c81][_0x49eb01(0x14e)]=_0x335ed4[0x3];else{var _0x4e4909;if(_0x335ed4[0x4]=='L')_0x4e4909=_0x49eb01(0x199);else _0x335ed4[0x4]=='F'&&(_0x4e4909=_0x49eb01(0x19f));_0x5eeb6e[_0x282c81]['storage']=_0x335ed4[0x0],_0x5eeb6e[_0x282c81][_0x49eb01(0x1bd)]=_0x335ed4[0x1],_0x5eeb6e[_0x282c81][_0x49eb01(0x15d)]=_0x335ed4[0x2],_0x5eeb6e[_0x282c81][_0x49eb01(0x13c)]=_0x335ed4[0x3],_0x5eeb6e[_0x282c81][_0x49eb01(0x1b3)]=_0x4e4909,_0x5eeb6e[_0x282c81][_0x49eb01(0x14e)]=_0x335ed4[0x5];}}}}});}),_0x347ca3[_0x46314b(0x193)]((_0x1016a3,_0x25c8a0)=>{_0x5eeb6e[_0x25c8a0]['primary_code']=_0x1016a3;}),_0x3bb378['forEach']((_0x2e347b,_0x2998a9)=>{_0x5eeb6e[_0x2998a9]['secondary_code']=_0x2e347b;}),_0x5b103a[_0x46314b(0x193)]((_0x492c2b,_0x35f036)=>{_0x5eeb6e[_0x35f036]['product_code']=_0x492c2b;}),_0xd4c4cc[_0x46314b(0x193)]((_0x1b7a56,_0x143647)=>{var _0xf465a4=_0x46314b;_0x5eeb6e[_0x143647][_0xf465a4(0x21e)]=_0x1b7a56;}),_0xfed814[_0x46314b(0x193)]((_0x1a9bb4,_0x47a122)=>{var _0x24eecb=_0x46314b;_0x5eeb6e[_0x47a122][_0x24eecb(0x190)]=_0x1a9bb4;}),_0x476e20[_0x46314b(0x193)]((_0x5d1103,_0x11b5e3)=>{var _0x48fbfa=_0x46314b;_0x5eeb6e[_0x11b5e3][_0x48fbfa(0x156)]=_0x5d1103;}),_0x277eb2[_0x46314b(0x193)]((_0x4ab4a7,_0x2a6e73)=>{var _0x5c92dd=_0x46314b;_0x5eeb6e[_0x2a6e73][_0x5c92dd(0x15f)]=_0x4ab4a7;}),_0x16eedb['forEach']((_0x42b954,_0x3b8c1c)=>{var _0x4ace9f=_0x46314b;_0x5eeb6e[_0x3b8c1c][_0x4ace9f(0x1a7)]=_0x42b954;}),_0x178aa2[_0x46314b(0x193)]((_0xf4bc44,_0x76397f)=>{_0x5eeb6e[_0x76397f]['maxperunit']=_0xf4bc44;}),_0x190f98[_0x46314b(0x193)]((_0x3f5057,_0x57583e)=>{_0x5eeb6e[_0x57583e]['production_date']=_0x3f5057;}),_0x1d25ee[_0x46314b(0x193)]((_0x533886,_0x3b5b06)=>{var _0x5ccea5=_0x46314b;_0x5eeb6e[_0x3b5b06][_0x5ccea5(0x12c)]=_0x533886;}),_0x42fb59['forEach']((_0x133cc1,_0x5603cc)=>{var _0x63a723=_0x46314b;_0x5eeb6e[_0x5603cc][_0x63a723(0x1be)]=_0x133cc1;}),_0x55d249['forEach']((_0x1a6fd9,_0x2d0aaa)=>{var _0x21ce27=_0x46314b;_0x5eeb6e[_0x2d0aaa][_0x21ce27(0x1c3)]=_0x1a6fd9;});const _0x5d9fd7=_0x5eeb6e['filter'](_0x46f78a=>_0x46f78a['to_quantity']!=='0'&&_0x46f78a[_0x46314b(0x18d)]!==''||_0x46f78a['to_floorlevel']!=='0'&&_0x46f78a[_0x46314b(0x14e)]!==''),_0x3b040e=new transfers({'date':_0x594f6a,'from_warehouse':_0x5f4a31,'to_warehouse':_0x3bf8a5,'product':_0x5d9fd7,'note':_0x1eb29f,'invoice':_0x175c7b}),_0x4d1b52=await _0x3b040e['save']();_0x151bef[_0x46314b(0x1cc)](_0x46314b(0x1a1),_0x46314b(0x1b6)),_0xaa4df5['redirect'](_0x46314b(0x13d)+_0x4d1b52[_0x46314b(0x1a6)]);}catch(_0x3fca36){console[_0x46314b(0x1b7)](_0x3fca36),_0xaa4df5[_0x46314b(0x1c4)](0xc8)['json']({'errorMessage':_0x3fca36[_0x46314b(0x1ee)]});}}),router[a0_0x3febab(0x1d9)](a0_0x3febab(0x133),auth,async(_0x38438d,_0x51a858)=>{var _0x4c0f27=a0_0x3febab;try{const {username:_0x5bcc99,email:_0x508537,role:_0x31d9c9}=_0x38438d[_0x4c0f27(0x155)],_0x1b51d3=_0x38438d[_0x4c0f27(0x155)],_0x30e6bd=await profile[_0x4c0f27(0x1e3)]({'email':_0x1b51d3[_0x4c0f27(0x1c5)]}),_0x2affb0=await master_shop[_0x4c0f27(0x1fe)]();console[_0x4c0f27(0x1b7)](_0x4c0f27(0x150),_0x2affb0);const _0xcbd765=await transfers[_0x4c0f27(0x13e)](_0x38438d[_0x4c0f27(0x1e1)]['id']);let _0xf11f88=new Date(_0xcbd765[_0x4c0f27(0x1a7)]),_0x24ccd2=('0'+_0xf11f88[_0x4c0f27(0x154)]())[_0x4c0f27(0x1a3)](-0x2),_0x57f914=('0'+(_0xf11f88[_0x4c0f27(0x210)]()+0x1))[_0x4c0f27(0x1a3)](-0x2),_0x27e05a=_0xf11f88[_0x4c0f27(0x207)](),_0x565567=_0x27e05a+'-'+_0x57f914+'-'+_0x24ccd2,_0xaac663;if(_0x1b51d3['role']==_0x4c0f27(0x1a2)){const _0x2de060=await staff['findOne']({'email':_0x1b51d3['email']});_0xaac663=await warehouse['find']({'status':_0x4c0f27(0x216),'name':_0x2de060['warehouse'],'warehouse_category':_0x4c0f27(0x188)});}else _0xaac663=await warehouse[_0x4c0f27(0x1fe)]({'status':_0x4c0f27(0x216),'warehouse_category':_0x4c0f27(0x188)});const _0x2b077d=await warehouse[_0x4c0f27(0x1de)]([{'$match':{'name':_0xcbd765['from_warehouse']}},{'$unwind':_0x4c0f27(0x176)},{'$group':{'_id':_0x4c0f27(0x16b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4c0f27(0x14c)},'bay':{'$first':_0x4c0f27(0x200)},'bin':{'$first':_0x4c0f27(0x140)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4c0f27(0x149)},'primary_code':{'$first':_0x4c0f27(0x1ac)},'secondary_code':{'$first':_0x4c0f27(0x1cf)},'product_code':{'$first':_0x4c0f27(0x212)},'storage':{'$first':_0x4c0f27(0x1e0)},'rack':{'$first':_0x4c0f27(0x14f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x4c0f27(0x13a)}}}]);if(_0x2affb0[0x0][_0x4c0f27(0x21f)]=='English\x20(US)'){var _0x91118=users[_0x4c0f27(0x1e6)];console['log'](_0x91118);}else{if(_0x2affb0[0x0][_0x4c0f27(0x21f)]==_0x4c0f27(0x1ed))var _0x91118=users[_0x4c0f27(0x1ed)];else{if(_0x2affb0[0x0][_0x4c0f27(0x21f)]==_0x4c0f27(0x169))var _0x91118=users[_0x4c0f27(0x169)];else{if(_0x2affb0[0x0][_0x4c0f27(0x21f)]==_0x4c0f27(0x21d))var _0x91118=users[_0x4c0f27(0x21d)];else{if(_0x2affb0[0x0]['language']=='French')var _0x91118=users[_0x4c0f27(0x151)];else{if(_0x2affb0[0x0][_0x4c0f27(0x21f)]==_0x4c0f27(0x1d4))var _0x91118=users[_0x4c0f27(0x194)];else{if(_0x2affb0[0x0]['language']=='Chinese')var _0x91118=users['Chinese'];else{if(_0x2affb0[0x0][_0x4c0f27(0x21f)]==_0x4c0f27(0x218))var _0x91118=users['Arabic'];}}}}}}}_0x51a858[_0x4c0f27(0x203)](_0x4c0f27(0x191),{'success':_0x38438d[_0x4c0f27(0x1cc)](_0x4c0f27(0x1a1)),'errors':_0x38438d[_0x4c0f27(0x1cc)](_0x4c0f27(0x13b)),'role':_0x1b51d3,'profile':_0x30e6bd,'master_shop':_0x2affb0,'warehouse':_0xaac663,'transfer':_0xcbd765,'stock':_0x2b077d,'language':_0x91118});}catch(_0x1e96a9){console[_0x4c0f27(0x1b7)](_0x1e96a9);}}),router[a0_0x3febab(0x13f)]('/preview/:id',auth,async(_0x5c449b,_0x4c2a9c)=>{var _0x2dcbbb=a0_0x3febab;try{const _0x4d2427=_0x5c449b['params']['id'],{from_warehouse:_0x5d4a4b,FromRoom_name:_0x281e30,to_warehouse:_0x3e81b4,ToRoom_name:_0x4a29c5}=_0x5c449b[_0x2dcbbb(0x1db)],_0x3716ed=await transfers[_0x2dcbbb(0x13e)]({'_id':_0x4d2427}),_0x33bef=_0x3716ed[_0x2dcbbb(0x1a4)][_0x2dcbbb(0x1e4)](async _0x2cea6a=>{var _0x1b6bbf=_0x2dcbbb;if(_0x2cea6a[_0x1b6bbf(0x18d)]>0x0){var _0x3edf37=await warehouse[_0x1b6bbf(0x1e3)]({'name':_0x3716ed['from_warehouse'],'room':_0x2cea6a[_0x1b6bbf(0x1be)],'warehouse_category':_0x1b6bbf(0x188)});const _0x374737=_0x3edf37['product_details']['map'](_0x463d9c=>{var _0x3e0330=_0x1b6bbf;_0x463d9c[_0x3e0330(0x1e5)]==_0x2cea6a[_0x3e0330(0x1e5)]&&_0x463d9c['floorlevel']==_0x2cea6a[_0x3e0330(0x1dc)]&&_0x463d9c[_0x3e0330(0x178)]==_0x2cea6a['from_types']&&_0x463d9c[_0x3e0330(0x162)]==_0x2cea6a[_0x3e0330(0x16f)]&&_0x463d9c[_0x3e0330(0x161)]==_0x2cea6a[_0x3e0330(0x185)]&&_0x463d9c[_0x3e0330(0x1bd)]==_0x2cea6a['from_rack']&&_0x463d9c[_0x3e0330(0x202)]==_0x2cea6a[_0x3e0330(0x1f1)]&&_0x463d9c['expiry_date']==_0x2cea6a[_0x3e0330(0x1a7)]&&_0x463d9c[_0x3e0330(0x15f)]==_0x2cea6a[_0x3e0330(0x15f)]&&_0x463d9c[_0x3e0330(0x179)]==_0x2cea6a[_0x3e0330(0x179)]&&_0x463d9c['invoice']==_0x2cea6a['from_invoice']&&_0x463d9c[_0x3e0330(0x1a6)]==_0x2cea6a['id_transaction_id']&&(_0x463d9c[_0x3e0330(0x20f)]=_0x463d9c[_0x3e0330(0x20f)]-_0x2cea6a[_0x3e0330(0x18d)]);});}return _0x3edf37;});Promise[_0x2dcbbb(0x18c)](_0x33bef)[_0x2dcbbb(0x130)](async _0x18d5f9=>{var _0x348c20=_0x2dcbbb;try{for(const _0x702706 of _0x18d5f9){await _0x702706[_0x348c20(0x192)]();}try{const _0x3e2f56=_0x3716ed[_0x348c20(0x1a4)][_0x348c20(0x1e4)](async _0x342675=>{var _0x5ccfd6=_0x348c20;if(_0x342675['to_quantity']>0x0){var _0x27a87d=await warehouse['findOne']({'name':_0x3716ed[_0x5ccfd6(0x1f9)],'room':_0x342675['to_room_name'],'warehouse_category':_0x5ccfd6(0x188)}),_0x4643d1=0x0;const _0x364e5e=_0x27a87d[_0x5ccfd6(0x146)][_0x5ccfd6(0x1e4)](_0x5a4c01=>{var _0x3d28fa=_0x5ccfd6;_0x5a4c01['product_name']==_0x342675[_0x3d28fa(0x1e5)]&&_0x5a4c01['floorlevel']==_0x342675[_0x3d28fa(0x14e)]&&_0x5a4c01[_0x3d28fa(0x178)]==_0x342675['to_types']&&_0x5a4c01[_0x3d28fa(0x162)]==_0x342675[_0x3d28fa(0x13c)]&&_0x5a4c01[_0x3d28fa(0x161)]==_0x342675[_0x3d28fa(0x15d)]&&_0x5a4c01['rack']==_0x342675[_0x3d28fa(0x1bd)]&&_0x5a4c01[_0x3d28fa(0x202)]==_0x342675[_0x3d28fa(0x202)]&&_0x5a4c01['expiry_date']==_0x342675[_0x3d28fa(0x1a7)]&&_0x5a4c01[_0x3d28fa(0x15f)]==_0x342675['batch_code']&&_0x5a4c01[_0x3d28fa(0x179)]==_0x342675[_0x3d28fa(0x179)]&&_0x5a4c01[_0x3d28fa(0x209)]==_0x342675[_0x3d28fa(0x1c1)]&&(_0x5a4c01[_0x3d28fa(0x20f)]=_0x5a4c01[_0x3d28fa(0x20f)]+_0x342675[_0x3d28fa(0x18d)],_0x4643d1++);});_0x4643d1=='0'&&(_0x27a87d[_0x5ccfd6(0x146)]=_0x27a87d[_0x5ccfd6(0x146)]['concat']({'product_name':_0x342675[_0x5ccfd6(0x1e5)],'product_stock':_0x342675[_0x5ccfd6(0x18d)],'bay':_0x342675[_0x5ccfd6(0x15d)],'bin':_0x342675[_0x5ccfd6(0x13c)],'type':_0x342675[_0x5ccfd6(0x1b3)],'floorlevel':_0x342675['to_floorlevel'],'storage':_0x342675[_0x5ccfd6(0x202)],'rack':_0x342675['rack'],'product_code':_0x342675[_0x5ccfd6(0x17d)],'primary_code':_0x342675['primary_code'],'secondary_code':_0x342675['secondary_code'],'maxProducts':_0x342675[_0x5ccfd6(0x21e)],'storage':_0x342675[_0x5ccfd6(0x202)],'rack':_0x342675[_0x5ccfd6(0x1bd)],'expiry_date':_0x342675[_0x5ccfd6(0x1a7)],'maxPerUnit':_0x342675[_0x5ccfd6(0x19e)],'batch_code':_0x342675['batch_code'],'production_date':_0x342675[_0x5ccfd6(0x179)]}));}return _0x27a87d;});Promise[_0x348c20(0x18c)](_0x3e2f56)[_0x348c20(0x130)](async _0x19f4aa=>{var _0x44f1f0=_0x348c20;try{for(const _0x3059aa of _0x19f4aa){await warehouse[_0x44f1f0(0x175)]({'_id':_0x3059aa[_0x44f1f0(0x1a6)]},{'$addToSet':{'product_details':{'$each':_0x3059aa[_0x44f1f0(0x146)]}}});}_0x3716ed[_0x44f1f0(0x204)]=_0x44f1f0(0x21a);const _0x307192=await _0x3716ed[_0x44f1f0(0x192)](),_0x4668f4=await master_shop[_0x44f1f0(0x1fe)](),_0x296f99=await email_settings['findOne'](),_0x19cf7a=await supervisor_settings[_0x44f1f0(0x1fe)]();var _0x5f54cc=_0x3716ed[_0x44f1f0(0x1a4)],_0x2c200c='',_0x262f17;for(_0x262f17 in _0x5f54cc){_0x2c200c+=_0x44f1f0(0x1cd)+_0x44f1f0(0x20e)+_0x5f54cc[_0x262f17][_0x44f1f0(0x1e5)]+_0x44f1f0(0x16d)+_0x44f1f0(0x20e)+_0x5f54cc[_0x262f17][_0x44f1f0(0x17d)]+'</td>'+_0x44f1f0(0x20e)+_0x5f54cc[_0x262f17][_0x44f1f0(0x18d)]+_0x44f1f0(0x16d)+_0x44f1f0(0x20e)+_0x5f54cc[_0x262f17][_0x44f1f0(0x190)]+_0x44f1f0(0x16d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5f54cc[_0x262f17]['secondary_unit']+_0x44f1f0(0x16d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3716ed[_0x44f1f0(0x1f9)]+_0x44f1f0(0x16d)+_0x44f1f0(0x20e)+_0x5f54cc[_0x262f17][_0x44f1f0(0x1c3)]+'</td>'+_0x44f1f0(0x20e)+_0x5f54cc[_0x262f17]['storage']+_0x5f54cc[_0x262f17]['rack']+_0x5f54cc[_0x262f17][_0x44f1f0(0x15d)]+_0x5f54cc[_0x262f17]['to_bin']+_0x5f54cc[_0x262f17][_0x44f1f0(0x1b3)][0x0]+_0x5f54cc[_0x262f17][_0x44f1f0(0x14e)]+_0x44f1f0(0x16d),_0x44f1f0(0x1f6);}let _0x5dceef=nodemailer[_0x44f1f0(0x1d6)]({'host':_0x296f99[_0x44f1f0(0x15e)],'port':Number(_0x296f99[_0x44f1f0(0x173)]),'secure':![],'auth':{'user':_0x296f99[_0x44f1f0(0x1c5)],'pass':_0x296f99['password']}}),_0xda26b5={'from':_0x296f99[_0x44f1f0(0x1c5)],'to':_0x19cf7a[0x0]['RMSEmail'],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x44f1f0(0x174),'path':__dirname+_0x44f1f0(0x19b)+_0x44f1f0(0x1ef)+_0x4668f4[0x0]['image'],'cid':_0x44f1f0(0x1eb)}],'html':_0x44f1f0(0x195)+_0x44f1f0(0x198)+_0x44f1f0(0x1f4)+_0x44f1f0(0x1fb)+_0x44f1f0(0x1e8)+_0x44f1f0(0x1fb)+_0x44f1f0(0x172)+_0x44f1f0(0x1c9)+'<div>'+_0x44f1f0(0x1ff)+_0x4668f4[0x0][_0x44f1f0(0x1a8)]+_0x44f1f0(0x12d)+'</div>'+_0x44f1f0(0x1c9)+_0x44f1f0(0x14a)+'<div>'+_0x44f1f0(0x201)+_0x44f1f0(0x152)+_0x3716ed[_0x44f1f0(0x209)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x44f1f0(0x132)+_0x3716ed[_0x44f1f0(0x159)]+'\x20'+_0x44f1f0(0x1b8)+_0x44f1f0(0x19d)+_0x44f1f0(0x1c9)+_0x44f1f0(0x1ba)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x44f1f0(0x1f0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x44f1f0(0x1c6)+_0x44f1f0(0x1bc)+_0x44f1f0(0x1c7)+_0x44f1f0(0x18e)+_0x44f1f0(0x215)+_0x44f1f0(0x143)+_0x44f1f0(0x1f6)+_0x44f1f0(0x137)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x2c200c+'\x20'+_0x44f1f0(0x16c)+_0x44f1f0(0x1ae)+_0x44f1f0(0x1fb)+_0x44f1f0(0x1b9)+_0x44f1f0(0x14b)+_0x4668f4[0x0][_0x44f1f0(0x1a8)]+_0x44f1f0(0x19d)+'</div>'+_0x44f1f0(0x1c9)+_0x44f1f0(0x1f5)};_0x5dceef[_0x44f1f0(0x20a)](_0xda26b5,function(_0x57258e,_0x5d39c4){var _0x19e43d=_0x44f1f0;_0x57258e?(console['log'](_0x57258e),console[_0x19e43d(0x1b7)](_0x19e43d(0x20c))):console[_0x19e43d(0x1b7)](_0x19e43d(0x1a5));}),_0x5c449b[_0x44f1f0(0x1cc)]('success',_0x44f1f0(0x208)),_0x4c2a9c[_0x44f1f0(0x171)](_0x44f1f0(0x147)+_0x307192[_0x44f1f0(0x1a6)]);}catch(_0x2a5881){console['error'](_0x2a5881),_0x4c2a9c['status'](0x1f4)[_0x44f1f0(0x1fc)]({'Perror':_0x44f1f0(0x1b4),'message':_0x2a5881[_0x44f1f0(0x1ee)]});}})[_0x348c20(0x220)](_0x486424=>{var _0xccca23=_0x348c20;console[_0xccca23(0x187)](_0x486424),_0x4c2a9c[_0xccca23(0x1c4)](0x1f4)[_0xccca23(0x1fc)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x13dbf3){_0x4c2a9c[_0x348c20(0x1fc)](_0x13dbf3);}}catch(_0x245188){console[_0x348c20(0x187)](_0x245188),_0x4c2a9c[_0x348c20(0x1c4)](0x1f4)[_0x348c20(0x1fc)]({'Merror':_0x348c20(0x1b4),'Message':_0x245188[_0x348c20(0x1ee)]});}})['catch'](_0x215a2d=>{var _0x4df7f9=_0x2dcbbb;console['error'](_0x215a2d),_0x4c2a9c[_0x4df7f9(0x1c4)](0x1f4)[_0x4df7f9(0x1fc)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x33bdd9){console[_0x2dcbbb(0x1b7)](_0x33bdd9);}});function BayBinSelected(_0x1cc693,_0x49af99){var _0x5a12ad=a0_0x3febab,_0x5aaec8=[],_0x480b73=[],_0xb0cf9b=[],_0x37f3e0=[],_0x4b98d9=[],_0x619d4a=[];let _0x1a8231=[];if(_0x1cc693=='DRY\x20STORAGE')switch(_0x49af99){case'Rack\x20A':_0x5aaec8=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x480b73=[0x1,0x2],_0x37f3e0=[0x1,0x2,0x3,0x4,0x5],_0xb0cf9b=[_0x5a12ad(0x199),'Floor'],_0x4b98d9=['D'],_0x619d4a=['A'];break;case _0x5a12ad(0x21b):_0x5aaec8=[0x6,0x5,0x4,0x3,0x2,0x1],_0x480b73=[0x1,0x2],_0x37f3e0=[0x1,0x2,0x3,0x4,0x5],_0xb0cf9b=[_0x5a12ad(0x199),_0x5a12ad(0x19f)],_0x4b98d9=['D'],_0x619d4a=['B'];break;case _0x5a12ad(0x1e7):_0x5aaec8=[0x0],_0x480b73=[0x0],_0x37f3e0=[0x1,0x2,0x3,0x4,0x5],_0xb0cf9b=['Floor'],_0x4b98d9=['D'],_0x619d4a=['S'];break;case'Receiving\x20Area':_0x5aaec8=[0x0],_0x480b73=[0x0],_0x37f3e0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0xb0cf9b=['Floor'],_0x4b98d9=['D'],_0x619d4a=['R'];break;}else{if(_0x1cc693=='COLD\x20STORAGE')switch(_0x49af99){case _0x5a12ad(0x1b5):_0x5aaec8=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x480b73=['B','F'],_0x37f3e0=[0x1,0x2,0x3,0x4,0x5],_0xb0cf9b=[_0x5a12ad(0x199),_0x5a12ad(0x19f)],_0x4b98d9=['C'],_0x619d4a=['A'];break;case _0x5a12ad(0x21b):_0x5aaec8=[0x5,0x4,0x3,0x2,0x1],_0x480b73=['F','B','S'],_0x37f3e0=[0x1,0x2,0x3,0x4,0x5],_0xb0cf9b=[_0x5a12ad(0x199),_0x5a12ad(0x19f)],_0x4b98d9=['C'],_0x619d4a=['B'];break;case'Rack\x20C':_0x5aaec8=[0x1,0x2,0x3,0x4,0x5],_0x480b73=['B','F','S'],_0x37f3e0=[0x5,0x4,0x3,0x2,0x1],_0xb0cf9b=[_0x5a12ad(0x199),_0x5a12ad(0x19f)],_0x4b98d9=['C'],_0x619d4a=['C'];break;case _0x5a12ad(0x181):_0x5aaec8=[0x5,0x4,0x3,0x2,0x1],_0x480b73=['F','B','S'],_0x37f3e0=[0x1,0x2,0x3,0x4,0x5],_0xb0cf9b=[_0x5a12ad(0x199),_0x5a12ad(0x19f)],_0x4b98d9=['C'],_0x619d4a=['D'];break;case _0x5a12ad(0x17f):_0x5aaec8=[0x4,0x3,0x2,0x1],_0x480b73=[0x1,0x2],_0x37f3e0=[0x1,0x2,0x3,0x4,0x5],_0xb0cf9b=['Level',_0x5a12ad(0x19f)],_0x4b98d9=['C'],_0x619d4a=['E'];break;case _0x5a12ad(0x138):_0x5aaec8=[0x1,0x2,0x3],_0x480b73=[0x1,0x2],_0x37f3e0=[0x1,0x2,0x3,0x4,0x5],_0xb0cf9b=[_0x5a12ad(0x199)],_0x4b98d9=['C'],_0x619d4a=['F'];break;}}return{'levels':_0x5aaec8,'Isle':_0x480b73,'rack':_0x37f3e0,'type':_0xb0cf9b,'storage':_0x4b98d9,'rak':_0x619d4a};}router['get'](a0_0x3febab(0x1d1),auth,async(_0x328151,_0x3db1d4)=>{var _0x3f6f9d=a0_0x3febab;try{const {username:_0x12b8cb,email:_0x3c2812,role:_0xdf2177}=_0x328151['user'],_0x3d3c47=_0x328151[_0x3f6f9d(0x155)],_0xa8b34d=await profile['findOne']({'email':_0x3d3c47[_0x3f6f9d(0x1c5)]}),_0x534c65=await master_shop['find'](),_0x40d7bf=await transfers[_0x3f6f9d(0x13e)](_0x328151[_0x3f6f9d(0x1e1)]['id']);let _0x3e03ad;if(_0x3d3c47[_0x3f6f9d(0x20b)]==_0x3f6f9d(0x1a2)){const _0x2bc6e5=await staff[_0x3f6f9d(0x1e3)]({'email':_0x3d3c47[_0x3f6f9d(0x1c5)]});_0x3e03ad=await warehouse[_0x3f6f9d(0x1de)]([{'$match':{'status':_0x3f6f9d(0x216),'name':_0x2bc6e5['warehouse'],'warehouse_category':_0x3f6f9d(0x188)}},{'$group':{'_id':'$name','name':{'$first':_0x3f6f9d(0x17a)}}}]);}else _0x3e03ad=await warehouse[_0x3f6f9d(0x1de)]([{'$match':{'status':_0x3f6f9d(0x216),'warehouse_category':_0x3f6f9d(0x188)}},{'$group':{'_id':'$name','name':{'$first':_0x3f6f9d(0x17a)}}}]);const _0xe5bd08=await warehouse[_0x3f6f9d(0x1de)]([{'$match':{'name':_0x40d7bf[_0x3f6f9d(0x18f)],'warehouse_category':_0x3f6f9d(0x188)}},{'$unwind':_0x3f6f9d(0x176)},{'$group':{'_id':_0x3f6f9d(0x16b),'name':{'$first':_0x3f6f9d(0x1a9)},'product_stock':{'$first':_0x3f6f9d(0x14c)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x3f6f9d(0x140)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3f6f9d(0x149)},'primary_code':{'$first':_0x3f6f9d(0x1ac)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3f6f9d(0x212)},'storage':{'$first':_0x3f6f9d(0x1e0)},'rack':{'$first':_0x3f6f9d(0x14f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3f6f9d(0x1dd)},'room':{'$first':'$room'}}}]),_0xc5d03f=await product[_0x3f6f9d(0x1fe)]({}),_0x114909=BayBinSelected(_0x40d7bf[_0x3f6f9d(0x1f9)],_0x40d7bf[_0x3f6f9d(0x1fd)]);if(_0x534c65[0x0][_0x3f6f9d(0x21f)]==_0x3f6f9d(0x135)){var _0x3bf3d4=users['English'];console[_0x3f6f9d(0x1b7)](_0x3bf3d4);}else{if(_0x534c65[0x0][_0x3f6f9d(0x21f)]=='Hindi')var _0x3bf3d4=users[_0x3f6f9d(0x1ed)];else{if(_0x534c65[0x0][_0x3f6f9d(0x21f)]==_0x3f6f9d(0x169))var _0x3bf3d4=users['German'];else{if(_0x534c65[0x0][_0x3f6f9d(0x21f)]==_0x3f6f9d(0x21d))var _0x3bf3d4=users['Spanish'];else{if(_0x534c65[0x0]['language']=='French')var _0x3bf3d4=users['French'];else{if(_0x534c65[0x0][_0x3f6f9d(0x21f)]==_0x3f6f9d(0x1d4))var _0x3bf3d4=users[_0x3f6f9d(0x194)];else{if(_0x534c65[0x0][_0x3f6f9d(0x21f)]=='Chinese')var _0x3bf3d4=users[_0x3f6f9d(0x131)];else{if(_0x534c65[0x0][_0x3f6f9d(0x21f)]==_0x3f6f9d(0x218))var _0x3bf3d4=users[_0x3f6f9d(0x12f)];}}}}}}}_0x3db1d4[_0x3f6f9d(0x203)]('edit_transfer',{'success':_0x328151[_0x3f6f9d(0x1cc)](_0x3f6f9d(0x1a1)),'errors':_0x328151[_0x3f6f9d(0x1cc)](_0x3f6f9d(0x13b)),'role':_0x3d3c47,'profile':_0xa8b34d,'master_shop':_0x534c65,'warehouse':_0x3e03ad,'transfer':_0x40d7bf,'stock':_0xe5bd08,'unit':_0xc5d03f,'language':_0x3bf3d4});}catch(_0x568aa4){console[_0x3f6f9d(0x1b7)](_0x568aa4);}}),router['post']('/view/:id',auth,async(_0x531dc9,_0x5eecca)=>{var _0x3307d3=a0_0x3febab;try{const _0x3b68ea=_0x531dc9['params']['id'],_0x71bfc9=await transfers[_0x3307d3(0x13e)](_0x3b68ea);_0x5eecca[_0x3307d3(0x1fc)](_0x531dc9[_0x3307d3(0x1db)]);return;const {date:_0x11c9ef,from_warehouse:_0x3e492b,FromRoom_name:_0x2f09fd,to_warehouse:_0x2e08d1,ToRoom_name:_0x332c29,prod_name:_0x4188c2,from_prod_qty:_0x55920a,from_prod_level:_0x4c56c1,from_prod_isle:_0x26ada3,from_prod_pallet:_0x2ab585,to_prod_qty:_0x17eee4,to_prod_level:_0x2c2d7b,to_prod_isle:_0x4ab203,to_prod_pallet:_0x50ac8b,primary_code:_0x5b0e74,secondary_code:_0x43e7ee,product_code3:_0x23e1b1,note:_0x58f2fd,invoice:_0x4fa546,expiry_date:_0x3c083c}=_0x531dc9[_0x3307d3(0x1db)];if(typeof _0x4188c2==_0x3307d3(0x1c8))var _0x5e3ca2=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1ea)]],_0x5e61e4=[_0x531dc9[_0x3307d3(0x1db)]['from_prod_qty']],_0x5bb139=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x17b)]],_0x2abb39=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x139)]],_0x1fbf92=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x15c)]],_0x511e52=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1f7)]],_0x5cca08=[_0x531dc9['body']['to_prod_qty']],_0x158a83=[_0x531dc9[_0x3307d3(0x1db)]['to_prod_level']],_0x1b781a=[_0x531dc9['body'][_0x3307d3(0x1b0)]],_0x255d8f=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x12e)]],_0x55eb71=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1b3)]],_0x4434f=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x202)]],_0x353280=[_0x531dc9['body'][_0x3307d3(0x1ad)]],_0x19b1ef=[_0x531dc9['body'][_0x3307d3(0x1d2)]],_0x4559f0=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x148)]],_0x3a339b=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1ab)]],_0x2203ee=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1d3)]],_0x453a03=[_0x531dc9['body'][_0x3307d3(0x190)]],_0x58c009=[_0x531dc9[_0x3307d3(0x1db)]['secondary_unit']],_0x28e980=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x15f)]],_0x4309ad=[_0x531dc9[_0x3307d3(0x1db)]['expiry_date']],_0x56d691=[_0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1f1)]],_0x4a3654=[_0x531dc9['body'][_0x3307d3(0x1cb)]];else var _0x5e3ca2=[..._0x531dc9['body']['prod_name']],_0x4434f=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x202)]],_0x353280=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1ad)]],_0x511e52=[..._0x531dc9['body'][_0x3307d3(0x1f7)]],_0x55eb71=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1b3)]],_0x5e61e4=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x211)]],_0x5bb139=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x17b)]],_0x2abb39=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x139)]],_0x1fbf92=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x15c)]],_0x5cca08=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1b1)]],_0x158a83=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1f2)]],_0x1b781a=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1b0)]],_0x255d8f=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x12e)]],_0x19b1ef=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1d2)]],_0x4559f0=[..._0x531dc9[_0x3307d3(0x1db)]['secondary_code']],_0x3a339b=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1ab)]],_0x2203ee=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1d3)]],_0x453a03=[..._0x531dc9['body'][_0x3307d3(0x190)]],_0x58c009=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x156)]],_0x28e980=[..._0x531dc9['body'][_0x3307d3(0x15f)]],_0x4309ad=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1a7)]],_0x56d691=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1f1)]],_0x4a3654=[..._0x531dc9[_0x3307d3(0x1db)][_0x3307d3(0x1cb)]];const _0x494114=_0x5e3ca2['map'](_0x52fd95=>{return _0x52fd95={'product_name':_0x52fd95};});_0x5e61e4[_0x3307d3(0x193)]((_0x51486c,_0x3efbc1)=>{_0x494114[_0x3efbc1]['from_quantity']=_0x51486c;}),_0x5bb139[_0x3307d3(0x193)]((_0x4d2668,_0x44522d)=>{var _0x3eae70=_0x3307d3;_0x494114[_0x44522d][_0x3eae70(0x185)]=_0x4d2668;}),_0x2abb39[_0x3307d3(0x193)]((_0x1bd362,_0x31cbdb)=>{var _0x1a81d4=_0x3307d3;_0x494114[_0x31cbdb][_0x1a81d4(0x16f)]=_0x1bd362;}),_0x1fbf92['forEach']((_0x1070f8,_0x3bdde0)=>{_0x494114[_0x3bdde0]['from_floorlevel']=_0x1070f8;}),_0x5cca08['forEach']((_0x50936a,_0x2a2ebf)=>{var _0x362191=_0x3307d3;_0x494114[_0x2a2ebf][_0x362191(0x18d)]=_0x50936a;}),_0x158a83['forEach']((_0xd4875a,_0x17b98f)=>{var _0x264de4=_0x3307d3;_0x494114[_0x17b98f][_0x264de4(0x15d)]=_0xd4875a;}),_0x1b781a[_0x3307d3(0x193)]((_0xb8b108,_0x1f1b06)=>{_0x494114[_0x1f1b06]['to_bin']=_0xb8b108;}),_0x255d8f[_0x3307d3(0x193)]((_0x26774f,_0x1adf3a)=>{var _0x42c0d8=_0x3307d3;_0x494114[_0x1adf3a][_0x42c0d8(0x14e)]=_0x26774f;}),_0x19b1ef[_0x3307d3(0x193)]((_0x5a2878,_0x27c1d4)=>{var _0x27ea12=_0x3307d3;_0x494114[_0x27c1d4][_0x27ea12(0x1d2)]=_0x5a2878;}),_0x4559f0[_0x3307d3(0x193)]((_0x3a0167,_0x5c4c02)=>{var _0xe1d636=_0x3307d3;_0x494114[_0x5c4c02][_0xe1d636(0x148)]=_0x3a0167;}),_0x3a339b[_0x3307d3(0x193)]((_0x59a27b,_0x1e5968)=>{_0x494114[_0x1e5968]['product_code']=_0x59a27b;}),_0x2203ee[_0x3307d3(0x193)]((_0x5cff0b,_0x143b2a)=>{var _0x15b5dc=_0x3307d3;_0x494114[_0x143b2a][_0x15b5dc(0x21e)]=_0x5cff0b;}),_0x453a03[_0x3307d3(0x193)]((_0x3107f9,_0xf035bb)=>{var _0x4c9cdf=_0x3307d3;_0x494114[_0xf035bb][_0x4c9cdf(0x190)]=_0x3107f9;}),_0x58c009[_0x3307d3(0x193)]((_0x33eb00,_0x57fa6b)=>{_0x494114[_0x57fa6b]['secondary_unit']=_0x33eb00;}),_0x28e980[_0x3307d3(0x193)]((_0x5a6dbf,_0x261131)=>{var _0x449169=_0x3307d3;_0x494114[_0x261131][_0x449169(0x15f)]=_0x5a6dbf;}),_0x4309ad[_0x3307d3(0x193)]((_0x45d458,_0x2c8f30)=>{var _0x52760f=_0x3307d3;_0x494114[_0x2c8f30][_0x52760f(0x1a7)]=_0x45d458;}),_0x4434f['forEach']((_0x4e9c76,_0x47317f)=>{var _0x21b80e=_0x3307d3;_0x494114[_0x47317f][_0x21b80e(0x202)]=_0x4e9c76;}),_0x353280[_0x3307d3(0x193)]((_0x348022,_0x64e973)=>{var _0x56aa94=_0x3307d3;_0x494114[_0x64e973][_0x56aa94(0x1bd)]=_0x348022;}),_0x511e52['forEach']((_0x5d4772,_0x455eab)=>{_0x494114[_0x455eab]['from_types']=_0x5d4772;}),_0x55eb71['forEach']((_0x450620,_0xe80ab4)=>{_0x494114[_0xe80ab4]['to_types']=_0x450620;}),_0x56d691[_0x3307d3(0x193)]((_0x5401b2,_0x48d5dd)=>{var _0x378e6d=_0x3307d3;_0x494114[_0x48d5dd][_0x378e6d(0x1f1)]=_0x5401b2;}),_0x4a3654[_0x3307d3(0x193)]((_0xff7613,_0x86b1af)=>{var _0x5f41a1=_0x3307d3;_0x494114[_0x86b1af][_0x5f41a1(0x186)]=_0xff7613;});const _0x529a70=_0x494114['filter'](_0x62d34b=>_0x62d34b[_0x3307d3(0x18d)]!=='0'&&_0x62d34b[_0x3307d3(0x18d)]!==''||_0x62d34b[_0x3307d3(0x14e)]!=='0'&&_0x62d34b[_0x3307d3(0x14e)]!=='');var _0x287d79=0x0;_0x529a70['forEach'](_0x5e35ae=>{var _0x1a067c=_0x3307d3;parseInt(_0x5e35ae[_0x1a067c(0x213)])<parseInt(_0x5e35ae[_0x1a067c(0x18d)])&&_0x287d79++;});if(_0x287d79!=0x0)return _0x531dc9[_0x3307d3(0x1cc)]('errors',_0x3307d3(0x15a)),_0x5eecca[_0x3307d3(0x171)](_0x3307d3(0x153));const _0x5be7cf=await warehouse[_0x3307d3(0x1e3)]({'name':_0x71bfc9[_0x3307d3(0x18f)],'room':_0x71bfc9['from_room']});_0x71bfc9[_0x3307d3(0x1a4)][_0x3307d3(0x193)](_0x33f8a6=>{var _0x12c4aa=_0x3307d3;if(_0x33f8a6['to_quantity']>0x0){const _0x1986b1=_0x5be7cf[_0x12c4aa(0x146)][_0x12c4aa(0x1e4)](_0x343134=>{var _0x19b8fc=_0x12c4aa;_0x343134['product_name']==_0x33f8a6[_0x19b8fc(0x1e5)]&&_0x343134[_0x19b8fc(0x1e9)]==_0x33f8a6[_0x19b8fc(0x1dc)]&&_0x343134[_0x19b8fc(0x178)]==_0x33f8a6[_0x19b8fc(0x1f7)]&&_0x343134['bin']==_0x33f8a6[_0x19b8fc(0x16f)]&&_0x343134[_0x19b8fc(0x161)]==_0x33f8a6['from_bay']&&_0x343134[_0x19b8fc(0x1bd)]==_0x33f8a6['from_rack']&&_0x343134[_0x19b8fc(0x202)]==_0x33f8a6['from_storage']&&(_0x343134[_0x19b8fc(0x20f)]=parseInt(_0x343134['product_stock'])+parseInt(_0x33f8a6[_0x19b8fc(0x18d)]));});}}),await _0x5be7cf[_0x3307d3(0x192)]();const _0x55e829=await warehouse[_0x3307d3(0x1e3)]({'name':_0x71bfc9['to_warehouse'],'room':_0x71bfc9['to_room']});_0x71bfc9[_0x3307d3(0x1a4)]['forEach'](_0x37d8cd=>{var _0x335f85=_0x3307d3;if(_0x37d8cd[_0x335f85(0x18d)]>0x0){const _0x27a85f=_0x55e829[_0x335f85(0x146)][_0x335f85(0x1e4)](_0x5eff55=>{var _0x1b0326=_0x335f85;_0x5eff55[_0x1b0326(0x1e5)]==_0x37d8cd[_0x1b0326(0x1e5)]&&_0x5eff55[_0x1b0326(0x1e9)]==_0x37d8cd[_0x1b0326(0x14e)]&&_0x5eff55[_0x1b0326(0x178)]==_0x37d8cd[_0x1b0326(0x1b3)]&&_0x5eff55[_0x1b0326(0x162)]==_0x37d8cd[_0x1b0326(0x13c)]&&_0x5eff55[_0x1b0326(0x161)]==_0x37d8cd[_0x1b0326(0x15d)]&&_0x5eff55[_0x1b0326(0x1bd)]==_0x37d8cd[_0x1b0326(0x1bd)]&&_0x5eff55['storage']==_0x37d8cd[_0x1b0326(0x202)]&&(_0x5eff55[_0x1b0326(0x20f)]=parseInt(_0x5eff55[_0x1b0326(0x20f)])-parseInt(_0x37d8cd['to_quantity']));});}}),await _0x55e829[_0x3307d3(0x192)](),_0x71bfc9[_0x3307d3(0x159)]=_0x11c9ef,_0x71bfc9[_0x3307d3(0x18f)]=_0x3e492b,_0x71bfc9['to_warehouse']=_0x2e08d1,_0x71bfc9['product']=_0x529a70,_0x71bfc9[_0x3307d3(0x1bb)]=_0x58f2fd,_0x71bfc9[_0x3307d3(0x209)]=_0x4fa546;const _0x332b83=await _0x71bfc9[_0x3307d3(0x192)]();console[_0x3307d3(0x1b7)](_0x332b83);const _0x321ae4=await warehouse[_0x3307d3(0x1e3)]({'name':_0x3e492b,'room':_0x2f09fd});_0x332b83[_0x3307d3(0x1a4)][_0x3307d3(0x193)](_0x3893cb=>{var _0x5f1407=_0x3307d3;if(_0x3893cb[_0x5f1407(0x18d)]>0x0){const _0x2cd422=_0x321ae4['product_details']['map'](_0x490a8b=>{var _0x14160c=_0x5f1407;_0x490a8b[_0x14160c(0x1e5)]==_0x3893cb[_0x14160c(0x1e5)]&&_0x490a8b[_0x14160c(0x1e9)]==_0x3893cb['from_floorlevel']&&_0x490a8b[_0x14160c(0x178)]==_0x3893cb['from_types']&&_0x490a8b[_0x14160c(0x162)]==_0x3893cb[_0x14160c(0x16f)]&&_0x490a8b[_0x14160c(0x161)]==_0x3893cb['from_bay']&&_0x490a8b[_0x14160c(0x1bd)]==_0x3893cb[_0x14160c(0x186)]&&_0x490a8b[_0x14160c(0x202)]==_0x3893cb['from_storage']&&(_0x490a8b[_0x14160c(0x20f)]=parseInt(_0x490a8b['product_stock'])-parseInt(_0x3893cb[_0x14160c(0x18d)]));});}}),await _0x321ae4['save']();const _0x55a86e=await warehouse['findOne']({'name':_0x2e08d1,'room':_0x332c29});_0x332b83[_0x3307d3(0x1a4)][_0x3307d3(0x193)](_0x4d4703=>{var _0x2fe0b2=_0x3307d3;if(_0x4d4703['to_quantity']>0x0){var _0x5667d3=0x0;const _0x48de41=_0x55a86e['product_details'][_0x2fe0b2(0x1e4)](_0x21fa46=>{var _0x252e89=_0x2fe0b2;_0x21fa46[_0x252e89(0x1e5)]==_0x4d4703[_0x252e89(0x1e5)]&&_0x21fa46['floorlevel']==_0x4d4703[_0x252e89(0x14e)]&&_0x21fa46['type']==_0x4d4703[_0x252e89(0x1b3)]&&_0x21fa46[_0x252e89(0x162)]==_0x4d4703['to_bin']&&_0x21fa46[_0x252e89(0x161)]==_0x4d4703[_0x252e89(0x15d)]&&_0x21fa46[_0x252e89(0x1bd)]==_0x4d4703[_0x252e89(0x1bd)]&&_0x21fa46['storage']==_0x4d4703[_0x252e89(0x202)]&&(_0x21fa46['product_stock']=parseInt(_0x21fa46[_0x252e89(0x20f)])+parseInt(_0x4d4703[_0x252e89(0x18d)]),_0x5667d3++);});_0x5667d3=='0'&&(_0x55a86e['product_details']=_0x55a86e[_0x2fe0b2(0x146)]['concat']({'product_name':_0x4d4703['product_name'],'product_stock':_0x4d4703[_0x2fe0b2(0x18d)],'bay':_0x4d4703[_0x2fe0b2(0x15d)],'bin':_0x4d4703['to_bin'],'type':_0x4d4703[_0x2fe0b2(0x1b3)],'floorlevel':_0x4d4703[_0x2fe0b2(0x14e)],'storage':_0x4d4703['storage'],'rack':_0x4d4703['rack'],'product_code':_0x4d4703[_0x2fe0b2(0x17d)],'primary_code':_0x4d4703[_0x2fe0b2(0x1d2)],'secondary_code':_0x4d4703[_0x2fe0b2(0x148)],'maxProducts':_0x4d4703[_0x2fe0b2(0x21e)],'storage':_0x4d4703[_0x2fe0b2(0x202)],'rack':_0x4d4703[_0x2fe0b2(0x1bd)]}));}}),await _0x55a86e['save'](),_0x531dc9['flash'](_0x3307d3(0x1a1),_0x3307d3(0x134)),_0x5eecca[_0x3307d3(0x171)]('/transfer/view');}catch(_0x355a63){console['log'](_0x355a63);}}),router['post']('/barcode_scanner',async(_0x1188a5,_0x405f96)=>{var _0x1c857f=a0_0x3febab;const {FromWareHouse:_0x4b5979,FromRoom:_0x407db4,ToWarehouse:_0x1155cc,ToRoom:_0x43399b,primary_code:_0x2c1569,Roomslist:_0xb5ae3e}=_0x1188a5[_0x1c857f(0x1db)],_0x21fd47=_0xb5ae3e[_0x1c857f(0x177)](','),_0x56e671=[];async function _0x527c9f(_0x512c88){var _0x430e2d=_0x1c857f;const _0x24e561=await warehouse[_0x430e2d(0x1de)]([{'$match':{'name':_0x4b5979,'room':_0x512c88}},{'$unwind':_0x430e2d(0x176)},{'$match':{'product_details.primary_code':_0x2c1569}},{'$group':{'_id':_0x430e2d(0x16b),'name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x430e2d(0x1ac)},'secondary_code':{'$first':_0x430e2d(0x1cf)},'product_code':{'$first':_0x430e2d(0x212)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x430e2d(0x140)},'type':{'$first':_0x430e2d(0x142)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x430e2d(0x1df)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x430e2d(0x1e0)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x430e2d(0x1dd)},'batch_code':{'$first':_0x430e2d(0x217)},'maxPerUnit':{'$first':_0x430e2d(0x158)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x430e2d(0x13a)},'maxProducts':{'$first':_0x430e2d(0x163)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0xca48c1=await warehouse[_0x430e2d(0x1de)]([{'$match':{'name':_0x4b5979,'room':_0x512c88}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2c1569}},{'$group':{'_id':_0x430e2d(0x16b),'name':{'$first':_0x430e2d(0x1a9)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x430e2d(0x1ac)},'secondary_code':{'$first':_0x430e2d(0x1cf)},'product_code':{'$first':_0x430e2d(0x212)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x430e2d(0x140)},'type':{'$first':_0x430e2d(0x142)},'pallet':{'$first':_0x430e2d(0x149)},'unit':{'$first':_0x430e2d(0x1df)},'secondary_unit':{'$first':_0x430e2d(0x1f3)},'storage':{'$first':_0x430e2d(0x1e0)},'rack':{'$first':_0x430e2d(0x14f)},'expiry_date':{'$first':_0x430e2d(0x196)},'production_date':{'$first':_0x430e2d(0x1dd)},'batch_code':{'$first':_0x430e2d(0x217)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x430e2d(0x13a)},'maxProducts':{'$first':_0x430e2d(0x163)},'invoice_product':{'$first':_0x430e2d(0x20d)}}}]);if(_0x24e561[_0x430e2d(0x1ca)]>0x0)_0x56e671[_0x430e2d(0x197)](_0x24e561);else _0xca48c1[_0x430e2d(0x1ca)]>0x0&&_0x56e671[_0x430e2d(0x197)](_0xca48c1);}const _0x2c7473=_0x21fd47[_0x1c857f(0x1e4)](_0x204362=>_0x527c9f(_0x204362));await Promise[_0x1c857f(0x18c)](_0x2c7473),_0x405f96[_0x1c857f(0x1fc)](_0x56e671);}),router['post'](a0_0x3febab(0x184),async(_0x334342,_0x5f2639)=>{var _0x2a3619=a0_0x3febab;try{const {FromWareHouse:_0x3eeeb4,FromRoom:_0x54c0cb,ToWarehouse:_0x405d07,ToRoom:_0x1b1a74,secondary_code:_0x5a255a}=_0x334342[_0x2a3619(0x1db)],_0x3c736e=await warehouse[_0x2a3619(0x1de)]([{'$match':{'name':_0x3eeeb4}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x5a255a}},{'$group':{'_id':_0x2a3619(0x16b),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2a3619(0x1cf)},'product_code':{'$first':_0x2a3619(0x212)},'instock':{'$first':_0x2a3619(0x14c)},'warehouse':{'$first':'$name'},'level':{'$first':_0x2a3619(0x1da)},'isle':{'$first':_0x2a3619(0x21c)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x2a3619(0x163)},'unit':{'$first':_0x2a3619(0x1df)}}}]);_0x5f2639[_0x2a3619(0x1c4)](0xc8)[_0x2a3619(0x1fc)](_0x3c736e);}catch(_0xcc43b5){_0x5f2639[_0x2a3619(0x1c4)](0x194)[_0x2a3619(0x1fc)]({'message':_0xcc43b5[_0x2a3619(0x1ee)]});}}),router[a0_0x3febab(0x13f)]('/barcode_scanner3',async(_0x5f4230,_0x18fce3)=>{var _0x252ada=a0_0x3febab;try{const {FromWareHouse:_0x932ecf,FromRoom:_0x54ebc3,ToWarehouse:_0x58dc23,ToRoom:_0x2e027f,product_code:_0x2faa88}=_0x5f4230[_0x252ada(0x1db)],_0x4e93e7=await warehouse['aggregate']([{'$match':{'name':_0x932ecf}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x2faa88}},{'$group':{'_id':_0x252ada(0x16b),'name':{'$first':_0x252ada(0x1a9)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x252ada(0x1cf)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x252ada(0x14c)},'warehouse':{'$first':_0x252ada(0x17a)},'level':{'$first':_0x252ada(0x1da)},'isle':{'$first':_0x252ada(0x21c)},'pallet':{'$first':_0x252ada(0x182)},'maxProducts':{'$first':_0x252ada(0x163)},'unit':{'$first':_0x252ada(0x1df)}}}]);_0x18fce3[_0x252ada(0x1c4)](0xc8)[_0x252ada(0x1fc)](_0x4e93e7);}catch(_0x235ec4){_0x18fce3[_0x252ada(0x1c4)](0x194)['json']({'message':_0x235ec4['message']});}}),router[a0_0x3febab(0x13f)](a0_0x3febab(0x1aa),async(_0x5b1321,_0xb42464)=>{var _0x12ff32=a0_0x3febab;const {level:_0x25e888,isle:_0x44bd83,pallet:_0x40e542,warehouses:_0x5b6d1e,room:_0x335d73}=_0x5b1321[_0x12ff32(0x1db)];try{const _0x577c7e=await warehouse['aggregate']([{'$match':{'name':_0x5b6d1e,'room':_0x335d73}},{'$unwind':_0x12ff32(0x176)},{'$match':{'product_details.level':parseInt(_0x25e888),'product_details.isle':_0x44bd83,'product_details.pallet':parseInt(_0x40e542)}},{'$group':{'_id':_0x12ff32(0x16b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x12ff32(0x14c)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x12ff32(0x21c)},'pallet':{'$first':_0x12ff32(0x182)},'maxProducts':{'$first':_0x12ff32(0x163)}}}]);_0xb42464[_0x12ff32(0x1c4)](0xc8)['json'](_0x577c7e);}catch(_0x1eb939){_0xb42464[_0x12ff32(0x1c4)](0x194)[_0x12ff32(0x1fc)]({'message':_0x1eb939[_0x12ff32(0x1ee)]});}}),module[a0_0x3febab(0x166)]=router;