var a0_0x7a021a=a0_0x32a3;(function(_0x192764,_0x1bac78){var _0x5220e9=a0_0x32a3,_0x2251c8=_0x192764();while(!![]){try{var _0x36b672=-parseInt(_0x5220e9(0x12c))/0x1*(parseInt(_0x5220e9(0x10f))/0x2)+-parseInt(_0x5220e9(0x156))/0x3+parseInt(_0x5220e9(0x10d))/0x4+-parseInt(_0x5220e9(0x12d))/0x5*(-parseInt(_0x5220e9(0x157))/0x6)+-parseInt(_0x5220e9(0xcc))/0x7+-parseInt(_0x5220e9(0xaa))/0x8+parseInt(_0x5220e9(0xec))/0x9*(parseInt(_0x5220e9(0x169))/0xa);if(_0x36b672===_0x1bac78)break;else _0x2251c8['push'](_0x2251c8['shift']());}catch(_0x3e269d){_0x2251c8['push'](_0x2251c8['shift']());}}}(a0_0x3ee1,0xe8784));const express=require(a0_0x7a021a(0xfd)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x7a021a(0x150)),auth=require(a0_0x7a021a(0x9f)),users=require(a0_0x7a021a(0x171)),nodemailer=require(a0_0x7a021a(0xa2));router[a0_0x7a021a(0xc6)]('/view',auth,async(_0x4c1f33,_0x16dd6c)=>{var _0x61ff3f=a0_0x7a021a;try{const {username:_0x2713b5,email:_0x10d03d,role:_0x311ca8}=_0x4c1f33['user'],_0x5b0b67=_0x4c1f33[_0x61ff3f(0x11a)],_0x4e0392=await profile[_0x61ff3f(0xb1)]({'email':_0x5b0b67['email']}),_0x1ee7dd=await master_shop['find']();console[_0x61ff3f(0x164)](_0x61ff3f(0xe1),_0x1ee7dd);let _0x2ce691;if(_0x5b0b67['role']==_0x61ff3f(0x161)){const _0x50d4d4=await staff['findOne']({'email':_0x5b0b67['email']});_0x2ce691=await transfers['find']({'from_warehouse':_0x50d4d4[_0x61ff3f(0x168)]});}else _0x2ce691=await transfers['aggregate']([{'$unwind':_0x61ff3f(0x14f)},{'$group':{'_id':'$_id','invoice':{'$first':_0x61ff3f(0x12e)},'date':{'$first':_0x61ff3f(0xe8)},'from_warehouse':{'$first':_0x61ff3f(0x138)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x61ff3f(0xc5)},'to_room_name':{'$addToSet':_0x61ff3f(0x15b)},'finalize':{'$first':_0x61ff3f(0xeb)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1ee7dd[0x0][_0x61ff3f(0x9e)]==_0x61ff3f(0xfc)){var _0x3c87f5=users[_0x61ff3f(0xb8)];console['log'](_0x3c87f5);}else{if(_0x1ee7dd[0x0][_0x61ff3f(0x9e)]=='Hindi')var _0x3c87f5=users[_0x61ff3f(0x134)];else{if(_0x1ee7dd[0x0][_0x61ff3f(0x9e)]==_0x61ff3f(0xc0))var _0x3c87f5=users[_0x61ff3f(0xc0)];else{if(_0x1ee7dd[0x0][_0x61ff3f(0x9e)]==_0x61ff3f(0x9a))var _0x3c87f5=users[_0x61ff3f(0x9a)];else{if(_0x1ee7dd[0x0][_0x61ff3f(0x9e)]==_0x61ff3f(0x115))var _0x3c87f5=users[_0x61ff3f(0x115)];else{if(_0x1ee7dd[0x0][_0x61ff3f(0x9e)]==_0x61ff3f(0xba))var _0x3c87f5=users['Portuguese'];else{if(_0x1ee7dd[0x0]['language']==_0x61ff3f(0xed))var _0x3c87f5=users[_0x61ff3f(0xed)];else{if(_0x1ee7dd[0x0]['language']==_0x61ff3f(0x9b))var _0x3c87f5=users[_0x61ff3f(0x144)];}}}}}}}_0x16dd6c[_0x61ff3f(0xc8)](_0x61ff3f(0x135),{'success':_0x4c1f33['flash'](_0x61ff3f(0x123)),'errors':_0x4c1f33['flash']('errors'),'role':_0x5b0b67,'profile':_0x4e0392,'master_shop':_0x1ee7dd,'transfer':_0x2ce691,'language':_0x3c87f5});}catch(_0x83fc3e){console[_0x61ff3f(0x164)](_0x83fc3e);}});async function getRandom8DigitNumber(){var _0x363644=a0_0x7a021a;const _0xa5a34d=0x989680,_0x300782=0x5f5e0ff,_0xb1669f=Math[_0x363644(0x11b)](Math[_0x363644(0xfb)]()*(_0x300782-_0xa5a34d+0x1))+_0xa5a34d;var _0x1e8aa1;const _0x9ad74f=await transfers['findOne']({'invoice':'TRF-'+_0xb1669f});return _0x9ad74f&&_0x9ad74f[_0x363644(0x167)]>0x0?_0x1e8aa1=_0x363644(0x162)+_0xb1669f:_0x1e8aa1=_0x363644(0x162)+_0xb1669f,_0x1e8aa1;}function a0_0x32a3(_0x535211,_0x3d6207){var _0x3ee154=a0_0x3ee1();return a0_0x32a3=function(_0x32a360,_0x2b2134){_0x32a360=_0x32a360-0x8f;var _0x4d2864=_0x3ee154[_0x32a360];return _0x4d2864;},a0_0x32a3(_0x535211,_0x3d6207);}function a0_0x3ee1(){var _0x1678b5=['$product_details.product_code','\x20<>\x20','Raw\x20Materials','$product_details.pallet','image','catch','Spanish','Arabic\x20(ae)','$name','expiry_date','language','../middleware/auth','from_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','nodemailer','Shelves','map','$product_details.storage','rack','</h5>','$product_details.maxProducts','Product\x20Transfer\x20successfully','5826184sQvNWp','/barcode_scanner3','To_invoice','</body></html>','$product_details.batch_code','$product_details.product_stock','True','findOne','aggregate','Portuguese','from_prod_qty','site_title','$product_details.maxPerUnit','product_stock','English','<h5\x20style=\x22text-align:\x20left;\x22>','Portuguese\x20(BR)','<div>','host','filter','from_types','$room','German','$product_details.type','<h5>','bay','$product_details.primary_code','$product.from_room_name','get','batch_code','render','unit','primary_code','to_invoice','4579106boCakG','invoice','$product_details.bin','</tr>','from_room_name','edit_transfer_view','type','from_warehouse','<hr\x20class=\x22my-3\x22>','padStart','getFullYear','Ambient','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','to_floorlevel','Floor','prod_cat','email','errors','$product_details.secondary_unit','$product_details.production_date','password','master','/preview/:id','RMSEmail','/barcode_scanner','findById','Transfer\x20Finalize\x20Successfully','to_warehouse','$date','flash','slice','$finalize','9crZkwS','Chinese','params','to_prod_isle','Return\x20Rooms','Rack\x20F','add_transfer','There\x27s\x20a\x20error\x20in\x20this\x20transaction','maxProducts','$product_details.rack','id_transaction','message','prod_name','/barcode_scanner2','<html><head><title></title>','random','English\x20(US)','express','split','storage','Enabled','toString','to_prod_level','from_floorlevel','body','from_bay','$product_details','post','getMonth','$product_details.invoice','to_room','<strong>\x20Regards\x20</strong>','$product_details.secondary_code','879360KwmLFB','An\x20error\x20occurred.','2NcNxpN','from_rack','from_prod_pallet','bin','</head><body>','Transfer\x20Mail','French','/../public','to_prod_qty','id_transaction_id','port','user','floor','Receiving\x20Area','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','push','from_bin','all','Rack\x20A','json','success','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','save','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','production_date','then','logo','/transfer/preview/','_id','1597453cuctAS','455YjDhfK','$invoice','maxperunit','role','max_per_unit','Rack\x20B','getDate','Hindi','transfer','floorlevel','\x20</h2>','$from_warehouse','/view/add_transfer','</tbody>','$product_details.product_name','<!DOCTYPE\x20html>','Level','MaxStocks_data2','createTransport','Enclosed','to_bay','</div>','product_details','Arabic','from_room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','product_code','from_rak','$product_details.unit','from_prod_isle','from_prod_level','find','here','secondary_unit','$product','../models/all_models','RoomAssigned','to_bin','ToRoomAssigned','to_prod_pallet','/transfer/view','3472116kTjpuE','12630fwvlWg','</td>','/view/:id','Rack\x20D','$product.to_room_name','from_storage','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/upload/','date','from_invoice','staff','TRF-','forEach','log','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','An\x20error\x20occurred\x20while\x20saving\x20data.','length','warehouse','46780570FitZYZ','<table\x20style=\x22width:\x20100%\x20!important;\x22>','to_room_name','</table>','string','$product_details.level','$product_details._id','to_types','../public/language/languages.json','$product_details.expiry_date','/CheckingWarehouse','redirect','status','$product_details.bay','product_code3','finalize','$product_details.isle','product_name','Email\x20sent\x20successfully','to_quantity','<span\x20style=\x22float:\x20right;\x22>','$product_details.floorlevel','secondary_code','error','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product','<tr>'];a0_0x3ee1=function(){return _0x1678b5;};return a0_0x3ee1();}router['get']('/view/add_transfer',auth,async(_0x39bf9a,_0x3ed6d4)=>{var _0x46a288=a0_0x7a021a;try{const {username:_0x5ae48d,email:_0x59f7c5,role:_0x456509}=_0x39bf9a[_0x46a288(0x11a)],_0x193fa0=_0x39bf9a[_0x46a288(0x11a)],_0x2a3da5=await profile[_0x46a288(0xb1)]({'email':_0x193fa0[_0x46a288(0xdc)]}),_0x4afdf8=await master_shop[_0x46a288(0x14c)]();console[_0x46a288(0x164)](_0x46a288(0xe1),_0x4afdf8);let _0x26536f;if(_0x193fa0[_0x46a288(0x130)]==_0x46a288(0x161)){const _0xd1d64b=await staff[_0x46a288(0xb1)]({'email':_0x193fa0[_0x46a288(0xdc)]});_0x26536f=await warehouse['aggregate']([{'$match':{'status':_0x46a288(0x100),'name':_0xd1d64b['warehouse'],'warehouse_category':_0x46a288(0x96)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x26536f=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x46a288(0x96)}},{'$group':{'_id':'$name','name':{'$first':_0x46a288(0x9c)}}}]);var _0x16d32d=[_0x46a288(0xd7),_0x46a288(0x140),_0x46a288(0xf0)];const _0x30f11f=await transfers['find']({}),_0x3840b3=_0x30f11f[_0x46a288(0x167)]+0x1,_0x2a223f=_0x46a288(0x162)+_0x3840b3[_0x46a288(0x101)]()[_0x46a288(0xd5)](0x5,'0');if(_0x4afdf8[0x0][_0x46a288(0x9e)]==_0x46a288(0xfc)){var _0x1c141a=users[_0x46a288(0xb8)];console[_0x46a288(0x164)](_0x1c141a);}else{if(_0x4afdf8[0x0]['language']==_0x46a288(0x134))var _0x1c141a=users[_0x46a288(0x134)];else{if(_0x4afdf8[0x0]['language']==_0x46a288(0xc0))var _0x1c141a=users[_0x46a288(0xc0)];else{if(_0x4afdf8[0x0][_0x46a288(0x9e)]==_0x46a288(0x9a))var _0x1c141a=users[_0x46a288(0x9a)];else{if(_0x4afdf8[0x0][_0x46a288(0x9e)]==_0x46a288(0x115))var _0x1c141a=users[_0x46a288(0x115)];else{if(_0x4afdf8[0x0][_0x46a288(0x9e)]==_0x46a288(0xba))var _0x1c141a=users[_0x46a288(0xb3)];else{if(_0x4afdf8[0x0]['language']==_0x46a288(0xed))var _0x1c141a=users[_0x46a288(0xed)];else{if(_0x4afdf8[0x0][_0x46a288(0x9e)]==_0x46a288(0x9b))var _0x1c141a=users[_0x46a288(0x144)];}}}}}}}const _0x4cff09=getRandom8DigitNumber();_0x4cff09[_0x46a288(0x128)](_0x5b3031=>{var _0x136dc9=_0x46a288;_0x3ed6d4[_0x136dc9(0xc8)](_0x136dc9(0xf2),{'success':_0x39bf9a[_0x136dc9(0xe9)](_0x136dc9(0x123)),'errors':_0x39bf9a[_0x136dc9(0xe9)]('errors'),'role':_0x193fa0,'profile':_0x2a3da5,'master_shop':_0x4afdf8,'warehouse':_0x26536f,'language':_0x1c141a,'rooms_data':_0x16d32d,'invoice':_0x5b3031});})[_0x46a288(0x99)](_0x2fcfe8=>{var _0x3c6d20=_0x46a288;_0x39bf9a[_0x3c6d20(0xe9)](_0x3c6d20(0xdd),_0x3c6d20(0xf3)),_0x3ed6d4[_0x3c6d20(0x174)](_0x3c6d20(0x155));});}catch(_0x59288f){console[_0x46a288(0x164)](_0x59288f);}}),router[a0_0x7a021a(0x107)](a0_0x7a021a(0x139),auth,async(_0x3037b1,_0x98e51)=>{var _0x517d28=a0_0x7a021a;try{console[_0x517d28(0x164)](_0x3037b1[_0x517d28(0x104)]);const {date:_0xf93b1,from_warehouse:_0x55ce3b,FromRoom_name:_0x3877d3,to_warehouse:_0x22b975,ToRoom_name:_0x111360,prod_name:_0x1963b4,from_prod_qty:_0xfb297f,from_prod_level:_0x339dfb,from_prod_isle:_0x48a5d4,from_prod_pallet:_0x5e833b,to_prod_qty:_0x5f1e92,to_prod_level:_0x50119d,to_prod_isle:_0x268b2d,to_prod_pallet:_0x2b2921,primary_code:_0x4433c5,secondary_code:_0x1f15a7,product_code3:_0x5729fd,note:_0x36e93a,MaxStocks_data2:_0x5f0ade,invoice:_0x44a134,expiry_date:_0x538bd6}=_0x3037b1[_0x517d28(0x104)];if(typeof _0x1963b4=='string')var _0xe40ca0=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0xf8)]],_0x850278=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0xb4)]],_0x2ec49e=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0x14b)]],_0x1db60c=[_0x3037b1['body']['New_Qty_Converted']],_0x2f8a97=[_0x3037b1['body']['to_prod_level']],_0x4801c7=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0xca)]],_0x28d334=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0x8f)]],_0x20f986=[_0x3037b1['body'][_0x517d28(0x177)]],_0x3c6349=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0x13e)]],_0x5bb844=[_0x3037b1[_0x517d28(0x104)]['primary_unit']],_0x2d31bf=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0x14e)]],_0x5cc7da=[_0x3037b1[_0x517d28(0x104)]['batch_code']],_0x5da8ad=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0x9d)]],_0x16c794=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0x131)]],_0x44f27c=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0x127)]],_0x1ac534=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0xdb)]],_0x47df2a=[_0x3037b1[_0x517d28(0x104)]['RoomAssigned']],_0x2f12d3=[_0x3037b1[_0x517d28(0x104)]['ToRoomAssigned']],_0x242357=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0x160)]],_0x5526f5=[_0x3037b1[_0x517d28(0x104)]['to_invoice']],_0x1cf67d=[_0x3037b1[_0x517d28(0x104)][_0x517d28(0xf6)]];else var _0xe40ca0=[..._0x3037b1['body'][_0x517d28(0xf8)]],_0x850278=[..._0x3037b1[_0x517d28(0x104)]['from_prod_qty']],_0x2ec49e=[..._0x3037b1[_0x517d28(0x104)][_0x517d28(0x14b)]],_0x1db60c=[..._0x3037b1[_0x517d28(0x104)]['New_Qty_Converted']],_0x2f8a97=[..._0x3037b1[_0x517d28(0x104)][_0x517d28(0x102)]],_0x4801c7=[..._0x3037b1[_0x517d28(0x104)][_0x517d28(0xca)]],_0x28d334=[..._0x3037b1['body']['secondary_code']],_0x20f986=[..._0x3037b1[_0x517d28(0x104)]['product_code3']],_0x3c6349=[..._0x3037b1['body'][_0x517d28(0x13e)]],_0x5bb844=[..._0x3037b1['body']['primary_unit']],_0x2d31bf=[..._0x3037b1[_0x517d28(0x104)][_0x517d28(0x14e)]],_0x5cc7da=[..._0x3037b1['body'][_0x517d28(0xc7)]],_0x5da8ad=[..._0x3037b1[_0x517d28(0x104)]['expiry_date']],_0x16c794=[..._0x3037b1['body']['max_per_unit']],_0x44f27c=[..._0x3037b1[_0x517d28(0x104)]['production_date']],_0x1ac534=[..._0x3037b1['body'][_0x517d28(0xdb)]],_0x47df2a=[..._0x3037b1['body'][_0x517d28(0x151)]],_0x2f12d3=[..._0x3037b1['body'][_0x517d28(0x153)]],_0x242357=[..._0x3037b1[_0x517d28(0x104)]['from_invoice']],_0x5526f5=[..._0x3037b1['body'][_0x517d28(0xcb)]],_0x1cf67d=[..._0x3037b1['body'][_0x517d28(0xf6)]];const _0x1c39cd=_0xe40ca0[_0x517d28(0xa4)](_0x59229f=>{return _0x59229f={'product_name':_0x59229f};});_0x850278[_0x517d28(0x163)]((_0x310049,_0x3a59a3)=>{var _0x2fd3d3=_0x517d28;_0x1c39cd[_0x3a59a3][_0x2fd3d3(0xa0)]=_0x310049;}),_0x242357[_0x517d28(0x163)]((_0x4207b4,_0x1abf0d)=>{_0x1c39cd[_0x1abf0d]['from_invoice']=_0x4207b4;}),_0x5526f5['forEach']((_0x1d82a9,_0x4dba69)=>{var _0x10a138=_0x517d28;_0x1c39cd[_0x4dba69][_0x10a138(0xac)]=_0x1d82a9;}),_0x1cf67d[_0x517d28(0x163)]((_0x157e63,_0x1563e4)=>{_0x1c39cd[_0x1563e4]['id_transaction_id']=_0x157e63;}),_0x2ec49e['forEach']((_0x29e4e8,_0x41452b)=>{var _0xf83687=_0x517d28;_0x47df2a[_0xf83687(0x163)]((_0x1f9b5d,_0x28f325)=>{var _0x766793=_0xf83687;if(_0x1f9b5d==_0x766793(0x11c)&&_0x41452b==_0x28f325){var _0x26d3c2=_0x29e4e8[_0x766793(0xea)](0x3);_0x1c39cd[_0x41452b][_0x766793(0x15c)]=_0x29e4e8[0x0],_0x1c39cd[_0x41452b][_0x766793(0x110)]=_0x29e4e8[0x1],_0x1c39cd[_0x41452b][_0x766793(0x105)]=0x0,_0x1c39cd[_0x41452b]['from_bin']=0x0,_0x1c39cd[_0x41452b]['from_types']=_0x766793(0xda),_0x1c39cd[_0x41452b][_0x766793(0x103)]=_0x26d3c2;}else{if(_0x1f9b5d==_0x766793(0xa3)&&_0x41452b==_0x28f325){var _0x26d3c2=_0x29e4e8[_0x766793(0xea)](0x3);_0x1c39cd[_0x41452b][_0x766793(0x15c)]=_0x29e4e8[0x0],_0x1c39cd[_0x41452b][_0x766793(0x110)]=_0x29e4e8[0x1],_0x1c39cd[_0x41452b][_0x766793(0x105)]=0x0,_0x1c39cd[_0x41452b][_0x766793(0x11f)]=0x0,_0x1c39cd[_0x41452b][_0x766793(0xbe)]=_0x766793(0xda),_0x1c39cd[_0x41452b][_0x766793(0x103)]=_0x29e4e8[0x5];}else{if(_0x41452b==_0x28f325){if(_0x29e4e8[0x0]=='A'&&_0x29e4e8[0x1]=='L'&&_0x29e4e8[0x2]=='L')console['log'](_0x1f9b5d+_0x766793(0x95)+_0x41452b+'\x20<>\x20'+_0x28f325+_0x766793(0x95)+_0x29e4e8+_0x766793(0x14d)),_0x1c39cd[_0x41452b][_0x766793(0x15c)]=_0x29e4e8[0x0],_0x1c39cd[_0x41452b][_0x766793(0x110)]=_0x29e4e8[0x1],_0x1c39cd[_0x41452b]['from_bay']=0x0,_0x1c39cd[_0x41452b][_0x766793(0x11f)]=0x0,_0x1c39cd[_0x41452b][_0x766793(0xbe)]=_0x766793(0xda),_0x1c39cd[_0x41452b][_0x766793(0x103)]=_0x29e4e8[0x3];else{var _0xe66c4a;if(_0x29e4e8[0x4]=='L')_0xe66c4a=_0x766793(0x13d);else _0x29e4e8[0x4]=='F'&&(_0xe66c4a='Floor');_0x1c39cd[_0x41452b]['from_storage']=_0x29e4e8[0x0],_0x1c39cd[_0x41452b][_0x766793(0x110)]=_0x29e4e8[0x1],_0x1c39cd[_0x41452b][_0x766793(0x105)]=_0x29e4e8[0x2],_0x1c39cd[_0x41452b]['from_bin']=_0x29e4e8[0x3],_0x1c39cd[_0x41452b][_0x766793(0xbe)]=_0xe66c4a,_0x1c39cd[_0x41452b][_0x766793(0x103)]=_0x29e4e8[0x5];}}}}});}),_0x1db60c['forEach']((_0x1fe441,_0x51a1bd)=>{var _0x263db3=_0x517d28;_0x1c39cd[_0x51a1bd][_0x263db3(0x17c)]=_0x1fe441;}),_0x2f8a97[_0x517d28(0x163)]((_0x1498d2,_0x3a03a0)=>{var _0x39ae52=_0x517d28;_0x2f12d3[_0x39ae52(0x163)]((_0x2721d4,_0x533657)=>{var _0x4b145c=_0x39ae52;if(_0x2721d4==_0x4b145c(0x11c)&&_0x3a03a0==_0x533657){var _0x4198b7=_0x1498d2[_0x4b145c(0xea)](0x3);_0x1c39cd[_0x3a03a0]['storage']=_0x1498d2[0x0],_0x1c39cd[_0x3a03a0][_0x4b145c(0xa6)]=_0x1498d2[0x1],_0x1c39cd[_0x3a03a0][_0x4b145c(0x141)]=0x0,_0x1c39cd[_0x3a03a0]['to_bin']=0x0,_0x1c39cd[_0x3a03a0][_0x4b145c(0x170)]=_0x4b145c(0xda),_0x1c39cd[_0x3a03a0][_0x4b145c(0xd9)]=_0x4198b7;}else{if(_0x2721d4==_0x4b145c(0xa3)&&_0x3a03a0==_0x533657){var _0x4198b7=_0x1498d2[_0x4b145c(0xea)](0x3);_0x1c39cd[_0x3a03a0][_0x4b145c(0xff)]=_0x1498d2[0x0],_0x1c39cd[_0x3a03a0][_0x4b145c(0xa6)]=_0x1498d2[0x1],_0x1c39cd[_0x3a03a0][_0x4b145c(0x141)]=0x0,_0x1c39cd[_0x3a03a0][_0x4b145c(0x152)]=0x0,_0x1c39cd[_0x3a03a0]['to_types']=_0x4b145c(0xda),_0x1c39cd[_0x3a03a0]['to_floorlevel']=_0x1498d2[0x5];}else{if(_0x3a03a0==_0x533657){if(_0x1498d2[0x0]=='A'&&_0x1498d2[0x1]=='L'&&_0x1498d2[0x2]=='L')console[_0x4b145c(0x164)](_0x2721d4+_0x4b145c(0x95)+_0x3a03a0+'\x20<>\x20'+_0x533657+'\x20<>\x20'+_0x1498d2+_0x4b145c(0x14d)),_0x1c39cd[_0x3a03a0][_0x4b145c(0xff)]=_0x1498d2[0x0],_0x1c39cd[_0x3a03a0][_0x4b145c(0xa6)]=_0x1498d2[0x1],_0x1c39cd[_0x3a03a0][_0x4b145c(0x141)]=0x0,_0x1c39cd[_0x3a03a0][_0x4b145c(0x152)]=0x0,_0x1c39cd[_0x3a03a0][_0x4b145c(0x170)]='Floor',_0x1c39cd[_0x3a03a0][_0x4b145c(0xd9)]=_0x1498d2[0x3];else{var _0x1c9e1c;if(_0x1498d2[0x4]=='L')_0x1c9e1c=_0x4b145c(0x13d);else _0x1498d2[0x4]=='F'&&(_0x1c9e1c=_0x4b145c(0xda));_0x1c39cd[_0x3a03a0][_0x4b145c(0xff)]=_0x1498d2[0x0],_0x1c39cd[_0x3a03a0][_0x4b145c(0xa6)]=_0x1498d2[0x1],_0x1c39cd[_0x3a03a0]['to_bay']=_0x1498d2[0x2],_0x1c39cd[_0x3a03a0][_0x4b145c(0x152)]=_0x1498d2[0x3],_0x1c39cd[_0x3a03a0][_0x4b145c(0x170)]=_0x1c9e1c,_0x1c39cd[_0x3a03a0][_0x4b145c(0xd9)]=_0x1498d2[0x5];}}}}});}),_0x4801c7[_0x517d28(0x163)]((_0x3cf1f7,_0x2ccc51)=>{var _0x3420ef=_0x517d28;_0x1c39cd[_0x2ccc51][_0x3420ef(0xca)]=_0x3cf1f7;}),_0x28d334[_0x517d28(0x163)]((_0x28f52a,_0x3a3321)=>{var _0x120c9e=_0x517d28;_0x1c39cd[_0x3a3321][_0x120c9e(0x8f)]=_0x28f52a;}),_0x20f986[_0x517d28(0x163)]((_0xa6169d,_0x1c2ef2)=>{var _0x40746f=_0x517d28;_0x1c39cd[_0x1c2ef2][_0x40746f(0x147)]=_0xa6169d;}),_0x3c6349[_0x517d28(0x163)]((_0x2ff91d,_0x318249)=>{var _0x3afbbf=_0x517d28;_0x1c39cd[_0x318249][_0x3afbbf(0xf4)]=_0x2ff91d;}),_0x5bb844[_0x517d28(0x163)]((_0x491147,_0x4876ec)=>{var _0x1011a0=_0x517d28;_0x1c39cd[_0x4876ec][_0x1011a0(0xc9)]=_0x491147;}),_0x2d31bf[_0x517d28(0x163)]((_0x3481fe,_0x519207)=>{var _0x762ef8=_0x517d28;_0x1c39cd[_0x519207][_0x762ef8(0x14e)]=_0x3481fe;}),_0x5cc7da[_0x517d28(0x163)]((_0x13dc35,_0x5b42ca)=>{var _0x5e57b2=_0x517d28;_0x1c39cd[_0x5b42ca][_0x5e57b2(0xc7)]=_0x13dc35;}),_0x5da8ad[_0x517d28(0x163)]((_0xd33267,_0x5bf288)=>{var _0x586a11=_0x517d28;_0x1c39cd[_0x5bf288][_0x586a11(0x9d)]=_0xd33267;}),_0x16c794['forEach']((_0x1038d3,_0x2199f9)=>{var _0x1b4c24=_0x517d28;_0x1c39cd[_0x2199f9][_0x1b4c24(0x12f)]=_0x1038d3;}),_0x44f27c[_0x517d28(0x163)]((_0x10a8fa,_0x102dc4)=>{var _0x58d689=_0x517d28;_0x1c39cd[_0x102dc4][_0x58d689(0x127)]=_0x10a8fa;}),_0x1ac534[_0x517d28(0x163)]((_0x29c7c6,_0x4c77a3)=>{var _0x14ccdc=_0x517d28;_0x1c39cd[_0x4c77a3][_0x14ccdc(0xdb)]=_0x29c7c6;}),_0x47df2a['forEach']((_0x450f53,_0x258d1f)=>{var _0x216099=_0x517d28;_0x1c39cd[_0x258d1f][_0x216099(0xd0)]=_0x450f53;}),_0x2f12d3['forEach']((_0x2db8c4,_0x41252a)=>{var _0x4301dd=_0x517d28;_0x1c39cd[_0x41252a][_0x4301dd(0x16b)]=_0x2db8c4;});const _0x190428=_0x1c39cd[_0x517d28(0xbd)](_0x52845f=>_0x52845f[_0x517d28(0x17c)]!=='0'&&_0x52845f[_0x517d28(0x17c)]!==''||_0x52845f[_0x517d28(0xd9)]!=='0'&&_0x52845f[_0x517d28(0xd9)]!==''),_0x8d46f8=new transfers({'date':_0xf93b1,'from_warehouse':_0x55ce3b,'to_warehouse':_0x22b975,'product':_0x190428,'note':_0x36e93a,'invoice':_0x44a134}),_0x1a5d82=await _0x8d46f8[_0x517d28(0x125)]();_0x3037b1[_0x517d28(0xe9)](_0x517d28(0x123),_0x517d28(0xa9)),_0x98e51['redirect'](_0x517d28(0x12a)+_0x1a5d82[_0x517d28(0x12b)]);}catch(_0x38a2fc){console[_0x517d28(0x164)](_0x38a2fc),_0x98e51[_0x517d28(0x175)](0xc8)[_0x517d28(0x122)]({'errorMessage':_0x38a2fc['message']});}}),router[a0_0x7a021a(0xc6)](a0_0x7a021a(0xe2),auth,async(_0x534d1c,_0x33dd0b)=>{var _0x520fb5=a0_0x7a021a;try{const {username:_0x10e5c5,email:_0x573a9a,role:_0x114eaf}=_0x534d1c['user'],_0x4e0f55=_0x534d1c['user'],_0x57b377=await profile[_0x520fb5(0xb1)]({'email':_0x4e0f55[_0x520fb5(0xdc)]}),_0x58ed78=await master_shop[_0x520fb5(0x14c)]();console[_0x520fb5(0x164)]('master',_0x58ed78);const _0x1f36f9=await transfers[_0x520fb5(0xe5)](_0x534d1c[_0x520fb5(0xee)]['id']);let _0x4bf2ca=new Date(_0x1f36f9[_0x520fb5(0x9d)]),_0x3a926d=('0'+_0x4bf2ca[_0x520fb5(0x133)]())[_0x520fb5(0xea)](-0x2),_0x42b6eb=('0'+(_0x4bf2ca[_0x520fb5(0x108)]()+0x1))[_0x520fb5(0xea)](-0x2),_0x168df4=_0x4bf2ca[_0x520fb5(0xd6)](),_0x206d77=_0x168df4+'-'+_0x42b6eb+'-'+_0x3a926d,_0x54899d;if(_0x4e0f55[_0x520fb5(0x130)]==_0x520fb5(0x161)){const _0x5c5781=await staff[_0x520fb5(0xb1)]({'email':_0x4e0f55['email']});_0x54899d=await warehouse[_0x520fb5(0x14c)]({'status':_0x520fb5(0x100),'name':_0x5c5781[_0x520fb5(0x168)],'warehouse_category':_0x520fb5(0x96)});}else _0x54899d=await warehouse[_0x520fb5(0x14c)]({'status':_0x520fb5(0x100),'warehouse_category':_0x520fb5(0x96)});const _0x140447=await warehouse[_0x520fb5(0xb2)]([{'$match':{'name':_0x1f36f9[_0x520fb5(0xd3)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x520fb5(0x16f),'name':{'$first':_0x520fb5(0x13b)},'product_stock':{'$first':_0x520fb5(0xaf)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x520fb5(0xce)},'type':{'$first':_0x520fb5(0xc1)},'floorlevel':{'$first':_0x520fb5(0x17e)},'primary_code':{'$first':_0x520fb5(0xc4)},'secondary_code':{'$first':_0x520fb5(0x10c)},'product_code':{'$first':_0x520fb5(0x94)},'storage':{'$first':_0x520fb5(0xa5)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x520fb5(0x172)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x520fb5(0xbf)}}}]);if(_0x58ed78[0x0]['language']==_0x520fb5(0xfc)){var _0x4f0501=users[_0x520fb5(0xb8)];console[_0x520fb5(0x164)](_0x4f0501);}else{if(_0x58ed78[0x0]['language']==_0x520fb5(0x134))var _0x4f0501=users['Hindi'];else{if(_0x58ed78[0x0][_0x520fb5(0x9e)]==_0x520fb5(0xc0))var _0x4f0501=users[_0x520fb5(0xc0)];else{if(_0x58ed78[0x0]['language']==_0x520fb5(0x9a))var _0x4f0501=users[_0x520fb5(0x9a)];else{if(_0x58ed78[0x0][_0x520fb5(0x9e)]==_0x520fb5(0x115))var _0x4f0501=users[_0x520fb5(0x115)];else{if(_0x58ed78[0x0]['language']==_0x520fb5(0xba))var _0x4f0501=users[_0x520fb5(0xb3)];else{if(_0x58ed78[0x0][_0x520fb5(0x9e)]=='Chinese')var _0x4f0501=users[_0x520fb5(0xed)];else{if(_0x58ed78[0x0][_0x520fb5(0x9e)]==_0x520fb5(0x9b))var _0x4f0501=users[_0x520fb5(0x144)];}}}}}}}_0x33dd0b[_0x520fb5(0xc8)](_0x520fb5(0xd1),{'success':_0x534d1c['flash'](_0x520fb5(0x123)),'errors':_0x534d1c[_0x520fb5(0xe9)]('errors'),'role':_0x4e0f55,'profile':_0x57b377,'master_shop':_0x58ed78,'warehouse':_0x54899d,'transfer':_0x1f36f9,'stock':_0x140447,'language':_0x4f0501});}catch(_0x5e75a0){console['log'](_0x5e75a0);}}),router[a0_0x7a021a(0x107)](a0_0x7a021a(0xe2),auth,async(_0x4107df,_0x479f3d)=>{var _0x277c16=a0_0x7a021a;try{const _0x37d29b=_0x4107df[_0x277c16(0xee)]['id'],{from_warehouse:_0x2d0aac,FromRoom_name:_0x5d51bf,to_warehouse:_0x3d13a7,ToRoom_name:_0x314e04}=_0x4107df[_0x277c16(0x104)],_0x479e37=await transfers[_0x277c16(0xe5)]({'_id':_0x37d29b}),_0x5da940=_0x479e37['product']['map'](async _0x16d0d2=>{var _0x1011dd=_0x277c16;if(_0x16d0d2['to_quantity']>0x0){var _0x19b3f0=await warehouse['findOne']({'name':_0x479e37[_0x1011dd(0xd3)],'room':_0x16d0d2[_0x1011dd(0xd0)],'warehouse_category':'Raw\x20Materials'});const _0x304bb=_0x19b3f0[_0x1011dd(0x143)][_0x1011dd(0xa4)](_0x55be33=>{var _0x3efc1a=_0x1011dd;_0x55be33[_0x3efc1a(0x17a)]==_0x16d0d2['product_name']&&_0x55be33[_0x3efc1a(0x136)]==_0x16d0d2[_0x3efc1a(0x103)]&&_0x55be33[_0x3efc1a(0xd2)]==_0x16d0d2[_0x3efc1a(0xbe)]&&_0x55be33[_0x3efc1a(0x112)]==_0x16d0d2[_0x3efc1a(0x11f)]&&_0x55be33[_0x3efc1a(0xc3)]==_0x16d0d2[_0x3efc1a(0x105)]&&_0x55be33[_0x3efc1a(0xa6)]==_0x16d0d2['from_rack']&&_0x55be33['storage']==_0x16d0d2['from_storage']&&_0x55be33[_0x3efc1a(0x9d)]==_0x16d0d2[_0x3efc1a(0x9d)]&&_0x55be33[_0x3efc1a(0xc7)]==_0x16d0d2['batch_code']&&_0x55be33[_0x3efc1a(0x127)]==_0x16d0d2[_0x3efc1a(0x127)]&&_0x55be33[_0x3efc1a(0xcd)]==_0x16d0d2[_0x3efc1a(0x160)]&&_0x55be33[_0x3efc1a(0x12b)]==_0x16d0d2[_0x3efc1a(0x118)]&&(_0x55be33[_0x3efc1a(0xb7)]=_0x55be33[_0x3efc1a(0xb7)]-_0x16d0d2[_0x3efc1a(0x17c)]);});}return _0x19b3f0;});Promise['all'](_0x5da940)['then'](async _0x260569=>{var _0x519857=_0x277c16;try{for(const _0x27eb5e of _0x260569){await _0x27eb5e['save']();}try{const _0x4618e8=_0x479e37[_0x519857(0x92)][_0x519857(0xa4)](async _0x4014d9=>{var _0x3fe2e1=_0x519857;if(_0x4014d9['to_quantity']>0x0){var _0xd5e0d8=await warehouse[_0x3fe2e1(0xb1)]({'name':_0x479e37[_0x3fe2e1(0xe7)],'room':_0x4014d9[_0x3fe2e1(0x16b)],'warehouse_category':_0x3fe2e1(0x96)}),_0x2cd1d4=0x0;const _0x47c59b=_0xd5e0d8[_0x3fe2e1(0x143)][_0x3fe2e1(0xa4)](_0x2781c4=>{var _0x554ed7=_0x3fe2e1;_0x2781c4[_0x554ed7(0x17a)]==_0x4014d9[_0x554ed7(0x17a)]&&_0x2781c4[_0x554ed7(0x136)]==_0x4014d9[_0x554ed7(0xd9)]&&_0x2781c4[_0x554ed7(0xd2)]==_0x4014d9[_0x554ed7(0x170)]&&_0x2781c4[_0x554ed7(0x112)]==_0x4014d9[_0x554ed7(0x152)]&&_0x2781c4[_0x554ed7(0xc3)]==_0x4014d9[_0x554ed7(0x141)]&&_0x2781c4[_0x554ed7(0xa6)]==_0x4014d9[_0x554ed7(0xa6)]&&_0x2781c4['storage']==_0x4014d9['storage']&&_0x2781c4[_0x554ed7(0x9d)]==_0x4014d9['expiry_date']&&_0x2781c4[_0x554ed7(0xc7)]==_0x4014d9[_0x554ed7(0xc7)]&&_0x2781c4['production_date']==_0x4014d9[_0x554ed7(0x127)]&&_0x2781c4[_0x554ed7(0xcd)]==_0x4014d9[_0x554ed7(0xac)]&&(_0x2781c4['product_stock']=_0x2781c4[_0x554ed7(0xb7)]+_0x4014d9[_0x554ed7(0x17c)],_0x2cd1d4++);});_0x2cd1d4=='0'&&(_0xd5e0d8['product_details']=_0xd5e0d8[_0x3fe2e1(0x143)]['concat']({'product_name':_0x4014d9['product_name'],'product_stock':_0x4014d9[_0x3fe2e1(0x17c)],'bay':_0x4014d9['to_bay'],'bin':_0x4014d9[_0x3fe2e1(0x152)],'type':_0x4014d9[_0x3fe2e1(0x170)],'floorlevel':_0x4014d9[_0x3fe2e1(0xd9)],'storage':_0x4014d9[_0x3fe2e1(0xff)],'rack':_0x4014d9[_0x3fe2e1(0xa6)],'product_code':_0x4014d9[_0x3fe2e1(0x147)],'primary_code':_0x4014d9['primary_code'],'secondary_code':_0x4014d9[_0x3fe2e1(0x8f)],'maxProducts':_0x4014d9[_0x3fe2e1(0xf4)],'storage':_0x4014d9[_0x3fe2e1(0xff)],'rack':_0x4014d9['rack'],'expiry_date':_0x4014d9['expiry_date'],'maxPerUnit':_0x4014d9[_0x3fe2e1(0x12f)],'batch_code':_0x4014d9[_0x3fe2e1(0xc7)],'production_date':_0x4014d9['production_date']}));}return _0xd5e0d8;});Promise[_0x519857(0x120)](_0x4618e8)[_0x519857(0x128)](async _0xfcaabd=>{var _0x2b06f4=_0x519857;try{for(const _0x53c09e of _0xfcaabd){await warehouse['updateOne']({'_id':_0x53c09e[_0x2b06f4(0x12b)]},{'$addToSet':{'product_details':{'$each':_0x53c09e[_0x2b06f4(0x143)]}}});}_0x479e37[_0x2b06f4(0x178)]=_0x2b06f4(0xb0);const _0x3fa8f4=await _0x479e37[_0x2b06f4(0x125)](),_0x1f5447=await master_shop[_0x2b06f4(0x14c)](),_0x1fc67d=await email_settings[_0x2b06f4(0xb1)](),_0x1b5b97=await supervisor_settings[_0x2b06f4(0x14c)]();var _0x36574c=_0x479e37['product'],_0x4f6f04='',_0x3c904d;for(_0x3c904d in _0x36574c){_0x4f6f04+=_0x2b06f4(0x93)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x36574c[_0x3c904d][_0x2b06f4(0x17a)]+_0x2b06f4(0x158)+_0x2b06f4(0x91)+_0x36574c[_0x3c904d]['product_code']+_0x2b06f4(0x158)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x36574c[_0x3c904d][_0x2b06f4(0x17c)]+'</td>'+_0x2b06f4(0x91)+_0x36574c[_0x3c904d][_0x2b06f4(0xc9)]+_0x2b06f4(0x158)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x36574c[_0x3c904d][_0x2b06f4(0x14e)]+_0x2b06f4(0x158)+_0x2b06f4(0x91)+_0x479e37[_0x2b06f4(0xe7)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x36574c[_0x3c904d]['to_room_name']+_0x2b06f4(0x158)+_0x2b06f4(0x91)+_0x36574c[_0x3c904d]['storage']+_0x36574c[_0x3c904d][_0x2b06f4(0xa6)]+_0x36574c[_0x3c904d][_0x2b06f4(0x141)]+_0x36574c[_0x3c904d]['to_bin']+_0x36574c[_0x3c904d][_0x2b06f4(0x170)][0x0]+_0x36574c[_0x3c904d][_0x2b06f4(0xd9)]+_0x2b06f4(0x158),_0x2b06f4(0xcf);}let _0x4da524=nodemailer[_0x2b06f4(0x13f)]({'host':_0x1fc67d[_0x2b06f4(0xbc)],'port':Number(_0x1fc67d[_0x2b06f4(0x119)]),'secure':![],'auth':{'user':_0x1fc67d['email'],'pass':_0x1fc67d[_0x2b06f4(0xe0)]}}),_0x1b6b12={'from':_0x1fc67d['email'],'to':_0x1b5b97[0x0][_0x2b06f4(0xe3)],'subject':_0x2b06f4(0x114),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2b06f4(0x116)+_0x2b06f4(0x15e)+_0x1f5447[0x0][_0x2b06f4(0x98)],'cid':_0x2b06f4(0x129)}],'html':_0x2b06f4(0x13c)+_0x2b06f4(0xfa)+_0x2b06f4(0x113)+_0x2b06f4(0xbb)+_0x2b06f4(0x165)+_0x2b06f4(0xbb)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2b06f4(0x142)+_0x2b06f4(0xbb)+'<h2>\x20'+_0x1f5447[0x0][_0x2b06f4(0xb5)]+_0x2b06f4(0x137)+'</div>'+_0x2b06f4(0x142)+_0x2b06f4(0xd4)+_0x2b06f4(0xbb)+_0x2b06f4(0xb9)+'\x20Order\x20Number\x20:\x20'+_0x479e37['invoice']+'\x20'+_0x2b06f4(0x17d)+'\x20Order\x20Date\x20:\x20'+_0x479e37[_0x2b06f4(0x15f)]+'\x20'+'</span>'+_0x2b06f4(0xa7)+_0x2b06f4(0x142)+_0x2b06f4(0x16a)+_0x2b06f4(0x126)+_0x2b06f4(0x93)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2b06f4(0xa1)+_0x2b06f4(0x146)+_0x2b06f4(0xd8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x2b06f4(0x11d)+_0x2b06f4(0x124)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x2b06f4(0xcf)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4f6f04+'\x20'+_0x2b06f4(0x13a)+_0x2b06f4(0x16c)+_0x2b06f4(0xbb)+_0x2b06f4(0x10b)+_0x2b06f4(0xc2)+_0x1f5447[0x0][_0x2b06f4(0xb5)]+_0x2b06f4(0xa7)+_0x2b06f4(0x142)+'</div>'+_0x2b06f4(0xad)};_0x4da524['sendMail'](_0x1b6b12,function(_0x1b903a,_0x44d9fe){var _0x22379c=_0x2b06f4;_0x1b903a?(console[_0x22379c(0x164)](_0x1b903a),console['log']('Error\x20Occurs')):console['log'](_0x22379c(0x17b));}),_0x4107df['flash'](_0x2b06f4(0x123),_0x2b06f4(0xe6)),_0x479f3d[_0x2b06f4(0x174)]('/picking_list/PDF_transfer_rm/'+_0x3fa8f4[_0x2b06f4(0x12b)]);}catch(_0x3c0d0a){console[_0x2b06f4(0x90)](_0x3c0d0a),_0x479f3d[_0x2b06f4(0x175)](0x1f4)[_0x2b06f4(0x122)]({'Perror':_0x2b06f4(0x166),'message':_0x3c0d0a[_0x2b06f4(0xf7)]});}})[_0x519857(0x99)](_0x3b0712=>{var _0x4e14fa=_0x519857;console[_0x4e14fa(0x90)](_0x3b0712),_0x479f3d[_0x4e14fa(0x175)](0x1f4)[_0x4e14fa(0x122)]({'Perror':_0x4e14fa(0x10e)});});}catch(_0x4b668a){_0x479f3d[_0x519857(0x122)](_0x4b668a);}}catch(_0x1b9e96){console[_0x519857(0x90)](_0x1b9e96),_0x479f3d['status'](0x1f4)[_0x519857(0x122)]({'Merror':_0x519857(0x166),'Message':_0x1b9e96['message']});}})[_0x277c16(0x99)](_0x489d46=>{var _0x23056f=_0x277c16;console['error'](_0x489d46),_0x479f3d[_0x23056f(0x175)](0x1f4)[_0x23056f(0x122)]({'Merror':_0x23056f(0x10e)});});}catch(_0x42f676){console['log'](_0x42f676);}});function BayBinSelected(_0xb9e84f,_0x254e46){var _0x543622=a0_0x7a021a,_0xb4efe2=[],_0x3d9560=[],_0x5680ec=[],_0x4de4a3=[],_0x4f3e22=[],_0x54d95d=[];let _0x54c12d=[];if(_0xb9e84f=='DRY\x20STORAGE')switch(_0x254e46){case _0x543622(0x121):_0xb4efe2=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x3d9560=[0x1,0x2],_0x4de4a3=[0x1,0x2,0x3,0x4,0x5],_0x5680ec=[_0x543622(0x13d),_0x543622(0xda)],_0x4f3e22=['D'],_0x54d95d=['A'];break;case _0x543622(0x132):_0xb4efe2=[0x6,0x5,0x4,0x3,0x2,0x1],_0x3d9560=[0x1,0x2],_0x4de4a3=[0x1,0x2,0x3,0x4,0x5],_0x5680ec=[_0x543622(0x13d),_0x543622(0xda)],_0x4f3e22=['D'],_0x54d95d=['B'];break;case _0x543622(0xa3):_0xb4efe2=[0x0],_0x3d9560=[0x0],_0x4de4a3=[0x1,0x2,0x3,0x4,0x5],_0x5680ec=[_0x543622(0xda)],_0x4f3e22=['D'],_0x54d95d=['S'];break;case'Receiving\x20Area':_0xb4efe2=[0x0],_0x3d9560=[0x0],_0x4de4a3=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5680ec=['Floor'],_0x4f3e22=['D'],_0x54d95d=['R'];break;}else{if(_0xb9e84f=='COLD\x20STORAGE')switch(_0x254e46){case'Rack\x20A':_0xb4efe2=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x3d9560=['B','F'],_0x4de4a3=[0x1,0x2,0x3,0x4,0x5],_0x5680ec=['Level',_0x543622(0xda)],_0x4f3e22=['C'],_0x54d95d=['A'];break;case _0x543622(0x132):_0xb4efe2=[0x5,0x4,0x3,0x2,0x1],_0x3d9560=['F','B','S'],_0x4de4a3=[0x1,0x2,0x3,0x4,0x5],_0x5680ec=[_0x543622(0x13d),_0x543622(0xda)],_0x4f3e22=['C'],_0x54d95d=['B'];break;case'Rack\x20C':_0xb4efe2=[0x1,0x2,0x3,0x4,0x5],_0x3d9560=['B','F','S'],_0x4de4a3=[0x5,0x4,0x3,0x2,0x1],_0x5680ec=[_0x543622(0x13d),_0x543622(0xda)],_0x4f3e22=['C'],_0x54d95d=['C'];break;case _0x543622(0x15a):_0xb4efe2=[0x5,0x4,0x3,0x2,0x1],_0x3d9560=['F','B','S'],_0x4de4a3=[0x1,0x2,0x3,0x4,0x5],_0x5680ec=['Level','Floor'],_0x4f3e22=['C'],_0x54d95d=['D'];break;case'Rack\x20E':_0xb4efe2=[0x4,0x3,0x2,0x1],_0x3d9560=[0x1,0x2],_0x4de4a3=[0x1,0x2,0x3,0x4,0x5],_0x5680ec=[_0x543622(0x13d),'Floor'],_0x4f3e22=['C'],_0x54d95d=['E'];break;case _0x543622(0xf1):_0xb4efe2=[0x1,0x2,0x3],_0x3d9560=[0x1,0x2],_0x4de4a3=[0x1,0x2,0x3,0x4,0x5],_0x5680ec=['Level'],_0x4f3e22=['C'],_0x54d95d=['F'];break;}}return{'levels':_0xb4efe2,'Isle':_0x3d9560,'rack':_0x4de4a3,'type':_0x5680ec,'storage':_0x4f3e22,'rak':_0x54d95d};}router['get'](a0_0x7a021a(0x159),auth,async(_0x58b05d,_0xca7524)=>{var _0xde4ce9=a0_0x7a021a;try{const {username:_0x1af4b2,email:_0x204d6c,role:_0x3eccb2}=_0x58b05d['user'],_0x41ac74=_0x58b05d['user'],_0x2b97c4=await profile[_0xde4ce9(0xb1)]({'email':_0x41ac74[_0xde4ce9(0xdc)]}),_0xa019ba=await master_shop[_0xde4ce9(0x14c)](),_0xf6ea9f=await transfers[_0xde4ce9(0xe5)](_0x58b05d[_0xde4ce9(0xee)]['id']);let _0x36cebf;if(_0x41ac74['role']==_0xde4ce9(0x161)){const _0x5780e4=await staff[_0xde4ce9(0xb1)]({'email':_0x41ac74[_0xde4ce9(0xdc)]});_0x36cebf=await warehouse[_0xde4ce9(0xb2)]([{'$match':{'status':_0xde4ce9(0x100),'name':_0x5780e4[_0xde4ce9(0x168)],'warehouse_category':_0xde4ce9(0x96)}},{'$group':{'_id':_0xde4ce9(0x9c),'name':{'$first':_0xde4ce9(0x9c)}}}]);}else _0x36cebf=await warehouse[_0xde4ce9(0xb2)]([{'$match':{'status':_0xde4ce9(0x100),'warehouse_category':_0xde4ce9(0x96)}},{'$group':{'_id':_0xde4ce9(0x9c),'name':{'$first':_0xde4ce9(0x9c)}}}]);const _0x5675b6=await warehouse[_0xde4ce9(0xb2)]([{'$match':{'name':_0xf6ea9f[_0xde4ce9(0xd3)],'warehouse_category':_0xde4ce9(0x96)}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xde4ce9(0xaf)},'bay':{'$first':_0xde4ce9(0x176)},'bin':{'$first':_0xde4ce9(0xce)},'type':{'$first':_0xde4ce9(0xc1)},'floorlevel':{'$first':_0xde4ce9(0x17e)},'primary_code':{'$first':_0xde4ce9(0xc4)},'secondary_code':{'$first':_0xde4ce9(0x10c)},'product_code':{'$first':_0xde4ce9(0x94)},'storage':{'$first':_0xde4ce9(0xa5)},'rack':{'$first':_0xde4ce9(0xf5)},'expiry_date':{'$first':_0xde4ce9(0x172)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0xde4ce9(0xbf)}}}]),_0x212cb7=await product[_0xde4ce9(0x14c)]({}),_0x3be4da=BayBinSelected(_0xf6ea9f[_0xde4ce9(0xe7)],_0xf6ea9f[_0xde4ce9(0x10a)]);if(_0xa019ba[0x0][_0xde4ce9(0x9e)]==_0xde4ce9(0xfc)){var _0x56f301=users['English'];console[_0xde4ce9(0x164)](_0x56f301);}else{if(_0xa019ba[0x0][_0xde4ce9(0x9e)]==_0xde4ce9(0x134))var _0x56f301=users[_0xde4ce9(0x134)];else{if(_0xa019ba[0x0][_0xde4ce9(0x9e)]=='German')var _0x56f301=users['German'];else{if(_0xa019ba[0x0][_0xde4ce9(0x9e)]=='Spanish')var _0x56f301=users['Spanish'];else{if(_0xa019ba[0x0][_0xde4ce9(0x9e)]==_0xde4ce9(0x115))var _0x56f301=users[_0xde4ce9(0x115)];else{if(_0xa019ba[0x0][_0xde4ce9(0x9e)]==_0xde4ce9(0xba))var _0x56f301=users[_0xde4ce9(0xb3)];else{if(_0xa019ba[0x0][_0xde4ce9(0x9e)]==_0xde4ce9(0xed))var _0x56f301=users[_0xde4ce9(0xed)];else{if(_0xa019ba[0x0]['language']==_0xde4ce9(0x9b))var _0x56f301=users[_0xde4ce9(0x144)];}}}}}}}_0xca7524['render']('edit_transfer',{'success':_0x58b05d[_0xde4ce9(0xe9)](_0xde4ce9(0x123)),'errors':_0x58b05d[_0xde4ce9(0xe9)](_0xde4ce9(0xdd)),'role':_0x41ac74,'profile':_0x2b97c4,'master_shop':_0xa019ba,'warehouse':_0x36cebf,'transfer':_0xf6ea9f,'stock':_0x5675b6,'unit':_0x212cb7,'language':_0x56f301});}catch(_0x3ac8d8){console[_0xde4ce9(0x164)](_0x3ac8d8);}}),router['post']('/view/:id',auth,async(_0x1f0e91,_0x2b006a)=>{var _0x432d86=a0_0x7a021a;try{const _0x20dc37=_0x1f0e91['params']['id'],_0x4813f6=await transfers[_0x432d86(0xe5)](_0x20dc37);_0x2b006a[_0x432d86(0x122)](_0x1f0e91[_0x432d86(0x104)]);return;const {date:_0x468231,from_warehouse:_0x4a9ea2,FromRoom_name:_0x20fcef,to_warehouse:_0x146675,ToRoom_name:_0x2e07c8,prod_name:_0x5ced11,from_prod_qty:_0x423e7e,from_prod_level:_0x9b2280,from_prod_isle:_0x4c5c20,from_prod_pallet:_0x56875,to_prod_qty:_0x2c2a0d,to_prod_level:_0x339892,to_prod_isle:_0x5bdbdf,to_prod_pallet:_0x31c5a5,primary_code:_0x13d265,secondary_code:_0x42c323,product_code3:_0x41b55b,note:_0x53124f,invoice:_0x30c2e8,expiry_date:_0x465eb2}=_0x1f0e91[_0x432d86(0x104)];if(typeof _0x5ced11==_0x432d86(0x16d))var _0xd48b2=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0xf8)]],_0x5b24ef=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0xb4)]],_0xa6ebbb=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0x14b)]],_0x365a6f=[_0x1f0e91['body'][_0x432d86(0x14a)]],_0x33341e=[_0x1f0e91[_0x432d86(0x104)]['from_prod_pallet']],_0x5c41ad=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0xbe)]],_0x1ae8db=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0x117)]],_0x4745e8=[_0x1f0e91[_0x432d86(0x104)]['to_prod_level']],_0x1917f7=[_0x1f0e91[_0x432d86(0x104)]['to_prod_isle']],_0x310347=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0x154)]],_0x2b4141=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0x170)]],_0xa8adbd=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0xff)]],_0x5df1ff=[_0x1f0e91[_0x432d86(0x104)]['rak']],_0xceacd5=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0xca)]],_0x2a1ad1=[_0x1f0e91['body'][_0x432d86(0x8f)]],_0x4c53b9=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0x177)]],_0x3fd682=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0x13e)]],_0x39b527=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0xc9)]],_0x454a06=[_0x1f0e91['body']['secondary_unit']],_0x28c47d=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0xc7)]],_0x3ee737=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0x9d)]],_0x5b18f5=[_0x1f0e91[_0x432d86(0x104)][_0x432d86(0x15c)]],_0x5c313b=[_0x1f0e91[_0x432d86(0x104)]['from_rak']];else var _0xd48b2=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0xf8)]],_0xa8adbd=[..._0x1f0e91['body']['storage']],_0x5df1ff=[..._0x1f0e91[_0x432d86(0x104)]['rak']],_0x5c41ad=[..._0x1f0e91[_0x432d86(0x104)]['from_types']],_0x2b4141=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0x170)]],_0x5b24ef=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0xb4)]],_0xa6ebbb=[..._0x1f0e91['body']['from_prod_level']],_0x365a6f=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0x14a)]],_0x33341e=[..._0x1f0e91['body'][_0x432d86(0x111)]],_0x1ae8db=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0x117)]],_0x4745e8=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0x102)]],_0x1917f7=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0xef)]],_0x310347=[..._0x1f0e91['body'][_0x432d86(0x154)]],_0xceacd5=[..._0x1f0e91[_0x432d86(0x104)]['primary_code']],_0x2a1ad1=[..._0x1f0e91['body'][_0x432d86(0x8f)]],_0x4c53b9=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0x177)]],_0x3fd682=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0x13e)]],_0x39b527=[..._0x1f0e91[_0x432d86(0x104)][_0x432d86(0xc9)]],_0x454a06=[..._0x1f0e91[_0x432d86(0x104)]['secondary_unit']],_0x28c47d=[..._0x1f0e91['body'][_0x432d86(0xc7)]],_0x3ee737=[..._0x1f0e91[_0x432d86(0x104)]['expiry_date']],_0x5b18f5=[..._0x1f0e91['body'][_0x432d86(0x15c)]],_0x5c313b=[..._0x1f0e91['body'][_0x432d86(0x148)]];const _0x58bcef=_0xd48b2[_0x432d86(0xa4)](_0x33ecb8=>{return _0x33ecb8={'product_name':_0x33ecb8};});_0x5b24ef[_0x432d86(0x163)]((_0x51cf43,_0x1b53bf)=>{var _0x1a4c22=_0x432d86;_0x58bcef[_0x1b53bf][_0x1a4c22(0xa0)]=_0x51cf43;}),_0xa6ebbb[_0x432d86(0x163)]((_0x179574,_0x143bdf)=>{_0x58bcef[_0x143bdf]['from_bay']=_0x179574;}),_0x365a6f[_0x432d86(0x163)]((_0x5055c1,_0x52f685)=>{var _0x544dfe=_0x432d86;_0x58bcef[_0x52f685][_0x544dfe(0x11f)]=_0x5055c1;}),_0x33341e[_0x432d86(0x163)]((_0x18dacf,_0x405599)=>{var _0x5e2d43=_0x432d86;_0x58bcef[_0x405599][_0x5e2d43(0x103)]=_0x18dacf;}),_0x1ae8db[_0x432d86(0x163)]((_0x3c0d9d,_0x227ce4)=>{var _0x48c0eb=_0x432d86;_0x58bcef[_0x227ce4][_0x48c0eb(0x17c)]=_0x3c0d9d;}),_0x4745e8['forEach']((_0x3b261e,_0x587dee)=>{_0x58bcef[_0x587dee]['to_bay']=_0x3b261e;}),_0x1917f7[_0x432d86(0x163)]((_0x28f005,_0x57dd91)=>{var _0x3cd226=_0x432d86;_0x58bcef[_0x57dd91][_0x3cd226(0x152)]=_0x28f005;}),_0x310347[_0x432d86(0x163)]((_0x3dd25c,_0xe8789)=>{_0x58bcef[_0xe8789]['to_floorlevel']=_0x3dd25c;}),_0xceacd5[_0x432d86(0x163)]((_0x50ed8d,_0x296d30)=>{_0x58bcef[_0x296d30]['primary_code']=_0x50ed8d;}),_0x2a1ad1[_0x432d86(0x163)]((_0x13e9aa,_0x18baa9)=>{var _0x3a4210=_0x432d86;_0x58bcef[_0x18baa9][_0x3a4210(0x8f)]=_0x13e9aa;}),_0x4c53b9['forEach']((_0x2f3922,_0x34c136)=>{var _0x347422=_0x432d86;_0x58bcef[_0x34c136][_0x347422(0x147)]=_0x2f3922;}),_0x3fd682[_0x432d86(0x163)]((_0x48d9c0,_0x19d8c7)=>{_0x58bcef[_0x19d8c7]['maxProducts']=_0x48d9c0;}),_0x39b527[_0x432d86(0x163)]((_0x254ac6,_0x16036e)=>{var _0x5a90e6=_0x432d86;_0x58bcef[_0x16036e][_0x5a90e6(0xc9)]=_0x254ac6;}),_0x454a06[_0x432d86(0x163)]((_0x4da872,_0x52d442)=>{var _0x975cd2=_0x432d86;_0x58bcef[_0x52d442][_0x975cd2(0x14e)]=_0x4da872;}),_0x28c47d[_0x432d86(0x163)]((_0x262c29,_0x4a2bf8)=>{var _0x3c1893=_0x432d86;_0x58bcef[_0x4a2bf8][_0x3c1893(0xc7)]=_0x262c29;}),_0x3ee737[_0x432d86(0x163)]((_0x185a1c,_0x189395)=>{var _0x4a43f6=_0x432d86;_0x58bcef[_0x189395][_0x4a43f6(0x9d)]=_0x185a1c;}),_0xa8adbd['forEach']((_0x14277c,_0x5caeb6)=>{var _0x53e3e6=_0x432d86;_0x58bcef[_0x5caeb6][_0x53e3e6(0xff)]=_0x14277c;}),_0x5df1ff[_0x432d86(0x163)]((_0x404827,_0x3cd8d5)=>{var _0x1ab50c=_0x432d86;_0x58bcef[_0x3cd8d5][_0x1ab50c(0xa6)]=_0x404827;}),_0x5c41ad[_0x432d86(0x163)]((_0x1cc5d2,_0x1e701d)=>{_0x58bcef[_0x1e701d]['from_types']=_0x1cc5d2;}),_0x2b4141[_0x432d86(0x163)]((_0x3e74b9,_0x3b6f2a)=>{var _0x907719=_0x432d86;_0x58bcef[_0x3b6f2a][_0x907719(0x170)]=_0x3e74b9;}),_0x5b18f5[_0x432d86(0x163)]((_0x4bdaf5,_0xab7f94)=>{_0x58bcef[_0xab7f94]['from_storage']=_0x4bdaf5;}),_0x5c313b[_0x432d86(0x163)]((_0x130f5a,_0xf8fa75)=>{var _0x532c79=_0x432d86;_0x58bcef[_0xf8fa75][_0x532c79(0x110)]=_0x130f5a;});const _0x49266b=_0x58bcef[_0x432d86(0xbd)](_0x482771=>_0x482771[_0x432d86(0x17c)]!=='0'&&_0x482771[_0x432d86(0x17c)]!==''||_0x482771[_0x432d86(0xd9)]!=='0'&&_0x482771[_0x432d86(0xd9)]!=='');var _0x40c175=0x0;_0x49266b[_0x432d86(0x163)](_0x3b903a=>{var _0x13deb6=_0x432d86;parseInt(_0x3b903a['from_quantity'])<parseInt(_0x3b903a[_0x13deb6(0x17c)])&&_0x40c175++;});if(_0x40c175!=0x0)return _0x1f0e91[_0x432d86(0xe9)]('errors',_0x432d86(0x15d)),_0x2b006a[_0x432d86(0x174)]('back');const _0x2b0587=await warehouse[_0x432d86(0xb1)]({'name':_0x4813f6[_0x432d86(0xd3)],'room':_0x4813f6[_0x432d86(0x145)]});_0x4813f6['product'][_0x432d86(0x163)](_0x479b39=>{var _0x5b3560=_0x432d86;if(_0x479b39['to_quantity']>0x0){const _0x599cf0=_0x2b0587[_0x5b3560(0x143)][_0x5b3560(0xa4)](_0x1c5685=>{var _0x1fd4fd=_0x5b3560;_0x1c5685['product_name']==_0x479b39[_0x1fd4fd(0x17a)]&&_0x1c5685[_0x1fd4fd(0x136)]==_0x479b39['from_floorlevel']&&_0x1c5685[_0x1fd4fd(0xd2)]==_0x479b39[_0x1fd4fd(0xbe)]&&_0x1c5685['bin']==_0x479b39[_0x1fd4fd(0x11f)]&&_0x1c5685[_0x1fd4fd(0xc3)]==_0x479b39[_0x1fd4fd(0x105)]&&_0x1c5685['rack']==_0x479b39['from_rack']&&_0x1c5685['storage']==_0x479b39[_0x1fd4fd(0x15c)]&&(_0x1c5685[_0x1fd4fd(0xb7)]=parseInt(_0x1c5685[_0x1fd4fd(0xb7)])+parseInt(_0x479b39[_0x1fd4fd(0x17c)]));});}}),await _0x2b0587['save']();const _0x7da609=await warehouse[_0x432d86(0xb1)]({'name':_0x4813f6[_0x432d86(0xe7)],'room':_0x4813f6[_0x432d86(0x10a)]});_0x4813f6[_0x432d86(0x92)][_0x432d86(0x163)](_0x4e2196=>{var _0x53412f=_0x432d86;if(_0x4e2196['to_quantity']>0x0){const _0x316b4e=_0x7da609[_0x53412f(0x143)][_0x53412f(0xa4)](_0x391ef7=>{var _0x399124=_0x53412f;_0x391ef7[_0x399124(0x17a)]==_0x4e2196[_0x399124(0x17a)]&&_0x391ef7['floorlevel']==_0x4e2196[_0x399124(0xd9)]&&_0x391ef7[_0x399124(0xd2)]==_0x4e2196[_0x399124(0x170)]&&_0x391ef7[_0x399124(0x112)]==_0x4e2196[_0x399124(0x152)]&&_0x391ef7[_0x399124(0xc3)]==_0x4e2196[_0x399124(0x141)]&&_0x391ef7['rack']==_0x4e2196['rack']&&_0x391ef7[_0x399124(0xff)]==_0x4e2196[_0x399124(0xff)]&&(_0x391ef7[_0x399124(0xb7)]=parseInt(_0x391ef7[_0x399124(0xb7)])-parseInt(_0x4e2196[_0x399124(0x17c)]));});}}),await _0x7da609[_0x432d86(0x125)](),_0x4813f6['date']=_0x468231,_0x4813f6['from_warehouse']=_0x4a9ea2,_0x4813f6[_0x432d86(0xe7)]=_0x146675,_0x4813f6[_0x432d86(0x92)]=_0x49266b,_0x4813f6['note']=_0x53124f,_0x4813f6[_0x432d86(0xcd)]=_0x30c2e8;const _0x5beb0b=await _0x4813f6[_0x432d86(0x125)]();console[_0x432d86(0x164)](_0x5beb0b);const _0x1e4616=await warehouse['findOne']({'name':_0x4a9ea2,'room':_0x20fcef});_0x5beb0b[_0x432d86(0x92)][_0x432d86(0x163)](_0xf571e2=>{var _0x5f2a09=_0x432d86;if(_0xf571e2[_0x5f2a09(0x17c)]>0x0){const _0x1e8d38=_0x1e4616[_0x5f2a09(0x143)][_0x5f2a09(0xa4)](_0xabb2d3=>{var _0x3e5c77=_0x5f2a09;_0xabb2d3[_0x3e5c77(0x17a)]==_0xf571e2[_0x3e5c77(0x17a)]&&_0xabb2d3[_0x3e5c77(0x136)]==_0xf571e2['from_floorlevel']&&_0xabb2d3[_0x3e5c77(0xd2)]==_0xf571e2[_0x3e5c77(0xbe)]&&_0xabb2d3[_0x3e5c77(0x112)]==_0xf571e2[_0x3e5c77(0x11f)]&&_0xabb2d3[_0x3e5c77(0xc3)]==_0xf571e2[_0x3e5c77(0x105)]&&_0xabb2d3['rack']==_0xf571e2['from_rack']&&_0xabb2d3[_0x3e5c77(0xff)]==_0xf571e2[_0x3e5c77(0x15c)]&&(_0xabb2d3[_0x3e5c77(0xb7)]=parseInt(_0xabb2d3[_0x3e5c77(0xb7)])-parseInt(_0xf571e2[_0x3e5c77(0x17c)]));});}}),await _0x1e4616['save']();const _0x480188=await warehouse[_0x432d86(0xb1)]({'name':_0x146675,'room':_0x2e07c8});_0x5beb0b[_0x432d86(0x92)][_0x432d86(0x163)](_0x3d77fe=>{var _0xb6ae68=_0x432d86;if(_0x3d77fe[_0xb6ae68(0x17c)]>0x0){var _0x4eca31=0x0;const _0x4c3aee=_0x480188[_0xb6ae68(0x143)]['map'](_0xec9d9d=>{var _0x30b690=_0xb6ae68;_0xec9d9d['product_name']==_0x3d77fe[_0x30b690(0x17a)]&&_0xec9d9d['floorlevel']==_0x3d77fe[_0x30b690(0xd9)]&&_0xec9d9d[_0x30b690(0xd2)]==_0x3d77fe[_0x30b690(0x170)]&&_0xec9d9d['bin']==_0x3d77fe[_0x30b690(0x152)]&&_0xec9d9d[_0x30b690(0xc3)]==_0x3d77fe[_0x30b690(0x141)]&&_0xec9d9d[_0x30b690(0xa6)]==_0x3d77fe['rack']&&_0xec9d9d[_0x30b690(0xff)]==_0x3d77fe[_0x30b690(0xff)]&&(_0xec9d9d[_0x30b690(0xb7)]=parseInt(_0xec9d9d['product_stock'])+parseInt(_0x3d77fe['to_quantity']),_0x4eca31++);});_0x4eca31=='0'&&(_0x480188[_0xb6ae68(0x143)]=_0x480188[_0xb6ae68(0x143)]['concat']({'product_name':_0x3d77fe[_0xb6ae68(0x17a)],'product_stock':_0x3d77fe[_0xb6ae68(0x17c)],'bay':_0x3d77fe[_0xb6ae68(0x141)],'bin':_0x3d77fe[_0xb6ae68(0x152)],'type':_0x3d77fe['to_types'],'floorlevel':_0x3d77fe['to_floorlevel'],'storage':_0x3d77fe[_0xb6ae68(0xff)],'rack':_0x3d77fe[_0xb6ae68(0xa6)],'product_code':_0x3d77fe[_0xb6ae68(0x147)],'primary_code':_0x3d77fe[_0xb6ae68(0xca)],'secondary_code':_0x3d77fe[_0xb6ae68(0x8f)],'maxProducts':_0x3d77fe['maxProducts'],'storage':_0x3d77fe[_0xb6ae68(0xff)],'rack':_0x3d77fe['rack']}));}}),await _0x480188['save'](),_0x1f0e91[_0x432d86(0xe9)]('success','Transfer\x20Edit\x20Successfully'),_0x2b006a[_0x432d86(0x174)](_0x432d86(0x155));}catch(_0x38ff81){console[_0x432d86(0x164)](_0x38ff81);}}),router[a0_0x7a021a(0x107)](a0_0x7a021a(0xe4),async(_0xf54b3b,_0xb51475)=>{var _0x185ed3=a0_0x7a021a;const {FromWareHouse:_0x439054,FromRoom:_0x5f09bf,ToWarehouse:_0x30edd1,ToRoom:_0x21f5fd,primary_code:_0x1c3f91,Roomslist:_0xf19bf1}=_0xf54b3b[_0x185ed3(0x104)],_0x2cfe32=_0xf19bf1[_0x185ed3(0xfe)](','),_0x52937d=[];async function _0x457065(_0x1e9fb8){var _0x2ffcad=_0x185ed3;const _0x1e0939=await warehouse[_0x2ffcad(0xb2)]([{'$match':{'name':_0x439054,'room':_0x1e9fb8}},{'$unwind':_0x2ffcad(0x106)},{'$match':{'product_details.primary_code':_0x1c3f91}},{'$group':{'_id':_0x2ffcad(0x16f),'name':{'$first':_0x2ffcad(0x13b)},'instock':{'$first':_0x2ffcad(0xaf)},'primary_code':{'$first':_0x2ffcad(0xc4)},'secondary_code':{'$first':_0x2ffcad(0x10c)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x2ffcad(0xce)},'type':{'$first':_0x2ffcad(0xc1)},'pallet':{'$first':_0x2ffcad(0x17e)},'unit':{'$first':_0x2ffcad(0x149)},'secondary_unit':{'$first':_0x2ffcad(0xde)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2ffcad(0xf5)},'expiry_date':{'$first':_0x2ffcad(0x172)},'production_date':{'$first':_0x2ffcad(0xdf)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x2ffcad(0xb6)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x2ffcad(0xbf)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x2ffcad(0x109)}}}]),_0x80c148=await warehouse[_0x2ffcad(0xb2)]([{'$match':{'name':_0x439054,'room':_0x1e9fb8}},{'$unwind':_0x2ffcad(0x106)},{'$match':{'product_details.secondary_code':_0x1c3f91}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2ffcad(0x13b)},'instock':{'$first':_0x2ffcad(0xaf)},'primary_code':{'$first':_0x2ffcad(0xc4)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2ffcad(0x94)},'level':{'$first':_0x2ffcad(0x176)},'isle':{'$first':_0x2ffcad(0xce)},'type':{'$first':_0x2ffcad(0xc1)},'pallet':{'$first':_0x2ffcad(0x17e)},'unit':{'$first':_0x2ffcad(0x149)},'secondary_unit':{'$first':_0x2ffcad(0xde)},'storage':{'$first':_0x2ffcad(0xa5)},'rack':{'$first':_0x2ffcad(0xf5)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2ffcad(0xdf)},'batch_code':{'$first':_0x2ffcad(0xae)},'maxPerUnit':{'$first':_0x2ffcad(0xb6)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x2ffcad(0xbf)},'maxProducts':{'$first':_0x2ffcad(0xa8)},'invoice_product':{'$first':_0x2ffcad(0x109)}}}]);if(_0x1e0939[_0x2ffcad(0x167)]>0x0)_0x52937d[_0x2ffcad(0x11e)](_0x1e0939);else _0x80c148[_0x2ffcad(0x167)]>0x0&&_0x52937d[_0x2ffcad(0x11e)](_0x80c148);}const _0xae3da0=_0x2cfe32['map'](_0x4180b3=>_0x457065(_0x4180b3));await Promise[_0x185ed3(0x120)](_0xae3da0),_0xb51475[_0x185ed3(0x122)](_0x52937d);}),router[a0_0x7a021a(0x107)](a0_0x7a021a(0xf9),async(_0x3d61f0,_0x2e0547)=>{var _0x2b609d=a0_0x7a021a;try{const {FromWareHouse:_0x5144ac,FromRoom:_0x27f051,ToWarehouse:_0x3a6a42,ToRoom:_0x796d25,secondary_code:_0x11bfc8}=_0x3d61f0[_0x2b609d(0x104)],_0xc5e27=await warehouse[_0x2b609d(0xb2)]([{'$match':{'name':_0x5144ac}},{'$unwind':_0x2b609d(0x106)},{'$match':{'product_details.secondary_code':_0x11bfc8}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2b609d(0x13b)},'primary_code':{'$first':_0x2b609d(0xc4)},'secondary_code':{'$first':_0x2b609d(0x10c)},'product_code':{'$first':_0x2b609d(0x94)},'instock':{'$first':_0x2b609d(0xaf)},'warehouse':{'$first':_0x2b609d(0x9c)},'level':{'$first':_0x2b609d(0x16e)},'isle':{'$first':_0x2b609d(0x179)},'pallet':{'$first':_0x2b609d(0x97)},'maxProducts':{'$first':_0x2b609d(0xa8)},'unit':{'$first':_0x2b609d(0x149)}}}]);_0x2e0547['status'](0xc8)[_0x2b609d(0x122)](_0xc5e27);}catch(_0x4ca1e2){_0x2e0547[_0x2b609d(0x175)](0x194)[_0x2b609d(0x122)]({'message':_0x4ca1e2[_0x2b609d(0xf7)]});}}),router[a0_0x7a021a(0x107)](a0_0x7a021a(0xab),async(_0x17e122,_0xf2c91c)=>{var _0x59a6b8=a0_0x7a021a;try{const {FromWareHouse:_0x202a51,FromRoom:_0x1839e8,ToWarehouse:_0xe3f23a,ToRoom:_0x4a13c5,product_code:_0x1a39a2}=_0x17e122[_0x59a6b8(0x104)],_0x573f23=await warehouse['aggregate']([{'$match':{'name':_0x202a51}},{'$unwind':_0x59a6b8(0x106)},{'$match':{'product_details.product_code':_0x1a39a2}},{'$group':{'_id':_0x59a6b8(0x16f),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x59a6b8(0xc4)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x59a6b8(0xaf)},'warehouse':{'$first':'$name'},'level':{'$first':_0x59a6b8(0x16e)},'isle':{'$first':_0x59a6b8(0x179)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x59a6b8(0x149)}}}]);_0xf2c91c[_0x59a6b8(0x175)](0xc8)[_0x59a6b8(0x122)](_0x573f23);}catch(_0x448d8f){_0xf2c91c[_0x59a6b8(0x175)](0x194)[_0x59a6b8(0x122)]({'message':_0x448d8f[_0x59a6b8(0xf7)]});}}),router[a0_0x7a021a(0x107)](a0_0x7a021a(0x173),async(_0x2544fe,_0x5e85e9)=>{var _0xa56691=a0_0x7a021a;const {level:_0x2a7019,isle:_0x59a376,pallet:_0x57e49a,warehouses:_0x2d03f4,room:_0x46e62a}=_0x2544fe[_0xa56691(0x104)];try{const _0x2e308d=await warehouse['aggregate']([{'$match':{'name':_0x2d03f4,'room':_0x46e62a}},{'$unwind':_0xa56691(0x106)},{'$match':{'product_details.level':parseInt(_0x2a7019),'product_details.isle':_0x59a376,'product_details.pallet':parseInt(_0x57e49a)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xa56691(0x13b)},'product_stock':{'$first':_0xa56691(0xaf)},'level':{'$first':_0xa56691(0x16e)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0xa56691(0x97)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x5e85e9['status'](0xc8)[_0xa56691(0x122)](_0x2e308d);}catch(_0x542dc2){_0x5e85e9['status'](0x194)[_0xa56691(0x122)]({'message':_0x542dc2[_0xa56691(0xf7)]});}}),module['exports']=router;