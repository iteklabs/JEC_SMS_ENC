var a0_0x43761f=a0_0x9453;function a0_0x9453(_0x506c1c,_0x76468c){var _0x271c12=a0_0x271c();return a0_0x9453=function(_0x9453fb,_0x330554){_0x9453fb=_0x9453fb-0x17f;var _0x45cfc7=_0x271c12[_0x9453fb];return _0x45cfc7;},a0_0x9453(_0x506c1c,_0x76468c);}(function(_0x203f6a,_0x55bf54){var _0x31bd01=a0_0x9453,_0x40669f=_0x203f6a();while(!![]){try{var _0x380327=parseInt(_0x31bd01(0x25e))/0x1+-parseInt(_0x31bd01(0x1e7))/0x2*(parseInt(_0x31bd01(0x1d5))/0x3)+parseInt(_0x31bd01(0x1fc))/0x4*(-parseInt(_0x31bd01(0x26a))/0x5)+parseInt(_0x31bd01(0x1a9))/0x6*(parseInt(_0x31bd01(0x18e))/0x7)+parseInt(_0x31bd01(0x190))/0x8+parseInt(_0x31bd01(0x1f7))/0x9+-parseInt(_0x31bd01(0x1ec))/0xa;if(_0x380327===_0x55bf54)break;else _0x40669f['push'](_0x40669f['shift']());}catch(_0x2ae687){_0x40669f['push'](_0x40669f['shift']());}}}(a0_0x271c,0xb49ea));const express=require(a0_0x43761f(0x21b)),app=express(),router=express[a0_0x43761f(0x1d1)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x43761f(0x230)),nodemailer=require(a0_0x43761f(0x1c6));router[a0_0x43761f(0x1dd)](a0_0x43761f(0x24b),auth,async(_0x4c86db,_0x1701e6)=>{var _0x36635c=a0_0x43761f;try{const {username:_0x14ea2c,email:_0x5698c4,role:_0x5a29bd}=_0x4c86db[_0x36635c(0x1e4)],_0x5c13ef=_0x4c86db[_0x36635c(0x1e4)],_0x22f9b3=await profile['findOne']({'email':_0x5c13ef[_0x36635c(0x209)]}),_0x40aee5=await master_shop[_0x36635c(0x238)]();console[_0x36635c(0x239)](_0x36635c(0x264),_0x40aee5);let _0x2644b2;if(_0x5c13ef['role']=='staff'){const _0x47556a=await staff['findOne']({'email':_0x5c13ef['email']});_0x2644b2=await transfers['find']({'from_warehouse':_0x47556a[_0x36635c(0x1aa)]});}else _0x2644b2=await transfers[_0x36635c(0x23a)]([{'$unwind':_0x36635c(0x24f)},{'$group':{'_id':_0x36635c(0x1eb),'invoice':{'$first':_0x36635c(0x23d)},'date':{'$first':_0x36635c(0x23e)},'from_warehouse':{'$first':_0x36635c(0x271)},'to_warehouse':{'$first':_0x36635c(0x1a3)},'from_room_name':{'$addToSet':_0x36635c(0x24a)},'to_room_name':{'$addToSet':_0x36635c(0x1ba)},'finalize':{'$first':_0x36635c(0x1e1)},'isAllowEdit':{'$first':_0x36635c(0x23f)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x40aee5[0x0][_0x36635c(0x248)]==_0x36635c(0x273)){var _0x35a3a1=users[_0x36635c(0x1e3)];console['log'](_0x35a3a1);}else{if(_0x40aee5[0x0][_0x36635c(0x248)]==_0x36635c(0x1d3))var _0x35a3a1=users[_0x36635c(0x1d3)];else{if(_0x40aee5[0x0][_0x36635c(0x248)]==_0x36635c(0x220))var _0x35a3a1=users['German'];else{if(_0x40aee5[0x0][_0x36635c(0x248)]==_0x36635c(0x21e))var _0x35a3a1=users['Spanish'];else{if(_0x40aee5[0x0][_0x36635c(0x248)]==_0x36635c(0x1da))var _0x35a3a1=users[_0x36635c(0x1da)];else{if(_0x40aee5[0x0][_0x36635c(0x248)]==_0x36635c(0x1dc))var _0x35a3a1=users[_0x36635c(0x199)];else{if(_0x40aee5[0x0][_0x36635c(0x248)]==_0x36635c(0x195))var _0x35a3a1=users[_0x36635c(0x195)];else{if(_0x40aee5[0x0]['language']==_0x36635c(0x1af))var _0x35a3a1=users['Arabic'];}}}}}}}_0x1701e6['render'](_0x36635c(0x1de),{'success':_0x4c86db['flash'](_0x36635c(0x234)),'errors':_0x4c86db['flash'](_0x36635c(0x206)),'role':_0x5c13ef,'profile':_0x22f9b3,'master_shop':_0x40aee5,'transfer':_0x2644b2,'language':_0x35a3a1});}catch(_0x38ff43){console['log'](_0x38ff43);}});async function getRandom8DigitNumber(){var _0x2ca001=a0_0x43761f;const _0x55dd7e=0x989680,_0x243181=0x5f5e0ff,_0x5b5e42=Math['floor'](Math[_0x2ca001(0x237)]()*(_0x243181-_0x55dd7e+0x1))+_0x55dd7e;var _0x10089b;const _0x5edac6=await transfers[_0x2ca001(0x207)]({'invoice':_0x2ca001(0x25b)+_0x5b5e42});return _0x5edac6&&_0x5edac6[_0x2ca001(0x18c)]>0x0?_0x10089b=_0x2ca001(0x25b)+_0x5b5e42:_0x10089b='TRF-'+_0x5b5e42,_0x10089b;}router['get'](a0_0x43761f(0x259),auth,async(_0xb1b761,_0x107913)=>{var _0x4f1886=a0_0x43761f;try{const {username:_0x524398,email:_0x1578d7,role:_0x1773ed}=_0xb1b761[_0x4f1886(0x1e4)],_0x98db2=_0xb1b761['user'],_0x3f40f7=await profile[_0x4f1886(0x207)]({'email':_0x98db2[_0x4f1886(0x209)]}),_0x322581=await master_shop['find']();console['log']('master',_0x322581);let _0x3f6644;if(_0x98db2['role']=='staff'){const _0x13ac3a=await staff[_0x4f1886(0x207)]({'email':_0x98db2[_0x4f1886(0x209)]});_0x3f6644=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x13ac3a[_0x4f1886(0x1aa)],'warehouse_category':_0x4f1886(0x186)}},{'$group':{'_id':_0x4f1886(0x235),'name':{'$first':_0x4f1886(0x235)}}}]);}else _0x3f6644=await warehouse[_0x4f1886(0x23a)]([{'$match':{'status':_0x4f1886(0x231),'warehouse_category':_0x4f1886(0x186)}},{'$group':{'_id':_0x4f1886(0x235),'name':{'$first':_0x4f1886(0x235)}}}]);var _0x5cd5df=['Ambient',_0x4f1886(0x1a0),_0x4f1886(0x22c)];const _0x17da13=await transfers[_0x4f1886(0x238)]({}),_0x224dbe=_0x17da13['length']+0x1,_0x1bf377=_0x4f1886(0x25b)+_0x224dbe[_0x4f1886(0x1e6)]()['padStart'](0x5,'0');if(_0x322581[0x0][_0x4f1886(0x248)]==_0x4f1886(0x273)){var _0x447d99=users[_0x4f1886(0x1e3)];console[_0x4f1886(0x239)](_0x447d99);}else{if(_0x322581[0x0][_0x4f1886(0x248)]==_0x4f1886(0x1d3))var _0x447d99=users[_0x4f1886(0x1d3)];else{if(_0x322581[0x0]['language']==_0x4f1886(0x220))var _0x447d99=users[_0x4f1886(0x220)];else{if(_0x322581[0x0][_0x4f1886(0x248)]=='Spanish')var _0x447d99=users[_0x4f1886(0x21e)];else{if(_0x322581[0x0]['language']==_0x4f1886(0x1da))var _0x447d99=users[_0x4f1886(0x1da)];else{if(_0x322581[0x0][_0x4f1886(0x248)]=='Portuguese\x20(BR)')var _0x447d99=users[_0x4f1886(0x199)];else{if(_0x322581[0x0][_0x4f1886(0x248)]==_0x4f1886(0x195))var _0x447d99=users[_0x4f1886(0x195)];else{if(_0x322581[0x0][_0x4f1886(0x248)]==_0x4f1886(0x1af))var _0x447d99=users[_0x4f1886(0x256)];}}}}}}}const _0x56101e=getRandom8DigitNumber();_0x56101e[_0x4f1886(0x1b7)](_0x239b69=>{var _0x291a89=_0x4f1886;_0x107913['render'](_0x291a89(0x1b1),{'success':_0xb1b761[_0x291a89(0x240)]('success'),'errors':_0xb1b761[_0x291a89(0x240)]('errors'),'role':_0x98db2,'profile':_0x3f40f7,'master_shop':_0x322581,'warehouse':_0x3f6644,'language':_0x447d99,'rooms_data':_0x5cd5df,'invoice':_0x239b69});})[_0x4f1886(0x1a7)](_0x45fb84=>{var _0x191c04=_0x4f1886;_0xb1b761[_0x191c04(0x240)](_0x191c04(0x206),_0x191c04(0x1fd)),_0x107913['redirect'](_0x191c04(0x1c8));});}catch(_0x39d862){console[_0x4f1886(0x239)](_0x39d862);}}),router[a0_0x43761f(0x1a6)]('/view/add_transfer',auth,async(_0x5721dc,_0x147ab4)=>{var _0x38c296=a0_0x43761f;try{console[_0x38c296(0x239)](_0x5721dc[_0x38c296(0x254)]);const {date:_0x43c1c0,from_warehouse:_0x599a0c,FromRoom_name:_0x54c139,to_warehouse:_0x1aa056,ToRoom_name:_0x150b92,prod_name:_0x4b419a,from_prod_qty:_0x708640,from_prod_level:_0x4e7e94,from_prod_isle:_0xfc54e0,from_prod_pallet:_0x1434ed,to_prod_qty:_0x59b7ce,to_prod_level:_0x27d480,to_prod_isle:_0x4b680f,to_prod_pallet:_0x2177ef,primary_code:_0xc8f472,secondary_code:_0x343de8,product_code3:_0x5d2be1,note:_0x50d25f,MaxStocks_data2:_0x395a5d,invoice:_0x1f7ab8,expiry_date:_0x280a0a}=_0x5721dc[_0x38c296(0x254)];if(typeof _0x4b419a==_0x38c296(0x1e9))var _0x1499e0=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x1bf)]],_0x504ce2=[_0x5721dc['body'][_0x38c296(0x22e)]],_0x46aab8=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x1e8)]],_0x308a1c=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x252)]],_0x1afa30=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x19a)]],_0x49a728=[_0x5721dc['body'][_0x38c296(0x1d8)]],_0x590036=[_0x5721dc['body']['secondary_code']],_0xcff80e=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x182)]],_0x1812e0=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x18a)]],_0x4c27a7=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x257)]],_0x5811de=[_0x5721dc[_0x38c296(0x254)]['secondary_unit']],_0x7d65f9=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x221)]],_0x5750c2=[_0x5721dc[_0x38c296(0x254)]['expiry_date']],_0x40fe3d=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x25a)]],_0x2f0ee2=[_0x5721dc[_0x38c296(0x254)]['production_date']],_0x5e173a=[_0x5721dc[_0x38c296(0x254)]['prod_cat']],_0xbc307b=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x232)]],_0x20fec5=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x1ac)]],_0x3fea24=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x225)]],_0x3cab13=[_0x5721dc['body']['to_invoice']],_0x29dc0b=[_0x5721dc[_0x38c296(0x254)][_0x38c296(0x22f)]];else var _0x1499e0=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x1bf)]],_0x504ce2=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x22e)]],_0x46aab8=[..._0x5721dc[_0x38c296(0x254)]['from_prod_level']],_0x308a1c=[..._0x5721dc[_0x38c296(0x254)]['New_Qty_Converted']],_0x1afa30=[..._0x5721dc['body'][_0x38c296(0x19a)]],_0x49a728=[..._0x5721dc['body'][_0x38c296(0x1d8)]],_0x590036=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x211)]],_0xcff80e=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x182)]],_0x1812e0=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x18a)]],_0x4c27a7=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x257)]],_0x5811de=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x187)]],_0x7d65f9=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x221)]],_0x5750c2=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x266)]],_0x40fe3d=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x25a)]],_0x2f0ee2=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x22a)]],_0x5e173a=[..._0x5721dc['body'][_0x38c296(0x260)]],_0xbc307b=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x232)]],_0x20fec5=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x1ac)]],_0x3fea24=[..._0x5721dc['body'][_0x38c296(0x225)]],_0x3cab13=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x201)]],_0x29dc0b=[..._0x5721dc[_0x38c296(0x254)][_0x38c296(0x22f)]];const _0x5ae175=_0x1499e0[_0x38c296(0x19f)](_0x3f9ef0=>{return _0x3f9ef0={'product_name':_0x3f9ef0};});_0x504ce2['forEach']((_0x5899ad,_0x196476)=>{var _0x40ab27=_0x38c296;_0x5ae175[_0x196476][_0x40ab27(0x189)]=_0x5899ad;}),_0x3fea24['forEach']((_0x29ed2a,_0x23ea5c)=>{_0x5ae175[_0x23ea5c]['from_invoice']=_0x29ed2a;}),_0x3cab13[_0x38c296(0x1a5)]((_0x3abb7b,_0x4d6ef3)=>{var _0x47b226=_0x38c296;_0x5ae175[_0x4d6ef3][_0x47b226(0x262)]=_0x3abb7b;}),_0x29dc0b[_0x38c296(0x1a5)]((_0x4a23b2,_0xd5181a)=>{var _0xd42457=_0x38c296;_0x5ae175[_0xd5181a][_0xd42457(0x1b4)]=_0x4a23b2;}),_0x46aab8['forEach']((_0x33f502,_0x131330)=>{_0xbc307b['forEach']((_0x3c5652,_0x47810d)=>{var _0x1e3dac=a0_0x9453;if(_0x3c5652==_0x1e3dac(0x20b)&&_0x131330==_0x47810d){var _0x4da047=_0x33f502['slice'](0x3);_0x5ae175[_0x131330][_0x1e3dac(0x258)]=_0x33f502[0x0],_0x5ae175[_0x131330][_0x1e3dac(0x1fe)]=_0x33f502[0x1],_0x5ae175[_0x131330][_0x1e3dac(0x1c9)]=0x0,_0x5ae175[_0x131330]['from_bin']=0x0,_0x5ae175[_0x131330][_0x1e3dac(0x219)]=_0x1e3dac(0x245),_0x5ae175[_0x131330][_0x1e3dac(0x19e)]=_0x4da047;}else{if(_0x3c5652==_0x1e3dac(0x1bc)&&_0x131330==_0x47810d){var _0x4da047=_0x33f502['slice'](0x3);_0x5ae175[_0x131330][_0x1e3dac(0x258)]=_0x33f502[0x0],_0x5ae175[_0x131330][_0x1e3dac(0x1fe)]=_0x33f502[0x1],_0x5ae175[_0x131330]['from_bay']=0x0,_0x5ae175[_0x131330][_0x1e3dac(0x19b)]=0x0,_0x5ae175[_0x131330][_0x1e3dac(0x219)]='Floor',_0x5ae175[_0x131330][_0x1e3dac(0x19e)]=_0x33f502[0x5];}else{if(_0x131330==_0x47810d){if(_0x33f502[0x0]=='A'&&_0x33f502[0x1]=='L'&&_0x33f502[0x2]=='L')console[_0x1e3dac(0x239)](_0x3c5652+_0x1e3dac(0x255)+_0x131330+'\x20<>\x20'+_0x47810d+_0x1e3dac(0x255)+_0x33f502+_0x1e3dac(0x267)),_0x5ae175[_0x131330]['from_storage']=_0x33f502[0x0],_0x5ae175[_0x131330][_0x1e3dac(0x1fe)]=_0x33f502[0x1],_0x5ae175[_0x131330]['from_bay']=0x0,_0x5ae175[_0x131330][_0x1e3dac(0x19b)]=0x0,_0x5ae175[_0x131330][_0x1e3dac(0x219)]=_0x1e3dac(0x245),_0x5ae175[_0x131330]['from_floorlevel']=_0x33f502[0x3];else{var _0x541601;if(_0x33f502[0x4]=='L')_0x541601='Level';else _0x33f502[0x4]=='F'&&(_0x541601=_0x1e3dac(0x245));_0x5ae175[_0x131330][_0x1e3dac(0x258)]=_0x33f502[0x0],_0x5ae175[_0x131330][_0x1e3dac(0x1fe)]=_0x33f502[0x1],_0x5ae175[_0x131330]['from_bay']=_0x33f502[0x2],_0x5ae175[_0x131330]['from_bin']=_0x33f502[0x3],_0x5ae175[_0x131330][_0x1e3dac(0x219)]=_0x541601,_0x5ae175[_0x131330]['from_floorlevel']=_0x33f502[0x5];}}}}});}),_0x308a1c[_0x38c296(0x1a5)]((_0x392aaf,_0x2394fb)=>{var _0x3d5aed=_0x38c296;_0x5ae175[_0x2394fb][_0x3d5aed(0x21a)]=_0x392aaf;}),_0x1afa30['forEach']((_0x3aefba,_0x1c3424)=>{var _0x1e98c5=_0x38c296;_0x20fec5[_0x1e98c5(0x1a5)]((_0x5627d2,_0x5585bd)=>{var _0x1f631d=_0x1e98c5;if(_0x5627d2==_0x1f631d(0x20b)&&_0x1c3424==_0x5585bd){var _0x183d20=_0x3aefba[_0x1f631d(0x202)](0x3);_0x5ae175[_0x1c3424][_0x1f631d(0x21f)]=_0x3aefba[0x0],_0x5ae175[_0x1c3424][_0x1f631d(0x26f)]=_0x3aefba[0x1],_0x5ae175[_0x1c3424]['to_bay']=0x0,_0x5ae175[_0x1c3424][_0x1f631d(0x1cd)]=0x0,_0x5ae175[_0x1c3424][_0x1f631d(0x1c0)]=_0x1f631d(0x245),_0x5ae175[_0x1c3424]['to_floorlevel']=_0x183d20;}else{if(_0x5627d2=='Shelves'&&_0x1c3424==_0x5585bd){var _0x183d20=_0x3aefba[_0x1f631d(0x202)](0x3);_0x5ae175[_0x1c3424][_0x1f631d(0x21f)]=_0x3aefba[0x0],_0x5ae175[_0x1c3424]['rack']=_0x3aefba[0x1],_0x5ae175[_0x1c3424][_0x1f631d(0x19c)]=0x0,_0x5ae175[_0x1c3424][_0x1f631d(0x1cd)]=0x0,_0x5ae175[_0x1c3424][_0x1f631d(0x1c0)]='Floor',_0x5ae175[_0x1c3424][_0x1f631d(0x1ad)]=_0x3aefba[0x5];}else{if(_0x1c3424==_0x5585bd){if(_0x3aefba[0x0]=='A'&&_0x3aefba[0x1]=='L'&&_0x3aefba[0x2]=='L')console[_0x1f631d(0x239)](_0x5627d2+'\x20<>\x20'+_0x1c3424+_0x1f631d(0x255)+_0x5585bd+_0x1f631d(0x255)+_0x3aefba+'here'),_0x5ae175[_0x1c3424][_0x1f631d(0x21f)]=_0x3aefba[0x0],_0x5ae175[_0x1c3424][_0x1f631d(0x26f)]=_0x3aefba[0x1],_0x5ae175[_0x1c3424][_0x1f631d(0x19c)]=0x0,_0x5ae175[_0x1c3424]['to_bin']=0x0,_0x5ae175[_0x1c3424][_0x1f631d(0x1c0)]='Floor',_0x5ae175[_0x1c3424][_0x1f631d(0x1ad)]=_0x3aefba[0x3];else{var _0x2d9631;if(_0x3aefba[0x4]=='L')_0x2d9631='Level';else _0x3aefba[0x4]=='F'&&(_0x2d9631=_0x1f631d(0x245));_0x5ae175[_0x1c3424]['storage']=_0x3aefba[0x0],_0x5ae175[_0x1c3424]['rack']=_0x3aefba[0x1],_0x5ae175[_0x1c3424][_0x1f631d(0x19c)]=_0x3aefba[0x2],_0x5ae175[_0x1c3424]['to_bin']=_0x3aefba[0x3],_0x5ae175[_0x1c3424][_0x1f631d(0x1c0)]=_0x2d9631,_0x5ae175[_0x1c3424][_0x1f631d(0x1ad)]=_0x3aefba[0x5];}}}}});}),_0x49a728['forEach']((_0xa8cdf4,_0x513b3d)=>{_0x5ae175[_0x513b3d]['primary_code']=_0xa8cdf4;}),_0x590036[_0x38c296(0x1a5)]((_0x542c2a,_0x1766d7)=>{var _0x1605c=_0x38c296;_0x5ae175[_0x1766d7][_0x1605c(0x211)]=_0x542c2a;}),_0xcff80e[_0x38c296(0x1a5)]((_0x161593,_0x1b2647)=>{var _0x514b62=_0x38c296;_0x5ae175[_0x1b2647][_0x514b62(0x205)]=_0x161593;}),_0x1812e0[_0x38c296(0x1a5)]((_0x16e6b0,_0x1bb8d3)=>{_0x5ae175[_0x1bb8d3]['maxProducts']=_0x16e6b0;}),_0x4c27a7[_0x38c296(0x1a5)]((_0x8bf868,_0x4b37c5)=>{_0x5ae175[_0x4b37c5]['unit']=_0x8bf868;}),_0x5811de[_0x38c296(0x1a5)]((_0x18e4db,_0x2e600a)=>{var _0x4100fd=_0x38c296;_0x5ae175[_0x2e600a][_0x4100fd(0x187)]=_0x18e4db;}),_0x7d65f9[_0x38c296(0x1a5)]((_0x39bafe,_0x1a52eb)=>{var _0xecc404=_0x38c296;_0x5ae175[_0x1a52eb][_0xecc404(0x221)]=_0x39bafe;}),_0x5750c2[_0x38c296(0x1a5)]((_0xc24389,_0x4c1eab)=>{var _0x593c4e=_0x38c296;_0x5ae175[_0x4c1eab][_0x593c4e(0x266)]=_0xc24389;}),_0x40fe3d[_0x38c296(0x1a5)]((_0x32df12,_0x30d9dc)=>{var _0x1f0df3=_0x38c296;_0x5ae175[_0x30d9dc][_0x1f0df3(0x18b)]=_0x32df12;}),_0x2f0ee2[_0x38c296(0x1a5)]((_0x1e84d8,_0x452b43)=>{_0x5ae175[_0x452b43]['production_date']=_0x1e84d8;}),_0x5e173a[_0x38c296(0x1a5)]((_0x1404af,_0x27c097)=>{_0x5ae175[_0x27c097]['prod_cat']=_0x1404af;}),_0xbc307b[_0x38c296(0x1a5)]((_0x2a0a11,_0x408a00)=>{_0x5ae175[_0x408a00]['from_room_name']=_0x2a0a11;}),_0x20fec5[_0x38c296(0x1a5)]((_0x4d0b2d,_0x5842c5)=>{_0x5ae175[_0x5842c5]['to_room_name']=_0x4d0b2d;});const _0x37b6fa=_0x5ae175[_0x38c296(0x1c1)](_0x5360cc=>_0x5360cc[_0x38c296(0x21a)]!=='0'&&_0x5360cc[_0x38c296(0x21a)]!==''||_0x5360cc[_0x38c296(0x1ad)]!=='0'&&_0x5360cc[_0x38c296(0x1ad)]!==''),_0x321a01=new transfers({'date':_0x43c1c0,'from_warehouse':_0x599a0c,'to_warehouse':_0x1aa056,'product':_0x37b6fa,'note':_0x50d25f,'invoice':_0x1f7ab8}),_0x355e20=await _0x321a01['save']();_0x5721dc[_0x38c296(0x240)](_0x38c296(0x234),_0x38c296(0x1b5)),_0x147ab4['redirect'](_0x38c296(0x223)+_0x355e20[_0x38c296(0x181)]);}catch(_0x5040f7){console[_0x38c296(0x239)](_0x5040f7),_0x147ab4[_0x38c296(0x20c)](0xc8)[_0x38c296(0x20a)]({'errorMessage':_0x5040f7[_0x38c296(0x1ab)]});}}),router[a0_0x43761f(0x1dd)](a0_0x43761f(0x1cc),auth,async(_0x39b31b,_0x599199)=>{var _0x29564e=a0_0x43761f;try{const {username:_0x5e577f,email:_0x4c36eb,role:_0x14b851}=_0x39b31b[_0x29564e(0x1e4)],_0x3d1d55=_0x39b31b[_0x29564e(0x1e4)],_0x179da8=await profile[_0x29564e(0x207)]({'email':_0x3d1d55[_0x29564e(0x209)]}),_0x57f0ce=await master_shop[_0x29564e(0x238)]();console['log'](_0x29564e(0x264),_0x57f0ce);const _0x29db84=await transfers[_0x29564e(0x1ea)](_0x39b31b[_0x29564e(0x1c4)]['id']);let _0x5d7bcd=new Date(_0x29db84[_0x29564e(0x266)]),_0x48e120=('0'+_0x5d7bcd['getDate']())[_0x29564e(0x202)](-0x2),_0xed6626=('0'+(_0x5d7bcd[_0x29564e(0x18d)]()+0x1))[_0x29564e(0x202)](-0x2),_0x14fa66=_0x5d7bcd[_0x29564e(0x188)](),_0x135f66=_0x14fa66+'-'+_0xed6626+'-'+_0x48e120,_0x32ff34;if(_0x3d1d55[_0x29564e(0x1cb)]==_0x29564e(0x1b8)){const _0x59afcf=await staff[_0x29564e(0x207)]({'email':_0x3d1d55[_0x29564e(0x209)]});_0x32ff34=await warehouse[_0x29564e(0x238)]({'status':'Enabled','name':_0x59afcf[_0x29564e(0x1aa)],'warehouse_category':'Raw\x20Materials'});}else _0x32ff34=await warehouse[_0x29564e(0x238)]({'status':_0x29564e(0x231),'warehouse_category':_0x29564e(0x186)});const _0x53775f=await warehouse['aggregate']([{'$match':{'name':_0x29db84[_0x29564e(0x1fb)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x29564e(0x24d)},'bay':{'$first':_0x29564e(0x227)},'bin':{'$first':_0x29564e(0x20f)},'type':{'$first':_0x29564e(0x1f2)},'floorlevel':{'$first':_0x29564e(0x21d)},'primary_code':{'$first':_0x29564e(0x1ae)},'secondary_code':{'$first':_0x29564e(0x249)},'product_code':{'$first':_0x29564e(0x1cf)},'storage':{'$first':_0x29564e(0x1bd)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x29564e(0x229)},'room':{'$first':_0x29564e(0x1b2)}}}]);if(_0x57f0ce[0x0][_0x29564e(0x248)]==_0x29564e(0x273)){var _0x5a4e71=users[_0x29564e(0x1e3)];console[_0x29564e(0x239)](_0x5a4e71);}else{if(_0x57f0ce[0x0][_0x29564e(0x248)]==_0x29564e(0x1d3))var _0x5a4e71=users['Hindi'];else{if(_0x57f0ce[0x0][_0x29564e(0x248)]==_0x29564e(0x220))var _0x5a4e71=users['German'];else{if(_0x57f0ce[0x0][_0x29564e(0x248)]=='Spanish')var _0x5a4e71=users[_0x29564e(0x21e)];else{if(_0x57f0ce[0x0][_0x29564e(0x248)]=='French')var _0x5a4e71=users['French'];else{if(_0x57f0ce[0x0][_0x29564e(0x248)]==_0x29564e(0x1dc))var _0x5a4e71=users['Portuguese'];else{if(_0x57f0ce[0x0]['language']==_0x29564e(0x195))var _0x5a4e71=users[_0x29564e(0x195)];else{if(_0x57f0ce[0x0][_0x29564e(0x248)]=='Arabic\x20(ae)')var _0x5a4e71=users['Arabic'];}}}}}}}_0x599199[_0x29564e(0x212)](_0x29564e(0x250),{'success':_0x39b31b[_0x29564e(0x240)](_0x29564e(0x234)),'errors':_0x39b31b[_0x29564e(0x240)](_0x29564e(0x206)),'role':_0x3d1d55,'profile':_0x179da8,'master_shop':_0x57f0ce,'warehouse':_0x32ff34,'transfer':_0x29db84,'stock':_0x53775f,'language':_0x5a4e71});}catch(_0xfe30fb){console[_0x29564e(0x239)](_0xfe30fb);}}),router[a0_0x43761f(0x1a6)](a0_0x43761f(0x1cc),auth,async(_0xc71699,_0x6de802)=>{var _0x1ab4dc=a0_0x43761f;try{const _0x32949a=_0xc71699[_0x1ab4dc(0x1c4)]['id'],{from_warehouse:_0x205ee3,FromRoom_name:_0x34b448,to_warehouse:_0x396ed6,ToRoom_name:_0x4a9dc2}=_0xc71699[_0x1ab4dc(0x254)],_0x1a1f2f=await transfers['findById']({'_id':_0x32949a}),_0x47e772=_0x1a1f2f[_0x1ab4dc(0x198)]['map'](async _0x4d1690=>{var _0x10ab4e=_0x1ab4dc;if(_0x4d1690['to_quantity']>0x0){var _0x746ad3=await warehouse[_0x10ab4e(0x207)]({'name':_0x1a1f2f[_0x10ab4e(0x1fb)],'room':_0x4d1690[_0x10ab4e(0x217)],'warehouse_category':_0x10ab4e(0x186)});const _0xdfcbff=_0x746ad3[_0x10ab4e(0x24e)][_0x10ab4e(0x19f)](_0x35b18c=>{var _0x1f6fbb=_0x10ab4e;_0x35b18c[_0x1f6fbb(0x270)]==_0x4d1690[_0x1f6fbb(0x270)]&&_0x35b18c[_0x1f6fbb(0x191)]==_0x4d1690[_0x1f6fbb(0x19e)]&&_0x35b18c['type']==_0x4d1690['from_types']&&_0x35b18c[_0x1f6fbb(0x242)]==_0x4d1690[_0x1f6fbb(0x19b)]&&_0x35b18c[_0x1f6fbb(0x1f6)]==_0x4d1690['from_bay']&&_0x35b18c[_0x1f6fbb(0x26f)]==_0x4d1690['from_rack']&&_0x35b18c['storage']==_0x4d1690[_0x1f6fbb(0x258)]&&_0x35b18c['expiry_date']==_0x4d1690['expiry_date']&&_0x35b18c[_0x1f6fbb(0x221)]==_0x4d1690[_0x1f6fbb(0x221)]&&_0x35b18c['production_date']==_0x4d1690[_0x1f6fbb(0x22a)]&&_0x35b18c[_0x1f6fbb(0x1c2)]==_0x4d1690['from_invoice']&&_0x35b18c[_0x1f6fbb(0x181)]==_0x4d1690[_0x1f6fbb(0x1b4)]&&(_0x35b18c[_0x1f6fbb(0x200)]=_0x35b18c[_0x1f6fbb(0x200)]-_0x4d1690[_0x1f6fbb(0x21a)]);});}return _0x746ad3;});Promise[_0x1ab4dc(0x1df)](_0x47e772)['then'](async _0x262778=>{var _0x5f416a=_0x1ab4dc;try{for(const _0x2c760 of _0x262778){await _0x2c760[_0x5f416a(0x1ff)]();}try{const _0x3aa253=_0x1a1f2f[_0x5f416a(0x198)][_0x5f416a(0x19f)](async _0xb1fe36=>{var _0x3e586a=_0x5f416a;if(_0xb1fe36[_0x3e586a(0x21a)]>0x0){var _0x486a07=await warehouse['findOne']({'name':_0x1a1f2f[_0x3e586a(0x208)],'room':_0xb1fe36[_0x3e586a(0x228)],'warehouse_category':_0x3e586a(0x186)}),_0xa172dd=0x0;const _0xba41a6=_0x486a07['product_details'][_0x3e586a(0x19f)](_0x54fb4d=>{var _0x922b44=_0x3e586a;_0x54fb4d[_0x922b44(0x270)]==_0xb1fe36['product_name']&&_0x54fb4d[_0x922b44(0x191)]==_0xb1fe36[_0x922b44(0x1ad)]&&_0x54fb4d[_0x922b44(0x1ca)]==_0xb1fe36[_0x922b44(0x1c0)]&&_0x54fb4d['bin']==_0xb1fe36[_0x922b44(0x1cd)]&&_0x54fb4d['bay']==_0xb1fe36[_0x922b44(0x19c)]&&_0x54fb4d[_0x922b44(0x26f)]==_0xb1fe36[_0x922b44(0x26f)]&&_0x54fb4d['storage']==_0xb1fe36[_0x922b44(0x21f)]&&_0x54fb4d[_0x922b44(0x266)]==_0xb1fe36[_0x922b44(0x266)]&&_0x54fb4d[_0x922b44(0x221)]==_0xb1fe36[_0x922b44(0x221)]&&_0x54fb4d[_0x922b44(0x22a)]==_0xb1fe36['production_date']&&_0x54fb4d['invoice']==_0xb1fe36[_0x922b44(0x262)]&&(_0x54fb4d[_0x922b44(0x200)]=_0x54fb4d[_0x922b44(0x200)]+_0xb1fe36[_0x922b44(0x21a)],_0xa172dd++);});_0xa172dd=='0'&&(_0x486a07[_0x3e586a(0x24e)]=_0x486a07[_0x3e586a(0x24e)]['concat']({'product_name':_0xb1fe36[_0x3e586a(0x270)],'product_stock':_0xb1fe36[_0x3e586a(0x21a)],'bay':_0xb1fe36[_0x3e586a(0x19c)],'bin':_0xb1fe36['to_bin'],'type':_0xb1fe36[_0x3e586a(0x1c0)],'floorlevel':_0xb1fe36[_0x3e586a(0x1ad)],'storage':_0xb1fe36[_0x3e586a(0x21f)],'rack':_0xb1fe36[_0x3e586a(0x26f)],'product_code':_0xb1fe36['product_code'],'primary_code':_0xb1fe36[_0x3e586a(0x1d8)],'secondary_code':_0xb1fe36[_0x3e586a(0x211)],'maxProducts':_0xb1fe36[_0x3e586a(0x265)],'storage':_0xb1fe36['storage'],'rack':_0xb1fe36[_0x3e586a(0x26f)],'expiry_date':_0xb1fe36[_0x3e586a(0x266)],'maxPerUnit':_0xb1fe36[_0x3e586a(0x18b)],'batch_code':_0xb1fe36['batch_code'],'production_date':_0xb1fe36[_0x3e586a(0x22a)]}));}return _0x486a07;});Promise[_0x5f416a(0x1df)](_0x3aa253)[_0x5f416a(0x1b7)](async _0x444dd0=>{var _0x5be376=_0x5f416a;try{for(const _0xa3802c of _0x444dd0){await warehouse[_0x5be376(0x1b6)]({'_id':_0xa3802c[_0x5be376(0x181)]},{'$addToSet':{'product_details':{'$each':_0xa3802c[_0x5be376(0x24e)]}}});}_0x1a1f2f['finalize']=_0x5be376(0x213);const _0x5f1a94=await _0x1a1f2f[_0x5be376(0x1ff)](),_0x377783=await master_shop['find'](),_0x544b41=await email_settings['findOne'](),_0x140d00=await supervisor_settings[_0x5be376(0x238)]();var _0x23d7a4=_0x1a1f2f[_0x5be376(0x198)],_0x207909='',_0x35a138;for(_0x35a138 in _0x23d7a4){_0x207909+=_0x5be376(0x1c7)+_0x5be376(0x236)+_0x23d7a4[_0x35a138][_0x5be376(0x270)]+_0x5be376(0x1e2)+_0x5be376(0x236)+_0x23d7a4[_0x35a138][_0x5be376(0x205)]+_0x5be376(0x1e2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x23d7a4[_0x35a138]['to_quantity']+_0x5be376(0x1e2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x23d7a4[_0x35a138]['unit']+_0x5be376(0x1e2)+_0x5be376(0x236)+_0x23d7a4[_0x35a138][_0x5be376(0x187)]+_0x5be376(0x1e2)+_0x5be376(0x236)+_0x1a1f2f['to_warehouse']+'</td>'+_0x5be376(0x236)+_0x23d7a4[_0x35a138][_0x5be376(0x228)]+_0x5be376(0x1e2)+_0x5be376(0x236)+_0x23d7a4[_0x35a138]['storage']+_0x23d7a4[_0x35a138][_0x5be376(0x26f)]+_0x23d7a4[_0x35a138]['to_bay']+_0x23d7a4[_0x35a138][_0x5be376(0x1cd)]+_0x23d7a4[_0x35a138][_0x5be376(0x1c0)][0x0]+_0x23d7a4[_0x35a138]['to_floorlevel']+'</td>','</tr>';}let _0x25eb78=nodemailer[_0x5be376(0x1a2)]({'host':_0x544b41[_0x5be376(0x1b0)],'port':Number(_0x544b41[_0x5be376(0x241)]),'secure':![],'auth':{'user':_0x544b41[_0x5be376(0x209)],'pass':_0x544b41[_0x5be376(0x1ed)]}}),_0x3757fb={'from':_0x544b41[_0x5be376(0x209)],'to':_0x140d00[0x0][_0x5be376(0x1bb)],'subject':_0x5be376(0x194),'attachments':[{'filename':_0x5be376(0x261),'path':__dirname+_0x5be376(0x1d7)+_0x5be376(0x1d2)+_0x377783[0x0]['image'],'cid':_0x5be376(0x1e0)}],'html':_0x5be376(0x1d4)+_0x5be376(0x1f8)+'</head><body>'+_0x5be376(0x269)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x5be376(0x269)+_0x5be376(0x210)+_0x5be376(0x17f)+_0x5be376(0x269)+'<h2>\x20'+_0x377783[0x0][_0x5be376(0x192)]+_0x5be376(0x1a4)+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x5be376(0x269)+_0x5be376(0x23c)+_0x5be376(0x1d6)+_0x1a1f2f[_0x5be376(0x1c2)]+'\x20'+_0x5be376(0x1be)+_0x5be376(0x1b9)+_0x1a1f2f['date']+'\x20'+_0x5be376(0x1f0)+'</h5>'+_0x5be376(0x17f)+_0x5be376(0x26d)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x5be376(0x25d)+_0x5be376(0x1db)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x5be376(0x196)+_0x5be376(0x251)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x5be376(0x183)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x207909+'\x20'+'</tbody>'+_0x5be376(0x1b3)+_0x5be376(0x269)+_0x5be376(0x22d)+_0x5be376(0x1a1)+_0x377783[0x0][_0x5be376(0x192)]+'</h5>'+_0x5be376(0x17f)+'</div>'+'</body></html>'};_0x25eb78[_0x5be376(0x263)](_0x3757fb,function(_0x3f1df8,_0x312182){var _0x5d309f=_0x5be376;_0x3f1df8?(console[_0x5d309f(0x239)](_0x3f1df8),console[_0x5d309f(0x239)]('Error\x20Occurs')):console['log'](_0x5d309f(0x216));}),_0xc71699[_0x5be376(0x240)](_0x5be376(0x234),_0x5be376(0x1c3)),_0x6de802[_0x5be376(0x1f1)](_0x5be376(0x21c)+_0x5f1a94[_0x5be376(0x181)]);}catch(_0x2a037c){console['error'](_0x2a037c),_0x6de802[_0x5be376(0x20c)](0x1f4)[_0x5be376(0x20a)]({'Perror':_0x5be376(0x19d),'message':_0x2a037c['message']});}})[_0x5f416a(0x1a7)](_0x537008=>{var _0xbe89c5=_0x5f416a;console['error'](_0x537008),_0x6de802['status'](0x1f4)[_0xbe89c5(0x20a)]({'Perror':_0xbe89c5(0x1ce)});});}catch(_0x329498){_0x6de802['json'](_0x329498);}}catch(_0x3a60a7){console[_0x5f416a(0x203)](_0x3a60a7),_0x6de802[_0x5f416a(0x20c)](0x1f4)[_0x5f416a(0x20a)]({'Merror':_0x5f416a(0x19d),'Message':_0x3a60a7[_0x5f416a(0x1ab)]});}})[_0x1ab4dc(0x1a7)](_0x2af4ea=>{var _0x50e0ef=_0x1ab4dc;console[_0x50e0ef(0x203)](_0x2af4ea),_0x6de802[_0x50e0ef(0x20c)](0x1f4)[_0x50e0ef(0x20a)]({'Merror':_0x50e0ef(0x1ce)});});}catch(_0x26e07a){console[_0x1ab4dc(0x239)](_0x26e07a);}});function BayBinSelected(_0x3794c3,_0x19057c){var _0x40428b=a0_0x43761f,_0xf69e8f=[],_0x4f0585=[],_0x535f7e=[],_0x68efd6=[],_0xce9910=[],_0x291f7d=[];let _0x21e4b1=[];if(_0x3794c3==_0x40428b(0x244))switch(_0x19057c){case _0x40428b(0x1ee):_0xf69e8f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4f0585=[0x1,0x2],_0x68efd6=[0x1,0x2,0x3,0x4,0x5],_0x535f7e=[_0x40428b(0x204),_0x40428b(0x245)],_0xce9910=['D'],_0x291f7d=['A'];break;case _0x40428b(0x1f3):_0xf69e8f=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4f0585=[0x1,0x2],_0x68efd6=[0x1,0x2,0x3,0x4,0x5],_0x535f7e=[_0x40428b(0x204),_0x40428b(0x245)],_0xce9910=['D'],_0x291f7d=['B'];break;case'Shelves':_0xf69e8f=[0x0],_0x4f0585=[0x0],_0x68efd6=[0x1,0x2,0x3,0x4,0x5],_0x535f7e=['Floor'],_0xce9910=['D'],_0x291f7d=['S'];break;case _0x40428b(0x20b):_0xf69e8f=[0x0],_0x4f0585=[0x0],_0x68efd6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x535f7e=['Floor'],_0xce9910=['D'],_0x291f7d=['R'];break;}else{if(_0x3794c3==_0x40428b(0x18f))switch(_0x19057c){case _0x40428b(0x1ee):_0xf69e8f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4f0585=['B','F'],_0x68efd6=[0x1,0x2,0x3,0x4,0x5],_0x535f7e=[_0x40428b(0x204),'Floor'],_0xce9910=['C'],_0x291f7d=['A'];break;case _0x40428b(0x1f3):_0xf69e8f=[0x5,0x4,0x3,0x2,0x1],_0x4f0585=['F','B','S'],_0x68efd6=[0x1,0x2,0x3,0x4,0x5],_0x535f7e=[_0x40428b(0x204),'Floor'],_0xce9910=['C'],_0x291f7d=['B'];break;case _0x40428b(0x215):_0xf69e8f=[0x1,0x2,0x3,0x4,0x5],_0x4f0585=['B','F','S'],_0x68efd6=[0x5,0x4,0x3,0x2,0x1],_0x535f7e=['Level',_0x40428b(0x245)],_0xce9910=['C'],_0x291f7d=['C'];break;case _0x40428b(0x233):_0xf69e8f=[0x5,0x4,0x3,0x2,0x1],_0x4f0585=['F','B','S'],_0x68efd6=[0x1,0x2,0x3,0x4,0x5],_0x535f7e=[_0x40428b(0x204),_0x40428b(0x245)],_0xce9910=['C'],_0x291f7d=['D'];break;case _0x40428b(0x272):_0xf69e8f=[0x4,0x3,0x2,0x1],_0x4f0585=[0x1,0x2],_0x68efd6=[0x1,0x2,0x3,0x4,0x5],_0x535f7e=[_0x40428b(0x204),'Floor'],_0xce9910=['C'],_0x291f7d=['E'];break;case _0x40428b(0x253):_0xf69e8f=[0x1,0x2,0x3],_0x4f0585=[0x1,0x2],_0x68efd6=[0x1,0x2,0x3,0x4,0x5],_0x535f7e=['Level'],_0xce9910=['C'],_0x291f7d=['F'];break;}}return{'levels':_0xf69e8f,'Isle':_0x4f0585,'rack':_0x68efd6,'type':_0x535f7e,'storage':_0xce9910,'rak':_0x291f7d};}router[a0_0x43761f(0x1dd)](a0_0x43761f(0x26c),auth,async(_0x222020,_0x50a8d3)=>{var _0x29c354=a0_0x43761f;try{const {username:_0x987a77,email:_0x514555,role:_0x224ac4}=_0x222020[_0x29c354(0x1e4)],_0x559db2=_0x222020[_0x29c354(0x1e4)],_0x5839e4=await profile[_0x29c354(0x207)]({'email':_0x559db2['email']}),_0x24de05=await master_shop[_0x29c354(0x238)](),_0x2ef4a3=await transfers['findById'](_0x222020['params']['id']);let _0x2dbd6b;if(_0x559db2['role']==_0x29c354(0x1b8)){const _0x5d3307=await staff['findOne']({'email':_0x559db2[_0x29c354(0x209)]});_0x2dbd6b=await warehouse[_0x29c354(0x23a)]([{'$match':{'status':'Enabled','name':_0x5d3307[_0x29c354(0x1aa)],'warehouse_category':_0x29c354(0x186)}},{'$group':{'_id':_0x29c354(0x235),'name':{'$first':_0x29c354(0x235)}}}]);}else _0x2dbd6b=await warehouse[_0x29c354(0x23a)]([{'$match':{'status':'Enabled','warehouse_category':_0x29c354(0x186)}},{'$group':{'_id':'$name','name':{'$first':_0x29c354(0x235)}}}]);const _0x1f587d=await warehouse[_0x29c354(0x23a)]([{'$match':{'name':_0x2ef4a3[_0x29c354(0x1fb)],'warehouse_category':_0x29c354(0x186)}},{'$unwind':_0x29c354(0x224)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x29c354(0x24d)},'bay':{'$first':_0x29c354(0x227)},'bin':{'$first':_0x29c354(0x20f)},'type':{'$first':_0x29c354(0x1f2)},'floorlevel':{'$first':_0x29c354(0x21d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x29c354(0x1bd)},'rack':{'$first':_0x29c354(0x25f)},'expiry_date':{'$first':_0x29c354(0x1fa)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x29c354(0x1b2)}}}]),_0x2d6933=await product[_0x29c354(0x238)]({}),_0x65350a=BayBinSelected(_0x2ef4a3[_0x29c354(0x208)],_0x2ef4a3[_0x29c354(0x26e)]);if(_0x24de05[0x0][_0x29c354(0x248)]==_0x29c354(0x273)){var _0x5cbdf4=users[_0x29c354(0x1e3)];console[_0x29c354(0x239)](_0x5cbdf4);}else{if(_0x24de05[0x0][_0x29c354(0x248)]==_0x29c354(0x1d3))var _0x5cbdf4=users[_0x29c354(0x1d3)];else{if(_0x24de05[0x0]['language']==_0x29c354(0x220))var _0x5cbdf4=users[_0x29c354(0x220)];else{if(_0x24de05[0x0][_0x29c354(0x248)]==_0x29c354(0x21e))var _0x5cbdf4=users[_0x29c354(0x21e)];else{if(_0x24de05[0x0][_0x29c354(0x248)]==_0x29c354(0x1da))var _0x5cbdf4=users[_0x29c354(0x1da)];else{if(_0x24de05[0x0]['language']=='Portuguese\x20(BR)')var _0x5cbdf4=users['Portuguese'];else{if(_0x24de05[0x0][_0x29c354(0x248)]==_0x29c354(0x195))var _0x5cbdf4=users[_0x29c354(0x195)];else{if(_0x24de05[0x0][_0x29c354(0x248)]==_0x29c354(0x1af))var _0x5cbdf4=users[_0x29c354(0x256)];}}}}}}}_0x50a8d3[_0x29c354(0x212)](_0x29c354(0x226),{'success':_0x222020[_0x29c354(0x240)](_0x29c354(0x234)),'errors':_0x222020[_0x29c354(0x240)]('errors'),'role':_0x559db2,'profile':_0x5839e4,'master_shop':_0x24de05,'warehouse':_0x2dbd6b,'transfer':_0x2ef4a3,'stock':_0x1f587d,'unit':_0x2d6933,'language':_0x5cbdf4});}catch(_0x1f9b83){console[_0x29c354(0x239)](_0x1f9b83);}}),router['post'](a0_0x43761f(0x26c),auth,async(_0x28d19e,_0x922bb8)=>{var _0x3f21cc=a0_0x43761f;try{const _0x581263=_0x28d19e[_0x3f21cc(0x1c4)]['id'],_0x5139fa=await transfers[_0x3f21cc(0x1ea)](_0x581263);_0x922bb8[_0x3f21cc(0x20a)](_0x28d19e[_0x3f21cc(0x254)]);return;const {date:_0x44886a,from_warehouse:_0x31a7db,FromRoom_name:_0x55b710,to_warehouse:_0x564ed5,ToRoom_name:_0x44e728,prod_name:_0x498ea6,from_prod_qty:_0x101e26,from_prod_level:_0x598e75,from_prod_isle:_0x3dab32,from_prod_pallet:_0x360c29,to_prod_qty:_0x54fd2a,to_prod_level:_0x5a0f6b,to_prod_isle:_0x2e6d00,to_prod_pallet:_0x5cede4,primary_code:_0x37ef8d,secondary_code:_0x382400,product_code3:_0x2d3e22,note:_0x1ca048,invoice:_0x52855a,expiry_date:_0x2e2260}=_0x28d19e[_0x3f21cc(0x254)];if(typeof _0x498ea6==_0x3f21cc(0x1e9))var _0x5eae88=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x1bf)]],_0x474a20=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x22e)]],_0x425f00=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x1e8)]],_0x4e6cd8=[_0x28d19e[_0x3f21cc(0x254)]['from_prod_isle']],_0x56a9a4=[_0x28d19e['body']['from_prod_pallet']],_0x38c9a2=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x219)]],_0x33568e=[_0x28d19e[_0x3f21cc(0x254)]['to_prod_qty']],_0x1ea0e5=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x19a)]],_0x5d6ba0=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x247)]],_0x12bbd0=[_0x28d19e[_0x3f21cc(0x254)]['to_prod_pallet']],_0x5e297c=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x1c0)]],_0x5044c9=[_0x28d19e['body'][_0x3f21cc(0x21f)]],_0x1dd946=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x214)]],_0xba4495=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x1d8)]],_0x2195ed=[_0x28d19e[_0x3f21cc(0x254)]['secondary_code']],_0x35d724=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x182)]],_0x5e9a85=[_0x28d19e[_0x3f21cc(0x254)]['MaxStocks_data2']],_0x15eca6=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x1f9)]],_0x258114=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x187)]],_0x59dc7d=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x221)]],_0x5c28b7=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x266)]],_0x35531e=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x258)]],_0x53554d=[_0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x184)]];else var _0x5eae88=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x1bf)]],_0x5044c9=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x21f)]],_0x1dd946=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x214)]],_0x38c9a2=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x219)]],_0x5e297c=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x1c0)]],_0x474a20=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x22e)]],_0x425f00=[..._0x28d19e[_0x3f21cc(0x254)]['from_prod_level']],_0x4e6cd8=[..._0x28d19e['body'][_0x3f21cc(0x1c5)]],_0x56a9a4=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x1f5)]],_0x33568e=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x222)]],_0x1ea0e5=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x19a)]],_0x5d6ba0=[..._0x28d19e[_0x3f21cc(0x254)]['to_prod_isle']],_0x12bbd0=[..._0x28d19e['body'][_0x3f21cc(0x20d)]],_0xba4495=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x1d8)]],_0x2195ed=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x211)]],_0x35d724=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x182)]],_0x5e9a85=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x18a)]],_0x15eca6=[..._0x28d19e['body'][_0x3f21cc(0x1f9)]],_0x258114=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x187)]],_0x59dc7d=[..._0x28d19e[_0x3f21cc(0x254)]['batch_code']],_0x5c28b7=[..._0x28d19e['body'][_0x3f21cc(0x266)]],_0x35531e=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x258)]],_0x53554d=[..._0x28d19e[_0x3f21cc(0x254)][_0x3f21cc(0x184)]];const _0x4807d3=_0x5eae88['map'](_0x319ec8=>{return _0x319ec8={'product_name':_0x319ec8};});_0x474a20[_0x3f21cc(0x1a5)]((_0x2aaae5,_0x4f2cb7)=>{var _0x209e6d=_0x3f21cc;_0x4807d3[_0x4f2cb7][_0x209e6d(0x189)]=_0x2aaae5;}),_0x425f00['forEach']((_0x5c42fe,_0x27f5fb)=>{var _0x2b2635=_0x3f21cc;_0x4807d3[_0x27f5fb][_0x2b2635(0x1c9)]=_0x5c42fe;}),_0x4e6cd8['forEach']((_0x2d22ef,_0x562eca)=>{_0x4807d3[_0x562eca]['from_bin']=_0x2d22ef;}),_0x56a9a4[_0x3f21cc(0x1a5)]((_0x57f260,_0x4bdf7f)=>{var _0x8fb3aa=_0x3f21cc;_0x4807d3[_0x4bdf7f][_0x8fb3aa(0x19e)]=_0x57f260;}),_0x33568e[_0x3f21cc(0x1a5)]((_0x2568cf,_0x496a72)=>{var _0xced088=_0x3f21cc;_0x4807d3[_0x496a72][_0xced088(0x21a)]=_0x2568cf;}),_0x1ea0e5[_0x3f21cc(0x1a5)]((_0x4873e6,_0x52c808)=>{var _0xa8c6e6=_0x3f21cc;_0x4807d3[_0x52c808][_0xa8c6e6(0x19c)]=_0x4873e6;}),_0x5d6ba0[_0x3f21cc(0x1a5)]((_0x58e302,_0x1c33fa)=>{var _0x3bb664=_0x3f21cc;_0x4807d3[_0x1c33fa][_0x3bb664(0x1cd)]=_0x58e302;}),_0x12bbd0['forEach']((_0x26fa19,_0x2569fa)=>{var _0x314315=_0x3f21cc;_0x4807d3[_0x2569fa][_0x314315(0x1ad)]=_0x26fa19;}),_0xba4495[_0x3f21cc(0x1a5)]((_0xaeb0cf,_0x4a1785)=>{var _0x184b4b=_0x3f21cc;_0x4807d3[_0x4a1785][_0x184b4b(0x1d8)]=_0xaeb0cf;}),_0x2195ed[_0x3f21cc(0x1a5)]((_0xa77c97,_0x4d5dbb)=>{var _0x354487=_0x3f21cc;_0x4807d3[_0x4d5dbb][_0x354487(0x211)]=_0xa77c97;}),_0x35d724[_0x3f21cc(0x1a5)]((_0x46bd2f,_0x14f7fb)=>{var _0x387fd9=_0x3f21cc;_0x4807d3[_0x14f7fb][_0x387fd9(0x205)]=_0x46bd2f;}),_0x5e9a85[_0x3f21cc(0x1a5)]((_0x1077ba,_0x1732ed)=>{var _0x211e7d=_0x3f21cc;_0x4807d3[_0x1732ed][_0x211e7d(0x265)]=_0x1077ba;}),_0x15eca6['forEach']((_0x43d820,_0xddbd55)=>{var _0x1800b6=_0x3f21cc;_0x4807d3[_0xddbd55][_0x1800b6(0x1f9)]=_0x43d820;}),_0x258114['forEach']((_0xa39bae,_0x422a25)=>{_0x4807d3[_0x422a25]['secondary_unit']=_0xa39bae;}),_0x59dc7d[_0x3f21cc(0x1a5)]((_0x5c113d,_0x44b197)=>{_0x4807d3[_0x44b197]['batch_code']=_0x5c113d;}),_0x5c28b7[_0x3f21cc(0x1a5)]((_0x564ea3,_0x3d89bc)=>{var _0x54e719=_0x3f21cc;_0x4807d3[_0x3d89bc][_0x54e719(0x266)]=_0x564ea3;}),_0x5044c9[_0x3f21cc(0x1a5)]((_0x233722,_0x1d7869)=>{var _0x21c5d6=_0x3f21cc;_0x4807d3[_0x1d7869][_0x21c5d6(0x21f)]=_0x233722;}),_0x1dd946[_0x3f21cc(0x1a5)]((_0x527d5f,_0x1aeef3)=>{var _0x7763a3=_0x3f21cc;_0x4807d3[_0x1aeef3][_0x7763a3(0x26f)]=_0x527d5f;}),_0x38c9a2['forEach']((_0x45a172,_0x5da9a4)=>{var _0x43435d=_0x3f21cc;_0x4807d3[_0x5da9a4][_0x43435d(0x219)]=_0x45a172;}),_0x5e297c[_0x3f21cc(0x1a5)]((_0x69c3e5,_0x1c0ad5)=>{var _0x70bd5c=_0x3f21cc;_0x4807d3[_0x1c0ad5][_0x70bd5c(0x1c0)]=_0x69c3e5;}),_0x35531e[_0x3f21cc(0x1a5)]((_0x57fa86,_0x1dc5f7)=>{var _0x1888a5=_0x3f21cc;_0x4807d3[_0x1dc5f7][_0x1888a5(0x258)]=_0x57fa86;}),_0x53554d['forEach']((_0xf1e045,_0x9cfb35)=>{_0x4807d3[_0x9cfb35]['from_rack']=_0xf1e045;});const _0x4c1448=_0x4807d3[_0x3f21cc(0x1c1)](_0x5b8f67=>_0x5b8f67[_0x3f21cc(0x21a)]!=='0'&&_0x5b8f67[_0x3f21cc(0x21a)]!==''||_0x5b8f67[_0x3f21cc(0x1ad)]!=='0'&&_0x5b8f67[_0x3f21cc(0x1ad)]!=='');var _0x6c251e=0x0;_0x4c1448[_0x3f21cc(0x1a5)](_0x2733e5=>{var _0x59313c=_0x3f21cc;parseInt(_0x2733e5[_0x59313c(0x189)])<parseInt(_0x2733e5[_0x59313c(0x21a)])&&_0x6c251e++;});if(_0x6c251e!=0x0)return _0x28d19e[_0x3f21cc(0x240)](_0x3f21cc(0x206),_0x3f21cc(0x1d9)),_0x922bb8[_0x3f21cc(0x1f1)](_0x3f21cc(0x1d0));const _0x9e63b9=await warehouse[_0x3f21cc(0x207)]({'name':_0x5139fa['from_warehouse'],'room':_0x5139fa['from_room']});_0x5139fa[_0x3f21cc(0x198)][_0x3f21cc(0x1a5)](_0x42d719=>{var _0x3d78db=_0x3f21cc;if(_0x42d719['to_quantity']>0x0){const _0x3e29ab=_0x9e63b9[_0x3d78db(0x24e)][_0x3d78db(0x19f)](_0x423bb4=>{var _0x147cff=_0x3d78db;_0x423bb4[_0x147cff(0x270)]==_0x42d719[_0x147cff(0x270)]&&_0x423bb4['floorlevel']==_0x42d719['from_floorlevel']&&_0x423bb4[_0x147cff(0x1ca)]==_0x42d719[_0x147cff(0x219)]&&_0x423bb4[_0x147cff(0x242)]==_0x42d719['from_bin']&&_0x423bb4[_0x147cff(0x1f6)]==_0x42d719[_0x147cff(0x1c9)]&&_0x423bb4[_0x147cff(0x26f)]==_0x42d719[_0x147cff(0x1fe)]&&_0x423bb4[_0x147cff(0x21f)]==_0x42d719[_0x147cff(0x258)]&&(_0x423bb4['product_stock']=parseInt(_0x423bb4[_0x147cff(0x200)])+parseInt(_0x42d719[_0x147cff(0x21a)]));});}}),await _0x9e63b9['save']();const _0x39f7b3=await warehouse[_0x3f21cc(0x207)]({'name':_0x5139fa[_0x3f21cc(0x208)],'room':_0x5139fa['to_room']});_0x5139fa['product']['forEach'](_0x41033c=>{if(_0x41033c['to_quantity']>0x0){const _0x88a4b=_0x39f7b3['product_details']['map'](_0x2028eb=>{var _0x31517b=a0_0x9453;_0x2028eb[_0x31517b(0x270)]==_0x41033c[_0x31517b(0x270)]&&_0x2028eb['floorlevel']==_0x41033c['to_floorlevel']&&_0x2028eb[_0x31517b(0x1ca)]==_0x41033c['to_types']&&_0x2028eb['bin']==_0x41033c['to_bin']&&_0x2028eb[_0x31517b(0x1f6)]==_0x41033c[_0x31517b(0x19c)]&&_0x2028eb[_0x31517b(0x26f)]==_0x41033c['rack']&&_0x2028eb[_0x31517b(0x21f)]==_0x41033c['storage']&&(_0x2028eb[_0x31517b(0x200)]=parseInt(_0x2028eb[_0x31517b(0x200)])-parseInt(_0x41033c[_0x31517b(0x21a)]));});}}),await _0x39f7b3['save'](),_0x5139fa['date']=_0x44886a,_0x5139fa[_0x3f21cc(0x1fb)]=_0x31a7db,_0x5139fa[_0x3f21cc(0x208)]=_0x564ed5,_0x5139fa[_0x3f21cc(0x198)]=_0x4c1448,_0x5139fa['note']=_0x1ca048,_0x5139fa['invoice']=_0x52855a;const _0x430720=await _0x5139fa['save']();console[_0x3f21cc(0x239)](_0x430720);const _0xfade3a=await warehouse[_0x3f21cc(0x207)]({'name':_0x31a7db,'room':_0x55b710});_0x430720[_0x3f21cc(0x198)][_0x3f21cc(0x1a5)](_0x11c4ba=>{var _0x594a9c=_0x3f21cc;if(_0x11c4ba[_0x594a9c(0x21a)]>0x0){const _0x346bc1=_0xfade3a[_0x594a9c(0x24e)][_0x594a9c(0x19f)](_0x57796f=>{var _0x3c797c=_0x594a9c;_0x57796f[_0x3c797c(0x270)]==_0x11c4ba['product_name']&&_0x57796f['floorlevel']==_0x11c4ba[_0x3c797c(0x19e)]&&_0x57796f[_0x3c797c(0x1ca)]==_0x11c4ba['from_types']&&_0x57796f[_0x3c797c(0x242)]==_0x11c4ba['from_bin']&&_0x57796f[_0x3c797c(0x1f6)]==_0x11c4ba['from_bay']&&_0x57796f[_0x3c797c(0x26f)]==_0x11c4ba[_0x3c797c(0x1fe)]&&_0x57796f[_0x3c797c(0x21f)]==_0x11c4ba['from_storage']&&(_0x57796f['product_stock']=parseInt(_0x57796f['product_stock'])-parseInt(_0x11c4ba['to_quantity']));});}}),await _0xfade3a['save']();const _0x14c108=await warehouse[_0x3f21cc(0x207)]({'name':_0x564ed5,'room':_0x44e728});_0x430720[_0x3f21cc(0x198)][_0x3f21cc(0x1a5)](_0x31035e=>{var _0x170f66=_0x3f21cc;if(_0x31035e['to_quantity']>0x0){var _0x10937b=0x0;const _0x5e7a01=_0x14c108[_0x170f66(0x24e)][_0x170f66(0x19f)](_0x370b9a=>{var _0x3581ef=_0x170f66;_0x370b9a[_0x3581ef(0x270)]==_0x31035e['product_name']&&_0x370b9a[_0x3581ef(0x191)]==_0x31035e[_0x3581ef(0x1ad)]&&_0x370b9a[_0x3581ef(0x1ca)]==_0x31035e[_0x3581ef(0x1c0)]&&_0x370b9a['bin']==_0x31035e['to_bin']&&_0x370b9a[_0x3581ef(0x1f6)]==_0x31035e['to_bay']&&_0x370b9a[_0x3581ef(0x26f)]==_0x31035e[_0x3581ef(0x26f)]&&_0x370b9a['storage']==_0x31035e[_0x3581ef(0x21f)]&&(_0x370b9a[_0x3581ef(0x200)]=parseInt(_0x370b9a[_0x3581ef(0x200)])+parseInt(_0x31035e[_0x3581ef(0x21a)]),_0x10937b++);});_0x10937b=='0'&&(_0x14c108['product_details']=_0x14c108['product_details']['concat']({'product_name':_0x31035e[_0x170f66(0x270)],'product_stock':_0x31035e[_0x170f66(0x21a)],'bay':_0x31035e[_0x170f66(0x19c)],'bin':_0x31035e[_0x170f66(0x1cd)],'type':_0x31035e[_0x170f66(0x1c0)],'floorlevel':_0x31035e[_0x170f66(0x1ad)],'storage':_0x31035e[_0x170f66(0x21f)],'rack':_0x31035e[_0x170f66(0x26f)],'product_code':_0x31035e[_0x170f66(0x205)],'primary_code':_0x31035e['primary_code'],'secondary_code':_0x31035e[_0x170f66(0x211)],'maxProducts':_0x31035e[_0x170f66(0x265)],'storage':_0x31035e[_0x170f66(0x21f)],'rack':_0x31035e['rack']}));}}),await _0x14c108[_0x3f21cc(0x1ff)](),_0x28d19e[_0x3f21cc(0x240)](_0x3f21cc(0x234),_0x3f21cc(0x185)),_0x922bb8[_0x3f21cc(0x1f1)](_0x3f21cc(0x1c8));}catch(_0x4ca916){console[_0x3f21cc(0x239)](_0x4ca916);}}),router['post'](a0_0x43761f(0x20e),async(_0x5bd90e,_0x389667)=>{var _0x4942e9=a0_0x43761f;const {FromWareHouse:_0x402da0,FromRoom:_0x378d4d,ToWarehouse:_0x139048,ToRoom:_0xd51ab7,primary_code:_0x13756c,Roomslist:_0x3dee27}=_0x5bd90e[_0x4942e9(0x254)],_0x401975=_0x3dee27[_0x4942e9(0x268)](','),_0x3887a8=[];async function _0x42eea9(_0x55689a){var _0x26e856=_0x4942e9;const _0xa0e9b2=await warehouse['aggregate']([{'$match':{'name':_0x402da0,'room':_0x55689a}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x13756c}},{'$group':{'_id':_0x26e856(0x22b),'name':{'$first':_0x26e856(0x25c)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x26e856(0x249)},'product_code':{'$first':_0x26e856(0x1cf)},'level':{'$first':_0x26e856(0x227)},'isle':{'$first':_0x26e856(0x20f)},'type':{'$first':_0x26e856(0x1f2)},'pallet':{'$first':_0x26e856(0x21d)},'unit':{'$first':_0x26e856(0x1ef)},'secondary_unit':{'$first':_0x26e856(0x1f4)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x26e856(0x25f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x26e856(0x229)},'batch_code':{'$first':_0x26e856(0x1e5)},'maxPerUnit':{'$first':_0x26e856(0x180)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x26e856(0x1b2)},'maxProducts':{'$first':_0x26e856(0x23b)},'invoice_product':{'$first':_0x26e856(0x26b)}}}]),_0x2ac3a2=await warehouse[_0x26e856(0x23a)]([{'$match':{'name':_0x402da0,'room':_0x55689a}},{'$unwind':_0x26e856(0x224)},{'$match':{'product_details.secondary_code':_0x13756c}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x26e856(0x24d)},'primary_code':{'$first':_0x26e856(0x1ae)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x26e856(0x227)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x26e856(0x1f2)},'pallet':{'$first':_0x26e856(0x21d)},'unit':{'$first':_0x26e856(0x1ef)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x26e856(0x1bd)},'rack':{'$first':_0x26e856(0x25f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x26e856(0x229)},'batch_code':{'$first':_0x26e856(0x1e5)},'maxPerUnit':{'$first':_0x26e856(0x180)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x26e856(0x1b2)},'maxProducts':{'$first':_0x26e856(0x23b)},'invoice_product':{'$first':_0x26e856(0x26b)}}}]);if(_0xa0e9b2[_0x26e856(0x18c)]>0x0)_0x3887a8[_0x26e856(0x24c)](_0xa0e9b2);else _0x2ac3a2[_0x26e856(0x18c)]>0x0&&_0x3887a8[_0x26e856(0x24c)](_0x2ac3a2);}const _0x188062=_0x401975[_0x4942e9(0x19f)](_0x794f98=>_0x42eea9(_0x794f98));await Promise[_0x4942e9(0x1df)](_0x188062),_0x389667[_0x4942e9(0x20a)](_0x3887a8);}),router['post'](a0_0x43761f(0x197),async(_0x2e9dbd,_0x587185)=>{var _0x266d0b=a0_0x43761f;try{const {FromWareHouse:_0x545291,FromRoom:_0x1a1995,ToWarehouse:_0x5907f3,ToRoom:_0x4cdd91,secondary_code:_0x5c8cbc}=_0x2e9dbd['body'],_0x394730=await warehouse[_0x266d0b(0x23a)]([{'$match':{'name':_0x545291}},{'$unwind':_0x266d0b(0x224)},{'$match':{'product_details.secondary_code':_0x5c8cbc}},{'$group':{'_id':_0x266d0b(0x22b),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x266d0b(0x1ae)},'secondary_code':{'$first':_0x266d0b(0x249)},'product_code':{'$first':_0x266d0b(0x1cf)},'instock':{'$first':_0x266d0b(0x24d)},'warehouse':{'$first':_0x266d0b(0x235)},'level':{'$first':_0x266d0b(0x1a8)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x266d0b(0x243)},'maxProducts':{'$first':_0x266d0b(0x23b)},'unit':{'$first':_0x266d0b(0x1ef)}}}]);_0x587185[_0x266d0b(0x20c)](0xc8)[_0x266d0b(0x20a)](_0x394730);}catch(_0x580b66){_0x587185[_0x266d0b(0x20c)](0x194)[_0x266d0b(0x20a)]({'message':_0x580b66[_0x266d0b(0x1ab)]});}}),router[a0_0x43761f(0x1a6)](a0_0x43761f(0x193),async(_0x581dfb,_0x23bc8c)=>{var _0x2503f2=a0_0x43761f;try{const {FromWareHouse:_0x1bedea,FromRoom:_0x20bac4,ToWarehouse:_0x5122e7,ToRoom:_0x2179d9,product_code:_0xf11d74}=_0x581dfb[_0x2503f2(0x254)],_0x542e8f=await warehouse['aggregate']([{'$match':{'name':_0x1bedea}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0xf11d74}},{'$group':{'_id':_0x2503f2(0x22b),'name':{'$first':_0x2503f2(0x25c)},'primary_code':{'$first':_0x2503f2(0x1ae)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2503f2(0x1cf)},'instock':{'$first':_0x2503f2(0x24d)},'warehouse':{'$first':_0x2503f2(0x235)},'level':{'$first':_0x2503f2(0x1a8)},'isle':{'$first':_0x2503f2(0x218)},'pallet':{'$first':_0x2503f2(0x243)},'maxProducts':{'$first':_0x2503f2(0x23b)},'unit':{'$first':_0x2503f2(0x1ef)}}}]);_0x23bc8c[_0x2503f2(0x20c)](0xc8)[_0x2503f2(0x20a)](_0x542e8f);}catch(_0x57100c){_0x23bc8c[_0x2503f2(0x20c)](0x194)[_0x2503f2(0x20a)]({'message':_0x57100c[_0x2503f2(0x1ab)]});}}),router[a0_0x43761f(0x1a6)]('/CheckingWarehouse',async(_0x372d5c,_0x3ebae8)=>{var _0x3a4443=a0_0x43761f;const {level:_0x2731df,isle:_0x584c83,pallet:_0x1eb8aa,warehouses:_0x47d057,room:_0x274074}=_0x372d5c[_0x3a4443(0x254)];try{const _0x368d76=await warehouse[_0x3a4443(0x23a)]([{'$match':{'name':_0x47d057,'room':_0x274074}},{'$unwind':_0x3a4443(0x224)},{'$match':{'product_details.level':parseInt(_0x2731df),'product_details.isle':_0x584c83,'product_details.pallet':parseInt(_0x1eb8aa)}},{'$group':{'_id':_0x3a4443(0x22b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x3a4443(0x1a8)},'isle':{'$first':_0x3a4443(0x218)},'pallet':{'$first':_0x3a4443(0x243)},'maxProducts':{'$first':_0x3a4443(0x23b)}}}]);_0x3ebae8['status'](0xc8)['json'](_0x368d76);}catch(_0x2b8124){_0x3ebae8[_0x3a4443(0x20c)](0x194)['json']({'message':_0x2b8124[_0x3a4443(0x1ab)]});}}),module[a0_0x43761f(0x246)]=router;function a0_0x271c(){var _0xb0fbd2=['Raw\x20Materials','secondary_unit','getFullYear','from_quantity','MaxStocks_data2','maxperunit','length','getMonth','1547XeUmLg','COLD\x20STORAGE','10283808GJTgkG','floorlevel','site_title','/barcode_scanner3','Transfer\x20Mail','Chinese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/barcode_scanner2','product','Portuguese','to_prod_level','from_bin','to_bay','An\x20error\x20occurred\x20while\x20saving\x20data.','from_floorlevel','map','Enclosed','<h5>','createTransport','$to_warehouse','\x20</h2>','forEach','post','catch','$product_details.level','8934grCdZq','warehouse','message','ToRoomAssigned','to_floorlevel','$product_details.primary_code','Arabic\x20(ae)','host','add_transfer','$room','</table>','id_transaction_id','Product\x20Transfer\x20successfully','updateOne','then','staff','\x20Order\x20Date\x20:\x20','$product.to_room_name','RMSEmail','Shelves','$product_details.storage','<span\x20style=\x22float:\x20right;\x22>','prod_name','to_types','filter','invoice','Transfer\x20Finalize\x20Successfully','params','from_prod_isle','nodemailer','<tr>','/transfer/view','from_bay','type','role','/preview/:id','to_bin','An\x20error\x20occurred.','$product_details.product_code','back','Router','/upload/','Hindi','<!DOCTYPE\x20html>','3MgvLdQ','\x20Order\x20Number\x20:\x20','/../public','primary_code','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','French','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Portuguese\x20(BR)','get','transfer','all','logo','$finalize','</td>','English','user','$product_details.batch_code','toString','1927342pLPRDC','from_prod_level','string','findById','$_id','5198700HgLDCC','password','Rack\x20A','$product_details.unit','</span>','redirect','$product_details.type','Rack\x20B','$product_details.secondary_unit','from_prod_pallet','bay','1926846GfiUYk','<html><head><title></title>','unit','$product_details.expiry_date','from_warehouse','528Uwssuj','There\x27s\x20a\x20error\x20in\x20this\x20transaction','from_rack','save','product_stock','to_invoice','slice','error','Level','product_code','errors','findOne','to_warehouse','email','json','Receiving\x20Area','status','to_prod_pallet','/barcode_scanner','$product_details.bin','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','secondary_code','render','True','rak','Rack\x20C','Email\x20sent\x20successfully','from_room_name','$product_details.isle','from_types','to_quantity','express','/picking_list/PDF_transfer_rm/','$product_details.floorlevel','Spanish','storage','German','batch_code','to_prod_qty','/transfer/preview/','$product_details','from_invoice','edit_transfer','$product_details.bay','to_room_name','$product_details.production_date','production_date','$product_details._id','Return\x20Rooms','<strong>\x20Regards\x20</strong>','from_prod_qty','id_transaction','../public/language/languages.json','Enabled','RoomAssigned','Rack\x20D','success','$name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','random','find','log','aggregate','$product_details.maxProducts','<h5\x20style=\x22text-align:\x20left;\x22>','$invoice','$date','$isAllowEdit','flash','port','bin','$product_details.pallet','DRY\x20STORAGE','Floor','exports','to_prod_isle','language','$product_details.secondary_code','$product.from_room_name','/view','push','$product_details.product_stock','product_details','$product','edit_transfer_view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','New_Qty_Converted','Rack\x20F','body','\x20<>\x20','Arabic','primary_unit','from_storage','/view/add_transfer','max_per_unit','TRF-','$product_details.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','538204IHlOFD','$product_details.rack','prod_cat','Logo.png','To_invoice','sendMail','master','maxProducts','expiry_date','here','split','<div>','5435szeJpK','$product_details.invoice','/view/:id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','to_room','rack','product_name','$from_warehouse','Rack\x20E','English\x20(US)','</div>','$product_details.maxPerUnit','_id','product_code3','</tr>','from_rak','Transfer\x20Edit\x20Successfully'];a0_0x271c=function(){return _0xb0fbd2;};return a0_0x271c();}