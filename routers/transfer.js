var a0_0x5e910c=a0_0x8ed4;(function(_0x443477,_0x30eda6){var _0x1d94ac=a0_0x8ed4,_0x503d21=_0x443477();while(!![]){try{var _0xe3a128=-parseInt(_0x1d94ac(0x204))/0x1+parseInt(_0x1d94ac(0x253))/0x2+-parseInt(_0x1d94ac(0x234))/0x3*(-parseInt(_0x1d94ac(0x22d))/0x4)+parseInt(_0x1d94ac(0x1b0))/0x5+parseInt(_0x1d94ac(0x19b))/0x6*(parseInt(_0x1d94ac(0x193))/0x7)+-parseInt(_0x1d94ac(0x1c6))/0x8*(parseInt(_0x1d94ac(0x231))/0x9)+-parseInt(_0x1d94ac(0x1de))/0xa;if(_0xe3a128===_0x30eda6)break;else _0x503d21['push'](_0x503d21['shift']());}catch(_0x24a531){_0x503d21['push'](_0x503d21['shift']());}}}(a0_0x4230,0xe11fd));const express=require(a0_0x5e910c(0x248)),app=express(),router=express[a0_0x5e910c(0x1e8)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x5e910c(0x1ac)),auth=require('../middleware/auth'),users=require(a0_0x5e910c(0x1c9)),nodemailer=require(a0_0x5e910c(0x192));function a0_0x4230(){var _0x3cad3c=['<tbody\x20style=\x22text-align:\x20center;\x22>','French','4122635fBGZFz','Rack\x20E','Error\x20Occurs','forEach','catch','There\x27s\x20a\x20error\x20in\x20this\x20transaction','batch_code','<div>','date','$product_details.production_date','body','<h5>','string','$product_details.isle','</tr>','logo','from_bin','bay','push','user','Portuguese\x20(BR)','get','6873368ZbGEYu','from_prod_isle','role','../public/language/languages.json','maxProducts','errors','Spanish','Receiving\x20Area','product','from_rak','to_quantity','edit_transfer_view','English\x20(US)','Logo.png','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','prod_name','\x20Order\x20Date\x20:\x20','TRF-','product_code','findOne','<h2>\x20','<html><head><title></title>','Raw\x20Materials','<h5\x20style=\x22text-align:\x20left;\x22>','6755090ZTCRpV','id_transaction_id','Product\x20Transfer\x20successfully','rack','/barcode_scanner','/view/add_transfer','$product_details','English','$to_warehouse','expiry_date','Router','MaxStocks_data2','email','master','to_bin','secondary_code','True','$_id','length','from_prod_level','$finalize','_id','updateOne','</tbody>','$product_details.batch_code','$product_details.product_stock','to_warehouse','product_name','to_bay','getMonth','RMSEmail','warehouse','Transfer\x20Finalize\x20Successfully','language','</table>','save','Chinese','floorlevel','744364pRCqqX','COLD\x20STORAGE','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.storage','type','</h5>','map','/barcode_scanner2','Floor','to_room','$from_warehouse','$room','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','New_Qty_Converted','\x20Order\x20Number\x20:\x20','params','transfer','findById','$product_details.secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<tr>','success','note','/picking_list/PDF_transfer_rm/','status','Return\x20Rooms','random','rak','createTransport','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.maxPerUnit','to_prod_isle','primary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','from_bay','find','To_invoice','<table\x20style=\x22width:\x20100%\x20!important;\x22>','filter','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$invoice','2095748TUYYwN','invoice','from_room_name','bin','9XmKRkt','edit_transfer','from_quantity','3vTzTjz','secondary_unit','add_transfer','</td>','message','then','Hindi','$product_details.product_name','/CheckingWarehouse','from_prod_pallet','$name','from_warehouse','RoomAssigned','Transfer\x20Mail','Rack\x20A','prod_cat','toString','from_storage','render','error','express','/transfer/preview/','json','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Enabled','$product_details.primary_code','id_transaction','max_per_unit','slice','sendMail','Enclosed','1586198cUQEBo','An\x20error\x20occurred.','Level','staff','$product_details.rack','from_rack','to_types','redirect','getDate','back','from_types','maxperunit','/barcode_scanner3','/preview/:id','ToRoomAssigned','$product_details.bin','log','Rack\x20F','to_invoice','Arabic\x20(ae)','site_title','production_date','from_prod_qty','</div>','$product_details.maxProducts','to_prod_qty','$product_details.type','Portuguese','password','$product_details.pallet','Shelves','all','flash','from_invoice','$product_details.floorlevel','<hr\x20class=\x22my-3\x22>','storage','</thead>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','aggregate','/view/:id','finalize','product_stock','padStart','<span\x20style=\x22float:\x20right;\x22>','post','$product_details.invoice','<strong>\x20Regards\x20</strong>','$product_details.unit','</span>','Arabic','product_details','split','exports','nodemailer','105959gwDiuN','German','to_room_name','unit','to_floorlevel','here','$product','$product_details._id','420ApFPiD','$product.from_room_name','Rack\x20B','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','DRY\x20STORAGE','/transfer/view','primary_code','host','Ambient','concat','$product_details.level','product_code3','$product_details.product_code','\x20<>\x20','$product_details.secondary_code','from_floorlevel','to_prod_level','../models/all_models','$product_details.expiry_date'];a0_0x4230=function(){return _0x3cad3c;};return a0_0x4230();}router[a0_0x5e910c(0x1c5)]('/view',auth,async(_0x2d7b0b,_0x1c5c42)=>{var _0x97b3f7=a0_0x5e910c;try{const {username:_0x194fa6,email:_0x2ada9a,role:_0x137838}=_0x2d7b0b[_0x97b3f7(0x1c3)],_0x3aafd5=_0x2d7b0b['user'],_0x4a23e1=await profile[_0x97b3f7(0x1d9)]({'email':_0x3aafd5[_0x97b3f7(0x1ea)]}),_0x650570=await master_shop['find']();console[_0x97b3f7(0x263)](_0x97b3f7(0x1eb),_0x650570);let _0x542ec0;if(_0x3aafd5[_0x97b3f7(0x1c8)]==_0x97b3f7(0x256)){const _0x437f49=await staff[_0x97b3f7(0x1d9)]({'email':_0x3aafd5[_0x97b3f7(0x1ea)]});_0x542ec0=await transfers['find']({'from_warehouse':_0x437f49[_0x97b3f7(0x1fd)]});}else _0x542ec0=await transfers[_0x97b3f7(0x183)]([{'$unwind':_0x97b3f7(0x199)},{'$group':{'_id':_0x97b3f7(0x1ef),'invoice':{'$first':_0x97b3f7(0x22c)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x97b3f7(0x20e)},'to_warehouse':{'$first':_0x97b3f7(0x1e6)},'from_room_name':{'$addToSet':_0x97b3f7(0x19c)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x97b3f7(0x1f2)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x650570[0x0][_0x97b3f7(0x1ff)]==_0x97b3f7(0x1d2)){var _0x2bf60a=users[_0x97b3f7(0x1e5)];console['log'](_0x2bf60a);}else{if(_0x650570[0x0][_0x97b3f7(0x1ff)]==_0x97b3f7(0x23a))var _0x2bf60a=users[_0x97b3f7(0x23a)];else{if(_0x650570[0x0][_0x97b3f7(0x1ff)]==_0x97b3f7(0x194))var _0x2bf60a=users[_0x97b3f7(0x194)];else{if(_0x650570[0x0][_0x97b3f7(0x1ff)]==_0x97b3f7(0x1cc))var _0x2bf60a=users[_0x97b3f7(0x1cc)];else{if(_0x650570[0x0]['language']==_0x97b3f7(0x1af))var _0x2bf60a=users[_0x97b3f7(0x1af)];else{if(_0x650570[0x0][_0x97b3f7(0x1ff)]==_0x97b3f7(0x1c4))var _0x2bf60a=users[_0x97b3f7(0x177)];else{if(_0x650570[0x0][_0x97b3f7(0x1ff)]==_0x97b3f7(0x202))var _0x2bf60a=users['Chinese'];else{if(_0x650570[0x0][_0x97b3f7(0x1ff)]==_0x97b3f7(0x266))var _0x2bf60a=users[_0x97b3f7(0x18e)];}}}}}}}_0x1c5c42[_0x97b3f7(0x246)](_0x97b3f7(0x214),{'success':_0x2d7b0b['flash'](_0x97b3f7(0x219)),'errors':_0x2d7b0b[_0x97b3f7(0x17c)](_0x97b3f7(0x1cb)),'role':_0x3aafd5,'profile':_0x4a23e1,'master_shop':_0x650570,'transfer':_0x542ec0,'language':_0x2bf60a});}catch(_0x1d39f9){console['log'](_0x1d39f9);}});async function getRandom8DigitNumber(){var _0x4c9cfe=a0_0x5e910c;const _0x18b9ce=0x989680,_0x3c3ca1=0x5f5e0ff,_0x169209=Math['floor'](Math[_0x4c9cfe(0x21e)]()*(_0x3c3ca1-_0x18b9ce+0x1))+_0x18b9ce;var _0x3d2363;const _0x325cd0=await transfers[_0x4c9cfe(0x1d9)]({'invoice':'TRF-'+_0x169209});return _0x325cd0&&_0x325cd0[_0x4c9cfe(0x1f0)]>0x0?_0x3d2363=_0x4c9cfe(0x1d7)+_0x169209:_0x3d2363=_0x4c9cfe(0x1d7)+_0x169209,_0x3d2363;}router[a0_0x5e910c(0x1c5)](a0_0x5e910c(0x1e3),auth,async(_0x2873e1,_0x1242e2)=>{var _0x1992cf=a0_0x5e910c;try{const {username:_0x10da71,email:_0x4f1ae9,role:_0x650df3}=_0x2873e1[_0x1992cf(0x1c3)],_0x5c4f07=_0x2873e1['user'],_0x28fb6d=await profile[_0x1992cf(0x1d9)]({'email':_0x5c4f07[_0x1992cf(0x1ea)]}),_0x1dd12e=await master_shop[_0x1992cf(0x227)]();console[_0x1992cf(0x263)](_0x1992cf(0x1eb),_0x1dd12e);let _0xdbcf95;if(_0x5c4f07[_0x1992cf(0x1c8)]=='staff'){const _0x25e92b=await staff[_0x1992cf(0x1d9)]({'email':_0x5c4f07[_0x1992cf(0x1ea)]});_0xdbcf95=await warehouse[_0x1992cf(0x183)]([{'$match':{'status':_0x1992cf(0x24c),'name':_0x25e92b['warehouse'],'warehouse_category':_0x1992cf(0x1dc)}},{'$group':{'_id':_0x1992cf(0x23e),'name':{'$first':_0x1992cf(0x23e)}}}]);}else _0xdbcf95=await warehouse[_0x1992cf(0x183)]([{'$match':{'status':'Enabled','warehouse_category':_0x1992cf(0x1dc)}},{'$group':{'_id':'$name','name':{'$first':_0x1992cf(0x23e)}}}]);var _0x43723a=[_0x1992cf(0x1a3),_0x1992cf(0x252),_0x1992cf(0x21d)];const _0x1a1d11=await transfers['find']({}),_0x1103c6=_0x1a1d11['length']+0x1,_0xf27f07='TRF-'+_0x1103c6[_0x1992cf(0x244)]()[_0x1992cf(0x187)](0x5,'0');if(_0x1dd12e[0x0][_0x1992cf(0x1ff)]==_0x1992cf(0x1d2)){var _0x4a2891=users['English'];console[_0x1992cf(0x263)](_0x4a2891);}else{if(_0x1dd12e[0x0][_0x1992cf(0x1ff)]=='Hindi')var _0x4a2891=users[_0x1992cf(0x23a)];else{if(_0x1dd12e[0x0][_0x1992cf(0x1ff)]=='German')var _0x4a2891=users[_0x1992cf(0x194)];else{if(_0x1dd12e[0x0][_0x1992cf(0x1ff)]==_0x1992cf(0x1cc))var _0x4a2891=users[_0x1992cf(0x1cc)];else{if(_0x1dd12e[0x0][_0x1992cf(0x1ff)]==_0x1992cf(0x1af))var _0x4a2891=users[_0x1992cf(0x1af)];else{if(_0x1dd12e[0x0][_0x1992cf(0x1ff)]=='Portuguese\x20(BR)')var _0x4a2891=users[_0x1992cf(0x177)];else{if(_0x1dd12e[0x0][_0x1992cf(0x1ff)]==_0x1992cf(0x202))var _0x4a2891=users[_0x1992cf(0x202)];else{if(_0x1dd12e[0x0][_0x1992cf(0x1ff)]==_0x1992cf(0x266))var _0x4a2891=users['Arabic'];}}}}}}}const _0x3a0e64=getRandom8DigitNumber();_0x3a0e64[_0x1992cf(0x239)](_0x385881=>{var _0x1ed883=_0x1992cf;_0x1242e2['render'](_0x1ed883(0x236),{'success':_0x2873e1['flash']('success'),'errors':_0x2873e1[_0x1ed883(0x17c)]('errors'),'role':_0x5c4f07,'profile':_0x28fb6d,'master_shop':_0x1dd12e,'warehouse':_0xdbcf95,'language':_0x4a2891,'rooms_data':_0x43723a,'invoice':_0x385881});})[_0x1992cf(0x1b4)](_0x319ea8=>{var _0x1843d3=_0x1992cf;_0x2873e1[_0x1843d3(0x17c)](_0x1843d3(0x1cb),_0x1843d3(0x1b5)),_0x1242e2[_0x1843d3(0x25a)](_0x1843d3(0x1a0));});}catch(_0x1dfb45){console['log'](_0x1dfb45);}}),router[a0_0x5e910c(0x189)](a0_0x5e910c(0x1e3),auth,async(_0x4a9ffd,_0x2b57e8)=>{var _0x17ebbc=a0_0x5e910c;try{console[_0x17ebbc(0x263)](_0x4a9ffd['body']);const {date:_0x21d51c,from_warehouse:_0x572f69,FromRoom_name:_0x2aa38e,to_warehouse:_0x163b5a,ToRoom_name:_0x1e9ad3,prod_name:_0x2ff43a,from_prod_qty:_0x3d83b0,from_prod_level:_0x5239f3,from_prod_isle:_0x5c51b0,from_prod_pallet:_0x52552e,to_prod_qty:_0x3cde8d,to_prod_level:_0x492fff,to_prod_isle:_0x15f3cf,to_prod_pallet:_0x34a9d8,primary_code:_0x4aec51,secondary_code:_0x17e81d,product_code3:_0x512d9d,note:_0x56a627,MaxStocks_data2:_0x311d49,invoice:_0x146b26,expiry_date:_0x23c985}=_0x4a9ffd['body'];if(typeof _0x2ff43a==_0x17ebbc(0x1bc))var _0x508675=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x1d5)]],_0x4c94e4=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x172)]],_0x2e6471=[_0x4a9ffd['body'][_0x17ebbc(0x1f1)]],_0x13be09=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x211)]],_0x397c7b=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x1ab)]],_0x57b9e9=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x1a1)]],_0x126c65=[_0x4a9ffd['body'][_0x17ebbc(0x1ed)]],_0x16264a=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x1a6)]],_0x406257=[_0x4a9ffd['body'][_0x17ebbc(0x1e9)]],_0x29c639=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x224)]],_0x420c17=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x235)]],_0x2a10fd=[_0x4a9ffd[_0x17ebbc(0x1ba)]['batch_code']],_0x2814ba=[_0x4a9ffd[_0x17ebbc(0x1ba)]['expiry_date']],_0x3ae281=[_0x4a9ffd['body'][_0x17ebbc(0x24f)]],_0x508c82=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x268)]],_0x477524=[_0x4a9ffd['body'][_0x17ebbc(0x243)]],_0x121a3f=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x240)]],_0x254f78=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x261)]],_0xc22195=[_0x4a9ffd['body'][_0x17ebbc(0x17d)]],_0x370727=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x265)]],_0x33c514=[_0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x24e)]];else var _0x508675=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x1d5)]],_0x4c94e4=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x172)]],_0x2e6471=[..._0x4a9ffd[_0x17ebbc(0x1ba)]['from_prod_level']],_0x13be09=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x211)]],_0x397c7b=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x1ab)]],_0x57b9e9=[..._0x4a9ffd['body']['primary_code']],_0x126c65=[..._0x4a9ffd['body']['secondary_code']],_0x16264a=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x1a6)]],_0x406257=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x1e9)]],_0x29c639=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x224)]],_0x420c17=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x235)]],_0x2a10fd=[..._0x4a9ffd['body'][_0x17ebbc(0x1b6)]],_0x2814ba=[..._0x4a9ffd[_0x17ebbc(0x1ba)]['expiry_date']],_0x3ae281=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x24f)]],_0x508c82=[..._0x4a9ffd[_0x17ebbc(0x1ba)]['production_date']],_0x477524=[..._0x4a9ffd[_0x17ebbc(0x1ba)]['prod_cat']],_0x121a3f=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x240)]],_0x254f78=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x261)]],_0xc22195=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x17d)]],_0x370727=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x265)]],_0x33c514=[..._0x4a9ffd[_0x17ebbc(0x1ba)][_0x17ebbc(0x24e)]];const _0x19f687=_0x508675[_0x17ebbc(0x20a)](_0x60ec6=>{return _0x60ec6={'product_name':_0x60ec6};});_0x4c94e4[_0x17ebbc(0x1b3)]((_0x34236d,_0x13f97d)=>{var _0x4c7f28=_0x17ebbc;_0x19f687[_0x13f97d][_0x4c7f28(0x233)]=_0x34236d;}),_0xc22195['forEach']((_0x8b46,_0x2e5756)=>{var _0x1c9042=_0x17ebbc;_0x19f687[_0x2e5756][_0x1c9042(0x17d)]=_0x8b46;}),_0x370727[_0x17ebbc(0x1b3)]((_0x4295bf,_0x50fb82)=>{_0x19f687[_0x50fb82]['To_invoice']=_0x4295bf;}),_0x33c514['forEach']((_0x529418,_0x4fb20b)=>{var _0x2e98eb=_0x17ebbc;_0x19f687[_0x4fb20b][_0x2e98eb(0x1df)]=_0x529418;}),_0x2e6471['forEach']((_0x19bab1,_0x282454)=>{var _0x78eb4b=_0x17ebbc;_0x121a3f[_0x78eb4b(0x1b3)]((_0x556913,_0x4539b6)=>{var _0x40d06f=_0x78eb4b;if(_0x556913==_0x40d06f(0x1cd)&&_0x282454==_0x4539b6){var _0x1e9231=_0x19bab1[_0x40d06f(0x250)](0x3);_0x19f687[_0x282454][_0x40d06f(0x245)]=_0x19bab1[0x0],_0x19f687[_0x282454][_0x40d06f(0x258)]=_0x19bab1[0x1],_0x19f687[_0x282454]['from_bay']=0x0,_0x19f687[_0x282454][_0x40d06f(0x1c0)]=0x0,_0x19f687[_0x282454][_0x40d06f(0x25d)]=_0x40d06f(0x20c),_0x19f687[_0x282454][_0x40d06f(0x1aa)]=_0x1e9231;}else{if(_0x556913=='Shelves'&&_0x282454==_0x4539b6){var _0x1e9231=_0x19bab1[_0x40d06f(0x250)](0x3);_0x19f687[_0x282454]['from_storage']=_0x19bab1[0x0],_0x19f687[_0x282454][_0x40d06f(0x258)]=_0x19bab1[0x1],_0x19f687[_0x282454][_0x40d06f(0x226)]=0x0,_0x19f687[_0x282454][_0x40d06f(0x1c0)]=0x0,_0x19f687[_0x282454][_0x40d06f(0x25d)]=_0x40d06f(0x20c),_0x19f687[_0x282454][_0x40d06f(0x1aa)]=_0x19bab1[0x5];}else{if(_0x282454==_0x4539b6){if(_0x19bab1[0x0]=='A'&&_0x19bab1[0x1]=='L'&&_0x19bab1[0x2]=='L')console[_0x40d06f(0x263)](_0x556913+_0x40d06f(0x1a8)+_0x282454+_0x40d06f(0x1a8)+_0x4539b6+_0x40d06f(0x1a8)+_0x19bab1+_0x40d06f(0x198)),_0x19f687[_0x282454][_0x40d06f(0x245)]=_0x19bab1[0x0],_0x19f687[_0x282454][_0x40d06f(0x258)]=_0x19bab1[0x1],_0x19f687[_0x282454][_0x40d06f(0x226)]=0x0,_0x19f687[_0x282454][_0x40d06f(0x1c0)]=0x0,_0x19f687[_0x282454][_0x40d06f(0x25d)]=_0x40d06f(0x20c),_0x19f687[_0x282454][_0x40d06f(0x1aa)]=_0x19bab1[0x3];else{var _0x45eb29;if(_0x19bab1[0x4]=='L')_0x45eb29=_0x40d06f(0x255);else _0x19bab1[0x4]=='F'&&(_0x45eb29=_0x40d06f(0x20c));_0x19f687[_0x282454][_0x40d06f(0x245)]=_0x19bab1[0x0],_0x19f687[_0x282454][_0x40d06f(0x258)]=_0x19bab1[0x1],_0x19f687[_0x282454][_0x40d06f(0x226)]=_0x19bab1[0x2],_0x19f687[_0x282454][_0x40d06f(0x1c0)]=_0x19bab1[0x3],_0x19f687[_0x282454]['from_types']=_0x45eb29,_0x19f687[_0x282454]['from_floorlevel']=_0x19bab1[0x5];}}}}});}),_0x13be09[_0x17ebbc(0x1b3)]((_0x900f29,_0x1b32ed)=>{var _0x505117=_0x17ebbc;_0x19f687[_0x1b32ed][_0x505117(0x1d0)]=_0x900f29;}),_0x397c7b[_0x17ebbc(0x1b3)]((_0x212fad,_0x17b0d6)=>{var _0x48b7f0=_0x17ebbc;_0x254f78[_0x48b7f0(0x1b3)]((_0x370a71,_0x511d8a)=>{var _0x2f6b1c=_0x48b7f0;if(_0x370a71==_0x2f6b1c(0x1cd)&&_0x17b0d6==_0x511d8a){var _0xe6635f=_0x212fad[_0x2f6b1c(0x250)](0x3);_0x19f687[_0x17b0d6][_0x2f6b1c(0x180)]=_0x212fad[0x0],_0x19f687[_0x17b0d6][_0x2f6b1c(0x1e1)]=_0x212fad[0x1],_0x19f687[_0x17b0d6]['to_bay']=0x0,_0x19f687[_0x17b0d6][_0x2f6b1c(0x1ec)]=0x0,_0x19f687[_0x17b0d6]['to_types']=_0x2f6b1c(0x20c),_0x19f687[_0x17b0d6]['to_floorlevel']=_0xe6635f;}else{if(_0x370a71==_0x2f6b1c(0x17a)&&_0x17b0d6==_0x511d8a){var _0xe6635f=_0x212fad[_0x2f6b1c(0x250)](0x3);_0x19f687[_0x17b0d6][_0x2f6b1c(0x180)]=_0x212fad[0x0],_0x19f687[_0x17b0d6][_0x2f6b1c(0x1e1)]=_0x212fad[0x1],_0x19f687[_0x17b0d6][_0x2f6b1c(0x1fa)]=0x0,_0x19f687[_0x17b0d6][_0x2f6b1c(0x1ec)]=0x0,_0x19f687[_0x17b0d6][_0x2f6b1c(0x259)]='Floor',_0x19f687[_0x17b0d6]['to_floorlevel']=_0x212fad[0x5];}else{if(_0x17b0d6==_0x511d8a){if(_0x212fad[0x0]=='A'&&_0x212fad[0x1]=='L'&&_0x212fad[0x2]=='L')console['log'](_0x370a71+_0x2f6b1c(0x1a8)+_0x17b0d6+'\x20<>\x20'+_0x511d8a+_0x2f6b1c(0x1a8)+_0x212fad+_0x2f6b1c(0x198)),_0x19f687[_0x17b0d6][_0x2f6b1c(0x180)]=_0x212fad[0x0],_0x19f687[_0x17b0d6]['rack']=_0x212fad[0x1],_0x19f687[_0x17b0d6]['to_bay']=0x0,_0x19f687[_0x17b0d6][_0x2f6b1c(0x1ec)]=0x0,_0x19f687[_0x17b0d6][_0x2f6b1c(0x259)]=_0x2f6b1c(0x20c),_0x19f687[_0x17b0d6][_0x2f6b1c(0x197)]=_0x212fad[0x3];else{var _0xe23f3c;if(_0x212fad[0x4]=='L')_0xe23f3c=_0x2f6b1c(0x255);else _0x212fad[0x4]=='F'&&(_0xe23f3c='Floor');_0x19f687[_0x17b0d6][_0x2f6b1c(0x180)]=_0x212fad[0x0],_0x19f687[_0x17b0d6]['rack']=_0x212fad[0x1],_0x19f687[_0x17b0d6][_0x2f6b1c(0x1fa)]=_0x212fad[0x2],_0x19f687[_0x17b0d6][_0x2f6b1c(0x1ec)]=_0x212fad[0x3],_0x19f687[_0x17b0d6][_0x2f6b1c(0x259)]=_0xe23f3c,_0x19f687[_0x17b0d6][_0x2f6b1c(0x197)]=_0x212fad[0x5];}}}}});}),_0x57b9e9[_0x17ebbc(0x1b3)]((_0x2b4017,_0x544db0)=>{_0x19f687[_0x544db0]['primary_code']=_0x2b4017;}),_0x126c65[_0x17ebbc(0x1b3)]((_0x215001,_0x53ebbd)=>{var _0x4b5406=_0x17ebbc;_0x19f687[_0x53ebbd][_0x4b5406(0x1ed)]=_0x215001;}),_0x16264a[_0x17ebbc(0x1b3)]((_0xa630e4,_0x1b3506)=>{var _0x13b580=_0x17ebbc;_0x19f687[_0x1b3506][_0x13b580(0x1d8)]=_0xa630e4;}),_0x406257[_0x17ebbc(0x1b3)]((_0x1c23b2,_0x371718)=>{var _0x3c19f8=_0x17ebbc;_0x19f687[_0x371718][_0x3c19f8(0x1ca)]=_0x1c23b2;}),_0x29c639[_0x17ebbc(0x1b3)]((_0x568a9c,_0x50f01d)=>{_0x19f687[_0x50f01d]['unit']=_0x568a9c;}),_0x420c17[_0x17ebbc(0x1b3)]((_0xd4df,_0x4f2d21)=>{var _0x2dd45b=_0x17ebbc;_0x19f687[_0x4f2d21][_0x2dd45b(0x235)]=_0xd4df;}),_0x2a10fd[_0x17ebbc(0x1b3)]((_0x32a7a7,_0x12ecd1)=>{var _0x4dc034=_0x17ebbc;_0x19f687[_0x12ecd1][_0x4dc034(0x1b6)]=_0x32a7a7;}),_0x2814ba[_0x17ebbc(0x1b3)]((_0x100651,_0x23573e)=>{var _0x33e663=_0x17ebbc;_0x19f687[_0x23573e][_0x33e663(0x1e7)]=_0x100651;}),_0x3ae281[_0x17ebbc(0x1b3)]((_0x4f8ac8,_0x481783)=>{var _0x1783cc=_0x17ebbc;_0x19f687[_0x481783][_0x1783cc(0x25e)]=_0x4f8ac8;}),_0x508c82[_0x17ebbc(0x1b3)]((_0x319c45,_0x3fd48b)=>{var _0x11464f=_0x17ebbc;_0x19f687[_0x3fd48b][_0x11464f(0x268)]=_0x319c45;}),_0x477524[_0x17ebbc(0x1b3)]((_0x571f6d,_0xba3954)=>{var _0x3a2a59=_0x17ebbc;_0x19f687[_0xba3954][_0x3a2a59(0x243)]=_0x571f6d;}),_0x121a3f[_0x17ebbc(0x1b3)]((_0x3c120a,_0x30a87b)=>{var _0x93a36e=_0x17ebbc;_0x19f687[_0x30a87b][_0x93a36e(0x22f)]=_0x3c120a;}),_0x254f78[_0x17ebbc(0x1b3)]((_0x4ebd98,_0x1ed98d)=>{_0x19f687[_0x1ed98d]['to_room_name']=_0x4ebd98;});const _0x3fddec=_0x19f687[_0x17ebbc(0x22a)](_0x229b84=>_0x229b84[_0x17ebbc(0x1d0)]!=='0'&&_0x229b84[_0x17ebbc(0x1d0)]!==''||_0x229b84['to_floorlevel']!=='0'&&_0x229b84[_0x17ebbc(0x197)]!==''),_0x37b691=new transfers({'date':_0x21d51c,'from_warehouse':_0x572f69,'to_warehouse':_0x163b5a,'product':_0x3fddec,'note':_0x56a627,'invoice':_0x146b26}),_0x59ca81=await _0x37b691['save']();_0x4a9ffd[_0x17ebbc(0x17c)](_0x17ebbc(0x219),_0x17ebbc(0x1e0)),_0x2b57e8[_0x17ebbc(0x25a)](_0x17ebbc(0x249)+_0x59ca81[_0x17ebbc(0x1f3)]);}catch(_0x2057b8){console[_0x17ebbc(0x263)](_0x2057b8),_0x2b57e8[_0x17ebbc(0x21c)](0xc8)[_0x17ebbc(0x24a)]({'errorMessage':_0x2057b8[_0x17ebbc(0x238)]});}}),router['get'](a0_0x5e910c(0x260),auth,async(_0x586707,_0x51dc1f)=>{var _0x2486d7=a0_0x5e910c;try{const {username:_0x439c1c,email:_0x12ae10,role:_0xac16d8}=_0x586707[_0x2486d7(0x1c3)],_0x55e1a3=_0x586707[_0x2486d7(0x1c3)],_0x53f9b0=await profile['findOne']({'email':_0x55e1a3['email']}),_0x13500b=await master_shop[_0x2486d7(0x227)]();console[_0x2486d7(0x263)](_0x2486d7(0x1eb),_0x13500b);const _0x29ae94=await transfers[_0x2486d7(0x215)](_0x586707[_0x2486d7(0x213)]['id']);let _0x300785=new Date(_0x29ae94['expiry_date']),_0x28810b=('0'+_0x300785[_0x2486d7(0x25b)]())[_0x2486d7(0x250)](-0x2),_0x5c4688=('0'+(_0x300785[_0x2486d7(0x1fb)]()+0x1))[_0x2486d7(0x250)](-0x2),_0xa17570=_0x300785['getFullYear'](),_0x42c52c=_0xa17570+'-'+_0x5c4688+'-'+_0x28810b,_0x4687c0;if(_0x55e1a3[_0x2486d7(0x1c8)]==_0x2486d7(0x256)){const _0x43556e=await staff[_0x2486d7(0x1d9)]({'email':_0x55e1a3[_0x2486d7(0x1ea)]});_0x4687c0=await warehouse[_0x2486d7(0x227)]({'status':_0x2486d7(0x24c),'name':_0x43556e[_0x2486d7(0x1fd)],'warehouse_category':'Raw\x20Materials'});}else _0x4687c0=await warehouse[_0x2486d7(0x227)]({'status':_0x2486d7(0x24c),'warehouse_category':_0x2486d7(0x1dc)});const _0x3b3154=await warehouse['aggregate']([{'$match':{'name':_0x29ae94[_0x2486d7(0x23f)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2486d7(0x19a),'name':{'$first':_0x2486d7(0x23b)},'product_stock':{'$first':_0x2486d7(0x1f7)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x2486d7(0x262)},'type':{'$first':_0x2486d7(0x176)},'floorlevel':{'$first':_0x2486d7(0x17e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2486d7(0x1a9)},'product_code':{'$first':_0x2486d7(0x1a7)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2486d7(0x257)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2486d7(0x1b9)},'room':{'$first':_0x2486d7(0x20f)}}}]);if(_0x13500b[0x0]['language']==_0x2486d7(0x1d2)){var _0xe531b6=users[_0x2486d7(0x1e5)];console[_0x2486d7(0x263)](_0xe531b6);}else{if(_0x13500b[0x0]['language']==_0x2486d7(0x23a))var _0xe531b6=users['Hindi'];else{if(_0x13500b[0x0][_0x2486d7(0x1ff)]==_0x2486d7(0x194))var _0xe531b6=users[_0x2486d7(0x194)];else{if(_0x13500b[0x0]['language']==_0x2486d7(0x1cc))var _0xe531b6=users['Spanish'];else{if(_0x13500b[0x0][_0x2486d7(0x1ff)]==_0x2486d7(0x1af))var _0xe531b6=users[_0x2486d7(0x1af)];else{if(_0x13500b[0x0][_0x2486d7(0x1ff)]==_0x2486d7(0x1c4))var _0xe531b6=users['Portuguese'];else{if(_0x13500b[0x0]['language']==_0x2486d7(0x202))var _0xe531b6=users[_0x2486d7(0x202)];else{if(_0x13500b[0x0][_0x2486d7(0x1ff)]=='Arabic\x20(ae)')var _0xe531b6=users['Arabic'];}}}}}}}_0x51dc1f[_0x2486d7(0x246)](_0x2486d7(0x1d1),{'success':_0x586707[_0x2486d7(0x17c)](_0x2486d7(0x219)),'errors':_0x586707[_0x2486d7(0x17c)]('errors'),'role':_0x55e1a3,'profile':_0x53f9b0,'master_shop':_0x13500b,'warehouse':_0x4687c0,'transfer':_0x29ae94,'stock':_0x3b3154,'language':_0xe531b6});}catch(_0x32e5af){console[_0x2486d7(0x263)](_0x32e5af);}}),router['post'](a0_0x5e910c(0x260),auth,async(_0x5a3b92,_0x4e3e3a)=>{var _0x30b114=a0_0x5e910c;try{const _0x1d54b3=_0x5a3b92[_0x30b114(0x213)]['id'],{from_warehouse:_0x558602,FromRoom_name:_0x4f0c9f,to_warehouse:_0x310017,ToRoom_name:_0x6786ae}=_0x5a3b92['body'],_0x40c9c9=await transfers[_0x30b114(0x215)]({'_id':_0x1d54b3}),_0x3408a4=_0x40c9c9[_0x30b114(0x1ce)][_0x30b114(0x20a)](async _0x4ed162=>{var _0x290caa=_0x30b114;if(_0x4ed162[_0x290caa(0x1d0)]>0x0){var _0x7e7679=await warehouse[_0x290caa(0x1d9)]({'name':_0x40c9c9['from_warehouse'],'room':_0x4ed162[_0x290caa(0x22f)],'warehouse_category':_0x290caa(0x1dc)});const _0x5e5633=_0x7e7679['product_details'][_0x290caa(0x20a)](_0x3edb2a=>{var _0x5827b4=_0x290caa;_0x3edb2a[_0x5827b4(0x1f9)]==_0x4ed162[_0x5827b4(0x1f9)]&&_0x3edb2a[_0x5827b4(0x203)]==_0x4ed162[_0x5827b4(0x1aa)]&&_0x3edb2a[_0x5827b4(0x208)]==_0x4ed162['from_types']&&_0x3edb2a[_0x5827b4(0x230)]==_0x4ed162[_0x5827b4(0x1c0)]&&_0x3edb2a[_0x5827b4(0x1c1)]==_0x4ed162[_0x5827b4(0x226)]&&_0x3edb2a[_0x5827b4(0x1e1)]==_0x4ed162[_0x5827b4(0x258)]&&_0x3edb2a[_0x5827b4(0x180)]==_0x4ed162[_0x5827b4(0x245)]&&_0x3edb2a['expiry_date']==_0x4ed162['expiry_date']&&_0x3edb2a[_0x5827b4(0x1b6)]==_0x4ed162[_0x5827b4(0x1b6)]&&_0x3edb2a[_0x5827b4(0x268)]==_0x4ed162['production_date']&&_0x3edb2a['invoice']==_0x4ed162['from_invoice']&&_0x3edb2a[_0x5827b4(0x1f3)]==_0x4ed162[_0x5827b4(0x1df)]&&(_0x3edb2a['product_stock']=_0x3edb2a[_0x5827b4(0x186)]-_0x4ed162[_0x5827b4(0x1d0)]);});}return _0x7e7679;});Promise[_0x30b114(0x17b)](_0x3408a4)[_0x30b114(0x239)](async _0x5a8e6b=>{var _0x5030d3=_0x30b114;try{for(const _0xa8608f of _0x5a8e6b){await _0xa8608f[_0x5030d3(0x201)]();}try{const _0x125464=_0x40c9c9[_0x5030d3(0x1ce)][_0x5030d3(0x20a)](async _0x18793e=>{var _0x280e61=_0x5030d3;if(_0x18793e[_0x280e61(0x1d0)]>0x0){var _0x4559a2=await warehouse[_0x280e61(0x1d9)]({'name':_0x40c9c9['to_warehouse'],'room':_0x18793e['to_room_name'],'warehouse_category':_0x280e61(0x1dc)}),_0x2c3d06=0x0;const _0x5f4752=_0x4559a2[_0x280e61(0x18f)][_0x280e61(0x20a)](_0x3b66a6=>{var _0x312e8c=_0x280e61;_0x3b66a6['product_name']==_0x18793e['product_name']&&_0x3b66a6['floorlevel']==_0x18793e['to_floorlevel']&&_0x3b66a6[_0x312e8c(0x208)]==_0x18793e['to_types']&&_0x3b66a6[_0x312e8c(0x230)]==_0x18793e['to_bin']&&_0x3b66a6['bay']==_0x18793e[_0x312e8c(0x1fa)]&&_0x3b66a6['rack']==_0x18793e[_0x312e8c(0x1e1)]&&_0x3b66a6[_0x312e8c(0x180)]==_0x18793e[_0x312e8c(0x180)]&&_0x3b66a6['expiry_date']==_0x18793e['expiry_date']&&_0x3b66a6[_0x312e8c(0x1b6)]==_0x18793e[_0x312e8c(0x1b6)]&&_0x3b66a6[_0x312e8c(0x268)]==_0x18793e[_0x312e8c(0x268)]&&_0x3b66a6['invoice']==_0x18793e[_0x312e8c(0x228)]&&(_0x3b66a6[_0x312e8c(0x186)]=_0x3b66a6[_0x312e8c(0x186)]+_0x18793e[_0x312e8c(0x1d0)],_0x2c3d06++);});_0x2c3d06=='0'&&(_0x4559a2[_0x280e61(0x18f)]=_0x4559a2[_0x280e61(0x18f)][_0x280e61(0x1a4)]({'product_name':_0x18793e[_0x280e61(0x1f9)],'product_stock':_0x18793e[_0x280e61(0x1d0)],'bay':_0x18793e['to_bay'],'bin':_0x18793e['to_bin'],'type':_0x18793e['to_types'],'floorlevel':_0x18793e['to_floorlevel'],'storage':_0x18793e[_0x280e61(0x180)],'rack':_0x18793e[_0x280e61(0x1e1)],'product_code':_0x18793e[_0x280e61(0x1d8)],'primary_code':_0x18793e[_0x280e61(0x1a1)],'secondary_code':_0x18793e['secondary_code'],'maxProducts':_0x18793e[_0x280e61(0x1ca)],'storage':_0x18793e[_0x280e61(0x180)],'rack':_0x18793e[_0x280e61(0x1e1)],'expiry_date':_0x18793e['expiry_date'],'maxPerUnit':_0x18793e[_0x280e61(0x25e)],'batch_code':_0x18793e[_0x280e61(0x1b6)],'production_date':_0x18793e[_0x280e61(0x268)]}));}return _0x4559a2;});Promise[_0x5030d3(0x17b)](_0x125464)['then'](async _0xa159a5=>{var _0x3d00e7=_0x5030d3;try{for(const _0x2cb6d2 of _0xa159a5){await warehouse[_0x3d00e7(0x1f4)]({'_id':_0x2cb6d2[_0x3d00e7(0x1f3)]},{'$addToSet':{'product_details':{'$each':_0x2cb6d2[_0x3d00e7(0x18f)]}}});}_0x40c9c9[_0x3d00e7(0x185)]=_0x3d00e7(0x1ee);const _0x339d3c=await _0x40c9c9[_0x3d00e7(0x201)](),_0x3cfd85=await master_shop[_0x3d00e7(0x227)](),_0x19899b=await email_settings[_0x3d00e7(0x1d9)](),_0x1f7e2e=await supervisor_settings[_0x3d00e7(0x227)]();var _0x332a39=_0x40c9c9[_0x3d00e7(0x1ce)],_0x5091dc='',_0x25fa68;for(_0x25fa68 in _0x332a39){_0x5091dc+=_0x3d00e7(0x218)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x332a39[_0x25fa68]['product_name']+_0x3d00e7(0x237)+_0x3d00e7(0x1d4)+_0x332a39[_0x25fa68]['product_code']+_0x3d00e7(0x237)+_0x3d00e7(0x1d4)+_0x332a39[_0x25fa68][_0x3d00e7(0x1d0)]+_0x3d00e7(0x237)+_0x3d00e7(0x1d4)+_0x332a39[_0x25fa68][_0x3d00e7(0x196)]+_0x3d00e7(0x237)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x332a39[_0x25fa68][_0x3d00e7(0x235)]+_0x3d00e7(0x237)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x40c9c9[_0x3d00e7(0x1f8)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x332a39[_0x25fa68][_0x3d00e7(0x195)]+_0x3d00e7(0x237)+_0x3d00e7(0x1d4)+_0x332a39[_0x25fa68][_0x3d00e7(0x180)]+_0x332a39[_0x25fa68][_0x3d00e7(0x1e1)]+_0x332a39[_0x25fa68]['to_bay']+_0x332a39[_0x25fa68]['to_bin']+_0x332a39[_0x25fa68][_0x3d00e7(0x259)][0x0]+_0x332a39[_0x25fa68][_0x3d00e7(0x197)]+_0x3d00e7(0x237),'</tr>';}let _0x4f3369=nodemailer[_0x3d00e7(0x220)]({'host':_0x19899b[_0x3d00e7(0x1a2)],'port':Number(_0x19899b['port']),'secure':![],'auth':{'user':_0x19899b[_0x3d00e7(0x1ea)],'pass':_0x19899b[_0x3d00e7(0x178)]}}),_0xc884ad={'from':_0x19899b[_0x3d00e7(0x1ea)],'to':_0x1f7e2e[0x0][_0x3d00e7(0x1fc)],'subject':_0x3d00e7(0x241),'attachments':[{'filename':_0x3d00e7(0x1d3),'path':__dirname+'/../public'+'/upload/'+_0x3cfd85[0x0]['image'],'cid':_0x3d00e7(0x1bf)}],'html':'<!DOCTYPE\x20html>'+_0x3d00e7(0x1db)+'</head><body>'+'<div>'+_0x3d00e7(0x210)+'<div>'+_0x3d00e7(0x24b)+_0x3d00e7(0x173)+_0x3d00e7(0x1b7)+_0x3d00e7(0x1da)+_0x3cfd85[0x0][_0x3d00e7(0x267)]+'\x20</h2>'+_0x3d00e7(0x173)+'</div>'+_0x3d00e7(0x17f)+_0x3d00e7(0x1b7)+_0x3d00e7(0x1dd)+_0x3d00e7(0x212)+_0x40c9c9[_0x3d00e7(0x22e)]+'\x20'+_0x3d00e7(0x188)+_0x3d00e7(0x1d6)+_0x40c9c9[_0x3d00e7(0x1b8)]+'\x20'+_0x3d00e7(0x18d)+_0x3d00e7(0x209)+'</div>'+_0x3d00e7(0x229)+_0x3d00e7(0x19e)+_0x3d00e7(0x218)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x3d00e7(0x182)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x3d00e7(0x22b)+_0x3d00e7(0x217)+_0x3d00e7(0x225)+_0x3d00e7(0x206)+_0x3d00e7(0x1be)+_0x3d00e7(0x181)+_0x3d00e7(0x1ae)+'\x20'+_0x5091dc+'\x20'+_0x3d00e7(0x1f5)+_0x3d00e7(0x200)+'<div>'+_0x3d00e7(0x18b)+_0x3d00e7(0x1bb)+_0x3cfd85[0x0][_0x3d00e7(0x267)]+_0x3d00e7(0x209)+_0x3d00e7(0x173)+_0x3d00e7(0x173)+'</body></html>'};_0x4f3369[_0x3d00e7(0x251)](_0xc884ad,function(_0x189759,_0x26551b){var _0x4a4c7e=_0x3d00e7;_0x189759?(console[_0x4a4c7e(0x263)](_0x189759),console[_0x4a4c7e(0x263)](_0x4a4c7e(0x1b2))):console[_0x4a4c7e(0x263)]('Email\x20sent\x20successfully');}),_0x5a3b92[_0x3d00e7(0x17c)](_0x3d00e7(0x219),_0x3d00e7(0x1fe)),_0x4e3e3a[_0x3d00e7(0x25a)](_0x3d00e7(0x21b)+_0x339d3c[_0x3d00e7(0x1f3)]);}catch(_0x499ef9){console[_0x3d00e7(0x247)](_0x499ef9),_0x4e3e3a[_0x3d00e7(0x21c)](0x1f4)['json']({'Perror':_0x3d00e7(0x221),'message':_0x499ef9[_0x3d00e7(0x238)]});}})[_0x5030d3(0x1b4)](_0x12ae34=>{var _0x40c4a8=_0x5030d3;console['error'](_0x12ae34),_0x4e3e3a['status'](0x1f4)['json']({'Perror':_0x40c4a8(0x254)});});}catch(_0x4c960c){_0x4e3e3a[_0x5030d3(0x24a)](_0x4c960c);}}catch(_0x3f02f7){console[_0x5030d3(0x247)](_0x3f02f7),_0x4e3e3a[_0x5030d3(0x21c)](0x1f4)[_0x5030d3(0x24a)]({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x3f02f7[_0x5030d3(0x238)]});}})[_0x30b114(0x1b4)](_0x227c40=>{var _0x439512=_0x30b114;console[_0x439512(0x247)](_0x227c40),_0x4e3e3a[_0x439512(0x21c)](0x1f4)[_0x439512(0x24a)]({'Merror':_0x439512(0x254)});});}catch(_0x25a7c0){console[_0x30b114(0x263)](_0x25a7c0);}});function BayBinSelected(_0x4e3f43,_0x1df90c){var _0xb3c5ab=a0_0x5e910c,_0xd6f196=[],_0x272c68=[],_0x2cd107=[],_0x435aba=[],_0x1c4bd2=[],_0x2d6ac4=[];let _0x5aad61=[];if(_0x4e3f43==_0xb3c5ab(0x19f))switch(_0x1df90c){case _0xb3c5ab(0x242):_0xd6f196=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x272c68=[0x1,0x2],_0x435aba=[0x1,0x2,0x3,0x4,0x5],_0x2cd107=['Level','Floor'],_0x1c4bd2=['D'],_0x2d6ac4=['A'];break;case _0xb3c5ab(0x19d):_0xd6f196=[0x6,0x5,0x4,0x3,0x2,0x1],_0x272c68=[0x1,0x2],_0x435aba=[0x1,0x2,0x3,0x4,0x5],_0x2cd107=['Level',_0xb3c5ab(0x20c)],_0x1c4bd2=['D'],_0x2d6ac4=['B'];break;case _0xb3c5ab(0x17a):_0xd6f196=[0x0],_0x272c68=[0x0],_0x435aba=[0x1,0x2,0x3,0x4,0x5],_0x2cd107=[_0xb3c5ab(0x20c)],_0x1c4bd2=['D'],_0x2d6ac4=['S'];break;case'Receiving\x20Area':_0xd6f196=[0x0],_0x272c68=[0x0],_0x435aba=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x2cd107=[_0xb3c5ab(0x20c)],_0x1c4bd2=['D'],_0x2d6ac4=['R'];break;}else{if(_0x4e3f43==_0xb3c5ab(0x205))switch(_0x1df90c){case'Rack\x20A':_0xd6f196=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x272c68=['B','F'],_0x435aba=[0x1,0x2,0x3,0x4,0x5],_0x2cd107=['Level',_0xb3c5ab(0x20c)],_0x1c4bd2=['C'],_0x2d6ac4=['A'];break;case _0xb3c5ab(0x19d):_0xd6f196=[0x5,0x4,0x3,0x2,0x1],_0x272c68=['F','B','S'],_0x435aba=[0x1,0x2,0x3,0x4,0x5],_0x2cd107=[_0xb3c5ab(0x255),_0xb3c5ab(0x20c)],_0x1c4bd2=['C'],_0x2d6ac4=['B'];break;case'Rack\x20C':_0xd6f196=[0x1,0x2,0x3,0x4,0x5],_0x272c68=['B','F','S'],_0x435aba=[0x5,0x4,0x3,0x2,0x1],_0x2cd107=[_0xb3c5ab(0x255),_0xb3c5ab(0x20c)],_0x1c4bd2=['C'],_0x2d6ac4=['C'];break;case'Rack\x20D':_0xd6f196=[0x5,0x4,0x3,0x2,0x1],_0x272c68=['F','B','S'],_0x435aba=[0x1,0x2,0x3,0x4,0x5],_0x2cd107=['Level',_0xb3c5ab(0x20c)],_0x1c4bd2=['C'],_0x2d6ac4=['D'];break;case _0xb3c5ab(0x1b1):_0xd6f196=[0x4,0x3,0x2,0x1],_0x272c68=[0x1,0x2],_0x435aba=[0x1,0x2,0x3,0x4,0x5],_0x2cd107=[_0xb3c5ab(0x255),'Floor'],_0x1c4bd2=['C'],_0x2d6ac4=['E'];break;case _0xb3c5ab(0x264):_0xd6f196=[0x1,0x2,0x3],_0x272c68=[0x1,0x2],_0x435aba=[0x1,0x2,0x3,0x4,0x5],_0x2cd107=[_0xb3c5ab(0x255)],_0x1c4bd2=['C'],_0x2d6ac4=['F'];break;}}return{'levels':_0xd6f196,'Isle':_0x272c68,'rack':_0x435aba,'type':_0x2cd107,'storage':_0x1c4bd2,'rak':_0x2d6ac4};}function a0_0x8ed4(_0x17759a,_0x52ccd8){var _0x42306d=a0_0x4230();return a0_0x8ed4=function(_0x8ed448,_0x41c455){_0x8ed448=_0x8ed448-0x172;var _0x5927d3=_0x42306d[_0x8ed448];return _0x5927d3;},a0_0x8ed4(_0x17759a,_0x52ccd8);}router[a0_0x5e910c(0x1c5)](a0_0x5e910c(0x184),auth,async(_0x32ed56,_0x22816f)=>{var _0x32e9df=a0_0x5e910c;try{const {username:_0x8a6c23,email:_0x1aaaed,role:_0x528882}=_0x32ed56['user'],_0x560064=_0x32ed56[_0x32e9df(0x1c3)],_0xa71e6f=await profile[_0x32e9df(0x1d9)]({'email':_0x560064['email']}),_0x2bb4a6=await master_shop[_0x32e9df(0x227)](),_0x3b86f9=await transfers[_0x32e9df(0x215)](_0x32ed56['params']['id']);let _0x6f2ee7;if(_0x560064['role']=='staff'){const _0x1000f8=await staff[_0x32e9df(0x1d9)]({'email':_0x560064[_0x32e9df(0x1ea)]});_0x6f2ee7=await warehouse[_0x32e9df(0x183)]([{'$match':{'status':'Enabled','name':_0x1000f8[_0x32e9df(0x1fd)],'warehouse_category':_0x32e9df(0x1dc)}},{'$group':{'_id':_0x32e9df(0x23e),'name':{'$first':_0x32e9df(0x23e)}}}]);}else _0x6f2ee7=await warehouse[_0x32e9df(0x183)]([{'$match':{'status':_0x32e9df(0x24c),'warehouse_category':_0x32e9df(0x1dc)}},{'$group':{'_id':_0x32e9df(0x23e),'name':{'$first':_0x32e9df(0x23e)}}}]);const _0x5658eb=await warehouse[_0x32e9df(0x183)]([{'$match':{'name':_0x3b86f9[_0x32e9df(0x23f)],'warehouse_category':_0x32e9df(0x1dc)}},{'$unwind':_0x32e9df(0x1e4)},{'$group':{'_id':_0x32e9df(0x19a),'name':{'$first':_0x32e9df(0x23b)},'product_stock':{'$first':_0x32e9df(0x1f7)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x32e9df(0x262)},'type':{'$first':_0x32e9df(0x176)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x32e9df(0x24d)},'secondary_code':{'$first':_0x32e9df(0x1a9)},'product_code':{'$first':_0x32e9df(0x1a7)},'storage':{'$first':_0x32e9df(0x207)},'rack':{'$first':_0x32e9df(0x257)},'expiry_date':{'$first':_0x32e9df(0x1ad)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x32e9df(0x20f)}}}]),_0x3191ef=await product[_0x32e9df(0x227)]({}),_0x233c5d=BayBinSelected(_0x3b86f9[_0x32e9df(0x1f8)],_0x3b86f9[_0x32e9df(0x20d)]);if(_0x2bb4a6[0x0][_0x32e9df(0x1ff)]=='English\x20(US)'){var _0x5db4a6=users[_0x32e9df(0x1e5)];console[_0x32e9df(0x263)](_0x5db4a6);}else{if(_0x2bb4a6[0x0][_0x32e9df(0x1ff)]==_0x32e9df(0x23a))var _0x5db4a6=users[_0x32e9df(0x23a)];else{if(_0x2bb4a6[0x0][_0x32e9df(0x1ff)]==_0x32e9df(0x194))var _0x5db4a6=users[_0x32e9df(0x194)];else{if(_0x2bb4a6[0x0][_0x32e9df(0x1ff)]==_0x32e9df(0x1cc))var _0x5db4a6=users[_0x32e9df(0x1cc)];else{if(_0x2bb4a6[0x0][_0x32e9df(0x1ff)]==_0x32e9df(0x1af))var _0x5db4a6=users[_0x32e9df(0x1af)];else{if(_0x2bb4a6[0x0][_0x32e9df(0x1ff)]==_0x32e9df(0x1c4))var _0x5db4a6=users[_0x32e9df(0x177)];else{if(_0x2bb4a6[0x0]['language']==_0x32e9df(0x202))var _0x5db4a6=users['Chinese'];else{if(_0x2bb4a6[0x0][_0x32e9df(0x1ff)]==_0x32e9df(0x266))var _0x5db4a6=users[_0x32e9df(0x18e)];}}}}}}}_0x22816f[_0x32e9df(0x246)](_0x32e9df(0x232),{'success':_0x32ed56['flash'](_0x32e9df(0x219)),'errors':_0x32ed56[_0x32e9df(0x17c)](_0x32e9df(0x1cb)),'role':_0x560064,'profile':_0xa71e6f,'master_shop':_0x2bb4a6,'warehouse':_0x6f2ee7,'transfer':_0x3b86f9,'stock':_0x5658eb,'unit':_0x3191ef,'language':_0x5db4a6});}catch(_0x563755){console['log'](_0x563755);}}),router[a0_0x5e910c(0x189)]('/view/:id',auth,async(_0x499307,_0x9629c3)=>{var _0x1553ec=a0_0x5e910c;try{const _0x2cfe7d=_0x499307[_0x1553ec(0x213)]['id'],_0x269059=await transfers['findById'](_0x2cfe7d);_0x9629c3[_0x1553ec(0x24a)](_0x499307[_0x1553ec(0x1ba)]);return;const {date:_0x5cd657,from_warehouse:_0x5f4f1e,FromRoom_name:_0x341874,to_warehouse:_0x19c2a0,ToRoom_name:_0x27ba7c,prod_name:_0x526d05,from_prod_qty:_0x259bf2,from_prod_level:_0x21c51e,from_prod_isle:_0xd25b64,from_prod_pallet:_0x35e075,to_prod_qty:_0x7c8b37,to_prod_level:_0x279898,to_prod_isle:_0x546b21,to_prod_pallet:_0x493d08,primary_code:_0x24ab2d,secondary_code:_0x27443c,product_code3:_0x28bd54,note:_0x16967d,invoice:_0x44dba1,expiry_date:_0x196a58}=_0x499307[_0x1553ec(0x1ba)];if(typeof _0x526d05==_0x1553ec(0x1bc))var _0x4b4a3f=[_0x499307[_0x1553ec(0x1ba)]['prod_name']],_0x3e514c=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x172)]],_0x3b00d8=[_0x499307[_0x1553ec(0x1ba)]['from_prod_level']],_0xf5241f=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1c7)]],_0x89ad58=[_0x499307[_0x1553ec(0x1ba)]['from_prod_pallet']],_0x338327=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x25d)]],_0x43f551=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x175)]],_0x282d51=[_0x499307[_0x1553ec(0x1ba)]['to_prod_level']],_0x3aff2c=[_0x499307['body'][_0x1553ec(0x223)]],_0x487288=[_0x499307[_0x1553ec(0x1ba)]['to_prod_pallet']],_0x131bf3=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x259)]],_0x3949ef=[_0x499307['body'][_0x1553ec(0x180)]],_0xa1d6f4=[_0x499307[_0x1553ec(0x1ba)]['rak']],_0x2417d0=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1a1)]],_0x479c03=[_0x499307['body']['secondary_code']],_0x5b846d=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1a6)]],_0xe03684=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1e9)]],_0x26e74f=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x196)]],_0x42241e=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x235)]],_0x324976=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1b6)]],_0x1d8ad6=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1e7)]],_0x390c23=[_0x499307['body'][_0x1553ec(0x245)]],_0xd0502e=[_0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1cf)]];else var _0x4b4a3f=[..._0x499307['body'][_0x1553ec(0x1d5)]],_0x3949ef=[..._0x499307[_0x1553ec(0x1ba)]['storage']],_0xa1d6f4=[..._0x499307['body'][_0x1553ec(0x21f)]],_0x338327=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x25d)]],_0x131bf3=[..._0x499307[_0x1553ec(0x1ba)]['to_types']],_0x3e514c=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x172)]],_0x3b00d8=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1f1)]],_0xf5241f=[..._0x499307['body'][_0x1553ec(0x1c7)]],_0x89ad58=[..._0x499307['body'][_0x1553ec(0x23d)]],_0x43f551=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x175)]],_0x282d51=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1ab)]],_0x3aff2c=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x223)]],_0x487288=[..._0x499307['body']['to_prod_pallet']],_0x2417d0=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1a1)]],_0x479c03=[..._0x499307[_0x1553ec(0x1ba)]['secondary_code']],_0x5b846d=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1a6)]],_0xe03684=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1e9)]],_0x26e74f=[..._0x499307[_0x1553ec(0x1ba)]['unit']],_0x42241e=[..._0x499307['body'][_0x1553ec(0x235)]],_0x324976=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x1b6)]],_0x1d8ad6=[..._0x499307['body'][_0x1553ec(0x1e7)]],_0x390c23=[..._0x499307[_0x1553ec(0x1ba)][_0x1553ec(0x245)]],_0xd0502e=[..._0x499307['body'][_0x1553ec(0x1cf)]];const _0x3b7bbf=_0x4b4a3f['map'](_0x17817e=>{return _0x17817e={'product_name':_0x17817e};});_0x3e514c[_0x1553ec(0x1b3)]((_0x43f2de,_0x5f3ac4)=>{var _0x479912=_0x1553ec;_0x3b7bbf[_0x5f3ac4][_0x479912(0x233)]=_0x43f2de;}),_0x3b00d8['forEach']((_0x1c6aca,_0x31a736)=>{var _0x2c8da6=_0x1553ec;_0x3b7bbf[_0x31a736][_0x2c8da6(0x226)]=_0x1c6aca;}),_0xf5241f['forEach']((_0x579651,_0x52a3a3)=>{var _0x19e85f=_0x1553ec;_0x3b7bbf[_0x52a3a3][_0x19e85f(0x1c0)]=_0x579651;}),_0x89ad58[_0x1553ec(0x1b3)]((_0x44796f,_0x5ab4b5)=>{_0x3b7bbf[_0x5ab4b5]['from_floorlevel']=_0x44796f;}),_0x43f551['forEach']((_0x517f9a,_0x11a6bd)=>{var _0x503bfa=_0x1553ec;_0x3b7bbf[_0x11a6bd][_0x503bfa(0x1d0)]=_0x517f9a;}),_0x282d51[_0x1553ec(0x1b3)]((_0x28d50c,_0x1ae693)=>{_0x3b7bbf[_0x1ae693]['to_bay']=_0x28d50c;}),_0x3aff2c['forEach']((_0x4ab471,_0x2a5661)=>{var _0x20cba9=_0x1553ec;_0x3b7bbf[_0x2a5661][_0x20cba9(0x1ec)]=_0x4ab471;}),_0x487288[_0x1553ec(0x1b3)]((_0x38fdcc,_0x36330d)=>{_0x3b7bbf[_0x36330d]['to_floorlevel']=_0x38fdcc;}),_0x2417d0['forEach']((_0x1fd8a7,_0x56267b)=>{var _0x12c20b=_0x1553ec;_0x3b7bbf[_0x56267b][_0x12c20b(0x1a1)]=_0x1fd8a7;}),_0x479c03[_0x1553ec(0x1b3)]((_0x2b3912,_0x2760f3)=>{_0x3b7bbf[_0x2760f3]['secondary_code']=_0x2b3912;}),_0x5b846d['forEach']((_0x4a60fe,_0x3fcc90)=>{var _0x3eac48=_0x1553ec;_0x3b7bbf[_0x3fcc90][_0x3eac48(0x1d8)]=_0x4a60fe;}),_0xe03684['forEach']((_0x3bd5aa,_0x1b45b4)=>{var _0x22ffea=_0x1553ec;_0x3b7bbf[_0x1b45b4][_0x22ffea(0x1ca)]=_0x3bd5aa;}),_0x26e74f[_0x1553ec(0x1b3)]((_0x441848,_0x39f260)=>{var _0x30a2d2=_0x1553ec;_0x3b7bbf[_0x39f260][_0x30a2d2(0x196)]=_0x441848;}),_0x42241e[_0x1553ec(0x1b3)]((_0x5a00f6,_0x2153b7)=>{var _0x3a3b43=_0x1553ec;_0x3b7bbf[_0x2153b7][_0x3a3b43(0x235)]=_0x5a00f6;}),_0x324976['forEach']((_0x12ca3e,_0x80195f)=>{var _0x469e5e=_0x1553ec;_0x3b7bbf[_0x80195f][_0x469e5e(0x1b6)]=_0x12ca3e;}),_0x1d8ad6[_0x1553ec(0x1b3)]((_0xaa28af,_0x5951e7)=>{var _0x289eb6=_0x1553ec;_0x3b7bbf[_0x5951e7][_0x289eb6(0x1e7)]=_0xaa28af;}),_0x3949ef['forEach']((_0x232127,_0x57c1a4)=>{_0x3b7bbf[_0x57c1a4]['storage']=_0x232127;}),_0xa1d6f4['forEach']((_0x528f84,_0x403889)=>{var _0x4bd70e=_0x1553ec;_0x3b7bbf[_0x403889][_0x4bd70e(0x1e1)]=_0x528f84;}),_0x338327[_0x1553ec(0x1b3)]((_0x1b109c,_0x5c2976)=>{var _0x2a1da1=_0x1553ec;_0x3b7bbf[_0x5c2976][_0x2a1da1(0x25d)]=_0x1b109c;}),_0x131bf3['forEach']((_0x2725bb,_0x556718)=>{var _0x3da247=_0x1553ec;_0x3b7bbf[_0x556718][_0x3da247(0x259)]=_0x2725bb;}),_0x390c23[_0x1553ec(0x1b3)]((_0x18850e,_0xf5ace1)=>{var _0xceb745=_0x1553ec;_0x3b7bbf[_0xf5ace1][_0xceb745(0x245)]=_0x18850e;}),_0xd0502e['forEach']((_0x55d55c,_0xa76cad)=>{_0x3b7bbf[_0xa76cad]['from_rack']=_0x55d55c;});const _0x4e6f9b=_0x3b7bbf[_0x1553ec(0x22a)](_0x9e0d13=>_0x9e0d13[_0x1553ec(0x1d0)]!=='0'&&_0x9e0d13[_0x1553ec(0x1d0)]!==''||_0x9e0d13[_0x1553ec(0x197)]!=='0'&&_0x9e0d13['to_floorlevel']!=='');var _0x58e2cf=0x0;_0x4e6f9b[_0x1553ec(0x1b3)](_0x470190=>{var _0x2771ed=_0x1553ec;parseInt(_0x470190[_0x2771ed(0x233)])<parseInt(_0x470190['to_quantity'])&&_0x58e2cf++;});if(_0x58e2cf!=0x0)return _0x499307[_0x1553ec(0x17c)](_0x1553ec(0x1cb),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x9629c3['redirect'](_0x1553ec(0x25c));const _0x5ba5a0=await warehouse[_0x1553ec(0x1d9)]({'name':_0x269059[_0x1553ec(0x23f)],'room':_0x269059['from_room']});_0x269059[_0x1553ec(0x1ce)][_0x1553ec(0x1b3)](_0x498d0a=>{var _0x2e5985=_0x1553ec;if(_0x498d0a[_0x2e5985(0x1d0)]>0x0){const _0x82d526=_0x5ba5a0[_0x2e5985(0x18f)][_0x2e5985(0x20a)](_0x50ae6b=>{var _0x65b448=_0x2e5985;_0x50ae6b['product_name']==_0x498d0a[_0x65b448(0x1f9)]&&_0x50ae6b['floorlevel']==_0x498d0a['from_floorlevel']&&_0x50ae6b[_0x65b448(0x208)]==_0x498d0a['from_types']&&_0x50ae6b['bin']==_0x498d0a['from_bin']&&_0x50ae6b[_0x65b448(0x1c1)]==_0x498d0a[_0x65b448(0x226)]&&_0x50ae6b[_0x65b448(0x1e1)]==_0x498d0a[_0x65b448(0x258)]&&_0x50ae6b[_0x65b448(0x180)]==_0x498d0a[_0x65b448(0x245)]&&(_0x50ae6b[_0x65b448(0x186)]=parseInt(_0x50ae6b[_0x65b448(0x186)])+parseInt(_0x498d0a['to_quantity']));});}}),await _0x5ba5a0[_0x1553ec(0x201)]();const _0x230af6=await warehouse[_0x1553ec(0x1d9)]({'name':_0x269059[_0x1553ec(0x1f8)],'room':_0x269059[_0x1553ec(0x20d)]});_0x269059[_0x1553ec(0x1ce)]['forEach'](_0x2e0fde=>{var _0x4f78d1=_0x1553ec;if(_0x2e0fde['to_quantity']>0x0){const _0x2aeab4=_0x230af6[_0x4f78d1(0x18f)][_0x4f78d1(0x20a)](_0x18c009=>{var _0x20fe5e=_0x4f78d1;_0x18c009['product_name']==_0x2e0fde['product_name']&&_0x18c009['floorlevel']==_0x2e0fde[_0x20fe5e(0x197)]&&_0x18c009[_0x20fe5e(0x208)]==_0x2e0fde[_0x20fe5e(0x259)]&&_0x18c009[_0x20fe5e(0x230)]==_0x2e0fde[_0x20fe5e(0x1ec)]&&_0x18c009['bay']==_0x2e0fde[_0x20fe5e(0x1fa)]&&_0x18c009[_0x20fe5e(0x1e1)]==_0x2e0fde[_0x20fe5e(0x1e1)]&&_0x18c009[_0x20fe5e(0x180)]==_0x2e0fde[_0x20fe5e(0x180)]&&(_0x18c009[_0x20fe5e(0x186)]=parseInt(_0x18c009[_0x20fe5e(0x186)])-parseInt(_0x2e0fde[_0x20fe5e(0x1d0)]));});}}),await _0x230af6[_0x1553ec(0x201)](),_0x269059['date']=_0x5cd657,_0x269059[_0x1553ec(0x23f)]=_0x5f4f1e,_0x269059['to_warehouse']=_0x19c2a0,_0x269059[_0x1553ec(0x1ce)]=_0x4e6f9b,_0x269059[_0x1553ec(0x21a)]=_0x16967d,_0x269059[_0x1553ec(0x22e)]=_0x44dba1;const _0x2ac0e5=await _0x269059['save']();console[_0x1553ec(0x263)](_0x2ac0e5);const _0x5b901c=await warehouse[_0x1553ec(0x1d9)]({'name':_0x5f4f1e,'room':_0x341874});_0x2ac0e5[_0x1553ec(0x1ce)][_0x1553ec(0x1b3)](_0x3d97cf=>{var _0x72bfea=_0x1553ec;if(_0x3d97cf[_0x72bfea(0x1d0)]>0x0){const _0x5b70f4=_0x5b901c['product_details'][_0x72bfea(0x20a)](_0x35dec4=>{var _0x1b4f2b=_0x72bfea;_0x35dec4[_0x1b4f2b(0x1f9)]==_0x3d97cf['product_name']&&_0x35dec4[_0x1b4f2b(0x203)]==_0x3d97cf['from_floorlevel']&&_0x35dec4[_0x1b4f2b(0x208)]==_0x3d97cf['from_types']&&_0x35dec4[_0x1b4f2b(0x230)]==_0x3d97cf[_0x1b4f2b(0x1c0)]&&_0x35dec4[_0x1b4f2b(0x1c1)]==_0x3d97cf[_0x1b4f2b(0x226)]&&_0x35dec4['rack']==_0x3d97cf[_0x1b4f2b(0x258)]&&_0x35dec4[_0x1b4f2b(0x180)]==_0x3d97cf['from_storage']&&(_0x35dec4[_0x1b4f2b(0x186)]=parseInt(_0x35dec4[_0x1b4f2b(0x186)])-parseInt(_0x3d97cf[_0x1b4f2b(0x1d0)]));});}}),await _0x5b901c[_0x1553ec(0x201)]();const _0x5c1847=await warehouse[_0x1553ec(0x1d9)]({'name':_0x19c2a0,'room':_0x27ba7c});_0x2ac0e5[_0x1553ec(0x1ce)][_0x1553ec(0x1b3)](_0xa2db5f=>{var _0x13fa10=_0x1553ec;if(_0xa2db5f[_0x13fa10(0x1d0)]>0x0){var _0x181765=0x0;const _0x4cba00=_0x5c1847['product_details'][_0x13fa10(0x20a)](_0x58da84=>{var _0xc5d31c=_0x13fa10;_0x58da84[_0xc5d31c(0x1f9)]==_0xa2db5f['product_name']&&_0x58da84[_0xc5d31c(0x203)]==_0xa2db5f[_0xc5d31c(0x197)]&&_0x58da84[_0xc5d31c(0x208)]==_0xa2db5f[_0xc5d31c(0x259)]&&_0x58da84[_0xc5d31c(0x230)]==_0xa2db5f[_0xc5d31c(0x1ec)]&&_0x58da84[_0xc5d31c(0x1c1)]==_0xa2db5f[_0xc5d31c(0x1fa)]&&_0x58da84[_0xc5d31c(0x1e1)]==_0xa2db5f['rack']&&_0x58da84[_0xc5d31c(0x180)]==_0xa2db5f['storage']&&(_0x58da84[_0xc5d31c(0x186)]=parseInt(_0x58da84['product_stock'])+parseInt(_0xa2db5f[_0xc5d31c(0x1d0)]),_0x181765++);});_0x181765=='0'&&(_0x5c1847[_0x13fa10(0x18f)]=_0x5c1847[_0x13fa10(0x18f)]['concat']({'product_name':_0xa2db5f['product_name'],'product_stock':_0xa2db5f[_0x13fa10(0x1d0)],'bay':_0xa2db5f[_0x13fa10(0x1fa)],'bin':_0xa2db5f['to_bin'],'type':_0xa2db5f[_0x13fa10(0x259)],'floorlevel':_0xa2db5f[_0x13fa10(0x197)],'storage':_0xa2db5f[_0x13fa10(0x180)],'rack':_0xa2db5f[_0x13fa10(0x1e1)],'product_code':_0xa2db5f['product_code'],'primary_code':_0xa2db5f[_0x13fa10(0x1a1)],'secondary_code':_0xa2db5f['secondary_code'],'maxProducts':_0xa2db5f[_0x13fa10(0x1ca)],'storage':_0xa2db5f[_0x13fa10(0x180)],'rack':_0xa2db5f[_0x13fa10(0x1e1)]}));}}),await _0x5c1847[_0x1553ec(0x201)](),_0x499307[_0x1553ec(0x17c)](_0x1553ec(0x219),'Transfer\x20Edit\x20Successfully'),_0x9629c3['redirect'](_0x1553ec(0x1a0));}catch(_0x161ce7){console['log'](_0x161ce7);}}),router[a0_0x5e910c(0x189)](a0_0x5e910c(0x1e2),async(_0x1d7e9b,_0x3ec46a)=>{var _0x1a4b5e=a0_0x5e910c;const {FromWareHouse:_0x3c95ce,FromRoom:_0x37106e,ToWarehouse:_0x510b87,ToRoom:_0x35c5ca,primary_code:_0x3c1f3e,Roomslist:_0x36b9e2}=_0x1d7e9b[_0x1a4b5e(0x1ba)],_0x5850f4=_0x36b9e2[_0x1a4b5e(0x190)](','),_0x6b5031=[];async function _0x38aa8d(_0x7d0458){var _0x5c37c4=_0x1a4b5e;const _0x428c62=await warehouse[_0x5c37c4(0x183)]([{'$match':{'name':_0x3c95ce,'room':_0x7d0458}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x3c1f3e}},{'$group':{'_id':_0x5c37c4(0x19a),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x5c37c4(0x1f7)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5c37c4(0x1a9)},'product_code':{'$first':_0x5c37c4(0x1a7)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5c37c4(0x262)},'type':{'$first':_0x5c37c4(0x176)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5c37c4(0x18c)},'secondary_unit':{'$first':_0x5c37c4(0x216)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5c37c4(0x1ad)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x5c37c4(0x1f6)},'maxPerUnit':{'$first':_0x5c37c4(0x222)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x5c37c4(0x174)},'invoice_product':{'$first':_0x5c37c4(0x18a)}}}]),_0x4f41a8=await warehouse[_0x5c37c4(0x183)]([{'$match':{'name':_0x3c95ce,'room':_0x7d0458}},{'$unwind':_0x5c37c4(0x1e4)},{'$match':{'product_details.secondary_code':_0x3c1f3e}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5c37c4(0x23b)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5c37c4(0x24d)},'secondary_code':{'$first':_0x5c37c4(0x1a9)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5c37c4(0x262)},'type':{'$first':_0x5c37c4(0x176)},'pallet':{'$first':_0x5c37c4(0x17e)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x5c37c4(0x216)},'storage':{'$first':_0x5c37c4(0x207)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5c37c4(0x1ad)},'production_date':{'$first':_0x5c37c4(0x1b9)},'batch_code':{'$first':_0x5c37c4(0x1f6)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x5c37c4(0x20f)},'maxProducts':{'$first':_0x5c37c4(0x174)},'invoice_product':{'$first':_0x5c37c4(0x18a)}}}]);if(_0x428c62['length']>0x0)_0x6b5031[_0x5c37c4(0x1c2)](_0x428c62);else _0x4f41a8[_0x5c37c4(0x1f0)]>0x0&&_0x6b5031[_0x5c37c4(0x1c2)](_0x4f41a8);}const _0x5c1f4b=_0x5850f4[_0x1a4b5e(0x20a)](_0x494ee7=>_0x38aa8d(_0x494ee7));await Promise[_0x1a4b5e(0x17b)](_0x5c1f4b),_0x3ec46a['json'](_0x6b5031);}),router[a0_0x5e910c(0x189)](a0_0x5e910c(0x20b),async(_0x531e74,_0x438758)=>{var _0x4a4d58=a0_0x5e910c;try{const {FromWareHouse:_0x323462,FromRoom:_0x2e45d4,ToWarehouse:_0x23f9e7,ToRoom:_0x54242e,secondary_code:_0x50eb98}=_0x531e74[_0x4a4d58(0x1ba)],_0x42c86a=await warehouse[_0x4a4d58(0x183)]([{'$match':{'name':_0x323462}},{'$unwind':_0x4a4d58(0x1e4)},{'$match':{'product_details.secondary_code':_0x50eb98}},{'$group':{'_id':_0x4a4d58(0x19a),'name':{'$first':_0x4a4d58(0x23b)},'primary_code':{'$first':_0x4a4d58(0x24d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4a4d58(0x1a7)},'instock':{'$first':_0x4a4d58(0x1f7)},'warehouse':{'$first':_0x4a4d58(0x23e)},'level':{'$first':_0x4a4d58(0x1a5)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x4a4d58(0x174)},'unit':{'$first':_0x4a4d58(0x18c)}}}]);_0x438758[_0x4a4d58(0x21c)](0xc8)['json'](_0x42c86a);}catch(_0xccc4f3){_0x438758[_0x4a4d58(0x21c)](0x194)['json']({'message':_0xccc4f3['message']});}}),router['post'](a0_0x5e910c(0x25f),async(_0x59b85b,_0x524cdc)=>{var _0x394739=a0_0x5e910c;try{const {FromWareHouse:_0x324671,FromRoom:_0x251507,ToWarehouse:_0x380382,ToRoom:_0x5be8da,product_code:_0x55d08b}=_0x59b85b['body'],_0xa3a93e=await warehouse[_0x394739(0x183)]([{'$match':{'name':_0x324671}},{'$unwind':_0x394739(0x1e4)},{'$match':{'product_details.product_code':_0x55d08b}},{'$group':{'_id':_0x394739(0x19a),'name':{'$first':_0x394739(0x23b)},'primary_code':{'$first':_0x394739(0x24d)},'secondary_code':{'$first':_0x394739(0x1a9)},'product_code':{'$first':_0x394739(0x1a7)},'instock':{'$first':_0x394739(0x1f7)},'warehouse':{'$first':'$name'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x394739(0x1bd)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'}}}]);_0x524cdc[_0x394739(0x21c)](0xc8)[_0x394739(0x24a)](_0xa3a93e);}catch(_0x1b6636){_0x524cdc['status'](0x194)[_0x394739(0x24a)]({'message':_0x1b6636[_0x394739(0x238)]});}}),router['post'](a0_0x5e910c(0x23c),async(_0x12d6fc,_0x2b6a44)=>{var _0x537b7c=a0_0x5e910c;const {level:_0x193f80,isle:_0x70fd78,pallet:_0x27fbec,warehouses:_0x36be23,room:_0x4ecfc7}=_0x12d6fc[_0x537b7c(0x1ba)];try{const _0x23d2df=await warehouse[_0x537b7c(0x183)]([{'$match':{'name':_0x36be23,'room':_0x4ecfc7}},{'$unwind':_0x537b7c(0x1e4)},{'$match':{'product_details.level':parseInt(_0x193f80),'product_details.isle':_0x70fd78,'product_details.pallet':parseInt(_0x27fbec)}},{'$group':{'_id':_0x537b7c(0x19a),'name':{'$first':_0x537b7c(0x23b)},'product_stock':{'$first':_0x537b7c(0x1f7)},'level':{'$first':_0x537b7c(0x1a5)},'isle':{'$first':_0x537b7c(0x1bd)},'pallet':{'$first':_0x537b7c(0x179)},'maxProducts':{'$first':_0x537b7c(0x174)}}}]);_0x2b6a44[_0x537b7c(0x21c)](0xc8)[_0x537b7c(0x24a)](_0x23d2df);}catch(_0x4221c0){_0x2b6a44[_0x537b7c(0x21c)](0x194)[_0x537b7c(0x24a)]({'message':_0x4221c0[_0x537b7c(0x238)]});}}),module[a0_0x5e910c(0x191)]=router;